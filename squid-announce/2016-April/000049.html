<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-announce] [ADVISORY] SQUID-2016:5 Buffer overflow in	cachemgr.cgi
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A5%20Buffer%20overflow%20in%0A%09cachemgr.cgi&In-Reply-To=%3C5718B977.20204%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000048.html">
   <LINK REL="Next"  HREF="000050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-announce] [ADVISORY] SQUID-2016:5 Buffer overflow in	cachemgr.cgi</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A5%20Buffer%20overflow%20in%0A%09cachemgr.cgi&In-Reply-To=%3C5718B977.20204%40treenet.co.nz%3E"
       TITLE="[squid-announce] [ADVISORY] SQUID-2016:5 Buffer overflow in	cachemgr.cgi">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Apr 21 11:28:55 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000048.html">[squid-announce] Squid 4.0.9 beta is available
</A></li>
        <LI>Next message: <A HREF="000050.html">[squid-announce] [ADVISORY SQUID-2016:6 Multiple issues in ESI	processing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

    Squid Proxy Cache Security Update Advisory SQUID-2016:5
__________________________________________________________________

Advisory ID:            SQUID-2016:5
Date:                   April 20, 2016
Summary:                Buffer overflow in cachemgr.cgi
Affected versions:      Squid 2.x all releases
                        Squid 3.x -&gt; 3.5.16
                        Squid 4.x -&gt; 4.0.8
Fixed in version:       Squid 3.5.17, 4.0.9
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2016_5.txt">http://www.squid-cache.org/Advisories/SQUID-2016_5.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4051">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4051</A>
    CESG REF: 56397140 / VULNERABILITY ID: 394201
__________________________________________________________________

Problem Description:

 Due to incorrect buffer management Squid cachemgr.cgi tool is
 vulnerable to a buffer overflow when processing remotely supplied
 inputs relayed to it from Squid.

__________________________________________________________________

Severity:

 This problem allows any client to seed the Squid manager reports
 with data that will cause a buffer overflow when processed by
 the cachemgr.cgi tool.

 However, this does require manual administrator actions to take
 place. Which greatly reduces the impact and possible uses.
__________________________________________________________________

Updated Packages:

 This bug is fixed by Squid versions 3.5.17 and 4.0.9

 In addition, patches addressing this problem for stable releases
 can be found in our patch archives:

Squid 3.2:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.2/changesets/SQUID-2016_5.patch">http://www.squid-cache.org/Versions/v3/3.2/changesets/SQUID-2016_5.patch</A>&gt;

Squid 3.3:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.3/changesets/SQUID-2016_5.patch">http://www.squid-cache.org/Versions/v3/3.3/changesets/SQUID-2016_5.patch</A>&gt;

Squid 3.4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.4/changesets/SQUID-2016_5.patch">http://www.squid-cache.org/Versions/v3/3.4/changesets/SQUID-2016_5.patch</A>&gt;

Squid 3.5:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/SQUID-2016_5.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/SQUID-2016_5.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 Squid proxy is not vulnerable. The problem is isolated to the
 manager CGI interface tool.

 The vulnerability is also limited to reports displaying full URL
 and/or similar unbounded values provided by the client. That
 includes the reports:

  filedescriptors, objects, vm_objects, active_requests,
  client_list, and mem on certain systems.


 cachemgr.cgi tool displays its version number in the HTML page
 footer:

  All 2.x versions up to and including 2.7.STABLE9 are vulnerable.

  All 3.x versions up to and including 3.5.16 are vulnerable.

  All 4.x versions up to and including 4.0.8 are vulnerable.

  If your cachemgr.cgi does not display a version it is likely
  to be one of the older vulnerable versions.

__________________________________________________________________

Workaround:

 Use tools other than cachemgr.cgi, such as squidclient to view
 affected reports until the CGI tool can be patched or upgraded.

OR,

 In recent Squid versions use the HTTP management interface
 directly from the squid proxy to view affected reports.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-users at squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 <A HREF="http://www.squid-cache.org/Support/mailing-lists.html.">http://www.squid-cache.org/Support/mailing-lists.html.</A>

 For reporting of non-security bugs in the latest release
 the squid bugzilla database should be used
 <A HREF="http://bugs.squid-cache.org/.">http://bugs.squid-cache.org/.</A>

 For reporting of security sensitive bugs send an email to the
 <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-bugs at squid-cache.org</A> mailing list. It is a closed list
 (though anyone can post) and security related bug reports are
 treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 The vulnerability was discovered independently by CESG and
 by Yuriy M. Kaminskiy.

 Fixed by Amos Jeffries from Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2016-04-15 10:54:39 GMT Initial Report
 2016-04-20 03:54:54 GMT Patches Released
 2016-04-20 13:42:00 GMT Packages Released
 2016-04-20 15:47:01 GMT CVE Assigned
__________________________________________________________________
END
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000048.html">[squid-announce] Squid 4.0.9 beta is available
</A></li>
	<LI>Next message: <A HREF="000050.html">[squid-announce] [ADVISORY SQUID-2016:6 Multiple issues in ESI	processing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-announce">More information about the squid-announce
mailing list</a><br>
</body></html>
