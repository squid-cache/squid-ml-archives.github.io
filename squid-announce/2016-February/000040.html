<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-announce] [ADVISORY] SQUID-2016:2 Multiple Denial of Service issues in HTTP Response processing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A2%20Multiple%20Denial%20of%20Service%0A%20issues%20in%20HTTP%20Response%20processing&In-Reply-To=%3C56CD3575.50702%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000039.html">
   <LINK REL="Next"  HREF="000041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-announce] [ADVISORY] SQUID-2016:2 Multiple Denial of Service issues in HTTP Response processing</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A2%20Multiple%20Denial%20of%20Service%0A%20issues%20in%20HTTP%20Response%20processing&In-Reply-To=%3C56CD3575.50702%40treenet.co.nz%3E"
       TITLE="[squid-announce] [ADVISORY] SQUID-2016:2 Multiple Denial of Service issues in HTTP Response processing">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Feb 24 04:45:41 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000039.html">[squid-announce] [ADVISORY] SQUID-2016:1 Remote Denial of Service issue in SSL/TLS processing.
</A></li>
        <LI>Next message: <A HREF="000041.html">[squid-announce] Squid 3.5.15 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40">[ date ]</a>
              <a href="thread.html#40">[ thread ]</a>
              <a href="subject.html#40">[ subject ]</a>
              <a href="author.html#40">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2016:2
__________________________________________________________________

Advisory ID:        SQUID-2016:1
Date:               February 23, 2016
Summary:            Multiple Denial of Service issues
                    in HTTP Response processing
Affected versions:  Squid 3.x -&gt; 3.5.16
                    Squid 4.x -&gt; 4.0.7
Fixed in version:   Squid 4.0.7, 3.5.15
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2016_2.txt">http://www.squid-cache.org/Advisories/SQUID-2016_2.txt</A>
__________________________________________________________________

Problem Description:

 Due to incorrect bounds checking Squid is vulnerable to a denial
 of service attack when processing HTTP responses.

 Due to incorrect error handling Squid-4 is vulnerable to a denial
 of service attack when processing malformed HTTP responses.

__________________________________________________________________

Severity:

 These problems allow remote servers delivering certain unusual
 HTTP response syntax to trigger a denial of service for all
 clients accessing the Squid service.

 HTTP responses containing malformed headers that trigger this
 issue are becoming common. We are not certain at this time if
 that is a sign of malware or just broken server scripting.

 Details of a trivial attack are already circulating publicly.

__________________________________________________________________

Updated Packages:

 These bugs are fixed by Squid version 3.5.15 and 4.0.7.

 In addition, patches addressing these problems for the stable
 release can be found in our patch archives:

Squid 3.5:
 <A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13990.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13990.patch</A>
 <A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13991.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13991.patch</A>

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 All Squid-3.2 and older have not been tested but are expected to
 be vulnerable.

 All unpatched Squid-3.3 versions are vulnerable.

 All unpatched Squid-3.4 versions are vulnerable.

 All unpatched Squid-3.5.14 and older are vulnerable.

 All unpatched Squid-4.0.6 and older are vulnerable.

__________________________________________________________________

Workaround:

 There are no good workarounds known for these vulnerabilities.

 The following squid.conf settings can protect Squid-3.5 (only)
 against the publicly published attack. But unpatched Squid
 remain vulnerable to other known attacks:

   acl Vary rep_header Vary .
   store_miss deny Vary

Or,

 The following squid.conf settings can protect against the
 publicly published attack. But unpatched Squid remain vulnerable
 to other known attacks:

   cache deny all

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If your install and build Squid from the original Squid sources
 then the <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-users at lists.squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

 For reporting of non-security bugs in the latest STABLE release
 the squid bugzilla database should be used
 &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

 For reporting of security sensitive bugs send an email to the
 <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-bugs at lists.squid-cache.org</A> mailing list. It's a closed
 list (though anyone can post) and security related bug reports
 are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 The bounds checking vulnerability was identified and reported by
 Mathias Fischer from Open Systems AG.

 The bounds checking vulnerability was fixed by Alex Rousskov from
 The Measurement Factory.

 The error handling vulnerability was found and fixed by Alex
 Rousskov from The Measurement Factory.

__________________________________________________________________

Revision history:

 2016-02-17 06:51:25 UTC Initial Report
 2016-02-18 04:15:33 UTC Patches Released
 2016-02-19 23:15:41 UTC Additional Patches Released
 2016-02-23 16:37:27 UTC Attack PoC becomes public knowledge
 2016-02-23 18:23:00 UTC Packages Released
__________________________________________________________________
END
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000039.html">[squid-announce] [ADVISORY] SQUID-2016:1 Remote Denial of Service issue in SSL/TLS processing.
</A></li>
	<LI>Next message: <A HREF="000041.html">[squid-announce] Squid 3.5.15 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40">[ date ]</a>
              <a href="thread.html#40">[ thread ]</a>
              <a href="subject.html#40">[ subject ]</a>
              <a href="author.html#40">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-announce">More information about the squid-announce
mailing list</a><br>
</body></html>
