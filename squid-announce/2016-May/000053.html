<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-announce] [ADVISORY] SQUID-2016:7 Cache poisoning issue in HTTP Request handling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A7%20Cache%20poisoning%20issue%20in%0A%20HTTP%20Request%20handling&In-Reply-To=%3C357b94df-6d53-0c77-b2a5-35ccc7a95394%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000052.html">
   <LINK REL="Next"  HREF="000054.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-announce] [ADVISORY] SQUID-2016:7 Cache poisoning issue in HTTP Request handling</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2016%3A7%20Cache%20poisoning%20issue%20in%0A%20HTTP%20Request%20handling&In-Reply-To=%3C357b94df-6d53-0c77-b2a5-35ccc7a95394%40treenet.co.nz%3E"
       TITLE="[squid-announce] [ADVISORY] SQUID-2016:7 Cache poisoning issue in HTTP Request handling">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon May  9 08:24:58 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000052.html">[squid-announce] Squid 3.5.19 is available
</A></li>
        <LI>Next message: <A HREF="000054.html">[squid-announce] [ADVISORY] SQUID-2016:8 Header smuggling issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53">[ date ]</a>
              <a href="thread.html#53">[ thread ]</a>
              <a href="subject.html#53">[ subject ]</a>
              <a href="author.html#53">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

    Squid Proxy Cache Security Update Advisory SQUID-2016:7
__________________________________________________________________

Advisory ID:        SQUID-2016:7
Date:               May 06, 2016
Summary:            Cache poisoning issue
                    in HTTP Request handling
Affected versions:  Squid 3.2.0.11 -&gt; 3.5.17
                    Squid 4.x -&gt; 4.0.9
Fixed in version:   Squid 3.5.18, 4.0.10
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2016_7.txt">http://www.squid-cache.org/Advisories/SQUID-2016_7.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4553">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4553</A>
__________________________________________________________________

Problem Description:

 Due to incorrect data validation of intercepted HTTP Request
 messages Squid is vulnerable to clients bypassing the protection
 against CVE-2009-0801 related issues. This leads to cache
 poisoning.

__________________________________________________________________

Severity:

 This problem is serious because it allows any client, including
 browser scripts, to bypass local security and poison the proxy
 cache and any downstream caches with content from an arbitrary
 source.

__________________________________________________________________

Updated Packages:

 This bug is fixed by Squid version 3.5.18 and 4.0.10.

 In addition, a patch addressing this problem for the stable
 release can be found in our patch archives:

Squid 3.5:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-14039.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-14039.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

Use the command 'squid -v' to view version and build details of
your proxy;

 All Squid 2.x are not vulnerable.

 All Squid-3.x up to and including 3.2.0.10 are not vulnerable.

 All Squid-3.2.0.11 and later versions up to and including 3.5.17
 are vulnerable.

 All Squid-4.x up to and including 4.0.9 are vulnerable.

__________________________________________________________________

Workaround:

 Add to squid.conf:
   client_dst_passthru off

And,

 Remove any use of &quot;host_verify_strict&quot; directive.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-users at squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 <A HREF="http://www.squid-cache.org/Support/mailing-lists.html.">http://www.squid-cache.org/Support/mailing-lists.html.</A>

 For reporting of non-security bugs in the latest release
 the squid bugzilla database should be used
 <A HREF="http://bugs.squid-cache.org/.">http://bugs.squid-cache.org/.</A>

 For reporting of security sensitive bugs send an email to the
 <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-bugs at squid-cache.org</A> mailing list. It is a closed list
 (though anyone can post) and security related bug reports are
 treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 The vulnerability was reported by Jianjun Chen from Tsinghua
 University.

 Fixed by Amos Jeffries from Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2016-04-15 10:54:39 UTC Initial Report
 2016-05-02 10:51:18 UTC Patch Released
 2016-05-06 13:12:00 UTC Packages Released
 2016-05-06 14:46:41 UTC CVE Assignment
__________________________________________________________________
END
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000052.html">[squid-announce] Squid 3.5.19 is available
</A></li>
	<LI>Next message: <A HREF="000054.html">[squid-announce] [ADVISORY] SQUID-2016:8 Header smuggling issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53">[ date ]</a>
              <a href="thread.html#53">[ thread ]</a>
              <a href="subject.html#53">[ subject ]</a>
              <a href="author.html#53">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-announce">More information about the squid-announce
mailing list</a><br>
</body></html>
