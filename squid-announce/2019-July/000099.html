<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-announce] [ADVISORY] SQUID-2019:6 Multiple Cross-Site Scripting issues in cachemgr.cgi
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2019%3A6%20Multiple%20Cross-Site%0A%20Scripting%20issues%20in%20cachemgr.cgi&In-Reply-To=%3Cff25630d-7efb-0845-b171-90557a160b35%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000098.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-announce] [ADVISORY] SQUID-2019:6 Multiple Cross-Site Scripting issues in cachemgr.cgi</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-announce%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2019%3A6%20Multiple%20Cross-Site%0A%20Scripting%20issues%20in%20cachemgr.cgi&In-Reply-To=%3Cff25630d-7efb-0845-b171-90557a160b35%40treenet.co.nz%3E"
       TITLE="[squid-announce] [ADVISORY] SQUID-2019:6 Multiple Cross-Site Scripting issues in cachemgr.cgi">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jul 13 13:33:47 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="000098.html">[squid-announce] [ADVISORY] SQUID-2019:5 Heap Overflow issue in HTTP Basic Authentication processing
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#99">[ date ]</a>
              <a href="thread.html#99">[ thread ]</a>
              <a href="subject.html#99">[ subject ]</a>
              <a href="author.html#99">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

    Squid Proxy Cache Security Update Advisory SQUID-2019:6
__________________________________________________________________

Advisory ID:        SQUID-2019:6
Date:               July 12, 2019
Summary:            Multiple Cross-Site Scripting issues
                    in cachemgr.cgi.
Affected versions:  Squid 2.x all releases
                    Squid 3.x -&gt; 3.5.28
                    Squid 4.x -&gt; 4.7
Fixed in version:   Squid 4.8
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2019_6.txt">http://www.squid-cache.org/Advisories/SQUID-2019_6.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13345">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13345</A>
__________________________________________________________________

Problem Description:

 Due to incorrect input handling Squid cachemgr.cgi tool is
 vulnerable to multiple cross-site scripting attacks.

__________________________________________________________________

Severity:

 This allows a malicious server to embed URLs in its content such
 that user credentials and other information can be extracted from
 a client or administrator with access to the Squid cachemgr.cgi
 tool URL.

__________________________________________________________________

Updated Packages:

 This bug is fixed by Squid version 4.8.

 In addition, patches addressing this problem for the stable
 releases can be found in our patch archives:

Squid 3.x:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-5730c2b5cb56e7639dc423dd62651c8736a54e35.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-5730c2b5cb56e7639dc423dd62651c8736a54e35.patch</A>&gt;

Squid 4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v4/changesets/squid-4-be1dc8614e7514103ba84d4067ed6fd15ab8f82e.patch">http://www.squid-cache.org/Versions/v4/changesets/squid-4-be1dc8614e7514103ba84d4067ed6fd15ab8f82e.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 Squid proxy is not vulnerable. The problem is isolated to the
 manager CGI interface tool.

 cachemgr.cgi tool displays its version number in the HTML page
 footer:

  All 2.x versions up to and including 2.7.STABLE9 are vulnerable.

  All 3.x versions up to and including 3.5.28 are vulnerable.

  All 4.x versions up to and including 4.7 are vulnerable.

  If your cachemgr.cgi does not display a version it is likely
  to be one of the older vulnerable versions.

__________________________________________________________________

Workarounds:

Either;

 Remove use of the cachemgr.cgi tool. It is only necessary for
 older proxy management. Modern Squid proxies management reports
 can be accessed directly.

Or,

 Add CORS protection to the web server running the CGI tool such
 that remote requests to the cachemgr.cgi tool cannot use
 query-string parameters.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If your install and build Squid from the original Squid sources
 then the <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-users at lists.squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

 For reporting of non-security bugs in the latest STABLE release
 the squid bugzilla database should be used
 &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

 For reporting of security sensitive bugs send an email to the
 <A HREF="http://lists.squid-cache.org/listinfo/squid-announce">squid-bugs at lists.squid-cache.org</A> mailing list. It's a closed
 list (though anyone can post) and security related bug reports
 are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 This vulnerability was discovered by Anil Pazvant.

 Fixed by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2019-05-27 13:38:06 UTC Initial Report
 2019-06-05 15:52:17 UTC CVE Assignment
 2019-07-04 01:17:48 UTC Patches Released
__________________________________________________________________
END
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000098.html">[squid-announce] [ADVISORY] SQUID-2019:5 Heap Overflow issue in HTTP Basic Authentication processing
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#99">[ date ]</a>
              <a href="thread.html#99">[ thread ]</a>
              <a href="subject.html#99">[ subject ]</a>
              <a href="author.html#99">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-announce">More information about the squid-announce
mailing list</a><br>
</body></html>
