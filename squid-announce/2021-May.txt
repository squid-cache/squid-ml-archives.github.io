From squid3 at treenet.co.nz  Mon May 10 12:33:20 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:33:20 +1200
Subject: [squid-announce] Squid 4.15 is available
Message-ID: <b4aa817f251e803c193385e066a9a80c@treenet.co.nz>

The Squid HTTP Proxy team is very pleased to announce the availability
of the Squid-4.15 release!


This release is a security release resolving several issues found in
the prior Squid releases.


The major changes to be aware of since 4.13:

  * SQUID-2020:11 HTTP Request Smuggling
    (CVE-2020-25097)

This problem allows a trusted client to perform HTTP Request
Smuggling and access services otherwise forbidden by Squid
security controls.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-jvf6-h9gj-pmj6>


  * SQUID-2021:1 Denial of Service in URN processing
    (CVE-2021-28651)

This problem allows a malicious server in collaboration with a
trusted client to consume arbitrarily large amounts of memory
on the server running Squid.

Lack of available memory resources impacts all services on the
machine running Squid. Once initiated the DoS situation will
persist until Squid is shutdown.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-ch36-9jhx-phm4>


  * SQUID-2021:2 Denial of Service in HTTP Response Processing
    (CVE-2021-28662)

This problem allows a remote server to perform Denial of Service
when delivering HTTP Response messages. The issue trigger is a
header which can be expected to exist in HTTP traffic without any
malicious intent by the server.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-jjq6-mh2h-g39h>


  * SQUID-2021:3 Denial of Service issue in Cache Manager
    (CVE-2021-28652)

This problem allows a trusted client to trigger memory leaks
which over time lead to a Denial of Service against Squid and
the machine it is operating on.

This attack is limited to clients with Cache Manager API access
privilege.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-m47m-9hvw-7447>


  * SQUID-2021:4 Multiple issues in HTTP Range header
    (CVE-2021-31806, CVE-2021-31807, CVE-2021-31808)

These problems all allow a trusted client to perform Denial of
Service when making HTTP Range requests.

The CVE-2021-31808 problem allows a remote server to perform
Denial of Service when delivering responses to HTTP Range
requests. The issue trigger is a header which can be expected
to exist in HTTP traffic without any malicious intent.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-pxwq-f3qr-w2xf>


  * SQUID-2021:5 Denial of Service in HTTP Response Processing
    (CVE pending allocation)

This problem allows a remote server to perform Denial of Service
when delivering HTTP Response messages. The issue trigger is a
header which can be expected to exist in HTTP traffic without
any malicious intent by the server.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-572g-rvwr-6c7f>


   All users of Squid are urged to upgrade as soon as possible.


See the ChangeLog for the full list of changes in this and earlier
releases.

Please refer to the release notes at
http://www.squid-cache.org/Versions/v4/RELEASENOTES.html
when you are ready to make the switch to Squid-4

This new release can be downloaded from our HTTP or FTP servers

   http://www.squid-cache.org/Versions/v4/
   ftp://ftp.squid-cache.org/pub/squid/
   ftp://ftp.squid-cache.org/pub/archive/4/

or the mirrors. For a list of mirror sites see

   http://www.squid-cache.org/Download/http-mirrors.html
   http://www.squid-cache.org/Download/mirrors.html

If you encounter any issues with this release please file a bug report.
   http://bugs.squid-cache.org/


Amos Jeffries

From squid3 at treenet.co.nz  Mon May 10 12:38:43 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:38:43 +1200
Subject: [squid-announce] Squid 5.0.6 beta is available
Message-ID: <70a1893de7c4f9d20cf7a1560365df1b@treenet.co.nz>

The Squid HTTP Proxy team is very pleased to announce the availability
of the Squid-5.0.6 beta release!


This release is a security release resolving several issues found in
the prior Squid releases.


The major changes to be aware of since 5.0.4:

  * SQUID-2020:11 HTTP Request Smuggling
    (CVE-2020-25097)

This problem allows a trusted client to perform HTTP Request
Smuggling and access services otherwise forbidden by Squid
security controls.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-jvf6-h9gj-pmj6>


  * SQUID-2021:1 Denial of Service in URN processing
    (CVE-2021-28651)

This problem allows a malicious server in collaboration with a
trusted client to consume arbitrarily large amounts of memory
on the server running Squid.

Lack of available memory resources impacts all services on the
machine running Squid. Once initiated the DoS situation will
persist until Squid is shutdown.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-ch36-9jhx-phm4>


  * SQUID-2021:2 Denial of Service in HTTP Response Processing
    (CVE-2021-28662)

This problem allows a remote server to perform Denial of Service
when delivering HTTP Response messages. The issue trigger is a
header which can be expected to exist in HTTP traffic without any
malicious intent by the server.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-jjq6-mh2h-g39h>


  * SQUID-2021:3 Denial of Service issue in Cache Manager
    (CVE-2021-28652)

This problem allows a trusted client to trigger memory leaks
which over time lead to a Denial of Service against Squid and
the machine it is operating on.

This attack is limited to clients with Cache Manager API access
privilege.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-m47m-9hvw-7447>


  * SQUID-2021:4 Multiple issues in HTTP Range header
    (CVE-2021-31806, CVE-2021-31807, CVE-2021-31808)

These problems all allow a trusted client to perform Denial of
Service when making HTTP Range requests.

The CVE-2021-31808 problem allows a remote server to perform
Denial of Service when delivering responses to HTTP Range
requests. The issue trigger is a header which can be expected
to exist in HTTP traffic without any malicious intent.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-pxwq-f3qr-w2xf>


  * SQUID-2021:5 Denial of Service in HTTP Response Processing
    (CVE pending allocation)

This problem allows a remote server to perform Denial of Service
when delivering HTTP Response messages. The issue trigger is a
header which can be expected to exist in HTTP traffic without
any malicious intent by the server.

See the advisory for patches:
  
<https://github.com/squid-cache/squid/security/advisories/GHSA-572g-rvwr-6c7f>


  * TLS/1.3 support improvements

Prior to TLS v1.3 Squid could detect and fetch missing intermediate
server certificates by parsing TLS ServerHello. TLS v1.3 encrypts the
relevant part of the handshake, making such "prefetch" impossible.

This release contains a workaround that should be able to identify
the missing certificates on most (but maybe not all) TLS connections.

This release enhances existing error detailing code so that more
information is logged via the existing %err_code, %err_detail,
%ssl::<negotiated_version and %ssl::>negotiated_version logformat
codes.

Fix certificate validation error handling. This has an immediate
positive effect on the existing reporting of the client
certificate validation errors.


  * Regression in CONNECT URI syntax

Since Peering support for SSL-Bump feature was added CONNECT
request URI have not always contained a port. Squid-5.0.5
and later now correctly send a port number on all requests.


   All users of Squid are urged to upgrade as soon as possible.


See the ChangeLog for the full list of changes in this and earlier
releases.

Please refer to the release notes at
http://www.squid-cache.org/Versions/v5/RELEASENOTES.html
when you are ready to make the switch to Squid-5

This new release can be downloaded from our HTTP or FTP servers

   http://www.squid-cache.org/Versions/v5/
   ftp://ftp.squid-cache.org/pub/squid/
   ftp://ftp.squid-cache.org/pub/archive/5/

or the mirrors. For a list of mirror sites see

   http://www.squid-cache.org/Download/http-mirrors.html
   http://www.squid-cache.org/Download/mirrors.html

If you encounter any issues with this release please file a bug report.
   http://bugs.squid-cache.org/


Amos Jeffries

From squid3 at treenet.co.nz  Mon May 10 12:39:55 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:39:55 +1200
Subject: [squid-announce] [ADVISORY] SQUID-2021:1 Denial of Service in URN
 processing
Message-ID: <d77e50649a1d49c4cfc716b5abbb61d2@treenet.co.nz>

__________________________________________________________________

     Squid Proxy Cache Security Update Advisory SQUID-2021:1
__________________________________________________________________

Advisory ID:       | SQUID-2021:1
Date:              | May 10, 2021
Summary:           | Denial of Service in URN processing
Affected versions: | Squid 2.0 -> 4.14
                    | Squid 5.x -> 5.0.5
Fixed in version:  | Squid 4.15 and 5.0.6
__________________________________________________________________

   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28651>
__________________________________________________________________

Problem Description:

  Due to a buffer management bug Squid is vulnerable to a
  Denial of service attack against the server it is operating on.

  This attack is limited to proxies which attempt to resolve a
  "urn:" resource identifier. Support for this resolving is enabled
  by default in all Squid.

__________________________________________________________________

Severity:

  This problem allows a malicious server in collaboration with a
  trusted client to consume arbitrarily large amounts of memory
  on the server running Squid.

  Lack of available memory resources impacts all services on the
  machine running Squid. Once initiated the DoS situation will
  persist until Squid is shutdown.

CVSS Score of 8.5
<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:N/MUI:R/MS:C/MC:X/MI:X/MA:H&version=3.1>

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
<http://www.squid-cache.org/Versions/v4/changesets/squid-4-a975fd5aedc866629214aaaccb38376855351899.patch>

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 3.5.28 have not been tested and should be
  assumed to be vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.0.5 are vulnerable.

__________________________________________________________________

Workaround:

  Disable URN processing by the proxy. Add these lines to
  squid.conf:

    acl URN proto URN
    http_access deny URN

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the <squid-users at lists.squid-cache.org> mailing list is your
  primary support point. For subscription details see
  <http://www.squid-cache.org/Support/mailing-lists.html>.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  <http://bugs.squid-cache.org/>.

  For reporting of security sensitive bugs send an email to the
  <squid-bugs at lists.squid-cache.org> mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

  2021-02-22 06:55:38 UTC Initial Report
  2021-02-24 00:53:21 UTC Patch Released
  2021-03-17 06:19:09 UTC CVE Assignment
__________________________________________________________________
END

From squid3 at treenet.co.nz  Mon May 10 12:40:58 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:40:58 +1200
Subject: [squid-announce] [ADVISORY] SQUID-2021:2 Denial of Service in HTTP
 Response Processing
Message-ID: <1f452afd8db7e5da14d58c450af4bd8b@treenet.co.nz>

__________________________________________________________________

     Squid Proxy Cache Security Update Advisory SQUID-2021:2
__________________________________________________________________

Advisory ID:       | SQUID-2021:2
Date:              | May 10, 2021
Summary:           | Denial of Service in HTTP Response Processing
Affected versions: | Squid 4.x -> 4.14
                    | Squid 5.x -> 5.0.5
Fixed in version:  | Squid 4.15, 5.0.6
__________________________________________________________________

   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28662>
__________________________________________________________________

Problem Description:

  Due to an input validation bug Squid is vulnerable to a Denial
  of Service against all clients using the proxy.

__________________________________________________________________

Severity:

  This problem allows a remote server to perform Denial of Service
  when delivering HTTP Response messages. The issue trigger is a
  header which can be expected to exist in HTTP traffic without any
  malicious intent by the server.

CVSS Score of 7.9
<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:X/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:N/MUI:R/MS:U/MC:N/MI:N/MA:H&version=3.1>

__________________________________________________________________

Updated Packages:

  This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
<http://www.squid-cache.org/Versions/v4/changesets/squid-4-b1c37c9e7b30d0efb5e5ccf8200f2a646b9c36f8.patch>

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  All Squid older than 4.0 are not vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.0.5 are vulnerable.

__________________________________________________________________

Workaround:

  There are no known workarounds for this vulnerability.

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the <squid-users at lists.squid-cache.org> mailing list is your
  primary support point. For subscription details see
  <http://www.squid-cache.org/Support/mailing-lists.html>.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  <http://bugs.squid-cache.org/>.

  For reporting of security sensitive bugs send an email to the
  <squid-bugs at lists.squid-cache.org> mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Alex Rousskov of The Measurement Factory.

__________________________________________________________________

Revision history:

  2021-03-08 19:45:14 UTC Initial Report
  2021-03-16 15:45:11 UTC Patch Released
  2021-03-18 01:33:50 UTC CVE Allocation
__________________________________________________________________
END

From squid3 at treenet.co.nz  Mon May 10 12:43:06 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:43:06 +1200
Subject: [squid-announce] [ADVISORY] SQUID-2021:4 Multiple issues in HTTP
 Range header
Message-ID: <80e8ffc8716ff55f379758c45f811803@treenet.co.nz>

__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2021:4
__________________________________________________________________

Advisory ID:       | SQUID-2021:4
Date:              | May 10, 2021
Summary:           | Multiple issues in HTTP Range header
Affected versions: | Squid 2.5 -> 2.7.STABLE9
                    | Squid 3.x -> 3.5.28
                    | Squid 4.x -> 4.14
                    | Squid 5.x -> 5.0.5
Fixed in version:  | Squid 4.16, 5.0.6
__________________________________________________________________

   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31806>
   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31807>
   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31808>
__________________________________________________________________

Problem Description:

  Due to an incorrect input validation bug Squid is vulnerable to
  a Denial of Service attack against all clients using the proxy.

  Due to an incorrect memory management bug Squid is vulnerable to
  a Denial of Service attack against all clients using the proxy.

  Due to an integer overflow bug Squid is vulnerable to a Denial
  of Service attack against all clients using the proxy.

__________________________________________________________________

Severity:

  These problems all allow a trusted client to perform Denial of
  Service when making HTTP Range requests.

  The integer overflow problem allows a remote server to perform
  Denial of Service when delivering responses to HTTP Range
  requests. The issue trigger is a header which can be expected to
  exist in HTTP traffic without any malicious intent.

CVSS Score of 8.0
<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:X/MI:X/MA:H&version=3.1>

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
<http://www.squid-cache.org/Versions/v4/changesets/squid-4-e7cf864f938f24eea8af0692c04d16790983c823.patch>

Squid 5:
  
<http://www.squid-cache.org/Versions/v5/changesets/squid-5-6bf66733c122804fada7f5839ef5f3b57e57591c.patch>

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 3.5.28 have not been tested and should be
  assumed to be vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.0.5 are vulnerable.

__________________________________________________________________

Workaround:

  There are no workarounds known for these problems.

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the <squid-users at lists.squid-cache.org> mailing list is your
  primary support point. For subscription details see
  <http://www.squid-cache.org/Support/mailing-lists.html>.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  <http://bugs.squid-cache.org/>.

  For reporting of security sensitive bugs send an email to the
  <squid-bugs at lists.squid-cache.org> mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Alex Rousskov of The Measurement Factory.

__________________________________________________________________

Revision history:

  2021-03-19 06:49:52 UTC Initial Report of Denial of Service
  2021-03-24 08:51:08 UTC Additional Report of Use-After-Free
  2021-03-25 21:57:07 UTC Additional Report of integer-overflow
__________________________________________________________________
END

From squid3 at treenet.co.nz  Mon May 10 12:44:36 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:44:36 +1200
Subject: [squid-announce] [ADVISORY] SQUID-2021:3 Denial of Service issue in
 Cache Manager
Message-ID: <75dea3b7e7204af75cc3d0a960f72c18@treenet.co.nz>

__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2021:3
__________________________________________________________________

Advisory ID:       | SQUID-2021:3
Date:              | May 10, 2021
Summary:           | Denial of Service issue in Cache Manager
Affected versions: | Squid 1.x -> 3.5.28
                    | Squid 4.x -> 4.14
                    | Squid 5.x -> 5.0.4
Fixed in version:  | Squid 4.15 and 5.0.5
__________________________________________________________________

   <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28652>
__________________________________________________________________

Problem Description:

  Due to an incorrect parser validation bug Squid is vulnerable to
  a Denial of Service attack against the Cache Manager API.

__________________________________________________________________

Severity:

  This problem allows a trusted client to trigger memory leaks
  which over time lead to a Denial of Service against Squid and
  the machine it is operating on.

  This attack is limited to clients with Cache Manager API access
  privilege.

CVSS Score of 7.8
https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:N/A:H/E:F/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:H/MPR:H/MUI:N/MS:C/MC:X/MI:X/MA:H&version=3.1

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
<http://www.squid-cache.org/Versions/v4/changesets/squid-4-0003e3518dc95e4b5ab46b5140af79b22253048e.patch>

Squid 5:
  
<http://www.squid-cache.org/Versions/v5/changesets/squid-5-2db70e04723cedd19a90dba8b863ccbc2e708f8e.patch>

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 3.5.28 have not been tested and should be
  assumed to be vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.0.4 are vulnerable.

__________________________________________________________________

Workaround:

Either,

  Disable Cache Manager access entirely if not needed.

  Place the following line in squid.conf before lines containing
  "allow" :

    http_access deny manager

Or,

  Harden Cache Manager access privileges.

  For example; require authentication or other access controls in
  http_access beyond the default IP address restriction.

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the <squid-users at lists.squid-cache.org> mailing list is your
  primary support point. For subscription details see
  <http://www.squid-cache.org/Support/mailing-lists.html>.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  <http://bugs.squid-cache.org/>.

  For reporting of security sensitive bugs send an email to the
  <squid-bugs at lists.squid-cache.org> mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

  2021-03-03 17:02:25 UTC Initial Report
  2021-03-16 01:59:45 UTC Patch Released
  2021-03-17 06:19:09 UTC CVE Assignment
__________________________________________________________________
END

From squid3 at treenet.co.nz  Mon May 10 12:46:42 2021
From: squid3 at treenet.co.nz (squid3 at treenet.co.nz)
Date: Tue, 11 May 2021 00:46:42 +1200
Subject: [squid-announce] [ADVISORY] SQUID-2021:5 Denial of Service in HTTP
 Response Processing
Message-ID: <c2593db6716cd41dc0c279fe2e24fa2a@treenet.co.nz>

__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2021:5
__________________________________________________________________

Advisory ID:       | SQUID-2021:5
Date:              | May 10, 2021
Summary:           | Denial of Service in HTTP Response Processing
Affected versions: | Squid 2.x -> 2.7.STABLE9
                    | Squid 3.x -> 3.5.28
                    | Squid 4.x -> 4.14
                    | Squid 5.x -> 5.0.5
Fixed in version:  | Squid 4.15, 5.0.6
__________________________________________________________________


__________________________________________________________________

Problem Description:

  Due to an input validation bug Squid is vulnerable to a Denial
  of Service against all clients using the proxy.

__________________________________________________________________

Severity:

  This problem allows a remote server to perform Denial of Service
  when delivering HTTP Response messages. The issue trigger is a
  header which can be expected to exist in HTTP traffic without
  any malicious intent by the server.

CVSS Score of 8.8
<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:X/MI:X/MA:H&version=3.1>

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
<http://www.squid-cache.org/Versions/v4/changesets/squid-4-1e05a85bd28c22c9ca5d3ac9f5e86d6269ec0a8c.patch>

Squid 5:
  
<http://www.squid-cache.org/Versions/v5/changesets/squid-5-8af775ed98bfd610f9ce762fe177e01b2675588c.patch>

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 4.15 have not been tested and should be
  assumed to be vulnerable.

  All Squid-5.x up to and including 5.0.5 are vulnerable.

__________________________________________________________________

Workaround:

  There are no known workarounds to this issue.

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the <squid-users at lists.squid-cache.org> mailing list is your
  primary support point. For subscription details see
  <http://www.squid-cache.org/Support/mailing-lists.html>.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  <http://bugs.squid-cache.org/>.

  For reporting of security sensitive bugs send an email to the
  <squid-bugs at lists.squid-cache.org> mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Alex Rousskov of The Measurement Factory.

__________________________________________________________________

Revision history:

  2021-03-05 22:11:43 UTC Initial Report
__________________________________________________________________
END

