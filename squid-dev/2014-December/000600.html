<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Support http_access denials of SslBump &quot;peeked&quot;	connections.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Support%20http_access%20denials%20of%20SslBump%20%22peeked%22%0A%09connections.&In-Reply-To=%3C548723BC.7050700%40users.sourceforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000580.html">
   <LINK REL="Next"  HREF="000622.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Support http_access denials of SslBump &quot;peeked&quot;	connections.</H1>
    <B>Tsantilas Christos</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Support%20http_access%20denials%20of%20SslBump%20%22peeked%22%0A%09connections.&In-Reply-To=%3C548723BC.7050700%40users.sourceforge.net%3E"
       TITLE="[squid-dev] [PATCH] Support http_access denials of SslBump &quot;peeked&quot;	connections.">chtsanti at users.sourceforge.net
       </A><BR>
    <I>Tue Dec  9 16:30:52 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000580.html">[squid-dev] Jenkins build is back to normal : 3.HEAD-amd64-centos-7	#222
</A></li>
        <LI>Next message: <A HREF="000622.html">[squid-dev] [PATCH] Support http_access denials of SslBump &quot;peeked&quot; connections.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#600">[ date ]</a>
              <a href="thread.html#600">[ thread ]</a>
              <a href="subject.html#600">[ subject ]</a>
              <a href="author.html#600">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

   If an SSL connection is &quot;peeked&quot;, it is currently not possible to 
deny it with http_access. For example, the following configuration 
denies all plain HTTP requests as expected but allows all CONNECTs (and 
all subsequent  encrypted/spliced HTTPS requests inside the allowed 
CONNECT tunnels):

     http_access deny all
     ssl_bump peek all
     ssl_bump splice all

The bug results in insecure bumping configurations and/or forces admins 
to abuse ssl_bump directive (during step1 of bumping) for access control 
(as a partial workaround).

This change sends all SSL tunnels (CONNECT and transparent) through 
http_access (and adaptation, etc.) checks during bumping step1. If (real 
or fake) CONNECT is denied during step1, then Squid does not connect to 
the SSL server, but bumps the client connection, and then delivers an 
error page (in response to the first decrypted GET). The behavior is 
similar to what Squid has already been doing for server certificate 
validation errors.

Please read the Technical notes included in patch preamble.

This is a Measurement Factory project
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-2-deny-peeked-CONNECTs-t4.patch
Type: text/x-patch
Size: 13217 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20141209/5cda5c67/attachment.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20141209/5cda5c67/attachment.bin</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000580.html">[squid-dev] Jenkins build is back to normal : 3.HEAD-amd64-centos-7	#222
</A></li>
	<LI>Next message: <A HREF="000622.html">[squid-dev] [PATCH] Support http_access denials of SslBump &quot;peeked&quot; connections.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#600">[ date ]</a>
              <a href="thread.html#600">[ thread ]</a>
              <a href="subject.html#600">[ subject ]</a>
              <a href="author.html#600">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
