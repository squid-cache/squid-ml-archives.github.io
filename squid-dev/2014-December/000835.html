<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] invalid certificates and spliced connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20invalid%20certificates%20and%20spliced%20connections&In-Reply-To=%3C549D9959.6040006%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000808.html">
   <LINK REL="Next"  HREF="000706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] invalid certificates and spliced connections</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20invalid%20certificates%20and%20spliced%20connections&In-Reply-To=%3C549D9959.6040006%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] invalid certificates and spliced connections">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Dec 26 17:22:33 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000808.html">[squid-dev] [PATCH] invalid certificates and spliced connections
</A></li>
        <LI>Next message: <A HREF="000706.html">[squid-dev] [PATCH] invalid certificates and spliced connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#835">[ date ]</a>
              <a href="thread.html#835">[ thread ]</a>
              <a href="subject.html#835">[ subject ]</a>
              <a href="author.html#835">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/22/2014 08:24 AM, Tsantilas Christos wrote:
&gt;<i> On 12/19/2014 10:03 PM, Amos Jeffries wrote:
</I>
&gt;&gt;<i> Possibly a fast ACL is appropriate:
</I>&gt;&gt;<i>     ssl_bump_error allow/deny [acls...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which is run to make the above decision. ONLY in the event that TLS
</I>&gt;&gt;<i> protocol syntax errors or malformations.  Not for cert/cipher/option
</I>&gt;&gt;<i> issues such as bad combinations of valid things, or insecure settings.
</I>
I predict it is going to be increasingly difficult to draw the line
around &quot;protocol syntax errors or malformations&quot; to deterministically
isolate those problems from everything else, including &quot;bad combinations
of valid things, or insecure settings&quot;. There is usually a significant
gray area between &quot;malformed&quot; and &quot;valid&quot;, where the decision depends on
the deployment environment and business logic.

We already have a very flexible certificate validator API and an
ACL-controlled SSL error handling logic. That ought to be sufficient as
far as allowing or denying SSL errors is concerned.

We lack configuration options to control honored error handling, but
that is a different problem. The default &quot;terminate server and bump the
client to serve the error message&quot; behavior suggested by Christos is
secure. It will not satisfy everybody; so future configuration options
will make that behavior configurable.


&gt;<i> I believe it is OK to let this patch as is for now.
</I>&gt;<i> This patch will abort imediatelly:
</I>&gt;<i>  - If no certificate found and checked using squid ssl verify procedure
</I>&gt;<i> (mostly because the server response was malformed, or unsupported)
</I>&gt;<i>  - if a server certificate validation failed
</I>&gt;<i> 
</I>&gt;<i> I believe this is handles most of the cases. The cipher or option issues
</I>&gt;<i> may still be ignored, but this errors may caused because of unsupported
</I>&gt;<i> features by openSSL library we are using.
</I>&gt;<i> But still we have verify server certificates, and this is should be
</I>&gt;<i> enough for security.
</I>

I agree with Christos here. SslBump configuration is already quite
complex. We should not add more configuration options unless absolutely
necessary. The default behavior that Christos is proposing solves the
security problem at hand. Let's postpone adding more options until there
are specific use cases that require them.


Thank you,

Alex.

</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000808.html">[squid-dev] [PATCH] invalid certificates and spliced connections
</A></li>
	<LI>Next message: <A HREF="000706.html">[squid-dev] [PATCH] invalid certificates and spliced connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#835">[ date ]</a>
              <a href="thread.html#835">[ thread ]</a>
              <a href="subject.html#835">[ subject ]</a>
              <a href="author.html#835">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
