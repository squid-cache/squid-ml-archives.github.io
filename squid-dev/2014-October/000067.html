<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20sslproxy_cert_sign_hash%20configuration%20option&In-Reply-To=%3C54338888.9040400%40users.sourceforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000066.html">
   <LINK REL="Next"  HREF="000068.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option</H1>
    <B>Tsantilas Christos</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20sslproxy_cert_sign_hash%20configuration%20option&In-Reply-To=%3C54338888.9040400%40users.sourceforge.net%3E"
       TITLE="[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option">chtsanti at users.sourceforge.net
       </A><BR>
    <I>Tue Oct  7 06:30:32 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000066.html">[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option
</A></li>
        <LI>Next message: <A HREF="000068.html">[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/06/2014 07:26 PM, Amos Jeffries wrote:
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> On 7/10/2014 3:50 a.m., Tsantilas Christos wrote:
</I>&gt;&gt;<i> On 10/06/2014 10:13 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 2/10/2014 5:48 a.m., Tsantilas Christos wrote:
</I>&gt;&gt;&gt;&gt;<i> Browser vendors will get rid of SSL certificates that use SHA-1
</I>&gt;&gt;&gt;&gt;<i> to generate the hash that is then signed by the CA. For
</I>&gt;&gt;&gt;&gt;<i> example, Google Chrome will start to show an &quot;insecure&quot; sign
</I>&gt;&gt;&gt;&gt;<i> for certificates that are valid after 1.1.2016 and will
</I>&gt;&gt;&gt;&gt;<i> generate a warning page for certificates that are valid after
</I>&gt;&gt;&gt;&gt;<i> 1.1.2017 [1],[2],[4]. Microsoft will block certificates with
</I>&gt;&gt;&gt;&gt;<i> SHA-1 after 1.1.2017 [3].
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> IMHO this directive should not be necessary.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1) when mimicing certs server provides the hash type.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We have found problems when trying to mimic everything...
</I>&gt;&gt;<i>
</I>&gt;<i> I know. What problem was there mimicing the hash?
</I>
Currently we are not mimicing signing hash. If we do it, we  may found 
problems. It is something which is not tested.
If in the future we need to mimic signing algorithm, we can implement it.

This is not the only reason.

Certificates mimicking is able only on bump-server-first mode.
It is not possible on bump-client-first, and in cases an error page is 
generated because bumping failed, or because we found wrong certificates.
But in these cases too we need to generate certificates...

The sha256 will be the default with this patch, but if in the future the 
sha256 found insecure, the system admin will be able to fix it using 
this cfg parameter.

&gt;<i>
</I>&gt;&gt;<i> For mimicking hash type, probably we need to support ACLs:
</I>&gt;&gt;<i> sslproxy_cert_sign_hash_mimic allow acl1 acl2 But this is a
</I>&gt;&gt;<i> different project. We do not cover this cases in this patch...
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2) cleanly generated certs should always be using a secure hash
</I>&gt;&gt;&gt;<i> in compliance with TLS specification. The TLS/SSL maximum version
</I>&gt;&gt;&gt;<i> supplied by the client also drives the hashes the server is able
</I>&gt;&gt;&gt;<i> to use: - MD5 for SSL, - SHA1 for TLS 1.0/1.1, - SHA256 for TLS
</I>&gt;&gt;&gt;<i> 1.2+
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The web servers does not provide a different Certificates signing
</I>&gt;&gt;<i> hashing algorithm depending on client TLS version supported....
</I>&gt;&gt;<i> Also the user may wants to use SHA384  ...
</I>&gt;<i>
</I>&gt;<i> Hmm. yes.
</I>&gt;<i>   Would it be easy to check for minimum values to prevent the below
</I>&gt;<i> examples?
</I>
Not in all cases, or not so easy.
The client TLS version is known on Peek-and-splice mode or in 
bump-client-first, but not in bump-server-first mode.

Regards,
    Christos

&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Allowing configuration of the hash seems to be unnecessary, and
</I>&gt;&gt;&gt;<i> adds potential for configuring impossible situations like SSL
</I>&gt;&gt;&gt;<i> without MD5, or more likely SHA-256 with TLS/1.0.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v2.0.22 (MingW32)
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBAgAGBQJUMsK5AAoJELJo5wb/XPRjNB8H/0yYcp24LQbxeyNjHJLvfYYD
</I>&gt;<i> LU4H+fxqqmOldpG82E9EJRyhhITZtsuYkQ9ipWLquZXwkvrtwki2jSI0A90Frq1F
</I>&gt;<i> aGEKCGjAyAhFQ69BuFD4V5dJIDZyGJLpdpPm5QrgRPzbFJ8F49mZ/FB7rVu2yTYr
</I>&gt;<i> Mh4fAA+ddnuXg9Fkj6ImJU64aYkNYWlR0StlC9c/y40Ikw43H3Ux4pHUtL4jMwYN
</I>&gt;<i> ygxH5b1gYkhCRJCkYQhqlPpHVoyF+8cmFPe/54OlJU79UnjFvfDTivkAWHddDs05
</I>&gt;<i> SzIOvsQWZLVZc3jzhDK3DNvC8dclsaDyuf8+9plfiH/33itLEQiX6GmCwTNcpIA=
</I>&gt;<i> =bzuy
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-dev mailing list
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000066.html">[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option
</A></li>
	<LI>Next message: <A HREF="000068.html">[squid-dev] [PATCH] sslproxy_cert_sign_hash configuration option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
