<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] Auth design changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Auth%20design%20changes&In-Reply-To=%3C54471F7C.4020901%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000173.html">
   <LINK REL="Next"  HREF="000182.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] Auth design changes</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Auth%20design%20changes&In-Reply-To=%3C54471F7C.4020901%40treenet.co.nz%3E"
       TITLE="[squid-dev] [RFC] Auth design changes">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Oct 22 03:07:40 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000173.html">[squid-dev] Jenkins build is back to normal : 3.HEAD-amd64-FreeBSD-10-clang #201
</A></li>
        <LI>Next message: <A HREF="000182.html">[squid-dev] [RFC] Auth design changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#176">[ date ]</a>
              <a href="thread.html#176">[ thread ]</a>
              <a href="subject.html#176">[ subject ]</a>
              <a href="author.html#176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Negotiate auth protocol is a bit nasty since it is a wrapper protocol
around both NTLM and Kerberos.

We are facing issues where Negotiate/NTLM handling differs from plain
NTLM and the negotiate_wrapper helper can fail as a result.

Markus has requested I look into merging the wrapper helper
functionality into the Negotiate auth module itself instead of a
separate helper. It has been a long task trying to figure it out but I
think I may have a way forward finally.


What I would like to do is:

 * adjust the module APIs such that the label they emit on headers was
configurable and could be changed at runtime independent of the type()
name they are configured and indexed by.

 * move most of the existing Negotiate code to a module called
Kerberos. Which would think its native scheme type() was &quot;Kerberos&quot;
[albeit unused], and emit the helper blobs as-is.

 * write a new Negotiate module that has Config::decode() probe the
GSSAPI header for protocol sub-type then generates a Ntlm::UserRequest
or Kerberos::UserRequest object. Calling the new API methods to set
their header label &quot;Negotiate&quot;.
 - this would only happen for the sub-protocols which were configured
of course.

 * the Negotiate module would completely lack its own UserRequest and
User objects, and helpers. Emitting the NTLM or Kerberos module
objects instead which use the appropriate other sub-protocol specific
helpers.

 * the Negotiate module configuration would disappear and be
auto-enabled whenever a) the Kerberos scheme was configured, or b) a
flag on NTLM module auth_param was enabled.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJURx98AAoJELJo5wb/XPRjt/4H/iW5TCE43lLln4I80dL3uNxy
R2QjTOYg27usXEi8r3r9tA9jVBPVm+gHb7gbJQxfpGjHOtqgiMvlSUc9nsWcRb4V
6kpG31j4pAqnaRIcOdZaFOoVDyAFE0faIPyarXxdnvzQqVHTt81Mm0jkMxgzmfGO
IO0kRExmyQtzxzMyU1yqsmRQAlisGCCRVpfREtHeevHXDpGUGQ15NkNXGFsYSCVr
LNPYzr9jA7N1wSPQaH21Ybjs+v9eA9VuTAdZV+oyiX3HywEdc1YBKdma3bRUPuuH
AVlmXCPnbVH0h4RcscEZ0MDjxKj6ZlnKCAnhe5Xxnvp/m8NOfIJhUcaMctCZrg8=
=IRbh
-----END PGP SIGNATURE-----
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000173.html">[squid-dev] Jenkins build is back to normal : 3.HEAD-amd64-FreeBSD-10-clang #201
</A></li>
	<LI>Next message: <A HREF="000182.html">[squid-dev] [RFC] Auth design changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#176">[ date ]</a>
              <a href="thread.html#176">[ thread ]</a>
              <a href="subject.html#176">[ subject ]</a>
              <a href="author.html#176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
