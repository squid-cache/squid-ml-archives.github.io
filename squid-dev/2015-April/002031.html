<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Secure ICAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Secure%20ICAP&In-Reply-To=%3C5526900C.6080603%40users.sourceforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002033.html">
   <LINK REL="Next"  HREF="002034.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Secure ICAP</H1>
    <B>Tsantilas Christos</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Secure%20ICAP&In-Reply-To=%3C5526900C.6080603%40users.sourceforge.net%3E"
       TITLE="[squid-dev] [PATCH] Secure ICAP">chtsanti at users.sourceforge.net
       </A><BR>
    <I>Thu Apr  9 14:43:24 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002033.html">[squid-dev] [PATCH] server_name ACL
</A></li>
        <LI>Next message: <A HREF="002034.html">[squid-dev] [PATCH] Secure ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2031">[ date ]</a>
              <a href="thread.html#2031">[ thread ]</a>
              <a href="subject.html#2031">[ subject ]</a>
              <a href="author.html#2031">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
This patch adds support for ICAP services that require SSL/TLS transport
connections.

To mark an ICAP service as &quot;secure&quot;, use an &quot;<A HREF="icaps://">icaps://</A>&quot; service URI 
scheme when listing your service via an icap_service directive.

Squid uses port 11344 for Secure ICAP by default, following another 
popular proxy convention. The old 1344 default for plain ICAP ports has 
not changed.

This patch should applied after the &quot;server_name&quot; and &quot;splicing resumed 
sessions&quot; patches applied to trunk, and after re-merged with the trunk.
However we can start the discussion if you agree.


Technical Details
==================

This patch:
   - Splits Ssl::PeerConnector class into Ssl::PeerConnector parent and 
two kids: Ssl::BlindPeerConnector, a basic SSL connector for 
cache_peers, and Ssl::PeekingPeerConnector, a peek-and-splice SSL 
connector for HTTP servers.

   - Adds a third Ssl::IcapPeerConnector kid to connect to Secure ICAP 
servers.

   - Fixes ErrorState class to avoid crashes on nil ErrorState::request 
member. (Ssl::IcapPeerConnector may generate an ErrorState with a nil 
request).

   - Modifies the ACL peername to use the Secure ICAP server name as 
value while connecting to an ICAP server. This is useful to make SSL 
certificate  policies based on ICAP server name. However, this change is 
undocumented until we decide whether a dedicated ACL would be better.


This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Secure-ICAP-t4.patch
Type: text/x-patch
Size: 99320 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150409/0a10ea80/attachment-0001.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150409/0a10ea80/attachment-0001.bin</A>&gt;
</PRE>










































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002033.html">[squid-dev] [PATCH] server_name ACL
</A></li>
	<LI>Next message: <A HREF="002034.html">[squid-dev] [PATCH] Secure ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2031">[ date ]</a>
              <a href="thread.html#2031">[ thread ]</a>
              <a href="subject.html#2031">[ subject ]</a>
              <a href="author.html#2031">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
