<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] removal of SSL version options
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20removal%20of%20SSL%20version%20options&In-Reply-To=%3C552F5A76.3050809%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002166.html">
   <LINK REL="Next"  HREF="002173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] removal of SSL version options</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20removal%20of%20SSL%20version%20options&In-Reply-To=%3C552F5A76.3050809%40treenet.co.nz%3E"
       TITLE="[squid-dev] [RFC] removal of SSL version options">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Apr 16 06:45:10 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002166.html">[squid-dev] [RFC] removal of SSL version options
</A></li>
        <LI>Next message: <A HREF="002173.html">[squid-dev] [RFC] removal of SSL version options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2167">[ date ]</a>
              <a href="thread.html#2167">[ thread ]</a>
              <a href="subject.html#2167">[ subject ]</a>
              <a href="author.html#2167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/04/2015 5:35 p.m., Alex Rousskov wrote:
&gt;<i> On 04/15/2015 06:17 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> Squid currently has several &quot;version&quot; options to set the SSL/TLS
</I>&gt;&gt;<i> protocol version.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   http(s)_port ... version=
</I>&gt;&gt;<i>   cache_peer ... sslversion
</I>&gt;&gt;<i>   sslproxy_version ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) the option configures version X-only. Which does not follow with
</I>&gt;&gt;<i> current best practice of most other TLS enabled software offering a
</I>&gt;&gt;<i> minimum-version option for compliance with TLS version auto-upgrade
</I>&gt;&gt;<i> mechanisms.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This can result in Squid installations being stuck unnecessarily on
</I>&gt;&gt;<i> outdated protocol versions with insecure ciphers.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2) these options overlap with the related ssloptions= values.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> These can easily be configured to conflict. Such as version setting
</I>&gt;&gt;<i> TLSv1.0-only and ssl-options enabling other versions with v1.0
</I>&gt;&gt;<i> forbidden. The order of security context setup prevents this being a
</I>&gt;&gt;<i> major problem, but it can result in security doing things the admin does
</I>&gt;&gt;<i> not exactly expect.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 3) the http(s)_port option is also easily confused with protocol= since
</I>&gt;&gt;<i> it lacks a &quot;ssl&quot; prefix seen elsewhere.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would like to eventually move towards having a TLS minimum-version
</I>&gt;&gt;<i> parameter like other software. Which means we at least need to begin
</I>&gt;&gt;<i> clearing up this problem ASAP.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Given that the ssloptions= parameters can be used to reach the same
</I>&gt;&gt;<i> configuration I propose that we simply remove the current sslversion
</I>&gt;&gt;<i> options.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Opinions?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I agree that having both ssloptions and sslversion is wrong when both
</I>&gt;<i> can restrict SSL versions. However, I am pretty sure there are cases
</I>&gt;<i> where the admin needs to restrict SSL version to be &quot;exactly X&quot; rather
</I>&gt;<i> than &quot;X or later&quot;. Removing an existing interface that supports such
</I>&gt;<i> &quot;exactly X&quot; configurations seems wrong to me. If you remove sslversion,
</I>&gt;<i> can you add ONLY_SSLv3, ONLY_TLSv1, etc. values to the remaining ssloptions?
</I>
ssloptions already supports enumerating the protocols one does not want
to support.

sslversion=1  ==  ssloptions=
sslversion=3  ==  ssloptions=NO_TLSv1,NO_TLSv1_1,NO_TLSv1_2
sslversion=4  ==  ssloptions=NO_SSLv3,NO_TLSv1_1,NO_TLSv1_2
sslversion=5  ==  ssloptions=NO_SSLv3,NO_TLSv1,NO_TLSv1_2
sslversion=6  ==  ssloptions=NO_SSLv3,NO_TLSv1,NO_TLSv1_1


&gt;<i> 
</I>&gt;<i> Alternatively, instead of removing sslversion, consider obsoleting
</I>&gt;<i> NO_SSL* and NO_TLS* options in ssloptions while adding support for a
</I>&gt;<i> more flexible sslversion configuration:
</I>&gt;<i> 
</I>&gt;<i>     cache_peer ... sslversion=TLSv1.0+ # TLSv1.0 or later
</I>&gt;<i>     cache_peer ... sslversion=TLSv1.1  # exactly TLSv1.1
</I>&gt;<i>     cache_peer ... sslversion=TLSv1.0,TLSv1.0 # TLSv1.0 or 1.1
</I>&gt;<i>     ...
</I>&gt;<i> 
</I>&gt;<i> This will allow admins to configure &quot;minimum-version&quot; (in most cases)
</I>&gt;<i> without losing the ability to restrict versions to a specific subset (in
</I>&gt;<i> special cases).
</I>
This is similar to what I was wanting to move towards. If you think I
should compress the timeline and go straight to this I can:

   cache_peer ... tls-version=1.0+ # TLSv1.0 or later
   cache_peer ... tls-version=1.1  # exactly TLSv1.1 (warn risky, etc)


&gt;<i> 
</I>&gt;<i> We can also emit a warning for &quot;closed&quot; (not X+) sslversions.
</I>&gt;<i> 
</I>&gt;<i> This alternative assumes OpenSSL supports such flexibility.
</I>

Your third example *version=N,M conflicts with the specifications. The
relevant spec requirement is to MUST advertise the highest version
supported by the library being used (which we dont actually know, its
library internal) and support receiving all others higher than some
minimum (1.0+).

Since we are mapping version to option flags we are capable of
supporting it if we must. But I would like to avoid that until we have a
real need. Most of TLS assumes the above spec mechanism is happening.

Amos
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002166.html">[squid-dev] [RFC] removal of SSL version options
</A></li>
	<LI>Next message: <A HREF="002173.html">[squid-dev] [RFC] removal of SSL version options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2167">[ date ]</a>
              <a href="thread.html#2167">[ thread ]</a>
              <a href="subject.html#2167">[ subject ]</a>
              <a href="author.html#2167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
