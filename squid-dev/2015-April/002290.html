<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] pconn_lifetime robustness fixes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20pconn_lifetime%20robustness%20fixes&In-Reply-To=%3C553F96B8.6080204%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002289.html">
   <LINK REL="Next"  HREF="002177.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] pconn_lifetime robustness fixes</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20pconn_lifetime%20robustness%20fixes&In-Reply-To=%3C553F96B8.6080204%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] pconn_lifetime robustness fixes">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Apr 28 14:18:32 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002289.html">[squid-dev] [PATCH] pconn_lifetime robustness fixes
</A></li>
        <LI>Next message: <A HREF="002177.html">[squid-dev] Build failed in Jenkins: trunk-matrix » clang,d-ubuntu-precise #173
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2290">[ date ]</a>
              <a href="thread.html#2290">[ thread ]</a>
              <a href="subject.html#2290">[ subject ]</a>
              <a href="author.html#2290">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/04/2015 9:56 p.m., Tsantilas Christos wrote:
&gt;<i> Patch applied to trunk as r14046.
</I>&gt;<i> 
</I>&gt;<i> 
</I>
Sorry, I got a bit delayed today digging up the reference.

I dont have any objections, since it means reverting back towards Squid
behaviour before this directive ever existed.



It is worth noting that this patch means the directive is now no longer
guaranteed to meet its primary use case:

&quot;
From: Tsantilas Christos
Date: Mon, 01 Sep 2014 19:49:59 +0300

This limit is useful in environments with long-lived connections where
Squid configuration or environmental factors change during a single
connection lifetime. If unrestricted, some connections may last for
hours and even days, ignoring those changes that should have affected
their behavior or their existence.
&quot;

With the reversion to the keep-alive -&gt; close action any existing and
ongoing pipeline of requests will cause the connection to persist past
its lifetime indefinitely. For example; a pipeline of 2+ Long-Polling
requests with Connection:keep-alive will remain alive for as long as the
polling continues to have a second request pipelined before the first ends.


&gt;<i> On 04/27/2015 06:40 PM, Tsantilas Christos wrote:
</I>&gt;&gt;<i> If there is not any objection I will apply this patch to trunk.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 04/15/2015 07:11 PM, Tsantilas Christos wrote:
</I>&gt;&gt;&gt;<i> Hi all,
</I>&gt;&gt;&gt;<i>   I am attaching which fixes pconn_lifetime feature.
</I>&gt;&gt;&gt;<i> We had a long discussion for this feature, which is resulted to the
</I>&gt;&gt;&gt;<i> patch r13780, but unfortunately, Measurement Factory customers reported
</I>&gt;&gt;&gt;<i> problems:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1. Squid closed connections with partially received requests when they
</I>&gt;&gt;&gt;<i> reached pconn_lifetime limit. We should only close _idle_ connections.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2. When connecting to Squid without sending anything for longer than
</I>&gt;&gt;&gt;<i> pconn_lifetime, the connection hangs if the request is sent after the
</I>&gt;&gt;&gt;<i> waiting period.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 3. The connection also hangs if the initial request is starting to be
</I>&gt;&gt;&gt;<i> transmitted but then there is a longer pause before the request is
</I>&gt;&gt;&gt;<i> completed.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Please read the patch preamble for more informations.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This is a Measurement Factory project.
</I>&gt;&gt;&gt;<i>
</I>

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002289.html">[squid-dev] [PATCH] pconn_lifetime robustness fixes
</A></li>
	<LI>Next message: <A HREF="002177.html">[squid-dev] Build failed in Jenkins: trunk-matrix » clang,d-ubuntu-precise #173
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2290">[ date ]</a>
              <a href="thread.html#2290">[ thread ]</a>
              <a href="subject.html#2290">[ subject ]</a>
              <a href="author.html#2290">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
