<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Reject responses with conflicting	Content-Length
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Reject%20responses%20with%20conflicting%0A%09Content-Length&In-Reply-To=%3C55CB6026.3080600%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002994.html">
   <LINK REL="Next"  HREF="003018.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Reject responses with conflicting	Content-Length</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Reject%20responses%20with%20conflicting%0A%09Content-Length&In-Reply-To=%3C55CB6026.3080600%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Reject responses with conflicting	Content-Length">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Aug 12 15:03:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002994.html">[squid-dev] [PATCH] Reject responses with conflicting Content-Length
</A></li>
        <LI>Next message: <A HREF="003018.html">[squid-dev] [PATCH] Reject responses with conflicting Content-Length
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2999">[ date ]</a>
              <a href="thread.html#2999">[ thread ]</a>
              <a href="subject.html#2999">[ subject ]</a>
              <a href="author.html#2999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/11/2015 11:49 PM, Amos Jeffries wrote:

&gt;<i> Which one of these malformations is not malign ?
</I>&gt;<i> 
</I>&gt;<i>  * non-numeric Content-Length
</I>&gt;<i>  * negative value Content-Length
</I>&gt;<i>  * Content-Length with also Transfer-Encoding header
</I>&gt;<i>  * multiple different-value Content-Length
</I>&gt;<i>  * Content-Length on 204 response
</I>
All of them may be benign in _some_ cases. Again, just because something
is malformed, does not mean it was created with an evil purpose and
cannot be proxied as intended, without harm, in some specific environments.

It is pointless to argue about this. You are simply using a different
definition of &quot;benign&quot;. My definition, in this context, is &quot;broken but
not intended to maim&quot;.

Please note that I am _not_ arguing that all benign traffic has to be
proxied and cannot be blocked.


&gt;<i> Each time we go against spec we retreat from the situation of current
</I>&gt;<i> best interoperability.
</I>
An RFC helps with general interoperability. In a specific environment,
it is sometimes possible to achieve better interoperability by violating
a MUST than by following it. This assertion is not only logical, but
proven by numerous examples, configuration options, and code. I hope we
do not need to argue about this.

We decide when those specific environments are worth accommodating, and
to what extent. Many factors go into that decision, including past Squid
behavior. We need to be careful when changing Squid to block something.
And careful action usually requires significant effort and discussion.
And that is part of the reason why I left other malformed cases outside
the scope of this thread.


&gt;<i> A lot of the issues you have been pointing out here and elsewhere is a
</I>&gt;<i> result of people experimenting with their newly approved abilities.
</I>&gt;<i> Sometimes getting it wrong, sometimes hitting remaining Squid flaws. But
</I>&gt;<i> that is cause for reporting failures to the experimenters so they can
</I>&gt;<i> fix inline with the spec (and/or us if we are the violator like this C-L
</I>&gt;<i> case), not for bending over backwards to silently allow a whole new
</I>&gt;<i> generation of brokenness to creep in.
</I>
I agree that reporting problems and blocking malformed traffic is often
the best choice.

However, the world is not black and white. Usually, the best action is
to block malformed traffic. Sometimes, the best action is to
accommodate. Usually, the best behavior can be hard-coded. Sometimes, we
need a configuration option to let the admin pick the best action for
her environment.

Alex.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002994.html">[squid-dev] [PATCH] Reject responses with conflicting Content-Length
</A></li>
	<LI>Next message: <A HREF="003018.html">[squid-dev] [PATCH] Reject responses with conflicting Content-Length
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2999">[ date ]</a>
              <a href="thread.html#2999">[ thread ]</a>
              <a href="subject.html#2999">[ subject ]</a>
              <a href="author.html#2999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
