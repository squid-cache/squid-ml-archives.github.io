<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Coverity-fixes%2C%20part%201%3A%20EnumIterator&In-Reply-To=%3C55DB6461.7060208%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="003164.html">
   <LINK REL="Next"  HREF="003172.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Coverity-fixes%2C%20part%201%3A%20EnumIterator&In-Reply-To=%3C55DB6461.7060208%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Aug 24 18:37:21 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="003164.html">[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator
</A></li>
        <LI>Next message: <A HREF="003172.html">[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3168">[ date ]</a>
              <a href="thread.html#3168">[ thread ]</a>
              <a href="subject.html#3168">[ subject ]</a>
              <a href="author.html#3168">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/24/2015 12:08 PM, Amos Jeffries wrote:
&gt;<i> On 25/08/2015 4:49 a.m., Kinkie wrote:
</I>
&gt;<i> + * behavior is undefined if the iterator
</I>&gt;<i> + * is incremented (or decremented) outside the range representing valid
</I>&gt;<i> + * enum symbols
</I>
I hope that behavior is well defined: For many enums/iterators,
iterators are &quot;incremented outside the range representing valid enum
symbols&quot; to reach end() and rend(). I asked you about these beyond-range
increments, and you assured me that they work fine. We should not add a
comment saying otherwise.

++end() may be undefined, but the result of ++i should be well defined
for an i value pointing to the last (or first) enum value. That result
is what we usually compare with end() or rend()!

If you changed your mind, we have to remove reverse iterators and
require end markers for all enums (as one of the possible solutions).
That would guarantee that iterators are not incremented or decremented
beyond the enum symbols range.



&gt;&gt;<i> + *   zeroth, first, second, onePastLast, fourth
</I>

Please make onePastLast last.


You might want to add a comment that EnumRange() cannot be used to
iterate whole enums without [end] markers and, hence, all enums that
require iteration of the entire range must have markers.


&gt;<i> * the iterator_type being used in static_cast before the typedef _looks_
</I>&gt;<i> very dangerous (even if its fine and works).
</I>&gt;<i>  - I would place typedef up the top in their own protected area to avoid
</I>&gt;<i> a) depending on implicit compiler behaviour and b) future developer
</I>&gt;<i> mistakes/misunderstanding.
</I>
And you can make the typedef public to simplify.


&gt;<i> I dont see the first-user code that we normally require for accepting
</I>&gt;<i> these. I know its coming with a rather big followup, just would be good
</I>&gt;<i> if there was a simple use that could be used as exemplar.
</I>
I have asked for usage examples in regular Squid code as well. I agree
that they should become a part of this patch, but I still do not insist
on that.


I do not have any other new comments and have no objections to the patch.


Alex.

</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003164.html">[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator
</A></li>
	<LI>Next message: <A HREF="003172.html">[squid-dev] [PATCH] Coverity-fixes, part 1: EnumIterator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3168">[ date ]</a>
              <a href="thread.html#3168">[ thread ]</a>
              <a href="subject.html#3168">[ subject ]</a>
              <a href="author.html#3168">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
