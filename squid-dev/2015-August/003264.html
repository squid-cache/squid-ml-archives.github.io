<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] mempools-nozero: turn StoreEntry into MEMPROXY_CLASS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20mempools-nozero%3A%20turn%20StoreEntry%20into%0A%20MEMPROXY_CLASS&In-Reply-To=%3C55E09950.6040807%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="003263.html">
   <LINK REL="Next"  HREF="003276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into MEMPROXY_CLASS</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20mempools-nozero%3A%20turn%20StoreEntry%20into%0A%20MEMPROXY_CLASS&In-Reply-To=%3C55E09950.6040807%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into MEMPROXY_CLASS">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Aug 28 17:24:32 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="003263.html">[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into	MEMPROXY_CLASS
</A></li>
        <LI>Next message: <A HREF="003276.html">[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into	MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3264">[ date ]</a>
              <a href="thread.html#3264">[ thread ]</a>
              <a href="subject.html#3264">[ subject ]</a>
              <a href="author.html#3264">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/28/2015 09:02 AM, Kinkie wrote:

&gt;<i> On Thu, Aug 27, 2015 at 9:28 PM, Alex Rousskov wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 08/27/2015 08:58 AM, Kinkie wrote:
</I>&gt;<i>     &gt;   this patch turns StoreEntry into MEMPROXY_CLASS, getting rid of the
</I>&gt;<i>     &gt; default constructors.
</I>&gt;<i>     &gt;   In the process, it turns hash_link into a class, giving it a default
</I>&gt;<i>     &gt; constructor in order to support nonzeroing pools.
</I>&gt;<i>     &gt;   The old custom allocator also gave a nonstandard chunk size; that
</I>&gt;<i>     &gt; tweak should not be necessary anymore.
</I>

&gt;<i>     Can you explain why that tweak should not be necessary any more?
</I>

&gt;<i> It was discussed on IRC (log edited for clarity, date is 2015-08-20)
</I>
Does not seem like it was _explained_ though.

Our vague understanding of the original code seems to revolve around
something like &quot;larger chunk size was specified to allocate large number
of StoreEntry objects efficiently&quot;. It is not clear to me why allocating
large number of StoreEntry objects efficiently no longer requires larger
chunks.

It is strange that your proposed commit message claims that something
should not be needed any more but we do not actually know whether it is
needed or not. If this goes in, I would recommend clearly stating that
your are changing something potentially major that you _hope_ has no
negative performance effects.


&gt;<i> &lt;yadi&gt; kinkie: I think this calls for an experimental targeted
</I>&gt;<i> conversion with lots of tests on what behaviour is affected.
</I>

I would agree in general, but I doubt you can run relevant tests in this
case. Perhaps there a way to avoid this particular part of the change
and keep the StoreEntry chunk sizes the same as they are today?


Thank you,

Alex.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003263.html">[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into	MEMPROXY_CLASS
</A></li>
	<LI>Next message: <A HREF="003276.html">[squid-dev] [PATCH] mempools-nozero: turn StoreEntry into	MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3264">[ date ]</a>
              <a href="thread.html#3264">[ thread ]</a>
              <a href="subject.html#3264">[ subject ]</a>
              <a href="author.html#3264">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
