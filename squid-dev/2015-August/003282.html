<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Regression introduced in r14268
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Regression%20introduced%20in%20r14268&In-Reply-To=%3C55E3D639.90600%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="003280.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Regression introduced in r14268</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Regression%20introduced%20in%20r14268&In-Reply-To=%3C55E3D639.90600%40measurement-factory.com%3E"
       TITLE="[squid-dev] Regression introduced in r14268">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Aug 31 04:21:13 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="003280.html">[squid-dev] Regression introduced in r14268
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3282">[ date ]</a>
              <a href="thread.html#3282">[ thread ]</a>
              <a href="subject.html#3282">[ subject ]</a>
              <a href="author.html#3282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/30/2015 01:50 PM, Amos Jeffries wrote:

&gt;<i> After fixing that I am now getting:
</I>&gt;<i> 
</I>&gt;<i> #3  0x083316dd in xassert (msg=0x8703069 &quot;c-&gt;locks &gt; 0&quot;, file=0x8702ed3
</I>&gt;<i> &quot;../../src/cbdata.cc&quot;, line=425) at ../../src/debug.cc:556
</I>&gt;<i> 
</I>&gt;<i> Hey reproducible case for *that* long annoying bug !!
</I>&gt;<i> 
</I>&gt;<i> #4  0x082d7feb in cbdataReferenceValid (p=0x8c92e48) at
</I>&gt;<i> ../../src/cbdata.cc:425
</I>&gt;<i> #5  0x082fe3f0 in ACLChecklist::changeAcl (this=0xbffff110, t=0x0) at
</I>&gt;<i> ../../src/acl/Checklist.h:175
</I>&gt;<i> #6  0x084d972b in ACLChecklist::fastCheck (this=0xbffff110,
</I>&gt;<i> list=0x8c92e48) at ../../../src/acl/Checklist.cc:326
</I>&gt;<i> #7  0x0863b5a6 in accessLogLogTo (log=0x8a7c780, al=...,
</I>&gt;<i> checklist=0xbffff110) at ../../../src/log/access_log.cc:96
</I>

I do not think the new changeAcl() method should be used in fastCheck().
The handling of the original ACL list there is different from [even
though the code looks similar to] what changeAcl() now does. When we
discussed adding that new method, I did not realize you would use it in
fastCheck() as well.

The fact that fastCheck(void), fastCheck(acl), and nonBlockingCheck()
are slightly and confusingly different when it comes to access list
management is essentially an [API] bug, but it is not a bug we can or
should solve with the new changeAcl() method.


HTH,

Alex.

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003280.html">[squid-dev] Regression introduced in r14268
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3282">[ date ]</a>
              <a href="thread.html#3282">[ thread ]</a>
              <a href="subject.html#3282">[ subject ]</a>
              <a href="author.html#3282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
