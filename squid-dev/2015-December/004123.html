<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Fix%20shared%20memory%20initialization%2C%0A%20cleanup.%20Ensure%20its%20usability.&In-Reply-To=%3C5668C62D.10503%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004121.html">
   <LINK REL="Next"  HREF="004126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Fix%20shared%20memory%20initialization%2C%0A%20cleanup.%20Ensure%20its%20usability.&In-Reply-To=%3C5668C62D.10503%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Dec 10 00:24:13 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="004121.html">[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.
</A></li>
        <LI>Next message: <A HREF="004126.html">[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4123">[ date ]</a>
              <a href="thread.html#4123">[ thread ]</a>
              <a href="subject.html#4123">[ subject ]</a>
              <a href="author.html#4123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/09/2015 04:24 PM, Amos Jeffries wrote:
&gt;<i> On 10/12/2015 10:49 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i> Questions: Should we add a configuration directive to control whether
</I>&gt;&gt;&gt;&gt;<i> mlock(2) is called? If yes, should mlock(2) be called by default?
</I>&gt;&gt;&gt;&gt;<i> Should mlock(2) failures be fatal?
</I>
&gt;&gt;&gt;<i> My answers are no, yes, yes. Since this is a startup thing squid.conf
</I>&gt;&gt;&gt;<i> post-processing is probably too late.
</I>

&gt;&gt;<i> Shared memory is not allocated until _after_ we parse squid.conf.
</I>

&gt;<i> Ah. Okay.
</I>

Does this understanding change your no/yes/yes answers?

If your answers stay the same, what do you propose to tell admins that
will complain about significantly slower startup times after this fix?
My plan was to tell them to disable mlock() (via a new squid.conf
directive) if all of the items below apply to them:

(a) mlock() is successful now
(b) they are reasonably sure no environment or configuration changes
    will make mlock() unsuccessful (if it is re-enabled) without them
    knowing about the problem
(c) mlock() slows things down too much in their setup
(d) they want to trade faster startup for micro delays during runtime


Thank you,

Alex.

</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004121.html">[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.
</A></li>
	<LI>Next message: <A HREF="004126.html">[squid-dev] [RFC] Fix shared memory initialization, cleanup. Ensure its usability.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4123">[ date ]</a>
              <a href="thread.html#4123">[ thread ]</a>
              <a href="subject.html#4123">[ subject ]</a>
              <a href="author.html#4123">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
