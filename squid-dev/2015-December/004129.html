<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Avoid memory leaks when a certificate validator is used with SslBump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Avoid%20memory%20leaks%20when%20a%20certificate%20validator%0A%20is%20used%20with%20SslBump&In-Reply-To=%3C566995C3.80902%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004128.html">
   <LINK REL="Next"  HREF="004143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Avoid memory leaks when a certificate validator is used with SslBump</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Avoid%20memory%20leaks%20when%20a%20certificate%20validator%0A%20is%20used%20with%20SslBump&In-Reply-To=%3C566995C3.80902%40chtsanti.net%3E"
       TITLE="[squid-dev] [PATCH] Avoid memory leaks when a certificate validator is used with SslBump">christos at chtsanti.net
       </A><BR>
    <I>Thu Dec 10 15:09:55 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="004128.html">[squid-dev] Ntlm helper child exceeds limit
</A></li>
        <LI>Next message: <A HREF="004143.html">[squid-dev] [PATCH] Avoid memory leaks when a certificate validator is used with SslBump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4129">[ date ]</a>
              <a href="thread.html#4129">[ thread ]</a>
              <a href="subject.html#4129">[ subject ]</a>
              <a href="author.html#4129">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When a certificate validator was used, sslCrtvdHandleReplyWrapper 
delivered validator response directly to the Ssl::PeerConnector job 
using job's Ssl::CertValidationHelper::CVHCB callback. If that 
synchronous call happened to be the last job call, then 
Ssl::PeerConnector::done() would become true for the job, as it should, 
but nobody would notice that the PeerConnector job object should be 
deleted, and the object would leak.

This fix converts CVHCB into an async job call to avoid direct, 
unprotected job calls in this context.

This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: High_Memory_Usage_in_Squid-trunk-t3.patch
Type: text/x-patch
Size: 21785 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20151210/331bcbc2/attachment.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20151210/331bcbc2/attachment.bin</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004128.html">[squid-dev] Ntlm helper child exceeds limit
</A></li>
	<LI>Next message: <A HREF="004143.html">[squid-dev] [PATCH] Avoid memory leaks when a certificate validator is used with SslBump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4129">[ date ]</a>
              <a href="thread.html#4129">[ thread ]</a>
              <a href="subject.html#4129">[ subject ]</a>
              <a href="author.html#4129">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
