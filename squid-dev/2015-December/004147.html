<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Note ACL substrings matching
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Note%20ACL%20substrings%20matching&In-Reply-To=%3C566D3ADE.4060600%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004108.html">
   <LINK REL="Next"  HREF="004152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Note ACL substrings matching</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Note%20ACL%20substrings%20matching&In-Reply-To=%3C566D3ADE.4060600%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] Note ACL substrings matching">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Dec 13 09:31:10 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="004108.html">[squid-dev] [PATCH] Note ACL substrings matching
</A></li>
        <LI>Next message: <A HREF="004152.html">[squid-dev] [PATCH] Note ACL substrings matching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4147">[ date ]</a>
              <a href="thread.html#4147">[ thread ]</a>
              <a href="subject.html#4147">[ subject ]</a>
              <a href="author.html#4147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/12/2015 10:56 p.m., Christos Tsantilas wrote:
&gt;<i> There are several use cases where an annotation may contain a list of
</I>&gt;<i> values for a single key. Today it is only possible to match the full
</I>&gt;<i> annotation value.
</I>&gt;<i> 
</I>&gt;<i> This patch investigates the -m flag which can be used to enable
</I>&gt;<i> delimiter separated substrings matching on annotations:
</I>&gt;<i> 
</I>&gt;<i>    acl aclname note [-m[=delimiters]] name value ...
</I>&gt;<i> 
</I>&gt;<i> The '-m' flag by default matches comma separated substrings. The
</I>&gt;<i> optional  &quot;delimiters&quot; parameter is a list of non-alphanumeric
</I>&gt;<i> characters, which can be used as alternate delimiters.
</I>&gt;<i> 
</I>&gt;<i> E.g. if an external ACL sets an annotation like:
</I>&gt;<i>    &quot;applications=http,facebook,facebook-chat&quot;
</I>&gt;<i> the following ACLs can be used to block access to certain applications:
</I>&gt;<i> 
</I>&gt;<i> acl fb_chat      note -m applications facebook-chat
</I>&gt;<i> acl db_upload    note -m  applications dropbox-upload
</I>&gt;<i> http_access      deny fb_chat
</I>&gt;<i> http_access      deny db_upload
</I>&gt;<i> 
</I>&gt;<i> This is a Measurement Factory project
</I>

Annotations from the helper are kv-pair. By definition that means
singular value per key on helper responses. Values are also stored
internally separate, and matched individually agaist the ACL values.

Any concatenation of values that would need this delimiting is solely an
artifact of the reporting method (logformat, header sets, etc).

  So where is the need for this coming from?

Also;

How does this interact with helpers that return multiple kv-pairs ?
 eg. OK user=foo group=Group1 group=Group2 group=group3

How does it interact with kv-pair which contain the delimiter characters
internally?
 eg OK group=Group,1 group=Group2

What about when those delimiters are escaped?
 eg. OK group=&quot;Group\,One&quot; group=Group%2cTwo


Amos

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004108.html">[squid-dev] [PATCH] Note ACL substrings matching
</A></li>
	<LI>Next message: <A HREF="004152.html">[squid-dev] [PATCH] Note ACL substrings matching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4147">[ date ]</a>
              <a href="thread.html#4147">[ thread ]</a>
              <a href="subject.html#4147">[ subject ]</a>
              <a href="author.html#4147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
