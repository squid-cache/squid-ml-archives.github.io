<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PREVIEW] Fetch missing certificates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPREVIEW%5D%20Fetch%20missing%20certificates&In-Reply-To=%3C567989ED.3030009%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004318.html">
   <LINK REL="Next"  HREF="004299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PREVIEW] Fetch missing certificates</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPREVIEW%5D%20Fetch%20missing%20certificates&In-Reply-To=%3C567989ED.3030009%40chtsanti.net%3E"
       TITLE="[squid-dev] [PREVIEW] Fetch missing certificates">christos at chtsanti.net
       </A><BR>
    <I>Tue Dec 22 17:35:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="004318.html">[squid-dev] Build failed in Jenkins: kinkie-refactor-matrix » clang,d-ubuntu-utopic #11
</A></li>
        <LI>Next message: <A HREF="004299.html">[squid-dev] Build failed in Jenkins: kinkie-refactor-matrix » clang,d-ubuntu-trusty #10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4297">[ date ]</a>
              <a href="thread.html#4297">[ thread ]</a>
              <a href="subject.html#4297">[ subject ]</a>
              <a href="author.html#4297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a preview patch. The internal review procedure is not finished 
yet, there are some TODOs, which probably we need to address them.

However I am posting it here to start a discussion on this patch, which 
is a little big and important.

Patch description:

Many web servers do not have complete certificate chains. Many browsers 
use certificate extensions of the server certificate and download the 
missing intermediate certificates automatically from the Internet. This 
patch add this feature to Squid.

The information for missing issuer certificates provided by the 
Authority  Information Access X509 extension. This describes the format 
and location of additional information provided by the issuer of the 
certificate in which in which this extension appears. If the caIssuers 
access method provided then the issuer certificate information provided 
and the access location field exist in thois extension provides the 
location of the issuer certificate.

This patch:
   - Implements an Downloader class as ConnStateData kid class. This new 
class can be used by internal squid subsystems to download objects from 
net.

   - Modify Ssl::PeerConnector class to use new Downloader class to 
retrieve missing certificaes from the net. It retrieved the URIs of 
missing certificates from the Authority Information Access X509 extension.

   - Implements a new SSL records and SSL handshake messages parser 
(Ssl::HandshakeParser class) to improve current SSL messages parsing. 
The new parser now used to check if a Change Cipher Spec message 
included in server hello. The related code removed from 
Ssl::Bio::sslFeatures class

   - Modify the Ssl::ServerBio class to:
      * Buffer the Server Hello message and process it before pass it to 
the openSSL library.
      * Extract server certificates from server hello message. This is 
required to check if there are missing certificates, and if yes give the 
chance to squid to download missing certificates and complete 
certificate chains before pass them for processing to openSSL

   - Fixes and improves the Ssl::Bio related code.

This is a Measurement Factory project
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fetch-certificates-preview-t1.patch
Type: text/x-patch
Size: 142513 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20151222/476bd1e6/attachment-0001.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20151222/476bd1e6/attachment-0001.bin</A>&gt;
</PRE>
































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004318.html">[squid-dev] Build failed in Jenkins: kinkie-refactor-matrix » clang,d-ubuntu-utopic #11
</A></li>
	<LI>Next message: <A HREF="004299.html">[squid-dev] Build failed in Jenkins: kinkie-refactor-matrix » clang,d-ubuntu-trusty #10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4297">[ date ]</a>
              <a href="thread.html#4297">[ thread ]</a>
              <a href="subject.html#4297">[ subject ]</a>
              <a href="author.html#4297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
