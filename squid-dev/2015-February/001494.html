<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] Secure ICAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Secure%20ICAP&In-Reply-To=%3CCA%2BY8hcPvPon38rHTwkUfzYCYi3AptmSkUjP%2BosfpYKrd0Q3RdQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001450.html">
   <LINK REL="Next"  HREF="001640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] Secure ICAP</H1>
    <B>Kinkie</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Secure%20ICAP&In-Reply-To=%3CCA%2BY8hcPvPon38rHTwkUfzYCYi3AptmSkUjP%2BosfpYKrd0Q3RdQ%40mail.gmail.com%3E"
       TITLE="[squid-dev] [RFC] Secure ICAP">gkinkie at gmail.com
       </A><BR>
    <I>Wed Feb  4 08:18:56 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001450.html">[squid-dev] [RFC] Secure ICAP
</A></li>
        <LI>Next message: <A HREF="001640.html">[squid-dev] [RFC] Secure ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1494">[ date ]</a>
              <a href="thread.html#1494">[ thread ]</a>
              <a href="subject.html#1494">[ subject ]</a>
              <a href="author.html#1494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I also have (of course) no objection with the proposed course of
action, and share the hope that the generic crypto library will be
useable for this.

On Wed, Feb 4, 2015 at 3:02 AM, Amos Jeffries &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i> I've been expecting this to come up for a while now, but had hoped the
</I>&gt;<i> crypto generalization would be a bit further along. Oh well.
</I>&gt;<i>
</I>&gt;<i> My plan for the Crypto-NG / libsecurity work already in audit was to
</I>&gt;<i> followup with a Security::Encryptor AsyncJob that could be passed the
</I>&gt;<i> Comm::Connection object from a newely opened connection plus the
</I>&gt;<i> Security::PeerOptions from squid.conf and initiate TLS/SSL on the
</I>&gt;<i> connection.
</I>&gt;<i>
</I>&gt;<i> That model is reusable for cache_peer, DIRECT connections, ICAP, and any
</I>&gt;<i> other protocols which use the X-over-TLS protocol layering. Without any
</I>&gt;<i> major changes to the existing code - we just update the appropriate Comm
</I>&gt;<i> callback to kick off the new Security::Encryptor job once the server FD
</I>&gt;<i> is opened.
</I>&gt;<i>
</I>&gt;<i> I would like to push that update forward rather than anyone writing
</I>&gt;<i> another protocol-specific connection setup pathway. A good chunk of the
</I>&gt;<i> preparation work is already done, so the time to completion would also
</I>&gt;<i> be faster than a new project.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 4/02/2015 9:52 a.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     We would like to add support for &quot;Secure ICAP&quot; -- ICAP services that
</I>&gt;&gt;<i> require SSL/TLS encryption for transport connections. Some other popular
</I>&gt;&gt;<i> proxies support that feature already, I have seen a trickle of admin
</I>&gt;&gt;<i> requests for it, and the feature often becomes essential when filtering
</I>&gt;&gt;<i> bumped traffic using external ICAP services (to preserve the overall
</I>&gt;&gt;<i> security of the entire message delivery chain).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Today, it is possible to emulate Secure ICAP using connection wrappers
</I>&gt;&gt;<i> like stunnel. Needless to say, that workaround is not a production-
</I>&gt;&gt;<i> quality solution.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I think Secure ICAP can use configuration knobs and server validation
</I>&gt;&gt;<i> logic already implemented for secure HTTP peers (the cache_peer
</I>&gt;&gt;<i> directive with an ssl option).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To mark an ICAP service as secure in squid.conf, we can use an &quot;icaps&quot;
</I>&gt;&gt;<i> service URI scheme. The industry is using &quot;secure ICAP&quot; term for this
</I>&gt;&gt;<i> feature,  but &quot;icaps&quot; seems more appropriate/standard for a scheme name
</I>&gt;&gt;<i> compared to &quot;sicap&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We will not support dynamic &quot;upgrades&quot; from plain to secure ICAP
</I>&gt;&gt;<i> connections because:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> * there are no ICAP servers that support that (AFAIK);
</I>&gt;&gt;<i> * there are no ICAP clients that support that (AFAIK);
</I>&gt;&gt;<i> * such support does not seem to be needed in practice given a rather
</I>&gt;&gt;<i> tight/long-term bonding between a proxy and an ICAP service (unlike a
</I>&gt;&gt;<i> relationship between an HTTP client and an origin server);
</I>&gt;&gt;<i> * such support can be added later, if needed, without redoing much of
</I>&gt;&gt;<i> the proposed work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I also do not anticipate changes to the existing ICAP service
</I>&gt;&gt;<i> _selection_ configuration and related features, implementation of the
</I>&gt;&gt;<i> ICAP protocol itself, and eCAP.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If there are any objections to adding Secure ICAP support or high-level
</I>&gt;&gt;<i> suggestions regarding implementation, please let me know!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-dev mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-dev mailing list
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>


-- 
    Francesco
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001450.html">[squid-dev] [RFC] Secure ICAP
</A></li>
	<LI>Next message: <A HREF="001640.html">[squid-dev] [RFC] Secure ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1494">[ date ]</a>
              <a href="thread.html#1494">[ thread ]</a>
              <a href="subject.html#1494">[ subject ]</a>
              <a href="author.html#1494">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
