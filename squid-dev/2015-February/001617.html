<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] sslproxy_options in peek-and-splice mode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20sslproxy_options%20in%20peek-and-splice%20mode&In-Reply-To=%3C54DA9A51.3020301%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001603.html">
   <LINK REL="Next"  HREF="001623.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20sslproxy_options%20in%20peek-and-splice%20mode&In-Reply-To=%3C54DA9A51.3020301%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Feb 10 23:54:57 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001603.html">[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode
</A></li>
        <LI>Next message: <A HREF="001623.html">[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1617">[ date ]</a>
              <a href="thread.html#1617">[ thread ]</a>
              <a href="subject.html#1617">[ subject ]</a>
              <a href="author.html#1617">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/02/2015 6:43 a.m., Tsantilas Christos wrote:
&gt;<i> Bug description:
</I>&gt;<i> 
</I>&gt;<i>   - Squid sslproxy_options deny the use of TLSv1_2 SSL protocol:
</I>&gt;<i>            sslproxy_options NO_TLSv1_2
</I>&gt;<i>   - Squid uses peek mode for bumped connections.
</I>&gt;<i>   - Web client sends an TLSv1_2 hello message and squid in peek mode,
</I>&gt;<i> forwards the client hello message to server
</I>&gt;<i>   - Web server respond with an TLSv1_2 hello message
</I>&gt;<i>   - Squid while parsing server hello message aborts with an error
</I>&gt;<i> because  sslproxy_options deny the use ot TLSv1_2 protocol.
</I>&gt;<i> 
</I>&gt;<i> This patch fixes squid to ignore sslproxy_options in peek or stare
</I>&gt;<i> bumping mode.
</I>
As I understand it the action of applying the options to the context
removes from the context cipher references etc which are not possible.

Since peek and stare are non-final states I can easily imagine that
OpenSSL library negotiates ciphers which the options would otherwise
prohibit. Then when the options get applied to the context it find
itself using an algorithm which does not exist.

So what happens during the final state in that type of event?

Amos

</PRE>























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001603.html">[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode
</A></li>
	<LI>Next message: <A HREF="001623.html">[squid-dev] [PATCH] sslproxy_options in peek-and-splice mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1617">[ date ]</a>
              <a href="thread.html#1617">[ thread ]</a>
              <a href="subject.html#1617">[ subject ]</a>
              <a href="author.html#1617">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
