<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Digest related question.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Digest%20related%20question.&In-Reply-To=%3C54E926D7.3010703%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001735.html">
   <LINK REL="Next"  HREF="001737.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Digest related question.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Digest%20related%20question.&In-Reply-To=%3C54E926D7.3010703%40treenet.co.nz%3E"
       TITLE="[squid-dev] Digest related question.">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Feb 22 00:46:15 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001735.html">[squid-dev] Digest related question.
</A></li>
        <LI>Next message: <A HREF="001737.html">[squid-dev] Digest related question.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1736">[ date ]</a>
              <a href="thread.html#1736">[ thread ]</a>
              <a href="subject.html#1736">[ subject ]</a>
              <a href="author.html#1736">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/02/2015 12:31 p.m., Eliezer Croitoru wrote:
&gt;<i> From what I understand, the HTTP protocol and some RFC docs that was
</I>&gt;<i> mentioned in the list allow or provide a way to utilize Digest header
</I>&gt;<i> and\or Link headers which might contain some digest data.
</I>&gt;<i> 
</I>&gt;<i> So the first question is about the current md5 hash which is being used
</I>&gt;<i> by the internal index hashing.
</I>&gt;<i> Assuming we want to allow the admin change the default md5 hash into
</I>&gt;<i> sha1 or sha256 hash, how complicated will it be? can it be considered a
</I>&gt;<i> wanted feature?
</I>
Not complicated at all. There is even a UFS cache meta tag (TLV) already
assigned from when it was added years ago.

The problem back then, and still today, is that SHA1 is 300% slower than
MD5.

But there is no real need for anything else in the context of a cache
hash ID. The MD5 issues are specifically in how the rare-but-possible
collisions can be generated to discover keys when its used as part of an
encryption cipher. Cache lookup hash has no secret info to decrypt, and
when sent over the wire represents a token *intended* to be replayable
to fetch public data anyway.


I've been keeping an eye on the AES hash speeds instead of SHA, since
AES is only 60% slower than MD5 today and has fewer collisions than even
SHA1. If there gets to be much more hardware acceleration AES might
become a real contender for better cache hashing. But until it does so
its not worth the trouble coding.



&gt;<i> 
</I>&gt;<i> And the second question, about metalinks related integration with squid.
</I>&gt;<i> In any scenario I see possible a digest of cache objects from the server
</I>&gt;<i> side would require digest update of any of the in transit objects and
</I>&gt;<i> another index or maybe two.
</I>&gt;<i> Another aspect of this thing is the integrity of the src server.
</I>&gt;<i> If the origin-server is indeed a hostile one we must not rely on it.
</I>&gt;<i> So there is a policy which needs to be implemented in some way to allow
</I>&gt;<i> an origin server which we rely on.
</I>&gt;<i> 
</I>&gt;<i> In order to prove this is indeed possible and applicable for what ever
</I>&gt;<i> system there is out-there I was thinking about writing a proof of
</I>&gt;<i> concept of the idea.
</I>&gt;<i> 
</I>&gt;<i> I would like to not touch squid code at all in the first steps while
</I>&gt;<i> implementing the proof of concept.
</I>&gt;<i> 
</I>&gt;<i> I need your help with the right point of view and ideas about how to
</I>&gt;<i> prove the idea.
</I>&gt;<i> What API or what options squid gives that can be used to implement the
</I>&gt;<i> idea?
</I>&gt;<i> What available programming resources are there that can help me with the
</I>&gt;<i> task that you can think might help with the task?(assuming I am not a
</I>&gt;<i> c\c++ programmer)
</I>
I expect it shodul be workable to use a StoreID helper and some
request/reply_header_replace/add config options to set the Link headers
from a kv-pair note.

&gt;<i> 
</I>&gt;<i> Another pointer is that I do not have an option(from an outside
</I>&gt;<i> software) to run a lookup at the cache index for cached objects.
</I>
Not on the in-memory one, but store.log (and swap.state) should be
written to constantly with journal records of what is going on. So for a
proof of concept tailing those files that should be sufficient to
approximate the current memory state.


&gt;<i> The way things are now, when I am trying to access the object with a GET
</I>&gt;<i> request I can get a result which will tell me if the object is in the
</I>&gt;<i> cache using the headers but will force me\UA to fetch the object or ABORT.
</I>&gt;<i> If I would use the HEAD method to request an object I will get a
</I>&gt;<i> HIT\MISS but it will not be related at all to the GET object state since
</I>&gt;<i> it's another object.
</I>
The response to a HEAD request is supposed to be exactly identical to a
response to the GET, but with the body/payload/entity cropped off. Even
the Content-Length headers etc should be present saying what size the
body would have been.


&gt;<i> So, assuming I will need some http interface\API that will allow me to
</I>&gt;<i> run a query on squid index DB, will it make sense to write one?(If I
</I>&gt;<i> missed it and there is a way to do so already..)
</I>&gt;<i> 
</I>&gt;<i> I had some time in the past to learn this document:
</I>&gt;<i> <A HREF="https://cwiki.apache.org/confluence/display/TS/Metalink">https://cwiki.apache.org/confluence/display/TS/Metalink</A>
</I>&gt;<i> 
</I>&gt;<i> which actually describes one approach to the subject.
</I>

Amos

</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001735.html">[squid-dev] Digest related question.
</A></li>
	<LI>Next message: <A HREF="001737.html">[squid-dev] Digest related question.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1736">[ date ]</a>
              <a href="thread.html#1736">[ thread ]</a>
              <a href="subject.html#1736">[ subject ]</a>
              <a href="author.html#1736">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
