<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Moved PID file management from Coordinator to Master
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Moved%20PID%20file%20management%20from%20Coordinator%20to%20Master&In-Reply-To=%3C54BF9434.1010204%40users.sourceforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001299.html">
   <LINK REL="Next"  HREF="001301.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Moved PID file management from Coordinator to Master</H1>
    <B>Tsantilas Christos</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Moved%20PID%20file%20management%20from%20Coordinator%20to%20Master&In-Reply-To=%3C54BF9434.1010204%40users.sourceforge.net%3E"
       TITLE="[squid-dev] Moved PID file management from Coordinator to Master">chtsanti at users.sourceforge.net
       </A><BR>
    <I>Wed Jan 21 11:57:40 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001299.html">[squid-dev] Moved PID file management from Coordinator to Master
</A></li>
        <LI>Next message: <A HREF="001301.html">[squid-dev] Moved PID file management from Coordinator to Master
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1300">[ date ]</a>
              <a href="thread.html#1300">[ thread ]</a>
              <a href="subject.html#1300">[ subject ]</a>
              <a href="author.html#1300">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I am posting a new patch.

This patch include fixes to follow Squid Coding Style but also have a 
fix for a small bug:
  In the previous patches I posted the pid creation done by master 
process but the pid file was not removed by master process. This patch 
fixes master process to remove pid file on exit.




On 01/21/2015 12:17 PM, Amos Jeffries wrote:
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> On 21/01/2015 10:57 p.m., Tsantilas Christos wrote:
</I>&gt;&gt;<i> On 01/20/2015 02:55 AM, Alex Rousskov wrote:
</I>&gt;&gt;&gt;<i> On 01/16/2015 08:51 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;<i> On 16/01/2015 11:29 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> In SMP, there is only one Coordinator process, created by
</I>&gt;&gt;&gt;&gt;&gt;<i> the Master process.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> All SMP kids (Coordinator, workers, and diskers) are started
</I>&gt;&gt;&gt;&gt;&gt;<i> by the Master process. There are no multiple levels as far as
</I>&gt;&gt;&gt;&gt;&gt;<i> kid startup and waiting are concerned and, hence, there is no
</I>&gt;&gt;&gt;&gt;&gt;<i> &quot;level deeper than the master can see&quot;.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hmm, okay. Then I have no problem per-se to this change of
</I>&gt;&gt;&gt;&gt;<i> esponsibility.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Great, thank you.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I do still think the coordinator needs to remain active until
</I>&gt;&gt;&gt;&gt;<i> last out of the kids though, so they can still use it to
</I>&gt;&gt;&gt;&gt;<i> coordinate during their shutdowns. Having it be the first up
</I>&gt;&gt;&gt;&gt;<i> and last down would solve a few architectural problems where
</I>&gt;&gt;&gt;&gt;<i> kids need to to collaborate on things, like log rotations or
</I>&gt;&gt;&gt;&gt;<i> broadcasting their availability.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Agreed!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This patch does not prevent coordinator process exit before the
</I>&gt;&gt;<i> workers, but also current squid does not guarantees that the
</I>&gt;&gt;<i> coordinator will exit after workers. I agree that we need to
</I>&gt;&gt;<i> implement it, but looks that this is out of the scope of this
</I>&gt;&gt;<i> patch.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If there is not any objection I will apply this patch as is for
</I>&gt;&gt;<i> now.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Okay, lets give it a try.
</I>&gt;<i>
</I>&gt;<i> Can you please though make sure all the new functions use the Squid
</I>&gt;<i> coding style instead of the one you keep slipping in. Squid style is
</I>&gt;<i> this in .cc files:
</I>&gt;<i>
</I>&gt;<i>   type
</I>&gt;<i>   functionName(...)
</I>&gt;<i>   {
</I>&gt;<i>      ... code ...
</I>&gt;<i>   }
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i> Amos
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-5-move-PID-file-management-to-Master-t8.patch
Type: text/x-patch
Size: 40178 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150121/b9add6b3/attachment-0001.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150121/b9add6b3/attachment-0001.bin</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001299.html">[squid-dev] Moved PID file management from Coordinator to Master
</A></li>
	<LI>Next message: <A HREF="001301.html">[squid-dev] Moved PID file management from Coordinator to Master
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1300">[ date ]</a>
              <a href="thread.html#1300">[ thread ]</a>
              <a href="subject.html#1300">[ subject ]</a>
              <a href="author.html#1300">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
