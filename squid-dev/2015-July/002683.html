<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] received_encrypted ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20received_encrypted%20ACL&In-Reply-To=%3C55A95298.9020509%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002681.html">
   <LINK REL="Next"  HREF="002688.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] received_encrypted ACL</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20received_encrypted%20ACL&In-Reply-To=%3C55A95298.9020509%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] received_encrypted ACL">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jul 17 19:08:08 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002681.html">[squid-dev] [PATCH] received_encrypted ACL
</A></li>
        <LI>Next message: <A HREF="002688.html">[squid-dev] [PATCH] received_encrypted ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2683">[ date ]</a>
              <a href="thread.html#2683">[ thread ]</a>
              <a href="subject.html#2683">[ subject ]</a>
              <a href="author.html#2683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/17/2015 11:48 AM, Amos Jeffries wrote:
&gt;<i> On 18/07/2015 3:13 a.m., Tsantilas Christos wrote:
</I>&gt;&gt;<i> This patch adds received_encrypted ACL
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The new received_encrypted ACL matches transactions where all HTTP
</I>&gt;&gt;<i> messages were received over TLS or SSL transport connections, including
</I>&gt;&gt;<i> messages received from ICAP servers.
</I>
&gt;&gt;<i> Use case: Sending everything to Secure ICAP services increases
</I>&gt;&gt;<i> adaptation performance overhead. Folks want to send received_encrypted
</I>&gt;&gt;<i> transactions and only those transactions to Secure ICAP services.
</I>

&gt;<i> -1 on principle I object to making this ACL available for this use case.
</I>

I must have read this wrong. You are not trying to block a useful
feature simply because you dislike a specific use case, are you?

Given your comments below, it sounds like you misunderstood the use case
itself, but even if you were right about that use case, blocking a
feature based on a single use case seems a bit too harsh!


&gt;<i> And the (very) long answer:
</I>&gt;<i> 
</I>&gt;<i> This is conceptually very bad.
</I>
What exactly is &quot;this&quot; and why is it very bad?


&gt;<i> * <A HREF="https://">https://</A> scheme traffic is *supposed* to be kept secure no matter
</I>&gt;<i> what. Either they need to obey that requirement or they dont (due to
</I>&gt;<i> non-TLS security).
</I>&gt;<i> 
</I>&gt;<i> * <A HREF="http://">http://</A> and the other non-secure schemes are optional.
</I>
&gt;<i> Please do instead encourage using the request URI scheme (&quot;proto&quot; ACL)
</I>&gt;<i> to make that determination of whether ICAP security is desirable or not.
</I>
Looking at the request URI scheme does not work well: For example, the
URI scheme may be insecure &quot;<A HREF="http://">http://</A>&quot; but the message has been received
via a secure channel (e.g., https_port or SslBump).


&gt;<i> In other news; HTTP is growing this thing called &quot;opportunistc security&quot;
</I>&gt;<i> (aka. encryption). Where <A HREF="http://">http://</A> schemed requests will be arriving over
</I>&gt;<i> TLS, and maybe even going out via it and it traverses fully secure
</I>&gt;<i> components. HTTPbis WG are already finding problems with servers not
</I>&gt;<i> handling the schemes right in these conditions. Lets not add another
</I>&gt;<i> bunch of bad assumptions to the mix. Follow the scheme.
</I>
That seems like a counter-example to your own argument! The
received_encrypted ACL should match if an <A HREF="http://">http://</A> request arrived over
TLS, and Squid may be able to offer better &quot;security&quot; for that
transaction (e.g., by sending it to a Secure ICAP service or bypassing
ICAP completely).


&gt;<i> Also;
</I>&gt;<i> 1) we know about the directly connected security. But the connections
</I>&gt;<i> beyond that may be insecure. You note this yourself about eCAP. Same
</I>&gt;<i> goes for TLS connections!!
</I>
Not sure what you are implying by that. Yes, the admin only knows about
things under his or her control. How is that related to the proposed
ACL? In the ICAP context, the proposed ACL simply taints transactions
received from un-encrypted sources.

We could go further and add a &quot;this ICAP service taints messages&quot; flag
to [Secure] ICAP service configuration but there has not been any
requests for that feature so perhaps adding more flags would be premature.


&gt;<i> 2) Even when something is supposedly secure it can have wildly differing
</I>&gt;<i> degrees of security from other things. TLS itself has NULL-cipher with
</I>&gt;<i> zero security.
</I>
How is that related to the proposed ACL? Are you implying that
&quot;received_encrypted&quot; is the wrong name because NULL-ciphers exist? I
hope you would not vote -1 simply because you do not like the name, but
better names are welcomed, of course.


&gt;<i> 3) non-TLS forms of connection security exist (IPSEC, VPN, stunnel, etc)
</I>&gt;<i> and may be used today without Squid knowledge.
</I>
And the admin can add rules to handle that traffic specially. The
proposed ACL helps the admin in cases where Squid does know that the
traffic was received over an encrypted channel.


&gt;<i> So any determination of &quot;security&quot; based on existence or lack of TLS or
</I>&gt;<i> other assumed properties is false information. We can't be sure about
</I>&gt;<i> other components real security, and it should not matter to the
</I>&gt;<i> component (ICAP service) making its decision.
</I>
The proposed ACL does not determine what is &quot;secure&quot;. It only determines
what was received via SSL/TLS channels, which for the lack of a better
word, we called &quot;encrypted&quot;. Better names are welcomed, but would not
change what the ACL does.


&gt;<i> On the third hand (:-P), whats wrong with using a transaction annotation
</I>&gt;<i> in the HttpRequest set by insecure components if they are passed an
</I>&gt;<i> <A HREF="https://">https://</A> request?
</I>
The annotation (effectively provided by the proposed ACL) needs to be
set _before_ any [insecure] components see the message. The annotation
may be used to decide whether those components will _see_ the message in
the first place!


In summary, I think you misunderstood the problem the ACL is trying to
solve and have not suggested any viable alternative solutions. I hope my
response clarified things enough for you to re-consider your -1 vote.


Thank you,

Alex.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002681.html">[squid-dev] [PATCH] received_encrypted ACL
</A></li>
	<LI>Next message: <A HREF="002688.html">[squid-dev] [PATCH] received_encrypted ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2683">[ date ]</a>
              <a href="thread.html#2683">[ thread ]</a>
              <a href="subject.html#2683">[ subject ]</a>
              <a href="author.html#2683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
