<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] suffix parsing and skipping
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B0F24C.9040202%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002831.html">
   <LINK REL="Next"  HREF="002835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] suffix parsing and skipping</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B0F24C.9040202%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] suffix parsing and skipping">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Jul 23 13:55:24 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002831.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
        <LI>Next message: <A HREF="002835.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2833">[ date ]</a>
              <a href="thread.html#2833">[ thread ]</a>
              <a href="subject.html#2833">[ subject ]</a>
              <a href="author.html#2833">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/23/2015 01:46 AM, Kinkie wrote:

&gt;<i> the only thing I don't understand is the XXX in
</I>&gt;<i> parsedSize(); it's not clear why the comment, 
</I>
The parsedSize() method is broken: It claims to return the number of
bytes parsed, but it does not return that. It usually returns the number
of bytes parsed from the left, but not from the right of the string. For
example,

  skipOne()
  skipOneTrailing()

should usually result in parsedSize() returning 2 because 2 bytes were
parsed and removed from the string. It usually returns 1.


&gt;<i> and what to use instead.
</I>
There is currently no good alternative. Discussing the best way forward
is outside this project scope (but I welcome such a separate discussion,
of course). Fortunately, no existing code misuses parsedSize() today AFAIK.


&gt;<i> as soon as that's improved, +1.
</I>
Why?! This is not something the patch breaks. Do you want me to remove
the XXX and just pretend that we have not discovered the problem?


Hope this clarifies,

Alex.



&gt;<i> On Thu, Jul 23, 2015 at 12:41 AM, Alex Rousskov
</I>&gt;<i> &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Hello,
</I>&gt;<i> 
</I>&gt;<i>         The attached patch adds SBuf and Tokenizer methods to simplify
</I>&gt;<i>     suffix parsing and skipping (and to make suffix/reverse APIs more
</I>&gt;<i>     similar to prefix/forward ones). The new methods are used in another
</I>&gt;<i>     patch (to be posted shortly) that makes the request line parser simpler
</I>&gt;<i>     and more robust, but they are useful in other contexts as well IMO.
</I>&gt;<i> 
</I>&gt;<i>     For consistency sake, I tried to mimic the existing Tokenizer/SBuf
</I>&gt;<i>     documentation, debugging, and code duplication styles.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     One old problem was detected and documented during this project: The
</I>&gt;<i>     Tokenizer::parsedSize() method does not account for the successfully
</I>&gt;<i>     parsed and removed suffix/trailing characters in most cases. That method
</I>&gt;<i>     should be revised or removed. Solving this problem is outside this
</I>&gt;<i>     project scope.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     This and the following patch are based on trunk r14083. I will update to
</I>&gt;<i>     the current trunk if the patches are approved. Please let me know if you
</I>&gt;<i>     want to review the updated versions as well.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     HTH,
</I>&gt;<i> 
</I>&gt;<i>     Alex.
</I>&gt;<i> 
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     squid-dev mailing list
</I>&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A> &lt;mailto:<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i>     Francesco
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002831.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
	<LI>Next message: <A HREF="002835.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2833">[ date ]</a>
              <a href="thread.html#2833">[ thread ]</a>
              <a href="subject.html#2833">[ subject ]</a>
              <a href="author.html#2833">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
