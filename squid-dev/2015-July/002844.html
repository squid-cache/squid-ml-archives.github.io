<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] suffix parsing and skipping
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B1C03B.8000006%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002848.html">
   <LINK REL="Next"  HREF="002837.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] suffix parsing and skipping</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B1C03B.8000006%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] suffix parsing and skipping">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jul 24 04:34:03 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002848.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
        <LI>Next message: <A HREF="002837.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2844">[ date ]</a>
              <a href="thread.html#2844">[ thread ]</a>
              <a href="subject.html#2844">[ subject ]</a>
              <a href="author.html#2844">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/23/2015 10:45 AM, Kinkie wrote:
&gt;<i> On Thu, Jul 23, 2015 at 3:55 PM, Alex Rousskov wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 07/23/2015 01:46 AM, Kinkie wrote:
</I>&gt;<i> 
</I>&gt;<i>     &gt; the only thing I don't understand is the XXX in
</I>&gt;<i>     &gt; parsedSize(); it's not clear why the comment,
</I>&gt;<i> 
</I>&gt;<i>     The parsedSize() method is broken: It claims to return the number of
</I>&gt;<i>     bytes parsed, but it does not return that. It usually returns the number
</I>&gt;<i>     of bytes parsed from the left, but not from the right of the string. For
</I>&gt;<i>     example,
</I>&gt;<i> 
</I>&gt;<i>       skipOne()
</I>&gt;<i>       skipOneTrailing()
</I>&gt;<i> 
</I>&gt;<i>     should usually result in parsedSize() returning 2 because 2 bytes were
</I>&gt;<i>     parsed and removed from the string. It usually returns 1.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt; and what to use instead.
</I>&gt;<i> 
</I>&gt;<i>     There is currently no good alternative. Discussing the best way forward
</I>&gt;<i>     is outside this project scope (but I welcome such a separate discussion,
</I>&gt;<i>     of course). Fortunately, no existing code misuses parsedSize() today
</I>&gt;<i>     AFAIK.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt; as soon as that's improved, +1.
</I>&gt;<i> 
</I>&gt;<i>     Why?! This is not something the patch breaks. Do you want me to remove
</I>&gt;<i>     the XXX and just pretend that we have not discovered the problem?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I'll try to clarify what I meant:
</I>&gt;<i> because the comment is issuing guidance to callers of that API: as
</I>&gt;<i> proposed, the guidance is incomplete both for any callers trying to
</I>&gt;<i> understand what API to use.
</I>
The patch says &quot;XXX: avoid when parsing suffixes/trailing bytes&quot;. That
is as complete instruction as a short comment can deliver IMO. There is
no better API today. A curious or confused reader can always get more
information from the commit message that added the XXX (which is also
provided in the posted patch).

Again, parsed size tracking is not something this patch broke. I just
noticed an old problem and marked it.


&gt;<i> If anything, there should be a BUG mark so that implementors may fix it.
</I>
Which is what &quot;XXX&quot; is IMO -- a marking of a bug.


I will just remove that XXX comment from the patch. It is outside the
patch scope. Feel free to add a better XXX, BUG, or whatever comment, of
course.


Thank you,

Alex.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002848.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
	<LI>Next message: <A HREF="002837.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2844">[ date ]</a>
              <a href="thread.html#2844">[ thread ]</a>
              <a href="subject.html#2844">[ subject ]</a>
              <a href="author.html#2844">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
