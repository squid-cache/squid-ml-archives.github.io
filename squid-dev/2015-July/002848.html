<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] suffix parsing and skipping
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B22329.40708%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002845.html">
   <LINK REL="Next"  HREF="002844.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] suffix parsing and skipping</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20suffix%20parsing%20and%20skipping&In-Reply-To=%3C55B22329.40708%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] suffix parsing and skipping">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jul 24 11:36:09 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002845.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
        <LI>Next message: <A HREF="002844.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2848">[ date ]</a>
              <a href="thread.html#2848">[ thread ]</a>
              <a href="subject.html#2848">[ subject ]</a>
              <a href="author.html#2848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/07/2015 4:41 p.m., Alex Rousskov wrote:
&gt;<i> On 07/23/2015 11:11 AM, Amos Jeffries wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Particular since the full fix is a one-liner in consumeTrailing() in
</I>&gt;&gt;<i> place of that comment, and currently affecting no other code that would
</I>&gt;&gt;<i> need auditing.
</I>&gt;&gt;<i> That one-liner being identical to the matching code in consume():
</I>&gt;&gt;<i>     parsed_ += result.length();
</I>&gt;<i> 
</I>&gt;<i> I doubt this is the right fix because some of the callers that will use
</I>&gt;<i> parsedSize() may only care about the consumed prefix bytes. However, I
</I>&gt;<i> will include this fix in the patch to avoid further discussion.
</I>&gt;<i> 
</I>
I think it is. For several reason which we can now ignore;

* The member and method are documented as just &quot;parsed size&quot;. No
specific direction implied.

* the callers making use of parsedSize() today are exclusively using
forward-Tokenizers. So the broken behaviour on suffix is not affecting
them either way.

* if we ever get a mixed-direction Tokenizer that caller will need to
cope and it seem better that the behaviour be consistent for each
direction, right now its all over the place for suffix handling
(sometimes accounted, sometimes not).

* the exclusively reverse-Tokenizers might one day want to use
parsedSize() for something, but can't in its current state. For example
perhapse using parsedSize() to account how many garbage delimiters have
been pruned off the found line between Http-Version and URI. This
matters when traffic counting read I/O bytes vs size of the message SBuf
Parser outputs.

Amos

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002845.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
	<LI>Next message: <A HREF="002844.html">[squid-dev] [PATCH] suffix parsing and skipping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2848">[ date ]</a>
              <a href="thread.html#2848">[ thread ]</a>
              <a href="subject.html#2848">[ subject ]</a>
              <a href="author.html#2848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
