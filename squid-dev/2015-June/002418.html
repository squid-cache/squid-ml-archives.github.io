<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] TLS peek by default
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20TLS%20peek%20by%20default&In-Reply-To=%3C557A65A9.6040105%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002413.html">
   <LINK REL="Next"  HREF="002414.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] TLS peek by default</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20TLS%20peek%20by%20default&In-Reply-To=%3C557A65A9.6040105%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] TLS peek by default">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jun 12 04:52:57 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002413.html">[squid-dev] [RFC] TLS peek by default
</A></li>
        <LI>Next message: <A HREF="002414.html">[squid-dev] [PATCH] Add chained certificates and signing certificate to bumpAndSpliced connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2418">[ date ]</a>
              <a href="thread.html#2418">[ thread ]</a>
              <a href="subject.html#2418">[ subject ]</a>
              <a href="author.html#2418">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/05/2015 04:47 PM, Amos Jeffries wrote:

&gt;<i> Along these lines, I am wondering why we need to have &quot;ssl_bump peek&quot;
</I>&gt;<i> checked for in relation to client peeking. Can we make Squid simply do
</I>&gt;<i> that first 'peek' step always for all potential HTTPS connections ?
</I>

IIRC, the reasons we did not want to peek by default included:

1. Worries about non-SSL protocols that expect the server to talk first.
If we require Squid to always peek, the transaction will get stuck. We
will need to add timeouts and such, further complicating the code and
configuration. The server-talks-first protocols are real, especially in
interception setups.

2. Worries about buggy code (ours, OpenSSL, and the combination of the
two) breaking stuff for folks that do not need to peek at all. In
retrospect, these worries were well founded -- IIRC, there were quite a
few problems with peeking at certain traffic that could be temporary
worked around by disabling peeking using ACLs.

Christos, did I forget any other reasons?


&gt;<i> This would also give SNI and the like up front and make Squid able to
</I>&gt;<i> act lot more like what people in squid-users seem to be starting off
</I>&gt;<i> assuming it does.
</I>
True. I think we could change how Squid does this, but I doubt simply
hard-coding peeking is a good idea for the reasons mentioned above. A
more flexible/elegant solution is probably needed (which may not exist
at all or may be more complex than your PROXY-specific project wants to
deal with).


HTH,

Alex.

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002413.html">[squid-dev] [RFC] TLS peek by default
</A></li>
	<LI>Next message: <A HREF="002414.html">[squid-dev] [PATCH] Add chained certificates and signing certificate to bumpAndSpliced connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2418">[ date ]</a>
              <a href="thread.html#2418">[ thread ]</a>
              <a href="subject.html#2418">[ subject ]</a>
              <a href="author.html#2418">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
