<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Temporary fix to restore compatibility with	Amazon
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Temporary%20fix%20to%20restore%20compatibility%20with%0A%09Amazon&In-Reply-To=%3C558A466E.1060303%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002442.html">
   <LINK REL="Next"  HREF="002444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Temporary fix to restore compatibility with	Amazon</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Temporary%20fix%20to%20restore%20compatibility%20with%0A%09Amazon&In-Reply-To=%3C558A466E.1060303%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Temporary fix to restore compatibility with	Amazon">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Jun 24 05:55:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002442.html">[squid-dev] [PATCH] Avoid SSL certificate db corruption with empty index.txt as a symptom.
</A></li>
        <LI>Next message: <A HREF="002444.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2443">[ date ]</a>
              <a href="thread.html#2443">[ thread ]</a>
              <a href="subject.html#2443">[ subject ]</a>
              <a href="author.html#2443">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

    This temporary trunk fix adds support for request URIs containing
'|' characters. Such URIs are used by popular Amazon product (and
probably other) sites: /images/I/ID1._RC|ID2.js,ID3.js,ID4.js_.js

Without this fix, all requests for affected URIs timeout while Squid
waits for the end of request headers it has already received(*).


The proper long-term fix is to allow any character in URI as long as we
can reliably parse the request line (and, later, URI components). There
is no point in hurting users by rejecting requests while slowly
accumulating the list of benign characters used by web sites but
prohibited by some RFC.


HTH,

Alex.
P.S. (*) which is probably another parsing regression bug (not addressed
by this temporary patch or the long-term fix discussed above), but I
have not tested whether the very latest trunk still suffers from this
other bug.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: amazon-urls-t0.patch
Type: text/x-diff
Size: 2438 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150623/5ad419a0/attachment.patch">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150623/5ad419a0/attachment.patch</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002442.html">[squid-dev] [PATCH] Avoid SSL certificate db corruption with empty index.txt as a symptom.
</A></li>
	<LI>Next message: <A HREF="002444.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2443">[ date ]</a>
              <a href="thread.html#2443">[ thread ]</a>
              <a href="subject.html#2443">[ subject ]</a>
              <a href="author.html#2443">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
