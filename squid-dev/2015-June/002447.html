<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Temporary%20fix%20to%20restore%20compatibility%20with%0A%20Amazon&In-Reply-To=%3C558B2367.5010806%40urlfilterdb.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002446.html">
   <LINK REL="Next"  HREF="002454.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon</H1>
    <B>Marcus Kool</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Temporary%20fix%20to%20restore%20compatibility%20with%0A%20Amazon&In-Reply-To=%3C558B2367.5010806%40urlfilterdb.com%3E"
       TITLE="[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon">marcus.kool at urlfilterdb.com
       </A><BR>
    <I>Wed Jun 24 21:38:47 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002446.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with	Amazon
</A></li>
        <LI>Next message: <A HREF="002454.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2447">[ date ]</a>
              <a href="thread.html#2447">[ thread ]</a>
              <a href="subject.html#2447">[ subject ]</a>
              <a href="author.html#2447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 06/24/2015 05:24 PM, Kinkie wrote:
&gt;<i> My 2c: I vote for reality; possibly with a shaming announce message; I
</I>&gt;<i> wouldn't even recommend logging the violation: there is nothing the
</I>&gt;<i> average admin can do about it. I would consider adding a shaming
</I>&gt;<i> comment in the release notes.
</I>
more cents:

correct.

A standard can be considered a strong guideline but if important sites
violate the standard (i.e. users/admins complain) then Squid
should be able to cope with it or it risks getting abandoned because
Squid cannot cope with traffic of sites that otherwise work without Squid.

For an admin it is irrelevant if the problem is caused by Squid or by
a website.  And the admin who dares to say to its users &quot;only visit
sites that comply with the standards&quot; probably gets fired.


&gt;<i> On Wed, Jun 24, 2015 at 10:12 PM, Alex Rousskov
</I>&gt;<i> &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;&gt;<i> On 06/24/2015 05:26 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 24/06/2015 5:55 p.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i>      This temporary trunk fix adds support for request URIs containing
</I>&gt;&gt;&gt;&gt;<i> '|' characters. Such URIs are used by popular Amazon product (and
</I>&gt;&gt;&gt;&gt;<i> probably other) sites: /images/I/ID1._RC|ID2.js,ID3.js,ID4.js_.js
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Without this fix, all requests for affected URIs timeout while Squid
</I>&gt;&gt;&gt;&gt;<i> waits for the end of request headers it has already received(*).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This is not right. Squid should be identifying the message as
</I>&gt;&gt;&gt;<i> non-HTTP/1.x (which it isn't due to the URI syntax violation) and
</I>&gt;&gt;&gt;<i> treating it as such.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I agree that Amazon violates URI syntax. On the other hand, the message
</I>&gt;&gt;<i> can be interpreted as HTTP/1.x for all practical purposes AFAICT. If you
</I>&gt;&gt;<i> want to implement a different fix, please do so. Meanwhile, folks
</I>&gt;&gt;<i> suffering from this serious regression can try the temporary fix I posted.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The proper long-term fix is to allow any character in URI as long as we
</I>&gt;&gt;&gt;&gt;<i> can reliably parse the request line (and, later, URI components). There
</I>&gt;&gt;&gt;&gt;<i> is no point in hurting users by rejecting requests while slowly
</I>&gt;&gt;&gt;&gt;<i> accumulating the list of benign characters used by web sites but
</I>&gt;&gt;&gt;&gt;<i> prohibited by some RFC.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The *proper* long term fix is to obey the standards in regard to message
</I>&gt;&gt;&gt;<i> syntax so applications stop using these invalid (when un-encoded)
</I>&gt;&gt;&gt;<i> characters and claiming HTTP/1.1 support.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We had &quot;standards vs reality&quot; and &quot;policing traffic&quot; discussions several
</I>&gt;&gt;<i> times in the past, with no signs of convergence towards a single
</I>&gt;&gt;<i> approach, so I am not going to revisit that discussion now. We continue
</I>&gt;&gt;<i> to disagree [while Squid users continue to suffer].
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-dev mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002446.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with	Amazon
</A></li>
	<LI>Next message: <A HREF="002454.html">[squid-dev] [PATCH] Temporary fix to restore compatibility with Amazon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2447">[ date ]</a>
              <a href="thread.html#2447">[ thread ]</a>
              <a href="subject.html#2447">[ subject ]</a>
              <a href="author.html#2447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
