<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] splicing resumed sessions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20splicing%20resumed%20sessions&In-Reply-To=%3C5508629D.7050303%40users.sourceforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001978.html">
   <LINK REL="Next"  HREF="001965.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] splicing resumed sessions</H1>
    <B>Tsantilas Christos</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20splicing%20resumed%20sessions&In-Reply-To=%3C5508629D.7050303%40users.sourceforge.net%3E"
       TITLE="[squid-dev] [PATCH] splicing resumed sessions">chtsanti at users.sourceforge.net
       </A><BR>
    <I>Tue Mar 17 17:21:33 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001978.html">[squid-dev] Build failed in Jenkins: trunk-matrix » clang,j-fbsd-93 #146
</A></li>
        <LI>Next message: <A HREF="001965.html">[squid-dev] [PATCH] splicing resumed sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1903">[ date ]</a>
              <a href="thread.html#1903">[ thread ]</a>
              <a href="subject.html#1903">[ subject ]</a>
              <a href="author.html#1903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This patch adds the &quot;ssl_bump_resuming_sessions&quot; directive that controls
SslBump behavior when dealing with &quot;resuming SSL/TLS sessions&quot;. Without 
these changes, SslBump usually terminates all resuming sessions with an 
error because such sessions do not include server certificates, 
preventing Squid from successfully validating the server identity.

After these changes, Squid either terminates or splices resuming 
sessions, depending on configuration. Splicing is the right default 
because Squid most likely has spliced the original connections that the 
client and server are trying to resume now.  Most likely, the splicing 
decision would not change now (but the lack of the server certificate 
information means we cannot repeat the original ACL checks and need a 
special directive to tell Squid what to do). Also, without SslBump, 
session resumption would just work, and SslBump default should approach 
that ideal.

In many deployment scenarios, this straightforward &quot;splice or terminate
resuming sessions&quot; implementation is exactly what the admin wants. 
Future projects may add more complex algorithms, including maintaining 
an SMP-shared cache of sessions that may be resumed in the future and 
evaluating client/server attempts to resume a session using that cache.


Example:
   # splice all resuming sessions [this is the default]
   ssl_bump_resuming_sessions allow all

This patch also makes SSL client Hello message parsing more robust and
adds an SSL server Hello message parser.

This patch also prevents occasional segfaults when dealing with SSL
cache_peer negotiation failures.

The last two changes should applied to squid-3.5 even if this patch will 
not go into squid-3.5.

Regards,
    Christos
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-14-splicing-resumed-sessions-t6.patch
Type: text/x-patch
Size: 47098 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150317/e5a8287b/attachment-0001.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20150317/e5a8287b/attachment-0001.bin</A>&gt;
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001978.html">[squid-dev] Build failed in Jenkins: trunk-matrix » clang,j-fbsd-93 #146
</A></li>
	<LI>Next message: <A HREF="001965.html">[squid-dev] [PATCH] splicing resumed sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1903">[ date ]</a>
              <a href="thread.html#1903">[ thread ]</a>
              <a href="subject.html#1903">[ subject ]</a>
              <a href="author.html#1903">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
