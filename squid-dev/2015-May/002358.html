<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Removal of xstrerror?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Removal%20of%20xstrerror%3F&In-Reply-To=%3C555A2B8C.8040805%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="002326.html">
   <LINK REL="Next"  HREF="002327.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Removal of xstrerror?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Removal%20of%20xstrerror%3F&In-Reply-To=%3C555A2B8C.8040805%40measurement-factory.com%3E"
       TITLE="[squid-dev] Removal of xstrerror?">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon May 18 18:12:28 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002326.html">[squid-dev] Removal of xstrerror?
</A></li>
        <LI>Next message: <A HREF="002327.html">[squid-dev] Jenkins build is back to normal : trunk-matrix » clang,j-fbsd-93 #201
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2358">[ date ]</a>
              <a href="thread.html#2358">[ thread ]</a>
              <a href="subject.html#2358">[ subject ]</a>
              <a href="author.html#2358">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/12/2015 04:11 PM, Amos Jeffries wrote:
&gt;<i> On 13/05/2015 7:30 a.m., Alex Dowad wrote:
</I>
&gt;&gt;<i> I'm just questioning whether removing xstrerror is really desirable
</I>&gt;&gt;<i> in cases where it is called without any intervening library
</I>&gt;&gt;<i> function call which could overwrite errno. Amos, are you sure
</I>&gt;&gt;<i> that's what you want to do?
</I>

&gt;<i> I am. It's just a macro in compat/ representing &quot;xstrerr(errno)&quot; and as
</I>&gt;<i> you and others have been finding its used incorrectly often enough to
</I>&gt;<i> cause problems.
</I>

I agree with Amos. There are no known good reasons for that macro to
exist, and we know it has been misused.

As for predicting when errno value is preserved, doing so correctly is
nearly impossible in many cases because of C++ operators and other
implicit calls that may trigger I/O (debugging) and/or memory allocation
system calls. Any code that does not save the errno value immediately
after the system call but uses it &quot;later&quot; should be rewritten.


Cheers,

Alex.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002326.html">[squid-dev] Removal of xstrerror?
</A></li>
	<LI>Next message: <A HREF="002327.html">[squid-dev] Jenkins build is back to normal : trunk-matrix » clang,j-fbsd-93 #201
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2358">[ date ]</a>
              <a href="thread.html#2358">[ thread ]</a>
              <a href="subject.html#2358">[ subject ]</a>
              <a href="author.html#2358">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
