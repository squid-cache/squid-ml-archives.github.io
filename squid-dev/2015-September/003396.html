<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Moving%20from%20Bump-Server-First%20to%20Bump/Peek/Splice&In-Reply-To=%3C55F7EEBB.70105%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="003371.html">
   <LINK REL="Next"  HREF="003397.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Moving%20from%20Bump-Server-First%20to%20Bump/Peek/Splice&In-Reply-To=%3C55F7EEBB.70105%40treenet.co.nz%3E"
       TITLE="[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Sep 15 10:11:07 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="003371.html">[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice
</A></li>
        <LI>Next message: <A HREF="003397.html">[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3396">[ date ]</a>
              <a href="thread.html#3396">[ thread ]</a>
              <a href="subject.html#3396">[ subject ]</a>
              <a href="author.html#3396">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/09/2015 6:23 a.m., Alex Rousskov wrote:
&gt;<i> On 09/14/2015 10:53 AM, Steve Hill wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> If you peek at step 1 and bump at step 2, everything works correctly -
</I>&gt;&gt;<i> the CN, SAN, etc. from the original server certificate is copied into
</I>&gt;&gt;<i> the forged certificate as expected
</I>&gt;<i> 
</I>&gt;<i> OK, that matches <A HREF="http://wiki.squid-cache.org/Features/SslPeekAndSplice">http://wiki.squid-cache.org/Features/SslPeekAndSplice</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> If you bump at step 1, the forged certificate's CN is whatever
</I>&gt;&gt;<i> hostname/IP was given in the CONNECT request.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> That may not match the above documentation. We claim that &quot;bump&quot;
</I>&gt;<i> establishes &quot;a secure connection with the server and, using a mimicked
</I>&gt;<i> server certificate, with the client&quot;. I would expect the origin server
</I>&gt;<i> CN in the forged certificate then. We should change the documentation if
</I>&gt;<i> bumping at step #1 does (and should do) something else. Another bug
</I>&gt;<i> report to file?
</I>&gt;<i> 
</I>
Only if the origin server is responding with some other CN values than
is in the mimic'd certificate.

In this case Squid is supposed to be connecting to the CONNECT hostname
(as SNI) or raw-IP (with no SNI). If the server is echoing that back in
its cert somehow then of course that would be mimic'd regardless of what
any un-peeked client SNI says.

Amos

</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003371.html">[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice
</A></li>
	<LI>Next message: <A HREF="003397.html">[squid-dev] Moving from Bump-Server-First to Bump/Peek/Splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3396">[ date ]</a>
              <a href="thread.html#3396">[ thread ]</a>
              <a href="subject.html#3396">[ subject ]</a>
              <a href="author.html#3396">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
