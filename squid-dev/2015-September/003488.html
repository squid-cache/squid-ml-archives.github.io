<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20convert%20digest_nonce_h%20to%20MEMPROXY_CLASS&In-Reply-To=%3C5607CA4E.3000800%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="003486.html">
   <LINK REL="Next"  HREF="003490.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20convert%20digest_nonce_h%20to%20MEMPROXY_CLASS&In-Reply-To=%3C5607CA4E.3000800%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Sep 27 10:51:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="003486.html">[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS
</A></li>
        <LI>Next message: <A HREF="003490.html">[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3488">[ date ]</a>
              <a href="thread.html#3488">[ thread ]</a>
              <a href="subject.html#3488">[ subject ]</a>
              <a href="author.html#3488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/09/2015 10:30 p.m., Kinkie wrote:
&gt;<i> .. and remove one XXX in the process.
</I>&gt;<i> Not much to add besides the subject.
</I>&gt;<i> 
</I>&gt;<i> build- and lightly run-tested, seems to be ok.
</I>&gt;<i> Big-context patch attached.
</I>&gt;<i> 
</I>
Two big problems stand right out.

* The static random and distribution objects were specificaly internal
to a function in order so that they got initialized on first use, but
did not get initialized if never used.

That is somewhat important to a) save the machine available entropy bits
for other useswhen Digest is not configured, and b) decrease the
probability that the workers initialize them within the same second -
they only get initialized on first traffic request handled, not during
the startup second. And so the seeding can survive fork()'ing.


* the contents of authenticateDigestNonceNew() should be in the nonce
object ctor, or at least a method called by it.

* the contents of authenticateDigestNonceDelete() should be the nonce
objects dtor.


Amos

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003486.html">[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS
</A></li>
	<LI>Next message: <A HREF="003490.html">[squid-dev] [PATCH] convert digest_nonce_h to MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3488">[ date ]</a>
              <a href="thread.html#3488">[ thread ]</a>
              <a href="subject.html#3488">[ subject ]</a>
              <a href="author.html#3488">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
