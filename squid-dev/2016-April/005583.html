<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Remove ServerOptions &quot;partial copy&quot; copy constructor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Remove%20ServerOptions%20%22partial%20copy%22%20copy%0A%20constructor&In-Reply-To=%3C570BD2F3.2030503%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="005577.html">
   <LINK REL="Next"  HREF="005554.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Remove ServerOptions &quot;partial copy&quot; copy constructor</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Remove%20ServerOptions%20%22partial%20copy%22%20copy%0A%20constructor&In-Reply-To=%3C570BD2F3.2030503%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Remove ServerOptions &quot;partial copy&quot; copy constructor">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Apr 11 16:38:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="005577.html">[squid-dev] [PATCH] Remove ServerOptions &quot;partial copy&quot; copy constructor
</A></li>
        <LI>Next message: <A HREF="005554.html">[squid-dev] [PATCH] Replace new/delete operators using modern C++	rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5583">[ date ]</a>
              <a href="thread.html#5583">[ thread ]</a>
              <a href="subject.html#5583">[ subject ]</a>
              <a href="author.html#5583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/09/2016 11:03 PM, Amos Jeffries wrote:
&gt;<i> On 8/04/2016 2:57 a.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> On 04/07/2016 03:22 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> On 7/04/2016 6:10 p.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i>     The attached patch removes broken and, AFAICT, unused &quot;partial copy&quot;
</I>&gt;&gt;&gt;&gt;<i> ServerOptions copy constructor.
</I>

&gt;&gt;&gt;<i> A (full) copy-constructor is needed on some systems for the clear()
</I>&gt;&gt;&gt;<i> method implementation to build.
</I>

&gt;&gt;<i> AFAICT, the clear() method needs an assignment operator rather than a
</I>&gt;&gt;<i> copy constructor.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there something wrong with the full copy constructor generated by
</I>&gt;&gt;<i> default?
</I>

&gt;<i> IIRC there the default was none (implicit =delete) but some of the
</I>&gt;<i> operators from AnyP::CfgPort try to make use of it.
</I>
In the current code, the &quot;default&quot; copy constructor for ServerOptions
would be not none/=delete, but a member-wise copy. Same for the
assignment operator. Perhaps the code has changed since when the
opposite was true.


&gt;<i> I dont recall which system or compiler version specifically sorry. But
</I>&gt;<i> CfgPort should only have copy-construct actions done on it for
</I>&gt;<i> split-stack OS such as OpenBSD. So maybe it only shows up there.
</I>
FWIW, the patch does not really remove a constructor so it should not
affect compilation. It just lets the compiler generate the [correct]
version of that constructor. My concern was that perhaps the
staticContext member was manually excluded from being copied on purpose
rather than by accident. The patched code copies all ServerOptions
members, including staticContext, and that is the change I am worried about.


&gt;<i> IIRC it was originally found in the BuildFarm testing so if this patch
</I>&gt;<i> passes the current BuildFarm matrix it can go in. And/or just apply and
</I>&gt;<i> add a proper ctor later if needed.
</I>

&gt;<i> (I'll tentatively +1 this as-is if you want to do the latter).
</I>
Committed to trunk (r14637). If I notice any related build failures, I
will try to address them.


Thank you,

Alex.

</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005577.html">[squid-dev] [PATCH] Remove ServerOptions &quot;partial copy&quot; copy constructor
</A></li>
	<LI>Next message: <A HREF="005554.html">[squid-dev] [PATCH] Replace new/delete operators using modern C++	rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5583">[ date ]</a>
              <a href="thread.html#5583">[ thread ]</a>
              <a href="subject.html#5583">[ subject ]</a>
              <a href="author.html#5583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
