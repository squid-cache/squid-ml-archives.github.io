<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Make Squid death due to overloaded helpers optional
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Make%20Squid%20death%20due%20to%20overloaded%20helpers%0A%20optional&In-Reply-To=%3C0b29a1fb-393e-d5cc-7b08-bdf5d94e7809%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006561.html">
   <LINK REL="Next"  HREF="006580.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Make%20Squid%20death%20due%20to%20overloaded%20helpers%0A%20optional&In-Reply-To=%3C0b29a1fb-393e-d5cc-7b08-bdf5d94e7809%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Aug 10 16:03:28 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006561.html">[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional
</A></li>
        <LI>Next message: <A HREF="006580.html">[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6578">[ date ]</a>
              <a href="thread.html#6578">[ thread ]</a>
              <a href="subject.html#6578">[ subject ]</a>
              <a href="author.html#6578">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/09/2016 06:19 PM, Henrik Nordstr√∂m wrote:
&gt;<i> tis 2016-08-09 klockan 11:47 -0600 skrev Alex Rousskov:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yep, that matches both my understanding and motivation to return ERR
</I>&gt;&gt;<i> in the explicitly configured on-persistent-overload=err case.
</I>
&gt;<i> I'd say make it configurable.
</I>&gt;<i> 
</I>&gt;<i> on-persistent-overload=abort/err/ok/unknown
</I>&gt;<i> 
</I>&gt;<i> to represent all three possible states.
</I>
Agreed (as a TODO for somebody who has a corresponding use case). We are
laying the framework for that future enhancement, but should not be
forced to implement it, especially because returning OK responses will
probably require more configuration and perhaps even helper-specific code.


&gt;<i> But that is based on the assumption that unknown is &quot;outcome is not
</I>&gt;<i> known&quot; and that Squid then skips the access rule and looks at next
</I>&gt;<i> rule. Have not looked in detail in how current Squid operated with
</I>&gt;<i> these conditions.
</I>
The uncertainty about &quot;unknown&quot; is one more reason to leave enabling
that as a TODO for those with a use case.


&gt;<i> Starting with only abort/err is good. err should then map to the same
</I>&gt;<i> as a negative helper response which is the most clear buldingblock to
</I>&gt;<i> work with then bulding access lists.
</I>&gt;<i> 
</I>&gt;<i> It does not make sense that err in this context should map to different
</I>&gt;<i> logics depending on the directive.
</I>
Agreed, and the take #10 implementation posted earlier appears to
implement the &quot;err&quot; case correctly AFAICT.

As Amos has noted, we do need to restore the old &quot;unknown&quot; behavior when
the helper is _missing_ (and not overloaded), but that is a completely
different problem with a simple solution: SubmissionFailure() should use
Helper::Unknown when its hlp parameter is nil and Helper::Error.


Cheers,

Alex.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006561.html">[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional
</A></li>
	<LI>Next message: <A HREF="006580.html">[squid-dev] [PATCH] Make Squid death due to overloaded helpers optional
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6578">[ date ]</a>
              <a href="thread.html#6578">[ thread ]</a>
              <a href="subject.html#6578">[ subject ]</a>
              <a href="author.html#6578">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
