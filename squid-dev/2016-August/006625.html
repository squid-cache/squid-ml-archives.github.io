<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] SSL CN wildcard must only match a single domain component [fragment]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20SSL%20CN%20wildcard%20must%20only%20match%20a%20single%20domain%0A%20component%20%5Bfragment%5D&In-Reply-To=%3C75c95e37-da88-b58b-7d26-a1e2bc9f2233%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006644.html">
   <LINK REL="Next"  HREF="006637.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] SSL CN wildcard must only match a single domain component [fragment]</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20SSL%20CN%20wildcard%20must%20only%20match%20a%20single%20domain%0A%20component%20%5Bfragment%5D&In-Reply-To=%3C75c95e37-da88-b58b-7d26-a1e2bc9f2233%40chtsanti.net%3E"
       TITLE="[squid-dev] [PATCH] SSL CN wildcard must only match a single domain component [fragment]">christos at chtsanti.net
       </A><BR>
    <I>Wed Aug 24 15:31:06 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006644.html">[squid-dev] [PATCH] Older response must not update
</A></li>
        <LI>Next message: <A HREF="006637.html">[squid-dev] Sad performance trend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6625">[ date ]</a>
              <a href="thread.html#6625">[ thread ]</a>
              <a href="subject.html#6625">[ subject ]</a>
              <a href="author.html#6625">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When comparing the requested domain name with a certificate Common Name, 
Squid expanded wildcard to cover more than one domain name label (a.k.a 
component), violating RFC 2818 requirement[1]. For example, Squid 
thought that wrong.host.example.com matched a *.example.com CN.

     [1] &quot;the wildcard character * ... is considered to match any single
     domain name component or component fragment. E.g., *.a.com matches
     foo.a.com but not bar.foo.a.com&quot;.

In other contexts (e.g., ACLs), wildcards expand to all components. 
matchDomainName() now accepts a mdnRejectSubsubDomains flag that selects 
the right behavior for CN match validation.

The old boolean honorWildcards parameter replaced with a flag, for 
clarity and consistency sake.

This patch also handles the cases where the host name consists only from 
dots (eg malformed Host header or SNI info). The old code has undefined 
behaviour in these cases. Moreover it handles the case a certificate 
contain zero length string as CN or alternate name.

This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-187-ErrorDomainName_for_Wildcard_Certificates-t4.patch
Type: text/x-patch
Size: 14600 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20160824/0f58ff27/attachment.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20160824/0f58ff27/attachment.bin</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006644.html">[squid-dev] [PATCH] Older response must not update
</A></li>
	<LI>Next message: <A HREF="006637.html">[squid-dev] Sad performance trend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6625">[ date ]</a>
              <a href="thread.html#6625">[ thread ]</a>
              <a href="subject.html#6625">[ subject ]</a>
              <a href="author.html#6625">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
