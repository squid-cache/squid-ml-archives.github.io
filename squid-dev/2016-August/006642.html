<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Revalidate without Last-Modified
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Revalidate%20without%20Last-Modified&In-Reply-To=%3C4830ba8f-7f05-9be2-5611-bf3b68d7d8c2%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006643.html">
   <LINK REL="Next"  HREF="006645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Revalidate without Last-Modified</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Revalidate%20without%20Last-Modified&In-Reply-To=%3C4830ba8f-7f05-9be2-5611-bf3b68d7d8c2%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Revalidate without Last-Modified">rousskov at measurement-factory.com
       </A><BR>
    <I>Sat Aug 27 22:05:21 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006643.html">[squid-dev] [PATCH] Revalidate without Last-Modified
</A></li>
        <LI>Next message: <A HREF="006645.html">[squid-dev] [PATCH] Revalidate without Last-Modified
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6642">[ date ]</a>
              <a href="thread.html#6642">[ thread ]</a>
              <a href="subject.html#6642">[ subject ]</a>
              <a href="author.html#6642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/27/2016 05:22 AM, Eduard Bagdasaryan wrote:
&gt;<i> 2016-08-25 18:52 GMT+03:00 Alex Rousskov
</I>&gt;<i> &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt;:
</I>&gt;<i> 
</I>&gt;&gt;<i> 3. Sending an HTCP message to another service.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; -            hdr.putTime(Http::HdrType::LAST_MODIFIED, e-&gt;lastmod);
</I>&gt;&gt;<i> &gt; +        if (e &amp;&amp; e-&gt;lastModified() &gt; -1)
</I>&gt;&gt;<i> &gt; +            hdr.putTime(Http::HdrType::LAST_MODIFIED,
</I>&gt;<i> e-&gt;lastModified());
</I>
&gt;&gt;<i> Is this a conditional/revalidation request? If yes, then should we use
</I>&gt;&gt;<i> an effective modification time instead, like we do in use case #1?
</I>
&gt;<i> The code snippet is taken from htcpTstReply(), serving replies for TST
</I>&gt;<i> requests (TST - test for the presence in the cache). If the entry is cached,
</I>&gt;<i> this method fills HTCP reply packet with some of cached entry's headers (Age,
</I>&gt;<i> Expires, Last-Modified etc.). According to the documentation, these headers are
</I>&gt;<i> added in order to give client an ability to calculate object's freshness itself:
</I>&gt;<i> HTCP response does not provide such information explicitly. On the other hand, I
</I>&gt;<i> have not found any strict requirements of what HTTP headers HTCP reply should
</I>&gt;<i> contain.
</I>&gt;<i> 
</I>&gt;<i> Would the &quot;effective&quot; Last-Modified information help HTCP client to
</I>&gt;<i> calculate object's freshness? It looks that some more information in this case is
</I>&gt;<i> better that lack of it.
</I>
Good question. I worry about the message recipient comparing received
effective LMT with the actual (absent!) LMT of the object they have in
the cache and then deciding that the resource has changed (and their
cached copy is now stale) because the resource now has LMT and it did
not have it before.

Not all HTCP clients are Squids, but how does Squid code treat such an
HTCP TST response? In other words, will Squid itself make a different
decision if it receives an effective LMT header value instead of no LMT
header field at all? Does your own patch affect the receiving Squid
behavior?


Thank you,

Alex.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006643.html">[squid-dev] [PATCH] Revalidate without Last-Modified
</A></li>
	<LI>Next message: <A HREF="006645.html">[squid-dev] [PATCH] Revalidate without Last-Modified
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6642">[ date ]</a>
              <a href="thread.html#6642">[ thread ]</a>
              <a href="subject.html#6642">[ subject ]</a>
              <a href="author.html#6642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
