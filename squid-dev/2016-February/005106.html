<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PREVIEW] Fetch missing certificates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPREVIEW%5D%20Fetch%20missing%20certificates&In-Reply-To=%3C56BA4440.3050303%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="005100.html">
   <LINK REL="Next"  HREF="005101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PREVIEW] Fetch missing certificates</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPREVIEW%5D%20Fetch%20missing%20certificates&In-Reply-To=%3C56BA4440.3050303%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PREVIEW] Fetch missing certificates">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Feb  9 19:55:44 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="005100.html">[squid-dev] [PREVIEW] Fetch missing certificates
</A></li>
        <LI>Next message: <A HREF="005101.html">[squid-dev] [PATCH] snprintf result used without validating its	range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5106">[ date ]</a>
              <a href="thread.html#5106">[ thread ]</a>
              <a href="subject.html#5106">[ subject ]</a>
              <a href="author.html#5106">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/09/2016 09:59 AM, Amos Jeffries wrote:

&gt;<i> &quot;Download&quot; activity is a ::Client class type of activity, which is about
</I>&gt;<i> managing the Squid end of a Squid-&gt;server connection.
</I>
I am afraid you got it backwards: Downloader is a request source (and a
response sink). Downloader does not actually care about the
Squid-to-server connection! It is up to Squid to manage Downloader
request and deliver the response back to Downloader (with or without the
connection to the origin server or peer).


&gt;<i> I am aware there is a need for the store logics to be involved. But
</I>&gt;<i> surely StoreEntry and/or clientStreams does not require the whole
</I>&gt;<i> ::Server 'side' of Squid to be involved.
</I>
Besides StoreEntry and/or clientStreams, download requests should go
through the regular doCallout() processing sequence including StoreID,
ICAP, and other complex things. Thus, I am sure Downloader needs to be
in the same group of classes as ConnStateData.


&gt;<i> Please no more ConnStateData derived classes. ::Server is the head of
</I>&gt;<i> that hierarchy and the servers/ classes as the per-protocol children.
</I>
As for the &quot;Server&quot; parent specifically, I cannot yet say whether your
request is valid. As I said earlier in another thread, I need more time
to study what that unaudited class is and what it should be. Based on
the current &quot;used to manage connections from clients&quot; description alone,
it is obviously the wrong parent for Downloader, but I do not claim that
the description itself is correct.

FWIW, the introduction of that Server class is the primary reason we
have not posted the long-polished &quot;Fetch missing certificates&quot; patch for
review...


&gt;<i> Looking at the patch I also see you have added a thing called
</I>&gt;<i> BinaryTokenizer, but the Tokenizer we already have operates on binary
</I>&gt;<i> octets. All that seems needed is some new accessor(s) for fetching the
</I>&gt;<i> fixed-width binary fields alongside the current int64() ASCII-&gt;integer
</I>&gt;<i> decoder.
</I>
* Tokenizer API is about sequences of characters -- it is built around
CharacterSet. When it retrieves a number, it may retrieve &quot;012345&quot;
characters.

* BinaryTokenizer is about sequences of bits. When it retrieves a
number, it may retrieve 64 bits.

While it all boils down to &quot;binary octets&quot; at some level, it would be a
design mistake to mix the two concepts in one class IMO; just like it
would be a mistake to add &quot;some accessors&quot; to HTTP parser to parse FTP
messages, even though both HTTP and FTP deal with the same kind of input
token streams.

It is possible to create a common Tokenizer parent for TextTokenizer and
BinaryTokenizer, but I think we should wait for BinaryTokenizer to
mature first. It is possible that it (or another *Tokenizer class using
it) will start dealing with not-byte-aligned bits. If that happens,
building a common parent for all tokenizers would be awkward and
expensive performance-wise.


Alex.

</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005100.html">[squid-dev] [PREVIEW] Fetch missing certificates
</A></li>
	<LI>Next message: <A HREF="005101.html">[squid-dev] [PATCH] snprintf result used without validating its	range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5106">[ date ]</a>
              <a href="thread.html#5106">[ thread ]</a>
              <a href="subject.html#5106">[ subject ]</a>
              <a href="author.html#5106">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
