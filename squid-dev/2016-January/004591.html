<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5CPREVIEW%5D%20ICAP%20service%20nodown%20option%20addition.&In-Reply-To=%3C568F1907.5000309%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004589.html">
   <LINK REL="Next"  HREF="004595.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5CPREVIEW%5D%20ICAP%20service%20nodown%20option%20addition.&In-Reply-To=%3C568F1907.5000309%40ngtech.co.il%3E"
       TITLE="[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.">eliezer at ngtech.co.il
       </A><BR>
    <I>Fri Jan  8 02:03:51 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004589.html">[squid-dev] Squid 3.5.11 ntlm helper crashes
</A></li>
        <LI>Next message: <A HREF="004595.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4591">[ date ]</a>
              <a href="thread.html#4591">[ thread ]</a>
              <a href="subject.html#4591">[ subject ]</a>
              <a href="author.html#4591">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>While working on some ICAP issues I have found a very annoying situation 
which I wrote a small patch that *I think* can be applied without any 
known risks to exiting functionality.

I added a configurable option to the ICAP services named &quot;nodown&quot; but 
maybe another name would be better fit.
The idea of the patch is to allow the admin to count on the periodic 
OPTIONS request only to identify the current state of the ICAP service. 
Currently the only option to force a failing service into UP state after 
a failure is using a reconfiguration of squid or the periodic OPTIONS 
fetch. Due to this the patch doesn't makes things much worse then they 
are now but allows the admin to rely on some external_acl helper that 
will use a deny_info to reflect a solid DOWN state between the periodic 
OPTIONS fetch.

I was thinking about using the icap_service_failure_limit with a very 
high limit but it is an ICAP global configuration and not a service 
specific configuration.

The patch link: <A HREF="http://paste.ngtech.co.il/phq5lqtf5">http://paste.ngtech.co.il/phq5lqtf5</A>

Some description in the patch at: 
<A HREF="http://paste.ngtech.co.il/phq5lqtf5#line-233">http://paste.ngtech.co.il/phq5lqtf5#line-233</A>

Thanks,
Eliezer
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004589.html">[squid-dev] Squid 3.5.11 ntlm helper crashes
</A></li>
	<LI>Next message: <A HREF="004595.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4591">[ date ]</a>
              <a href="thread.html#4591">[ thread ]</a>
              <a href="subject.html#4591">[ subject ]</a>
              <a href="author.html#4591">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
