<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5CPREVIEW%5D%20ICAP%20service%20nodown%20option%20addition.&In-Reply-To=%3C568FD551.70401%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004591.html">
   <LINK REL="Next"  HREF="004597.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5CPREVIEW%5D%20ICAP%20service%20nodown%20option%20addition.&In-Reply-To=%3C568FD551.70401%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jan  8 15:27:13 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004591.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
        <LI>Next message: <A HREF="004597.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4595">[ date ]</a>
              <a href="thread.html#4595">[ thread ]</a>
              <a href="subject.html#4595">[ subject ]</a>
              <a href="author.html#4595">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/07/2016 07:03 PM, Eliezer Croitoru wrote:

&gt;<i> I added a configurable option to the ICAP services named &quot;nodown&quot; but
</I>&gt;<i> maybe another name would be better fit.
</I>
Please do not use negative option names. If this feature is committed
despite my objections, please consider using &quot;always-up&quot; or another
positive name.


&gt;<i> The idea of the patch is to allow the admin to count on the periodic
</I>&gt;<i> OPTIONS request only to identify the current state of the ICAP service.
</I>
If an ICAP OPTIONS request fails, will the service be marked as down? If
yes, the option name is misleading. If not, your description above is
misleading. If this feature is committed, please adjust the
documentation to clearly define whether Squid may mark a nodown=1
service as down for any reason.


&gt;<i> I was thinking about using the icap_service_failure_limit with a very
</I>&gt;<i> high limit but it is an ICAP global configuration and not a service
</I>&gt;<i> specific configuration.
</I>
IMO, you should add a service-specific failure-limit option instead of
adding a brand new option with an overlapping but very narrow scope.
Squid already implements the failure-limit logic on a per-service basis.
You just need to add a per-service option (that will default to the
global one).


&gt;<i> +       [...] It gives the
</I>&gt;<i> +       service admin to implement his own heart-beat script which
</I>&gt;<i> +       will work as a replacment to the default internal requests
</I>&gt;<i> +       success\failure probes while the ICAP service state is UP.
</I>&gt;<i> +       An external heart-beat script can run under external_acl
</I>&gt;<i> +       and can be checked in http_access and couple other acls
</I>&gt;<i> +       vectoring points.
</I>
IMO, this text should not be added to the new option because it talks
about controlling access to an ICAP service rather than about [not]
changing the service state which the new option controls. Referring to
adaptation_access from the new option documentation and adding a similar
hint to the adaptation_access documentation instead may be a good idea.


HTH,

Alex.

</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004591.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
	<LI>Next message: <A HREF="004597.html">[squid-dev] [RFC\PREVIEW] ICAP service nodown option addition.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4595">[ date ]</a>
              <a href="thread.html#4595">[ thread ]</a>
              <a href="subject.html#4595">[ subject ]</a>
              <a href="author.html#4595">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
