<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] The situation with helpers/
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20The%20situation%20with%20helpers/&In-Reply-To=%3C569670A9.6000401%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004651.html">
   <LINK REL="Next"  HREF="004667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] The situation with helpers/</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20The%20situation%20with%20helpers/&In-Reply-To=%3C569670A9.6000401%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] The situation with helpers/">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Jan 13 15:43:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004651.html">[squid-dev] [RFC] The situation with helpers/
</A></li>
        <LI>Next message: <A HREF="004667.html">[squid-dev] [RFC] The situation with helpers/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4663">[ date ]</a>
              <a href="thread.html#4663">[ thread ]</a>
              <a href="subject.html#4663">[ subject ]</a>
              <a href="author.html#4663">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/13/2016 06:12 AM, Kinkie wrote:
&gt;<i> On Tue, Jan 5, 2016 at 6:01 PM, Alex Rousskov
</I>&gt;<i> &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;&gt;<i> On 01/04/2016 08:58 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> The SBuf and CharacterSet patch auditing has brought up the questions of
</I>&gt;&gt;&gt;<i> why helpers/ is separate from src/, built first, what cross-dependency
</I>&gt;&gt;&gt;<i> there can be, and even why we are bundling C++ helpers to begin with.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So lets clarify it formally once and for all.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Q1: why is helpers/ built before src/ ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A1: Primarily for historical and paranoia reasons.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Q2: why is helpers/ separate from src/ ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A2: Primarily for historical and paranoia reasons.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> should we shuffle them back to src/*/helpers/ directories on a
</I>&gt;&gt;&gt;<i> per-component basis ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes w.r.t. src/. There is no known good reason to enact artificial hard
</I>&gt;&gt;<i> barriers between parts of Squid code. All Squid code should be in src/.
</I>
&gt;<i> Could or could not. For sure it would help with dependency tracking
</I>&gt;<i> where needed, and there are cases where it is needed.
</I>
Yes, that is one reason I said &quot;should&quot;, not &quot;could&quot;.


&gt;&gt;&gt;<i> * it does somewhat hinder anyone wanting to manually build a single
</I>&gt;&gt;&gt;<i> helper. Though I have not heard of anyone doing so in many years.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The move does not preclude anyone from building a helper. The fact that
</I>&gt;&gt;<i> a few more things may be built along the way is a minor detail IMO.
</I>&gt;&gt;<i> Patches to improve dependency tracking (by migrating away from recursive
</I>&gt;&gt;<i> Makefiles??) are welcomed.
</I>&gt;<i> 
</I>&gt;<i> Ugh. see src/Makefile.am for the monster file this would yield.
</I>
And see src/Makefile.am for the monster file the current
lets-track-complex-dependencies-manually approach has created. I do not
know exactly what the best solution to the current src/Makefile.am
problem is. I know that is a big problem. I suspect the solution
involves more than simply migrating away from recursive Makefiles. I do
not want to discuss that problem in this thread. That is why I said
exactly what I said, including the question marks.


&gt;&gt;&gt;<i> * it does mean we should probably discard the goal of having the helpers
</I>&gt;&gt;&gt;<i> be demo code examples for people to base their custom helpers on.
</I>
&gt;&gt;<i> The location of the helper code is pretty much irrelevant for the above
</I>&gt;&gt;<i> goal. However, if we want to provide demo helpers that are easy to
</I>&gt;&gt;<i> understand and customize, then we probably should not use C++ to write
</I>&gt;&gt;<i> those demo helpers.
</I>
&gt;<i> I don't agree. We should use whatever tool makes sense, depending on
</I>&gt;<i> the availability of libraries, complexity, volunteer time etc.
</I>
Not sure what you do not agree with:

* Your statement does not contradict what I said about the location of
the helper code being pretty much irrelevant.

* If you are focusing on the second part of my statement, then please
note that it is possible, perhaps even likely that the &quot;tools&quot; that
&quot;make sense&quot; in our situation are not appropriate for some goals. When
that happens, the goals have to be re-evaluated to match reality so that
unrealistic goals do not misdirect our decisions.


&gt;&gt;<i> * If we want to provide the smallest set of default helpers for the
</I>&gt;&gt;<i> widest possible set of deployment environments, then internal
</I>&gt;&gt;<i> dependencies are preferred to the external ones and, hence, C++ is the
</I>&gt;&gt;<i> best language choice.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> * If we want to provide default production-quality helpers for the most
</I>&gt;&gt;<i> demanding deployment environments, then internal dependencies are
</I>&gt;&gt;<i> irrelevant, and C++ is the best language choice. Please note that I do
</I>&gt;&gt;<i> not know whether it is wise to declare performance the primary goal,
</I>&gt;&gt;<i> given the performance deficiencies of the helper interface itself and
</I>&gt;&gt;<i> the current Squid Project resources.
</I>&gt;&gt;<i> Any open source helper can be examined, customized, and cloned, of
</I>&gt;&gt;<i> course. Our decision with regard to programming language and
</I>&gt;&gt;<i> dependencies may make it easier or more difficult, but not impossible.
</I>&gt;&gt;<i> It is a question of the primary optimization target: ease of
</I>&gt;&gt;<i> understanding/customizability versus supported platforms versus performance.
</I>&gt;<i> 
</I>&gt;<i> I believe our goals should be, in descending order of importance:
</I>&gt;<i> 1- cover a reasonable set of needs
</I>&gt;<i> 2- provide a gallery of examples for administrators who have special
</I>&gt;<i> needs not covered by the provided set of helpers. 
</I>
Goal #2, as stated, is not a goal but a side-effect: Whatever helpers we
provide to satisfy goal #1 will automatically become a &quot;gallery of
examples&quot;.


&gt;<i> Corollaries of this objective are:
</I>&gt;<i> 2a- bundled helpers should aim at being as readable as possible.
</I>
Any code should aim at being as readable as possible so this statement
is not a corollary and does not really bring anything new to the debate.


&gt;<i> 2b- bundled helpers should try to avoid relying on Squid internal code
</I>&gt;<i> within reason. We can expect administrators embarking in the task to
</I>&gt;<i> be competent programmers, asking them to be also competent Squid
</I>&gt;<i> coders is maybe too much to ask.
</I>
Relying on Squid libraries/APIs is not that much different than relying
on external libraries/APIs. Thus, I disagree that a reasonable use of
Squid code in helpers forces helper writers to become competent Squid
coders. It is a question of how much use is &quot;reasonable&quot; given our
still-being-debated goals, of course.


Alex.

</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004651.html">[squid-dev] [RFC] The situation with helpers/
</A></li>
	<LI>Next message: <A HREF="004667.html">[squid-dev] [RFC] The situation with helpers/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4663">[ date ]</a>
              <a href="thread.html#4663">[ thread ]</a>
              <a href="subject.html#4663">[ subject ]</a>
              <a href="author.html#4663">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
