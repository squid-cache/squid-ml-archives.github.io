<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] YesNoNone class updates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20YesNoNone%20class%20updates&In-Reply-To=%3C56991925.3090307%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="004681.html">
   <LINK REL="Next"  HREF="004724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] YesNoNone class updates</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20YesNoNone%20class%20updates&In-Reply-To=%3C56991925.3090307%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] YesNoNone class updates">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jan 15 16:07:01 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="004681.html">[squid-dev] [PATCH] YesNoNone class updates
</A></li>
        <LI>Next message: <A HREF="004724.html">[squid-dev] [PATCH] YesNoNone class updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4722">[ date ]</a>
              <a href="thread.html#4722">[ thread ]</a>
              <a href="subject.html#4722">[ subject ]</a>
              <a href="author.html#4722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/14/2016 11:49 PM, Amos Jeffries wrote:
&gt;<i> On 15/01/2016 11:38 a.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> On 01/14/2016 12:31 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> On 15/01/2016 6:26 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i> On 01/13/2016 03:56 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> On 13/01/2016 5:11 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> On 01/11/2016 06:36 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> +    /** forbidden operation.
</I>&gt;&gt;&gt;&gt;&gt;<i> +     * Use x.configure(bool) when the value is configured.
</I>&gt;&gt;&gt;&gt;&gt;<i> +     * Use x = YesNoNone(bool) to assign defaults.
</I>&gt;&gt;&gt;&gt;&gt;<i> +     */
</I>&gt;&gt;&gt;&gt;&gt;<i> +    YesNoNone &amp;operator =(bool) = delete;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Why do we need to delete something that does not exist? If you do not
</I>&gt;&gt;&gt;&gt;<i> add the above code, do you really gain the ability to assign booleans to
</I>&gt;&gt;&gt;&gt;<i> YesNoNone objects? If not, please remove.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> We have a bool constructor and implicit copy-assignment. Which tempts
</I>&gt;&gt;&gt;<i> the compiler to try bool constructing then copying. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Fortunately, we do not have just any &quot;bool constructor&quot;. We have an
</I>&gt;&gt;<i> _explicit_ bool constructor which prohibits implicit &quot;bool constructing
</I>&gt;&gt;<i> then copying&quot;, no matter how tempting it might seem to the compiler.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What would be the purpose of marking the constructor &quot;explicit&quot; if the
</I>&gt;&gt;<i> imaginary conversion sequence you have described would still be
</I>&gt;&gt;<i> possible, depending on the compiler or other factors? [Rhetorical]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please either remove the bool assignment operator (instead of deleting
</I>&gt;&gt;<i> what does not exist) or provide a use case where its deleted existence
</I>&gt;&gt;<i> changes something other than the compiler error message text.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> FWIW, in my tests, without the operator, the errors look like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> error: conversion from ‘bool’ to non-scalar type ‘YesNoNone’ requested
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> FYI: with GCC-5.3 and libstdc++6 I get both of these two buried amidst a
</I>&gt;<i> page of verbose compiler output:
</I>&gt;<i>  error: missing operator 'YesNoNone &amp; operator =(const YesNoNone &amp;)'
</I>&gt;<i>  error: missing operator 'YesNoNone &amp;&amp; operator =(const YesNoNone &amp;&amp;)'
</I>&gt;<i> 
</I>&gt;<i> So the bool conversion seems to be happening despite explicit,
</I>
AFAIK, implicit bool conversion cannot happen with an explicit bool
constructor. Unfortunately, I do not have convenient access to GCC v5.3
or the time to triage and explain the above error messages.

Fortunately, the compilation fails as it should, so this is only an
understanding issue. If somebody can provide an explanation for this GCC
behavior, please do so.


&gt;<i> Done anyway.
</I>

Thank you,

Alex.
P.S. I trust you have seen the seemingly related linking problems in
Jenkins.

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004681.html">[squid-dev] [PATCH] YesNoNone class updates
</A></li>
	<LI>Next message: <A HREF="004724.html">[squid-dev] [PATCH] YesNoNone class updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4722">[ date ]</a>
              <a href="thread.html#4722">[ thread ]</a>
              <a href="subject.html#4722">[ subject ]</a>
              <a href="author.html#4722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
