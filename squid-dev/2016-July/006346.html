<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] &quot;Splicing&quot; bumped requests to	resolve\workaround WebSockets issues.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20%22Splicing%22%20bumped%20requests%20to%0A%09resolve%5Cworkaround%20WebSockets%20issues.&In-Reply-To=%3C00b801d1e06a%24a24cc370%24e6e64a50%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006345.html">
   <LINK REL="Next"  HREF="006350.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to	resolve\workaround WebSockets issues.</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20%22Splicing%22%20bumped%20requests%20to%0A%09resolve%5Cworkaround%20WebSockets%20issues.&In-Reply-To=%3C00b801d1e06a%24a24cc370%24e6e64a50%24%40ngtech.co.il%3E"
       TITLE="[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to	resolve\workaround WebSockets issues.">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Jul 17 20:34:36 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006345.html">[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to resolve\workaround WebSockets issues.
</A></li>
        <LI>Next message: <A HREF="006350.html">[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to resolve\workaround WebSockets issues.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6346">[ date ]</a>
              <a href="thread.html#6346">[ thread ]</a>
              <a href="subject.html#6346">[ subject ]</a>
              <a href="author.html#6346">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alex thanks for clearing things out.
I remember something's vaguely and this is why I didn't quote anything.
I tried searching for something in the squid-dev list or irc but I couldn't
found it.

&quot;tunnel after bump&quot; is indeed the right term and despite to what some think
in many cases the issue is not certificate pinning but...
A specially crafted binary protocol that cannot be intercepted by an HTTP
proxy.

About the on_unsupported_protocol , I am assuming it's part of the:
<A HREF="http://wiki.squid-cache.org/Squid-4?highlight=%28on_unsupported_protocol%29">http://wiki.squid-cache.org/Squid-4?highlight=%28on_unsupported_protocol%29</A>

The test cases I can think about are couple:
- CONNECT of a pinned certificate based connection(MS, SKYPE)
- CONNECT of a non TLS based connection(SKYPE)
- CONNECT of a http websocket connection(WHATSAPP?)
- CONNECT of a HTTPS based connection, non websocket(a simple banking site)
- CONNECT of a HTTPS based websocket connection(the CentOS\Fedora cockpit
have these, other suggections are welcome)
- intercepted connection for each of the cases above

I think that when we could test each and every one of these
cases(successfully) then we can move forward from beta to the next release.
(only for the bump, splice, tunnel, on_unsupported_protocol aspect of squid)

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">eliezer at ngtech.co.il</A>


-----Original Message-----
From: Alex Rousskov [mailto:<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>] 
Sent: Sunday, July 17, 2016 10:39 PM
To: Eliezer Croitoru; <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
Subject: Re: [RFC] &quot;Splicing&quot; bumped requests to resolve\workaround
WebSockets issues.

On 07/15/2016 04:29 AM, Eliezer Croitoru wrote:
&gt;<i> The issue:
</I>&gt;<i> 
</I>&gt;<i> Clients are issuing secured connections which contains WebSockets
</I>&gt;<i> internally and squid HTTP parsing breaks these connections.
</I>
&gt;<i> Another related issue which deserves attention:
</I>&gt;<i> 
</I>&gt;<i> Certificate pinning and connection breakage.
</I>&gt;<i> 
</I>&gt;<i> Currently we cannot determine for many connections what is the &quot;issue&quot;,
</I>&gt;<i> is it the bumping itself of the breakage of a WebSocket http connection.
</I>


&gt;<i> An acceptable solution:
</I>&gt;<i> 
</I>&gt;<i> Alex mentioned the option to splice a bumped connection.  
</I>&gt;<i> 
</I>&gt;<i> I do not know exactly what Alex meant since not much details were
</I>presented.

I do not know exactly what Alex meant either since you provided no
source for that alleged Alex' opinion.


&gt;<i> As I understand, it would not be possible  to do this kind of splice
</I>&gt;<i> without bumping first.
</I>
I recommend avoiding &quot;splice after bump&quot; terminology because, in SslBump
context implied by the word &quot;bump&quot;, that combination makes no sense: It
is not possible to splice bumped connections.

I suggest using &quot;tunnel after bump&quot; instead. Please note that &quot;tunnel&quot;
(not &quot;splice&quot;) is one of the on_unsupported_protocol actions.


HTH,

Alex.


</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006345.html">[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to resolve\workaround WebSockets issues.
</A></li>
	<LI>Next message: <A HREF="006350.html">[squid-dev] [RFC] &quot;Splicing&quot; bumped requests to resolve\workaround WebSockets issues.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6346">[ date ]</a>
              <a href="thread.html#6346">[ thread ]</a>
              <a href="subject.html#6346">[ subject ]</a>
              <a href="author.html#6346">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
