<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Some failed transactions are not logged
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Some%20failed%20transactions%20are%20not%20logged&In-Reply-To=%3C578F95AD.30304%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006400.html">
   <LINK REL="Next"  HREF="006301.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Some failed transactions are not logged</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Some%20failed%20transactions%20are%20not%20logged&In-Reply-To=%3C578F95AD.30304%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Some failed transactions are not logged">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Jul 20 15:15:57 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006400.html">[squid-dev] [PATCH] Some failed transactions are not logged
</A></li>
        <LI>Next message: <A HREF="006301.html">[squid-dev] Broken trunk after r14735, r14726
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6385">[ date ]</a>
              <a href="thread.html#6385">[ thread ]</a>
              <a href="subject.html#6385">[ subject ]</a>
              <a href="author.html#6385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/19/2016 10:36 PM, Amos Jeffries wrote:
&gt;<i> On 20/07/2016 5:01 a.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> On 07/19/2016 08:10 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> On 20/07/2016 1:44 a.m., Eduard Bagdasaryan wrote:
</I>&gt;&gt;&gt;&gt;<i> 2016-07-19 16:17 GMT+03:00 Amos Jeffries:
</I>&gt;&gt;&gt;&gt;&gt;<i> Is this patch going to include the new config option to prevent logging
</I>&gt;&gt;&gt;&gt;&gt;<i> the new things? or do it in a followup?
</I>
&gt;&gt;&gt;&gt;<i> For now we are not planning to add this option(that is why initially the
</I>&gt;&gt;&gt;&gt;<i> patch did not perform logging for &quot;no-bytes&quot; connections).
</I>&gt;&gt;&gt;&gt;<i> Probably there should be a (new?) ACL, controlling number of received
</I>&gt;&gt;&gt;&gt;<i> bytes(instead of separate option). If so, implementing this requires
</I>&gt;&gt;&gt;&gt;<i> solving non-trivial separate task.
</I>
&gt;&gt;&gt;<i> Okay. I was just thinking an on/off directive for now. So people could
</I>&gt;&gt;&gt;<i> restore the old behaviour, or go ahead with the new logs. 
</I>
&gt;&gt;<i> An ACL is the right way to control what gets logged ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which ACL(s) to add depends on the final version of the new logging
</I>&gt;&gt;<i> code, requires careful thinking, and may require non-trivial
</I>&gt;&gt;<i> development. We want to keep all of that outside this project scope.
</I>&gt;&gt;<i> Amos, if we assume that this patch does not add new ACLs or directives,
</I>&gt;&gt;<i> are you happy with what it logs now or do you want Eduard to exclude
</I>&gt;&gt;<i> something?
</I>
&gt;<i> Hmm. Good point.
</I>&gt;<i> 
</I>&gt;<i> The 'problem' with ACLs was not the lack of checks, it is that the URL
</I>&gt;<i> ones we already have use exclusively the HttpRequest URL and complain
</I>&gt;<i> when one is not existing. It might be easier to extend those to use the
</I>&gt;<i> error:* URL, in the same way the log itself is getting it for display.
</I>
Agreed: It might be easier. The point is that whether the problem is the
lack of ACLs, imperfect implementation of existing ACLs, a combination
of both, or something else, it is a non-trivial question that should be
carefully researched and answered in another project IMO.

If we assume that this patch does not add new ACLs or directives, and
does not adjust existing ones, are you happy with what it logs now or do
you want Eduard to exclude something?


&gt;&gt;<i> Thus, we have the following naming options:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) error:accept-user-connection and annotate_user_connection
</I>&gt;&gt;<i> 2) error:accept-client-connection and annotate_client
</I>&gt;&gt;<i> 3) error:accept-client-connection and annotate_client_connection
</I>

&gt;<i> My inbox(es) contain no mention of these annotate_client / annotate_user
</I>&gt;<i> you speak of being discussed. And my memory is also drawing a bank right
</I>&gt;<i> now.
</I>
<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html">http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html</A>


&gt;<i> I'm asking for &quot;error:accept-client-connection&quot;
</I>
Sounds good to me.


Thank you,

Alex.

</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006400.html">[squid-dev] [PATCH] Some failed transactions are not logged
</A></li>
	<LI>Next message: <A HREF="006301.html">[squid-dev] Broken trunk after r14735, r14726
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6385">[ date ]</a>
              <a href="thread.html#6385">[ thread ]</a>
              <a href="subject.html#6385">[ subject ]</a>
              <a href="author.html#6385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
