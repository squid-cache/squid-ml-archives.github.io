<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Deletors%20for%20std%3A%3Aunique_ptr%20WAS%3A%20Re%3A%0A%20Broken%20trunk%20after%20r14735&In-Reply-To=%3C380a57c2-5540-4094-3aab-a560764c4878%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006462.html">
   <LINK REL="Next"  HREF="006466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Deletors%20for%20std%3A%3Aunique_ptr%20WAS%3A%20Re%3A%0A%20Broken%20trunk%20after%20r14735&In-Reply-To=%3C380a57c2-5540-4094-3aab-a560764c4878%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jul 31 09:57:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006462.html">[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735
</A></li>
        <LI>Next message: <A HREF="006466.html">[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6465">[ date ]</a>
              <a href="thread.html#6465">[ thread ]</a>
              <a href="subject.html#6465">[ subject ]</a>
              <a href="author.html#6465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[ This is getign kidn fo personal, so I've taken it off-list, but if you
want to stay public feel free to revert that ]

On 31/07/2016 5:26 a.m., Alex Rousskov wrote:
&gt;<i> On 07/30/2016 07:03 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> On 30/07/2016 6:29 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;<i> On 07/29/2016 09:27 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> typedef std::unique_ptr&lt;BIO, std::function&lt;decltype(BIO_free)&gt;&gt; BIO_Pointer;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I got this config parsing crash replicated here and tried a dozen or so
</I>&gt;&gt;&gt;&gt;<i> combinations. It does seem to keep coming back to my earlier approach of
</I>&gt;&gt;&gt;&gt;<i> using per-type Functors as the most reliable solution.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> AFAICT, this is not a question of reliability, and we should not be
</I>&gt;&gt;&gt;<i> fixing this by trying various combination of typedef characters until we
</I>&gt;&gt;&gt;<i> find one that does not immediately crash Squid. We should figure out
</I>&gt;&gt;&gt;<i> _why_ trunk code does not work (and then fix it accordingly).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> Please clear your head of the notion that I'm tying things bindly or
</I>&gt;&gt;<i> randomly.
</I>&gt;<i> 
</I>&gt;<i> You control those notions -- I am going by what you tell me. I can
</I>&gt;<i> rarely guess your state of mind unless you document it. The lack of the
</I>&gt;<i> problem cause description combined with phrases like &quot;trying dozen or so
</I>&gt;<i> combinations&quot;, &quot;seem to&quot;, &quot;the most reliable solution&quot; and other things
</I>&gt;<i> you have said, tell me that you do not know what the root of the problem
</I>&gt;<i> is and assume that this is a reliability problem (i.e., sometimes a
</I>&gt;<i> certain solution works and sometimes it does not).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> The difficulty as I mentioned already has been in finding a working
</I>&gt;&gt;<i> solution that is easily used without risking future bugs from people
</I>&gt;&gt;<i> misunderstanding the use of these Pointers. That is what I meant by
</I>&gt;&gt;<i> &quot;reliable&quot;.
</I>&gt;<i> 
</I>&gt;<i> AFAICT, you have not documented what the cause of the bug is and you
</I>&gt;<i> have used a vague &quot;reliable&quot; adjective without enough context to guess
</I>&gt;<i> one of its meanings, so blaming others for not knowing your state of
</I>&gt;<i> mind is rather unfair.
</I>&gt;<i> 
</I>
NO blame intended. I became clear yesterday that we are badly out of
sync with all these parallel threads. That last mail was intended as a
basic clarification of where we are at and whats going on at my end of
things in the whole situation. I'm sorry if it could be taken otherwise,
or did not do the clarification I'd though it was.

&gt;<i> 
</I>&gt;&gt;<i> You have previously assured me[1] that using std::function&lt;declype(X)&gt;
</I>&gt;&gt;<i> was the way to go and would allow removal of the macros. That usage has
</I>&gt;&gt;<i> turned out to cause the null derefernce.
</I>&gt;<i> 
</I>&gt;<i> I fully admit that my std::function suggestion was wrong. While my
</I>&gt;<i> suggestion and decltype discovery were a big step in the right
</I>&gt;<i> direction, I missed the fact that the default functor constructor needs
</I>&gt;<i> to create the right target which, AFAIK, std::function cannot do. If you
</I>&gt;<i> think that makes me responsible for the bugs in your patch (otherwise
</I>&gt;<i> why would you even mention that mistake?), I am not going to waste time
</I>&gt;<i> convincing you otherwise.
</I>
I do not think that. I am _hopeful_ that you can fix the bugs in my
patch. Because this and some others have turned out to be cases of a
quote what my teachers once passed on: if you code to the best of your
ability - you wont be capable enough to fix the bugs.

I see you as being somewhat smarter than me. So yeah, when I get stuck
I'm hopeful that you can find the right way forward. If none of us can
find it, then things are really screwed.

&gt;<i> 
</I>&gt;<i> For the record, my suggestions did remove macros, and I gave no
</I>&gt;<i> assurances that they are the final/correct solution (only that they
</I>&gt;<i> compile in my tests).
</I>&gt;<i> 
</I>&gt;<i> A bigger problem here is that your attitude continues to present a
</I>&gt;<i> difficult dilemma for me: When you post bad code, do I simply downvote
</I>&gt;<i> it (and get blamed for being harsh and uncooperative while increasing
</I>&gt;<i> the risks that we all will have to suffer from the consequences of that
</I>&gt;<i> code being committed), or do I spend insane amounts of time trying to
</I>&gt;<i> improve it despite the resistance and frequent personal attacks (and
</I>&gt;<i> then get blamed for the bugs)? It is difficult to find the lesser evil
</I>&gt;<i> among these options!
</I>
Thank you for having the courage to voice that.

Please do whatever you need to at any time without guilt or any other
form of doubt or worry. Even though I'm not aware of the precise
pressures you are dealing with constantly, I do understand you have
many. Whatever non-technical things I write in response is not targeted
at anyone else (and IIRC always has been). Simply expression of my
frustration, or in my mind at least an open/honest argument about
technical direction. Any two people with different focus like we have,
will always have those differences.
 There are some people that really piss me off. But you are not one of
them. I value your skills and feedback *a lot*.

On the topic of personal attacks, if I do any please do point it out. I
have a bad case of 'social cue recognition'. Which is both a boon and a
curse. It helps me waive off subtle personal attacks by jumping to a
friendly interpretation of everything (yay!) - but also prevents me
noticing if I'm emitting any signals that could be interpreted by others
as being ambiguous or unfriendly (doh!).

In writing like this that can be particularly hard to get right. I'm
trying to be casual but professional in all I do regarding Squid. So if
any is happening it is more a bad statement about myself than anyone
else. I need to fix that, so pointing out when I get it wrong is helpful
and appreciated.



In other related things, there have been a number of occasions that I've
found myself wishing you and I had a more informal kind of relationship
to offset the dry nature of the pure work/Squid stuff. At least being
able to talk a few lines about non-Squid things every now and again on
IRC makes for a friendlier exchange more like real office colleagues can
build up. Around a watercooler as the steriotype goes.

With each of the others I can chat (at least for a few words) about
family, hobbies or job problems; with Alex ... practically all I have is
&quot;hi&quot;. I find it difficult to imagine that you would like it that way
100% of the time, even if we only sync up in chat every other year due
to geography.
 So if we were working in the same building and happened to sit down for
a beverage after work one day, what could we talk about?

Amos

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006462.html">[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735
</A></li>
	<LI>Next message: <A HREF="006466.html">[squid-dev] [PATCH] Deletors for std::unique_ptr WAS: Re: Broken trunk after r14735
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6465">[ date ]</a>
              <a href="thread.html#6465">[ thread ]</a>
              <a href="subject.html#6465">[ subject ]</a>
              <a href="author.html#6465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
