<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] ICAP external acl services
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20ICAP%20external%20acl%20services&In-Reply-To=%3Cd21fbc72-3570-e23a-0a38-059da896b07c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006005.html">
   <LINK REL="Next"  HREF="006021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] ICAP external acl services</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20ICAP%20external%20acl%20services&In-Reply-To=%3Cd21fbc72-3570-e23a-0a38-059da896b07c%40treenet.co.nz%3E"
       TITLE="[squid-dev] [RFC] ICAP external acl services">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jun 19 20:25:16 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006005.html">[squid-dev] [RFC] ICAP external acl services
</A></li>
        <LI>Next message: <A HREF="006021.html">[squid-dev] [RFC] ICAP external acl services
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6006">[ date ]</a>
              <a href="thread.html#6006">[ thread ]</a>
              <a href="subject.html#6006">[ subject ]</a>
              <a href="author.html#6006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/06/2016 6:53 a.m., Eliezer Croitoru wrote:
&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Alex mentioned long ago the idea\option to add an ICAP service as an
</I>&gt;<i> external_acl helper.
</I>&gt;<i> 
</I>
I suspect you misunderstood him. The two things are very differently
focused and the informational needs and limitations are equally different.

&gt;<i> I want to highlight my understanding of couple things about the subject.
</I>&gt;<i> 
</I>&gt;<i> Currently external_acl helpers are required to &quot;decide&quot; on an action based
</I>&gt;<i> only on couple basic parts of the request.
</I>&gt;<i> 
</I>&gt;<i> It's not bad or wrong but ICAP can extend squid helpers assistance.
</I>&gt;<i> 
</I>&gt;<i> It can extend the decision to the brief request and response details.
</I>&gt;<i> 
</I>
No. The decisions that ACLs participate in making for Squid are
completely orthoginal to ICAP.

ICAP can produce state changes in the transaction to cause the decision
process to go a different way to where it would go without ICAP. But it
cannot directly make the descision itself. The ICAP changed state still
has to be (re-)processed for those descisions at the point(s) Squid
needs them made.

&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Alex mentioned at the time that ICAP services implements ACLs but in a form
</I>&gt;<i> which the interface maybe was not designed for.
</I>
Yes.

&gt;<i> 
</I>&gt;<i> I think that the ICAP services interface usage might be used a bit &quot;off&quot; to
</I>&gt;<i> what it was designed for but it seems OK to me for many cases.
</I>
ICAP and eCAP are suitable for when modifications and descisions need to
include anythign in the payload.

ACLs (including external ACL) are suitable for decisions and
modifications only requiring HTTP and transport layer metadata.


&gt;<i> 
</I>&gt;<i> Also any ICAP implementation requires a more deep understanding of HTTP in
</I>&gt;<i> general which has it's own pros and cons.
</I>&gt;<i> 
</I>&gt;<i> The main benefit of an ICAP service as I see it is that it's not bound to
</I>&gt;<i> squid or c++ compared to eCAP.
</I>
eCAP is not bound to C++ either. At heart it is a library ABI
definition. Any module could in theory be built in another language - as
long as it presents the C++ symbolic eCAP ABI to Squid.
The only thing that is binding it at present is the fact that doing
cross-language ABI is difficult and the existing eCAP library is in C++.

&gt;<i> Means I like ICAP better and maybe since I have better luck with it.
</I>&gt;<i> 
</I>
ICAP is like having root/admin privileges over the transaction. Of
course its more attractive than doing things in restricted targeted
ways. Even if all that is needed is a simple binary descision.

You have to choose if you actually need the complication of *CAP
overheads. Or would something much simpler be more suitable.

And I dont mean the ease of coding detail you seem to be focussing on.
But the x3 multiplier on CPU, socket, RAM resource and latency delays.
Doubling (or more) on latency is a big deal.

&gt;<i> 
</I>&gt;<i> And to the actual implementation idea:
</I>&gt;<i> 
</I>&gt;<i> There are couple options on how an ICAP service should respond.
</I>&gt;<i> 
</I>
Nope. There is pretty much just one. Fake request delivered to ICAP with
parameters as HTTP headers. Status of the reply delivered back
translated to OK/ERR values.

&gt;<i> I think that &quot;OK&quot; or &quot;ERR&quot; are good but a &quot;DUNNO&quot; ie use default action
</I>&gt;<i> could be used.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I hope that you have comments to write about the subject.
</I>&gt;<i> 
</I>&gt;<i> Will it be good to add ICAP based external acl interfaces?
</I>
No it would be horribly complex.

&gt;<i> 
</I>&gt;<i> Maybe it's too complex?
</I>&gt;<i> 
</I>&gt;<i> Are there any benefits to external_acl helpers over ICAP services?
</I>&gt;<i> 
</I>
Simplicity. Speed. Flexibility.

And not having to teach admin a major compicated protocol just to script
a yes/no decision. The basic helper I/O protocol we have already seems
to be blowing some peoples minds.

Amos

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006005.html">[squid-dev] [RFC] ICAP external acl services
</A></li>
	<LI>Next message: <A HREF="006021.html">[squid-dev] [RFC] ICAP external acl services
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6006">[ date ]</a>
              <a href="thread.html#6006">[ thread ]</a>
              <a href="subject.html#6006">[ subject ]</a>
              <a href="author.html#6006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
