From noc at squid-cache.org  Tue Nov  1 04:46:15 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 1 Nov 2016 04:46:15 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Jenkins_build_is_back_to_normal_=3A_trunk-m?=
 =?utf-8?q?atrix_=C2=BB_gcc=2Cd-ubuntu-wily_=23823?=
In-Reply-To: <104969530.43.1477882182517.JavaMail.jenkins@buildmaster>
References: <104969530.43.1477882182517.JavaMail.jenkins@buildmaster>
Message-ID: <887216192.44.1477975575423.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-ubuntu-wily/823/

From noc at squid-cache.org  Tue Nov  1 08:00:56 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 1 Nov 2016 08:00:56 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23269?=
In-Reply-To: <795310413.42.1477877334592.JavaMail.jenkins@buildmaster>
References: <795310413.42.1477877334592.JavaMail.jenkins@buildmaster>
Message-ID: <193320159.45.1477987256624.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/269/------------------------------------------
[...truncated 6789 lines...]
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
checking for egrep... .././test-suite/../configure: line 7191: echo: write error: Broken pipe
checking for fgrep... .././test-suite/../configure: line 8238: echo: write error: Broken pipe
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From christos at chtsanti.net  Tue Nov  1 15:31:57 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Tue, 1 Nov 2016 17:31:57 +0200
Subject: [squid-dev] [PATCH] Support tunneling of bumped non-HTTP
 traffic. Other SslBump fixes.
In-Reply-To: <9791ec04-61b2-c1a0-b727-dc464783e90f@treenet.co.nz>
References: <20161014133016.Horde.z4XvK-tzo30mm9qVt-7tjNG@office.urlfilterdb.com>
 <90915e3a-7d70-f215-dfbf-a8401fe581a5@chtsanti.net>
 <97144092-6901-a51e-7ce8-945a8ee9b0ce@measurement-factory.com>
 <b823ebd2-acb9-908b-0b3e-cdabbddb8183@chtsanti.net>
 <48d54e6f-ab2d-a2fd-acc9-8cef534aab61@treenet.co.nz>
 <59f259cf-65d9-280b-d34e-599793990286@measurement-factory.com>
 <98336281-d2cd-886f-6649-cfaa0bc12c31@chtsanti.net>
 <03fe40fe-2978-6b75-343b-a233c3737b98@measurement-factory.com>
 <eb73b3e0-7b16-94ee-f1ed-36064e626059@chtsanti.net>
 <9791ec04-61b2-c1a0-b727-dc464783e90f@treenet.co.nz>
Message-ID: <9ccad3bf-865c-e3b4-d3df-537a8673d335@chtsanti.net>

On 10/28/2016 01:11 PM, Amos Jeffries wrote:
> On 21/10/2016 3:55 a.m., Christos Tsantilas wrote:
>>
>> Support tunneling of bumped non-HTTP traffic. Other SslBump fixes.
>>
>> Use case: Skype groups appear to use TLS-encrypted MSNP protocol instead
>> of HTTPS. This change allows Squid admins using SslBump to tunnel Skype
>> groups and similar non-HTTP traffic bytes via "on_unsupported_protocol
>> tunnel all". Previously, the combination resulted in encrypted HTTP 400
>> (Bad Request) messages sent to the client (that does not speak HTTP).
>>
>> Also this patch:
>>  * fixes bug 4529: !EBIT_TEST(entry->flags, ENTRY_FWD_HDR_WAIT)
>>    assertion in FwdState.cc.
>>
>>  * when splicing transparent connections during SslBump step1, avoid
>>    access-logging an extra record and log %ssl::bump_mode as the expected
>>    "splice" not "none".
>>
>>  * handles an XXX comment inside clientTunnelOnError for possible memory
>>    leak of client streams related objects
>>
>>  * fixes TunnelStateData logging in the case of splicing after peek.
>>
>> This is a Measurement Factory project.
>
>
> Are any of these additional fixes able to be easily broken out into
> separate patches? It would greatly help the auditing process to get
> smaller patches.
>
> in src/FwdState.cc:
>
> * Most of the changed lines are a needless de-scoping of code.
>  - note that the sub-scope existed to begin with so as to silence noisy
> false-positives by static analysis tools (trunk rev.14790).

I make FwdState related fixes a separate patch and I remove it from main 
patch.
Do you believe that the SQUID-211-FwdState_connectStart_cleanup-t1.patch 
will cause problems to Squid?
We can just remove the line :
   pinned_connection->stopPinnedConnectionMonitoring();

>
> Please use nullptr in new code instead of NULL.
>  - there is one part "if (cause != NULL && cause->method == " that
> should either not have the " != NULL" bytes, or use nullptr explicitly.
>  - I prefer the former, "if (cause && cause->method == ", when testing
> pointers existence-vs-nil.

OK. I made this and some other similar fixes.


>
>
> in tunnelPeerSelectComplete()
>  - "if (!bail &&" can be replaced by "else if (".

ok for this.

>
>  - please take advantage of the surrounding code being re-written to
> cleanup:
>     if (peer_paths == NULL || peer_paths->size() < 1) {
>         debugs(26, 3, HERE << "No paths found. Aborting CONNECT");
> as:
>     if (!peer_paths || peer_paths->size() < 1) {
>         debugs(26, 3, "No paths found. Aborting CONNECT");


I did not this fix Amos.
I will make a separate commit after this patch committed if you want it.

>
> Amos
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-211-FwdState_connectStart_cleanup-t1.patch
Type: text/x-patch
Size: 4005 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161101/88ee123a/attachment-0002.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-211-Skype_groups_and_msnp_bypass-t10.patch
Type: text/x-patch
Size: 91425 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161101/88ee123a/attachment-0003.bin>

From gkinkie at gmail.com  Tue Nov  1 20:02:17 2016
From: gkinkie at gmail.com (Kinkie)
Date: Tue, 1 Nov 2016 20:02:17 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
	suffix arguments
Message-ID: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>

Hi all,
  the attached patch extends SBufContainerJoin to have prefix and
suffix arguments. This can support a use-case which I found in the
current ACLRegexData work I'm following, where we need to transform
{"foo", "bar", "gazonk"}
into
(foo)|(bar)|(gazonk)

It can be done with the current version of the SBufContainerJoin
function, but it requires one more copy.
There are probably further cases of this pattern elsewhere, all hand-rolled.

-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbuflist-prefixsuffix-v1.patch
Type: application/octet-stream
Size: 2186 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161101/a530edb6/attachment.obj>

From rousskov at measurement-factory.com  Tue Nov  1 20:47:01 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 1 Nov 2016 14:47:01 -0600
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
Message-ID: <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>

On 11/01/2016 02:02 PM, Kinkie wrote:
>   the attached patch extends SBufContainerJoin to have prefix and
> suffix arguments. This can support a use-case which I found in the
> current ACLRegexData work I'm following, where we need to transform
> {"foo", "bar", "gazonk"}
> into
> (foo)|(bar)|(gazonk)
> 
> It can be done with the current version of the SBufContainerJoin
> function, but it requires one more copy.
> There are probably further cases of this pattern elsewhere, all hand-rolled.

I agree that the use case is legitimate, but the implementation does not
solve the underlying cause -- extra copies.

I recommend reworking this by adding a dest parameter:

/// copies all container items (delimited by separator) into dest
...
/// \returns dest
SBuf &ContainerToSBuf(SBuf &dest, ...);

and using that function to implement the SBufContainerJoin() or a
similarly named convenience wrapper that does not require a dest
parameter and that returns a copy of an internally used SBuf.

In either case, please do not forget to document that the new prefix and
suffix are always added, even if the container is empty.


>      // sz can be zero in two cases: ... or all items are zero-length.

FWIW, this is a lie. Zero-length items do not result in zero sz unless
the separator itself is also surprisingly empty. Zero-length items is
not a special case worth mentioning IMO. The zero-size check should be
replaced with a direct (begin != end) check to avoid complexity and
confusion -- it is only needed to avoid dereferencing begin() AFAICT.


HTH,

Alex.


From squid3 at treenet.co.nz  Tue Nov  1 22:59:19 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 2 Nov 2016 11:59:19 +1300
Subject: [squid-dev] [PATCH] Support tunneling of bumped non-HTTP
 traffic. Other SslBump fixes.
In-Reply-To: <9ccad3bf-865c-e3b4-d3df-537a8673d335@chtsanti.net>
References: <20161014133016.Horde.z4XvK-tzo30mm9qVt-7tjNG@office.urlfilterdb.com>
 <90915e3a-7d70-f215-dfbf-a8401fe581a5@chtsanti.net>
 <97144092-6901-a51e-7ce8-945a8ee9b0ce@measurement-factory.com>
 <b823ebd2-acb9-908b-0b3e-cdabbddb8183@chtsanti.net>
 <48d54e6f-ab2d-a2fd-acc9-8cef534aab61@treenet.co.nz>
 <59f259cf-65d9-280b-d34e-599793990286@measurement-factory.com>
 <98336281-d2cd-886f-6649-cfaa0bc12c31@chtsanti.net>
 <03fe40fe-2978-6b75-343b-a233c3737b98@measurement-factory.com>
 <eb73b3e0-7b16-94ee-f1ed-36064e626059@chtsanti.net>
 <9791ec04-61b2-c1a0-b727-dc464783e90f@treenet.co.nz>
 <9ccad3bf-865c-e3b4-d3df-537a8673d335@chtsanti.net>
Message-ID: <0942b6a7-c100-539d-3319-6220eae3d5c8@treenet.co.nz>

On 2/11/2016 4:31 a.m., Christos Tsantilas wrote:
> On 10/28/2016 01:11 PM, Amos Jeffries wrote:
>> On 21/10/2016 3:55 a.m., Christos Tsantilas wrote:
>>>
>>> Support tunneling of bumped non-HTTP traffic. Other SslBump fixes.
>>>
>>> Use case: Skype groups appear to use TLS-encrypted MSNP protocol instead
>>> of HTTPS. This change allows Squid admins using SslBump to tunnel Skype
>>> groups and similar non-HTTP traffic bytes via "on_unsupported_protocol
>>> tunnel all". Previously, the combination resulted in encrypted HTTP 400
>>> (Bad Request) messages sent to the client (that does not speak HTTP).
>>>
>>> Also this patch:
>>>  * fixes bug 4529: !EBIT_TEST(entry->flags, ENTRY_FWD_HDR_WAIT)
>>>    assertion in FwdState.cc.
>>>
>>>  * when splicing transparent connections during SslBump step1, avoid
>>>    access-logging an extra record and log %ssl::bump_mode as the
>>> expected
>>>    "splice" not "none".
>>>
>>>  * handles an XXX comment inside clientTunnelOnError for possible memory
>>>    leak of client streams related objects
>>>
>>>  * fixes TunnelStateData logging in the case of splicing after peek.
>>>
>>> This is a Measurement Factory project.
>>
>>
>> Are any of these additional fixes able to be easily broken out into
>> separate patches? It would greatly help the auditing process to get
>> smaller patches.
>>
>> in src/FwdState.cc:
>>
>> * Most of the changed lines are a needless de-scoping of code.
>>  - note that the sub-scope existed to begin with so as to silence noisy
>> false-positives by static analysis tools (trunk rev.14790).
> 
> I make FwdState related fixes a separate patch and I remove it from main
> patch.
> Do you believe that the SQUID-211-FwdState_connectStart_cleanup-t1.patch
> will cause problems to Squid?
> We can just remove the line :
>   pinned_connection->stopPinnedConnectionMonitoring();
> 

It is not problems in Squid itself, but in the analysis tools being
confused. We can try this one and see how it goes.


>>
>>  - please take advantage of the surrounding code being re-written to
>> cleanup:
>>     if (peer_paths == NULL || peer_paths->size() < 1) {
>>         debugs(26, 3, HERE << "No paths found. Aborting CONNECT");
>> as:
>>     if (!peer_paths || peer_paths->size() < 1) {
>>         debugs(26, 3, "No paths found. Aborting CONNECT");
> 
> 
> I did not this fix Amos.
> I will make a separate commit after this patch committed if you want it.
> 

I'm okay with that. Please do it the way Alex suggested though that is
slightly better.

+1.

Amos

From noc at squid-cache.org  Tue Nov  1 22:59:45 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 1 Nov 2016 22:59:45 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23270?=
In-Reply-To: <193320159.45.1477987256624.JavaMail.jenkins@buildmaster>
References: <193320159.45.1477987256624.JavaMail.jenkins@buildmaster>
Message-ID: <1319384614.46.1478041185988.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/270/------------------------------------------
[...truncated 6787 lines...]
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
checking for egrep... ../../configure: line 7191: echo: write error: Broken pipe
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From garryd at comnet.uz  Wed Nov  2 08:12:31 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Wed, 02 Nov 2016 13:12:31 +0500
Subject: [squid-dev] [PATCH] Fix spelling for digest nonce cache maintenance
	event
Message-ID: <1478074351.11054.4.camel@comnet.uz>

Please apply the patch to fixspelling for digest nonce cache
maintenance event. The patch is for Squid 4.0.16. Thanks.

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_event_desc_digest_nonce_cache.patch
Type: text/x-patch
Size: 1224 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161102/76e73a88/attachment.bin>

From noc at squid-cache.org  Wed Nov  2 12:05:23 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Wed, 2 Nov 2016 12:05:23 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23271?=
In-Reply-To: <1319384614.46.1478041185988.JavaMail.jenkins@buildmaster>
References: <1319384614.46.1478041185988.JavaMail.jenkins@buildmaster>
Message-ID: <1490197303.47.1478088323413.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/271/------------------------------------------
[...truncated 6789 lines...]
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
checking for egrep... .././test-suite/../configure: line 7191: echo: write error: Broken pipe
checking for fgrep... .././test-suite/../configure: line 8238: echo: write error: Broken pipe
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Thu Nov  3 03:18:40 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 3 Nov 2016 16:18:40 +1300
Subject: [squid-dev] [PATCH] Fix spelling for digest nonce cache
 maintenance event
In-Reply-To: <1478074351.11054.4.camel@comnet.uz>
References: <1478074351.11054.4.camel@comnet.uz>
Message-ID: <25dc5571-9310-c298-e3ba-7606ccf975b8@treenet.co.nz>

On 2/11/2016 9:12 p.m., Garri Djavadyan wrote:
> Please apply the patch to fix spelling for digest nonce cache
> maintenance event. The patch is for Squid 4.0.16. Thanks.
> 

Thanks. Applied to trunk as rev.14910.

Amos


From noc at squid-cache.org  Thu Nov  3 08:01:48 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Thu, 3 Nov 2016 08:01:48 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23272?=
In-Reply-To: <1490197303.47.1478088323413.JavaMail.jenkins@buildmaster>
References: <1490197303.47.1478088323413.JavaMail.jenkins@buildmaster>
Message-ID: <1436706572.48.1478160108756.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/272/------------------------------------------
[...truncated 6785 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From gkinkie at gmail.com  Thu Nov  3 21:19:51 2016
From: gkinkie at gmail.com (Kinkie)
Date: Thu, 3 Nov 2016 21:19:51 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
Message-ID: <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>

On Tue, Nov 1, 2016 at 8:47 PM, Alex Rousskov
<rousskov at measurement-factory.com> wrote:
> On 11/01/2016 02:02 PM, Kinkie wrote:
>>   the attached patch extends SBufContainerJoin to have prefix and
>> suffix arguments. This can support a use-case which I found in the
>> current ACLRegexData work I'm following, where we need to transform
>> {"foo", "bar", "gazonk"}
>> into
>> (foo)|(bar)|(gazonk)
>>
>> It can be done with the current version of the SBufContainerJoin
>> function, but it requires one more copy.
>> There are probably further cases of this pattern elsewhere, all hand-rolled.
>
> I agree that the use case is legitimate, but the implementation does not
> solve the underlying cause -- extra copies.

It removes the need of one copy in a common use case, but it can do better.
It also has the drawback of iterating over a full container; reworking
to add a target SBuf and to use begin-end iterators instead of a
container.

> I recommend reworking this by adding a dest parameter:
>
> /// copies all container items (delimited by separator) into dest
> ...
> /// \returns dest
> SBuf &ContainerToSBuf(SBuf &dest, ...);
>
> and using that function to implement the SBufContainerJoin() or a
> similarly named convenience wrapper that does not require a dest
> parameter and that returns a copy of an internally used SBuf.

Can simply return the modified SBuf. All the convenience without the
bloat. Also taking the argument by copy; will cow if needed (passing
by reference makes for awkward client code as it'd have to be an
lvalue).
So the common pattern would be:

auto out = JoinContainerIntoSBuf(SBuf(), container.begin(),
container.end(), SBuf("separator"))

> In either case, please do not forget to document that the new prefix and
> suffix are always added, even if the container is empty.

Done.

>>      // sz can be zero in two cases: ... or all items are zero-length.
>
> FWIW, this is a lie. Zero-length items do not result in zero sz unless
> the separator itself is also surprisingly empty. Zero-length items is
> not a special case worth mentioning IMO. The zero-size check should be
> replaced with a direct (begin != end) check to avoid complexity and
> confusion -- it is only needed to avoid dereferencing begin() AFAICT.

Ok.

> HTH,

Sure does :)
Updated patch attached.


-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbufcontainerjoin-v2.patch
Type: application/octet-stream
Size: 3244 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161103/e03563fd/attachment.obj>

From noc at squid-cache.org  Thu Nov  3 22:34:47 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Thu, 3 Nov 2016 22:34:47 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23273?=
In-Reply-To: <1436706572.48.1478160108756.JavaMail.jenkins@buildmaster>
References: <1436706572.48.1478160108756.JavaMail.jenkins@buildmaster>
Message-ID: <520905179.49.1478212487347.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/273/------------------------------------------
[...truncated 6787 lines...]
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
checking for fgrep... .././test-suite/../configure: line 8238: echo: write error: Broken pipe
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From rousskov at measurement-factory.com  Thu Nov  3 22:55:46 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Thu, 3 Nov 2016 16:55:46 -0600
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
Message-ID: <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>

On 11/03/2016 03:19 PM, Kinkie wrote:
> On Tue, Nov 1, 2016 at 8:47 PM, Alex Rousskov wrote:
>> On 11/01/2016 02:02 PM, Kinkie wrote:
>>>   the attached patch extends SBufContainerJoin to have prefix and
>>> suffix arguments. 

>> I recommend reworking this by adding a dest parameter:
>> SBuf &ContainerToSBuf(SBuf &dest, ...);


> Can simply return the modified SBuf.

>  SBuf
> -SBufContainerJoin(const Container &items, const SBuf& separator)
> +JoinContainerIntoSBuf(SBuf dest, const ContainerIterator &begin,

This implementation does not avoid copies in a general case: When I
already have an SBuf with some content, I have to feed my writeable SBuf
to ContainerToSBuf() to avoid allocating and copying.

AFAICT, the reasonable implementation options are:

  1. Your old simpler implementation without "dest".
  2. A more efficient implementation with writeable "dest".

The latest implementation has the complexity of #2 but lacks its
efficiency. I do not think it is a good API.

Alex.


From noc at squid-cache.org  Fri Nov  4 04:28:15 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 4 Nov 2016 04:28:15 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23274?=
In-Reply-To: <520905179.49.1478212487347.JavaMail.jenkins@buildmaster>
References: <520905179.49.1478212487347.JavaMail.jenkins@buildmaster>
Message-ID: <1350354053.50.1478233695665.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/274/------------------------------------------
[...truncated 6785 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From gkinkie at gmail.com  Fri Nov  4 07:12:02 2016
From: gkinkie at gmail.com (Kinkie)
Date: Fri, 4 Nov 2016 07:12:02 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
Message-ID: <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>

On Thu, Nov 3, 2016 at 10:55 PM, Alex Rousskov
<rousskov at measurement-factory.com> wrote:
> On 11/03/2016 03:19 PM, Kinkie wrote:
>> On Tue, Nov 1, 2016 at 8:47 PM, Alex Rousskov wrote:
>>> On 11/01/2016 02:02 PM, Kinkie wrote:
>>>>   the attached patch extends SBufContainerJoin to have prefix and
>>>> suffix arguments.
>
>>> I recommend reworking this by adding a dest parameter:
>>> SBuf &ContainerToSBuf(SBuf &dest, ...);
>
>
>> Can simply return the modified SBuf.
>
>>  SBuf
>> -SBufContainerJoin(const Container &items, const SBuf& separator)
>> +JoinContainerIntoSBuf(SBuf dest, const ContainerIterator &begin,
>
> This implementation does not avoid copies in a general case: When I
> already have an SBuf with some content, I have to feed my writeable SBuf
> to ContainerToSBuf() to avoid allocating and copying.
>
> AFAICT, the reasonable implementation options are:
>
>   1. Your old simpler implementation without "dest".
>   2. A more efficient implementation with writeable "dest".

attached v3 does this.

> The latest implementation has the complexity of #2 but lacks its
> efficiency. I do not think it is a good API.

I am not generally worried as it seems you are about copying SBufs as
long as the underlying storage is not reallocated needlessly. But it's
very simple to express one call in terms of the other, so I'm doing
just that. I am convinced that the end result of our discussion is
better than what we had started with, and I'm grateful for that.


-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbufcontainerjoin-v3.patch
Type: application/octet-stream
Size: 3578 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161104/ad1da0e0/attachment.obj>

From squid3 at treenet.co.nz  Fri Nov  4 14:22:48 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 5 Nov 2016 03:22:48 +1300
Subject: [squid-dev] [PATCH] Faster SBuf::append
In-Reply-To: <a771a31e-4107-7d65-4b70-043ed7103b1a@measurement-factory.com>
References: <b41b7b8a-e746-0a9e-7028-b6c90c50c556@measurement-factory.com>
 <577e61de-5d80-2d94-147e-0f3bca72407b@treenet.co.nz>
 <a771a31e-4107-7d65-4b70-043ed7103b1a@measurement-factory.com>
Message-ID: <3084f248-8044-e834-c977-11d0d91f6bb3@treenet.co.nz>

On 7/10/2016 6:20 a.m., Alex Rousskov wrote:
> On 10/06/2016 10:57 AM, Amos Jeffries wrote:
> 
>> Please add a check to the unit test testSBuf::testAppendSBuf()
>> to guarantee that the (*this = S) assignment code path updates the store
>> reference count rather than doing a bit-wise copy of the SBuf.
> 
> I support that addition but do not have the time to implement it right
> now. It would also be nice to add a test case that the optimized
> assignment path does _not_ happen for pre-allocated SBufs.
> 

Test case added as trunk rev.14911

SBuf::append patch applied as trunk rev.14912

Amos

From christos at chtsanti.net  Fri Nov  4 17:45:42 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Fri, 4 Nov 2016 19:45:42 +0200
Subject: [squid-dev] [PATCH] Support tunneling of bumped non-HTTP
 traffic. Other SslBump fixes.
In-Reply-To: <0942b6a7-c100-539d-3319-6220eae3d5c8@treenet.co.nz>
References: <20161014133016.Horde.z4XvK-tzo30mm9qVt-7tjNG@office.urlfilterdb.com>
 <90915e3a-7d70-f215-dfbf-a8401fe581a5@chtsanti.net>
 <97144092-6901-a51e-7ce8-945a8ee9b0ce@measurement-factory.com>
 <b823ebd2-acb9-908b-0b3e-cdabbddb8183@chtsanti.net>
 <48d54e6f-ab2d-a2fd-acc9-8cef534aab61@treenet.co.nz>
 <59f259cf-65d9-280b-d34e-599793990286@measurement-factory.com>
 <98336281-d2cd-886f-6649-cfaa0bc12c31@chtsanti.net>
 <03fe40fe-2978-6b75-343b-a233c3737b98@measurement-factory.com>
 <eb73b3e0-7b16-94ee-f1ed-36064e626059@chtsanti.net>
 <9791ec04-61b2-c1a0-b727-dc464783e90f@treenet.co.nz>
 <9ccad3bf-865c-e3b4-d3df-537a8673d335@chtsanti.net>
 <0942b6a7-c100-539d-3319-6220eae3d5c8@treenet.co.nz>
Message-ID: <b32640e7-8952-32dd-4bdb-12252b25eb52@chtsanti.net>

The SQUID-211-Skype_groups_and_msnp_bypass-t11.patch applied to trunk as 
r14913
The SQUID-211-FwdState_connectStart_cleanup-t1.patch patch applied as r14914

The final applied patch has one more change over the t10 patch, it 
merges the ConnStateData::startPeekAndSplice() and 
CoinnStateData::startPeekAndSpliceDone() to one method.
This is possible because the r14898 and this patch removes any extra 
call from old startPeekAndSplice method.

I am attaching the final patch as t11.


On 11/02/2016 12:59 AM, Amos Jeffries wrote:
> On 2/11/2016 4:31 a.m., Christos Tsantilas wrote:
>> On 10/28/2016 01:11 PM, Amos Jeffries wrote:
>>> On 21/10/2016 3:55 a.m., Christos Tsantilas wrote:
>>>>
>>>> Support tunneling of bumped non-HTTP traffic. Other SslBump fixes.
>>>>
>>>> Use case: Skype groups appear to use TLS-encrypted MSNP protocol instead
>>>> of HTTPS. This change allows Squid admins using SslBump to tunnel Skype
>>>> groups and similar non-HTTP traffic bytes via "on_unsupported_protocol
>>>> tunnel all". Previously, the combination resulted in encrypted HTTP 400
>>>> (Bad Request) messages sent to the client (that does not speak HTTP).
>>>>
>>>> Also this patch:
>>>>  * fixes bug 4529: !EBIT_TEST(entry->flags, ENTRY_FWD_HDR_WAIT)
>>>>    assertion in FwdState.cc.
>>>>
>>>>  * when splicing transparent connections during SslBump step1, avoid
>>>>    access-logging an extra record and log %ssl::bump_mode as the
>>>> expected
>>>>    "splice" not "none".
>>>>
>>>>  * handles an XXX comment inside clientTunnelOnError for possible memory
>>>>    leak of client streams related objects
>>>>
>>>>  * fixes TunnelStateData logging in the case of splicing after peek.
>>>>
>>>> This is a Measurement Factory project.
>>>
>>>
>>> Are any of these additional fixes able to be easily broken out into
>>> separate patches? It would greatly help the auditing process to get
>>> smaller patches.
>>>
>>> in src/FwdState.cc:
>>>
>>> * Most of the changed lines are a needless de-scoping of code.
>>>  - note that the sub-scope existed to begin with so as to silence noisy
>>> false-positives by static analysis tools (trunk rev.14790).
>>
>> I make FwdState related fixes a separate patch and I remove it from main
>> patch.
>> Do you believe that the SQUID-211-FwdState_connectStart_cleanup-t1.patch
>> will cause problems to Squid?
>> We can just remove the line :
>>   pinned_connection->stopPinnedConnectionMonitoring();
>>
>
> It is not problems in Squid itself, but in the analysis tools being
> confused. We can try this one and see how it goes.
>
>
>>>
>>>  - please take advantage of the surrounding code being re-written to
>>> cleanup:
>>>     if (peer_paths == NULL || peer_paths->size() < 1) {
>>>         debugs(26, 3, HERE << "No paths found. Aborting CONNECT");
>>> as:
>>>     if (!peer_paths || peer_paths->size() < 1) {
>>>         debugs(26, 3, "No paths found. Aborting CONNECT");
>>
>>
>> I did not this fix Amos.
>> I will make a separate commit after this patch committed if you want it.
>>
>
> I'm okay with that. Please do it the way Alex suggested though that is
> slightly better.
>
> +1.
>
> Amos
>


-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-211-Skype_groups_and_msnp_bypass-t11.patch
Type: text/x-patch
Size: 91909 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161104/bbbea014/attachment-0001.bin>

From rousskov at measurement-factory.com  Fri Nov  4 18:12:48 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Fri, 4 Nov 2016 12:12:48 -0600
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
Message-ID: <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>

On 11/04/2016 01:12 AM, Kinkie wrote:
> On Thu, Nov 3, 2016 at 10:55 PM, Alex Rousskov
> <rousskov at measurement-factory.com> wrote:
>> On 11/03/2016 03:19 PM, Kinkie wrote:
>>> On Tue, Nov 1, 2016 at 8:47 PM, Alex Rousskov wrote:
>>>> On 11/01/2016 02:02 PM, Kinkie wrote:
>>>>>   the attached patch extends SBufContainerJoin to have prefix and
>>>>> suffix arguments.
>>
>>>> I recommend reworking this by adding a dest parameter:
>>>> SBuf &ContainerToSBuf(SBuf &dest, ...);

> attached v3 does this.

>  SBuf
> +JoinContainerIntoSBuf(SBuf &dest, ...

Please return dest, not a copy of it. There is no reason to create and
destroy a new SBuf object here IMO. SBuf creation and destruction are
not as expensive as underlying storage copying, but they are still a
measurable expense without justification AFAICT.

There are certainly many cases where using references is a bad idea but
returning a fed-by-reference "dest" is not one of them AFAICT. In fact,
it is nearly the norm in "chainable" calls such as those that append
something.


> +/// variant of JoinContainerIntoSBuf not needing a SBuf lvalue

I recommend a more informative description than retelling of the
function declaration code. For example:

/// convenience JoinContainerIntoSBuf() wrapper with an extra memory
allocation

> +    dest.reserveSpace(sz + prefix.length() + suffix.length());

I would reorder the operands to make the code more self-documenting,
especially when using an anonymous variable name like "sz":

  dest.reserveSpace(prefix.length() + sz + suffix.length());


> I am not generally worried as it seems you are about copying SBufs as
> long as the underlying storage is not reallocated needlessly. 

Unfortunately, all three patch versions reallocate storage needlessly
(for various reasons). You can study the attached debugging from the
attached patch to see what is actually going on in various
JoinContainerIntoSBuf implementations. It may surprise and inspire you
to make the code better. It did surprise and inspire me (but I wish I
was not doing this legwork!).


Thank you,

Alex.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbuf-alloc.log
Type: text/x-log
Size: 8233 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161104/3b8dcbc9/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbuf-alloc.patch
Type: text/x-diff
Size: 3301 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161104/3b8dcbc9/attachment.patch>

From rousskov at measurement-factory.com  Fri Nov  4 19:50:30 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Fri, 4 Nov 2016 13:50:30 -0600
Subject: [squid-dev] [PATCH] Faster SBuf::append
In-Reply-To: <3084f248-8044-e834-c977-11d0d91f6bb3@treenet.co.nz>
References: <b41b7b8a-e746-0a9e-7028-b6c90c50c556@measurement-factory.com>
 <577e61de-5d80-2d94-147e-0f3bca72407b@treenet.co.nz>
 <a771a31e-4107-7d65-4b70-043ed7103b1a@measurement-factory.com>
 <3084f248-8044-e834-c977-11d0d91f6bb3@treenet.co.nz>
Message-ID: <3192339b-d807-f3be-2720-e4313b0dc318@measurement-factory.com>

On 11/04/2016 08:22 AM, Amos Jeffries wrote:
> On 7/10/2016 6:20 a.m., Alex Rousskov wrote:
>> On 10/06/2016 10:57 AM, Amos Jeffries wrote:
>>
>>> Please add a check to the unit test testSBuf::testAppendSBuf()
>>> to guarantee that the (*this = S) assignment code path updates the store
>>> reference count rather than doing a bit-wise copy of the SBuf.
>>
>> I support that addition but do not have the time to implement it right
>> now. It would also be nice to add a test case that the optimized
>> assignment path does _not_ happen for pre-allocated SBufs.
>>
> 
> Test case added as trunk rev.14911
> 
> SBuf::append patch applied as trunk rev.14912

Thank you,

Alex.


From noc at squid-cache.org  Sat Nov  5 08:37:44 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 5 Nov 2016 08:37:44 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23275?=
In-Reply-To: <1350354053.50.1478233695665.JavaMail.jenkins@buildmaster>
References: <1350354053.50.1478233695665.JavaMail.jenkins@buildmaster>
Message-ID: <1520823857.51.1478335065048.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/275/------------------------------------------
[...truncated 6785 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov  5 20:27:40 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 5 Nov 2016 20:27:40 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23276?=
In-Reply-To: <1520823857.51.1478335065048.JavaMail.jenkins@buildmaster>
References: <1520823857.51.1478335065048.JavaMail.jenkins@buildmaster>
Message-ID: <2110000572.52.1478377660396.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/276/------------------------------------------
[...truncated 6789 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From gkinkie at gmail.com  Sat Nov  5 20:57:36 2016
From: gkinkie at gmail.com (Kinkie)
Date: Sat, 5 Nov 2016 20:57:36 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
Message-ID: <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>

On Fri, Nov 4, 2016 at 6:12 PM, Alex Rousskov
<rousskov at measurement-factory.com> wrote:
> On 11/04/2016 01:12 AM, Kinkie wrote:
>> On Thu, Nov 3, 2016 at 10:55 PM, Alex Rousskov
>> <rousskov at measurement-factory.com> wrote:
>>> On 11/03/2016 03:19 PM, Kinkie wrote:
>>>> On Tue, Nov 1, 2016 at 8:47 PM, Alex Rousskov wrote:
>>>>> On 11/01/2016 02:02 PM, Kinkie wrote:
>>>>>>   the attached patch extends SBufContainerJoin to have prefix and
>>>>>> suffix arguments.
>>>
>>>>> I recommend reworking this by adding a dest parameter:
>>>>> SBuf &ContainerToSBuf(SBuf &dest, ...);
>
>> attached v3 does this.
>
>>  SBuf
>> +JoinContainerIntoSBuf(SBuf &dest, ...
>
> Please return dest, not a copy of it. There is no reason to create and
> destroy a new SBuf object here IMO. SBuf creation and destruction are
> not as expensive as underlying storage copying, but they are still a
> measurable expense without justification AFAICT.

Doh, right. I had actually thought about this after sending the patch.

> There are certainly many cases where using references is a bad idea but
> returning a fed-by-reference "dest" is not one of them AFAICT. In fact,
> it is nearly the norm in "chainable" calls such as those that append
> something.

I agree that this case fits perfectly.

>> +/// variant of JoinContainerIntoSBuf not needing a SBuf lvalue
>
> I recommend a more informative description than retelling of the
> function declaration code. For example:
>
> /// convenience JoinContainerIntoSBuf() wrapper with an extra memory
> allocation

The extra memory allocation is a side effect; I agree it is a
convenience, but the convenience is in not needing a SBuf lvalue. This
makes it useable e.g. in ostreams

>
>> +    dest.reserveSpace(sz + prefix.length() + suffix.length());
>
> I would reorder the operands to make the code more self-documenting,
> especially when using an anonymous variable name like "sz":
>
>   dest.reserveSpace(prefix.length() + sz + suffix.length());

Ok. I'm also renaming sz for extra clarity.

>
>
>> I am not generally worried as it seems you are about copying SBufs as
>> long as the underlying storage is not reallocated needlessly.
>
> Unfortunately, all three patch versions reallocate storage needlessly
> (for various reasons). You can study the attached debugging from the
> attached patch to see what is actually going on in various
> JoinContainerIntoSBuf implementations. It may surprise and inspire you
> to make the code better. It did surprise and inspire me (but I wish I
> was not doing this legwork!).

Sorry about that causing extra work for you.

Updated patch attached. I'm struggling a bit with the convenience
wrapper documentation. Note that the wrapper cannot return a ref,
intentionally so. I hope RVO will optimize that cost away as much as
possible.

-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbufcontainerjoin-v4.patch
Type: application/octet-stream
Size: 5090 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161105/85fb1a46/attachment-0001.obj>

From rousskov at measurement-factory.com  Sun Nov  6 02:10:33 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sat, 5 Nov 2016 20:10:33 -0600
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
Message-ID: <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>

On 11/05/2016 02:57 PM, Kinkie wrote:
> On Fri, Nov 4, 2016 at 6:12 PM, Alex Rousskov wrote:
>> On 11/04/2016 01:12 AM, Kinkie wrote:
>>> +/// variant of JoinContainerIntoSBuf not needing a SBuf lvalue

>> I recommend a more informative description than retelling of the
>> function declaration code. For example:
>>
>> /// convenience JoinContainerIntoSBuf() wrapper with an extra memory
>> allocation


> The extra memory allocation is a side effect; 

Some side effects, like this one, are very important to document,
_especially_ because they are invisible to the caller. If I am looking
for a convenience function to call, I do want to know whether that
convenience comes at a price.


> the convenience is in not needing a SBuf lvalue.

Yes.


> This makes it useable e.g. in ostreams

Both functions are usable with ostream, but the convenience wrapper is
more convenient to use, naturally. There is nothing wrong with that! You
just need to warn folks that they are probably paying one memory
allocation/destruction for that convenience. In many cases, that price
is perfectly reasonable, of course. We just need to disclose it.


> Note that the wrapper cannot return a ref, intentionally so.

Yes, of course. As far as the wrapper is concerned, it is only a
question of disclosing that the wrapper is a costly function. The cost
does not come from the return type. It comes from the lack of a
pre-allocated caller's buffer to accumulate the results in.


>> Unfortunately, all three patch versions reallocate storage needlessly
>> (for various reasons). You can study the attached debugging from the
>> attached patch to see what is actually going on in various
>> JoinContainerIntoSBuf implementations. It may surprise and inspire you
>> to make the code better. It did surprise and inspire me (but I wish I
>> was not doing this legwork!).

> Updated patch attached. 

> +    dest.reserveSpace(prefix.length() + totalContainerSize + suffix.length());

Please note that v4 still allocates memory according to my last
experiment. See JoinContainerIntoSBuf3() which mimics your patch v4. You
may claim that the unnecessary allocation is not the fault of this
patch, and you could be right, but I was hoping this observation will
inspire you to change

* either your patch (mimicking my JoinContainerIntoSBuf4() which does
not result in extra allocation) reserveSpace()

* or reserveSpace() (after making sure that all callers are going to be
OK with that change).

The latter would be better if it is possible. If it is not possible,
then we may need to change reserveSpace() documentation so that folks do
not use that method like you did.


HTH,

Alex.


From gkinkie at gmail.com  Sun Nov  6 07:15:25 2016
From: gkinkie at gmail.com (Kinkie)
Date: Sun, 6 Nov 2016 07:15:25 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
Message-ID: <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>

>> +    dest.reserveSpace(prefix.length() + totalContainerSize + suffix.length());
>
> Please note that v4 still allocates memory according to my last
> experiment. See JoinContainerIntoSBuf3() which mimics your patch v4. You
> may claim that the unnecessary allocation is not the fault of this
> patch, and you could be right, but I was hoping this observation will
> inspire you to change

I don't follow. The space requirement in JoinContainerIntoSBuf is not
advisory. The accumulate at the beginning of the function is meant to
calculate exactly how much space is needed, to copy (if needed) only
once and early.

> * either your patch (mimicking my JoinContainerIntoSBuf4() which does
> not result in extra allocation) reserveSpace()

The traces you provided do not reallocate there because the underlying
MemBlob has grown enough in previous calls to have enough free space
to cover the projected needs (it was resized last at
JoinContainerIntoSBuf3).

In other words, the test data is dirtied as the tests progress.
Follow with me:
2016/11/04 11:47:21.841| 24,8| SBuf.cc(42) SBuf: SBuf2698 created
2016/11/04 11:47:21.841| 24,8| SBuf.cc(908) cow: SBuf2698 new size:1024
2016/11/04 11:47:21.841| 24,8| SBuf.cc(878) reAlloc: SBuf2698 new size: 1024

But then:

2016/11/04 11:47:21.841| 1,2| AccessLogEntry.cc(47)
JoinContainerIntoSBuf2: started
2016/11/04 11:47:21.841| 1,2| AccessLogEntry.cc(48)
JoinContainerIntoSBuf2: did not create an empty buf
2016/11/04 11:47:21.841| 24,8| SBuf.cc(908) cow: SBuf2698 new size:124
2016/11/04 11:47:21.841| 24,8| SBuf.cc(878) reAlloc: SBuf2698 new size: 124

This is correct behavior: the code advises that it only needs that
much storage and the SBuf shrinks. It's passed by reference, so from
now on 'buffer' has 124 bytes of storage instead of the pre-allocated
1024.

As a demonstration, swapping order of tests 3 and 4 results in:
[...]
2016/11/06 07:05:47.860 kid1| 1,2| main.cc(457) JoinContainerIntoSBuf4: started
2016/11/06 07:05:47.860 kid1| 24,8| SBuf.cc(130) reserve: SBuf3657
was: 0+81+47=128
2016/11/06 07:05:47.860 kid1| 24,8| SBuf.cc(912) cow: SBuf3657 new size:181
2016/11/06 07:05:47.860 kid1| 24,8| SBuf.cc(882) reAlloc: SBuf3657 new size: 181
2016/11/06 07:05:47.860 kid1| 24,8| MemBlob.cc(101) memAlloc: blob2420
memAlloc: requested=181, received=512
2016/11/06 07:05:47.860 kid1| 24,7| SBuf.cc(891) reAlloc: SBuf3657 new
store capacity: 512
2016/11/06 07:05:47.860 kid1| 24,7| SBuf.cc(146) reserve: SBuf3657
now: 0+81+431=512
2016/11/06 07:05:47.860 kid1| 1,2| main.cc(462)
JoinContainerIntoSBuf4: reserved space
2016/11/06 07:05:47.860 kid1| 24,7| SBuf.cc(154) rawSpace: reserving 7
for SBuf3657
2016/11/06 07:05:47.860 kid1| 24,7| SBuf.cc(161) rawSpace: SBuf3657 not growing


I don't think however that we should change reserveSpace() behavior
not to ever shrink; there may be use cases where it's better not to do
it in fact. At the same time, it's not a matter of API: the extended
reserve() has the same behavior as the "problem" is elsewhere.

>
> * or reserveSpace() (after making sure that all callers are going to be
> OK with that change).
>
> The latter would be better if it is possible. If it is not possible,
> then we may need to change reserveSpace() documentation so that folks do
> not use that method like you did.

What we could do is:
- define a reserveMinSpace() which does not shrink storage
- reimplement both reserveSpace() and reserveMinSpace() as convenience
wrappers around reserve() which is undoubtably more powerful
- while we're at it, give SBufReservationRequirements a convenience constructor

What do you think?
Thanks.

-- 
    Francesco

From garryd at comnet.uz  Sun Nov  6 11:08:01 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Sun, 06 Nov 2016 16:08:01 +0500
Subject: [squid-dev] [PATCH] Fix spelling for digest nonce cache
 maintenance event
In-Reply-To: <25dc5571-9310-c298-e3ba-7606ccf975b8@treenet.co.nz>
References: <1478074351.11054.4.camel@comnet.uz>
 <25dc5571-9310-c298-e3ba-7606ccf975b8@treenet.co.nz>
Message-ID: <974741c583dc08bc7e201fda939c02fe@comnet.uz>

On 2016-11-03 08:18, Amos Jeffries wrote:
> On 2/11/2016 9:12 p.m., Garri Djavadyan wrote:
>> Please apply the patch to fix spelling for digest nonce cache
>> maintenance event. The patch is for Squid 4.0.16. Thanks.
>> 
> 
> Thanks. Applied to trunk as rev.14910.
> 
> Amos

Same problem in 3.5 branch. The patch is attached.

Thanks.


Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_event_desc_digest_nonce_cache_v3.5.patch
Type: text/x-diff
Size: 1224 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161106/b771cca4/attachment.patch>

From noc at squid-cache.org  Sun Nov  6 22:23:50 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sun, 6 Nov 2016 22:23:50 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23277?=
In-Reply-To: <2110000572.52.1478377660396.JavaMail.jenkins@buildmaster>
References: <2110000572.52.1478377660396.JavaMail.jenkins@buildmaster>
Message-ID: <566033686.53.1478471030706.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/277/------------------------------------------
[...truncated 6785 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From rousskov at measurement-factory.com  Mon Nov  7 01:02:16 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 6 Nov 2016 18:02:16 -0700
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
Message-ID: <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>

On 11/06/2016 01:15 AM, Kinkie wrote:
>>> +    dest.reserveSpace(prefix.length() + totalContainerSize + suffix.length());
>>
>> Please note that v4 still allocates memory according to my last
>> experiment. See JoinContainerIntoSBuf3() which mimics your patch v4. You
>> may claim that the unnecessary allocation is not the fault of this
>> patch, and you could be right, but I was hoping this observation will
>> inspire you to change
> 
> I don't follow. The space requirement in JoinContainerIntoSBuf is not
> advisory. The accumulate at the beginning of the function is meant to
> calculate exactly how much space is needed, to copy (if needed) only
> once and early.

What you say is true except for the "if needed" part. In some cases,
JoinContainerIntoSBuf() allocates and copies without needed. Those extra
allocations are present in v1, v2, v3, and v4 versions of the patch, but
the reasons behind those unnecessary allocations varied.


> The traces you provided do not reallocate there because the underlying
> MemBlob has grown enough in previous calls to have enough free space
> to cover the projected needs (it was resized last at
> JoinContainerIntoSBuf3).

No, "has grown enough" is not the reason why JoinContainerIntoSBuf4()
does not reallocate needlessly.


> In other words, the test data is dirtied as the tests progress.

My tests were indeed dirty (sorry) and could have easily led to wrong
conclusions, but they did not. The cleaned up version (attached) shows
exactly the same problem, this time without any effect of earlier tests
on later tests.


> This is correct behavior: the code advises that it only needs that
> much storage and the SBuf shrinks.

Violating explicit STL reserve() guarantees is rarely a good idea but,
for now, I will not argue about what reserveSpace() should do. I will
focus on JoinContainerIntoSBuf() instead.

Tests and code analysis show that JoinContainerIntoSBuf() allocates when
no allocation is needed. I have also shown that it is possible to
implement JoinContainerIntoSBuf() so that there is no extra allocation.
AFAICT, going forward, you choices are:

* state that the extra allocation is not your fault, leaving it as is,
  and/or
* fix JoinContainerIntoSBuf() to avoid the extra allocation.

When you added the "dest" parameter, you have started moving in the
latter direction.


> As a demonstration, swapping order of tests 3 and 4 results in:

[Snipped wrong conclusions based on confusing dirty tests.
 See cleaned up order-independent tests instead.]


> At the same time, it's not a matter of API: the extended
> reserve() has the same behavior as the "problem" is elsewhere.

Whether SBuf::reserve() has the same behavior as reserveSpace() depends
on reserve() configuration parameters.

JoinContainerIntoSBuf() should configure reserve() in such a way that
reserve() does _not_ have the same behavior as reserveSpace(). I showed
how to do that in JoinContainerIntoSBuf4() in my earlier patch. The
patch attached now has an even simpler JoinContainerIntoSBuf5()
implementation because I fixed reserve() to not require the .ideal
configuration parameter to be set (trunk r14917).



> What we could do is:
> - define a reserveMinSpace() which does not shrink storage

Having two methods called reserveMinSpace() and reserveSpace(), one of
which does not shrink and the other one does, makes no sense to me
because the method names do not reflect that difference at all and
because reserve() is always primarily about "minimum" space anyway.

More importantly, reserveSpace() guarantees single ownership. IMO,
shrinking is essentially a side effect of that guarantee.

I suspect we do not need a "provide single-ownership space, shrinking
the existing single-owned MemBlob if there is one" method, but if you
have some existing use cases for it, please share them. If there are no
such cases, reserveSpace()/reserveCapacity() should be optimized to
avoid unnecessary re-allocation when their MemBlob is already not
shared, but that is a different story, unrelated to JoinContainerIntoSBuf!


> - reimplement [...] reserveSpace() as convenience wrapper around reserve()

Sure, but that is outside this patch scope.


> - while we're at it, give SBufReservationRequirements a convenience constructor

With minSpace as the only parameter? Sure. Please do not forget
"explicit". Again, that seems to be outside your patch scope.

I do not recommend providing more than one constructor parameter though
because constructors with multiple same- or similar-type parameters are
a recipe for mismatching parameters disasters.


HTH,

Alex.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbuf-alloc-t2.patch
Type: text/x-diff
Size: 4098 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161106/7b6067aa/attachment-0001.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbuf-alloc-t2.log
Type: text/x-log
Size: 11932 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161106/7b6067aa/attachment-0001.bin>

From noc at squid-cache.org  Mon Nov  7 11:30:55 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 7 Nov 2016 11:30:55 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-ubuntu-wily_=23278?=
In-Reply-To: <566033686.53.1478471030706.JavaMail.jenkins@buildmaster>
References: <566033686.53.1478471030706.JavaMail.jenkins@buildmaster>
Message-ID: <1378971269.54.1478518256003.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/278/------------------------------------------
[...truncated 6785 lines...]
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NCSA'>
Making dvi in NIS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/NIS'>
Making dvi in POP3
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/POP3'>
Making dvi in RADIUS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/RADIUS'>
Making dvi in SMB
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/SMB'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/fake'>
Making dvi in getpwnam
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic/getpwnam'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/basic'>
Making dvi in digest
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in file
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest/file'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/digest'>
Making dvi in negotiate
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in wrapper
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate/wrapper'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/negotiate'>
Making dvi in ntlm
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth/ntlm'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/auth'>
Making dvi in http
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in one
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/one'>
Making dvi in url_rewriters
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
Making dvi in LFS
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/LFS'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http/url_rewriters'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/http'>
Making dvi in ip
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ip'>
Making dvi in icmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/icmp'>
Making dvi in ident
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ident'>
Making dvi in log
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in DB
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/DB'>
Making dvi in file
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log/file'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/log'>
Making dvi in ipc
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/ipc'>
Making dvi in mgr
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/mgr'>
Making dvi in security
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in cert_generators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_generators'>
Making dvi in cert_validators
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
Making dvi in fake
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Nothing to be done for 'dvi'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators/fake'>
make[5]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[5]: Nothing to be done for 'dvi-am'.
make[5]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security/cert_validators'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/security'>
Making dvi in snmp
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/snmp'>
Making dvi in adaptation
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
Making dvi in icap
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Nothing to be done for 'dvi'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation/icap'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src/adaptation'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/src'>
Making dvi in tools
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in helper-mux
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/helper-mux'>
Making dvi in purge
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/purge'>
Making dvi in squidclient
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[4]: Nothing to be done for 'dvi-am'.
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/squidclient'>
Making dvi in systemd
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/systemd'>
Making dvi in sysvinit
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Nothing to be done for 'dvi'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools/sysvinit'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[3]: Nothing to be done for 'dvi-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/tools'>
Making dvi in test-suite
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Nothing to be done for 'dvi'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/test-suite'>
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[2]: Nothing to be done for 'dvi-am'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
make[1]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Making check in compat
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
make  testPreCompiler
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
depbase=`echo testPreCompiler.o | sed 's|[^/]*$|.deps/&|;s|\.o$||'`;\
ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include     -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11 -MT testPreCompiler.o -MD -MP -MF $depbase.Tpo -c -o testPreCompiler.o ../../../compat/testPreCompiler.cc &&\
mv -f $depbase.Tpo $depbase.Po
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2 -std=c++11  -g -o testPreCompiler testPreCompiler.o -lcppunit  
libtool: link: ccache clang++ -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2 -std=c++11 -g -o testPreCompiler testPreCompiler.o  -lcppunit
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Makefile:871: recipe for target 'testPreCompiler' failed
make[3]: *** [testPreCompiler] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:1213: recipe for target 'check-am' failed
make[2]: *** [check-am] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub/compat'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-ubuntu-wily/ws/btlayer-00-default/squid-4.0.16-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS:  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
testPreCompiler.o:(.rodata._ZTVN7CppUnit10TestCallerI15testPreCompilerEE[_ZTVN7CppUnit10TestCallerI15testPreCompilerEE]+0x40): undefined reference to `CppUnit::TestCase::getName() const'
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [testPreCompiler] Error 1
make[2]: *** [check-am] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Mon Nov  7 13:49:24 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 7 Nov 2016 13:49:24 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-matrix_?=
 =?utf-8?q?=C2=BB_gcc=2Cd-debian-unstable_=23834?=
Message-ID: <974738136.55.1478526564078.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/834/------------------------------------------
[...truncated 32113 lines...]
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Mon Nov  7 14:31:45 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 7 Nov 2016 14:31:45 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_gcc=2Cd-debian-unstable_=23278?=
Message-ID: <1863390969.56.1478529105187.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/278/------------------------------------------
[...truncated 32114 lines...]
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Mon Nov  7 15:12:52 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 7 Nov 2016 15:12:52 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-full-matri?=
 =?utf-8?q?x_=C2=BB_clang=2Cd-debian-unstable_=23278?=
Message-ID: <1717630608.57.1478531572250.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/278/------------------------------------------
[...truncated 32103 lines...]
/bin/bash ../libtool  --tag=CC   --mode=compile ccache clang -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Werror -Qunused-arguments  -D_REENTRANT -g -O2 -MT radix.lo -MD -MP -MF $depbase.Tpo -c -o radix.lo ../../../lib/radix.c &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo rfc1123.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache clang -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Werror -Qunused-arguments  -D_REENTRANT -g -O2 -MT rfc1123.lo -MD -MP -MF $depbase.Tpo -c -o rfc1123.lo ../../../lib/rfc1123.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT heap.lo -MD -MP -MF .deps/heap.Tpo -c ../../../lib/heap.c  -fPIC -DPIC -o heap.o >/dev/null 2>&1
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT radix.lo -MD -MP -MF .deps/radix.Tpo -c ../../../lib/radix.c  -fPIC -DPIC -o .libs/radix.o
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT rfc1123.lo -MD -MP -MF .deps/rfc1123.Tpo -c ../../../lib/rfc1123.c  -fPIC -DPIC -o .libs/rfc1123.o
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT hash.lo -MD -MP -MF .deps/hash.Tpo -c ../../../lib/hash.cc  -fPIC -DPIC -o hash.o >/dev/null 2>&1
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT rfc1123.lo -MD -MP -MF .deps/rfc1123.Tpo -c ../../../lib/rfc1123.c  -fPIC -DPIC -o rfc1123.o >/dev/null 2>&1
depbase=`echo Splay.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Splay.lo -MD -MP -MF $depbase.Tpo -c -o Splay.lo ../../../lib/Splay.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo stub_memaccount.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache clang -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Werror -Qunused-arguments  -D_REENTRANT -g -O2 -MT stub_memaccount.lo -MD -MP -MF $depbase.Tpo -c -o stub_memaccount.lo ../../../lib/stub_memaccount.c &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo util.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache clang -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Werror -Qunused-arguments  -D_REENTRANT -g -O2 -MT util.lo -MD -MP -MF $depbase.Tpo -c -o util.lo ../../../lib/util.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT radix.lo -MD -MP -MF .deps/radix.Tpo -c ../../../lib/radix.c  -fPIC -DPIC -o radix.o >/dev/null 2>&1
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache clang -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Werror -Qunused-arguments  -D_REENTRANT -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache clang -Werror -Qunused-arguments  -D_REENTRANT -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache clang -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Werror -Qunused-arguments -D_REENTRANT -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache clang++ -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache clang++ -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
../../../src/cf_gen.cc:261:21: warning: enumeration value 'sEXIT' not handled in switch [-Wswitch]
            switch (state) {
                    ^
1 warning generated.
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache clang++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
In file included from ../../../../src/mem/old_api.cc:24:
In file included from ../../../../src/SquidConfig.h:21:
In file included from ../../../../src/security/forward.h:13:
../../../../src/security/Context.h:29:51: error: use of undeclared identifier 'CRYPTO_LOCK_SSL_CTX'
typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                  ^
In file included from ../../../../src/mem/old_api.cc:24:
In file included from ../../../../src/SquidConfig.h:21:
In file included from ../../../../src/security/forward.h:14:
../../../../src/security/Session.h:33:53: error: use of undeclared identifier 'CRYPTO_LOCK_SSL'
typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                    ^
In file included from ../../../../src/mem/old_api.cc:24:
In file included from ../../../../src/SquidConfig.h:21:
../../../../src/security/forward.h:53:55: error: use of undeclared identifier 'CRYPTO_LOCK_X509'
typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                      ^
../../../../src/security/forward.h:63:53: error: use of undeclared identifier 'CRYPTO_LOCK_X509_CRL'
typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                    ^
../../../../src/security/forward.h:77:51: error: use of undeclared identifier 'CRYPTO_LOCK_DH'
typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                  ^
In file included from ../../../../src/mem/old_api.cc:24:
In file included from ../../../../src/SquidConfig.h:24:
In file included from ../../../../src/ssl/support.h:20:
../../../../src/ssl/gadgets.h:49:63: error: use of undeclared identifier 'CRYPTO_LOCK_EVP_PKEY'
typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                              ^
6 errors generated.
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache clang++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Werror -Qunused-arguments -Wno-deprecated-register -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-full-matrix/compiler=clang,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -g -O2
configure: BUILD EXTRA C FLAGS:  -Werror -Qunused-arguments  -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2  -Werror -Qunused-arguments -Wno-deprecated-register  -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2 -std=c++11
../../../../src/security/Context.h:29:51: error: use of undeclared identifier 'CRYPTO_LOCK_SSL_CTX'
../../../../src/security/Session.h:33:53: error: use of undeclared identifier 'CRYPTO_LOCK_SSL'
../../../../src/security/forward.h:53:55: error: use of undeclared identifier 'CRYPTO_LOCK_X509'
../../../../src/security/forward.h:63:53: error: use of undeclared identifier 'CRYPTO_LOCK_X509_CRL'
../../../../src/security/forward.h:77:51: error: use of undeclared identifier 'CRYPTO_LOCK_DH'
../../../../src/ssl/gadgets.h:49:63: error: use of undeclared identifier 'CRYPTO_LOCK_EVP_PKEY'
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Mon Nov  7 19:19:49 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 7 Nov 2016 19:19:49 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-matrix_?=
 =?utf-8?q?=C2=BB_gcc=2Cd-debian-unstable_=23835?=
In-Reply-To: <974738136.55.1478526564078.JavaMail.jenkins@buildmaster>
References: <974738136.55.1478526564078.JavaMail.jenkins@buildmaster>
Message-ID: <1657069786.58.1478546389803.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/835/------------------------------------------
[...truncated 32112 lines...]
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Tue Nov  8 07:38:14 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 8 Nov 2016 07:38:14 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_trunk-matrix_?=
 =?utf-8?q?=C2=BB_gcc=2Cd-debian-unstable_=23836?=
In-Reply-To: <1657069786.58.1478546389803.JavaMail.jenkins@buildmaster>
References: <1657069786.58.1478546389803.JavaMail.jenkins@buildmaster>
Message-ID: <675541174.59.1478590694085.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/836/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT rfc1123.lo -MD -MP -MF .deps/rfc1123.Tpo -c ../../../lib/rfc1123.c  -fPIC -DPIC -o rfc1123.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/trunk-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From eduard.bagdasaryan at measurement-factory.com  Tue Nov  8 14:05:57 2016
From: eduard.bagdasaryan at measurement-factory.com (Eduard Bagdasaryan)
Date: Tue, 8 Nov 2016 17:05:57 +0300
Subject: [squid-dev] [PATCH] ICAP trailer support
Message-ID: <5821DBC5.2080904@measurement-factory.com>

Hello,

This patch introduces the initial ICAP trailer support. ICAP trailers are
currently specified by
https://datatracker.ietf.org/doc/draft-rousskov-icap-trailers/. For now,
Squid logs and ignores all parsed ICAP header fields.  In future we plan
to add code for using ICAP trailers for transaction annotations and
access logging.

Also refactored HttpHeader parsing methods in order to reuse them for
ICAP trailer parsing.

Also simplified and fixed headers isolating code while dealing with
empty (i.e. zero header fields) headers. Old httpMsgIsolateHeaders()
tried to re-implement header end detection/processing logic that is
actually covered by headersEnd(). Old httpMsgIsolateHeaders() could
return success for some garbage input (e.g., a buffer of several CRs)
even if no end of headers was found.

Regards,
Eduard.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-157-parse-icap-trailer-t8.patch
Type: text/x-patch
Size: 57173 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161108/2d348076/attachment-0001.bin>

From squid3 at treenet.co.nz  Wed Nov  9 14:49:48 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 10 Nov 2016 03:49:48 +1300
Subject: [squid-dev] Squid v5 has branched for development
Message-ID: <924c8ac9-8e6f-d09e-df07-4f309361132f@treenet.co.nz>

A Squid-5 branch is now open for use. Please commit new code on that
branch instead of Squid-4.

The Squid-5 branch URL path is /bzr/squid3/5 .

Due to the way the new numbering automation worked the 'trunk' moniker
is no longer useful (it still points to what became of the 3.HEAD
branch, aka v4 branch). Please check any 'trunk' (/bzr/squid3/trunk)
checkouts you have and move them to the relevant v4 or v5 branch.

AFAIK "bzr pull" should be the way to do that update, but may erase
other non-tracked files in the checkout directory.


Cheers
Amos

From squid3 at treenet.co.nz  Wed Nov  9 15:16:49 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 10 Nov 2016 04:16:49 +1300
Subject: [squid-dev] [PATCH] ICAP trailer support
In-Reply-To: <5821DBC5.2080904@measurement-factory.com>
References: <5821DBC5.2080904@measurement-factory.com>
Message-ID: <686beb8b-758a-c018-e6de-16b65f7c1641@treenet.co.nz>

On 9/11/2016 3:05 a.m., Eduard Bagdasaryan wrote:
> Hello,
> 
> This patch introduces the initial ICAP trailer support. ICAP trailers are
> currently specified by
> https://datatracker.ietf.org/doc/draft-rousskov-icap-trailers/. For now,
> Squid logs and ignores all parsed ICAP header fields.  In future we plan
> to add code for using ICAP trailers for transaction annotations and
> access logging.
> 
> Also refactored HttpHeader parsing methods in order to reuse them for
> ICAP trailer parsing.
> 
> Also simplified and fixed headers isolating code while dealing with
> empty (i.e. zero header fields) headers. Old httpMsgIsolateHeaders()
> tried to re-implement header end detection/processing logic that is
> actually covered by headersEnd(). Old httpMsgIsolateHeaders() could
> return success for some garbage input (e.g., a buffer of several CRs)
> even if no end of headers was found.
> 

Careful there. Since HttpMsg is actually HTTP parse logic a buffer
containing several CR's can be a valid mime block (just empty). CR is
part of BWS/OWS in HTTP.


In Adaptation::Icap::ModXact::expectIcapTrailers() please use
getByIdIfPresent(Http::TRAILER, ...) since Trailer is a registered header.

In answer to "TODO: should we add a new Http::scInvalidTrailer?"
 - only if the draft defines an HTTP 5xx status code called "Ivalid
Trailer". Since the Http::sc* are HTTP status codes.

Thats all I have for now after a quick read through.

Amos


From rousskov at measurement-factory.com  Wed Nov  9 15:24:02 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 9 Nov 2016 08:24:02 -0700
Subject: [squid-dev] [PATCH] ssl::server_name ACL badly broken since
 inception (trunk r14008).
In-Reply-To: <3980028d-7c37-c31a-3fec-a984759cb914@chtsanti.net>
References: <dbe554e3-6099-2dda-9029-8ca64f990886@chtsanti.net>
 <263b52dc-2b51-899b-14fc-2557771bb6d6@treenet.co.nz>
 <3980028d-7c37-c31a-3fec-a984759cb914@chtsanti.net>
Message-ID: <e73c9fa8-0c47-2b5a-fd78-0ad23c96ef55@measurement-factory.com>

On 10/28/2016 02:39 AM, Christos Tsantilas wrote:

> I am attaching the squid-3.5 version of the patch.

Amos, will you commit this fix to the v3.5 branch?


Thank you,

Alex.


> On 10/27/2016 12:46 AM, Amos Jeffries wrote:
>> On 21/10/2016 5:18 a.m., Christos Tsantilas wrote:
>>>
>>> The original server_name code mishandled all SNI checks and some rare
>>> host checks:
>>>
>>> * The SNI-derived value was pointing to an already freed memory storage.
>>> * Missing host-derived values were not detected (host() is never nil).
>>> * Mismatches were re-checked with an undocumented "none" value instead
>>> of being treated as mismatches.
>>>
>>> Same for ssl::server_name_regex.
>>>
>>> Also set SNI for more server-first and client-first transactions.
>>>
>>> This is a Measurement Factory project.
>>>
>>
>> +1.
>>
>> Amos


From squid3 at treenet.co.nz  Wed Nov  9 16:26:26 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 10 Nov 2016 05:26:26 +1300
Subject: [squid-dev] [PATCH] ssl::server_name ACL badly broken since
 inception (trunk r14008).
In-Reply-To: <e73c9fa8-0c47-2b5a-fd78-0ad23c96ef55@measurement-factory.com>
References: <dbe554e3-6099-2dda-9029-8ca64f990886@chtsanti.net>
 <263b52dc-2b51-899b-14fc-2557771bb6d6@treenet.co.nz>
 <3980028d-7c37-c31a-3fec-a984759cb914@chtsanti.net>
 <e73c9fa8-0c47-2b5a-fd78-0ad23c96ef55@measurement-factory.com>
Message-ID: <361d28f9-5737-b84e-86a2-85a90490dbc3@treenet.co.nz>

On 10/11/2016 4:24 a.m., Alex Rousskov wrote:
> On 10/28/2016 02:39 AM, Christos Tsantilas wrote:
> 
>> I am attaching the squid-3.5 version of the patch.
> 
> Amos, will you commit this fix to the v3.5 branch?
> 

Sure. Will do in the next few days sometime.

Amos


From rousskov at measurement-factory.com  Wed Nov  9 18:29:06 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 9 Nov 2016 11:29:06 -0700
Subject: [squid-dev] [PATCH] ICAP trailer support
In-Reply-To: <686beb8b-758a-c018-e6de-16b65f7c1641@treenet.co.nz>
References: <5821DBC5.2080904@measurement-factory.com>
 <686beb8b-758a-c018-e6de-16b65f7c1641@treenet.co.nz>
Message-ID: <2d018272-8c1a-2a23-3e85-8c8afa90631b@measurement-factory.com>

On 11/09/2016 08:16 AM, Amos Jeffries wrote:
> On 9/11/2016 3:05 a.m., Eduard Bagdasaryan wrote:
>> Also simplified and fixed headers isolating code while dealing with
>> empty (i.e. zero header fields) headers. Old httpMsgIsolateHeaders()
>> tried to re-implement header end detection/processing logic that is
>> actually covered by headersEnd(). Old httpMsgIsolateHeaders() could
>> return success for some garbage input (e.g., a buffer of several CRs)
>> even if no end of headers was found.


> Careful there. Since HttpMsg is actually HTTP parse logic a buffer
> containing several CR's can be a valid mime block (just empty). CR is
> part of BWS/OWS in HTTP.

Amos,

    Do you agree that a buffer consisting of several CRs and nothing
else must not result in httpMsgIsolateHeaders() returning 1 (i.e.
"success")?

The above preamble text is trying to say that the old
httpMsgIsolateHeaders() could return 1 in that invalid-input case. The
text should be rephrased for clarity if that is not how you interpreted
it. Suggestions welcomed.


In this context, the "HTTP header(s)" is defined as

  *( header-field CR?LF )
  CR?LF

where CR?LF is either CRLF or just LF.

Old httpMsgIsolateHeaders() and new HttpHeader::Isolate() must extract
the mime block (i.e., the *(header-field CR?LF) part) but only if
headersEnd() finds the end of the HTTP header first. The old
httpMsgIsolateHeaders was buggy. If you believe HttpHeader::Isolate() is
buggy, please speak up!


HTH,

Alex.


From noc at squid-cache.org  Wed Nov  9 20:51:09 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Wed, 9 Nov 2016 20:51:09 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=231?=
Message-ID: <216267217.60.1478724669139.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/1/------------------------------------------
[...truncated 32112 lines...]
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT hash.lo -MD -MP -MF .deps/hash.Tpo -c ../../../lib/hash.cc  -fPIC -DPIC -o hash.o >/dev/null 2>&1
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Wed Nov  9 21:35:15 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Wed, 9 Nov 2016 21:35:15 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=231?=
Message-ID: <29574447.61.1478727315535.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/1/------------------------------------------
[...truncated 32109 lines...]
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Thu Nov 10 13:30:01 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Thu, 10 Nov 2016 13:30:01 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=232?=
In-Reply-To: <216267217.60.1478724669139.JavaMail.jenkins@buildmaster>
References: <216267217.60.1478724669139.JavaMail.jenkins@buildmaster>
Message-ID: <80888003.62.1478784601837.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/2/------------------------------------------
[...truncated 32111 lines...]
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From christos at chtsanti.net  Thu Nov 10 17:03:58 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Thu, 10 Nov 2016 19:03:58 +0200
Subject: [squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
Message-ID: <f8bb858b-34f6-ad5f-fcbc-07181d817f8c@chtsanti.net>


Added nil dereference checks for Ftp::Client::ctrl.conn, including:
- Ftp::Client::handlePasvReply() and handleEpsvReply() that dereference 
ctrl.conn in DBG_IMPORTANT messages.
- Many functions inside FtpClient.cc and FtpGateway.cc files.

TODO: We need to find a better way to handle nil ctrl.conn. It is only a 
matter of time when we forget to add another dereference check or 
discover a place we missed during this change.

Also disabled forwarding of EPRT and PORT commands to origin servers. 
Squid support for those commands is broken and their forwarding may 
cause segfaults (bug #4004). Active FTP is still supported, of course.

This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-233-Squid_Segfault_via_Ftp_Client_readControlReply-t4.patch
Type: text/x-patch
Size: 16020 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161110/a2053526/attachment.bin>

From noc at squid-cache.org  Thu Nov 10 18:38:41 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Thu, 10 Nov 2016 18:38:41 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=233?=
In-Reply-To: <80888003.62.1478784601837.JavaMail.jenkins@buildmaster>
References: <80888003.62.1478784601837.JavaMail.jenkins@buildmaster>
Message-ID: <1069136603.63.1478803121594.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/3/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From gkinkie at gmail.com  Thu Nov 10 20:28:15 2016
From: gkinkie at gmail.com (Kinkie)
Date: Thu, 10 Nov 2016 20:28:15 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
 <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
Message-ID: <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>

> Tests and code analysis show that JoinContainerIntoSBuf() allocates when
> no allocation is needed. I have also shown that it is possible to
> implement JoinContainerIntoSBuf() so that there is no extra allocation.
> AFAICT, going forward, you choices are:
>
> * state that the extra allocation is not your fault, leaving it as is,
>   and/or
> * fix JoinContainerIntoSBuf() to avoid the extra allocation.
>
> When you added the "dest" parameter, you have started moving in the
> latter direction.

I'm completing that by using the reseve() based approach

>> At the same time, it's not a matter of API: the extended
>> reserve() has the same behavior as the "problem" is elsewhere.
>
> Whether SBuf::reserve() has the same behavior as reserveSpace() depends
> on reserve() configuration parameters.
>
> JoinContainerIntoSBuf() should configure reserve() in such a way that
> reserve() does _not_ have the same behavior as reserveSpace(). I showed
> how to do that in JoinContainerIntoSBuf4() in my earlier patch. The
> patch attached now has an even simpler JoinContainerIntoSBuf5()
> implementation because I fixed reserve() to not require the .ideal
> configuration parameter to be set (trunk r14917).

Aha! I was confused as I had branched off earlier. Merging.

>
>> What we could do is:
>> - define a reserveMinSpace() which does not shrink storage
>
> Having two methods called reserveMinSpace() and reserveSpace(), one of
> which does not shrink and the other one does, makes no sense to me
> because the method names do not reflect that difference at all and
> because reserve() is always primarily about "minimum" space anyway.
>
> More importantly, reserveSpace() guarantees single ownership. IMO,
> shrinking is essentially a side effect of that guarantee.

Yes.

> I suspect we do not need a "provide single-ownership space, shrinking
> the existing single-owned MemBlob if there is one" method, but if you
> have some existing use cases for it, please share them. If there are no
> such cases, reserveSpace()/reserveCapacity() should be optimized to
> avoid unnecessary re-allocation when their MemBlob is already not
> shared, but that is a different story, unrelated to JoinContainerIntoSBuf!

I agree. And that's why I think they could be simply convenience
methods for reserve().

>> - reimplement [...] reserveSpace() as convenience wrapper around reserve()
>
> Sure, but that is outside this patch scope.

Yes.


>> - while we're at it, give SBufReservationRequirements a convenience constructor
>
> With minSpace as the only parameter? Sure. Please do not forget
> "explicit". Again, that seems to be outside your patch scope.

Yes.

> I do not recommend providing more than one constructor parameter though
> because constructors with multiple same- or similar-type parameters are
> a recipe for mismatching parameters disasters.

Let's optimize the common case, we'll see if there is a need for more later on.

v4 attached.

-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sbufcontainerjoin-v4.patch
Type: application/octet-stream
Size: 6642 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161110/76f6b98c/attachment.obj>

From noc at squid-cache.org  Fri Nov 11 04:06:58 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 11 Nov 2016 04:06:58 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=232?=
In-Reply-To: <29574447.61.1478727315535.JavaMail.jenkins@buildmaster>
References: <29574447.61.1478727315535.JavaMail.jenkins@buildmaster>
Message-ID: <996548699.64.1478837218478.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/2/------------------------------------------
[...truncated 32111 lines...]
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Fri Nov 11 05:02:37 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 11 Nov 2016 18:02:37 +1300
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
 <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
 <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
Message-ID: <e12ed9cc-0689-097f-72e1-c7a25af0ab23@treenet.co.nz>

On 11/11/2016 9:28 a.m., Kinkie wrote:
> 
> v4 attached.
> 

Does it have to take begin() and end() iterators explicitly?
 can we not have it take the container itself and use a for(auto &i :
container) loop ?

Amos


From squid3 at treenet.co.nz  Fri Nov 11 05:27:55 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 11 Nov 2016 18:27:55 +1300
Subject: [squid-dev] [PATCH] ICAP trailer support
In-Reply-To: <2d018272-8c1a-2a23-3e85-8c8afa90631b@measurement-factory.com>
References: <5821DBC5.2080904@measurement-factory.com>
 <686beb8b-758a-c018-e6de-16b65f7c1641@treenet.co.nz>
 <2d018272-8c1a-2a23-3e85-8c8afa90631b@measurement-factory.com>
Message-ID: <0178bbb5-7872-f9f3-7830-9210a44b4614@treenet.co.nz>

On 10/11/2016 7:29 a.m., Alex Rousskov wrote:
> On 11/09/2016 08:16 AM, Amos Jeffries wrote:
>> On 9/11/2016 3:05 a.m., Eduard Bagdasaryan wrote:
>>> Also simplified and fixed headers isolating code while dealing with
>>> empty (i.e. zero header fields) headers. Old httpMsgIsolateHeaders()
>>> tried to re-implement header end detection/processing logic that is
>>> actually covered by headersEnd(). Old httpMsgIsolateHeaders() could
>>> return success for some garbage input (e.g., a buffer of several CRs)
>>> even if no end of headers was found.
> 
> 
>> Careful there. Since HttpMsg is actually HTTP parse logic a buffer
>> containing several CR's can be a valid mime block (just empty). CR is
>> part of BWS/OWS in HTTP.
> 
> Amos,
> 
>     Do you agree that a buffer consisting of several CRs and nothing
> else must not result in httpMsgIsolateHeaders() returning 1 (i.e.
> "success")?

Only if all the callers of this function are handling the case where it
produces non-1 and adding a terminator LF explicitly for a re-parse attempt.

IIRC we made the HTTP code do that, but I'm not sure of the ICAP or HTCP
code, or the Store loading code (which parses into StoreEntry/MemObject
or something).

If this functions output in this case is going to change then all those
callers need to be checked that they cope with this change correctly.


> 
> The above preamble text is trying to say that the old
> httpMsgIsolateHeaders() could return 1 in that invalid-input case. The
> text should be rephrased for clarity if that is not how you interpreted
> it. Suggestions welcomed.
> 
> 
> In this context, the "HTTP header(s)" is defined as
> 
>   *( header-field CR?LF )
>   CR?LF
> 
> where CR?LF is either CRLF or just LF.
> 
> Old httpMsgIsolateHeaders() and new HttpHeader::Isolate() must extract
> the mime block (i.e., the *(header-field CR?LF) part) but only if
> headersEnd() finds the end of the HTTP header first. The old
> httpMsgIsolateHeaders was buggy. If you believe HttpHeader::Isolate() is
> buggy, please speak up!

I have not seen any bugs, just the above needs doing.

Amos


From squid3 at treenet.co.nz  Fri Nov 11 05:37:18 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 11 Nov 2016 18:37:18 +1300
Subject: [squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
In-Reply-To: <f8bb858b-34f6-ad5f-fcbc-07181d817f8c@chtsanti.net>
References: <f8bb858b-34f6-ad5f-fcbc-07181d817f8c@chtsanti.net>
Message-ID: <9636746e-cf22-1090-ab45-307936acdb7b@treenet.co.nz>

On 11/11/2016 6:03 a.m., Christos Tsantilas wrote:
> 
> Added nil dereference checks for Ftp::Client::ctrl.conn, including:
> - Ftp::Client::handlePasvReply() and handleEpsvReply() that dereference
> ctrl.conn in DBG_IMPORTANT messages.
> - Many functions inside FtpClient.cc and FtpGateway.cc files.
> 
> TODO: We need to find a better way to handle nil ctrl.conn. It is only a
> matter of time when we forget to add another dereference check or
> discover a place we missed during this change.
> 
> Also disabled forwarding of EPRT and PORT commands to origin servers.
> Squid support for those commands is broken and their forwarding may
> cause segfaults (bug #4004). Active FTP is still supported, of course.
> 
> This is a Measurement Factory project.


in ftpReadPasv()
- please leave the ftpSendEPRT where it was (but comment out). As-is
this will just add a new Coverity issue about dead/unreachable code.

in completeForwarding()
- sic you are changing the debugs line please polish it all up to remove
the HERE
 - also s/completeForwarding avoids /avoid /

+1 with the above polish.

pPS. please remember to apply on the squid-5 branchnow, not trunk or v4.

Amos


From gkinkie at gmail.com  Fri Nov 11 08:30:22 2016
From: gkinkie at gmail.com (Kinkie)
Date: Fri, 11 Nov 2016 08:30:22 +0000
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <e12ed9cc-0689-097f-72e1-c7a25af0ab23@treenet.co.nz>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
 <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
 <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
 <e12ed9cc-0689-097f-72e1-c7a25af0ab23@treenet.co.nz>
Message-ID: <CA+Y8hcOvHfTNQtVqOF80Bd8L=p+USMCJ-Y5hg0n=o6cgtX5aEw@mail.gmail.com>

On Fri, Nov 11, 2016 at 5:02 AM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
> On 11/11/2016 9:28 a.m., Kinkie wrote:
>>
>> v4 attached.
>>
>
> Does it have to take begin() and end() iterators explicitly?
>  can we not have it take the container itself and use a for(auto &i :
> container) loop ?

No it doesn't but it's sometimes convenient.
My use case is the regex-compressing code. It can be reduced to (pseudocode)

join(regex-so-far, wordsList., separator=")|(", prefix="(", suffix=")")

granted, it can be done with explicit append calls but then you can't
inline it (e.g in streams).

The code used to take the whole container, but there's a use case for
iterating over a slice only.

-- 
    Francesco

From noc at squid-cache.org  Fri Nov 11 12:23:23 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 11 Nov 2016 12:23:23 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=234?=
In-Reply-To: <1069136603.63.1478803121594.JavaMail.jenkins@buildmaster>
References: <1069136603.63.1478803121594.JavaMail.jenkins@buildmaster>
Message-ID: <1774955768.65.1478867003576.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/4/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT radix.lo -MD -MP -MF .deps/radix.Tpo -c ../../../lib/radix.c  -fPIC -DPIC -o radix.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Fri Nov 11 12:39:05 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 11 Nov 2016 12:39:05 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=233?=
In-Reply-To: <996548699.64.1478837218478.JavaMail.jenkins@buildmaster>
References: <996548699.64.1478837218478.JavaMail.jenkins@buildmaster>
Message-ID: <1692277011.66.1478867945856.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/3/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From christos at chtsanti.net  Fri Nov 11 16:36:58 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Fri, 11 Nov 2016 18:36:58 +0200
Subject: [squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
In-Reply-To: <9636746e-cf22-1090-ab45-307936acdb7b@treenet.co.nz>
References: <f8bb858b-34f6-ad5f-fcbc-07181d817f8c@chtsanti.net>
 <9636746e-cf22-1090-ab45-307936acdb7b@treenet.co.nz>
Message-ID: <83d37553-d0c8-2e6f-5fa3-d24f44d6de03@chtsanti.net>

The patch applied to trunk as r14936 and r14937.
I am attaching a patch for squid-3.5 release.


On 11/11/2016 07:37 AM, Amos Jeffries wrote:
> On 11/11/2016 6:03 a.m., Christos Tsantilas wrote:
>>
>> Added nil dereference checks for Ftp::Client::ctrl.conn, including:
>> - Ftp::Client::handlePasvReply() and handleEpsvReply() that dereference
>> ctrl.conn in DBG_IMPORTANT messages.
>> - Many functions inside FtpClient.cc and FtpGateway.cc files.
>>
>> TODO: We need to find a better way to handle nil ctrl.conn. It is only a
>> matter of time when we forget to add another dereference check or
>> discover a place we missed during this change.
>>
>> Also disabled forwarding of EPRT and PORT commands to origin servers.
>> Squid support for those commands is broken and their forwarding may
>> cause segfaults (bug #4004). Active FTP is still supported, of course.
>>
>> This is a Measurement Factory project.
>
>
> in ftpReadPasv()
> - please leave the ftpSendEPRT where it was (but comment out). As-is
> this will just add a new Coverity issue about dead/unreachable code.
>
> in completeForwarding()
> - sic you are changing the debugs line please polish it all up to remove
> the HERE
>  - also s/completeForwarding avoids /avoid /
>
> +1 with the above polish.
>
> pPS. please remember to apply on the squid-5 branchnow, not trunk or v4.
>
> Amos
>
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev
>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-233-Squid_Segfault_via_Ftp_Client_readControlReply-squid-3.5-t5.patch
Type: text/x-patch
Size: 17890 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161111/4b34cfa8/attachment.bin>

From christos at chtsanti.net  Fri Nov 11 16:45:01 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Fri, 11 Nov 2016 18:45:01 +0200
Subject: [squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
In-Reply-To: <83d37553-d0c8-2e6f-5fa3-d24f44d6de03@chtsanti.net>
References: <f8bb858b-34f6-ad5f-fcbc-07181d817f8c@chtsanti.net>
 <9636746e-cf22-1090-ab45-307936acdb7b@treenet.co.nz>
 <83d37553-d0c8-2e6f-5fa3-d24f44d6de03@chtsanti.net>
Message-ID: <089de496-bb7b-24cf-ad0d-b49e2ef597c1@chtsanti.net>

On 11/11/2016 06:36 PM, Christos Tsantilas wrote:
> The patch applied to trunk as r14936 and r14937.

I mean applied to "squid-5".

> I am attaching a patch for squid-3.5 release.
>
>
> On 11/11/2016 07:37 AM, Amos Jeffries wrote:
>> On 11/11/2016 6:03 a.m., Christos Tsantilas wrote:
>>>
>>> Added nil dereference checks for Ftp::Client::ctrl.conn, including:
>>> - Ftp::Client::handlePasvReply() and handleEpsvReply() that dereference
>>> ctrl.conn in DBG_IMPORTANT messages.
>>> - Many functions inside FtpClient.cc and FtpGateway.cc files.
>>>
>>> TODO: We need to find a better way to handle nil ctrl.conn. It is only a
>>> matter of time when we forget to add another dereference check or
>>> discover a place we missed during this change.
>>>
>>> Also disabled forwarding of EPRT and PORT commands to origin servers.
>>> Squid support for those commands is broken and their forwarding may
>>> cause segfaults (bug #4004). Active FTP is still supported, of course.
>>>
>>> This is a Measurement Factory project.
>>
>>
>> in ftpReadPasv()
>> - please leave the ftpSendEPRT where it was (but comment out). As-is
>> this will just add a new Coverity issue about dead/unreachable code.
>>
>> in completeForwarding()
>> - sic you are changing the debugs line please polish it all up to remove
>> the HERE
>>  - also s/completeForwarding avoids /avoid /
>>
>> +1 with the above polish.
>>
>> pPS. please remember to apply on the squid-5 branchnow, not trunk or v4.
>>
>> Amos
>>
>> _______________________________________________
>> squid-dev mailing list
>> squid-dev at lists.squid-cache.org
>> http://lists.squid-cache.org/listinfo/squid-dev
>>

From rousskov at measurement-factory.com  Fri Nov 11 17:52:36 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Fri, 11 Nov 2016 10:52:36 -0700
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcOvHfTNQtVqOF80Bd8L=p+USMCJ-Y5hg0n=o6cgtX5aEw@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
 <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
 <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
 <e12ed9cc-0689-097f-72e1-c7a25af0ab23@treenet.co.nz>
 <CA+Y8hcOvHfTNQtVqOF80Bd8L=p+USMCJ-Y5hg0n=o6cgtX5aEw@mail.gmail.com>
Message-ID: <f55f743c-eb3b-cb64-0e0d-f08ba6432239@measurement-factory.com>

On 11/11/2016 01:30 AM, Kinkie wrote:
> On Fri, Nov 11, 2016 at 5:02 AM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
>> On 11/11/2016 9:28 a.m., Kinkie wrote:
>>>
>>> v4 attached.
>>>
>>
>> Does it have to take begin() and end() iterators explicitly?
>>  can we not have it take the container itself and use a for(auto &i :
>> container) loop ?
> 
> No it doesn't but it's sometimes convenient.
> My use case is the regex-compressing code. It can be reduced to (pseudocode)
> 
> join(regex-so-far, wordsList., separator=")|(", prefix="(", suffix=")")
> 
> granted, it can be done with explicit append calls but then you can't
> inline it (e.g in streams).
> 
> The code used to take the whole container, but there's a use case for
> iterating over a slice only.

Accepting iterators is standard in STL (despite being slightly
inconvenient) probably because accepting iterators covers a lot more
potential use cases.

Alex.


From rousskov at measurement-factory.com  Fri Nov 11 17:59:52 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Fri, 11 Nov 2016 10:59:52 -0700
Subject: [squid-dev] [PATCH] Extend SBufContainerJoin to have prefix and
 suffix arguments
In-Reply-To: <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
References: <CA+Y8hcOibQFmV5mdjFy0J4Y+bL7ZByz=27ja9WNn9VjeZ2K14g@mail.gmail.com>
 <c41579b7-24fd-fb4a-e388-8a9f41a39aec@measurement-factory.com>
 <CA+Y8hcN9mf7Z5nYX2s4hA_2yguhKeOhgZhKwc69D1mC-NMcTgA@mail.gmail.com>
 <48b2e9b7-f08f-d05f-03ab-b3f5cf739c53@measurement-factory.com>
 <CA+Y8hcNdEcMn7bTrpDknweEgjNH5Jprfoe-Kyitoz1LrjCav2w@mail.gmail.com>
 <e0b4185e-0763-a05f-d4f3-816d86ed2351@measurement-factory.com>
 <CA+Y8hcMXenWbTXVY+PqKb43J3n2uFWCpL+sU3ZQQGF5ztao5sg@mail.gmail.com>
 <4506e1bb-2fca-36dd-54e0-794213fa3051@measurement-factory.com>
 <CA+Y8hcOfO-G2d2vPxL6KP0PnSk+HWkSRBcdBmGmk2sRtKgB22w@mail.gmail.com>
 <aa2bf093-7ba2-5530-0a05-37d9ead0a72b@measurement-factory.com>
 <CA+Y8hcNJfQm8g04WDO+vY=TvCgqV0N3Tqr_sz5VLGXvi+dXuyQ@mail.gmail.com>
Message-ID: <89dfb1db-267c-7ff0-bee0-9b5f456a4900@measurement-factory.com>

On 11/10/2016 01:28 PM, Kinkie wrote:

> +/// convenience wrapper of JoinContainerIntoSBuf with no caller-supplied SBuf
> +template <class ContainerIterator>
> +SBuf
> +JoinContainerToSBuf(const ContainerIterator &begin,

IMO, the description should disclose the performance overhead of the
convenience wrapper [instead of stating the obvious lack of the
caller-supplied SBuf]. I have proposed a specific wording, but it does
not have to be that wording, of course.


> v4 attached.

v5, actually.

I am OK with these changes going in, hopefully after the description
adjustment discussed above.


Thank you,

Alex.


From noc at squid-cache.org  Fri Nov 11 18:45:08 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 11 Nov 2016 18:45:08 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=235?=
In-Reply-To: <1774955768.65.1478867003576.JavaMail.jenkins@buildmaster>
References: <1774955768.65.1478867003576.JavaMail.jenkins@buildmaster>
Message-ID: <928149875.67.1478889908633.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/5/------------------------------------------
[...truncated 32108 lines...]
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov 12 13:45:38 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 12 Nov 2016 13:45:38 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=236?=
In-Reply-To: <928149875.67.1478889908633.JavaMail.jenkins@buildmaster>
References: <928149875.67.1478889908633.JavaMail.jenkins@buildmaster>
Message-ID: <911269570.0.1478958338655.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/6/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov 12 16:36:01 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 12 Nov 2016 16:36:01 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=237?=
In-Reply-To: <911269570.0.1478958338655.JavaMail.jenkins@buildmaster>
References: <911269570.0.1478958338655.JavaMail.jenkins@buildmaster>
Message-ID: <131878035.1.1478968561238.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/7/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From eduard.bagdasaryan at measurement-factory.com  Sat Nov 12 18:01:38 2016
From: eduard.bagdasaryan at measurement-factory.com (Eduard Bagdasaryan)
Date: Sat, 12 Nov 2016 21:01:38 +0300
Subject: [squid-dev] [PATCH] ICAP trailer support
In-Reply-To: <0178bbb5-7872-f9f3-7830-9210a44b4614@treenet.co.nz>
References: <0178bbb5-7872-f9f3-7830-9210a44b4614@treenet.co.nz>
Message-ID: <58275902.6090709@measurement-factory.com>

2016-11-11 8:27 GMT+03:00 Amos Jeffries <squid3 at treenet.co.nz>:

 > In Adaptation::Icap::ModXact::expectIcapTrailers() please use
 > getByIdIfPresent(Http::TRAILER, ...) since Trailer is a registered
 > header.

Fixed.

 > In answer to "TODO: should we add a new Http::scInvalidTrailer?" only if
 > the draft defines an HTTP 5xx status code called "Ivalid > Trailer".
 > Since the Http::sc* are HTTP status codes.

The draft does not define HTTP 5xx status codes for invalid trailers.
Also please note that scInvalidHeader (600 code) is marked for
internal/Squid-only use. Probably we could similarly use
scInvalidTrailer with code 602 (for example).

 > Only if all the callers of this function are handling the case where it
 > produces non-1 and adding a terminator LF explicitly for a re-parse
 > attempt.

I have only found such 're-parse' logic inside
HttpStateData::processReplyHeader(), marked with the comment. However
this code does not use the patch-affected HttpHeader::parse(): it uses
Http::One::Parser::grabMimeBlock() instead. So, nothing to fix here, IMO.


Eduard.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-157-parse-icap-trailer-t9.patch
Type: text/x-patch
Size: 57149 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161112/b927e240/attachment-0001.bin>

From garryd at comnet.uz  Sat Nov 12 20:40:07 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Sun, 13 Nov 2016 01:40:07 +0500
Subject: [squid-dev] [PATCH] Fix for the bug 3533
Message-ID: <c27115252130dd4dbe1993c9de21bcb9@comnet.uz>

Dear developers,

The attached patch fixes the bug 3533 [1], still existing in trunk 
(revno: 14938). The problem relates to the fact that the code 303 
(scSeeOther) is not considered by Squid as a one permitted to remove 
public store entries. Below is excerpt from src/http.cc:

    180	/// Remove an existing public store entry if the incoming 
response (to be
    181	/// stored in a currently private entry) is going to invalidate 
it.
    182	static void
    183	httpMaybeRemovePublic(StoreEntry * e, Http::StatusCode status)

I've successfully replicated the issue and the patch solved the problem 
in my test environment.


[1] http://bugs.squid-cache.org/show_bug.cgi?id=3533


Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_bug3533.patch
Type: text/x-diff
Size: 237 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161113/5680ae40/attachment.patch>

From gkinkie at gmail.com  Mon Nov 14 00:11:13 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 00:11:13 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
Message-ID: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>

Hi all,
  the attached patch moves away from hand-rolling a c-string onto
joining a SBufList for optimizing regexes in RegexData.cc.

You can find attached as a test case the output of squidclient
mgr:config taken on trunk and on the submitted code. It is slightly
different in that the new code allows for a longer optimized regex.
  The code is expected to cause a small performance regression on
parse and reconfigure due to extra data copies. The regression is
negligible: the attached test cases perform "squid -k parse" in 60
msec in trunk and 62 on the branch on a warm cache on my i5 macbook
air.


[RFC]
The code managing case-insensitivity flags is IMO quite complicated
and not really intuitive: it switches between case-insensitive and
case-sensitive each time it meets a -i flag. I would like to change
the behaviour so that a -i flag makes the whole acl case-insensitive;
this seems to me consistent with the behavior documented in squid.conf
which does not document the case of multiple -i flags in a single
regex-type ACL. I'd like feedback on this proposal.



-- 
    Francesco
-------------- next part --------------
HTTP/1.1 200 OK
Server: squid/5.0.0-BZR
Mime-Version: 1.0
Date: Sun, 13 Nov 2016 23:46:45 GMT
Content-Type: text/plain;charset=utf-8
Expires: Sun, 13 Nov 2016 23:46:45 GMT
Last-Modified: Sun, 13 Nov 2016 23:46:45 GMT
X-Cache: MISS from kair
X-Cache-Lookup: MISS from kair:3128
Via: 1.1 kair (squid/5.0.0-BZR)
Connection: close

workers 1
shared_memory_locking off
authenticate_cache_garbage_interval 3600 seconds
authenticate_ttl 3600 seconds
authenticate_ip_ttl 1 seconds
acl CONNECT method  CONNECT 
acl Safe_ports port  80 21 443 70 210 1025-65535 280 488 591 777 
acl SSL_ports port  443 
acl localhet src  169.254.0.0/16 
acl localnet src  0.0.0.1-0.255.255.255 10.0.0.0/8 100.64.0.0/10 172.16.0.0/12 192.168.0.0/16 fc00::/7 fe80::/10 
acl bigacl dstdom_regex  (kinkie.it)|(localhost)|(pattern1)|(pattern2)|(pattern3)|(pattern4)|(pattern5)|(pattern6)|(pattern7)|(pattern8)|(pattern9)|(pattern10)|(pattern11)|(pattern12)|(pattern13)|(pattern14)|(pattern15)|(pattern16)|(pattern17)|(pattern18)|(pattern19)|(pattern20)|(pattern21)|(pattern22)|(pattern23)|(pattern24)|(pattern25)|(pattern26)|(pattern27)|(pattern28)|(pattern29)|(pattern30)|(pattern31)|(pattern32)|(pattern33)|(pattern34)|(pattern35)|(pattern36)|(pattern37)|(pattern38)|(pattern39)|(pattern40)|(pattern41)|(pattern42)|(pattern43)|(pattern44)|(pattern45)|(pattern46)|(pattern47)|(pattern48)|(pattern49)|(pattern50)|(pattern51)|(pattern52)|(pattern53)|(pattern54)|(pattern55)|(pattern56)|(pattern57)|(pattern58)|(pattern59)|(pattern60)|(pattern61)|(pattern62)|(pattern63)|(pattern64)|(pattern65)|(pattern66)|(pattern67)|(pattern68)|(pattern69)|(pattern70)|(pattern71)|(pattern72)|(pattern73)|(pattern74)|(pattern75)|(pattern76)|(pattern77)|(pattern78)|(pattern79)|(pattern80)|(pattern81)|(pattern82)|(pattern83)|(pattern84)|(pattern85)|(pattern86)|(pattern87)|(pattern88)|(pattern89)|(pattern90)|(pattern91)|(pattern92)|(pattern93)|(pattern94)|(pattern95)|(pattern96)|(pattern97)|(pattern98)|(pattern99)|(pattern100)|(pattern101)|(pattern102)|(pattern103)|(pattern104)|(pattern105)|(pattern106)|(pattern107)|(pattern108)|(pattern109)|(pattern110)|(pattern111)|(pattern112) (pattern114)|(pattern115)|(pattern116)|(pattern117)|(pattern118)|(pattern119)|(pattern120)|(pattern121)|(pattern122)|(pattern123)|(pattern124)|(pattern125)|(pattern126)|(pattern127)|(pattern128)|(pattern129)|(pattern130)|(pattern131)|(pattern132)|(pattern133)|(pattern134)|(pattern135)|(pattern136)|(pattern137)|(pattern138)|(pattern139)|(pattern140)|(pattern141)|(pattern142)|(pattern143)|(pattern144)|(pattern145)|(pattern146)|(pattern147)|(pattern148)|(pattern149)|(pattern150)|(pattern151)|(pattern152)|(pattern153)|(pattern154)|(pattern155)|(pattern156)|(pattern157)|(pattern158)|(pattern159)|(pattern160)|(pattern161)|(pattern162)|(pattern163)|(pattern164)|(pattern165)|(pattern166)|(pattern167)|(pattern168)|(pattern169)|(pattern170)|(pattern171)|(pattern172)|(pattern173)|(pattern174)|(pattern175)|(pattern176)|(pattern177)|(pattern178)|(pattern179)|(pattern180)|(pattern181)|(pattern182)|(pattern183)|(pattern184)|(pattern185)|(pattern186)|(pattern187)|(pattern188)|(pattern189)|(pattern190)|(pattern191)|(pattern192)|(pattern193)|(pattern194)|(pattern195)|(pattern196)|(pattern197)|(pattern198)|(pattern199)|(pattern200)|(pattern201)|(pattern202)|(pattern203)|(pattern204)|(pattern205)|(pattern206)|(pattern207)|(pattern208)|(pattern209)|(pattern210)|(pattern211)|(pattern212)|(pattern213)|(pattern214)|(pattern215)|(pattern216) (pattern218)|(pattern219)|(pattern220)|(pattern221)|(pattern222)|(pattern223)|(pattern224)|(pattern225)|(pattern226)|(pattern227)|(pattern228)|(pattern229)|(pattern230)|(pattern231)|(pattern232)|(pattern233)|(pattern234)|(pattern235)|(pattern236)|(pattern237)|(pattern238)|(pattern239)|(pattern240)|(pattern241)|(pattern242)|(pattern243)|(pattern244)|(pattern245)|(pattern246)|(pattern247)|(pattern248)|(pattern249)|(pattern250)|(pattern251)|(pattern252)|(pattern253)|(pattern254)|(pattern255)|(pattern256)|(pattern257)|(pattern258)|(pattern259)|(pattern260)|(pattern261)|(pattern262)|(pattern263)|(pattern264)|(pattern265)|(pattern266)|(pattern267)|(pattern268)|(pattern269)|(pattern270)|(pattern271)|(pattern272)|(pattern273)|(pattern274)|(pattern275)|(pattern276)|(pattern277)|(pattern278)|(pattern279)|(pattern280)|(pattern281)|(pattern282)|(pattern283)|(pattern284)|(pattern285)|(pattern286)|(pattern287)|(pattern288)|(pattern289)|(pattern290)|(pattern291)|(pattern292)|(pattern293)|(pattern294)|(pattern295)|(pattern296)|(pattern297)|(pattern298)|(pattern299)|(pattern300)|(pattern301)|(pattern302)|(pattern303)|(pattern304)|(pattern305)|(pattern306)|(pattern307)|(pattern308)|(pattern309)|(pattern310)|(pattern311)|(pattern312)|(pattern313)|(pattern314)|(pattern315)|(pattern316)|(pattern317)|(pattern318)|(pattern319)|(pattern320) (pattern322)|(pattern323)|(pattern324)|(pattern325)|(pattern326)|(pattern327)|(pattern328)|(pattern329)|(pattern330)|(pattern331)|(pattern332)|(pattern333)|(pattern334)|(pattern335)|(pattern336)|(pattern337)|(pattern338)|(pattern339)|(pattern340)|(pattern341)|(pattern342)|(pattern343)|(pattern344)|(pattern345)|(pattern346)|(pattern347)|(pattern348)|(pattern349)|(pattern350)|(pattern351)|(pattern352)|(pattern353)|(pattern354)|(pattern355)|(pattern356)|(pattern357)|(pattern358)|(pattern359)|(pattern360)|(pattern361)|(pattern362)|(pattern363)|(pattern364)|(pattern365)|(pattern366)|(pattern367)|(pattern368)|(pattern369)|(pattern370)|(pattern371)|(pattern372)|(pattern373)|(pattern374)|(pattern375)|(pattern376)|(pattern377)|(pattern378)|(pattern379)|(pattern380)|(pattern381)|(pattern382)|(pattern383)|(pattern384)|(pattern385)|(pattern386)|(pattern387)|(pattern388)|(pattern389)|(pattern390)|(pattern391)|(pattern392)|(pattern393)|(pattern394)|(pattern395)|(pattern396)|(pattern397)|(pattern398)|(pattern399)|(pattern400)|(pattern401)|(pattern402)|(pattern403)|(pattern404)|(pattern405)|(pattern406)|(pattern407)|(pattern408)|(pattern409)|(pattern410)|(pattern411)|(pattern412)|(pattern413)|(pattern414)|(pattern415)|(pattern416)|(pattern417)|(pattern418)|(pattern419)|(pattern420)|(pattern421)|(pattern422)|(pattern423)|(pattern424) (pattern426)|(pattern427)|(pattern428)|(pattern429)|(pattern430)|(pattern431)|(pattern432)|(pattern433)|(pattern434)|(pattern435)|(pattern436)|(pattern437)|(pattern438)|(pattern439)|(pattern440)|(pattern441)|(pattern442)|(pattern443)|(pattern444)|(pattern445)|(pattern446)|(pattern447)|(pattern448)|(pattern449)|(pattern450)|(pattern451)|(pattern452)|(pattern453)|(pattern454)|(pattern455)|(pattern456)|(pattern457)|(pattern458)|(pattern459)|(pattern460)|(pattern461)|(pattern462)|(pattern463)|(pattern464)|(pattern465)|(pattern466)|(pattern467)|(pattern468)|(pattern469)|(pattern470)|(pattern471)|(pattern472)|(pattern473)|(pattern474)|(pattern475)|(pattern476)|(pattern477)|(pattern478)|(pattern479)|(pattern480)|(pattern481)|(pattern482)|(pattern483)|(pattern484)|(pattern485)|(pattern486)|(pattern487)|(pattern488)|(pattern489)|(pattern490)|(pattern491)|(pattern492)|(pattern493)|(pattern494)|(pattern495)|(pattern496)|(pattern497)|(pattern498)|(pattern499)|(pattern500)|(pattern501)|(pattern502)|(pattern503)|(pattern504)|(pattern505)|(pattern506)|(pattern507)|(pattern508)|(pattern509)|(pattern510)|(pattern511)|(pattern512)|(pattern513)|(pattern514)|(pattern515)|(pattern516)|(pattern517)|(pattern518)|(pattern519)|(pattern520)|(pattern521)|(pattern522)|(pattern523)|(pattern524)|(pattern525)|(pattern526)|(pattern527)|(pattern528) (pattern530)|(pattern531)|(pattern532)|(pattern533)|(pattern534)|(pattern535)|(pattern536)|(pattern537)|(pattern538)|(pattern539)|(pattern540)|(pattern541)|(pattern542)|(pattern543)|(pattern544)|(pattern545)|(pattern546)|(pattern547)|(pattern548)|(pattern549)|(pattern550)|(pattern551)|(pattern552)|(pattern553)|(pattern554)|(pattern555)|(pattern556)|(pattern557)|(pattern558)|(pattern559)|(pattern560)|(pattern561)|(pattern562)|(pattern563)|(pattern564)|(pattern565)|(pattern566)|(pattern567)|(pattern568)|(pattern569)|(pattern570)|(pattern571)|(pattern572)|(pattern573)|(pattern574)|(pattern575)|(pattern576)|(pattern577)|(pattern578)|(pattern579)|(pattern580)|(pattern581)|(pattern582)|(pattern583)|(pattern584)|(pattern585)|(pattern586)|(pattern587)|(pattern588)|(pattern589)|(pattern590)|(pattern591)|(pattern592)|(pattern593)|(pattern594)|(pattern595)|(pattern596)|(pattern597)|(pattern598)|(pattern599)|(pattern600)|(pattern601)|(pattern602)|(pattern603)|(pattern604)|(pattern605)|(pattern606)|(pattern607)|(pattern608)|(pattern609)|(pattern610)|(pattern611)|(pattern612)|(pattern613)|(pattern614)|(pattern615)|(pattern616)|(pattern617)|(pattern618)|(pattern619)|(pattern620)|(pattern621)|(pattern622)|(pattern623)|(pattern624)|(pattern625)|(pattern626)|(pattern627)|(pattern628)|(pattern629)|(pattern630)|(pattern631)|(pattern632) (pattern634)|(pattern635)|(pattern636)|(pattern637)|(pattern638)|(pattern639)|(pattern640)|(pattern641)|(pattern642)|(pattern643)|(pattern644)|(pattern645)|(pattern646)|(pattern647)|(pattern648)|(pattern649)|(pattern650)|(pattern651)|(pattern652)|(pattern653)|(pattern654)|(pattern655)|(pattern656)|(pattern657)|(pattern658)|(pattern659)|(pattern660)|(pattern661)|(pattern662)|(pattern663)|(pattern664)|(pattern665)|(pattern666)|(pattern667)|(pattern668)|(pattern669)|(pattern670)|(pattern671)|(pattern672)|(pattern673)|(pattern674)|(pattern675)|(pattern676)|(pattern677)|(pattern678)|(pattern679)|(pattern680)|(pattern681)|(pattern682)|(pattern683)|(pattern684)|(pattern685)|(pattern686)|(pattern687)|(pattern688)|(pattern689)|(pattern690)|(pattern691)|(pattern692)|(pattern693)|(pattern694)|(pattern695)|(pattern696)|(pattern697)|(pattern698)|(pattern699)|(pattern700)|(pattern701)|(pattern702)|(pattern703)|(pattern704)|(pattern705)|(pattern706)|(pattern707)|(pattern708)|(pattern709)|(pattern710)|(pattern711)|(pattern712)|(pattern713)|(pattern714)|(pattern715)|(pattern716)|(pattern717)|(pattern718)|(pattern719)|(pattern720)|(pattern721)|(pattern722)|(pattern723)|(pattern724)|(pattern725)|(pattern726)|(pattern727)|(pattern728)|(pattern729)|(pattern730)|(pattern731)|(pattern732)|(pattern733)|(pattern734)|(pattern735)|(pattern736) (pattern738)|(pattern739)|(pattern740)|(pattern741)|(pattern742)|(pattern743)|(pattern744)|(pattern745)|(pattern746)|(pattern747)|(pattern748)|(pattern749)|(pattern750)|(pattern751)|(pattern752)|(pattern753)|(pattern754)|(pattern755)|(pattern756)|(pattern757)|(pattern758)|(pattern759)|(pattern760)|(pattern761)|(pattern762)|(pattern763)|(pattern764)|(pattern765)|(pattern766)|(pattern767)|(pattern768)|(pattern769)|(pattern770)|(pattern771)|(pattern772)|(pattern773)|(pattern774)|(pattern775)|(pattern776)|(pattern777)|(pattern778)|(pattern779)|(pattern780)|(pattern781)|(pattern782)|(pattern783)|(pattern784)|(pattern785)|(pattern786)|(pattern787)|(pattern788)|(pattern789)|(pattern790)|(pattern791)|(pattern792)|(pattern793)|(pattern794)|(pattern795)|(pattern796)|(pattern797)|(pattern798)|(pattern799)|(pattern800)|(pattern801)|(pattern802)|(pattern803)|(pattern804)|(pattern805)|(pattern806)|(pattern807)|(pattern808)|(pattern809)|(pattern810)|(pattern811)|(pattern812)|(pattern813)|(pattern814)|(pattern815)|(pattern816)|(pattern817)|(pattern818)|(pattern819)|(pattern820)|(pattern821)|(pattern822)|(pattern823)|(pattern824)|(pattern825)|(pattern826)|(pattern827)|(pattern828)|(pattern829)|(pattern830)|(pattern831)|(pattern832)|(pattern833)|(pattern834)|(pattern835)|(pattern836)|(pattern837)|(pattern838)|(pattern839)|(pattern840) (pattern842)|(pattern843)|(pattern844)|(pattern845)|(pattern846)|(pattern847)|(pattern848)|(pattern849)|(pattern850)|(pattern851)|(pattern852)|(pattern853)|(pattern854)|(pattern855)|(pattern856)|(pattern857)|(pattern858)|(pattern859)|(pattern860)|(pattern861)|(pattern862)|(pattern863)|(pattern864)|(pattern865)|(pattern866)|(pattern867)|(pattern868)|(pattern869)|(pattern870)|(pattern871)|(pattern872)|(pattern873)|(pattern874)|(pattern875)|(pattern876)|(pattern877)|(pattern878)|(pattern879)|(pattern880)|(pattern881)|(pattern882)|(pattern883)|(pattern884)|(pattern885)|(pattern886)|(pattern887)|(pattern888)|(pattern889)|(pattern890)|(pattern891)|(pattern892)|(pattern893)|(pattern894)|(pattern895)|(pattern896)|(pattern897)|(pattern898)|(pattern899)|(pattern900)|(pattern901)|(pattern902)|(pattern903)|(pattern904)|(pattern905)|(pattern906)|(pattern907)|(pattern908)|(pattern909)|(pattern910)|(pattern911)|(pattern912)|(pattern913)|(pattern914)|(pattern915)|(pattern916)|(pattern917)|(pattern918)|(pattern919)|(pattern920)|(pattern921)|(pattern922)|(pattern923)|(pattern924)|(pattern925)|(pattern926)|(pattern927)|(pattern928)|(pattern929)|(pattern930)|(pattern931)|(pattern932)|(pattern933)|(pattern934)|(pattern935)|(pattern936)|(pattern937)|(pattern938)|(pattern939)|(pattern940)|(pattern941)|(pattern942)|(pattern943)|(pattern944) (pattern946)|(pattern947)|(pattern948)|(pattern949)|(pattern950)|(pattern951)|(pattern952)|(pattern953)|(pattern954)|(pattern955)|(pattern956)|(pattern957)|(pattern958)|(pattern959)|(pattern960)|(pattern961)|(pattern962)|(pattern963)|(pattern964)|(pattern965)|(pattern966)|(pattern967)|(pattern968)|(pattern969)|(pattern970)|(pattern971)|(pattern972)|(pattern973)|(pattern974)|(pattern975)|(pattern976)|(pattern977)|(pattern978)|(pattern979)|(pattern980)|(pattern981)|(pattern982)|(pattern983)|(pattern984)|(pattern985)|(pattern986)|(pattern987)|(pattern988)|(pattern989)|(pattern990)|(pattern991)|(pattern992)|(pattern993)|(pattern994)|(pattern995)|(pattern996)|(pattern997)|(pattern998) 
acl to_localhost dst  ::1 0.0.0.0 127.0.0.0/8 
acl localhost src  ::1 127.0.0.1 
acl manager url_regex  -i (^cache_object://) +i (^https?://[^/]+/squid-internal-mgr/) 
acl all src  ::/0 
acl ssl::certSelfSigned ssl_error  X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT 
acl ssl::certUntrusted ssl_error  X509_V_ERR_CERT_UNTRUSTED X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY X509_V_ERR_INVALID_CA X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN 
acl ssl::certDomainMismatch ssl_error  SQUID_X509_V_ERR_DOMAIN_MISMATCH 
acl ssl::certNotYetValid ssl_error  X509_V_ERR_CERT_NOT_YET_VALID 
acl ssl::certHasExpired ssl_error  X509_V_ERR_CERT_HAS_EXPIRED 
follow_x_forwarded_for deny all 
 
acl_uses_indirect_client on
delay_pool_uses_indirect_client on
log_uses_indirect_client on
http_access allow bigacl 
 http_access allow manager 
 http_access deny all 
 http_access deny !Safe_ports 
 http_access deny CONNECT !SSL_ports 
 http_access allow localhost manager 
 http_access deny manager 
 http_access allow localnet 
 http_access allow localhost 
 http_access deny all 
 
http_port [::]:3128 name=3128 connection-auth=on tls-disable
https_port [::]:3128 name=3128 connection-auth=on tls-disable
,host_verify_strict off
client_dst_passthru on
tls_outgoing_options
ssl_unclean_shutdown off
sslproxy_session_ttl 300
sslproxy_session_cache_size 2097152 bytes
sslproxy_cert_sign signUntrusted (sslproxy_cert_sign signUntrusted line) 

sslproxy_cert_sign signSelf (sslproxy_cert_sign signSelf line) 

sslproxy_cert_sign signTrusted (sslproxy_cert_sign signTrusted line) 


sslcrtvalidator_children 32 startup=5 idle=1 concurrency=1
dead_peer_timeout 10 seconds
forward_max_tries 25
cache_mem 268435456 bytes
maximum_object_size_in_memory 524288 bytes
memory_cache_shared off
memory_cache_mode always
memory_replacement_policy lru
cache_replacement_policy lru
minimum_object_size 0 bytes
maximum_object_size 4194304 bytes
store_dir_select_algorithm least-load
max_open_disk_fds 0
cache_swap_low 90
cache_swap_high 95
access_log daemon:/Users/kinkie/tmp/squid/var/logs/access.log logformat=squid(access_log daemon:/Users/kinkie/tmp/squid/var/logs/access.log 

logfile_daemon /Users/kinkie/tmp/squid/libexec/log_file_daemon
logfile_rotate 10
mime_table /Users/kinkie/tmp/squid/etc/mime.conf
log_mime_hdrs off
pid_filename /Users/kinkie/tmp/squid/var/run/squid.pid
client_netmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
strip_query_terms on
buffered_logs off
netdb_filename stdio:/Users/kinkie/tmp/squid/var/cache/squid/netdb.state
cache_log /Users/kinkie/tmp/squid/var/logs/cache.log
debug_options ALL,1
coredump_dir /Users/kinkie/tmp/squid/var/cache/squid
ftp_user Squid@
ftp_passive on
ftp_epsv_all off
ftp_eprt on
ftp_sanitycheck on
ftp_telnet_protocol on
diskd_program /Users/kinkie/tmp/squid/libexec/diskd
unlinkd_program /Users/kinkie/tmp/squid/libexec/unlinkd
pinger_program /Users/kinkie/tmp/squid/libexec/pinger
pinger_enable on

url_rewrite_children 20 startup=0 idle=1 concurrency=0
url_rewrite_host_header on
url_rewrite_bypass off
url_rewrite_extras %>a/%>A %un %>rm myip=%la myport=%lp
url_rewrite_timeout 0 seconds
 on_timeout=bypass
store_id_extras %>a/%>A %un %>rm myip=%la myport=%lp

store_id_children 20 startup=0 idle=1 concurrency=0
store_id_bypass on
max_stale 604800 seconds
refresh_pattern ^ftp: 1440 20% 10080
refresh_pattern ^gopher: 1440 0% 1440
refresh_pattern -i (/cgi-bin/|\?) 0 0% 0
refresh_pattern . 0 20% 4320
quick_abort_min 16 KB
quick_abort_max 16 KB
quick_abort_pct 95
read_ahead_gap 16384 bytes
negative_ttl 0 seconds
positive_dns_ttl 21600 seconds
negative_dns_ttl 60 seconds
minimum_expiry_time 60 seconds
store_avg_object_size 13312 bytes
store_objects_per_bucket 20
request_header_max_size 65536 bytes
reply_header_max_size 65536 bytes
request_body_max_size 0 bytes
client_request_buffer_max_size 524288 bytes
adaptation_uses_indirect_client on
via on
vary_ignore_expire off
request_entities off
relaxed_header_parser on
collapsed_forwarding off
collapsed_forwarding_shared_entries_limit 16384
forward_timeout 240 seconds
connect_timeout 60 seconds
peer_connect_timeout 30 seconds
read_timeout 900 seconds
write_timeout 900 seconds
request_timeout 300 seconds
request_start_timeout 300 seconds
client_idle_pconn_timeout 120 seconds
ftp_client_idle_timeout 1800 seconds
client_lifetime 86400 seconds
pconn_lifetime 0 seconds
half_closed_clients off
server_idle_pconn_timeout 60 seconds
ident_timeout 10 seconds
shutdown_lifetime 1 seconds
cache_mgr webmaster
mail_program mail
cache_effective_user nobody
httpd_suppress_version_string off
umask 23
announce_period 31536000 seconds
announce_host tracker.ircache.net
announce_port 3131
httpd_accel_surrogate_id kair
http_accel_surrogate_remote off
esi_parser custom
delay_pools 0
delay_initial_bucket_level 50
client_delay_initial_bucket_level 50
wccp_router ::
wccp_version 4
wccp2_rebuild_wait on
wccp2_forwarding_method gre
wccp2_return_method gre
wccp2_assignment_method hash
wccp2_service standard 0
wccp2_weight 10000
wccp_address 0.0.0.0
wccp2_address 0.0.0.0
client_persistent_connections on
server_persistent_connections on
persistent_connection_after_error on
detect_broken_pconn off
digest_generation on
digest_bits_per_entry 5
digest_rebuild_period 3600 seconds
digest_rewrite_period 3600 seconds
digest_swapout_chunk_size 4096 bytes
digest_rebuild_chunk_percentage 10
snmp_port 0
snmp_incoming_address ::
snmp_outgoing_address ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
icp_port 0
htcp_port 0
log_icp_queries on
udp_incoming_address ::
udp_outgoing_address ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
icp_hit_stale off
minimum_direct_hops 4
minimum_direct_rtt 400
netdb_low 900
netdb_high 1000
netdb_ping_period 300 seconds
query_icmp off
test_reachability off
icp_query_timeout 0
maximum_icp_query_timeout 2000
minimum_icp_query_timeout 5
background_ping_rate 10 seconds
mcast_icp_query_timeout 2000
icon_directory /Users/kinkie/tmp/squid/share/icons
global_internal_static on
short_icon_urls on
error_log_languages on
err_page_stylesheet /Users/kinkie/tmp/squid/etc/errorpage.css
err_html_text 
email_err_data on
nonhierarchical_direct on
prefer_direct off
cache_miss_revalidate on
incoming_udp_average 6
incoming_tcp_average 4
incoming_dns_average 4
min_udp_poll_cnt 8
min_dns_poll_cnt 8
min_tcp_poll_cnt 8
client_ip_max_connections -1
tcp_recv_bufsize 0 bytes
icap_enable off
icap_connect_timeout 0 seconds
icap_io_timeout 0 seconds
icap_service_failure_limit 10
icap_service_revival_delay 180
icap_preview_enable on
icap_preview_size -1
icap_206_enable on
icap_default_options_ttl 60
icap_persistent_connections on
adaptation_send_client_ip off
adaptation_send_username off
icap_client_username_header X-Client-Username
icap_client_username_encode off
adaptation_service_iteration_limit 16
icap_retry deny all 
 
icap_retry_limit 0
check_hostnames off
allow_underscore on
dns_retransmit_interval 5 seconds
dns_timeout 30 seconds
dns_packet_max 0 bytes
dns_defnames off
dns_multicast_local off
hosts_file yes
ignore_unknown_nameservers on
dns_v4_first off
ipcache_size 1024
ipcache_low 90
ipcache_high 95
fqdncache_size 1024
configuration_includes_quoted_values off
memory_pools on
memory_pools_limit 5242880 bytes
forwarded_for on
cachemgr_passwd none all
client_db on
refresh_all_ims off
reload_into_ims off
connect_retries 0
retry_on_error off
as_whois_server whois.ra.net
offline_mode off
uri_whitespace strip
balance_on_multiple_ip off
pipeline_prefetch 0
high_response_time_warning 0
high_page_fault_warning 0
sleep_after_fork 0
eui_lookup on
max_filedescriptors 0
-------------- next part --------------
HTTP/1.1 200 OK
Server: squid/5.0.0-BZR
Mime-Version: 1.0
Date: Sun, 13 Nov 2016 23:47:08 GMT
Content-Type: text/plain;charset=utf-8
Expires: Sun, 13 Nov 2016 23:47:08 GMT
Last-Modified: Sun, 13 Nov 2016 23:47:08 GMT
X-Cache: MISS from kair
X-Cache-Lookup: MISS from kair:3128
Via: 1.1 kair (squid/5.0.0-BZR)
Connection: close

workers 1
shared_memory_locking off
authenticate_cache_garbage_interval 3600 seconds
authenticate_ttl 3600 seconds
authenticate_ip_ttl 1 seconds
acl CONNECT method  CONNECT 
acl Safe_ports port  80 21 443 70 210 1025-65535 280 488 591 777 
acl SSL_ports port  443 
acl localhet src  169.254.0.0/16 
acl localnet src  0.0.0.1-0.255.255.255 10.0.0.0/8 100.64.0.0/10 172.16.0.0/12 192.168.0.0/16 fc00::/7 fe80::/10 
acl bigacl dstdom_regex  (kinkie.it)|(localhost)|(pattern1)|(pattern2)|(pattern3)|(pattern4)|(pattern5)|(pattern6)|(pattern7)|(pattern8)|(pattern9)|(pattern10)|(pattern11)|(pattern12)|(pattern13)|(pattern14)|(pattern15)|(pattern16)|(pattern17)|(pattern18)|(pattern19)|(pattern20)|(pattern21)|(pattern22)|(pattern23)|(pattern24)|(pattern25)|(pattern26)|(pattern27)|(pattern28)|(pattern29)|(pattern30)|(pattern31)|(pattern32)|(pattern33)|(pattern34)|(pattern35)|(pattern36)|(pattern37)|(pattern38)|(pattern39)|(pattern40)|(pattern41)|(pattern42)|(pattern43)|(pattern44)|(pattern45)|(pattern46)|(pattern47)|(pattern48)|(pattern49)|(pattern50)|(pattern51)|(pattern52)|(pattern53)|(pattern54)|(pattern55)|(pattern56)|(pattern57)|(pattern58)|(pattern59)|(pattern60)|(pattern61)|(pattern62)|(pattern63)|(pattern64)|(pattern65)|(pattern66)|(pattern67)|(pattern68)|(pattern69)|(pattern70)|(pattern71)|(pattern72)|(pattern73)|(pattern74)|(pattern75)|(pattern76)|(pattern77)|(pattern78)|(pattern79)|(pattern80)|(pattern81)|(pattern82)|(pattern83)|(pattern84) (pattern86)|(pattern87)|(pattern88)|(pattern89)|(pattern90)|(pattern91)|(pattern92)|(pattern93)|(pattern94)|(pattern95)|(pattern96)|(pattern97)|(pattern98)|(pattern99)|(pattern100)|(pattern101)|(pattern102)|(pattern103)|(pattern104)|(pattern105)|(pattern106)|(pattern107)|(pattern108)|(pattern109)|(pattern110)|(pattern111)|(pattern112)|(pattern113)|(pattern114)|(pattern115)|(pattern116)|(pattern117)|(pattern118)|(pattern119)|(pattern120)|(pattern121)|(pattern122)|(pattern123)|(pattern124)|(pattern125)|(pattern126)|(pattern127)|(pattern128)|(pattern129)|(pattern130)|(pattern131)|(pattern132)|(pattern133)|(pattern134)|(pattern135)|(pattern136)|(pattern137)|(pattern138)|(pattern139)|(pattern140)|(pattern141)|(pattern142)|(pattern143)|(pattern144)|(pattern145)|(pattern146)|(pattern147)|(pattern148)|(pattern149)|(pattern150)|(pattern151)|(pattern152)|(pattern153)|(pattern154)|(pattern155)|(pattern156)|(pattern157)|(pattern158)|(pattern159)|(pattern160)|(pattern161)|(pattern162)|(pattern163)|(pattern164) (pattern166)|(pattern167)|(pattern168)|(pattern169)|(pattern170)|(pattern171)|(pattern172)|(pattern173)|(pattern174)|(pattern175)|(pattern176)|(pattern177)|(pattern178)|(pattern179)|(pattern180)|(pattern181)|(pattern182)|(pattern183)|(pattern184)|(pattern185)|(pattern186)|(pattern187)|(pattern188)|(pattern189)|(pattern190)|(pattern191)|(pattern192)|(pattern193)|(pattern194)|(pattern195)|(pattern196)|(pattern197)|(pattern198)|(pattern199)|(pattern200)|(pattern201)|(pattern202)|(pattern203)|(pattern204)|(pattern205)|(pattern206)|(pattern207)|(pattern208)|(pattern209)|(pattern210)|(pattern211)|(pattern212)|(pattern213)|(pattern214)|(pattern215)|(pattern216)|(pattern217)|(pattern218)|(pattern219)|(pattern220)|(pattern221)|(pattern222)|(pattern223)|(pattern224)|(pattern225)|(pattern226)|(pattern227)|(pattern228)|(pattern229)|(pattern230)|(pattern231)|(pattern232)|(pattern233)|(pattern234)|(pattern235)|(pattern236)|(pattern237)|(pattern238)|(pattern239)|(pattern240)|(pattern241)|(pattern242)|(pattern243) (pattern245)|(pattern246)|(pattern247)|(pattern248)|(pattern249)|(pattern250)|(pattern251)|(pattern252)|(pattern253)|(pattern254)|(pattern255)|(pattern256)|(pattern257)|(pattern258)|(pattern259)|(pattern260)|(pattern261)|(pattern262)|(pattern263)|(pattern264)|(pattern265)|(pattern266)|(pattern267)|(pattern268)|(pattern269)|(pattern270)|(pattern271)|(pattern272)|(pattern273)|(pattern274)|(pattern275)|(pattern276)|(pattern277)|(pattern278)|(pattern279)|(pattern280)|(pattern281)|(pattern282)|(pattern283)|(pattern284)|(pattern285)|(pattern286)|(pattern287)|(pattern288)|(pattern289)|(pattern290)|(pattern291)|(pattern292)|(pattern293)|(pattern294)|(pattern295)|(pattern296)|(pattern297)|(pattern298)|(pattern299)|(pattern300)|(pattern301)|(pattern302)|(pattern303)|(pattern304)|(pattern305)|(pattern306)|(pattern307)|(pattern308)|(pattern309)|(pattern310)|(pattern311)|(pattern312)|(pattern313)|(pattern314)|(pattern315)|(pattern316)|(pattern317)|(pattern318)|(pattern319)|(pattern320)|(pattern321)|(pattern322) (pattern324)|(pattern325)|(pattern326)|(pattern327)|(pattern328)|(pattern329)|(pattern330)|(pattern331)|(pattern332)|(pattern333)|(pattern334)|(pattern335)|(pattern336)|(pattern337)|(pattern338)|(pattern339)|(pattern340)|(pattern341)|(pattern342)|(pattern343)|(pattern344)|(pattern345)|(pattern346)|(pattern347)|(pattern348)|(pattern349)|(pattern350)|(pattern351)|(pattern352)|(pattern353)|(pattern354)|(pattern355)|(pattern356)|(pattern357)|(pattern358)|(pattern359)|(pattern360)|(pattern361)|(pattern362)|(pattern363)|(pattern364)|(pattern365)|(pattern366)|(pattern367)|(pattern368)|(pattern369)|(pattern370)|(pattern371)|(pattern372)|(pattern373)|(pattern374)|(pattern375)|(pattern376)|(pattern377)|(pattern378)|(pattern379)|(pattern380)|(pattern381)|(pattern382)|(pattern383)|(pattern384)|(pattern385)|(pattern386)|(pattern387)|(pattern388)|(pattern389)|(pattern390)|(pattern391)|(pattern392)|(pattern393)|(pattern394)|(pattern395)|(pattern396)|(pattern397)|(pattern398)|(pattern399)|(pattern400)|(pattern401) (pattern403)|(pattern404)|(pattern405)|(pattern406)|(pattern407)|(pattern408)|(pattern409)|(pattern410)|(pattern411)|(pattern412)|(pattern413)|(pattern414)|(pattern415)|(pattern416)|(pattern417)|(pattern418)|(pattern419)|(pattern420)|(pattern421)|(pattern422)|(pattern423)|(pattern424)|(pattern425)|(pattern426)|(pattern427)|(pattern428)|(pattern429)|(pattern430)|(pattern431)|(pattern432)|(pattern433)|(pattern434)|(pattern435)|(pattern436)|(pattern437)|(pattern438)|(pattern439)|(pattern440)|(pattern441)|(pattern442)|(pattern443)|(pattern444)|(pattern445)|(pattern446)|(pattern447)|(pattern448)|(pattern449)|(pattern450)|(pattern451)|(pattern452)|(pattern453)|(pattern454)|(pattern455)|(pattern456)|(pattern457)|(pattern458)|(pattern459)|(pattern460)|(pattern461)|(pattern462)|(pattern463)|(pattern464)|(pattern465)|(pattern466)|(pattern467)|(pattern468)|(pattern469)|(pattern470)|(pattern471)|(pattern472)|(pattern473)|(pattern474)|(pattern475)|(pattern476)|(pattern477)|(pattern478)|(pattern479)|(pattern480) (pattern482)|(pattern483)|(pattern484)|(pattern485)|(pattern486)|(pattern487)|(pattern488)|(pattern489)|(pattern490)|(pattern491)|(pattern492)|(pattern493)|(pattern494)|(pattern495)|(pattern496)|(pattern497)|(pattern498)|(pattern499)|(pattern500)|(pattern501)|(pattern502)|(pattern503)|(pattern504)|(pattern505)|(pattern506)|(pattern507)|(pattern508)|(pattern509)|(pattern510)|(pattern511)|(pattern512)|(pattern513)|(pattern514)|(pattern515)|(pattern516)|(pattern517)|(pattern518)|(pattern519)|(pattern520)|(pattern521)|(pattern522)|(pattern523)|(pattern524)|(pattern525)|(pattern526)|(pattern527)|(pattern528)|(pattern529)|(pattern530)|(pattern531)|(pattern532)|(pattern533)|(pattern534)|(pattern535)|(pattern536)|(pattern537)|(pattern538)|(pattern539)|(pattern540)|(pattern541)|(pattern542)|(pattern543)|(pattern544)|(pattern545)|(pattern546)|(pattern547)|(pattern548)|(pattern549)|(pattern550)|(pattern551)|(pattern552)|(pattern553)|(pattern554)|(pattern555)|(pattern556)|(pattern557)|(pattern558)|(pattern559) (pattern561)|(pattern562)|(pattern563)|(pattern564)|(pattern565)|(pattern566)|(pattern567)|(pattern568)|(pattern569)|(pattern570)|(pattern571)|(pattern572)|(pattern573)|(pattern574)|(pattern575)|(pattern576)|(pattern577)|(pattern578)|(pattern579)|(pattern580)|(pattern581)|(pattern582)|(pattern583)|(pattern584)|(pattern585)|(pattern586)|(pattern587)|(pattern588)|(pattern589)|(pattern590)|(pattern591)|(pattern592)|(pattern593)|(pattern594)|(pattern595)|(pattern596)|(pattern597)|(pattern598)|(pattern599)|(pattern600)|(pattern601)|(pattern602)|(pattern603)|(pattern604)|(pattern605)|(pattern606)|(pattern607)|(pattern608)|(pattern609)|(pattern610)|(pattern611)|(pattern612)|(pattern613)|(pattern614)|(pattern615)|(pattern616)|(pattern617)|(pattern618)|(pattern619)|(pattern620)|(pattern621)|(pattern622)|(pattern623)|(pattern624)|(pattern625)|(pattern626)|(pattern627)|(pattern628)|(pattern629)|(pattern630)|(pattern631)|(pattern632)|(pattern633)|(pattern634)|(pattern635)|(pattern636)|(pattern637)|(pattern638) (pattern640)|(pattern641)|(pattern642)|(pattern643)|(pattern644)|(pattern645)|(pattern646)|(pattern647)|(pattern648)|(pattern649)|(pattern650)|(pattern651)|(pattern652)|(pattern653)|(pattern654)|(pattern655)|(pattern656)|(pattern657)|(pattern658)|(pattern659)|(pattern660)|(pattern661)|(pattern662)|(pattern663)|(pattern664)|(pattern665)|(pattern666)|(pattern667)|(pattern668)|(pattern669)|(pattern670)|(pattern671)|(pattern672)|(pattern673)|(pattern674)|(pattern675)|(pattern676)|(pattern677)|(pattern678)|(pattern679)|(pattern680)|(pattern681)|(pattern682)|(pattern683)|(pattern684)|(pattern685)|(pattern686)|(pattern687)|(pattern688)|(pattern689)|(pattern690)|(pattern691)|(pattern692)|(pattern693)|(pattern694)|(pattern695)|(pattern696)|(pattern697)|(pattern698)|(pattern699)|(pattern700)|(pattern701)|(pattern702)|(pattern703)|(pattern704)|(pattern705)|(pattern706)|(pattern707)|(pattern708)|(pattern709)|(pattern710)|(pattern711)|(pattern712)|(pattern713)|(pattern714)|(pattern715)|(pattern716)|(pattern717) (pattern719)|(pattern720)|(pattern721)|(pattern722)|(pattern723)|(pattern724)|(pattern725)|(pattern726)|(pattern727)|(pattern728)|(pattern729)|(pattern730)|(pattern731)|(pattern732)|(pattern733)|(pattern734)|(pattern735)|(pattern736)|(pattern737)|(pattern738)|(pattern739)|(pattern740)|(pattern741)|(pattern742)|(pattern743)|(pattern744)|(pattern745)|(pattern746)|(pattern747)|(pattern748)|(pattern749)|(pattern750)|(pattern751)|(pattern752)|(pattern753)|(pattern754)|(pattern755)|(pattern756)|(pattern757)|(pattern758)|(pattern759)|(pattern760)|(pattern761)|(pattern762)|(pattern763)|(pattern764)|(pattern765)|(pattern766)|(pattern767)|(pattern768)|(pattern769)|(pattern770)|(pattern771)|(pattern772)|(pattern773)|(pattern774)|(pattern775)|(pattern776)|(pattern777)|(pattern778)|(pattern779)|(pattern780)|(pattern781)|(pattern782)|(pattern783)|(pattern784)|(pattern785)|(pattern786)|(pattern787)|(pattern788)|(pattern789)|(pattern790)|(pattern791)|(pattern792)|(pattern793)|(pattern794)|(pattern795)|(pattern796) (pattern798)|(pattern799)|(pattern800)|(pattern801)|(pattern802)|(pattern803)|(pattern804)|(pattern805)|(pattern806)|(pattern807)|(pattern808)|(pattern809)|(pattern810)|(pattern811)|(pattern812)|(pattern813)|(pattern814)|(pattern815)|(pattern816)|(pattern817)|(pattern818)|(pattern819)|(pattern820)|(pattern821)|(pattern822)|(pattern823)|(pattern824)|(pattern825)|(pattern826)|(pattern827)|(pattern828)|(pattern829)|(pattern830)|(pattern831)|(pattern832)|(pattern833)|(pattern834)|(pattern835)|(pattern836)|(pattern837)|(pattern838)|(pattern839)|(pattern840)|(pattern841)|(pattern842)|(pattern843)|(pattern844)|(pattern845)|(pattern846)|(pattern847)|(pattern848)|(pattern849)|(pattern850)|(pattern851)|(pattern852)|(pattern853)|(pattern854)|(pattern855)|(pattern856)|(pattern857)|(pattern858)|(pattern859)|(pattern860)|(pattern861)|(pattern862)|(pattern863)|(pattern864)|(pattern865)|(pattern866)|(pattern867)|(pattern868)|(pattern869)|(pattern870)|(pattern871)|(pattern872)|(pattern873)|(pattern874)|(pattern875) (pattern877)|(pattern878)|(pattern879)|(pattern880)|(pattern881)|(pattern882)|(pattern883)|(pattern884)|(pattern885)|(pattern886)|(pattern887)|(pattern888)|(pattern889)|(pattern890)|(pattern891)|(pattern892)|(pattern893)|(pattern894)|(pattern895)|(pattern896)|(pattern897)|(pattern898)|(pattern899)|(pattern900)|(pattern901)|(pattern902)|(pattern903)|(pattern904)|(pattern905)|(pattern906)|(pattern907)|(pattern908)|(pattern909)|(pattern910)|(pattern911)|(pattern912)|(pattern913)|(pattern914)|(pattern915)|(pattern916)|(pattern917)|(pattern918)|(pattern919)|(pattern920)|(pattern921)|(pattern922)|(pattern923)|(pattern924)|(pattern925)|(pattern926)|(pattern927)|(pattern928)|(pattern929)|(pattern930)|(pattern931)|(pattern932)|(pattern933)|(pattern934)|(pattern935)|(pattern936)|(pattern937)|(pattern938)|(pattern939)|(pattern940)|(pattern941)|(pattern942)|(pattern943)|(pattern944)|(pattern945)|(pattern946)|(pattern947)|(pattern948)|(pattern949)|(pattern950)|(pattern951)|(pattern952)|(pattern953)|(pattern954) (pattern956)|(pattern957)|(pattern958)|(pattern959)|(pattern960)|(pattern961)|(pattern962)|(pattern963)|(pattern964)|(pattern965)|(pattern966)|(pattern967)|(pattern968)|(pattern969)|(pattern970)|(pattern971)|(pattern972)|(pattern973)|(pattern974)|(pattern975)|(pattern976)|(pattern977)|(pattern978)|(pattern979)|(pattern980)|(pattern981)|(pattern982)|(pattern983)|(pattern984)|(pattern985)|(pattern986)|(pattern987)|(pattern988)|(pattern989)|(pattern990)|(pattern991)|(pattern992)|(pattern993)|(pattern994)|(pattern995)|(pattern996)|(pattern997)|(pattern998) 
acl to_localhost dst  ::1 0.0.0.0 127.0.0.0/8 
acl localhost src  ::1 127.0.0.1 
acl manager url_regex  -i (^cache_object://) +i (^https?://[^/]+/squid-internal-mgr/) 
acl all src  ::/0 
acl ssl::certSelfSigned ssl_error  X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT 
acl ssl::certUntrusted ssl_error  X509_V_ERR_CERT_UNTRUSTED X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY X509_V_ERR_INVALID_CA X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN 
acl ssl::certDomainMismatch ssl_error  SQUID_X509_V_ERR_DOMAIN_MISMATCH 
acl ssl::certNotYetValid ssl_error  X509_V_ERR_CERT_NOT_YET_VALID 
acl ssl::certHasExpired ssl_error  X509_V_ERR_CERT_HAS_EXPIRED 
follow_x_forwarded_for deny all 
 
acl_uses_indirect_client on
delay_pool_uses_indirect_client on
log_uses_indirect_client on
http_access allow bigacl 
 http_access allow manager 
 http_access deny all 
 http_access deny !Safe_ports 
 http_access deny CONNECT !SSL_ports 
 http_access allow localhost manager 
 http_access deny manager 
 http_access allow localnet 
 http_access allow localhost 
 http_access deny all 
 
http_port [::]:3128 name=3128 connection-auth=on tls-disable
https_port [::]:3128 name=3128 connection-auth=on tls-disable
vhost_verify_strict off
client_dst_passthru on
tls_outgoing_options
ssl_unclean_shutdown off
sslproxy_session_ttl 300
sslproxy_session_cache_size 2097152 bytes
sslproxy_cert_sign signUntrusted (sslproxy_cert_sign signUntrusted line) 

sslproxy_cert_sign signSelf (sslproxy_cert_sign signSelf line) 

sslproxy_cert_sign signTrusted (sslproxy_cert_sign signTrusted line) 


sslcrtvalidator_children 32 startup=5 idle=1 concurrency=1
dead_peer_timeout 10 seconds
forward_max_tries 25
cache_mem 268435456 bytes
maximum_object_size_in_memory 524288 bytes
memory_cache_shared off
memory_cache_mode always
memory_replacement_policy lru
cache_replacement_policy lru
minimum_object_size 0 bytes
maximum_object_size 4194304 bytes
store_dir_select_algorithm least-load
max_open_disk_fds 0
cache_swap_low 90
cache_swap_high 95
access_log daemon:/Users/kinkie/tmp/squid/var/logs/access.log logformat=squid(access_log daemon:/Users/kinkie/tmp/squid/var/logs/access.log 

logfile_daemon /Users/kinkie/tmp/squid/libexec/log_file_daemon
logfile_rotate 10
mime_table /Users/kinkie/tmp/squid/etc/mime.conf
log_mime_hdrs off
pid_filename /Users/kinkie/tmp/squid/var/run/squid.pid
client_netmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
strip_query_terms on
buffered_logs off
netdb_filename stdio:/Users/kinkie/tmp/squid/var/cache/squid/netdb.state
cache_log /Users/kinkie/tmp/squid/var/logs/cache.log
debug_options ALL,1
coredump_dir /Users/kinkie/tmp/squid/var/cache/squid
ftp_user Squid@
ftp_passive on
ftp_epsv_all off
ftp_eprt on
ftp_sanitycheck on
ftp_telnet_protocol on
diskd_program /Users/kinkie/tmp/squid/libexec/diskd
unlinkd_program /Users/kinkie/tmp/squid/libexec/unlinkd
pinger_program /Users/kinkie/tmp/squid/libexec/pinger
pinger_enable on

url_rewrite_children 20 startup=0 idle=1 concurrency=0
url_rewrite_host_header on
url_rewrite_bypass off
url_rewrite_extras %>a/%>A %un %>rm myip=%la myport=%lp
url_rewrite_timeout 0 seconds
 on_timeout=bypass
store_id_extras %>a/%>A %un %>rm myip=%la myport=%lp

store_id_children 20 startup=0 idle=1 concurrency=0
store_id_bypass on
max_stale 604800 seconds
refresh_pattern ^ftp: 1440 20% 10080
refresh_pattern ^gopher: 1440 0% 1440
refresh_pattern -i (/cgi-bin/|\?) 0 0% 0
refresh_pattern . 0 20% 4320
quick_abort_min 16 KB
quick_abort_max 16 KB
quick_abort_pct 95
read_ahead_gap 16384 bytes
negative_ttl 0 seconds
positive_dns_ttl 21600 seconds
negative_dns_ttl 60 seconds
minimum_expiry_time 60 seconds
store_avg_object_size 13312 bytes
store_objects_per_bucket 20
request_header_max_size 65536 bytes
reply_header_max_size 65536 bytes
request_body_max_size 0 bytes
client_request_buffer_max_size 524288 bytes
adaptation_uses_indirect_client on
via on
vary_ignore_expire off
request_entities off
relaxed_header_parser on
collapsed_forwarding off
collapsed_forwarding_shared_entries_limit 16384
forward_timeout 240 seconds
connect_timeout 60 seconds
peer_connect_timeout 30 seconds
read_timeout 900 seconds
write_timeout 900 seconds
request_timeout 300 seconds
request_start_timeout 300 seconds
client_idle_pconn_timeout 120 seconds
ftp_client_idle_timeout 1800 seconds
client_lifetime 86400 seconds
pconn_lifetime 0 seconds
half_closed_clients off
server_idle_pconn_timeout 60 seconds
ident_timeout 10 seconds
shutdown_lifetime 1 seconds
cache_mgr webmaster
mail_program mail
cache_effective_user nobody
httpd_suppress_version_string off
umask 23
announce_period 31536000 seconds
announce_host tracker.ircache.net
announce_port 3131
httpd_accel_surrogate_id kair
http_accel_surrogate_remote off
esi_parser custom
delay_pools 0
delay_initial_bucket_level 50
client_delay_initial_bucket_level 50
wccp_router ::
wccp_version 4
wccp2_rebuild_wait on
wccp2_forwarding_method gre
wccp2_return_method gre
wccp2_assignment_method hash
wccp2_service standard 0
wccp2_weight 10000
wccp_address 0.0.0.0
wccp2_address 0.0.0.0
client_persistent_connections on
server_persistent_connections on
persistent_connection_after_error on
detect_broken_pconn off
digest_generation on
digest_bits_per_entry 5
digest_rebuild_period 3600 seconds
digest_rewrite_period 3600 seconds
digest_swapout_chunk_size 4096 bytes
digest_rebuild_chunk_percentage 10
snmp_port 0
snmp_incoming_address ::
snmp_outgoing_address ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
icp_port 0
htcp_port 0
log_icp_queries on
udp_incoming_address ::
udp_outgoing_address ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
icp_hit_stale off
minimum_direct_hops 4
minimum_direct_rtt 400
netdb_low 900
netdb_high 1000
netdb_ping_period 300 seconds
query_icmp off
test_reachability off
icp_query_timeout 0
maximum_icp_query_timeout 2000
minimum_icp_query_timeout 5
background_ping_rate 10 seconds
mcast_icp_query_timeout 2000
icon_directory /Users/kinkie/tmp/squid/share/icons
global_internal_static on
short_icon_urls on
error_log_languages on
err_page_stylesheet /Users/kinkie/tmp/squid/etc/errorpage.css
err_html_text 
email_err_data on
nonhierarchical_direct on
prefer_direct off
cache_miss_revalidate on
incoming_udp_average 6
incoming_tcp_average 4
incoming_dns_average 4
min_udp_poll_cnt 8
min_dns_poll_cnt 8
min_tcp_poll_cnt 8
client_ip_max_connections -1
tcp_recv_bufsize 0 bytes
icap_enable off
icap_connect_timeout 0 seconds
icap_io_timeout 0 seconds
icap_service_failure_limit 10
icap_service_revival_delay 180
icap_preview_enable on
icap_preview_size -1
icap_206_enable on
icap_default_options_ttl 60
icap_persistent_connections on
adaptation_send_client_ip off
adaptation_send_username off
icap_client_username_header X-Client-Username
icap_client_username_encode off
adaptation_service_iteration_limit 16
icap_retry deny all 
 
icap_retry_limit 0
check_hostnames off
allow_underscore on
dns_retransmit_interval 5 seconds
dns_timeout 30 seconds
dns_packet_max 0 bytes
dns_defnames off
dns_multicast_local off
hosts_file yes
ignore_unknown_nameservers on
dns_v4_first off
ipcache_size 1024
ipcache_low 90
ipcache_high 95
fqdncache_size 1024
configuration_includes_quoted_values off
memory_pools on
memory_pools_limit 5242880 bytes
forwarded_for on
cachemgr_passwd none all
client_db on
refresh_all_ims off
reload_into_ims off
connect_retries 0
retry_on_error off
as_whois_server whois.ra.net
offline_mode off
uri_whitespace strip
balance_on_multiple_ip off
pipeline_prefetch 0
high_response_time_warning 0
high_page_fault_warning 0
sleep_after_fork 0
eui_lookup on
max_filedescriptors 0
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wordlist-sbuflist-aclregexdata.patch
Type: application/octet-stream
Size: 12604 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161114/2f8b62cb/attachment-0001.obj>

From squid3 at treenet.co.nz  Mon Nov 14 05:15:01 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 14 Nov 2016 18:15:01 +1300
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
Message-ID: <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>

On 14/11/2016 1:11 p.m., Kinkie wrote:
> Hi all,
>   the attached patch moves away from hand-rolling a c-string onto
> joining a SBufList for optimizing regexes in RegexData.cc.
> 
> You can find attached as a test case the output of squidclient
> mgr:config taken on trunk and on the submitted code. It is slightly
> different in that the new code allows for a longer optimized regex.
>   The code is expected to cause a small performance regression on
> parse and reconfigure due to extra data copies. The regression is
> negligible: the attached test cases perform "squid -k parse" in 60
> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
> air.
> 
> 
> [RFC]
> The code managing case-insensitivity flags is IMO quite complicated
> and not really intuitive: it switches between case-insensitive and
> case-sensitive each time it meets a -i flag. I would like to change
> the behaviour so that a -i flag makes the whole acl case-insensitive;
> this seems to me consistent with the behavior documented in squid.conf
> which does not document the case of multiple -i flags in a single
> regex-type ACL. I'd like feedback on this proposal.
> 

I'm aware of a few sites relying on that behaviour.

I think we should accumulate into two SBufList instead, one for -i and
one for +i instead of switching back and forth with potentially lots of
little patterns.

Amos


From rousskov at measurement-factory.com  Mon Nov 14 05:30:12 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 13 Nov 2016 22:30:12 -0700
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
Message-ID: <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>

On 11/13/2016 05:11 PM, Kinkie wrote:

> the attached patch moves away from hand-rolling a c-string onto
> joining a SBufList for optimizing regexes in RegexData.cc.

> You can find attached as a test case the output of squidclient
> mgr:config taken on trunk and on the submitted code. It is slightly
> different in that the new code allows for a longer optimized regex.

I see the following before/after difference:

  -acl bigacl dstdom_regex ... (pattern84) (pattern86) ...
  +acl bigacl dstdom_regex ... (pattern84)|(pattern85) ...

Does changing space into "|" result in one internal regex instead of
two? And that is the optimization you have implemented? How is that
related to SBufs (i.e., why could not old c-strings accommodate longer
regexes)?

And why is there no pattern85 in the "before" test?!


> The code is expected to cause a small performance regression on
> parse and reconfigure due to extra data copies. The regression is
> negligible: the attached test cases perform "squid -k parse" in 60
> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
> air.

A 3% performance regression is not necessarily negligible. Have you
tested with more ACL lines (not larger individual ACL lines) that take a
few seconds to load (as opposed to 60ms) ? If not, please do unless that
test would be irrelevant somehow.

And what is the expected performance improvement from having fewer
longer regexes?


> [RFC]

This should be a different thread IMHO.


> The code managing case-insensitivity flags is IMO quite complicated
> and not really intuitive: it switches between case-insensitive and
> case-sensitive each time it meets a -i flag. 

It does?! Wow! The documentation says that +i switches back to
case-sensitive rather than repeating -i values. If Squid does something
else here, that would be a pretty big bug IMO!


> I would like to change
> the behaviour so that a -i flag makes the whole acl case-insensitive;
> this seems to me consistent with the behavior documented in squid.conf
> which does not document the case of multiple -i flags in a single
> regex-type ACL. I'd like feedback on this proposal.

I am not 100% sure what you mean by "whole acl" exactly, but please see
the "Where do ACL flags belong?" RFC[1] for a comprehensive coverage of
a similar problem and the agreed solution. The initial discussion was
mostly noise, but things started to make sense around [2]. Your -i is
mentioned frequently, including the last(?) email on that thread[3].

AFAICT, the agreed solutions have not been implemented yet so if you
have the cycles to work on this, you may be able to address all the
related problems at once and make things consistent across all options
of all ACLs. You should probably post a revised RFC (summarizing all
known issues and corresponding changes) if you are going to do that.


[1]
http://lists.squid-cache.org/pipermail/squid-dev/2015-December/004034.html

[2]
http://lists.squid-cache.org/pipermail/squid-dev/2015-December/004044.html

[3]
http://lists.squid-cache.org/pipermail/squid-dev/2015-December/004096.html


Thank you,

Alex.


From rousskov at measurement-factory.com  Mon Nov 14 05:36:42 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 13 Nov 2016 22:36:42 -0700
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
Message-ID: <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>

On 11/13/2016 10:15 PM, Amos Jeffries wrote:

> I think we should accumulate into two SBufList instead, one for -i and
> one for +i instead of switching back and forth with potentially lots of
> little patterns.

Would not forcing regexes into two different groups change the regex
evaluation order and, hence, make it more difficult for some admins to
optimize their regexes by placing frequently matching regexes earlier?

I am still not quite sure what problem we are trying to solve exactly
here, but allowing admins to control exact regex evaluation order seems
important [for some admins].

Alex.


From squid3 at treenet.co.nz  Mon Nov 14 05:59:48 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 14 Nov 2016 18:59:48 +1300
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
Message-ID: <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>

On 14/11/2016 6:30 p.m., Alex Rousskov wrote:
> On 11/13/2016 05:11 PM, Kinkie wrote:
> 
>> the attached patch moves away from hand-rolling a c-string onto
>> joining a SBufList for optimizing regexes in RegexData.cc.
> 
>> You can find attached as a test case the output of squidclient
>> mgr:config taken on trunk and on the submitted code. It is slightly
>> different in that the new code allows for a longer optimized regex.
> 
> I see the following before/after difference:
> 
>   -acl bigacl dstdom_regex ... (pattern84) (pattern86) ...
>   +acl bigacl dstdom_regex ... (pattern84)|(pattern85) ...
> 
> Does changing space into "|" result in one internal regex instead of
> two?

It does / should.

> And that is the optimization you have implemented?

No, that was implemented long ago by Marcus. We got a ~20% speed
increase from that. More complexity in the individual regex test seemed
to counteract the fewer tests done.


> How is that
> related to SBufs (i.e., why could not old c-strings accommodate longer
> regexes)?

FYI (to kinkie): The 100 patterns per aggregation was an arbitrary
limit, but the total string length is limited by the ConfigParser buffers.

The plain-text length of the aggregated regex string needs to fit within
one squid.conf line length. With space for the directive name, label,
type and flags being included in the limit.


> 
> And why is there no pattern85 in the "before" test?!
> 
> 
>> The code is expected to cause a small performance regression on
>> parse and reconfigure due to extra data copies. The regression is
>> negligible: the attached test cases perform "squid -k parse" in 60
>> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
>> air.
> 
> A 3% performance regression is not necessarily negligible. Have you
> tested with more ACL lines (not larger individual ACL lines) that take a
> few seconds to load (as opposed to 60ms) ? If not, please do unless that
> test would be irrelevant somehow.
> 
> And what is the expected performance improvement from having fewer
> longer regexes?

I assume you mean performance of normal request processing through the
regex ACL. Agreed, that need to be checked/compared to current speeds.

Amos


From squid3 at treenet.co.nz  Mon Nov 14 06:02:53 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 14 Nov 2016 19:02:53 +1300
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
 <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
Message-ID: <070ce8a2-bef5-de9b-5c2c-e2f446ce17e4@treenet.co.nz>

On 14/11/2016 6:36 p.m., Alex Rousskov wrote:
> On 11/13/2016 10:15 PM, Amos Jeffries wrote:
> 
>> I think we should accumulate into two SBufList instead, one for -i and
>> one for +i instead of switching back and forth with potentially lots of
>> little patterns.
> 
> Would not forcing regexes into two different groups change the regex
> evaluation order and, hence, make it more difficult for some admins to
> optimize their regexes by placing frequently matching regexes earlier?
> 
> I am still not quite sure what problem we are trying to solve exactly
> here, but allowing admins to control exact regex evaluation order seems
> important [for some admins].

Good point.

AFAIK the goal is twofold;

1) removing wordlist usage.

 It gets replaced with SBufList.

2) improved performance.

 One of the often raised reasons for people still using re-writer
helpers is that Squid regex take so long to reconfigure when big (MB)
lists are used.

Amos


From gkinkie at gmail.com  Mon Nov 14 10:42:55 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 10:42:55 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
Message-ID: <CA+Y8hcO_1JFNoG62n_=_+FEk1YYNDhQXb=qshcRP0Yagmy_jVQ@mail.gmail.com>

On Mon, Nov 14, 2016 at 5:30 AM, Alex Rousskov
<rousskov at measurement-factory.com> wrote:
> On 11/13/2016 05:11 PM, Kinkie wrote:
>
>> the attached patch moves away from hand-rolling a c-string onto
>> joining a SBufList for optimizing regexes in RegexData.cc.
>
>> You can find attached as a test case the output of squidclient
>> mgr:config taken on trunk and on the submitted code. It is slightly
>> different in that the new code allows for a longer optimized regex.
>
> I see the following before/after difference:
>
>   -acl bigacl dstdom_regex ... (pattern84) (pattern86) ...
>   +acl bigacl dstdom_regex ... (pattern84)|(pattern85) ...
>
> Does changing space into "|" result in one internal regex instead of
> two? And that is the optimization you have implemented? How is that
> related to SBufs (i.e., why could not old c-strings accommodate longer
> regexes)?

If we feed too big a regex to the regex compiler it will crash with
OOM; 1024 bytes is probably on the conservative side, but it's hard to
set a predictable limit so I've mostly ketp it. This said, I've
slightly raised the limit by not counting the separators in the total
length, and this explains the difference: we use a few more patterns
per optimized regex.

>
> And why is there no pattern85 in the "before" test?!

Now that is interesting. The code is apparently buggy, and will forget
the last (or first) acl for each optimized ACL. I suspect we have a
bug in trunk, and have had for some time.

>> The code is expected to cause a small performance regression on
>> parse and reconfigure due to extra data copies. The regression is
>> negligible: the attached test cases perform "squid -k parse" in 60
>> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
>> air.
>
> A 3% performance regression is not necessarily negligible. Have you
> tested with more ACL lines (not larger individual ACL lines) that take a
> few seconds to load (as opposed to 60ms) ? If not, please do unless that
> test would be irrelevant somehow.

I've done this test. Whatever performance regression this is
introducing is more than offset by the big benefit of dumping wordlist
in fovour of sbuflist.
I've tested on a 1M-entries, 13MB-long acl, where entries are randomly
generated:

Time for "squid -k parse" was  23 seconds on my macbook air.

> And what is the expected performance improvement from having fewer
> longer regexes?

Amos already answered this one.

>> [RFC]

Thanks for the pointers on this; I'll check them and move to a
separate thread as you suggest.

  Kinkie

From gkinkie at gmail.com  Mon Nov 14 10:49:07 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 10:49:07 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
 <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
Message-ID: <CA+Y8hcNa6BAgAiobbK-Yt0AkiyKSeTxNW=vfbxx_zkB+10psCA@mail.gmail.com>

On Mon, Nov 14, 2016 at 5:36 AM, Alex Rousskov
<rousskov at measurement-factory.com> wrote:
> On 11/13/2016 10:15 PM, Amos Jeffries wrote:
>
>> I think we should accumulate into two SBufList instead, one for -i and
>> one for +i instead of switching back and forth with potentially lots of
>> little patterns.
>
> Would not forcing regexes into two different groups change the regex
> evaluation order and, hence, make it more difficult for some admins to
> optimize their regexes by placing frequently matching regexes earlier?
>
> I am still not quite sure what problem we are trying to solve exactly
> here, but allowing admins to control exact regex evaluation order seems
> important [for some admins].

Then these admins should not optimize, as the compiled regex' FSM
guarantees the same results but not necessarily evaluation order.
And IMO mixing insensitive and sensitive regexes is bad practice which
I would advise against in the documentation.


-- 
    Francesco

From squid3 at treenet.co.nz  Mon Nov 14 10:53:06 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 14 Nov 2016 23:53:06 +1300
Subject: [squid-dev] [PATCH] ssl::server_name ACL badly broken since
 inception (trunk r14008).
In-Reply-To: <3980028d-7c37-c31a-3fec-a984759cb914@chtsanti.net>
References: <dbe554e3-6099-2dda-9029-8ca64f990886@chtsanti.net>
 <263b52dc-2b51-899b-14fc-2557771bb6d6@treenet.co.nz>
 <3980028d-7c37-c31a-3fec-a984759cb914@chtsanti.net>
Message-ID: <1611bff6-8c49-e051-59b9-6981558e220c@treenet.co.nz>

On 28/10/2016 9:39 p.m., Christos Tsantilas wrote:
> Patch applied to trunk as r14898.
> 
> I am attaching the squid-3.5 version of the patch.
> 

Applied to 3.5 as r14110.

Amos


From gkinkie at gmail.com  Mon Nov 14 11:04:21 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 11:04:21 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
 <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
Message-ID: <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>

On Mon, Nov 14, 2016 at 5:59 AM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
> On 14/11/2016 6:30 p.m., Alex Rousskov wrote:
>> On 11/13/2016 05:11 PM, Kinkie wrote:
>>
>>> the attached patch moves away from hand-rolling a c-string onto
>>> joining a SBufList for optimizing regexes in RegexData.cc.
>>
>>> You can find attached as a test case the output of squidclient
>>> mgr:config taken on trunk and on the submitted code. It is slightly
>>> different in that the new code allows for a longer optimized regex.
>>
>> I see the following before/after difference:
>>
>>   -acl bigacl dstdom_regex ... (pattern84) (pattern86) ...
>>   +acl bigacl dstdom_regex ... (pattern84)|(pattern85) ...
>>
>> Does changing space into "|" result in one internal regex instead of
>> two?
>
> It does / should.
>
>> And that is the optimization you have implemented?
>
> No, that was implemented long ago by Marcus. We got a ~20% speed
> increase from that. More complexity in the individual regex test seemed
> to counteract the fewer tests done.
>
>
>> How is that
>> related to SBufs (i.e., why could not old c-strings accommodate longer
>> regexes)?
>
> FYI (to kinkie): The 100 patterns per aggregation was an arbitrary
> limit, but the total string length is limited by the ConfigParser buffers.
>
> The plain-text length of the aggregated regex string needs to fit within
> one squid.conf line length. With space for the directive name, label,
> type and flags being included in the limit.

that's BUFSIZ, or 4k. We currently have 1K + separator, name and flags.
If anything, we could be more aggressive in having longer regexes,
modulo OOM in regcomp.

>> And why is there no pattern85 in the "before" test?!
>>
>>
>>> The code is expected to cause a small performance regression on
>>> parse and reconfigure due to extra data copies. The regression is
>>> negligible: the attached test cases perform "squid -k parse" in 60
>>> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
>>> air.
>>
>> A 3% performance regression is not necessarily negligible. Have you
>> tested with more ACL lines (not larger individual ACL lines) that take a
>> few seconds to load (as opposed to 60ms) ? If not, please do unless that
>> test would be irrelevant somehow.
>>
>> And what is the expected performance improvement from having fewer
>> longer regexes?
>
> I assume you mean performance of normal request processing through the
> regex ACL. Agreed, that need to be checked/compared to current speeds.

Time needed for squid -k parse on my Mac 1.3GHz i5 macbook air, for a
1M-entry random ACL, 13Mb-big:
new: 20.8s
trunk: 18.3s

Hopefully in time we'll move the config parser to SBuf..

-- 
    Francesco

From squid3 at treenet.co.nz  Mon Nov 14 13:20:04 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 15 Nov 2016 02:20:04 +1300
Subject: [squid-dev] [PATCH] Fix for the bug 3533
In-Reply-To: <c27115252130dd4dbe1993c9de21bcb9@comnet.uz>
References: <c27115252130dd4dbe1993c9de21bcb9@comnet.uz>
Message-ID: <49682024-68ad-da1f-d5eb-0821bc22b87a@treenet.co.nz>

On 13/11/2016 9:40 a.m., Garri Djavadyan wrote:
> Dear developers,
> 
> The attached patch fixes the bug 3533 [1], still existing in trunk
> (revno: 14938). The problem relates to the fact that the code 303
> (scSeeOther) is not considered by Squid as a one permitted to remove
> public store entries. Below is excerpt from src/http.cc:
> 
>    180    /// Remove an existing public store entry if the incoming
> response (to be
>    181    /// stored in a currently private entry) is going to
> invalidate it.
>    182    static void
>    183    httpMaybeRemovePublic(StoreEntry * e, Http::StatusCode status)
> 
> I've successfully replicated the issue and the patch solved the problem
> in my test environment.
> 
> 
> [1] http://bugs.squid-cache.org/show_bug.cgi?id=3533
> 

Thanks. Applied to Squid-5 as r14940.

Amos



From gkinkie at gmail.com  Mon Nov 14 16:12:47 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 16:12:47 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
Message-ID: <CA+Y8hcNPq7ZVaDR415zsixmyvZaeKrk2FQqUaOmW1uPXesUPLw@mail.gmail.com>

>> The code managing case-insensitivity flags is IMO quite complicated
>> and not really intuitive: it switches between case-insensitive and
>> case-sensitive each time it meets a -i flag.
>
> It does?! Wow! The documentation says that +i switches back to
> case-sensitive rather than repeating -i values. If Squid does something
> else here, that would be a pretty big bug IMO!

Double-checked. No it doesn't, it uses -i and +i as documented, I was
remembering wrong details.

Kinkie

From gkinkie at gmail.com  Mon Nov 14 16:34:03 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 16:34:03 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
 <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
 <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>
Message-ID: <CA+Y8hcMmp9ujYJ-Cwh6dov6HxHGtDFLDj8sQ=xXH-i2SV7zg_A@mail.gmail.com>

Hi,
  the attached patch fixes the issue with missing ACL entries
(verified) and streamlines the code a bit.

Performance-wise it improves a bit, parsing the same 1M-entry ACL in
19.4 seconds (17.8 seconds in userland).



On Mon, Nov 14, 2016 at 11:04 AM, Kinkie <gkinkie at gmail.com> wrote:
> On Mon, Nov 14, 2016 at 5:59 AM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
>> On 14/11/2016 6:30 p.m., Alex Rousskov wrote:
>>> On 11/13/2016 05:11 PM, Kinkie wrote:
>>>
>>>> the attached patch moves away from hand-rolling a c-string onto
>>>> joining a SBufList for optimizing regexes in RegexData.cc.
>>>
>>>> You can find attached as a test case the output of squidclient
>>>> mgr:config taken on trunk and on the submitted code. It is slightly
>>>> different in that the new code allows for a longer optimized regex.
>>>
>>> I see the following before/after difference:
>>>
>>>   -acl bigacl dstdom_regex ... (pattern84) (pattern86) ...
>>>   +acl bigacl dstdom_regex ... (pattern84)|(pattern85) ...
>>>
>>> Does changing space into "|" result in one internal regex instead of
>>> two?
>>
>> It does / should.
>>
>>> And that is the optimization you have implemented?
>>
>> No, that was implemented long ago by Marcus. We got a ~20% speed
>> increase from that. More complexity in the individual regex test seemed
>> to counteract the fewer tests done.
>>
>>
>>> How is that
>>> related to SBufs (i.e., why could not old c-strings accommodate longer
>>> regexes)?
>>
>> FYI (to kinkie): The 100 patterns per aggregation was an arbitrary
>> limit, but the total string length is limited by the ConfigParser buffers.
>>
>> The plain-text length of the aggregated regex string needs to fit within
>> one squid.conf line length. With space for the directive name, label,
>> type and flags being included in the limit.
>
> that's BUFSIZ, or 4k. We currently have 1K + separator, name and flags.
> If anything, we could be more aggressive in having longer regexes,
> modulo OOM in regcomp.
>
>>> And why is there no pattern85 in the "before" test?!
>>>
>>>
>>>> The code is expected to cause a small performance regression on
>>>> parse and reconfigure due to extra data copies. The regression is
>>>> negligible: the attached test cases perform "squid -k parse" in 60
>>>> msec in trunk and 62 on the branch on a warm cache on my i5 macbook
>>>> air.
>>>
>>> A 3% performance regression is not necessarily negligible. Have you
>>> tested with more ACL lines (not larger individual ACL lines) that take a
>>> few seconds to load (as opposed to 60ms) ? If not, please do unless that
>>> test would be irrelevant somehow.
>>>
>>> And what is the expected performance improvement from having fewer
>>> longer regexes?
>>
>> I assume you mean performance of normal request processing through the
>> regex ACL. Agreed, that need to be checked/compared to current speeds.
>
> Time needed for squid -k parse on my Mac 1.3GHz i5 macbook air, for a
> 1M-entry random ACL, 13Mb-big:
> new: 20.8s
> trunk: 18.3s
>
> Hopefully in time we'll move the config parser to SBuf..
>
> --
>     Francesco



-- 
    Francesco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wordlist-sbuflist-aclregexdata-v2.patch
Type: application/octet-stream
Size: 8718 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161114/d23e1805/attachment.obj>

From rousskov at measurement-factory.com  Mon Nov 14 17:02:57 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Mon, 14 Nov 2016 10:02:57 -0700
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <070ce8a2-bef5-de9b-5c2c-e2f446ce17e4@treenet.co.nz>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
 <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
 <070ce8a2-bef5-de9b-5c2c-e2f446ce17e4@treenet.co.nz>
Message-ID: <258e7602-e232-7e5c-e74f-62c9664b46d7@measurement-factory.com>

On 11/13/2016 11:02 PM, Amos Jeffries wrote:
> On 14/11/2016 6:36 p.m., Alex Rousskov wrote:
>> On 11/13/2016 10:15 PM, Amos Jeffries wrote:
>>
>>> I think we should accumulate into two SBufList instead, one for -i and
>>> one for +i instead of switching back and forth with potentially lots of
>>> little patterns.
>>
>> Would not forcing regexes into two different groups change the regex
>> evaluation order and, hence, make it more difficult for some admins to
>> optimize their regexes by placing frequently matching regexes earlier?
>>
>> I am still not quite sure what problem we are trying to solve exactly
>> here, but allowing admins to control exact regex evaluation order seems
>> important [for some admins].
> 
> Good point.
> 
> AFAIK the goal is twofold;
> 
> 1) removing wordlist usage.
> 
>  It gets replaced with SBufList.
> 
> 2) improved performance.
> 
>  One of the often raised reasons for people still using re-writer
> helpers is that Squid regex take so long to reconfigure when big (MB)
> lists are used.

For the record, I do not plan on reviewing this patch further. I did
what I could, but there is just too much information missing for me to
reconstruct the exact intent and evaluate the results. IMHO, I should
not be parsing large raw dumps to figure out what the patch does or does
not do. I am sure you and Kinkie do not need me to finish this.


Thank you,

Alex.


From gkinkie at gmail.com  Mon Nov 14 17:10:31 2016
From: gkinkie at gmail.com (Kinkie)
Date: Mon, 14 Nov 2016 17:10:31 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <258e7602-e232-7e5c-e74f-62c9664b46d7@measurement-factory.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <1426389f-2b17-0835-0505-ad417cd255de@treenet.co.nz>
 <47499e4b-6640-e8ed-8e22-3d97c197c176@measurement-factory.com>
 <070ce8a2-bef5-de9b-5c2c-e2f446ce17e4@treenet.co.nz>
 <258e7602-e232-7e5c-e74f-62c9664b46d7@measurement-factory.com>
Message-ID: <CA+Y8hcOizhjsokwb_WA8H1vnfaeiwci1XfJp_e5+e1JxNXrXKA@mail.gmail.com>

> For the record, I do not plan on reviewing this patch further. I did
> what I could, but there is just too much information missing for me to
> reconstruct the exact intent and evaluate the results. IMHO, I should
> not be parsing large raw dumps to figure out what the patch does or does
> not do. I am sure you and Kinkie do not need me to finish this.

Thanks for helping out so far.


-- 
    Francesco

From christos at chtsanti.net  Mon Nov 14 18:03:23 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Mon, 14 Nov 2016 20:03:23 +0200
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
Message-ID: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>

The following sequence of events triggers this assertion:
   - The server sends an 1xx control message.
   - http.cc schedules ConnStateData::sendControlMsg call.
   - Before sendControlMsg is fired, http.cc detects an error (e.g., I/O 
error or timeout) and starts writing the reply to the user.
   - The ConnStateData::sendControlMsg is fired, starts writing 1xx, and 
hits the "no concurrent writes" assertion.

We could only reproduce this sequence in the lab after changing Squid 
code to trigger a timeout at the right moment, but the sequence looks 
plausible. Other event sequences might result in the same outcome.

To avoid concurrent writes, Squid now drops the control message if 
Http::One::Server detects that a reply is already being written. Also, 
ConnStateData delays reply writing until a pending control message write 
has been completed.


There is strong possibility that the bug fixing this patch is a variant 
of the bug4174:
   http://bugs.squid-cache.org/show_bug.cgi?id=4174
However we are getting different backtrace.


This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-238-assertion_failed_Write_cc_Not_ccb_active-t3.patch
Type: text/x-patch
Size: 11100 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161114/b97e860e/attachment.bin>

From noc at squid-cache.org  Mon Nov 14 18:49:09 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 14 Nov 2016 18:49:09 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=238?=
In-Reply-To: <131878035.1.1478968561238.JavaMail.jenkins@buildmaster>
References: <131878035.1.1478968561238.JavaMail.jenkins@buildmaster>
Message-ID: <1824712414.2.1479149349779.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/8/------------------------------------------
[...truncated 32111 lines...]
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
depbase=`echo xusleep.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT radix.lo -MD -MP -MF .deps/radix.Tpo -c ../../../lib/radix.c  -fPIC -DPIC -o radix.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 5.0.0-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Tue Nov 15 05:18:56 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 15 Nov 2016 18:18:56 +1300
Subject: [squid-dev] [PATCH] ICAP trailer support
In-Reply-To: <58275902.6090709@measurement-factory.com>
References: <0178bbb5-7872-f9f3-7830-9210a44b4614@treenet.co.nz>
 <58275902.6090709@measurement-factory.com>
Message-ID: <ae0385f2-eb60-0855-ace3-1ba7eee4c043@treenet.co.nz>

On 13/11/2016 7:01 a.m., Eduard Bagdasaryan wrote:
> 2016-11-11 8:27 GMT+03:00 Amos Jeffries <squid3 at treenet.co.nz>:
> 
>> In Adaptation::Icap::ModXact::expectIcapTrailers() please use
>> getByIdIfPresent(Http::TRAILER, ...) since Trailer is a registered
>> header.
> 
> Fixed.
> 
>> In answer to "TODO: should we add a new Http::scInvalidTrailer?" only if
>> the draft defines an HTTP 5xx status code called "Ivalid > Trailer".
>> Since the Http::sc* are HTTP status codes.
> 
> The draft does not define HTTP 5xx status codes for invalid trailers.
> Also please note that scInvalidHeader (600 code) is marked for
> internal/Squid-only use. Probably we could similarly use
> scInvalidTrailer with code 602 (for example).
> 
>> Only if all the callers of this function are handling the case where it
>> produces non-1 and adding a terminator LF explicitly for a re-parse
>> attempt.
> 
> I have only found such 're-parse' logic inside
> HttpStateData::processReplyHeader(), marked with the comment. However
> this code does not use the patch-affected HttpHeader::parse(): it uses
> Http::One::Parser::grabMimeBlock() instead. So, nothing to fix here, IMO.
> 

Thanks for checking. Applied to Squid-5 as rev.14941.

Amos


From squid3 at treenet.co.nz  Tue Nov 15 05:21:34 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 15 Nov 2016 18:21:34 +1300
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
Message-ID: <1c278690-9210-9adf-1cba-ce63a016a556@treenet.co.nz>

On 15/11/2016 7:03 a.m., Christos Tsantilas wrote:
> The following sequence of events triggers this assertion:
>   - The server sends an 1xx control message.
>   - http.cc schedules ConnStateData::sendControlMsg call.
>   - Before sendControlMsg is fired, http.cc detects an error (e.g., I/O
> error or timeout) and starts writing the reply to the user.
>   - The ConnStateData::sendControlMsg is fired, starts writing 1xx, and
> hits the "no concurrent writes" assertion.
> 
> We could only reproduce this sequence in the lab after changing Squid
> code to trigger a timeout at the right moment, but the sequence looks
> plausible. Other event sequences might result in the same outcome.
> 
> To avoid concurrent writes, Squid now drops the control message if
> Http::One::Server detects that a reply is already being written. Also,
> ConnStateData delays reply writing until a pending control message write
> has been completed.
> 
> 
> There is strong possibility that the bug fixing this patch is a variant
> of the bug4174:
>   http://bugs.squid-cache.org/show_bug.cgi?id=4174
> However we are getting different backtrace.
> 
> 
> This is a Measurement Factory project.
> 

+1. Looks okay.

Amos


From noc at squid-cache.org  Tue Nov 15 07:26:39 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 07:26:39 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2310?=
Message-ID: <1848329586.3.1479194799121.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/10/------------------------------------------
[...truncated 34378 lines...]
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     delete static_cast<Ssl::Bio*>(table->ptr);
                                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     table->ptr = NULL;
          ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_write(BIO*, const char*, int)':
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_read(BIO*, char*, int)':
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
In file included from ../../../../src/sbuf/SBuf.h:15:0,
                 from ../../../../src/ssl/support.h:18,
                 from ../../../../src/ssl/bio.cc:12:
../../../../src/ssl/bio.cc: In function 'long int squid_bio_ctrl(BIO*, int, long int, void*)':
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         assert(!table->ptr);
                      ^
../../../../src/Debug.h:30:23: note: in definition of macro 'assert'
 #define assert(EX)  ((EX)?((void)0):xassert( # EX , __FILE__, __LINE__))
                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->ptr = bio;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->init = 1;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT context_storage.lo -MD -MP -MF .deps/context_storage.Tpo -c ../../../../src/ssl/context_storage.cc  -fPIC -DPIC -o context_storage.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT cert_validate_message.lo -MD -MP -MF .deps/cert_validate_message.Tpo -c ../../../../src/ssl/cert_validate_message.cc  -fPIC -DPIC -o cert_validate_message.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetail.lo -MD -MP -MF .deps/ErrorDetail.Tpo -c ../../../../src/ssl/ErrorDetail.cc  -fPIC -DPIC -o ErrorDetail.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From garryd at comnet.uz  Tue Nov 15 08:30:04 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Tue, 15 Nov 2016 13:30:04 +0500
Subject: [squid-dev] [PATCH] Fix for bug 4630
Message-ID: <1479198604.30825.18.camel@comnet.uz>

Hello,

Please review the attached one-line patch for Squid-5 fixing the issue
described in the report [1]. Thanks in advance!

[1]http://bugs.squid-cache.org/show_bug.cgi?id=4630


Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_bug4630.patch
Type: text/x-patch
Size: 278 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161115/4bc79e26/attachment-0001.bin>

From squid3 at treenet.co.nz  Tue Nov 15 09:37:42 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 15 Nov 2016 22:37:42 +1300
Subject: [squid-dev] [PATCH] Fix for bug 4630
In-Reply-To: <1479198604.30825.18.camel@comnet.uz>
References: <1479198604.30825.18.camel@comnet.uz>
Message-ID: <fba03547-4e48-f707-b527-88a400d91e9a@treenet.co.nz>

On 15/11/2016 9:30 p.m., Garri Djavadyan wrote:
> Hello,
> 
> Please review the attached one-line patch for Squid-5 fixing the issue
> described in the report [1]. Thanks in advance!
> 
> [1] http://bugs.squid-cache.org/show_bug.cgi?id=4630

Thanks for the reminder. Applied as Squid-5 r14944.

Amos


From noc at squid-cache.org  Tue Nov 15 10:03:52 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 10:03:52 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
	=?utf-8?q?gcc=2Cd-centos-7_=2310?=
Message-ID: <697425923.4.1479204232103.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/10/------------------------------------------
[...truncated 10806 lines...]
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build'>
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testCacheManager] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEvent] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEventLoop] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/test_http_range] Error 1
make[4]: *** [check-am] Error 2
make[3]: *** [check-recursive] Error 1
make[2]: *** [check] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Tue Nov 15 10:30:30 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 10:30:30 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
	=?utf-8?q?gcc=2Cd-fedora-21_=2310?=
Message-ID: <951178251.5.1479205830458.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/10/------------------------------------------
[...truncated 10774 lines...]
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
Makefile:6502: recipe for target 'tests/test_http_range' failed
make[5]: *** [tests/test_http_range] Error 1
make[5]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
Makefile:7435: recipe for target 'check-am' failed
make[4]: *** [check-am] Error 2
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
Makefile:6921: recipe for target 'check-recursive' failed
make[3]: *** [check-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
Makefile:7438: recipe for target 'check' failed
make[2]: *** [check] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
Makefile:570: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build'>
Makefile:778: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -I/usr/include/p11-kit-1  -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -I/usr/include/p11-kit-1  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -I/usr/include/p11-kit-1  -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -I/usr/include/p11-kit-1  -g -O2 -std=c++11
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testCacheManager] Error 1
make[5]: *** [tests/testEvent] Error 1
make[5]: *** [tests/testEventLoop] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/test_http_range] Error 1
make[4]: *** [check-am] Error 2
make[3]: *** [check-recursive] Error 1
make[2]: *** [check] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Tue Nov 15 10:43:05 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 10:43:05 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
	=?utf-8?q?gcc=2Cd-ubuntu-wily_=2310?=
Message-ID: <1612711809.6.1479206585683.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/10/------------------------------------------
[...truncated 9782 lines...]
make[5]: *** Waiting for unfinished jobs....
libtool: link: ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -g -O2 -std=c++11 -g -o tests/testEvent AccessLogEntry.o BodyPipe.o tests/stub_CacheDigest.o cache_cf.o CachePeer.o cache_manager.o tests/stub_carp.o cbdata.o client_db.o client_side.o client_side_reply.o client_side_request.o clientStream.o tests/stub_CollapsedForwarding.o ConfigOption.o ConfigParser.o CpuAffinityMap.o CpuAffinitySet.o debug.o fs_io.o dlink.o dns_internal.o errorpage.o tests/stub_ETag.o event.o EventLoop.o external_acl.o ExternalACLEntry.o FadingCounter.o tests/stub_fatal.o fd.o fde.o filemap.o fqdncache.o FwdState.o gopher.o helper.o htcp.o http.o HttpBody.o tests/stub_HttpControlMsg.o HttpHeader.o HttpHeaderTools.o HttpHdrCc.o HttpHdrContRange.o HttpHdrRange.o HttpHdrSc.o HttpHdrScTarget.o HttpMsg.o HttpReply.o PeerPoolMgr.o RequestFlags.o HttpRequest.o icp_v2.o icp_v3.o ipc.o ipcache.o int.o internal.o LogTags.o tests/stub_libsecurity.o MasterXaction.o tests/stub_libmem.o mem_node.o MemBuf.o MemObject.o mime.o mime_header.o multicast.o neighbors.o Notes.o Parsing.o pconn.o peer_digest.o peer_proxy_negotiate_auth.o peer_select.o peer_sourcehash.o peer_userhash.o Pipeline.o tests/stub_redirect.o refresh.o RemovalPolicy.o StrList.o tests/stub_SBufDetailedStats.o snmp_core.o snmp_agent.o SquidMath.o stat.o StatCounters.o StatHist.o stmem.o store.o store_client.o tests/stub_store_digest.o store_io.o store_key_md5.o store_log.o store_rebuild.o store_swapin.o store_swapmeta.o store_swapout.o StoreFileSystem.o StoreIOState.o tests/stub_StoreMeta.o StoreMetaUnpacker.o StoreSwapLogData.o String.o tests/stub_SwapDir.o tests/testEvent.o tests/stub_main_cc.o tests/stub_ipc_Forwarder.o tests/stub_libauth_acls.o tests/stub_libauth.o tests/stub_libdiskio.o tests/stub_libeui.o tests/stub_store_stats.o time.o tools.o Transients.o tests/stub_tunnel.o MemStore.o unlinkd.o url.o urn.o tests/stub_wccp2.o tests/stub_whois.o wordlist.o err_type.o err_detail_type.o globals.o hier_code.o icp_opcode.o lookup_t.o repl_modules.o swap_log_op.o  ./.libs/libsquid.a clients/.libs/libclients.a servers/.libs/libservers.a ftp/.libs/libftp.a helper/.libs/libhelper.a http/.libs/libhttp.a parser/.libs/libparser.a ident/.libs/libident.a acl/.libs/libacls.a acl/.libs/libstate.a acl/.libs/libapi.a dns/.libs/libdns.a base/.libs/libbase.a ip/.libs/libip.a fs/.libs/libfs.a anyp/.libs/libanyp.a icmp/.libs/libicmp.a comm/.libs/libcomm.a log/.libs/liblog.a format/.libs/libformat.a repl/liblru.a adaptation/.libs/libadaptation.a ../lib/.libs/libmisccontainers.a ../lib/.libs/libmiscencoding.a ../lib/.libs/libmiscutil.a ipc/.libs/libipc.a mgr/.libs/libmgr.a store/.libs/libstore.a sbuf/.libs/libsbuf.a snmp/.libs/libsnmp.a ../lib/snmplib/.libs/libsnmplib.a -lnettle -lcppunit ../compat/.libs/libcompatsquid.a -lm -lnsl -lresolv -lcap -lrt -ldl
libtool: link: ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -g -O2 -std=c++11 -g -o tests/testEventLoop AccessLogEntry.o BodyPipe.o tests/stub_CacheDigest.o cache_manager.o cache_cf.o CachePeer.o tests/stub_carp.o cbdata.o client_db.o client_side.o client_side_reply.o client_side_request.o clientStream.o tests/stub_CollapsedForwarding.o ConfigOption.o ConfigParser.o CpuAffinityMap.o CpuAffinitySet.o debug.o fs_io.o dlink.o dns_internal.o errorpage.o tests/stub_ETag.o EventLoop.o event.o external_acl.o ExternalACLEntry.o FadingCounter.o tests/stub_fatal.o fd.o fde.o filemap.o fqdncache.o FwdState.o gopher.o helper.o htcp.o http.o HttpBody.o tests/stub_HttpControlMsg.o HttpHeader.o HttpHeaderTools.o HttpHdrCc.o HttpHdrContRange.o HttpHdrRange.o HttpHdrSc.o HttpHdrScTarget.o HttpMsg.o HttpReply.o PeerPoolMgr.o RequestFlags.o HttpRequest.o icp_v2.o icp_v3.o ipc.o ipcache.o int.o internal.o LogTags.o MasterXaction.o MemBuf.o MemObject.o tests/stub_libmem.o mem_node.o mime.o mime_header.o multicast.o neighbors.o Notes.o Parsing.o pconn.o peer_digest.o peer_proxy_negotiate_auth.o peer_select.o peer_sourcehash.o peer_userhash.o Pipeline.o RemovalPolicy.o tests/stub_redirect.o refresh.o tests/stub_SBufDetailedStats.o snmp_core.o snmp_agent.o SquidMath.o stat.o StatCounters.o StatHist.o stmem.o store.o store_client.o tests/stub_store_digest.o store_io.o store_key_md5.o store_log.o store_rebuild.o store_swapin.o store_swapmeta.o store_swapout.o StoreFileSystem.o StoreIOState.o tests/stub_StoreMeta.o StoreMetaUnpacker.o StoreSwapLogData.o String.o StrList.o tests/stub_SwapDir.o tests/testEventLoop.o tests/stub_main_cc.o tests/stub_ipc_Forwarder.o tests/stub_libauth_acls.o tests/stub_libauth.o tests/stub_libdiskio.o tests/stub_libeui.o tests/stub_libsecurity.o tests/stub_store_stats.o time.o tools.o Transients.o tests/stub_tunnel.o MemStore.o unlinkd.o url.o urn.o tests/stub_wccp2.o tests/stub_whois.o wordlist.o err_type.o err_detail_type.o globals.o hier_code.o icp_opcode.o lookup_t.o repl_modules.o swap_log_op.o  ./.libs/libsquid.a clients/.libs/libclients.a servers/.libs/libservers.a ftp/.libs/libftp.a helper/.libs/libhelper.a http/.libs/libhttp.a parser/.libs/libparser.a ident/.libs/libident.a acl/.libs/libacls.a acl/.libs/libstate.a acl/.libs/libapi.a dns/.libs/libdns.a base/.libs/libbase.a ip/.libs/libip.a fs/.libs/libfs.a anyp/.libs/libanyp.a icmp/.libs/libicmp.a comm/.libs/libcomm.a log/.libs/liblog.a format/.libs/libformat.a repl/liblru.a adaptation/.libs/libadaptation.a ../lib/.libs/libmisccontainers.a ../lib/.libs/libmiscencoding.a ../lib/.libs/libmiscutil.a ipc/.libs/libipc.a mgr/.libs/libmgr.a sbuf/.libs/libsbuf.a store/.libs/libstore.a snmp/.libs/libsnmp.a ../lib/snmplib/.libs/libsnmplib.a -lnettle -lcppunit ../compat/.libs/libcompatsquid.a -lm -lnsl -lresolv -lcap -lrt -ldl
client_side.o: In function `ConnStateData::wroteControlMsgOK()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src/../../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
Makefile:6375: recipe for target 'tests/testEvent' failed
make[5]: *** [tests/testEvent] Error 1
client_side.o: In function `ConnStateData::wroteControlMsgOK()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src/../../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
Makefile:6381: recipe for target 'tests/testEventLoop' failed
make[5]: *** [tests/testEventLoop] Error 1
make[5]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src'>
Makefile:7446: recipe for target 'check-am' failed
make[4]: *** [check-am] Error 2
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src'>
Makefile:6932: recipe for target 'check-recursive' failed
make[3]: *** [check-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src'>
Makefile:7449: recipe for target 'check' failed
make[2]: *** [check] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src'>
Makefile:580: recipe for target 'check-recursive' failed
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub'>
Makefile:788: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -g -O2 -std=c++11
checking for egrep... ../../configure: line 7191: echo: write error: Broken pipe
checking for fgrep... ../../configure: line 8238: echo: write error: Broken pipe
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src/../../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testCacheManager] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src/../../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEvent] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/ws/btlayer-00-default/squid-5.0.0-BZR/_build/sub/src/../../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData120_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE120_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE120_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEventLoop] Error 1
make[4]: *** [check-am] Error 2
make[3]: *** [check-recursive] Error 1
make[2]: *** [check] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Tue Nov 15 10:55:45 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 10:55:45 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-ubuntu-trusty_=2310?=
Message-ID: <1099732287.7.1479207345142.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/10/------------------------------------------
[...truncated 10150 lines...]
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1   -g -O2 -std=c++11 -ldl -g -o tests/testEnumIterator tests/stub_debug.o tests/stub_libmem.o tests/testEnumIterator.o test_tools.o globals.o base/libbase.la -lcppunit   ../compat/libcompatsquid.la  -lm -lnsl -lresolv -lcap -lrt -ldl -ldl 
libtool: link: ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -g -o tests/testEnumIterator tests/stub_debug.o tests/stub_libmem.o tests/testEnumIterator.o test_tools.o globals.o  base/.libs/libbase.a -lcppunit ../compat/.libs/libcompatsquid.a -lm -lnsl -lresolv -lcap -lrt -ldl
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1   -g -O2 -std=c++11 -ldl -g -o tests/testEvent AccessLogEntry.o BodyPipe.o tests/stub_CacheDigest.o cache_cf.o CachePeer.o cache_manager.o tests/stub_carp.o cbdata.o client_db.o client_side.o client_side_reply.o client_side_request.o clientStream.o tests/stub_CollapsedForwarding.o ConfigOption.o ConfigParser.o CpuAffinityMap.o CpuAffinitySet.o debug.o  fs_io.o dlink.o dns_internal.o errorpage.o tests/stub_ETag.o event.o EventLoop.o external_acl.o ExternalACLEntry.o FadingCounter.o tests/stub_fatal.o fd.o fde.o filemap.o fqdncache.o FwdState.o gopher.o helper.o htcp.o http.o HttpBody.o tests/stub_HttpControlMsg.o HttpHeader.o HttpHeaderTools.o HttpHdrCc.o HttpHdrContRange.o HttpHdrRange.o HttpHdrSc.o HttpHdrScTarget.o HttpMsg.o HttpReply.o PeerPoolMgr.o RequestFlags.o HttpRequest.o icp_v2.o icp_v3.o ipc.o ipcache.o int.o internal.o LogTags.o tests/stub_libsecurity.o MasterXaction.o tests/stub_libmem.o mem_node.o MemBuf.o MemObject.o mime.o mime_header.o multicast.o neighbors.o Notes.o Parsing.o pconn.o peer_digest.o peer_proxy_negotiate_auth.o peer_select.o peer_sourcehash.o peer_userhash.o Pipeline.o tests/stub_redirect.o refresh.o RemovalPolicy.o StrList.o tests/stub_SBufDetailedStats.o snmp_core.o snmp_agent.o SquidMath.o stat.o StatCounters.o StatHist.o stmem.o store.o store_client.o tests/stub_store_digest.o store_io.o store_key_md5.o store_log.o store_rebuild.o store_swapin.o store_swapmeta.o store_swapout.o StoreFileSystem.o StoreIOState.o tests/stub_StoreMeta.o StoreMetaUnpacker.o StoreSwapLogData.o String.o tests/stub_SwapDir.o tests/testEvent.o tests/stub_main_cc.o tests/stub_ipc_Forwarder.o tests/stub_libauth_acls.o tests/stub_libauth.o tests/stub_libdiskio.o tests/stub_libeui.o tests/stub_store_stats.o time.o tools.o Transients.o tests/stub_tunnel.o MemStore.o unlinkd.o url.o urn.o tests/stub_wccp2.o tests/stub_whois.o  wordlist.o err_type.o err_detail_type.o globals.o hier_code.o icp_opcode.o lookup_t.o repl_modules.o swap_log_op.o libsquid.la clients/libclients.la servers/libservers.la ftp/libftp.la helper/libhelper.la http/libhttp.la parser/libparser.la ident/libident.la acl/libacls.la acl/libstate.la acl/libapi.la dns/libdns.la base/libbase.la ip/libip.la fs/libfs.la anyp/libanyp.la icmp/libicmp.la comm/libcomm.la log/liblog.la format/libformat.la repl/liblru.a adaptation/libadaptation.la   ../lib/libmisccontainers.la ../lib/libmiscencoding.la ../lib/libmiscutil.la ipc/libipc.la mgr/libmgr.la store/libstore.la sbuf/libsbuf.la snmp/libsnmp.la ../lib/snmplib/libsnmplib.la -lnettle  -lgnutls     -lcppunit   ../compat/libcompatsquid.la  -lm -lnsl -lresolv -lcap -lrt -ldl -ldl 
client_side.o: In function `ConnStateData::wroteControlMsgOK()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o: In function `HttpControlMsgSink::~HttpControlMsgSink()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o: In function `~HttpControlMsgSink':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testCacheManager] Error 1
make[5]: *** Waiting for unfinished jobs....
libtool: link: ccache g++ -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -std=c++11 -g -o tests/testEvent AccessLogEntry.o BodyPipe.o tests/stub_CacheDigest.o cache_cf.o CachePeer.o cache_manager.o tests/stub_carp.o cbdata.o client_db.o client_side.o client_side_reply.o client_side_request.o clientStream.o tests/stub_CollapsedForwarding.o ConfigOption.o ConfigParser.o CpuAffinityMap.o CpuAffinitySet.o debug.o fs_io.o dlink.o dns_internal.o errorpage.o tests/stub_ETag.o event.o EventLoop.o external_acl.o ExternalACLEntry.o FadingCounter.o tests/stub_fatal.o fd.o fde.o filemap.o fqdncache.o FwdState.o gopher.o helper.o htcp.o http.o HttpBody.o tests/stub_HttpControlMsg.o HttpHeader.o HttpHeaderTools.o HttpHdrCc.o HttpHdrContRange.o HttpHdrRange.o HttpHdrSc.o HttpHdrScTarget.o HttpMsg.o HttpReply.o PeerPoolMgr.o RequestFlags.o HttpRequest.o icp_v2.o icp_v3.o ipc.o ipcache.o int.o internal.o LogTags.o tests/stub_libsecurity.o MasterXaction.o tests/stub_libmem.o mem_node.o MemBuf.o MemObject.o mime.o mime_header.o multicast.o neighbors.o Notes.o Parsing.o pconn.o peer_digest.o peer_proxy_negotiate_auth.o peer_select.o peer_sourcehash.o peer_userhash.o Pipeline.o tests/stub_redirect.o refresh.o RemovalPolicy.o StrList.o tests/stub_SBufDetailedStats.o snmp_core.o snmp_agent.o SquidMath.o stat.o StatCounters.o StatHist.o stmem.o store.o store_client.o tests/stub_store_digest.o store_io.o store_key_md5.o store_log.o store_rebuild.o store_swapin.o store_swapmeta.o store_swapout.o StoreFileSystem.o StoreIOState.o tests/stub_StoreMeta.o StoreMetaUnpacker.o StoreSwapLogData.o String.o tests/stub_SwapDir.o tests/testEvent.o tests/stub_main_cc.o tests/stub_ipc_Forwarder.o tests/stub_libauth_acls.o tests/stub_libauth.o tests/stub_libdiskio.o tests/stub_libeui.o tests/stub_store_stats.o time.o tools.o Transients.o tests/stub_tunnel.o MemStore.o unlinkd.o url.o urn.o tests/stub_wccp2.o tests/stub_whois.o wordlist.o err_type.o err_detail_type.o globals.o hier_code.o icp_opcode.o lookup_t.o repl_modules.o swap_log_op.o  ./.libs/libsquid.a clients/.libs/libclients.a servers/.libs/libservers.a ftp/.libs/libftp.a helper/.libs/libhelper.a http/.libs/libhttp.a parser/.libs/libparser.a ident/.libs/libident.a acl/.libs/libacls.a acl/.libs/libstate.a acl/.libs/libapi.a dns/.libs/libdns.a base/.libs/libbase.a ip/.libs/libip.a fs/.libs/libfs.a anyp/.libs/libanyp.a icmp/.libs/libicmp.a comm/.libs/libcomm.a log/.libs/liblog.a format/.libs/libformat.a repl/liblru.a adaptation/.libs/libadaptation.a ../lib/.libs/libmisccontainers.a ../lib/.libs/libmiscencoding.a ../lib/.libs/libmiscutil.a ipc/.libs/libipc.a mgr/.libs/libmgr.a store/.libs/libstore.a sbuf/.libs/libsbuf.a snmp/.libs/libsnmp.a ../lib/snmplib/.libs/libsnmplib.a -lnettle -lgnutls -lcppunit ../compat/.libs/libcompatsquid.a -lm -lnsl -lresolv -lcap -lrt -ldl
client_side.o: In function `ConnStateData::wroteControlMsgOK()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o: In function `HttpControlMsgSink::~HttpControlMsgSink()':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o: In function `~HttpControlMsgSink':
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEvent] Error 1
make[5]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
make[4]: *** [check-am] Error 2
make[4]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
make[3]: *** [check-recursive] Error 1
make[3]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
make[2]: *** [check] Error 2
make[2]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src'>
make[1]: *** [check-recursive] Error 1
make[1]: Leaving directory `<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build'>
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-00-default.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -I/usr/include/p11-kit-1   -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -I/usr/include/p11-kit-1   -g -O2 -std=c++11
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -lm -lnsl -lresolv -lcap -lrt -ldl -ldl
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS: -I/usr/include/p11-kit-1   -g -O2 -std=c++11
configure: BUILD EXTRA C++ FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:  -I/usr/include/p11-kit-1   -g -O2 -std=c++11
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
# XFAIL: 0
# FAIL:  0
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testCacheManager] Error 1
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/client_side.cc>:3839: undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/ws/btlayer-00-default/squid-5.0.0-BZR/_build/src/../../src/HttpControlMsg.h>:28: undefined reference to `vtable for HttpControlMsgSink'
client_side.o:(.rodata._ZTI13ConnStateData[_ZTI13ConnStateData]+0x28): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
client_side.o:(.rodata._ZTC13ConnStateData112_18HttpControlMsgSink[_ZTV13ConnStateData]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(FtpServer.o):(.data.rel.ro._ZTCN3Ftp6ServerE112_18HttpControlMsgSink[_ZTVN3Ftp6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x10): undefined reference to `typeinfo for HttpControlMsgSink'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x20): undefined reference to `HttpControlMsgSink::wroteControlMsgOK()'
servers/.libs/libservers.a(Http1Server.o):(.data.rel.ro._ZTCN4Http3One6ServerE112_18HttpControlMsgSink[_ZTVN4Http3One6ServerE]+0x80): undefined reference to `typeinfo for HttpControlMsgSink'
collect2: error: ld returned 1 exit status
make[5]: *** [tests/testEvent] Error 1
make[4]: *** [check-am] Error 2
make[3]: *** [check-recursive] Error 1
make[2]: *** [check] Error 2
make[1]: *** [check-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From christos at chtsanti.net  Tue Nov 15 11:58:45 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Tue, 15 Nov 2016 13:58:45 +0200
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
Message-ID: <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>

Hi all,
  I applied the patch as r14945 with an r14946 fix.

Unfortunately while I was testing the Squid-3.5 variant of the patch I 
found a bug:
  When the Http::One::Server::writeControlMsgAndCall fails to write the 
control message, schedules a Comm::Write callback using just a 
ScheduleCallHere command.
The callback called without the CommIoCbParams details and squid is crashes.

There are two ways to fix this issue.
   1) complete the missing CommIoCbParams details inside 
writeControlMsgAndCall
   2) Make the ConnStateData::writeControlMsgAndCall to return false on 
failures and allow caller handle the failure.

This patch implements the (2) as I believe it is the better option.

My apologies for the buggy patch.


On 11/14/2016 08:03 PM, Christos Tsantilas wrote:
> The following sequence of events triggers this assertion:
>   - The server sends an 1xx control message.
>   - http.cc schedules ConnStateData::sendControlMsg call.
>   - Before sendControlMsg is fired, http.cc detects an error (e.g., I/O
> error or timeout) and starts writing the reply to the user.
>   - The ConnStateData::sendControlMsg is fired, starts writing 1xx, and
> hits the "no concurrent writes" assertion.
>
> We could only reproduce this sequence in the lab after changing Squid
> code to trigger a timeout at the right moment, but the sequence looks
> plausible. Other event sequences might result in the same outcome.
>
> To avoid concurrent writes, Squid now drops the control message if
> Http::One::Server detects that a reply is already being written. Also,
> ConnStateData delays reply writing until a pending control message write
> has been completed.
>
>
> There is strong possibility that the bug fixing this patch is a variant
> of the bug4174:
>   http://bugs.squid-cache.org/show_bug.cgi?id=4174
> However we are getting different backtrace.
>
>
> This is a Measurement Factory project.
>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Fix-r14945-assertion_failed_Write_cc_Not_ccb_active.patch
Type: text/x-patch
Size: 12186 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161115/fcfd5b31/attachment.bin>

From noc at squid-cache.org  Tue Nov 15 12:47:52 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 12:47:52 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2311?=
In-Reply-To: <1848329586.3.1479194799121.JavaMail.jenkins@buildmaster>
References: <1848329586.3.1479194799121.JavaMail.jenkins@buildmaster>
Message-ID: <822556589.8.1479214072980.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/11/------------------------------------------
[...truncated 34513 lines...]
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ServerBump.lo -MD -MP -MF .deps/ServerBump.Tpo -c ../../../../src/ssl/ServerBump.cc  -fPIC -DPIC -o ServerBump.o >/dev/null 2>&1
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSplice()':
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSpliceMatched(Ssl::BumpMode)':
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual bool Ssl::PeekingPeerConnector::initialize(Security::SessionPointer&)':
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::ClientBio *cltBio = static_cast<Ssl::ClientBio *>(bc->ptr);
                                                                      ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
                     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteWantWrite()':
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteNegotiationError(int, int, int)':
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'PeekingPeerConnector.lo' failed
make[4]: *** [PeekingPeerConnector.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetailManager.lo -MD -MP -MF .deps/ErrorDetailManager.Tpo -c ../../../../src/ssl/ErrorDetailManager.cc  -fPIC -DPIC -o ErrorDetailManager.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Tue Nov 15 13:55:03 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 13:55:03 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Jenkins_build_is_back_to_normal_=3A_5-matri?=
 =?utf-8?q?x_=C2=BB_gcc=2Cd-ubuntu-trusty_=2311?=
In-Reply-To: <1099732287.7.1479207345142.JavaMail.jenkins@buildmaster>
References: <1099732287.7.1479207345142.JavaMail.jenkins@buildmaster>
Message-ID: <1591642111.9.1479218103917.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-trusty/11/

From noc at squid-cache.org  Tue Nov 15 14:21:19 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 14:21:19 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Jenkins_build_is_back_to_normal_=3A_5-matri?=
 =?utf-8?q?x_=C2=BB_gcc=2Cd-centos-7_=2311?=
In-Reply-To: <697425923.4.1479204232103.JavaMail.jenkins@buildmaster>
References: <697425923.4.1479204232103.JavaMail.jenkins@buildmaster>
Message-ID: <744195246.10.1479219679498.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-centos-7/11/

From noc at squid-cache.org  Tue Nov 15 14:27:31 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 14:27:31 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Jenkins_build_is_back_to_normal_=3A_5-matri?=
 =?utf-8?q?x_=C2=BB_gcc=2Cd-ubuntu-wily_=2311?=
In-Reply-To: <1612711809.6.1479206585683.JavaMail.jenkins@buildmaster>
References: <1612711809.6.1479206585683.JavaMail.jenkins@buildmaster>
Message-ID: <2048109178.11.1479220051243.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-ubuntu-wily/11/

From noc at squid-cache.org  Tue Nov 15 14:36:19 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 15 Nov 2016 14:36:19 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Jenkins_build_is_back_to_normal_=3A_5-matri?=
 =?utf-8?q?x_=C2=BB_gcc=2Cd-fedora-21_=2311?=
In-Reply-To: <951178251.5.1479205830458.JavaMail.jenkins@buildmaster>
References: <951178251.5.1479205830458.JavaMail.jenkins@buildmaster>
Message-ID: <262708500.12.1479220579327.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-fedora-21/11/

From squid3 at treenet.co.nz  Wed Nov 16 12:35:05 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 17 Nov 2016 01:35:05 +1300
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
 <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
Message-ID: <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>

On 16/11/2016 12:58 a.m., Christos Tsantilas wrote:
> Hi all,
>  I applied the patch as r14945 with an r14946 fix.
> 
> Unfortunately while I was testing the Squid-3.5 variant of the patch I
> found a bug:
>  When the Http::One::Server::writeControlMsgAndCall fails to write the
> control message, schedules a Comm::Write callback using just a
> ScheduleCallHere command.
> The callback called without the CommIoCbParams details and squid is
> crashes.
> 
> There are two ways to fix this issue.
>   1) complete the missing CommIoCbParams details inside
> writeControlMsgAndCall
>   2) Make the ConnStateData::writeControlMsgAndCall to return false on
> failures and allow caller handle the failure.
> 
> This patch implements the (2) as I believe it is the better option.
> 
> My apologies for the buggy patch.
> 

Now that the method wroteControlMsgOK() is needing to be called in
not-OK situations I think it should have a different name.
 Perhapse doneWithControlMsg() ?

Amos


From christos at chtsanti.net  Wed Nov 16 13:50:50 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Wed, 16 Nov 2016 15:50:50 +0200
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
 <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
 <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
Message-ID: <5b41eacb-3b03-69aa-f596-4a8626e442fa@chtsanti.net>

On 11/16/2016 02:35 PM, Amos Jeffries wrote:
> On 16/11/2016 12:58 a.m., Christos Tsantilas wrote:
>> Hi all,
>>  I applied the patch as r14945 with an r14946 fix.
>>
>> Unfortunately while I was testing the Squid-3.5 variant of the patch I
>> found a bug:
>>  When the Http::One::Server::writeControlMsgAndCall fails to write the
>> control message, schedules a Comm::Write callback using just a
>> ScheduleCallHere command.
>> The callback called without the CommIoCbParams details and squid is
>> crashes.
>>
>> There are two ways to fix this issue.
>>   1) complete the missing CommIoCbParams details inside
>> writeControlMsgAndCall
>>   2) Make the ConnStateData::writeControlMsgAndCall to return false on
>> failures and allow caller handle the failure.
>>
>> This patch implements the (2) as I believe it is the better option.
>>
>> My apologies for the buggy patch.
>>
>
> Now that the method wroteControlMsgOK() is needing to be called in
> not-OK situations I think it should have a different name.
>  Perhapse doneWithControlMsg() ?

Yes you are right. I will use this name.


>
> Amos
>
>

From garryd at comnet.uz  Wed Nov 16 14:43:04 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Wed, 16 Nov 2016 19:43:04 +0500
Subject: [squid-dev] [PATCH] Fix for bug 3290
Message-ID: <1479307384.15118.17.camel@comnet.uz>

Dear developers,

Please review the attached patch for Squid-5 fixing the issue explained
in the bug report 3290 [1]. The issue is still reproducible using rev.
14947.

The problem exists because Squid resets expiration time for a user on
every successful authentication, regardless where the user was found in
the username cache or found by means of a helper. The patch instructs
Squid to reset expiration time only for users gotten from helper.

Thanks in advance!

[1]http://bugs.squid-cache.org/show_bug.cgi?id=3290


Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_bug3290.patch
Type: text/x-patch
Size: 1170 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161116/70b130a7/attachment.bin>

From christos at chtsanti.net  Wed Nov 16 14:43:14 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Wed, 16 Nov 2016 16:43:14 +0200
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
 <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
 <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
Message-ID: <68905499-03f7-d4ba-bd43-3caa2c5197f8@chtsanti.net>

If no objection I will apply this patch to trunk.



On 11/16/2016 02:35 PM, Amos Jeffries wrote:
> On 16/11/2016 12:58 a.m., Christos Tsantilas wrote:
>> Hi all,
>>  I applied the patch as r14945 with an r14946 fix.
>>
>> Unfortunately while I was testing the Squid-3.5 variant of the patch I
>> found a bug:
>>  When the Http::One::Server::writeControlMsgAndCall fails to write the
>> control message, schedules a Comm::Write callback using just a
>> ScheduleCallHere command.
>> The callback called without the CommIoCbParams details and squid is
>> crashes.
>>
>> There are two ways to fix this issue.
>>   1) complete the missing CommIoCbParams details inside
>> writeControlMsgAndCall
>>   2) Make the ConnStateData::writeControlMsgAndCall to return false on
>> failures and allow caller handle the failure.
>>
>> This patch implements the (2) as I believe it is the better option.
>>
>> My apologies for the buggy patch.
>>
>
> Now that the method wroteControlMsgOK() is needing to be called in
> not-OK situations I think it should have a different name.
>  Perhapse doneWithControlMsg() ?
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Fix-r14945-assertion_failed_Write_cc_Not_ccb_active-t2.patch
Type: text/x-patch
Size: 17426 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161116/5cf098e6/attachment-0001.bin>

From noc at squid-cache.org  Wed Nov 16 21:32:30 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Wed, 16 Nov 2016 21:32:30 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2313?=
In-Reply-To: <822556589.8.1479214072980.JavaMail.jenkins@buildmaster>
References: <822556589.8.1479214072980.JavaMail.jenkins@buildmaster>
Message-ID: <1169816874.0.1479331950571.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/13/------------------------------------------
[...truncated 34844 lines...]
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'X509* readSslX509CertificatesChain(const char*, stack_st_X509*)':
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
     Ssl::BIO_Pointer bio(BIO_new(BIO_s_file_internal()));
                                                      ^
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT helper.lo -MD -MP -MF .deps/helper.Tpo -c ../../../../src/ssl/helper.cc  -fPIC -DPIC -o helper.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Thu Nov 17 02:18:26 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 17 Nov 2016 15:18:26 +1300
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <68905499-03f7-d4ba-bd43-3caa2c5197f8@chtsanti.net>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
 <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
 <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
 <68905499-03f7-d4ba-bd43-3caa2c5197f8@chtsanti.net>
Message-ID: <1bead38a-63fa-bdef-702e-b48770c14ad4@treenet.co.nz>

On 17/11/2016 3:43 a.m., Christos Tsantilas wrote:
> If no objection I will apply this patch to trunk.
> 

+1

Amos



From christos at chtsanti.net  Thu Nov 17 10:47:31 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Thu, 17 Nov 2016 12:47:31 +0200
Subject: [squid-dev] [PATCH] Fixed Write.cc:41 "!ccb->active()" assertion
In-Reply-To: <68905499-03f7-d4ba-bd43-3caa2c5197f8@chtsanti.net>
References: <ae8e0590-d7c9-599b-e641-ffef8b18ba39@chtsanti.net>
 <dfbd1f17-bfb8-9a2c-5c3a-cff787fd86dc@chtsanti.net>
 <6ecba26a-e487-9ece-7005-571d5f135600@treenet.co.nz>
 <68905499-03f7-d4ba-bd43-3caa2c5197f8@chtsanti.net>
Message-ID: <6e746c16-b9fa-95d9-fbf3-c8c408044d7e@chtsanti.net>

I am also attaching the t4 patch for squid-3.5.
This is include all fixes.


On 11/16/2016 04:43 PM, Christos Tsantilas wrote:
> If no objection I will apply this patch to trunk.
>
>
>
> On 11/16/2016 02:35 PM, Amos Jeffries wrote:
>> On 16/11/2016 12:58 a.m., Christos Tsantilas wrote:
>>> Hi all,
>>>  I applied the patch as r14945 with an r14946 fix.
>>>
>>> Unfortunately while I was testing the Squid-3.5 variant of the patch I
>>> found a bug:
>>>  When the Http::One::Server::writeControlMsgAndCall fails to write the
>>> control message, schedules a Comm::Write callback using just a
>>> ScheduleCallHere command.
>>> The callback called without the CommIoCbParams details and squid is
>>> crashes.
>>>
>>> There are two ways to fix this issue.
>>>   1) complete the missing CommIoCbParams details inside
>>> writeControlMsgAndCall
>>>   2) Make the ConnStateData::writeControlMsgAndCall to return false on
>>> failures and allow caller handle the failure.
>>>
>>> This patch implements the (2) as I believe it is the better option.
>>>
>>> My apologies for the buggy patch.
>>>
>>
>> Now that the method wroteControlMsgOK() is needing to be called in
>> not-OK situations I think it should have a different name.
>>  Perhapse doneWithControlMsg() ?
>>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-238-assertion_failed_Write_cc_Not_ccb_active-squid3.5-t4.patch
Type: text/x-patch
Size: 16749 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161117/30b14dde/attachment-0001.bin>

From noc at squid-cache.org  Thu Nov 17 12:11:27 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Thu, 17 Nov 2016 12:11:27 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2314?=
In-Reply-To: <1169816874.0.1479331950571.JavaMail.jenkins@buildmaster>
References: <1169816874.0.1479331950571.JavaMail.jenkins@buildmaster>
Message-ID: <1547073230.1.1479384687103.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/14/------------------------------------------
[...truncated 34839 lines...]
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'X509* readSslX509CertificatesChain(const char*, stack_st_X509*)':
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
     Ssl::BIO_Pointer bio(BIO_new(BIO_s_file_internal()));
                                                      ^
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Fri Nov 18 07:17:27 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 18 Nov 2016 07:17:27 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2315?=
In-Reply-To: <1547073230.1.1479384687103.JavaMail.jenkins@buildmaster>
References: <1547073230.1.1479384687103.JavaMail.jenkins@buildmaster>
Message-ID: <1213474163.2.1479453447192.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/15/------------------------------------------
[...truncated 34941 lines...]
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'X509* readSslX509CertificatesChain(const char*, stack_st_X509*)':
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
     Ssl::BIO_Pointer bio(BIO_new(BIO_s_file_internal()));
                                                      ^
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:112:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:653:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/gadgets.cc:666:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1333:54: error: 'BIO_s_file_internal' was not declared in this scope
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Fri Nov 18 10:47:09 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 18 Nov 2016 10:47:09 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2316?=
In-Reply-To: <1213474163.2.1479453447192.JavaMail.jenkins@buildmaster>
References: <1213474163.2.1479453447192.JavaMail.jenkins@buildmaster>
Message-ID: <1566210419.3.1479466029651.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/16/------------------------------------------
[...truncated 34378 lines...]
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     delete static_cast<Ssl::Bio*>(table->ptr);
                                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     table->ptr = NULL;
          ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_write(BIO*, const char*, int)':
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_read(BIO*, char*, int)':
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
In file included from ../../../../src/sbuf/SBuf.h:15:0,
                 from ../../../../src/ssl/support.h:18,
                 from ../../../../src/ssl/bio.cc:12:
../../../../src/ssl/bio.cc: In function 'long int squid_bio_ctrl(BIO*, int, long int, void*)':
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         assert(!table->ptr);
                      ^
../../../../src/Debug.h:30:23: note: in definition of macro 'assert'
 #define assert(EX)  ((EX)?((void)0):xassert( # EX , __FILE__, __LINE__))
                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->ptr = bio;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->init = 1;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT context_storage.lo -MD -MP -MF .deps/context_storage.Tpo -c ../../../../src/ssl/context_storage.cc  -fPIC -DPIC -o context_storage.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetail.lo -MD -MP -MF .deps/ErrorDetail.Tpo -c ../../../../src/ssl/ErrorDetail.cc  -fPIC -DPIC -o ErrorDetail.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT cert_validate_message.lo -MD -MP -MF .deps/cert_validate_message.Tpo -c ../../../../src/ssl/cert_validate_message.cc  -fPIC -DPIC -o cert_validate_message.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From robertogonza at hotmail.com  Fri Nov 18 12:31:10 2016
From: robertogonza at hotmail.com (R. G.)
Date: Fri, 18 Nov 2016 12:31:10 +0000
Subject: [squid-dev] error dpkg --configure squid
Message-ID: <VI1PR09MB07513B1BCE78BAB1811E36F7C1B00@VI1PR09MB0751.eurprd09.prod.outlook.com>

When I execute the command error dpkg --configure squid I get the error:

Setting up squid (3.5.22-1) ...
Setcap worked! /usr/lib/squid/pinger is not suid!
insserv: warning: script 'K01tunelgre.sh' missing LSB tags and overrides
insserv: warning: script 'tunelgre.sh' missing LSB tags and overrides
dpkg: error processing package squid (--configure):
 subprocess installed post-installation script returned error exit status 102
Errors were encountered while processing:
 squid

-----------------------------------------------------------------------------------------------------------

strace: dpkg --configure squid

execve("/usr/bin/dpkg", ["dpkg", "--configure", "squid"], [/* 12 vars */]) = 0
brk(0)                                  = 0x19a7000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e08000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=32753, ...}) = 0
mmap(NULL, 32753, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f9454e00000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libselinux.so.1", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\20c\0\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0644, st_size=142728, ...}) = 0
mmap(NULL, 2246896, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f94549c5000
mprotect(0x7f94549e6000, 2097152, PROT_NONE) = 0
mmap(0x7f9454be6000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x21000) = 0x7f9454be6000
mmap(0x7f9454be8000, 6384, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f9454be8000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\34\2\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=1738176, ...}) = 0
mmap(NULL, 3844640, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f945461a000
mprotect(0x7f94547bb000, 2097152, PROT_NONE) = 0
mmap(0x7f94549bb000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1a1000) = 0x7f94549bb000
mmap(0x7f94549c1000, 14880, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f94549c1000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libpcre.so.3", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\20\27\0\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0644, st_size=448440, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454dff000
mmap(NULL, 2543976, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f94543ac000
mprotect(0x7f9454418000, 2097152, PROT_NONE) = 0
mmap(0x7f9454618000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6c000) = 0x7f9454618000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libdl.so.2", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\320\16\0\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0644, st_size=14664, ...}) = 0
mmap(NULL, 2109712, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f94541a8000
mprotect(0x7f94541ab000, 2093056, PROT_NONE) = 0
mmap(0x7f94543aa000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f94543aa000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libpthread.so.0", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\20o\0\0\0\0\0\0"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=137440, ...}) = 0
mmap(NULL, 2213008, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f9453f8b000
mprotect(0x7f9453fa3000, 2093056, PROT_NONE) = 0
mmap(0x7f94541a2000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x17000) = 0x7f94541a2000
mmap(0x7f94541a4000, 13456, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f94541a4000
close(3)                                = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454dfe000
mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454dfc000
arch_prctl(ARCH_SET_FS, 0x7f9454dfc800) = 0
mprotect(0x7f94549bb000, 16384, PROT_READ) = 0
mprotect(0x7f94541a2000, 4096, PROT_READ) = 0
mprotect(0x7f94543aa000, 4096, PROT_READ) = 0
mprotect(0x7f9454618000, 4096, PROT_READ) = 0
mprotect(0x7f9454be6000, 4096, PROT_READ) = 0
mprotect(0x641000, 4096, PROT_READ)     = 0
mprotect(0x7f9454e0a000, 4096, PROT_READ) = 0
munmap(0x7f9454e00000, 32753)           = 0
set_tid_address(0x7f9454dfcad0)         = 13030
set_robust_list(0x7f9454dfcae0, 24)     = 0
rt_sigaction(SIGRTMIN, {0x7f9453f919f0, [], SA_RESTORER|SA_SIGINFO, 0x7f9453f9a8d0}, NULL, 8) = 0
rt_sigaction(SIGRT_1, {0x7f9453f91a80, [], SA_RESTORER|SA_RESTART|SA_SIGINFO, 0x7f9453f9a8d0}, NULL, 8) = 0
rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0
getrlimit(RLIMIT_STACK, {rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY}) = 0
statfs("/sys/fs/selinux", 0x7ffc9df50d10) = -1 ENOENT (No such file or directory)
statfs("/selinux", 0x7ffc9df50d10)      = -1 ENOENT (No such file or directory)
brk(0)                                  = 0x19a7000
brk(0x19c8000)                          = 0x19c8000
open("/proc/filesystems", O_RDONLY)     = 3
fstat(3, {st_mode=S_IFREG|0444, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e07000
read(3, "nodev\tsysfs\nnodev\trootfs\nnodev\tr"..., 1024) = 304
read(3, "", 1024)                       = 0
close(3)                                = 0
munmap(0x7f9454e07000, 4096)            = 0
open("/usr/lib/locale/locale-archive", O_RDONLY|O_CLOEXEC) = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=1607712, ...}) = 0
mmap(NULL, 1607712, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f9454c73000
close(3)                                = 0
ioctl(1, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, {B38400 opost isig icanon echo ...}) = 0
umask(022)                              = 022
openat(AT_FDCWD, "/etc/dpkg/dpkg.cfg.d", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 3
getdents(3, /* 2 entries */, 32768)     = 48
getdents(3, /* 0 entries */, 32768)     = 0
close(3)                                = 0
open("/etc/dpkg/dpkg.cfg", O_RDONLY)    = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=446, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e07000
read(3, "# dpkg configuration file\n#\n# Th"..., 4096) = 446
read(3, "", 4096)                       = 0
close(3)                                = 0
munmap(0x7f9454e07000, 4096)            = 0
open("/root/.dpkg.cfg", O_RDONLY)       = -1 ENOENT (No such file or directory)
getuid()                                = 0
geteuid()                               = 0
access("/var/lib/dpkg", W_OK)           = 0
open("/var/lib/dpkg/lock", O_RDWR|O_CREAT|O_TRUNC, 0660) = 3
open("/usr/share/locale/locale.alias", O_RDONLY|O_CLOEXEC) = 4
fstat(4, {st_mode=S_IFREG|0644, st_size=2492, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e07000
read(4, "# Locale name alias data base.\n#"..., 4096) = 2492
read(4, "", 4096)                       = 0
close(4)                                = 0
munmap(0x7f9454e07000, 4096)            = 0
open("/usr/share/locale/en_US/LC_MESSAGES/dpkg.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/share/locale/en/LC_MESSAGES/dpkg.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
fcntl(3, F_GETFD)                       = 0
fcntl(3, F_SETFD, FD_CLOEXEC)           = 0
fcntl(3, F_SETLK, {type=F_WRLCK, whence=SEEK_SET, start=0, len=0}) = 0
open("/var/lib/dpkg/arch", O_RDONLY)    = -1 ENOENT (No such file or directory)
open("/var/lib/dpkg/status", O_RDONLY)  = 4
fstat(4, {st_mode=S_IFREG|0644, st_size=636383, ...}) = 0
mmap(NULL, 638976, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9453eef000
read(4, "Package: libquadmath0\nStatus: in"..., 636383) = 636383
brk(0x19ea000)                          = 0x19ea000
brk(0x1a0c000)                          = 0x1a0c000
brk(0x1a2e000)                          = 0x1a2e000
brk(0x1a4f000)                          = 0x1a4f000
brk(0x1a71000)                          = 0x1a71000
brk(0x1a92000)                          = 0x1a92000
brk(0x1ab4000)                          = 0x1ab4000
brk(0x1ad6000)                          = 0x1ad6000
brk(0x1af8000)                          = 0x1af8000
brk(0x1b1a000)                          = 0x1b1a000
brk(0x1b3c000)                          = 0x1b3c000
brk(0x1b5e000)                          = 0x1b5e000
brk(0x1b80000)                          = 0x1b80000
close(4)                                = 0
munmap(0x7f9453eef000, 638976)          = 0
openat(AT_FDCWD, "/var/lib/dpkg/updates/", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 4
brk(0x1ba6000)                          = 0x1ba6000
getdents(4, /* 2 entries */, 32768)     = 48
getdents(4, /* 0 entries */, 32768)     = 0
close(4)                                = 0
open("/var/lib/dpkg/updates/tmp.i", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 4
fcntl(4, F_GETFD)                       = 0
fcntl(4, F_SETFD, FD_CLOEXEC)           = 0
fstat(4, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e07000
write(4, "#padding\n#padding\n#padding\n#padd"..., 4096) = 4096
write(4, "padding\n#padding\n#padding\n#paddi"..., 512) = 512
lseek(4, 0, SEEK_SET)                   = 0
open("/var/lib/dpkg/triggers/File", O_RDONLY) = 5
fstat(5, {st_mode=S_IFREG|0644, st_size=1166, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e06000
read(5, "/usr/man man-db/noawait\n/usr/sha"..., 4096) = 1166
read(5, "", 4096)                       = 0
close(5)                                = 0
munmap(0x7f9454e06000, 4096)            = 0
open("/var/lib/dpkg/triggers/Lock", O_RDWR|O_CREAT|O_TRUNC, 0600) = 5
fcntl(5, F_GETFD)                       = 0
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
fcntl(5, F_SETLKW, {type=F_WRLCK, whence=SEEK_SET, start=0, len=0}) = 0
open("/var/lib/dpkg/triggers/Unincorp", O_RDONLY) = 6
fcntl(6, F_GETFD)                       = 0
fcntl(6, F_SETFD, FD_CLOEXEC)           = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
fcntl(5, F_SETLK, {type=F_UNLCK, whence=SEEK_SET, start=0, len=0}) = 0
stat("/usr/local/sbin/sh", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/sh", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/sh", 0x7ffc9df50c80)    = -1 ENOENT (No such file or directory)
stat("/usr/bin/sh", 0x7ffc9df50c80)     = -1 ENOENT (No such file or directory)
stat("/sbin/sh", 0x7ffc9df50c80)        = -1 ENOENT (No such file or directory)
stat("/bin/sh", {st_mode=S_IFREG|0755, st_size=125400, ...}) = 0
stat("/usr/local/sbin/rm", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/rm", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/rm", 0x7ffc9df50c80)    = -1 ENOENT (No such file or directory)
stat("/usr/bin/rm", 0x7ffc9df50c80)     = -1 ENOENT (No such file or directory)
stat("/sbin/rm", 0x7ffc9df50c80)        = -1 ENOENT (No such file or directory)
stat("/bin/rm", {st_mode=S_IFREG|0755, st_size=60072, ...}) = 0
stat("/usr/local/sbin/tar", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/tar", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/tar", 0x7ffc9df50c80)   = -1 ENOENT (No such file or directory)
stat("/usr/bin/tar", 0x7ffc9df50c80)    = -1 ENOENT (No such file or directory)
stat("/sbin/tar", 0x7ffc9df50c80)       = -1 ENOENT (No such file or directory)
stat("/bin/tar", {st_mode=S_IFREG|0755, st_size=358072, ...}) = 0
stat("/usr/local/sbin/find", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/find", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/find", 0x7ffc9df50c80)  = -1 ENOENT (No such file or directory)
stat("/usr/bin/find", {st_mode=S_IFREG|0755, st_size=233984, ...}) = 0
stat("/usr/local/sbin/dpkg-deb", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/dpkg-deb", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/dpkg-deb", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/bin/dpkg-deb", {st_mode=S_IFREG|0755, st_size=130256, ...}) = 0
stat("/usr/local/sbin/ldconfig", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/ldconfig", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/ldconfig", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/bin/ldconfig", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/sbin/ldconfig", {st_mode=S_IFREG|0755, st_size=387, ...}) = 0
stat("/usr/local/sbin/start-stop-daemon", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/local/bin/start-stop-daemon", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/sbin/start-stop-daemon", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/usr/bin/start-stop-daemon", 0x7ffc9df50c80) = -1 ENOENT (No such file or directory)
stat("/sbin/start-stop-daemon", {st_mode=S_IFREG|0755, st_size=32392, ...}) = 0
open("/var/lib/dpkg/info/format", O_RDONLY) = 7
fstat(7, {st_mode=S_IFREG|0644, st_size=2, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e06000
read(7, "1\n", 4096)                    = 2
close(7)                                = 0
munmap(0x7f9454e06000, 4096)            = 0
stat("/var/lib/dpkg/info/format-new", 0x7ffc9df50be0) = -1 ENOENT (No such file or directory)
open("/var/log/dpkg.log", O_WRONLY|O_CREAT|O_APPEND, 0666) = 7
fstat(7, {st_mode=S_IFREG|0644, st_size=87063, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e06000
fstat(7, {st_mode=S_IFREG|0644, st_size=87063, ...}) = 0
lseek(7, 87063, SEEK_SET)               = 87063
fcntl(7, F_GETFD)                       = 0
fcntl(7, F_SETFD, FD_CLOEXEC)           = 0
open("/etc/localtime", O_RDONLY|O_CLOEXEC) = 8
fstat(8, {st_mode=S_IFREG|0644, st_size=235, ...}) = 0
fstat(8, {st_mode=S_IFREG|0644, st_size=235, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e05000
read(8, "TZif2\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0\3\0\0\0\0"..., 4096) = 235
lseek(8, -139, SEEK_CUR)                = 96
read(8, "TZif2\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\4\0\0\0\4\0\0\0\0"..., 4096) = 139
close(8)                                = 0
munmap(0x7f9454e05000, 4096)            = 0
write(7, "2016-11-16 15:25:29 startup pack"..., 47) = 47
open("/var/lib/dpkg/diversions", O_RDONLY) = 8
fcntl(8, F_GETFD)                       = 0
fcntl(8, F_SETFD, FD_CLOEXEC)           = 0
fstat(8, {st_mode=S_IFREG|0644, st_size=522, ...}) = 0
fstat(8, {st_mode=S_IFREG|0644, st_size=522, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e05000
read(8, "/usr/share/dict/words\n/usr/share"..., 4096) = 522
read(8, "", 4096)                       = 0
write(1, "Setting up squid (3.5.22-1) ...\n", 32Setting up squid (3.5.22-1) ...
) = 32
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=235, ...}) = 0
write(7, "2016-11-16 15:25:29 configure sq"..., 58) = 58
open("/var/lib/dpkg/info/squid.triggers", O_RDONLY) = -1 ENOENT (No such file or directory)
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=235, ...}) = 0
write(7, "2016-11-16 15:25:29 status half-"..., 64) = 64
write(4, "Package: squid\nStatus: install o"..., 1540) = 1540
ftruncate(4, 1540)                      = 0
fsync(4)                                = 0
close(4)                                = 0
munmap(0x7f9454e07000, 4096)            = 0
rename("/var/lib/dpkg/updates/tmp.i", "/var/lib/dpkg/updates/0000") = 0
openat(AT_FDCWD, "/var/lib/dpkg/updates/", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 4
fsync(4)                                = 0
close(4)                                = 0
open("/var/lib/dpkg/updates/tmp.i", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 4
fcntl(4, F_GETFD)                       = 0
fcntl(4, F_SETFD, FD_CLOEXEC)           = 0
fstat(4, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9454e07000
write(4, "#padding\n#padding\n#padding\n#padd"..., 4096) = 4096
write(4, "padding\n#padding\n#padding\n#paddi"..., 512) = 512
lseek(4, 0, SEEK_SET)                   = 0
stat("/var/lib/dpkg/info/squid.postinst", {st_mode=S_IFREG|0755, st_size=2642, ...}) = 0
clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f9454dfcad0) = 13031
rt_sigaction(SIGQUIT, {SIG_IGN, [], SA_RESTORER, 0x7f945464f0e0}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGINT, {SIG_IGN, [], SA_RESTORER, 0x7f945464f0e0}, {SIG_DFL, [], 0}, 8) = 0
wait4(13031, Setcap worked! /usr/lib/squid/pinger is not suid!
insserv: warning: script 'K01tunelgre.sh' missing LSB tags and overrides
insserv: warning: script 'tunelgre.sh' missing LSB tags and overrides
[{WIFEXITED(s) && WEXITSTATUS(s) == 102}], 0, NULL) = 13031
--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=13031, si_uid=0, si_status=102, si_utime=0, si_stime=0} ---
write(2, "dpkg: error processing package s"..., 130dpkg: error processing package squid (--configure):
 subprocess installed post-installation script returned error exit status 102
) = 130
rt_sigaction(SIGQUIT, {SIG_DFL, [], SA_RESTORER, 0x7f945464f0e0}, NULL, 8) = 0
rt_sigaction(SIGINT, {SIG_DFL, [], SA_RESTORER, 0x7f945464f0e0}, NULL, 8) = 0
open("/var/lib/dpkg/diversions", O_RDONLY) = 9
fcntl(9, F_GETFD)                       = 0
fcntl(9, F_SETFD, FD_CLOEXEC)           = 0
fstat(9, {st_mode=S_IFREG|0644, st_size=522, ...}) = 0
close(9)                                = 0
fcntl(5, F_GETFD)                       = 0x1 (flags FD_CLOEXEC)
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
fcntl(5, F_SETLKW, {type=F_WRLCK, whence=SEEK_SET, start=0, len=0}) = 0
close(6)                                = 0
open("/var/lib/dpkg/triggers/Unincorp", O_RDONLY) = 6
fcntl(6, F_GETFD)                       = 0
fcntl(6, F_SETFD, FD_CLOEXEC)           = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
fcntl(5, F_SETLK, {type=F_UNLCK, whence=SEEK_SET, start=0, len=0}) = 0
open("/var/lib/dpkg/status-new", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 9
fchmod(9, 0644)                         = 0
write(9, "Package: libquadmath0\nStatus: in"..., 8192) = 8192
write(9, ".dfsg-9+deb8u8\nReplaces: dnsutil"..., 8192) = 8192
write(9, "pports\n building static librarie"..., 8192) = 8192
write(9, "3-8\nReplaces: libreadline-common"..., 8192) = 8192
write(9, "epends: multiarch-support\nBreaks"..., 8192) = 8192
write(9, "ian Samba Maintainers <pkg-samba"..., 8192) = 8192
write(9, "n Internet domain\n name server. "..., 8192) = 8192
write(9, ": utils\nInstalled-Size: 69\nMaint"..., 8192) = 8192
write(9, "nctions, time2str() and\n str2tim"..., 8192) = 8192
write(9, "inimal (= 3.4.2-1), libexpat1 (>"..., 8192) = 8192
write(9, "ds: python3 (<< 3.5), python3 (>"..., 8192) = 8192
write(9, ": optional\nSection: devel\nInstal"..., 8192) = 8192
write(9, "hitecture: all\nSource: ispell\nVe"..., 8192) = 8192
write(9, "trary ways by using a\n printf-st"..., 8192) = 8192
write(9, "arily by the installation script"..., 8192) = 8192
write(9, "++.\n .\n This package contains th"..., 8192) = 8192
write(9, "ests: isoquery\nDescription: ISO "..., 8192) = 8192
write(9, "tion\n TimeDate is a collection o"..., 8192) = 8192
write(9, "http://www.cl.cam.ac.uk/~mgk25/j"..., 8192) = 8192
write(9, "ide URL transfer library (OpenSS"..., 8192) = 8192
write(9, "MD2, MD4, MD5, Panama Hash, DES,"..., 8192) = 8192
write(9, "e\n\nPackage: bsd-mailx\nStatus: in"..., 8192) = 8192
write(9, "it-core | upstart\nDescription: S"..., 8192) = 8192
write(9, "rind-based detector of data race"..., 8192) = 8192
write(9, "ins the shared library.\nHomepage"..., 8192) = 8192
write(9, "trusted by all the entities on\n "..., 8192) = 8192
write(9, " The\n xkeyboard-config project h"..., 8192) = 8192
write(9, "ent facility and is compliant\n w"..., 8192) = 8192
write(9, "\nSuggests: nfs-common (>= 1:1.1."..., 8192) = 8192
write(9, "er that interprets GPS,\n DCF-77,"..., 8192) = 8192
write(9, " binary. slocate\n    does this a"..., 8192) = 8192
write(9, "ese tools\n operate on any files "..., 8192) = 8192
write(9, "< 6.00)\nDepends: perl, libhttp-d"..., 8192) = 8192
write(9, "deb8u8), libk5crypto3 (>= 1.6.df"..., 8192) = 8192
write(9, "leased packages\n  - manpage-aler"..., 8192) = 8192
write(9, "talled-Size: 16406\nMaintainer: D"..., 8192) = 8192
write(9, "main (BIND) implements an Intern"..., 8192) = 8192
write(9, "illegal ones (MIM == 1999).\n .\n "..., 8192) = 8192
write(9, ")\nConffiles:\n /etc/rmt 3c58b7cd1"..., 8192) = 8192
write(9, "mu that does not depend\n on libX"..., 8192) = 8192
write(9, "ps://github.com/kiorky/SOAPpy.gi"..., 8192) = 8192
write(9, "t, like exim or sendmail; howeve"..., 8192) = 8192
write(9, "ts on Microsoft backends\n .\n Thi"..., 8192) = 8192
write(9, "oftware/libgpg-error/\n\nPackage: "..., 8192) = 8192
write(9, "cessibility toolkit\n ATK is a to"..., 8192) = 8192
write(9, "e Force <debian-x at lists.debian.o"..., 8192) = 8192
write(9, "iption: Apply a diff file to an "..., 8192) = 8192
write(9, "lete for most\n purposes.\nHomepag"..., 8192) = 8192
write(9, "-Size: 3253\nMaintainer: GNU Libc"..., 8192) = 8192
write(9, " (<< 215-1)\nConffiles:\n /etc/ini"..., 8192) = 8192
write(9, "rub-emu, xorriso (>= 0.5.6.pl00)"..., 8192) = 8192
write(9, "h.debian.org>\nArchitecture: amd6"..., 8192) = 8192
write(9, "rithmetic.  It also allows you t"..., 8192) = 8192
write(9, "nds: multiarch-support\nDescripti"..., 8192) = 8192
write(9, "a15e6\n /etc/systemd/timesyncd.co"..., 8192) = 8192
write(9, "2-10), libatomic1 (>= 4.9.2-10),"..., 8192) = 8192
write(9, "Section: perl\nInstalled-Size: 79"..., 8192) = 8192
write(9, "instance. A form consists of a s"..., 8192) = 8192
write(9, ", openjdk-6-jdk (<< 6b24-1.11-0u"..., 8192) = 8192
write(9, "s package contains various utili"..., 8192) = 8192
write(9, "e classes, internal to the libra"..., 8192) = 8192
write(9, "libc6 (>= 2.3), libgmp10, libmpf"..., 8192) = 8192
write(9, "mpiler\n and various libraries to"..., 8192) = 8192
write(9, "\n libcomerr is an attempt to pre"..., 8192) = 8192
write(9, "dict\n This package provides the "..., 8192) = 8192
write(9, "cvs20060405-1)\nConffiles:\n /etc/"..., 8192) = 8192
write(9, "2-1), mime-support, libbz2-1.0, "..., 8192) = 8192
write(9, "on: perl\nInstalled-Size: 166\nMai"..., 8192) = 8192
write(9, ": http://cwidget.alioth.debian.o"..., 8192) = 8192
write(9, "on: 2.19-18+deb8u6\nProvides: lib"..., 8192) = 8192
write(9, "roup <pkg-perl-maintainers at lists"..., 8192) = 8192
write(9, " files. Currently handled are:\n "..., 8192) = 8192
write(9, ".\n libsepol provides an API for "..., 8192) = 8192
write(9, "-gssapi, rsyslog-relp\nConflicts:"..., 8192) = 8192
write(9, "r: Vaclav Ovsik <vaclav.ovsik at i."..., 8192) = 8192
write(9, "and discover services and hosts\n"..., 8192) = 8192
write(9, "y submit to the Debian developer"..., 8192) = 8192
write(9, "ze: 1809\nMaintainer: Sebastian D"..., 5599) = 5599
fsync(9)                                = 0
close(9)                                = 0
unlink("/var/lib/dpkg/status-old")      = 0
link("/var/lib/dpkg/status", "/var/lib/dpkg/status-old") = 0
rename("/var/lib/dpkg/status-new", "/var/lib/dpkg/status") = 0
openat(AT_FDCWD, "/var/lib/dpkg", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 9
fsync(9)                                = 0
close(9)                                = 0
unlink("/var/lib/dpkg/updates/0000")    = 0
openat(AT_FDCWD, "/var/lib/dpkg/updates/", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 9
fsync(9)                                = 0
close(9)                                = 0
close(4)                                = 0
munmap(0x7f9454e07000, 4096)            = 0
unlink("/var/lib/dpkg/updates/tmp.i")   = 0
fcntl(3, F_SETLK, {type=F_UNLCK, whence=SEEK_SET, start=0, len=0}) = 0
write(2, "Errors were encountered while pr"..., 42Errors were encountered while processing:
) = 42
write(2, " squid\n", 7 squid
)                 = 7
exit_group(1)                           = ?
+++ exited with 1 +++


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161118/34c3651c/attachment-0001.html>

From noc at squid-cache.org  Fri Nov 18 17:28:52 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 18 Nov 2016 17:28:52 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=234?=
In-Reply-To: <1692277011.66.1478867945856.JavaMail.jenkins@buildmaster>
References: <1692277011.66.1478867945856.JavaMail.jenkins@buildmaster>
Message-ID: <1683317196.4.1479490132624.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/4/------------------------------------------
[...truncated 32111 lines...]
/bin/bash ../libtool  --tag=CC   --mode=compile ccache gcc -DHAVE_CONFIG_H   -I../../.. -I../../../include -I../../../lib -I../../../src -I../include    -I/usr/include/libxml2  -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF $depbase.Tpo -c -o xusleep.lo ../../../lib/xusleep.c &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o .libs/Splay.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o .libs/stub_memaccount.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o .libs/util.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o .libs/xusleep.o
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT util.lo -MD -MP -MF .deps/util.Tpo -c ../../../lib/util.c  -fPIC -DPIC -o util.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CC   --mode=link ccache gcc -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2  -g -o libmiscencoding.la  base64.lo charset.lo html_quote.lo md5.lo rfc1738.lo rfc2617.lo uudecode.lo  
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT stub_memaccount.lo -MD -MP -MF .deps/stub_memaccount.Tpo -c ../../../lib/stub_memaccount.c  -fPIC -DPIC -o stub_memaccount.o >/dev/null 2>&1
libtool: link: /usr/bin/ar cru .libs/libmiscencoding.a .libs/base64.o .libs/charset.o .libs/html_quote.o .libs/md5.o .libs/rfc1738.o .libs/rfc2617.o .libs/uudecode.o 
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmisccontainers.la  hash.lo  
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscencoding.a
libtool: link: ( cd ".libs" && rm -f "libmiscencoding.la" && ln -s "../libmiscencoding.la" "libmiscencoding.la" )
libtool: compile:  ccache gcc -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT -Wall -g -O2 -MT xusleep.lo -MD -MP -MF .deps/xusleep.Tpo -c ../../../lib/xusleep.c  -fPIC -DPIC -o xusleep.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../.. -I../../../include -I../../../lib -I../../../src -I../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Splay.lo -MD -MP -MF .deps/Splay.Tpo -c ../../../lib/Splay.cc  -fPIC -DPIC -o Splay.o >/dev/null 2>&1
/bin/bash ../libtool  --tag=CXX   --mode=link ccache g++ -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2  -g -o libmiscutil.la  getfullhostname.lo heap.lo iso3307.lo radix.lo rfc1123.lo Splay.lo stub_memaccount.lo util.lo xusleep.lo  
libtool: link: /usr/bin/ar cru .libs/libmisccontainers.a .libs/hash.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmisccontainers.a
libtool: link: ( cd ".libs" && rm -f "libmisccontainers.la" && ln -s "../libmisccontainers.la" "libmisccontainers.la" )
libtool: link: /usr/bin/ar cru .libs/libmiscutil.a .libs/getfullhostname.o .libs/heap.o .libs/iso3307.o .libs/radix.o .libs/rfc1123.o .libs/Splay.o .libs/stub_memaccount.o .libs/util.o .libs/xusleep.o 
/usr/bin/ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libmiscutil.a
libtool: link: ( cd ".libs" && rm -f "libmiscutil.la" && ln -s "../libmiscutil.la" "libmiscutil.la" )
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/lib'>
Making all in libltdl
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make  all-am
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
  CC       libltdlc_la-lt_dlloader.lo
  CC       libltdlc_la-lt__alloc.lo
  CC       libltdlc_la-lt_error.lo
  CC       libltdlc_la-ltdl.lo
  CC       libltdlc_la-slist.lo
  CC       lt__strl.lo
  CC       loaders/dlopen.lo
  CC       loaders/libltdlc_la-preopen.lo
  CCLD     dlopen.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     libltdlc.la
ar: `u' modifier ignored since `D' is the default (see `U')
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/libltdl'>
Making all in scripts
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/scripts'>
Making all in icons
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/icons'>
Making all in errors
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
case "" in \
off) \
    echo "WARNING: Translation is disabled."; \
    ;; \
""|no) \
    echo "WARNING: Translation toolkit was not detected."; \
    ;; \
esac; \
touch translate-warn
WARNING: Translation toolkit was not detected.
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/errors'>
Making all in doc
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in manuals
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/manuals'>
Making all in release-notes
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc/release-notes'>
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/doc'>
Making all in src
make[2]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
mawk -f ../../../src/cf_gen_defines <../../../src/cf.data.pre >cf_gen_defines.cci || (/bin/rm -f -f cf_gen_defines.cci && exit 1)
sed \
-e "s%[@]DEFAULT_HTTP_PORT[@]%3128%g" \
-e "s%[@]DEFAULT_ICP_PORT[@]%3130%g" \
-e "s%[@]DEFAULT_CACHE_EFFECTIVE_USER[@]%nobody%g" \
-e "s%[@]DEFAULT_MIME_TABLE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc/mime.conf%g"> \
-e "s%[@]DEFAULT_SSL_CRTD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> security_file_certgen | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_UNLINKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> unlinkd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_PINGER[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> pinger | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_DISKD[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> diskd | sed 's,x,x,;s/$//'`%g" \
-e "s%[@]DEFAULT_LOGFILED[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/libexec/`echo> log_file_daemon | sed 's,x,x,;s/$//'`%g;" \
-e "s%[@]DEFAULT_CACHE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/cache.log%g"> \
-e "s%[@]DEFAULT_ACCESS_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/access.log%g"> \
-e "s%[@]DEFAULT_STORE_LOG[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/logs/store.log%g"> \
-e "s%[@]DEFAULT_PID_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/run/@SERVICE_NAME at .pid%g"> \
-e "s%[@]DEFAULT_NETDB_FILE[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/netdb.state%g"> \
-e "s%[@]DEFAULT_SWAP_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid%g"> \
-e "s%[@]DEFAULT_SSL_DB_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/var/cache/squid/ssl_db%g"> \
-e "s%[@]DEFAULT_ICON_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/icons%g"> \
-e "s%[@]DEFAULT_CONFIG_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/etc%g"> \
-e "s%[@]DEFAULT_ERROR_DIR[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst/share/errors%g"> \
-e "s%[@]DEFAULT_PREFIX[@]%<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_inst%g"> \
-e "s%[@]DEFAULT_HOSTS[@]%/etc/hosts%g" \
-e "s%[@]SQUID[@]%SQUID\ 4.0.16-BZR%g" \
-f ../../../src/cf.data.sed \
< ../../../src/cf.data.pre >cf.data
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_type.h > err_type.cc || (/bin/rm -f -f err_type.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/err_detail_type.h | sed 's/ERR_DETAIL_//' > err_detail_type.cc || (/bin/rm -f -f err_detail_type.cc && exit 1)
mawk -f ../../../src/mk-globals-c.awk < ../../../src/globals.h > globals.cc || (/bin/rm -f -f globals.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/hier_code.h > hier_code.cc || (/bin/rm -f -f hier_code.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/icp_opcode.h > icp_opcode.cc || (/bin/rm -f -f icp_opcode.cc && exit 1)
mawk -f ../../../src/mk-string-arrays.awk < ../../../src/lookup_t.h > lookup_t.cc || (/bin/rm -f -f lookup_t.cc && exit 1)
/bin/bash ../../../src/repl_modules.sh heap lru > repl_modules.cc
ccache g++ -I/usr/include/p11-kit-1 -g -O2 -o cf_gen ../../../src/cf_gen.cc -I../../../src -I../include/ -I../src
./cf_gen cf.data ../../../src/cf.data.depend
make  all-recursive
make[3]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Making all in mem
make[4]: Entering directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
depbase=`echo AllocatorProxy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF $depbase.Tpo -c -o AllocatorProxy.lo ../../../../src/mem/AllocatorProxy.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo old_api.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF $depbase.Tpo -c -o old_api.lo ../../../../src/mem/old_api.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo Pool.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF $depbase.Tpo -c -o Pool.lo ../../../../src/mem/Pool.cc &&\
mv -f $depbase.Tpo $depbase.Plo
depbase=`echo PoolChunked.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF $depbase.Tpo -c -o PoolChunked.lo ../../../../src/mem/PoolChunked.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o .libs/AllocatorProxy.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT old_api.lo -MD -MP -MF .deps/old_api.Tpo -c ../../../../src/mem/old_api.cc  -fPIC -DPIC -o .libs/old_api.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o .libs/PoolChunked.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o .libs/Pool.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolChunked.lo -MD -MP -MF .deps/PoolChunked.Tpo -c ../../../../src/mem/PoolChunked.cc  -fPIC -DPIC -o PoolChunked.o >/dev/null 2>&1
depbase=`echo PoolMalloc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
/bin/bash ../../libtool  --tag=CXX   --mode=compile ccache g++ -DHAVE_CONFIG_H   -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include    -I/usr/include/libxml2  -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF $depbase.Tpo -c -o PoolMalloc.lo ../../../../src/mem/PoolMalloc.cc &&\
mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o .libs/PoolMalloc.o
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT AllocatorProxy.lo -MD -MP -MF .deps/AllocatorProxy.Tpo -c ../../../../src/mem/AllocatorProxy.cc  -fPIC -DPIC -o AllocatorProxy.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT Pool.lo -MD -MP -MF .deps/Pool.Tpo -c ../../../../src/mem/Pool.cc  -fPIC -DPIC -o Pool.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PoolMalloc.lo -MD -MP -MF .deps/PoolMalloc.Tpo -c ../../../../src/mem/PoolMalloc.cc  -fPIC -DPIC -o PoolMalloc.o >/dev/null 2>&1
In file included from ../../../../src/security/forward.h:13:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                   ^~~~~~~~~~~~~~~~~~~
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
 typedef LockingPointer<SSL_CTX, SSL_CTX_free_cpp, CRYPTO_LOCK_SSL_CTX> ContextPointer;
                                                                      ^
In file included from ../../../../src/security/forward.h:14:0,
                 from ../../../../src/SquidConfig.h:21,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                     ^~~~~~~~~~~~~~~
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
 typedef LockingPointer<SSL, Security::SSL_free_cpp, CRYPTO_LOCK_SSL> SessionPointer;
                                                                    ^
In file included from ../../../../src/SquidConfig.h:21:0,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                       ^~~~~~~~~~~~~~~~
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
 typedef Security::LockingPointer<X509, X509_free_cpp, CRYPTO_LOCK_X509> CertPointer;
                                                                       ^
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                     ^~~~~~~~~~~~~~~~~~~~
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
 typedef LockingPointer<X509_CRL, X509_CRL_free_cpp, CRYPTO_LOCK_X509_CRL> CrlPointer;
                                                                         ^
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                   ^~~~~~~~~~~~~~
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
 typedef Security::LockingPointer<DH, DH_free_cpp, CRYPTO_LOCK_DH> DhePointer;
                                                                 ^
In file included from ../../../../src/ssl/support.h:20:0,
                 from ../../../../src/SquidConfig.h:24,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                               ^~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
 typedef Security::LockingPointer<EVP_PKEY, EVP_PKEY_free_cpp, CRYPTO_LOCK_EVP_PKEY> EVP_PKEY_Pointer;
                                                                                   ^
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:817: recipe for target 'old_api.lo' failed
make[4]: *** [old_api.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/mem'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/security/Context.h:29:51: error: 'CRYPTO_LOCK_SSL_CTX' was not declared in this scope
../../../../src/security/Context.h:29:70: error: template argument 3 is invalid
../../../../src/security/Session.h:33:53: error: 'CRYPTO_LOCK_SSL' was not declared in this scope
../../../../src/security/Session.h:33:68: error: template argument 3 is invalid
../../../../src/security/forward.h:53:55: error: 'CRYPTO_LOCK_X509' was not declared in this scope
../../../../src/security/forward.h:53:71: error: template argument 3 is invalid
../../../../src/security/forward.h:63:53: error: 'CRYPTO_LOCK_X509_CRL' was not declared in this scope
../../../../src/security/forward.h:63:73: error: template argument 3 is invalid
../../../../src/security/forward.h:77:51: error: 'CRYPTO_LOCK_DH' was not declared in this scope
../../../../src/security/forward.h:77:65: error: template argument 3 is invalid
../../../../src/ssl/gadgets.h:49:63: error: 'CRYPTO_LOCK_EVP_PKEY' was not declared in this scope
../../../../src/ssl/gadgets.h:49:83: error: template argument 3 is invalid
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [old_api.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Fri Nov 18 19:06:15 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 19 Nov 2016 08:06:15 +1300
Subject: [squid-dev] error dpkg --configure squid
In-Reply-To: <VI1PR09MB07513B1BCE78BAB1811E36F7C1B00@VI1PR09MB0751.eurprd09.prod.outlook.com>
References: <VI1PR09MB07513B1BCE78BAB1811E36F7C1B00@VI1PR09MB0751.eurprd09.prod.outlook.com>
Message-ID: <18b9b868-1852-4a13-70e4-c6f981263c50@treenet.co.nz>

On 19/11/2016 1:31 a.m., R. G. wrote:
> When I execute the command error dpkg --configure squid I get the error:
> 
> Setting up squid (3.5.22-1) ...
> Setcap worked! /usr/lib/squid/pinger is not suid!
> insserv: warning: script 'K01tunelgre.sh' missing LSB tags and overrides
> insserv: warning: script 'tunelgre.sh' missing LSB tags and overrides
> dpkg: error processing package squid (--configure):
>  subprocess installed post-installation script returned error exit status 102
> Errors were encountered while processing:
>  squid
> 

It looks like you have some custom init script which are preventing
insserv scheduling the Squid one properly.

dpkg errors are a Debian issue not Squid. Please contact your OS vendor
about this.

PS. You should use the dpkg --debug=help feature to find out what is
actually going on.

Amos


From noc at squid-cache.org  Fri Nov 18 19:27:10 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Fri, 18 Nov 2016 19:27:10 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2317?=
In-Reply-To: <1566210419.3.1479466029651.JavaMail.jenkins@buildmaster>
References: <1566210419.3.1479466029651.JavaMail.jenkins@buildmaster>
Message-ID: <913010153.5.1479497230169.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/17/------------------------------------------
[...truncated 34512 lines...]
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSplice()':
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSpliceMatched(Ssl::BumpMode)':
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual bool Ssl::PeekingPeerConnector::initialize(Security::SessionPointer&)':
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::ClientBio *cltBio = static_cast<Ssl::ClientBio *>(bc->ptr);
                                                                      ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
                     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteWantWrite()':
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteNegotiationError(int, int, int)':
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'PeekingPeerConnector.lo' failed
make[4]: *** [PeekingPeerConnector.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ServerBump.lo -MD -MP -MF .deps/ServerBump.Tpo -c ../../../../src/ssl/ServerBump.cc  -fPIC -DPIC -o ServerBump.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetailManager.lo -MD -MP -MF .deps/ErrorDetailManager.Tpo -c ../../../../src/ssl/ErrorDetailManager.cc  -fPIC -DPIC -o ErrorDetailManager.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From eduard.bagdasaryan at measurement-factory.com  Fri Nov 18 23:56:59 2016
From: eduard.bagdasaryan at measurement-factory.com (Eduard Bagdasaryan)
Date: Sat, 19 Nov 2016 02:56:59 +0300
Subject: [squid-dev] [PATCH] auth_schemes directive
Message-ID: <582F954B.5060402@measurement-factory.com>

Hello,

This patch introduces a new 'auth_schemes' squid.conf directive.

This directive may be used to customize authentication
schemes presence and order in Squid's HTTP 401 (Unauthorized) and 407
(Proxy Authentication Required) responses. The defaults remain the same.

Also refactored configuration code for options with custom
ACL-controlled actions:

* Reduced parsing code duplication by adding ParseAclWithAction().

* Used functors for generic action-to-string conversions. It is possible
   now to perform such conversions providing lambda expressions.

* Used vectors of strings instead of C-style arrays for storing
   conversion tables and check against bounds with vector::at().


Regards,
Eduard.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161119/270edd0a/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-242-auth-scheme-t1.patch
Type: text/x-patch
Size: 57238 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161119/270edd0a/attachment-0001.bin>

From noc at squid-cache.org  Sat Nov 19 00:37:02 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 00:37:02 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=235?=
In-Reply-To: <1683317196.4.1479490132624.JavaMail.jenkins@buildmaster>
References: <1683317196.4.1479490132624.JavaMail.jenkins@buildmaster>
Message-ID: <1747295401.6.1479515822691.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/5/------------------------------------------
[...truncated 34378 lines...]
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     delete static_cast<Ssl::Bio*>(table->ptr);
                                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     table->ptr = NULL;
          ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_write(BIO*, const char*, int)':
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_read(BIO*, char*, int)':
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
In file included from ../../../../src/sbuf/SBuf.h:15:0,
                 from ../../../../src/ssl/support.h:18,
                 from ../../../../src/ssl/bio.cc:12:
../../../../src/ssl/bio.cc: In function 'long int squid_bio_ctrl(BIO*, int, long int, void*)':
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         assert(!table->ptr);
                      ^
../../../../src/Debug.h:30:23: note: in definition of macro 'assert'
 #define assert(EX)  ((EX)?((void)0):xassert( # EX , __FILE__, __LINE__))
                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->ptr = bio;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->init = 1;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT context_storage.lo -MD -MP -MF .deps/context_storage.Tpo -c ../../../../src/ssl/context_storage.cc  -fPIC -DPIC -o context_storage.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT cert_validate_message.lo -MD -MP -MF .deps/cert_validate_message.Tpo -c ../../../../src/ssl/cert_validate_message.cc  -fPIC -DPIC -o cert_validate_message.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetail.lo -MD -MP -MF .deps/ErrorDetail.Tpo -c ../../../../src/ssl/ErrorDetail.cc  -fPIC -DPIC -o ErrorDetail.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov 19 09:05:58 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 09:05:58 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2318?=
In-Reply-To: <913010153.5.1479497230169.JavaMail.jenkins@buildmaster>
References: <913010153.5.1479497230169.JavaMail.jenkins@buildmaster>
Message-ID: <931045468.7.1479546358086.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/18/------------------------------------------
[...truncated 34378 lines...]
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     delete static_cast<Ssl::Bio*>(table->ptr);
                                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     table->ptr = NULL;
          ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_write(BIO*, const char*, int)':
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'int squid_bio_read(BIO*, char*, int)':
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                 ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
In file included from ../../../../src/sbuf/SBuf.h:15:0,
                 from ../../../../src/ssl/support.h:18,
                 from ../../../../src/ssl/bio.cc:12:
../../../../src/ssl/bio.cc: In function 'long int squid_bio_ctrl(BIO*, int, long int, void*)':
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         assert(!table->ptr);
                      ^
../../../../src/Debug.h:30:23: note: in definition of macro 'assert'
 #define assert(EX)  ((EX)?((void)0):xassert( # EX , __FILE__, __LINE__))
                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->ptr = bio;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         table->init = 1;
              ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (table->init) {
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT context_storage.lo -MD -MP -MF .deps/context_storage.Tpo -c ../../../../src/ssl/context_storage.cc  -fPIC -DPIC -o context_storage.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetail.lo -MD -MP -MF .deps/ErrorDetail.Tpo -c ../../../../src/ssl/ErrorDetail.cc  -fPIC -DPIC -o ErrorDetail.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT cert_validate_message.lo -MD -MP -MF .deps/cert_validate_message.Tpo -c ../../../../src/ssl/cert_validate_message.cc  -fPIC -DPIC -o cert_validate_message.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Sat Nov 19 09:15:10 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 19 Nov 2016 22:15:10 +1300
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <582F954B.5060402@measurement-factory.com>
References: <582F954B.5060402@measurement-factory.com>
Message-ID: <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>

On 19/11/2016 12:56 p.m., Eduard Bagdasaryan wrote:
> Hello,
> 
> This patch introduces a new 'auth_schemes' squid.conf directive.
> 
> This directive may be used to customize authentication
> schemes presence and order in Squid's HTTP 401 (Unauthorized) and 407
> (Proxy Authentication Required) responses. The defaults remain the same.
> 
> Also refactored configuration code for options with custom
> ACL-controlled actions:
> 
> * Reduced parsing code duplication by adding ParseAclWithAction().
> 
> * Used functors for generic action-to-string conversions. It is possible
>   now to perform such conversions providing lambda expressions.
> 
> * Used vectors of strings instead of C-style arrays for storing
>   conversion tables and check against bounds with vector::at().
> 

-1. This patch is conflating two major feature additions.


Firstly;


The logic changes adding support for access controls 'kind' other than
allow/deny should be proposed as a separate feature addition.

Secondly;

IMO the access control for schemes is implemented wrong.

For the past 10 years admin who have been requesting control over what
schemes get advertised to clients have been driven by two main use cases:

 1) segmented networks where auth is done differently on each segment
(ie WAN vs LAN) but all segments share the one proxy.
 - either access controls to prevent some scheme being advertised to one
segment,
 - or being able to use one scheme name in several different ways
(different helper or realm etc.) .

 2) to administratively perform security downgrade attacks on clients.
Though this is usually spoken of as 'fixing' clients who repeatedly
request access with one particular (secure) credential type.


To resolve (1) fully we will need to have multiple Config objects with
the same scheme name and different config details.

To add auth scheme access controls in a way that does not actively
prevent (1) from being implemented later IMO we need to add access
controls as a member of the Config object, *not* as a global access list.

The config would look like:
 auth_param foo access allow blah blah
 auth_param foo access deny bar

 auth_param foo2 access deny blah
 auth_param foo2 access allow all

Amos


From noc at squid-cache.org  Sat Nov 19 09:21:37 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 09:21:37 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=236?=
In-Reply-To: <1747295401.6.1479515822691.JavaMail.jenkins@buildmaster>
References: <1747295401.6.1479515822691.JavaMail.jenkins@buildmaster>
Message-ID: <504516253.8.1479547297602.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/6/------------------------------------------
[...truncated 34512 lines...]
                  ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr);
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void squid_ssl_info(const SSL*, int, int)':
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
         if (Ssl::Bio *bio = static_cast<Ssl::Bio*>(table->ptr))
                                                         ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/bio.cc: In function 'void applyTlsDetailsToSSL(SSL*, const Pointer&, Ssl::BumpMode)':
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
             const SSL_CIPHER *c = method->get_cipher_by_char(cbytes);
                                         ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:226:16: note: forward declaration of 'SSL_METHOD {aka struct ssl_method_st}'
 typedef struct ssl_method_st SSL_METHOD;
                ^~~~~~~~~~~~~
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
                 strCiphers.append(c->name);
                                    ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/support.h:19,
                 from ../../../../src/ssl/bio.cc:12:
/usr/include/openssl/ssl.h:227:16: note: forward declaration of 'SSL_CIPHER {aka struct ssl_cipher_st}'
 typedef struct ssl_cipher_st SSL_CIPHER;
                ^~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'bio.lo' failed
make[4]: *** [bio.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSplice()':
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'void Ssl::PeekingPeerConnector::checkForPeekAndSpliceMatched(Ssl::BumpMode)':
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual bool Ssl::PeekingPeerConnector::initialize(Security::SessionPointer&)':
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
             Ssl::ClientBio *cltBio = static_cast<Ssl::ClientBio *>(bc->ptr);
                                                                      ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
                     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteWantWrite()':
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
../../../../src/ssl/PeekingPeerConnector.cc: In member function 'virtual void Ssl::PeekingPeerConnector::noteNegotiationError(int, int, int)':
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
     Ssl::ServerBio *srvBio = static_cast<Ssl::ServerBio *>(b->ptr);
                                                             ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/PeekingPeerConnector.cc:12:
/usr/include/openssl/ossl_typ.h:79:16: note: forward declaration of 'BIO {aka struct bio_st}'
 typedef struct bio_st BIO;
                ^~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'PeekingPeerConnector.lo' failed
make[4]: *** [PeekingPeerConnector.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ServerBump.lo -MD -MP -MF .deps/ServerBump.Tpo -c ../../../../src/ssl/ServerBump.cc  -fPIC -DPIC -o ServerBump.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT ErrorDetailManager.lo -MD -MP -MF .deps/ErrorDetailManager.Tpo -c ../../../../src/ssl/ErrorDetailManager.cc  -fPIC -DPIC -o ErrorDetailManager.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/bio.cc:47:19: error: variable 'BIO_METHOD SquidMethods' has initializer but incomplete type
../../../../src/ssl/bio.cc:154:25: error: 'SSL3_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:155:25: error: 'SSL23_ST_SR_CLNT_HELLO_A' was not declared in this scope
../../../../src/ssl/bio.cc:156:25: error: 'SSL23_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:157:25: error: 'SSL3_ST_SR_CLNT_HELLO_B' was not declared in this scope
../../../../src/ssl/bio.cc:158:25: error: 'SSL3_ST_SR_CLNT_HELLO_C' was not declared in this scope
../../../../src/ssl/bio.cc:512:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:513:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:514:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:515:7: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:523:40: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:524:10: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:532:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:541:49: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:569:22: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:570:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:571:14: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:576:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:577:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:591:18: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:592:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:622:57: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/bio.cc:656:41: error: invalid use of incomplete type 'const SSL_METHOD {aka const struct ssl_method_st}'
../../../../src/ssl/bio.cc:660:36: error: invalid use of incomplete type 'const SSL_CIPHER {aka const struct ssl_cipher_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [bio.lo] Error 1
../../../../src/ssl/PeekingPeerConnector.cc:68:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:81:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:172:70: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:179:77: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:265:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
../../../../src/ssl/PeekingPeerConnector.cc:282:61: error: invalid use of incomplete type 'BIO {aka struct bio_st}'
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [PeekingPeerConnector.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Sat Nov 19 10:07:58 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 19 Nov 2016 23:07:58 +1300
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
Message-ID: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>

Since ssl_bump directive went in my original opinion of it as being too
complicated and confusing has pretty much been demonstrated as correct
by the vast amount of misconfigurations and failed attempts of people to
use it without direct assistance from those of us involved with its design.

Since we are also transitioning to a world where 'SSL' does not exist
any longer I think v5 is a good time to rename and redesign the
directive a bit.

I propose going back to the older config style where each step has its
own directive name which self-documents what it does. That will reduce
the confusion about what is going on at each 'step', and allow us a
chance to have clearly documented default actions for each step.

For example:
 tls_new_connection
  - default: peek all
  - or run ssl_bump check if that directive exists

 tls_client_hello
  - default: splice all
  - or run ssl_bump check if that directive exists

 tls_server_hello
  - default: terminate all
  - or run ssl_bump check if that directive exists


The main consideration here is that the default behaviour/actions are
both a) that legal in almost all jurisdictions users will be working in,
and b) let client connections work if the admin does not configure
anything different (ie peek + splice).
 Those for whom even peeking is not wanted can configure
'tls_new_connection splice all'.

The terminate on step3/server_hello is so that if the admin configures
the earlier steps in a broken way without also configuring what to do at
the later step it shows up as an immediate connection failure.

Amos


From noc at squid-cache.org  Sat Nov 19 14:43:36 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 14:43:36 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2319?=
In-Reply-To: <931045468.7.1479546358086.JavaMail.jenkins@buildmaster>
References: <931045468.7.1479546358086.JavaMail.jenkins@buildmaster>
Message-ID: <1950267777.9.1479566616511.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/19/------------------------------------------
[...truncated 34528 lines...]
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PeekingPeerConnector.lo -MD -MP -MF .deps/PeekingPeerConnector.Tpo -c ../../../../src/ssl/PeekingPeerConnector.cc  -fPIC -DPIC -o PeekingPeerConnector.o >/dev/null 2>&1
../../../../src/ssl/gadgets.cc: In function 'EVP_PKEY* Ssl::createSslPrivateKey()':
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                          ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                                                                   ^
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc: In function 'bool mimicAuthorityKeyId(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
         issuerSerial.reset(M_ASN1_INTEGER_dup(X509_get_serialNumber(issuerCert.get())));
                                                                                      ^
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
     Ssl::ASN1_OCTET_STRING_Pointer extOct(M_ASN1_OCTET_STRING_new());
                                                                   ^
../../../../src/ssl/gadgets.cc: In function 'int mimicExtensions(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
     int mimicAlgo = OBJ_obj2nid(mimicCert.get()->cert_info->key->algor->algorithm);
                                                ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/ossl_typ.h:119:16: note: forward declaration of 'struct x509_st'
 typedef struct x509_st X509;
                ^~~~~~~
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
                     ASN1_OCTET_STRING *ext_oct = M_ASN1_OCTET_STRING_new();
                                                                          ^
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
                     M_ASN1_OCTET_STRING_free(ext_oct);
                                                     ^
../../../../src/ssl/gadgets.cc: In function 'bool Ssl::certificateMatchesProperties(X509*, const Ssl::CertificateProperties&)':
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
             match = sk_GENERAL_NAME_find(cert2_altnames, aName);
                                                               ^
In file included from /usr/include/openssl/crypto.h:29:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/x509v3.h:165:1: note:   initializing argument 2 of 'int sk_GENERAL_NAME_find(stack_st_GENERAL_NAME*, GENERAL_NAME*)'
 DEFINE_STACK_OF(GENERAL_NAME)
 ^
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'gadgets.lo' failed
make[4]: *** [gadgets.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT helper.lo -MD -MP -MF .deps/helper.Tpo -c ../../../../src/ssl/helper.cc  -fPIC -DPIC -o helper.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov 19 18:35:02 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 18:35:02 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=237?=
In-Reply-To: <504516253.8.1479547297602.JavaMail.jenkins@buildmaster>
References: <504516253.8.1479547297602.JavaMail.jenkins@buildmaster>
Message-ID: <575002370.10.1479580502187.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/7/------------------------------------------
[...truncated 34531 lines...]
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT PeekingPeerConnector.lo -MD -MP -MF .deps/PeekingPeerConnector.Tpo -c ../../../../src/ssl/PeekingPeerConnector.cc  -fPIC -DPIC -o PeekingPeerConnector.o >/dev/null 2>&1
../../../../src/ssl/gadgets.cc: In function 'EVP_PKEY* Ssl::createSslPrivateKey()':
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                          ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                                                                   ^
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc: In function 'bool mimicAuthorityKeyId(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
         issuerSerial.reset(M_ASN1_INTEGER_dup(X509_get_serialNumber(issuerCert.get())));
                                                                                      ^
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
     Ssl::ASN1_OCTET_STRING_Pointer extOct(M_ASN1_OCTET_STRING_new());
                                                                   ^
../../../../src/ssl/gadgets.cc: In function 'int mimicExtensions(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
     int mimicAlgo = OBJ_obj2nid(mimicCert.get()->cert_info->key->algor->algorithm);
                                                ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/ossl_typ.h:119:16: note: forward declaration of 'struct x509_st'
 typedef struct x509_st X509;
                ^~~~~~~
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
                     ASN1_OCTET_STRING *ext_oct = M_ASN1_OCTET_STRING_new();
                                                                          ^
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
                     M_ASN1_OCTET_STRING_free(ext_oct);
                                                     ^
../../../../src/ssl/gadgets.cc: In function 'bool Ssl::certificateMatchesProperties(X509*, const Ssl::CertificateProperties&)':
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
             match = sk_GENERAL_NAME_find(cert2_altnames, aName);
                                                               ^
In file included from /usr/include/openssl/crypto.h:29:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/x509v3.h:165:1: note:   initializing argument 2 of 'int sk_GENERAL_NAME_find(stack_st_GENERAL_NAME*, GENERAL_NAME*)'
 DEFINE_STACK_OF(GENERAL_NAME)
 ^
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'gadgets.lo' failed
make[4]: *** [gadgets.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT helper.lo -MD -MP -MF .deps/helper.Tpo -c ../../../../src/ssl/helper.cc  -fPIC -DPIC -o helper.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sat Nov 19 21:40:15 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sat, 19 Nov 2016 21:40:15 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=238?=
In-Reply-To: <575002370.10.1479580502187.JavaMail.jenkins@buildmaster>
References: <575002370.10.1479580502187.JavaMail.jenkins@buildmaster>
Message-ID: <1242062844.11.1479591615495.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/8/------------------------------------------
[...truncated 34536 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From marcus.kool at urlfilterdb.com  Sat Nov 19 23:08:27 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Sat, 19 Nov 2016 21:08:27 -0200
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
Message-ID: <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>



On 11/19/2016 08:07 AM, Amos Jeffries wrote:
> Since ssl_bump directive went in my original opinion of it as being too
> complicated and confusing has pretty much been demonstrated as correct
> by the vast amount of misconfigurations and failed attempts of people to
> use it without direct assistance from those of us involved with its design.
>
> Since we are also transitioning to a world where 'SSL' does not exist
> any longer I think v5 is a good time to rename and redesign the
> directive a bit.
>
> I propose going back to the older config style where each step has its
> own directive name which self-documents what it does. That will reduce
> the confusion about what is going on at each 'step', and allow us a
> chance to have clearly documented default actions for each step.
>
> For example:
>  tls_new_connection
>   - default: peek all
>   - or run ssl_bump check if that directive exists
>
>  tls_client_hello
>   - default: splice all
>   - or run ssl_bump check if that directive exists
>
>  tls_server_hello
>   - default: terminate all
>   - or run ssl_bump check if that directive exists

I like the intent of the proposal and the new directives tls_*.
What currently makes configuration in Squid 3/4 difficult is
the logic of 'define in step x what to do in the next step' and
IMO this logic is the main cause of misunderstandings and
incorrect configurations.  Also the terms 'bump' and 'splice'
do not help ease of understanding.  Since Squid evolved and
bumping changed from 3.3 - 3.4 - 3.5 to 4.x, and likely will
change again in 5.x, there is an opportunity to improve
things more than is proposed.
There is also a difference in dealing with transparent intercepted
connections and direct connections (browsers doing a CONNECT)
which also causes some misunderstandings.
The current ssl bump steps allow problematic configs where Squid
bumps or stares in one step and to splice in an other step,
which can be resolved (made impossible) in a new configuration syntax.

I propose to use a new logic for the configuration directives
where 'define in step x what to do in the next step' is replaced
with a new logic 'define in step x what to do _now_'.

Below is a new proposal to attempt to make the configuration
more intuitive and less prone for admin misunderstandings.

First the admin must define if there is any bumping at all.
This could be done with
https_decryption on|off
This is similar to tls_new_connection peek|splice but much
more intuitive.

Iff https_decryption is on:

1) the "connection" step:
When a browser uses "CONNECT <FQDN>" Squid does not need to make
peek or splice decisions.
When Squid intercepts a connection to "port 443 of <IP>" no peek
or splice decision is made here any more.
This step becomes obsolete in the proposed configuration.

2) the "TLS client hello" step:
When a browser uses CONNECT, Squid has a FQDN and does not need
peeking a TLS client hello message. It can use the tls_client_hello
directives given below.
When Squid intercepts a connection, Squid always peeks to retrieve
the SNI which is the equivalent of the FQDN used by a CONNECT.
In this step admins may want to define what Squid must do, e.g.
tls_client_hello passthrough aclfoo
Note that the acl 'aclfoo' can use tls::client_servername and
tls::client_servername should always have a FQDN if the connection
is https.  tls::client_servername expands to the IP address if
the SNI of an intercepted connection could not be retrieved.

For https connections with a client hello without the SNI extension:
tls_client_hello passthrough|terminate aclbar
where aclbar can contain tls::client_hello_missing_sni

For connections that do not use TLS (i.e. not a valid
TLS client hello message was seen):
tls_client_hello passthrough|terminate aclbar2
where aclbar2 may contain tls::handshake_failure

To define that the TLS handshake continues, the config can contain
tls_client_hello continue
This is a basically a no-op and not required but enhances readability
of a configuration.

3) the "TLS server hello" step:
Usually no directives are needed since rarely actions are taken
based on the server hello message, so the default is
tls_server_hello continue
The tls_server_hello can be used to terminate specific connections.
In this step many types of certificate errors can be detected
and in the Squid configuration there must be a way to define
what to do for specific errors and optionally for which FQDN.
E.g. allow to define that connections with self-signed certificates
are terminates but the self-signed cert for domain foo.example.com
is allowed.  See also the example config below and the use of
tls::server_servername.

What is left, is a configuration directive for connections
that use TLS as an encryption wrapper but do not use HTTP
inside the TLS wrapper:
tls_no_http passthrough|terminate   # similar to on_unsupported_protocol

An example configuration looks like this:
https_decryption on
acl banks tls::client_servername .bank1.example.org
acl no_sni tls::client_hello_missing_sni
acl no_handshake tls::handshake_failure
acl hacked_server tls::server_servername evil.example.com
tls_client_hello passthrough banks
tls_client_hello terminate no_sni
tls_client_hello passthrough no_handshake
tls_client_hello continue
tls_server_hello terminate hacked_server
tls_server_hello continue
tls_no_http passthrough

The configuration directives as I proposed are IMO intuitive and
leave very little room for misunderstandings.

Marcus


> The main consideration here is that the default behaviour/actions are
> both a) that legal in almost all jurisdictions users will be working in,
> and b) let client connections work if the admin does not configure
> anything different (ie peek + splice).
>  Those for whom even peeking is not wanted can configure
> 'tls_new_connection splice all'.
>
> The terminate on step3/server_hello is so that if the admin configures
> the earlier steps in a broken way without also configuring what to do at
> the later step it shows up as an immediate connection failure.
>
> Amos
>
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev
>

From squid3 at treenet.co.nz  Sun Nov 20 02:06:13 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sun, 20 Nov 2016 15:06:13 +1300
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
Message-ID: <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>

On 20/11/2016 12:08 p.m., Marcus Kool wrote:
> 
> 
> On 11/19/2016 08:07 AM, Amos Jeffries wrote:
>> Since ssl_bump directive went in my original opinion of it as being too
>> complicated and confusing has pretty much been demonstrated as correct
>> by the vast amount of misconfigurations and failed attempts of people to
>> use it without direct assistance from those of us involved with its
>> design.
>>
>> Since we are also transitioning to a world where 'SSL' does not exist
>> any longer I think v5 is a good time to rename and redesign the
>> directive a bit.
>>
>> I propose going back to the older config style where each step has its
>> own directive name which self-documents what it does. That will reduce
>> the confusion about what is going on at each 'step', and allow us a
>> chance to have clearly documented default actions for each step.
>>
>> For example:
>>  tls_new_connection
>>   - default: peek all
>>   - or run ssl_bump check if that directive exists
>>
>>  tls_client_hello
>>   - default: splice all
>>   - or run ssl_bump check if that directive exists
>>
>>  tls_server_hello
>>   - default: terminate all
>>   - or run ssl_bump check if that directive exists
> 
> I like the intent of the proposal and the new directives tls_*.
> What currently makes configuration in Squid 3/4 difficult is
> the logic of 'define in step x what to do in the next step' and
> IMO this logic is the main cause of misunderstandings and
> incorrect configurations.  Also the terms 'bump' and 'splice'
> do not help ease of understanding.  Since Squid evolved and
> bumping changed from 3.3 - 3.4 - 3.5 to 4.x, and likely will
> change again in 5.x, there is an opportunity to improve
> things more than is proposed.
> There is also a difference in dealing with transparent intercepted
> connections and direct connections (browsers doing a CONNECT)
> which also causes some misunderstandings.
> The current ssl bump steps allow problematic configs where Squid
> bumps or stares in one step and to splice in an other step,
> which can be resolved (made impossible) in a new configuration syntax.
> 
> I propose to use a new logic for the configuration directives
> where 'define in step x what to do in the next step' is replaced
> with a new logic 'define in step x what to do _now_'.

>From reading the below I think you are mistaking what "now" means to
Squid. Input access control directives in squid.conf make a decision
about what action to do based on some state that just arrived.

For example:
 HTTP message just finished parsing -> check http_access what to do with it.
 HTTP reply message just arrived -> check http_reply_access what to do
with it.

Thus my proposal was along the lines of:
  client hello recieved -> check tls_client_hello what to do with it.
  server hello recieved -> check tls_server_hello what to do with it.


> 
> Below is a new proposal to attempt to make the configuration
> more intuitive and less prone for admin misunderstandings.
> 
> First the admin must define if there is any bumping at all.
> This could be done with
> https_decryption on|off
> This is similar to tls_new_connection peek|splice but much
> more intuitive.
> 
> Iff https_decryption is on:
> 
> 1) the "connection" step:
> When a browser uses "CONNECT <FQDN>" Squid does not need to make
> peek or splice decisions.
> When Squid intercepts a connection to "port 443 of <IP>" no peek
> or splice decision is made here any more.
> This step becomes obsolete in the proposed configuration.

I am still hoping that will happen. But also still getting pushback that
people want to terminate or splice without even looking at the
clear-text hello details.

> 
> 2) the "TLS client hello" step:
> When a browser uses CONNECT, Squid has a FQDN and does not need
> peeking a TLS client hello message. It can use the tls_client_hello
> directives given below.

Sadly this is not correct. Squid still needs to get the client hello
details at this point. They are needed to perform bump before the server
hello is received, and to "terminate with an error message" without
contacting a server.


> When Squid intercepts a connection, Squid always peeks to retrieve
> the SNI which is the equivalent of the FQDN used by a CONNECT.
> In this step admins may want to define what Squid must do, e.g.
> tls_client_hello passthrough aclfoo
> Note that the acl 'aclfoo' can use tls::client_servername and
> tls::client_servername should always have a FQDN if the connection
> is https.  tls::client_servername expands to the IP address if
> the SNI of an intercepted connection could not be retrieved.

What if the SNI contradicts the CONNECT message FQDN ?
What if a raw-IP in the CONNECT message (or TCP SYN) does not belong to
the server named in SNI ?

Squid would now be diverting the client transparently to a server other
than the one it expects and caching under that FQDN. But the server cert
would still authenticate as being the SNI host, so TLS cannot detect the
diversion.

The fake CONNECT's are a bit messy but IMHO we can only get rid of the
first one done for intercepted connections. Although that alone would
make both cases handle the same way.

> 
> For https connections with a client hello without the SNI extension:
> tls_client_hello passthrough|terminate aclbar
> where aclbar can contain tls::client_hello_missing_sni
> 
> For connections that do not use TLS (i.e. not a valid
> TLS client hello message was seen):
> tls_client_hello passthrough|terminate aclbar2
> where aclbar2 may contain tls::handshake_failure
> 
> To define that the TLS handshake continues, the config can contain
> tls_client_hello continue
> This is a basically a no-op and not required but enhances readability
> of a configuration.

This is getting complicated again. Avoiding the first (TCP SYN) access
control cycles will make ssl::server_name ACL contain either FQDN/SNI or
the actual server cert name. A default "none" or "-" value when no
FQDN/SNI is available should be sufficient for matching these clients.
And we should have that already I think, if not its a missing feature bug.

Also even "no-op" ACLs still require CPU time to assemble data for ACL
checking. So avoiding that kind of thing in configs is good.

> 
> 3) the "TLS server hello" step:
> Usually no directives are needed since rarely actions are taken
> based on the server hello message, so the default is
> tls_server_hello continue

Once Squid gets to this stage of processing "continue" could mean either
splice or bump, but only one of the two is possible.

Bump is not legal in a lot of situations but splice may not be possible.
So terminate is the only realistic default we can set for general use.
As you say, its uncommon to need it, and people who do tend to know what
they want done. So will configure that.


The handshake containing error signals or other protocols are different
decisions points. Remember Squid is deciding what to do with some data
that just arrived. If its going to tunnel/splice the server hello, there
is no point even evaluating what the protocol inside is, and error
alerts get delivered to the client as-is.

So the existing on_unsupported_protocol and sslproxy_cert_error to make
those handling decisions with 'ssl_error' type ACL to match the specific
problem are fine IMO.


> The tls_server_hello can be used to terminate specific connections.
> In this step many types of certificate errors can be detected
> and in the Squid configuration there must be a way to define
> what to do for specific errors and optionally for which FQDN.
> E.g. allow to define that connections with self-signed certificates
> are terminates but the self-signed cert for domain foo.example.com
> is allowed.  See also the example config below and the use of
> tls::server_servername.
> 
> What is left, is a configuration directive for connections
> that use TLS as an encryption wrapper but do not use HTTP
> inside the TLS wrapper:
> tls_no_http passthrough|terminate   # similar to on_unsupported_protocol
> 
> An example configuration looks like this:
> https_decryption on
> acl banks tls::client_servername .bank1.example.org
> acl no_sni tls::client_hello_missing_sni
> acl no_handshake tls::handshake_failure
> acl hacked_server tls::server_servername evil.example.com
> tls_client_hello passthrough banks
> tls_client_hello terminate no_sni
> tls_client_hello passthrough no_handshake
> tls_client_hello continue
> tls_server_hello terminate hacked_server
> tls_server_hello continue
> tls_no_http passthrough
> 
> The configuration directives as I proposed are IMO intuitive and
> leave very little room for misunderstandings.

Looks just like what I'm proposing except your config above lets clients
connect to servers with invalid TLS credentials (maybe not so intuitive?).

 acl banks ssl::server_name .bank1.example.org
 acl no_sni ssl::server_name "-"
 acl hacked_server ssl::server_name evil.example.com

 tls_client_hello splice banks
 tls_client_hello terminate no_sni
 tls_client_hello terminate hacked_server
 tls_client_hello peek all

 tls_server_hello terminate hacked_server
 tls_server_hello splice all

 # NP: "sslproxy_cert_error deny all" is default

 on_unsupported_protocol tunnel all


Amos


From noc at squid-cache.org  Sun Nov 20 11:17:40 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sun, 20 Nov 2016 11:17:40 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2320?=
In-Reply-To: <1950267777.9.1479566616511.JavaMail.jenkins@buildmaster>
References: <1950267777.9.1479566616511.JavaMail.jenkins@buildmaster>
Message-ID: <1734625559.12.1479640661029.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/20/------------------------------------------
[...truncated 34481 lines...]
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:847: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: *** Waiting for unfinished jobs....
../../../../src/ssl/gadgets.cc: In function 'EVP_PKEY* Ssl::createSslPrivateKey()':
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                          ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
     Ssl::RSA_Pointer rsa(RSA_generate_key(1024, RSA_F4, NULL, NULL));
                                                                   ^
In file included from /usr/include/openssl/rsa.h:13:0,
                 from /usr/include/openssl/x509.h:31,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/rsa.h:193:1: note: declared here
 DEPRECATEDIN_0_9_8(RSA *RSA_generate_key(int bits, unsigned long e, void
 ^
../../../../src/ssl/gadgets.cc: In function 'bool mimicAuthorityKeyId(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
         issuerSerial.reset(M_ASN1_INTEGER_dup(X509_get_serialNumber(issuerCert.get())));
                                                                                      ^
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
     Ssl::ASN1_OCTET_STRING_Pointer extOct(M_ASN1_OCTET_STRING_new());
                                                                   ^
../../../../src/ssl/gadgets.cc: In function 'int mimicExtensions(Security::CertPointer&, const CertPointer&, const CertPointer&)':
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
     int mimicAlgo = OBJ_obj2nid(mimicCert.get()->cert_info->key->algor->algorithm);
                                                ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/ossl_typ.h:119:16: note: forward declaration of 'struct x509_st'
 typedef struct x509_st X509;
                ^~~~~~~
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
                     ASN1_OCTET_STRING *ext_oct = M_ASN1_OCTET_STRING_new();
                                                                          ^
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
                     M_ASN1_OCTET_STRING_free(ext_oct);
                                                     ^
../../../../src/ssl/gadgets.cc: In function 'bool Ssl::certificateMatchesProperties(X509*, const Ssl::CertificateProperties&)':
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
             match = sk_GENERAL_NAME_find(cert2_altnames, aName);
                                                               ^
In file included from /usr/include/openssl/crypto.h:29:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/ssl/gadgets.h:13,
                 from ../../../../src/ssl/gadgets.cc:10:
/usr/include/openssl/x509v3.h:165:1: note:   initializing argument 2 of 'int sk_GENERAL_NAME_find(stack_st_GENERAL_NAME*, GENERAL_NAME*)'
 DEFINE_STACK_OF(GENERAL_NAME)
 ^
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:847: recipe for target 'gadgets.lo' failed
make[4]: *** [gadgets.lo] Error 1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT crtd_message.lo -MD -MP -MF .deps/crtd_message.Tpo -c ../../../../src/ssl/crtd_message.cc  -fPIC -DPIC -o crtd_message.o >/dev/null 2>&1
libtool: compile:  ccache g++ -DHAVE_CONFIG_H -I../../../.. -I../../../../include -I../../../../lib -I../../../../src -I../../include -I/usr/include/libxml2 -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT -I/usr/include/p11-kit-1 -g -O2 -MT helper.lo -MD -MP -MF .deps/helper.Tpo -c ../../../../src/ssl/helper.cc  -fPIC -DPIC -o helper.o >/dev/null 2>&1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6912: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5932: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:582: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:790: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From marcus.kool at urlfilterdb.com  Sun Nov 20 12:55:50 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Sun, 20 Nov 2016 10:55:50 -0200
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
Message-ID: <e333c20d-986a-fe1e-7fd3-0acbebe71ba9@urlfilterdb.com>



On 11/20/2016 12:06 AM, Amos Jeffries wrote:
> On 20/11/2016 12:08 p.m., Marcus Kool wrote:
>>
[snip]

>>
>> I like the intent of the proposal and the new directives tls_*.
>> What currently makes configuration in Squid 3/4 difficult is
>> the logic of 'define in step x what to do in the next step' and
>> IMO this logic is the main cause of misunderstandings and
>> incorrect configurations.  Also the terms 'bump' and 'splice'
>> do not help ease of understanding.  Since Squid evolved and
>> bumping changed from 3.3 - 3.4 - 3.5 to 4.x, and likely will
>> change again in 5.x, there is an opportunity to improve
>> things more than is proposed.
>> There is also a difference in dealing with transparent intercepted
>> connections and direct connections (browsers doing a CONNECT)
>> which also causes some misunderstandings.
>> The current ssl bump steps allow problematic configs where Squid
>> bumps or stares in one step and to splice in an other step,
>> which can be resolved (made impossible) in a new configuration syntax.
>>
>> I propose to use a new logic for the configuration directives
>> where 'define in step x what to do in the next step' is replaced
>> with a new logic 'define in step x what to do _now_'.
>
> From reading the below I think you are mistaking what "now" means to
> Squid. Input access control directives in squid.conf make a decision
> about what action to do based on some state that just arrived.

Maybe it is necessary to redefine 'now' but my point remains that
'define in step x what to do in the next step' is the cause of
most misunderstandings.

> For example:
>  HTTP message just finished parsing -> check http_access what to do with it.
>  HTTP reply message just arrived -> check http_reply_access what to do
> with it.
>
> Thus my proposal was along the lines of:
>   client hello recieved -> check tls_client_hello what to do with it.
>   server hello recieved -> check tls_server_hello what to do with it.

For both hello messages: is the decision moment the moment where it
has been peeked at?

>>
>> Below is a new proposal to attempt to make the configuration
>> more intuitive and less prone for admin misunderstandings.
>>
>> First the admin must define if there is any bumping at all.
>> This could be done with
>> https_decryption on|off
>> This is similar to tls_new_connection peek|splice but much
>> more intuitive.
>>
>> Iff https_decryption is on:
>>
>> 1) the "connection" step:
>> When a browser uses "CONNECT <FQDN>" Squid does not need to make
>> peek or splice decisions.
>> When Squid intercepts a connection to "port 443 of <IP>" no peek
>> or splice decision is made here any more.
>> This step becomes obsolete in the proposed configuration.
>
> I am still hoping that will happen. But also still getting pushback that
> people want to terminate or splice without even looking at the
> clear-text hello details.

We must know the reasons behind this pushback.  Only then sane decisions
can be made.

>>
>> 2) the "TLS client hello" step:
>> When a browser uses CONNECT, Squid has a FQDN and does not need
>> peeking a TLS client hello message. It can use the tls_client_hello
>> directives given below.
>
> Sadly this is not correct. Squid still needs to get the client hello
> details at this point. They are needed to perform bump before the server
> hello is received, and to "terminate with an error message" without
> contacting a server.

yes, correct.  Squid must do this.  But does it have to be configured?

>> When Squid intercepts a connection, Squid always peeks to retrieve
>> the SNI which is the equivalent of the FQDN used by a CONNECT.
>> In this step admins may want to define what Squid must do, e.g.
>> tls_client_hello passthrough aclfoo
>> Note that the acl 'aclfoo' can use tls::client_servername and
>> tls::client_servername should always have a FQDN if the connection
>> is https.  tls::client_servername expands to the IP address if
>> the SNI of an intercepted connection could not be retrieved.
>
> What if the SNI contradicts the CONNECT message FQDN ?
> What if a raw-IP in the CONNECT message (or TCP SYN) does not belong to
> the server named in SNI ?

:-)  I left this out on purpose to not make the post even larger than it was.
There is of course a lot of error checking.  The question is if
we have to configure it.  If yes, can we get away with one directive based
on an acl that uses tls::handshake_failure ?

> Squid would now be diverting the client transparently to a server other
> than the one it expects and caching under that FQDN. But the server cert
> would still authenticate as being the SNI host, so TLS cannot detect the
> diversion.
>
> The fake CONNECT's are a bit messy but IMHO we can only get rid of the
> first one done for intercepted connections. Although that alone would
> make both cases handle the same way.

I do not know anything about the code that generates the fake CONNECT
of an transparent interception connection, but logically there should
not be a fake CONNECT for true HTTPS (TLS+HTTP) since a browser does
not do a CONNECT, so why fake one?  Was the fake CONNECT introduced
to keep a state?  If yes, the state can be administered in a different way.

However, in case of other protocols on port 443 a fake CONNECT is a
must to be able to filter and log it.

>> For https connections with a client hello without the SNI extension:
>> tls_client_hello passthrough|terminate aclbar
>> where aclbar can contain tls::client_hello_missing_sni
>>
>> For connections that do not use TLS (i.e. not a valid
>> TLS client hello message was seen):
>> tls_client_hello passthrough|terminate aclbar2
>> where aclbar2 may contain tls::handshake_failure
>>
>> To define that the TLS handshake continues, the config can contain
>> tls_client_hello continue
>> This is a basically a no-op and not required but enhances readability
>> of a configuration.
>
> This is getting complicated again. Avoiding the first (TCP SYN) access
> control cycles will make ssl::server_name ACL contain either FQDN/SNI or
> the actual server cert name. A default "none" or "-" value when no
> FQDN/SNI is available should be sufficient for matching these clients.
> And we should have that already I think, if not its a missing feature bug.

Maybe in some cases tls_new_connection is required to be used, but
lets start with a default of
tls_new_connection continue
Under normal circumstances there is no need to define that Squid must
peek or already define that the connection must be spliced.

In my proposal there is no ssl::server_name and I did that on purpose.
While it might seem a nice idea to evaluate it from 'none' to SNI
to server name, there is no need for it and the use of tls::client_servername
and tls::server_servername explicitly refers to which servername
Squid must look at.
And at the moment that tls_new_connection is evaluated, there
is no servername when intercepted.

> Also even "no-op" ACLs still require CPU time to assemble data for ACL
> checking. So avoiding that kind of thing in configs is good.

Maybe not, the no-op was there for readability and at config parse time
Squid can simply skip it to not have any CPU cycles wasted on it
by acl matching logic.

I am not familiar with all steps/stages in the implementation but
one may get better performance in a simpler design if that reduces
the number of events that Squid processes for each TLS connection.

>> 3) the "TLS server hello" step:
>> Usually no directives are needed since rarely actions are taken
>> based on the server hello message, so the default is
>> tls_server_hello continue
>
> Once Squid gets to this stage of processing "continue" could mean either
> splice or bump, but only one of the two is possible.
>
> Bump is not legal in a lot of situations but splice may not be possible.
> So terminate is the only realistic default we can set for general use.
> As you say, its uncommon to need it, and people who do tend to know what
> they want done. So will configure that.

Admin who want https decryption do not want that the connection is
terminated by default.

You are right that tls_server_hello needs a little more thought.
Somewhere must be defined if the connection will have mode passthrough
(splice) or mode decrypt (bump).
And the right place to make that decision is at tls_client_hello
(after the SNI has been peeked at).
Then for tls_server_hello remains 'continue' and 'terminate' decisions.

> The handshake containing error signals or other protocols are different
> decisions points. Remember Squid is deciding what to do with some data
> that just arrived. If its going to tunnel/splice the server hello, there
> is no point even evaluating what the protocol inside is, and error
> alerts get delivered to the client as-is.
>
> So the existing on_unsupported_protocol and sslproxy_cert_error to make
> those handling decisions with 'ssl_error' type ACL to match the specific
> problem are fine IMO.

yes, they look fine but may need a rename to have a tls_ prefix
but I cannot find a way to define
continue when cert-is-self-signed and server_name is '.nic.es' and
otherwise terminate when cert-is-self-signed.

>> The tls_server_hello can be used to terminate specific connections.
>> In this step many types of certificate errors can be detected
>> and in the Squid configuration there must be a way to define
>> what to do for specific errors and optionally for which FQDN.
>> E.g. allow to define that connections with self-signed certificates
>> are terminates but the self-signed cert for domain foo.example.com
>> is allowed.  See also the example config below and the use of
>> tls::server_servername.
>>
>> What is left, is a configuration directive for connections
>> that use TLS as an encryption wrapper but do not use HTTP
>> inside the TLS wrapper:
>> tls_no_http passthrough|terminate   # similar to on_unsupported_protocol
>>
>> An example configuration looks like this:
>> https_decryption on
>> acl banks tls::client_servername .bank1.example.org
>> acl no_sni tls::client_hello_missing_sni
>> acl no_handshake tls::handshake_failure
>> acl hacked_server tls::server_servername evil.example.com
>> tls_client_hello passthrough banks
>> tls_client_hello terminate no_sni
>> tls_client_hello passthrough no_handshake
>> tls_client_hello continue
>> tls_server_hello terminate hacked_server
>> tls_server_hello continue
>> tls_no_http passthrough
>>
>> The configuration directives as I proposed are IMO intuitive and
>> leave very little room for misunderstandings.
>
> Looks just like what I'm proposing except your config above lets clients
> connect to servers with invalid TLS credentials (maybe not so intuitive?).

Are you referring to 'tls_client_hello passthrough no_handshake' ?
That should be 'tls_client_hello terminate no_handshake'.

>  acl banks ssl::server_name .bank1.example.org
>  acl no_sni ssl::server_name "-"
>  acl hacked_server ssl::server_name evil.example.com
>
>  tls_client_hello splice banks
>  tls_client_hello terminate no_sni
>  tls_client_hello terminate hacked_server
>  tls_client_hello peek all
>
>  tls_server_hello terminate hacked_server
>  tls_server_hello splice all
>
>  # NP: "sslproxy_cert_error deny all" is default
>
>  on_unsupported_protocol tunnel all

In my example at the time that tls_client_hello is evaluated,
the client hello has not only arrived but has also been parsed
and the SNI is known.  You also seem to intend that given
the rule 'tls_client_hello splice banks', but then why do you
have the rule 'tls_client_hello peek all' ?  Does that mean
'peek at the received client hello and continue' ?

The 'tls_client_hello continue' was intended to mean 'decrypt
the connection' (bump) but I failed to mention that.  I think
that 'tls_client_hello continue' must be replaced with
'tls_client_hello decrypt'.

There is a distinction between tls::server_servername and
tls::client_servername on one hand and ssl:server_name on the
other hand.  I prefer tls::* since it explicitly refers to
one of the servernames while ssl::server_name refers to
a dynamic object that needs evaluation and may evaluate to
different server names at different times.

One of the rules with 'terminate hacked_server' seems
redundant.

So after corrections, my example becomes
https_decryption on
acl banks tls::client_servername .bank1.example.org
acl no_sni tls::client_hello_missing_sni
acl no_handshake tls::handshake_failure
acl hacked_server tls::server_servername evil.example.com
tls_client_hello passthrough banks
tls_client_hello terminate no_sni
# tls_client_hello terminate no_handshake  # default behavior, so no rule needed
tls_client_hello decrypt
tls_server_hello terminate hacked_server
tls_server_hello continue
tls_unsupported_protocol passthrough all

In your example the meaning is to splice all connections and
with my proposed syntax the config would look like this:

https_decryption on
acl banks tls::client_servername .bank1.example.org
acl no_sni tls::client_hello_missing_sni
acl no_handshake tls::handshake_failure
acl hacked_server tls::server_servername evil.example.com
tls_client_hello passthrough banks
tls_client_hello terminate no_sni
tls_client_hello passthrough
tls_server_hello terminate hacked_server
tls_server_hello continue
tls_unsupported_protocol passthrough all

The choice of keywords for the config may seem a matter of taste,
but I feel it is more than that and that the keyword
'decrypt' is far better than 'bump' and the keyword
'passthrough' is better than 'splice'.

Marcus

> Amos
>
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev
>

From noc at squid-cache.org  Sun Nov 20 15:27:14 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sun, 20 Nov 2016 15:27:14 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2321?=
In-Reply-To: <1734625559.12.1479640661029.JavaMail.jenkins@buildmaster>
References: <1734625559.12.1479640661029.JavaMail.jenkins@buildmaster>
Message-ID: <625143061.13.1479655634729.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/21/------------------------------------------
[...truncated 34481 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:847: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6912: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5932: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:582: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:790: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From noc at squid-cache.org  Sun Nov 20 18:29:03 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sun, 20 Nov 2016 18:29:03 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2322?=
In-Reply-To: <625143061.13.1479655634729.JavaMail.jenkins@buildmaster>
References: <625143061.13.1479655634729.JavaMail.jenkins@buildmaster>
Message-ID: <412500243.14.1479666543081.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/22/------------------------------------------
[...truncated 34484 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:847: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6912: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5932: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:582: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:790: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From garryd at comnet.uz  Sun Nov 20 20:22:02 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Mon, 21 Nov 2016 01:22:02 +0500
Subject: [squid-dev] Build fails after update to rev. 14954
Message-ID: <1434dfe7c1bde6ad8e62eacfb07ef84a@comnet.uz>

Hello, the build fails with the following error:

Making all in compat
make[1]: Entering directory '/usr/local/src/squid/trunk/compat'
make[1]: *** No rule to make target 'GnuRegex.c', needed by 
'GnuRegex.lo'.  Stop.
make[1]: Leaving directory '/usr/local/src/squid/trunk/compat'
make: *** [Makefile:582: all-recursive] Error 1


Garri

From garryd at comnet.uz  Sun Nov 20 20:43:18 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Mon, 21 Nov 2016 01:43:18 +0500
Subject: [squid-dev] Build fails after update to rev. 14954
In-Reply-To: <1434dfe7c1bde6ad8e62eacfb07ef84a@comnet.uz>
References: <1434dfe7c1bde6ad8e62eacfb07ef84a@comnet.uz>
Message-ID: <103099f159a457418f4f11abf5157009@comnet.uz>

On 2016-11-21 01:22, Garri Djavadyan wrote:
> Hello, the build fails with the following error:
> 
> Making all in compat
> make[1]: Entering directory '/usr/local/src/squid/trunk/compat'
> make[1]: *** No rule to make target 'GnuRegex.c', needed by
> 'GnuRegex.lo'.  Stop.
> make[1]: Leaving directory '/usr/local/src/squid/trunk/compat'
> make: *** [Makefile:582: all-recursive] Error 1

Sorry, I had to run bootstrap.sh again after the update.

From garryd at comnet.uz  Sun Nov 20 20:58:49 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Mon, 21 Nov 2016 01:58:49 +0500
Subject: [squid-dev] [PATCH] Update refresh_pattern description regarding
	'max' option
Message-ID: <c6d299bb492cdcc82ca55612ac68c8c5@comnet.uz>

The patch adds description for undocumented behavior related to 'max' 
option of 'refresh_pattern' directive. I mean, 'max' option sets value 
for 'Cache-Control: max-age' header sent by Squid upstream. Feel free to 
modify the description. Thanks.

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: refresh_pattern_update_max_desc.patch
Type: text/x-diff
Size: 490 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161121/7d4add38/attachment-0001.patch>

From eduard.bagdasaryan at measurement-factory.com  Tue Nov 22 09:33:19 2016
From: eduard.bagdasaryan at measurement-factory.com (Eduard Bagdasaryan)
Date: Tue, 22 Nov 2016 12:33:19 +0300
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
References: <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
Message-ID: <583410DF.3000704@measurement-factory.com>

  2016-11-19 12:15 GMT+03:00 Amos Jeffries <squid3 at treenet.co.nz>:
 >  To add auth scheme access controls in a way that does not actively
 > prevent (1) from being implemented later IMO we need to add access
 > controls as a member of the Config object, *not* as a global access list.
 >
 > The config would look like:
 >  auth_param foo access allow blah blah
 >  auth_param foo access deny bar
 >
 >  auth_param foo2 access deny blah
 >  auth_param foo2 access allow all

If I understood you correctly, we have foo and foo2 auth schemes, and do
not want foo to be used with "bar", foo2 with "blah" and want both
schemes for others. I don't see problem here because with new
auth_schemes we similarly get:

  auth_param foo ...
  auth_param foo2 ...

  auth_schemes foo blah
  auth_schemes foo2 bar


Eduard.


From marcus.kool at urlfilterdb.com  Thu Nov 24 10:57:46 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Thu, 24 Nov 2016 08:57:46 -0200
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <e333c20d-986a-fe1e-7fd3-0acbebe71ba9@urlfilterdb.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <e333c20d-986a-fe1e-7fd3-0acbebe71ba9@urlfilterdb.com>
Message-ID: <27868cb5-0dc6-4eb9-5ede-b3a936d2eef1@urlfilterdb.com>

Hi Amos,

Can you share your thoughts ?

Thanks
Marcus


On 11/20/2016 10:55 AM, Marcus Kool wrote:
>
>
> On 11/20/2016 12:06 AM, Amos Jeffries wrote:
>> On 20/11/2016 12:08 p.m., Marcus Kool wrote:
>>>
> [snip]
>
>>>
>>> I like the intent of the proposal and the new directives tls_*.
>>> What currently makes configuration in Squid 3/4 difficult is
>>> the logic of 'define in step x what to do in the next step' and
>>> IMO this logic is the main cause of misunderstandings and
>>> incorrect configurations.  Also the terms 'bump' and 'splice'
>>> do not help ease of understanding.  Since Squid evolved and
>>> bumping changed from 3.3 - 3.4 - 3.5 to 4.x, and likely will
>>> change again in 5.x, there is an opportunity to improve
>>> things more than is proposed.
>>> There is also a difference in dealing with transparent intercepted
>>> connections and direct connections (browsers doing a CONNECT)
>>> which also causes some misunderstandings.
>>> The current ssl bump steps allow problematic configs where Squid
>>> bumps or stares in one step and to splice in an other step,
>>> which can be resolved (made impossible) in a new configuration syntax.
>>>
>>> I propose to use a new logic for the configuration directives
>>> where 'define in step x what to do in the next step' is replaced
>>> with a new logic 'define in step x what to do _now_'.
>>
>> From reading the below I think you are mistaking what "now" means to
>> Squid. Input access control directives in squid.conf make a decision
>> about what action to do based on some state that just arrived.
>
> Maybe it is necessary to redefine 'now' but my point remains that
> 'define in step x what to do in the next step' is the cause of
> most misunderstandings.
>
>> For example:
>>  HTTP message just finished parsing -> check http_access what to do with it.
>>  HTTP reply message just arrived -> check http_reply_access what to do
>> with it.
>>
>> Thus my proposal was along the lines of:
>>   client hello recieved -> check tls_client_hello what to do with it.
>>   server hello recieved -> check tls_server_hello what to do with it.
>
> For both hello messages: is the decision moment the moment where it
> has been peeked at?
>
>>>
>>> Below is a new proposal to attempt to make the configuration
>>> more intuitive and less prone for admin misunderstandings.
>>>
>>> First the admin must define if there is any bumping at all.
>>> This could be done with
>>> https_decryption on|off
>>> This is similar to tls_new_connection peek|splice but much
>>> more intuitive.
>>>
>>> Iff https_decryption is on:
>>>
>>> 1) the "connection" step:
>>> When a browser uses "CONNECT <FQDN>" Squid does not need to make
>>> peek or splice decisions.
>>> When Squid intercepts a connection to "port 443 of <IP>" no peek
>>> or splice decision is made here any more.
>>> This step becomes obsolete in the proposed configuration.
>>
>> I am still hoping that will happen. But also still getting pushback that
>> people want to terminate or splice without even looking at the
>> clear-text hello details.
>
> We must know the reasons behind this pushback.  Only then sane decisions
> can be made.
>
>>>
>>> 2) the "TLS client hello" step:
>>> When a browser uses CONNECT, Squid has a FQDN and does not need
>>> peeking a TLS client hello message. It can use the tls_client_hello
>>> directives given below.
>>
>> Sadly this is not correct. Squid still needs to get the client hello
>> details at this point. They are needed to perform bump before the server
>> hello is received, and to "terminate with an error message" without
>> contacting a server.
>
> yes, correct.  Squid must do this.  But does it have to be configured?
>
>>> When Squid intercepts a connection, Squid always peeks to retrieve
>>> the SNI which is the equivalent of the FQDN used by a CONNECT.
>>> In this step admins may want to define what Squid must do, e.g.
>>> tls_client_hello passthrough aclfoo
>>> Note that the acl 'aclfoo' can use tls::client_servername and
>>> tls::client_servername should always have a FQDN if the connection
>>> is https.  tls::client_servername expands to the IP address if
>>> the SNI of an intercepted connection could not be retrieved.
>>
>> What if the SNI contradicts the CONNECT message FQDN ?
>> What if a raw-IP in the CONNECT message (or TCP SYN) does not belong to
>> the server named in SNI ?
>
> :-)  I left this out on purpose to not make the post even larger than it was.
> There is of course a lot of error checking.  The question is if
> we have to configure it.  If yes, can we get away with one directive based
> on an acl that uses tls::handshake_failure ?
>
>> Squid would now be diverting the client transparently to a server other
>> than the one it expects and caching under that FQDN. But the server cert
>> would still authenticate as being the SNI host, so TLS cannot detect the
>> diversion.
>>
>> The fake CONNECT's are a bit messy but IMHO we can only get rid of the
>> first one done for intercepted connections. Although that alone would
>> make both cases handle the same way.
>
> I do not know anything about the code that generates the fake CONNECT
> of an transparent interception connection, but logically there should
> not be a fake CONNECT for true HTTPS (TLS+HTTP) since a browser does
> not do a CONNECT, so why fake one?  Was the fake CONNECT introduced
> to keep a state?  If yes, the state can be administered in a different way.
>
> However, in case of other protocols on port 443 a fake CONNECT is a
> must to be able to filter and log it.
>
>>> For https connections with a client hello without the SNI extension:
>>> tls_client_hello passthrough|terminate aclbar
>>> where aclbar can contain tls::client_hello_missing_sni
>>>
>>> For connections that do not use TLS (i.e. not a valid
>>> TLS client hello message was seen):
>>> tls_client_hello passthrough|terminate aclbar2
>>> where aclbar2 may contain tls::handshake_failure
>>>
>>> To define that the TLS handshake continues, the config can contain
>>> tls_client_hello continue
>>> This is a basically a no-op and not required but enhances readability
>>> of a configuration.
>>
>> This is getting complicated again. Avoiding the first (TCP SYN) access
>> control cycles will make ssl::server_name ACL contain either FQDN/SNI or
>> the actual server cert name. A default "none" or "-" value when no
>> FQDN/SNI is available should be sufficient for matching these clients.
>> And we should have that already I think, if not its a missing feature bug.
>
> Maybe in some cases tls_new_connection is required to be used, but
> lets start with a default of
> tls_new_connection continue
> Under normal circumstances there is no need to define that Squid must
> peek or already define that the connection must be spliced.
>
> In my proposal there is no ssl::server_name and I did that on purpose.
> While it might seem a nice idea to evaluate it from 'none' to SNI
> to server name, there is no need for it and the use of tls::client_servername
> and tls::server_servername explicitly refers to which servername
> Squid must look at.
> And at the moment that tls_new_connection is evaluated, there
> is no servername when intercepted.
>
>> Also even "no-op" ACLs still require CPU time to assemble data for ACL
>> checking. So avoiding that kind of thing in configs is good.
>
> Maybe not, the no-op was there for readability and at config parse time
> Squid can simply skip it to not have any CPU cycles wasted on it
> by acl matching logic.
>
> I am not familiar with all steps/stages in the implementation but
> one may get better performance in a simpler design if that reduces
> the number of events that Squid processes for each TLS connection.
>
>>> 3) the "TLS server hello" step:
>>> Usually no directives are needed since rarely actions are taken
>>> based on the server hello message, so the default is
>>> tls_server_hello continue
>>
>> Once Squid gets to this stage of processing "continue" could mean either
>> splice or bump, but only one of the two is possible.
>>
>> Bump is not legal in a lot of situations but splice may not be possible.
>> So terminate is the only realistic default we can set for general use.
>> As you say, its uncommon to need it, and people who do tend to know what
>> they want done. So will configure that.
>
> Admin who want https decryption do not want that the connection is
> terminated by default.
>
> You are right that tls_server_hello needs a little more thought.
> Somewhere must be defined if the connection will have mode passthrough
> (splice) or mode decrypt (bump).
> And the right place to make that decision is at tls_client_hello
> (after the SNI has been peeked at).
> Then for tls_server_hello remains 'continue' and 'terminate' decisions.
>
>> The handshake containing error signals or other protocols are different
>> decisions points. Remember Squid is deciding what to do with some data
>> that just arrived. If its going to tunnel/splice the server hello, there
>> is no point even evaluating what the protocol inside is, and error
>> alerts get delivered to the client as-is.
>>
>> So the existing on_unsupported_protocol and sslproxy_cert_error to make
>> those handling decisions with 'ssl_error' type ACL to match the specific
>> problem are fine IMO.
>
> yes, they look fine but may need a rename to have a tls_ prefix
> but I cannot find a way to define
> continue when cert-is-self-signed and server_name is '.nic.es' and
> otherwise terminate when cert-is-self-signed.
>
>>> The tls_server_hello can be used to terminate specific connections.
>>> In this step many types of certificate errors can be detected
>>> and in the Squid configuration there must be a way to define
>>> what to do for specific errors and optionally for which FQDN.
>>> E.g. allow to define that connections with self-signed certificates
>>> are terminates but the self-signed cert for domain foo.example.com
>>> is allowed.  See also the example config below and the use of
>>> tls::server_servername.
>>>
>>> What is left, is a configuration directive for connections
>>> that use TLS as an encryption wrapper but do not use HTTP
>>> inside the TLS wrapper:
>>> tls_no_http passthrough|terminate   # similar to on_unsupported_protocol
>>>
>>> An example configuration looks like this:
>>> https_decryption on
>>> acl banks tls::client_servername .bank1.example.org
>>> acl no_sni tls::client_hello_missing_sni
>>> acl no_handshake tls::handshake_failure
>>> acl hacked_server tls::server_servername evil.example.com
>>> tls_client_hello passthrough banks
>>> tls_client_hello terminate no_sni
>>> tls_client_hello passthrough no_handshake
>>> tls_client_hello continue
>>> tls_server_hello terminate hacked_server
>>> tls_server_hello continue
>>> tls_no_http passthrough
>>>
>>> The configuration directives as I proposed are IMO intuitive and
>>> leave very little room for misunderstandings.
>>
>> Looks just like what I'm proposing except your config above lets clients
>> connect to servers with invalid TLS credentials (maybe not so intuitive?).
>
> Are you referring to 'tls_client_hello passthrough no_handshake' ?
> That should be 'tls_client_hello terminate no_handshake'.
>
>>  acl banks ssl::server_name .bank1.example.org
>>  acl no_sni ssl::server_name "-"
>>  acl hacked_server ssl::server_name evil.example.com
>>
>>  tls_client_hello splice banks
>>  tls_client_hello terminate no_sni
>>  tls_client_hello terminate hacked_server
>>  tls_client_hello peek all
>>
>>  tls_server_hello terminate hacked_server
>>  tls_server_hello splice all
>>
>>  # NP: "sslproxy_cert_error deny all" is default
>>
>>  on_unsupported_protocol tunnel all
>
> In my example at the time that tls_client_hello is evaluated,
> the client hello has not only arrived but has also been parsed
> and the SNI is known.  You also seem to intend that given
> the rule 'tls_client_hello splice banks', but then why do you
> have the rule 'tls_client_hello peek all' ?  Does that mean
> 'peek at the received client hello and continue' ?
>
> The 'tls_client_hello continue' was intended to mean 'decrypt
> the connection' (bump) but I failed to mention that.  I think
> that 'tls_client_hello continue' must be replaced with
> 'tls_client_hello decrypt'.
>
> There is a distinction between tls::server_servername and
> tls::client_servername on one hand and ssl:server_name on the
> other hand.  I prefer tls::* since it explicitly refers to
> one of the servernames while ssl::server_name refers to
> a dynamic object that needs evaluation and may evaluate to
> different server names at different times.
>
> One of the rules with 'terminate hacked_server' seems
> redundant.
>
> So after corrections, my example becomes
> https_decryption on
> acl banks tls::client_servername .bank1.example.org
> acl no_sni tls::client_hello_missing_sni
> acl no_handshake tls::handshake_failure
> acl hacked_server tls::server_servername evil.example.com
> tls_client_hello passthrough banks
> tls_client_hello terminate no_sni
> # tls_client_hello terminate no_handshake  # default behavior, so no rule needed
> tls_client_hello decrypt
> tls_server_hello terminate hacked_server
> tls_server_hello continue
> tls_unsupported_protocol passthrough all
>
> In your example the meaning is to splice all connections and
> with my proposed syntax the config would look like this:
>
> https_decryption on
> acl banks tls::client_servername .bank1.example.org
> acl no_sni tls::client_hello_missing_sni
> acl no_handshake tls::handshake_failure
> acl hacked_server tls::server_servername evil.example.com
> tls_client_hello passthrough banks
> tls_client_hello terminate no_sni
> tls_client_hello passthrough
> tls_server_hello terminate hacked_server
> tls_server_hello continue
> tls_unsupported_protocol passthrough all
>
> The choice of keywords for the config may seem a matter of taste,
> but I feel it is more than that and that the keyword
> 'decrypt' is far better than 'bump' and the keyword
> 'passthrough' is better than 'splice'.
>
> Marcus
>
>> Amos
>>
>> _______________________________________________
>> squid-dev mailing list
>> squid-dev at lists.squid-cache.org
>> http://lists.squid-cache.org/listinfo/squid-dev
>>
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev

From christos at chtsanti.net  Fri Nov 25 10:50:23 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Fri, 25 Nov 2016 12:50:23 +0200
Subject: [squid-dev] g++ 4.8.x and std::regex problems
Message-ID: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>

Hi all,

   I have problems to run latest squid-5. The reason looks that it is 
the r14954, which removes old GnuRegex and uses the std::regex API.

The std::regex supported from gcc-4.9 and latest releases and I am still 
using an gcc-4.8.4 on my kubuntu-14.04 LTS release.

OK, I can upgrade to newer OS (currently not without problems), but 
since the end-of-life of ubuntu-14.04 and I suppose other OSes (eg 
debian Wheezy, centos7) are near the 2019 is it legal to stop supporting 
them? A developer which uses latest CentOs as primary system needs to 
recompile gcc-4.9, to continue working.

The squid-trunk (or now squid-5) is not running only on developers 
machines, sometimes runs on customers machines they need special 
features or need to test the new features and configurations.

Regards,
    Christos

From squid3 at treenet.co.nz  Fri Nov 25 13:39:00 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 26 Nov 2016 02:39:00 +1300
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
Message-ID: <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>

On 25/11/2016 11:50 p.m., Christos Tsantilas wrote:
> Hi all,
> 
>   I have problems to run latest squid-5. The reason looks that it is the
> r14954, which removes old GnuRegex and uses the std::regex API.
> 
> The std::regex supported from gcc-4.9 and latest releases and I am still
> using an gcc-4.8.4 on my kubuntu-14.04 LTS release.
> 

Well the STL docs says GCC 4.9, but there are problems on that version
too. I think GCC 5 is going to be the minimum for Squid-5.

Which is the reason why this regex change was delayed until squid-5.


> OK, I can upgrade to newer OS (currently not without problems), but
> since the end-of-life of ubuntu-14.04 and I suppose other OSes (eg
> debian Wheezy, centos7) are near the 2019 is it legal to stop supporting
> them? A developer which uses latest CentOs as primary system needs to
> recompile gcc-4.9, to continue working.

If you want to look at legality;

Part of the LTS contract is that software feature changes are *not*
done. The clients have chosen to make that a requirement. The OS
distributors have chosen to meet it. Nothing to do with what Squid
Project does in our latest shiny version.

It is actually a bit unreasonable to ask us not to add new features to
the upstream code to prevent breakage in something that was designed
specifically NOT to run those new software versions.

So, if anything it is more likely to be "illegal" to run Squid-5 on
those OS.


Despite the unreasonableness I'm procrastinating as much as I can to
balance the overlap of timelines. But I also have to look at the
projected timing of stable releases. If I stretch it much longer we are
going to have a whole pile of 5-year LTS releases through to 2027
suffering from v3.5 bugs that are already fixed by v4.


> 
> The squid-trunk (or now squid-5) is not running only on developers
> machines, sometimes runs on customers machines they need special
> features or need to test the new features and configurations.

That type of service which IMO can and should be paid for. Even with
open source the "free" only stretches so far. Customers have money,
payment is what makes them "customers".

On the other side, v4 is still in beta so if there is a strong need you
can probably still twist my arm into accepting things there. NO big
things though please as it does need to get stable ASAP. And as usual
TLS/SSL stuff is going back as requested, no twisting needed.

Amos


From christos at chtsanti.net  Fri Nov 25 14:23:45 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Fri, 25 Nov 2016 16:23:45 +0200
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
Message-ID: <11cdf65c-c655-7429-f414-81ac7ce57c61@chtsanti.net>

On 11/25/2016 03:39 PM, Amos Jeffries wrote:
>
> If you want to look at legality;
>
> Part of the LTS contract is that software feature changes are *not*
> done. The clients have chosen to make that a requirement. The OS
> distributors have chosen to meet it. Nothing to do with what Squid
> Project does in our latest shiny version.
>
> It is actually a bit unreasonable to ask us not to add new features to
> the upstream code to prevent breakage in something that was designed
> specifically NOT to run those new software versions.
>
> So, if anything it is more likely to be "illegal" to run Squid-5 on
> those OS.

OK, but LTS releases may used by developers to develop squid (this is 
not illegal!).

> That type of service which IMO can and should be paid for. Even with
> open source the "free" only stretches so far. Customers have money,
> payment is what makes them "customers".

Yes, but we are (you, measurement factory, etc) the supporters of these 
customers, there is not any reason to make our lives harder.
Anyway...




From squid3 at treenet.co.nz  Sat Nov 26 08:52:38 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 26 Nov 2016 21:52:38 +1300
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <27868cb5-0dc6-4eb9-5ede-b3a936d2eef1@urlfilterdb.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <e333c20d-986a-fe1e-7fd3-0acbebe71ba9@urlfilterdb.com>
 <27868cb5-0dc6-4eb9-5ede-b3a936d2eef1@urlfilterdb.com>
Message-ID: <835c0d94-bac7-db0e-3a38-a1fee08a47c6@treenet.co.nz>

On 24/11/2016 11:57 p.m., Marcus Kool wrote:
> Hi Amos,
> 
> Can you share your thoughts ?
> 
> Thanks
> Marcus
> 

I'm thinking we agree on whats wrong and general direction of a fix.

I'm waiting to see if there are any other ideas that come forward before
I get time to do any coding about this.

Amos


From squid3 at treenet.co.nz  Sun Nov 27 13:58:21 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 28 Nov 2016 02:58:21 +1300
Subject: [squid-dev] [PATCH] Fix for bug 3290
In-Reply-To: <1479307384.15118.17.camel@comnet.uz>
References: <1479307384.15118.17.camel@comnet.uz>
Message-ID: <c68ff9c3-60d1-119c-d509-2595c6338014@treenet.co.nz>

On 17/11/2016 3:43 a.m., Garri Djavadyan wrote:
> Dear developers,
> 
> Please review the attached patch for Squid-5 fixing the issue explained
> in the bug report 3290 [1]. The issue is still reproducible using rev.
> 14947.
> 
> The problem exists because Squid resets expiration time for a user on
> every successful authentication, regardless where the user was found in
> the username cache or found by means of a helper. The patch instructs
> Squid to reset expiration time only for users gotten from helper.
> 
> Thanks in advance! 
> 
> [1] http://bugs.squid-cache.org/show_bug.cgi?id=3290

Thanks. Applied to Squid-5 as rev.14958.

Amos


From noc at squid-cache.org  Sun Nov 27 15:28:48 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Sun, 27 Nov 2016 15:28:48 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2323?=
In-Reply-To: <412500243.14.1479666543081.JavaMail.jenkins@buildmaster>
References: <412500243.14.1479666543081.JavaMail.jenkins@buildmaster>
Message-ID: <1430646370.15.1480260528796.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/23/------------------------------------------
[...truncated 34484 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:847: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6912: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5932: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:582: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:790: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From rousskov at measurement-factory.com  Mon Nov 28 00:16:23 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 27 Nov 2016 17:16:23 -0700
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
Message-ID: <56068785-39c7-da00-4860-1c5fca776217@measurement-factory.com>

On 11/19/2016 03:07 AM, Amos Jeffries wrote:

> I propose going back to the older config style where each step has its
> own directive name which self-documents what it does.

IIRC, SslBump has never used step-specific directives: First
implementations applied all ssl_bump actions during step1 and the
current implementation applies various ssl_bump actions at various
steps, but no Squid version had steps with dedicated directive names
AFAICT: http://www.squid-cache.org/Doc/config/ssl_bump/


> That will reduce
> the confusion about what is going on at each 'step', and allow us a
> chance to have clearly documented default actions for each step.

Why do you think that moving the step name into the directive name,
i.e., essentially replacing

  ssl_bump action stepN ...

with

  ssl_bump_stepN action ...

will "reduce the confusion about what is going on at each step, and
allow us a chance to have clearly documented default actions for each
step"? I see no correlation between the proposed change and the expected
result.


There have been cases were being explicit about steps resulted in worse
or broken configurations. There have been cases were being explicit
about steps resulted in better configurations. The exact outcome usually
depends on the level of admin's understanding and specific use cases.
Steps are helpful in some cases and harmful in others. If the consensus
is that explicit steps are usually helpful, we can encourage their use
[without forcing them on all the admins, in all cases].

IMO, the steps are not the core problem; their set will change
long-term; and they should not be the focus of the configuration. The
core problems lie elsewhere:

* The available information varies widely and may (or may not!) change
with each step. Even today, the information available at step1 varies
depending on the bumping environment. It is difficult to deal with
changing information using traditional "fixed" ACLs. We need to arm the
admin with server_name and similar "dynamic" ACLs. A related
"information" problem is server certificate validation: The admins are
surprised to learn that Squid validates the server certificate, and it
is often not clear when Squid does that and how to control whether Squid
should validate.

* The "price" (or side effects) of obtaining more information grows with
each step. For example, one can learn the origin server CN, but only at
the cost of establishing a TCP connection with the origin server and
precluding future splicing (or bumping). There is currently no good way
to tell Squid how much the admin is willing to "pay" for more
information [in the context of the current transaction state].

* Exception handling: When things go wrong, the admins are surprised to
learn that Squid bumps the client (to send an error message). There are
different kinds of errors and Squid reaction to each kind is controlled
by a different configuration directive. It is often not clear what Squid
will do in a particular situation, even when the current step is known.

These problems are fundamental SslBump properties that will not change
regardless of the configuration approach. The best configuration
approach should focus on these fundamental properties rather than on the
[still evolving] "steps" mechanics. The current configuration abilities
have many weak spots, but the proposed changes seem like a step in the
wrong direction to me because they focus on the mechanics rather than on
these fundamentals. They force the admins to detail what should not be
important.



> For example:
>  tls_new_connection
>   - default: peek all
>   - or run ssl_bump check if that directive exists
> 
>  tls_client_hello
>   - default: splice all
>   - or run ssl_bump check if that directive exists
> 
>  tls_server_hello
>   - default: terminate all
>   - or run ssl_bump check if that directive exists


To illustrate why your proposal will be better than the existing
approach, please compare an old configuration with a new configuration
for a few common use cases. Please do your best to be unbiased in your
comparison -- do not just pick the cases that benefit your proposal.


Also, I suggest to separate naming from the functionality changes. If we
agree to change the functionality, we can then discuss how to name the
new configuration knobs. For now, I am not going to discuss the problems
with the proposed naming scheme.



> The main consideration here is that the default behaviour/actions are
> both a) that legal in almost all jurisdictions users will be working in,

Please do not bring legality and jurisdictions into this. If there is
quorum, then we are unlikely to reach consensus if we start discussing
what is "legal" and where one "jurisdiction" ends and another begins.
Said that, the existing default behavior is probably already legal in
all jurisdictions so there seems to be no difference here anyway.


> and b) let client connections work if the admin does not configure
> anything different (ie peek + splice).

How is that different from today? Client connections already work if the
admin configures nothing: Splicing is the default when nothing is
configured. If it is not the default, it should be (and we can certainly
fix that bug if it exists).


Thank you,

Alex.
P.S.
> Since ssl_bump directive went in my original opinion of it as being too
> complicated and confusing has pretty much been demonstrated as correct
> by the vast amount of misconfigurations and failed attempts [to use it].

I envy your confidence but do not know why you started your RFC with
this flawed attempt to prove some vaguely defined opinion to be correct.
I tried to avoid this distraction and focus on the RFC parts that deal
with reducing ssl_bump configuration complexity instead. If you meant to
discuss why we happen to be where we are today, and who has predicted
what, please start a dedicated email thread.


From rousskov at measurement-factory.com  Mon Nov 28 01:20:51 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 27 Nov 2016 18:20:51 -0700
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
Message-ID: <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>

On 11/19/2016 07:06 PM, Amos Jeffries wrote:
> On 20/11/2016 12:08 p.m., Marcus Kool wrote:
>> The current ssl bump steps allow problematic configs where Squid
>> bumps or stares in one step and to splice in an other step,
>> which can be resolved (made impossible) in a new configuration syntax.

It would be nice to prohibit truly impossible actions at the syntax
level, but I suspect that the only way to make that possible is to focus
on final actions [instead of steps] and require at *most* one ssl_bump
rule for each of the supported final actions:

  ssl_bump splice    ...rules that define when to splice...
  ssl_bump bump      ...rules that define when to bump...
  ssl_bump terminate ...rules that define when to terminate...
  # no other ssl_bump lines allowed!

The current intermediate actions (peek and stare) would have to go into
the ACLs. There will be no ssl_bump rules for them at all. In other
words, the admin would be required to _always_ write an equivalent of

  if (a1() && a2() && ...)
  then
      splice
  elsif (b1() && b2() && ...)
  then
      bump
  elsif (c1() && c2() && ...)
  then
      terminate
  else
      splice or bump, depending on state
      (or some other default; this decision is secondary)
  endif

where a1(), b2(), and other functions/ACLs may peek or stare as needed
to get the required information.

I am not sure such a change is desirable, but it is worth considering, I
guess.

Please note that I am ignoring the directives/actions naming issue for now.


AFAICT, the syntax proposed by Amos (i.e., making stepN mandatory) does
not solve this particular problem at all:

  # Syntactically valid nonsense:
  ssl_bump_step1 splice all
  ssl_bump_step2 bump all


and neither is yours:

  # Syntactically valid nonsense?
  tls_server_hello passthrough all
  tls_client_hello terminate all


>> Below is a new proposal to attempt to make the configuration
>> more intuitive and less prone for admin misunderstandings.
>>
>> First the admin must define if there is any bumping at all.
>> This could be done with
>> https_decryption on|off
>> This is similar to tls_new_connection peek|splice but much
>> more intuitive.

I do not see why

  https_decryption off

is more intuitive (or more precise) than

  ssl_bump splice all

especially after you consider the order of directives.

Again, I am ignoring the naming issue for now. You may assume any name
you want for any directive or ACL.


>> Iff https_decryption is on:
>>
>> 1) the "connection" step:
>> When a browser uses "CONNECT <FQDN>" Squid does not need to make
>> peek or splice decisions.
>> When Squid intercepts a connection to "port 443 of <IP>" no peek
>> or splice decision is made here any more.
>> This step becomes obsolete in the proposed configuration.

> I am still hoping that will happen. But also still getting pushback that
> people want to terminate or splice without even looking at the
> clear-text hello details.

I suspect that not looking at some SSL Hellos will always be needed
because some of those Hellos are not Hellos at all and it takes too much
time/resources for the SSL Hellos parser to detect some non-SSL Hellos.
Besides that, it is always nice to be able to selectively bypass the
complex Hello parser code in emergencies.


>> 3) the "TLS server hello" step:
>> Usually no directives are needed since rarely actions are taken
>> based on the server hello message, so the default is
>> tls_server_hello continue
> 
> Once Squid gets to this stage of processing "continue" could mean either
> splice or bump, but only one of the two is possible.
> 
> Bump is not legal in a lot of situations but splice may not be possible.
> So terminate is the only realistic default we can set for general use.
> As you say, its uncommon to need it, and people who do tend to know what
> they want done. So will configure that.

Just like naming, the defaults are probably not that important yet: If
we can agree on the new configuration approach, then we probably will be
able to agree on the defaults.

However, all proposals have to decide how to distinguish stare from peek
during step2. Those two intermediate actions result in different bytes
on the wire so they cannot be mapped to a single verb like "continue".


>> An example configuration looks like this:
>> https_decryption on
>> acl banks tls::client_servername .bank1.example.org
>> acl no_sni tls::client_hello_missing_sni
>> acl no_handshake tls::handshake_failure
>> acl hacked_server tls::server_servername evil.example.com
>> tls_client_hello passthrough banks
>> tls_client_hello terminate no_sni
>> tls_client_hello passthrough no_handshake
>> tls_client_hello continue
>> tls_server_hello terminate hacked_server
>> tls_server_hello continue
>> tls_no_http passthrough
>>
>> The configuration directives as I proposed are IMO intuitive and
>> leave very little room for misunderstandings.

... if you use them correctly. However, the same is true for the current
directives so this is not really an illustration of improvement AFAICT.
For example, what does the following [mis]configuration do?

  https_decryption off
  tls_server_hello continue
  tls_server_hello terminate hacked_server
  https_decryption on
  tls_client_hello continue
  tls_client_hello passthrough banks

If I understand the proposals correctly, the above will probably splice
or perhaps bump everything but I am obviously not sure. I do not see an
an improvement as far as possible confusion/misunderstanding is concerned.

Again, I am ignoring the naming issue. If, for example, there is
consensus that "passthrough" is better than "splice" or "continue2" is
better than "stare" then we can, of course, add aliases and eventually
completely get rid of the old names. Let's focus on the functionality first.


Thank you,

Alex.


From rousskov at measurement-factory.com  Mon Nov 28 02:34:49 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 27 Nov 2016 19:34:49 -0700
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
Message-ID: <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>

On 11/19/2016 02:15 AM, Amos Jeffries wrote:
> On 19/11/2016 12:56 p.m., Eduard Bagdasaryan wrote:
>> This patch introduces a new 'auth_schemes' squid.conf directive.
>>
>> This directive may be used to customize authentication
>> schemes presence and order in Squid's HTTP 401 (Unauthorized) and 407
>> (Proxy Authentication Required) responses. The defaults remain the same.
>>
>> Also refactored configuration code for options with custom
>> ACL-controlled actions

> -1. This patch is conflating two major feature additions.

The patch does not add two major features. It only adds one regular feature.


> The logic changes adding support for access controls 'kind' other than
> allow/deny should be proposed as a separate feature addition.

Squid already supports many actions other than allow/deny. AFAIK, the
proposed patch reduces code duplication in that existing code area while
reusing the already working approach. No logic changes related to
non-allow/deny actions are being proposed here. While splitting the code
improvements from the new feature may be possible, their coexistence
certainly does not warrant a -1 vote!


> Secondly;
> 
> IMO the access control for schemes is implemented wrong.
> 
> For the past 10 years admin who have been requesting control over what
> schemes get advertised to clients have been driven by two main use cases:
> 
>  1) segmented networks where auth is done differently on each segment
> (ie WAN vs LAN) but all segments share the one proxy.
>  - either access controls to prevent some scheme being advertised to one
> segment,
>  - or being able to use one scheme name in several different ways
> (different helper or realm etc.) .


Or being able to control the order of schemes presented to the user.


> To resolve (1) fully we will need to have multiple Config objects with
> the same scheme name and different config details.

The use cases covered by the proposed patch do not need different
configurations for the same scheme. The proposed changes do not preclude
such future support. Moreover, such future support will not address some
of the use cases covered by the proposed patch. In other words, what has
been implemented and your suggestion are complementary, not mutually
exclusive.


> To add auth scheme access controls in a way that does not actively
> prevent (1) from being implemented later IMO we need to add access
> controls as a member of the Config object, *not* as a global access list.

Per-scheme access controls do not work for controlling the order of the
presented schemes. The order is currently hard-coded. The proposed patch
makes it configurable. Future patches may certainly add per scheme
access controls and other knobs as needed. I see no reason why the two
complementary mechanisms cannot coexist.

Also, while working on the proposed feature, we have discovered why
adding per-scheme ACLs (or a special NONE value to auth_schemes) will
create a negative side effect that the posted implementation avoids: The
implemented code does not change authentication decision; auth_schemes
cannot accidentally create a situation where no schemes exist for a
transaction. Interpreting such a situation correctly is going to be
tricky: Does it mean "allow access without authentication" or "deny
access"? Or should Squid keep evaluating other http_access rules because
the decision/ACLs may change later?

This "NONE" problem does not imply that multiple same-scheme
configurations are a bad idea, of course. It only illustrates why the
"Should I use this configuration for scheme X?" and "What schemes should
I use for this transaction?" are two different questions, each deserving
an answer in various real-world situations.

Please reconsider your initial evaluation.


Thank you,

Alex.


From noc at squid-cache.org  Mon Nov 28 12:34:33 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Mon, 28 Nov 2016 12:34:33 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=239?=
In-Reply-To: <1242062844.11.1479591615495.JavaMail.jenkins@buildmaster>
References: <1242062844.11.1479591615495.JavaMail.jenkins@buildmaster>
Message-ID: <1649269111.16.1480336473476.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/9/------------------------------------------
[...truncated 34531 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6934: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5954: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From marcus.kool at urlfilterdb.com  Mon Nov 28 13:30:07 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Mon, 28 Nov 2016 11:30:07 -0200
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>
Message-ID: <0d79f393-fb4a-6f46-14cc-0481149c505a@urlfilterdb.com>



On 11/27/2016 11:20 PM, Alex Rousskov wrote:
> On 11/19/2016 07:06 PM, Amos Jeffries wrote:
>> On 20/11/2016 12:08 p.m., Marcus Kool wrote:
>>> The current ssl bump steps allow problematic configs where Squid
>>> bumps or stares in one step and to splice in an other step,
>>> which can be resolved (made impossible) in a new configuration syntax.
>
> It would be nice to prohibit truly impossible actions at the syntax
> level, but I suspect that the only way to make that possible is to focus
> on final actions [instead of steps] and require at *most* one ssl_bump
> rule for each of the supported final actions:
>
>   ssl_bump splice    ...rules that define when to splice...
>   ssl_bump bump      ...rules that define when to bump...
>   ssl_bump terminate ...rules that define when to terminate...
>   # no other ssl_bump lines allowed!
>
> The current intermediate actions (peek and stare) would have to go into
> the ACLs. There will be no ssl_bump rules for them at all. In other
> words, the admin would be required to _always_ write an equivalent of
>
>   if (a1() && a2() && ...)
>   then
>       splice
>   elsif (b1() && b2() && ...)
>   then
>       bump
>   elsif (c1() && c2() && ...)
>   then
>       terminate
>   else
>       splice or bump, depending on state
>       (or some other default; this decision is secondary)
>   endif
>
> where a1(), b2(), and other functions/ACLs may peek or stare as needed
> to get the required information.

The above if-then-else tree is clear.
I like your suggestion to drop steps in the configuration and make
Squid more intelligent to take decisions at the appropriate
moments (steps).

You mentioned admins being surprised about Squid bumping for a
notification of an error and one way to improve that is to replace
'terminate' by 'terminate_with_error' (with bumping) and 'quick_terminate'
(no bumping, just close fd).  The quick_terminate, if used, is also
faster, which is an added benefit.


> I am not sure such a change is desirable, but it is worth considering, I
> guess.
>
> Please note that I am ignoring the directives/actions naming issue for now.
>
>
> AFAICT, the syntax proposed by Amos (i.e., making stepN mandatory) does
> not solve this particular problem at all:
>
>   # Syntactically valid nonsense:
>   ssl_bump_step1 splice all
>   ssl_bump_step2 bump all
>
>
> and neither is yours:
>
>   # Syntactically valid nonsense?
>   tls_server_hello passthrough all
>   tls_client_hello terminate all
>

Correct.  It would be nice to have a better configuration syntax
where impossible rules are easier to avoid and/or Squid has
intelligence to detect nonsense rules and produce an error.

>>> Below is a new proposal to attempt to make the configuration
>>> more intuitive and less prone for admin misunderstandings.
>>>
>>> First the admin must define if there is any bumping at all.
>>> This could be done with
>>> https_decryption on|off
>>> This is similar to tls_new_connection peek|splice but much
>>> more intuitive.
>
> I do not see why
>
>   https_decryption off
>
> is more intuitive (or more precise) than
>
>   ssl_bump splice all

For me this is because of the used terminology and because
with 'https_decryption off' one does not write anything
that has 'bump' in it, so the admin does not even have to
read the documentation to learn that 'ssl_bump splice all'
means 'no decryption'.

> especially after you consider the order of directives.
>
> Again, I am ignoring the naming issue for now. You may assume any name
> you want for any directive or ACL.

allright for now.
The only comment that I want to make without starting a
new thread is that I think that conceptual terms are better
than technical terms (hence my preference for 'passthrough'
instead of 'splice').  But let's save this discussion for later.

>>> Iff https_decryption is on:
>>>
>>> 1) the "connection" step:
>>> When a browser uses "CONNECT <FQDN>" Squid does not need to make
>>> peek or splice decisions.
>>> When Squid intercepts a connection to "port 443 of <IP>" no peek
>>> or splice decision is made here any more.
>>> This step becomes obsolete in the proposed configuration.
>
>> I am still hoping that will happen. But also still getting pushback that
>> people want to terminate or splice without even looking at the
>> clear-text hello details.
>
> I suspect that not looking at some SSL Hellos will always be needed
> because some of those Hellos are not Hellos at all and it takes too much
> time/resources for the SSL Hellos parser to detect some non-SSL Hellos.
> Besides that, it is always nice to be able to selectively bypass the
> complex Hello parser code in emergencies.

Perhaps less resources are used if there is a two-stage parser:
1) quick scan of input for data layout of a ClientHello without
    semantic parsing the content, e.g. look at the CipherSuite and verify
    that the whole field has legal characters without verifying
    that the ciphersuite is a valid SSL string of ciphers.
2) do the complex parsing.

Stage 1 should be fast and can separate SSL ClientHello from other
protocols.

>>> 3) the "TLS server hello" step:
>>> Usually no directives are needed since rarely actions are taken
>>> based on the server hello message, so the default is
>>> tls_server_hello continue
>>
>> Once Squid gets to this stage of processing "continue" could mean either
>> splice or bump, but only one of the two is possible.
>>
>> Bump is not legal in a lot of situations but splice may not be possible.
>> So terminate is the only realistic default we can set for general use.
>> As you say, its uncommon to need it, and people who do tend to know what
>> they want done. So will configure that.
>
> Just like naming, the defaults are probably not that important yet: If
> we can agree on the new configuration approach, then we probably will be
> able to agree on the defaults.
>
> However, all proposals have to decide how to distinguish stare from peek
> during step2. Those two intermediate actions result in different bytes
> on the wire so they cannot be mapped to a single verb like "continue".

An issue that complicates things is an "impossible decision",
the desire to splice when "it is too late".  I suggest to
solve this issue by simply splicing a bumped connection.
On the bumped connection Squid can also splice/passthrough:
just do not interpret the data and copy it from client to server
and vice versa.
Yes I realize that the connection is bumped and that on technical
grounds one can argue that the connection is not really spliced,
but on a conceptual level the connection _is_ in a 'passthrough mode'
and that is what 'splice' means or should mean.

With the concept of splicing a bumped connection, the problem
of making which decision at step2, if not yet made by some acls,
can be solved.

And I think that we do not have to be afraid of CPU cycles spent
in TLS/SSL encryption since modern multi-core systems are fast
with encryption:
https://software.intel.com/en-us/articles/accelerating-ssl-load-balancers-with-intel-xeon-v3-processors
and Intel also has the quickassist hardware accelerator to create a powerful proxy:
http://www.intel.com/content/www/us/en/ethernet-products/gigabit-server-adapters/quickassist-adapter-for-servers.html
which is supported by OpenSSL:
http://www.intel.com/content/dam/www/public/us/en/documents/solution-briefs/accelerating-openssl-brief.pdf

>>> An example configuration looks like this:
>>> https_decryption on
>>> acl banks tls::client_servername .bank1.example.org
>>> acl no_sni tls::client_hello_missing_sni
>>> acl no_handshake tls::handshake_failure
>>> acl hacked_server tls::server_servername evil.example.com
>>> tls_client_hello passthrough banks
>>> tls_client_hello terminate no_sni
>>> tls_client_hello passthrough no_handshake
>>> tls_client_hello continue
>>> tls_server_hello terminate hacked_server
>>> tls_server_hello continue
>>> tls_no_http passthrough
>>>
>>> The configuration directives as I proposed are IMO intuitive and
>>> leave very little room for misunderstandings.
>
> ... if you use them correctly. However, the same is true for the current
> directives so this is not really an illustration of improvement AFAICT.
> For example, what does the following [mis]configuration do?
>
>   https_decryption off
>   tls_server_hello continue
>   tls_server_hello terminate hacked_server
>   https_decryption on
>   tls_client_hello continue
>   tls_client_hello passthrough banks
>
> If I understand the proposals correctly, the above will probably splice
> or perhaps bump everything but I am obviously not sure. I do not see an
> an improvement as far as possible confusion/misunderstanding is concerned.
>
> Again, I am ignoring the naming issue. If, for example, there is
> consensus that "passthrough" is better than "splice" or "continue2" is
> better than "stare" then we can, of course, add aliases and eventually
> completely get rid of the old names. Let's focus on the functionality first.

You are good in finding examples of nonsense configurations :-)
And I think that a syntax that does not permit nonsense configurations,
does not exist.  The question is what to do.

If a new syntax is not based on steps, the config can just have a list
of rules and instead of Squid obeying the order of the TLS rules at
all times, it can gain intelligence and at the time that Squid is done
reading the configuration, validates whatever it can validate and makes
the decisions about which acls are executed/verified at what time (and
also does some runtime checks at the appropriate times).
So the config for 'bump all except banks' could look like this:
tls decryption on
tls default bump
tls splice banks
tls terminate clients_from_subnet_x
tls terminate hacked_server
tls splice no_http_protocol_inside_tls_wrapper  # default
tls splice no_tls_protocol                      # default
tls terminate tls_without_sni

The above is elegant and I think that the required intelligence to
decide to evaluate which rule at what step is not impossible.

Squid must not allow a mix of 'tls decryption on' and
'tls decryption off'.

Simple examples like above 'work'.  The question is if it
is possible for Squid to detect most or all nonsense configurations
and generate a (fatal?) error.

Marcus

>
> Thank you,
>
> Alex.
>

From rousskov at measurement-factory.com  Mon Nov 28 17:58:55 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Mon, 28 Nov 2016 10:58:55 -0700
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <0d79f393-fb4a-6f46-14cc-0481149c505a@urlfilterdb.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>
 <0d79f393-fb4a-6f46-14cc-0481149c505a@urlfilterdb.com>
Message-ID: <519575ab-1317-bd07-fcb7-f2a994065ed8@measurement-factory.com>

On 11/28/2016 06:30 AM, Marcus Kool wrote:
> On 11/27/2016 11:20 PM, Alex Rousskov wrote:
>> It would be nice to prohibit truly impossible actions at the syntax
>> level, but I suspect that the only way to make that possible is to focus
>> on final actions [instead of steps] and require at *most* one ssl_bump
>> rule for each of the supported final actions:
>>
>>   ssl_bump splice    ...rules that define when to splice...
>>   ssl_bump bump      ...rules that define when to bump...
>>   ssl_bump terminate ...rules that define when to terminate...
>>   # no other ssl_bump lines allowed!
>>
>> The current intermediate actions (peek and stare) would have to go into
>> the ACLs. There will be no ssl_bump rules for them at all. In other
>> words, the admin would be required to _always_ write an equivalent of
>>
>>   if (a1() && a2() && ...)
>>   then
>>       splice
>>   elsif (b1() && b2() && ...)
>>   then
>>       bump
>>   elsif (c1() && c2() && ...)
>>   then
>>       terminate
>>   else
>>       splice or bump, depending on state
>>       (or some other default; this decision is secondary)
>>   endif
>>
>> where a1(), b2(), and other functions/ACLs may peek or stare as needed
>> to get the required information.

> The above if-then-else tree is clear.

It is clear at the top level. I am not sure we can also make the
secondary level (i.e., intermediate peak/state actions) clear because
they have to be side effects in this design and side effects are rarely
clear. We can try though.


> I like your suggestion to drop steps in the configuration and make
> Squid more intelligent to take decisions at the appropriate
> moments (steps).

Please note that the current configuration does not contain implicit
steps either; in its spirit/intent, it is essentially the same as the
above three-action sketch. Needless to say, most correct configurations
do contain an explicit step ACL or two, but they are supposed to be used
to essentially implement the above three-action logic.

Also, to avoid misunderstanding, I am not (yet) advocating any specific
configuration approach, including the one I started to sketch above. I
am only documenting a possible solution to the "How to make impossible
actions invalid at the syntax level" problem you have raised.


> You mentioned admins being surprised about Squid bumping for a
> notification of an error and one way to improve that is to replace
> 'terminate' by 'terminate_with_error' (with bumping) and 'quick_terminate'
> (no bumping, just close fd).  The quick_terminate, if used, is also
> faster, which is an added benefit.

Terminate is always an instant TCP connection closure, without any
bumping and without any errors being delivered to the user.

AFAIK, admins are not surprised by bumping when a terminate rule matches
(that would be a Squid bug). Admins are surprised by bumping when a
splice, peek, or stare rule matches. That surprise is a different
problem (that we should also try to solve, of course -- see the three
"core problem" bullets in my original response).


> The only comment that I want to make without starting a
> new thread is that I think that conceptual terms are better
> than technical terms (hence my preference for 'passthrough'
> instead of 'splice').  But let's save this discussion for later.

Personally, I doubt we should spend much time discussing whether
"passthrough" is better than "splice", but I agree that nobody should be
discussing naming until the much bigger (and, hopefully, solvable)
problems are solved.


>> I suspect that not looking at some SSL Hellos will always be needed
>> because some of those Hellos are not Hellos at all and it takes too much
>> time/resources for the SSL Hellos parser to detect some non-SSL Hellos.
>> Besides that, it is always nice to be able to selectively bypass the
>> complex Hello parser code in emergencies.


> Perhaps less resources are used if there is a two-stage parser:
> 1) quick scan of input for data layout of a ClientHello
> 2) do the complex parsing.

Squid v4 already uses a two-stage Hello parser (the first stage is built
into Squid and the second stage is provided by OpenSSL).

You are oversimplifying the general protocol recognition problem because
you are focusing of the trivial cases. For example, one of the reasons
the first-stage parser cannot be always "quick" is because, in some
cases, there is no data to parse -- the server has to speak before the
client will send anything. Another example is SSL-like traffic that is
not really SSL. And a third example is Squid/OpenSSL limitations in
handling advanced valid SSL traffic. In summary, there will always be a
need for bypass IMO.


>>>> 3) the "TLS server hello" step:

>> all proposals have to decide how to distinguish stare from peek
>> during step2. Those two intermediate actions result in different bytes
>> on the wire so they cannot be mapped to a single verb like "continue".

> An issue that complicates things is an "impossible decision",
> the desire to splice when "it is too late".  I suggest to
> solve this issue by simply splicing a bumped connection.

We can and probably should teach Squid to bump and tunnel stared at
connections as needed (I bet this can be done within the current
configuration paradigm). However, this does not help with distinguishing
two valid "continue" actions (peek at the server vs. stare at the
server). The admin has to tell Squid what to do (either peek or stare).
A single "continue" action does not/cannot carry that information.


>>>> The configuration directives as I proposed are IMO intuitive and
>>>> leave very little room for misunderstandings.
>>
>> ... if you use them correctly. However, the same is true for the current
>> directives so this is not really an illustration of improvement AFAICT.
>> For example, what does the following [mis]configuration do?
>>
>>   https_decryption off
>>   tls_server_hello continue
>>   tls_server_hello terminate hacked_server
>>   https_decryption on
>>   tls_client_hello continue
>>   tls_client_hello passthrough banks

> You are good in finding examples of nonsense configurations :-)

I am just thinking from a confused user point of view. All the proposals
I have seen so far do not help much (and may hurt) when the admin
already knows what she is doing. To justify a configuration change, an
example has to illustrate an important _difference_ for a [confused]
user rather than just illustrate the new configuration.


> the config can just have a list
> of rules and instead of Squid obeying the order of the TLS rules at
> all times, it can gain intelligence and at the time that Squid is done
> reading the configuration, validates whatever it can validate and makes
> the decisions about which acls are executed/verified at what time (and
> also does some runtime checks at the appropriate times).

This "intelligence gathering" cannot gather much information because
Squid cannot evaluate most ACLs outside a specific transaction context.

Also, it might be important to emphasize the primary point of ordered
rules (in general): Squid and lots of other software use ordered rules
not because they want to force the admin to think in some specific
"steps" order. They use ordered rules to implement the "else" logic. If
rules are unordered, then to implement "if A then splice else bump"
logic, one has to write "If A then splice. If !A then bump". This
duplication of ACLs leads to configuration bugs and performance waste
(among other bad things).

This order support is why I wrote "elsif" in my earlier three-action
sketch instead of just writing "if" three times.


> So the config for 'bump all except banks' could look like this:
> tls decryption on
> tls default bump
> tls splice banks
> tls terminate clients_from_subnet_x
> tls terminate hacked_server
> tls splice no_http_protocol_inside_tls_wrapper  # default
> tls splice no_tls_protocol                      # default
> tls terminate tls_without_sni
> 
> The above is elegant and I think that the required intelligence to
> decide to evaluate which rule at what step is not impossible.

This is already 90% supported AFAICT:

+ Squid already skips ssl_bump directives with currently impossible
actions and does not require explicit steps. The above config can be
written almost as is using the current configuration approach and almost
everything will "work" as intended (see the two bullets below for
exceptions).

- One invisible part of your example is not supported: There is
currently no way for an ACL to trigger a peeking or staring action to
gather more information. Whether it is a good idea to add ACLs with such
side effects is an open question. *If* they are added, the above
configuration will work with just one last minor change:

- The "tls default bump" has to be listed as the last "tls bump all"
rule. Adding a special "default" rule is also possible, of course, but I
doubt that it is a good idea because admins are already used to
ACL-driven rules to end with the default action.

Your own "splice ... # default" rules that contradict the "default bump"
setting is also a good illustration why a dedicated default directive
may not be a good idea -- there are often many "defaults" because Squid
"default" action often depends on the current transaction context.



> Squid must not allow a mix of 'tls decryption on' and
> 'tls decryption off'.

Mixtures can be prohibited but such prohibitions often create problems
for [partially-generated] configurations. IMO, a better approach is to
infer whether "decryption" (whatever it is) is needed based on the
actual rules. This is what the current implementation does.


> Simple examples like above 'work'.  The question is if it
> is possible for Squid to detect most or all nonsense configurations

I know the answer to that question: "No". Complex actions like bumping
traffic require human intelligence. Squid will not be able to detect
bugs in advanced human thinking (in the foreseeable future). You cannot
make complex bumping both highly configurable and fool-proof. If you
want a fool-proof solution, I know of three possible ways:

* Reduction: Drastically reduce the number of supported configurations
and uses. Support just a few simple fool-proof cases. I think this
solution is unacceptable for a product like Squid and for a complex area
such as SSL bumping.

* Wizard: Provide an intelligent configuration generator/wizard which
asks admins some questions and then generates a valid squid.conf snippet
while guiding and educating the admin. A wizard may also evaluate a
given configuration, with human assistance (a much harder but not
impossible task). No Squid changes are necessary.

* Shim: Provide a set of simple new directives that cover basic bumping
needs. Internally, these directives are mapped to the already supported
"power-user" configuration. Admins using the new directives will not be
allowed to add old/power-user directives into the mix (i.e., the two
sets of directives will be mutually exclusive). This is a good approach
*if* we can come up with new fool-proof directives that cover many
bumping needs well.


Currently, this thread appears to be focused on another alternative:
Replacing the current set of directives with a much simpler one while
supporting the same functionality. This is an honorable goal, but I do
not think you can sneak "detection of most nonsense configurations" into
that. If the latter is your goal, see the three items above.


HTH,

Alex.


From rousskov at measurement-factory.com  Mon Nov 28 21:46:15 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Mon, 28 Nov 2016 14:46:15 -0700
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
Message-ID: <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>

On 11/25/2016 06:39 AM, Amos Jeffries wrote:
> On 25/11/2016 11:50 p.m., Christos Tsantilas wrote:
>> I have problems to run latest squid-5. The reason looks that it is the
>> r14954, which removes old GnuRegex and uses the std::regex API.
>>
>> The std::regex supported from gcc-4.9 and latest releases and I am still
>> using an gcc-4.8.4 on my kubuntu-14.04 LTS release.

> I think GCC 5 is going to be the minimum for Squid-5.

Why was a change with such serious known consequences committed without
any discussion on squid-dev?


> Despite the unreasonableness I'm procrastinating as much as I can to
> balance the overlap of timelines. 

The decision what goes into trunk, v5, or whatever you call the master
branch should be done by the community. We should be discussing the pros
and cons of dropping libregex support and requiring GCC v5 now, not
waking up with a master branch that we cannot use without painful
environment changes.

v5 r14954 commit message does not document any benefits except reducing
headaches associated with supporting [custom] regex libraries. And even
that benefit is partially offset by headaches associated with upgrading
from custom regex libraries. There is no indication that the new
STL-dependent implementation has been tested to be at least as fast as
the old code. And no warning that some regular expressions are no longer
supported.

Please undo that commit and let's discuss whether switching from
libregex to std::regex now is a good idea.


Thank you,

Alex.


From marcus.kool at urlfilterdb.com  Mon Nov 28 22:21:30 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Mon, 28 Nov 2016 20:21:30 -0200
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
Message-ID: <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>



On 11/28/2016 07:46 PM, Alex Rousskov wrote:
> Please undo that commit and let's discuss whether switching from
> libregex to std::regex now is a good idea.
>
>
> Thank you,
>
> Alex.

Has anybody considered using RE2?
It is a regex library that is fast, C++ source, high quality, public domain, and is supported by older compilers.

Marcus

From marcus.kool at urlfilterdb.com  Mon Nov 28 22:26:34 2016
From: marcus.kool at urlfilterdb.com (Marcus Kool)
Date: Mon, 28 Nov 2016 20:26:34 -0200
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <519575ab-1317-bd07-fcb7-f2a994065ed8@measurement-factory.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>
 <0d79f393-fb4a-6f46-14cc-0481149c505a@urlfilterdb.com>
 <519575ab-1317-bd07-fcb7-f2a994065ed8@measurement-factory.com>
Message-ID: <11fb5eb2-57b9-1e2d-25eb-866b3da9e906@urlfilterdb.com>



On 11/28/2016 03:58 PM, Alex Rousskov wrote:
> On 11/28/2016 06:30 AM, Marcus Kool wrote:
>> On 11/27/2016 11:20 PM, Alex Rousskov wrote:
>>> It would be nice to prohibit truly impossible actions at the syntax
>>> level, but I suspect that the only way to make that possible is to focus
>>> on final actions [instead of steps] and require at *most* one ssl_bump
>>> rule for each of the supported final actions:
>>>
>>>   ssl_bump splice    ...rules that define when to splice...
>>>   ssl_bump bump      ...rules that define when to bump...
>>>   ssl_bump terminate ...rules that define when to terminate...
>>>   # no other ssl_bump lines allowed!
>>>
>>> The current intermediate actions (peek and stare) would have to go into
>>> the ACLs. There will be no ssl_bump rules for them at all. In other
>>> words, the admin would be required to _always_ write an equivalent of
>>>
>>>   if (a1() && a2() && ...)
>>>   then
>>>       splice
>>>   elsif (b1() && b2() && ...)
>>>   then
>>>       bump
>>>   elsif (c1() && c2() && ...)
>>>   then
>>>       terminate
>>>   else
>>>       splice or bump, depending on state
>>>       (or some other default; this decision is secondary)
>>>   endif
>>>
>>> where a1(), b2(), and other functions/ACLs may peek or stare as needed
>>> to get the required information.
>
>> The above if-then-else tree is clear.
>
> It is clear at the top level. I am not sure we can also make the
> secondary level (i.e., intermediate peak/state actions) clear because
> they have to be side effects in this design and side effects are rarely
> clear. We can try though.
>
>
>> I like your suggestion to drop steps in the configuration and make
>> Squid more intelligent to take decisions at the appropriate
>> moments (steps).
>
> Please note that the current configuration does not contain implicit
> steps either; in its spirit/intent, it is essentially the same as the
> above three-action sketch. Needless to say, most correct configurations
> do contain an explicit step ACL or two, but they are supposed to be used
> to essentially implement the above three-action logic.
>
> Also, to avoid misunderstanding, I am not (yet) advocating any specific
> configuration approach, including the one I started to sketch above. I
> am only documenting a possible solution to the "How to make impossible
> actions invalid at the syntax level" problem you have raised.

Yeah, I used a bit optimistic wording.  It cannot be solved at the syntax
level, but should be possible at the semantic level.

>> You mentioned admins being surprised about Squid bumping for a
>> notification of an error and one way to improve that is to replace
>> 'terminate' by 'terminate_with_error' (with bumping) and 'quick_terminate'
>> (no bumping, just close fd).  The quick_terminate, if used, is also
>> faster, which is an added benefit.

I replied to the item where admins get confused when Squid bumps
to generate an error and suggested a way to control the behavior
of Squid to terminate instead of bump and generate an error.

> Terminate is always an instant TCP connection closure, without any
> bumping and without any errors being delivered to the user.
>
> AFAIK, admins are not surprised by bumping when a terminate rule matches
> (that would be a Squid bug). Admins are surprised by bumping when a
> splice, peek, or stare rule matches. That surprise is a different
> problem (that we should also try to solve, of course -- see the three
> "core problem" bullets in my original response).


>
>> The only comment that I want to make without starting a
>> new thread is that I think that conceptual terms are better
>> than technical terms (hence my preference for 'passthrough'
>> instead of 'splice').  But let's save this discussion for later.
>
> Personally, I doubt we should spend much time discussing whether
> "passthrough" is better than "splice", but I agree that nobody should be
> discussing naming until the much bigger (and, hopefully, solvable)
> problems are solved.
>
>
>>> I suspect that not looking at some SSL Hellos will always be needed
>>> because some of those Hellos are not Hellos at all and it takes too much
>>> time/resources for the SSL Hellos parser to detect some non-SSL Hellos.
>>> Besides that, it is always nice to be able to selectively bypass the
>>> complex Hello parser code in emergencies.
>
>
>> Perhaps less resources are used if there is a two-stage parser:
>> 1) quick scan of input for data layout of a ClientHello
>> 2) do the complex parsing.
>
> Squid v4 already uses a two-stage Hello parser (the first stage is built
> into Squid and the second stage is provided by OpenSSL).
>
> You are oversimplifying the general protocol recognition problem because
> you are focusing of the trivial cases. For example, one of the reasons
> the first-stage parser cannot be always "quick" is because, in some
> cases, there is no data to parse -- the server has to speak before the
> client will send anything. Another example is SSL-like traffic that is
> not really SSL. And a third example is Squid/OpenSSL limitations in
> handling advanced valid SSL traffic. In summary, there will always be a
> need for bypass IMO.

I am not suggesting to drop a bypass.
The comment was about the fact that determination if data from a client
is a syntactically valid ClientHello message should be quick and without
use of OpenSSL functions.  Since I do not know all SSL-like traffic of
all applications it is open for debate if it is possible, but I remain
optimistic that it can be done.

When a server sends data first, it is not a TLS handshake.
So when a server sends data first, Squid knows quickly (if the server
is quick) that the connection is not a TLS connection, right?

>>>>> 3) the "TLS server hello" step:
>
>>> all proposals have to decide how to distinguish stare from peek
>>> during step2. Those two intermediate actions result in different bytes
>>> on the wire so they cannot be mapped to a single verb like "continue".
>
>> An issue that complicates things is an "impossible decision",
>> the desire to splice when "it is too late".  I suggest to
>> solve this issue by simply splicing a bumped connection.
>
> We can and probably should teach Squid to bump and tunnel stared at
> connections as needed (I bet this can be done within the current
> configuration paradigm). However, this does not help with distinguishing
> two valid "continue" actions (peek at the server vs. stare at the
> server). The admin has to tell Squid what to do (either peek or stare).
> A single "continue" action does not/cannot carry that information.

It can help.  Suppose one want to make a decision based on the server
certificate, then currently one must use stare at step2 and currently
this has a limitation that it cannot be spliced at step3.
With a splice-bumped-connections feature this issue is resolved by
staring at step2 and make a splice-or-bump decision at step3.
So the decision that currently is enforced at step2 can be postponed
by doing a 'continue' and decide at step3.

>>>>> The configuration directives as I proposed are IMO intuitive and
>>>>> leave very little room for misunderstandings.
>>>
>>> ... if you use them correctly. However, the same is true for the current
>>> directives so this is not really an illustration of improvement AFAICT.
>>> For example, what does the following [mis]configuration do?
>>>
>>>   https_decryption off
>>>   tls_server_hello continue
>>>   tls_server_hello terminate hacked_server
>>>   https_decryption on
>>>   tls_client_hello continue
>>>   tls_client_hello passthrough banks
>
>> You are good in finding examples of nonsense configurations :-)
>
> I am just thinking from a confused user point of view. All the proposals
> I have seen so far do not help much (and may hurt) when the admin
> already knows what she is doing. To justify a configuration change, an
> example has to illustrate an important _difference_ for a [confused]
> user rather than just illustrate the new configuration.
>
>
>> the config can just have a list
>> of rules and instead of Squid obeying the order of the TLS rules at
>> all times, it can gain intelligence and at the time that Squid is done
>> reading the configuration, validates whatever it can validate and makes
>> the decisions about which acls are executed/verified at what time (and
>> also does some runtime checks at the appropriate times).
>
> This "intelligence gathering" cannot gather much information because
> Squid cannot evaluate most ACLs outside a specific transaction context.
>
> Also, it might be important to emphasize the primary point of ordered
> rules (in general): Squid and lots of other software use ordered rules
> not because they want to force the admin to think in some specific
> "steps" order. They use ordered rules to implement the "else" logic. If
> rules are unordered, then to implement "if A then splice else bump"
> logic, one has to write "If A then splice. If !A then bump". This
> duplication of ACLs leads to configuration bugs and performance waste
> (among other bad things).
>
> This order support is why I wrote "elsif" in my earlier three-action
> sketch instead of just writing "if" three times.

Order is often important, but Squid can gain more
intelligence by upfront making decisions about which rules
get evaluated when.  For example, 'splice banks' can only be
done when the server_name is known so after a peek and can be skipped
when the server_name is not yet known.

>> So the config for 'bump all except banks' could look like this:
>> tls decryption on
>> tls default bump
>> tls splice banks
>> tls terminate clients_from_subnet_x
>> tls terminate hacked_server
>> tls splice no_http_protocol_inside_tls_wrapper  # default
>> tls splice no_tls_protocol                      # default
>> tls terminate tls_without_sni
>>
>> The above is elegant and I think that the required intelligence to
>> decide to evaluate which rule at what step is not impossible.
>
> This is already 90% supported AFAICT:
>
> + Squid already skips ssl_bump directives with currently impossible
> actions and does not require explicit steps. The above config can be
> written almost as is using the current configuration approach and almost
> everything will "work" as intended (see the two bullets below for
> exceptions).
>
> - One invisible part of your example is not supported: There is
> currently no way for an ACL to trigger a peeking or staring action to
> gather more information. Whether it is a good idea to add ACLs with such
> side effects is an open question. *If* they are added, the above
> configuration will work with just one last minor change:
>
> - The "tls default bump" has to be listed as the last "tls bump all"
> rule. Adding a special "default" rule is also possible, of course, but I
> doubt that it is a good idea because admins are already used to
> ACL-driven rules to end with the default action.
>
> Your own "splice ... # default" rules that contradict the "default bump"
> setting is also a good illustration why a dedicated default directive
> may not be a good idea -- there are often many "defaults" because Squid
> "default" action often depends on the current transaction context.

If you interpret 'tls default bump' as 'the objective is to bump'
and 'splice banks' as an exception to the default behavior, they do
not contradict.

IMO your 3-bullet list misses these:
* improve the syntax/rules since currently it confuses too many admins
* make the configuration simpler where an admin does not have
   to know many details of the TLS protocol.

The first bullet is why Amos and I tried to improve the
situation by syntactical changes.

The last bullet may also be interpreted as: make the config
rules simple for 95% of all sites and support optional complex rules
for the rest.

>> Squid must not allow a mix of 'tls decryption on' and
>> 'tls decryption off'.
>
> Mixtures can be prohibited but such prohibitions often create problems
> for [partially-generated] configurations. IMO, a better approach is to
> infer whether "decryption" (whatever it is) is needed based on the
> actual rules. This is what the current implementation does.
>
>
>> Simple examples like above 'work'.  The question is if it
>> is possible for Squid to detect most or all nonsense configurations
>
> I know the answer to that question: "No". Complex actions like bumping
> traffic require human intelligence. Squid will not be able to detect
> bugs in advanced human thinking (in the foreseeable future). You cannot
> make complex bumping both highly configurable and fool-proof. If you
> want a fool-proof solution, I know of three possible ways:
>
> * Reduction: Drastically reduce the number of supported configurations
> and uses. Support just a few simple fool-proof cases. I think this
> solution is unacceptable for a product like Squid and for a complex area
> such as SSL bumping.

An alternative for Reduction is a list of good examples (better than
wiki has).

> * Wizard: Provide an intelligent configuration generator/wizard which
> asks admins some questions and then generates a valid squid.conf snippet
> while guiding and educating the admin. A wizard may also evaluate a
> given configuration, with human assistance (a much harder but not
> impossible task). No Squid changes are necessary.

Would like to see that :-)

> * Shim: Provide a set of simple new directives that cover basic bumping
> needs. Internally, these directives are mapped to the already supported
> "power-user" configuration. Admins using the new directives will not be
> allowed to add old/power-user directives into the mix (i.e., the two
> sets of directives will be mutually exclusive). This is a good approach
> *if* we can come up with new fool-proof directives that cover many
> bumping needs well.

Shim is nice, but does not change the current situation for power-users.

> Currently, this thread appears to be focused on another alternative:
> Replacing the current set of directives with a much simpler one while
> supporting the same functionality. This is an honorable goal, but I do
> not think you can sneak "detection of most nonsense configurations" into
> that. If the latter is your goal, see the three items above.

Going back to your 3 bullets,
* Can you give an example of more dynamic ACLs?
   I am surprised that admins are surprised that Squid does server
   certificate validation.  Maybe document it better?
* the issue with price becomes less if splice-a-bumped-connection
   is implemented and also solves the problem of precluding future
   decisions.
* I suggest to document that Squid bumps a connection to send
   an error message.  Maybe error handling can be separated from
   the other ssl bump rules and have a list of acls on how to act
   (terminate or bump+error) in case there is an error.

Marcus

>
> HTH,
>
> Alex.

From squid3 at treenet.co.nz  Tue Nov 29 02:29:42 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 29 Nov 2016 15:29:42 +1300
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
Message-ID: <583CE815.2000503@treenet.co.nz>

Please note that GCC 4.8 is not capable of building correctly operating 
Squid-4 either. So its not a matter of GCC 4.8 vs Squid. It is a 
question of whether GCC 4.9 is still the newest available GCC on any OS. 
Sadly it seems needed still for CentOS 7 and probably RHEL 7 too.


On 29/11/2016 11:21 a.m., Marcus Kool wrote:
>
>
> On 11/28/2016 07:46 PM, Alex Rousskov wrote:
>> Please undo that commit and let's discuss whether switching from
>> libregex to std::regex now is a good idea.
>>
>>
>> Thank you,
>>
>> Alex.
>
> Has anybody considered using RE2?
> It is a regex library that is fast, C++ source, high quality, public 
> domain, and is supported by older compilers.

That one has not been investigated until just now, I took a brief look. 
The research and testing of this was done in 2008-2014 timeframe.

It looks to me like we cannot use RE2 without a wrapper layer. With v5 
using std::regex the library needs to implement the portable <regex> 
API, then it just needs to be linked in.

When I revert that patch as Alex requested we are back to being stuck 
with the GNURegex API. There are only two libraries I'm aware of 
implementing that API. The GnuRegex bundled with Squid which is horribly 
slow, and the modern version of that library which is available in 
Linux, BSD, etc as -lregex.

The std::regex is for most OS implemented using the libregex that was 
there anyway and probably already being linked to Squid as -lregex. The 
other cases it is supposed to be implemented by something faster, like 
libpcre. The benefits to Squid are that the API is standardized and we 
dont have to care about which library is linked any more. In all cases 
it should be using either the same library as before behind the STL API, 
or something better.

Amos


From rousskov at measurement-factory.com  Tue Nov 29 03:40:28 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Mon, 28 Nov 2016 20:40:28 -0700
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <583CE815.2000503@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
Message-ID: <07a89cb0-b693-f283-17b5-edce242649ac@measurement-factory.com>

On 11/28/2016 07:29 PM, Amos Jeffries wrote:
> GCC 4.8 is not capable of building correctly operating Squid-4

You have said that before, but in all such cases that I remember, the
reality was actually different. I do not know if something has changed
in v4 within the past month or so [but any such change should have been
discussed too].

Alex.


From noc at squid-cache.org  Tue Nov 29 07:36:22 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 29 Nov 2016 07:36:22 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2310?=
In-Reply-To: <1649269111.16.1480336473476.JavaMail.jenkins@buildmaster>
References: <1649269111.16.1480336473476.JavaMail.jenkins@buildmaster>
Message-ID: <2144993646.17.1480404982188.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/10/------------------------------------------
[...truncated 34531 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From christos at chtsanti.net  Tue Nov 29 07:46:58 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Tue, 29 Nov 2016 09:46:58 +0200
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <583CE815.2000503@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
Message-ID: <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>

On 29/11/2016 04:29 , Amos Jeffries wrote:
> Please note that GCC 4.8 is not capable of building correctly operating
> Squid-4 either. So its not a matter of GCC 4.8 vs Squid.

The 4.8 does not have any problem. I was doing all of my developments 
and tests using GCC-4.8 and never found a problem, an incompatibility 
something does not work well.

On my side I upgraded my development system, however this is not 
something which can be done without spending a lot of hours. Also maybe 
required to upgrade 1-2 virtual machines I am using.

We should define at least a warning period before applying such changes 
in squid.



> there anyway and probably already being linked to Squid as -lregex. The
> other cases it is supposed to be implemented by something faster, like
> libpcre. The benefits to Squid are that the API is standardized and we
> dont have to care about which library is linked any more. In all cases
> it should be using either the same library as before behind the STL API,
> or something better.

The regex library is small, it has a small number of API functions. And 
Personally I do not remember a case the regex causes problems.

Also, my opinion is that if pcre is faster we should consider to use 
them. At least have it as a todo.


>
> Amos

From garryd at comnet.uz  Tue Nov 29 09:51:20 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Tue, 29 Nov 2016 14:51:20 +0500
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
Message-ID: <1480413080.31040.24.camel@comnet.uz>

Hello,

Please review the attached patch prepared for r14958, it fixes the If-
None-Match processing (incorrect logging [1]) and the bug [2] report
4169 depending on the incorrect (IMO) behavior.

An If-None-Match request for a non-matched (ETag) but cached object
should be processed as normal HIT.

[1]http://lists.squid-cache.org/pipermail/squid-users/2016-November/01
3483.html
[2]http://bugs.squid-cache.org/show_bug.cgi?id=4169

Thanks.

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_if-none-match.patch
Type: text/x-patch
Size: 704 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161129/0a150e4f/attachment.bin>

From garryd at comnet.uz  Tue Nov 29 12:47:21 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Tue, 29 Nov 2016 17:47:21 +0500
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <1480413080.31040.24.camel@comnet.uz>
References: <1480413080.31040.24.camel@comnet.uz>
Message-ID: <1480423641.31040.34.camel@comnet.uz>

On Tue, 2016-11-29 at 14:51 +0500, Garri Djavadyan wrote:
> Hello,
> 
> Please review the attached patch prepared for r14958, it fixes the
> If-
> None-Match processing (incorrect logging [1]) and the bug [2] report
> 4169 depending on the incorrect (IMO) behavior.
> 
> An If-None-Match request for a non-matched (ETag) but cached object
> should be processed as normal HIT.
> 
> [1]http://lists.squid-cache.org/pipermail/squid-users/2016-November/
> 01
> 3483.html
> [2]http://bugs.squid-cache.org/show_bug.cgi?id=4169
> 
> Thanks.
> 
> Garri

I've attached second version of the patch. In the first version I
removed strings (not related to the fix) which mark a request as non-
IMS, because I thought the same request could not
enterprocessConditional twice and the removed actions are redundant.
Now I'm not sure about it.

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_if-none-match_v2.patch
Type: text/x-patch
Size: 466 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161129/028e9f22/attachment.bin>

From squid3 at treenet.co.nz  Tue Nov 29 18:22:25 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 30 Nov 2016 07:22:25 +1300
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <07a89cb0-b693-f283-17b5-edce242649ac@measurement-factory.com>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <07a89cb0-b693-f283-17b5-edce242649ac@measurement-factory.com>
Message-ID: <81fc29f0-0f32-4ab5-280f-19a94b26065c@treenet.co.nz>

On 29/11/2016 4:40 p.m., Alex Rousskov wrote:
> On 11/28/2016 07:29 PM, Amos Jeffries wrote:
>> GCC 4.8 is not capable of building correctly operating Squid-4
> 
> You have said that before, but in all such cases that I remember, the
> reality was actually different. I do not know if something has changed
> in v4 within the past month or so [but any such change should have been
> discussed too].
> 
> Alex.
> 

Coverity identifies 6 uninitialized objects and 4 memory leaks in the
STL templates when GCC 4.8 builds Squid-4.

We do have workarounds now for the missing libatomic and lambda
functionality.

There was something about the libc implementation of std::random as
well, but I've forgotten the specific details on that one (randomness
source not being exactly random?).

Amos


From noc at squid-cache.org  Tue Nov 29 18:36:07 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 29 Nov 2016 18:36:07 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2311?=
In-Reply-To: <2144993646.17.1480404982188.JavaMail.jenkins@buildmaster>
References: <2144993646.17.1480404982188.JavaMail.jenkins@buildmaster>
Message-ID: <1556886937.18.1480444567501.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/11/------------------------------------------
[...truncated 34536 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From rousskov at measurement-factory.com  Tue Nov 29 19:19:10 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 29 Nov 2016 12:19:10 -0700
Subject: [squid-dev] [RFC] simplifying ssl_bump complexity
In-Reply-To: <11fb5eb2-57b9-1e2d-25eb-866b3da9e906@urlfilterdb.com>
References: <820fc097-c480-5f4b-2d04-7647e829588f@treenet.co.nz>
 <b5b4c97b-dd64-92f1-dc65-83e8856ae8b9@urlfilterdb.com>
 <e0b94187-8a91-07d5-9294-cae6087212e4@treenet.co.nz>
 <c618a763-4b75-e01a-4811-d27a5aef3746@measurement-factory.com>
 <0d79f393-fb4a-6f46-14cc-0481149c505a@urlfilterdb.com>
 <519575ab-1317-bd07-fcb7-f2a994065ed8@measurement-factory.com>
 <11fb5eb2-57b9-1e2d-25eb-866b3da9e906@urlfilterdb.com>
Message-ID: <2fb5800f-ee1b-3162-623f-a7d28669ca8a@measurement-factory.com>

On 11/28/2016 03:26 PM, Marcus Kool wrote:

> The comment was about the fact that determination if data from a client
> is a syntactically valid ClientHello message should be quick

Unfortunately, it is not a fact. In simple cases, you are right (which
is why Squid v4 already uses a two-stage parser). In other cases, it may
cost time or even require taking some risks to make the "client speaks
TLS" determination. This is why bypass support is required _before_ any
TLS parsing starts.


> When a server sends data first, it is not a TLS handshake.

I am not sure that is 100% accurate because there could be TLS servers
that send the first byte(s) early (for some stupid reason), but even if
we are sure that such servers do not exist, Squid cannot know whether
the server is going to speak first unless Squid has _connected_ to the
server already (and waited for some time). In some cases, the admin does
not want Squid to contact the server (even at TCP level) until Squid is
sure that the connection is carrying TLS with validated SNI.


> So when a server sends data first, Squid knows quickly (if the server
> is quick) that the connection is not a TLS connection, right?

No quite, unfortunately. See my previous message and the above example
for the cases where nothing is quick or simple at the expected-TLS level.



>>>>>> 3) the "TLS server hello" step:
>>
>>>> all proposals have to decide how to distinguish stare from peek
>>>> during step2. Those two intermediate actions result in different bytes
>>>> on the wire so they cannot be mapped to a single verb like "continue".
>>
>>> An issue that complicates things is an "impossible decision",
>>> the desire to splice when "it is too late".  I suggest to
>>> solve this issue by simply splicing a bumped connection.
>>
>> We can and probably should teach Squid to bump and tunnel stared at
>> connections as needed (I bet this can be done within the current
>> configuration paradigm). However, this does not help with distinguishing
>> two valid "continue" actions (peek at the server vs. stare at the
>> server). The admin has to tell Squid what to do (either peek or stare).
>> A single "continue" action does not/cannot carry that information.

> Suppose one want to make a decision based on the server
> certificate, then currently one must use stare at step2 and currently
> this has a limitation that it cannot be spliced at step3.
> With a splice-bumped-connections feature this issue is resolved by
> staring at step2 and make a splice-or-bump decision at step3.

Yes, tunneling of bumped connections is useful in _some_ cases and
should be supported, but it does not eliminate the a peek-vs-stare
decision at step2. If you assume that it does eliminate that decision,
then you have to assume that bumping always works, which is obviously
not true.

* If Squid is talking to a server that cannot be successfully bumped,
the [future] support for tunneling of bumped connections does not help,
and the admin has to tell Squid to peek rather than stare.

* If Squid is talking to a server that can and should be successfully
bumped, the [future] support for tunneling of bumped connections helps,
but the admin has to tell Squid to stare rather than peek.

Thus, a single "continue" action does not work -- it will not
accommodate one of the two bullets above.

[ FWIW, I strongly discourage you from applying the term "splice" to
bumped connections -- it is easy to deceive oneself that staring is not
needed because all connections end up "spliced". I recommend saying
"tunneled" when talking about bumped connections passed through Squid
(as opposed to spliced connections passed through Squid). ]


> So the decision that currently is enforced at step2 can be postponed
> by doing a 'continue' and decide at step3.

AFAICT, your logic is missing the fact that, if step2 is not final, then
Squid has to do one of two actions during step2: stare or peek. Those
are different actions, resulting in different bytes on the wire. You
cannot postpone that peek-vs-stare decision until the final step3. Thus,
one "continue" action does not work.

Again, the requirement for two "continue" actions does not imply that
tunneling of bumped connections is not helpful in some cases!


> Squid can gain more
> intelligence by upfront making decisions about which rules
> get evaluated when.  For example, 'splice banks' can only be
> done when the server_name is known so after a peek and can be skipped
> when the server_name is not yet known.

That example does not compute for me: To know whether the server_name is
known, Squid has to evaluate the server_name ACL. If that evaluation is
possible, Squid should just use its result (and skip or honor the
"splice banks" rule) instead of speculating that the rule can be safely
skipped during step1.

In real configurations, most rules cannot be correctly evaluated outside
transaction context because they contain ACLs, such as the
ssl::server_name ACL, that are context-dependent.


>>> So the config for 'bump all except banks' could look like this:
>>> tls decryption on
>>> tls default bump
>>> tls splice banks
>>> tls terminate clients_from_subnet_x
>>> tls terminate hacked_server
>>> tls splice no_http_protocol_inside_tls_wrapper  # default
>>> tls splice no_tls_protocol                      # default
>>> tls terminate tls_without_sni

>> Your own "splice ... # default" rules that contradict the "default bump"
>> setting is also a good illustration why a dedicated default directive
>> may not be a good idea -- there are often many "defaults" because Squid
>> "default" action often depends on the current transaction context.

> If you interpret 'tls default bump' as 'the objective is to bump'
> and 'splice banks' as an exception to the default behavior, they do
> not contradict.

I do not think many reasonable people can interpret "... # default" as
"an exception to the default behavior" but YMMV.


>>> The question is if it
>>> is possible for Squid to detect most or all nonsense configurations

>> I know the answer to that question: "No". Complex actions like bumping
>> traffic require human intelligence. Squid will not be able to detect
>> bugs in advanced human thinking (in the foreseeable future). You cannot
>> make complex bumping both highly configurable and fool-proof. If you
>> want a fool-proof solution, I know of three possible ways:
>> 
>> * Reduction: Drastically reduce the number of supported configurations
>> and uses. Support just a few simple fool-proof cases. I think this
>> solution is unacceptable for a product like Squid and for a complex area
>> such as SSL bumping.
>> 
>> * Wizard: Provide an intelligent configuration generator/wizard which
>> asks admins some questions and then generates a valid squid.conf snippet
>> while guiding and educating the admin. A wizard may also evaluate a
>> given configuration, with human assistance (a much harder but not
>> impossible task). No Squid changes are necessary.
>> 
>> * Shim: Provide a set of simple new directives that cover basic bumping
>> needs. Internally, these directives are mapped to the already supported
>> "power-user" configuration. Admins using the new directives will not be
>> allowed to add old/power-user directives into the mix (i.e., the two
>> sets of directives will be mutually exclusive). This is a good approach
>> *if* we can come up with new fool-proof directives that cover many
>> bumping needs well.
>> 
>> 
>> Currently, this thread appears to be focused on another alternative:
>> Replacing the current set of directives with a much simpler one while
>> supporting the same functionality. This is an honorable goal, but I do
>> not think you can sneak "detection of most nonsense configurations" into
>> that. If the latter is your goal, see the three items above.


> IMO your 3-bullet list misses these:
> * improve the syntax/rules since currently it confuses too many admins
> * make the configuration simpler where an admin does not have
>   to know many details of the TLS protocol.

Please do not forget that the Reduction/Wizard/Shim bullets only apply
to your "detect most or all nonsense configurations" goal. What you are
probably implying above is covered by the "Replacing the current set of
directives with a much simpler one while supporting the same
functionality" paragraph after those bullets.


> The first bullet is why Amos and I tried to improve the
> situation by syntactical changes.

Not sure what you mean, but if "Reduction" (the first bullet) is your
preferred approach, then we are stuck because I find that approach
unacceptable for obvious (IMO) reasons.


> The last bullet may also be interpreted as: make the config
> rules simple for 95% of all sites and support optional complex rules
> for the rest.

I would not recommend that way of thinking/phrasing because it may imply
that an average admin will use a _mixture_ of directives from simple and
complex sets. If that is the result, you have accomplished nothing
because the current problems will continue to exist for that average
admin using complex directives (that he should avoid).

For the "Shim" approach to work, the set of simple directives should
satisfy 100% of an average admin needs so that an average admin does not
have to switch to (or, worse, mix in!) directives from the complex set.
A significant barrier should prevent an average admin from considering
using complex rules. The requirement to use complex rules for either
nothing or everything could be such a barrier.


>>> Simple examples like above 'work'.  The question is if it
>>> is possible for Squid to detect most or all nonsense configurations

>> I know the answer to that question: "No". Complex actions like bumping
>> traffic require human intelligence. Squid will not be able to detect
>> bugs in advanced human thinking (in the foreseeable future). You cannot
>> make complex bumping both highly configurable and fool-proof. If you
>> want a fool-proof solution, I know of three possible ways:
>>
>> * Reduction: Drastically reduce the number of supported configurations
>> and uses. Support just a few simple fool-proof cases. I think this
>> solution is unacceptable for a product like Squid and for a complex area
>> such as SSL bumping.

> An alternative for Reduction is a list of good examples (better than
> wiki has).

You may have missed the context of this Reduction bullet: A list of good
examples does not allow Squid to detect most or all nonsense configurations.


>> * Wizard: Provide an intelligent configuration generator/wizard which
>> asks admins some questions and then generates a valid squid.conf snippet
>> while guiding and educating the admin. A wizard may also evaluate a
>> given configuration, with human assistance (a much harder but not
>> impossible task). No Squid changes are necessary.

> Would like to see that :-)

Me too! FWIW, we have developed a somewhat similar configuration wizard
for Web Polygraph, and I am pretty sure it is possible to create one for
SslBump. The standard FAQ applies even though this project may not
require any Squid modifications:
http://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F


>> * Shim: Provide a set of simple new directives that cover basic bumping
>> needs. Internally, these directives are mapped to the already supported
>> "power-user" configuration. Admins using the new directives will not be
>> allowed to add old/power-user directives into the mix (i.e., the two
>> sets of directives will be mutually exclusive). This is a good approach
>> *if* we can come up with new fool-proof directives that cover many
>> bumping needs well.

> Shim is nice, but does not change the current situation for power-users.

True (but missing the context of these bullets again).


>> Currently, this thread appears to be focused on another alternative:
>> Replacing the current set of directives with a much simpler one while
>> supporting the same functionality. This is an honorable goal, but I do
>> not think you can sneak "detection of most nonsense configurations" into
>> that. If the latter is your goal, see the three items above.
> 
> Going back to your 3 bullets,

Your questions do not seem to be related to the bullets. I will answer
them in a general context:


> * Can you give an example of more dynamic ACLs?

For example, we can add a get_client_hello and get_server_hello ACLs
that will trigger a peeking or staring actions as necessary. They will
either always match or will match if the action was successful. The
get_server_hello ACL will need options to distinguish peeking from staring.

  acl got_client_hello get_client_hello
  acl client_goes_to_bank server_name ...

  ssl_bump splice got_client_hello client_goes_to_bank
  ssl_bump bump all

Needless to say, peeking/staring ACLs do not solve the "too late to
splice!" problem. For example, neither of the following examples
magically start to work:

  # XXX: One cannot tunnel after staring at the server:
  acl got_server_hello get_server_hello --stare
  acl server_uses_pinning server_name ...
  ssl_bump tunnel got_server_hello server_uses_pinning # XXX
  ssl_bump bump all

or

  # XXX: One cannot bump after peeking at the server:
  acl got_server_hello get_server_hello --peek
  acl server_uses_pinning server_name ...
  ssl_bump splice got_server_hello server_uses_pinning
  ssl_bump bump all # XXX


>   I am surprised that admins are surprised that Squid does server
>   certificate validation.  Maybe document it better?

Better documentation would not hurt but I do not know whether it will
help. Please note that it is not just validation that some admins find
surprising, it is bumping that follows unsuccessful validation. For
example, many think that this configuration will never bump, but IIRC,
it may if validation fails:

  ssl_bump peek all
  ssl_bump splice all


> * the issue with price becomes less if splice-a-bumped-connection
>   is implemented

Yes, but ...

>   and also solves the problem of precluding future decisions.

It does not fully solve that problem as discussed above (one "continue"
does not work).


> * I suggest to document that Squid bumps a connection to send
>   an error message.  Maybe error handling can be separated from
>   the other ssl bump rules and have a list of acls on how to act
>   (terminate or bump+error) in case there is an error.

The error handling is separated (took another fight or two IIRC).
However, there is currently no [convenient] way to terminate the
connection on errors. I agree that such a way should be added, but it is
tricky to do that well because Squid already has a similar TCP_RESET
knob tied to deny_info. A good solution would generalize that existing
functionality instead of creating a parallel control structure with
overlapping/conflicting scope.

Alex.


From squid3 at treenet.co.nz  Tue Nov 29 19:46:30 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 30 Nov 2016 08:46:30 +1300
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>
Message-ID: <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>

On 29/11/2016 8:46 p.m., Christos Tsantilas wrote:
> On 29/11/2016 04:29 , Amos Jeffries wrote:
>> Please note that GCC 4.8 is not capable of building correctly operating
>> Squid-4 either. So its not a matter of GCC 4.8 vs Squid.
> 
> The 4.8 does not have any problem. I was doing all of my developments
> and tests using GCC-4.8 and never found a problem, an incompatibility
> something does not work well.
> 
> On my side I upgraded my development system, however this is not
> something which can be done without spending a lot of hours. Also maybe
> required to upgrade 1-2 virtual machines I am using.

I'm thinking it might be useful to add a how-to in the release notes for
v4+ to make the compiler update easier. Would you be able to write that
now that you have gone through the process?

> 
> We should define at least a warning period before applying such changes
> in squid.

It seems I mis-remembered the decision. It was not just to delay to v5,
but until the compiler situation was resolved
<http://lists.squid-cache.org/pipermail/squid-dev/2015-July/002884.html> :-(

>From thread
<http://lists.squid-cache.org/pipermail/squid-dev/2015-July/002875.html>

I'm starting the merge revert now. It will go into v5 when the build
tests pass (a few hours).


> 
>> there anyway and probably already being linked to Squid as -lregex. The
>> other cases it is supposed to be implemented by something faster, like
>> libpcre. The benefits to Squid are that the API is standardized and we
>> dont have to care about which library is linked any more. In all cases
>> it should be using either the same library as before behind the STL API,
>> or something better.
> 
> The regex library is small, it has a small number of API functions. And
> Personally I do not remember a case the regex causes problems.
> 
> Also, my opinion is that if pcre is faster we should consider to use
> them. At least have it as a todo.

It is faster, but also has a different pattern syntax and API. So we
would need both a config directive to specify what syntax was in use and
a wrapper layer for portability.

Which is exactly what std::regex provides . Though I have not gone so
far as to add the config directive for changing the used syntax. It
makes a lot more sense to go through the transition pain once instead of
twice (GNURegex -> PCRE -> std::regex).

Amos


From rousskov at measurement-factory.com  Tue Nov 29 20:39:13 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 29 Nov 2016 13:39:13 -0700
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <81fc29f0-0f32-4ab5-280f-19a94b26065c@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <07a89cb0-b693-f283-17b5-edce242649ac@measurement-factory.com>
 <81fc29f0-0f32-4ab5-280f-19a94b26065c@treenet.co.nz>
Message-ID: <bcc1f7ac-8ce7-5fc1-ae51-a936c3c7cfc8@measurement-factory.com>

On 11/29/2016 11:22 AM, Amos Jeffries wrote:
> On 29/11/2016 4:40 p.m., Alex Rousskov wrote:
>> On 11/28/2016 07:29 PM, Amos Jeffries wrote:
>>> GCC 4.8 is not capable of building correctly operating Squid-4
>>
>> You have said that before, but in all such cases that I remember, the
>> reality was actually different. I do not know if something has changed
>> in v4 within the past month or so [but any such change should have been
>> discussed too].


> Coverity identifies 6 uninitialized objects and 4 memory leaks in the
> STL templates when GCC 4.8 builds Squid-4.

If Squid v4 built with GCC v4 leaks memory, then the leak should be
reported and Squid should be fixed. However, a leak in itself is
unlikely to be a sufficient criteria for "not capable of building"
categorization.


More importantly, given the lack of Project resources, we should
continue using two versions (stable + development). While nobody has the
energy or desire to fight your version increments and branch renaming, I
doubt many have 20+% spare time to start working on three increasingly
different branches/environments: "stable" v3, "current" v4, and "Amos
special" v5. You should not introduce significant barriers between v4
and v5 until v4 truly replaces v3 as the go-to stable branch. At the
very least, you should not introduce them without a discussion/consensus!

When v4 is stable and v3 is obsolete, let's discuss whether it is time
to require GCC v5 (and latest build environments) for master. Until
then, let's conserve resources for more important matters.

Alex.


From noc at squid-cache.org  Tue Nov 29 21:11:12 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Tue, 29 Nov 2016 21:11:12 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_4-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2312?=
In-Reply-To: <1556886937.18.1480444567501.JavaMail.jenkins@buildmaster>
References: <1556886937.18.1480444567501.JavaMail.jenkins@buildmaster>
Message-ID: <418382580.19.1480453872866.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/12/------------------------------------------
[...truncated 34537 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/4-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-4.0.16-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From squid3 at treenet.co.nz  Tue Nov 29 21:23:25 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 30 Nov 2016 10:23:25 +1300
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <1480423641.31040.34.camel@comnet.uz>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
Message-ID: <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>

On 30/11/2016 1:47 a.m., Garri Djavadyan wrote:
> On Tue, 2016-11-29 at 14:51 +0500, Garri Djavadyan wrote:
>> Hello,
>>
>> Please review the attached patch prepared for r14958, it fixes the
>> If-
>> None-Match processing (incorrect logging [1]) and the bug [2] report
>> 4169 depending on the incorrect (IMO) behavior.
>>
>> An If-None-Match request for a non-matched (ETag) but cached object
>> should be processed as normal HIT.
>>
>> [1] http://lists.squid-cache.org/pipermail/squid-users/2016-November/
>> 01
>> 3483.html
>> [2] http://bugs.squid-cache.org/show_bug.cgi?id=4169
>>
>> Thanks.
>>
>> Garri
> 
> I've attached second version of the patch. In the first version I
> removed strings (not related to the fix) which mark a request as non-
> IMS, because I thought the same request could not
> enter processConditional twice and the removed actions are redundant.
> Now I'm not sure about it.
> 

The logic looks a bit funky and that is probably a side effect of
RFC2616 confusion.

Checking this whole processConditional() sequence for compliance with
RFC 7232 and 7234 the rest of the logic seems to be fine except this case:

<https://tools.ietf.org/html/rfc7234#section-4.3.2>
"
   If the field-value is "*", or if the
   field-value is a list of entity-tags and at least one of them matches

[ e->hasIfNoneMatchEtag(r) == false --> !N == true ]

   the entity-tag of the selected stored response, a cache recipient
   SHOULD generate a 304 (Not Modified) response (using the metadata of
   the selected stored response) instead of sending that stored
   response.
"

so this is supposed to be a 304 response which is a HIT, perhapse with a
new 'INM' LogTag flag set to true.

Amos


From rousskov at measurement-factory.com  Tue Nov 29 22:42:11 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 29 Nov 2016 15:42:11 -0700
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
 <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
Message-ID: <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>

On 11/29/2016 02:23 PM, Amos Jeffries wrote:
> On 30/11/2016 1:47 a.m., Garri Djavadyan wrote:
>> On Tue, 2016-11-29 at 14:51 +0500, Garri Djavadyan wrote:
>>> Hello,
>>>
>>> Please review the attached patch prepared for r14958, it fixes the
>>> If-
>>> None-Match processing (incorrect logging [1]) and the bug [2] report
>>> 4169 depending on the incorrect (IMO) behavior.
>>>
>>> An If-None-Match request for a non-matched (ETag) but cached object
>>> should be processed as normal HIT.
>>>
>>> [1] http://lists.squid-cache.org/pipermail/squid-users/2016-November/013483.html
>>> [2] http://bugs.squid-cache.org/show_bug.cgi?id=4169

>> In the first version I
>> removed strings (not related to the fix) which mark a request as non-
>> IMS, because I thought the same request could not
>> enter processConditional twice and the removed actions are redundant.

I agree that the second version is better: Unless you are absolutely
sure, it is best to stay focused on the problem and leave the IMS
deletion code "as is" even if it may not be necessary. If you still
suspect it is not necessary, add a TODO comment to investigate separately.


> Checking this whole processConditional() sequence for compliance with
> RFC 7232 and 7234 the rest of the logic seems to be fine except this case:
> 
> <https://tools.ietf.org/html/rfc7234#section-4.3.2>
> "
>    If the field-value is "*", or if the
>    field-value is a list of entity-tags and at least one of them matches
>    the entity-tag of the selected stored response,

> [ e->hasIfNoneMatchEtag(r) == false --> !N == true ]

I am not sure I am interpreting your [...] mnemonic correctly, but
AFAICT, the patched code works when the RFC conditions quoted above are
_not_ meant:

>     if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
>         if (!e->hasIfNoneMatchEtag(r)) {
>             // RFC 2616: ignore IMS if If-None-Match did not match
>             r.flags.ims = false;
>             r.ims = -1;
>             r.imslen = 0;
>             r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
>             http->logType = LOG_TCP_MISS;
>             sendMoreData(result);
>             return true;
>         }


In other words, hasIfNoneMatchEtag() returns false and, hence, the
quoted code is executed when _none_ of the requested ETags matches the
cached ETag. The "if If-None-Match did not match" comment inside that
code agrees with this interpretation.

Thus, the recommended RFC action that you found does _not_ apply to the
fixed code:

>    a cache recipient
>    SHOULD generate a 304 (Not Modified) response (using the metadata of
>    the selected stored response) instead of sending that stored
>    response.
> "


If you were talking about processConditional() code outside the if
statement fixed by Garri (i.e., when hasIfNoneMatchEtag() returns true),
then it appears to match the quoted requirement only if there is no IMS
header:

> if (!r.flags.ims) {
>     // RFC 2616: if If-None-Match matched and there is no IMS,
>     // reply with 304 Not Modified or 412 Precondition Failed
>     sendNotModifiedOrPreconditionFailedError();
>     return true;
> }
> 
> // otherwise check IMS below to decide if we reply with 304 or 412
> matchedIfNoneMatch = true;


If there is an IMS header, then Squid violates the following RFC 7232 MUST:

> A recipient MUST ignore If-Modified-Since if the request contains an
> If-None-Match header field

The HTTP requirements changed here since RFC 2616, and we probably
should adjust the code to delete IMS header/flags after discovering the
If-None-Match header:

if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
    // RFC 7232: If-None-Match recipient MUST ignore IMS
    r.flags.ims = false;
    r.ims = -1;
    r.imslen = 0;
    r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);

    if (e->hasIfNoneMatchEtag(r)) {
        sendNotModifiedOrPreconditionFailedError();
        return true;
    }

    // If-None-Match did not match; treat as an unconditional hit
    return false;
}

If the above sketch is correct, then the matchedIfNoneMatch variable may
become unnecessary.


HTH,

Alex.


From squid3 at treenet.co.nz  Tue Nov 29 22:50:27 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 30 Nov 2016 11:50:27 +1300
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
 <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
Message-ID: <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>

On 28/11/2016 3:34 p.m., Alex Rousskov wrote:
> On 11/19/2016 02:15 AM, Amos Jeffries wrote:
>> On 19/11/2016 12:56 p.m., Eduard Bagdasaryan wrote:
>>> This patch introduces a new 'auth_schemes' squid.conf directive.
>>>
>>> This directive may be used to customize authentication
>>> schemes presence and order in Squid's HTTP 401 (Unauthorized) and 407
>>> (Proxy Authentication Required) responses. The defaults remain the same.
>>>
>>> Also refactored configuration code for options with custom
>>> ACL-controlled actions
> 
>> -1. This patch is conflating two major feature additions.
> 
> The patch does not add two major features. It only adds one regular feature.
> 
> 
>> The logic changes adding support for access controls 'kind' other than
>> allow/deny should be proposed as a separate feature addition.
> 
> Squid already supports many actions other than allow/deny. AFAIK, the
> proposed patch reduces code duplication in that existing code area while
> reusing the already working approach. No logic changes related to
> non-allow/deny actions are being proposed here. While splitting the code
> improvements from the new feature may be possible, their coexistence
> certainly does not warrant a -1 vote!
> 
> 
>> Secondly;
>>
>> IMO the access control for schemes is implemented wrong.
>>
>> For the past 10 years admin who have been requesting control over what
>> schemes get advertised to clients have been driven by two main use cases:
>>
>>  1) segmented networks where auth is done differently on each segment
>> (ie WAN vs LAN) but all segments share the one proxy.
>>  - either access controls to prevent some scheme being advertised to one
>> segment,
>>  - or being able to use one scheme name in several different ways
>> (different helper or realm etc.) .
> 
> 
> Or being able to control the order of schemes presented to the user.

Any HTTP client implementation which was coded to be properly compliant
with RFC 2616 and 2617 *will not* obey any ordering presented by Squid.
(Yes that was relaxed in RFC723x, but only to "ought to" and most
clients still obey the older MUST requirement).

We *already* have ordering ability in squid.conf. Many users have tried
to make use of it. The fact that it is not solving their issues is a
good demonstration about why/how the above RFC requirement is a killer
for any attempt to use ordering to control the clients behaviour.

IE6 was a notable exception that did follow the ordering when Basic was
first and why that ordering of auth_param was made significant back in
the early Squid-2.x sometime. It is now almost completely dead/absent as
a client though.

The current worst problem is Safari - for exactly the opposite reason.
It demonstrably ignores the list of schemes and uses only (and forever
looping) its first choice of "best" scheme. No others are considered nor
attempted.

I'm also aware of Firefix NTLM issues and Java, but those are not order
related. Are there any other client software with scheme ordering issues
I should be aware of?


> 
>> To resolve (1) fully we will need to have multiple Config objects with
>> the same scheme name and different config details.
> 
> The use cases covered by the proposed patch do not need different
> configurations for the same scheme.

Indeed, and that is probably why it works well for its own use cases.

> The proposed changes do not preclude
> such future support. Moreover, such future support will not address some
> of the use cases covered by the proposed patch. In other words, what has
> been implemented and your suggestion are complementary, not mutually
> exclusive.

For the use cases this patch resolves, that is true. For the other cases
my per-scheme ACLs proposal seeks to resolve as well, it is not.

We could add both ways. But that I expect will just lead to more
confusion. So lets try to avoid that.

> 
>> To add auth scheme access controls in a way that does not actively
>> prevent (1) from being implemented later IMO we need to add access
>> controls as a member of the Config object, *not* as a global access list.
> 
> Per-scheme access controls do not work for controlling the order of the
> presented schemes. The order is currently hard-coded. The proposed patch
> makes it configurable. Future patches may certainly add per scheme
> access controls and other knobs as needed. I see no reason why the two
> complementary mechanisms cannot coexist.

See above, ordering is provided already in current auth_param design.

My proposal uses that existing logic instead of adding a second config
setting that can contradict it and cause confusion.

For the uncommon case of needing different order of the same schemes for
different clients, multiple auth_param sections with different ACL lists
can be used. It is a little verbose, yes, but not a common need so as
you have argued in the past: we should not be optimizing for that type
of case at expense of the more common ones.


> 
> Also, while working on the proposed feature, we have discovered why
> adding per-scheme ACLs (or a special NONE value to auth_schemes) will
> create a negative side effect that the posted implementation avoids: The
> implemented code does not change authentication decision; auth_schemes
> cannot accidentally create a situation where no schemes exist for a
> transaction.

That is exactly the case in HTTP Authentication where 403 status code is
supposed to be used. It is explicitly one of the permitted auth states.

RFC 7231 section 6.5.3
"
   The 403 (Forbidden) status code indicates that the server understood
   the request but refuses to authorize it.
   ...

   If authentication credentials were provided in the request, the
   server considers them insufficient to grant access.  The client
   SHOULD NOT automatically repeat the request with the same
   credentials.  The client MAY repeat the request with new or different
   credentials.  However, a request might be forbidden for reasons
   unrelated to the credentials.
"

with some tie-in of "reasons unrelated" at the RFC 7235 section 2.1
final paragraph:
"
   HTTP does not restrict applications to this simple challenge-response
   framework for access authentication.  Additional mechanisms can be
   used, such as authentication at the transport level or via message
   encapsulation, and with additional header fields specifying
   authentication information.  However, such additional mechanisms are
   not defined by this specification.
"

Essentially anyone configuring these ACLs has constructed a non-standard
auth mechanism with additional special criteria surrounding the
credentials validity - and has told Squid how to process those extra
criteria in the form of ACL checks.


> Interpreting such a situation correctly is going to be
> tricky: Does it mean "allow access without authentication" or "deny
> access"? Or should Squid keep evaluating other http_access rules because
> the decision/ACLs may change later?

It means 403 Forbidden in HTTP terms.

IMO, that means in terms of ACLs a non-match has ocured for the auth ACL
being tested.

For the external ACL case any credentials the client did supply should
be able to pass in to the helper but not as %LOGIN / %un, that should be
'-'.


> 
> This "NONE" problem does not imply that multiple same-scheme
> configurations are a bad idea, of course. It only illustrates why the
> "Should I use this configuration for scheme X?" and "What schemes should
> I use for this transaction?" are two different questions, each deserving
> an answer in various real-world situations.
> 
> Please reconsider your initial evaluation.

I have and still do not want to see this go in as one change.

I'm happy with the structural/internal part making non-allow/deny
actions possible anywhere. If that were split from the auth_schemes
directive part it could go in immediately without another review IMO.

Amos


From rousskov at measurement-factory.com  Wed Nov 30 01:11:55 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 29 Nov 2016 18:11:55 -0700
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
 <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
 <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>
Message-ID: <0abe1174-5046-3d92-fddb-57a9531b877f@measurement-factory.com>

On 11/29/2016 03:50 PM, Amos Jeffries wrote:
> On 28/11/2016 3:34 p.m., Alex Rousskov wrote:
>> Or being able to control the order of schemes presented to the user.

> Any HTTP client implementation which was coded to be properly compliant
> with RFC 2616 and 2617 *will not* obey any ordering presented by Squid.
> (Yes that was relaxed in RFC723x, but only to "ought to" and most
> clients still obey the older MUST requirement).

> IE6 was a notable exception that did follow the ordering when Basic was
> first and why that ordering of auth_param was made significant back in
> the early Squid-2.x sometime. It is now almost completely dead/absent as
> a client though.
> 
> The current worst problem is Safari - for exactly the opposite reason.
> It demonstrably ignores the list of schemes and uses only (and forever
> looping) its first choice of "best" scheme. No others are considered nor
> attempted.
> 
> I'm also aware of Firefix NTLM issues and Java, but those are not order
> related. Are there any other client software with scheme ordering issues
> I should be aware of?

I find it ironic that you need to ask for more issues after listing a
well known issue and indicating that the protocol requirements have been
relaxed. For me, your own response is a good illustration that ordering
control is [at least marginally] useful!


> We *already* have ordering ability in squid.conf. 

The existing ability is severely limited because it can accommodate at
most one unusual client. It is also rather awkward to configure.


> Many users have tried
> to make use of it. The fact that it is not solving their issues is a
> good demonstration about why/how the above RFC requirement is a killer
> for any attempt to use ordering to control the clients behaviour.

I am not sure how you reach that conclusion given the available
evidence. Yes, ordering alone cannot solve all the issues, but that does
not mean that properly supporting ACL-driven order is useless.

Said that, better ordering support is just one of several useful
properties of the proposed approach. Even if we are 100% positive that
nobody will ever need to control the order of schemes, the ability to
specify a list of schemes to use is still a nice/useful feature, and
will remain a nice/useful feature even after somebody adds support for
multiple configurations of the same scheme.


>>> To resolve (1) fully we will need to have multiple Config objects with
>>> the same scheme name and different config details.

>> The proposed changes do not preclude
>> such future support. Moreover, such future support will not address some
>> of the use cases covered by the proposed patch. In other words, what has
>> been implemented and your suggestion are complementary, not mutually
>> exclusive.

> For the use cases this patch resolves, that is true. 

IMO, my statement is true for all use cases, both use cases covered by
the patch and use cases not covered by the patch: The two areas are
complementary, not mutually exclusive, regardless of the use cases.


> For the other cases
> my per-scheme ACLs proposal seeks to resolve as well, it is not.

Which part of my statement is not true for those other cases?


> We could add both ways. But that I expect will just lead to more
> confusion. So lets try to avoid that.

I agree that supporting two partially overlapping ways to configure used
authentication schemes will cause some confusion in some cases, but I
disagree that it will be the only outcome. The positive outcomes of
supporting both explicit scheme lists and multiple scheme configurations
outweigh the negatives IMO.

However, we can and should also prevent any overlaps in coverage! The
already implemented code can be used to control scheme presence [and
order] while the proposed future code will control which configuration
is used for each used scheme. That divide-and-concur is the right/best
approach here. I should have thought of that earlier, but, fortunately,
this realization does not affect auth_schemes.


> My proposal uses that existing logic instead of adding a second config
> setting that can contradict it and cause confusion.

If your proposal implementation is limited to scheme configuration
selection (among multiple configurations for the same scheme), then
there will be no contradiction and confusion. Each feature will control
its own area.

* Want to control which schemes are used for transaction X?
  Use the implemented auth_schemes.

* Want to control which scheme configuration is used for used scheme S?
  Use [future feature].


> For the uncommon case of needing different order of the same schemes for
> different clients, multiple auth_param sections with different ACL lists
> can be used. It is a little verbose, yes, but not a common need so as
> you have argued in the past: we should not be optimizing for that type
> of case at expense of the more common ones.

The implemented auth_schemes optimize a common case AFAICT. The future
scheme configuration selection code can also optimize its common case.
The features do not need to overlap, and each can focus on optimizing
its area.


>> Also, while working on the proposed feature, we have discovered why
>> adding per-scheme ACLs (or a special NONE value to auth_schemes) will
>> create a negative side effect that the posted implementation avoids: The
>> implemented code does not change authentication decision; auth_schemes
>> cannot accidentally create a situation where no schemes exist for a
>> transaction.

> That is exactly the case in HTTP Authentication where 403 status code is
> supposed to be used. It is explicitly one of the permitted auth states.

Explicitly forbidding access and wanting to authenticate but implicitly
running out of authentication schemes are very different cases. We
should not duplicate http_access functionality in auth_schemes or the
future scheme configuration selection code IMO. If an admin wants to
forbid access, they should use appropriate tools without worrying that
their complex scheme configuration ACLs may also accidentally select no
usable schemes and stub them in the back.



>>  The
>> "Should I use this configuration for scheme X?" and "What schemes should
>> I use for this transaction?" are two different questions, each deserving
>> an answer in various real-world situations.

The above is still a good summary of why you should not block
auth_schemes because you want Squid to support multiple scheme
configurations in the future. Prior to this email, I thought that what
you are proposing and what we have implemented can overlap. Now I am
fairly certain that they should not overlap but should complement each
other. In other words, they should be orthogonal questions/answers/features.


>> Please reconsider your initial evaluation.
> 
> I have and still do not want to see this go in as one change.
> 
> I'm happy with the structural/internal part making non-allow/deny
> actions possible anywhere. If that were split from the auth_schemes
> directive part it could go in immediately without another review IMO.

Sure it can, but the deadlock is not in those code polishing changes. Do
you still block auth_schemes, even if it is committed separately from
those polishing changes? Or does your "as one change" imply that you are
removing your objection to auth_schems as such if it is committed
separately from the polishing changes?


Thank you,

Alex.


From squid3 at treenet.co.nz  Wed Nov 30 03:35:45 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 30 Nov 2016 16:35:45 +1300
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <0abe1174-5046-3d92-fddb-57a9531b877f@measurement-factory.com>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
 <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
 <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>
 <0abe1174-5046-3d92-fddb-57a9531b877f@measurement-factory.com>
Message-ID: <53866c4b-5b37-27bb-1f22-ad5e2893a005@treenet.co.nz>

On 30/11/2016 2:11 p.m., Alex Rousskov wrote:
> On 11/29/2016 03:50 PM, Amos Jeffries wrote:
>> On 28/11/2016 3:34 p.m., Alex Rousskov wrote:
>>> Or being able to control the order of schemes presented to the user.
> 
>> Any HTTP client implementation which was coded to be properly compliant
>> with RFC 2616 and 2617 *will not* obey any ordering presented by Squid.
>> (Yes that was relaxed in RFC723x, but only to "ought to" and most
>> clients still obey the older MUST requirement).
> 
>> IE6 was a notable exception that did follow the ordering when Basic was
>> first and why that ordering of auth_param was made significant back in
>> the early Squid-2.x sometime. It is now almost completely dead/absent as
>> a client though.
>>
>> The current worst problem is Safari - for exactly the opposite reason.
>> It demonstrably ignores the list of schemes and uses only (and forever
>> looping) its first choice of "best" scheme. No others are considered nor
>> attempted.
>>
>> I'm also aware of Firefix NTLM issues and Java, but those are not order
>> related. Are there any other client software with scheme ordering issues
>> I should be aware of?
> 
> I find it ironic that you need to ask for more issues after listing a
> well known issue and indicating that the protocol requirements have been
> relaxed. For me, your own response is a good illustration that ordering
> control is [at least marginally] useful!
> 

No irony intended. If those are the only things driving the need for
ordering then we should probably drop order considerations entirely.

Considering just the allow/deny decision about whether any particular
scheme configuration should be used on a given request my proposal would
be the simplest implementation;

 one checklist object created outside the fixHeader() loop,
 fastCheck() the relevant access list for active schemes,
   continue the loop on denials,
 if no auth headers added when the loop ends,
   change status code to 403.

10-20 lines of code IIRC and about the same in docs text.

> 
>> We *already* have ordering ability in squid.conf. 
> 
> The existing ability is severely limited because it can accommodate at
> most one unusual client. It is also rather awkward to configure.
> 

Which appears to be IE and IE alone AFAIK. So nothing much gained by a
change there.

> 
>> Many users have tried
>> to make use of it. The fact that it is not solving their issues is a
>> good demonstration about why/how the above RFC requirement is a killer
>> for any attempt to use ordering to control the clients behaviour.
> 
> I am not sure how you reach that conclusion given the available
> evidence. Yes, ordering alone cannot solve all the issues, but that does
> not mean that properly supporting ACL-driven order is useless.
> 
> Said that, better ordering support is just one of several useful
> properties of the proposed approach. Even if we are 100% positive that
> nobody will ever need to control the order of schemes, the ability to
> specify a list of schemes to use is still a nice/useful feature, and
> will remain a nice/useful feature even after somebody adds support for
> multiple configurations of the same scheme.
> 
> 
>>>> To resolve (1) fully we will need to have multiple Config objects with
>>>> the same scheme name and different config details.
> 
>>> The proposed changes do not preclude
>>> such future support. Moreover, such future support will not address some
>>> of the use cases covered by the proposed patch. In other words, what has
>>> been implemented and your suggestion are complementary, not mutually
>>> exclusive.
> 
>> For the use cases this patch resolves, that is true. 
> 
> IMO, my statement is true for all use cases, both use cases covered by
> the patch and use cases not covered by the patch: The two areas are
> complementary, not mutually exclusive, regardless of the use cases.
> 
> 
>> For the other cases
>> my per-scheme ACLs proposal seeks to resolve as well, it is not.
> 
> Which part of my statement is not true for those other cases?

The part about them not being "complementary, not mutually exclusive".

They are mutually interferring on what would seem a reasonably average
config:

 auth_param basic ...
 auth_param ntlm ...
 auth_param ntlm access allow localhost

 auth_schemes ntlm,basic localnet
 auth_schemes basic,ntlm all

WTF?!! only Basic ever gets used.


Or one would think from the above that 'only Negotiate' would be the
outcome in this equivalent config:

 auth_param negotiate ...
 auth_param ntlm ...
 auth_param ntlm access allow localhost

 auth_schemes ntlm,negotiate localnet
 auth_schemes negotiate,ntlm all

Nope, NTLM gets used now. Even when its not offered (ie non-localhost
traffic).


Now some future code of an entirely different sort can fix that, but we
would still have a period of confusion to go through meanwhile.

And if we don't care about ordering (from up top reasons). Then which of
the two access lists gets implemented right away does not matter much.

> 
>> We could add both ways. But that I expect will just lead to more
>> confusion. So lets try to avoid that.
> 
> I agree that supporting two partially overlapping ways to configure used
> authentication schemes will cause some confusion in some cases, but I
> disagree that it will be the only outcome. The positive outcomes of
> supporting both explicit scheme lists and multiple scheme configurations
> outweigh the negatives IMO.

AFAICT we have pretty much narrowed the positives down to this patch
allowing multiple orderings of schemes. With accompanying evidence that
ordering is largely useless.

So no I dont agree at present that the positives outweight the
negatives. It is only outweighing the status-quo.

> 
> However, we can and should also prevent any overlaps in coverage! The
> already implemented code can be used to control scheme presence [and
> order] while the proposed future code will control which configuration
> is used for each used scheme. That divide-and-concur is the right/best
> approach here. I should have thought of that earlier, but, fortunately,
> this realization does not affect auth_schemes.
> 
>> My proposal uses that existing logic instead of adding a second config
>> setting that can contradict it and cause confusion.
> 
> If your proposal implementation is limited to scheme configuration
> selection (among multiple configurations for the same scheme), then
> there will be no contradiction and confusion. Each feature will control
> its own area.
> 
> * Want to control which schemes are used for transaction X?
>   Use the implemented auth_schemes.
> 
> * Want to control which scheme configuration is used for used scheme S?
>   Use [future feature].
> 
> 
>> For the uncommon case of needing different order of the same schemes for
>> different clients, multiple auth_param sections with different ACL lists
>> can be used. It is a little verbose, yes, but not a common need so as
>> you have argued in the past: we should not be optimizing for that type
>> of case at expense of the more common ones.
> 
> The implemented auth_schemes optimize a common case AFAICT. The future
> scheme configuration selection code can also optimize its common case.
> The features do not need to overlap, and each can focus on optimizing
> its area.
> 
> 
>>> Also, while working on the proposed feature, we have discovered why
>>> adding per-scheme ACLs (or a special NONE value to auth_schemes) will
>>> create a negative side effect that the posted implementation avoids: The
>>> implemented code does not change authentication decision; auth_schemes
>>> cannot accidentally create a situation where no schemes exist for a
>>> transaction.
> 
>> That is exactly the case in HTTP Authentication where 403 status code is
>> supposed to be used. It is explicitly one of the permitted auth states.
> 
> Explicitly forbidding access and wanting to authenticate but implicitly
> running out of authentication schemes are very different cases. We

Running out of usable schemes is just non-credential criteria and may be
based on other header values ACL matching, not very different case at all.


> should not duplicate http_access functionality in auth_schemes or the

This is not http_access functaionality. This is the 403 response from
authentication attempt. With auth-failed status codes being 401 (www
credentials), 407 (proxy credentials) and 403 (other auth criteria).


> 
>>>  The
>>> "Should I use this configuration for scheme X?" and "What schemes should
>>> I use for this transaction?" are two different questions, each deserving
>>> an answer in various real-world situations.
> 
> The above is still a good summary of why you should not block
> auth_schemes because you want Squid to support multiple scheme
> configurations in the future. Prior to this email, I thought that what
> you are proposing and what we have implemented can overlap. Now I am
> fairly certain that they should not overlap but should complement each
> other. In other words, they should be orthogonal questions/answers/features.
> 

I've taken another read of the patch and am leaning towards agreeing to
the above separation despite what I think is a very limited gain.
  The docs will need to reflect that scoping.

Though I do think my proposal would prove to be more efficient if we can
put together some tests for comparing the two.

> 
>>> Please reconsider your initial evaluation.
>>
>> I have and still do not want to see this go in as one change.
>>
>> I'm happy with the structural/internal part making non-allow/deny
>> actions possible anywhere. If that were split from the auth_schemes
>> directive part it could go in immediately without another review IMO.
> 
> Sure it can, but the deadlock is not in those code polishing changes. Do
> you still block auth_schemes, even if it is committed separately from
> those polishing changes? Or does your "as one change" imply that you are
> removing your objection to auth_schems as such if it is committed
> separately from the polishing changes?
> 

I still want the split. If it helps clarify my reasons are basically;

 The new directive is UI change so is a v5 feature, excluded from v4 due
to where we are at in the release cycle.

 But the structural changes should probably still end up in v4 to
minimize future portage pain around all the other access controls touched.

 Also, each part is likely to result in (or allow fixing) different
types of bugs. The new directive in specifically auth related issues,
and the structural change more widespread ACL processing issues.


Amos


From rousskov at measurement-factory.com  Wed Nov 30 07:06:57 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 30 Nov 2016 00:06:57 -0700
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <53866c4b-5b37-27bb-1f22-ad5e2893a005@treenet.co.nz>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
 <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
 <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>
 <0abe1174-5046-3d92-fddb-57a9531b877f@measurement-factory.com>
 <53866c4b-5b37-27bb-1f22-ad5e2893a005@treenet.co.nz>
Message-ID: <0b9552d0-381b-2223-a42d-d04fda0b9c7d@measurement-factory.com>

On 11/29/2016 08:35 PM, Amos Jeffries wrote:
> Considering just the allow/deny decision about whether any particular
> scheme configuration should be used on a given request my proposal would
> be the simplest implementation;
> 
>  one checklist object created outside the fixHeader() loop,
>  fastCheck() the relevant access list for active schemes,
>    continue the loop on denials,
>  if no auth headers added when the loop ends,
>    change status code to 403.

If we

* want to add 403 support as a side effect of running out of
authentication schemes (rather difficult to configure explicitly because
the decision to send 403 has to be made repeatedly for each scheme!),

* want to make configuring simple scheme lists more difficult, and

* do not want to improve scheme order support,

then the per-scheme access list is indeed a better approach! You are
essentially trading admin convenience/sanity for ease of implementation,
which is a strange trade since the implementation is already available.

The per-scheme access lists do have one advantage: They allow for simple
configuration of a "do not send scheme S to user U" exception when
multiple schemes are enabled. However, this advantage turns into a
problem in many cases (because an admin may accidentally run out of
schemes, because it is going to be difficult for the admin to visualize
the final list after many individual rules, and because it is a bad way
to control 403 responses explicitly).

Perhaps there is a way to keep the per-scheme access list advantage
without opening the 403 Pandora box and preserving the whole-list
visualization provided by auth_schemes?

For example, we could support something like this:

  auth_schemes "ALL except S1"    acl1 ...
  auth_schemes "ALL except S1,S2" acl2 ...
  auth_schemes S1,S2              acl3 ...
  auth_schemes ALL                acl4 ...

but I do not like how this syntax essentially moves operators inside
quoted strings.

Another alternative is:

  auth_schemes S1    deny  acl1 ... # ALL except S1
  auth_schemes S1,S2 deny  acl2 ... # ALL except S1 and S2
  auth_schemes S1,S2 allow acl3 ... # just S1 and S2
  auth_schemes ALL   allow acl4 ... # ALL

(with the configuration implementation similar to the existing
request_header_access rules).

Unfortunately, in all these cases, we would have to special-case
denying/excepting all schemes to avoid opening the 403 Pandora box. Only
the current auth_schemes implementation avoids that 403 problem (because
an empty list is a syntax-level/configure-time violation).


> The part about them not being "complementary, not mutually exclusive".
> They are mutually interferring on what would seem a reasonably average
> config:

You are probably interpreting "complementary" as non-intersecting. I did
not mean it that way. I agree that if per-scheme access lists are
allowed to select which schemes are used (as opposed to which scheme
configurations are used), then there will be interference. I think we
agree that such interference is undesirable and can be avoided.


> AFAICT we have pretty much narrowed the positives down to this patch
> allowing multiple orderings of schemes.

We have not. I doubt introducing implicitly controlled 403s is a good
idea, and I am sure some admins will appreciate the ability to specify
the whole list of schemes as a single parameter rather than trying to
construct it on the fly from individual pieces using properly ordered ACLs.


>>> That is exactly the case in HTTP Authentication where 403 status code is
>>> supposed to be used. It is explicitly one of the permitted auth states.
>>
>> Explicitly forbidding access and wanting to authenticate but implicitly
>> running out of authentication schemes are very different cases. We
> 
> Running out of usable schemes is just non-credential criteria and may be
> based on other header values ACL matching, not very different case at all.

I disagree: Configuring ways to authenticate and denying access by
prohibiting authentication are different cases IMHO. Both may be based
on various header values, of course.


>> should not duplicate http_access functionality in auth_schemes or the
> 
> This is not http_access functaionality. This is the 403 response from
> authentication attempt. With auth-failed status codes being 401 (www
> credentials), 407 (proxy credentials) and 403 (other auth criteria).

It is probably pointless to argue without enough use cases, but I
suspect that all three kinds of access denials should be controlled by
http_access, not schemes configuration/selection code.


>>>>  The
>>>> "Should I use this configuration for scheme X?" and "What schemes should
>>>> I use for this transaction?" are two different questions, each deserving
>>>> an answer in various real-world situations.


> I've taken another read of the patch and am leaning towards agreeing to
> the above separation despite what I think is a very limited gain.

Why? We do not seem to agree on any rationale items that back up one
approach versus the other. In other words, all your previous responses
seem to claim that auth_schemes offers no gain at all, but now you see
some. I am curious which agreement I missed; or perhaps you see some
auth_schemes advantage that we have not discussed?


>   The docs will need to reflect that scoping.

Sure. The implemented auth_scheme docs should not invade per-scheme
configuration selection territory, but we should double check.


> Though I do think my proposal would prove to be more efficient if we can
> put together some tests for comparing the two.

The performance difference would depend on the configuration: If there
are fewer scheme lists than explicit per-scheme rules, then auth_schemes
win. Otherwise, per-scheme ACLs win.


> I still want the split.

Yes, that is understood.


> If it helps clarify my reasons are basically;
> 
> The new directive is UI change so is a v5 feature, excluded from v4 due
> to where we are at in the release cycle.

This is a bogus reason IMO: Adding an optional configuration option is
not the kind of UI change that should matter for a v4/v5 boundary.


> But the structural changes should probably still end up in v4 to
> minimize future portage pain around all the other access controls touched.

Sure.


> Also, each part is likely to result in (or allow fixing) different
> types of bugs. The new directive in specifically auth related issues,
> and the structural change more widespread ACL processing issues.

Yes, but if both end up in v4 and v5, then the time spent separating
them would be better spent elsewhere IMO.


Let's do another round in case we manage to improve the overall design
somehow (as discussed above). If that fails, we will start working on
separating auth_schemes from action code polishing so that each can be
committed separately per your request.


Thank you,

Alex.


From christos at chtsanti.net  Wed Nov 30 09:23:39 2016
From: christos at chtsanti.net (Christos Tsantilas)
Date: Wed, 30 Nov 2016 11:23:39 +0200
Subject: [squid-dev] g++ 4.8.x and std::regex poblems
In-Reply-To: <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>
 <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>
Message-ID: <6487fc27-a51c-cafe-45c3-bd1c35af64bb@chtsanti.net>

On 29/11/2016 09:46 , Amos Jeffries wrote:
> I'm thinking it might be useful to add a how-to in the release notes for
> v4+ to make the compiler update easier. Would you be able to write that
> now that you have gone through the process?

I upgraded to newer OS, not just the compiler :-). It is something I 
would have to do in the next months so I decide to do it now.
However major linux distributions still does not provide stable releases 
with gcc-5.x.

>
> It is faster, but also has a different pattern syntax and API. So we
> would need both a config directive to specify what syntax was in use and
> a wrapper layer for portability.
>
> Which is exactly what std::regex provides . Though I have not gone so
> far as to add the config directive for changing the used syntax. It
> makes a lot more sense to go through the transition pain once instead of
> twice (GNURegex -> PCRE -> std::regex).

My sense is that std::regex is not a wrapper layer. It is just a 
different implementation. Maybe it is the faster implementation, OK.

We are using regex expressions in very few places and actually I believe 
that we should use RegexPattern class instead of direct calls to the 
external regex libraries. A such RegexPattern class can be small and can 
be adjusted to use many regex implementations.

It is not difficult, your patch is a prove for this, you are replaced 
old gnu regex with new std::regex with just replacing calls, without 
huge changes.

The basics regex expressions are the same. There are common flags, and 
there are flags which supported only in one library. The squid manual 
can just provide links, for example, to std::regex, pcre and gnu regex 
manuals.

I know that this is a new project, I am not saying that we should 
implement support for multiple regex libraries right now, but I believe 
that it is something we should have in our mind when we are planning squid.

Christos

>
> Amos
>

From noc at squid-cache.org  Wed Nov 30 09:49:58 2016
From: noc at squid-cache.org (noc at squid-cache.org)
Date: Wed, 30 Nov 2016 09:49:58 +0000 (UTC)
Subject: [squid-dev] =?utf-8?q?Build_failed_in_Jenkins=3A_5-matrix_=C2=BB_?=
 =?utf-8?q?gcc=2Cd-debian-unstable_=2324?=
In-Reply-To: <1430646370.15.1480260528796.JavaMail.jenkins@buildmaster>
References: <1430646370.15.1480260528796.JavaMail.jenkins@buildmaster>
Message-ID: <1641649557.20.1480499398162.JavaMail.jenkins@buildmaster>

http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/24/------------------------------------------
[...truncated 34536 lines...]
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
     ssl_ex_index_cert_error_check = SSL_get_ex_new_index(0, (void *) "cert_error_check", NULL, &ssl_dupAclChecklist, &ssl_freeAclChecklist);
                                                                                                ^~
In file included from ../../../../src/security/LockingPointer.h:16:0,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/crypto.h:178:12: note:   initializing argument 5 of 'int CRYPTO_get_ex_new_index(int, long int, void*, void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*), int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*), void (*)(void*, void*, CRYPTO_EX_DATA*, int, long int, void*))'
 __owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
            ^~~~~~~~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void ssl_info_cb(const SSL*, int, int)':
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
         ssl->s3->flags |= SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS;
            ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:144:16: note: forward declaration of 'SSL {aka struct ssl_st}'
 typedef struct ssl_st SSL;
                ^~~~~~
../../../../src/ssl/support.cc: In function 'const char* hasAuthorityInfoAccessCaIssuers(X509*)':
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                        ^~~~~~~~~~~~~~~~
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
                 xstrncpy(uri, reinterpret_cast<char *>(ASN1_STRING_data(ad->location->d.uniformResourceIdentifier)), sizeof(uri));
                                                                                                                  ^
In file included from /usr/include/openssl/bn.h:31:0,
                 from /usr/include/openssl/asn1.h:24,
                 from /usr/include/openssl/objects.h:916,
                 from /usr/include/openssl/evp.h:27,
                 from /usr/include/openssl/x509.h:23,
                 from /usr/include/openssl/ssl.h:50,
                 from ../../../../src/security/Context.h:17,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/asn1.h:553:1: note: declared here
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
 ^
../../../../src/ssl/support.cc: In function 'void completeIssuers(X509_STORE_CTX*, stack_st_X509*)':
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     int depth = ctx->param->depth;
                    ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     X509 *current = ctx->cert;
                        ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int untrustedToStoreCtx_cb(X509_STORE_CTX*, void*)':
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
     STACK_OF(X509) *oldUntrusted = ctx->untrusted;
                                       ^~
In file included from /usr/include/openssl/crypto.h:31:0,
                 from ../../../../src/security/LockingPointer.h:16,
                 from ../../../../src/security/Context.h:13,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ossl_typ.h:127:16: note: forward declaration of 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
 typedef struct x509_store_ctx_st X509_STORE_CTX;
                ^~~~~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'int store_session_cb(SSL*, SSL_SESSION*)':
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned char *id = session->session_id;
                                ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
     unsigned int idlen = session->session_id_length;
                                 ^~
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:228:16: note: forward declaration of 'SSL_SESSION {aka struct ssl_session_st}'
 typedef struct ssl_session_st SSL_SESSION;
                ^~~~~~~~~~~~~~
../../../../src/ssl/support.cc: In function 'void Ssl::SetSessionCallbacks(Security::ContextPointer&)':
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
         SSL_CTX_sess_set_get_cb(ctx.get(), get_session_cb);
                                                          ^
In file included from ../../../../src/security/Context.h:17:0,
                 from ../../../../src/security/forward.h:13,
                 from ../../../../src/security/KeyData.h:13,
                 from ../../../../src/security/PeerOptions.h:14,
                 from ../../../../src/security/ServerOptions.h:13,
                 from ../../../../src/anyp/PortCfg.h:17,
                 from ../../../../src/AccessLogEntry.h:12,
                 from ../../../../src/acl/FilledChecklist.h:12,
                 from ../../../../src/ssl/support.cc:18:
/usr/include/openssl/ssl.h:618:6: note:   initializing argument 2 of 'void SSL_CTX_sess_set_get_cb(SSL_CTX*, SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*))'
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,
      ^~~~~~~~~~~~~~~~~~~~~~~
At global scope:
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
cc1plus: all warnings being treated as errors
Makefile:848: recipe for target 'support.lo' failed
make[4]: *** [support.lo] Error 1
make[4]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src/ssl'>
Makefile:6933: recipe for target 'all-recursive' failed
make[3]: *** [all-recursive] Error 1
make[3]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:5953: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub/src'>
Makefile:583: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '<http://build.squid-cache.org/job/5-matrix/compiler=gcc,label=d-debian-unstable/ws/btlayer-02-maximus/squid-5.0.0-BZR/_build/sub'>
Makefile:791: recipe for target 'distcheck' failed
make: *** [distcheck] Error 1
buildtest.sh result is 2
BUILD: .././test-suite/buildtests/layer-02-maximus.opts
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
configure: BUILD LIBRARIES: 
configure: BUILD EXTRA LIBRARIES: -ldl -lm -lnsl -lresolv -lcap -lrt
configure: BUILD OBJECTS: 
configure: BUILD EXTRA OBJECTS: 
configure: BUILD C FLAGS: -Wall -g -O2
configure: BUILD EXTRA C FLAGS: -Wall -Wpointer-arith -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations -Wcomments -Wshadow -Werror -pipe -D_REENTRANT
configure: BUILD C++ FLAGS:  -I/usr/include/p11-kit-1 -g -O2
configure: BUILD EXTRA C++ FLAGS: -I/usr/include/libxml2 -Wall -Wpointer-arith -Wwrite-strings -Wcomments -Wshadow -Woverloaded-virtual -Werror -Wno-deprecated-register -pipe -D_REENTRANT
configure: BUILD Tools C++ FLAGS:   -I/usr/include/p11-kit-1 -g -O2
../../../../src/ssl/gadgets.cc:23:26: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:23:67: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/gadgets.cc:304:86: error: 'M_ASN1_INTEGER_dup' was not declared in this scope
../../../../src/ssl/gadgets.cc:335:67: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:377:48: error: invalid use of incomplete type 'struct x509_st'
../../../../src/ssl/gadgets.cc:406:74: error: 'M_ASN1_OCTET_STRING_new' was not declared in this scope
../../../../src/ssl/gadgets.cc:411:53: error: 'M_ASN1_OCTET_STRING_free' was not declared in this scope
../../../../src/ssl/gadgets.cc:801:63: error: invalid conversion from 'const GENERAL_NAME* {aka const GENERAL_NAME_st*}' to 'GENERAL_NAME* {aka GENERAL_NAME_st*}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [gadgets.lo] Error 1
../../../../src/ssl/support.cc:114:23: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:114:63: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:24: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:124:65: error: 'RSA* RSA_generate_key(int, long unsigned int, void (*)(int, int, void*), void*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:234:61: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:244:31: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:473:96: error: invalid conversion from 'int (*)(CRYPTO_EX_DATA*, CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, crypto_ex_data_st*, void*, int, long int, void*)}' to 'int (*)(CRYPTO_EX_DATA*, const CRYPTO_EX_DATA*, void*, int, long int, void*) {aka int (*)(crypto_ex_data_st*, const crypto_ex_data_st*, void*, int, long int, void*)}' [-fpermissive]
../../../../src/ssl/support.cc:489:12: error: invalid use of incomplete type 'const SSL {aka const struct ssl_st}'
../../../../src/ssl/support.cc:1117:56: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1117:114: error: 'unsigned char* ASN1_STRING_data(ASN1_STRING*)' is deprecated [-Werror=deprecated-declarations]
../../../../src/ssl/support.cc:1246:20: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1247:24: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1281:39: error: invalid use of incomplete type 'X509_STORE_CTX {aka struct x509_store_ctx_st}'
../../../../src/ssl/support.cc:1468:32: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1469:33: error: invalid use of incomplete type 'SSL_SESSION {aka struct ssl_session_st}'
../../../../src/ssl/support.cc:1553:58: error: invalid conversion from 'SSL_SESSION* (*)(SSL*, unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, unsigned char*, int, int*)}' to 'SSL_SESSION* (*)(ssl_st*, const unsigned char*, int, int*) {aka ssl_session_st* (*)(ssl_st*, const unsigned char*, int, int*)}' [-fpermissive]
cc1plus: error: unrecognized command line option '-Wno-deprecated-register' [-Werror]
make[4]: *** [support.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
make[1]: *** [all-recursive] Error 1
make: *** [distcheck] Error 1
Build FAILED.
Build step 'Execute shell' marked build as failure
[description-setter] Description set: 

From garryd at comnet.uz  Wed Nov 30 11:44:06 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Wed, 30 Nov 2016 16:44:06 +0500
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
 <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
 <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>
Message-ID: <1480506246.7500.25.camel@comnet.uz>

On Tue, 2016-11-29 at 15:42 -0700, Alex Rousskov wrote:
> On 11/29/2016 02:23 PM, Amos Jeffries wrote:
> > 
> > On 30/11/2016 1:47 a.m., Garri Djavadyan wrote:
> > > 
> > > On Tue, 2016-11-29 at 14:51 +0500, Garri Djavadyan wrote:
> > > > 
> > > > Hello,
> > > > 
> > > > Please review the attached patch prepared for r14958, it fixes
> > > > the
> > > > If-
> > > > None-Match processing (incorrect logging [1]) and the bug [2]
> > > > report
> > > > 4169 depending on the incorrect (IMO) behavior.
> > > > 
> > > > An If-None-Match request for a non-matched (ETag) but cached
> > > > object
> > > > should be processed as normal HIT.
> > > > 
> > > > [1] http://lists.squid-cache.org/pipermail/squid-users/2016-Nov
> > > > ember/013483.html
> > > > [2] http://bugs.squid-cache.org/show_bug.cgi?id=4169
> 
> > 
> > > 
> > > In the first version I
> > > removed strings (not related to the fix) which mark a request as
> > > non-
> > > IMS, because I thought the same request could not
> > > enter processConditional twice and the removed actions are
> > > redundant.
> 
> I agree that the second version is better: Unless you are absolutely
> sure, it is best to stay focused on the problem and leave the IMS
> deletion code "as is" even if it may not be necessary. If you still
> suspect it is not necessary, add a TODO comment to investigate
> separately.
> 
> 
> > 
> > Checking this whole processConditional() sequence for compliance
> > with
> > RFC 7232 and 7234 the rest of the logic seems to be fine except
> > this case:
> > 
> > <https://tools.ietf.org/html/rfc7234#section-4.3.2>
> > "
> > If the field-value is "*", or if the
> > field-value is a list of entity-tags and at least one of them
> > matches
> > the entity-tag of the selected stored response,
> 
> > 
> > [ e->hasIfNoneMatchEtag(r) == false --> !N == true ]
> 
> I am not sure I am interpreting your [...] mnemonic correctly, but
> AFAICT, the patched code works when the RFC conditions quoted above
> are
> _not_ meant:
> 
> > 
> > if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
> > if (!e->hasIfNoneMatchEtag(r)) {
> > // RFC 2616: ignore IMS if If-None-Match did not match
> > r.flags.ims = false;
> > r.ims = -1;
> > r.imslen = 0;
> > r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
> > http->logType = LOG_TCP_MISS;
> > sendMoreData(result);
> > return true;
> > }
> 
> 
> In other words, hasIfNoneMatchEtag() returns false and, hence, the
> quoted code is executed when _none_ of the requested ETags matches
> the
> cached ETag. The "if If-None-Match did not match" comment inside that
> code agrees with this interpretation.
> 
> Thus, the recommended RFC action that you found does _not_ apply to
> the
> fixed code:
> 
> > 
> > a cache recipient
> > SHOULD generate a 304 (Not Modified) response (using the
> > metadata of
> > the selected stored response) instead of sending that stored
> > response.
> > "
> 
> 
> If you were talking about processConditional() code outside the if
> statement fixed by Garri (i.e., when hasIfNoneMatchEtag() returns
> true),
> then it appears to match the quoted requirement only if there is no
> IMS
> header:
> 
> > 
> > if (!r.flags.ims) {
> > // RFC 2616: if If-None-Match matched and there is no IMS,
> > // reply with 304 Not Modified or 412 Precondition Failed
> > sendNotModifiedOrPreconditionFailedError();
> > return true;
> > }
> > 
> > // otherwise check IMS below to decide if we reply with 304 or 412
> > matchedIfNoneMatch = true;
> 
> 
> If there is an IMS header, then Squid violates the following RFC 7232
> MUST:
> 
> > 
> > A recipient MUST ignore If-Modified-Since if the request contains
> > an
> > If-None-Match header field
> 
> The HTTP requirements changed here since RFC 2616, and we probably
> should adjust the code to delete IMS header/flags after discovering
> the
> If-None-Match header:
> 
> if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
> // RFC 7232: If-None-Match recipient MUST ignore IMS
> r.flags.ims = false;
> r.ims = -1;
> r.imslen = 0;
> r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
> 
> if (e->hasIfNoneMatchEtag(r)) {
> sendNotModifiedOrPreconditionFailedError();
> return true;
> }
> 
> // If-None-Match did not match; treat as an unconditional hit
> return false;
> }
> 
> If the above sketch is correct, then the matchedIfNoneMatch variable
> may
> become unnecessary.

Alex, Amos thanks for comments! I've attached third version of the
patch. It is based on the proposal by Alex. The patch introduces
following changes:

* Matched If-None-Match requests are logged as TCP_INM_HIT (proposed by
Amos)
* If-Modified-Since requests for modified cached objects are processed
as normal HITs
* Not matched If-None-Match requests for cached objects are processed
as normal HITs
* If-Modified-Since header is ignored if If-None-Match header exists
(RFC7232 compliance)

I've tested different conditional requests (including 'If-None-Match:
*' and 'If-None-Match: "matched-tag", "not-matched-tag"') and found no
problems. Thanks.

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_if-none-match_v3.patch
Type: text/x-patch
Size: 3789 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161130/747828d1/attachment.bin>

From squid3 at treenet.co.nz  Wed Nov 30 11:56:00 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 1 Dec 2016 00:56:00 +1300
Subject: [squid-dev] [PATCH] Update refresh_pattern description
 regarding 'max' option
In-Reply-To: <c6d299bb492cdcc82ca55612ac68c8c5@comnet.uz>
References: <c6d299bb492cdcc82ca55612ac68c8c5@comnet.uz>
Message-ID: <1d136fb7-352b-6d45-0e3c-af739244c893@treenet.co.nz>

On 21/11/2016 9:58 a.m., Garri Djavadyan wrote:
> The patch adds description for undocumented behavior related to 'max'
> option of 'refresh_pattern' directive. I mean, 'max' option sets value
> for 'Cache-Control: max-age' header sent by Squid upstream. Feel free to
> modify the description. Thanks.
> 

IIRC it is not supposed to affect just any request. Only;
 a) the revalidation updates to HIT content need max-age, and that is to
ensure newer data comes back.
 b) sibling cache requests, because the content retrieved from a sibling
cache is supposed to be cacheable (thus within max storable age).

That (b) situation is one we probably should remove. But it needs
someone to analyse the use cases and figure out what should be going on
now in the HTTP/1.1 era.

Amos


From squid3 at treenet.co.nz  Wed Nov 30 12:20:06 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 1 Dec 2016 01:20:06 +1300
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <1480506246.7500.25.camel@comnet.uz>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
 <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
 <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>
 <1480506246.7500.25.camel@comnet.uz>
Message-ID: <45f61ee5-03ac-98c4-51aa-2a4f6b5b9f80@treenet.co.nz>

On 1/12/2016 12:44 a.m., Garri Djavadyan wrote:
> On Tue, 2016-11-29 at 15:42 -0700, Alex Rousskov wrote:
>> On 11/29/2016 02:23 PM, Amos Jeffries wrote:
>>>
>>> On 30/11/2016 1:47 a.m., Garri Djavadyan wrote:
>>>>
>>>> On Tue, 2016-11-29 at 14:51 +0500, Garri Djavadyan wrote:
>>>>>
>>>>> Hello,
>>>>>
>>>>> Please review the attached patch prepared for r14958, it fixes
>>>>> the
>>>>> If-
>>>>> None-Match processing (incorrect logging [1]) and the bug [2]
>>>>> report
>>>>> 4169 depending on the incorrect (IMO) behavior.
>>>>>
>>>>> An If-None-Match request for a non-matched (ETag) but cached
>>>>> object
>>>>> should be processed as normal HIT.
>>>>>
>>>>> [1] http://lists.squid-cache.org/pipermail/squid-users/2016-Nov
>>>>> ember/013483.html
>>>>> [2] http://bugs.squid-cache.org/show_bug.cgi?id=4169
>>
>>>
>>>>
>>>> In the first version I
>>>> removed strings (not related to the fix) which mark a request as
>>>> non-
>>>> IMS, because I thought the same request could not
>>>> enter processConditional twice and the removed actions are
>>>> redundant.
>>
>> I agree that the second version is better: Unless you are absolutely
>> sure, it is best to stay focused on the problem and leave the IMS
>> deletion code "as is" even if it may not be necessary. If you still
>> suspect it is not necessary, add a TODO comment to investigate
>> separately.
>>
>>
>>>
>>> Checking this whole processConditional() sequence for compliance
>>> with
>>> RFC 7232 and 7234 the rest of the logic seems to be fine except
>>> this case:
>>>
>>> <https://tools.ietf.org/html/rfc7234#section-4.3.2>
>>> "
>>>    If the field-value is "*", or if the
>>>    field-value is a list of entity-tags and at least one of them
>>> matches
>>>    the entity-tag of the selected stored response,
>>
>>>
>>> [ e->hasIfNoneMatchEtag(r) == false --> !N == true ]
>>
>> I am not sure I am interpreting your [...] mnemonic correctly, but
>> AFAICT, the patched code works when the RFC conditions quoted above
>> are
>> _not_ meant:
>>

Arg. You are right. Double not-non-negations strikes again :-(

<snip>
> 
> Alex, Amos thanks for comments! I've attached third version of the
> patch. It is based on the proposal by Alex. The patch introduces
> following changes:
> 
> * Matched If-None-Match requests are logged as TCP_INM_HIT (proposed by
> Amos)
> * If-Modified-Since requests for modified cached objects are processed
> as normal HITs
> * Not matched If-None-Match requests for cached objects are processed
> as normal HITs
> * If-Modified-Since header is ignored if If-None-Match header exists
> (RFC7232 compliance) 
> 
> I've tested different conditional requests (including 'If-None-Match:
> *' and 'If-None-Match: "matched-tag", "not-matched-tag"') and found no
> problems. Thanks.
> 

+1. That looks better to me.

I would really like the LogTags flag to be an actual flag, but I can do
that as a followup or later when I convert the others to flags.

Amos


From squid3 at treenet.co.nz  Wed Nov 30 12:31:46 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 1 Dec 2016 01:31:46 +1300
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
 SBufList
In-Reply-To: <CA+Y8hcMmp9ujYJ-Cwh6dov6HxHGtDFLDj8sQ=xXH-i2SV7zg_A@mail.gmail.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
 <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
 <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>
 <CA+Y8hcMmp9ujYJ-Cwh6dov6HxHGtDFLDj8sQ=xXH-i2SV7zg_A@mail.gmail.com>
Message-ID: <5c5a9a3c-aa8a-ad1a-9796-5ad73782e193@treenet.co.nz>

On 15/11/2016 5:34 a.m., Kinkie wrote:
> Hi,
>   the attached patch fixes the issue with missing ACL entries
> (verified) and streamlines the code a bit.
> 
> Performance-wise it improves a bit, parsing the same 1M-entry ACL in
> 19.4 seconds (17.8 seconds in userland).
> 

+1. Seems to be okay.

If there are no objections this can go in asap.

Amos


From squid3 at treenet.co.nz  Wed Nov 30 13:14:12 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 1 Dec 2016 02:14:12 +1300
Subject: [squid-dev] g++ 4.8.x and std::regex poblems
In-Reply-To: <6487fc27-a51c-cafe-45c3-bd1c35af64bb@chtsanti.net>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>
 <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>
 <6487fc27-a51c-cafe-45c3-bd1c35af64bb@chtsanti.net>
Message-ID: <d1ef9019-73d9-bd5a-7b2c-93e70949ceb1@treenet.co.nz>

On 30/11/2016 10:23 p.m., Christos Tsantilas wrote:
> On 29/11/2016 09:46 , Amos Jeffries wrote:
>> I'm thinking it might be useful to add a how-to in the release notes for
>> v4+ to make the compiler update easier. Would you be able to write that
>> now that you have gone through the process?
> 
> I upgraded to newer OS, not just the compiler :-). It is something I
> would have to do in the next months so I decide to do it now.
> However major linux distributions still does not provide stable releases
> with gcc-5.x.
> 
>>
>> It is faster, but also has a different pattern syntax and API. So we
>> would need both a config directive to specify what syntax was in use and
>> a wrapper layer for portability.
>>
>> Which is exactly what std::regex provides . Though I have not gone so
>> far as to add the config directive for changing the used syntax. It
>> makes a lot more sense to go through the transition pain once instead of
>> twice (GNURegex -> PCRE -> std::regex).
> 
> My sense is that std::regex is not a wrapper layer. It is just a
> different implementation. Maybe it is the faster implementation, OK.

Whether its a wrapper or completely different implementation is up to
the library. At the very least it is a consistent API regardless of the
regex grammar being presented.

And the extra requirement of std::regex is that all 6 grammars be
presented one way or another, not limited to a subset of them the
library wants to implement.


> 
> We are using regex expressions in very few places and actually I believe
> that we should use RegexPattern class instead of direct calls to the
> external regex libraries. A such RegexPattern class can be small and can
> be adjusted to use many regex implementations.
> 

That is what the class was made for, yes.

> 
> I know that this is a new project, I am not saying that we should
> implement support for multiple regex libraries right now, but I believe
> that it is something we should have in our mind when we are planning squid.
> 

My point was that we dont have to. All we have to do is migrate to
std::regex usage and the underlying library is no longer our concern.

Once we are using std::regex we just add squid.conf flag(s) in relevant
places to set a users prefered grammar. The RegexPattern class sends
std::regex API a grammar flag depending on what the user configured.

The C++11 implementation guarantees availability of all the common
grammars as listed in the first table at
<http://www.cplusplus.com/reference/regex/regex_constants/#syntax_option_type>.
No worries about detecting libraries or what to link against for
multiple grammar support.


But them nice toys are stuck waiting for the CentOS 7 compiler to be
irrelevant. I hope we dont have to wait the next 14 years for its EOL date.

Amos


From squid3 at treenet.co.nz  Wed Nov 30 13:34:52 2016
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 1 Dec 2016 02:34:52 +1300
Subject: [squid-dev] [PATCH] ServerBump class cleanup
Message-ID: <72200f70-19df-4f44-cb06-9b97edc98119@treenet.co.nz>

This patch is a general cleanup of coding styles and current code
requirements for the ServerBump class.

Is there any other general cleanup that should be done to this class
while I'm at it ?

Amos
-------------- next part --------------
=== modified file 'src/ssl/PeekingPeerConnector.cc'
--- src/ssl/PeekingPeerConnector.cc	2016-11-19 13:25:15 +0000
+++ src/ssl/PeekingPeerConnector.cc	2016-11-30 13:29:17 +0000
@@ -184,41 +184,41 @@
                 }
             }
         } else {
             // Set client SSL options
             SSL_set_options(serverSession.get(), ::Security::ProxyOutgoingConfig.parsedOptions);
 
             // Use SNI TLS extension only when we connect directly
             // to the origin server and we know the server host name.
             const char *sniServer = NULL;
             const bool redirected = request->flags.redirected && ::Config.onoff.redir_rewrites_host;
             if (!hostName || redirected)
                 sniServer = !request->url.hostIsNumeric() ? request->url.host() : NULL;
             else
                 sniServer = hostName->c_str();
 
             if (sniServer)
                 Ssl::setClientSNI(serverSession.get(), sniServer);
         }
 
         if (Ssl::ServerBump *serverBump = csd->serverBump()) {
-            serverBump->attachServerSSL(serverSession.get());
+            serverBump->attachServerSession(serverSession);
             // store peeked cert to check SQUID_X509_V_ERR_CERT_CHANGE
             if (X509 *peeked_cert = serverBump->serverCert.get()) {
                 X509_up_ref(peeked_cert);
                 SSL_set_ex_data(serverSession.get(), ssl_ex_index_ssl_peeked_cert, peeked_cert);
             }
         }
     }
 
     return true;
 }
 
 void
 Ssl::PeekingPeerConnector::noteNegotiationDone(ErrorState *error)
 {
     // Check the list error with
     if (!request->clientConnectionManager.valid() || !fd_table[serverConnection()->fd].ssl)
         return;
 
     // remember the server certificate from the ErrorDetail object
     if (Ssl::ServerBump *serverBump = request->clientConnectionManager->serverBump()) {

=== modified file 'src/ssl/ServerBump.cc'
--- src/ssl/ServerBump.cc	2016-10-06 22:05:50 +0000
+++ src/ssl/ServerBump.cc	2016-11-30 13:29:17 +0000
@@ -27,47 +27,47 @@
     debugs(33, 4, "will peek at " << request->url.authority(true));
     act.step1 = md;
     act.step2 = act.step3 = Ssl::bumpNone;
 
     if (e) {
         entry = e;
         entry->lock("Ssl::ServerBump");
     } else {
         // XXX: Performance regression. c_str() reallocates
         SBuf uriBuf(request->effectiveRequestUri());
         const char *uri = uriBuf.c_str();
         entry = storeCreateEntry(uri, uri, request->flags, request->method);
     }
     // We do not need to be a client because the error contents will be used
     // later, but an entry without any client will trim all its contents away.
     sc = storeClientListAdd(entry, this);
 }
 
 Ssl::ServerBump::~ServerBump()
 {
-    debugs(33, 4, HERE << "destroying");
+    debugs(33, 4, "destroying");
     if (entry) {
-        debugs(33, 4, HERE << *entry);
+        debugs(33, 4, *entry);
         storeUnregister(sc, entry, this);
         entry->unlock("Ssl::ServerBump");
     }
 }
 
 void
-Ssl::ServerBump::attachServerSSL(SSL *ssl)
+Ssl::ServerBump::attachServerSession(const Security::SessionPointer &s)
 {
-    if (serverSSL.get())
+    if (serverSession)
         return;
 
-    serverSSL.resetAndLock(ssl);
+    serverSession = s;
 }
 
 const Security::CertErrors *
 Ssl::ServerBump::sslErrors() const
 {
-    if (!serverSSL.get())
-        return NULL;
+    if (!serverSession)
+        return nullptr;
 
-    const Security::CertErrors *errs = static_cast<const Security::CertErrors*>(SSL_get_ex_data(serverSSL.get(), ssl_ex_index_ssl_errors));
+    const Security::CertErrors *errs = static_cast<const Security::CertErrors*>(SSL_get_ex_data(serverSession.get(), ssl_ex_index_ssl_errors));
     return errs;
 }
 

=== modified file 'src/ssl/ServerBump.h'
--- src/ssl/ServerBump.h	2016-09-13 11:38:07 +0000
+++ src/ssl/ServerBump.h	2016-11-30 13:31:28 +0000
@@ -1,60 +1,60 @@
 /*
  * Copyright (C) 1996-2016 The Squid Software Foundation and contributors
  *
  * Squid software is distributed under GPLv2+ license and includes
  * contributions from numerous individuals and organizations.
  * Please see the COPYING and CONTRIBUTORS files for details.
  */
 
-#ifndef _SQUID_SSL_PEEKER_H
-#define _SQUID_SSL_PEEKER_H
+#ifndef _SQUID_SRC_SSL_SERVERBUMP_H
+#define _SQUID_SRC_SSL_SERVERBUMP_H
 
 #include "base/AsyncJob.h"
 #include "base/CbcPointer.h"
 #include "comm/forward.h"
 #include "HttpRequest.h"
 #include "ip/Address.h"
 #include "security/forward.h"
 
 class ConnStateData;
 class store_client;
 
 namespace Ssl
 {
 
 /**
  * Maintains bump-server-first related information.
  */
 class ServerBump
 {
     CBDATA_CLASS(ServerBump);
 
 public:
-    explicit ServerBump(HttpRequest *fakeRequest, StoreEntry *e = NULL, Ssl::BumpMode mode = Ssl::bumpServerFirst);
+    explicit ServerBump(HttpRequest *fakeRequest, StoreEntry *e = nullptr, Ssl::BumpMode mode = Ssl::bumpServerFirst);
     ~ServerBump();
-    void attachServerSSL(SSL *); ///< Sets the server SSL object
+    void attachServerSession(const Security::SessionPointer &); ///< Sets the server SSL object
     const Security::CertErrors *sslErrors() const; ///< SSL [certificate validation] errors
 
     /// faked, minimal request; required by Client API
     HttpRequest::Pointer request;
     StoreEntry *entry; ///< for receiving Squid-generated error messages
     /// HTTPS server certificate. Maybe it is different than the one
-    /// it is stored in serverSSL object (error SQUID_X509_V_ERR_CERT_CHANGE)
+    /// stored in serverSession object (error SQUID_X509_V_ERR_CERT_CHANGE)
     Security::CertPointer serverCert;
     struct {
         Ssl::BumpMode step1; ///< The SSL bump mode at step1
         Ssl::BumpMode step2; ///< The SSL bump mode at step2
         Ssl::BumpMode step3; ///< The SSL bump mode at step3
     } act; ///< bumping actions at various bumping steps
     Ssl::BumpStep step; ///< The SSL bumping step
-    SBuf clientSni; ///< the SSL client SNI name
-    Security::SessionPointer serverSSL; ///< The SSL object on server side.
+    SBuf clientSni; ///< the client provided SNI name
 
 private:
+    Security::SessionPointer serverSession; ///< The session object on server side.
     store_client *sc; ///< dummy client to prevent entry trimming
 };
 
 } // namespace Ssl
 
 #endif
 


From gkinkie at gmail.com  Wed Nov 30 14:02:41 2016
From: gkinkie at gmail.com (Kinkie)
Date: Wed, 30 Nov 2016 14:02:41 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <5c5a9a3c-aa8a-ad1a-9796-5ad73782e193@treenet.co.nz>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
 <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
 <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>
 <CA+Y8hcMmp9ujYJ-Cwh6dov6HxHGtDFLDj8sQ=xXH-i2SV7zg_A@mail.gmail.com>
 <5c5a9a3c-aa8a-ad1a-9796-5ad73782e193@treenet.co.nz>
Message-ID: <CA+Y8hcNdhb+mcGUz5BnnrDFds5ZeRrWpp4TW21d2GZDiy3ZN=Q@mail.gmail.com>

I'll do that tonight, but after the rever of std::regex which it clashes with.

On Wed, Nov 30, 2016 at 12:31 PM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
> On 15/11/2016 5:34 a.m., Kinkie wrote:
>> Hi,
>>   the attached patch fixes the issue with missing ACL entries
>> (verified) and streamlines the code a bit.
>>
>> Performance-wise it improves a bit, parsing the same 1M-entry ACL in
>> 19.4 seconds (17.8 seconds in userland).
>>
>
> +1. Seems to be okay.
>
> If there are no objections this can go in asap.
>
> Amos
>



-- 
    Francesco

From gkinkie at gmail.com  Wed Nov 30 14:07:59 2016
From: gkinkie at gmail.com (Kinkie)
Date: Wed, 30 Nov 2016 14:07:59 +0000
Subject: [squid-dev] [PATCH] ServerBump class cleanup
In-Reply-To: <72200f70-19df-4f44-cb06-9b97edc98119@treenet.co.nz>
References: <72200f70-19df-4f44-cb06-9b97edc98119@treenet.co.nz>
Message-ID: <CA+Y8hcMrY0pbC+oAuamoVrHyS_+8Gk5tgO8YdOqhSTgv+iD3QQ@mail.gmail.com>

Looks reasonable to me. +1

On Wed, Nov 30, 2016 at 1:34 PM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
> This patch is a general cleanup of coding styles and current code
> requirements for the ServerBump class.
>
> Is there any other general cleanup that should be done to this class
> while I'm at it ?
>
> Amos
>
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev
>



-- 
    Francesco

From rousskov at measurement-factory.com  Wed Nov 30 14:44:34 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 30 Nov 2016 07:44:34 -0700
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <1480506246.7500.25.camel@comnet.uz>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
 <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
 <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>
 <1480506246.7500.25.camel@comnet.uz>
Message-ID: <698410d6-2a86-a541-1de7-0f34314d5a4d@measurement-factory.com>

On 11/30/2016 04:44 AM, Garri Djavadyan wrote:
> * If-Modified-Since header is ignored if If-None-Match header exists
> (RFC7232 compliance) 

>      if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
> +        if (e->hasIfNoneMatchEtag(r)) {
> +            // RFC 7232: If-None-Match recipient MUST ignore IMS
>              r.flags.ims = false;
>              r.ims = -1;
>              r.imslen = 0;
>              r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
>  
>              sendNotModifiedOrPreconditionFailedError();
>              return true;
>          }
>  
> +        // If-None-Match did not match; treat as an unconditional hit
> +        return false;
>      }


Can you explain why we are not clearing various IMS flags and headers
when hasIfNoneMatchEtag() returns false? Does not RFC7232 compliance
require equal treatment of IMS in both true and false cases?


Thank you,

Alex.


From rousskov at measurement-factory.com  Wed Nov 30 14:57:26 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 30 Nov 2016 07:57:26 -0700
Subject: [squid-dev] [PATCH] ServerBump class cleanup
In-Reply-To: <72200f70-19df-4f44-cb06-9b97edc98119@treenet.co.nz>
References: <72200f70-19df-4f44-cb06-9b97edc98119@treenet.co.nz>
Message-ID: <b4a37aa2-a6a6-a029-1fbe-f15dcd23bccd@measurement-factory.com>

On 11/30/2016 06:34 AM, Amos Jeffries wrote:
> This patch is a general cleanup of coding styles and current code
> requirements for the ServerBump class.

> -    void attachServerSSL(SSL *); ///< Sets the server SSL object
> +    void attachServerSession(const Security::SessionPointer &); ///< Sets the server SSL object

The comment continues to lie. If you rename the method, please fix the
comment as well (and mention that the method does nothing if the session
has already been set).

Renaming attachServerSSL() and serverSSL() is the only justifiable
change IMO. The maintenance/porting headaches created by other polishing
touches are not worth it. I cannot block them, but I do not recommend
making them.


> Is there any other general cleanup that should be done to this class
> while I'm at it ?

I do not think we should be doing any general cleanup of the frequently
used class that should be completely redesigned instead.

Alex.


From rousskov at measurement-factory.com  Wed Nov 30 15:03:36 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 30 Nov 2016 08:03:36 -0700
Subject: [squid-dev] g++ 4.8.x and std::regex problems
In-Reply-To: <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>
References: <28308f03-839f-98a7-7d6e-0490aef7efec@chtsanti.net>
 <be828884-4c51-d1c3-bdc9-558d3cef064b@treenet.co.nz>
 <d1b44a73-32cb-1d6a-6355-29693424b6ee@measurement-factory.com>
 <b58ccd05-5775-c11d-1ce8-9a9552d0a5a3@urlfilterdb.com>
 <583CE815.2000503@treenet.co.nz>
 <c8690dcc-50d5-878a-f492-0231b772e0f6@chtsanti.net>
 <77c2ed79-0eed-b742-f072-077ae7308ce6@treenet.co.nz>
Message-ID: <c4275880-0b00-41bb-8a16-29bd1cba743e@measurement-factory.com>

On 11/29/2016 12:46 PM, Amos Jeffries wrote:
> It was not just to delay to v5

To avoid similar disasters in the future, please note that any
"decision" to "delay until vX" is essentially invalid when there is no
consensus regarding vX branching: A promise to delay something until the
moment others cannot predict or control is not a meaningful promise!


Thank you,

Alex.


From garryd at comnet.uz  Wed Nov 30 15:12:29 2016
From: garryd at comnet.uz (Garri Djavadyan)
Date: Wed, 30 Nov 2016 20:12:29 +0500
Subject: [squid-dev] Fix If-None-Match processing and related bug 4169
In-Reply-To: <698410d6-2a86-a541-1de7-0f34314d5a4d@measurement-factory.com>
References: <1480413080.31040.24.camel@comnet.uz>
 <1480423641.31040.34.camel@comnet.uz>
 <4fc59b88-a470-87ba-9667-c9a8e8bafb69@treenet.co.nz>
 <e44eb84e-c6b6-30cf-a8ce-967b78c02db5@measurement-factory.com>
 <1480506246.7500.25.camel@comnet.uz>
 <698410d6-2a86-a541-1de7-0f34314d5a4d@measurement-factory.com>
Message-ID: <1480518749.7500.34.camel@comnet.uz>

On Wed, 2016-11-30 at 07:44 -0700, Alex Rousskov wrote:
> On 11/30/2016 04:44 AM, Garri Djavadyan wrote:
> > 
> > * If-Modified-Since header is ignored if If-None-Match header
> > exists
> > (RFC7232 compliance)
> 
> > 
> > if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
> > +if (e->hasIfNoneMatchEtag(r)) {
> > +// RFC 7232: If-None-Match recipient MUST ignore IMS
> > r.flags.ims = false;
> > r.ims = -1;
> > r.imslen = 0;
> > r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
> > 
> > sendNotModifiedOrPreconditionFailedError();
> > return true;
> > }
> > 
> > +// If-None-Match did not match; treat as an unconditional
> > hit
> > +return false;
> > }
> 
> 
> Can you explain why we are not clearing various IMS flags and headers
> when hasIfNoneMatchEtag() returns false? Does not RFC7232 compliance
> require equal treatment of IMS in both true and false cases?
> 
> 
> Thank you,
> 
> Alex.

Sorry, Alex you are right. I overlooked it. I've attached fixed
version.


On Thu, 2016-12-01 at 01:20 +1300, Amos Jeffries wrote:
> I would really like the LogTags flag to be an actual flag, but I can
> do that as a followup or later when I convert the others to flags.

Should I revert TCP_INM_HIT to TCP_IMS_HIT at the moment?


Thanks,

Garri
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_if-none-match_v4.patch
Type: text/x-patch
Size: 3920 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161130/a6f22d4a/attachment.bin>

From rousskov at measurement-factory.com  Wed Nov 30 19:00:58 2016
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 30 Nov 2016 12:00:58 -0700
Subject: [squid-dev] [PATCH] auth_schemes directive
In-Reply-To: <0b9552d0-381b-2223-a42d-d04fda0b9c7d@measurement-factory.com>
References: <582F954B.5060402@measurement-factory.com>
 <c544086d-25f6-d4b2-8357-a9405270403c@treenet.co.nz>
 <b832a3cb-3385-a091-453c-6f0fbf682b81@measurement-factory.com>
 <b4dc79bf-bf96-9c14-e70a-398548c082a2@treenet.co.nz>
 <0abe1174-5046-3d92-fddb-57a9531b877f@measurement-factory.com>
 <53866c4b-5b37-27bb-1f22-ad5e2893a005@treenet.co.nz>
 <0b9552d0-381b-2223-a42d-d04fda0b9c7d@measurement-factory.com>
Message-ID: <6e9c5212-3a75-a7c4-aeec-14a14147e57f@measurement-factory.com>

On 11/30/2016 12:06 AM, Alex Rousskov wrote:
> Perhaps there is a way to keep the per-scheme access list advantage
> without opening the 403 Pandora box and preserving the whole-list
> visualization provided by auth_schemes?
> 
> For example, we could support something like this:
> 
>   auth_schemes "ALL except S1"    acl1 ...
>   auth_schemes "ALL except S1,S2" acl2 ...
>   auth_schemes S1,S2              acl3 ...
>   auth_schemes ALL                acl4 ...
> 
> but I do not like how this syntax essentially moves operators inside
> quoted strings.
> 
> Another alternative is:
> 
>   auth_schemes S1    deny  acl1 ... # ALL except S1
>   auth_schemes S1,S2 deny  acl2 ... # ALL except S1 and S2
>   auth_schemes S1,S2 allow acl3 ... # just S1 and S2
>   auth_schemes ALL   allow acl4 ... # ALL
> 
> (with the configuration implementation similar to the existing
> request_header_access rules).
> 
> Unfortunately, in all these cases, we would have to special-case
> denying/excepting all schemes to avoid opening the 403 Pandora box. Only
> the current auth_schemes implementation avoids that 403 problem (because
> an empty list is a syntax-level/configure-time violation).

I just got a nice illustration why that 403-via-lack-of-schemes Pandora
box should remain closed:

A customer has indicated that "auth_schemes NONE" support would make
writing their configurations a little easier. That comment appeared to
support your assertion that lack-of-schemes should be treated as a
special useful 403 Forbidden case. However, to my surprise, the
follow-up conversation revealed that the customer expected "auth_schemes
NONE" to _allow_ access, not forbid it!

This example of diametrically opposed expectations reinforces my
original worries about supporting this special "no authentication
schemes" case. I think we should continue to rely on http_access to
permit or forbid access (including permitting or forbidding access
without authentication) and require at least one authentication scheme
to be available when authentication schemes are configured/used.

Said that, there might still be a way to configure the list of schemes
better than the posted auth_schemes does. I have not found it yet though.

Alex.


From gkinkie at gmail.com  Wed Nov 30 23:53:57 2016
From: gkinkie at gmail.com (Kinkie)
Date: Wed, 30 Nov 2016 23:53:57 +0000
Subject: [squid-dev] [PATCH] Rework acl/RegexData optimization to use
	SBufList
In-Reply-To: <CA+Y8hcNdhb+mcGUz5BnnrDFds5ZeRrWpp4TW21d2GZDiy3ZN=Q@mail.gmail.com>
References: <CA+Y8hcNTBj4ZwW9TPKA9_St_EVYRFrdMDq4+H_Esid5quadD_A@mail.gmail.com>
 <8afb1f3a-a763-86b8-44e0-3277defcee24@measurement-factory.com>
 <c823ddf5-b89c-72c1-8724-4bb86a8f01fa@treenet.co.nz>
 <CA+Y8hcOJHqYERF9vOLRPNvxaKBHVUN=v3s-RwuVp9w5hV5bAVg@mail.gmail.com>
 <CA+Y8hcMmp9ujYJ-Cwh6dov6HxHGtDFLDj8sQ=xXH-i2SV7zg_A@mail.gmail.com>
 <5c5a9a3c-aa8a-ad1a-9796-5ad73782e193@treenet.co.nz>
 <CA+Y8hcNdhb+mcGUz5BnnrDFds5ZeRrWpp4TW21d2GZDiy3ZN=Q@mail.gmail.com>
Message-ID: <CA+Y8hcPRfNPgvazdw-Hr+MmbvoP3=HkTsMqT4mPYYTVftbWKPg@mail.gmail.com>

Ok, done.
Thanks

On Wed, Nov 30, 2016 at 2:02 PM, Kinkie <gkinkie at gmail.com> wrote:
> I'll do that tonight, but after the rever of std::regex which it clashes with.
>
> On Wed, Nov 30, 2016 at 12:31 PM, Amos Jeffries <squid3 at treenet.co.nz> wrote:
>> On 15/11/2016 5:34 a.m., Kinkie wrote:
>>> Hi,
>>>   the attached patch fixes the issue with missing ACL entries
>>> (verified) and streamlines the code a bit.
>>>
>>> Performance-wise it improves a bit, parsing the same 1M-entry ACL in
>>> 19.4 seconds (17.8 seconds in userland).
>>>
>>
>> +1. Seems to be okay.
>>
>> If there are no objections this can go in asap.
>>
>> Amos
>>
>
>
>
> --
>     Francesco



-- 
    Francesco

