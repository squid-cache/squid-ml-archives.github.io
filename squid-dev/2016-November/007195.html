<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Segfault%20via%20Ftp%3A%3AClient%3A%3AreadControlReply.&In-Reply-To=%3Cf8bb858b-34f6-ad5f-fcbc-07181d817f8c%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007306.html">
   <LINK REL="Next"  HREF="007201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Segfault%20via%20Ftp%3A%3AClient%3A%3AreadControlReply.&In-Reply-To=%3Cf8bb858b-34f6-ad5f-fcbc-07181d817f8c%40chtsanti.net%3E"
       TITLE="[squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.">christos at chtsanti.net
       </A><BR>
    <I>Thu Nov 10 17:03:58 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="007306.html">[squid-dev] Build failed in Jenkins: 4-matrix » gcc,d-debian-unstable #12
</A></li>
        <LI>Next message: <A HREF="007201.html">[squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7195">[ date ]</a>
              <a href="thread.html#7195">[ thread ]</a>
              <a href="subject.html#7195">[ subject ]</a>
              <a href="author.html#7195">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Added nil dereference checks for Ftp::Client::ctrl.conn, including:
- Ftp::Client::handlePasvReply() and handleEpsvReply() that dereference 
ctrl.conn in DBG_IMPORTANT messages.
- Many functions inside FtpClient.cc and FtpGateway.cc files.

TODO: We need to find a better way to handle nil ctrl.conn. It is only a 
matter of time when we forget to add another dereference check or 
discover a place we missed during this change.

Also disabled forwarding of EPRT and PORT commands to origin servers. 
Squid support for those commands is broken and their forwarding may 
cause segfaults (bug #4004). Active FTP is still supported, of course.

This is a Measurement Factory project.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-233-Squid_Segfault_via_Ftp_Client_readControlReply-t4.patch
Type: text/x-patch
Size: 16020 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161110/a2053526/attachment.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20161110/a2053526/attachment.bin</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007306.html">[squid-dev] Build failed in Jenkins: 4-matrix » gcc,d-debian-unstable #12
</A></li>
	<LI>Next message: <A HREF="007201.html">[squid-dev] [PATCH] Segfault via Ftp::Client::readControlReply.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7195">[ date ]</a>
              <a href="thread.html#7195">[ thread ]</a>
              <a href="subject.html#7195">[ subject ]</a>
              <a href="author.html#7195">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
