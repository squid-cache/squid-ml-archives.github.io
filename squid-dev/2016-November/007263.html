<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] auth_schemes directive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20auth_schemes%20directive&In-Reply-To=%3Cc544086d-25f6-d4b2-8357-a9405270403c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007260.html">
   <LINK REL="Next"  HREF="007278.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] auth_schemes directive</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20auth_schemes%20directive&In-Reply-To=%3Cc544086d-25f6-d4b2-8357-a9405270403c%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] auth_schemes directive">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Nov 19 09:15:10 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="007260.html">[squid-dev] [PATCH] auth_schemes directive
</A></li>
        <LI>Next message: <A HREF="007278.html">[squid-dev] [PATCH] auth_schemes directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7263">[ date ]</a>
              <a href="thread.html#7263">[ thread ]</a>
              <a href="subject.html#7263">[ subject ]</a>
              <a href="author.html#7263">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/11/2016 12:56 p.m., Eduard Bagdasaryan wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> This patch introduces a new 'auth_schemes' squid.conf directive.
</I>&gt;<i> 
</I>&gt;<i> This directive may be used to customize authentication
</I>&gt;<i> schemes presence and order in Squid's HTTP 401 (Unauthorized) and 407
</I>&gt;<i> (Proxy Authentication Required) responses. The defaults remain the same.
</I>&gt;<i> 
</I>&gt;<i> Also refactored configuration code for options with custom
</I>&gt;<i> ACL-controlled actions:
</I>&gt;<i> 
</I>&gt;<i> * Reduced parsing code duplication by adding ParseAclWithAction().
</I>&gt;<i> 
</I>&gt;<i> * Used functors for generic action-to-string conversions. It is possible
</I>&gt;<i>   now to perform such conversions providing lambda expressions.
</I>&gt;<i> 
</I>&gt;<i> * Used vectors of strings instead of C-style arrays for storing
</I>&gt;<i>   conversion tables and check against bounds with vector::at().
</I>&gt;<i> 
</I>
-1. This patch is conflating two major feature additions.


Firstly;


The logic changes adding support for access controls 'kind' other than
allow/deny should be proposed as a separate feature addition.

Secondly;

IMO the access control for schemes is implemented wrong.

For the past 10 years admin who have been requesting control over what
schemes get advertised to clients have been driven by two main use cases:

 1) segmented networks where auth is done differently on each segment
(ie WAN vs LAN) but all segments share the one proxy.
 - either access controls to prevent some scheme being advertised to one
segment,
 - or being able to use one scheme name in several different ways
(different helper or realm etc.) .

 2) to administratively perform security downgrade attacks on clients.
Though this is usually spoken of as 'fixing' clients who repeatedly
request access with one particular (secure) credential type.


To resolve (1) fully we will need to have multiple Config objects with
the same scheme name and different config details.

To add auth scheme access controls in a way that does not actively
prevent (1) from being implemented later IMO we need to add access
controls as a member of the Config object, *not* as a global access list.

The config would look like:
 auth_param foo access allow blah blah
 auth_param foo access deny bar

 auth_param foo2 access deny blah
 auth_param foo2 access allow all

Amos

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007260.html">[squid-dev] [PATCH] auth_schemes directive
</A></li>
	<LI>Next message: <A HREF="007278.html">[squid-dev] [PATCH] auth_schemes directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7263">[ date ]</a>
              <a href="thread.html#7263">[ thread ]</a>
              <a href="subject.html#7263">[ subject ]</a>
              <a href="author.html#7263">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
