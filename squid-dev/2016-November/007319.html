<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] g++ 4.8.x and std::regex poblems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20g%2B%2B%204.8.x%20and%20std%3A%3Aregex%20poblems&In-Reply-To=%3Cd1ef9019-73d9-bd5a-7b2c-93e70949ceb1%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007313.html">
   <LINK REL="Next"  HREF="007325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] g++ 4.8.x and std::regex poblems</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20g%2B%2B%204.8.x%20and%20std%3A%3Aregex%20poblems&In-Reply-To=%3Cd1ef9019-73d9-bd5a-7b2c-93e70949ceb1%40treenet.co.nz%3E"
       TITLE="[squid-dev] g++ 4.8.x and std::regex poblems">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Nov 30 13:14:12 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="007313.html">[squid-dev] g++ 4.8.x and std::regex poblems
</A></li>
        <LI>Next message: <A HREF="007325.html">[squid-dev] g++ 4.8.x and std::regex problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7319">[ date ]</a>
              <a href="thread.html#7319">[ thread ]</a>
              <a href="subject.html#7319">[ subject ]</a>
              <a href="author.html#7319">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/11/2016 10:23 p.m., Christos Tsantilas wrote:
&gt;<i> On 29/11/2016 09:46 μμ, Amos Jeffries wrote:
</I>&gt;&gt;<i> I'm thinking it might be useful to add a how-to in the release notes for
</I>&gt;&gt;<i> v4+ to make the compiler update easier. Would you be able to write that
</I>&gt;&gt;<i> now that you have gone through the process?
</I>&gt;<i> 
</I>&gt;<i> I upgraded to newer OS, not just the compiler :-). It is something I
</I>&gt;<i> would have to do in the next months so I decide to do it now.
</I>&gt;<i> However major linux distributions still does not provide stable releases
</I>&gt;<i> with gcc-5.x.
</I>&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It is faster, but also has a different pattern syntax and API. So we
</I>&gt;&gt;<i> would need both a config directive to specify what syntax was in use and
</I>&gt;&gt;<i> a wrapper layer for portability.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which is exactly what std::regex provides . Though I have not gone so
</I>&gt;&gt;<i> far as to add the config directive for changing the used syntax. It
</I>&gt;&gt;<i> makes a lot more sense to go through the transition pain once instead of
</I>&gt;&gt;<i> twice (GNURegex -&gt; PCRE -&gt; std::regex).
</I>&gt;<i> 
</I>&gt;<i> My sense is that std::regex is not a wrapper layer. It is just a
</I>&gt;<i> different implementation. Maybe it is the faster implementation, OK.
</I>
Whether its a wrapper or completely different implementation is up to
the library. At the very least it is a consistent API regardless of the
regex grammar being presented.

And the extra requirement of std::regex is that all 6 grammars be
presented one way or another, not limited to a subset of them the
library wants to implement.


&gt;<i> 
</I>&gt;<i> We are using regex expressions in very few places and actually I believe
</I>&gt;<i> that we should use RegexPattern class instead of direct calls to the
</I>&gt;<i> external regex libraries. A such RegexPattern class can be small and can
</I>&gt;<i> be adjusted to use many regex implementations.
</I>&gt;<i> 
</I>
That is what the class was made for, yes.

&gt;<i> 
</I>&gt;<i> I know that this is a new project, I am not saying that we should
</I>&gt;<i> implement support for multiple regex libraries right now, but I believe
</I>&gt;<i> that it is something we should have in our mind when we are planning squid.
</I>&gt;<i> 
</I>
My point was that we dont have to. All we have to do is migrate to
std::regex usage and the underlying library is no longer our concern.

Once we are using std::regex we just add squid.conf flag(s) in relevant
places to set a users prefered grammar. The RegexPattern class sends
std::regex API a grammar flag depending on what the user configured.

The C++11 implementation guarantees availability of all the common
grammars as listed in the first table at
&lt;<A HREF="http://www.cplusplus.com/reference/regex/regex_constants/#syntax_option_type">http://www.cplusplus.com/reference/regex/regex_constants/#syntax_option_type</A>&gt;.
No worries about detecting libraries or what to link against for
multiple grammar support.


But them nice toys are stuck waiting for the CentOS 7 compiler to be
irrelevant. I hope we dont have to wait the next 14 years for its EOL date.

Amos

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007313.html">[squid-dev] g++ 4.8.x and std::regex poblems
</A></li>
	<LI>Next message: <A HREF="007325.html">[squid-dev] g++ 4.8.x and std::regex problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7319">[ date ]</a>
              <a href="thread.html#7319">[ thread ]</a>
              <a href="subject.html#7319">[ subject ]</a>
              <a href="author.html#7319">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
