<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Fix If-None-Match processing and related bug 4169
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fix%20If-None-Match%20processing%20and%20related%20bug%204169&In-Reply-To=%3C698410d6-2a86-a541-1de7-0f34314d5a4d%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007317.html">
   <LINK REL="Next"  HREF="007326.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Fix If-None-Match processing and related bug 4169</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fix%20If-None-Match%20processing%20and%20related%20bug%204169&In-Reply-To=%3C698410d6-2a86-a541-1de7-0f34314d5a4d%40measurement-factory.com%3E"
       TITLE="[squid-dev] Fix If-None-Match processing and related bug 4169">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Nov 30 14:44:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="007317.html">[squid-dev] Fix If-None-Match processing and related bug 4169
</A></li>
        <LI>Next message: <A HREF="007326.html">[squid-dev] Fix If-None-Match processing and related bug 4169
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7323">[ date ]</a>
              <a href="thread.html#7323">[ thread ]</a>
              <a href="subject.html#7323">[ subject ]</a>
              <a href="author.html#7323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/30/2016 04:44 AM, Garri Djavadyan wrote:
&gt;<i> * If-Modified-Since header is ignored if If-None-Match header exists
</I>&gt;<i> (RFC7232 compliance) 
</I>
&gt;<i>      if (r.header.has(Http::HdrType::IF_NONE_MATCH)) {
</I>&gt;<i> +        if (e-&gt;hasIfNoneMatchEtag(r)) {
</I>&gt;<i> +            // RFC 7232: If-None-Match recipient MUST ignore IMS
</I>&gt;<i>              r.flags.ims = false;
</I>&gt;<i>              r.ims = -1;
</I>&gt;<i>              r.imslen = 0;
</I>&gt;<i>              r.header.delById(Http::HdrType::IF_MODIFIED_SINCE);
</I>&gt;<i>  
</I>&gt;<i>              sendNotModifiedOrPreconditionFailedError();
</I>&gt;<i>              return true;
</I>&gt;<i>          }
</I>&gt;<i>  
</I>&gt;<i> +        // If-None-Match did not match; treat as an unconditional hit
</I>&gt;<i> +        return false;
</I>&gt;<i>      }
</I>

Can you explain why we are not clearing various IMS flags and headers
when hasIfNoneMatchEtag() returns false? Does not RFC7232 compliance
require equal treatment of IMS in both true and false cases?


Thank you,

Alex.

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007317.html">[squid-dev] Fix If-None-Match processing and related bug 4169
</A></li>
	<LI>Next message: <A HREF="007326.html">[squid-dev] Fix If-None-Match processing and related bug 4169
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7323">[ date ]</a>
              <a href="thread.html#7323">[ thread ]</a>
              <a href="subject.html#7323">[ subject ]</a>
              <a href="author.html#7323">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
