<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] polish Config2 using C++11 features
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20polish%20Config2%20using%20C%2B%2B11%20features&In-Reply-To=%3C3a25bafe-b8c5-8104-1108-73fceaa42f23%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006907.html">
   <LINK REL="Next"  HREF="006911.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] polish Config2 using C++11 features</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20polish%20Config2%20using%20C%2B%2B11%20features&In-Reply-To=%3C3a25bafe-b8c5-8104-1108-73fceaa42f23%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] polish Config2 using C++11 features">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Oct  1 04:55:26 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006907.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
        <LI>Next message: <A HREF="006911.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6908">[ date ]</a>
              <a href="thread.html#6908">[ thread ]</a>
              <a href="subject.html#6908">[ subject ]</a>
              <a href="author.html#6908">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/10/2016 6:10 a.m., Alex Rousskov wrote:
&gt;<i> On 09/30/2016 10:58 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> On 1/10/2016 5:09 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;<i> On 09/30/2016 09:38 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;<i> So I think we can start using these to replace old C-style
</I>&gt;&gt;&gt;&gt;<i> initialization and clear() functions.
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> Agreed. I wonder whether we should be consistent -- if some class data
</I>&gt;&gt;&gt;<i> members cannot use default initialization and some can, should we
</I>&gt;&gt;&gt;<i> initialize _all_ members in the constructor(s)?
</I>&gt;<i> 
</I>&gt;&gt;<i> I was aiming towards that some years ago. But reality turned out to be
</I>&gt;&gt;<i> that some of the bigger classes had annoyingly long lists of members to
</I>&gt;&gt;<i> initialize, many of which did not exactly need it. And no compiler or
</I>&gt;&gt;<i> static checking detects patches that forget to set one if it was a
</I>&gt;&gt;<i> complex class with own default constructor (like our Pointer types,
</I>&gt;&gt;<i> which were frequently missed).
</I>&gt;<i> 
</I>&gt;<i> Sorry I was not clear. I was not proposing a one-size-fits-all approach
</I>&gt;<i> that you were trying to enforce some years ago. The consistency I was
</I>&gt;<i> talking about has a single class scope. In other words:
</I>&gt;<i> 
</I>&gt;<i> * If, for a specific class C, some C members cannot use default
</I>&gt;<i> initializers, then none of the C members should use default initializers.
</I>&gt;<i> 
</I>&gt;<i> Is that a good rule? Do we need a rule here?
</I>
What we have now is to do the work to cleanly and properly avoid
uninitialized members on the build testing. But to treat other members
which handle themselves as optionally initialized.

That is sufficient, automatically testable (-Wuninitialized), and can be
applied as a blanket rule instead of trying to remember where its used
and where not.

If one wishes to go around adding needless entries to constructor lists,
one is free to do so. But it is really pointless work and wasted lines
of code.

&gt;<i> 
</I>&gt;&gt;<i> So these days I'm only setting the basic POD type members explicitly on
</I>&gt;&gt;<i> construct. If we can set them like this and skip defining a default
</I>&gt;&gt;<i> constructor entirely that would be even better for shrinking the code.
</I>&gt;<i> 
</I>&gt;<i> Sure, but the consistency I am worried about is about a different case
</I>&gt;<i> where we cannot avoid defining a constructor because some members
</I>&gt;<i> require non-constexpr initializers.
</I>
In that case it is optional whether the code explicitly says what the
compiler will do anyway.

We might be pushed into that position by &quot;Big 3&quot; or &quot;Big 5&quot;
requirements. But as optional we can deal with all them case-by-case.

Amos

</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006907.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
	<LI>Next message: <A HREF="006911.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6908">[ date ]</a>
              <a href="thread.html#6908">[ thread ]</a>
              <a href="subject.html#6908">[ subject ]</a>
              <a href="author.html#6908">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
