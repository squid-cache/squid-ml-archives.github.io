<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Sad performance trend
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Sad%20performance%20trend&In-Reply-To=%3C50d57c38-270e-56db-6cd0-c00e527f9bb0%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006672.html">
   <LINK REL="Next"  HREF="006673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Sad performance trend</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Sad%20performance%20trend&In-Reply-To=%3C50d57c38-270e-56db-6cd0-c00e527f9bb0%40treenet.co.nz%3E"
       TITLE="[squid-dev] Sad performance trend">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Sep  6 14:27:54 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006672.html">[squid-dev] Jenkins build is back to normal : trunk-matrix » gcc,j-fbsd-93 #747
</A></li>
        <LI>Next message: <A HREF="006673.html">[squid-dev] Sad performance trend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6671">[ date ]</a>
              <a href="thread.html#6671">[ thread ]</a>
              <a href="subject.html#6671">[ subject ]</a>
              <a href="author.html#6671">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/08/2016 12:32 p.m., Alex Rousskov wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i>     Factory ran a bunch of micro-level Polygraph tests, targeting
</I>&gt;<i> several Squid subsystems: header parsing, connection management, and SSL
</I>&gt;<i> (but no SslBump). We tested a few Squid versions going back to v3.1:
</I>&gt;<i> 
</I>&gt;<i>         W1  W2  W3  W4  W5  W6
</I>&gt;<i>   v3.1  32% 38% 16% 48% 16+ 9%
</I>&gt;<i>   v3.3  23% 31% 14% 42% 15% 8%
</I>&gt;<i>   v3.5  11% 16% 12% 36%  7% 6%
</I>&gt;<i>   v4.0  11% 15%  9% 30% 14% 5%
</I>&gt;<i> 
</I>&gt;<i> Each W column represents a particular Polygraph workload (the workload
</I>&gt;<i> details are not important right now). Each percentage cell represents a
</I>&gt;<i> single test result for a given Squid version. Absolute numbers mean
</I>&gt;<i> little in these quick-and-dirty micro tests, but higher percentages are
</I>&gt;<i> better (100% would be comparable to a &quot;wire&quot; -- an ideal proxy with zero
</I>&gt;<i> overhead). Comparing numbers from different columns is virtually
</I>&gt;<i> meaningless because different workloads have different 100% levels.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If you follow each W column from top (v3.1 stabilizing in ~2010) to
</I>&gt;<i> bottom (current v4.0/trunk), you will notice that all studied Squid
</I>&gt;<i> subsystems are getting slower and slower. These micro tests exaggerate
</I>&gt;<i> the impact of specific subsystems and cannot predict real performance
</I>&gt;<i> degradation in a given environment, but things are clearly getting worse
</I>&gt;<i> with time. This is a sad trend!
</I>&gt;<i> 
</I>
That trend goes all the way back to at least 2.6. Which is a bit weird,
since it contradicts the total request-per-second capacity we have been
watching in polygraph results.

The speed per request goes down and the number that can be handled rises.

As far as my simple observations have been, the per-request slowdown
correlates to the amount of code being added (ie new features) and also
to the amount of AsyncCalls involved with the request handling (where
more AsyncCall is more latency).

The AsyncCall correlation kind of explains the capacity vs speed
relationship. As Calls make more transactions happen in parallel the
fixed CPU resource gets spread thinner.

&gt;<i>  
</I>&gt;<i> Whether you blame it on an unfortunate initial code state, insufficient
</I>&gt;<i> project resources, lack of an official architect, mediocre development
</I>&gt;<i> skills, nearly absent quality controls, something else, or the
</I>&gt;<i> combination of several factors, we are clearly doing something wrong,
</I>&gt;<i> year after year after year...
</I>&gt;<i> 
</I>&gt;<i> And what is arguably worse than the bad trend itself, we did not even
</I>&gt;<i> _know_ about the problem (or at least its magnitude) until now.
</I>&gt;<i> 
</I>
I thought you had noticed this several years ago and it was behind your
growing insistence on polygraph tests being used. I know I've been
watching it for a while.

&gt;<i> 
</I>&gt;<i> I will not propose any solutions at this time, but will feed this
</I>&gt;<i> information into ongoing Squid Foundation discussions about revamping
</I>&gt;<i> Squid QA. Your feedback is welcomed, of course.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Thank you,
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-dev mailing list
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
</I>&gt;<i> 
</I>
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006672.html">[squid-dev] Jenkins build is back to normal : trunk-matrix » gcc,j-fbsd-93 #747
</A></li>
	<LI>Next message: <A HREF="006673.html">[squid-dev] Sad performance trend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6671">[ date ]</a>
              <a href="thread.html#6671">[ thread ]</a>
              <a href="subject.html#6671">[ subject ]</a>
              <a href="author.html#6671">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
