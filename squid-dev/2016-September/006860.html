<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] dns_wait_for_all
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20dns_wait_for_all&In-Reply-To=%3Cdb04317e-d23c-84ff-93a5-1f8943572dc7%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006837.html">
   <LINK REL="Next"  HREF="006877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] dns_wait_for_all</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20dns_wait_for_all&In-Reply-To=%3Cdb04317e-d23c-84ff-93a5-1f8943572dc7%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] dns_wait_for_all">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Sep 15 15:35:45 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006837.html">[squid-dev] [RFC] dns_wait_for_all
</A></li>
        <LI>Next message: <A HREF="006877.html">[squid-dev] [RFC] dns_wait_for_all
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6860">[ date ]</a>
              <a href="thread.html#6860">[ thread ]</a>
              <a href="subject.html#6860">[ subject ]</a>
              <a href="author.html#6860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/15/2016 03:50 AM, Amos Jeffries wrote:
&gt;<i> On 15/09/2016 5:11 p.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> On 09/14/2016 07:26 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> On 15/09/2016 8:15 a.m., Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i> Any better ideas or objections to adding dns_wait_for_all?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In principle okay. However, I was intending to redesign the object we
</I>&gt;&gt;&gt;<i> store DNS RR results in to achieve this is a more useful way. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you are talking about Comm::ConnectionList/serverDestinations, then
</I>&gt;&gt;<i> that object will have to be redesigned to support this proposal, of
</I>&gt;&gt;<i> course. The object would also have to be safely shared across FwdState,
</I>&gt;&gt;<i> peer selection code, and DNS code for the proposed feature to work.
</I>&gt;<i> 
</I>&gt;<i> I mean Dns::LookupDetails, ipcache_addrs and rfc1035_rr.
</I>
&gt;<i> Something like:
</I>&gt;<i> 
</I>&gt;<i> * ipcache_addrs::in_addrs becomes a list of rfc1035_rr instead of array
</I>&gt;<i> if IP address. (or an equivalent type storing the same details in easier
</I>&gt;<i> to access type than 'rdata' uses).
</I>&gt;<i> 
</I>&gt;<i> * ipcache_addrs::bad_mask moved into rfc1035_rr for a mask on the
</I>&gt;<i> records in each RR separately.
</I>&gt;<i> 
</I>&gt;<i> * ipcache_addrs merged into Dns::LookupDetails.
</I>
That sounds mostly unrelated to the problem at hand. If we need to alter
Dns::LookupDetails, ipcache_addrs, or rfc1035_rr in some significant
way, then we will come back to this discussion. Otherwise, it stays as a
separate/independent not-yet-discussed project.


&gt;<i> The serverDestinations not changing (yet).
</I>
I am pretty sure we have to change that field to implement
dns_wait_for_all functionality correctly. For example:

* we need to make its updates (from different jobs!) safe, with
easy-to-trace debugging.

* we need to support an EOF-like semantics to signal whether more
destinations may still be provided.


Thank you,

Alex.

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006837.html">[squid-dev] [RFC] dns_wait_for_all
</A></li>
	<LI>Next message: <A HREF="006877.html">[squid-dev] [RFC] dns_wait_for_all
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6860">[ date ]</a>
              <a href="thread.html#6860">[ thread ]</a>
              <a href="subject.html#6860">[ subject ]</a>
              <a href="author.html#6860">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
