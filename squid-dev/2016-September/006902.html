<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] polish Config2 using C++11 features
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20polish%20Config2%20using%20C%2B%2B11%20features&In-Reply-To=%3C5dcf5f33-3905-b8e2-188d-08783f322311%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="006900.html">
   <LINK REL="Next"  HREF="006904.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] polish Config2 using C++11 features</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20polish%20Config2%20using%20C%2B%2B11%20features&In-Reply-To=%3C5dcf5f33-3905-b8e2-188d-08783f322311%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] polish Config2 using C++11 features">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Sep 30 16:58:56 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="006900.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
        <LI>Next message: <A HREF="006904.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6902">[ date ]</a>
              <a href="thread.html#6902">[ thread ]</a>
              <a href="subject.html#6902">[ subject ]</a>
              <a href="author.html#6902">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/10/2016 5:09 a.m., Alex Rousskov wrote:
&gt;<i> On 09/30/2016 09:38 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> We now seem to have had several patches successfully use members
</I>&gt;&gt;<i> declared with default values and/or with the &quot;*this = Foo();&quot; shortcut
</I>&gt;&gt;<i> for a reset/clear method.
</I>&gt;<i> 
</I>&gt;<i> The *this assignment works for pre-C++11 v3.5 as well. The default
</I>&gt;<i> values will not work there so we should be extra careful when
</I>&gt;<i> backporting affected code.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> So I think we can start using these to replace old C-style
</I>&gt;&gt;<i> initialization and clear() functions.
</I>&gt;<i> 
</I>&gt;<i> Agreed. I wonder whether we should be consistent -- if some class data
</I>&gt;<i> members cannot use default initialization and some can, should we
</I>&gt;<i> initialize _all_ members in the constructor(s)?
</I>
I was aiming towards that some years ago. But reality turned out to be
that some of the bigger classes had annoyingly long lists of members to
initialize, many of which did not exactly need it. And no compiler or
static checking detects patches that forget to set one if it was a
complex class with own default constructor (like our Pointer types,
which were frequently missed).

So these days I'm only setting the basic POD type members explicitly on
construct. If we can set them like this and skip defining a default
constructor entirely that would be even better for shrinking the code.


&gt;<i> 
</I>&gt;&gt;<i> This patch begins by replacing the Config2 use of memset(). I for one am
</I>&gt;&gt;<i> constantly mistaking which of the Config objects has memset() applied to
</I>&gt;&gt;<i> it at the global level when reconfigure happens. Now we do not need to
</I>&gt;&gt;<i> care, each object handles its own clearing one way or another.
</I>&gt;<i> 
</I>&gt;<i> +1
</I>&gt;<i> 
</I>
Thanks. Will commit once it passes all the build tests.

Amos

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006900.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
	<LI>Next message: <A HREF="006904.html">[squid-dev] [PATCH] polish Config2 using C++11 features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6902">[ date ]</a>
              <a href="thread.html#6902">[ thread ]</a>
              <a href="subject.html#6902">[ subject ]</a>
              <a href="author.html#6902">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
