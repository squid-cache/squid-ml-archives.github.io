<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] Changes to http_access defaults
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Changes%20to%20http_access%20defaults&In-Reply-To=%3Cf4299bf2-bea5-b242-e6a6-91dbd9c96a79%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008497.html">
   <LINK REL="Next"  HREF="008487.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] Changes to http_access defaults</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Changes%20to%20http_access%20defaults&In-Reply-To=%3Cf4299bf2-bea5-b242-e6a6-91dbd9c96a79%40treenet.co.nz%3E"
       TITLE="[squid-dev] [RFC] Changes to http_access defaults">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Apr 12 18:16:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008497.html">[squid-dev] [PATCH] Honor peer timeouts when forwarding CONNECTs
</A></li>
        <LI>Next message: <A HREF="008487.html">[squid-dev] [RFC] Changes to http_access defaults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8482">[ date ]</a>
              <a href="thread.html#8482">[ thread ]</a>
              <a href="subject.html#8482">[ subject ]</a>
              <a href="author.html#8482">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When I implemented the major changes to squid.conf in 3.1/3.2  there
were a lot of installations placing custom config rules above the lines
I describe now as &quot;default security checks&quot;. The !Safe_ports and
!SSL_ports deny lines.

At the time I also believed reverse-proxy config had to go above that to
work properly. Which was the major argument behind leaving them manually
configured.

That reverse-proxy reason has turned out to be incorrect and over the
years since I have become convinced that Squid always checks those
security rules, then do the custom access rules. All other orderings
seem to have turned out to be problematic and security-buggy in some
edge cases or another.


What are peoples opinions about making the following items built-in
defaults?

 acl Safe_ports port 21 80 443
 acl CONNECT_ports port 443
 acl CONNECT method CONNECT

 http_acces deny !Safe_ports
 http_access deny CONNECT !CONNECT_ports


This makes the three protocols Squid-4/5 can officially support (HTTP,
HTTPS, FTP) acceptable by default.

I have excluded the other protocols that are safe, but usually not
necessary to proxy in modern traffic. They can remain 'recommended'
configurable defaults like today.

Likewise the manager rules (for now) since local conditions can
sometimes allow them to be optimized better than our current recommended
default.


The above change will have some effect on installations that try to use
an empty squid.conf. If the proposal goes ahead some extra additions
would be included to retain that default-reject behaviour.

Ideas? opinions?


Amos
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008497.html">[squid-dev] [PATCH] Honor peer timeouts when forwarding CONNECTs
</A></li>
	<LI>Next message: <A HREF="008487.html">[squid-dev] [RFC] Changes to http_access defaults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8482">[ date ]</a>
              <a href="thread.html#8482">[ thread ]</a>
              <a href="subject.html#8482">[ subject ]</a>
              <a href="author.html#8482">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
