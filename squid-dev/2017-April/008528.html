<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Squid-4 status update
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Squid-4%20status%20update&In-Reply-To=%3Ce38dad41-f7a7-843a-5d0c-d6871069ce10%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008536.html">
   <LINK REL="Next"  HREF="008532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Squid-4 status update</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Squid-4%20status%20update&In-Reply-To=%3Ce38dad41-f7a7-843a-5d0c-d6871069ce10%40measurement-factory.com%3E"
       TITLE="[squid-dev] Squid-4 status update">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Apr 19 16:26:55 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008536.html">[squid-dev] Jenkins build is back to normal : template-full-matrix » gcc,d-debian-jessie #332
</A></li>
        <LI>Next message: <A HREF="008532.html">[squid-dev] Squid-4 status update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8528">[ date ]</a>
              <a href="thread.html#8528">[ thread ]</a>
              <a href="subject.html#8528">[ subject ]</a>
              <a href="author.html#8528">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/26/2017 09:20 PM, Amos Jeffries wrote:

&gt;<i> Below are the bugs which are currently preventing a &quot;stable&quot; release:
</I>

&gt;<i> 4659 - sslproxy_foreign_intermediate_certs does not work any more
</I>&gt;<i> 
</I>&gt;<i>  * waiting for someone to identify what part of the Downloader code
</I>&gt;<i> breaks this directive behaviour.
</I>
Factory will work on this one if nobody beats us to it. We should be
able to start (and provide an ETA) within a week or so.


&gt;<i> Below are planned to ignore for release purposes. If they can be fixed
</I>&gt;<i> great, but I'm not holding for them:
</I>
IMO, it is your call whether to violate the formal release conditions as
long as you acknowledge and explain the violations. Those formal
conditions allow us to knowingly release completely buggy software so it
is difficult to defend them in general.


&gt;<i> 4662 - build errors with LibreSSL 2.4.4
</I>&gt;<i> 
</I>&gt;<i>  * stuck waiting for someone to add feature detection to all the code
</I>&gt;<i> using OPENSSL_VERSION macros. Then to find any other places LibreSSL
</I>&gt;<i> differ and fix those too.
</I>
FWIW, the above nice long-term solution is not required to close that
bug IMO. A much smaller short-term solution would be to introduce a
version-testing macro that will auto-correct LibreSSL lies about the
supported OpenSSL API version.


&gt;<i> this kind of requires someone who actually use LibreSSL to do the
</I>&gt;<i> testing.
</I>
Anybody can test with LibreSSL, but somebody who needs LibreSSL support
may want to perform or motivate the corresponding work. I agree that the
bug is stuck for now.


&gt;<i> 4505 - Memory hits shadow disk entries and vice versa
</I>&gt;<i> 
</I>&gt;<i>  * AFAIK, still nobody working on this. Requires a fair bit of redesign
</I>&gt;<i> in store code.
</I>
Factory is working on this major bug. The fix was stuck in my review
queue, but I should be able to start the review within a few days. I
hope to see the final patch posted here soon after the PID file fixes
(discussed below).


&gt;<i> 4631 - security_file_certgen drops request due to a full queue
</I>&gt;<i> 
</I>&gt;<i>  * seems to be an expected but undesirable consequence of being helper
</I>&gt;<i> API. The effects are major, but the fix is technically a feature
</I>&gt;<i> enhancement AFAICT.
</I>
My understanding of that bug report is completely different: The current
working theory is that some kind of unusual input or condition (e.g., a
very large certificate or malformed helper request) results in more and
more helpers getting independently stuck waiting for more input from
Squid that never comes.

The bug will remain stuck until somebody volunteers to analyze the
latest logs from Dan (at least).


&gt;<i> Any other issues that dont have bug reports I should wait for?
</I>
I recall several issues that might be worth waiting for (your call):

1. PID file management changes

We fixed some of the problems in trunk r13867 but the current code still
badly mishandles SMP race conditions. We see a stream of related problem
reports from SMP installations that cannot reliably start, restart, or
send signals. The fix went through several major rewrites and review
cycles already, so I hope we are within a week of the final solution.

The fix contains some Squid &quot;interface&quot; changes (exit codes, what
failures are considered fatal, level-1 messages, etc.) so it may be a
good idea to get it in before a lot of folks start upgrading to v4. It
is your call though.


2. New transaction_initiator ACL

Based on squid-users and private requests, quite a few admins are likely
to need this ACL to better cope with regression-like problems related to
other recent improvements. Here is a quote from the being-reviewed patch
preamble:

&gt;<i> This ACL is essential in several use cases, including:
</I>&gt;<i> 
</I>&gt;<i> * After fetching a missing intermediate certificate, Squid uses the
</I>&gt;<i>   regular cache (and regular caching rules) to store the response. Squid
</I>&gt;<i>   deployments that do not want to cache regular traffic need to cache
</I>&gt;<i>   fetched certificates and only them.
</I>&gt;<i> 
</I>&gt;<i>   acl fetched_certificate transaction_initiator certificate-fetching
</I>&gt;<i>   cache allow fetched_certificate
</I>&gt;<i>   cache deny all
</I>&gt;<i> 
</I>&gt;<i> * Many traffic policies and tools assume the existence of an HTTP client
</I>&gt;<i>   behind every transaction. Internal Squid requests violate that
</I>&gt;<i>   assumption. Identifying internal requests protects external ACLs, log
</I>&gt;<i>   analyzers, and other mechanisms from the transactions they mishandle.
</I>&gt;<i> 
</I>&gt;<i>   acl skip_logging transaction_initiator internal
</I>&gt;<i>   access_log ... !skip_logging
</I>
I do not know whether v4 port is practical but it would be nice to have
this ACL in v4.


3. Bug 4682 - With ssl_bump, squid can ignore ACL denied and serve page

This is a v3 bug, but it is almost fixed, and since the bug may have
disastrous consequences, you may want to get it in before calling v4
&quot;stable&quot;.


4. [PATCH] Do not forward HTTP requests to dead idle peers

Eduard has posted that improvement yesterday. If you think this is a bug
fix, then it can be committed to v4 later. Otherwise, its reviewed/final
version should be committed to v4 before calling v4 stable IMO.


BTW, please do not rush to create any new official branches after
changing v4 status: During to-git migration, I expect us to have enough
trouble with v5 already being &quot;out of place&quot;, and creating more such
branches before conversion is likely to make the matters worse.


Thank you,

Alex.

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008536.html">[squid-dev] Jenkins build is back to normal : template-full-matrix » gcc,d-debian-jessie #332
</A></li>
	<LI>Next message: <A HREF="008532.html">[squid-dev] Squid-4 status update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8528">[ date ]</a>
              <a href="thread.html#8528">[ thread ]</a>
              <a href="subject.html#8528">[ subject ]</a>
              <a href="author.html#8528">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
