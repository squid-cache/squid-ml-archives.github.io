<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] CRUSH peer selection method
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20CRUSH%20peer%20selection%20method&In-Reply-To=%3C4224727b-e8a6-0fa8-6cdd-05d633439d3d%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008531.html">
   <LINK REL="Next"  HREF="008518.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] CRUSH peer selection method</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20CRUSH%20peer%20selection%20method&In-Reply-To=%3C4224727b-e8a6-0fa8-6cdd-05d633439d3d%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] CRUSH peer selection method">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Apr 19 17:02:24 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008531.html">[squid-dev] [RFC] CRUSH peer selection method
</A></li>
        <LI>Next message: <A HREF="008518.html">[squid-dev] [PATCH] Do not forward HTTP requests to dead idle peers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8530">[ date ]</a>
              <a href="thread.html#8530">[ thread ]</a>
              <a href="subject.html#8530">[ subject ]</a>
              <a href="author.html#8530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/19/2017 09:48 AM, Loic Dachary wrote:
&gt;<i> On 04/19/2017 04:31 PM, Alex Rousskov wrote:
</I>
&gt;&gt;<i> Another test shows better CRUSH performance. It is not clear to me
</I>&gt;&gt;<i> whether some other tests will show better CARP performance.
</I>
&gt;<i> The test program I wrote[1] displays the properties of CARP that help
</I>&gt;<i> comparing it with CRUSH, that is:
</I>
&gt;<i> - requests are evenly distributed among peers, in accordance to the weights
</I>
This CARP behavior feels natural/reasonable. How does this compare to CRUSH?


&gt;<i> - when a peer is added or removed, the amount of requests moving to
</I>&gt;<i> or from the new or old peer is in proportion of its weight
</I>
This CARP behavior feels natural/reasonable. How does this compare to CRUSH?


&gt;<i> - when the weight of a peer is changed, the amount of requests moving
</I>&gt;<i> to or from the changed peer is in proportion of the weight change
</I>
This CARP behavior feels natural/reasonable. How does this compare to CRUSH?


&gt;<i> While conducting these tests I discovered that CARP does not perform
</I>&gt;<i> as well as CRUSH when changing weights. 
</I>
AFAICT, you showed one data point where the above is true. Would it be
possible to _generalize_, based on all the other tests you have done
and/or based on your understanding of how the algorithms work? In other
words, can you formulate a general statement of the following form?

  CRUSH outperforms CARP when ... . Under those conditions, CRUSH
  results in X% fewer reassigned requests. CRUSH gets Y% close to
  the hypothetical ideal algorithm that minimizes reassignment
  while still balancing the load.

(The last sentence is _optional_ -- I do not know whether you have
enough information to make such a statement and whether it is possible
to make such an estimate at all.)


&gt;<i> If there are other tests that
</I>&gt;<i> you think relevant to compare the two algorithms, I'd be happy to
</I>&gt;<i> work on that.
</I>
There may be a misunderstanding: I am not trying to force you to run
more or different tests. I just want to understand the performance
difference between the two algorithms. How you discover/document/present
that difference is your call. Running tests and generalizing from them
could be a valid approach (but one isolated measurement does not tell me
much).


&gt;<i> I hope this shows you the work done is better than a random
</I>&gt;<i> exploration of meaningless tests.
</I>
Again, I am not trying to request &quot;more work&quot; or belittle the value of
the work already performed. I am just saying that you have not given us
enough information to get excited about CRUSH. That does not mean we
should not be excited about it. It only means that you have not proven
that adding CRUSH is worth it. And if we do not know whether or how
CRUSH is better (beyond one data point), how can we &quot;sell&quot; switching to
this new algorithm to the admins? (Rhetorical).

Finally, I do not speak for others, but please do not expect me to read
scientific articles or study code at least until you convince me that
CRUSH is probably significantly better than CARP (again, based on
whatever proof method that you think will work). I need a convincing
executive summary first.


Thank you,

Alex.

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008531.html">[squid-dev] [RFC] CRUSH peer selection method
</A></li>
	<LI>Next message: <A HREF="008518.html">[squid-dev] [PATCH] Do not forward HTTP requests to dead idle peers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8530">[ date ]</a>
              <a href="thread.html#8530">[ thread ]</a>
              <a href="subject.html#8530">[ subject ]</a>
              <a href="author.html#8530">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
