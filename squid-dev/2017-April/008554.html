<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] shuffle remaining session cache code to libsecurity
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20shuffle%20remaining%20session%20cache%20code%20to%0A%20libsecurity&In-Reply-To=%3C86a1e538-b02d-d861-1be1-8da8487b6e86%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008548.html">
   <LINK REL="Next"  HREF="008556.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20shuffle%20remaining%20session%20cache%20code%20to%0A%20libsecurity&In-Reply-To=%3C86a1e538-b02d-d861-1be1-8da8487b6e86%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Apr 29 08:45:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008548.html">[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity
</A></li>
        <LI>Next message: <A HREF="008556.html">[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8554">[ date ]</a>
              <a href="thread.html#8554">[ thread ]</a>
              <a href="subject.html#8554">[ subject ]</a>
              <a href="author.html#8554">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/04/17 11:20, Alex Rousskov wrote:
&gt;<i> On 04/26/2017 07:01 AM, Amos Jeffries wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> +#if USE_OPENSSL // while Ssl:: bits in use
</I>&gt;&gt;<i> +static const char *SessionCacheName = &quot;tls_session_cache&quot;;
</I>&gt;&gt;<i> +static Ipc::MemMap *SessionCache = nullptr;
</I>&gt;&gt;<i> +#endif
</I>&gt;<i> What does the above comment mean? I could not guess based on a few other
</I>&gt;<i> occurrences of the same comment, and I do not see any &quot;Ssl::&quot; bits in
</I>&gt;<i> the above code.
</I>
Oops, just me missing that after copying the functions that used these 
globals over. Will remove before commit.

&gt;&gt;<i> +    if (auto *slotW = SessionCache-&gt;openForWriting((const cache_key*)key, pos)) {
</I>&gt;<i> In general, I recommend removing &quot;*&quot; after &quot;auto&quot; because the condition
</I>&gt;<i> and the code protected by it does not care whether the variable is a raw
</I>&gt;<i> pointer, a smart pointer, or (in some cases) something else with a
</I>&gt;<i> to-boolean conversion.
</I>
Okay, good point.

&gt;<i> &quot;auto&quot; needs &quot;const&quot; and &quot;&amp;&quot; but not &quot;*&quot;.
</I>
FYI: that statement does not match my experiences with auto in the 
general case. I have in the past omitted these sugar type details and 
found that the compiler picked to use the object copy-assignment to 
duplicate the object into the 'auto' variable. That may just have been 
compiler bugs, but is a nasty one anyway. So I prefer to only replace 
the type name with auto to ensure that implicit conversions are kept to 
minimal or performant ones and the nature of the variable remains 
visible to us reading it.


Amos
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008548.html">[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity
</A></li>
	<LI>Next message: <A HREF="008556.html">[squid-dev] [PATCH] shuffle remaining session cache code to libsecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8554">[ date ]</a>
              <a href="thread.html#8554">[ thread ]</a>
              <a href="subject.html#8554">[ subject ]</a>
              <a href="author.html#8554">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
