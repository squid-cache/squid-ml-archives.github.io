<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] VIA creation code duplication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20VIA%20creation%20code%20duplication&In-Reply-To=%3C4c5ca6b2-dfc7-a1c3-be01-973373ae3b89%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008019.html">
   <LINK REL="Next"  HREF="007955.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] VIA creation code duplication</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20VIA%20creation%20code%20duplication&In-Reply-To=%3C4c5ca6b2-dfc7-a1c3-be01-973373ae3b89%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] VIA creation code duplication">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Feb 14 01:22:19 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008019.html">[squid-dev] [PATCH] VIA creation code duplication
</A></li>
        <LI>Next message: <A HREF="007955.html">[squid-dev] [PATCH] convert Delay Pools classes to use MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8021">[ date ]</a>
              <a href="thread.html#8021">[ thread ]</a>
              <a href="subject.html#8021">[ subject ]</a>
              <a href="author.html#8021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/02/2017 2:06 a.m., Eduard Bagdasaryan wrote:
&gt;<i> I see that String::append asserts when String is unable to &quot;grow&quot;:
</I>&gt;<i> String has hardcoded ~64Kb limit for that. It is hardly possible since
</I>&gt;<i> most of web servers have header length limit less than this value.
</I>&gt;<i> Theoretically a buggy upstream server could generate such huge Via.
</I>&gt;<i> However any other header may assert as well, since HttpHeaderEntry
</I>&gt;<i> stores its value in String. Why do you think we should care only about
</I>&gt;<i> Via header overflow?
</I>
I dont think Via is the only one. We had issues with Vary last year. But
sice this patch is dealign with Via we should not add the extra risk.

The problem is with proxy where the admin has configured large headers
to be allowed, and receives a Via just under the 6KB liit. Our append
pushing it over by even one byte would assert. The older bbuf code
cropping at 1KB was nasty but would not crash Squid.

Amos
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008019.html">[squid-dev] [PATCH] VIA creation code duplication
</A></li>
	<LI>Next message: <A HREF="007955.html">[squid-dev] [PATCH] convert Delay Pools classes to use MEMPROXY_CLASS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8021">[ date ]</a>
              <a href="thread.html#8021">[ thread ]</a>
              <a href="subject.html#8021">[ subject ]</a>
              <a href="author.html#8021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
