<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Problems about Squid documentation/configuration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Problems%20about%20Squid%20documentation/configuration&In-Reply-To=%3Cfdf384bd-4e40-7fe3-4856-ba0c4a049f2e%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008151.html">
   <LINK REL="Next"  HREF="008198.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Problems about Squid documentation/configuration</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Problems%20about%20Squid%20documentation/configuration&In-Reply-To=%3Cfdf384bd-4e40-7fe3-4856-ba0c4a049f2e%40treenet.co.nz%3E"
       TITLE="[squid-dev] Problems about Squid documentation/configuration">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Feb 21 23:19:28 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008151.html">[squid-dev] Problems about Squid documentation/configuration
</A></li>
        <LI>Next message: <A HREF="008198.html">[squid-dev] url_rewrite_program doesn't work, redirector helpers are crashing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8179">[ date ]</a>
              <a href="thread.html#8179">[ thread ]</a>
              <a href="subject.html#8179">[ subject ]</a>
              <a href="author.html#8179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/02/2017 3:04 a.m., Rallph wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am actually working on a URL filter that works with Squid and his
</I>&gt;<i> url_rewrite_program.
</I>&gt;<i> I haven't installed SquidGuard or UFDBGuard either on my Debian 8.6 with
</I>&gt;<i> Squid 3.5 (from sources).
</I>&gt;<i> 
</I>&gt;<i> The problem is : I can't find why must my program return to Squid, this page
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/PhpRedirectors#PHP_Redirect_.28Simple.29">http://wiki.squid-cache.org/ConfigExamples/PhpRedirectors#PHP_Redirect_.28Simple.29</A>
</I>&gt;<i> say that the output is &quot;302:<A HREF="http://example.com/\n">http://example.com/\n</A>&quot; ...
</I>
That page is written about a very specific helper script someone
created. It is consistent with the AddonHelpers page content, but only
contains a very limited use of the URL rewrite API.


&gt;<i> But when you look at
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/Features/AddonHelpers#HTTP_Redirection">http://wiki.squid-cache.org/Features/AddonHelpers#HTTP_Redirection</A> it says
</I>&gt;<i> that the output must be something like &quot;0 OK status=302
</I>&gt;<i> url=<A HREF="http://example.com/\n">http://example.com/\n</A> 302:<A HREF="http://example.com/\n">http://example.com/\n</A>&quot; and it doesn't work.
</I>
That page is the most up to date documentation. It contains the *full*
helper protocol and all helper APIs. The sub-section of that relevant to
redirectors is contained in
&lt;<A HREF="http://wiki.squid-cache.org/Features/Redirectors">http://wiki.squid-cache.org/Features/Redirectors</A>&gt; along with some other
documentations related to redirectors.

The PhpRedirectors page documents a single helper using a specific
sub-set of the redirect protocol applicable to Squid-2 compatible
helpers without concurrency support.

The syntax definitions use [] to indicate optional fields in the protocol.

So as you should see, that PhpRedirectors helper is using *only* the
status:URL field in its response. No channel-ID, result or key=value
details.


Your helper is using channel-ID, result and some kv-pairs. Which is
correct for Squid-3.4 and later.


&gt;<i> I've tried &quot;0 OK status=302 url=<A HREF="http://example.com/\n">http://example.com/\n</A>&quot; but Squid tells me
</I>&gt;<i> &quot;ERROR: URL rewrite helper returned invalid result code. Wrong Helper?
</I>&gt;<i> {result=Unknown}&quot; and I can not find something to fix it.
</I>&gt;<i> 
</I>
Use of the concurrency channel-ID requires that squid.conf has enabled
concurrency support with the url_rewrite_children directive.

It looks to me like you are missing that squid.conf part. The helper
should work okay one that is added.

The rest of the issues are all side effects.

Amos

</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008151.html">[squid-dev] Problems about Squid documentation/configuration
</A></li>
	<LI>Next message: <A HREF="008198.html">[squid-dev] url_rewrite_program doesn't work, redirector helpers are crashing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8179">[ date ]</a>
              <a href="thread.html#8179">[ thread ]</a>
              <a href="subject.html#8179">[ subject ]</a>
              <a href="author.html#8179">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
