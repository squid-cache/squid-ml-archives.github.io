<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Mitigate DoS attacks that use client-initiated SSL/TLS renegotiation.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Mitigate%20DoS%20attacks%20that%20use%20client-initiated%0A%20SSL/TLS%20renegotiation.&In-Reply-To=%3Cc61f2e7e-7a6e-0dc6-1bd5-4e67aabd4516%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007933.html">
   <LINK REL="Next"  HREF="007810.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Mitigate DoS attacks that use client-initiated SSL/TLS renegotiation.</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Mitigate%20DoS%20attacks%20that%20use%20client-initiated%0A%20SSL/TLS%20renegotiation.&In-Reply-To=%3Cc61f2e7e-7a6e-0dc6-1bd5-4e67aabd4516%40chtsanti.net%3E"
       TITLE="[squid-dev] [PATCH] Mitigate DoS attacks that use client-initiated SSL/TLS renegotiation.">christos at chtsanti.net
       </A><BR>
    <I>Sun Jan 22 12:03:06 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="007933.html">[squid-dev] [PATCH] Response delay pools
</A></li>
        <LI>Next message: <A HREF="007810.html">[squid-dev] [PATCH] Mitigate DoS attacks that use client-initiated SSL/TLS renegotiation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7809">[ date ]</a>
              <a href="thread.html#7809">[ thread ]</a>
              <a href="subject.html#7809">[ subject ]</a>
              <a href="author.html#7809">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
There is a well-known DoS attack using client-initiated SSL/TLS 
renegotiation. The severity or uniqueness of this attack method is 
disputed, but many believe it is serious/real.
There is even a (disputed) CVE 2011-1473:
     <A HREF="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1473">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1473</A>

The old Squid code tried to disable client-initiated renegotiation, but 
it did not work reliably (or at all), depending on Squid version, due to 
OpenSSL API changes and conflicting SslBump callbacks. That code is now 
removed and client-initiated renegotiations are allowed.

With this change, Squid aborts the TLS connection, with a level-1 ERROR 
message if the rate of client-initiated renegotiate requests exceeds  5 
requests in 10 seconds (approximately). This protection and the rate 
limit are currently hard-coded but the rate is not expected to be 
exceeded under normal circumstances.

This is a Measurement Factory project
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQUID-266-DoS-using-client-initiated-renegotiation-t2.patch
Type: text/x-patch
Size: 14282 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170122/43b24630/attachment.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170122/43b24630/attachment.bin</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007933.html">[squid-dev] [PATCH] Response delay pools
</A></li>
	<LI>Next message: <A HREF="007810.html">[squid-dev] [PATCH] Mitigate DoS attacks that use client-initiated SSL/TLS renegotiation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7809">[ date ]</a>
              <a href="thread.html#7809">[ thread ]</a>
              <a href="subject.html#7809">[ subject ]</a>
              <a href="author.html#7809">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
