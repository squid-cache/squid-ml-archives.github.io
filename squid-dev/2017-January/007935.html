<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Bug 4662 adding --with-libressl build option
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Bug%204662%20adding%20--with-libressl%20build%20option&In-Reply-To=%3Ca9fec235-a2cc-42b1-d8df-27940b228e00%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="007928.html">
   <LINK REL="Next"  HREF="007936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Bug%204662%20adding%20--with-libressl%20build%20option&In-Reply-To=%3Ca9fec235-a2cc-42b1-d8df-27940b228e00%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jan 31 15:20:28 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="007928.html">[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option
</A></li>
        <LI>Next message: <A HREF="007936.html">[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7935">[ date ]</a>
              <a href="thread.html#7935">[ thread ]</a>
              <a href="subject.html#7935">[ subject ]</a>
              <a href="author.html#7935">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 31/01/2017 7:04 a.m., Alex Rousskov wrote:
&gt;<i> On 01/29/2017 04:26 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> This is I think all we need to do code-wise to resolve the Bug 4662
</I>&gt;&gt;<i> issues with LibreSSL being incompatible with OpenSSL 1.1.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The libraries cannot both be linked either way. If both --with-* options
</I>&gt;&gt;<i> are provided LibreSSL currently overrides OpenSSL. I picked that
</I>&gt;&gt;<i> preference order because AFAICS the LibreSSL has the lower overall
</I>&gt;&gt;<i> security footprint while providing the same (or better) needed
</I>&gt;&gt;<i> functionality.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> NP: If there are no objections I would like to fast-track this and apply
</I>&gt;&gt;<i> in ~3 days (allowing for today being a sunday) for a slightly late
</I>&gt;&gt;<i> 4.0.18 beta.
</I>&gt;<i> 
</I>&gt;<i> I do not think these changes should be committed. As you probably know
</I>&gt;<i> from earlier communication, I think we should avoid using both
</I>&gt;<i> USE_OPENSSL and USE_LIBRESSL in the code if LibreSSL is [treated as] a
</I>&gt;<i> replacement for OpenSSL. I have suggested several ways to avoid the
</I>&gt;<i> dangerous and needless repetition of (USE_OPENSSL || USE_LIBRESSL)
</I>&gt;<i> conditions, and we even seemed to agree on one of those solutions.
</I>&gt;<i> 
</I>
IMO we only agreed on the HAVE_* macro usage for determining whether the
1.1 API was in use. Which is included in this patch.


I don't think the repetition of (USE_OPENSSL || USE_LIBRESSL) is either
needless or dangerous. No more than USE_OPENSSL was in the same spot.
Fixing the sheer number of uses is not in scope, tempting as it was to
drop some more completely.

Keep it simple. Only one macro per library. --with-foo sets USE_FOO.

The rest is normal precompiler operators which anyone knowing C/C++
should be able to easily read and can combine the libraries in all sorts
of fancy ways _iff_ necessary.

Going by that policy both libraries get named for code they support and
the || is used.


NP: I am only adding the &quot;|| USE_LIBRESSL&quot; parts in this patch because I
happen to know that the existing code is being used with LibreSSL and
found to be working. Future code will have to prove itself separately
for each library, OR at the submitters discretion (passing audit and QA
also) list the librares believed to be safe with it.


&gt;<i> 
</I>&gt;<i> FWIW, I do not think bug 4662 blocks 4.0.18 beta.
</I>&gt;<i> 
</I>
It is not a blocker, but I would like to avoid declaring LibreSSL as no
longer supported by v4 since the fix is not exactly hard.

Amos

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007928.html">[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option
</A></li>
	<LI>Next message: <A HREF="007936.html">[squid-dev] [PATCH] Bug 4662 adding --with-libressl build option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7935">[ date ]</a>
              <a href="thread.html#7935">[ thread ]</a>
              <a href="subject.html#7935">[ subject ]</a>
              <a href="author.html#7935">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
