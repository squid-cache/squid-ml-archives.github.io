<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] http(s)_port TLS/SSL config redesign
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20http%28s%29_port%20TLS/SSL%20config%20redesign&In-Reply-To=%3C2187f117-97a4-4aed-8a43-426a217745cf%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009243.html">
   <LINK REL="Next"  HREF="009244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] http(s)_port TLS/SSL config redesign</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20http%28s%29_port%20TLS/SSL%20config%20redesign&In-Reply-To=%3C2187f117-97a4-4aed-8a43-426a217745cf%40treenet.co.nz%3E"
       TITLE="[squid-dev] [RFC] http(s)_port TLS/SSL config redesign">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Jul 20 01:27:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="009243.html">[squid-dev] [RFC] Disable Github issue tracker
</A></li>
        <LI>Next message: <A HREF="009244.html">[squid-dev] Introduction / SslBump upstream ssl proxy support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9196">[ date ]</a>
              <a href="thread.html#9196">[ thread ]</a>
              <a href="subject.html#9196">[ subject ]</a>
              <a href="author.html#9196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all, Christos and Alex particularly,

I have been mulling over several ideas for how to improve the config 
parameters on the http(s)_port to make them a bit easier for newbies to 
get right, and pros to do powerfully cool stuff.


So, the most major change I would like to propose is to move the proxies 
CA for cert generation from cert= parameter to 
generate-host-certificates= parameter. Having it configured with a file 
being the same as generate =on and not configuring it default to =off.


The matching key= and any CA chain would need to be all bundled in the 
same PEM file. That should be fine since the clients get a separate DER 
file installed, not sharing the PEM file loaded into Squid.

That will stop confusing newbies have over what should go in cert= for 
what Squid use-case. And will allow pros to configure exactly which 
static cert Squid uses as a fallback when auto-generating others - 
simply by using cert= in the normal non-bumping way.

Also, we can then easily use the two sets of parameters in identical 
fashion for non-SSL-Bump proxies to auto-generate reverse-proxy certs 
based on SNI, or use a fallback static cert of admins choice.

Bringing these two different use-cases config into line should vastly 
simplify the complexity of working with Squid TLS certs for everybody, 
including us in the code as we no longer have multiple (8! at least) 
code paths for different cert= possibilities and config error handling 
permutations.


For backward compatibility concerns with existing SSL-Bump configs I 
think we can use the certificate CA vs non-CA property to auto-detect 
old SSL-Bump configs being loaded and handle the compatibility 
auto-upgrade and warnings. The warning will be useful long-term and not 
just for the transitional period.


Now would also be a marginally better than usual time to make the change 
since the parameters are migrating to tls-* prefix in v4 and have extra 
admin attention already.


Amos
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009243.html">[squid-dev] [RFC] Disable Github issue tracker
</A></li>
	<LI>Next message: <A HREF="009244.html">[squid-dev] Introduction / SslBump upstream ssl proxy support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9196">[ date ]</a>
              <a href="thread.html#9196">[ thread ]</a>
              <a href="subject.html#9196">[ subject ]</a>
              <a href="author.html#9196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
