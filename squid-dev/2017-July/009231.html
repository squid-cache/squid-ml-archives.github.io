<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [RFC] Migrate explicit syslog calls to debugs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Migrate%20explicit%20syslog%20calls%20to%20debugs&In-Reply-To=%3C735b3062-275a-1217-96c4-3a31246a7226%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009230.html">
   <LINK REL="Next"  HREF="009232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [RFC] Migrate explicit syslog calls to debugs</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BRFC%5D%20Migrate%20explicit%20syslog%20calls%20to%20debugs&In-Reply-To=%3C735b3062-275a-1217-96c4-3a31246a7226%40measurement-factory.com%3E"
       TITLE="[squid-dev] [RFC] Migrate explicit syslog calls to debugs">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Jul 27 04:06:51 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="009230.html">[squid-dev] Cache poisoning vulnerability 3.5.23
</A></li>
        <LI>Next message: <A HREF="009232.html">[squid-dev] [RFC] Migrate explicit syslog calls to debugs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9231">[ date ]</a>
              <a href="thread.html#9231">[ thread ]</a>
              <a href="subject.html#9231">[ subject ]</a>
              <a href="author.html#9231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

    Squid master process uses many explicit syslog() calls like these:

&gt;<i> syslog(LOG_ALERT, &quot;fork failed: %s&quot;, xstrerr(xerrno));
</I>&gt;<i> syslog(LOG_ALERT, &quot;Suspiciously high workers value: %d&quot;,
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: will start %d kids&quot;, (int)TheKids.count());
</I>&gt;<i> syslog(LOG_ALERT, &quot;execvp failed: %s&quot;, xstrerr(xerrno));
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: %s process %d started&quot;,
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: %s process %d exited with status %d&quot;,
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: %s process %d exited due to signal %d with status %d&quot;,
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: %s process %d exited&quot;,
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: %s process %d will not&quot;
</I>&gt;<i> syslog(LOG_NOTICE, &quot;Squid Parent: unknown child process %d exited&quot;, pid);
</I>&gt;<i> syslog(LOG_ALERT, &quot;Exiting due to unexpected forced shutdown&quot;);
</I>&gt;<i> syslog(LOG_ALERT, &quot;Exiting due to repeated, frequent failures&quot;);
</I>

I propose to replace explicit syslog() calls with DBG_CRITICAL and
DBG_IMPORTANT debugs() calls _and_ automatically enable syslog-logging
of levels 0-1 debugs() calls made by the master process.

The proposed combination should preserve the current syslog info while
allowing us to use modern ostream-style formatting that is usually more
convenient, often more powerful, and sometimes safer to use than
printf-style formatting used by syslog().


The proposed approach would also make it easier to add master process
debugging messages (that should not go to syslog by default). As Squid
master process becomes smarter (e.g., an upcoming patch adds initial
master reconfiguration support among other things), these debugging
messages become desperately needed.


What do you think?


Thank you,

Alex.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009230.html">[squid-dev] Cache poisoning vulnerability 3.5.23
</A></li>
	<LI>Next message: <A HREF="009232.html">[squid-dev] [RFC] Migrate explicit syslog calls to debugs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9231">[ date ]</a>
              <a href="thread.html#9231">[ thread ]</a>
              <a href="subject.html#9231">[ subject ]</a>
              <a href="author.html#9231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
