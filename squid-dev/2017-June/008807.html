<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [BUG] Incorrect &quot;FS Block Size&quot; printed by cachemgr.cgi for the Rock store
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BBUG%5D%20Incorrect%20%22FS%20Block%20Size%22%20printed%20by%0A%20cachemgr.cgi%20for%20the%20Rock%20store&In-Reply-To=%3C877631f2-3b84-5634-0e31-47ef88ae57f3%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008804.html">
   <LINK REL="Next"  HREF="008805.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [BUG] Incorrect &quot;FS Block Size&quot; printed by cachemgr.cgi for the Rock store</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BBUG%5D%20Incorrect%20%22FS%20Block%20Size%22%20printed%20by%0A%20cachemgr.cgi%20for%20the%20Rock%20store&In-Reply-To=%3C877631f2-3b84-5634-0e31-47ef88ae57f3%40measurement-factory.com%3E"
       TITLE="[squid-dev] [BUG] Incorrect &quot;FS Block Size&quot; printed by cachemgr.cgi for the Rock store">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jun  9 04:56:08 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008804.html">[squid-dev] [BUG] Incorrect &quot;FS Block Size&quot; printed by cachemgr.cgi for the Rock store
</A></li>
        <LI>Next message: <A HREF="008805.html">[squid-dev] [POSSIBLE BUG???] &quot;FS Block Size = 1024&quot; printed by	cachemgr.cgi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8807">[ date ]</a>
              <a href="thread.html#8807">[ thread ]</a>
              <a href="subject.html#8807">[ subject ]</a>
              <a href="author.html#8807">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/08/2017 09:06 PM, St√©phane Ouellette wrote:

&gt;<i>    while I was testing the use of the rock store on a ZFS pool using
</I>&gt;<i> file system block sizes of 4K, 8K and 16K, I noticed that cachemgr.cgi
</I>&gt;<i> always printed &quot;FS Block Size = 1024&quot; in all cases.
</I>&gt;<i> 
</I>&gt;<i>    I tracked down the issue by comparing Rock::SwapDir::init() to
</I>&gt;<i> Fs::Ufs::UFSSwapDir::init(). I discovered a missing instruction.
</I>&gt;<i> Following is the proposed patch that applies to Squid 3.5.26.
</I>
Thank you for investigating this! I agree that there is a bug, but I
think the underlying issue is actually located elsewhere. AFAICT, Rock
does not use the file system block or fragment size. Thus, the correct
fix is not to add unused code to Rock, but to move this UFS-only
feature, including sizeInBlocks() to Fs::Ufs classes.

Can you make the corresponding patch please?

Alex.
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008804.html">[squid-dev] [BUG] Incorrect &quot;FS Block Size&quot; printed by cachemgr.cgi for the Rock store
</A></li>
	<LI>Next message: <A HREF="008805.html">[squid-dev] [POSSIBLE BUG???] &quot;FS Block Size = 1024&quot; printed by	cachemgr.cgi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8807">[ date ]</a>
              <a href="thread.html#8807">[ thread ]</a>
              <a href="subject.html#8807">[ subject ]</a>
              <a href="author.html#8807">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
