<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] switch session/connection for OpenSSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20switch%20session/connection%20for%20OpenSSL&In-Reply-To=%3C570fef71-2068-9f83-9e82-3a2ae00113ab%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008830.html">
   <LINK REL="Next"  HREF="008835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] switch session/connection for OpenSSL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20switch%20session/connection%20for%20OpenSSL&In-Reply-To=%3C570fef71-2068-9f83-9e82-3a2ae00113ab%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] switch session/connection for OpenSSL">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jun 10 12:27:41 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008830.html">[squid-dev] Jenkins build is back to normal : 5-matrix » gcc,d-debian-unstable #199
</A></li>
        <LI>Next message: <A HREF="008835.html">[squid-dev] [PATCH] Adds support for --long-acl-options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8832">[ date ]</a>
              <a href="thread.html#8832">[ thread ]</a>
              <a href="subject.html#8832">[ subject ]</a>
              <a href="author.html#8832">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/04/17 05:24, Alex Rousskov wrote:
&gt;<i> Needless to say, I would be happy if we can come up with better
</I>&gt;<i> definitions or even better concepts. The above is a starting point.
</I>&gt;<i>
</I>
I do not think it is up to us to define these things. So I have taken a 
much longer reading of all the RFCs since SSLv3.0 through to current 
TLS/1.3 and isolated what are the authoritative definitions AFAICT.

The attached patch:

* updates some of the libsecurity API documentation to reference the 
relevant RFC definitions and sections.

* moves the pieces that are doing what is defined as solely TLS 
Connection things to security/TlsConnection.* files.

* adds a Security::TlsConnection::Pointer type for use by code dealing 
with TLS Connection logic.
  - SessionPointer still exists for code performing TLS Session logic. 
see PeerConnector description for the distinction.
  - I have not gone through and renamed uses of SessionPointer beyond 
those directly involved with the above code shuffle.


Yes this is far from complete, and intentionally much smaller that the 
previous patch. I am limiting the scope here to these things which have 
RFC definitions, and making their names consistent with those 
definitions where there was a conflict.


PS: Applying the definitions to PeerConnector, it has become clear that 
it (and children) not following a MUST requirement about the underlying 
TCP transport connection being terminated in the case where Handshake 
negotiation failed due to a Record protocol violation. They are leaving 
this closure to the caller which is a layering violation - that caller 
being required to watch the Comm::Connection for close() anyway AND 
Squid being the client, indicates there is not a strong case for doing that.


Amos

-------------- next part --------------
A non-text attachment was scrubbed...
Name: TlsConnection_mk1.patch
Type: text/x-patch
Size: 46617 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170611/ef83fc69/attachment-0001.bin">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170611/ef83fc69/attachment-0001.bin</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008830.html">[squid-dev] Jenkins build is back to normal : 5-matrix » gcc,d-debian-unstable #199
</A></li>
	<LI>Next message: <A HREF="008835.html">[squid-dev] [PATCH] Adds support for --long-acl-options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8832">[ date ]</a>
              <a href="thread.html#8832">[ thread ]</a>
              <a href="subject.html#8832">[ subject ]</a>
              <a href="author.html#8832">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
