<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Adds support for --long-acl-options
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Adds%20support%20for%20--long-acl-options&In-Reply-To=%3Cf2edae5f-21d2-f082-69f6-f9d7c59f23d6%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008832.html">
   <LINK REL="Next"  HREF="008837.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Adds support for --long-acl-options</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Adds%20support%20for%20--long-acl-options&In-Reply-To=%3Cf2edae5f-21d2-f082-69f6-f9d7c59f23d6%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] Adds support for --long-acl-options">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jun 10 13:30:32 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008832.html">[squid-dev] [PATCH] switch session/connection for OpenSSL
</A></li>
        <LI>Next message: <A HREF="008837.html">[squid-dev] [PATCH] Adds support for --long-acl-options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8835">[ date ]</a>
              <a href="thread.html#8835">[ thread ]</a>
              <a href="subject.html#8835">[ subject ]</a>
              <a href="author.html#8835">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/05/17 20:31, Christos Tsantilas wrote:
&gt;<i> Adds support for --long-acl-options
</I>&gt;<i>
</I>&gt;<i> This patch adds support for --long-acl-options. The old single-letter 
</I>&gt;<i> ACL &quot;flags&quot; code was refactored to support long option names (with 
</I>&gt;<i> option-specific value types) without significant per-ACL-object 
</I>&gt;<i> performance/RAM overheads and without creating a global registry for 
</I>&gt;<i> all possible options. This refactoring (unexpectedly) resulted in 
</I>&gt;<i> removal of a lot of unreliable static initialization code.
</I>&gt;<i>
</I>&gt;<i> Refactoring fixed ACL flags parsing code that was dangerously 
</I>&gt;<i> misinterpreting -i and +i flags in several contexts. For example, each 
</I>&gt;<i> of the three cases below was misinterpreted as if three domains were 
</I>&gt;<i> configured (e.g., &quot;+i&quot;, &quot;-z&quot;, and &quot;example.com&quot;) on each line instead 
</I>&gt;<i> of one domain (&quot;example.com&quot;):
</I>&gt;<i>
</I>&gt;<i>         acl parsedAsThreeDomains dstdomain +i -i .example.com
</I>&gt;<i>         acl parsedAsThreeDomains dstdomain -i +i .example.com
</I>&gt;<i>         acl parsedAsThreeDomains dstdomain +i -z .example.com
</I>&gt;<i>
</I>&gt;<i> TODO: Finish ACL::clone() removal. Then consider removing any unused 
</I>&gt;<i> ACLData::clone() and associated ACL/ACLData copying methods.
</I>&gt;<i>
</I>&gt;<i> This is a Measurement Factory project.
</I>&gt;<i>
</I>
Okay, think I've got it now. Sorry it took so long to get around to. I'm 
not completely sure I saw everything yet, but I'm unlikely to do a 
better job of review anytime soon.

Just one thing to add on top of Ales' requests:

* please use src/acl/forward.h instead of AclRegs.h to define the global 
Init() function. There is no real need AFAICT to add the new file now 
only to remove again in the followup patch that will be needed to move 
AclRegs.cc into src/acl/ where it belongs.


+1 with the above change and Alexs' polishing requests.


Amos

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008832.html">[squid-dev] [PATCH] switch session/connection for OpenSSL
</A></li>
	<LI>Next message: <A HREF="008837.html">[squid-dev] [PATCH] Adds support for --long-acl-options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8835">[ date ]</a>
              <a href="thread.html#8835">[ thread ]</a>
              <a href="subject.html#8835">[ subject ]</a>
              <a href="author.html#8835">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
