<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Fwd: RFP: ssl-bump support for upstream proxy in	transparent mode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20RFP%3A%20ssl-bump%20support%20for%20upstream%20proxy%20in%0A%09transparent%20mode&In-Reply-To=%3Cd7176150cc0857364677d2d615b19c0f%40sss.chaoslab.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009073.html">
   <LINK REL="Next"  HREF="009075.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Fwd: RFP: ssl-bump support for upstream proxy in	transparent mode</H1>
    <B>Alexandr</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20RFP%3A%20ssl-bump%20support%20for%20upstream%20proxy%20in%0A%09transparent%20mode&In-Reply-To=%3Cd7176150cc0857364677d2d615b19c0f%40sss.chaoslab.ru%3E"
       TITLE="[squid-dev] Fwd: RFP: ssl-bump support for upstream proxy in	transparent mode">sss at sss.chaoslab.ru
       </A><BR>
    <I>Fri Jun 30 17:21:30 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="009073.html">[squid-dev] Προσωπικά Δεδομένα και GDPR Compliance
</A></li>
        <LI>Next message: <A HREF="009075.html">[squid-dev] [PATCH] Happy Eyeballs: Deliver DNS results to peer	selection ASAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9072">[ date ]</a>
              <a href="thread.html#9072">[ thread ]</a>
              <a href="subject.html#9072">[ subject ]</a>
              <a href="author.html#9072">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

-------- Исходное сообщение --------
Тема: RFP: ssl-bump support for upstream proxy in transparent mode
Дата: 2017-06-25 01:38
От: Alexandr &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">sss at sss.chaoslab.ru</A>&gt;
Кому: <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

good day.
i am interested in ssl-bump, or at list splice in transparent mode for
upstream proxy.
use-case:
1. squid used in transparent mode like this:
iptables:
iptables -t nat -A PREROUTING -i br0 -p tcp -m tcp --dport 80 -j DNAT
- --to-destination 192.168.0.1:3129
iptables -t nat -A PREROUTING -i br0 -p tcp -m tcp --dport 443 -j DNAT
- --to-destination 192.168.0.1:3130
squid.conf:
cache_peer 192.168.0.1 parent 8118 0 no-digest no-query no-netdb-
exchange no-delay name=tor max-conn=8 standby=2 default
cache_peer 192.168.0.1 parent 8128 0 no-digest no-query no-netdb-
exchange no-delay name=i2p max-conn=16 standby=4 default

cache_peer_access i2p allow i2p
cache_peer_access i2p deny all
cache_peer_access tor allow tor
cache_peer_access tor allow blocked_russia
cache_peer_access tor deny all

never_direct allow tor
never_direct allow blocked_russia
never_direct allow i2p

always_direct deny tor
always_direct deny blocked_russia
always_direct deny i2p


http_port 192.168.0.1:3129 intercept
https_port 192.168.0.1:3130 intercept ssl-bump connection-auth=off
generate-host-certificates=on dynamic_cert_mem_cache_size=8MB
cert=/etc/squid/ssl/example.com.cert
key=/etc/squid/ssl/example.com.private cipher=HIGH:!WEAK:!MEDIUM:!RC4
sslflags=VERIFY_CRL_ALL

//currently configured to splice ssl connections via tor/i2p and
blocked_russia acls

2. ssl-bump/splice is required for all connections
3. most internet is accessible directly, but some parts accessible only
via upstream proxy, in transparent mode ssl/tls connections via
upstream proxy currently does not work.

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEl/sA7WQg6czXWI/dsEApXVthX7wFAllO6fUACgkQsEApXVth
X7wmzA//QLVxTd4NI7sk+GtHnEWnClEd4eRDBvbVmQOol/aoRkOTjv9DHMhYjV5y
kkNoHeQUtlyTvwrLPNLt3PYmFD8vz3Kc+2KWnhSq0UxLBasgO8SDn5MqZOm+RV9R
P/7sVI37pjibW9d3euPl2Antxg2n8hhffKa97EcoWWnnmGUDzv3n1tHLnB5HafqI
W0DRORAcpuRocPZ1Y91uqKbPlJD9X4ANGIeHc/Pf2FMoOGmp/7YVoP4gWFRIgyK4
faMDlyCS3vNMhBZAE+/+jgGgkw84s2xUtdvgJCbglq+0kBoMxXSllQLzBNcuLs1X
+0wuvs8GtL7mOcYGe5HmHbe5zYmNHe2fI+BKTE/Cq1IxlNXq7H+Ad4zfhvWkVjTy
1uy2s9E6mNb7BOn86wmI7QsqZS4G37nQVq++VDNu95GWXecenoErDvY37CXtKIJ8
Jmn77Z9KyWfrM6kZLKMQZHvGsm1geYMOM0MgxvuujC1nfqRbzPhqGeTbZI2QoeFl
yUUtOCJNznYdpBCfExyUBMjHTot3mY2Cwpyv/x+EwGj6lwqKhDBrbpwTmW4wr8v0
frOOLsXYPiMw5pp/SMqj4YglxIqQSsA+/ZZ1rJ1oXowkJcz4WRTxYoW7m6yDwDbo
hmVPtGz36r74AW+aGgrvE+8akxnC0Z6WyWe9SHHnydw+REbe2yo=
=NZDU
-----END PGP SIGNATURE-----
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009073.html">[squid-dev] Προσωπικά Δεδομένα και GDPR Compliance
</A></li>
	<LI>Next message: <A HREF="009075.html">[squid-dev] [PATCH] Happy Eyeballs: Deliver DNS results to peer	selection ASAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9072">[ date ]</a>
              <a href="thread.html#9072">[ thread ]</a>
              <a href="subject.html#9072">[ subject ]</a>
              <a href="author.html#9072">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
