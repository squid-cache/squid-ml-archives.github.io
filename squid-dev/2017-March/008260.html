<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Fwd: [PATCH] for loops modernization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20%5BPATCH%5D%20for%20loops%20modernization&In-Reply-To=%3C8712fb53-0105-a207-ea09-1590a0e50e38%40suse.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008259.html">
   <LINK REL="Next"  HREF="008265.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Fwd: [PATCH] for loops modernization</H1>
    <B>Adam Majer</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20%5BPATCH%5D%20for%20loops%20modernization&In-Reply-To=%3C8712fb53-0105-a207-ea09-1590a0e50e38%40suse.de%3E"
       TITLE="[squid-dev] Fwd: [PATCH] for loops modernization">amajer at suse.de
       </A><BR>
    <I>Wed Mar 15 12:57:14 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008259.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
        <LI>Next message: <A HREF="008265.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8260">[ date ]</a>
              <a href="thread.html#8260">[ thread ]</a>
              <a href="subject.html#8260">[ subject ]</a>
              <a href="author.html#8260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/15/2017 11:43 AM, khaled belhout wrote:
&gt;<i> hello Alex
</I>&gt;<i> I fixed the naming of the current iteration object, limited the
</I>&gt;<i> changes to &quot;src/adaptation&quot; sub tree and replaced NULL macro by
</I>&gt;<i> nullptr keyword.
</I>
I don't want to be too critical about this, but these types of changes
do not add anything. They actually make the code more difficult to maintain.

For example,

-    if (HttpRequest *r = dynamic_cast&lt;HttpRequest*&gt;(theMsg)) {
+    if (auto *r = dynamic_cast&lt;HttpRequest*&gt;(theMsg)) {

Nothing is gained here. On the contrary, it is not immediately known to
the reader what this `auto` type actually is until they look to the
right. So what are we saving?


-Adaptation::Message::Message(): header(NULL)
+Adaptation::Message::Message(): header(nullptr)

NULL and nullptr are the same thing for these purposes. Actually, the
most likely implementation of NULL macro in C++11 is just

#define NULL nullptr

I have no problem in using either, but changing this just for the same
of changing it....

Another example,

     typedef Master::Extensions::const_iterator MECI;
-    for (MECI i = master.extensions.begin(); i !=
master.extensions.end(); ++i) {
-        if (name == i-&gt;first)
-            return Area(i-&gt;second.data(), i-&gt;second.size());
+    for (const auto &amp; extension : master.extensions) {
+        if (name == extension.first)
+            return Area(extension.second.data(), extension.second.size());
     }

In this example, you've not even removed MECI typedef. But basically the
point here is this makes is even more complicated to know the type you
are referring to. The compiler knows, but the developer? I have no idea.
master.extentions can be anything with iterator.

If you really want to fix this, avoid `auto` in code people actually
want to maintain. The only place it is actually useful is in heavily
templated code and that is the main reason it was introduced. It was not
introduced so you can avoid typing the name of POS (plain old
structures) or types or classes.

This is where you *may* want to use auto, like

std::vector&lt;std::pair&lt;int, std::unique&lt;Something&gt;&gt;&gt; my_awesome_vector;
for (const auto &amp;p : my_awesome_vector) {
    ....
}

But if you have,

std::vector&lt;Something&gt; some_vector;
for (const Something &amp;thing : some_vector) {
   ...
}

because using

for (const auto &amp;thing : some_vector) {
   ...
}

doesn't really save you anything, it just makes it worse.

These are just my personal opinions. Others may disagree.

- Adam

</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008259.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
	<LI>Next message: <A HREF="008265.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8260">[ date ]</a>
              <a href="thread.html#8260">[ thread ]</a>
              <a href="subject.html#8260">[ subject ]</a>
              <a href="author.html#8260">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
