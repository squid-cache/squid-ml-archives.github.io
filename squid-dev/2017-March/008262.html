<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Fwd: [PATCH] for loops modernization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20%5BPATCH%5D%20for%20loops%20modernization&In-Reply-To=%3Cc29d384c-185b-15c5-b1a9-168cb3b21fc7%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008287.html">
   <LINK REL="Next"  HREF="008243.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Fwd: [PATCH] for loops modernization</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Fwd%3A%20%5BPATCH%5D%20for%20loops%20modernization&In-Reply-To=%3Cc29d384c-185b-15c5-b1a9-168cb3b21fc7%40measurement-factory.com%3E"
       TITLE="[squid-dev] Fwd: [PATCH] for loops modernization">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Mar 15 14:32:16 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008287.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
        <LI>Next message: <A HREF="008243.html">[squid-dev] [PATCH] Honor peer timeouts when forwarding CONNECTs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8262">[ date ]</a>
              <a href="thread.html#8262">[ thread ]</a>
              <a href="subject.html#8262">[ subject ]</a>
              <a href="author.html#8262">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/15/2017 04:43 AM, khaled belhout wrote:

&gt;<i> I fixed the naming of the current iteration object, 
</I>
Thank you. FWIW, it is not necessary to add _ptr and similar suffixes to
object names when the fact that it is a pointer (or a reference, or a
copy) is unimportant.


&gt;<i> limited the changes to &quot;src/adaptation&quot; sub tree
</I>
Why?!


&gt;<i> and replaced NULL macro by nullptr keyword.
</I>
You should not have:

* Due to the same porting overhead concerns that I was trying to explain
earlier, we only replace NULLs when the code needs to be changed for
other reasons.

* Mixing benign NULL and potentially deadly (for performance or
const-correctness) auto changes complicates review.


BTW, I am not sure, but I believe the updated patch still seems to be
missing &quot;const&quot; in at least one &quot;auto&quot; conversion case. I did not check
all of them because of the NULL replacement noise.


In summary: I still do not think these changes are desirable (even in
their polished variant), but if others overrule me on that, my comments
about the quality of the current changes still apply.


Thank you,

Alex.


&gt;<i> 2017-03-13 14:45 GMT+01:00 Alex Rousskov &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt;:
</I>&gt;&gt;<i> On 03/12/2017 08:42 PM, khaled belhout wrote:
</I>&gt;&gt;&gt;<i> I used clang-tidy tool to modernize all these loops.
</I>&gt;&gt;&gt;<i> <A HREF="http://clang.llvm.org/extra/clang-tidy/">http://clang.llvm.org/extra/clang-tidy/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It looks like that tool is not ready for fully automated use. If you
</I>&gt;&gt;<i> want to fix its results, please use &quot;const auto&quot; where possible and
</I>&gt;&gt;<i> avoid using &quot;i&quot; for naming the current iteration object.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> we can take the advantage of the tool by selecting the changes that
</I>&gt;&gt;&gt;<i> make code more readable understandable and maintainable.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please do not misinterpret my earlier comments as an argument against
</I>&gt;&gt;<i> range loops. Range loops are good and new code should use them!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However, I doubt the advantages of changing those old loops outweigh
</I>&gt;&gt;<i> cross-branch development costs right now. Others may disagree, and, if
</I>&gt;&gt;<i> they do, I would not object to a polished patch being committed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2017-03-12 16:31 GMT+01:00 Alex Rousskov:
</I>&gt;&gt;&gt;&gt;<i> On 03/12/2017 07:45 AM, khaled belhout wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> this patch modernize for loops using c++11 Range-based for loop
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Please use &quot;const auto&quot; where possible and avoid using &quot;i&quot; for naming
</I>&gt;&gt;&gt;&gt;<i> the current iteration object.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am curious why did you decide to change all these loops? How did you
</I>&gt;&gt;&gt;&gt;<i> select the loops to change? Normally, we avoid wide-spread polishing
</I>&gt;&gt;&gt;&gt;<i> touches to minimize the price developers working with older code have to
</I>&gt;&gt;&gt;&gt;<i> pay when porting back various bug fixes and features. I am trying to
</I>&gt;&gt;&gt;&gt;<i> decide whether the advantages of changing these loops outweigh those
</I>&gt;&gt;&gt;&gt;<i> costs in this case.
</I>&gt;&gt;<i>
</I>
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008287.html">[squid-dev] Fwd: [PATCH] for loops modernization
</A></li>
	<LI>Next message: <A HREF="008243.html">[squid-dev] [PATCH] Honor peer timeouts when forwarding CONNECTs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8262">[ date ]</a>
              <a href="thread.html#8262">[ thread ]</a>
              <a href="subject.html#8262">[ subject ]</a>
              <a href="author.html#8262">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
