<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] To make squid works in snap world.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20To%20make%20squid%20works%20in%20snap%20world.&In-Reply-To=%3C1e036458-637e-db91-2efb-797787ae7910%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008258.html">
   <LINK REL="Next"  HREF="008268.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] To make squid works in snap world.</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20To%20make%20squid%20works%20in%20snap%20world.&In-Reply-To=%3C1e036458-637e-db91-2efb-797787ae7910%40measurement-factory.com%3E"
       TITLE="[squid-dev] To make squid works in snap world.">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Mar 15 16:33:43 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008258.html">[squid-dev] To make squid works in snap world.
</A></li>
        <LI>Next message: <A HREF="008268.html">[squid-dev] To make squid works in snap world.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8267">[ date ]</a>
              <a href="thread.html#8267">[ thread ]</a>
              <a href="subject.html#8267">[ subject ]</a>
              <a href="author.html#8267">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/15/2017 03:24 AM, Gary Wang wrote:
&gt;<i> Regarding the confinement of usage of shared memory in snap world,
</I>&gt;<i>        Please take a look at the bug
</I>&gt;<i>        <A HREF="https://bugs.launchpad.net/snappy/+bug/1653955">https://bugs.launchpad.net/snappy/+bug/1653955</A>
</I>
The above bug is about semaphores. Squid does not use semaphores (our
implementation of shared memory objects is lockless). Squid uses shared
memory segments created by shm_open(), not sem_open() system calls.

The above bug description appears to imply that snap allows
/dev/shm/snap.@{SNAP_NAME}.* names, which are not the names used in your
prior examples (IIRC). The sem.* pattern you used confused reviewers
into thinking that you are trying to solve the wrong problem. The actual
problem you are trying to solve (AFAICT) is valid and is not about the
&quot;sem.&quot; prefix but about the &quot;snap.&quot; prefix.


&gt;<i>        And Jamie's reply can be fuond in snapcraft maillist      
</I>&gt;<i>  <A HREF="https://www.mail-archive.com/snapcraft@lists.snapcraft.io/msg02465.html">https://www.mail-archive.com/snapcraft@lists.snapcraft.io/msg02465.html</A>
</I>
Again, that feels like an irrelevant piece of information here because
it is specific to semaphores that Squid does not use.


If I am right, then your argument should be something like this:

1. Snap does not allow arbitrary names in /dev/shm/.
2. Snap allows names matching /dev/shm/snap.@{SNAP_NAME}.* (and others)
3. I need to make Squid names for /dev/shm/ files configurable
   so that they can be forced to match one of the snap-allowed patterns.


Please note that it is theoretically possible that OS shm_open()
implementation (in Squid context) creates some secret temporary files
just like sem_open() does in Python context. That would mean that other
names/patterns may be in play here as well. However, since you know that
your patch &quot;works&quot;, my argument sketch above remains valid even if there
are other OS-created names that we do not know about.


HTH,

Alex.

</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008258.html">[squid-dev] To make squid works in snap world.
</A></li>
	<LI>Next message: <A HREF="008268.html">[squid-dev] To make squid works in snap world.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8267">[ date ]</a>
              <a href="thread.html#8267">[ thread ]</a>
              <a href="subject.html#8267">[ subject ]</a>
              <a href="author.html#8267">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
