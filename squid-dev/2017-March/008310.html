<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Fix ext_session_acl to handle - when no	argument is passed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Fix%20ext_session_acl%20to%20handle%20-%20when%20no%0A%09argument%20is%20passed&In-Reply-To=%3Cd7ed0ac9-02dc-8610-81ef-37014885e60f%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008317.html">
   <LINK REL="Next"  HREF="008312.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Fix ext_session_acl to handle - when no	argument is passed</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Fix%20ext_session_acl%20to%20handle%20-%20when%20no%0A%09argument%20is%20passed&In-Reply-To=%3Cd7ed0ac9-02dc-8610-81ef-37014885e60f%40treenet.co.nz%3E"
       TITLE="[squid-dev] [PATCH] Fix ext_session_acl to handle - when no	argument is passed">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Mar 22 05:43:08 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008317.html">[squid-dev] [RFC] Do not use idle dead peers
</A></li>
        <LI>Next message: <A HREF="008312.html">[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8310">[ date ]</a>
              <a href="thread.html#8310">[ thread ]</a>
              <a href="subject.html#8310">[ subject ]</a>
              <a href="author.html#8310">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/03/2017 3:36 a.m., Trever L. Adams wrote:
&gt;<i> On 03/20/2017 05:47 AM, Trever L. Adams wrote:
</I>&gt;&gt;<i> This is pull #1 on github if that is the correct place to do this.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Trever
</I>&gt;&gt;<i>
</I>&gt;<i> I am sorry, I sent the wrong patch. Pull request has been corrected as well.
</I>&gt;<i> 
</I>

Hi Trever,
 Can you explain the problem and intended behaviour change? the title of
the PR does not tell much.


FYI: the current contents of github are experiments which will be remove
or replaced shortly. AFAIK the plan is that the 'squid' repository name
will be the one used in future, however the current contents are going
to be replaced shortly. Please do not rely on them until an announcement
comes out about the migration. Apologies for the inconvenience.

Amos

PS. for squid-dev the patch submission was:

ext_session_acl_no_argument.patch

diff --git a/src/acl/external/session/ext_session_acl.cc
b/src/acl/external/session/ext_session_acl.cc
index 09ff163..e252165 100644
--- a/src/acl/external/session/ext_session_acl.cc
+++ b/src/acl/external/session/ext_session_acl.cc
@@ -202,15 +202,13 @@ int main(int argc, char **argv)
         char *lastdetail = strrchr(detail, ' ');
         size_t detail_len = strlen(detail);
         if (lastdetail) {
+            detail_len = (size_t)(lastdetail-detail);
             if (strcmp(lastdetail, &quot; LOGIN&quot;) == 0) {
                 action = 1;
-                detail_len = (size_t)(lastdetail-detail);
-                *lastdetail = '\0';
             } else if (strcmp(lastdetail, &quot; LOGOUT&quot;) == 0) {
                 action = -1;
-                detail_len = (size_t)(lastdetail-detail);
-                *lastdetail = '\0';
             }
+            *lastdetail = '\0';
         }
         if (action == -1) {
             session_logout(detail, detail_len);

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008317.html">[squid-dev] [RFC] Do not use idle dead peers
</A></li>
	<LI>Next message: <A HREF="008312.html">[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8310">[ date ]</a>
              <a href="thread.html#8310">[ thread ]</a>
              <a href="subject.html#8310">[ subject ]</a>
              <a href="author.html#8310">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
