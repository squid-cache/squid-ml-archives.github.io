<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Fix%20ext_session_acl%20to%20handle%20-%20when%20no%0A%20argument%20is%20passed&In-Reply-To=%3C08fa4706-b998-33de-d9af-26026caf4d56%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008319.html">
   <LINK REL="Next"  HREF="008323.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Fix%20ext_session_acl%20to%20handle%20-%20when%20no%0A%20argument%20is%20passed&In-Reply-To=%3C08fa4706-b998-33de-d9af-26026caf4d56%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Mar 23 14:46:03 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008319.html">[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed
</A></li>
        <LI>Next message: <A HREF="008323.html">[squid-dev] on_unsupported_protocol rewrite to support tcp	connection relay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8321">[ date ]</a>
              <a href="thread.html#8321">[ thread ]</a>
              <a href="subject.html#8321">[ subject ]</a>
              <a href="author.html#8321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/22/2017 07:53 PM, Amos Jeffries wrote:

&gt;<i> This helpers' passive mode does not need to care what the input is, so
</I>&gt;<i> long as it is consistent.
</I>
I do not recommend ignoring input format in hope that ignored input is
consistent/acceptable/compatible/etc. However, I am not going to object
to any changes to this helper, even if they violate that general
principle, so feel free to commit whatever you think is the best. I do
not plan on following this thread further.


&gt;<i> The admin may still use %DATA in either mode, so not touching the input
</I>&gt;<i> seems to be the better way to go except where there is no choice.
</I>
Using %DATA explicitly at the expected location (i.e., last) is not a
problem. Using it in unexpected and possibly unsupported places is.


&gt;&gt;<i> I would expect something along these lines instead (pseudo code):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   // What action was requested (including no/default action)?
</I>&gt;&gt;<i>   if (... LOGIN ...) action = 1;
</I>&gt;&gt;<i>   else if (... LOGOUT ...) action = -1;
</I>&gt;&gt;<i>   else if (... - ...) action = default_action;
</I>&gt;&gt;<i>   else { ... BH unexpected query format ...; continue; }
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> That will result in BH for passive mode when the admin wants to use
</I>&gt;<i> %DATA in the format string (unless it is last).
</I>
Yes, and I think that would be the right behavior for the helper.

The only counter argument that I can think of is that undocumented(?)
passive helper functionality correctly uses (not just tolerates/ignores
but _uses_) arbitrary query input past the source address. It is
difficult for me to imagine a good helper design that would allow for
such a thing but that does not mean it cannot exist. Please note that
this counter argument does not apply to the active helper where the
action ought to be required even when arbitrary query input is used.


&gt;<i> The &quot;// else do nothing&quot; is explicitly added by my patch to document
</I>&gt;<i> that the case of unknown other values is valid/expected and to not touch
</I>&gt;<i> the contents of 'detail' when it happens.
</I>
The comment does not explain _why_ we should do nothing so it is 50%
useless because it just retells what the code is already saying. The 50%
usefulness comes from relaying the fact that the developer actually
thought about the non-obvious &quot;else&quot; case (but then decided to hide his
reasons for doing nothing in that case).


Cheers,

Alex.

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008319.html">[squid-dev] [PATCH] Fix ext_session_acl to handle - when no argument is passed
</A></li>
	<LI>Next message: <A HREF="008323.html">[squid-dev] on_unsupported_protocol rewrite to support tcp	connection relay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8321">[ date ]</a>
              <a href="thread.html#8321">[ thread ]</a>
              <a href="subject.html#8321">[ subject ]</a>
              <a href="author.html#8321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
