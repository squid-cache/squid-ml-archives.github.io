<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] squid-dev Digest, Vol 31, Issue 47
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20squid-dev%20Digest%2C%20Vol%2031%2C%20Issue%2047&In-Reply-To=%3Ctencent_4355E0F70C4780223495C284%40qq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008324.html">
   <LINK REL="Next"  HREF="008329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] squid-dev Digest, Vol 31, Issue 47</H1>
    <B>钱国正</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20squid-dev%20Digest%2C%20Vol%2031%2C%20Issue%2047&In-Reply-To=%3Ctencent_4355E0F70C4780223495C284%40qq.com%3E"
       TITLE="[squid-dev] squid-dev Digest, Vol 31, Issue 47">richard.qian at magicwifi.com.cn
       </A><BR>
    <I>Mon Mar 27 02:15:50 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008324.html">[squid-dev] on_unsupported_protocol rewrite to support tcp connection relay
</A></li>
        <LI>Next message: <A HREF="008329.html">[squid-dev] on_unsupported_protocol rewrite to support tcp	connection, relay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8327">[ date ]</a>
              <a href="thread.html#8327">[ thread ]</a>
              <a href="subject.html#8327">[ subject ]</a>
              <a href="author.html#8327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> I want to know what's the
</I>&gt;&gt;<i> pinning.serverConnection mean? and what it is used for?
</I>
&gt;<i>Before we dive into low-level details, please allow me to ask an
</I>&gt;<i>important high-level question. Your answer may render those low-level
</I>&gt;<i>detail irrelevant:
</I>
&gt;&gt;<i> I want to rewrite the on_unsupported_protocol to support tcp connection
</I>&gt;&gt;<i>(non-http protocol, called httpdns not readable, no http header) and
</I>&gt;&gt;<i> relay it the server. [...] I need assign the server's address and port
</I>
&gt;<i>Where will your code get the server address and port from? If the answer
</I>&gt;<i>is &quot;from the received httpdns message header&quot;, then please do not abuse
</I>&gt;<i>on_unsupported_protocol to support &quot;httpdns&quot;. Instead, add proper
</I>&gt;<i>support for httpdns (which may be limited to forwarding httpdns queries
</I>&gt;<i>to the right server if such blind forwarding makes sense).
</I>
No, I got it from `clientConnection-&gt;local`, the httpdns is just a tcp connection to server with
specified protocol, not known to me, it is designed by its user, use 80 port to transfer dns request.

&gt;<i>BTW, can you post a link to the &quot;httpdns&quot; protocol specification (not
</I>&gt;<i>API)? And what do you mean by &quot;not readable&quot;?
</I>


It is not a standard protocol in RFC or some standard specification, just some company use 
80 (default for http protocol) port to transfer dns request, they do this because in China many 
ISP would use they own dns server in different places which makes it slow 
or unreachable to the some company's service.


 
 
 
------------------ Original ------------------
From:  &quot;squid-dev-request&quot;&lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev-request at lists.squid-cache.org</A>&gt;;
Date:  Sat, Mar 25, 2017 08:00 PM
To:  &quot;squid-dev&quot;&lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>&gt;; 

Subject:  squid-dev Digest, Vol 31, Issue 47

 
Send squid-dev mailing list submissions to
	<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>
or, via email, send a message with subject or body 'help' to
	<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev-request at lists.squid-cache.org</A>

You can reach the person managing the list at
	<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev-owner at lists.squid-cache.org</A>

When replying, please edit your Subject line so it is more specific
than &quot;Re: Contents of squid-dev digest...&quot;


Today's Topics:

   1. Re: on_unsupported_protocol rewrite to support tcp connection
      relay (Alex Rousskov)


----------------------------------------------------------------------

Message: 1
Date: Fri, 24 Mar 2017 08:01:13 -0600
From: Alex Rousskov &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">rousskov at measurement-factory.com</A>&gt;
To: 钱国正 &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">richard.qian at magicwifi.com.cn</A>&gt;, squid-dev
	&lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>&gt;
Subject: Re: [squid-dev] on_unsupported_protocol rewrite to support
	tcp connection relay
Message-ID:
	&lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">d0c3afc9-6189-a659-37a4-69fb40586543 at measurement-factory.com</A>&gt;
Content-Type: text/plain; charset=utf-8

On 03/24/2017 04:54 AM, 钱国正 wrote:

&gt;<i> I want to know what's the
</I>&gt;<i> pinning.serverConnection mean? and what it is used for?
</I>
Before we dive into low-level details, please allow me to ask an
important high-level question. Your answer may render those low-level
detail irrelevant:

&gt;<i> I want to rewrite the on_unsupported_protocol to support tcp connection
</I>&gt;<i> (non-http protocol, called httpdns not readable, no http header) and
</I>&gt;<i> relay it the server. [...] I need assign the server's address and port
</I>
Where will your code get the server address and port from? If the answer
is &quot;from the received httpdns message header&quot;, then please do not abuse
on_unsupported_protocol to support &quot;httpdns&quot;. Instead, add proper
support for httpdns (which may be limited to forwarding httpdns queries
to the right server if such blind forwarding makes sense).

BTW, can you post a link to the &quot;httpdns&quot; protocol specification (not
API)? And what do you mean by &quot;not readable&quot;?


Thank you,

Alex.



------------------------------

Subject: Digest Footer

_______________________________________________
squid-dev mailing list
<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">squid-dev at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">http://lists.squid-cache.org/listinfo/squid-dev</A>


------------------------------

End of squid-dev Digest, Vol 31, Issue 47
*****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170327/f19b77bc/attachment.html">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20170327/f19b77bc/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008324.html">[squid-dev] on_unsupported_protocol rewrite to support tcp connection relay
</A></li>
	<LI>Next message: <A HREF="008329.html">[squid-dev] on_unsupported_protocol rewrite to support tcp	connection, relay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8327">[ date ]</a>
              <a href="thread.html#8327">[ thread ]</a>
              <a href="subject.html#8327">[ subject ]</a>
              <a href="author.html#8327">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
