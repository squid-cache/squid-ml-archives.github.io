<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] A new 'has' ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20A%20new%20%27has%27%20ACL&In-Reply-To=%3C0c4692d9-c71d-77cd-7ced-f195dae81ebf%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="008562.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] A new 'has' ACL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20A%20new%20%27has%27%20ACL&In-Reply-To=%3C0c4692d9-c71d-77cd-7ced-f195dae81ebf%40treenet.co.nz%3E"
       TITLE="[squid-dev] A new 'has' ACL">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon May  1 04:03:34 UTC 2017</I>
    <P><UL>
        
        <LI>Next message: <A HREF="008562.html">[squid-dev] A new 'has' ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8559">[ date ]</a>
              <a href="thread.html#8559">[ thread ]</a>
              <a href="subject.html#8559">[ subject ]</a>
              <a href="author.html#8559">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/05/17 01:05, Eduard Bagdasaryan wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I am working on a new 'has' ACL:
</I>&gt;<i>
</I>&gt;<i>   acl aclname has &lt;component&gt;
</I>&gt;<i>
</I>&gt;<i> where &quot;component&quot; is one of the following three tokens: request, 
</I>&gt;<i> response, or ALE.
</I>&gt;<i> For example:
</I>&gt;<i>
</I>&gt;<i>   acl hasRequest has request
</I>&gt;<i>
</I>&gt;<i> Multiple components on one ACL line are not supported because they
</I>&gt;<i> would have to be ORed and ORing components would probably go against
</I>&gt;<i> admin expectaions in most cases:
</I>&gt;<i>
</I>&gt;<i>   acl hasWhatMyLoggingDaemonNeeds has request response # XXX: Likely 
</I>&gt;<i> to be wrong!
</I>&gt;<i>
</I>&gt;<i> Multiple same-name ACL lines would still be ORed to support arguably
</I>&gt;<i> rare use cases where ORing is appropriate:
</I>&gt;<i>
</I>&gt;<i>   # OK, this strange logging daemon needs request or response,
</I>&gt;<i>   # but can work without either a request or a response:
</I>&gt;<i>   acl hasWhatMyLoggingDaemonNeeds has request
</I>&gt;<i>   acl hasWhatMyLoggingDaemonNeeds has response
</I>&gt;<i>
</I>&gt;<i> This new ACL addresses a TODO in item #3 of trunk revision 14752,
</I>&gt;<i> adding that 'missing' configuration option.
</I>&gt;<i>
</I>&gt;<i> For example, the following configuration:
</I>&gt;<i>
</I>&gt;<i>   acl logMe note important_transaction
</I>&gt;<i>   access_log ... logformat=detailed logMe
</I>&gt;<i>
</I>&gt;<i> gives such 'noise' warning messages:
</I>&gt;<i>
</I>&gt;<i>   2017/01/06 12:54:46 kid2| WARNING: logMe ACL is used in context 
</I>&gt;<i> without an HTTP request. Assuming mismatch.
</I>&gt;<i>   2017/01/06 12:54:46 kid1| WARNING: logMe ACL is used in context 
</I>&gt;<i> without an HTTP request. Assuming mismatch.
</I>&gt;<i>
</I>&gt;<i> Once the &quot;has&quot; ACL is available, the admin can do either:
</I>&gt;<i>
</I>&gt;<i>   acl logMe note important_transaction
</I>&gt;<i>   access_log ... logformat=detailed hasRequest logMe
</I>&gt;<i>
</I>&gt;<i>   or even
</I>&gt;<i>
</I>&gt;<i>   acl logMe note important_transaction
</I>&gt;<i>   access_log ... logformat=detailed hasRequest logMe
</I>&gt;<i>   access_log ... logformat=brief !hasRequest logMe
</I>&gt;<i>
</I>&gt;<i>  If you think these specs miss something important, let's discuss.
</I>&gt;<i>
</I>
Thank you for working on this.


Is there an explicit need you have found for ALE to be on the component 
list?
Since ALE is currently standing in as a &quot;master transaction&quot; object for 
most of the Squid code. It needs to be either created or 
provided/fetched from elsewhere whenever it is used. Having an ACL that 
bypasses that would defeat bug-finding of places where it is broken.

Amos

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="008562.html">[squid-dev] A new 'has' ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8559">[ date ]</a>
              <a href="thread.html#8559">[ thread ]</a>
              <a href="subject.html#8559">[ subject ]</a>
              <a href="author.html#8559">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
