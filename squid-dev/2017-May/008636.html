<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] OpenSSL 1.1 regression
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20OpenSSL%201.1%20regression&In-Reply-To=%3C029fdf3f-cea7-b477-2505-c301b798e96a%40chtsanti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008634.html">
   <LINK REL="Next"  HREF="008635.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] OpenSSL 1.1 regression</H1>
    <B>Christos Tsantilas</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20OpenSSL%201.1%20regression&In-Reply-To=%3C029fdf3f-cea7-b477-2505-c301b798e96a%40chtsanti.net%3E"
       TITLE="[squid-dev] OpenSSL 1.1 regression">christos at chtsanti.net
       </A><BR>
    <I>Thu May 18 14:46:46 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008634.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
        <LI>Next message: <A HREF="008635.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8636">[ date ]</a>
              <a href="thread.html#8636">[ thread ]</a>
              <a href="subject.html#8636">[ subject ]</a>
              <a href="author.html#8636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/05/2017 03:12 μμ, Amos Jeffries wrote:
&gt;<i> On 18/05/17 23:12, Christos Tsantilas wrote:
</I>&gt;&gt;<i> On 17/05/2017 07:56 μμ, Alex Rousskov wrote:
</I>&gt;&gt;&gt;<i> On 05/17/2017 10:35 AM, Christos Tsantilas wrote:
</I>&gt;&gt;&gt;&gt;<i> +#if (OPENSSL_VERSION_NUMBER &gt;= 0x10002000L)
</I>&gt;&gt;&gt;&gt;<i> +    X509 * cert = SSL_CTX_get0_certificate(ctx.get());
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If it is possible to replace this version check with a ./configure-time
</I>&gt;&gt;&gt;<i> detection of SSL_CTX_get0_certificate() availability, please do that.
</I>&gt;&gt;&gt;<i> Avoiding OPENSSL_VERSION_NUMBER macros in new code may help with future
</I>&gt;&gt;&gt;<i> support for LibreSSL and/or other libraries that lie about OpenSSL API
</I>&gt;&gt;&gt;<i> version they provide.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For the t2 patch I am using the AC_CHECK_LIB autoconf macro to check
</I>&gt;&gt;<i> for the function availability.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>     <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4662">http://bugs.squid-cache.org/show_bug.cgi?id=4662</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Agrr... Using the openSSL version was the faster/easier way. Touching
</I>&gt;&gt;<i> autoconf may result to 2-3 full squid rebuilds to implement/test
</I>&gt;&gt;<i> similar fixes.
</I>&gt;<i>
</I>&gt;<i> The autoconf detection part can be designed and tested with just
</I>&gt;<i> bootstrap.sh and ./configure execution - then check what got set in
</I>&gt;<i> includes/autoconf.h and config.log. No need for the &quot;make&quot; parts of
</I>&gt;<i> building.
</I>
Well. Of course this is what someone must do. But you have always to 
build and test, to avoid typo errors for example or other simple mistakes.
And after you are finished with this you are finding that it would be 
better to move a check into the if-not-found [] path to speed-up 
configure script!


&gt;<i>
</I>&gt;<i> Amos
</I></PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008634.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
	<LI>Next message: <A HREF="008635.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8636">[ date ]</a>
              <a href="thread.html#8636">[ thread ]</a>
              <a href="subject.html#8636">[ subject ]</a>
              <a href="author.html#8636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
