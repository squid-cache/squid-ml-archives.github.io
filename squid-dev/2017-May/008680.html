<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [PATCH] Happy Eyeballs: Use each fully resolved destination ASAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Happy%20Eyeballs%3A%20Use%20each%20fully%20resolved%0A%20destination%20ASAP&In-Reply-To=%3C172f62c8-4bb5-e8fd-d5d6-7d6d5590d720%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="008677.html">
   <LINK REL="Next"  HREF="008614.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [PATCH] Happy Eyeballs: Use each fully resolved destination ASAP</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BPATCH%5D%20Happy%20Eyeballs%3A%20Use%20each%20fully%20resolved%0A%20destination%20ASAP&In-Reply-To=%3C172f62c8-4bb5-e8fd-d5d6-7d6d5590d720%40measurement-factory.com%3E"
       TITLE="[squid-dev] [PATCH] Happy Eyeballs: Use each fully resolved destination ASAP">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu May 25 16:18:32 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="008677.html">[squid-dev] [PATCH] Happy Eyeballs: Use each fully resolved destination ASAP
</A></li>
        <LI>Next message: <A HREF="008614.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8680">[ date ]</a>
              <a href="thread.html#8680">[ thread ]</a>
              <a href="subject.html#8680">[ subject ]</a>
              <a href="author.html#8680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/24/2017 10:27 PM, Amos Jeffries wrote:

&gt;<i> Are you aware of the socket expense issue inherent in Happy Eyeballs?
</I>
Yes, I am. This series of patches does not deal with the Happy Eyeballs
parts that increase the number of sockets, but, if those parts are
eventually implemented, the increase should be taken into account (e.g.,
limited or enabled/disabled via configuration), of course. Discussing
whether and how to do that is outside this thread scope.


&gt;&gt;&gt;<i> The synchronous processing may make the one transaction
</I>&gt;&gt;&gt;<i> reach connection faster, but that is just taking CPU cycles from /
</I>&gt;&gt;&gt;<i> slowing other transactions.
</I>
&gt;&gt;<i> The patch parallelizes second DNS lookup and first HTTP transaction
</I>&gt;&gt;<i> execution. That parallelization is not about CPU cycles but about the
</I>&gt;&gt;<i> time the first HTTP transaction spends waiting for (blocked on) that
</I>&gt;&gt;<i> second (and usually unused) DNS lookup in the old code. The patched code
</I>&gt;&gt;<i> does not wait/block. Again, the gains from this optimization are not the
</I>&gt;&gt;<i> goal, but some environments will see them.
</I>
&gt;&gt;&gt;<i> It might be worth initiating that noteDestination() sub-path as async
</I>&gt;&gt;&gt;<i> step to avoid the remaining delay.
</I>
&gt;&gt;<i> Yes, and my second thread email stated that much. However, the reason
</I>&gt;&gt;<i> for making that call async is not performance optimization (async calls
</I>&gt;&gt;<i> make performance worse, not better!) or delays. The reason is to shorten
</I>&gt;&gt;<i> the call stack, reducing the number of balls in the air and localizing
</I>&gt;&gt;<i> bugs.
</I>
&gt;<i> I would be interested if there are any measurements on the above two
</I>&gt;<i> points
</I>
Sorry, I seem to have lost context here: The measurements of which &quot;two
points&quot; would you like to see? And what kind of measurements? I see
nothing in the previous email that makes sense to measure (in this
project scope)...

If you are talking about the &quot;parallelizes second DNS lookup and first
HTTP transaction execution&quot; part, then the performance gain from that
change can be as huge/tiny as the tester wants -- it heavily depends on
DNS and HTTP transaction delays.


Thank you,

Alex.

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008677.html">[squid-dev] [PATCH] Happy Eyeballs: Use each fully resolved destination ASAP
</A></li>
	<LI>Next message: <A HREF="008614.html">[squid-dev] OpenSSL 1.1 regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8680">[ date ]</a>
              <a href="thread.html#8680">[ thread ]</a>
              <a href="subject.html#8680">[ subject ]</a>
              <a href="author.html#8680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
