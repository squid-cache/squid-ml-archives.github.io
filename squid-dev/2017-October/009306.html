<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] proof of concept for mitm attack for all ssl including pinned certificates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20proof%20of%20concept%20for%20mitm%20attack%20for%20all%20ssl%0A%20including%20pinned%20certificates&In-Reply-To=%3Cda6358fa-3ad3-88a6-30f7-e5cbe5340e0b%40opendium.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="009307.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] proof of concept for mitm attack for all ssl including pinned certificates</H1>
    <B>Steve Hill</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20proof%20of%20concept%20for%20mitm%20attack%20for%20all%20ssl%0A%20including%20pinned%20certificates&In-Reply-To=%3Cda6358fa-3ad3-88a6-30f7-e5cbe5340e0b%40opendium.com%3E"
       TITLE="[squid-dev] proof of concept for mitm attack for all ssl including pinned certificates">steve at opendium.com
       </A><BR>
    <I>Wed Oct  4 13:08:49 UTC 2017</I>
    <P><UL>
        
        <LI>Next message: <A HREF="009307.html">[squid-dev] proof of concept for mitm attack for all ssl including pinned certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9306">[ date ]</a>
              <a href="thread.html#9306">[ thread ]</a>
              <a href="subject.html#9306">[ subject ]</a>
              <a href="author.html#9306">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/09/17 18:51, Eliezer Croitoru wrote:

&gt;<i> What exactly do you mean by proof of concept for such an attack?
</I>&gt;<i> With commodity hardware and normal budget you cannot attack pinned certificate.
</I>&gt;<i> The only &quot;efficient&quot; way to enable such an attack would be to patch the client side OS memory or Binary.
</I>
Pinning is _supposed_ to be disabled in cases where the certificate 
presented by the website is signed by a root certificate that was 
imported by the user, rather than in the device's default certificate 
store.  So in theory, a website with a pinned certificate can still be 
man-in-the-middled by Squid in the usual way, since Squid's CA 
certificate would have been manually imported into the device.

In practice, web browsers tend to follow this rule, but apps don't - for 
example, you can MITM communications between Chrome and Facebook's 
servers, but you can't MITM communications between the Facebook Android 
app and Facebook's servers.

The situation is further complicated by the fact that Android 7 disables 
the use of the user's trusted certificate store by all applications 
unless they specifically opt into it.  This renders Squid's sslbump 
functionality practically useless for those devices, even though the 
user has consented to being MITM'd by importing Squid's CA certificate.
 
<A HREF="https://android-developers.googleblog.com/2016/07/changes-to-trusted-certificate.html">https://android-developers.googleblog.com/2016/07/changes-to-trusted-certificate.html</A>

(For what its worth, our business is supplying esafety systems to 
schools, and we are of the opinion that Google have ruled Android 
devices out of the British education sector because schools cannot meet 
the UK government's safeguarding requirements when Android 7 devices are 
in use on their network).

-- 
  - Steve Hill
    Technical Director
    Opendium    Online Safety / Web Filtering    <A HREF="http://www.opendium.com">http://www.opendium.com</A>

    Enquiries                 Support
    ---------                 -------
    <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">sales at opendium.com</A>        <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">support at opendium.com</A>
    +44-1792-824568           +44-1792-825748
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="009307.html">[squid-dev] proof of concept for mitm attack for all ssl including pinned certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9306">[ date ]</a>
              <a href="thread.html#9306">[ thread ]</a>
              <a href="subject.html#9306">[ subject ]</a>
              <a href="author.html#9306">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
