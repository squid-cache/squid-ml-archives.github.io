<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Converting squid to library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Converting%20squid%20to%20library&In-Reply-To=%3Cd30c84a0-15bb-0078-cd25-0db6f2113f2e%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009449.html">
   <LINK REL="Next"  HREF="009455.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Converting squid to library</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Converting%20squid%20to%20library&In-Reply-To=%3Cd30c84a0-15bb-0078-cd25-0db6f2113f2e%40treenet.co.nz%3E"
       TITLE="[squid-dev] Converting squid to library">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Aug  2 10:16:12 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="009449.html">[squid-dev] Converting squid to library
</A></li>
        <LI>Next message: <A HREF="009455.html">[squid-dev] Converting squid to library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9451">[ date ]</a>
              <a href="thread.html#9451">[ thread ]</a>
              <a href="subject.html#9451">[ subject ]</a>
              <a href="author.html#9451">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/08/18 18:32, Manju Prabhu wrote:
&gt;<i> Hi,
</I>&gt;<i> I plan to use Squid for ssl-proxy in my project. However, I have my own
</I>&gt;<i> data-path and TCP stack I want to try it out with for performance
</I>&gt;<i> reasons. The TCP stack could be in user-space for example, if I use DPDK.
</I>&gt;<i> 
</I>&gt;<i> * Is there any potential pitfalls if I embark on this task?
</I>
The first one is that Squid is is a collection of binaries and processes
working together to process traffic. Not suitable for being a library.


&gt;<i> * Is it better to convert squid to a library and link it to my process
</I>&gt;<i> along with DPDK (Option A)? Or is it better to try to link DPDK to squid
</I>&gt;<i> (Option B)?
</I>
Neither if you can avoid it. Option B only if you have to.

Squid uses POSIX API for I/O. So if you are providing POSIX API from
your TCP stack it should be as simple as building Squid with the
appropriate ./configure CXXFLAGS, CFLAGS, and LDADD build options to
link your stacks library/objects.

If you have done some non-standard API you will have to write a mapping
between it and POSIX functions. Doing that in your own code simplifies
things considerably - especially for your codes prospects being used
widely, but it can be patched into Squid if necessary.

Also, many TLS/SSL I/O operations are done through the system TLS/SSL
library. Not by Squid at all. So there is additional complication
rebuilding that library against your stack before Squid can use it.
Having the standard POSIX API which both can access is much easier and
better than any custom API.



&gt;<i> * With squid I see that separate threads are created to manage
</I>&gt;<i> certificate mimicking etc. Do all of that get complicated with Option A? 
</I>
Not threads. Processes. Squid is running independent
binaries/interpreters, and forking itself sometimes as well. Thus your
Option A is not an option.


&gt;<i> 
</I>&gt;<i> I apologize in advance for some open ended questions. Please point me to
</I>&gt;<i> the right forum if these questions are not valid here.
</I>&gt;<i> 
</I>
This is the right place.

Amos
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009449.html">[squid-dev] Converting squid to library
</A></li>
	<LI>Next message: <A HREF="009455.html">[squid-dev] Converting squid to library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9451">[ date ]</a>
              <a href="thread.html#9451">[ thread ]</a>
              <a href="subject.html#9451">[ subject ]</a>
              <a href="author.html#9451">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
