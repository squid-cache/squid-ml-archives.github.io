<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] 206 Partial Content Caching
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20206%20Partial%20Content%20Caching&In-Reply-To=%3C1688790048.4227944.1536837782364%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="009460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] 206 Partial Content Caching</H1>
    <B>Benson Kwok</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20206%20Partial%20Content%20Caching&In-Reply-To=%3C1688790048.4227944.1536837782364%40mail.yahoo.com%3E"
       TITLE="[squid-dev] 206 Partial Content Caching">bkwok at yahoo.com
       </A><BR>
    <I>Thu Sep 13 11:23:02 UTC 2018</I>
    <P><UL>
        
        <LI>Next message: <A HREF="009460.html">[squid-dev] 206 Partial Content Caching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9459">[ date ]</a>
              <a href="thread.html#9459">[ thread ]</a>
              <a href="subject.html#9459">[ subject ]</a>
              <a href="author.html#9459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I have successfully implemented caching of 206 Partial Content as a project at my job and want to know if you guys are interested in pulling it into main branch.  Here is what I did in brief:
- adding range_offset and range_length to StoreEntry- caching single ranged requests by adding the range offset and length to store key hash function so they can be lookup by another request with the same range offset and length- offset and length are also added to StoreMeta so after a restart, the offset and range can be restored- enhancing HTCP so the range header from a peer is parsed and the offset and length are used during HIT/MISS lookup- skip ICP for range request since ICP cannot include range header- adjust store_client.cc copyInfo.offset by range_offset- adjust store_swapout.cc mem-&gt;swapout.queue_offset by range_offset- adjust trimSwappable() new_mem_lo by range_offset
I have run through a good amount of testing with multiple clients running same or random range requests and everything seems to be working fine.  Also tried testing HTCP with 2 squids and HTCP messages are correctly answered with HIT/MISS.
The diff can be found here:
<A HREF="https://github.com/squid-cache/squid/compare/master...bkwzwz:206_partial_content_caching">https://github.com/squid-cache/squid/compare/master...bkwzwz:206_partial_content_caching</A>


ThanksBenson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20180913/a799369a/attachment.html">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20180913/a799369a/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="009460.html">[squid-dev] 206 Partial Content Caching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9459">[ date ]</a>
              <a href="thread.html#9459">[ thread ]</a>
              <a href="subject.html#9459">[ subject ]</a>
              <a href="author.html#9459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
