From ghaith at sublimeapp.com  Wed Oct  9 14:36:07 2019
From: ghaith at sublimeapp.com (ghaith)
Date: Wed, 9 Oct 2019 09:36:07 -0500 (CDT)
Subject: [squid-dev] Squid Radius Not Working
Message-ID: <1570631767621-0.post@n4.nabble.com>

Hello everyone,

So i have squid proxy setup and working fine, now im trying to configure it
using raduis auth and i've followed all the required steps to do so but its
still not working i dont know why, here is my configs:

auth_param basic program /usr/lib/squid/basic_radius_auth -f
/etc/squid/radius_config
auth_param basic children 5
auth_param basic realm JC
auth_param basic credentialsttl 5 minute
auth_param basic casesensitive off


acl radius proxy_auth REQUIRED
http_access allow radius

am i missing anything here?

any help or guidance is greatly appreciated, thanks in advance!

Cheers!





--
Sent from: http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Development-f1042840.html

From rousskov at measurement-factory.com  Thu Oct 10 22:41:06 2019
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Thu, 10 Oct 2019 18:41:06 -0400
Subject: [squid-dev] PRs ready for merge
Message-ID: <060e80d9-a780-f89f-cdfb-31b7b758d391@measurement-factory.com>

Hi Amos,

    I believe the following two PRs are ready to go in. I added the
corresponding comments and labels to these PRs. I did not hear from you
since then, and I do not know whether you are OK with these PRs going in
or just unaware of my plans to merge them. The latter possibility is the
reason I am sending this "heads up" email. My current plan is to clear
them for merge in 24 hours unless I hear otherwise from you.

  #485: Re-enabled updates of stored headers on HTTP 304 responses
  #483: Report context of level-0/1 cache.log messages


The following two PRs will be in the same position soon. You have
commented on both, but it is not clear (to me) whether you are OK with
them going in despite your no-vote comments.

  #474: Bug 4796: comm.cc !isOpen(conn->fd) assertion when rotating logs
  #490: Send HTTP/503 (Service Unavailable) error when lacking peers


Let's try to move these and other outstanding projects forward and then
properly branch v5.


Thank you,

Alex.

From squid3 at treenet.co.nz  Fri Oct 11 13:37:36 2019
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 12 Oct 2019 02:37:36 +1300
Subject: [squid-dev] PRs ready for merge
In-Reply-To: <060e80d9-a780-f89f-cdfb-31b7b758d391@measurement-factory.com>
References: <060e80d9-a780-f89f-cdfb-31b7b758d391@measurement-factory.com>
Message-ID: <c3b1c3c0-9496-42df-d385-22c70d0de808@treenet.co.nz>

On 11/10/19 11:41 am, Alex Rousskov wrote:
> Hi Amos,
> 
>     I believe the following two PRs are ready to go in. I added the
> corresponding comments and labels to these PRs. I did not hear from you
> since then, and I do not know whether you are OK with these PRs going in
> or just unaware of my plans to merge them. The latter possibility is the
> reason I am sending this "heads up" email. My current plan is to clear
> them for merge in 24 hours unless I hear otherwise from you.
> 
>   #485: Re-enabled updates of stored headers on HTTP 304 responses
>   #483: Report context of level-0/1 cache.log messages
> 

Reviewed, briefly.

> 
> The following two PRs will be in the same position soon. You have
> commented on both, but it is not clear (to me) whether you are OK with
> them going in despite your no-vote comments.
> 
>   #474: Bug 4796: comm.cc !isOpen(conn->fd) assertion when rotating logs

I want to be very sure of the sequence being identical or better before
this goes in.


>   #490: Send HTTP/503 (Service Unavailable) error when lacking peers
> 

Will followup in the PR on this shortly.


Amos

From steve at opendium.com  Wed Oct 30 12:19:02 2019
From: steve at opendium.com (Steve Hill)
Date: Wed, 30 Oct 2019 12:19:02 +0000
Subject: [squid-dev] Streaming ICAP previews
Message-ID: <a973f0c1-c0e8-48fc-5d98-ab527195a86b@opendium.com>


This is probably best directed at the ICAP Forum, but www.i-cap.org 
seems to be dead.

There seems to be a limitation in the ICAP specification that I've just 
hit, and would be trivial to fix, so wanted to have some input into 
whether this has previously been discussed (I can't see any mention in 
the measurement-factory errata page).

RFC3507 section 4.5 says:
"100 Continue.  If the entire encapsulated HTTP body did not fit in the 
preview, the ICAP client MUST send the remainder of its ICAP message, 
starting from the first chunk after the preview.  If the entire message 
fit in the preview (detected by the "EOF" symbol explained below), then 
the ICAP server MUST NOT respond with 100 Continue."

The "MUST NOT" part prevents streaming of content during the preview, 
because until the end of the preview the ICAP server does not know 
whether a 100 Continue response will be allowed.

Take the following scenario, with the ICAP server expecting 4096 byte 
previews:

The HTTP client makes a request via the proxy, and the server responds 
with an HTTP chunked request that slowly streams 16 byte chunks of data 
back at a rate of 1 chunk per second.

The proxy sends an ICAP RESPMOD request to the ICAP server, starts a 
4096 byte preview, and as it receives the chunked data from the HTTP 
server it streams that data to the ICAP server.  At 16 bytes per second, 
the preview will take a little over 4 minutes to complete.  During that 
4 minutes, the ICAP server can respond with "204 No Content" to allow 
the content, or it can produce an entirely new HTTP response of its own 
to replace the original response.

However, if the ICAP server wants to stream the original response back 
to the client (with or without any modifications), it can't start doing 
this until after the preview is complete because it has to wait until 
the end of the preview to find out whether or not to send a 100 Continue.

In our example, this means the client doesn't start seeing the response 
from the server for over 4 minutes.

This fix for this seems obvious - in my opinion, the RFC should read:
"100 Continue.  If the entire encapsulated HTTP body did not fit in the 
preview, the ICAP client MUST send the remainder of its ICAP message, 
starting from the first chunk after the preview.  If the entire message 
fit in the preview (detected by the "EOF" symbol explained below), then 
the ICAP client MUST ignore a 100 Continue."

This change should be straight forward to implement on the client side, 
and allows the server to start streaming at any point during the preview 
by blindly sending a "100 Continue" followed by the ICAP reqmod/respmod 
response:
  - If the HTTP response does not fit in the preview, the client would 
see the 100 Continue and continue to send the whole response to the ICAP 
server after the preview is complete, then wait for the reqmod/respmod 
response.
  - If the HTTP response does not fit in the preview, the client would 
ignore the 100 Continue and wait for the reqmod/respmod response.

In either case, the end of the preview is still marked by the chunk body 
terminator, and the server knows whether to expect further non-preview 
chunks by the presence or absence of the ieof chunk extension.

-- 
  - Steve Hill
    Technical Director | Cyfarwyddwr Technegol
    Opendium    Online Safety & Web Filtering     http://www.opendium.com
                Diogelwch Ar-Lein a Hidlo Gwefan

    Enquiries | Ymholiadau:   sales at opendium.com     +44-1792-824568
    Support   | Cefnogi:      support at opendium.com   +44-1792-825748

------------------------------------------------------------------------
Opendium Limited is a company registered in England and Wales.
Mae Opendium Limited yn gwmni sydd wedi'i gofrestru yn Lloegr a Chymru.

Company No. | Rhif Cwmni:   5465437
Highfield House, 1 Brue Close, Bruton, Somerset, BA10 0HY, England.

