<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] squid.conf future
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20squid.conf%20future&In-Reply-To=%3Cc62ae383-353e-b66d-9bb3-a345eae192cd%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009550.html">
   <LINK REL="Next"  HREF="009552.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] squid.conf future</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20squid.conf%20future&In-Reply-To=%3Cc62ae383-353e-b66d-9bb3-a345eae192cd%40measurement-factory.com%3E"
       TITLE="[squid-dev] squid.conf future">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Feb 25 17:41:12 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="009550.html">[squid-dev] squid.conf future
</A></li>
        <LI>Next message: <A HREF="009552.html">[squid-dev] squid.conf future
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9551">[ date ]</a>
              <a href="thread.html#9551">[ thread ]</a>
              <a href="subject.html#9551">[ subject ]</a>
              <a href="author.html#9551">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/25/20 1:31 AM, Amos Jeffries wrote:
&gt;<i> On 25/02/20 6:11 am, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 2/24/20 3:11 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> For the future I am considering a switch of cf.data.pre to a format like
</I>&gt;&gt;&gt;<i> SGML or XML which we can better generate the website contents from.
</I>
&gt;&gt;<i> If you meant something specific by &quot;SGML&quot;, please clarify.
</I>
&gt;<i> We have the Linuxdoc toolchain already used for release notes
</I>&gt;<i> etc. so long as we have a simple set of rules about the markup used for
</I>&gt;<i> bits that cf_gen needs to pull out for code generation we can use any of
</I>&gt;<i> the more powerful markup in the documentation comment parts.
</I>
With all due respect to LDP, LinuxDoc feels like is a dying project
these days -- not a lot of activity and a lot of stale sites. The
current(?) toolchain maintainer said[1] that modern (at the time)
developers prefer DocBook: &quot;DocBook DTD [...] is now a more popular DTD
than LinuxDoc in writing technical software documentation&quot;.

That was ... 11 years ago.

[1] <A HREF="https://gitlab.com/agmartin/linuxdoc-tools">https://gitlab.com/agmartin/linuxdoc-tools</A>



&gt;&gt;<i> Automated rendering of squid.conf sources, including web site content
</I>&gt;&gt;<i> generation, should be straightforward with any good source format,
</I>&gt;&gt;<i> including writer-friendly formats. Thus, web site generation is not an
</I>&gt;&gt;<i> important deciding criteria here AFAICT.
</I>
&gt;<i> It is an existing use-case for documentation output we need to maintain.
</I>
Agreed. My point is _not_ that we do not need to support web site
generation. My point is that any decent tool, including custom scripts,
can generate web sites these days (and, in most cases, do a better job
than what we have today). Thus, we should decide based on other, more
selective factors first.


&gt;&gt;<i> IMO, an ideal markup language for cf.data.pre (or its replacements)
</I>&gt;&gt;<i> would satisfy these draft high-level criteria:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. Writer-friendly. Proper whitespace, indentation, and other
</I>&gt;&gt;<i> presentation features of the _rendered_ output are the responsibility of
</I>&gt;&gt;<i> renderes, not content writers. Decent _sources_ formatting should be
</I>&gt;&gt;<i> automatically handled by popular modern text editors that developers
</I>&gt;&gt;<i> already use. No torturing humans with counting tags or brackets.
</I>
&gt;<i> This nullifies the argument that XML is torturous. Good editing tools
</I>&gt;<i> can handle XML easily.
</I>
Good editors can close the current tag for you, but closing tags and
dealing with all the other machine noise is still tedious for most
humans. XML is just not designed to be friendly to human writers (and
readers!). It is like JSON: Yes, one can edit JSON by hand, especially
with a good editor, but that does not make it human-friendly. Both
formats are meant for exchanging information between programs.


&gt;&gt;<i> 2. Expressive enough to define all the squid.conf concepts that we want
</I>&gt;&gt;<i> to keep/support, so that they can be rendered beautifully without hacks.
</I>&gt;&gt;<i> For example, if we agree that those sections are a good idea, then this
</I>&gt;&gt;<i> item includes support for introduction sections that define no
</I>&gt;&gt;<i> configuration options themselves.
</I>
&gt;<i> What are you calling squid.conf concepts here?
</I>
Everything that may need to be referenced or rendered specially. For
example, directive names, directive parameter lists, individual
parameter documentation, parameter defaults, default parameter
documentation, configuration examples, C++ macro guards, AND prose
elements such as sections, paragraphs, lists, emphasized phrases,
verbatim text, hyperlinks, etc.



&gt;&gt;<i> 3. Supports documentation duplication avoidance so that we do not have
</I>&gt;&gt;<i> to duplicate a lot of text or refer the reader to directive X for
</I>&gt;&gt;<i> details of directive Y functionality.
</I>
&gt;<i> The XML idea supports that. I am not sure about SGML.
</I>
With XML (and many SGML DTDs), the question is not so much whether it is
_possible_ to support Foo or Bar, but how difficult that support is
going to be (for documentation writers, readers, and tool
developers/admins). I suspect that reusing XML snippets is going to
require custom tooling unless those snippets are isolated into
entities/macros. We can live with that isolation, but a more flexible
&quot;foo.faz documentation is the same as bar.baz documentation (after
replacing baz with faz)&quot; may work a lot better.

N.B. If by &quot;SGML&quot; you mean Linuxdoc DTD, then I am not sure whether it
supports quoting. SGML itself, being a meta-language (compared to XML),
can &quot;support&quot; anything XML can support and a lot more.


&gt;<i> All the other text syntax I'm aware of do not have nice writer-friendly
</I>&gt;<i> referencing. The YAML-like one we currently have is a case in point.
</I>
I am not aware of _nice_ referencing in XML either. FWIW, Markdown
referencing is OK. Certainly not nice, just OK. We have no referencing
today in cf.data.pre AFAIK.

Please note that referencing and quoting/reusing content are different
beasts: Item 3 is about the latter (which is more difficult to find good
support for compared to the more prevailing referencing).


&gt;&gt;<i> 6. Git-friendly: Adding two new unrelated directives does not lead to
</I>&gt;&gt;<i> conflicting pull requests.
</I>&gt;<i> 
</I>&gt;<i> This is unrealistic so long as the source code remains in one file. Only
</I>&gt;<i> edits to independent files are guaranteed not to conflict.
</I>
Yes, I know. Some formats support individual files better than others.
And, if we decide to go this way, each individual file should be
validatable and renderable on its own (ideally). Splitting itself is
easy, but nice split support is difficult. Again, we may never find a
format that satisfies all the criteria, but it is a valid criteria to
consider.


&gt;<i> What I am considering is a change to the internal syntax within
</I>&gt;<i> cf.data.pre. 
</I>
Yes, I understand and support evaluating other grammars. Splitting
cf.data.pre in the process is a fair consideration IMO. I am not saying
the split is required, of course. I am only saying it should be
considered because it reduces merge conflicts (at least).


&gt;<i> At most a filename/extension change to match. It remains a
</I>&gt;<i> source code file like any other.
</I>
Not sure what you mean by the &quot;source code file&quot; in this context. The
fact that we currently extract pieces of cf.data.pre to build Squid
executable is unimportant for this discussion AFAICT. Do you assign some
other special properties/implications to &quot;source code&quot; that I should be
aware of in this context?


&gt;&gt;<i> 7. Either already well-known or easy to learn by example (as far as
</I>&gt;&gt;<i> major used concepts are concerned).
</I>
&gt;<i> AFAIK, that effectively means SGML or XML.
</I>
If &quot;SGML&quot; is &quot;Linuxdoc&quot;, then I would agree with your conclusion ... ~20
years ago. Today, most kids use markdown and such for most text-centric
tasks, probably because the latter are much more human-friendly (and
were designed to be that way). Again, markdown can be expressed in an
SGML DTD.


&gt;&gt;<i> 8. Can be easily parsed using programming languages that our renderers
</I>&gt;&gt;<i> are (going to be) written in (e.g., using existing parser libraries). We
</I>&gt;&gt;<i> should probably discuss whether these renderers should be (re)written in
</I>&gt;&gt;<i> some specific languages.
</I>&gt;<i> 
</I>&gt;<i> This is where XML has the the advantage over wider SGML. Both are
</I>&gt;<i> parseable, but XML end-tags and libxml make is a bit more simple for the
</I>&gt;<i> cf_gen implementation.
</I>
To simplify, I suggest excluding XML from consideration. The more I
think about it, the more I am convinced that it would be a big mistake
to go to a machine-centric format that &quot;nobody&quot; uses these days.

As for SGML DTDs, I think we should rule out LinuxDoc for similar
reasons. It is possible that I can be convinced to change my mind on
LinuxDoc, but I am pretty sure there are much better options out there.


&gt;&gt;<i> 9. Translation-friendly. (I do not know what that entails, but I am sure
</I>&gt;&gt;<i> that others can detail this reqiurement.)
</I>&gt;<i> 
</I>&gt;<i> Human language translation requires one of the formats which
</I>&gt;<i> translate-toolkit can use as input, OR being easily converted into one
</I>&gt;<i> of those with machine translation.
</I>
I suspect that with tools like <A HREF="https://pandoc.org/,">https://pandoc.org/,</A> we can convert
virtually any standard format to any modern format if needed, but it may
be good to know what translate-toolkit can use as input.


&gt;<i> Machine translation only requires a toolchain that knows both formats.
</I>&gt;<i> Translation of cf.data.pre into HTML for the web and man pages for
</I>&gt;<i> distro documentation of using SGML.
</I>
I do not think we should worry about machine translation -- readers can
do that on their own.


&gt;<i> Any suggestions of formats I should look at then?
</I>
I will need to research that. I will get back to you.


Thank you,

Alex.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009550.html">[squid-dev] squid.conf future
</A></li>
	<LI>Next message: <A HREF="009552.html">[squid-dev] squid.conf future
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9551">[ date ]</a>
              <a href="thread.html#9551">[ thread ]</a>
              <a href="subject.html#9551">[ subject ]</a>
              <a href="author.html#9551">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
