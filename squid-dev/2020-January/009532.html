<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Efficient FD annotations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Efficient%20FD%20annotations&In-Reply-To=%3C18ae915e-1490-497a-e79e-1c7c71569a98%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009529.html">
   <LINK REL="Next"  HREF="009534.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Efficient FD annotations</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Efficient%20FD%20annotations&In-Reply-To=%3C18ae915e-1490-497a-e79e-1c7c71569a98%40treenet.co.nz%3E"
       TITLE="[squid-dev] Efficient FD annotations">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan 10 07:37:32 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="009529.html">[squid-dev] Efficient FD annotations
</A></li>
        <LI>Next message: <A HREF="009534.html">[squid-dev] Efficient FD annotations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9532">[ date ]</a>
              <a href="thread.html#9532">[ thread ]</a>
              <a href="subject.html#9532">[ subject ]</a>
              <a href="author.html#9532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/01/20 3:39 am, Alex Rousskov wrote:
&gt;<i> On 1/7/20 1:39 AM, Amos Jeffries wrote:
</I>&gt;&gt;<i> On 7/01/20 4:28 am, Alex Rousskov wrote:
</I>&gt;&gt;&gt;<i> For the record: The ideas below are superseded by the concept of the
</I>&gt;&gt;&gt;<i> code context introduced in commit ccfbe8f, including the
</I>&gt;&gt;&gt;<i> fde::codeContext field. --Alex
</I>&gt;<i> 
</I>&gt;&gt;<i> If you want to go that way (replace fde:note with fde:codeContext)
</I>&gt;<i> 
</I>&gt;<i> I would not replace fde::note with fde::codeContext. I would keep
</I>&gt;<i> fde::note as a basic indication of the current FD purpose/scope. This
</I>&gt;<i> can be done cheaply using string literals or constant SBufs.
</I>&gt;<i> 
</I>
In that case, why is this thread being revived?
AIUI your proposals were alternatives to PR 270 - ways to replace the
fde::note field instead of just updating it to SBuf.


&gt;<i> 
</I>&gt;&gt;<i> we are going to have to do a security audit on the values displayed
</I>&gt;&gt;<i> by the CodeContext objects. That is due to how the fde::note are sent
</I>&gt;&gt;<i> over the public network in clear-text transactions for
</I>&gt;&gt;<i> mgr:filedescriptors report.
</I>&gt;<i> 
</I>&gt;<i> Overall, I doubt such an audit is a good idea -- only the Squid admin
</I>&gt;<i> can correctly decide whether it is OK to expose transaction information
</I>&gt;<i> in cache manager responses[1,2].
</I>
see responses below to [1] and [2]. Since you are apparently not seeking
to replace the mgr:filedescriptors report fde::note field with
fde::codeContext display - then please take it as a general security
approach policy for handling that type of change.



&gt;<i> If there is demand for limiting that
</I>&gt;<i> exposure, I would rather add a configuration directive that would allow
</I>&gt;<i> the admin to control whether Squid is allowed to report context in cache
</I>&gt;<i> manager responses, error pages, etc.
</I>
We do not have to default such an option to publish everything on the
off chance it is safe. Our objective here is to prevent CVEs occuring.
To achieve that we should be defaulting to elide sensitive details from
public view unless configured to show them.

The details I am thinking of most prominently here are things like
credentials and tokens in the auth processing contexts. URL history and
keys in the SSL-Bump context. Access to Squid internal memory spaces on
the server. There are probably others we will uncover later. Anything
that could be reported as a sensitive information leak and assigned a CVE.


&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;<i> [1] Some of the transaction context is already exposed in the current
</I>&gt;<i> cache manager responses. We may want to add more details or report fewer
</I>&gt;<i> details, but there is no paradigm shift here.
</I>
&quot;some&quot; renders this argument irrelevant. The leak issues will be
cropping up about the *new* data if we let that contain anything sensitive.

The purpose of audit is to retrospectively check the those not-yet
published details are safe for publishing. It will either find
everything is OK as-is, or that we need to add a censoring print
operator for publicly visible displays to use.


&gt;<i> 
</I>&gt;<i> [2] In some deployment environments, cache manager responses are
</I>&gt;<i> delivered over secure channels.
</I>&gt;<i> 
</I>
&quot;some&quot; renders this argument irrelevant. The leak issues will be
cropping up where they are *not* secured.


Amos
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009529.html">[squid-dev] Efficient FD annotations
</A></li>
	<LI>Next message: <A HREF="009534.html">[squid-dev] Efficient FD annotations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9532">[ date ]</a>
              <a href="thread.html#9532">[ thread ]</a>
              <a href="subject.html#9532">[ subject ]</a>
              <a href="author.html#9532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
