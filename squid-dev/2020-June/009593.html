<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] RFC: making TrieNode less memory-hungry
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20making%20TrieNode%20less%20memory-hungry&In-Reply-To=%3Cd1f2e887-3ef2-81bb-b90e-3b8e7b2624ef%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009591.html">
   <LINK REL="Next"  HREF="009592.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] RFC: making TrieNode less memory-hungry</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20making%20TrieNode%20less%20memory-hungry&In-Reply-To=%3Cd1f2e887-3ef2-81bb-b90e-3b8e7b2624ef%40treenet.co.nz%3E"
       TITLE="[squid-dev] RFC: making TrieNode less memory-hungry">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun 30 23:21:33 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009591.html">[squid-dev] RFC: making TrieNode less memory-hungry
</A></li>
        <LI>Next message (by thread): <A HREF="009592.html">[squid-dev] Proposed focus for Squid-6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9593">[ date ]</a>
              <a href="thread.html#9593">[ thread ]</a>
              <a href="subject.html#9593">[ subject ]</a>
              <a href="author.html#9593">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/06/20 9:13 am, Francesco Chemolli wrote:
&gt;<i> Hi all,
</I>&gt;<i>   I'm looking at the TrieNode code, and while it's super fast, it's
</I>&gt;<i> quite memory-hungry: each node uses 2kb of RAM for the children index
</I>&gt;<i> and any moderately-sized Trie has plenty of nodes. On the upside, it's
</I>&gt;<i> blazing fast.
</I>&gt;<i> 
</I>&gt;<i> How about changing it so that each node only havs as many children as
</I>&gt;<i> the [min_char, max_char] range, using a std::vector and a min_char
</I>&gt;<i> offset? Lookups would still be O(length of key), insertions may require
</I>&gt;<i> shifting the vector if the char being inserted is lower than the current
</I>&gt;<i> min_char, but the memory savings sound promising.
</I>&gt;<i> 
</I>&gt;<i> What do you think?
</I>&gt;<i> 
</I>
Before doing anything, please look at how trie is implemented for
rbldnsd. It is both super fast and memory efficient. A lot of the
optimization analysis and work has already been done by some super smart
people we can probably leverage.

Also, keep in mind that trie is only used by ESI. So it is not exactly a
high-usage feature.


Amos
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009591.html">[squid-dev] RFC: making TrieNode less memory-hungry
</A></li>
	<LI>Next message (by thread): <A HREF="009592.html">[squid-dev] Proposed focus for Squid-6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9593">[ date ]</a>
              <a href="thread.html#9593">[ thread ]</a>
              <a href="subject.html#9593">[ subject ]</a>
              <a href="author.html#9593">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
