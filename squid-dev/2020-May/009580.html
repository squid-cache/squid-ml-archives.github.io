<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] cppunit -&gt; googletest / gmock?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20cppunit%20-%3E%20googletest%20/%20gmock%3F&In-Reply-To=%3CCA%2BY8hcNLaEkENpAWSUTpy-efkY5ZjS6rvMLH%2BagPHDaJphPP3g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="009582.html">
   <LINK REL="Next"  HREF="009581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] cppunit -&gt; googletest / gmock?</H1>
    <B>Francesco Chemolli</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20cppunit%20-%3E%20googletest%20/%20gmock%3F&In-Reply-To=%3CCA%2BY8hcNLaEkENpAWSUTpy-efkY5ZjS6rvMLH%2BagPHDaJphPP3g%40mail.gmail.com%3E"
       TITLE="[squid-dev] cppunit -&gt; googletest / gmock?">gkinkie at gmail.com
       </A><BR>
    <I>Sat May 30 17:27:12 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009582.html">[squid-dev] Squid command
</A></li>
        <LI>Next message (by thread): <A HREF="009581.html">[squid-dev] cppunit -&gt; googletest / gmock?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9580">[ date ]</a>
              <a href="thread.html#9580">[ thread ]</a>
              <a href="subject.html#9580">[ subject ]</a>
              <a href="author.html#9580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
   starting from a PR in a conversation with Alex about our current
approach to unit testing being painful, I've checked what alternatives
would we have and how practical would they be.

An easy first option would be googletest/googlemock.

On a lazy afternoon, I've tried seeing how useful/painful it would be to
try it, by porting one test over - it's quite trivial and doesn't require
mocking, so I'll try a more complicated one next - to start a conversation
about the topic.

You can find the test branch at <A HREF="https://github.com/kinkie/squid/tree/gtest">https://github.com/kinkie/squid/tree/gtest</A> .
I've only touched two files, a newly-created src/tests/testMemGtest and
src/Makefile.am .

The output from the test run is at <A HREF="https://paste.ubuntu.com/p/3sgTDN7rNm/">https://paste.ubuntu.com/p/3sgTDN7rNm/</A>

What do you think?

My initial thoughts:
- it is somewhat simpler and more powerful than cppunit
- setting the test environment up is easy but at this time it can only be
done from source. Adding it to the build farm images is straightforward
- the license is BSD 3-clause new (
<A HREF="https://github.com/google/googletest/blob/master/LICENSE">https://github.com/google/googletest/blob/master/LICENSE</A>)
- googlemock promises to be vastly superior to our current approach
- porting memTest took me about one hour, mostly caused by us including
cppunit headers from squid.h (WUT? A PR is coming up to unentangle that)

-- 
    Francesco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20200530/65686d5d/attachment.html">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20200530/65686d5d/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009582.html">[squid-dev] Squid command
</A></li>
	<LI>Next message (by thread): <A HREF="009581.html">[squid-dev] cppunit -&gt; googletest / gmock?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9580">[ date ]</a>
              <a href="thread.html#9580">[ thread ]</a>
              <a href="subject.html#9580">[ subject ]</a>
              <a href="author.html#9580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
