<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] What os/cpu platforms do we want to target as a project?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20What%20os/cpu%20platforms%20do%20we%20want%20to%20target%20as%20a%0A%20project%3F&In-Reply-To=%3Cabc50ecc-b54d-db33-a0bc-8cceafb2c8d9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009730.html">
   <LINK REL="Next"  HREF="009734.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] What os/cpu platforms do we want to target as a project?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20What%20os/cpu%20platforms%20do%20we%20want%20to%20target%20as%20a%0A%20project%3F&In-Reply-To=%3Cabc50ecc-b54d-db33-a0bc-8cceafb2c8d9%40treenet.co.nz%3E"
       TITLE="[squid-dev] What os/cpu platforms do we want to target as a project?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Dec  5 12:00:03 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009730.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
        <LI>Next message (by thread): <A HREF="009734.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9731">[ date ]</a>
              <a href="thread.html#9731">[ thread ]</a>
              <a href="subject.html#9731">[ subject ]</a>
              <a href="author.html#9731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/12/21 22:44, Francesco Chemolli wrote:
&gt;<i> Hi all,
</I>&gt;<i>    continuing the conversation from
</I>&gt;<i> <A HREF="https://github.com/squid-cache/squid/pull/942#issuecomment-986055422">https://github.com/squid-cache/squid/pull/942#issuecomment-986055422</A>
</I>&gt;<i> to a bigger forum
</I>&gt;<i> 
</I>&gt;<i> The discussion started out of a number of PRs meant to remove explicit
</I>&gt;<i> support for obsolete platforms such as OSF/1, NeXT or old versions of
</I>&gt;<i> Solaris.
</I>&gt;<i> 
</I>&gt;<i> I that thread I move forward a list of platforms that in my opinion we
</I>&gt;<i> should as a project target, and while of course we should not
</I>&gt;<i> explicitly prevent other platforms from being built on, we should also
</I>&gt;<i> not disperse our time supporting complexity for the sake of other
</I>&gt;<i> os/cpu combos .
</I>&gt;<i> 
</I>&gt;<i> The rationale is that we should focus our attention as a project where
</I>&gt;<i> the majority of our userbase is, where users mean &quot;people who build
</I>&gt;<i> and run squid&quot;.
</I>&gt;<i> 
</I>
I do not accept that a few hacks for old OS are causing pain to core 
developers simply by bitrotting in untouched code.

Removing things because the majority of users are not using it would 
mean we become a Linux-only project and thus actively push people out of 
the community unnecessarily. There are active benefits gained in the 
form of better code, bug detection, and community inclusiveness from 
maintaining portable code.


FTR; The criteria informing my OS removal decisions so far have been:

  a) Squid-3 has support for any OS which has a chance at providing C++ 
tools. Inheriting from the Squid-2 support for any ancient OS that had 
someone willing to provide patches.

  b) Squid-4+ require C++11 toolchain. This eliminates a lot of very old 
OS code. Especially those which have no vendor/distro have little chance 
at providing a modern toolchain.

  - At times the vendor/distro supporting that OS provides 
toolchains/support in ways that no longer need our hacks (eg PR 944 m88k 
supported as normal NetBSD/OpenBSD builds, PR 943 likewise as QNX or 
MacOS builds).

  -  At times our hack is for a version of OS which the vendor(s) 
provide (and/or require) admin to use a newer version of Squid for. Our 
usual distro hack removals.

  c) OS which are outdated (newer version supported by the vendors) need 
a reasonable ability for any admin wanting to manually build their Squid 
able to do so. If we know of any admin wanting the code to remain it can 
stay unless we have a clear reason to remove. (eg PR 942)


NP: now that Squid has formally dated releases I have a timeline for 
support forcasts. (eg PR 942 vendor LTS schedule vs Squid-6 release)



&gt;<i> We have no way of knowing who is installing squid, we don't have
</I>&gt;<i> telemetry, so we will need to do a bit of guesswork, based on the
</I>&gt;<i> assumption that people who deploy squid are rational; as a consequence
</I>&gt;<i> of that, we can assume that they will go for the solution that gives
</I>&gt;<i> them most bang for buck (&quot;buck&quot; being money and time).
</I>&gt;<i> 
</I>&gt;<i> What are the main use cases for squid users? (again, guesswork, please
</I>&gt;<i> feel free to add more)
</I>&gt;<i> 1. forward proxy in enterprise or ISP
</I>&gt;<i> 2. reverse proxy in datacenter
</I>&gt;<i> 3. forward proxy in small or embedded environments
</I>&gt;<i> 
</I>

IME, (1) and (2) have switched places in the past 5 years for actual 
usage. Though (1) people are more vocal with SSL-Bump problems.


  4. protocol translation gateways

Historically FTP and Gopher to HTTP. Recent years IPv6/v4 conversion. 
Plus latest Browsers dropping FTP support has brought back FTP gateway 
translation popularity.


We should be in the thick of HTTP 1/2/3 conversion, but blockers on that 
work have completely eliminated Squid from that section of the market. 
People wanting that go to Haproxy instead.



&gt;<i> What are the Os/CPU combos that we can expect to find in these environments?
</I>
Ubuntu is a large chunk of user base and that alone requires a large 
range of architectures (see <A HREF="https://buildd.debian.org/">https://buildd.debian.org/</A>) to get through 
Debian. That includes BSD and microkernel builds, not just Linux.

So, IMO specific machine architectures are not much concern to &quot;us&quot;. The 
toolchains and vendors take care of that part so long as we provide 
half-decent code.


&gt;<i> x64 is likely to be found in all of them, and the OSes most likely to
</I>&gt;<i> be used are all sorts of Linux, FreeBSD, OpenBSD, Windows.
</I>&gt;<i> For the third use case (and possibly more and more of the second in
</I>&gt;<i> upcoming years), we can consider arm64, arm32 and possibly MIPS with
</I>&gt;<i> Linux. There might be a niche of NetBSD users here, hard to tell.
</I>&gt;<i> 
</I>&gt;<i> By now it makes no economic sense to run Squid on large Unix boxen.
</I>
Worse decisions have been sighted from management levels and not every 
admin has a choice. I don't think this is a strong enough argument for 
it to be relevant to this discussion.



&gt;<i> 
</I>&gt;<i> What do we get as a project out of this?
</I>&gt;<i> - Mainly code simplification. Fewer portability subcases makes for
</I>&gt;<i> easier to understand and modify code
</I>
When it comes to portability the outcome is more ironic. The lack of 
special-cases means less pressure to have clear concept design, 
abstraction/boundaries between actions (modularity). So large code like 
Squid can become more complex than simple.

It is more work in total to design simple than complex/ad-hoc. 
Portability gives a clear justification for that design work, does not 
add/remove from the amount of it necessary to output simple code.


&gt;<i> - More clarity about our target use cases
</I>
That is a matter of features/protocols not portability.


&gt;<i> - better coverage in our testing for our explicit target use cases
</I>&gt;<i> 
</I>
Agreed.

Amos
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009730.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
	<LI>Next message (by thread): <A HREF="009734.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9731">[ date ]</a>
              <a href="thread.html#9731">[ thread ]</a>
              <a href="subject.html#9731">[ subject ]</a>
              <a href="author.html#9731">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
