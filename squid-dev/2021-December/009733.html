<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] RFC: Categorize level-0/1 messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Categorize%20level-0/1%20messages&In-Reply-To=%3Cd8b47c13-a095-0bd0-dbd3-7bfae931ccc3%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009732.html">
   <LINK REL="Next"  HREF="009736.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] RFC: Categorize level-0/1 messages</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Categorize%20level-0/1%20messages&In-Reply-To=%3Cd8b47c13-a095-0bd0-dbd3-7bfae931ccc3%40measurement-factory.com%3E"
       TITLE="[squid-dev] RFC: Categorize level-0/1 messages">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Dec  5 17:43:39 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009732.html">[squid-dev] RFC: Categorize level-0/1 messages
</A></li>
        <LI>Next message (by thread): <A HREF="009736.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9733">[ date ]</a>
              <a href="thread.html#9733">[ thread ]</a>
              <a href="subject.html#9733">[ subject ]</a>
              <a href="author.html#9733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/5/21 8:06 AM, Amos Jeffries wrote:
&gt;<i> On 21/10/21 16:16, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 10/20/21 3:14 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> On 21/10/21 4:22 am, Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;<i> To facilitate automatic monitoring of Squid cache.logs, I suggest to
</I>&gt;&gt;&gt;&gt;<i> adjust Squid code to divide all level-0/1 messages into two major
</I>&gt;&gt;&gt;&gt;<i> categories -- &quot;problem messages&quot; and &quot;status messages&quot;[0]:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> We already have a published categorization design which (when/if used)
</I>&gt;&gt;&gt;<i> solves the problem(s) you are describing. Unfortunately that design has
</I>&gt;&gt;&gt;<i> not been followed by all authors and conversion of old code to it has
</I>&gt;&gt;&gt;<i> not been done.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Please focus your project on making Squid actually use the system of
</I>&gt;&gt;&gt;<i> debugs line labels. The labels are documented at:
</I>&gt;&gt;&gt;<i> &#160;&#160; <A HREF="https://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages">https://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> AFAICT, the partial classification in that wiki table is an opinion on
</I>&gt;&gt;<i> how things could be designed, and that opinion does not reflect Project
</I>&gt;&gt;<i> consensus.
</I>
&gt;<i> The wiki was written from observation of how the message labels are/were
</I>&gt;<i> being used in the code. As such it reflects the defacto consensus of
</I>&gt;<i> everyone ever authoring code that used one of the labels.
</I>
[ N.B. I am worried that this (mostly irrelevant IMO) part of the
discussion risks ruining the shaky agreement we have reached on the
important parts of the RFC, but I am also worried about
misrepresentation of the wiki table status. I will respond here, but
please move any future discussion about that table status (if you decide
to continue them) to a different email thread. ]

AFAICT, the wiki table in question does not accurately reflect Squid
code and does not constitute Project consensus on how things could be
designed, regardless of what observations led to that table creation.
The creative process of writing a classification table (based on code
observations) naturally allows for misinterpretations, mistakes, and
other problems. One cannot claim consensus on the _result_ on the
grounds that they have started with code observations.


&gt;&gt;<i> FWIW, I cannot use that wiki table for labeling messages, but
</I>&gt;&gt;<i> I do not want to hijack this RFC thread for that table review.
</I>
&gt;<i> You our text below contradicts the &quot;cannot&quot; statement by describing how
</I>&gt;<i> the two definitions fit together and offer to use the wiki table labels
</I>&gt;<i> for problem category.
</I>
I cannot use the wiki table for deciding how to label a given message
(because of the problems with the table definitions that I would rather
not review here), but the primary labels we use (and should continue to
use!) are naturally found in that table. There is no contradiction here.


&gt;&gt;<i> * The wiki table talks about FATAL, ERROR, and WARNING messages. These
</I>&gt;&gt;<i> labels match the RFC &quot;problem messages&quot; category. This match covers all
</I>&gt;&gt;<i> of the remaining cache.log messages except for 10 debugs() detailed
</I>&gt;&gt;<i> below. Thus, so far, there is a usable match on nearly all current
</I>&gt;&gt;<i> level-0/1 messages. Excellent!
</I>
&gt;<i> Thus my request that you use the wiki definitions to categorize the
</I>&gt;<i> unlabeled and fix any detected labeling mistakes.
</I>
While I cannot use those wiki definitions (because of the problems with
the table that I would rather not review here), it is not a big deal as
far as this RFC is concerned because I do not have to use or violate
those definitions to implement the vast majority of the proposed changes
-- those changes are orthogonal to the wiki table and its definitions.

If somebody finds a table violation introduced by the RFC PR, then we
will either undo the corresponding PR change, change the label used by
the PR, or fix the table, but my goal is to minimize the number of such
cases because they are likely to waste a lot of time on difficult
discussions about poorly defined concepts.



&gt;&gt;<i> * The wiki table also uses three &quot;SECURITY ...&quot; labels. The RFC does not
</I>&gt;&gt;<i> recognize those labels as special. I find their definitions in the wiki
</I>&gt;&gt;<i> table unusable/impractical, and you naturally think otherwise, but the
</I>&gt;&gt;<i> situation is not as bad as it may seem at the first glance:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - &quot;SECURITY ERROR&quot; is used once to report a coding _bug_. That single
</I>&gt;&gt;<i> use case does not match the wiki table SECURITY ERROR description. We
</I>&gt;&gt;<i> should be able to rephrase that single message so that does it not
</I>&gt;&gt;<i> contradict the wiki table and the RFC.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - &quot;SECURITY ALERT&quot; is used 6 times. Most or all of those cases are a
</I>&gt;&gt;<i> poor match for the SECURITY ALERT description in the wiki table IMHO. I
</I>&gt;&gt;<i> hope we can find a way to rephrase those 6 cases to avoid conflicts.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - &quot;SECURITY NOTICE&quot; is used 3 times. Two of those use cases can be
</I>&gt;&gt;<i> simply removed by removing the long-deprecated and increasingly poorly
</I>&gt;&gt;<i> supported SslBump features. I do not see why we should keep the third
</I>&gt;&gt;<i> message/feature, but if it must be kept, we may be able to rephrase it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If we cannot reach an agreement regarding these 10 special messages, we
</I>&gt;&gt;<i> can leave them as is for now, and come back to them when we find a way
</I>&gt;&gt;<i> to agree on how/whether to assign additional labels to some messages.
</I>
&gt;<i> AFAICT, they were added as equivalent to ERROR/WARNING in CVE fixes,
</I>
Sorry, I do not understand the relationship between a CVE fix (i.e. a
code change) and a debugs() label that you are referring to above.
Clearly, CVE fixes may or may not alter or add debugs() statements, but
those statements very rarely get (or should get) a special label. I hope
this detail is not important for the RFC though.


&gt;<i> or to highlight a known security vulnerability being opened by admin settings.
</I>
We can and, IMO, should highlight those while still using just three
top-level labels.


&gt;&gt;<i> Thus, there are no significant conflicts between the RFC and the table!
</I>&gt;&gt;<i> We strongly disagree how labels should be defined,
</I>
&gt;<i> Recall that the wiki is describing the observed pattern of label usage
</I>&gt;<i> by all Squid contributors.
</I>
IMO, it does not.


&gt;<i> The options for any author are to comply with the existing
</I>&gt;<i> consensus/pattern or to get agreement on changing the definitions.
</I>
Yes, of course. We only disagree on whether the wiki table represents
any existing agreement/consensus or Project definitions, but, again, I
hope we can avoid fighting about that as far as this RFC is concerned.


&gt;<i> Options like changing the labeling scheme are off the table because we
</I>&gt;<i> already have significant amounts of community using those labels with
</I>&gt;<i> third-party tools etc. i.e. the &quot;automatic monitoring&quot; cited as target
</I>&gt;<i> use-case for this proposal are already using the wiki labels as their
</I>&gt;<i> category types.
</I>
There is pretty much no official labeling scheme right now, so this RFC
does not _change_ it. The RFC proposes parts of such a scheme for future
use.

The RFC is compatible with what the community is doing/using already and
greatly reduces long-term admin overheads. Any &quot;we cannot change
anything because admins are using these labels&quot; assertion is false
because it is _admins_ that rightfully complain about existing labeling
(and lack of thereof) and ask for these changes! Admins really want us
to change/improve things in this area. I would not post this RFC otherwise.


&gt;&gt;<i> We only need to
</I>&gt;&gt;<i> agree that (those 10 SECURITY messages aside) the RFC-driven message
</I>&gt;&gt;<i> categorization projects should adjust (the easily adjustable) messages
</I>&gt;&gt;<i> about Squid problems to use three standard labels: FATAL, ERROR, and
</I>&gt;&gt;<i> WARNING. Can we do just that and set aside the other disagreements for
</I>&gt;&gt;<i> another time?
</I>
&gt;<i> Agreed.
</I>
Great! I will proceed with that agreement in mind.


&gt;<i> IMO you should not need a formal definition of &quot;status message&quot; and
</I>&gt;<i> &quot;problem message&quot;.
</I>
Hm... Perhaps there is a misunderstanding of how &quot;problem messages&quot; and
&quot;status messages&quot; categories are defined in the RFC.

For obvious convenience in discussions, documentation, and code, we need
a term that describes

* level-0/1 messages with such well-known prefixes as WARNING:, ERROR:,
and FATAL:.

The RFC calls these messages &quot;problem messages&quot;.

All other level-0/1 messages are called &quot;status messages&quot;:

* level-0/1 messages without well-known prefixes

That is it! These &quot;definitions&quot; are so
factual/trivial/pragmatic/convenient that (the choice of the words
&quot;problem&quot; and &quot;status&quot; aside) we should not be arguing about (the need
for) them IMO! If you think these categories are not needed, you do not
need to use them, of course, but I see no reason to argue about it. They
contradict/prevent/block nothing.


&gt;<i> All it needs to do is go straight to determine whether the message
</I>&gt;<i> meets one of the wiki labels and apply it or the debugs to level2+.
</I>&gt;<i> &quot;status&quot; vs &quot;problem messages&quot; are an emergent property of the correctly
</I>&gt;<i> used labels.
</I>
Lots of of existing level-0/1 messages satisfy both of these conditions:

a) They are not ERRORs/WARNINGs/FATALs/SECURITY*s by _any_ definition.
b) They should be logged at level 0 or 1.

In RFC terminology, these are &quot;status messages&quot;, but you do not have to
call them that. If you are suggesting that their debugs() level should
be changed to 2+, then I disagree because they are useful for
understanding Squid state and triaging basic problems at the _default_
debugging level. Perhaps you are suggesting something else with regard
to the status messages?


&gt;<i> IIRC there are a large number that will need to change verbosity,
</I>&gt;<i> but fine to do that later.
</I>
Agreed on all counts.


Thank you,

Alex.
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009732.html">[squid-dev] RFC: Categorize level-0/1 messages
</A></li>
	<LI>Next message (by thread): <A HREF="009736.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9733">[ date ]</a>
              <a href="thread.html#9733">[ thread ]</a>
              <a href="subject.html#9733">[ subject ]</a>
              <a href="author.html#9733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
