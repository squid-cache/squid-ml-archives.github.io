<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Squid%20does%20not%20accept%20WCCP%20of%20Cisco%20router%20since%0A%20CVE%202021-28116&In-Reply-To=%3C7cd07c6b-18d4-23f1-5c96-8b907b304660%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009736.html">
   <LINK REL="Next"  HREF="009738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Squid%20does%20not%20accept%20WCCP%20of%20Cisco%20router%20since%0A%20CVE%202021-28116&In-Reply-To=%3C7cd07c6b-18d4-23f1-5c96-8b907b304660%40measurement-factory.com%3E"
       TITLE="[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Dec  6 20:34:58 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009736.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
        <LI>Next message (by thread): <A HREF="009738.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9737">[ date ]</a>
              <a href="thread.html#9737">[ thread ]</a>
              <a href="subject.html#9737">[ subject ]</a>
              <a href="author.html#9737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/5/21 6:11 PM, Andrej Mikus wrote:

&gt;<i> I would like to find some information about wccp servers (routers,
</I>&gt;<i> firewalls, etc) that are officially supported and therefore tested for
</I>&gt;<i> compatibility.
</I>
IIRC, there are no such servers/etc. WCCP code quality is low, the code
has been neglected for a long time, and the changes we recently had to
do for CVE 2021-28116 took a very long time, were unfinished and
essentially untested because, in part, those looking for testers could
not get anybody to test the changes and report the results back to us.


&gt;<i> Is there any way to get in touch with the developper responsible for the
</I>&gt;<i> security patch and request his comments?
</I>
You are using the right channel for that. I was one of the developers
that were forced to work on code changes for CVE 2021-28116, but I am
not sure I would consider myself &quot;responsible for the patch&quot; (it depends
on your definition of &quot;responsible&quot;). The advisory says the bug was
fixed by Amos; Amos is on this mailing list.


&gt;<i> I do not have access to other
</I>&gt;<i> Cisco hardware, and I would like to know if the update was confirmed
</I>&gt;<i> working for example against a CSR1000v.
</I>
I do not think that update was confirmed as working against any WCCP
server. If you are using WCCP, you are relying on a long-neglected
feature. There is no proper support for WCCP code in Squid today IMO.


Alex.
P.S. Squid side of CVE 2021-28116 is at
<A HREF="https://github.com/squid-cache/squid/security/advisories/GHSA-rgf3-9v3p-qp82">https://github.com/squid-cache/squid/security/advisories/GHSA-rgf3-9v3p-qp82</A>



&gt;<i> ----- Forwarded message from amk &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">1952158 at bugs.launchpad.net</A>&gt; -----
</I>&gt;<i> 
</I>&gt;<i> Date: Sun, 05 Dec 2021 22:21:51 -0000
</I>&gt;<i> From: amk &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-dev">1952158 at bugs.launchpad.net</A>&gt;
</I>&gt;<i> To: <A HREF="http://lists.squid-cache.org/listinfo/squid-dev">launchpad at mikus.sk</A>
</I>&gt;<i> Subject: [Bug 1952158] Re: squid does not accept WCCP of Cisco router since 3.5.27-1ubuntu1.12
</I>&gt;<i> 
</I>&gt;<i> 4.13-10ubuntu5 in 21.10 and 5.2-1ubuntu1 in jammy are failing as well,
</I>&gt;<i> with debug log different when compared to version 3 involved here:
</I>&gt;<i> 
</I>&gt;<i> 2021/12/05 19:58:41.705 kid1| 80,6| wccp2.cc(1580) wccp2HereIam: wccp2HereIam: Called
</I>&gt;<i> 2021/12/05 19:58:41.705 kid1| 80,5| wccp2.cc(1599) wccp2HereIam: wccp2HereIam: sending to service id 0
</I>&gt;<i> 2021/12/05 19:58:41.705 kid1| 80,3| wccp2.cc(1630) wccp2HereIam: Sending HereIam packet size 144
</I>&gt;<i> 2021/12/05 19:58:41.707 kid1| 80,6| wccp2.cc(1202) wccp2HandleUdp: wccp2HandleUdp: Called.
</I>&gt;<i> 2021/12/05 19:58:41.707 kid1| 80,3| wccp2.cc(1226) wccp2HandleUdp: Incoming WCCPv2 I_SEE_YOU length 128.
</I>&gt;<i> 2021/12/05 19:58:41.707 kid1| ERROR: Ignoring WCCPv2 message: duplicate security definition
</I>&gt;<i>     exception location: wccp2.cc(1249) wccp2HandleUdp
</I>&gt;<i> 
</I>&gt;<i> This looks like a problem with squid itself, the packet does not have
</I>&gt;<i> duplicate security definition. In the code at <A HREF="http://www.squid-">http://www.squid-</A>
</I>&gt;<i> cache.org/Doc/code/wccp2_8cc_source.html I miss some debug output in the
</I>&gt;<i> loop processing the packet /* Go through the data structure */ so would
</I>&gt;<i> need to rebuild the package or to involve debugger.
</I>&gt;<i> 
</I>&gt;<i> I was not able to find any documentation of squid listing
</I>&gt;<i> supported/tested wccp servers but at this point this looks like an issue
</I>&gt;<i> to be reported upstream. There is no reason to consider wccp packets
</I>&gt;<i> from IOS 15.8(3)M2 invalid.
</I>&gt;<i> 
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009736.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
	<LI>Next message (by thread): <A HREF="009738.html">[squid-dev] Squid does not accept WCCP of Cisco router since CVE 2021-28116
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9737">[ date ]</a>
              <a href="thread.html#9737">[ thread ]</a>
              <a href="subject.html#9737">[ subject ]</a>
              <a href="author.html#9737">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
