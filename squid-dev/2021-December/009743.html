<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] What os/cpu platforms do we want to target as a project?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20What%20os/cpu%20platforms%20do%20we%20want%20to%20target%20as%20a%0A%20project%3F&In-Reply-To=%3Cbd66c4f1-7685-7e58-eda3-21ad02510c7b%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009747.html">
   <LINK REL="Next"  HREF="009745.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] What os/cpu platforms do we want to target as a project?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20What%20os/cpu%20platforms%20do%20we%20want%20to%20target%20as%20a%0A%20project%3F&In-Reply-To=%3Cbd66c4f1-7685-7e58-eda3-21ad02510c7b%40measurement-factory.com%3E"
       TITLE="[squid-dev] What os/cpu platforms do we want to target as a project?">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Dec 26 21:58:40 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009747.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
        <LI>Next message (by thread): <A HREF="009745.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9743">[ date ]</a>
              <a href="thread.html#9743">[ thread ]</a>
              <a href="subject.html#9743">[ subject ]</a>
              <a href="author.html#9743">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/26/21 10:30 AM, Francesco Chemolli wrote:
&gt;<i> On Sun, Dec 5, 2021 at 10:05 PM Alex Rousskov wrote:
</I>&gt;&gt;<i> On 12/5/21 4:44 AM, Francesco Chemolli wrote:
</I>&gt;&gt;&gt;<i> I would recommend that we support as main targets:
</I>&gt;&gt;&gt;<i> - Linux on x64, arm64, arm32 and, if we can, MIPS
</I>&gt;&gt;&gt;<i> - FreeBSD, OpenBSD on x64
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> As best-effort:
</I>&gt;&gt;&gt;<i> - Windows on x64, with the aim of eventually promoting to primary target
</I>&gt;&gt;&gt;<i> - Darwin on x64 and maybe eventually arm64
</I>&gt;&gt;&gt;<i> - NetBSD on x64
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What does &quot;support as main targets&quot; and &quot;support as best-effort&quot; mean?
</I>
&gt;<i> &quot;main targets&quot; to me means that any regression in build or unit tests
</I>&gt;<i> on these platforms is PR-blocking. We aim to deliver a working build
</I>&gt;<i> out of the box on these environments, with no need of maintainer
</I>&gt;<i> patches.
</I>
I am OK with that definition if you remove &quot;in build or unit tests&quot;. Any
known Squid regression affecting the &quot;main&quot; environment should block the
PR introducing that regression IMO. I see no need to limit this to
&quot;build and unit tests&quot; regressions. Are you OK with that definition
simplification?

I do not think MIPS, FreeBSD, and OpenBSD should be on the &quot;main&quot; list:
There are just too few users and contributors on those platforms right
now to grant them primary status AFAICT. I may be missing some important
signals, of course, but I would downgrade them to best-effort.

I am not sure about arm32, for similar reasons, but perhaps there is a
strong demand for &quot;embedded&quot; Squid that I do not know about (and that
does not materialize in a stream of PRs because Squid already works well
in those environments??)? How can we tell?


&gt;<i> Once achieved this status on any of these platforms,
</I>&gt;<i> regressions on it are release blockers.
</I>
I do not know what you mean by &quot;release&quot; exactly, but we should not add
rules that block schedule-based branching points and major releases[1].
As for other/minor releases, I am not against this rule if the
maintainer is happy about it.

[1] <A HREF="https://wiki.squid-cache.org/ReleaseSchedule">https://wiki.squid-cache.org/ReleaseSchedule</A>



&gt;<i> &quot;support as best effort&quot; means that we keep these environment as build
</I>&gt;<i> options, and test builds on them. Regressions on build or unit tests
</I>&gt;<i> on these environments are not PR-blocking but we strongly encourage
</I>&gt;<i> the PR owner to fix these platforms with followup PRs. We aim to
</I>&gt;<i> deliver an out-of-the-box build on these platforms but failure to do
</I>&gt;<i> so or regressions are not a release blocker
</I>
OK. If we drop the vague parts, &quot;best effort&quot; simply means that CI
covers these platforms (but they are not &quot;main&quot; environments and, hence,
the corresponding CI failures alone are not sufficient to block PRs).

AFAICT, the primary costs of keeping a platform on a best-effort list
are CI testing time and CI maintenance overheads. I suggest capping that
best-effort list to keep the total CI test time for one PR commit under,
say, 4 hours and granting CI maintenance team a veto on adding (but not
removing) platforms. IIRC, we have discussed PR commit testing time a
few months ago; if we agreed on another number of hours there, let's
take that as a cap.


&gt;&gt;&gt;<i> If anyone in the community wants to support/maintain extra OSes or
</I>&gt;&gt;&gt;<i> architectures, they're very welcome to do so
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> By &quot;welcome&quot;, do you mean something like &quot;we will accept high-quality
</I>&gt;&gt;<i> PRs adding such extra support to Squid&quot;? Or &quot;we will consider sharing
</I>&gt;&gt;<i> references to your work, but please do not ask us to merge your
</I>&gt;&gt;<i> OS-specific changes into the official Squid code&quot;? Something else? This
</I>&gt;&gt;<i> bit is critical for understanding the real effect of this proposal IMO.
</I>&gt;<i> 
</I>&gt;<i> Fair point. I'd go for the former. If someone has an environment they
</I>&gt;<i> want to support and do so without adding complexity to the code base,
</I>&gt;<i> it's a good policy to enable that. The question is &quot;how much
</I>&gt;<i> complexity is it healthy to impose on other platforms to support
</I>&gt;<i> niche/obsolete ones?&quot;
</I>&gt;<i> While setting an objective bar is hard to impossible, this is my
</I>&gt;<i> attempt to set one for the most active group of developers
</I>
I agree regarding the level of difficulty in defining that bar.

Unfortunately, I do not think &quot;we will accept high-quality PRs adding
such extra support to Squid&quot; is something we should run with. We simply
do not have the resources to support some new environments, even if PRs
introducing them are perfect in every respect. For example, a perfect PR
introducing (explicit) LibreSSL support should be blocked IMO because we
do not have enough resources to properly handle the two already
(unfortunately) accepted TLS libraries (OpenSSL and GnuTLS).

However, we can drop this part of your proposal in hope to get to the
consensus on the other, arguably more important parts: The definitions
of three support levels (main, best-effort, and other). We can come back
to this part of the discussion later/separately, armed with established
and tested support levels.


Cheers,

Alex.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009747.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
	<LI>Next message (by thread): <A HREF="009745.html">[squid-dev] What os/cpu platforms do we want to target as a project?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9743">[ date ]</a>
              <a href="thread.html#9743">[ thread ]</a>
              <a href="subject.html#9743">[ subject ]</a>
              <a href="author.html#9743">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
