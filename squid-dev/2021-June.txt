From rousskov at measurement-factory.com  Fri Jun  4 22:53:42 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Fri, 4 Jun 2021 18:53:42 -0400
Subject: [squid-dev] Compilling squid
In-Reply-To: <945521622314675@mail.yandex.ru>
References: <945521622314675@mail.yandex.ru>
Message-ID: <bcd97eed-f709-70f3-2d23-ef9ed786e281@measurement-factory.com>

On 5/29/21 2:58 PM, phenom252525 at yandex.ru wrote:

> Hello, please help with building squid with ssl support for filtering
> https in transparent mode. I am assembling from sources on ubuntu server
> 18.20 version. The problem is that reading on your site, I do not
> understand what dependencies are needed to build a transparent squid in
> each version. I search for articles on the Internet, but this does not
> give much, since the articles may be outdated and when assembling, a
> mountain of errors simply pours in. The question is where is the list of
> dependencies for the assembly and what else is needed. Sorry for the
> possibly stupid questions, I'm just learning to work with a squid and I
> don't understand some points, but I really want to learn. Thank you for
> your help.

IIRC, the following packages are sufficient to build Squid on relatively
modern AWS servers, but I am not sure whether they match Ubuntu server
18.20 needs specifically:

>     build-essential
>     g++
>     gdb
>     automake
>     autoconf
>     autoconf-archive
>     libtool
>     libtool-bin
>     libssl1.0-dev
>     zlib1g-dev
>     openssl
>     libsystemd-dev
>     pkg-config


> ./configure --enable-ssl-crtd --with-openssl ...

I suggest that you fix basic build errors before trying to add more
dependencies for interception. I do not know exactly what libraries you
need for interception support on Ubuntu, and the answer may depend on
what kind of interception you want to use. Others on this mailing list
may help with that.


HTH,

Alex.

From gkinkie at gmail.com  Sat Jun  5 13:16:40 2021
From: gkinkie at gmail.com (Francesco Chemolli)
Date: Sat, 5 Jun 2021 14:16:40 +0100
Subject: [squid-dev] Compilling squid
In-Reply-To: <bcd97eed-f709-70f3-2d23-ef9ed786e281@measurement-factory.com>
References: <945521622314675@mail.yandex.ru>
 <bcd97eed-f709-70f3-2d23-ef9ed786e281@measurement-factory.com>
Message-ID: <FABABF02-F11D-41C6-B338-9B9338E5B666@gmail.com>


>> ./configure --enable-ssl-crtd --with-openssl ...
> 
> I suggest that you fix basic build errors before trying to add more
> dependencies for interception. I do not know exactly what libraries you
> need for interception support on Ubuntu, and the answer may depend on
> what kind of interception you want to use. Others on this mailing list
> may help with that.
> 

https://github.com/kinkie/dockerfiles <https://github.com/kinkie/dockerfiles> has the definition of the containers
used to run the Squid build farm, including installation instructions for
all relevant or semi-relevant Linux flavors. It may contain extra dependencies
for the specific set of features needed, but if Squid fails to build with that set of
dependencies installed, I would be very curious to know about it

	Francesco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20210605/501a28b6/attachment.htm>

From rousskov at measurement-factory.com  Tue Jun  8 14:22:03 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 8 Jun 2021 10:22:03 -0400
Subject: [squid-dev] [squid-users] Squid modification to only read
 client SNI without bumping.
In-Reply-To: <7a9b5c791fbbe39041f19d31b8694779@treenet.co.nz>
References: <CAK7W0xennW+uGE11s7sMN5wZo13J9CcW4hXy+Edd1=XeHwMxXw@mail.gmail.com>
 <7a9b5c791fbbe39041f19d31b8694779@treenet.co.nz>
Message-ID: <a5fb3029-1295-a3fd-9402-114351bcc7a0@measurement-factory.com>

On 6/8/21 7:36 AM, squid3 at treenet.co.nz wrote:

> The way I think to approach it though is to start with the
> configuration parser.

That starting point does not compute for me. We do need to agree on how
to configure this feature, but parsing any resulting Squid configuration
ought to be very straightforward. Perhaps you have meant "TLS
ClientHello parser", but Squid already has that.


> A simple peek-splice/terminate TLS traffic flow
> should not need certificates setup by admin.

Squid already does not generate/use certificates for splicing or
terminating connections. In splice-or-terminate use cases, the
certificates come into play only when delivery _errors_. A feature to
prevent bumping for error delivery (and remove any configuration
requirements for CA certificate) should be welcomed IMO.

Please drop squid-users if responding to this email.

Alex.

