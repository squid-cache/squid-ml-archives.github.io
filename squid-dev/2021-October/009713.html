<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] RFC: Categorize level-0/1 messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Categorize%20level-0/1%20messages&In-Reply-To=%3Cc917fc15-bd3e-429a-e059-9bb7d8db0b20%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009712.html">
   <LINK REL="Next"  HREF="009714.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] RFC: Categorize level-0/1 messages</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Categorize%20level-0/1%20messages&In-Reply-To=%3Cc917fc15-bd3e-429a-e059-9bb7d8db0b20%40measurement-factory.com%3E"
       TITLE="[squid-dev] RFC: Categorize level-0/1 messages">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct 21 03:16:12 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009712.html">[squid-dev] RFC: Categorize level-0/1 messages
</A></li>
        <LI>Next message (by thread): <A HREF="009714.html">[squid-dev] request for change handling hostStrictVerify
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9713">[ date ]</a>
              <a href="thread.html#9713">[ thread ]</a>
              <a href="subject.html#9713">[ subject ]</a>
              <a href="author.html#9713">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/20/21 3:14 PM, Amos Jeffries wrote:
&gt;<i> On 21/10/21 4:22 am, Alex Rousskov wrote:
</I>&gt;&gt;<i> To facilitate automatic monitoring of Squid cache.logs, I suggest to
</I>&gt;&gt;<i> adjust Squid code to divide all level-0/1 messages into two major
</I>&gt;&gt;<i> categories -- &quot;problem messages&quot; and &quot;status messages&quot;[0]:
</I>

&gt;<i> We already have a published categorization design which (when/if used)
</I>&gt;<i> solves the problem(s) you are describing. Unfortunately that design has
</I>&gt;<i> not been followed by all authors and conversion of old code to it has
</I>&gt;<i> not been done.
</I>
&gt;<i> Please focus your project on making Squid actually use the system of
</I>&gt;<i> debugs line labels. The labels are documented at:
</I>&gt;<i> &#160; <A HREF="https://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages">https://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages</A>
</I>
AFAICT, the partial classification in that wiki table is an opinion on
how things could be designed, and that opinion does not reflect Project
consensus. FWIW, I cannot use that wiki table for labeling messages, but
I do not want to hijack this RFC thread for that table review.

Fortunately, there are many similarities between the wiki table and this
RFC that we can and should capitalize on instead:

* While the wiki table is silent about the majority of existing
cache.log messages, most of the messages it is silent about probably
belong to the &quot;status messages&quot; category proposed by this RFC. This
assumption gives a usable match between the wiki table and the RFC for
about half of the existing level-0/1 cache.log messages. Great!

* The wiki table talks about FATAL, ERROR, and WARNING messages. These
labels match the RFC &quot;problem messages&quot; category. This match covers all
of the remaining cache.log messages except for 10 debugs() detailed
below. Thus, so far, there is a usable match on nearly all current
level-0/1 messages. Excellent!

* The wiki table also uses three &quot;SECURITY ...&quot; labels. The RFC does not
recognize those labels as special. I find their definitions in the wiki
table unusable/impractical, and you naturally think otherwise, but the
situation is not as bad as it may seem at the first glance:

- &quot;SECURITY ERROR&quot; is used once to report a coding _bug_. That single
use case does not match the wiki table SECURITY ERROR description. We
should be able to rephrase that single message so that does it not
contradict the wiki table and the RFC.

- &quot;SECURITY ALERT&quot; is used 6 times. Most or all of those cases are a
poor match for the SECURITY ALERT description in the wiki table IMHO. I
hope we can find a way to rephrase those 6 cases to avoid conflicts.

- &quot;SECURITY NOTICE&quot; is used 3 times. Two of those use cases can be
simply removed by removing the long-deprecated and increasingly poorly
supported SslBump features. I do not see why we should keep the third
message/feature, but if it must be kept, we may be able to rephrase it.

If we cannot reach an agreement regarding these 10 special messages, we
can leave them as is for now, and come back to them when we find a way
to agree on how/whether to assign additional labels to some messages.


Thus, there are no significant conflicts between the RFC and the table!
We strongly disagree how labels should be defined, but I do not think we
have to agree on those details to make progress here. We only need to
agree that (those 10 SECURITY messages aside) the RFC-driven message
categorization projects should adjust (the easily adjustable) messages
about Squid problems to use three standard labels: FATAL, ERROR, and
WARNING. Can we do just that and set aside the other disagreements for
another time?

If there are serious disagreements whether a specific debugs() is an
ERROR or WARNING, we can leave those specific messages intact until we
find a way to reach consensus. I hope there will be very few such
messages if we use the three labels from the RFC and do our best to
avoid controversial changes.


&gt;<i> What we do not have in that design is clarity on which labels are shown
</I>&gt;<i> at what level.
</I>
In hope to make progress, I strongly suggest to _ignore_ the difference
between level 0 and level 1 for now. We are just too far apart on that
topic to reach consensus AFAICT. The vast majority of messages that
RFC-driven projects should touch (and, if really needed, _all_ such
messages!) can be left at their current level, avoiding this problem.



&gt;<i> I have one worry about you taking this on right now. PR 574 has not been
</I>&gt;<i> resolved and merged yet, but many of the debugs() messages you are going
</I>&gt;<i> to be touching in here should be converted to thrown exceptions - which
</I>&gt;<i> ones and what exception type is used has some dependency on how that PR
</I>&gt;<i> turns out.
</I>
If the RFC PRs are merged first, Factory will help resolve conflicts in
the PR 574 branch. While resolving boring conflicts is certainly
annoying, this is not really a big deal in this case, and both projects
are worth the pain.

Alternatively, I can offer to massage PR 574 branch into merge-able
shape _before_ we start working on these PRs. While the current branch
code has serious problems, I believe they have known straightforward
solutions that will allow us to make progress in a much more efficient way.


Cheers,

Alex.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009712.html">[squid-dev] RFC: Categorize level-0/1 messages
</A></li>
	<LI>Next message (by thread): <A HREF="009714.html">[squid-dev] request for change handling hostStrictVerify
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9713">[ date ]</a>
              <a href="thread.html#9713">[ thread ]</a>
              <a href="subject.html#9713">[ subject ]</a>
              <a href="author.html#9713">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
