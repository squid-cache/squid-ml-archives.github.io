<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] Alternate origin server selection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Alternate%20origin%20server%20selection&In-Reply-To=%3Cf9e7634f-fa00-e282-dcb7-081aef4fe745%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009718.html">
   <LINK REL="Next"  HREF="009720.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] Alternate origin server selection</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20Alternate%20origin%20server%20selection&In-Reply-To=%3Cf9e7634f-fa00-e282-dcb7-081aef4fe745%40measurement-factory.com%3E"
       TITLE="[squid-dev] Alternate origin server selection">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct 28 17:16:37 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009718.html">[squid-dev] Alternate origin server selection
</A></li>
        <LI>Next message (by thread): <A HREF="009720.html">[squid-dev] Alternate origin server selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9719">[ date ]</a>
              <a href="thread.html#9719">[ thread ]</a>
              <a href="subject.html#9719">[ subject ]</a>
              <a href="author.html#9719">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/28/21 12:39 PM, Steve Hill wrote:
&gt;<i> On 28/10/2021 16:41, Alex Rousskov wrote:
</I>&gt;&gt;<i> AFAICT, the primary obstacle here is that Squid pins the connection
</I>&gt;&gt;<i> while obtaining the origin server certificate.
</I>
&gt;<i> Well, I can't see why Squid needs the origin certificate - it should be
</I>&gt;<i> able to make a decision off the SNI before connecting to the origin server.
</I>
Squid does not &quot;need&quot; any of this, of course. Configuration and/or bugs
force Squid to do what it does. If your decision-making process does not
involve the certificate, then you should be able to rewrite the fake
CONNECT request during SslBump step2, without (or before) telling Squid
to stare at the certificate (and pin the resulting connection).

There are bugs in this area, including bugs that may prevent certain
CONNECT adaptations from happening. We are fixing one of those bugs
right now. For details, you can see an unpolished/unofficial pull
request at <A HREF="https://github.com/measurement-factory/squid/pull/108">https://github.com/measurement-factory/squid/pull/108</A>


&gt;<i> I didn't seem to be able to make the decision prior to the connection
</I>&gt;<i> being pinned though.&#160; I'm not sure why - I will go back and investigate
</I>&gt;<i> further.
</I>
Sounds like a plan!


Cheers,

Alex.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009718.html">[squid-dev] Alternate origin server selection
</A></li>
	<LI>Next message (by thread): <A HREF="009720.html">[squid-dev] Alternate origin server selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9719">[ date ]</a>
              <a href="thread.html#9719">[ thread ]</a>
              <a href="subject.html#9719">[ subject ]</a>
              <a href="author.html#9719">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
