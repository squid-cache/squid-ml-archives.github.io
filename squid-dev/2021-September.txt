From darshitpandit95 at gmail.com  Tue Sep  7 23:21:33 2021
From: darshitpandit95 at gmail.com (Darshit Pandit)
Date: Tue, 7 Sep 2021 16:21:33 -0700
Subject: [squid-dev] Decrypt SSL traffic and add Header
In-Reply-To: <CAB6xNqwkWiSfyqRUf6qAZMxP1PDMzuoJW5=ciNY8hM2pPyoYzQ@mail.gmail.com>
References: <CAB6xNqwkWiSfyqRUf6qAZMxP1PDMzuoJW5=ciNY8hM2pPyoYzQ@mail.gmail.com>
Message-ID: <CAB6xNqxLRSeRcDWxTNo15tTRC-T=GiC6pfABojtDBY6n0ZF5cg@mail.gmail.com>

Hello,
    I had a quick question regarding the typical use-case I am trying with
squid proxy. I couldn't find anything in documentation that will help me
    What I need is a way to decrypt client https traffic using my own
decrypt certificate and add certain headers (XAU, XFF, etc.), then encrypt
again with the same cert and resend the same  client traffic to the
intended web server.
    Is the above workflow possible ? I know we have a peek 'n' slice method
in the latest squid but I am not sure if we have a way to use a custom
decrypt certificate and also add header post decryption. Please let me know.

-Thanks,
Darshit
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20210907/01a3b24c/attachment.htm>

From gkinkie at gmail.com  Mon Sep 20 07:16:48 2021
From: gkinkie at gmail.com (Francesco Chemolli)
Date: Mon, 20 Sep 2021 08:16:48 +0100
Subject: [squid-dev] Incoming breaking changes to OpenSSL API
Message-ID: <CA+Y8hcOcF159dRcPx06JCh_VsaZuP5ytAFB8s+R-BzuUjF4jbQ@mail.gmail.com>

Hi all,
  Fedora Rawhide has upgraded openssl to version 3, and the results
can be seen at
https://build.squid-cache.org/job/anybranch-arm64-matrix/COMPILER=gcc,OS=fedora-rawhide,label=arm64/10/console

For example:

In file included from ../../../../src/security/Session.h:15,
                 from ../../../../src/security/forward.h:15,
                 from ../../../../src/SquidConfig.h:26,
                 from ../../../../src/mem/old_api.cc:24:
../../../../src/security/forward.h: In function ?void
Security::DH_free_cpp(DH*)?:
../../../../src/security/LockingPointer.h:34:21: error: ?void
DH_free(DH*)? is deprecated: Since OpenSSL 3.0
[-Werror=deprecated-declarations]
   34 |             function(a); \


-- 
    Francesco

From squid3 at treenet.co.nz  Mon Sep 20 07:37:06 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 20 Sep 2021 19:37:06 +1200
Subject: [squid-dev] Incoming breaking changes to OpenSSL API
In-Reply-To: <CA+Y8hcOcF159dRcPx06JCh_VsaZuP5ytAFB8s+R-BzuUjF4jbQ@mail.gmail.com>
References: <CA+Y8hcOcF159dRcPx06JCh_VsaZuP5ytAFB8s+R-BzuUjF4jbQ@mail.gmail.com>
Message-ID: <109cffe4-548e-a851-4348-b51d84503d53@treenet.co.nz>

On 20/09/21 7:16 pm, Francesco Chemolli wrote:
> Hi all,
>    Fedora Rawhide has upgraded openssl to version 3, and the results
> can be seen at
> https://build.squid-cache.org/job/anybranch-arm64-matrix/COMPILER=gcc,OS=fedora-rawhide,label=arm64/10/console
> 
> For example:
> 
> In file included from ../../../../src/security/Session.h:15,
>                   from ../../../../src/security/forward.h:15,
>                   from ../../../../src/SquidConfig.h:26,
>                   from ../../../../src/mem/old_api.cc:24:
> ../../../../src/security/forward.h: In function ?void
> Security::DH_free_cpp(DH*)?:
> ../../../../src/security/LockingPointer.h:34:21: error: ?void
> DH_free(DH*)? is deprecated: Since OpenSSL 3.0
> [-Werror=deprecated-declarations]
>     34 |             function(a); \
> 
> 

<https://github.com/squid-cache/squid/pull/694>

Amos

From gkinkie at gmail.com  Mon Sep 20 08:55:15 2021
From: gkinkie at gmail.com (Francesco Chemolli)
Date: Mon, 20 Sep 2021 09:55:15 +0100
Subject: [squid-dev] Incoming breaking changes to OpenSSL API
In-Reply-To: <109cffe4-548e-a851-4348-b51d84503d53@treenet.co.nz>
References: <CA+Y8hcOcF159dRcPx06JCh_VsaZuP5ytAFB8s+R-BzuUjF4jbQ@mail.gmail.com>
 <109cffe4-548e-a851-4348-b51d84503d53@treenet.co.nz>
Message-ID: <CA+Y8hcNb+swwxNgpRE_nikXYGjSG2iWsoo-LqP1sqvsUT6hUkw@mail.gmail.com>

I just checked a built on Fedora rawhide; it builds fine!

BTW: if you want to test it, there is a tool in my support-tools repo
(https://github.com/kinkie/support-tools)

squid-build/do-build --in <distroname> --build --force --no-ccache
--log=build.log --layer=02

will do the heavy lifting, or at least it does for me.
It requires
- a working docker setup on the build machine
- I've only ever tested with uid 1001 (kinkie) and 1000. (jenkins);
not sure about other users, in fact I encourage you to test it and LMK
if it breaks

On Mon, Sep 20, 2021 at 8:42 AM Amos Jeffries <squid3 at treenet.co.nz> wrote:
>
> On 20/09/21 7:16 pm, Francesco Chemolli wrote:
> > Hi all,
> >    Fedora Rawhide has upgraded openssl to version 3, and the results
> > can be seen at
> > https://build.squid-cache.org/job/anybranch-arm64-matrix/COMPILER=gcc,OS=fedora-rawhide,label=arm64/10/console
> >
> > For example:
> >
> > In file included from ../../../../src/security/Session.h:15,
> >                   from ../../../../src/security/forward.h:15,
> >                   from ../../../../src/SquidConfig.h:26,
> >                   from ../../../../src/mem/old_api.cc:24:
> > ../../../../src/security/forward.h: In function ?void
> > Security::DH_free_cpp(DH*)?:
> > ../../../../src/security/LockingPointer.h:34:21: error: ?void
> > DH_free(DH*)? is deprecated: Since OpenSSL 3.0
> > [-Werror=deprecated-declarations]
> >     34 |             function(a); \
> >
> >
>
> <https://github.com/squid-cache/squid/pull/694>
>
> Amos
> _______________________________________________
> squid-dev mailing list
> squid-dev at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-dev



-- 
    Francesco

