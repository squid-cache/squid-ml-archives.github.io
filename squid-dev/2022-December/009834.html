<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] RFC: Switch to C++17
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Switch%20to%20C%2B%2B17&In-Reply-To=%3Cdfa25bb6-32b6-9436-e5a9-f0f4dd06e373%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009833.html">
   <LINK REL="Next"  HREF="009835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] RFC: Switch to C++17</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Switch%20to%20C%2B%2B17&In-Reply-To=%3Cdfa25bb6-32b6-9436-e5a9-f0f4dd06e373%40treenet.co.nz%3E"
       TITLE="[squid-dev] RFC: Switch to C++17">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Dec  5 11:18:36 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009833.html">[squid-dev] RFC: Switch to C++17
</A></li>
        <LI>Next message (by thread): <A HREF="009835.html">[squid-dev] RFC: Switch to C++17
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9834">[ date ]</a>
              <a href="thread.html#9834">[ thread ]</a>
              <a href="subject.html#9834">[ subject ]</a>
              <a href="author.html#9834">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I support the switch.

Caveat details below...


On 5/12/2022 5:21 am, Francesco Chemolli wrote:
&gt;<i> I support the switch
</I>&gt;<i>
</I>&gt;<i> On Sun, 4 Dec 2022 at 16:18, Alex Rousskov wrote:
</I>&gt;<i>
</I>&gt;<i>     Hello,
</I>&gt;<i>
</I>&gt;<i>     C++17 is supported by popular modern compilers and stable distros.
</I>&gt;<i>     Squid
</I>&gt;<i>     master branch should target those IMO. Even old environments can
</I>&gt;<i>     install
</I>&gt;<i>     the necessary modern compilers (e.g., RHEL5 users can get them via
</I>&gt;<i>     Red
</I>&gt;<i>     Hat Developer Toolset).
</I>&gt;<i>
</I>&gt;<i>     * GCC v5 supports most C++17 features.
</I>&gt;<i>     * GCC v8 supports all relevant C++17 features.
</I>&gt;<i>     * Clang v5 supports nearly all C++17 features.
</I>&gt;<i>     * Clang v8 supports all relevant C++17 features.
</I>&gt;<i>
</I>
non-RHEL distros shipping Squid are almost all providing at lease GCC 
v8. In many cases even their recently refreshed (Nov 2022) LTS have it.

The RHEL family distros (CentOS 7 in particular, but also many others) 
LTS versions only provide LLVM/clang v7 from the C++17 compilers.

So I think we could bump to require GCC v8 or Clang v7 minimum without 
much fuss. That would leave us figuring out what (if any) hacks we 
needed for the clang v7 vs C++17 feature gaps. Hopefully no worse than 
what we have been doing to figure out the GCC 4.8 vs C++11 feature gaps.

It has been a while since I had any info about the RedHat developer 
toolset. Do you know if GCC 8+ or LLVM/clang 8+ are in there? if so, 
then bump to v8 for both compilers and full speed ahead :-)


&gt;<i>
</I>&gt;<i>     Switching to just C++14 would be better than nothing, but it will not
</I>&gt;<i>     give us several C++17 features that we already waste serious time on
</I>&gt;<i>     emulating/avoiding (e.g., std::optional). We should not switch to
</I>&gt;<i>     C++20
</I>&gt;<i>     yet because modern stable compilers still have some C++20 support
</I>&gt;<i>     holes.
</I>&gt;<i>
</I>
Agreed, C++14 is not worth the jump, and C++20 is far too early.

[ IMO in general we should leave ~5 years for the distro LTS to catch up 
on compilers releases before considering adopting a language update. ]


Cheers
Amos

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009833.html">[squid-dev] RFC: Switch to C++17
</A></li>
	<LI>Next message (by thread): <A HREF="009835.html">[squid-dev] RFC: Switch to C++17
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9834">[ date ]</a>
              <a href="thread.html#9834">[ thread ]</a>
              <a href="subject.html#9834">[ subject ]</a>
              <a href="author.html#9834">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
