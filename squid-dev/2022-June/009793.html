<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] RFC: Class section/member _order_
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Class%20section/member%20_order_&In-Reply-To=%3C003d2899-8300-0d4b-cc44-8f9e623429c0%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009792.html">
   <LINK REL="Next"  HREF="009794.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] RFC: Class section/member _order_</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20RFC%3A%20Class%20section/member%20_order_&In-Reply-To=%3C003d2899-8300-0d4b-cc44-8f9e623429c0%40measurement-factory.com%3E"
       TITLE="[squid-dev] RFC: Class section/member _order_">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Jun 23 13:37:04 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009792.html">[squid-dev] RFC: Class section/member order
</A></li>
        <LI>Next message (by thread): <A HREF="009794.html">[squid-dev] RFC: Class section/member _order_
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9793">[ date ]</a>
              <a href="thread.html#9793">[ thread ]</a>
              <a href="subject.html#9793">[ subject ]</a>
              <a href="author.html#9793">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

     Amos and I disagreed[1] regarding the existing guidelines for 
section/member order in C++ class declarations. To resolve that 
disagreement, this email proposes the order for future use.

-----

1. Class &quot;sections&quot; order (by member access specifiers): public, 
protected, private. Each section, if present, declared once. Omit 
sections that would be empty. Rationale: List most commonly reused, most 
important things fist. In this context, those are public class 
interfaces. The private section is the least important implementation 
detail as far as the notion of a C++ class is concerned.


2. Within each section, the recommended member order is defined below. 
Rationale: Group similar things together to facilitate searching and 
highlight differences. List things most likely to be reused (by other 
class members) and most important/influential things higher.

* friendship declarations
* type and aliases declarations; nested classes/structs/unions
* static member functions
* constructors and assignment operators
* destructors (just one until C++20)
* other/regular non-static member functions except overrides
* overrides (see item 3 below)
* static data members
* non-static data members


3. Overrides are a special case where we do not expect member 
descriptions but do expect a reference to the corresponding API as 
sketched below. Overrides are grouped by the (direct or indirect) parent 
that _introduced_ the corresponding API method(s) (i.e. the parent class 
that declared the virtual method but could _not_ use an override keyword 
in that declaration). Rationale: Provide API context and facilitate 
searching for member descriptions without chasing overrides through parents.

     /* Baz API */
     overrides for Baz-introduced methods (excluding destructors)

     /* Bar API */
     overrides for Bar-introduced methods (excluding destructors)


4. Caveats

The above rules are not meant to force authors to include any access 
specifiers or members that the code does not actually need (except the 
&quot;private&quot; specifier should be mentioned explicitly in class declarations 
that have only private members -- do not rely on the class default 
access specifier being &quot;private&quot;).

Squid has some legacy code that forces CBDATA-related declarations to be 
hoisted to the very top of the class, into the &quot;unnamed&quot; section. This 
is an exception to the above rules. Eventually, we will stop doing that, 
but we should continue doing that for consistency sake until the 
offending CBDATA macros are gone.

Like any style rules, these rules are not comprehensive. If your use 
case is not explicitly covered, then look around for similar Squid code 
and try to be consistent and/or reasonable.

-----

Most of the above rules are arbitrary but common in the industry[2,3].

[1] <A HREF="https://github.com/squid-cache/squid/pull/1067#discussion_r889864925">https://github.com/squid-cache/squid/pull/1067#discussion_r889864925</A>
[2] <A HREF="https://stackoverflow.com/q/308581">https://stackoverflow.com/q/308581</A>
[3] <A HREF="https://google.github.io/styleguide/cppguide.html#Declaration_Order">https://google.github.io/styleguide/cppguide.html#Declaration_Order</A>


HTH,

Alex.
P.S. This is my Nth attempt to get through the mailing list filter. You 
may have received a pretty much the same message as an attachment to the 
previous mailing list post. Sorry about the noise!
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009792.html">[squid-dev] RFC: Class section/member order
</A></li>
	<LI>Next message (by thread): <A HREF="009794.html">[squid-dev] RFC: Class section/member _order_
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9793">[ date ]</a>
              <a href="thread.html#9793">[ thread ]</a>
              <a href="subject.html#9793">[ subject ]</a>
              <a href="author.html#9793">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
