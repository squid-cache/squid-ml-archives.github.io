From gkinkie at gmail.com  Wed Dec  6 21:47:30 2023
From: gkinkie at gmail.com (Francesco Chemolli)
Date: Wed, 6 Dec 2023 21:47:30 +0000
Subject: [squid-dev] RFC: ACL clashes with Windows system entity
Message-ID: <CA+Y8hcMTebb7uyuXYbC=fi4RaKw6RL+atcQdKxJRmxdQMeR4QQ@mail.gmail.com>

Hi all,
  I'm looking at improving windows portability, and we have a name clash
with a Windows system header (
https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-acl)

So.. how to deal with it?
I can see two options: either we lift ACL into the Acl namespace, or we
need to rename it. ACL is referenced in 106 files, so the change is going
to be big, so I ask if there are any opinions on how to go about this

Thanks,

-- 
    Francesco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-dev/attachments/20231206/cf8d6c22/attachment.htm>

From squid3 at treenet.co.nz  Thu Dec  7 01:35:35 2023
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 7 Dec 2023 14:35:35 +1300
Subject: [squid-dev] RFC: ACL clashes with Windows system entity
In-Reply-To: <CA+Y8hcMTebb7uyuXYbC=fi4RaKw6RL+atcQdKxJRmxdQMeR4QQ@mail.gmail.com>
References: <CA+Y8hcMTebb7uyuXYbC=fi4RaKw6RL+atcQdKxJRmxdQMeR4QQ@mail.gmail.com>
Message-ID: <b59116fe-c371-4f33-ad6e-fb9e4441672f@treenet.co.nz>

On 7/12/23 10:47, Francesco Chemolli wrote:
> Hi all,
>  ? I'm looking at improving windows portability, and we have a name 
> clash with a Windows system header 
> (https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-acl 
> <https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-acl>)
> 
> So.. how to deal with it?
> I can see two options: either we lift ACL into the Acl namespace, or we 
> need to rename it. ACL is referenced in 106 files, so the change is 
> going to be big, so I ask if there are any opinions on how to go about this
> 

Or both.

I got partway through fixing this in 
<https://github.com/squid-cache/squid/pull/1350>. Feel free to resume it 
if you like.

Amos

From rousskov at measurement-factory.com  Thu Dec  7 20:22:11 2023
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Thu, 7 Dec 2023 15:22:11 -0500
Subject: [squid-dev] RFC: ACL clashes with Windows system entity
In-Reply-To: <CA+Y8hcMTebb7uyuXYbC=fi4RaKw6RL+atcQdKxJRmxdQMeR4QQ@mail.gmail.com>
References: <CA+Y8hcMTebb7uyuXYbC=fi4RaKw6RL+atcQdKxJRmxdQMeR4QQ@mail.gmail.com>
Message-ID: <fd94b952-7080-4555-8b65-9b5a05c4af45@measurement-factory.com>

On 2023-12-06 16:47, Francesco Chemolli wrote:
> Hi all,
>  ? I'm looking at improving windows portability, and we have a name 
> clash with a Windows system header 
> (https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-acl)
> 
> So.. how to deal with it?
> I can see two options: either we lift ACL into the Acl namespace, or we 
> need to rename it. ACL is referenced in 106 files, so the change is 
> going to be big, so I ask if there are any opinions on how to go about this


We need to rename/move ACL into Acl::Node or similar (as PR 1350 
attempted to do but got bogged down in many out-of-scope changes).

I suggest to do nothing right now: After 20+ recently merged smooth 
reconfiguration PRs, we are getting really close to reference counting 
ACL objects. If PR 1350 is not merged by that time, we can rename that 
class in that upcoming PR because refcounting changes will have to touch 
a lot of the same code...


HTH,

Alex.


