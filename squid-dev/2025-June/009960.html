<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BIssue%20Report%5D%20Squid%20forward%20request%20to%200.0.0.0/8&In-Reply-To=%3C9f2ee826cd454f898e2dcb7042173bf3%40nwcdcloud.cn%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="009961.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8</H1>
    <B>Yang, Chao</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BIssue%20Report%5D%20Squid%20forward%20request%20to%200.0.0.0/8&In-Reply-To=%3C9f2ee826cd454f898e2dcb7042173bf3%40nwcdcloud.cn%3E"
       TITLE="[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8">yngcho at nwcdcloud.cn
       </A><BR>
    <I>Thu Jun  5 08:04:09 UTC 2025</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="009961.html">[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9960">[ date ]</a>
              <a href="thread.html#9960">[ thread ]</a>
              <a href="subject.html#9960">[ subject ]</a>
              <a href="author.html#9960">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Squid Support Team,
Hope you are everything well.

I meet a strange issue and hope you could give some suggestions.

Background:
I am using squid as a proxy to register my SUSE EC2 Instance in AWS. I installed squid in Amazon Linux 2023 and just modify /etc/squid/squid.conf file &quot;http_access deny all&quot; to &quot;http_access allow all&quot;.

After that , I set the enviroment in SUSE Instance(172.31.45.49 is Squid instance):
    env | grep proxy
    https_proxy=<A HREF="http://172.31.45.49:3128">http://172.31.45.49:3128</A>
    http_proxy=<A HREF="http://172.31.45.49:3128">http://172.31.45.49:3128</A>
    no_proxy=169.254.169.254

When I tried to register SUSE instance with command &quot;registercloudguest --force-new&quot;, got the following error(/var/log/cloudregister):
===================================================================================================================
2025-06-05 05:23:34,418 ERROR:  Registration failed: Registering system to registration proxy <A HREF="https://smt-ec2.susecloud.net">https://smt-ec2.susecloud.net</A>

Updating system details on <A HREF="https://smt-ec2.susecloud.net">https://smt-ec2.susecloud.net</A> ...

Activating sle-module-web-scripting 15.5 x86_64 ...
-&gt; Adding service to system ...
command '/usr/bin/zypper --non-interactive refs Web_and_Scripting_Module_x86_64' failed
Error: zypper returned 1 with 'Unexpected exception.
Unknown error reading from 'plugin:/susecloud?credentials=Web_and_Scripting_Module_x86_64&amp;path=/services/2494'
History:
- Not ready to read within timeout.

Please file a bug report about this.
See <A HREF="http://en.opensuse.org/Zypper/Troubleshooting">http://en.opensuse.org/Zypper/Troubleshooting</A> for instructions.' (exit status 1)
===================================================================================================================

Action taken:
I found there are lots of strange log when I register SUSE as below(/var/log/squid/access.log):
===================================================================================================================
1749103351.951      3 172.31.47.207 TCP_DENIED/403 3804 CONNECT 0.0.10.40:1 - HIER_NONE/- text/html
1749103366.975      4 172.31.47.207 TCP_DENIED/403 3802 CONNECT 0.0.9.96:7 - HIER_NONE/- text/html
1749103375.466  59932 172.31.47.207 TCP_TUNNEL/503 0 CONNECT 0.0.9.102:443 - HIER_DIRECT/0.0.9.102 -
===================================================================================================================

After I edited the config file(/etc/squid/squid.conf) and add the following:
    acl invalid_dst dst 0.0.0.0/8
    http_access deny invalid_dst

I could register SUSE without any error.

When I access Amazon S3 using squid instance, there is no any strange IP in the access log.

I checked /etc/hosts and no any information of &quot;0.0.0.0/8&quot;

Action Required:
Do you know why squid forward request to 0.0.0.0/8?

Thank you!

Best Regards
Yang Chao
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-dev/attachments/20250605/4ec7495e/attachment.htm">http://lists.squid-cache.org/pipermail/squid-dev/attachments/20250605/4ec7495e/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="009961.html">[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9960">[ date ]</a>
              <a href="thread.html#9960">[ thread ]</a>
              <a href="subject.html#9960">[ subject ]</a>
              <a href="author.html#9960">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
