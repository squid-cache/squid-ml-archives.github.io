<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BIssue%20Report%5D%20Squid%20forward%20request%20to%200.0.0.0/8&In-Reply-To=%3Cd16d152a-cc2e-49d2-bff8-24bb6182c93d%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009960.html">
   <LINK REL="Next"  HREF="009962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-dev%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-dev%5D%20%5BIssue%20Report%5D%20Squid%20forward%20request%20to%200.0.0.0/8&In-Reply-To=%3Cd16d152a-cc2e-49d2-bff8-24bb6182c93d%40treenet.co.nz%3E"
       TITLE="[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Jun  5 10:49:03 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009960.html">[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
</A></li>
        <LI>Next message (by thread): <A HREF="009962.html">[squid-dev] compiling squid 7.0.2 on Debian abends
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9961">[ date ]</a>
              <a href="thread.html#9961">[ thread ]</a>
              <a href="subject.html#9961">[ subject ]</a>
              <a href="author.html#9961">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/06/25 20:04, Yang, Chao wrote:
&gt;<i> 
</I>&gt;<i> I found there are lots of strange log when I register SUSE as below(/ 
</I>&gt;<i> var/log/squid/access.log):
</I>&gt;<i> 
</I>&gt;<i> / 
</I>&gt;<i> ===================================================================================================================/
</I>&gt;<i> 
</I>&gt;<i> /1749103351.951&#160;&#160;&#160;&#160;&#160; 3 172.31.47.207 TCP_DENIED/403 3804 CONNECT 
</I>&gt;<i> 0.0.10.40:1 - HIER_NONE/- text/html/
</I>&gt;<i> 
</I>
Squid received the HTTP request &quot;CONNECT 0.0.10.40:1&quot;.

The port 1 is forbidden by SSL_ports, so Squid sent a 403 Denied response.


&gt;<i> /1749103366.975&#160;&#160;&#160;&#160;&#160; 4 172.31.47.207 TCP_DENIED/403 3802 CONNECT 
</I>&gt;<i> 0.0.9.96:7 - HIER_NONE/- text/html/
</I>&gt;<i> 
</I>
Squid received the HTTP request &quot;CONNECT 0.0.9.96:7&quot;.

The port 7 is forbidden by SSL_ports, so Squid sent a 403 Denied response.


&gt;<i> /1749103375.466&#160; 59932 172.31.47.207 TCP_TUNNEL/503 0 CONNECT 
</I>&gt;<i> 0.0.9.102:443 - HIER_DIRECT/0.0.9.102 -/
</I>&gt;<i> 
</I>
Squid received the HTTP request &quot;CONNECT 0.0.9.102:443&quot;.

The port 443 is valid for HTTPS, so Squid opened a tunnel to that server 
(successfully). The connection closed after 59.9 seconds, with no data 
sent to the client.


&gt;<i> / 
</I>&gt;<i> ===================================================================================================================/
</I>&gt;<i> 
</I>&gt;<i> After I edited the config file(/etc/squid/squid.conf) and add the following:
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160; acl invalid_dst dst 0.0.0.0/8
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160;&#160;http_access deny invalid_dst
</I>&gt;<i> 
</I>&gt;<i> I could register SUSE without any error.
</I>

The error is something inside the SUSE zypper or the plugin it is using 
to access their cloud services. Whoever coded it did not expect that IP 
address range to work in &quot;public&quot; Internet.

Squid is just trying to do what it is told to do. It looks to me like it 
is working.



&gt;<i> 
</I>&gt;<i> When I access Amazon S3 using squid instance, there is no any strange IP 
</I>&gt;<i> in the access log.
</I>&gt;<i> 
</I>
That being an entirely different company and/or web service. One can 
expect them to be different.


&gt;<i> I checked /etc/hosts and no any information of &quot;0.0.0.0/8&quot;
</I>&gt;<i> 
</I>
Those IPs are being sent to Squid directly by the &quot;registercloudguest&quot; 
software.  Why, is a different question and should be taken up with the 
SUSE people or whoever wrote the zypper plugin that tool is using.



&gt;<i> *Action Required:*
</I>&gt;<i> 
</I>&gt;<i> Do you know why squid forward request to 0.0.0.0/8?
</I>&gt;<i> 
</I>
As you have discovered that range is used by Cloud services. Typically 
for internal messaging. In some of the environments Squid operates it is 
treated as equivalent to a LAN range for VMs.


Cheers
Amos
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009960.html">[squid-dev] [Issue Report] Squid forward request to 0.0.0.0/8
</A></li>
	<LI>Next message (by thread): <A HREF="009962.html">[squid-dev] compiling squid 7.0.2 on Debian abends
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9961">[ date ]</a>
              <a href="thread.html#9961">[ thread ]</a>
              <a href="subject.html#9961">[ subject ]</a>
              <a href="author.html#9961">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-dev">More information about the squid-dev
mailing list</a><br>
</body></html>
