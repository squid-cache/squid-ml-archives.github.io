<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sun,&nbsp;Jul&nbsp;12,&nbsp;2015&nbsp;at&nbsp;10:20&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;12/07/2015&nbsp;7:03&nbsp;p.m.,&nbsp;Kinkie&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;tried&nbsp;it.&nbsp;Unfortunately&nbsp;it&nbsp;fails&nbsp;for&nbsp;those&nbsp;cases&nbsp;of&nbsp;debugs()&nbsp;which&nbsp;do&nbsp;not&lt;br&gt;<br>
&gt;&nbsp;use&nbsp;xstrerror,&nbsp;e.g.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;../../src/esi/Element.h:&nbsp;In&nbsp;member&nbsp;function&nbsp;&#39;virtual&nbsp;bool&lt;br&gt;<br>
&gt;&nbsp;ESIElement::addElement(ESIElement::Pointer)&#39;:&lt;br&gt;<br>
&gt;&nbsp;../../src/esi/Element.h:64:74:&nbsp;error:&nbsp;unused&nbsp;variable&nbsp;&#39;_squid_errno&#39;&lt;br&gt;<br>
&gt;&nbsp;[-Werror=unused-variable]&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;debugs(86,5,&nbsp;&quot;ESIElement::addElement:&nbsp;Failed&nbsp;for&nbsp;&quot;&nbsp;&lt;&lt;&nbsp;this);&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;:(&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;believe&nbsp;putting&nbsp;the&nbsp;burden&nbsp;of&nbsp;saving&nbsp;state&nbsp;to&nbsp;the&nbsp;caller&nbsp;is&nbsp;way&nbsp;too&lt;br&gt;<br>
&gt;&nbsp;intrusive:&nbsp;a&nbsp;simple&nbsp;count&nbsp;places&nbsp;the&nbsp;number&nbsp;of&nbsp;xstrerror&nbsp;calls&nbsp;at&nbsp;about&nbsp;260.&lt;br&gt;<br>
&gt;&nbsp;So&nbsp;we&#39;re&nbsp;back&nbsp;to&nbsp;square&nbsp;one,&nbsp;the&nbsp;-v2&nbsp;patch.&nbsp;Do&nbsp;you&nbsp;see&nbsp;any&nbsp;other&nbsp;options?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;No&nbsp;sorry.&nbsp;But&nbsp;I&nbsp;do&nbsp;know&nbsp;that&nbsp;we&nbsp;also&nbsp;have&nbsp;to&nbsp;deal&nbsp;with&nbsp;CONTENT&nbsp;cotaining&lt;br&gt;<br>
nested&nbsp;functions&nbsp;etc.&nbsp;That&nbsp;means&nbsp;nested&nbsp;debugs()&nbsp;calls...&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes,&nbsp;but&nbsp;we&nbsp;do&nbsp;not&nbsp;really&nbsp;need&nbsp;to&nbsp;be&nbsp;reentrant:&nbsp;the&nbsp;problems&nbsp;you&nbsp;have&nbsp;identified&nbsp;are&nbsp;all&nbsp;in&nbsp;debugLogTime,&nbsp;which&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;reentrant&nbsp;(and&nbsp;right&nbsp;now&nbsp;it&nbsp;is&nbsp;not,&nbsp;as&nbsp;it&nbsp;uses&nbsp;a&nbsp;static&nbsp;buffer).&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
At&nbsp;debugs&nbsp;level&nbsp;9&nbsp;this&nbsp;is&nbsp;a&nbsp;big&nbsp;problem,&nbsp;particularly&nbsp;for&nbsp;things&nbsp;like&lt;br&gt;<br>
debugs&nbsp;in&nbsp;SBuf/String/MemBuf/MemAllocator&nbsp;methods&nbsp;that&nbsp;get&nbsp;triggered&nbsp;by&lt;br&gt;<br>
any&nbsp;object&nbsp;producing&nbsp;debug&nbsp;output&nbsp;for&nbsp;display.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes.&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;the&nbsp;same&nbsp;time,&nbsp;while&nbsp;the&nbsp;proposed&nbsp;patch&nbsp;may&nbsp;not&nbsp;be&nbsp;the&nbsp;final&nbsp;fix&nbsp;to&nbsp;the&nbsp;problem,&nbsp;I&nbsp;believe&nbsp;it&nbsp;helps&nbsp;a&nbsp;little&nbsp;bit&nbsp;in&nbsp;improving&nbsp;things.&nbsp;Especially&nbsp;since&nbsp;no&nbsp;alternate&nbsp;path&nbsp;seems&nbsp;viable.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt; &nbsp; &nbsp;Francesco&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
