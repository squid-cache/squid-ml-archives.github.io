<tt>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Alex,&lt;br&gt;<br>
 &nbsp;it&nbsp;turns&nbsp;out&nbsp;that&nbsp;the&nbsp;itch&nbsp;is&nbsp;real,&nbsp;and&nbsp;this&nbsp;is&nbsp;actually&nbsp;going&nbsp;to&nbsp;be&nbsp;useful&nbsp;in&nbsp;carrying&nbsp;forward&nbsp;the&nbsp;HttpHeader&nbsp;restructuring&nbsp;I&#39;m&nbsp;doing&nbsp;in&nbsp;lp:~kinkie/squid/coverity-fixes,&nbsp;to&nbsp;iterate&nbsp;over&nbsp;the&nbsp;list&nbsp;of&nbsp;header&nbsp;types&nbsp;for&nbsp;various&nbsp;purposes&nbsp;(compacting,&nbsp;etc).&lt;br&gt;<br>
So&nbsp;I&nbsp;went&nbsp;ahead&nbsp;and&nbsp;just&nbsp;implemented&nbsp;it,&nbsp;starting&nbsp;from&nbsp;your&nbsp;observations.&lt;br&gt;<br>
It&#39;s&nbsp;a&nbsp;bit&nbsp;more&nbsp;complex&nbsp;that&nbsp;your&nbsp;proposal,&nbsp;as&nbsp;I&nbsp;took&nbsp;the&nbsp;chance&nbsp;to&nbsp;implement&nbsp;bidirectional&nbsp;forward&nbsp;and&nbsp;reverse&nbsp;iterators.&lt;br&gt;<br>
The&nbsp;attached&nbsp;patch&nbsp;is&nbsp;in&nbsp;changeset 14235&nbsp;of&nbsp;lp:~kinkie/squid/coverity-fixes,&nbsp;but&nbsp;since&nbsp;the&nbsp;code&nbsp;is&nbsp;quite&nbsp;well&nbsp;self-contained&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;submit&nbsp;it&nbsp;for&nbsp;audit&nbsp;as&nbsp;a&nbsp;standalone&nbsp;unit;&nbsp;If&nbsp;it&nbsp;passed&nbsp;I&#39;ll&nbsp;merge&nbsp;it&nbsp;to&nbsp;trunk&nbsp;with&nbsp;the&nbsp;code&nbsp;that&nbsp;uses&nbsp;it.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Thanks!&lt;br&gt;&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quot&lt;blockquote&nbsp;class=&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;08/05/2015&nbsp;07:58&nbsp;PM,&nbsp;Kinkie&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;What&nbsp;I&nbsp;understand&nbsp;from&nbsp;the&nbsp;changes&nbsp;you&nbsp;propose&nbsp;is&nbsp;that:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;1.&nbsp;instead&nbsp;of&nbsp;having&nbsp;explicit&nbsp;begin/end&nbsp;markers&nbsp;passed&nbsp;as&nbsp;template&lt;br&gt;<br>
&gt;&nbsp;arguments&nbsp;you&nbsp;propose&nbsp;to&nbsp;have&nbsp;a&nbsp;convention&nbsp;on&nbsp;begin/end&nbsp;markers.&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;are&nbsp;several&nbsp;different&nbsp;things/layers&nbsp;mixed&nbsp;up&nbsp;here:&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;If&nbsp;we&nbsp;want&nbsp;to&nbsp;use&nbsp;range&nbsp;loops&nbsp;for&nbsp;enums&nbsp;[in&nbsp;a&nbsp;sane&nbsp;way],&nbsp;then&nbsp;our&lt;br&gt;<br>
enums&nbsp;should&nbsp;have&nbsp;begin/end&nbsp;markers.&nbsp;Many&nbsp;already&nbsp;do,&nbsp;but&nbsp;we&nbsp;will&nbsp;have&lt;br&gt;<br>
to&nbsp;standardize&nbsp;their&nbsp;names&nbsp;and&nbsp;fill&nbsp;the&nbsp;gaps.&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;The&nbsp;begin/end&nbsp;parameters&nbsp;should&nbsp;not&nbsp;be&nbsp;template&nbsp;parameters.&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;If&nbsp;we&nbsp;need&nbsp;to&nbsp;iterate&nbsp;sub-ranges,&nbsp;then&nbsp;we&nbsp;should&nbsp;add&nbsp;EnumRangeT&lt;Enum&gt;&lt;br&gt;<br>
class&nbsp;with&nbsp;begin/end&nbsp;as&nbsp;constructor&nbsp;parameters&nbsp;(see&nbsp;below).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;2.&nbsp;you&nbsp;skip&nbsp;the&nbsp;typedef&nbsp;fixing&nbsp;these&nbsp;parameters&nbsp;in&nbsp;favor&nbsp;of&nbsp;letting&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;template&nbsp;parameters&nbsp;appear&nbsp;in&nbsp;the&nbsp;calls.&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;are&nbsp;two&nbsp;separate&nbsp;issues/layers&nbsp;here:&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;Naming&nbsp;an&nbsp;expression&nbsp;is&nbsp;a&nbsp;good&nbsp;idea,&nbsp;especially&nbsp;if&nbsp;that&nbsp;name&nbsp;is&nbsp;going&lt;br&gt;<br>
to&nbsp;be&nbsp;used&nbsp;multiple&nbsp;times.&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;Fewer&nbsp;template&nbsp;parameters&nbsp;are&nbsp;generally&nbsp;better&nbsp;if&nbsp;they&nbsp;can&nbsp;accomplish&lt;br&gt;<br>
the&nbsp;same&nbsp;thing&nbsp;as&nbsp;more&nbsp;template&nbsp;parameters.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;1.&nbsp;looks&nbsp;interesting,&nbsp;especially&nbsp;as&nbsp;an&nbsp;enum&nbsp;missing&nbsp;those&nbsp;markers&nbsp;will&lt;br&gt;<br>
&gt;&nbsp;fail&nbsp;to&nbsp;compile.&nbsp;Maybe&nbsp;both&nbsp;approaches&nbsp;can&nbsp;be&nbsp;combined&nbsp;by&nbsp;using&nbsp;default&lt;br&gt;<br>
&gt;&nbsp;template&nbsp;arguments,&nbsp;what&nbsp;do&nbsp;you&nbsp;think?&lt;br&gt;<br>
&gt;&nbsp;template&nbsp;&lt;typename&nbsp;C,&nbsp;C&nbsp;first&nbsp;=&nbsp;C::enumBegin_,&nbsp;C&nbsp;last_plus_one&nbsp;=&lt;br&gt;<br>
&gt;&nbsp;C::enumEnd_&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;we&nbsp;should&nbsp;not&nbsp;specify&nbsp;iteration&nbsp;range&nbsp;boundaries&nbsp;as&nbsp;template&lt;br&gt;<br>
parameters.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;3.&nbsp;we&nbsp;could&nbsp;maybe&nbsp;combine&nbsp;the&nbsp;benefits&nbsp;of&nbsp;beautiful&nbsp;range-for&nbsp;and&nbsp;ugly&lt;br&gt;<br>
&gt;&nbsp;explicit-for&nbsp;also&nbsp;for&nbsp;shorter&nbsp;ranges&nbsp;by&nbsp;having&nbsp;(in&nbsp;the&nbsp;class-based&lt;br&gt;<br>
&gt;&nbsp;variant),&nbsp;on&nbsp;top&nbsp;of&nbsp;what&nbsp;you&nbsp;have&nbsp;already&nbsp;proposed&nbsp;(untested)&lt;br&gt;<br>
&lt;br&gt;<br>
Yes,&nbsp;if&nbsp;sub-range&nbsp;iteration&nbsp;using&nbsp;range&nbsp;loops&nbsp;is&nbsp;needed,&nbsp;then&nbsp;we&nbsp;should&lt;br&gt;<br>
add&nbsp;EnumRangeT&lt;Enum&gt;&nbsp;class&nbsp;that&nbsp;does&nbsp;it.&nbsp;Sorry&nbsp;if&nbsp;I&nbsp;have&nbsp;not&nbsp;mentioned&lt;br&gt;<br>
that&nbsp;explicitly.&lt;br&gt;<br>
&lt;br&gt;<br>
Your&nbsp;sketch&nbsp;for&nbsp;that&nbsp;class&nbsp;is&nbsp;fine,&nbsp;but&nbsp;it&nbsp;will&nbsp;be&nbsp;a&nbsp;EnumRangeT&nbsp;class,&lt;br&gt;<br>
separate&nbsp;from&nbsp;simpler&nbsp;WholeEnum,&nbsp;and&nbsp;we&nbsp;would&nbsp;try&nbsp;to&nbsp;define&nbsp;a&nbsp;function&lt;br&gt;<br>
that&nbsp;will&nbsp;create&nbsp;that&nbsp;EnumRangeT&nbsp;object&nbsp;so&nbsp;that&nbsp;we&nbsp;only&nbsp;have&nbsp;to&nbsp;type&lt;br&gt;<br>
&quot;Numbers&quot;&nbsp;zero&nbsp;or&nbsp;two&nbsp;times&nbsp;as&nbsp;illustrated&nbsp;below:&lt;br&gt;<br>
&lt;br&gt;<br>
template&nbsp;&lt;typename&nbsp;Enum&gt;&lt;br&gt;<br>
inline&lt;br&gt;<br>
EnumRangeT&lt;Enum&gt;&nbsp;EnumRange(const&nbsp;Enum&nbsp;from,&nbsp;const&nbsp;Enum&nbsp;to)&nbsp;{&lt;br&gt;<br>
 &nbsp; &nbsp;return&nbsp;EnumRangeT&lt;Enum&gt;(from,&nbsp;to);&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;that&nbsp;instead&nbsp;of:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;for&nbsp;(auto&nbsp;i&nbsp;:&nbsp;WholeEnum&lt;Numbers&gt;(Numbers::one,&nbsp;Numbers::three))&nbsp;{&lt;br&gt;<br>
&gt; &nbsp;//&nbsp;do&nbsp;stuff&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
we&nbsp;could&nbsp;do:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;//&nbsp;iterating&nbsp;sub-range&nbsp;of&nbsp;a&nbsp;class&nbsp;enum:&lt;br&gt;<br>
 &nbsp;for&nbsp;(auto&nbsp;i:&nbsp;EnumRange(Numbers::one,&nbsp;Numbers::three))&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;//&nbsp;iterating&nbsp;sub-range&nbsp;of&nbsp;a&nbsp;global&nbsp;C&nbsp;enum:&lt;br&gt;<br>
 &nbsp;for&nbsp;(auto&nbsp;i:&nbsp;EnumRange(one,&nbsp;three))&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;//&nbsp;iterating&nbsp;a&nbsp;whole&nbsp;enum:&lt;br&gt;<br>
 &nbsp;for&nbsp;(auto&nbsp;i:&nbsp;WholeEnum&lt;Numbers&gt;())&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Again,&nbsp;the&nbsp;above&nbsp;range&nbsp;objects&nbsp;can&nbsp;be&nbsp;named&nbsp;(and&nbsp;the&nbsp;first&nbsp;two&nbsp;should&nbsp;be&lt;br&gt;<br>
named&nbsp;if&nbsp;they&nbsp;are&nbsp;used&nbsp;more&nbsp;than&nbsp;once).&nbsp;For&nbsp;example:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;WholeEnum&lt;Numbers&gt;&nbsp;AllNumbers()&nbsp;{&nbsp;return&nbsp;WholeEnum&lt;Numbers&gt;();&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;EnumRange&lt;Numbers&gt;&nbsp;FooBarNumbers()&nbsp;{&nbsp;return&nbsp;EnumRange(Numbers::foo,&lt;br&gt;<br>
Numbers::bar);&nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;It&nbsp;looks&nbsp;to&nbsp;me&nbsp;that&nbsp;I&nbsp;have&nbsp;crossed&nbsp;an&nbsp;itch&nbsp;you&nbsp;feel&nbsp;as&nbsp;well,&lt;br&gt;<br>
&lt;br&gt;<br>
No,&nbsp;I&nbsp;am&nbsp;just&nbsp;trying&nbsp;to&nbsp;help&nbsp;you&nbsp;scratch&nbsp;your&nbsp;itch&nbsp;without&nbsp;scarring&lt;br&gt;<br>
Squid&nbsp;code.&nbsp;I&nbsp;do&nbsp;not&nbsp;know&nbsp;whether&nbsp;your&nbsp;itch&nbsp;is&nbsp;real&nbsp;or&nbsp;imaginary.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
