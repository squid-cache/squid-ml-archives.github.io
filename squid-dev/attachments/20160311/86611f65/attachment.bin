Migrate lastAclData to an SBuf.

This is submitted on behalf of Bloomberg L.P.

=== modified file 'src/AccessLogEntry.cc'
--- src/AccessLogEntry.cc	2016-01-01 00:12:18 +0000
+++ src/AccessLogEntry.cc	2016-03-11 04:07:32 +0000
@@ -76,7 +76,6 @@
     HTTPMSGUNLOCK(adapted_request);
 
     safe_free(lastAclName);
-    safe_free(lastAclData);
 
     HTTPMSGUNLOCK(reply);
     HTTPMSGUNLOCK(request);

=== modified file 'src/AccessLogEntry.h'
--- src/AccessLogEntry.h	2016-01-01 00:12:18 +0000
+++ src/AccessLogEntry.h	2016-03-11 04:25:25 +0000
@@ -42,7 +42,6 @@
     AccessLogEntry() :
         url(nullptr),
         lastAclName(nullptr),
-        lastAclData(nullptr),
         reply(nullptr),
         request(nullptr),
         adapted_request(nullptr)
@@ -207,7 +206,7 @@
 #endif
 
     const char *lastAclName; ///< string for external_acl_type %ACL format code
-    const char *lastAclData; ///< string for external_acl_type %DATA format code
+    SBuf lastAclData; ///< string for external_acl_type %DATA format code
 
     HierarchyLogEntry hier;
     HttpReply *reply;

=== modified file 'src/external_acl.cc'
--- src/external_acl.cc	2016-02-19 17:19:25 +0000
+++ src/external_acl.cc	2016-03-11 04:07:33 +0000
@@ -742,7 +742,7 @@
                 }
             }
 
-            ch->al->lastAclData = xstrdup(sb.c_str());
+            ch->al->lastAclData = sb;
         }
 
 #if USE_IDENT

=== modified file 'src/format/Format.cc'
--- src/format/Format.cc	2016-02-13 07:51:20 +0000
+++ src/format/Format.cc	2016-03-11 04:07:33 +0000
@@ -1381,7 +1381,7 @@
             break;
 
         case LFT_EXT_ACL_DATA:
-            out = al->lastAclData;
+            out = al->lastAclData.c_str();
             break;
         }
 

