<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;widows:&nbsp;1;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;white-space:&nbsp;pre-wrap;&quot;&gt;Hello,<br>
<br>
This&nbsp;patch&nbsp;forces&nbsp;Squid&nbsp;to&nbsp;always&nbsp;revalidate&nbsp;Cache-Control:no-cache<br>
responses.<br>
<br>
Squid&nbsp;MUST&nbsp;NOT&nbsp;use&nbsp;a&nbsp;CC:no-cache&nbsp;response&nbsp;for&nbsp;satisfying&nbsp;subsequent<br>
requests&nbsp;without&nbsp;successful&nbsp;validation&nbsp;with&nbsp;the&nbsp;origin&nbsp;server.&nbsp;Squid<br>
violated&nbsp;this&nbsp;MUST&nbsp;because&nbsp;Squid&nbsp;mapped&nbsp;both&nbsp;&quot;no-cache&quot;&nbsp;and<br>
&quot;must-revalidate&quot;/etc.&nbsp;directives&nbsp;to&nbsp;the&nbsp;same&nbsp;ENTRY_REVALIDATE&nbsp;flag<br>
which&nbsp;was&nbsp;interpreted&nbsp;as&nbsp;&quot;revalidate&nbsp;when&nbsp;the&nbsp;cached&nbsp;response&nbsp;becomes<br>
stale&quot;&nbsp;rather&nbsp;than&nbsp;&quot;revalidate&nbsp;on&nbsp;every&nbsp;request&quot;.<br>
<br>
This&nbsp;patch&nbsp;splits&nbsp;ENTRY_REVALIDATE&nbsp;into:<br>
-&nbsp;ENTRY_REVALIDATE_ALWAYS,&nbsp;for&nbsp;entries&nbsp;with&nbsp;CC:no-cache&nbsp;and<br>
-&nbsp;ENTRY_REVALIDATE_STALE,&nbsp;for&nbsp;entries&nbsp;with&nbsp;other&nbsp;related&nbsp;CC&nbsp;directives<br>
&nbsp;&nbsp;like&nbsp;CC:must-revalidate&nbsp;and&nbsp;CC:proxy-revalidate.<br>
<br>
Reusing&nbsp;ENTRY_CACHABLE_RESERVED_FOR_FUTURE_USE&nbsp;value&nbsp;for&nbsp;the&nbsp;more<br>
forgiving&nbsp;ENTRY_REVALIDATE_STALE&nbsp;(instead&nbsp;of&nbsp;the&nbsp;more&nbsp;aggressive<br>
ENTRY_REVALIDATE_ALWAYS)&nbsp;fixes&nbsp;the&nbsp;bug&nbsp;for&nbsp;the&nbsp;already&nbsp;cached&nbsp;entries&nbsp;-<br>
they&nbsp;will&nbsp;be&nbsp;revalidated&nbsp;and&nbsp;stored&nbsp;with&nbsp;the&nbsp;correct&nbsp;flag&nbsp;on&nbsp;the&nbsp;next<br>
request.<br>
<br>
<br>
Regards,<br>
Eduard.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
