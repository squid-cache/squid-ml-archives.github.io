<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;14.02.2017&nbsp;04:22,&nbsp;Amos&nbsp;Jeffries<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:4c5ca6b2-dfc7-a1c3-be01-973373ae3b89@treenet.co.nz&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;The&nbsp;problem&nbsp;is&nbsp;with&nbsp;proxy&nbsp;where&nbsp;the&nbsp;admin&nbsp;has&nbsp;configured&nbsp;large&nbsp;headers<br>
to&nbsp;be&nbsp;allowed,&nbsp;and&nbsp;receives&nbsp;a&nbsp;Via&nbsp;just&nbsp;under&nbsp;the&nbsp;6KB&nbsp;liit.&nbsp;Our&nbsp;append<br>
pushing&nbsp;it&nbsp;over&nbsp;by&nbsp;even&nbsp;one&nbsp;byte&nbsp;would&nbsp;assert.&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;attaching&nbsp;a&nbsp;patch&nbsp;using&nbsp;SBuf&nbsp;instead&nbsp;of&nbsp;String&nbsp;for&nbsp;Via&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumulating,&nbsp;as&nbsp;you&nbsp;previously&nbsp;suggested.&nbsp;I&nbsp;am&nbsp;not&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sure&nbsp;this&nbsp;is&nbsp;a&nbsp;much&nbsp;better&nbsp;solution&nbsp;since&nbsp;we&nbsp;have&nbsp;to&nbsp;do&nbsp;an&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;extra&nbsp;copy&nbsp;into&nbsp;SBuf.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;The&nbsp;older&nbsp;bbuf&nbsp;code&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;cropping&nbsp;at&nbsp;1KB&nbsp;was&nbsp;nasty&nbsp;but&nbsp;would&nbsp;not&nbsp;crash&nbsp;Squid.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;don't&nbsp;see&nbsp;the&nbsp;code&nbsp;preventing&nbsp;Squid&nbsp;from&nbsp;String&nbsp;overflow&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;there.&nbsp;The&nbsp;bbuf&nbsp;you&nbsp;are&nbsp;talking&nbsp;about&nbsp;was&nbsp;appended&nbsp;to&nbsp;via&nbsp;string&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;strListAdd()&nbsp;without&nbsp;any&nbsp;checks...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thanks,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Eduard.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
