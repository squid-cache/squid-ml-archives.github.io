<tt>
&lt;div&gt;&lt;br&gt;&gt;&gt;&nbsp;I&nbsp;want&nbsp;to&nbsp;know&nbsp;what's&nbsp;the&lt;br&gt;&gt;&gt;&nbsp;pinning.serverConnection&nbsp;mean?&nbsp;and&nbsp;what&nbsp;it&nbsp;is&nbsp;used&nbsp;for?&lt;br&gt;&lt;br&gt;&gt;Before&nbsp;we&nbsp;dive&nbsp;into&nbsp;low-level&nbsp;details,&nbsp;please&nbsp;allow&nbsp;me&nbsp;to&nbsp;ask&nbsp;an&lt;br&gt;&gt;important&nbsp;high-level&nbsp;question.&nbsp;Your&nbsp;answer&nbsp;may&nbsp;render&nbsp;those&nbsp;low-level&lt;br&gt;&gt;detail&nbsp;irrelevant:&lt;br&gt;&lt;br&gt;&gt;&gt;&nbsp;I&nbsp;want&nbsp;to&nbsp;rewrite&nbsp;the&nbsp;on_unsupported_protocol&nbsp;to&nbsp;support&nbsp;tcp&nbsp;connection&lt;/div&gt;&lt;div&gt;&gt;&gt;(non-http&nbsp;protocol,&nbsp;called&nbsp;httpdns&nbsp;not&nbsp;readable,&nbsp;no&nbsp;http&nbsp;header)&nbsp;and&lt;/div&gt;&lt;div&gt;&gt;&gt;&nbsp;relay&nbsp;it&nbsp;the&nbsp;server.&nbsp;[...]&nbsp;I&nbsp;need&nbsp;assign&nbsp;the&nbsp;server's&nbsp;address&nbsp;and&nbsp;port&lt;/div&gt;&lt;div&gt;&lt;br&gt;&gt;Where&nbsp;will&nbsp;your&nbsp;code&nbsp;get&nbsp;the&nbsp;server&nbsp;address&nbsp;and&nbsp;port&nbsp;from?&nbsp;If&nbsp;the&nbsp;answer&lt;br&gt;&gt;is&nbsp;&quot;from&nbsp;the&nbsp;received&nbsp;httpdns&nbsp;message&nbsp;header&quot;,&nbsp;then&nbsp;please&nbsp;do&nbsp;not&nbsp;abuse&lt;br&gt;&gt;on_unsupported_protocol&nbsp;to&nbsp;support&nbsp;&quot;httpdns&quot;.&nbsp;Instead,&nbsp;add&nbsp;proper&lt;br&gt;&gt;support&nbsp;for&nbsp;httpdns&nbsp;(which&nbsp;may&nbsp;be&nbsp;limited&nbsp;to&nbsp;forwarding&nbsp;httpdns&nbsp;queries&lt;br&gt;&gt;to&nbsp;the&nbsp;right&nbsp;server&nbsp;if&nbsp;such&nbsp;blind&nbsp;forwarding&nbsp;makes&nbsp;sense).&lt;br&gt;&lt;br&gt;No,&nbsp;I&nbsp;got&nbsp;it&nbsp;from&nbsp;`clientConnection-&gt;local`,&nbsp;the&nbsp;httpdns&nbsp;is&nbsp;just&nbsp;a&nbsp;tcp&nbsp;connection&nbsp;to&nbsp;server&nbsp;with&lt;/div&gt;&lt;div&gt;specified&nbsp;protocol,&nbsp;not&nbsp;known&nbsp;to&nbsp;me,&nbsp;it&nbsp;is&nbsp;designed&nbsp;by&nbsp;its&nbsp;user,&nbsp;use&nbsp;80&nbsp;port&nbsp;to&nbsp;transfer&nbsp;dns&nbsp;request.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&gt;BTW,&nbsp;can&nbsp;you&nbsp;post&nbsp;a&nbsp;link&nbsp;to&nbsp;the&nbsp;&quot;httpdns&quot;&nbsp;protocol&nbsp;specification&nbsp;(not&lt;br&gt;&gt;API)?&nbsp;And&nbsp;what&nbsp;do&nbsp;you&nbsp;mean&nbsp;by&nbsp;&quot;not&nbsp;readable&quot;?&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;is&nbsp;not&nbsp;a&nbsp;standard&nbsp;protocol&nbsp;in&nbsp;RFC&nbsp;or&nbsp;some&nbsp;standard&nbsp;specification,&nbsp;just&nbsp;some&nbsp;company&nbsp;use&nbsp;&lt;/div&gt;&lt;div&gt;80&nbsp;(default&nbsp;for&nbsp;http&nbsp;protocol)&nbsp;port&nbsp;to&nbsp;transfer&nbsp;dns&nbsp;request,&nbsp;they&nbsp;do&nbsp;this&nbsp;because&nbsp;in&nbsp;China&nbsp;many&nbsp;&lt;/div&gt;&lt;div&gt;ISP&nbsp;would&nbsp;use&nbsp;they&nbsp;own&nbsp;dns&nbsp;server&nbsp;in&nbsp;different&nbsp;places&nbsp;which&nbsp;makes&nbsp;it&nbsp;slow&nbsp;&lt;/div&gt;&lt;div&gt;or&nbsp;unreachable&nbsp;to&nbsp;the&nbsp;some&nbsp;company's&nbsp;service.&lt;/div&gt;&lt;div&gt;&lt;sign&nbsp;signid=&quot;-1&quot;&gt;&lt;/sign&gt;&lt;/div&gt;&lt;div&gt;&lt;qzone&gt;&lt;/qzone&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;includetail&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font:Verdana&nbsp;normal&nbsp;14px;color:#000;&quot;&gt;&lt;div&nbsp;style=&quot;FONT-SIZE:&nbsp;12px;FONT-FAMILY:&nbsp;Arial&nbsp;Narrow;padding:2px&nbsp;0&nbsp;2px&nbsp;0;&quot;&gt;------------------&nbsp;Original&nbsp;------------------&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT-SIZE:&nbsp;12px;background:#efefef;padding:8px;&quot;&gt;&lt;div&nbsp;id=&quot;menu_sender&quot;&gt;&lt;b&gt;From:&nbsp;&lt;/b&gt;&nbsp;&quot;squid-dev-request&quot;&lt;squid-dev-request@lists.squid-cache.org&gt;;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Date:&nbsp;&lt;/b&gt;&nbsp;Sat,&nbsp;Mar&nbsp;25,&nbsp;2017&nbsp;08:00&nbsp;PM&lt;/div&gt;&lt;div&gt;&lt;b&gt;To:&nbsp;&lt;/b&gt;&nbsp;&quot;squid-dev&quot;&lt;squid-dev@lists.squid-cache.org&gt;;&nbsp;&lt;wbr&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Subject:&nbsp;&lt;/b&gt;&nbsp;squid-dev&nbsp;Digest,&nbsp;Vol&nbsp;31,&nbsp;Issue&nbsp;47&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;Send&nbsp;squid-dev&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squid-dev@lists.squid-cache.org&lt;br&gt;&lt;br&gt;To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;&nbsp;&nbsp;http://lists.squid-cache.org/listinfo/squid-dev&lt;br&gt;or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;'help'&nbsp;to&lt;br&gt;&nbsp;squid-dev-request@lists.squid-cache.org&lt;br&gt;&lt;br&gt;You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squid-dev-owner@lists.squid-cache.org&lt;br&gt;&lt;br&gt;When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;squid-dev&nbsp;digest...&quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;Today's&nbsp;Topics:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;1.&nbsp;Re:&nbsp;on_unsupported_protocol&nbsp;rewrite&nbsp;to&nbsp;support&nbsp;tcp&nbsp;connection&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relay&nbsp;(Alex&nbsp;Rousskov)&lt;br&gt;&lt;br&gt;&lt;br&gt;----------------------------------------------------------------------&lt;br&gt;&lt;br&gt;Message:&nbsp;1&lt;br&gt;Date:&nbsp;Fri,&nbsp;24&nbsp;Mar&nbsp;2017&nbsp;08:01:13&nbsp;-0600&lt;br&gt;From:&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;rousskov@measurement-factory.com&gt;&lt;br&gt;To:&nbsp;钱国正&nbsp;&lt;richard.qian@magicwifi.com.cn&gt;,&nbsp;squid-dev&lt;br&gt;&nbsp;&lt;squid-dev@lists.squid-cache.org&gt;&lt;br&gt;Subject:&nbsp;Re:&nbsp;[squid-dev]&nbsp;on_unsupported_protocol&nbsp;rewrite&nbsp;to&nbsp;support&lt;br&gt;&nbsp;&nbsp;tcp&nbsp;connection&nbsp;relay&lt;br&gt;Message-ID:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d0c3afc9-6189-a659-37a4-69fb40586543@measurement-factory.com&gt;&lt;br&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8&lt;br&gt;&lt;br&gt;On&nbsp;03/24/2017&nbsp;04:54&nbsp;AM,&nbsp;钱国正&nbsp;wrote:&lt;br&gt;&lt;br&gt;&gt;&nbsp;I&nbsp;want&nbsp;to&nbsp;know&nbsp;what's&nbsp;the&lt;br&gt;&gt;&nbsp;pinning.serverConnection&nbsp;mean?&nbsp;and&nbsp;what&nbsp;it&nbsp;is&nbsp;used&nbsp;for?&lt;br&gt;&lt;br&gt;Before&nbsp;we&nbsp;dive&nbsp;into&nbsp;low-level&nbsp;details,&nbsp;please&nbsp;allow&nbsp;me&nbsp;to&nbsp;ask&nbsp;an&lt;br&gt;important&nbsp;high-level&nbsp;question.&nbsp;Your&nbsp;answer&nbsp;may&nbsp;render&nbsp;those&nbsp;low-level&lt;br&gt;detail&nbsp;irrelevant:&lt;br&gt;&lt;br&gt;&gt;&nbsp;I&nbsp;want&nbsp;to&nbsp;rewrite&nbsp;the&nbsp;on_unsupported_protocol&nbsp;to&nbsp;support&nbsp;tcp&nbsp;connection&lt;br&gt;&gt;&nbsp;(non-http&nbsp;protocol,&nbsp;called&nbsp;httpdns&nbsp;not&nbsp;readable,&nbsp;no&nbsp;http&nbsp;header)&nbsp;and&lt;br&gt;&gt;&nbsp;relay&nbsp;it&nbsp;the&nbsp;server.&nbsp;[...]&nbsp;I&nbsp;need&nbsp;assign&nbsp;the&nbsp;server's&nbsp;address&nbsp;and&nbsp;port&lt;br&gt;&lt;br&gt;Where&nbsp;will&nbsp;your&nbsp;code&nbsp;get&nbsp;the&nbsp;server&nbsp;address&nbsp;and&nbsp;port&nbsp;from?&nbsp;If&nbsp;the&nbsp;answer&lt;br&gt;is&nbsp;&quot;from&nbsp;the&nbsp;received&nbsp;httpdns&nbsp;message&nbsp;header&quot;,&nbsp;then&nbsp;please&nbsp;do&nbsp;not&nbsp;abuse&lt;br&gt;on_unsupported_protocol&nbsp;to&nbsp;support&nbsp;&quot;httpdns&quot;.&nbsp;Instead,&nbsp;add&nbsp;proper&lt;br&gt;support&nbsp;for&nbsp;httpdns&nbsp;(which&nbsp;may&nbsp;be&nbsp;limited&nbsp;to&nbsp;forwarding&nbsp;httpdns&nbsp;queries&lt;br&gt;to&nbsp;the&nbsp;right&nbsp;server&nbsp;if&nbsp;such&nbsp;blind&nbsp;forwarding&nbsp;makes&nbsp;sense).&lt;br&gt;&lt;br&gt;BTW,&nbsp;can&nbsp;you&nbsp;post&nbsp;a&nbsp;link&nbsp;to&nbsp;the&nbsp;&quot;httpdns&quot;&nbsp;protocol&nbsp;specification&nbsp;(not&lt;br&gt;API)?&nbsp;And&nbsp;what&nbsp;do&nbsp;you&nbsp;mean&nbsp;by&nbsp;&quot;not&nbsp;readable&quot;?&lt;br&gt;&lt;br&gt;&lt;br&gt;Thank&nbsp;you,&lt;br&gt;&lt;br&gt;Alex.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;------------------------------&lt;br&gt;&lt;br&gt;Subject:&nbsp;Digest&nbsp;Footer&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;squid-dev&nbsp;mailing&nbsp;list&lt;br&gt;squid-dev@lists.squid-cache.org&lt;br&gt;http://lists.squid-cache.org/listinfo/squid-dev&lt;br&gt;&lt;br&gt;&lt;br&gt;------------------------------&lt;br&gt;&lt;br&gt;End&nbsp;of&nbsp;squid-dev&nbsp;Digest,&nbsp;Vol&nbsp;31,&nbsp;Issue&nbsp;47&lt;br&gt;*****************************************&lt;br&gt;&lt;/div&gt;&lt;!--&lt;![endif]--&gt;&lt;/includetail&gt;&lt;/div&gt;
</tt>
