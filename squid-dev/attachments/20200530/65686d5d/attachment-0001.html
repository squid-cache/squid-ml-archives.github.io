<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;all,&lt;div&gt; &nbsp; starting&nbsp;from&nbsp;a&nbsp;PR&nbsp;in&nbsp;a&nbsp;conversation&nbsp;with&nbsp;Alex&nbsp;about&nbsp;our&nbsp;current&nbsp;approach&nbsp;to&nbsp;unit&nbsp;testing&nbsp;being&nbsp;painful,&nbsp;I&#39;ve&nbsp;checked&nbsp;what&nbsp;alternatives&nbsp;would&nbsp;we&nbsp;have&nbsp;and&nbsp;how&nbsp;practical&nbsp;would&nbsp;they&nbsp;be.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;An&nbsp;easy&nbsp;first&nbsp;option&nbsp;would&nbsp;be&nbsp;googletest/googlemock.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;a&nbsp;lazy&nbsp;afternoon,&nbsp;I&#39;ve&nbsp;tried&nbsp;seeing&nbsp;how&nbsp;useful/painful&nbsp;it&nbsp;would&nbsp;be&nbsp;to&nbsp;try&nbsp;it,&nbsp;by&nbsp;porting&nbsp;one&nbsp;test&nbsp;over&nbsp;-&nbsp;it&#39;s&nbsp;quite&nbsp;trivial&nbsp;and&nbsp;doesn&#39;t&nbsp;require&nbsp;mocking,&nbsp;so&nbsp;I&#39;ll&nbsp;try&nbsp;a&nbsp;more&nbsp;complicated&nbsp;one&nbsp;next&nbsp;-&nbsp;to&nbsp;start&nbsp;a&nbsp;conversation&nbsp;about&nbsp;the&nbsp;topic.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;can&nbsp;find&nbsp;the&nbsp;test&nbsp;branch&nbsp;at &lt;a&nbsp;href=&quot;https://github.com/kinkie/squid/tree/gtest&quot;&gt;https://github.com/kinkie/squid/tree/gtest&lt;/a&gt; .&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;only&nbsp;touched&nbsp;two&nbsp;files,&nbsp;a&nbsp;newly-created&nbsp;src/tests/testMemGtest&nbsp;and&nbsp;src/Makefile.am .&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;output&nbsp;from&nbsp;the&nbsp;test&nbsp;run&nbsp;is&nbsp;at &lt;a&nbsp;href=&quot;https://paste.ubuntu.com/p/3sgTDN7rNm/&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;style=&quot;font-family:SFMono-Regular,Consolas,&quot;Liberation&nbsp;Mono&quot;,Menlo,monospace;font-size:13px;white-space:pre-wrap;box-sizing:border-box;background-color:initial;color:rgb(3,102,214);outline-width:0px&quot;&gt;https://paste.ubuntu.com/p/3sgTDN7rNm/&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What do&nbsp;you&nbsp;think?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;initial&nbsp;thoughts:&lt;/div&gt;&lt;div&gt;-&nbsp;it&nbsp;is&nbsp;somewhat&nbsp;simpler&nbsp;and&nbsp;more&nbsp;powerful&nbsp;than&nbsp;cppunit&lt;/div&gt;&lt;div&gt;-&nbsp;setting&nbsp;the&nbsp;test&nbsp;environment&nbsp;up&nbsp;is&nbsp;easy&nbsp;but&nbsp;at&nbsp;this&nbsp;time&nbsp;it&nbsp;can&nbsp;only&nbsp;be&nbsp;done&nbsp;from&nbsp;source.&nbsp;Adding&nbsp;it&nbsp;to&nbsp;the&nbsp;build&nbsp;farm&nbsp;images&nbsp;is&nbsp;straightforward&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;the&nbsp;license&nbsp;is&nbsp;BSD&nbsp;3-clause&nbsp;new&nbsp;(&lt;a&nbsp;href=&quot;https://github.com/google/googletest/blob/master/LICENSE&quot;&gt;https://github.com/google/googletest/blob/master/LICENSE&lt;/a&gt;) &lt;/div&gt;&lt;div&gt;-&nbsp;googlemock&nbsp;promises&nbsp;to&nbsp;be&nbsp;vastly&nbsp;superior&nbsp;to&nbsp;our&nbsp;current&nbsp;approach&lt;/div&gt;&lt;div&gt;-&nbsp;porting&nbsp;memTest&nbsp;took&nbsp;me&nbsp;about&nbsp;one&nbsp;hour,&nbsp;mostly&nbsp;caused&nbsp;by&nbsp;us&nbsp;including&nbsp;cppunit&nbsp;headers&nbsp;from&nbsp;squid.h&nbsp;(WUT?&nbsp;A&nbsp;PR&nbsp;is&nbsp;coming&nbsp;up&nbsp;to&nbsp;unentangle that)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt; &nbsp; &nbsp;Francesco&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
