<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;there,&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;was&nbsp;looking&nbsp;at&nbsp;the&nbsp;file&nbsp;src/auth/basic/UserRequest.cc,&nbsp;in&nbsp;function Auth::Basic::UserRequest::module_direction:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;case&nbsp;Auth::Ok:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;(user()-&gt;expiretime&nbsp;+&nbsp;static_cast&lt;Auth::Basic::Config*&gt;(Auth::SchemeConfig::Find(&quot;basic&quot;))-&gt;credentialsTTL&nbsp;&lt;=&nbsp;squid_curtime)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;Auth::CRED_LOOKUP;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;Auth::CRED_VALID;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;case&nbsp;Auth::Failed:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;Auth::CRED_VALID;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;was&nbsp;a&nbsp;bit&nbsp;alarmed&nbsp;that&nbsp;if&nbsp;an&nbsp;auth&nbsp;fails,&nbsp;it&nbsp;returns&nbsp;Auth::CRED_VALID. &lt;/div&gt;&lt;div&gt;Why&nbsp;is&nbsp;CRED_ERROR&nbsp;or&nbsp;CRED_CHALLENGE&nbsp;not&nbsp;used&nbsp;here?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;negotiate&nbsp;and&nbsp;NTLM&nbsp;code,&nbsp;there&nbsp;is&nbsp;a&nbsp;note:&lt;/div&gt;&lt;div&gt;&quot;XXX:&nbsp;really?&nbsp;not&nbsp;VALID&nbsp;or&nbsp;CHALLENGE?&quot;&nbsp;when&nbsp;CRED_ERROR&nbsp;is&nbsp;returned.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thankfully&nbsp;Squid&nbsp;doesn&#39;t&nbsp;really&nbsp;rely&nbsp;on&nbsp;this&nbsp;return&nbsp;value&nbsp;to&nbsp;determine&nbsp;whether&nbsp;a&nbsp;login&nbsp;is&nbsp;correct&nbsp;or&nbsp;not&nbsp;as&nbsp;it&nbsp;calls authenticateUserAuthenticated()&nbsp;which&nbsp;eventually&nbsp;checks credentials()&nbsp;== Auth::Ok.&nbsp;It&nbsp;all&nbsp;seems&nbsp;like&nbsp;quite&nbsp;a&nbsp;round-about&nbsp;method,&nbsp;however.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;According&nbsp;to &lt;a&nbsp;href=&quot;http://www.squid-cache.org/Doc/code/namespaceAuth.html?#afd721f7bc874e61ad0111999abf22a19a2d0cf49d6f94b0664c99dffb68cb4d5d&quot;&gt;http://www.squid-cache.org/Doc/code/namespaceAuth.html?#afd721f7bc874e61ad0111999abf22a19a2d0cf49d6f94b0664c99dffb68cb4d5d&lt;/a&gt;&nbsp;each&nbsp;of&nbsp;these&nbsp;calls&nbsp;should&nbsp;return CRED_CHALLENGE.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;are&nbsp;your&nbsp;thoughts&nbsp;on&nbsp;this?&nbsp;Should&nbsp;it&nbsp;be&nbsp;changed?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;Josh&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
