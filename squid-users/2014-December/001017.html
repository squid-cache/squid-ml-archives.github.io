<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] odd wccp issue affecting only some web servers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20odd%20wccp%20issue%20affecting%20only%20some%20web%20servers&In-Reply-To=%3C548108CA.9080805%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001014.html">
   <LINK REL="Next"  HREF="001051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] odd wccp issue affecting only some web servers</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20odd%20wccp%20issue%20affecting%20only%20some%20web%20servers&In-Reply-To=%3C548108CA.9080805%40treenet.co.nz%3E"
       TITLE="[squid-users] odd wccp issue affecting only some web servers">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Dec  5 01:22:18 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001014.html">[squid-users] odd wccp issue affecting only some web servers
</A></li>
        <LI>Next message (by thread): <A HREF="001051.html">[squid-users] odd wccp issue affecting only some web servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1017">[ date ]</a>
              <a href="thread.html#1017">[ thread ]</a>
              <a href="subject.html#1017">[ subject ]</a>
              <a href="author.html#1017">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 5/12/2014 6:58 a.m., Jason Haar wrote:
&gt;<i> Hi there
</I>&gt;<i> 
</I>&gt;<i> We have CentOS-6 squid-3.1.10-29 servers that are configured for
</I>&gt;<i> WCCP. They are working - for some web sites. eg &quot;www.slashdot.org&quot;
</I>&gt;<i> works (216.34.181.48), but &quot;slashdot.org&quot; doesn't (216.34.181.45).
</I>&gt;<i> Those are both on the same Class-C subnet.
</I>
&quot;Class-C&quot; ? ... oh right, that netmask thing they used to have before
1996. ;-P

&gt;<i> 
</I>&gt;<i> What I see is the SYN packet being forwarded for both from our
</I>&gt;<i> Cisco kit to the Linux &quot;wccp0&quot; interface, but only the
</I>&gt;<i> &quot;www.slashdot.org&quot; one leads to squid connecting to that website.
</I>&gt;<i> The other just stops. I can't tell if this is a fault in iptables
</I>&gt;<i> forwarding one and not the other to squid, or a problem with squid
</I>&gt;<i> - but iptables has the easier job so it shouldn't be in there.
</I>&gt;<i> (obviously we don't do any kind of weird, &quot;partial&quot; transparent
</I>&gt;<i> proxy - the iptables rule is to pass all port 80 traffic to squid).
</I>&gt;<i> Also both websites work fine through squid if you use it as a
</I>&gt;<i> normal proxy
</I>&gt;<i> 
</I>&gt;<i> Any ideas how to diagnose this, or is this a &quot;that was fixed in a
</I>&gt;<i> newer version that your OS vendor doesn't support&quot; kind of problem
</I>&gt;<i> ;-)
</I>&gt;<i> 
</I>
One is a HIT the other a MISS?
 Squid ACLs?
 TCP connection issue?

I suggest finding out what happens to the TCP DATA packets that follow
the SYN. There might be some clues in there, particularly if its a TCP
issue like path-MTU, ECN or Window scaling.

Whether its fixed in a new version is a &quot;maybe&quot;. Upgrade and see?


Squid might be trying IPv6 to contact slashdot.org (thus bypassing
your viewing), but it has no AAAA records when I resolve it. So that
is unlikely.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUgQjKAAoJELJo5wb/XPRjckgH/Am25yCkoC6hGF/ghVdwDi7C
ZkvoEmBSHBVSHt7SheScKwuymQxgghtj02veX6y6oEkHSycyhNJfTPW4XXTpYmqf
eMWo+Wqz10U3rc/fcpdz9OuCk76rq/fmnozGcKuG5F5g0oue+SPsPFOzPBt8D1GB
KIwkZKl9aKKfO0BatTMdGnnpP+NH3WB92SgNVW8G21QXvIRh4r5LSDzRa8VF5oTG
dEoFAS/aYMOyLOOZDYMx0LXCuMIJ865+Wle912N9vN6vugK5g1h89RAPtLJ2vPFt
yxP/IH3+zJQLtWj1gV+xgKWpDc3k0+sGzaQcs0j85izm8b93XCWF1SU774c455k=
=QsO6
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001014.html">[squid-users] odd wccp issue affecting only some web servers
</A></li>
	<LI>Next message (by thread): <A HREF="001051.html">[squid-users] odd wccp issue affecting only some web servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1017">[ date ]</a>
              <a href="thread.html#1017">[ thread ]</a>
              <a href="subject.html#1017">[ subject ]</a>
              <a href="author.html#1017">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
