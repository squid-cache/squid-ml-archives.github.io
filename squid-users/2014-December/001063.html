<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20do%20a%20fallback%20from%20ipv6%20to%20ipv4%2C%0A%20if%20the%20ipv6%20connect%20fails&In-Reply-To=%3C5488764E.4020506%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001057.html">
   <LINK REL="Next"  HREF="001157.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20do%20a%20fallback%20from%20ipv6%20to%20ipv4%2C%0A%20if%20the%20ipv6%20connect%20fails&In-Reply-To=%3C5488764E.4020506%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Dec 10 16:35:26 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001057.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
        <LI>Next message (by thread): <A HREF="001157.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1063">[ date ]</a>
              <a href="thread.html#1063">[ thread ]</a>
              <a href="subject.html#1063">[ subject ]</a>
              <a href="author.html#1063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 9/12/2014 4:48 a.m., Dieter Bloms wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> we use squid 3.4.9 as proxy for our company with ipv4 and ipv6
</I>&gt;<i> dual stack. It works good, but if a destination has an A and AAAA
</I>&gt;<i> record and the webserver isn't reachable via ipv6, squid generates
</I>&gt;<i> an error page instead of trying a connection via ipv4.
</I>&gt;<i> 
</I>&gt;<i> One example is the url:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://ssl.ratsinfo-online.net/pirna-ri/logon.asp">https://ssl.ratsinfo-online.net/pirna-ri/logon.asp</A>
</I>&gt;<i> 
</I>&gt;<i> where squid tries to reach the webside via the ip 
</I>&gt;<i> 2001:8d8:87c:5f00::6e:72d6, but without success, because it isn't 
</I>&gt;<i> reachable.
</I>&gt;<i> 
</I>&gt;<i> Now I want, that squid does a fallback to ipv4 after
</I>&gt;<i> connect_timeout, but squid returns an error page (ERR_CONNECT_FAIL)
</I>&gt;<i> to the client.
</I>&gt;<i> 
</I>
Squid rarely sees <A HREF="https://">https://</A> URLs like that. Check if it is being given
the server name in a way that it can lookup all IPs, or just the one
IP address.

It also depends on how long the connection attempt(s) take.
 If it takes longer to lookup the DNS (dns_timeout) and try that one
IP (connect_timeout * connect_retries) than the entire transaction is
permitted to use (forward_timeout), then there is of course no time to
try anything else.

Note also that the message in the ERR_CONNECT_FAIL page is the result
of the final attempt made. Squid may have made several connection
attempts to other IP which also failed.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUiHZOAAoJELJo5wb/XPRj1TYH/Aid+TxcHzQNK4Q1Lw12Bwl6
QUx0vlpBKfmvzAq+9ucvavWePBSkKkLqmjsSasqqDebi26PuKvoTaJB02lZUdbKe
tDFlL9+1QWLfUCyqJDhZuUsnbD/rjVolvpk+Zu1RD6PvK2TSRG0YcaM68mefw7Wn
LFj4aKpo+pUaRJhdZHu3cKmG3SMREhq6z5rgHASyxnQhGUWugSg5NjCnHGzB0Qt1
5U79b3nmRO9bZ2st15iJG3B000v01NLojthSDZaTjYNR9LJ0eNIqVwa4ppEf399q
j/H6JyC5hNFXpX4LOtuGTY7sptAXCK4ItNJcAupV6TOkCJsesaQqk5SreOlxA/M=
=n1dE
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001057.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
	<LI>Next message (by thread): <A HREF="001157.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1063">[ date ]</a>
              <a href="thread.html#1063">[ thread ]</a>
              <a href="subject.html#1063">[ subject ]</a>
              <a href="author.html#1063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
