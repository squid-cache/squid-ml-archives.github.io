<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Skype bypass using ssl_bump peek
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Skype%20bypass%20using%20ssl_bump%20peek&In-Reply-To=%3C54917362.5080202%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001133.html">
   <LINK REL="Next"  HREF="001134.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Skype bypass using ssl_bump peek</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Skype%20bypass%20using%20ssl_bump%20peek&In-Reply-To=%3C54917362.5080202%40treenet.co.nz%3E"
       TITLE="[squid-users] Skype bypass using ssl_bump peek">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Dec 17 12:13:22 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001133.html">[squid-users] Skype bypass using ssl_bump peek
</A></li>
        <LI>Next message (by thread): <A HREF="001134.html">[squid-users] Skype bypass using ssl_bump peek
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1135">[ date ]</a>
              <a href="thread.html#1135">[ thread ]</a>
              <a href="subject.html#1135">[ subject ]</a>
              <a href="author.html#1135">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 17/12/2014 10:52 p.m., Yu-Hsuan Liao wrote:
&gt;&gt;<i> Only if &quot;skype_list&quot; matches the TCP packet IP address (without 
</I>&gt;&gt;<i> rDNS being looked up) will the peek happen.
</I>&gt;<i> 
</I>&gt;&gt;<i> I think you need to add at_step ACL test to peek always at
</I>&gt;&gt;<i> step1, then do the other actions at step2 once SNI (domain name)
</I>&gt;&gt;<i> is possibly available.
</I>&gt;<i> 
</I>&gt;<i> Hello Amos,
</I>&gt;<i> 
</I>&gt;<i> What if a non-SSL over 443 or a non-HTTP over SSL connections?
</I>
The peek at step1 should be detecting that non-TLS/SSL is occuring.

For the non-HTTP over TLS/SSL... IF you bumped it Squid can still
fallback to tunnel I think, but a slower way than splice normally
would. A few people are indicating problems or weirdness with how
serverHello is handled so YMMV.


NP: this is all brand new complicated functionality and I'm not the
author/designer. So reality may differ a bit from what I understand of
it all.


&gt;<i> Skype voice connection seems an non standard SSL 
</I>&gt;<i> negotiation(Partial Handshake), is it possible revert to tunnel 
</I>&gt;<i> mode at steps to bypass connection?
</I>&gt;<i> 
</I>
As long as you are able to determine whether to do splice and Squid
has not yet auto-generated anything that got sent out, then you should
be able to.
 If Squid has sent anything over the wire that was generated by Squid
(bumping) the only choices left are continue with bump or reject/abort.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUkXNaAAoJELJo5wb/XPRj2awH/2o+zdYmKSht6T+4NnlexI4y
fKEY+9v1jP8+ugFzcpuEu9AeOLN8JZZf1lC+uVBeRDyZD7XGRiY4DuAW4dJle9Mk
ythFOp1WIU4JWa9+FjQv4fpR3ua1t5JljVfyHZRxXBOMZTYs9E9cMdE4wsCW5TBa
7P8dGpfHXKFDyJNhtJEZO2rG8w4cUiVn9L33ZBkYcysTeAQdZdc70jRdpJndLOiA
yeR8C7FGMtDyQ207QXIimrVhhas8gRWFn2bhG9i5JbCYzpS4TLb3XHQm1KUR+Kvn
V0aXkS576MuoJOb46LnQEznm7cL8AJeri7GYGo2FxwH2MWeGTmYoPEeIZ+jkikE=
=sRS7
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001133.html">[squid-users] Skype bypass using ssl_bump peek
</A></li>
	<LI>Next message (by thread): <A HREF="001134.html">[squid-users] Skype bypass using ssl_bump peek
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1135">[ date ]</a>
              <a href="thread.html#1135">[ thread ]</a>
              <a href="subject.html#1135">[ subject ]</a>
              <a href="author.html#1135">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
