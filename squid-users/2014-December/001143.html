<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Debian 7 LDAP auth to 2008r2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debian%207%20LDAP%20auth%20to%202008r2&In-Reply-To=%3C549297F8.1030600%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001140.html">
   <LINK REL="Next"  HREF="001141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Debian 7 LDAP auth to 2008r2</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debian%207%20LDAP%20auth%20to%202008r2&In-Reply-To=%3C549297F8.1030600%40treenet.co.nz%3E"
       TITLE="[squid-users] Debian 7 LDAP auth to 2008r2">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Dec 18 09:01:44 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001140.html">[squid-users] Debian 7 LDAP auth to 2008r2
</A></li>
        <LI>Next message (by thread): <A HREF="001141.html">[squid-users] SQUID_ERR_SSL_HANDSHAKE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1143">[ date ]</a>
              <a href="thread.html#1143">[ thread ]</a>
              <a href="subject.html#1143">[ subject ]</a>
              <a href="author.html#1143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 18/12/2014 11:28 a.m., Bert wrote:
&gt;<i> Man I just can't seem to make this work. I followed this guide:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://wiki.bitbinary.com/index.php/Active_Directory_Integrated_Squid_Proxy">http://wiki.bitbinary.com/index.php/Active_Directory_Integrated_Squid_Proxy</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>and everything went well but as soon as I get to the
&gt;<i> squid_ldap_group test I get nothing back, or the second time I hit 
</I>&gt;<i> enter it returns a &quot;invalid entry&quot; error.
</I>&gt;<i> 
</I>&gt;<i> /usr/lib/squid3/squid_ldap_group -R -K -S -b &quot;dc=example,dc=local&quot;
</I>&gt;<i> -D <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at example.local</A> -W /etc/squid3/ldappass.txt -f 
</I>&gt;<i> &quot;(&amp;(objectclass=person)(sAMAccountName=%v)(memberof=cn=%g,ou=Security
</I>&gt;<i>
</I>&gt;<i> 
</I>Groups,ou=MyBusiness,dc=example,dc=local))&quot; -h dc1.example.local
&gt;<i> EXAMPLE\Username Internet%20Users%20Standard
</I>&gt;<i> 
</I>&gt;<i> Can anyone tell me what to look for as far as testing? I have run 
</I>&gt;<i> this test with debug -d but that doesn't seem to return anything.
</I>&gt;<i> My understanding of the command above is it's taking the basedn and
</I>&gt;<i> a user name that I have setup and created a password for and
</I>&gt;<i> attempting to query the AD server that is listed after the -h
</I>&gt;<i> option. The part of the line I don't understand is cn=%g. No idea
</I>&gt;<i> what might be plugged in there as &quot;g&quot; is not initialized anywhere.
</I>
%g is the group name being looked up.

acl .. external groupName1 groupName2 ...

&gt;<i> Based on the options returned after squid_ldap_group I think I get
</I>&gt;<i> what's going on and the last two entries on the line are the
</I>&gt;<i> queried username against the security groups I created in AD and
</I>&gt;<i> the user I have been testing is a member of the internet users
</I>&gt;<i> group. This seems pretty straight forward but I get nothing and so
</I>&gt;<i> this query is basically the same in the squid.conf so if it doesn't
</I>&gt;<i> work here it's obviously not going to work from a browser.
</I>&gt;<i> 
</I>
The tutorial is a bit broken.

Firstly, it does not explain the &quot;bug&quot; causing group names to have to
be in files loaded by Squid external ACL is that the squid.conf parser
uses whitespace as reserved characters delimiting words.
The normal ACL syntax is:
  acl foo external memberof Group1Name Group2Name ...

It then recommends that -f parameter which contains whitespace
directly in squid.conf...


You need to replace &quot;Security Groups&quot; with &quot;Security\ Groups&quot; and if
that does not work by itself upgrade to a current Squid version.
Squid-3.4 or later should accept \-escapes in quoted strings.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUkpf3AAoJELJo5wb/XPRjLHAH/RhYmHXjlZFPPGzd02VpILIE
aVTacnsnauzQeLIUNH+EWjU5wCDN9byPE7kjC/h7yo3f1cirV2UIR7vw7s12SkVH
BWBNzdhNGe5uQsJ6al33USYKUeuVxdVhMJs6orJAQWzxgRK8xqktJFcDSivv+opN
5HmKXqBK4S1sXtGDzybu6lJzRC/ycZMAuDjT2Mbs5pF/Pw5eQd0KW9A5RE9DQT6q
HkCQl9B7HDhiYs0hMVVc7ayjcg//r+BVqI1Y5uEl+/AaUqkYjlQqiQG/Y+Ls2HrX
YIq2n6fzvrzSpE0drac7iyIM6RyGQ4Fh7LkCS8ae9mBNFI4nAZXYnldseReKVJA=
=e4Co
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001140.html">[squid-users] Debian 7 LDAP auth to 2008r2
</A></li>
	<LI>Next message (by thread): <A HREF="001141.html">[squid-users] SQUID_ERR_SSL_HANDSHAKE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1143">[ date ]</a>
              <a href="thread.html#1143">[ thread ]</a>
              <a href="subject.html#1143">[ subject ]</a>
              <a href="author.html#1143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
