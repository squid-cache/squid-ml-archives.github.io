<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.4.10 incorrectly configured on Solaris 10
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.10%20incorrectly%20configured%20on%20Solaris%2010&In-Reply-To=%3C5492DE30.5060209%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001142.html">
   <LINK REL="Next"  HREF="001145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.4.10 incorrectly configured on Solaris 10</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.10%20incorrectly%20configured%20on%20Solaris%2010&In-Reply-To=%3C5492DE30.5060209%40gmail.com%3E"
       TITLE="[squid-users] Squid 3.4.10 incorrectly configured on Solaris 10">yvoinov at gmail.com
       </A><BR>
    <I>Thu Dec 18 14:01:20 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001142.html">[squid-users] SQUID_ERR_SSL_HANDSHAKE
</A></li>
        <LI>Next message (by thread): <A HREF="001145.html">[squid-users] Squid 3.4.10 incorrectly configured on Solaris 10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1144">[ date ]</a>
              <a href="thread.html#1144">[ thread ]</a>
              <a href="subject.html#1144">[ subject ]</a>
              <a href="author.html#1144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
Hi there,

yesterday (and during last four day) I've try to build transparent
caching proxy on Solaris 10 (x86_64) testing environment.

Configuration options are:

# Without SSL 64 bit GCC
./configure '--prefix=/usr/local/squid' '--enable-translation'
'--enable-external-acl-helpers=file_userip,unix_group'
'--enable-icap-client' '--enable-ipf-transparent'
'--enable-storeio=diskd' '--enable-removal-policies=lru,heap'
'--enable-devpoll' '--disable-wccp' '--enable-wccpv2'
'--enable-http-violations' '--enable-follow-x-forwarded-for'
'--enable-arp-acl' '--enable-htcp' '--enable-cache-digests' '--with-dl'
'--enable-auth-negotiate=none' '--disable-auth-digest'
'--disable-auth-ntlm' '--disable-auth-basic'
'--enable-storeid-rewrite-helpers=file'
'--enable-log-daemon-helpers=file' '--with-filedescriptors=131072'
'--with-build-environment=POSIX_V6_LP64_OFF64' 'CFLAGS=-O3 -m64 -fPIE
-fstack-protector -mtune=core2 --param=ssp-buffer-size=4 -pipe'
'CXXFLAGS=-O3 -m64 -fPIE -fstack-protector -mtune=core2
--param=ssp-buffer-size=4 -pipe' 'CPPFLAGS=-I/usr/include
-I/opt/csw/include' 'LDFLAGS=-fPIE -pie -Wl,-z,now'

But binaries built without interceptor support.

Some investigation:

Config.log has errors with ip_nat.h compilation:

configure:27435: checking for netinet/ip_nat.h
configure:27435: g++ -c -m64 -O3 -m64 -fPIE -fstack-protector
-mtune=core2 --param=ssp-buffer-size=4 -pipe -march=native -std=c++11
-I/usr/include -I/opt/csw/include -I/usr/include/gssapi
-I/usr/include/kerberosv5 conftest.cpp &gt;&amp;5
In file included from conftest.cpp:266:0:
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:98:2:
error: 'ipfmutex_t' does not name a type
  ipfmutex_t nat_lock;
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:108:2:
error: 'frentry_t' does not name a type
  frentry_t *nat_fr; /* filter rule ptr if appropriate */
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:112:2:
error: 'ipftqent_t' does not name a type
  ipftqent_t nat_tqe;
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:113:2:
error: 'u_32_t' does not name a type
  u_32_t  nat_flags;
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:114:2:
error: 'u_32_t' does not name a type
  u_32_t  nat_sumd[2]; /* ip checksum delta for data segment */
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:115:2:
error: 'u_32_t' does not name a type
  u_32_t  nat_ipsumd; /* ip checksum delta for ip header */
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:116:2:
error: 'u_32_t' does not name a type
  u_32_t  nat_mssclamp; /* if != zero clamp MSS to this */
  ^
/opt/csw/lib/gcc/i386-pc-solaris2.10/4.9.2/include-fixed/netinet/ip_nat.h:117:2:
error: 'i6addr_t' does not name a type
  i6addr_t nat_inip6;

and so, configure does not see IP Filter finally, ergo cannot build
interceptor.

Yes, IP Filter installed in system. Yes, I've try to build 32 bit also.
Yes, I've try to build on another system. Yes, I've try to play with
configure option. Yes, I've try also development version 3.5.x - with
the same result.

Amos, need your help.

Thanks in advance,

WBR, Yuri

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBAgAGBQJUkt4vAAoJENNXIZxhPexGn9EH/3CUqof3f4xHNBuZIhC35Zup
EgTYQGwUck0hq98GP+USC7C186qW3pscafTO82olbb55xb7Bpmw6b0YVgsVK9AJy
u2IFnc6MQe1rhYl8NM5L9B5XC6K5gKb8P4UQYAirYPvu0XDxWJYd0N8HqL+8uI6+
3OtvrGnQZyCOHTuQ8Ubu2y3yDpjdUhjX7sCRER8QiLR/IMTyXAu2pmIpMISLTMK+
wmI1xVfrafpg5TO+RzkwQFbWQhNUq1JqY6kttHb9D/Qg5eTw2ceFLYsrkTiuwpYv
czjRk2J4F7WYmbFJ0sTwRqyAZtM8xC8b9dk4SjkqOEpgIE/wdnqCJp/yQbfo/kk=
=LWVp
-----END PGP SIGNATURE-----



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001142.html">[squid-users] SQUID_ERR_SSL_HANDSHAKE
</A></li>
	<LI>Next message (by thread): <A HREF="001145.html">[squid-users] Squid 3.4.10 incorrectly configured on Solaris 10
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1144">[ date ]</a>
              <a href="thread.html#1144">[ thread ]</a>
              <a href="subject.html#1144">[ subject ]</a>
              <a href="author.html#1144">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
