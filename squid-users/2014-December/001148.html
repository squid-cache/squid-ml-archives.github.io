<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Unable to configure cache_dir with only TCP_MISS/200
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20configure%20cache_dir%20with%20only%20TCP_MISS/200&In-Reply-To=%3C54932D12.6020802%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001198.html">
   <LINK REL="Next"  HREF="001152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Unable to configure cache_dir with only TCP_MISS/200</H1>
    <B>Red</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20configure%20cache_dir%20with%20only%20TCP_MISS/200&In-Reply-To=%3C54932D12.6020802%40gmail.com%3E"
       TITLE="[squid-users] Unable to configure cache_dir with only TCP_MISS/200">redhoodny at gmail.com
       </A><BR>
    <I>Thu Dec 18 19:37:54 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001198.html">[squid-users] Error negotiating SSL connection
</A></li>
        <LI>Next message (by thread): <A HREF="001152.html">[squid-users] Unable to configure cache_dir with only	TCP_MISS/200
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1148">[ date ]</a>
              <a href="thread.html#1148">[ thread ]</a>
              <a href="subject.html#1148">[ subject ]</a>
              <a href="author.html#1148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Using squid 3.3.8 on Ubuntu 14.04.
Copied default configuration file for version from
<A HREF="http://wiki.squid-cache.org/Squid-3.3,">http://wiki.squid-cache.org/Squid-3.3,</A> modified refresh pattern and acl to:

refresh_pattern .               1440       20%     4320
acl localnet src 129.236.0.0/16 

start squid, execute squidclient <A HREF="http://wiki.squid-cache.org/">http://wiki.squid-cache.org/</A> twice, get expected responses:
1418930476.244    565 127.0.0.1 TCP_MISS/200 16286 GET <A HREF="http://wiki.squid-cache.org/">http://wiki.squid-cache.org/</A> - HIER_DIRECT/77.93.254.178 text/html
1418930486.000      0 127.0.0.1 TCP_MEM_HIT/200 16293 GET <A HREF="http://wiki.squid-cache.org/">http://wiki.squid-cache.org/</A> - HIER_NONE/- text/html

Tried to enable cache_dir, add line to config: 
cache_dir ufs /var/spool/squid3 100 16 256

Create  cache with sudo squid3 -z ; start squid, repeat above squidclient commands and get only TCP_MISS/200:

1418930731.778   5548 127.0.0.1 TCP_MISS/200 16286 GET <A HREF="http://wiki.squid-cache.org/">http://wiki.squid-cache.org/</A> - HIER_DIRECT/77.93.254.178 text/html
1418930738.044    774 127.0.0.1 TCP_MISS/200 16286 GET <A HREF="http://wiki.squid-cache.org/">http://wiki.squid-cache.org/</A> - HIER_DIRECT/77.93.254.178 text/html

Check cache dirs to see if any file has been create, and one is there:
$ sudo find /var/spool/squid3/ -type f -exec ls -l {} \;
-rw-r----- 1 proxy proxy 288 Dec 18 14:25 /var/spool/squid3/swap.state
-rw-r----- 1 proxy proxy 16393 Dec 18 14:25 /var/spool/squid3/00/00/00000001

Note: I have tried other pages which for sure do not have do not cache instructions with same result.

I have tried this on three different ubuntu machines, no luck.  BTW, more complex squid config we have with 3.1.19 on ubuntu 12 works fine.  Can not upgrade for now.
Any help is appreciated.


Bob
 



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001198.html">[squid-users] Error negotiating SSL connection
</A></li>
	<LI>Next message (by thread): <A HREF="001152.html">[squid-users] Unable to configure cache_dir with only	TCP_MISS/200
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1148">[ date ]</a>
              <a href="thread.html#1148">[ thread ]</a>
              <a href="subject.html#1148">[ subject ]</a>
              <a href="author.html#1148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
