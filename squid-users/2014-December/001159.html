<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20do%20a%20fallback%20from%20ipv6%20to%20ipv4%2C%0A%20if%20the%20ipv6%20connect%20fails&In-Reply-To=%3C54942A20.7040209%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001157.html">
   <LINK REL="Next"  HREF="001173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20do%20a%20fallback%20from%20ipv6%20to%20ipv4%2C%0A%20if%20the%20ipv6%20connect%20fails&In-Reply-To=%3C54942A20.7040209%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Dec 19 13:37:36 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001157.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
        <LI>Next message (by thread): <A HREF="001173.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1159">[ date ]</a>
              <a href="thread.html#1159">[ thread ]</a>
              <a href="subject.html#1159">[ subject ]</a>
              <a href="author.html#1159">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 20/12/2014 2:08 a.m., Dieter Bloms wrote:
&gt;<i> 
</I>&gt;<i> When I do a <A HREF="http://ssl.ratsinfo-online.net/">http://ssl.ratsinfo-online.net/</A> the fallback from ipv6
</I>&gt;<i> to ipv4 works fine, but when I do a
</I>&gt;<i> <A HREF="https://ssl.ratsinfo-online.net/">https://ssl.ratsinfo-online.net/</A> squid tries ipv6 only and doesn't
</I>&gt;<i> do a fallback to ipv4.
</I>&gt;<i> 
</I>&gt;<i> I would be nice, if you can try it on your dial stack setup.
</I>&gt;<i> 
</I>&gt;<i> Thank you.
</I>&gt;<i> 
</I>
It takes me 10-20 sec to receive any response on the very first DNS
lookup for that domain. After which all responses are quite fast for a
few minutes. Then repeat with the slow lookup.

Like you say it responds with 1 IPv4 and 1 IPv6. Which is not too
many, and none actually failing to resolve. So DNS is reasonable even
with the occasional delay.

I am seeing approx 40-90% packet loss on several of the NTT.net
transit hops between me and the site in IPv4. Not sure if that is
related in any way related to your access path.

My current colo provider blocks network measurements from end-servers
(but only on v6) so I cant adequately test the v6 connectivity
anymore. But your log entry indicates that probably a TCP SYN
handshake did not finish over either IP version.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUlCofAAoJELJo5wb/XPRjtC8H/jza0kveI1sedrGVqAUleGxL
sD0V7gOy7sb6INFcIKKhl9VhTZf43m6zB4qcP/bJ9AtvjAJKc9D4FLNAaicvzTJr
e2IS+glEfg8bXC67DEbH1YpMo6R3iK73LX5T50+E+SqrYbsRv8xXqkEnU6J7d4dL
dFsYFbYFs7zqcOCSkqHFHuWmAKsi86zmmvuLgBxsmOGuHUPMR70J8MtFxSZTL3DJ
zCyDESIuw3L3P+fJw9A0SiKiXLCagj6Gv/XKWpOiBvwUhUSow0D+avsH37J1rAOC
ddZuzOOfNHbPCuQT41X7xN3AWfY42fvJmz3Ihr0sgzkBQph9IBSIqvx21cuxq8s=
=J0by
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001157.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
	<LI>Next message (by thread): <A HREF="001173.html">[squid-users] Squid doesn't do a fallback from ipv6 to ipv4, if the ipv6 connect fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1159">[ date ]</a>
              <a href="thread.html#1159">[ thread ]</a>
              <a href="subject.html#1159">[ subject ]</a>
              <a href="author.html#1159">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
