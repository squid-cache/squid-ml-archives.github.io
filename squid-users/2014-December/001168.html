<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] You MUST specify at least one Domain Controller.You can use either \ or / as separator between the domain name
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20You%20MUST%20specify%20at%20least%20one%20Domain%0A%20Controller.You%20can%20use%20either%20%5C%20or%20/%20as%20separator%20between%20the%20domain%20name&In-Reply-To=%3C5494360B.5000301%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001171.html">
   <LINK REL="Next"  HREF="001183.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] You MUST specify at least one Domain Controller.You can use either \ or / as separator between the domain name</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20You%20MUST%20specify%20at%20least%20one%20Domain%0A%20Controller.You%20can%20use%20either%20%5C%20or%20/%20as%20separator%20between%20the%20domain%20name&In-Reply-To=%3C5494360B.5000301%40treenet.co.nz%3E"
       TITLE="[squid-users] You MUST specify at least one Domain Controller.You can use either \ or / as separator between the domain name">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Dec 19 14:28:27 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001171.html">[squid-users] You MUST specify at least one Domain	Controller.You can use either \ or / as separator between the	domain name
</A></li>
        <LI>Next message (by thread): <A HREF="001183.html">[squid-users] squid with multiple ips is listenting to some ips	with port and not all of ips ??!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1168">[ date ]</a>
              <a href="thread.html#1168">[ thread ]</a>
              <a href="subject.html#1168">[ subject ]</a>
              <a href="author.html#1168">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 20/12/2014 12:50 p.m., Ahmed Allzaeem wrote:
&gt;<i> Thank  you Amos , don&#8217;t know wt to say , u helped me a lot !
</I>&gt;<i> 
</I>&gt;<i> Now it get user/pwd
</I>&gt;<i> 
</I>&gt;<i> But still a new issue appeared !!
</I>&gt;<i> 
</I>&gt;<i> Now the browsing is so slow !!
</I>&gt;<i> 
</I>&gt;<i> I check the logs of squid I found a lot of TCP_denied and some of
</I>&gt;<i> TCP_MISS
</I>&gt;<i> 
</I>
Thats DENIED/407. In particular sets of 5 requests.
 Four auth challenges (407) followed by one final/successful request
(non-407).

NTLM handshake normally works in threes. Two 407's then one non-407.

NOTE: The non-407 can appear much later in the log than the two 407's.
A very good example of this is the 5 &quot;POST <A HREF="http://ocsp.digicert.com/">http://ocsp.digicert.com/</A>&quot;
log lines. You can see the set of 407s occuring, then ~2 seconds later
the non-407 saying it took 1974 ms (~2 sec) to complete.


I suspect what you are seeing in that log is the mess that happens
when browsers (un)Happy Eyeballs algorithm collides with NTLM. The
browser opening connections in pairs to see which will be usable first
needs to authenticate both, but final request only sent on first
connection to complete the auth.
 *If* I am right about this then the slowdown should only happen on
startup when a lot of stuff has to be done by the browser and the
experience will get faster over time. The browser can technically save
the second-opened connections for later use, some do.


Also, ensure that persistent connections are enabled to both server
and clients. This will help minimize the number of handshakes
required. That is about all you can do to optimize NTLM unfortunately,
it is a truely nasty protocol.


Also, if you are seeing some clients looping with many 407 trying the
same credentials over and over try the setting:
 auth_param ntlm keepalive off

However, dont confuse this &quot;keepalive&quot; option with persistent
connections. It is a hack specially crafted to work with NTLM and
Negotiate auth to fix old IE brokenness and has proven useful with
some Java apps and recent Firefox versions. Its not harmful to any
client, but can limit the proxy total traffic capacity somewhat so
best to avoid if you dont need it.

HTH
Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUlDYLAAoJELJo5wb/XPRj558H/12+3ARMFEHINczwgrPjzFBx
3la3Vn+mBo8NOaxCgEcJP73F1ZHH58oTlBcUygj1h9ecj7/fikil6IXhDvV87W4s
esS+IIFbOekKKFXxfGiSa0hg4G3NEEepmPfAx8OT8UWLC68fkESOCeOP99LYY3q5
7xZ7bef1ieudgDAUI7zuTCb8tEsV47SRFRQESOJefcXz3YkXhtL5ouNaK56sfp03
iaP33AzkjC9HBVxcfp4h4rInMO3VVbSecKtrHdStmnty5pU7lkXvMgSDtP1Kf71z
5waoPr7+8sf2uyUx/c42/RFpLIH0gfjg++WcIAXfF9gzmALNwhImvtb8JnRfHHk=
=autN
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001171.html">[squid-users] You MUST specify at least one Domain	Controller.You can use either \ or / as separator between the	domain name
</A></li>
	<LI>Next message (by thread): <A HREF="001183.html">[squid-users] squid with multiple ips is listenting to some ips	with port and not all of ips ??!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1168">[ date ]</a>
              <a href="thread.html#1168">[ thread ]</a>
              <a href="subject.html#1168">[ subject ]</a>
              <a href="author.html#1168">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
