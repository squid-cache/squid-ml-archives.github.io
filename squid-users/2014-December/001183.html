<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid with multiple ips is listenting to some ips	with port and not all of ips ??!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20with%20multiple%20ips%20is%20listenting%20to%20some%20ips%0A%09with%20port%20and%20not%20all%20of%20ips%20%3F%3F%21%21&In-Reply-To=%3C000001d01c89%2458f08780%240ad19680%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001168.html">
   <LINK REL="Next"  HREF="001184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid with multiple ips is listenting to some ips	with port and not all of ips ??!!</H1>
    <B>Ahmed Allzaeem</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20with%20multiple%20ips%20is%20listenting%20to%20some%20ips%0A%09with%20port%20and%20not%20all%20of%20ips%20%3F%3F%21%21&In-Reply-To=%3C000001d01c89%2458f08780%240ad19680%24%40netstream.ps%3E"
       TITLE="[squid-users] squid with multiple ips is listenting to some ips	with port and not all of ips ??!!">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Sat Dec 20 19:15:40 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001168.html">[squid-users] You MUST specify at least one Domain Controller.You can use either \ or / as separator between the domain name
</A></li>
        <LI>Next message (by thread): <A HREF="001184.html">[squid-users] squid with multiple ips is listenting to some	ips	with port and not all of ips ??!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1183">[ date ]</a>
              <a href="thread.html#1183">[ thread ]</a>
              <a href="subject.html#1183">[ subject ]</a>
              <a href="author.html#1183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

 

Recently I have a squid with 256 ips installed on a proxy server.

 

The issue that we have is I added about 256 .

 

 

The ips are diversie in ranges and I can ping all of them from outside

 

 

Bur the problem is only with squid !!

 

Squid whrn it start .it only listen to sort of ips , not all of the ips.

 

I check that by the command :

Netstat -ant | grep LISTEN

 

I can see only some of ips

 

As can example , in squid.conf there is about 240 ips listening 

But the real that getting listenting is about 130 ips ??!!!

 

 

The port tanges of the ips is from 2400 tcp to 2460 

I mean , ip #  1 listen to port 2400

Ip # 2  listen to port 2401

And so on..

But im wondering why the proxy is not let the other ips up !!!

Why only 130 ips from 240 is up with ip:port and other is not working and
not connecting ??!!!

Im sure it not iptables and I checked by tcpdump , I can see that I can
reach the proxy , but the issue with ssquid that is not letting all ips in
the conf file to be up.

 

Also im sure all ips are pingable from outide !!!

 

Here is sampel of wy I have :

I made abbreviation of  long list of ips :

 

=====================================
[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# cat /etc/squid/squid.conf

# Recommended minimum configuration:

#

###########Authentication######

auth_param basic children 300

auth_param basic realm &quot;Put your pwd&quot;

auth_param basic program /lib/squid/basic_ncsa_auth   /etc/squid/squid_user

auth_param basic credentialsttl 2 hours

auth_param basic casesensitive off

###

acl classx proxy_auth REQUIRED

http_access allow classx

###

# Example rule allowing access from your local networks.

# Adapt to list your (internal) IP networks from where browsing

# should be allowed

acl localnet src 10.0.0.0/8     # RFC1918 possible internal network

acl localnet src 172.16.0.0/12  # RFC1918 possible internal network

acl localnet src 192.168.0.0/16 # RFC1918 possible internal network

acl localnet src fc00::/7       # RFC 4193 local private network range

acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
machines

acl localnet src xx0.0/16 xxx0.0/16

acl SSL_ports port 443

acl Safe_ports port 80          # http

acl Safe_ports port 21          # ftp

acl Safe_ports port 443         # https

acl Safe_ports port 70          # gopher

acl Safe_ports port 210         # wais

acl Safe_ports port 1025-65535  # unregistered ports

acl Safe_ports port 280         # http-mgmt

acl Safe_ports port 488         # gss-http

acl Safe_ports port 591         # filemaker

acl Safe_ports port 777         # multiling http

acl CONNECT method CONNECT

#

# Recommended minimum Access Permission configuration:

#

# Deny requests to certain unsafe ports

http_access deny !Safe_ports

 

# Deny CONNECT to other than secure SSL ports

http_access deny CONNECT !SSL_ports

 

# Only allow cachemgr access from localhost

http_access allow localhost manager

http_access deny manager

 

# We strongly recommend the following be uncommented to protect innocent

# web applications running on the proxy server who think the only

# one who can access services on &quot;localhost&quot; is a local user

#http_access deny to_localhost

 

#

# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS

#

####################################################################

# Example rule allowing access from your local networks.

# Adapt localnet in the ACL section to list your (internal) IP networks

# from where browsing should be allowed

http_access allow localnet

http_access allow localhost

############################################################

# And finally deny all other access to this proxy

http_access deny all

 

 

#http_port 2400

http_port xxxx:2401
.

.

.

.

.

 

http_port xxxx:2660

# Uncomment and adjust the following to add a disk cache directory.

#cache_dir ufs /var/cache/squid 100 16 256

 

# Leave coredumps in the first cache dir

coredump_dir /var/cache/squid

 

#

# Add any of your own refresh_pattern entries above these.

#

refresh_pattern ^ftp:           1440    20%     10080

refresh_pattern ^gopher:        1440    0%      1440

refresh_pattern -i (/cgi-bin/|\?) 0     0%      0

refresh_pattern .               0       20%     4320

###################################################

cache_effective_user squid

cache_effective_group squid

##############################

################################################

acl ip1 myip 5x.x.x.x

.

.

.

.

..

 

acl ip260 myip xxx

################################################

################################################

tcp_outgoing_address xxx ip1

.

.

.

.

.

.

tcp_outgoing_address xxx ip260

 

#####################################################

 

 

 

 

 

Version 3.4.3

configure options:  '--prefix=/usr' '--includedir=/include'
'--mandir=/share/man' '--infodir=/share/info' '--sysconfdir=/etc'
'--enable-cachemgr-hostname=drx' '--localstatedir=/var'
'--libexecdir=/lib/squid' '--disable-maintainer-mode'
'--disable-dependency-tracking' '--disable-silent-rules' '--srcdir=.'
'--datadir=/usr/share/squid' '--sysconfdir=/etc/squid'
'--mandir=/usr/share/man' '--enable-inline' '--enable-async-io=8'
'--enable-storeio=ufs,aufs,diskd,rock' '--enable-removal-policies=lru,heap'
'--enable-delay-pools' '--enable-cache-digests' '--enable-underscores'
'--enable-icap-client' '--enable-follow-x-forwarded-for' '--enable-auth'
'--enable-basic-auth-helpers=LDAP,MSNT,NCSA,PAM,SASL,SMB,YP,DB,POP3,getpwnam
,squid_radius_auth,multi-domain-NTLM' '--enable-ntlm-auth-helpers=smb_lm'
'--enable-digest-auth-helpers=ldap,password'
'--enable-negotiate-auth-helpers=squid_kerb_auth' '--enable-arp-acl'
'--enable-esi' '--disable-translation' '--with-logdir=/var/log/squid'
'--with-pidfile=/var/run/squid.pid' '--with-filedescriptors=131072'
'--with-large-files' '--with-default-user=squid' '--enable-linux-netfilter'
'CFLAGS=-g -O2 -g -Wall -O2' 'LDFLAGS=' 'CPPFLAGS=' 'CXXFLAGS=-g -O2 -g
-Wall -O2' '--enable-ltdl-convenience'

 

 

 

 

 

 

 

Any help ???

Could it be a kernel limitations ???

 

cheers

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20141220/0ca6cc1a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20141220/0ca6cc1a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001168.html">[squid-users] You MUST specify at least one Domain Controller.You can use either \ or / as separator between the domain name
</A></li>
	<LI>Next message (by thread): <A HREF="001184.html">[squid-users] squid with multiple ips is listenting to some	ips	with port and not all of ips ??!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1183">[ date ]</a>
              <a href="thread.html#1183">[ thread ]</a>
              <a href="subject.html#1183">[ subject ]</a>
              <a href="author.html#1183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
