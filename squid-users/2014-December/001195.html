<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Is squid2/3 ufs/diskd cache formats compatible?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Is%20squid2/3%20ufs/diskd%20cache%20formats%20compatible%3F&In-Reply-To=%3C54963BBC.8060100%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001192.html">
   <LINK REL="Next"  HREF="001201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Is squid2/3 ufs/diskd cache formats compatible?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Is%20squid2/3%20ufs/diskd%20cache%20formats%20compatible%3F&In-Reply-To=%3C54963BBC.8060100%40treenet.co.nz%3E"
       TITLE="[squid-users] Is squid2/3 ufs/diskd cache formats compatible?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Dec 21 03:17:16 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001192.html">[squid-users] Is squid2/3 ufs/diskd cache formats compatible?
</A></li>
        <LI>Next message (by thread): <A HREF="001201.html">[squid-users] [squid-announce] Squid 3.5.0.4 beta is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1195">[ date ]</a>
              <a href="thread.html#1195">[ thread ]</a>
              <a href="subject.html#1195">[ subject ]</a>
              <a href="author.html#1195">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 21/12/2014 9:40 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> Hi gents,
</I>&gt;<i> 
</I>&gt;<i> does enybody tell me, please,
</I>&gt;<i> 
</I>&gt;<i> is squid2 and squid3 compatible or not by cache formats?
</I>
Yes and no.

UFS/diskd/AUFS:
 The Squid-3 swap.state format includes a few extra checksum details
and better 32-bit 64-bit protection. There is enough compatibility
that Squid will detect which format the objects on disk are and
upgrade the mautomatically. Unfortunately this also means each current
item in your cache will likely need a network refresh when its first
used after the update. And the cache will not be compatible with
Squid-2 once its been touched by Squid-3.

For larger caches (10's of GB or more ) the best thing to do is just
erase and start clean as the DIRTY scan can take hours. Squid will
begin with slow-ish service times for some minutes but things will
improve exponentially as the cache fills up.

For smallish (few GB or less) you can erase the old cache_dir's
swap.state and let Squid do a full disk-based (&quot;DIRTY&quot;) rebuild. If
you can do that before putting traffic through it even better.


COSS / Rock:
 COSS has been replaced by Rock in Squid-3. But the two are not binary
compatible. So an empty Rock cache is required.

If you really are desperate to preserve the data (**) you can run
Squid-2 for a few weeks with the COSS cache set to read-only and a
temporary UFS cache that can store the objects currently in COSS.
Eventually the COSS cache contents will be useless and the UFS will
contain all the useful ones. Then reserve the process after moving to
Squid-3 with Rock.


** Key thing to remember is that a cache is just a cache. *Short* term
storage for objects which are served and constantly being updated
elsewhere within the network. The data in it is always subject to erasure.


Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUlju7AAoJELJo5wb/XPRjvMMIAIsma0rw9Zp9WV/loLqDKo6Q
RUoomsqMSv6aJmVQh6swn/vWlM1JFuWdDsXQKMMlnWYvebWI4llU+zErLWu/gWMx
YsG+iZaTvvl2TJutZdmRhcw/TwVGf+YoEyBNe8NowHzTbQy0TYj+5k1vK/yWl4YB
4ccQmD548F1syj8UmFhyIp9g2jzDhb3Alg8xy7VnP3ix662KSU1R5olelK34fYdJ
UMwzBxOjyOSrK9xcoKejBrdSYyLseTtjJ1EreJBYbUT5DxlilmSnzkHpwQech0uM
IvIr6h1uhXe5Rq1ASjO+VsP6GCVDqo4bTGqYi+LU0F1cy9yRHXTeEG/Y5KpLVZE=
=Upc+
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001192.html">[squid-users] Is squid2/3 ufs/diskd cache formats compatible?
</A></li>
	<LI>Next message (by thread): <A HREF="001201.html">[squid-users] [squid-announce] Squid 3.5.0.4 beta is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1195">[ date ]</a>
              <a href="thread.html#1195">[ thread ]</a>
              <a href="subject.html#1195">[ subject ]</a>
              <a href="author.html#1195">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
