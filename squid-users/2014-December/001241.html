<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.4.10 cachemgr.cgi permission denied
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.10%20cachemgr.cgi%20permission%20denied&In-Reply-To=%3C549E02F1.7020907%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001240.html">
   <LINK REL="Next"  HREF="001243.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.4.10 cachemgr.cgi permission denied</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.10%20cachemgr.cgi%20permission%20denied&In-Reply-To=%3C549E02F1.7020907%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 3.4.10 cachemgr.cgi permission denied">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Dec 27 00:53:05 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001240.html">[squid-users] Squid 3.4.10 cachemgr.cgi permission denied
</A></li>
        <LI>Next message (by thread): <A HREF="001243.html">[squid-users] Squid 3.4.10 cachemgr.cgi permission denied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1241">[ date ]</a>
              <a href="thread.html#1241">[ thread ]</a>
              <a href="subject.html#1241">[ subject ]</a>
              <a href="author.html#1241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 27/12/2014 10:33 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> Hi, gents.
</I>&gt;<i> 
</I>&gt;<i> Now I have another problem. Cachemgr.cgi with password does not
</I>&gt;<i> access to Squid when password specified.
</I>&gt;<i> 
</I>&gt;<i> Look at squid.conf frag (this configuration ffragments derived
</I>&gt;<i> from working Squid2 installation):
</I>&gt;<i> 
</I>&gt;<i> # Only allow cachemgr access from localhost http_access allow
</I>&gt;<i> localhost manager http_access deny manager
</I>&gt;<i> 
</I>&gt;<i> # Cache manager cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>
</I>&gt;<i> 
</I>&gt;<i> # Cache manager password cachemgr_passwd secret all
</I>&gt;<i> 
</I>&gt;<i> and when I login through local Apache - I've got Squid access
</I>&gt;<i> denied page and message in cache.log:
</I>&gt;<i> 
</I>&gt;<i> 2014/12/24 17:44:17 kid1| CacheManager:
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">unknown at local</A>=127.0.0.1:3127 remote=127.0.0.1:35146 FD 40 flags=1:
</I>&gt;<i> password needed for 'menu'
</I>&gt;<i> 
</I>&gt;<i> Also, Munin plugins cannot work too - they use authenticated
</I>&gt;<i> cachemgr login.
</I>&gt;<i> 
</I>&gt;<i> AFAIK, this means unknown user.
</I>&gt;<i> 
</I>&gt;<i> Ok,
</I>&gt;<i> 
</I>&gt;<i> now - what username I must use in cachemgr login form?
</I>
You should get the administrators to use their normal username and the
mgr password. The cachemgr itself only checks the password matches the
one in squid.conf for that manager action. Username is used if some
other security checks are in place such as proxy_auth ACLs, and for
logging.

The cachemgr now has three methods of access. Direct <A HREF="http://">http://</A> and
<A HREF="https://">https://</A> URLs from the browser to Squid, and the old cache_<A HREF="object://">object://</A>
URLs sent by cachemgr and existing tools (Munin?). Though HTTPS only
works properly in reverse-proxy at the moment and it is all a bit
picky about the URL matching Squids public domain name (visible_hostname).

All of those methods can have user:password in a Basic www-auth header
(not proxy-auth), or the @password tacked on the end of the URL. Squid
should be generating a 401 auth challenge to get that Basic header,
not a full 403 Forbidden access denied.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUngLxAAoJELJo5wb/XPRjpUQIAId3lEcO8aIxMeP3wuW2//fg
2z4klihTpTcSD1ZxMrLMfDyS0JAAaZr967MQc9+txPThwZ9GL13uFiBhrfbvJmoT
7MS35K5aLHTP0CpbbxYwIv9Frah7GtFGiyslV8+m0l67428JIgDYIxm9wOcW5LLL
LiyK8taI4bBa5SmALD7gM1kP2hUERCRqq8rxelz/fVHN4eqjFSie2ELZu090R/Fc
riQut3W4r6LT30S3vS2+koFFce+cYNFyCYMn1NxAtOmnejkIAh/SkHFphNLT1/wy
6yh6iRMl43pi84/UzQK4Jq5ZGjbRcsgGSxMO31W4PEgCMD9U2R8Uw+qyRA82pnU=
=UgC2
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001240.html">[squid-users] Squid 3.4.10 cachemgr.cgi permission denied
</A></li>
	<LI>Next message (by thread): <A HREF="001243.html">[squid-users] Squid 3.4.10 cachemgr.cgi permission denied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1241">[ date ]</a>
              <a href="thread.html#1241">[ thread ]</a>
              <a href="subject.html#1241">[ subject ]</a>
              <a href="author.html#1241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
