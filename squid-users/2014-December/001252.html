<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] https bug slow browsing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20bug%20slow%20browsing&In-Reply-To=%3C54A0DC92.6040404%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001249.html">
   <LINK REL="Next"  HREF="001253.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] https bug slow browsing</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20bug%20slow%20browsing&In-Reply-To=%3C54A0DC92.6040404%40treenet.co.nz%3E"
       TITLE="[squid-users] https bug slow browsing">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Dec 29 04:46:10 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001249.html">[squid-users] https bug slow browsing
</A></li>
        <LI>Next message (by thread): <A HREF="001253.html">[squid-users] https bug slow browsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 29/12/2014 11:46 a.m., HackXBack wrote:
&gt;<i> you're explain is complicated for me and sorry for that but i want
</I>&gt;<i>  to understand more if that not bother you. at first lets talk
</I>&gt;<i> about cache_dir what you are telling me is to do rock and aufs for
</I>&gt;<i> each HDD what you mean is like this : cache_dir rock /cache01/rk
</I>&gt;<i> 50000 120 256 max-size=31744 cache_dir aufs/cache01/au 400000 961
</I>&gt;<i> 256 min-size=31745
</I>&gt;<i> 
</I>&gt;<i> for each HDD but in this way i will consume only 450 GB from 
</I>&gt;<i> 3TerraByte and this is not enough for me and will be full very fast
</I>&gt;<i> especially for caching videos and large files and this is a problem
</I>&gt;<i> while i cant add more rams for this hardware, so what is the
</I>&gt;<i> solution for this ?
</I>
It is a starting point. The size parameter on the AUFS cache_dir can
be increased as needed later with only a &quot;squid -k reconfigure&quot; and no
data loss. Just set the L1/L2 cache parameters suitable for a large
cache size, they cannot be changed easily.
NP: I also notice your L1 parameter is 961 ... both numbers need to
be even (multiples of 2, or better powers of 2).


15 TB cache (5x 3TB) may be too much and never filled if our traffic
is mostly small objects. Only if your users request a lot of video
will it be used.

If you are expecting a large number of under-32KB objects you can
double the rock cache to 100GB. But it gets slow to manage the Rock DB
if it gets too big (rock is a singe database file containing DB
records/slots with an object in each).

The key problem(s) currently is that you have/had too many cache_dir
on each HDD. The memory required to handle them is bigger than the
machine contains and they are competing for disk I/O bandwidth. Both
of which slow Squid down - sometimes a lot.




&gt;<i> 
</I>&gt;<i> also you said that is for only http objects , so what about caching
</I>&gt;<i> https files like youtube videos ? why i cant take these traffic
</I>&gt;<i> also ?
</I>
HTTPS is HTTP. Just using a TLS transport instead of TCP transport.
When it comes to caching there is no difference.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUoNySAAoJELJo5wb/XPRjxIYH/Rc8yzu4tZ1MKwg5dfJYWINl
GKeIESk1bZWGBqRYWGHjRihy4NlwYqWB9qD0TYdskbGW0VgpcRH97OBmroSD6BZn
EPVGwLhINpqJo7PEb9TIg7FIXCoI8ADH5rKUmq/5/SCoSuF4cOIq9tFZuQaBOjT0
PH2OYFuVd+uJ3AA5uWtulzBDMAPyDW5V7RraZYokBPws+kRoIE0r60oqGbFUuwLo
VXd+d97E1HRL4uPsaLbZuVG/VenbGzm1/ppn2zn5pSm5/cmqFYJWjg5686Qcp+1x
wY/xxMyxrAO4FNcMtB8VVSd+EnLGFbHvc6dc3F3bOK+EUNZJCc/TPoVY7DhwcJw=
=zzIG
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001249.html">[squid-users] https bug slow browsing
</A></li>
	<LI>Next message (by thread): <A HREF="001253.html">[squid-users] https bug slow browsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
