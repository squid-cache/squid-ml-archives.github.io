<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3 SSL bump: Google drive application could not	connect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%09connect&In-Reply-To=%3C54A30160.1000809%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001272.html">
   <LINK REL="Next"  HREF="001275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3 SSL bump: Google drive application could not	connect</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%09connect&In-Reply-To=%3C54A30160.1000809%40gmail.com%3E"
       TITLE="[squid-users] Squid 3 SSL bump: Google drive application could not	connect">yvoinov at gmail.com
       </A><BR>
    <I>Tue Dec 30 19:47:44 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001272.html">[squid-users] Squid 3 SSL bump: Google drive application could not	connect
</A></li>
        <LI>Next message (by thread): <A HREF="001275.html">[squid-users] Squid 3 SSL bump: Google drive application could not	connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1274">[ date ]</a>
              <a href="thread.html#1274">[ thread ]</a>
              <a href="subject.html#1274">[ subject ]</a>
              <a href="author.html#1274">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
Already found this lonely right post ;) I have Google-Fu too :) And it
longer than you :)

Anyway,

all of these issues solved.

I have snoop (not Windoze wireshark - all great things makes in console,
ya!) and take a look on single client traffic during bumping.

As I haven't iptables (no penguins, please!), but I have Cisco 2911, I
pass some Windows Update, Symantec Update (which is not work too)
bypassing Squid.

Cisco is greatest. All others are probably suxx :)

The complete solution looks like:

access-list 121 remark ACL for HTTPS WCCP
access-list 121 remark Squid proxies bypass
access-list 121 deny   ip host 192.168.200.3 any
access-list 121 remark WU bypass
access-list 121 deny tcp any 191.232.0.0 0.7.255.255
access-list 121 deny tcp any 65.52.0.0 0.3.255.255
access-list 121 remark Symantec bypass
access-list 121 deny tcp any host 195.215.221.99
access-list 121 deny tcp any host 195.215.221.104
access-list 121 deny tcp any host 213.248.114.172
access-list 121 deny tcp any host 213.248.114.173
access-list 121 deny tcp any host 213.248.114.174
access-list 121 deny tcp any host 213.248.114.175
access-list 121 deny tcp any host 77.67.22.168
access-list 121 deny tcp any host 77.67.22.171
access-list 121 deny tcp any host 77.67.22.173
access-list 121 deny tcp any host 213.248.114.171
access-list 121 remark LAN clients proxy port 443
access-list 121 permit tcp 192.168.0.0 0.0.255.255 any eq 443
access-list 121 remark all others bypass WCCP
access-list 121 deny   ip any any

So, all others issue solves similar.

Want to do something good - do it yourself!

That's the way. :)

30.12.2014 23:39, Rafael Akchurin &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i>
</I>&gt;<i> Hello Yuri,
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Luckily the same topic was just discussed on our forum &#8211; please see if
</I>this can help
<A HREF="https://groups.google.com/d/msg/quintolabs-content-security-for-squid-proxy/GKIV3FpYSBE/9IET-4hg_tEJ">https://groups.google.com/d/msg/quintolabs-content-security-for-squid-proxy/GKIV3FpYSBE/9IET-4hg_tEJ</A>
&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> It describes the iptables settings for successful SSL bump exclusions
</I>for Dropbox clients / Google Drive / iTunes (bypassing SSL Bump because
of SSL Pinning).
&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i>
</I>&gt;<i> Raf
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> *From:*squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>]
</I>*On Behalf Of *Rafael Akchurin
&gt;<i> *Sent:* Tuesday, December 30, 2014 4:23 PM
</I>&gt;<i> *To:* Yuri Voinov; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> *Subject:* Re: [squid-users] Squid 3 SSL bump: Google drive
</I>application could not connect
&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> &#8203;Only exclusion from SSL Bump as far as I know.
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> raf
</I>&gt;<i>
</I>&gt;<i> -------------------------
</I>&gt;<i>
</I>&gt;<i> *From:*Yuri Voinov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt;&gt;
</I>&gt;<i> *Sent:* Tuesday, December 30, 2014 3:19 PM
</I>&gt;<i> *To:* Rafael Akchurin; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i> *Subject:* Re: [squid-users] Squid 3 SSL bump: Google drive
</I>application could not connect
&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> May be.
</I>&gt;<i>
</I>&gt;<i> Does workaround exists?
</I>&gt;<i>
</I>&gt;<i> 30.12.2014 20:09, Rafael Akchurin ?????:
</I>&gt;<i> &gt; SSL Pinning? (I know Dropbox does this)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; my two cents only :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Raf
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; ________________________________________
</I>&gt;<i>
</I>&gt;<i> &gt; From: squid-users &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;on behalf of Yuri
Voinov &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt;
&gt;<i>
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Sent: Tuesday, December 30, 2014 2:12 PM
</I>&gt;<i>
</I>&gt;<i> &gt; To: &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i>
</I>&gt;<i> &gt; Subject: [squid-users] Squid 3 SSL bump: Google drive application
</I>could not     connect
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Hi gents,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I found strange issue.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Squid 3.4.10. Intercept. HTTPS bumping. All works fine. All configs
</I>correct.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Whenever all web https sites works perfectly - especially in Chrome,
</I>&gt;<i>
</I>&gt;<i> &gt; most cloud clients works like charm (SpiderOak is!), Google Drive client
</I>&gt;<i>
</I>&gt;<i> &gt; application (PC) could not work.
</I>&gt;<i>
</I>&gt;<i> &gt; Note: Web Google Docs works. Web Google drive works.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Note: Google support info - even I if pass dozen Google URL's without
</I>&gt;<i>
</I>&gt;<i> &gt; bump - cannot help. It doesn't work when server-first bumping is on and
</I>&gt;<i>
</I>&gt;<i> &gt; works othervise.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; So, the Serious Question is: Why? :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Any idea?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i>
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i>
</I>&gt;<i> &gt; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i>
</I>&gt;<i> &gt; &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBAgAGBQJUowFgAAoJENNXIZxhPexGHxkIAM2mb+OjhevZWpgdwiKHP2E0
D+8UM6/c7OZcJ2uSjIWN7DG0h+b86/ATul+9S+mZHl1DLBYpGUKW9J5I3iIQb+sr
5xR2ReFkuFeSpZASXex2yq5lfmACPdiUzI9iVhe7DPJqKJNiIzvHLq4ZRnjJN4Ih
0u0NGuPKfkkWFJ/SmXAceEdS7sT/lT0cVm1JgpurVzipelBUNbLQUd0yKrpbIz2x
ia7gwu3ZFi2aY2DvrfP7ntkoZpLl+SyDI/PkFIEaAr2+KaMcTbUXVQcVTZ7S6eLu
pgCNil0x8AFApWSIg+P68DcFcIS/nUIvNqXjuvr0ikqGwLEAqvueM6LPKifsdSg=
=J+Cs
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20141231/091f2fff/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20141231/091f2fff/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001272.html">[squid-users] Squid 3 SSL bump: Google drive application could not	connect
</A></li>
	<LI>Next message (by thread): <A HREF="001275.html">[squid-users] Squid 3 SSL bump: Google drive application could not	connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1274">[ date ]</a>
              <a href="thread.html#1274">[ thread ]</a>
              <a href="subject.html#1274">[ subject ]</a>
              <a href="author.html#1274">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
