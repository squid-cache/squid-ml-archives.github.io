<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_DENIED/403
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_DENIED/403&In-Reply-To=%3C5459FBED.8070905%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000626.html">
   <LINK REL="Next"  HREF="000637.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_DENIED/403</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_DENIED/403&In-Reply-To=%3C5459FBED.8070905%40treenet.co.nz%3E"
       TITLE="[squid-users] TCP_DENIED/403">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Nov  5 10:29:01 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000626.html">[squid-users] TCP_DENIED/403
</A></li>
        <LI>Next message (by thread): <A HREF="000637.html">[squid-users] TCP_DENIED/403
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#628">[ date ]</a>
              <a href="thread.html#628">[ thread ]</a>
              <a href="subject.html#628">[ subject ]</a>
              <a href="author.html#628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 5/11/2014 10:39 p.m., <A HREF="https://lists.squid-cache.org/listinfo/squid-users">navari.lorenzo at gmail.com</A> wrote:
&gt;<i> Good day today. I' m configuring a Squid Web Proxy Cache and  I
</I>&gt;<i> apply the deny policy to some sites l this is the problem:
</I>&gt;<i> 
</I>&gt;<i> when people accesses sites with GET they have the right html error
</I>&gt;<i> page ERR_ACCES_DENIED (LOG = TCP_DENIED/403 4069 GET
</I>&gt;<i> <A HREF="http://www.sex.com/">http://www.sex.com/</A> - HIER_NONE/- text/html)
</I>&gt;<i> 
</I>&gt;<i> when people accesses sites with CONNECT they DON'T  have the right
</I>&gt;<i> html error page but te message CONNECTION REFUSED BY PROXY SERVER 
</I>&gt;<i> (LOG = TCP_DENIED/403 3681 CONNECT facebook.com:443 - HIER_NONE/-
</I>&gt;<i> text/html)
</I>&gt;<i> 
</I>&gt;<i> I would like to have the same error page for all.
</I>&gt;<i> 
</I>&gt;<i> Can anyone help ??
</I>&gt;<i> 
</I>
Sorry, the answer there is no.

If you look at the TCP packets being sent back by Squid, adn also
shown by those log entries. Squid *is* sending back the same 403 error
in both cases to the client browser.

What is happening is that the browser treates CONNECT and GET
differently. Specifically they refuse to show any remotely generated
(by Squid) content in the even of a 4xx or 5xx response to CONNECT.

To get this changed you will have to discuss it with the browser
people. They do it this way because of past hstory with malicious
payloads being delivered back in 4xx errors to CONNECT.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUWfvtAAoJELJo5wb/XPRjiMgH/iBOO2WiuZ8QnWrcxz/spKpe
pf8KAGwzvtqJMuP0ZUWSLzmfVXEHWf1HlljiwoP+2n73zg3JS51iVSd7f6L3rbGM
eWhZhZ+syWJQ3LBretZHgpvXMuyjiu74PF7m/LkL61G4j/41oVvZeBIt8DQ54ml0
8yC196NIVEAjf2PXasHywgO+Is8L839l4uEh+WVudrDt9VCGEO7V1TJAt6qXiF6j
nwzJEbzzjCLfTosqwdBW1I/QuXVjj230XRVRVT38x/SSu7C1DFY68AvrkIK4DKae
YD0h2ElYEvg2O97KFo6BUugbbUeT/SNz+NGTKNvbz0di0AlwNVVyGj6nuTKayEg=
=Ol/T
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000626.html">[squid-users] TCP_DENIED/403
</A></li>
	<LI>Next message (by thread): <A HREF="000637.html">[squid-users] TCP_DENIED/403
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#628">[ date ]</a>
              <a href="thread.html#628">[ thread ]</a>
              <a href="subject.html#628">[ subject ]</a>
              <a href="author.html#628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
