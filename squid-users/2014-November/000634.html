<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Behind enemy lines (squid behind proxy)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Behind%20enemy%20lines%20%28squid%20behind%20proxy%29&In-Reply-To=%3C545AEFA5.9030903%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000633.html">
   <LINK REL="Next"  HREF="000644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Behind enemy lines (squid behind proxy)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Behind%20enemy%20lines%20%28squid%20behind%20proxy%29&In-Reply-To=%3C545AEFA5.9030903%40treenet.co.nz%3E"
       TITLE="[squid-users] Behind enemy lines (squid behind proxy)">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Nov  6 03:48:53 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000633.html">[squid-users] Behind enemy lines (squid behind proxy)
</A></li>
        <LI>Next message (by thread): <A HREF="000644.html">[squid-users] Behind enemy lines (squid behind proxy)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#634">[ date ]</a>
              <a href="thread.html#634">[ thread ]</a>
              <a href="subject.html#634">[ subject ]</a>
              <a href="author.html#634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 6/11/2014 2:33 p.m., <A HREF="https://lists.squid-cache.org/listinfo/squid-users">doc.holliday at usa.com</A> wrote:
&gt;<i> I've searched through the internets and tried various things... to
</I>&gt;<i> no avail. Hopefully someone here can point me in the right
</I>&gt;<i> direction. I am sitting behind a proxy, which accepts http/https.
</I>&gt;<i> Everything else is blocked. If I instruct my browser to use this
</I>&gt;<i> proxy, everything works dandy. Both http and https. The problem is,
</I>&gt;<i> I have a few apps that don't have an option to set proxy. So, my 
</I>&gt;<i> idea was to set up squid on the local machine that would
</I>&gt;<i> transparently redirect http/https to the proxy. Eg something like
</I>&gt;<i> this: [ local_box: app (http or https) ---&gt; squid ]   -----&gt;   [
</I>&gt;<i> the_proxy ] -----&gt;   ...   -----&gt;   [ internets ] I have no control
</I>&gt;<i> of the proxy, nor do I know what goes on after it.
</I>
&lt;snip&gt;
&gt;<i> And so after endless searching and searching and trying various
</I>&gt;<i> things I came here. Could please help me figure out why it is not
</I>&gt;<i> working?
</I>
HTTPS is supposed to offer end-to-end security. Squid attempts to
simulate that behaviour even when bumping. So by default bumped
traffic will be re-encrypted and sent directly to the origin server as
per DNS records.

What you have configured forces that not to happen then sends the
de-crypted traffic to the peer proxy as HTTP. The peer is rejecting
the un-encrypted protocol containing <A HREF="https://">https://</A> URLs with a 503 for
whatever reason.

If the other peer is another Squid then chances are still fairly high
that it has been built without OpenSSL support and so literally cannot
open the TLS connection to deliver the <A HREF="https://">https://</A> request to the origin.

Generating new CONNECT tunnels over peer proxies has not yet been
coded for Squid. Nobody seems willing sponsor its development, despite
all these problems bumping is now causing.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUWu+lAAoJELJo5wb/XPRjBfQH/iXUPYRkq16T4cuSsrex2OIH
8XldBtMkzAYl4HjtiFHeK0uT5lV/BHvelP9hfKSs5zFa4Y1JjQeLYV3rLTXWIWME
VSsk7Q/PDUCMdEShenCDPFaSCHr8pSU8Ey7wCgco86yMm5SMEtjCxP0pmaauuUvq
PNH8CceJUWgVQFtVuRZq57MueNX0xSIxIzVdiOn22ajST4ZQoWthoHvsTybbup/l
4iBXp7wygwCOFmVs6/WFw7CA/e7yuxj6oWhL3q4vg4pFP23zA7uknERf4h6QVkQw
Ms3/QfXJDVvnRhya3jbqm1Eme/vIC4LDYKO1a++YBxHg8b4yxtN+D6oqF2Vlz1k=
=oPE/
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000633.html">[squid-users] Behind enemy lines (squid behind proxy)
</A></li>
	<LI>Next message (by thread): <A HREF="000644.html">[squid-users] Behind enemy lines (squid behind proxy)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#634">[ date ]</a>
              <a href="thread.html#634">[ thread ]</a>
              <a href="subject.html#634">[ subject ]</a>
              <a href="author.html#634">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
