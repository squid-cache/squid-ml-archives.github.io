<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid ACL, SSL-BUMP and authentication questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20ACL%2C%20SSL-BUMP%20and%20authentication%20questions&In-Reply-To=%3C545C764E.5040007%40visolve.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000646.html">
   <LINK REL="Next"  HREF="000649.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid ACL, SSL-BUMP and authentication questions</H1>
    <B>squid-list</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20ACL%2C%20SSL-BUMP%20and%20authentication%20questions&In-Reply-To=%3C545C764E.5040007%40visolve.com%3E"
       TITLE="[squid-users] Squid ACL, SSL-BUMP and authentication questions">squid at visolve.com
       </A><BR>
    <I>Fri Nov  7 07:35:42 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000646.html">[squid-users] Squid ACL, SSL-BUMP and authentication questions
</A></li>
        <LI>Next message (by thread): <A HREF="000649.html">[squid-users] Squid ACL, SSL-BUMP and authentication questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#648">[ date ]</a>
              <a href="thread.html#648">[ thread ]</a>
              <a href="subject.html#648">[ subject ]</a>
              <a href="author.html#648">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
*
**&quot;Access to google maps(<A HREF="https://www.google.com/maps">https://www.google.com/maps</A>) should prevent any 
authentication need&quot;*

I could understand that all users should be able to access the google 
maps link without any authentication. For this you could add the site 
acl before the authentication part in the squid conf. So that users will 
not prompt for the authentication when the user try to access the google 
map site. But when they try to access any other site authentication will 
be prompted.

(i.e)
acl GoogleMaps           url_regex -i ^<A HREF="https://www.google.com/maps*.">https://www.google.com/maps*.</A>
         acl allow GoogleMaps all

auth_param basic children 5

auth_param basic realm Welcome to Our Website!

auth_param basic program /usr/lib64/squid/basic_ncsa_auth 
/etc/squid/squid_user

auth_param basic credentialsttl 2 hours

         auth_param basic casesensitive off

         ....
         ....

I am not clear about the remaining part of the content.

Regards,
ViSolve Squid

On 11/07/2014 08:55 AM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at icshk.com</A> wrote:
&gt;<i>
</I>&gt;<i> Hello all,
</I>&gt;<i>
</I>&gt;<i> As our company policy only allow some machines to access to some SSL 
</I>&gt;<i> website URL(eg. <A HREF="https://www.google.com/maps">https://www.google.com/maps</A>). However, they do not 
</I>&gt;<i> have access to <A HREF="https://www.google.com/">https://www.google.com/</A> Before, we tried to implement 
</I>&gt;<i> authentication, everything works fine. We try to allow https access to 
</I>&gt;<i> <A HREF="https://www.google.com/maps">https://www.google.com/maps</A> and &#8220;CONNECT&#8221; request to www.google.com 
</I>&gt;<i> &lt;<A HREF="http://www.google.com">http://www.google.com</A>&gt; using SSL bump. Now, I want to preserve this 
</I>&gt;<i> config, and let user to authenicate to access to any website. Access 
</I>&gt;<i> to google maps(<A HREF="https://www.google.com/maps">https://www.google.com/maps</A>) should prevent any 
</I>&gt;<i> authentication need. However, I am not success to figure this out. I 
</I>&gt;<i> have tried different kinds of configuration, some will prompt for 
</I>&gt;<i> authentication. Some will not allow the authenticated users to access 
</I>&gt;<i> to <A HREF="https://www.google.com.">https://www.google.com.</A> From the access log, after I authenticate 
</I>&gt;<i> and try to access to <A HREF="https://www.google.com,">https://www.google.com,</A> the authentication 
</I>&gt;<i> information is not displayed. Seems squid do not use the 
</I>&gt;<i> authentication information when matching the this rule: 
</I>&gt;<i> &#8220;http_access     allow   CONNECT google&#8221;.
</I>&gt;<i>
</I>&gt;<i> The &#8220;CONNECT&#8221; method is success. Then, the squid will continue use no 
</I>&gt;<i> authentication information to process the &#8220;GET&#8221; command, causing the 
</I>&gt;<i> authenticated user to denied access to <A HREF="https://www.google.com.">https://www.google.com.</A>
</I>&gt;<i>
</I>&gt;<i> Can I make squid always use the authentication information if already 
</I>&gt;<i> authenticate ? Or any suggestion to implement this policy.
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> Here is an extracted version of config which should state the related 
</I>&gt;<i> configuration:
</I>&gt;<i>
</I>&gt;<i> auth_param basic children 5
</I>&gt;<i>
</I>&gt;<i> auth_param basic realm Welcome to Our Website!
</I>&gt;<i>
</I>&gt;<i> auth_param basic program /usr/lib64/squid/basic_ncsa_auth 
</I>&gt;<i> /etc/squid/squid_user
</I>&gt;<i>
</I>&gt;<i> auth_param basic credentialsttl 2 hours
</I>&gt;<i>
</I>&gt;<i> auth_param basic casesensitive off
</I>&gt;<i>
</I>&gt;<i> acl my_auth proxy_auth REQUIRED
</I>&gt;<i>
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i>
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i>
</I>&gt;<i> acl GoogleMaps           url_regex -i ^<A HREF="https://www.google.com/maps*.">https://www.google.com/maps*.</A>
</I>&gt;<i>
</I>&gt;<i> acl test_net                 src             192.168.1.253/32
</I>&gt;<i>
</I>&gt;<i> acl google                    dstdomain www.google.com 
</I>&gt;<i> &lt;<A HREF="http://www.google.com">http://www.google.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i>
</I>&gt;<i> http_access allow                           GoogleMaps
</I>&gt;<i>
</I>&gt;<i> http_access allow   CONNECT                 google
</I>&gt;<i>
</I>&gt;<i> http_access deny    CONNECT                 google my_auth
</I>&gt;<i>
</I>&gt;<i> #http_access allow   CONNECT                 test_net google
</I>&gt;<i>
</I>&gt;<i> http_access allow   my_auth                all
</I>&gt;<i>
</I>&gt;<i> http_access deny                            all
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20141107/8c10f040/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20141107/8c10f040/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000646.html">[squid-users] Squid ACL, SSL-BUMP and authentication questions
</A></li>
	<LI>Next message (by thread): <A HREF="000649.html">[squid-users] Squid ACL, SSL-BUMP and authentication questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#648">[ date ]</a>
              <a href="thread.html#648">[ thread ]</a>
              <a href="subject.html#648">[ subject ]</a>
              <a href="author.html#648">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
