<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid3%20config%20on%20Ubuntu%20remains%20even%20after%0A%20uninstall%20and%20ignore%20the%20new%20config&In-Reply-To=%3C5460DD9E.8080201%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000699.html">
   <LINK REL="Next"  HREF="000709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid3%20config%20on%20Ubuntu%20remains%20even%20after%0A%20uninstall%20and%20ignore%20the%20new%20config&In-Reply-To=%3C5460DD9E.8080201%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Nov 10 15:45:34 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000699.html">[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config
</A></li>
        <LI>Next message (by thread): <A HREF="000709.html">[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#706">[ date ]</a>
              <a href="thread.html#706">[ thread ]</a>
              <a href="subject.html#706">[ subject ]</a>
              <a href="author.html#706">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 11/11/2014 2:58 a.m., Efe wrote:
&gt;<i> Thank you for your reply. I've managed to retrieve uncommented
</I>&gt;<i> config lines:
</I>&gt;<i> 
</I>&gt;<i> $ grep -P '^\s*\w' /etc/squid3/squid.conf
</I>&gt;<i> 
</I>&gt;<i> acl localnet src 192.168.0.101  # RFC1918 possible internal
</I>&gt;<i> network acl SSL_ports port 443 acl Safe_ports port 80      # http 
</I>&gt;<i> acl Safe_ports port 21      # ftp acl Safe_ports port 443     #
</I>&gt;<i> https acl Safe_ports port 70      # gopher acl Safe_ports port 210
</I>&gt;<i> # wais acl Safe_ports port 1025-65535  # unregistered ports acl
</I>&gt;<i> Safe_ports port 280     # http-mgmt acl Safe_ports port 488     #
</I>&gt;<i> gss-http acl Safe_ports port 591     # filemaker acl Safe_ports
</I>&gt;<i> port 777     # multiling http acl CONNECT method CONNECT 
</I>&gt;<i> http_access deny !Safe_ports http_access deny CONNECT !SSL_ports 
</I>&gt;<i> acl myrule dstdom_regex &quot;/etc/squid3/domainblock.txt&quot; http_access
</I>&gt;<i> allow myrule cache deny all http_access allow localhost manager 
</I>&gt;<i> http_access deny manager acl Purge method PURGE http_access deny
</I>&gt;<i> Purge http_access allow localhost http_port 3128 coredump_dir
</I>&gt;<i> /var/spool/squid3 refresh_pattern ^ftp:       1440    20% 10080 
</I>&gt;<i> refresh_pattern ^gopher:    1440    0%  1440 refresh_pattern -i
</I>&gt;<i> (/cgi-bin/|\?) 0 0%  0 refresh_pattern (Release|Packages(.gz)*)$
</I>&gt;<i> 0       20%     2880 refresh_pattern .       0   20% 4320
</I>&gt;<i> 
</I>&gt;<i> If helps, iptables is empty and netstat status is $ sudo netstat
</I>&gt;<i> -nltp | grep squid tcp6       0      0 :::3128
</I>&gt;<i> :::* LISTEN      20292/(squid-1)
</I>&gt;<i> 
</I>&gt;<i> Version info: $ sudo apt-cache policy squid3 squid3: Installed:
</I>&gt;<i> 3.3.8-1ubuntu6.1 Candidate: 3.3.8-1ubuntu6.1 Version table: ***
</I>&gt;<i> 3.3.8-1ubuntu6.1 0 500 <A HREF="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</A>
</I>&gt;<i> trusty-updates/main i386 Packages 500
</I>&gt;<i> <A HREF="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</A> trusty-security/main i386 
</I>&gt;<i> Packages 100 /var/lib/dpkg/status 3.3.8-1ubuntu6 0 500
</I>&gt;<i> <A HREF="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</A> trusty/main i386 Packages
</I>&gt;<i> 
</I>&gt;<i> Proof that squid is running: $ ps ax | grep squid 20290 ?        Ss
</I>&gt;<i> 0:00 squid3 20292 ?        S      0:06 (squid-1) 31535 ?        S
</I>&gt;<i> 0:00 (logfile-daemon) /var/log/squid3/access.log 31720 pts/28   S+
</I>&gt;<i> 0:00 grep --color=auto squid
</I>&gt;<i> 
</I>&gt;<i> Maybe i used the wrong terminology as &quot;redirect&quot;. B/c whenever the
</I>&gt;<i> website in the blocklist is called, localhost page of my LAMP shows
</I>&gt;<i> up.
</I>&gt;<i> 
</I>&gt;<i> So, what i want to achieve in the end is blocking and sometimes
</I>&gt;<i> unblocking a list of websites based on their domain name. Problem
</I>&gt;<i> is even the config is changed to &quot;http_access allow myrule&quot; it
</I>&gt;<i> doesnt reflect allow/deny options accordingly anymore. At this
</I>&gt;<i> moment, the websites in the list are still non-accessible.
</I>&gt;<i> 
</I>
Let me guess,  you are testing this with a browser URL
<A HREF="http://192.168.whatever:3128/">http://192.168.whatever:3128/</A> or even just <A HREF="http://192.168.whatever/">http://192.168.whatever/</A>
and it shows your LAMP server page?

You seem to have missed out all the bits of the setup which make the
browser use the proxy rather than just connecting directly to Apache
in the LAMP stack.
You may need to read through this:
 <A HREF="http://wiki.squid-cache.org/SquidFaq/ConfiguringBrowsers">http://wiki.squid-cache.org/SquidFaq/ConfiguringBrowsers</A>

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUYN2bAAoJELJo5wb/XPRj5VMIANLLVIb8kjqk5BiycDBAH1MR
5qA896B3hhcoVEgFIH2lxSzFVBXJBFSwcjXnZN9nkqf5b7/t6k58hY3+56+UfZSF
xO7tHOy/mvtCNA+ol7JlyVz+MvgaKMRqzXdAnJdP3OrhQ4g75WfGKCxoCBBwPNgU
5gD7rSSQq8PpD0uBNuHV8SDwwKkYaoYtoqAs1OWD5p+WbyAylYZB7cJKKgex1+d9
nPqGIlaRLaWRJzcTDFUW0C3B0zIggIv5GRNsO50gqqQZ0Xb9F3Iy5aDOwyiyiCYn
LmlRADaoqf4MWfBh+nmmufcwUcfsAGknI7tStk3dXCzNQNA9O2gy3e7s+H+7Poo=
=A5vS
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000699.html">[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config
</A></li>
	<LI>Next message (by thread): <A HREF="000709.html">[squid-users] Squid3 config on Ubuntu remains even after uninstall and ignore the new config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#706">[ date ]</a>
              <a href="thread.html#706">[ thread ]</a>
              <a href="subject.html#706">[ subject ]</a>
              <a href="author.html#706">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
