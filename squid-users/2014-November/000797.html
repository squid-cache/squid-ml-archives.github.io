<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid going through another forward proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20going%20through%20another%20forward%20proxy&In-Reply-To=%3C5465A296.8010109%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000796.html">
   <LINK REL="Next"  HREF="000900.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid going through another forward proxy</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20going%20through%20another%20forward%20proxy&In-Reply-To=%3C5465A296.8010109%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid going through another forward proxy">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Nov 14 06:35:02 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000796.html">[squid-users] Squid going through another forward proxy
</A></li>
        <LI>Next message (by thread): <A HREF="000900.html">[squid-users] Squid going through another forward proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#797">[ date ]</a>
              <a href="thread.html#797">[ thread ]</a>
              <a href="subject.html#797">[ subject ]</a>
              <a href="author.html#797">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 14/11/2014 6:22 p.m., Hector Chan wrote:
&gt;<i> Hi Amos,
</I>&gt;<i> 
</I>&gt;&gt;<i> those lines you specify above go in (C). *if* they are needed at
</I>&gt;&gt;<i> all.
</I>&gt;<i> 
</I>&gt;<i> But I don't have control over (C).  It's off limits.
</I>
Then you have to trust that the admin in charge of it set it up right.

&gt;<i> 
</I>&gt;&gt;<i> In (B) goes:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> cache_peer forward-proxy.example.com parent 3128 0 name=C
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> acl sendToC dstdomain origin-x.example.com origin-y.example.com
</I>&gt;<i> origin-z.example.com
</I>&gt;&gt;<i> cache_peer_access C sendToC
</I>&gt;<i> 
</I>&gt;<i> The requests reaching (B) (reverse-proxy.example.com) are in the
</I>&gt;<i> form: <A HREF="http://reverse-proxy.example.com/goto-origin-x">http://reverse-proxy.example.com/goto-origin-x</A> 
</I>&gt;<i> <A HREF="http://reverse-proxy.example.com/goto-origin-y">http://reverse-proxy.example.com/goto-origin-y</A> 
</I>&gt;<i> <A HREF="http://reverse-proxy.example.com/goto-origin-z">http://reverse-proxy.example.com/goto-origin-z</A>
</I>&gt;<i> 
</I>&gt;<i> and I have a couple of cache_peer_access acls (urlpath regex) to
</I>&gt;<i> send them to origin-x, origin-y, and origin-z.  How would the above
</I>&gt;<i> dstdomain acl work with these rules?
</I>
You have now stopped using HTTP and started using some strange
URL-embeded protocol.

An HTTP proxy cannot help you there. You require a proxy that
understands and acts on the URL-embeded protocol messages.

It is possible to extend Squid with URL-rewrite helpers that can
translate it into different HTTP URL for passing to (C). BUT, there is
no guarantee of what origin (C) will use to fetch that resource. You
have to *trust* that (C) uses the origin best suited to any request
that it is given, according to the criteria its own admin has set for
&quot;best&quot;.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUZaKVAAoJELJo5wb/XPRjdpQH/iBh1HQcAZQr0gqK7FS8nZ9x
v0fzAOx/L0HCG5MTT7drwvvEVltxMRYoVniM8VJSqUw3cFAlI+2VEScIr3oOFjcr
qAdjxyjer7sxVgmQM80Oa+n40RK7mvZejvhEV9/0Gc0XTmAjL3PrBptKpumslhVh
rq40LUX50rg5xaAfA02WCy4mYS99uH7qBABWIXeeESVdvGLVRTaTlthqaKW8JTFh
pjmS9OKVnk5CeEi6cyJ8VV7edBOgv2rpgUH8Wjap66mmIjVHq8alNU53obRAMk7p
Pd/bPfPFERnoBymbYmYfFBd3Mfddgc49Wpz9gggAWgXE8bq6CbXQHpj5GvUayaE=
=mS+q
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000796.html">[squid-users] Squid going through another forward proxy
</A></li>
	<LI>Next message (by thread): <A HREF="000900.html">[squid-users] Squid going through another forward proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#797">[ date ]</a>
              <a href="thread.html#797">[ thread ]</a>
              <a href="subject.html#797">[ subject ]</a>
              <a href="author.html#797">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
