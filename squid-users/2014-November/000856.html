<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Centralized Squid - design and implementation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Centralized%20Squid%20-%20design%20and%20implementation&In-Reply-To=%3CCAHsHsyvMm_ojaN_SUrmCy3uwypiv8mVYBjZrBj0jtw3djeio1A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000853.html">
   <LINK REL="Next"  HREF="000858.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Centralized Squid - design and implementation</H1>
    <B>Carlos Defoe</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Centralized%20Squid%20-%20design%20and%20implementation&In-Reply-To=%3CCAHsHsyvMm_ojaN_SUrmCy3uwypiv8mVYBjZrBj0jtw3djeio1A%40mail.gmail.com%3E"
       TITLE="[squid-users] Centralized Squid - design and implementation">carlosdefoe at gmail.com
       </A><BR>
    <I>Tue Nov 18 11:35:39 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000853.html">[squid-users] Centralized Squid - design and implementation
</A></li>
        <LI>Next message (by thread): <A HREF="000858.html">[squid-users] Centralized Squid - design and implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#856">[ date ]</a>
              <a href="thread.html#856">[ thread ]</a>
              <a href="subject.html#856">[ subject ]</a>
              <a href="author.html#856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Well, you just wrote a load balancer in PHP, with a load balancing
algorithm in it. It serves the same purpose as HAproxy (I don't really
use HAproxy, so I don't know, but I use the F5 big-ip which is
perfectly capable of testing Internet links behind squid). In you
scheme, WPAD is being used to tell the clients where the load balancer
(a webserver with a php script) is, and PAC probably as the answer
format, which returns a currently valid proxy node address directly to
the client. But as far as I know, once the client gets the PAC answer,
it willl not refresh until the browser is restarted, so it might be a
small problem there.

But it is a good solution, as proved by your decade of using it, and
much cheaper than a F5. As for the DNS trick, it is intended to
increase high availability of the web servers that are serving
wpad.dat (or your php script), because if it runs on only one
webserver, at some point no clients will find anything at all.

Well, there's a lot of ways of doing the same thing, including ucarp,
squid cache_peer as Amos said... It's just a matter of picking the one
that fits.

On Tue, Nov 18, 2014 at 3:31 AM, Jason Haar &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Jason_Haar at trimble.com</A>&gt; wrote:
&gt;<i> On 18/11/14 16:07, Carlos Defoe wrote:
</I>&gt;&gt;<i> As for my scenario, I also use wpad to configure some exceptions, some
</I>&gt;&gt;<i> clients that will use a completely different proxy, etc...
</I>&gt;<i> Our &quot;wpad.dat&quot; is actually a PHP script which tests that the &quot;official&quot;
</I>&gt;<i> proxy (per client subnet) is actually working (with caching of the
</I>&gt;<i> results for performance reasons of course), if not it flicks them off to
</I>&gt;<i> another site's proxy server. Much better than trying to do dynamic DNS
</I>&gt;<i> tricks with a local HAproxy. ie if you have actually lost local Internet
</I>&gt;<i> access due to an ISP outage, HAproxy isn't going to help. But if WPAD
</I>&gt;<i> knows that a WAN-connected proxy is still working - why not point your
</I>&gt;<i> users at that instead
</I>&gt;<i>
</I>&gt;<i> We've been doing this for 10+ years, 99% of the time it's never needed,
</I>&gt;<i> but when it's needed, it works :-)
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Cheers
</I>&gt;<i>
</I>&gt;<i> Jason Haar
</I>&gt;<i> Corporate Information Security Manager, Trimble Navigation Ltd.
</I>&gt;<i> Phone: +1 408 481 8171
</I>&gt;<i> PGP Fingerprint: 7A2E 0407 C9A6 CAF6 2B9F 8422 C063 5EBB FE1D 66D1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000853.html">[squid-users] Centralized Squid - design and implementation
</A></li>
	<LI>Next message (by thread): <A HREF="000858.html">[squid-users] Centralized Squid - design and implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#856">[ date ]</a>
              <a href="thread.html#856">[ thread ]</a>
              <a href="subject.html#856">[ subject ]</a>
              <a href="author.html#856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
