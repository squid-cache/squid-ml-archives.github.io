<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Using LDAP and NCSA auth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20LDAP%20and%20NCSA%20auth&In-Reply-To=%3C546B37A6.9010902%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000855.html">
   <LINK REL="Next"  HREF="000859.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Using LDAP and NCSA auth</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20LDAP%20and%20NCSA%20auth&In-Reply-To=%3C546B37A6.9010902%40treenet.co.nz%3E"
       TITLE="[squid-users] Using LDAP and NCSA auth">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Nov 18 12:12:22 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000855.html">[squid-users] Using LDAP and NCSA auth
</A></li>
        <LI>Next message (by thread): <A HREF="000859.html">[squid-users] Assertion failure: DestinationIp.cc:60
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#857">[ date ]</a>
              <a href="thread.html#857">[ thread ]</a>
              <a href="subject.html#857">[ subject ]</a>
              <a href="author.html#857">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 19/11/2014 12:30 a.m., schinken wrote:
&gt;<i> Hi there,
</I>&gt;<i> 
</I>&gt;<i> i'm currently trying to do authentication against LDAP and NCSA
</I>&gt;<i> auth - but it looks like, the user is never checked against NCSA if
</I>&gt;<i> auth against LDAP failed (because the user doesn't exist):
</I>&gt;<i> 
</I>&gt;&gt;<i> auth_param basic program /usr/lib/squid3/basic_ldap_auth -R -b
</I>&gt;&gt;<i> &quot;dc=COMPANY,dc=int&quot; -D <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at company.int</A> -W
</I>&gt;&gt;<i> /etc/squid3/ldappass.txt -f sAMAccountName=%s -h
</I>&gt;&gt;<i> ldap.company.int auth_param basic children 100 auth_param basic
</I>&gt;&gt;<i> realm Internet Proxy auth_param basic credentialsttl 5 minute
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> auth_param basic program /usr/lib/squid3/basic_ncsa_auth
</I>&gt;&gt;<i> /etc/squid3/passwd auth_param basic realm Internet Proxy Basic
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> acl auth proxy_auth REQUIRED
</I>&gt;<i> 
</I>&gt;<i> If i try ncsa auth manually, it works:
</I>&gt;<i> 
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A>:~# /usr/lib/squid3/basic_ncsa_auth /etc/squid3/passwd 
</I>&gt;&gt;<i> nikola testla OK
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The same is true for LDAP auth. But i can't get a fallback working.
</I>&gt;<i> How could i solve this?
</I>
Two points:

1) Squid does not do authentication. What it does do is send
credentials to a helper and uses the OK/ERR response that comes back
to determine whether to serve the client request. That is all.

2) Each authentication scheme may only have one helper queried. Its
answer is absolute regarding the validity of the credentials sent to it.


Since you decided to write your own authentication system {check
against A, if ERR check against B} you also need to write a helper
that can do the authentication using that system logic.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUazekAAoJELJo5wb/XPRj6p0IANu5XsqkLFlj8pamP60LsXfp
VNxMbRHFBADauR7yaWUIbz+3Wif1ojr/nQg3tiXhb+1skUDOi1iIziPi3C9QvewI
FBlmcHBgIVHm+GfYHm4rfALnyi7lVXPX0Q9uJy4R+0xGzQw0mqgCRQ9QnYD+SUyB
euITq/X6AjDXKKT1fLbJ82DfiAYbukVTLXdXoBFKQ24semNcmHztoeBPuSeyFtBO
Yfu3SkR7J2zXolBt7o/q8nFXJSNzspuwjmIeIZGY7DliBoQtzSII/psiKI/QHusk
Q5/qb3S74uxhmvFhIbuflL0smYgIqezlILHqulZL60ob0tHAGrRnoYVnIYjVd/k=
=Ujkt
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000855.html">[squid-users] Using LDAP and NCSA auth
</A></li>
	<LI>Next message (by thread): <A HREF="000859.html">[squid-users] Assertion failure: DestinationIp.cc:60
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#857">[ date ]</a>
              <a href="thread.html#857">[ thread ]</a>
              <a href="subject.html#857">[ subject ]</a>
              <a href="author.html#857">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
