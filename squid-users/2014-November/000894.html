<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid basic ntlm auth error after upgrade to 3.3.8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20basic%20ntlm%20auth%20error%20after%20upgrade%20to%203.3.8&In-Reply-To=%3C546E0E96.3010303%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000886.html">
   <LINK REL="Next"  HREF="000887.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid basic ntlm auth error after upgrade to 3.3.8</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20basic%20ntlm%20auth%20error%20after%20upgrade%20to%203.3.8&In-Reply-To=%3C546E0E96.3010303%40treenet.co.nz%3E"
       TITLE="[squid-users] squid basic ntlm auth error after upgrade to 3.3.8">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Nov 20 15:53:58 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000886.html">[squid-users] squid basic ntlm auth error after upgrade to 3.3.8
</A></li>
        <LI>Next message (by thread): <A HREF="000887.html">[squid-users] Pull/Fetch high level URL requests from Squid access.log without getting all the object hits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#894">[ date ]</a>
              <a href="thread.html#894">[ thread ]</a>
              <a href="subject.html#894">[ subject ]</a>
              <a href="author.html#894">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 21/11/2014 12:38 a.m., Lupick wrote:
&gt;<i> Hi I've a problem authenticating users outside my AD domain after
</I>&gt;<i> the upgrade to squid 3.3.8.
</I>
3.3.8 is far from the latest Squid. There is information about where
to find updated packages for CentOS at
&lt;<A HREF="http://wiki.squid-cache.org/KnowledgeBase/CentOS">http://wiki.squid-cache.org/KnowledgeBase/CentOS</A>&gt;

&gt;<i> 
</I>&gt;<i> All the domain logged user are able to authenticate without any
</I>&gt;<i> issue.
</I>&gt;<i> 
</I>&gt;<i> The local user or user of a non domain computer have a
</I>&gt;<i> username/password prompt as expected.
</I>&gt;<i> 
</I>&gt;<i> If I provide the right doamin\username and password the promt
</I>&gt;<i> appear over and over.
</I>
By &quot;right&quot; you mean the Basic or NTLM credentials?

Which popup is the browser selecting to display?
 - the realm value configured in squid.conf is displayed as part of
the Basic auth popup, IIRC the proxy hostname or DOMAIN is listed in
teh NTLM popup. So you should be able to tell which its asking for.

NTLM requires machines to be signed into the domain to get the correct
credentials crypto tokens from the DC to login with. Any attempt to
use NTLM credentials without being signed onto the domain will fail.

Basic auth only requires the domain\user:password combo gets delivered.


&gt;<i> 
</I>&gt;<i> BUT after the first time if I click cancel qnd I retry i'm able to
</I>&gt;<i> browse internet.  This happen cause the credential provided  are
</I>&gt;<i> stored under the windows credentian manager in the control panel.
</I>&gt;<i> 
</I>&gt;<i> no problem using centos 6 and squid 3.3.1, the problem appears
</I>&gt;<i> after an upgrade to centos 7 and squid 3.3.8.
</I>&gt;<i> 
</I>&gt;<i> this is my section on squid.conf:
</I>&gt;<i> 
</I>&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth 
</I>&gt;<i> --helper-protocol=squid-2.5-ntlmssp auth_param ntlm children 45 
</I>&gt;<i> #auth_param ntlm max_challenge_reuses 0 #auth_param ntlm
</I>&gt;<i> max_challenge_lifetime 2 minutes
</I>&gt;<i> 
</I>&gt;<i> auth_param basic program /usr/bin/ntlm_auth 
</I>&gt;<i> --helper-protocol=squid-2.5-basic auth_param basic children 5 
</I>&gt;<i> auth_param basic realm Squid proxy-caching web server auth_param
</I>&gt;<i> basic credentialsttl 5 hours
</I>&gt;<i> 
</I>
PS. Have you considered migrating to Kerberos? it has a lot less
problems than NTLM.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUbg6UAAoJELJo5wb/XPRjHzYIALBvTG3mVsl0QX0I1MzYdM2w
h9Cz2ShzpYEJWP+JcqeyQsp8xd8eWcxC8jsnibTat60belprPjcG7HLVVKHnKacT
jwQUQFId5B3KfuIad5MD887CxLwfujT3yoiBB2vFFki+bGWkkEDoOPzkcNY7TsUs
pSAqlynOpHNWH6UTahzG7L/xvxcHMTv8Wd2n1XxKFSGrdShwkWixLP1x3zA/CB3q
qckN8H5R/rOnMSBmWNCZ5VDFelPZTItXaxf4HmSbLw4XySxwLkthd8kHO9o/sv4E
SwiOihvxVMcXD/GPyG+bW9aXDN1p51aPX0SIisUuznuhh6vTTrhCJTqCDU1o9mM=
=pGgC
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000886.html">[squid-users] squid basic ntlm auth error after upgrade to 3.3.8
</A></li>
	<LI>Next message (by thread): <A HREF="000887.html">[squid-users] Pull/Fetch high level URL requests from Squid access.log without getting all the object hits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#894">[ date ]</a>
              <a href="thread.html#894">[ thread ]</a>
              <a href="subject.html#894">[ subject ]</a>
              <a href="author.html#894">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
