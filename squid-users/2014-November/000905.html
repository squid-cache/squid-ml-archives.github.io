<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Problem with digest authentification and credential backend
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20digest%20authentification%20and%0A%20credential%20backend&In-Reply-To=%3C379284887.174632909.1416821882975.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000896.html">
   <LINK REL="Next"  HREF="000931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Problem with digest authentification and credential backend</H1>
    <B>FredB</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20digest%20authentification%20and%0A%20credential%20backend&In-Reply-To=%3C379284887.174632909.1416821882975.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E"
       TITLE="[squid-users] Problem with digest authentification and credential backend">fredbmail at free.fr
       </A><BR>
    <I>Mon Nov 24 09:38:02 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000896.html">[squid-users] Problem with digest authentification and credential backend
</A></li>
        <LI>Next message (by thread): <A HREF="000931.html">[squid-users] Problem with digest authentification and credential backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#905">[ date ]</a>
              <a href="thread.html#905">[ thread ]</a>
              <a href="subject.html#905">[ subject ]</a>
              <a href="author.html#905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And it works great ! Thank you Amos for your patch.
</I>&gt;<i> In previous Squid 3.3.x DIGEST was very buggy , crash, 407, banners,
</I>&gt;<i> but now it seems very stable. Perhaps there are some little bugs
</I>&gt;<i> like this, but now it's usable.
</I>&gt;<i> Thanks for your works
</I>&gt;<i> 
</I>

Hi,

William to be more clear this patch is not related at all with authenticate_ttl directive.
authenticate_ttl doesn't works with Digest, but with basic and maybe another (ntlm, kerberos ?) there is no precision here <A HREF="http://www.squid-cache.org/Doc/config/authenticate_ttl/">http://www.squid-cache.org/Doc/config/authenticate_ttl/</A>

The patch works like this:

At first banner Squid store the login/password HASH <A HREF="http://en.wikipedia.org/wiki/Digest_access_authentication">http://en.wikipedia.org/wiki/Digest_access_authentication</A> <A HREF="http://wiki.squid-cache.org/KnowledgeBase/LdapBackedDigestAuthentication">http://wiki.squid-cache.org/KnowledgeBase/LdapBackedDigestAuthentication</A> 

When nonce is stalled (nonce_max_count reached) the helper compare the account stored in memory with a request to Ldap or/and when the nonce is expired, the helper makes the same thing.

In this two cases there are two possibilities, the account is right or wrong -&gt; Bad password or/and bad login

- If the return is right Squid return a new nonce and there is no impact for the user, I mean no banner.
- If the return is wrong Squid present the authentication realm to the user and the browser prompt for a username and password.

There is also an another situation - if squid is restarted - the browser returns is HASH without banner (if the account is right of course)

So, without any change in LDAP the banner never appear, except when the browser start.

Fred 

PS: About Digest you are right it's almost good now, still also a little problem with nonce count but not related with this 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000896.html">[squid-users] Problem with digest authentification and credential backend
</A></li>
	<LI>Next message (by thread): <A HREF="000931.html">[squid-users] Problem with digest authentification and credential backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#905">[ date ]</a>
              <a href="thread.html#905">[ thread ]</a>
              <a href="subject.html#905">[ subject ]</a>
              <a href="author.html#905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
