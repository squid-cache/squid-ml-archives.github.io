<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Existing root certificate not working with SSL Bump (squid 3.3.10)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Existing%20root%20certificate%20not%20working%20with%20SSL%0A%20Bump%20%28squid%203.3.10%29&In-Reply-To=%3C547AB5A1.3030702%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000935.html">
   <LINK REL="Next"  HREF="000924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Existing root certificate not working with SSL Bump (squid 3.3.10)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Existing%20root%20certificate%20not%20working%20with%20SSL%0A%20Bump%20%28squid%203.3.10%29&In-Reply-To=%3C547AB5A1.3030702%40treenet.co.nz%3E"
       TITLE="[squid-users] Existing root certificate not working with SSL Bump (squid 3.3.10)">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Nov 30 06:13:53 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000935.html">[squid-users] Existing root certificate not working with SSL Bump (squid 3.3.10)
</A></li>
        <LI>Next message (by thread): <A HREF="000924.html">[squid-users] Transparent proxy with Peek and Splice feature.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#970">[ date ]</a>
              <a href="thread.html#970">[ thread ]</a>
              <a href="subject.html#970">[ subject ]</a>
              <a href="author.html#970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 27/11/2014 6:45 a.m., HaxNobody wrote:
&gt;<i> Alright, I figured out a possible cause. I downloaded the
</I>&gt;<i> certificate that the browsers were complaining about, and used
</I>&gt;<i> openssl verify to verify against the root certificate that I have.
</I>&gt;<i> I got error 20, indicating that squid must not be using the correct
</I>&gt;<i> root certificate to generate the client certificate on the fly, or
</I>&gt;<i> that it is being generated incorrectly. The generated certificate
</I>&gt;<i> shows all the correct properties of the root certificate that I am
</I>&gt;<i> using, so my conclusion is that squid is incorrectly generating the
</I>&gt;<i> client certificate.
</I>&gt;<i> 
</I>&gt;<i> Question: Under what circumstances might squid incorrectly generate
</I>&gt;<i> a bump certificate?
</I>
In all circumstances involving client-first bumping, or a bug in Squid.

Other circumstances depend on your definitinon of &quot;correct&quot;. Squid
3.3+ will mimic certificates *including errors* delivered by servers.


Also, Squid does not generate client certificates. It generates server
certificates. I assume that is what you are talking about.


&gt;<i> Another question: Why might it be working when I use a different
</I>&gt;<i> root certificate?
</I>
a) possibly the client trusts only one out of the two root certificates.

b) possibly the non-working certificate is not properly installed in
the client.

c) possibly the non-trusted root certificate is part of a chain which
the client is not able to locate all the pieces for (leading to 'a').

d) possibly the root certificate has key extensions or usage
restrictions prohibiting what Squid usage requires (leading to 'a').


You will need to get a content dump of the certificates emitted by
Squid and a working system to see what the difference(s) are.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUerWgAAoJELJo5wb/XPRjOnoH/ROsdsAnwe837rrCSgvmlb7N
y51KKl6axftQZs6HQKToYNZ4BkB1Hzgpn5mPxT9NlsbQm8yRGA42mhjHOWvJX4R7
WEsW6OlF+HNd/FVhahkJHSGmS/isSKRCK0B5fXuq0KX3dnTrZz6/53oNYXMXeyl+
j89d9JHSKUPVmvtEUfLEPYW5VDmaZfcmFL8WkUQ7Hi/ZOubnbL5gQPr67DF0r6qE
maZucqIHs5j0xP3ItLbcOxZQ5iCjmTmyNrxh0gyjZ3/OOTp1qpyRZQ6UPGqtnswt
UIGPgvayerMDNN+rAp82qZyLm70A4mmcHVY42d6haG4hGWb/WweEEhCZm6wS/TI=
=+5Ty
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000935.html">[squid-users] Existing root certificate not working with SSL Bump (squid 3.3.10)
</A></li>
	<LI>Next message (by thread): <A HREF="000924.html">[squid-users] Transparent proxy with Peek and Splice feature.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#970">[ date ]</a>
              <a href="thread.html#970">[ thread ]</a>
              <a href="subject.html#970">[ subject ]</a>
              <a href="author.html#970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
