<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [ADVISORY] SQUID-2014:4 Multiple issues in pinger	ICMP processing.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BADVISORY%5D%20SQUID-2014%3A4%20Multiple%20issues%20in%20pinger%0A%09ICMP%20processing.&In-Reply-To=%3C542D1646.1000807%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000063.html">
   <LINK REL="Next"  HREF="000065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [ADVISORY] SQUID-2014:4 Multiple issues in pinger	ICMP processing.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BADVISORY%5D%20SQUID-2014%3A4%20Multiple%20issues%20in%20pinger%0A%09ICMP%20processing.&In-Reply-To=%3C542D1646.1000807%40treenet.co.nz%3E"
       TITLE="[squid-users] [ADVISORY] SQUID-2014:4 Multiple issues in pinger	ICMP processing.">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Oct  2 09:09:26 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000063.html">[squid-users] [ADVISORY] SQUID-2014:3 Buffer overflow in SNMP	processing
</A></li>
        <LI>Next message (by thread): <A HREF="000065.html">[squid-users] squid 3.4. uses 100% cpu with ntlm_auth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64">[ date ]</a>
              <a href="thread.html#64">[ thread ]</a>
              <a href="subject.html#64">[ subject ]</a>
              <a href="author.html#64">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

__________________________________________________________________

      Squid Proxy Cache Security Update Advisory SQUID-2014:4
__________________________________________________________________

Advisory ID:            SQUID-2014:4
Date:                   September 15, 2014
Summary:                Multiple issues in pinger ICMP processing.
Affected versions:      Squid 3.x -&gt; 3.4.7
Fixed in version:       Squid 3.4.8
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2014_4.txt">http://www.squid-cache.org/Advisories/SQUID-2014_4.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7141">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7141</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7142">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7142</A>
__________________________________________________________________

Problem Description:

 Due to incorrect bounds checking Squid pinger binary is
 vulnerable to denial of service or information leak attack when
 processing larger than normal ICMP or ICMPv6 packets.

 Due to incorrect input validation Squid pinger binary is
 vulnerable to denial of service or information leak attacks when
 processing ICMP or ICMPv6 packets.

__________________________________________________________________

Severity:

 Several bugs allow any remote server to perform a denial of
 service attack on the Squid service by crashing the pinger.

 Some of these bugs allow attackers to leak arbitrary amounts of
 information from the heap into Squid log files. This is of higher
 importance than usual because the pinger process operates with
 root priviliges.

__________________________________________________________________

Updated Packages:

 This bug is fixed by Squid version 3.4.8

 In addition, patches addressing this problem for stable releases
 can be found in our patch archives:

Squid 3.1:
<A HREF="http://www.squid-cache.org/Versions/v3/3.1/changesets/squid-3.1-10490.patch">http://www.squid-cache.org/Versions/v3/3.1/changesets/squid-3.1-10490.patch</A>

Squid 3.2:
<A HREF="http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11830.patch">http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11830.patch</A>

Squid 3.3:
<A HREF="http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12683.patch">http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12683.patch</A>

Squid 3.4:
<A HREF="http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13173.patch">http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13173.patch</A>


 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 All Squid built with --disable-icmp are not vulnerable to these
 problems.

 Check the server running processes list to determine if the Squid
 service is running a &quot;pinger&quot; child process.

 All unpatched Squid-2.x and Squid-3.x versions up to and
 including 3.4.7 running the pinger process are vulnerable to
 these problems.

__________________________________________________________________

Workaround:

 Configuring the firewall controlling access to Squid service such
 that only ICMP ECHO packets are allowed delivery to the Squid
 pinger process will limit the denial of service vulnerability.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A> mailing list is your primary
 support point. For subscription details see
 <A HREF="http://www.squid-cache.org/Support/mailing-lists.html.">http://www.squid-cache.org/Support/mailing-lists.html.</A>

 For reporting of non-security bugs in the latest release
 the squid bugzilla database should be used
 <A HREF="http://bugs.squid-cache.org/.">http://bugs.squid-cache.org/.</A>

 For reporting of security sensitive bugs send an email to the
 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at squid-cache.org</A> mailing list. It's a closed list
 (though anyone can post) and security related bug reports are
 treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 Several of the vulnerabilities were discovered and fixed by
 Sebastian Krahmer of the OpenSUSE Project.

 Some of the vulnerabilities were discovered and fixed by Amos
 Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2014-09-09 08:39 GMT Initial Report
 2014-09-15 08:15 GMT Patches and Packages Released
 2014-09-22 06:08 GMT CVE assignment
__________________________________________________________________
END

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJULRZGAAoJELJo5wb/XPRjTsUIAN5kJRs7H0DDJKCuSdTgHOZJ
NhYoFKMyP9vHcYBSMKG9AHD++xdp5vuJNMSlDgfSptrdb2nT7dMlke8x3pXFvCxQ
6FeaJHZ3/zbc4Pg9wxmPHIRXzGCs1ic7/qNRLkaZsyGPkQRgSMABYhxsxAIGzolF
SbXJWsx+7zck2BwB84yPDGg1VPflTAE3sSz1XoG7mjATgydqrH9jTUZsOfUV4O4+
A2ByEbmGgaxd8mWtxnTU8Rk17CWHKQRsC0p30gZkOFP39QtYfx4LANS0vnkhsE+S
gfKWyA92mPG2Nocl9PnTsUQJqr8oOpGB/loioGzjRgvxe3ezaycKgr3fHuMy6kg=
=i0Am
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000063.html">[squid-users] [ADVISORY] SQUID-2014:3 Buffer overflow in SNMP	processing
</A></li>
	<LI>Next message (by thread): <A HREF="000065.html">[squid-users] squid 3.4. uses 100% cpu with ntlm_auth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64">[ date ]</a>
              <a href="thread.html#64">[ thread ]</a>
              <a href="subject.html#64">[ subject ]</a>
              <a href="author.html#64">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
