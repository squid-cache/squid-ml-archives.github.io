<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] transparent proxy https and self signed certificate	error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20https%20and%20self%20signed%20certificate%0A%09error&In-Reply-To=%3CCADoG9xk43M6%2BROrbhA6kL2TrC9_zrcOjUznz%2BzhLS7xphrZC_Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000129.html">
   <LINK REL="Next"  HREF="000096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] transparent proxy https and self signed certificate	error</H1>
    <B>Robert Watson</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20https%20and%20self%20signed%20certificate%0A%09error&In-Reply-To=%3CCADoG9xk43M6%2BROrbhA6kL2TrC9_zrcOjUznz%2BzhLS7xphrZC_Q%40mail.gmail.com%3E"
       TITLE="[squid-users] transparent proxy https and self signed certificate	error">robert at gillecaluim.com
       </A><BR>
    <I>Sun Oct  5 00:29:01 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000129.html">[squid-users] High cpu usage by re_search_internal
</A></li>
        <LI>Next message (by thread): <A HREF="000096.html">[squid-users] transparent proxy https and self signed certificate error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92">[ date ]</a>
              <a href="thread.html#92">[ thread ]</a>
              <a href="subject.html#92">[ subject ]</a>
              <a href="author.html#92">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>using squid 3.4.8, compiled from source with ./configure flags
--enable-icap-client --enable-ssl --enable-ssl-crtd
configured iptables for transparent proxy (redirect 80 to 3128) and
everything works fine

configured iptables for transparent proxy (redirect 443 to 3127) but can't
get transparent proxy for https to work
my squid.conf
...
# Squid https port
https_port 3127 intercept ssl-bump generate-host-certificates=on
dynamic_cert_mem_cache_size=4MB cert=/etc/squid/ssl_cert/XXX.pem
acl broken_sites dstdomain .example.com
ssl_bump none localhost
ssl_bump none broken_sites
ssl_bump server-first all
sslproxy_cert_error allow all
sslproxy_flags DONT_VERIFY_PEER
sslcrtd_program /usr/lib/squid/ssl_crtd -s /var/lib/squid/ssl_db -M 4MB
sslcrtd_children 32 startup=5 idle=1

when visiting google (or any other https site) chrome complains
NET::ERR_CERT_AUTHORITY_INVALID
I tried using internet explorer as admin and imported the self signed
certificate but that hasn't helped

can anyone please with how to debug this
thanks, Robert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20141004/8076704b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20141004/8076704b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000129.html">[squid-users] High cpu usage by re_search_internal
</A></li>
	<LI>Next message (by thread): <A HREF="000096.html">[squid-users] transparent proxy https and self signed certificate error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92">[ date ]</a>
              <a href="thread.html#92">[ thread ]</a>
              <a href="subject.html#92">[ subject ]</a>
              <a href="author.html#92">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
