<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C20141007025214.GA51120%40admin.sibptus.tomsk.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000132.html">
   <LINK REL="Next"  HREF="000138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)</H1>
    <B>Victor Sudakov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C20141007025214.GA51120%40admin.sibptus.tomsk.ru%3E"
       TITLE="[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)">sudakov at sibptus.tomsk.ru
       </A><BR>
    <I>Tue Oct  7 02:52:14 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000132.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
        <LI>Next message (by thread): <A HREF="000138.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#137">[ date ]</a>
              <a href="thread.html#137">[ thread ]</a>
              <a href="subject.html#137">[ subject ]</a>
              <a href="author.html#137">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Amos Jeffries wrote:
&gt;<i> &gt; 
</I>&gt;<i> &gt; I have never used the helper provided by Samba, and I am not
</I>&gt;<i> &gt; willing to start using it.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I don't want to install Samba on a proxy server, maintain a
</I>&gt;<i> &gt; smb.conf and TDB databases there, join a domain, see hundreds of
</I>&gt;<i> &gt; winbindd processes etc.
</I>&gt;<i> 
</I>&gt;<i> Thats the price of NTLM.
</I>
This price is too high for my objectives.

&gt;<i> &gt; The ntlm_auth plugin has always been sufficient for my needs. I
</I>&gt;<i> &gt; hoped it would continue to be usable, but something is broken in
</I>&gt;<i> &gt; it.
</I>&gt;<i> 
</I>&gt;<i> The Squid &quot;ntlm_auth&quot; helper (now ntlm_smb_lm_auth) does not, and
</I>&gt;<i> never has, performed NTLM in any way.
</I>&gt;<i> 
</I>&gt;<i> What it does is this <A HREF="http://en.wikipedia.org/wiki/LM_hash.">http://en.wikipedia.org/wiki/LM_hash.</A>
</I>
I am perfectly aware of that. The problem is that this LM
authentication did work with the squid27 ntlm_auth helper and does not
work with the squid34 newer ntlm_smb_lm_auth helper. There was no need
to break what was working.

&gt;<i> The *Basic* authentication provided in HTTP is actually a superior
</I>&gt;<i> form of authentication.
</I>&gt;<i> If you convert your proxy to requesting Basic auth you will find your
</I>
I am afraid you are mistaken. If I convert my proxy to Basic, it
will start asking users for their login/password for proxy access,
instead of authenticating them transparently with their Windows
credentials.

&gt;<i> 
</I>&gt;<i> &gt; I would be glad to migrate to Kerberos though, if I can only make 
</I>&gt;<i> &gt; browsers use it. No success so far. If anybody can help with it, I 
</I>&gt;<i> &gt; would greatly appreciate.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Since your environment was accepting the old versions of
</I>&gt;<i> ntlm_smb_lm_auth helper I predict that most of that software will
</I>&gt;<i> attempt to use the Negotiate/NTLM form of Negotiate authentication
</I>&gt;<i> over HTTP.
</I>&gt;<i> 
</I>&gt;<i> To prevent that you will have to disable NTLM use on the machine(s)
</I>&gt;<i> you are trying to convert to Kerberos. 
</I>
Yes, I have special provisions in the domain policies to allow the old
NTLM.  Do you mean to say if I disable NTLM, the browsers will start
talking Negotiate/Kerberos? 

Thanks for the hint, I will try that out and report here.

&gt;<i> Adding Basic as a fallback
</I>&gt;<i> offering you can test the Kerberos is working without cutting the
</I>&gt;<i> service or /user off completely.
</I>
No, adding Basic is not an option because I will have to provide
special &quot;proxy passwords&quot; to the users, or make them enter their
Windows passwords by hand. This is highly undesirable. Once they
logon into Windows, they must have (or not have) Web access
transparently.

If you know how to achieve SSO with Basic auth, please share.

-- 
Victor Sudakov,  VAS4-RIPE, VAS47-RIPN
sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sudakov at sibptus.tomsk.ru</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000132.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
	<LI>Next message (by thread): <A HREF="000138.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#137">[ date ]</a>
              <a href="thread.html#137">[ thread ]</a>
              <a href="subject.html#137">[ subject ]</a>
              <a href="author.html#137">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
