<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C20141007041659.GB51918%40admin.sibptus.tomsk.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000139.html">
   <LINK REL="Next"  HREF="000143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)</H1>
    <B>Victor Sudakov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C20141007041659.GB51918%40admin.sibptus.tomsk.ru%3E"
       TITLE="[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)">sudakov at sibptus.tomsk.ru
       </A><BR>
    <I>Tue Oct  7 04:16:59 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000139.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
        <LI>Next message (by thread): <A HREF="000143.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#142">[ date ]</a>
              <a href="thread.html#142">[ thread ]</a>
              <a href="subject.html#142">[ subject ]</a>
              <a href="author.html#142">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Amos Jeffries wrote:
&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; I have never used the helper provided by Samba, and I am not 
</I>&gt;<i> &gt;&gt;&gt; willing to start using it.
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; I don't want to install Samba on a proxy server, maintain a 
</I>&gt;<i> &gt;&gt;&gt; smb.conf and TDB databases there, join a domain, see hundreds
</I>&gt;<i> &gt;&gt;&gt; of winbindd processes etc.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; Thats the price of NTLM.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This price is too high for my objectives.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt;&gt; The ntlm_auth plugin has always been sufficient for my needs.
</I>&gt;<i> &gt;&gt;&gt; I hoped it would continue to be usable, but something is broken
</I>&gt;<i> &gt;&gt;&gt; in it.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; The Squid &quot;ntlm_auth&quot; helper (now ntlm_smb_lm_auth) does not,
</I>&gt;<i> &gt;&gt; and never has, performed NTLM in any way.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; What it does is this <A HREF="http://en.wikipedia.org/wiki/LM_hash.">http://en.wikipedia.org/wiki/LM_hash.</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I am perfectly aware of that. The problem is that this LM 
</I>&gt;<i> &gt; authentication did work with the squid27 ntlm_auth helper and does
</I>&gt;<i> &gt; not work with the squid34 newer ntlm_smb_lm_auth helper. There was
</I>&gt;<i> &gt; no need to break what was working.
</I>&gt;<i> 
</I>&gt;<i> SMB LM supports both ASCII and UNICODE. Each packet is explicitly
</I>&gt;<i> flagged as one or other. Apparently your client software wants to
</I>&gt;<i> authenticate using a character 171 out of an array of length 127.
</I>
Apparently so, but as I said, the very same client software does work
with the old &quot;ntlm_auth&quot; helper and does not work with the new
ntlm_smb_lm_auth one.

That's why I am saying that the problem is on the authenticator side
and not on the client side.


&gt;<i> &gt;&gt; The *Basic* authentication provided in HTTP is actually a
</I>&gt;<i> &gt;&gt; superior form of authentication. If you convert your proxy to
</I>&gt;<i> &gt;&gt; requesting Basic auth you will find your
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I am afraid you are mistaken. If I convert my proxy to Basic, it 
</I>&gt;<i> &gt; will start asking users for their login/password for proxy access, 
</I>&gt;<i> &gt; instead of authenticating them transparently with their Windows 
</I>&gt;<i> &gt; credentials.
</I>&gt;<i> 
</I>&gt;<i> That is a limitation of your software. Basic itself is superior to SMB
</I>&gt;<i> LM. 
</I>
I am not so sure about it. In Basic, you just base64 decode the
relevant HTTP header to obtain a plain text password. In LM,
it is a bit more difficult.

&gt;<i> You are just given no access to use it for SSO by the tools
</I>&gt;<i> currently in use.
</I>
All right, what tools are there for proxy SSO with Windows
credentials? Please specify.

[dd]

I will reply to the rest of the mail after I experiment if disabling
LM actutlly does enable Negotiate/Kerberos.


- -- 
Victor Sudakov,  VAS4-RIPE, VAS47-RIPN
sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sudakov at sibptus.tomsk.ru</A>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJUM2k6AAoJEA2k8lmbXsY0Y4IH/1KE7zea2njCKWCHp5wY0bsz
9QIW3ds0T+JCj9Fvfsdt+4cRAzGMu1ILnlC5FtosRz5Bi1sPBva3BRcBQRdilxfc
dmlL/XVmfs/F39iGKJnIM7Xy9gs2D5a7pBfvo+J6Ph3lxhbKEvDLQTET3IO9eF99
BH2La23Rk1+3rFyrL6eapt9/F3q2ndwspzqiKUcHeJFGRzfcuEzYto9YxJXWy1t1
eRi0Y9yVw+QiVlz6NxTShLg/TRGS+CPPhLFRTwSwqmeC+rtUzBNKyB7UqCUe/cM1
rkoGoaNzYPNkbJda8RW64pl2EYHDZANjAoAb+LoZBFfW7T3JBfNpzj1zEBSqDq4=
=7PmE
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000139.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
	<LI>Next message (by thread): <A HREF="000143.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#142">[ date ]</a>
              <a href="thread.html#142">[ thread ]</a>
              <a href="subject.html#142">[ subject ]</a>
              <a href="author.html#142">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
