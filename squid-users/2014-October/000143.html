<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C54336F8F.7020209%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000142.html">
   <LINK REL="Next"  HREF="000146.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntlmssp%3A%20bad%20ascii%3A%20ffffffab%20%28Lan%20Manager%20auth%0A%20broken%3F%29&In-Reply-To=%3C54336F8F.7020209%40treenet.co.nz%3E"
       TITLE="[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Oct  7 04:43:59 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000142.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
        <LI>Next message (by thread): <A HREF="000146.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#143">[ date ]</a>
              <a href="thread.html#143">[ thread ]</a>
              <a href="subject.html#143">[ subject ]</a>
              <a href="author.html#143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 7/10/2014 5:16 p.m., Victor Sudakov wrote:
&gt;<i> Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> I have never used the helper provided by Samba, and I am
</I>&gt;&gt;&gt;&gt;&gt;<i> not willing to start using it.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> I don't want to install Samba on a proxy server, maintain a
</I>&gt;&gt;&gt;&gt;&gt;<i>  smb.conf and TDB databases there, join a domain, see
</I>&gt;&gt;&gt;&gt;&gt;<i> hundreds of winbindd processes etc.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Thats the price of NTLM.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> This price is too high for my objectives.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> The ntlm_auth plugin has always been sufficient for my
</I>&gt;&gt;&gt;&gt;&gt;<i> needs. I hoped it would continue to be usable, but
</I>&gt;&gt;&gt;&gt;&gt;<i> something is broken in it.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> The Squid &quot;ntlm_auth&quot; helper (now ntlm_smb_lm_auth) does
</I>&gt;&gt;&gt;&gt;<i> not, and never has, performed NTLM in any way.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> What it does is this <A HREF="http://en.wikipedia.org/wiki/LM_hash.">http://en.wikipedia.org/wiki/LM_hash.</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I am perfectly aware of that. The problem is that this LM 
</I>&gt;&gt;&gt;<i> authentication did work with the squid27 ntlm_auth helper and
</I>&gt;&gt;&gt;<i> does not work with the squid34 newer ntlm_smb_lm_auth helper.
</I>&gt;&gt;&gt;<i> There was no need to break what was working.
</I>&gt;<i> 
</I>&gt;&gt;<i> SMB LM supports both ASCII and UNICODE. Each packet is
</I>&gt;&gt;<i> explicitly flagged as one or other. Apparently your client
</I>&gt;&gt;<i> software wants to authenticate using a character 171 out of an
</I>&gt;&gt;<i> array of length 127.
</I>&gt;<i> 
</I>&gt;<i> Apparently so, but as I said, the very same client software does
</I>&gt;<i> work with the old &quot;ntlm_auth&quot; helper and does not work with the
</I>&gt;<i> new ntlm_smb_lm_auth one.
</I>&gt;<i> 
</I>&gt;<i> That's why I am saying that the problem is on the authenticator
</I>&gt;<i> side and not on the client side.
</I>
The client is sending corrupt packets.

Old authenticator did not check for the corruption. New one does.

Client is still sending corrupt packets, which is why both the
developers have said the problem is in the client.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUM2+PAAoJELJo5wb/XPRjLbkH/09mdnl6r5Q2ZlPv3uwSjHZf
CAce2sHQYpKM3m7F3V8f4rLxhLz65Ive+nIXTFIkrdf+YWbCr8KRYnHIxWYpsbdz
oIEixxl1lFDnQJmiS8qQXDBDlwoXMNBU+ey3C2TarJt6R62oX+5ZBztVNZHGXycS
aA+I+2K4MHVZXKAS0g8tMecNcSgqB91Qfd3BA4+hybeHXPRbJr8gvZZ6v9vChWZq
BYCyGNDA4r7lEXqQx+YcZ/9BWsQaWBm/Smh4xlR1PD3YiIrLZ8WvK9o+Ldjz+nEC
iZG2VM9OHb9Nf52ZNU8Ofw+6CoM4reiQPydswFjqwnwWze7UEZQ0DUjiFvantm8=
=Uosz
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000142.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
	<LI>Next message (by thread): <A HREF="000146.html">[squid-users] ntlmssp: bad ascii: ffffffab (Lan Manager auth broken?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#143">[ date ]</a>
              <a href="thread.html#143">[ thread ]</a>
              <a href="subject.html#143">[ subject ]</a>
              <a href="author.html#143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
