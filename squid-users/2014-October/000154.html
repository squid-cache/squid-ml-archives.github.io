<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] https issues for google
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20issues%20for%20google&In-Reply-To=%3CBLU436-SMTP422B3B37D21D8B91465952CDA20%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000140.html">
   <LINK REL="Next"  HREF="000162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] https issues for google</H1>
    <B>CW</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20issues%20for%20google&In-Reply-To=%3CBLU436-SMTP422B3B37D21D8B91465952CDA20%40phx.gbl%3E"
       TITLE="[squid-users] https issues for google">crazyworld at outlook.com
       </A><BR>
    <I>Tue Oct  7 07:55:52 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000140.html">[squid-users] https issues for google
</A></li>
        <LI>Next message (by thread): <A HREF="000162.html">[squid-users] https issues for google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#154">[ date ]</a>
              <a href="thread.html#154">[ thread ]</a>
              <a href="subject.html#154">[ subject ]</a>
              <a href="author.html#154">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Either find the error from the log file or run tcpdump to capture the 
traffic to start with.

- CW
On 10/7/2014 11:51 AM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">glenn.groves at bradnams.com.au</A> wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> We have a weird issue where https sites apparently don't respond (get message &quot;this page can't be displayed&quot;). This mainly affects google websites and to a lesser affect youtube. It has been reported it may have affected some banking sites but this is unconfirmed. We are running centos 6.5 with up to date squid from the centos repositories.
</I>&gt;<i>
</I>&gt;<i> Here is the version of squid:
</I>&gt;<i> yum list installed | grep squid
</I>&gt;<i> squid.x86_64                         7:3.1.10-20.el6_5.3
</I>&gt;<i>
</I>&gt;<i> The https sites work fine if I put a direct hole in the firewall to allow internet traffic directly out - but this is not a solution.
</I>&gt;<i>
</I>&gt;<i> Thanks, Glenn
</I>&gt;<i>
</I>&gt;<i> Below is the conf file:
</I>&gt;<i>
</I>&gt;<i> ### /etc/squid/squid.conf Configuration File ####
</I>&gt;<i>
</I>&gt;<i> ### cache manager
</I>&gt;<i> cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">somone at email.com</A>
</I>&gt;<i>
</I>&gt;<i> ### negotiate kerberos and ntlm authentication
</I>&gt;<i> auth_param negotiate program /usr/local/bin/negotiate_wrapper -d --ntlm /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5-ntlmssp --domain=DOMAIN --kerberos /usr/lib64/squid/squid_kerb_auth -i -d -s HTTP/proxycen.email.com
</I>&gt;<i> auth_param negotiate children 50
</I>&gt;<i> auth_param negotiate keep_alive off
</I>&gt;<i>
</I>&gt;<i> ### pure ntlm authentication
</I>&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5-ntlmssp --domain=DOMAIN
</I>&gt;<i> auth_param ntlm children 200
</I>&gt;<i> # auth_param ntlm max_challenge_lifetime 5 minutes
</I>&gt;<i> auth_param ntlm keep_alive off
</I>&gt;<i>
</I>&gt;<i> ### provide basic authentication via ldap for clients not authenticated via kerberos/ntlm
</I>&gt;<i> auth_param basic program /usr/lib64/squid/squid_ldap_auth -R -b &quot;dc=DOMAIN,dc=com &quot; -D <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at email.com</A> -W /etc/squid/ldappass.txt -f sAMAccountName=%s -h SERVER.email.com
</I>&gt;<i> auth_param basic children 100
</I>&gt;<i> auth_param basic realm Internet Proxy
</I>&gt;<i> auth_param basic credentialsttl 1 minute
</I>&gt;<i>
</I>&gt;<i> ### ldap authorisation
</I>&gt;<i> # external_acl_type memberof children=300 %LOGIN /usr/lib64/squid/squid_ldap_group -R -K -b &quot;dc=DOMAIN,dc=com,dc=au&quot; -D <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at email.com</A> -W /etc/squid/ldappass.txt -f &quot;(&amp;(objectclass=person)(sAMAccountName=%v)(memberof=cn=%g, ou=Internet,ou=DOMAIN Groups,ou=DOMAIN,dc=DOMAIN,dc=com,dc=au))&quot; -h SERVER.email.com
</I>&gt;<i>
</I>&gt;<i> ### Squid Cache Manager
</I>&gt;<i> cachemgr_passwd none info
</I>&gt;<i>
</I>&gt;<i> cache_dir aufs /var/spool/squid 30000 16 256
</I>&gt;<i> minimum_object_size 2 KB
</I>&gt;<i> maximum_object_size 10 MB
</I>&gt;<i> cache_swap_low 95
</I>&gt;<i> cache_swap_high 97
</I>&gt;<i>
</I>&gt;<i> ### acl for proxy auth and ldap authorizations
</I>&gt;<i> acl SSL method CONNECT
</I>&gt;<i> acl allowedsites        dstdomain &quot;/etc/squid/allowedsites.txt&quot;
</I>&gt;<i> acl auth proxy_auth REQUIRED
</I>&gt;<i> #   aclname             acltype  typename activedirectorygroup
</I>&gt;<i> # acl BlockedAccess       external memberof &quot;/etc/squid/blocked_access.txt&quot;
</I>&gt;<i> # acl RestrictedAccess    external memberof &quot;/etc/squid/restricted_access.txt&quot;
</I>&gt;<i> # acl StandardAccess      external memberof &quot;/etc/squid/standard_access.txt&quot;
</I>&gt;<i> # acl ExceptionAccess     external memberof &quot;/etc/squid/exception_access.txt&quot;
</I>&gt;<i> # acl FullAccess          external memberof &quot;/etc/squid/full_access.txt&quot;
</I>&gt;<i> # acl AnonymousAccess     external memberof &quot;/etc/squid/anonymous_access.txt&quot;
</I>&gt;<i> # acl allowedsites        dstdomain &quot;/etc/squid/allowedsites.txt&quot;
</I>&gt;<i> # acl blockedsites        dstdomain &quot;/etc/squid/blockedsites.txt&quot;
</I>&gt;<i> # acl exceptedsites       dstdomain &quot;/etc/squid/exceptedsites.txt&quot;
</I>&gt;<i> acl prioritysites       dstdomain &quot;/etc/squid/prioritysites.txt&quot;
</I>&gt;<i>
</I>&gt;<i> ### squid defaults
</I>&gt;<i> acl manager proto cache_object
</I>&gt;<i> acl localhost src 127.0.0.1/32 ::1
</I>&gt;<i> acl allowedsite124 src 192.168.124.0/24
</I>&gt;<i> acl to_localhost dst 127.0.0.0/8 0.0.0.0/32 ::1
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i> acl Safe_ports port 70          # gopher
</I>&gt;<i> acl Safe_ports port 210         # wais
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> acl Safe_ports port 280         # http-mgmt
</I>&gt;<i> acl Safe_ports port 488         # gss-http
</I>&gt;<i> acl Safe_ports port 591         # filemaker
</I>&gt;<i> acl Safe_ports port 777         # multiling http
</I>&gt;<i> acl Safe_ports port 17500       # dropbox
</I>&gt;<i> #http_access deny CONNECT !SSL_ports
</I>&gt;<i> #http_access allow SSL_ports
</I>&gt;<i> http_access allow allowedsites
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> acl cacheadmin src 192.168.11.221 192.168.8.175
</I>&gt;<i> http_access allow manager localhost
</I>&gt;<i> http_access allow manager cacheadmin
</I>&gt;<i> http_access deny manager
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access allow localhost
</I>&gt;<i>
</I>&gt;<i> ### http_access rules
</I>&gt;<i> # allow unrestricted access to prioritysites
</I>&gt;<i> http_access allow prioritysites
</I>&gt;<i> # enforce authentication, order of rules is important for authorization levels
</I>&gt;<i> http_access allow allowedsite124
</I>&gt;<i> http_access deny !auth
</I>&gt;<i> # prevent access to basic auth prompt for BlockedAccess users
</I>&gt;<i> # http_access deny BlockedAccess all
</I>&gt;<i> # http_access allow allowedsites
</I>&gt;<i> # http_access deny RestrictedAccess all
</I>&gt;<i> # http_access allow AnonymousAccess auth
</I>&gt;<i> # http_access allow FullAccess auth
</I>&gt;<i> # http_access allow exceptedsites ExceptionAccess auth
</I>&gt;<i> # http_access deny blockedsites
</I>&gt;<i> # http_access allow StandardAccess auth
</I>&gt;<i> http_access allow auth
</I>&gt;<i> # http_access deny !auth
</I>&gt;<i> # DO NOT REMOVE THE FOLLOWING LINE
</I>&gt;<i> http_access deny all
</I>&gt;<i>
</I>&gt;<i> ### logging
</I>&gt;<i> access_log /var/log/squid/access.log squid
</I>&gt;<i>
</I>&gt;<i> ### Set memory manually, to allow it to use more of the system
</I>&gt;<i> cache_mem 1024 MB
</I>&gt;<i>
</I>&gt;<i> ### squid Debian defaults
</I>&gt;<i> http_port 8080
</I>&gt;<i> hierarchy_stoplist cgi-bin ?
</I>&gt;<i> coredump_dir /var/spool/squid
</I>&gt;<i> refresh_pattern ^ftp:           1440    20%     10080
</I>&gt;<i> refresh_pattern ^gopher:        1440    0%      1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
</I>&gt;<i> refresh_pattern .               0       20%     4320
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxycen</A> squid]#
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000140.html">[squid-users] https issues for google
</A></li>
	<LI>Next message (by thread): <A HREF="000162.html">[squid-users] https issues for google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#154">[ date ]</a>
              <a href="thread.html#154">[ thread ]</a>
              <a href="subject.html#154">[ subject ]</a>
              <a href="author.html#154">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
