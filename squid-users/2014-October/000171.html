<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid not liking dnscache for some hosts?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20not%20liking%20dnscache%20for%20some%20hosts%3F&In-Reply-To=%3C54341CDA.7060507%40trimble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000275.html">
   <LINK REL="Next"  HREF="000172.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid not liking dnscache for some hosts?</H1>
    <B>Jason Haar</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20not%20liking%20dnscache%20for%20some%20hosts%3F&In-Reply-To=%3C54341CDA.7060507%40trimble.com%3E"
       TITLE="[squid-users] squid not liking dnscache for some hosts?">Jason_Haar at trimble.com
       </A><BR>
    <I>Tue Oct  7 17:03:22 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000275.html">[squid-users] Fwd:  Problems with NTLM authentication
</A></li>
        <LI>Next message (by thread): <A HREF="000172.html">[squid-users] squid not liking dnscache for some hosts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#171">[ date ]</a>
              <a href="thread.html#171">[ thread ]</a>
              <a href="subject.html#171">[ subject ]</a>
              <a href="author.html#171">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there

We have CentOS-6 servers running the default squid-3.1.10 with dnscache
on 127.0.0.1 as the local dns server. It's been working fine but we've
just had reports that people couldn't reach urls on
dl.dropboxusercontent.com

On the proxy itself, &quot;nslookup dl.dropboxusercontent.com&quot; worked fine -
returning several IP addresses (just like google and all other Cloud
service providers do), but squid returns a 404 on any page in it
(X-Squid-Error: ERR_DNS_FAIL 0). It hangs and sniffing made me think it
was hanging on the DNS lookup part. I then edited /etc/resolv.conf and
pointed at some Microsoft DNS servers we have (which our dnscache just
forwards to anyway) and the problem was solved.

So it looks like dnscache doesn't like dl.dropboxusercontent.com, or
squid doesn't like how dnscache returns that data to it? All I know is
that this all works fine for everything else (ie we haven't had
complaints about any other sites with multiple IP addresses), and works
fine for dig/nslookup, but I can't for the life of me figure out what's
so different about this

Even the cachemgr cgi  &quot;IP Cache&quot; contains dl.dropboxusercontent.com
with only &quot;OK&quot; IP addresses  - even though squid returns &quot;X-Squid-Error:
ERR_DNS_FAIL 0&quot;. The only difference between it and other cached hosts
is that it hasn't got a &quot;H&quot; flag like the other hosts do? I even cranked
up debugging, but all that shows up is matching dropboxusercontent.com
against acl lists and NOT getting a match (as expected) - it doesn't
seem to show DNS debugging?

Any ideas? Thanks

-- 
Cheers

Jason Haar
Corporate Information Security Manager, Trimble Navigation Ltd.
Phone: +1 408 481 8171
PGP Fingerprint: 7A2E 0407 C9A6 CAF6 2B9F 8422 C063 5EBB FE1D 66D1


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000275.html">[squid-users] Fwd:  Problems with NTLM authentication
</A></li>
	<LI>Next message (by thread): <A HREF="000172.html">[squid-users] squid not liking dnscache for some hosts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#171">[ date ]</a>
              <a href="thread.html#171">[ thread ]</a>
              <a href="subject.html#171">[ subject ]</a>
              <a href="author.html#171">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
