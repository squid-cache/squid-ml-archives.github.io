<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] https issues for google
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20issues%20for%20google&In-Reply-To=%3C543769B8.0%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000219.html">
   <LINK REL="Next"  HREF="000221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] https issues for google</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20issues%20for%20google&In-Reply-To=%3C543769B8.0%40treenet.co.nz%3E"
       TITLE="[squid-users] https issues for google">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Oct 10 05:08:08 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000219.html">[squid-users] https issues for google
</A></li>
        <LI>Next message (by thread): <A HREF="000221.html">[squid-users] https issues for google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/10/2014 12:02 p.m., <A HREF="https://lists.squid-cache.org/listinfo/squid-users">glenn.groves at bradnams.com.au</A> wrote:
&gt;<i> I was able to capture the log at the time this happened to me, I
</I>&gt;<i> got the following in the access.log:
</I>&gt;<i> 
</I>&gt;<i> 1412895309.389     84 10.10.10.69 TCP_MISS/200 0 CONNECT
</I>&gt;<i> www.youtube.com:443 &lt;MYADUSER&gt; DIRECT/74.125.237.160 - 
</I>&gt;<i> 1412895311.770      0 10.10.10.69 TCP_DENIED/407 3983 CONNECT
</I>&gt;<i> www.youtube.com:443 - NONE/- text/html 1412895311.852     77
</I>&gt;<i> 10.10.10.69 TCP_MISS/200 0 CONNECT www.youtube.com:443 &lt;MYADUSER&gt;
</I>&gt;<i> DIRECT/74.125.237.160 - 1412895311.855      0 10.10.10.69
</I>&gt;<i> TCP_DENIED/407 3983 CONNECT www.youtube.com:443 - NONE/- text/html 
</I>&gt;<i> 1412895311.937     77 10.10.10.69 TCP_MISS/200 0 CONNECT
</I>&gt;<i> www.youtube.com:443 &lt;MYADUSER&gt; DIRECT/74.125.237.160 - 
</I>&gt;<i> 1412895311.941      0 10.10.10.69 TCP_DENIED/407 3983 CONNECT
</I>&gt;<i> www.youtube.com:443 - NONE/- text/html 1412895312.053    107
</I>&gt;<i> 10.10.10.69 TCP_MISS/200 0 CONNECT www.youtube.com:443 &lt;MYADUSER&gt;
</I>&gt;<i> DIRECT/74.125.237.160 - 1412895312.056      0 10.10.10.69
</I>&gt;<i> TCP_DENIED/407 3983 CONNECT www.youtube.com:443 - NONE/- text/html 
</I>&gt;<i> 1412895312.124     65 10.10.10.69 TCP_MISS/200 0 CONNECT
</I>&gt;<i> www.youtube.com:443 &lt;MYADUSER&gt; DIRECT/74.125.237.160 - 
</I>&gt;<i> 1412895312.680      0 10.10.10.69 TCP_DENIED/407 3983 CONNECT
</I>&gt;<i> www.youtube.com:443 - NONE/- text/html 1412895312.765     79
</I>&gt;<i> 10.10.10.69 TCP_MISS/200 0 CONNECT www.youtube.com:443 &lt;MYADUSER&gt;
</I>&gt;<i> DIRECT/74.125.237.160 - 1412895312.768      0 10.10.10.69
</I>&gt;<i> TCP_DENIED/407 3983 CONNECT www.youtube.com:443 - NONE/- text/html 
</I>&gt;<i> 1412895312.846     74 10.10.10.69 TCP_MISS/200 0 CONNECT
</I>&gt;<i> www.youtube.com:443 &lt;MYADUSER&gt; DIRECT/74.125.237.160 - 
</I>&gt;<i> 1412895312.851      0 10.10.10.69 TCP_DENIED/407 3983 CONNECT
</I>&gt;<i> www.youtube.com:443 - NONE/- text/html 1412895312.927     73
</I>&gt;<i> 10.10.10.69 TCP_MISS/200 0 CONNECT www.youtube.com:443 &lt;MYADUSER&gt;
</I>&gt;<i> DIRECT/74.125.237.160 - 1412895312.931      0 10.10.10.69
</I>&gt;<i> TCP_DENIED/407 3983 CONNECT www.youtube.com:443 - NONE/- text/html
</I>&gt;<i> 
</I>&gt;<i> Not sure why it would be saying TCP_MISS, I assume the TCP_DENIED
</I>&gt;<i> is expected as it happens after the TCP_MISS and has no
</I>&gt;<i> authentication information.
</I>&gt;<i> 
</I>

This looks like perfectly normal authentication working exactly as it
was designed to work.

Privacy and security requires that client/browsers only send users
credentials if they have to. So the client/browser is doing this:

 * open TCP connection
 * HTTP request (no authentication , hiding user credentials) -&gt; 407
challenge
 * retry HTTP request with authentication

The whole auth handshake sequence is happening in 50-100ms.


Being CONNECT tunnels the TCP connection is always closed after the
tunnel is done. Causing a new auth handshake for each CONNECT.

The MISS just means no cached object was used in the reply (CONNECT
not being cacheable). Thats is also normal, we only recently added the
TCP_TUNNEL label to separate tunnelled vs ssl-bumped CONNECT.
 The &quot;0&quot; in bytes column is result of logging bug on CONNECT byte
counting.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUN2m4AAoJELJo5wb/XPRjx0QH/02x2sHyh3O/S3RuEuyye9Bf
XKHWxwwhYdOa97wZ+dgRPBhl3ge1wqRYxBwDaFbnhh/R652w5j+sJtnXoS0OhD6Z
H0GxuXy7kiekBFEcTDpISKSwKgAmoGjNSEuFVT5vnchf6v3o7eaCTX1fgbpOBd+R
x0mp+HJew76eEOC2tihMpVkRLD6TGg76r3jDOe0y2rbhOqH7Hh1h/7SSST4jNZVw
pz3oflnnMR7h+pk2QIHdDn8Jy4Dmm5waGZHQ1NIyco3wbsm7nmbFMbt+hmf3EGfu
UQCYEuiqx5xh5cgBIrvG+C+lkYdh+CMVLb1xnu0hYGnS0ZikwbaKBnWVkF/I/ZM=
=F5F0
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000219.html">[squid-users] https issues for google
</A></li>
	<LI>Next message (by thread): <A HREF="000221.html">[squid-users] https issues for google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
