<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSL/SSH/SFTP/FTPS to alternate ports
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL/SSH/SFTP/FTPS%20to%20alternate%20ports&In-Reply-To=%3CBLU436-SMTP106B639CBABAB56039B29BACDAF0%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000254.html">
   <LINK REL="Next"  HREF="000257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSL/SSH/SFTP/FTPS to alternate ports</H1>
    <B>B</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL/SSH/SFTP/FTPS%20to%20alternate%20ports&In-Reply-To=%3CBLU436-SMTP106B639CBABAB56039B29BACDAF0%40phx.gbl%3E"
       TITLE="[squid-users] SSL/SSH/SFTP/FTPS to alternate ports">crazyworld at outlook.com
       </A><BR>
    <I>Sun Oct 12 03:37:13 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000254.html">[squid-users] SSL/SSH/SFTP/FTPS to alternate ports
</A></li>
        <LI>Next message (by thread): <A HREF="000257.html">[squid-users] SSL/SSH/SFTP/FTPS to alternate ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#255">[ date ]</a>
              <a href="thread.html#255">[ thread ]</a>
              <a href="subject.html#255">[ subject ]</a>
              <a href="author.html#255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>check out your access log seeing what it says. Sounds like you are 
looking for an AFW from squid. The ports themselves are defined. You 
need to make sure the other ports are opened.

Your rule tells squid to block the non-allowed sites to the non-allowed 
ports. Still sounds like FW function, but with the domain feature only.

-B
On 10/12/2014 7:48 AM, Timothy Spear wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Here is the issue:
</I>&gt;<i> I can proxy through Squid just fine to HTTP and HTTPS. I can also run 
</I>&gt;<i> SSH via Corkscrew to a SSH server running on port 443 and it works fine.
</I>&gt;<i> What I cannot do, is access HTTPS or SSH on any other port except 443. 
</I>&gt;<i> I have lost track of the number of things I have tried so any help 
</I>&gt;<i> will be appreciated and I feel like I am missing something simple.
</I>&gt;<i> OS: Ubuntu 14.04.1 LTS
</I>&gt;<i> Squid: 3.3.8-1ubuntu6.1
</I>&gt;<i>
</I>&gt;<i> Here is my current Squid 3 configuration:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> debug_optionsall,3
</I>&gt;<i>
</I>&gt;<i> # local network we proxy for
</I>&gt;<i> acllocalnet src10.110.98.0/24
</I>&gt;<i>
</I>&gt;<i> # what ports can be the desitnation
</I>&gt;<i> acl allowedPorts port 21
</I>&gt;<i> acl allowedPorts port 22
</I>&gt;<i> acl allowedPorts port 2222
</I>&gt;<i> acl allowedPorts port 80
</I>&gt;<i> acl allowedPorts port 443
</I>&gt;<i> acl allowedPorts port 8443
</I>&gt;<i>
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i>
</I>&gt;<i> # determine the available sites
</I>&gt;<i> acl allowedSites dstdomain &quot;/etc/squid3/allowed-sites.squid&quot;
</I>&gt;<i>
</I>&gt;<i> # now block anything not on the localnet or ports
</I>&gt;<i> http_access deny !localnet
</I>&gt;<i>
</I>&gt;<i> # allow connect only for approved ports
</I>&gt;<i> http_access deny CONNECT !allowedPorts
</I>&gt;<i>
</I>&gt;<i> # now only allow to the specific sites
</I>&gt;<i> http_access allow localnet allowedSites allowedPorts
</I>&gt;<i>
</I>&gt;<i> http_port3128
</I>&gt;<i> access_log /var/log/squid3/access.log squid
</I>&gt;<i> hosts_file /etc/hosts
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Background (just FYI):
</I>&gt;<i> I am trying to setup Squid to control network access from a local 
</I>&gt;<i> subnet to a select number of domains. I do not need to bump the 
</I>&gt;<i> encrypted traffic and play man in the middle, I just need to prevent 
</I>&gt;<i> the servers on the local network from accessing unauthorized networks. 
</I>&gt;<i> Yes, I know I can do this in the Firewall, but that is IP based and I 
</I>&gt;<i> am dealing with enough other companies that maintaining the IP list 
</I>&gt;<i> has become a major pain. Instead I want to use domains, which I can do 
</I>&gt;<i> in Squid.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Tim
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20141012/18386913/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20141012/18386913/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000254.html">[squid-users] SSL/SSH/SFTP/FTPS to alternate ports
</A></li>
	<LI>Next message (by thread): <A HREF="000257.html">[squid-users] SSL/SSH/SFTP/FTPS to alternate ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#255">[ date ]</a>
              <a href="thread.html#255">[ thread ]</a>
              <a href="subject.html#255">[ subject ]</a>
              <a href="author.html#255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
