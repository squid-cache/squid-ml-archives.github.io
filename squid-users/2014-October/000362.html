<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] peek and splice and splice()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20peek%20and%20splice%20and%20splice%28%29&In-Reply-To=%3Cb3e4d8ce69654684a44f6e7e3a4f6471%40HKNPR04MB0388.apcprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000389.html">
   <LINK REL="Next"  HREF="000364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] peek and splice and splice()</H1>
    <B>James Harper</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20peek%20and%20splice%20and%20splice%28%29&In-Reply-To=%3Cb3e4d8ce69654684a44f6e7e3a4f6471%40HKNPR04MB0388.apcprd04.prod.outlook.com%3E"
       TITLE="[squid-users] peek and splice and splice()">james at ejbdigital.com.au
       </A><BR>
    <I>Fri Oct 17 08:47:44 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000389.html">[squid-users] Question squid on centos 6.5 and poodle
</A></li>
        <LI>Next message (by thread): <A HREF="000364.html">[squid-users] peek and splice and splice()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#362">[ date ]</a>
              <a href="thread.html#362">[ thread ]</a>
              <a href="subject.html#362">[ subject ]</a>
              <a href="author.html#362">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Just reading up on this, the Feature page <A HREF="http://wiki.squid-cache.org/Features/SslPeekAndSplice">http://wiki.squid-cache.org/Features/SslPeekAndSplice</A> says:

&quot;... with Squid shoveling TCP bytes back and forth without any decryption&quot;

I can't see that squid actually uses the splice() system call, so that would mean squid would actually read the data into userspace then write it out again, is that right? I assume once this happens it's the same code as a CONNECT.

What if there was a way to actually splice the two TCP connections at the kernel level so that Squid didn't actually need to be involved anymore, except when the connection closes to do the accounting? There appear to be a few historic attempts to implement this in the Linux kernel but I suspect they haven't been maintained.

And would this be a worthwhile optimisation anyway or is shunting data not a significant part of squid load?

Just curious.

James


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000389.html">[squid-users] Question squid on centos 6.5 and poodle
</A></li>
	<LI>Next message (by thread): <A HREF="000364.html">[squid-users] peek and splice and splice()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#362">[ date ]</a>
              <a href="thread.html#362">[ thread ]</a>
              <a href="subject.html#362">[ subject ]</a>
              <a href="author.html#362">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
