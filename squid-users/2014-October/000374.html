<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ubuntu server 14.04 - Squid 3.3.8 - Active directory sync problem !
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%20server%2014.04%20-%20Squid%203.3.8%20-%20Active%0A%20directory%20sync%20problem%20%21&In-Reply-To=%3C5441AF2D.5040400%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000372.html">
   <LINK REL="Next"  HREF="000373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ubuntu server 14.04 - Squid 3.3.8 - Active directory sync problem !</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%20server%2014.04%20-%20Squid%203.3.8%20-%20Active%0A%20directory%20sync%20problem%20%21&In-Reply-To=%3C5441AF2D.5040400%40treenet.co.nz%3E"
       TITLE="[squid-users] Ubuntu server 14.04 - Squid 3.3.8 - Active directory sync problem !">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Oct 18 00:07:09 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000372.html">[squid-users] Ubuntu server 14.04 - Squid 3.3.8 - Active directory	sync problem !
</A></li>
        <LI>Next message (by thread): <A HREF="000373.html">[squid-users] Central Proxy using WCCP to multiple sites in our network with ASA box.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#374">[ date ]</a>
              <a href="thread.html#374">[ thread ]</a>
              <a href="subject.html#374">[ subject ]</a>
              <a href="author.html#374">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 18/10/2014 8:38 a.m., Yassin CHOUCHANE wrote:
&gt;<i> Hello all, I have installed an ubuntu 14.04 x64 with squid v3.3.8,
</I>&gt;<i> and i need to make sso with Windows microsoft active directory 2008
</I>&gt;<i> server r2.
</I>&gt;<i> 
</I>&lt;snip&gt;

&gt;<i> /var/log/squid/cache.log
</I>&gt;<i> 
</I>&gt;<i> 2014/10/13 19:15:52| ERROR: Negotiate Authentication validating
</I>&gt;<i> user. Error returned 'BH received type 1 NTLM token' 
</I>&gt;<i> negotiate_kerberos_auth.cc(315): pid=3418 :2014/10/13 19:15:52| 
</I>&gt;<i> negotiate_kerberos_auth: DEBUG: Got 'YR 
</I>&gt;<i> TlRMTVNTUAABAAAAl4II4gAAAAAAAAAAAAAAAAAAAAAGAbEdAAAADw==' from
</I>&gt;<i> squid (length: 59). negotiate_kerberos_auth.cc(378): pid=3418
</I>&gt;<i> :2014/10/13 19:15:52| negotiate_kerberos_auth: DEBUG: Decode 
</I>&gt;<i> 'TlRMTVNTUAABAAAAl4II4gAAAAAAAAAAAAAAAAAAAAAGAbEdAAAADw==' (decoded
</I>&gt;<i> length: 40). negotiate_kerberos_auth.cc(388): pid=3418 :2014/10/13
</I>&gt;<i> 19:15:52| negotiate_kerberos_auth: WARNING: received type 1 NTLM
</I>&gt;<i> token 2014/10/13 19:15:52| ERROR: Negotiate Authentication
</I>&gt;<i> validating user. Error returned 'BH received type 1 NTLM token'
</I>&gt;<i> 
</I>&gt;<i> can someone can help me to fix this problem please
</I>
As logged this is NTLM, not Kerberos.

Negotiate is a wrapper protocol around two &quot;flavours&quot; Negotiate/NTLM
and Negotiate/Kerberos. The client software has picked the wrong one
to use.
That usually means the problem is in the client software, in
particular how it is locating (or not) the keytab.

Some info about the client would be useful. In particular; what
software is it? what OS is it running on? does it try Kerberos or any
other login before that failed NTLM one?

NP: you could try the negotiate_wrapper helper to setup both Kerberos
and NTLM. But the best option is to get Kerberos working before going
there.

Amos

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUQa8tAAoJELJo5wb/XPRjtNwH/j7mlsugEc/mhsu8Xd031VBH
WOXzci+43dBbA5eJsJVIPQWHUT0KsyT6GyOzG2BW9EoGV5ONOcaWvMGI6DGEcFhy
V+1XZTW1zlWCL8NgPbduPxK/E+AhTWiZrFqOowjRHi4SsJfRFF6bnCvbB6zagJPM
haNsB0rt2GhieECUAOqIn0eZF4a25kuuld7r3FuNmHl4XDHy/AqFN7XNtBB0t1JN
VpMPs7tKMIkEwkZ8YAzWcPrn8mEBHVlMFtS1h4G4o/gKB5MF3WWGmlFyggw9phEs
zggGCkABnPW2nKyND0LB++cBvuaFsUcKtNpbNI2Y2Lyuuhl9YOgn5Z1Nu/G4zog=
=QkfN
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000372.html">[squid-users] Ubuntu server 14.04 - Squid 3.3.8 - Active directory	sync problem !
</A></li>
	<LI>Next message (by thread): <A HREF="000373.html">[squid-users] Central Proxy using WCCP to multiple sites in our network with ASA box.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#374">[ date ]</a>
              <a href="thread.html#374">[ thread ]</a>
              <a href="subject.html#374">[ subject ]</a>
              <a href="author.html#374">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
