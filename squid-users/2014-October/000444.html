<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 3.3.x -&gt; 3.4.x: huge performance regression
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.3.x%20-%3E%203.4.x%3A%20huge%20performance%20regression&In-Reply-To=%3C5448C7FB.1080104%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000441.html">
   <LINK REL="Next"  HREF="000454.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 3.3.x -&gt; 3.4.x: huge performance regression</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.3.x%20-%3E%203.4.x%3A%20huge%20performance%20regression&In-Reply-To=%3C5448C7FB.1080104%40ngtech.co.il%3E"
       TITLE="[squid-users] 3.3.x -&gt; 3.4.x: huge performance regression">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Oct 23 09:18:51 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000441.html">[squid-users] 3.3.x -&gt; 3.4.x: huge performance regression
</A></li>
        <LI>Next message (by thread): <A HREF="000454.html">[squid-users] OT: Re: 3.3.x -&gt; 3.4.x: huge performance regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#444">[ date ]</a>
              <a href="thread.html#444">[ thread ]</a>
              <a href="subject.html#444">[ subject ]</a>
              <a href="author.html#444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hey,

What is the network load? how many users?
Have you been using workers at all in the past?
Can you see the avg requests per second on the cache manager page?

Eliezer

On 10/22/2014 09:02 AM, Eugene M. Zheganin wrote:
&gt;<i> Hi.
</I>&gt;<i> 
</I>&gt;<i> I was using the 3.4.x branch for quite some time, it was working
</I>&gt;<i> just fine on small installations. Yesterday I upgraded my largest
</I>&gt;<i> cache installation from 3.3.13 to 3.4.8 (same config, diskd,
</I>&gt;<i> NTLM/GSS-SPNEGO auth helpers, external helpers). Today morning I
</I>&gt;<i> noticed that squid is spiking to 100% of CPU and almost isn't
</I>&gt;<i> serving any traffic. Restart didn't help, squid is serving pages 
</I>&gt;<i> while continuing to consume CPU, load grows, until it's at 100%,
</I>&gt;<i> and after some time my users are unable to open any page from
</I>&gt;<i> Internet. This is sad, so I downgraded to 3.3.13. CPU consumption
</I>&gt;<i> went back to 20-35% and everything is back to normal.
</I>&gt;<i> 
</I>&gt;<i> In order to understand what's happening I did some dtrace profiling
</I>&gt;<i> to see what is squid busy with, taking the consideration, that
</I>&gt;<i> measuring the same amount of connect()/socket() syscalls should
</I>&gt;<i> give same amount of squid work, but the results were totally
</I>&gt;<i> different on one number of such syscalls.
</I>&gt;<i> 
</I>&gt;<i> Anyone to comment ?
</I>&gt;<i> 
</I>&gt;<i> Thanks. Eugene. _______________________________________________ 
</I>&gt;<i> squid-users mailing list <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJUSMf7AAoJENxnfXtQ8ZQU/KwH/icRcMBoEA4Y8u3/inbnvSiT
CMPX6On9CO+RJeXlDGcAMfbYofZixB8zR5BuBTOsNS35moqCtHmlzZYtoGxkLGLx
RU6KKEhLGuGNyFCnyQx/oh9hcG90PSnaFnsp0m3vClcFtxv3kcdn944VS8hPtKWC
MQw7G8KzXwu7RmTaP5nk+EGNX3JAn8GlQaINX6G4zKeujqwrK954KORPMt0S53iQ
P7k6rq+ckPDgTIHuK4L+eMCka22y0z2FTo41jxSXK7J6w3GnWUsvwA22yYo6BV1h
+4DjvvtoJA3nNuFtXYxXCcBLMXcwk953o2uQKGkqOmlLGg660Bu9tCTBFAvaQsg=
=79iu
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000441.html">[squid-users] 3.3.x -&gt; 3.4.x: huge performance regression
</A></li>
	<LI>Next message (by thread): <A HREF="000454.html">[squid-users] OT: Re: 3.3.x -&gt; 3.4.x: huge performance regression
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#444">[ date ]</a>
              <a href="thread.html#444">[ thread ]</a>
              <a href="subject.html#444">[ subject ]</a>
              <a href="author.html#444">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
