<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] how to obtain info about actual active downloads?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20how%20to%20obtain%20info%20about%20actual%20active%20downloads%3F&In-Reply-To=%3C544E4977.3050705%40hanzlici.cz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000489.html">
   <LINK REL="Next"  HREF="000492.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] how to obtain info about actual active downloads?</H1>
    <B>Frantisek Hanzlik</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20how%20to%20obtain%20info%20about%20actual%20active%20downloads%3F&In-Reply-To=%3C544E4977.3050705%40hanzlici.cz%3E"
       TITLE="[squid-users] how to obtain info about actual active downloads?">franta at hanzlici.cz
       </A><BR>
    <I>Mon Oct 27 13:32:39 UTC 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000489.html">[squid-users] Delay Class 3 - Squid
</A></li>
        <LI>Next message (by thread): <A HREF="000492.html">[squid-users] how to obtain info about actual active downloads?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#491">[ date ]</a>
              <a href="thread.html#491">[ thread ]</a>
              <a href="subject.html#491">[ subject ]</a>
              <a href="author.html#491">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please, what is best way for determining who squid clients (their
PC IP addresses) have which downloads active?
I want it to determine which clients burden our slow internet line.
Examining 'access.log' does not help much in this case, because users
can download large files and it may take a few minutes or hours (e.g.
in case of consuming some audio/video streams).

I tried inspecting informations in 'Client-side Active Requests' menu
in cachemgr.cgi, where are paragraphs as:

Connection: 0x7f442037aa48
	FD 94, read 5892, wrote 148211583
	FD desc: Reading next request
	in: buf 0x7f440efc9150, offset 0, size 4096
	remote: 192.168.1.44:1631
	local: 192.168.1.254:3128
	nrequests: 7
uri <A HREF="http://ice.abradio.cz/prachen64.mp3">http://ice.abradio.cz/prachen64.mp3</A>
logType TCP_MISS
out.offset 148178800, out.size 148179207
req_sz 724
entry 0x7f440d5d6220/A1AD3A830E803B23F9295A9BCB9C1949
start 1414389495.929684 (18515.473233 seconds ago)
username
delay_pool 0

which seems to contain the necessary items and it would not be a big
problem adjust them to shorter form using e.g. awk or sed script,
and this informations is possible obtain in batch with some as:

wget -q -O - '<A HREF="http://localhost/Squid/cgi-bin/cachemgr.cgi?host=localhost&amp;port=3128&amp;user_name=&amp;operation=active_requests">http://localhost/Squid/cgi-bin/cachemgr.cgi?host=localhost&amp;port=3128&amp;user_name=&amp;operation=active_requests</A>'
or
lynx -dump '<A HREF="http://localhost/Squid/cgi-bin/cachemgr.cgi?host=localhost&amp;port=3128&amp;user_name=&amp;operation=active_requests">http://localhost/Squid/cgi-bin/cachemgr.cgi?host=localhost&amp;port=3128&amp;user_name=&amp;operation=active_requests</A>'

But is this the correct way? Or Squid offers other tools for this
case? Or is possible cachemgr.cgi supply/enwrap with some filter
which output needed info in some customized format?
We are using squid-3.3.13/Linux i686 now, it run on our LAN internet
router, LAN has approx. twenty PCs.

Thanks in advance, Franta Hanzlik


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000489.html">[squid-users] Delay Class 3 - Squid
</A></li>
	<LI>Next message (by thread): <A HREF="000492.html">[squid-users] how to obtain info about actual active downloads?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#491">[ date ]</a>
              <a href="thread.html#491">[ thread ]</a>
              <a href="subject.html#491">[ subject ]</a>
              <a href="author.html#491">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
