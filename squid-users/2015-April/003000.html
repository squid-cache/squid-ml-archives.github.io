<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Possible-Spam  a question about Dns lookup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Possible-Spam%20%20a%20question%20about%20Dns%20lookup&In-Reply-To=%3C5524A7CE.4080103%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002998.html">
   <LINK REL="Next"  HREF="003002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Possible-Spam  a question about Dns lookup</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Possible-Spam%20%20a%20question%20about%20Dns%20lookup&In-Reply-To=%3C5524A7CE.4080103%40treenet.co.nz%3E"
       TITLE="[squid-users] Possible-Spam  a question about Dns lookup">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Apr  8 04:00:14 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002998.html">[squid-users] Possible-Spam  a question about Dns lookup
</A></li>
        <LI>Next message (by thread): <A HREF="003002.html">[squid-users] Possible-Spam  a question about Dns lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3000">[ date ]</a>
              <a href="thread.html#3000">[ thread ]</a>
              <a href="subject.html#3000">[ subject ]</a>
              <a href="author.html#3000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/04/2015 3:21 a.m., johnzeng wrote:
&gt;<i> Hello Lawrence:
</I>&gt;<i> 
</I>&gt;<i>                           Thanks , Maybe  we must add
</I>&gt;<i> tcp_outgoing_address   at bridge mode + tproxy .
</I>&gt;<i> 
</I>&gt;<i>                           and Box can send dns request to internet via
</I>&gt;<i> the setting .
</I>&gt;<i> 
</I>&gt;<i>                           i feel accessing rate will be fast than
</I>&gt;<i> previous seting .
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>                           John
</I>
Bridging, TPROXY and tcp_outgoing_address are *alternative* features.

Bridging works with TPROXY, because TPOXY is all about using the client
IP and not the local device (bridge) IP. Since bridge devices do not
have an IP of their own to use in tcp_outgoing_address this works fine.

TPROXY works without bridging, because bridging is just a TCP-only layer
feature and Squid operates at HTTP layer.

tcp_outgoing_address does *not* work with TPROXY (or bridging), because
it is all about selecting which of the *Squid device* IPs are to be used
by the *routing* systems.


NP: You *can* use tcp_outgoing_address selection on traffic received in
a TPROXY port, but only if spoofing is disabled using the
spoof_client_ip directive.
(&lt;<A HREF="http://www.squid-cache.org/Doc/config/spoof_client_ip/">http://www.squid-cache.org/Doc/config/spoof_client_ip/</A>&gt;)


Running Squid (or any other loclahost software) on a bridge device needs
that device to *also* have some routing capability and IPs for use.
Squid DNS traffic will use the device IP as source address so packets
get back to *it* properly. This has nothing to do with the HTTP layer
bridging or TPROXY or tcp_outgoing_address behaviours.

This situation can make it appear as if strange things are going on if
you are thinking of the box as *only* a bridge - because its not a
bridge its a bridge+router.

HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002998.html">[squid-users] Possible-Spam  a question about Dns lookup
</A></li>
	<LI>Next message (by thread): <A HREF="003002.html">[squid-users] Possible-Spam  a question about Dns lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3000">[ date ]</a>
              <a href="thread.html#3000">[ thread ]</a>
              <a href="subject.html#3000">[ subject ]</a>
              <a href="author.html#3000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
