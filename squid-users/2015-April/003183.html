<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid HTTPs as reverse proxy problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20HTTPs%20as%20reverse%20proxy%20problem&In-Reply-To=%3C003c01d07bd0%24e53627d0%24afa27770%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003179.html">
   <LINK REL="Next"  HREF="003184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid HTTPs as reverse proxy problem</H1>
    <B>snakeeyes</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20HTTPs%20as%20reverse%20proxy%20problem&In-Reply-To=%3C003c01d07bd0%24e53627d0%24afa27770%24%40netstream.ps%3E"
       TITLE="[squid-users] squid HTTPs as reverse proxy problem">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Tue Apr 21 01:17:11 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003179.html">[squid-users] squid HTTPs as reverse proxy problem
</A></li>
        <LI>Next message (by thread): <A HREF="003184.html">[squid-users] squid HTTPs as reverse proxy problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3183">[ date ]</a>
              <a href="thread.html#3183">[ thread ]</a>
              <a href="subject.html#3183">[ subject ]</a>
              <a href="author.html#3183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thankx , I will tell u wt I did so far abd hope u help me in the directive squid needed :

Mkdir /etc/openvpn/
wget <A HREF="https://github.com/OpenVPN/easy-rsa-old/archive/master.zip">https://github.com/OpenVPN/easy-rsa-old/archive/master.zip</A>

unzip master

cd easy-rsa-old-master/

 

cp -R easy-rsa/ /etc/openvpn/

 

cd /etc/openvpn/easy-rsa/2.0

chmod 755 *

source ./vars

./vars

./clean-all

 

./build-ca

 

./build-key-server server

 

./build-dh

 

Now I have the files :

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squid</A> keys]# ls -l

total 76

-rw-r--r-- 1 root root 4120 Apr 20 17:51 01.pem

-rw-r--r-- 1 root root 4006 Apr 20 17:52 02.pem

-rw-r--r-- 1 root root 1383 Apr 20 17:51 ca.crt

-rw------- 1 root root  912 Apr 20 17:51 ca.key

-rw-r--r-- 1 root root  245 Apr 20 17:51 dh1024.pem

-rw-r--r-- 1 root root  276 Apr 20 17:52 index.txt

-rw-r--r-- 1 root root   21 Apr 20 17:52 index.txt.attr

-rw-r--r-- 1 root root   21 Apr 20 17:51 index.txt.attr.old

-rw-r--r-- 1 root root  136 Apr 20 17:51 index.txt.old

-rw-r--r-- 1 root root    3 Apr 20 17:52 serial

-rw-r--r-- 1 root root    3 Apr 20 17:51 serial.old

-rw-r--r-- 1 root root 4120 Apr 20 17:51 server.crt

-rw-r--r-- 1 root root  729 Apr 20 17:51 server.csr

-rw------- 1 root root  920 Apr 20 17:51 server.key

 

 

 

 

What do I need for squid directive ?

 

Is what I did above is okay ?

 

 

cheers

 

From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Yuri Voinov
Sent: Monday, April 20, 2015 6:22 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] squid HTTPs as reverse proxy problem

 


-----BEGIN PGP SIGNED MESSAGE----- 
Hash: SHA256 
 
Man,

self-signed sertificate required only for SSL Bump (not pump :)).

For SSL reverse proxy you need CA's signed server certificate.

Feel the difference.

21.04.15 5:16, snakeeyes &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi all , I need a help in
</I>
      setting up squid for https reverse proxy 



      &gt;



      &gt; I mean I want to  authorize the certificate on my pc so that

      be able to



      &gt; acces https using http not tunnel method



      &gt;



      &gt; I have searched a lot and most of docs mention ssl pump , but

      again im here



      &gt; don't want ssl pump feature and all I need is just reverse

      proxy.



      &gt;



      &gt;  



      &gt;



      &gt; Here is steps that I did :



      &gt;



      &gt; cd /etc/squid



      &gt;



      &gt;  



      &gt;



      &gt; openssl req -new -newkey rsa:1024 -days 3650 -nodes -x509

      -subj



      &gt; '/C=dsa/ST=asd/L=aaa/O=abcv/CN=abc' -keyout

      /etc/squid/abc.pem -out 



      &gt;



      &gt; /etc/squid/abc.pem



      &gt;



      &gt;  



      &gt;



      &gt; openssl x509 -in /etc/squid/abc.pem -outform DER -out

      /etc/squid/abc.der



      &gt;



      &gt;  



      &gt;



      &gt; whereis ssl_crtd



      &gt;



      &gt;  



      &gt;



      &gt; chown squid:squid /var/lib/ssl_db



      &gt;



      &gt;  



      &gt;



      &gt; after that  edited squid.conf with :



      &gt;



      &gt;  



      &gt;



      &gt; https_port 443 cert=/etc/squid/abc.pem key=/etc/squid/abc.pem



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt; then went to my browser and added abc.der as authorized

      certificates



      &gt;



      &gt;  



      &gt;



      &gt; when I connect to proxy I have erros logs :



      &gt;



      &gt;  



      &gt;



      &gt; 2015/04/20 15:44:18 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:44:19 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:44:21 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:44:23 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:45:33 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:45:33 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:47:01 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:53:44 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:53:46 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt; 2015/04/20 15:53:47 kid1| Error negotiating SSL connection on

      FD 11: Success



      &gt; (0)



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt; Where could be the problem ?



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt; Here is my squid config :



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt; squid -v



      &gt;



      &gt; Squid Cache: Version 3.5.1



      &gt;



      &gt; Service Name: squid



      &gt;



      &gt; configure options:  '--prefix=/usr' '--includedir=/include'



      &gt; '--mandir=/share/man' '--infodir=/share/info'

      '--sysconfdir=/etc'



      &gt; '--enable-cachemgr-hostname=drx' '--localstatedir=/var'



      &gt; '--libexecdir=/lib/squid' '--disable-maintainer-mode'



      &gt; '--disable-dependency-tracking' '--disable-silent-rules'

      '--srcdir=.'



      &gt; '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid'



      &gt; '--mandir=/usr/share/man' '--enable-inline'

      '--enable-async-io=8'



      &gt; '--enable-storeio=ufs,aufs,diskd,rock'

      '--enable-removal-policies=lru,heap'



      &gt; '--enable-delay-pools' '--enable-cache-digests'

      '--enable-underscores'



      &gt; '--enable-icap-client' '--enable-follow-x-forwarded-for'

      '--enable-auth'



      &gt;

'--enable-basic-auth-helpers=LDAP,MSNT,NCSA,PAM,SASL,SMB,YP,DB,POP3,getpwnam



      &gt; ,squid_radius_auth,multi-domain-NTLM'

      '--enable-ntlm-auth-helpers=smb_lm'



      &gt; '--enable-digest-auth-helpers=ldap,password'



      &gt; '--enable-negotiate-auth-helpers=squid_kerb_auth'

      '--enable-esi'



      &gt; '--disable-translation' '--with-logdir=/var/log/squid'



      &gt; '--with-pidfile=/var/run/squid.pid'

      '--with-filedescriptors=131072'



      &gt; '--with-large-files' '--with-default-user=squid'

      '--enable-linux-netfilter'



      &gt; '--enable-ltdl-convenience' '--enable-ssl'

      '--enable-ssl-crtd'



      &gt; '--enable-arp-acl' 'CXXFLAGS=-DMAXTCPLISTENPORTS=20000'

      '--with-openssl'



      &gt; '--enable-snmp'



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt; cheers



      &gt;



      &gt;



      &gt;



      &gt;



      &gt; _______________________________________________



      &gt; squid-users mailing list



      &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 



      &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

-----BEGIN PGP SIGNATURE----- 
Version: GnuPG v2 
 
iQEcBAEBCAAGBQJVNP1qAAoJENNXIZxhPexGA7QIAKGDJIOUiKxo0iemYhT2b+dz 
YEVjuOMcjOu643MzUpFNJEezD0spQrGk01Lrj9DLJrlTv6fH5CWEAJJcsy/ieyAV 
KN/SVxS6v98N5KitIhNGbeSO3OKMASJVvgaSi/MpTEl2snRUNaSSiJDKvu9oJqje 
fo19qw+Ce4tH1QjnvRX+v1IHYlBcqBroGnQAR/kNnW1QdC0kXWy2X/hv0eJ5Lmyd 
kSLtiSaOVl6qJ64S1UuQWL9mW8phPI/mYJBOZ3AGe535VO+15pXsFrsxfeIIF8ra 
DmV6cEKEtMVDikI8n9DvlRvJV/vFMmrtI2vqWgXE6HEjmr1WNiYDqkQVczYXeQk= 
=Pb8X 
-----END PGP SIGNATURE----- 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150420/f2b7321a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150420/f2b7321a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003179.html">[squid-users] squid HTTPs as reverse proxy problem
</A></li>
	<LI>Next message (by thread): <A HREF="003184.html">[squid-users] squid HTTPs as reverse proxy problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3183">[ date ]</a>
              <a href="thread.html#3183">[ thread ]</a>
              <a href="subject.html#3183">[ subject ]</a>
              <a href="author.html#3183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
