<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] transparent proxy original_dst err
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20original_dst%20err&In-Reply-To=%3C553630B4.2050007%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003196.html">
   <LINK REL="Next"  HREF="003199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] transparent proxy original_dst err</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20original_dst%20err&In-Reply-To=%3C553630B4.2050007%40gmail.com%3E"
       TITLE="[squid-users] transparent proxy original_dst err">yvoinov at gmail.com
       </A><BR>
    <I>Tue Apr 21 11:12:52 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003196.html">[squid-users] transparent proxy original_dst err
</A></li>
        <LI>Next message (by thread): <A HREF="003199.html">[squid-users] transparent proxy original_dst err
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3198">[ date ]</a>
              <a href="thread.html#3198">[ thread ]</a>
              <a href="subject.html#3198">[ subject ]</a>
              <a href="author.html#3198">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So, what?

What's the problem?

21.04.15 16:44, jaykbvt &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi,
</I>&gt;<i> My squid is configured in interception mode with
</I>&gt;<i>
</I>&gt;<i> http_port 3130
</I>&gt;<i> http_port 3129 intercept
</I>&gt;<i>
</I>&gt;<i> squid is running with single network card. request comes from the Cisco ISG
</I>&gt;<i> and internet is also allowed from the same Cisco ISG only.
</I>&gt;<i>
</I>&gt;<i> IPtables has been configured with following
</I>&gt;<i> squidip = 10.58.200.33
</I>&gt;<i> squid port = 3129
</I>&gt;<i> ====================
</I>&gt;<i> iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to
</I>&gt;<i> 10.58.200.33:3129
</I>&gt;<i> ====================
</I>&gt;<i>
</I>&gt;<i> Have also tried setting up config suggested at squid docs
</I>&gt;<i>
</I>&gt;<i> DNAT - <A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxDnat">http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxDnat</A>
</I>&gt;<i> Redirect -
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect">http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> But in all three setup I am getting
</I>&gt;<i>
</I>&gt;<i> I'm getting following entries in my access.log file...
</I>&gt;<i>
</I>&gt;<i> ==========================================================
</I>&gt;<i> 1429610951.208    309 10.210.83.249 TCP_MISS/503 3808 GET
</I>&gt;<i> <A HREF="http://www.wikipedia.org/">http://www.wikipedia.org/</A> - ORIGINAL_DST/10.58.200.33 text/html
</I>&gt;<i> 1429611003.025      5 10.210.83.249 TCP_MISS/503 3808 GET
</I>&gt;<i> <A HREF="http://www.wikipedia.org/">http://www.wikipedia.org/</A> - ORIGINAL_DST/10.58.200.33 text/html
</I>&gt;<i> 1429611620.888    306 10.210.83.249 TCP_MISS/503 3808 GET
</I>&gt;<i> <A HREF="http://www.wikipedia.org/">http://www.wikipedia.org/</A> - ORIGINAL_DST/10.58.200.33 text/html
</I>&gt;<i> 1429611625.952      4 10.210.83.249 TCP_MISS/503 3808 GET
</I>&gt;<i> <A HREF="http://www.wikipedia.org/">http://www.wikipedia.org/</A> - ORIGINAL_DST/10.58.200.33 text/html
</I>&gt;<i> ==========================================================
</I>&gt;<i>
</I>&gt;<i> Given bellow are entries in cache.log
</I>&gt;<i>
</I>&gt;<i> +++++++++++++++++++++++++++++++++++
</I>&gt;<i> 2015/04/21 15:50:20.576 kid1| client_side.cc(3412) httpAccept:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10 flags=33: accepted
</I>&gt;<i> 2015/04/21 15:50:20.576 kid1| client_side.cc(258) readSomeData:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10 flags=33: reading
</I>&gt;<i> request...
</I>&gt;<i> 2015/04/21 15:50:20.581 kid1| client_side.cc(2322) parseHttpRequest:
</I>&gt;<i> parseHttpRequest: req_hdr = {Host: www.wikipedia.org
</I>&gt;<i> User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:35.0) Gecko/20100101
</I>&gt;<i> Firefox/35.0
</I>&gt;<i> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</I>&gt;<i> Accept-Language: en-US,en;q=0.5
</I>&gt;<i> Accept-Encoding: gzip, deflate
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i> 2015/04/21 15:50:20.581 kid1| client_side.cc(2326) parseHttpRequest:
</I>&gt;<i> parseHttpRequest: end = {
</I>&gt;<i> }
</I>&gt;<i> 2015/04/21 15:50:20.581 kid1| client_side.cc(2330) parseHttpRequest:
</I>&gt;<i> parseHttpRequest: prefix_sz = 284, req_line_sz = 16
</I>&gt;<i> 2015/04/21 15:50:20.582 kid1| client_side.cc(925) clientSetKeepaliveFlag:
</I>&gt;<i> clientSetKeepaliveFlag: http_ver = 1.1
</I>&gt;<i> 2015/04/21 15:50:20.582 kid1| client_side.cc(927) clientSetKeepaliveFlag:
</I>&gt;<i> clientSetKeepaliveFlag: method = GET
</I>&gt;<i> 2015/04/21 15:50:20.582 kid1| client_side_request.cc(1691) doCallouts: Doing
</I>&gt;<i> calloutContext-&gt;hostHeaderVerify()
</I>&gt;<i> 2015/04/21 15:50:20.583 kid1| client_side.cc(258) readSomeData:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10 flags=33: reading
</I>&gt;<i> request...
</I>&gt;<i> 2015/04/21 15:50:20.884 kid1| client_side_request.cc(1698) doCallouts: Doing
</I>&gt;<i> calloutContext-&gt;clientAccessCheck()
</I>&gt;<i> 2015/04/21 15:50:20.884 kid1| AccessCheck.cc(32) Start: adaptation off,
</I>&gt;<i> skipping
</I>&gt;<i> 2015/04/21 15:50:20.884 kid1| client_side_request.cc(1727) doCallouts: Doing
</I>&gt;<i> calloutContext-&gt;clientAccessCheck2()
</I>&gt;<i> 2015/04/21 15:50:20.884 kid1| client_side_request.cc(1746) doCallouts: Doing
</I>&gt;<i> clientInterpretRequestHeaders()
</I>&gt;<i> 2015/04/21 15:50:20.885 kid1| client_side_request.cc(1835) doCallouts:
</I>&gt;<i> calling processRequest()
</I>&gt;<i> 2015/04/21 15:50:20.888 kid1| client_side.cc(1626) keepaliveNextRequest:
</I>&gt;<i> ConnnStateData(local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10
</I>&gt;<i> flags=33), Context(local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10
</I>&gt;<i> flags=33)
</I>&gt;<i> 2015/04/21 15:50:20.888 kid1| client_side_request.cc(265)
</I>&gt;<i> ~ClientHttpRequest: httpRequestFree: <A HREF="http://www.wikipedia.org/">http://www.wikipedia.org/</A>
</I>&gt;<i> 2015/04/21 15:50:20.888 kid1| client_side.cc(1696) keepaliveNextRequest:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10 flags=33: calling
</I>&gt;<i> conn-&gt;readNextRequest()
</I>&gt;<i> 2015/04/21 15:50:23.401 kid1| client_side.cc(2492) connFinishedWithConn:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 FD 10 flags=33 closed
</I>&gt;<i> 2015/04/21 15:50:23.401 kid1| client_side.cc(864) swanSong:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 flags=33
</I>&gt;<i> 2015/04/21 15:50:23.401 kid1| client_side.cc(4644) unpinConnection:
</I>&gt;<i> 2015/04/21 15:50:23.402 kid1| client_side.cc(895) ~ConnStateData:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3375 flags=33
</I>&gt;<i> 2015/04/21 15:50:25.945 kid1| client_side.cc(3412) httpAccept:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3378 FD 10 flags=33: accepted
</I>&gt;<i> 2015/04/21 15:50:25.946 kid1| client_side.cc(258) readSomeData:
</I>&gt;<i> local=10.58.200.33:80 remote=10.210.83.249:3378 FD 10 flags=33: reading
</I>&gt;<i> request...
</I>&gt;<i> 2015/04/21 15:50:25.947 kid1| client_side.cc(2322) parseHttpRequest:
</I>&gt;<i> parseHttpRequest: req_hdr = {Host: www.wikipedia.org
</I>&gt;<i> User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:35.0) Gecko/20100101
</I>&gt;<i> Firefox/35.0
</I>&gt;<i> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</I>&gt;<i> Accept-Language: en-US,en;q=0.5
</I>&gt;<i> Accept-Encoding: gzip, deflate
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i>
</I>&gt;<i> +++++++++++++++++++++++++++++++++++
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> any idea how to resolve this.
</I>&gt;<i>
</I>&gt;<i> Thanks &amp; Regards,
</I>&gt;<i> Jaykbvt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/transparent-proxy-original-dst-err-tp4670846.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/transparent-proxy-original-dst-err-tp4670846.html</A>
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003196.html">[squid-users] transparent proxy original_dst err
</A></li>
	<LI>Next message (by thread): <A HREF="003199.html">[squid-users] transparent proxy original_dst err
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3198">[ date ]</a>
              <a href="thread.html#3198">[ thread ]</a>
              <a href="subject.html#3198">[ subject ]</a>
              <a href="author.html#3198">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
