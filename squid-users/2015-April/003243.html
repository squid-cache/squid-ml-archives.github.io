<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Upgrade%20from%203.4.12%20to%203.5.3%20on%20FreeBSD%0A%2010.1%20broke%20Exchange%20RPC%20reverse%20proxy&In-Reply-To=%3C5539A638.1010100%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003239.html">
   <LINK REL="Next"  HREF="003248.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Upgrade%20from%203.4.12%20to%203.5.3%20on%20FreeBSD%0A%2010.1%20broke%20Exchange%20RPC%20reverse%20proxy&In-Reply-To=%3C5539A638.1010100%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Apr 24 02:11:04 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003239.html">[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy
</A></li>
        <LI>Next message (by thread): <A HREF="003248.html">[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3243">[ date ]</a>
              <a href="thread.html#3243">[ thread ]</a>
              <a href="subject.html#3243">[ subject ]</a>
              <a href="author.html#3243">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/04/2015 7:11 a.m., dweimer wrote:
&gt;<i> On 04/23/2015 9:24 am, dweimer wrote:
</I>&gt;&gt;<i> I upgraded our Reverse proxy from 3.4.12 to 3.5.3 via the FreeBSD
</I>&gt;&gt;<i> ports last night. It has broken our Outlook RPC over HTTPS. OWA and
</I>&gt;&gt;<i> Phones are still connecting with Active Sync, its just the RPC for
</I>&gt;&gt;<i> Outlook anywhere that is broken.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Did anyone else have any issues when upgrading from 3.4 branch to 3.5
</I>&gt;&gt;<i> branch with Outlook RPC?
</I>&gt;<i> 
</I>&gt;<i> In case anyone else is having an issue, I found the solution. Which also
</I>&gt;<i> solved a long standing issue with larger file uploads through
</I>&gt;<i> OWA/ActiveSync/RPC, that we were having. I had to force the cache peer
</I>&gt;<i> to use SSLv3 instead of TLSv1.0 by adding sslversion=3 to the cache peer
</I>&gt;<i> line.
</I>&gt;<i> 
</I>&gt;<i> cache_peer 1.1.1.1 parent 443 0 ssl no-query proxy-only no-digest
</I>&gt;<i> originserver name=exchange2010_parent sslflags=DONT_VERIFY_PEER
</I>&gt;<i> login=PASSTHRU front-end-https=on connection-auth=on sslversion=3
</I>&gt;<i> 
</I>&gt;<i> The HTTPS port line is still enforcing TLSv1.0 or newer, with restricted
</I>&gt;<i> ciphers.
</I>&gt;<i> 
</I>&gt;<i> https_port 1.1.1.2:443 accel cert=... key=...
</I>&gt;<i> options=NO_SSLv2:NO_SSLv3:CIPHER_SERVER_PREFERENCE
</I>&gt;<i> cipher=ALL:!aNULL:!eNULL:!LOW:!EXP:!ADH:+HIGH:+MEDIUM:!SSLv2:!RC4
</I>&gt;<i> 
</I>&gt;<i> 
</I>
Ouch. Good to know thank you.

FYI:
That workaround is one to keep an eye on. You may find the workaround
needs undoing at some point soonish.
 MS are officially in the process of releasing updates that remove and
disable SSLv3 support from their software. It began back in Oct/Nov 2014
and seems to be moving across the product range in a staged rollout with
each of the &quot;Patch Tueday&quot; so far (and probaly some future).

Amos



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003239.html">[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy
</A></li>
	<LI>Next message (by thread): <A HREF="003248.html">[squid-users] Squid Upgrade from 3.4.12 to 3.5.3 on FreeBSD 10.1 broke Exchange RPC reverse proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3243">[ date ]</a>
              <a href="thread.html#3243">[ thread ]</a>
              <a href="subject.html#3243">[ subject ]</a>
              <a href="author.html#3243">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
