<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid basic ntlm auth error after upgrade to 3.3.8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20basic%20ntlm%20auth%20error%20after%20upgrade%20to%203.3.8&In-Reply-To=%3CCA%2B-fCxAoix8yb_Qe%2BDmTzC7iWPBvLfR2wSSP-MLh7z%3Dg48t_4w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003302.html">
   <LINK REL="Next"  HREF="003308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid basic ntlm auth error after upgrade to 3.3.8</H1>
    <B>Lupick</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20basic%20ntlm%20auth%20error%20after%20upgrade%20to%203.3.8&In-Reply-To=%3CCA%2B-fCxAoix8yb_Qe%2BDmTzC7iWPBvLfR2wSSP-MLh7z%3Dg48t_4w%40mail.gmail.com%3E"
       TITLE="[squid-users] squid basic ntlm auth error after upgrade to 3.3.8">lupick at gmail.com
       </A><BR>
    <I>Tue Apr 28 08:46:31 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003302.html">[squid-users] Using Cache Digest in Squid Proxy
</A></li>
        <LI>Next message (by thread): <A HREF="003308.html">[squid-users] squid basic ntlm auth error after upgrade to 3.3.8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3299">[ date ]</a>
              <a href="thread.html#3299">[ thread ]</a>
              <a href="subject.html#3299">[ subject ]</a>
              <a href="author.html#3299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've found probably where is the problem but I don't know how to solve it.

If I try to connect with a PC outside the domain squid ntlm auth prompt for
username/password. On the password prompt banner I have the proxy ip
address; so the ntlm auth is used.
I can put my domain\username + password but it keep requesting the
password.

I've tried to comment out all the ntlm auth stuff in squid.conf; and I kept
only the basic.

Now the PC request to me the username\password but this time on the banner
I have &quot; Squid proxy-caching web server&quot;  so basic auth is used.  If I put
my domain\username + pwd all is working well.

So I assume the problem is due to ntlm auth doesn't fall back to basic but
it keeps requesting password.

Do you know how to force squid to fallback to basic auth if ntlm auth fail?
I remember in older version it was automatic.

Thank you for your help

L.

Il giorno gio 20 nov 2014 alle ore 16:54 Amos Jeffries [via Squid Web Proxy
Cache] &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ml-node+s1019090n4668485h22 at n4.nabble.com</A>&gt; ha scritto:

&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> On 21/11/2014 12:38 a.m., Lupick wrote:
</I>&gt;<i> &gt; Hi I've a problem authenticating users outside my AD domain after
</I>&gt;<i> &gt; the upgrade to squid 3.3.8.
</I>&gt;<i>
</I>&gt;<i> 3.3.8 is far from the latest Squid. There is information about where
</I>&gt;<i> to find updated packages for CentOS at
</I>&gt;<i> &lt;<A HREF="http://wiki.squid-cache.org/KnowledgeBase/CentOS">http://wiki.squid-cache.org/KnowledgeBase/CentOS</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; All the domain logged user are able to authenticate without any
</I>&gt;<i> &gt; issue.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The local user or user of a non domain computer have a
</I>&gt;<i> &gt; username/password prompt as expected.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If I provide the right doamin\username and password the promt
</I>&gt;<i> &gt; appear over and over.
</I>&gt;<i>
</I>&gt;<i> By &quot;right&quot; you mean the Basic or NTLM credentials?
</I>&gt;<i>
</I>&gt;<i> Which popup is the browser selecting to display?
</I>&gt;<i>  - the realm value configured in squid.conf is displayed as part of
</I>&gt;<i> the Basic auth popup, IIRC the proxy hostname or DOMAIN is listed in
</I>&gt;<i> teh NTLM popup. So you should be able to tell which its asking for.
</I>&gt;<i>
</I>&gt;<i> NTLM requires machines to be signed into the domain to get the correct
</I>&gt;<i> credentials crypto tokens from the DC to login with. Any attempt to
</I>&gt;<i> use NTLM credentials without being signed onto the domain will fail.
</I>&gt;<i>
</I>&gt;<i> Basic auth only requires the domain\user:password combo gets delivered.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; BUT after the first time if I click cancel qnd I retry i'm able to
</I>&gt;<i> &gt; browse internet.  This happen cause the credential provided  are
</I>&gt;<i> &gt; stored under the windows credentian manager in the control panel.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; no problem using centos 6 and squid 3.3.1, the problem appears
</I>&gt;<i> &gt; after an upgrade to centos 7 and squid 3.3.8.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; this is my section on squid.conf:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; auth_param ntlm program /usr/bin/ntlm_auth
</I>&gt;<i> &gt; --helper-protocol=squid-2.5-ntlmssp auth_param ntlm children 45
</I>&gt;<i> &gt; #auth_param ntlm max_challenge_reuses 0 #auth_param ntlm
</I>&gt;<i> &gt; max_challenge_lifetime 2 minutes
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; auth_param basic program /usr/bin/ntlm_auth
</I>&gt;<i> &gt; --helper-protocol=squid-2.5-basic auth_param basic children 5
</I>&gt;<i> &gt; auth_param basic realm Squid proxy-caching web server auth_param
</I>&gt;<i> &gt; basic credentialsttl 5 hours
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> PS. Have you considered migrating to Kerberos? it has a lot less
</I>&gt;<i> problems than NTLM.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v2.0.22 (MingW32)
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBAgAGBQJUbg6UAAoJELJo5wb/XPRjHzYIALBvTG3mVsl0QX0I1MzYdM2w
</I>&gt;<i> h9Cz2ShzpYEJWP+JcqeyQsp8xd8eWcxC8jsnibTat60belprPjcG7HLVVKHnKacT
</I>&gt;<i> jwQUQFId5B3KfuIad5MD887CxLwfujT3yoiBB2vFFki+bGWkkEDoOPzkcNY7TsUs
</I>&gt;<i> pSAqlynOpHNWH6UTahzG7L/xvxcHMTv8Wd2n1XxKFSGrdShwkWixLP1x3zA/CB3q
</I>&gt;<i> qckN8H5R/rOnMSBmWNCZ5VDFelPZTItXaxf4HmSbLw4XySxwLkthd8kHO9o/sv4E
</I>&gt;<i> SwiOihvxVMcXD/GPyG+bW9aXDN1p51aPX0SIisUuznuhh6vTTrhCJTqCDU1o9mM=
</I>&gt;<i> =pGgC
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4668485&amp;i=0">http:///user/SendEmail.jtp?type=node&amp;node=4668485&amp;i=0</A>&gt;
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>  If you reply to this email, your message will be added to the discussion
</I>&gt;<i> below:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/squid-basic-ntlm-auth-error-after-upgrade-to-3-3-8-tp4668477p4668485.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/squid-basic-ntlm-auth-error-after-upgrade-to-3-3-8-tp4668477p4668485.html</A>
</I>&gt;<i>  To unsubscribe from squid basic ntlm auth error after upgrade to 3.3.8, click
</I>&gt;<i> here
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4668477&amp;code=bHVwaWNrQGdtYWlsLmNvbXw0NjY4NDc3fC0xMjk5NDA0Njcx">http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4668477&amp;code=bHVwaWNrQGdtYWlsLmNvbXw0NjY4NDc3fC0xMjk5NDA0Njcx</A>&gt;
</I>&gt;<i> .
</I>&gt;<i> NAML
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml">http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml</A>&gt;
</I>&gt;<i>
</I>



--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/squid-basic-ntlm-auth-error-after-upgrade-to-3-3-8-tp4668477p4670949.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/squid-basic-ntlm-auth-error-after-upgrade-to-3-3-8-tp4668477p4670949.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003302.html">[squid-users] Using Cache Digest in Squid Proxy
</A></li>
	<LI>Next message (by thread): <A HREF="003308.html">[squid-users] squid basic ntlm auth error after upgrade to 3.3.8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3299">[ date ]</a>
              <a href="thread.html#3299">[ thread ]</a>
              <a href="subject.html#3299">[ subject ]</a>
              <a href="author.html#3299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
