<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Detecting clients flooding squid with failed request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Detecting%20clients%20flooding%20squid%20with%20failed%0A%20request&In-Reply-To=%3C55BF3C82.9060900%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004899.html">
   <LINK REL="Next"  HREF="004903.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Detecting clients flooding squid with failed request</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Detecting%20clients%20flooding%20squid%20with%20failed%0A%20request&In-Reply-To=%3C55BF3C82.9060900%40ngtech.co.il%3E"
       TITLE="[squid-users] Detecting clients flooding squid with failed request">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Aug  3 10:03:46 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004899.html">[squid-users] Detecting clients flooding squid with failed	request
</A></li>
        <LI>Next message (by thread): <A HREF="004903.html">[squid-users] Deny Caching of Video and Audio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4901">[ date ]</a>
              <a href="thread.html#4901">[ thread ]</a>
              <a href="subject.html#4901">[ subject ]</a>
              <a href="author.html#4901">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Dan,

It's pretty simple to write this rule since its a counted+pattern match 
and that's it nothing more.
If it fits your need you can add a send mail target instead of a &quot;ban&quot; one.

Eliezer

On 03/08/2015 10:25, Dan Charlesworth wrote:
&gt;<i> Thanks Antony.
</I>&gt;<i>
</I>&gt;<i> Fail2ban looks like a viable option though we would still need to write a regex definition to target this sort of behaviour. Their squid example targets aggressive hosts where my preference would be to target aggressive applications (that could be running on more than one host).
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/fail2ban/fail2ban/blob/master/config/filter.d/squid.conf">https://github.com/fail2ban/fail2ban/blob/master/config/filter.d/squid.conf</A>
</I>&gt;<i>
</I>&gt;<i> In my case &#8220;raise the alarm&#8221; would probably mean send an email to somebody and there are lots of ways to do that programmatically.
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004899.html">[squid-users] Detecting clients flooding squid with failed	request
</A></li>
	<LI>Next message (by thread): <A HREF="004903.html">[squid-users] Deny Caching of Video and Audio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4901">[ date ]</a>
              <a href="thread.html#4901">[ thread ]</a>
              <a href="subject.html#4901">[ subject ]</a>
              <a href="author.html#4901">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
