<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to have squid as safe as (e.g.) firefox?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20have%20squid%20as%20safe%20as%20%28e.g.%29%20firefox%3F&In-Reply-To=%3C475713687.3811682.1439414439152.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005015.html">
   <LINK REL="Next"  HREF="004988.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to have squid as safe as (e.g.) firefox?</H1>
    <B>Jeremie Rafin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20have%20squid%20as%20safe%20as%20%28e.g.%29%20firefox%3F&In-Reply-To=%3C475713687.3811682.1439414439152.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[squid-users] How to have squid as safe as (e.g.) firefox?">rafinjer-squid at yahoo.fr
       </A><BR>
    <I>Wed Aug 12 21:20:39 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005015.html">[squid-users] Squid 3.5 Forward Secrecy on https_port
</A></li>
        <LI>Next message (by thread): <A HREF="004988.html">[squid-users] How to have squid as safe as (e.g.) firefox?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4987">[ date ]</a>
              <a href="thread.html#4987">[ thread ]</a>
              <a href="subject.html#4987">[ subject ]</a>
              <a href="author.html#4987">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

If I browse on the internet **without** a proxy like squid, and if I use a browser like firefox, the certificate management of SSL connections looks, as far as I feel it, safe and secure.

One of my favorite web pages to test this is: <A HREF="https://revoked.grc.com/">https://revoked.grc.com/</A>
Going on this site must generate an error such as a &quot;revoked certificate&quot; reject.

But, if I browse with squid &quot;behind&quot;, configured with SSL bumping and host certificate generation (in such a way my proxy works well for https), this site (<A HREF="https://revoked.grc.com/">https://revoked.grc.com/</A>) is **not** filtered. Which is, to my eye, a big security hole...

Questions (I am searching for answers for several months, without success):

-while using squid, is it possible to have a SSL/HTTPS level of security at least as high as with a reference like firefox (assuming this is a reference; in my humble opinion, regarding certificate management, it is, as I don't know better)?

-do you know any implementation of NSS library (the security library of firefox, probably safer than openssl) for certificate checking helper (cf. sslcrtvalidator_program)?

-how to manage certificate lists, especially automatic updates of them (e.g. use of OSCP inside squid helpers)? Could we access to tweaks like maximum acceptable age of certificate validity, white and black lists of trust authorities, exclusion of autosigned certificate, etc?

Thanks for any help, any suggestion!
J&#233;r&#233;mie


PS1: some of test web pages, for which, to my mind, security fails with squid:
-<A HREF="https://revoked.grc.com">https://revoked.grc.com</A> (my &quot;favorite&quot;; must fail browsing)
-<A HREF="https://www.ssllabs.com/ssltest/viewMyClient.html">https://www.ssllabs.com/ssltest/viewMyClient.html</A> (to get a big picture, especially if OCSP stapling is active)
-<A HREF="https://www.howsmyssl.com/">https://www.howsmyssl.com/</A> (not as good as previous; provides another point of view)

PS2: my squid 3.5 works on a debian wheezy 7.6; here is my squid.conf (only my adds in top of the default file content); so far I try to have transparent (implicit) proxy but explicit proxy is not better (only simpler configuration):

# SSL bumping configuration
http_port 3126 intercept
https_port 3127 intercept ssl-bump generate-host-certificates=on dynamic_cert_mem_cache_size=4MB cert=/etc/squid/ssl_cert/myCA.pem
sslcrtd_program /usr/local/squid-3.5/lib/squid/ssl_crtd -s /var/spool/squid3_ssldb -M 4MB

# SSL Options - to mimic firefox; some of keys are weaks but some of my favorite websites need them :(
sslproxy_options NO_SSLv2,No_Compression
sslproxy_cipher ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:ECDHE-RSA-RC4-SHA:ECDHE-ECDSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-RC4-SHA:DHE-RSA-AES256-SHA:AES256-SHA:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA:AES128-SHA:DES-CBC3-SHA:RC4-SHA:RC4-MD5:!aNULL:!eNULL:!EXPORT:!DSS:!DES:!3DES:!PSK
sslproxy_cert_error deny all

# Splice access lists
acl splice_client src 192.168.2.30
acl splice_domain dstdomain .paypal.com
acl splice_dst dst 66.211.169.66 66.211.169.3

# HTTPS access
ssl_bump splice splice_client
ssl_bump splice splice_domain
ssl_bump splice splice_dst
ssl_bump server-first all

# Hide PROXY
via off
forwarded_for delete

# Cache management
cache_dir ufs /var/cache/squid 500 16 256

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005015.html">[squid-users] Squid 3.5 Forward Secrecy on https_port
</A></li>
	<LI>Next message (by thread): <A HREF="004988.html">[squid-users] How to have squid as safe as (e.g.) firefox?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4987">[ date ]</a>
              <a href="thread.html#4987">[ thread ]</a>
              <a href="subject.html#4987">[ subject ]</a>
              <a href="author.html#4987">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
