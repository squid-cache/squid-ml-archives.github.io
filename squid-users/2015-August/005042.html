<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid + oracle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20oracle&In-Reply-To=%3C55D32E38.7020905%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005078.html">
   <LINK REL="Next"  HREF="005045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid + oracle</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20oracle&In-Reply-To=%3C55D32E38.7020905%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid + oracle">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Aug 18 13:08:08 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005078.html">[squid-users] Squid + oracle
</A></li>
        <LI>Next message (by thread): <A HREF="005045.html">[squid-users] Squid + oracle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5042">[ date ]</a>
              <a href="thread.html#5042">[ thread ]</a>
              <a href="subject.html#5042">[ subject ]</a>
              <a href="author.html#5042">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/08/2015 12:15 a.m., Eliezer Croitoru wrote:
&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i> Currently I do not know of such a helper but it is possible to write one.
</I>
You surprise me Eliezer. Thought you had been around long enough to be
aware of these SQL database helpers:

&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/basic_db_auth.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/basic_db_auth.html</A>&gt; and
&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_sql_session_acl.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_sql_session_acl.html</A>&gt;

(and for completeness)
&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/log_db_daemon.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/log_db_daemon.html</A>&gt;

Any database that the Perl DBI module can connect to can be used as a
backend to these helpers.


&gt;<i> 
</I>&gt;<i> On 18/08/2015 14:58, adricustodio wrote:
</I>&gt;&gt;<i> Hello guys.
</I>&gt;&gt;<i> I got a few questions.
</I>&gt;&gt;<i> I need to authenticate my squid on my oracle database, is that possible ?
</I>
Assuming you mean an actual SQL database such as Oracles' MySQL product
then the answer is yes.

Some other types of database such as BerkleyDB, ActiveDirectory,
eDirectory, RADIUS, or some flat file formats are also supported in
various ways.

Then there is always the possibility of writing your own helper like
Eliezer mentioned. Thats why we call them add-on helpers.


&gt;&gt;<i> if its possible, i can do like a captive portal ? like a hotspot for
</I>&gt;&gt;<i> that ?
</I>
No.

The problem is simple: Would you hand your credit card and pin number to
any stranger that walked up and asked you for them ?
Similarly browsers refuse to hand over authentication credentials to any
MITM proxy that suddenly appears and demands credentials.


Like Eliezer mentioned, captive portals must use only _authorization_.

You redirect non-authorized traffic to a &quot;login&quot; page and have a DB
record created for clients that successfully completion of some task
there such as filing out a &quot;login&quot; form. Be aware that has nothing to do
with HTTP authentication though.

Squid comes with two helpers designed for captive portals :

* ext_sql_session_acl uses a SQL database to check some detail like
client IP, MAC address, or some combo with user-agent against records
stored there (ie by your portals &quot;login&quot; form).

* ext_session_acl in &quot;ACTIVE&quot; mode uses clicking on a link to access a
particular activation URL to create its database records. But that
helper maintains its own built-in database.


IMPORTANT: Be careful that the traffic you redirect to your captive
portal page is an HTML GET request by a browser; not a background tool
update, PUT / POST / CONNECT method, browser images/video fetches, etc.


&gt;&gt;<i> The last question is... can i drop the connection of a user on squid
</I>&gt;&gt;<i> after X
</I>&gt;&gt;<i> minutes ?
</I>
No. That is not possible. A) there is no &quot;user&quot;, B) only idle
connections can be closed arbitrarily, and C) HTTP is message-based not
connection-based.

(C) means that its entirely reasonable for a client to be redirected to
your portal login page for one request. Then make another request on the
same connection after portal login has succeeded. The second request
should be accepted.


&gt;&gt;<i> For example, every 5 minutes connected the user need to authenticate
</I>&gt;&gt;<i> again ?
</I>
That is completely unrelated to TCP connections being open or closed.

In captive potal scenarios it is a session timeout. How you configure it
depends on the session helper being used. But make sure the
external_acl_type ttl= parameter is small enough for the timeout to
happen properly, since the timeout can ony reach the helepr on a
multiple of the ttl=N seconds.

With ext_sql_session_acl helper the DB records are maintained separately
in any way you like. You can set a job going that removed DB records
after a timeout. Or have the helper SQL query check a session creation
timestamp in the record is no more than X.

With ext_session_acl you set a timeout (-T) value and sessions are
closed at that time since being opened. You can also set an idle timout.

With a self-written custom helper you do it however you like.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005078.html">[squid-users] Squid + oracle
</A></li>
	<LI>Next message (by thread): <A HREF="005045.html">[squid-users] Squid + oracle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5042">[ date ]</a>
              <a href="thread.html#5042">[ thread ]</a>
              <a href="subject.html#5042">[ subject ]</a>
              <a href="author.html#5042">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
