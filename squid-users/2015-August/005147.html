<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.7%2C%20cache_swap_high%2C%20bug%20or%20not%20bug%20%3F&In-Reply-To=%3C55DAF5DD.7060406%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005146.html">
   <LINK REL="Next"  HREF="005151.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.7%2C%20cache_swap_high%2C%20bug%20or%20not%20bug%20%3F&In-Reply-To=%3C55DAF5DD.7060406%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Aug 24 10:45:49 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005146.html">[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?
</A></li>
        <LI>Next message (by thread): <A HREF="005151.html">[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5147">[ date ]</a>
              <a href="thread.html#5147">[ thread ]</a>
              <a href="subject.html#5147">[ subject ]</a>
              <a href="author.html#5147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/08/2015 9:23 p.m., FredT wrote:
&gt;<i> Hi Amos,
</I>&gt;<i> Since the patch, the Percent Used is decreasing correctly, no new 100% at
</I>&gt;<i> the moment.
</I>
Oh well. Good signs at least for current needs.

If you are open to the experiment
&lt;<A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=2448">http://bugs.squid-cache.org/show_bug.cgi?id=2448</A>&gt; indicates a good way
to force the over-100% issue to happen on demand. Just cut a GB off the
current cache-used size and reconfigure. (I do fully understand not
wanting to see the effects of that in a production machine. So your choice.)

This patch will make that bugs issue more visible since it will outright
pause all service while the resize happens. Rather than just slowing
things down randomly as it grabs CPU cycles between traffic I/O.
 But clear predictable situation is better anyway. So is acceptable if
pause is the only bad side effect.


&gt;<i> 
</I>&gt;<i> Why not using the Req/min as the value to use in the cleaning when the
</I>&gt;<i> cache_swap_low/high are reached ?
</I>&gt;<i> ex: Average HTTP requests per minute since start:   19232.8
</I>&gt;<i> Btw, when the cache_swap_low is reached, the squid could use 25% of the
</I>&gt;<i> req/min for the cleaning and with the cache_swap_high the squid could use
</I>&gt;<i> 100%.
</I>&gt;<i> This is an example, there are tons of data in the squid we could use 
</I>
That is what I hope for long-term. But the value you see in those
reports is not a narrow point value. It is an average over the entire
uptime of the Squid. Calculating it requires clock lookups and a
histogram of past data. A bit too complex for this loop which runs every
single second.

We simply dont have any nice metric yet that says &quot;done N requests in
the past 1 second&quot;. There are a few things in Squid that could make good
use of it :-).


&gt;<i> 
</I>&gt;<i> Or, we could have special options to define by ourselves the number of
</I>&gt;<i> objects to clean, example:
</I>&gt;<i> - cache_swap_low_del_object 256
</I>&gt;<i> - cache_swap_high_del_object 1024
</I>&gt;<i> 
</I>
I have been considering both, and some others and the TODO is getting a
bit longer.

But its unlikely to happen in the coming weekends release. So far just
the two bug fixes, and rate increase.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005146.html">[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?
</A></li>
	<LI>Next message (by thread): <A HREF="005151.html">[squid-users] Squid 3.5.7, cache_swap_high, bug or not bug ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5147">[ date ]</a>
              <a href="thread.html#5147">[ thread ]</a>
              <a href="subject.html#5147">[ subject ]</a>
              <a href="author.html#5147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
