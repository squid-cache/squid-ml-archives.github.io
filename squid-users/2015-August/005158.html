<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Cache Permission Errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cache%20Permission%20Errors&In-Reply-To=%3COF59591ABA.FA2C0544-ONCC257EAB.007720DA-CC257EAB.00772F59%40nab.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005157.html">
   <LINK REL="Next"  HREF="005159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Cache Permission Errors</H1>
    <B>Kuntal_Basak at bnz.co.nz</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cache%20Permission%20Errors&In-Reply-To=%3COF59591ABA.FA2C0544-ONCC257EAB.007720DA-CC257EAB.00772F59%40nab.com.au%3E"
       TITLE="[squid-users] Cache Permission Errors">Kuntal_Basak at bnz.co.nz
       </A><BR>
    <I>Mon Aug 24 21:41:49 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005157.html">[squid-users] Cache Permission Errors
</A></li>
        <LI>Next message (by thread): <A HREF="005159.html">[squid-users] Cache Permission Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5158">[ date ]</a>
              <a href="thread.html#5158">[ thread ]</a>
              <a href="subject.html#5158">[ subject ]</a>
              <a href="author.html#5158">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Could you please un-subscribe me ?

Cheers,

Kuntal
Senior Infrastructure Architecture and Design Specialist
Infrastructure Architecture and Design
Bank of New Zealand

DDI: 04-474 6722
Mobile: 021-2408034 

?Success is not final, failure is not fatal: it is the courage to continue 
that counts.? - Winston Churchill 



From:   JL &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">zimurgy at gmail.com</A>&gt;
To:     Xen &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">xen at dds.nl</A>&gt;, 
Cc:     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Date:   25/08/2015 05:02 a.m.
Subject:        Re: [squid-users] Cache Permission Errors
Sent by:        &quot;squid-users&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;



Hi Xen,

Thanks for the feedback. I can confirm both the --with-default-user=squid 
is present in squid -v and the perms of the logs are indeed squid user.

Regards,
Zim

On Mon, Aug 24, 2015 at 12:47 PM, Xen &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">xen at dds.nl</A>&gt; wrote:
Are you terribly certain the owner:group of the generated log files is the 
same as those of the cache dirs?.

That is a way to check for sure what user it is running under. I was just 
compiling the latest 3.5.x when it would complain, and I had forgotten to 
compile it with --with-default-user=squid.



On 08/24/2015 04:05 PM, JL wrote:
Hi, 

Sorry if this is a duplicate message, I am not sure it went through 
initially. I am having an issue with my caching drives that I can't seem 
to pinpoint the problem. I have 4 drives to be used for caching, they are 
ext3 filesystems mounted like so. I am running CentOS 7.

/dev/sde1 on /var/spool/squid4 type ext3 
(rw,noatime,seclabel,data=ordered)
/dev/sdd1 on /var/spool/squid3 type ext3 
(rw,noatime,seclabel,data=ordered)
/dev/sdc1 on /var/spool/squid2 type ext3 
(rw,noatime,seclabel,data=ordered)
/dev/sdb1 on /var/spool/squid1 type ext3 
(rw,noatime,seclabel,data=ordered)

I set the cache user to be squid in the squid.conf and I reference the 
drives for caching.

cache_dir aufs /var/spool/squid1 460800 32 512
cache_dir aufs /var/spool/squid2 460800 32 512
cache_dir aufs /var/spool/squid3 460800 32 512
cache_dir aufs /var/spool/squid4 460800 32 512

ls -l of the /var/spool shows proper perms, they are propagated.

drwxr-x---. 34 squid squid 4096 Aug 21 10:01 squid1
drwxr-x---. 34 squid squid 4096 Aug 21 10:01 squid2
drwxr-x---. 34 squid squid 4096 Aug 21 10:01 squid3
drwxr-x---. 34 squid squid 4096 Aug 21 10:01 squid4

The cache dirs were successfully created using squid -z and all of the 
subfolders were generated. Squid starts and everything appears to be 
great. Until I monitor the cache.log, then I see the errors begin.

Some like this.

2015/08/16 03:41:55 kid1| /var/spool/squid1/cache/19/8B: (13) Permission 
denied
2015/08/16 03:42:10 kid1| /var/spool/squid2/cache/19/8B: (13) Permission 
denied
2015/08/16 03:42:25 kid1| /var/spool/squid3/cache/19/8B: (13) Permission 
denied
2015/08/16 03:42:40 kid1| /var/spool/squid4/cache/19/8B: (13) Permission 
denied
2015/08/16 03:42:55 kid1| /var/spool/squid1/cache/1A/8B: (13) Permission 
denied
2015/08/16 03:43:10 kid1| /var/spool/squid2/cache/1A/8B: (13) Permission 
denied
2015/08/16 03:43:25 kid1| /var/spool/squid3/cache/1A/8B: (13) Permission 
denied
2015/08/16 03:43:40 kid1| /var/spool/squid4/cache/1A/8B: (13) Permission 
denied
2015/08/16 03:43:55 kid1| /var/spool/squid1/cache/1B/8B: (13) Permission 
denied

Some like this.

2015/08/21 10:02:13 kid1| /var/spool/squid2/17/1FF: (13) Permission denied
2015/08/21 10:02:13 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:13 kid1| /var/spool/squid4/00/00/00000000
2015/08/21 10:02:28 kid1| /var/spool/squid3/17/1FF: (13) Permission denied
2015/08/21 10:02:32 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:32 kid1| /var/spool/squid4/00/00/00000001
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000002
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000003
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000004
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000005
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000006
2015/08/21 10:02:33 kid1| DiskThreadsDiskFile::openDone: (13) Permission 
denied
2015/08/21 10:02:33 kid1| /var/spool/squid4/00/00/00000007

The folders remain empty of course, so no caching is taking place.

I am truly stumped as to what I may be doing wrong since squid has enough 
perms to create the dirs but not enough to save to them.

Any help would be great.

Thanks!
Zim


_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>



_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


CAUTION - This message may contain privileged and confidential information
intended only for the use of the addressee named above. If you are not the
intended recipient of this message you are hereby notified that any use,
dissemination, distribution or reproduction of this message is prohibited.
This email was sent by the Bank of New Zealand. You can contact us on
0800 ASK BNZ (0800 275 269). Any views expressed in this message are those
of the individual sender and may not necessarily reflect the views of Bank
of New Zealand.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150825/23aa26a8/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150825/23aa26a8/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005157.html">[squid-users] Cache Permission Errors
</A></li>
	<LI>Next message (by thread): <A HREF="005159.html">[squid-users] Cache Permission Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5158">[ date ]</a>
              <a href="thread.html#5158">[ thread ]</a>
              <a href="subject.html#5158">[ subject ]</a>
              <a href="author.html#5158">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
