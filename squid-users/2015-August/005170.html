<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FATAL: Unable to open HTTPS Socket
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FATAL%3A%20Unable%20to%20open%20HTTPS%20Socket&In-Reply-To=%3CSNT147-W1473772EA94E8B3D488F87CA610%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005169.html">
   <LINK REL="Next"  HREF="005182.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FATAL: Unable to open HTTPS Socket</H1>
    <B>Oliver Webb</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FATAL%3A%20Unable%20to%20open%20HTTPS%20Socket&In-Reply-To=%3CSNT147-W1473772EA94E8B3D488F87CA610%40phx.gbl%3E"
       TITLE="[squid-users] FATAL: Unable to open HTTPS Socket">ow97 at outlook.com
       </A><BR>
    <I>Tue Aug 25 18:51:19 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005169.html">[squid-users] Squid HIT ratio
</A></li>
        <LI>Next message (by thread): <A HREF="005182.html">[squid-users] FATAL: Unable to open HTTPS Socket
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5170">[ date ]</a>
              <a href="thread.html#5170">[ thread ]</a>
              <a href="subject.html#5170">[ subject ]</a>
              <a href="author.html#5170">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>TLDR Skip to ----------

I have squid 3.5.7 installed on linux with the following configure options:

&#160;'--build=arm-linux-gnueabihf' '--prefix=/usr' '--localstatedir=/var' '--libexecdir=/usr/lib/squid' '--srcdir=.' '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid' '--with-default-user=proxy' '--with-logdir=/var/log' '--with-pidfile=/var/run/squid.pid' '--enable-ssl' '--with-openssl' '--enable-ssl-crtd' '--enable-delay-pools' '--enable-external-acl-helpers=session' 'build_alias=arm-linux-gnueabihf'

I have the following ports assigned in squid.conf:

http_port 3129
http_port 3128 intercept
https_port 3130 intercept ssl-bump generate-host-certificates=on dynamic_cert_mem_cache_size=4MB cert=/etc/squid/myCA.pem

I also have IPTables redirecting port 443 traffic to port 3130 and port 80 traffic to 3128

For port 80 HTTP traffic the proxy works fine pages load except blocked ones which the proxy successfully replaces which blocked message

Port 443 HTTPS traffic is successfully bumped by squid and the certificate is replaced with the dynamically generated one.
----------
HOWEVER
The page squid serves over the browser-squid tunnel is the ERR_DNS_FAIL error page with the %H hostname template code evaluated to 'http' (without quotes)

Also in the cache.log the following message appears after every HTTPS request
FATAL: Unable to open HTTPS Socket
Nothing else is using the 3130 port as when I stop squid I am able to run a web server off this port (no it *definitely* isn't the web server using the port I just started it as a test)

I have no clue what is wrong. Please Help!! Thank you! 		 	   		  
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005169.html">[squid-users] Squid HIT ratio
</A></li>
	<LI>Next message (by thread): <A HREF="005182.html">[squid-users] FATAL: Unable to open HTTPS Socket
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5170">[ date ]</a>
              <a href="thread.html#5170">[ thread ]</a>
              <a href="subject.html#5170">[ subject ]</a>
              <a href="author.html#5170">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
