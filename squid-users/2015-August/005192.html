<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Lots of &quot;Vary object loop!&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Lots%20of%20%22Vary%20object%20loop%21%22&In-Reply-To=%3C55DE0F5B.2070703%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005187.html">
   <LINK REL="Next"  HREF="005194.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Lots of &quot;Vary object loop!&quot;</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Lots%20of%20%22Vary%20object%20loop%21%22&In-Reply-To=%3C55DE0F5B.2070703%40treenet.co.nz%3E"
       TITLE="[squid-users] Lots of &quot;Vary object loop!&quot;">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Aug 26 19:11:23 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005187.html">[squid-users] Lots of &quot;Vary object loop!&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="005194.html">[squid-users] Lots of &quot;Vary object loop!&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5192">[ date ]</a>
              <a href="thread.html#5192">[ thread ]</a>
              <a href="subject.html#5192">[ subject ]</a>
              <a href="author.html#5192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/08/2015 4:11 a.m., Sebasti&#225;n Goicochea wrote:
&gt;<i> Hello Amos, thanks for your help. I've disabled our rewriter helper but
</I>&gt;<i> the errors remain the same. So I think that's not the reason.
</I>
You emptied the cache, or at least altered the cache_dir line to point
at a new empty cache_dir during the test after disabling the helper?
anything it might have done to the cache contents is already done to the
data stored there by the time you disable it.


&gt;<i> I've been reading some older mails from the list and a guy named Hussam
</I>&gt;<i> Al-Tayeb exchanged some interesting mails with you a couple of months
</I>&gt;<i> ago .. That got me thinking, can I completely disable Vary checking? I
</I>&gt;<i> know is an http violation and not recommended, but if I could disable it
</I>&gt;<i> using an ACL for certain sites that are missconfigured and I have the
</I>&gt;<i> certainty that the content is exactly the same no matter what .. I could
</I>&gt;<i> get better performance. (It's ok if I have to patch something and
</I>&gt;<i> recompile squid)
</I>&gt;<i> If this is not possible, what about &quot;bypassing&quot; content that has the
</I>&gt;<i> Vary in its response header so squid does not make this 2 lookups only
</I>&gt;<i> to find that it has to retrieve it from the original server anyway?
</I>&gt;<i> 
</I>
Its not a violation of HTTP. It is a critical internal validity check
for the cache index itself.

Preventing the contents of say your bank account display page being sent
to someone else fetching <A HREF="http://google.com/.">http://google.com/.</A> That kind of critical.

If the Vary meta object is not pointing at the object its supposed to
be. Then the object it was supposed to be pointing at could be anything
at all.


For your other question. Yes, 3.5 has the store_miss directive now.
&lt;<A HREF="http://master.squid-cache.org/Doc/config/store_miss/">http://master.squid-cache.org/Doc/config/store_miss/</A>&gt;.
You can use ACLs in there to check for either the known URLs or the Vary
header existence on replies and prevent caching of those objects. I'm
not sure how that will interact with the vary objects in your case but
none I know of using it has mentioned any issues.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005187.html">[squid-users] Lots of &quot;Vary object loop!&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="005194.html">[squid-users] Lots of &quot;Vary object loop!&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5192">[ date ]</a>
              <a href="thread.html#5192">[ thread ]</a>
              <a href="subject.html#5192">[ subject ]</a>
              <a href="author.html#5192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
