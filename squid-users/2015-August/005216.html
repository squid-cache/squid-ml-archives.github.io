<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Zero Sized Reply
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Zero%20Sized%20Reply&In-Reply-To=%3CCAMeoTHm_nzRi9ypmrHz4kkxAxTe6dp-env_CVNF_fdXSHo2ZRQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005215.html">
   <LINK REL="Next"  HREF="005217.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Zero Sized Reply</H1>
    <B>Jorgeley Junior</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Zero%20Sized%20Reply&In-Reply-To=%3CCAMeoTHm_nzRi9ypmrHz4kkxAxTe6dp-env_CVNF_fdXSHo2ZRQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Zero Sized Reply">jorgeley at gmail.com
       </A><BR>
    <I>Thu Aug 27 19:51:39 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005215.html">[squid-users] Zero Sized Reply
</A></li>
        <LI>Next message (by thread): <A HREF="005217.html">[squid-users] Zero Sized Reply
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5216">[ date ]</a>
              <a href="thread.html#5216">[ thread ]</a>
              <a href="subject.html#5216">[ subject ]</a>
              <a href="author.html#5216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You're the man Amos!!! You're the man!!! Thanks!!! Thanks so so much!!!
that's solved the problem, but I'm thinking if it solved just for this
domain, so can it happen again with another domains, ok? No way to solve
for future errors of this same type?

2015-08-27 16:03 GMT-03:00 Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:

&gt;<i> On 28/08/2015 5:49 a.m., Jorgeley Junior wrote:
</I>&gt;<i> &gt; Amos, thank you so much for attention, but sorry, I didn't understand
</I>&gt;<i> what
</I>&gt;<i> &gt; you said.
</I>&gt;<i>
</I>&gt;<i> Nevermind. The website code is broken.
</I>&gt;<i>
</I>&gt;<i> I have been looking into it from here using those request headers from
</I>&gt;<i> your log.
</I>&gt;<i>
</I>&gt;<i> What I see happening is that the server starts responding. Then the PHP
</I>&gt;<i> code it is running hangs for a very long time. If you wait long enough
</I>&gt;<i> it will pop out part of a page and a PHP error message about its
</I>&gt;<i> database connection script and some timeout.
</I>&gt;<i>
</I>&gt;<i> The best I could get was over a minute (78 seconds) delay before
</I>&gt;<i> anything at all happened. Usually a bit longer.
</I>&gt;<i>
</I>&gt;<i> I think something in your network is terminating the server connection
</I>&gt;<i> after it takes too long. NAT and high speed router systems tend to have
</I>&gt;<i> a 30 second maximum wait between TCP packets before they close the
</I>&gt;<i> connection.
</I>&gt;<i>
</I>&gt;<i> Either way the website server itself is very broken.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; So, I tried to change the http for https and it showed the website and i
</I>&gt;<i> &gt; added the security exception for no trusted certificate, but I really
</I>&gt;<i> would
</I>&gt;<i> &gt; like that the squid didn't show the error.
</I>&gt;<i> &gt; Why http show de Zero Sized Reply and https no?
</I>&gt;<i>
</I>&gt;<i> Different protocols and ports.
</I>&gt;<i>
</I>&gt;<i> I still see the same delays, partial page and database errors when
</I>&gt;<i> connecting with HTTPS. But kept digging to see why you might be getting
</I>&gt;<i> a page...
</I>&gt;<i>
</I>&gt;<i> It seems to be an IPv6 server sitting behind some form of gateway access
</I>&gt;<i> network and only pretending to be IPv4-only. When sending it a
</I>&gt;<i> X-Forwarded-For header claiming to be an IPv6-enabled browser it seems
</I>&gt;<i> to operate just fine.
</I>&gt;<i>
</I>&gt;<i> So, try adding this to your squid.conf:
</I>&gt;<i>
</I>&gt;<i>  acl magicXff dstdomain .grupoatuall.com.br
</I>&gt;<i>  request_header_access X-Forwarded-For deny magicXff
</I>&gt;<i>  request_header_replace X-Forwarded-For ::1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>

--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150827/551969ea/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150827/551969ea/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005215.html">[squid-users] Zero Sized Reply
</A></li>
	<LI>Next message (by thread): <A HREF="005217.html">[squid-users] Zero Sized Reply
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5216">[ date ]</a>
              <a href="thread.html#5216">[ thread ]</a>
              <a href="subject.html#5216">[ subject ]</a>
              <a href="author.html#5216">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
