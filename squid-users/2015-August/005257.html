<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Building squid | Best Practices?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Building%20squid%20%7C%20Best%20Practices%3F&In-Reply-To=%3C55E24EC2.30704%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005243.html">
   <LINK REL="Next"  HREF="005259.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Building squid | Best Practices?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Building%20squid%20%7C%20Best%20Practices%3F&In-Reply-To=%3C55E24EC2.30704%40treenet.co.nz%3E"
       TITLE="[squid-users] Building squid | Best Practices?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Aug 30 00:30:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005243.html">[squid-users] Building squid | Best Practices?
</A></li>
        <LI>Next message (by thread): <A HREF="005259.html">[squid-users] Building squid | Best Practices?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5257">[ date ]</a>
              <a href="thread.html#5257">[ thread ]</a>
              <a href="subject.html#5257">[ subject ]</a>
              <a href="author.html#5257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/08/2015 12:52 p.m., Howard Waterfall wrote:
&gt;<i> Ubuntu 14.04
</I>&gt;<i> 
</I>&gt;<i> Squid 3.5.5
</I>&gt;<i> 
</I>&gt;<i> Hi -
</I>&gt;<i> 
</I>&gt;<i> I've successfully installed, configured and run squid 3.5.5 w/o a problem
</I>&gt;<i> using:
</I>&gt;<i> 
</I>&gt;<i> sudo apt-get install squid
</I>&gt;<i> 
</I>&gt;<i> I want to filter by mac address though, so I purged that install and
</I>&gt;<i> re-built squid with the *--enable-arp-acl* flag. I installed using make
</I>&gt;<i> install.
</I>&gt;<i> 
</I>
It seems the documentation is outdated. EUI support is built into
current Squid by default.

Note however that ARP and MAC/EUI-48 is an IPv4-only feature and does
not work on complex networks anyway due to how ARP operates. IPv6 uses
other mechanisms to route packets.


&gt;<i> This is when the problems begin. I've summarized that in a separate thread:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/pipermail/squid-users/2015-August/005232.html">http://lists.squid-cache.org/pipermail/squid-users/2015-August/005232.html</A>
</I>&gt;<i> 
</I>&gt;<i> I wonder if there's a way to simply *avoid* all those problems.
</I>
There is. At least its &quot;simple&quot; for someone used to custom building.


step 1) Purge your custom build and reinstall the distro package.

If this is just for the ARP. That should be enough.


If you want other custom features continue with ...

step 2) run &quot;apt-get build-dep squid&quot; to install the packages needed to
build squid yourself.

step 3) Use &quot;squid -v&quot; to identify the system-specific build options.


If you build Squd now with the options straight from -v the &quot;make
install&quot; step will replace the existing package files with updated copies.

Note that Upgrading the system package later will in turn replace your
custom build in the same way. So this is mostly useful for custom builds
to fix/patch temporary bugs you expect the system package to fix later.
Or if you use aptitudes 'hold' feature.

But, there are more steps below..

&gt;<i> 
</I>&gt;<i> A couple of questions:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    1. My build configuration is below. After building and installing, squid
</I>&gt;<i>    ended up here: */usr/local/squid/sbin*. I think that's the same place *sudo
</I>&gt;<i>    apt-get install squid *puts it right?
</I>
That /usr/local is the default location for user-built programs in *NIX
and *BSD operating systems. System provided packages go elsewhere.

Debian/Ubuntu has a different package layout as well. The squid -v step
above will provide you with the build options needed to setup for that
layout properly.



&gt;<i>    2. Given I had no problems with *sudo apt-get install squid*, is the
</I>&gt;<i>    best practice to install squid using that method and arrange for my builds
</I>&gt;<i>    to install squid to a different location and simply copy it over?
</I>

If you just want to keep the Squid installation separate from the system
package. Then the FS layout does not matter. Just...


&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> 
</I>&gt;<i> Deiter
</I>&gt;<i> 
</I>&gt;<i> ./configure --prefix=/usr --localstatedir=/var
</I>&gt;<i> --libexecdir=${prefix}/lib/squid3 --srcdir=.
</I>&gt;<i> --datadir=${prefix}/share/squid3 --sysconfdir=/etc/squid3
</I>&gt;<i> --with-default-user=proxy --with-logdir=/var/log
</I>&gt;<i> --with-pidfile=/var/run/squid.pid --enable-arp-acl
</I>&gt;<i> 
</I>

step 4) run &quot;mkdir /proxy&quot; (or whatever you want to call it)

step 5) change that --prefix option to /proxy

The &quot;make install&quot; should then create everything which makes up &quot;Squid&quot;
inside /proxy.

step 6) edit the /etc/init.d/squid script DAEMON= and CONFIG= variables
to point at your custom /proxy/sbin/squid and /proxy/etc/squid/squid.conf


The system package upgrades will then not affect your customizations.


Thats how I do it anyway :-)

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005243.html">[squid-users] Building squid | Best Practices?
</A></li>
	<LI>Next message (by thread): <A HREF="005259.html">[squid-users] Building squid | Best Practices?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5257">[ date ]</a>
              <a href="thread.html#5257">[ thread ]</a>
              <a href="subject.html#5257">[ subject ]</a>
              <a href="author.html#5257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
