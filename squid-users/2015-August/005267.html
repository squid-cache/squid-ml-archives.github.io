<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Please help me , about none HTTP protocol (DPORT 80)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Please%20help%20me%20%2C%0A%20about%20none%20HTTP%20protocol%20%28DPORT%2080%29&In-Reply-To=%3C55E32260.3030109%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005260.html">
   <LINK REL="Next"  HREF="005275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Please help me , about none HTTP protocol (DPORT 80)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Please%20help%20me%20%2C%0A%20about%20none%20HTTP%20protocol%20%28DPORT%2080%29&In-Reply-To=%3C55E32260.3030109%40treenet.co.nz%3E"
       TITLE="[squid-users] Please help me , about none HTTP protocol (DPORT 80)">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Aug 30 15:33:52 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005260.html">[squid-users] Please help me , about none HTTP protocol (DPORT 80)
</A></li>
        <LI>Next message (by thread): <A HREF="005275.html">[squid-users] Software caused connection abort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5267">[ date ]</a>
              <a href="thread.html#5267">[ thread ]</a>
              <a href="subject.html#5267">[ subject ]</a>
              <a href="author.html#5267">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/08/2015 1:10 p.m., &#36158;&#20961; wrote:
&gt;<i> Please help me , about none HTTP protocol (DPORT 80) . 
</I>&gt;<i> 
</I>&gt;<i> I installed a SQUID (3.5) on Centos 6.5  as a web &amp; video caching system .(not reverse proxy or cache )
</I>&gt;<i> I use the TPROXY method following here: &lt;<A HREF="http://wiki.squid-cache.org/Features/Tproxy4">http://wiki.squid-cache.org/Features/Tproxy4</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> the section in this tourial :
</I>&gt;<i> iptables -t mangle -A PREROUTING -p tcp --dport 80 -j TPROXY --tproxy-mark 0x1/0x1 --on-port 3129
</I>&gt;<i> 
</I>&gt;<i> it will set all the data incoming from LAN erea (condition: destination port is 80) as the MARK , and then 
</I>&gt;<i> squid process the data .
</I>
Yes. Amongst many other things, and only with support of the other rules
documented around it.

&gt;<i> 
</I>&gt;<i> here , I want to ask a question :
</I>&gt;<i> not all the DPORT 80 data is HTTP protocol (such as : tencent's IM service port is 80 , but it is not HTTP protocol ) 
</I>&gt;<i> 
</I>&gt;<i> in this condition , source client will appear problem because the SQUID box could not rightly process the data.
</I>&gt;<i> 
</I>&gt;<i> then how Squid process the data that dport is 80 but which is not http protocol  ?
</I>
By rejecting. Port 80 is a *reserved* port for HTTP protocol use *only*.

Software that uses port 80 for non-HTTP protocols and messaging does so
for the explicit purpose of bypassing the network administrative
policies. Squid does not support that abuse of the port.

IM protocols in particular share most of their behaviour with REST HTTP
messaging design. So there is zero excuse for those IM services not to
be using HTTP syntax for their messages on port 80.


Squid-4 contains a directive on_unsupported_protocol that lets you
configure what happens.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005260.html">[squid-users] Please help me , about none HTTP protocol (DPORT 80)
</A></li>
	<LI>Next message (by thread): <A HREF="005275.html">[squid-users] Software caused connection abort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5267">[ date ]</a>
              <a href="thread.html#5267">[ thread ]</a>
              <a href="subject.html#5267">[ subject ]</a>
              <a href="author.html#5267">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
