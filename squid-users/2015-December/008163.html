<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid with NTLM auth behind netscaler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20NTLM%20auth%20behind%20netscaler&In-Reply-To=%3C5661AA55.4090407%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008155.html">
   <LINK REL="Next"  HREF="008176.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid with NTLM auth behind netscaler</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20NTLM%20auth%20behind%20netscaler&In-Reply-To=%3C5661AA55.4090407%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid with NTLM auth behind netscaler">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Dec  4 14:59:33 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008155.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
        <LI>Next message (by thread): <A HREF="008176.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8163">[ date ]</a>
              <a href="thread.html#8163">[ thread ]</a>
              <a href="subject.html#8163">[ subject ]</a>
              <a href="author.html#8163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/12/2015 11:14 p.m., Fabio Bucci wrote:
&gt;<i> Hi All,
</I>&gt;<i> my task is implementing a squid proxy that allow all my authenticated
</I>&gt;<i> (windows AD) internal users to surf internet without any credential request
</I>&gt;<i> (pop-up).
</I>&gt;<i> 
</I>&gt;<i> Plus, i created two squid nodes and put them behind a citrix netscaler in
</I>&gt;<i> order to perform a load balance service.
</I>&gt;<i> 
</I>
How does this LB device work exactly? when dealing with NTLM the
specifics matter *a lot*.

Some LB sniff the HTTP traffic then route them on a per-message basis.
This is incompatible with both NTLM and Negotiate authentication, and
can cause bad confusion between the browser and proxy randomly.

Note that HTTP is a stateless protocol. So none of the browser, LB or
proxy are broken when this is going on. It is those to auth schemes that
are broken and incompatible with the designed statelessness feature of
HTTP being used by the LB.


&gt;<i> I configured squid with samba and ntlm helper in order to perform a
</I>&gt;<i> transparent authentication but sometimes some user report me their browsers
</I>&gt;<i> require authentication via pop-up.
</I>&gt;<i> 
</I>&gt;<i> I'm not a deep expert about squid and i'd like to receive your help in
</I>&gt;<i> order to understand if my configuration is correct or not and if there is a
</I>&gt;<i> way to prevent popup.
</I>
With HTTP authentication there should only ever be one popup no matter
what type of authentication scheme is used. HTTP being stateless,
requires that every single message has credentials attached (NTLM
violates that and some browsers dont always re-send while the connection
is alive; Squid accepts that, the LB may not). It is the browsers
responsibility to remember the credentials that work and continue using
them without annoying the user.


There are some proxy configurations that allow for the proxy to force
the Browser to change credentials. These can result in popups as that
change happens. We will need to see your squid.conf to provide any
specific help on that.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008155.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
	<LI>Next message (by thread): <A HREF="008176.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8163">[ date ]</a>
              <a href="thread.html#8163">[ thread ]</a>
              <a href="subject.html#8163">[ subject ]</a>
              <a href="author.html#8163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
