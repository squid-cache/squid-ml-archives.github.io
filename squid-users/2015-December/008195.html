<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Deny%20Access%20based%20on%20SSL-Blacklists%0A%20%28SHA1-Fingerprint%29%20with%20ssl_bump&In-Reply-To=%3C5665FA59.5010506%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008194.html">
   <LINK REL="Next"  HREF="008247.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Deny%20Access%20based%20on%20SSL-Blacklists%0A%20%28SHA1-Fingerprint%29%20with%20ssl_bump&In-Reply-To=%3C5665FA59.5010506%40measurement-factory.com%3E"
       TITLE="[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Dec  7 21:30:01 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008194.html">[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump
</A></li>
        <LI>Next message (by thread): <A HREF="008247.html">[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8195">[ date ]</a>
              <a href="thread.html#8195">[ thread ]</a>
              <a href="subject.html#8195">[ subject ]</a>
              <a href="author.html#8195">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/07/2015 02:05 PM, Tom Tom wrote:
&gt;<i> The configuration provided by Alex works for me (squid 3.5.11) 
</I>
Thank you for testing and helping expose problems.


&gt;<i> if:
</I>&gt;<i> * the http_port-directive is configured with ssl-bump and a
</I>&gt;<i> certificate (ex. http_port 3128 ssl-bump generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=4MB cert=/usr/local/certs/myCA.pem)
</I>
ssl-bump is required to access SSL/TLS peeking code. Now way around that
today although future Squid versions may provide something like an
ssl-peek port option that tells Squid that no bumping, for any reason
(including error serving) is permitted on that port.

Specifying root CA is required to serve certificate validation (and
other) errors, but we probably should be more flexible and allow no-CA
splice-or-terminate configurations as well.

Related enhancement requests in bugzilla are welcomed, especially if
they are followed by quality patches.


&gt;<i> * the SHA1-fingerprint in the file SSL_BLACKLISTS is delimited after
</I>&gt;<i> two characters with a colon
</I>&gt;<i> (9E:C8:15:3F:27:C9:B5:BA:B9:17:49:C8:0A:D7:DF:21:D3:8C:80:50 for
</I>&gt;<i> ar***krebs.de)
</I>
If Squid silently misinterprets colon-less fingerprints, it is a bug
that should be reported and fixed. Squid should either interpret them
correctly or exit with a configuration error.


Thank you,

Alex.



&gt;<i> On Mon, Dec 7, 2015 at 4:02 PM, Alex Rousskov
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;&gt;<i> On 12/07/2015 04:37 AM, Ralf Hildebrandt wrote:
</I>&gt;&gt;&gt;<i> * Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;:
</I>&gt;&gt;&gt;&gt;<i> Please note that if you do not want to bump anything, then the following
</I>&gt;&gt;&gt;&gt;<i> should also work (bugs notwithstanding):
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>     ssl_bump splice whitelist
</I>&gt;&gt;&gt;&gt;<i>     ssl_bump peek all
</I>&gt;&gt;&gt;&gt;<i>     ssl_bump terminate blacklist
</I>&gt;&gt;&gt;&gt;<i>     ssl_bump splice all
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That doesn't seem to work for me (squid 3.5.2)
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Yet I still can connect. What am I doing wrong?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you are indeed using v3.5.2, then that is a big red flag.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you are using the latest v3.5 release, then you should open a bug
</I>&gt;&gt;<i> report, preferably with an ALL,9 log depicting a single failing
</I>&gt;&gt;<i> transaction. AFAICT, the above is meant to work. If it does not, there
</I>&gt;&gt;<i> is either a Squid bug or misconfiguration [that I cannot detect by
</I>&gt;&gt;<i> reading email].
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thank you,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008194.html">[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump
</A></li>
	<LI>Next message (by thread): <A HREF="008247.html">[squid-users] Deny Access based on SSL-Blacklists (SHA1-Fingerprint) with ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8195">[ date ]</a>
              <a href="thread.html#8195">[ thread ]</a>
              <a href="subject.html#8195">[ subject ]</a>
              <a href="author.html#8195">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
