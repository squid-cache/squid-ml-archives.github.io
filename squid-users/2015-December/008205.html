<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid auth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20auth&In-Reply-To=%3C56669CD0.4070805%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008202.html">
   <LINK REL="Next"  HREF="008208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid auth</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20auth&In-Reply-To=%3C56669CD0.4070805%40treenet.co.nz%3E"
       TITLE="[squid-users] squid auth">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Dec  8 09:03:12 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008202.html">[squid-users] squid auth
</A></li>
        <LI>Next message (by thread): <A HREF="008208.html">[squid-users] squid auth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8205">[ date ]</a>
              <a href="thread.html#8205">[ thread ]</a>
              <a href="subject.html#8205">[ subject ]</a>
              <a href="author.html#8205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/12/2015 7:44 p.m., Alex Samad wrote:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> Currently using 3.1 (from centos 6)
</I>&gt;<i> I have setup squid to auth against MS AD
</I>&gt;<i> 
</I>&gt;<i> I have
</I>&gt;<i> # #######
</I>&gt;<i> # Negotiate
</I>&gt;<i> # #######
</I>&gt;<i> 
</I>&gt;<i> # <A HREF="http://wiki.squid-cache.org/Features/Authentication">http://wiki.squid-cache.org/Features/Authentication</A>
</I>&gt;<i> # <A HREF="http://wiki.squid-cache.org/Features/NegotiateAuthentication">http://wiki.squid-cache.org/Features/NegotiateAuthentication</A>
</I>&gt;<i> auth_param negotiate program /usr/bin/ntlm_auth
</I>&gt;<i> --helper-protocol=gss-spnego --configfile /etc/samba/smb.conf-squid
</I>&gt;<i> auth_param negotiate children 10 startup=0 idle=3
</I>&gt;<i> auth_param negotiate keep_alive on
</I>&gt;<i> 
</I>&gt;<i> # #######
</I>&gt;<i> # NTLM AUTH
</I>&gt;<i> # #######
</I>&gt;<i> 
</I>&gt;<i> # ntlm auth
</I>&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth
</I>&gt;<i> --helper-protocol=squid-2.5-ntlmssp --configfile
</I>&gt;<i> /etc/samba/smb.conf-squid
</I>&gt;<i> auth_param ntlm children 10
</I>&gt;<i> #auth_param ntlm children 10 startup=0 idle=3
</I>&gt;<i> #auth_param ntlm keep_alive
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> # #######
</I>&gt;<i> # NTLM over basic
</I>&gt;<i> # #######
</I>&gt;<i> 
</I>&gt;<i> # warning: basic authentication sends passwords plaintext
</I>&gt;<i> # a network sniffer can and will discover passwords
</I>&gt;<i> auth_param basic program /usr/bin/ntlm_auth
</I>&gt;<i> --helper-protocol=squid-2.5-basic --configfile
</I>&gt;<i> /etc/samba/smb.conf-squid
</I>&gt;<i> auth_param basic children 5
</I>&gt;<i> auth_param basic realm Squid proxy-caching web server
</I>&gt;<i> auth_param basic credentialsttl 2 hours
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I want to move towards using kerberos come to this page
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/Authenticate/Kerberos">http://wiki.squid-cache.org/ConfigExamples/Authenticate/Kerberos</A>
</I>&gt;<i> 
</I>&gt;<i> worked through that, but i saw this
</I>&gt;<i> 
</I>&gt;<i> Do not use this method if you run winbindd or other samba services as
</I>&gt;<i> samba will reset the machine password every x days and thereby makes
</I>&gt;<i> the keytab invalid !!
</I>

As I understand it that disclaimer applies only to the &quot;OR with Samba&quot;
instructions for keytab creation directly above it. The other two
methods should work.

Also, it is just a disclaimer about a known problem. There is always the
option to setup a script that re-builds the keytab and reloads Squid
every X days when it changes.

&gt;<i> 
</I>&gt;<i> I have winbindd running for my users list in linux
</I>&gt;<i> 
</I>&gt;<i> is there a way around this and if not how
</I>&gt;<i> 
</I>
The initial mskutil method of keytab creation is both a way around it
and the preferred method of keytab creation.

As you found elsewhere ...

&gt;<i> then found this one
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory">http://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory</A>
</I>&gt;<i> 
</I>&gt;<i> but I am not using msktutil, i do have samba and the krb-workstation installed
</I>&gt;<i> 
</I>
mskutil is just a tool to generate keytabs and link the machine to
domain. I *think* it should still be usable even if you have Sambe, the
probem is just that if you let Samba know about the keytab and account
it will do the periodic updates.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008202.html">[squid-users] squid auth
</A></li>
	<LI>Next message (by thread): <A HREF="008208.html">[squid-users] squid auth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8205">[ date ]</a>
              <a href="thread.html#8205">[ thread ]</a>
              <a href="subject.html#8205">[ subject ]</a>
              <a href="author.html#8205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
