<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ffserver on remote server and ffmpeg on local
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ffserver%20on%20remote%20server%20and%20ffmpeg%20on%20local&In-Reply-To=%3C566C7924.5010408%40web.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008353.html">
   <LINK REL="Next"  HREF="008291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ffserver on remote server and ffmpeg on local</H1>
    <B>Jens Kallup</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ffserver%20on%20remote%20server%20and%20ffmpeg%20on%20local&In-Reply-To=%3C566C7924.5010408%40web.de%3E"
       TITLE="[squid-users] ffserver on remote server and ffmpeg on local">jkallup at web.de
       </A><BR>
    <I>Sat Dec 12 19:44:36 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008353.html">[squid-users] Not work HELP change cache dir
</A></li>
        <LI>Next message (by thread): <A HREF="008291.html">[squid-users] ffserver on remote server and ffmpeg on local
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8288">[ date ]</a>
              <a href="thread.html#8288">[ thread ]</a>
              <a href="subject.html#8288">[ subject ]</a>
              <a href="author.html#8288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I have running a ffserver on remote machine without parameters - except

#File: /etc/ffserver.conf

Port 8090
# bind to all IPs aliased or not
BindAddress 0.0.0.0
# max number of simultaneous clients
MaxClients 1000
# max bandwidth per-client (kb/s)
MaxBandwidth 10000
# Suppress that if you want to launch ffserver as a daemon.
NoDaemon

&lt;Feed feed1.ffm&gt;
File /tmp/feed1.ffm
FileMaxSize 5M
&lt;/Feed&gt;

&lt;Stream test.swf&gt;
Feed feed1.ffm
Format swf
VideoCodec flv
VideoFrameRate 15
VideoBufferSize 80000
VideoBitRate 100
VideoQMin 1
VideoQMax 5
VideoSize 352x288
PreRoll 0
Noaudio
&lt;/Stream&gt;

And on local machine:

# ffmpeg -f x11grab -i :0.0+100,200 -flags +global_header -c:v libx264 
-b:v 500k -r 10 -s 352x288 -x264opts keyint=50 -g 10 -pix_fmt yuv420p -f 
flv <A HREF="http://server.tld:8090/feed1.ffm">http://server.tld:8090/feed1.ffm</A>
ffmpeg version 2.7.2 Copyright (c) 2000-2015 the FFmpeg developers
   built with gcc 4.9.2 (Debian 4.9.2-10)
   configuration: --enable-gpl --enable-version3 --enable-nonfree 
--enable-postproc --enable-libaacplus --enable-libfaac 
--enable-libfdk-aac --enable-libfreetype --enable-libmp3lame 
--enable-libopencore-amrnb --enable-libopencore-amrwb 
--enable-libopenjpeg --enable-openssl --enable-libopus 
--enable-libschroedinger --enable-libspeex --enable-libtheora 
--enable-libvo-aacenc --enable-libvorbis --enable-libvpx 
--enable-libx264 --enable-libxvid --prefix=/usr/local --enable-librtmp
   WARNING: library configuration mismatch
   avutil      configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   avcodec     configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   avformat    configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   avdevice    configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   avfilter    configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   swscale     configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   swresample  configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   postproc    configuration: --enable-gpl --enable-postproc 
--enable-swscale --enable-avfilter --enable-libmp3lame 
--enable-libvorbis --enable-libtheora --enable-libx264 --enable-libspeex 
--enable-shared --enable-pthreads --enable-libopenjpeg --enable-libfaac 
--enable-nonfree
   libavutil      54. 27.100 / 54. 27.100
   libavcodec     56. 41.100 / 56. 41.100
   libavformat    56. 36.100 / 56. 36.100
   libavdevice    56.  4.100 / 56.  4.100
   libavfilter     5. 16.101 /  5. 16.101
   libswscale      3.  1.101 /  3.  1.101
   libswresample   1.  2.100 /  1.  2.100
   libpostproc    53.  3.100 / 53.  3.100
Input #0, x11grab, from ':0.0+100,200':
   Duration: N/A, start: 1449948966.255341, bitrate: N/A
     Stream #0:0: Video: rawvideo (BGR[0] / 0x524742), bgr0, 640x480, 
29.97 fps, 29.97 tbr, 1000k tbn, 29.97 tbc
[libx264 @ 0x1e5be20] using cpu capabilities: MMX2 SSE2Fast SSSE3 Cache64
[libx264 @ 0x1e5be20] profile High, level 2.0
[libx264 @ 0x1e5be20] 264 - core 146 - H.264/MPEG-4 AVC codec - Copyleft 
2003-2015 - <A HREF="http://www.videolan.org/x264.html">http://www.videolan.org/x264.html</A> - options: cabac=1 ref=3 
deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 
mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 
deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 
lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 
bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 
b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=50 keyint_min=5 
scenecut=40 intra_refresh=0 rc_lookahead=40 rc=abr mbtree=1 bitrate=500 
ratetol=1.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, flv, to '<A HREF="http://kallup.net:8090/feed1.ffm">http://kallup.net:8090/feed1.ffm</A>':
   Metadata:
     encoder         : Lavf56.36.100
     Stream #0:0: Video: h264 (libx264) ([7][0][0][0] / 0x0007), 
yuv420p, 352x288, q=-1--1, 500 kb/s, 10 fps, 1k tbn, 10 tbc
     Metadata:
       encoder         : Lavc56.41.100 libx264
Stream mapping:
   Stream #0:0 -&gt; #0:0 (rawvideo (native) -&gt; h264 (libx264))
Press [q] to stop, [?] for help
av_interleaved_write_frame(): Connection reset by peer:00.10 bitrate=N/A 
dup=0 drop=92
[flv @ 0x1e5ac20] Failed to update header with correct duration.
[flv @ 0x1e5ac20] Failed to update header with correct filesize.
frame=   49 fps= 10 q=-1.0 Lsize=      41kB time=00:00:00.00 bitrate=N/A 
dup=0 drop=94
video:41kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB 
muxing overhead: 0.793859%
[libx264 @ 0x1e5be20] frame I:1     Avg QP:18.63  size: 37296
[libx264 @ 0x1e5be20] frame P:14    Avg QP:12.64  size:  4936
[libx264 @ 0x1e5be20] frame B:34    Avg QP:19.91  size:    23
[libx264 @ 0x1e5be20] consecutive B-frames:  6.1%  4.1%  0.0% 89.8%
[libx264 @ 0x1e5be20] mb I  I16..4:  8.3%  2.3% 89.4%
[libx264 @ 0x1e5be20] mb P  I16..4:  1.0%  0.2%  4.5%  P16..4: 25.6%  
1.4%  1.1%  0.0%  0.0%    skip:66.3%
[libx264 @ 0x1e5be20] mb B  I16..4:  0.0%  0.0%  0.0%  B16..8: 2.3%  
0.0%  0.0%  direct: 0.0%  skip:97.7%  L0: 2.6% L1:97.4% BI: 0.0%
[libx264 @ 0x1e5be20] final ratefactor: 6.87
[libx264 @ 0x1e5be20] 8x8 transform intra:2.8% inter:40.2%
[libx264 @ 0x1e5be20] coded y,uvDC,uvAC intra: 74.4% 5.9% 5.5% inter: 
5.8% 1.0% 0.9%
[libx264 @ 0x1e5be20] i16 v,h,dc,p: 46% 51%  3%  0%
[libx264 @ 0x1e5be20] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 55%  0% 45% 0%  0%  
0%  0%  0%  0%
[libx264 @ 0x1e5be20] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 24% 27% 12% 4%  6%  
5%  7%  5%  9%
[libx264 @ 0x1e5be20] i8c dc,h,v,p: 86% 12%  2%  0%
[libx264 @ 0x1e5be20] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x1e5be20] ref P L0: 98.0%  0.6%  1.2%  0.2%
[libx264 @ 0x1e5be20] kb/s:174.96
Conversion failed!


The stream break always after 3-5 seconds.
Any help and ideas are welcome
Thanks

Jens

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008353.html">[squid-users] Not work HELP change cache dir
</A></li>
	<LI>Next message (by thread): <A HREF="008291.html">[squid-users] ffserver on remote server and ffmpeg on local
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8288">[ date ]</a>
              <a href="thread.html#8288">[ thread ]</a>
              <a href="subject.html#8288">[ subject ]</a>
              <a href="author.html#8288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
