<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Using subordinate CA for SSL Bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20subordinate%20CA%20for%20SSL%20Bump&In-Reply-To=%3C566F4DC6.6080408%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008317.html">
   <LINK REL="Next"  HREF="008321.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Using subordinate CA for SSL Bump</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20subordinate%20CA%20for%20SSL%20Bump&In-Reply-To=%3C566F4DC6.6080408%40treenet.co.nz%3E"
       TITLE="[squid-users] Using subordinate CA for SSL Bump">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Dec 14 23:16:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008317.html">[squid-users] Using subordinate CA for SSL Bump
</A></li>
        <LI>Next message (by thread): <A HREF="008321.html">[squid-users] Using subordinate CA for SSL Bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8320">[ date ]</a>
              <a href="thread.html#8320">[ thread ]</a>
              <a href="subject.html#8320">[ subject ]</a>
              <a href="author.html#8320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/12/2015 10:26 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> Hi all.
</I>&gt;<i> 
</I>&gt;<i> Does anybody can tell me - is it possible to use subordinate secondary
</I>&gt;<i> CA in squid for SSL Bumping purpose?
</I>&gt;<i> 
</I>&gt;<i> I.e., we have self-signed primary CA for issue subordinate CA,
</I>&gt;<i> 
</I>&gt;<i> subordinate CA we install in squid's setup,
</I>&gt;<i> 
</I>&gt;<i> primary CA certificate install to clients.
</I>&gt;<i> 
</I>&gt;<i> For example.
</I>&gt;<i> 
</I>&gt;<i> For mimicking we'll using subordinate CA, and, in case of subordinate
</I>&gt;<i> key forgery, we can use primary CA to revoke subordinate CA and re-issue
</I>&gt;<i> them without total replacement primary CA on clients.
</I>&gt;<i> 
</I>&gt;<i> This will seriously increase bumping security procedure, hm?
</I>&gt;<i> 
</I>&gt;<i> I've tried this scheme with 3.5.11, but without success.
</I>
I suspect its not going to work in the current releases. The more I look
at this part of the SSL code the more twisted it appears to be.

There are multiple code paths loading certs in different orders for
different features and traffic types. I have been trying to clean up
those code paths recently, but it is all still a bit tangled to even see
which one is handling what type of traffic.

AFAICT (so far) both the bumping and reverse-proxy code loads
Intermediary certs if they are listed in the cert= PEM file after the
cert Squid is using for either signing-cert or as server-cert. Some
other code path is loading them from cafile=, it looks like its the main
SSL code but I've not yet found how that code path actually happens (grr).

With all that looking hopeful, and the certs identified as the secondary
chain being attached (everything except the firstprimary/signing cert).
I'm not actually finding anywhere sending the actual signing certificate
itself during the bumping steps. So Squid may be horribly sending
all-but-one of the certs needed, on the assumption that the signing cert
is itself installed on the client.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008317.html">[squid-users] Using subordinate CA for SSL Bump
</A></li>
	<LI>Next message (by thread): <A HREF="008321.html">[squid-users] Using subordinate CA for SSL Bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8320">[ date ]</a>
              <a href="thread.html#8320">[ thread ]</a>
              <a href="subject.html#8320">[ subject ]</a>
              <a href="author.html#8320">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
