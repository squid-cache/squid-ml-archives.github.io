<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid with NTLM auth behind netscaler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20NTLM%20auth%20behind%20netscaler&In-Reply-To=%3C5671C5B9.5080100%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008370.html">
   <LINK REL="Next"  HREF="008464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid with NTLM auth behind netscaler</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20NTLM%20auth%20behind%20netscaler&In-Reply-To=%3C5671C5B9.5080100%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid with NTLM auth behind netscaler">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Dec 16 20:12:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008370.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
        <LI>Next message (by thread): <A HREF="008464.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8373">[ date ]</a>
              <a href="thread.html#8373">[ thread ]</a>
              <a href="subject.html#8373">[ subject ]</a>
              <a href="author.html#8373">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 17/12/2015 5:34 a.m., Fabio Bucci wrote:
&gt;<i> i'm planning to migrate to kerberos instead NTLM.....i got a question for
</I>&gt;<i> you Amos: sometimes a client reports issue in navigation and searching into
</I>&gt;<i> log file i cannot see &quot;username&quot; and all the request are 407
</I>&gt;<i> 
</I>&gt;<i> In these cases is there a way to reset a user session or it's a completely
</I>&gt;<i> client issue?
</I>
Usually it is the client stuck in a loop trying Negtiate/NTLM auth for
some reason. Some old Firefox, most Safari, and older IE can all get
stuck trying those credentials and ignoring the offers of Basic.

It might be possible to figure out some LmCompatibility settings change
that makes the problem just go away (eg, forcing NTLM of all versions to
disabled on the client).

Other than that Squid does have some workaround responses it can be made
to send back that might help the client reach the right conclusion:

a) list Basic auth first in the config. Any properly working client will
re-sort the auth types by security level and do theKerberos anyway. But
the broken ones (particularly IE7 and older) will have more chance of
using Basic.

b) sending 407 response with no auth headers. Such as a deny 407 status
generated by external ACL deny, or a URL-redirector. These tell the
client that auth failed, but there is no acceptible fallback.

c) sending Connection:close. Sometimes (mostly Firefox v20-v40) it is
the client prematurely attaching the credentials to the connection and
re-using them. That is supposed to have been fixed recently, but I've
not confirmed.

d) sending 403 status response. To just flat-out block the client once
it enters the looping state. Hoping that later requests will start to
work again.


HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008370.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
	<LI>Next message (by thread): <A HREF="008464.html">[squid-users] Squid with NTLM auth behind netscaler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8373">[ date ]</a>
              <a href="thread.html#8373">[ thread ]</a>
              <a href="subject.html#8373">[ subject ]</a>
              <a href="author.html#8373">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
