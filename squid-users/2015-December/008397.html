<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Fwd: Squid configuration advise
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fwd%3A%20Squid%20configuration%20advise&In-Reply-To=%3C5675B1CF.3020608%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008396.html">
   <LINK REL="Next"  HREF="008398.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Fwd: Squid configuration advise</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fwd%3A%20Squid%20configuration%20advise&In-Reply-To=%3C5675B1CF.3020608%40gmail.com%3E"
       TITLE="[squid-users] Fwd: Squid configuration advise">yvoinov at gmail.com
       </A><BR>
    <I>Sat Dec 19 19:36:47 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008396.html">[squid-users] Fwd: Squid configuration advise
</A></li>
        <LI>Next message (by thread): <A HREF="008398.html">[squid-users] Fwd: Squid configuration advise
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8397">[ date ]</a>
              <a href="thread.html#8397">[ thread ]</a>
              <a href="subject.html#8397">[ subject ]</a>
              <a href="author.html#8397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
Did your configure SSL Bump?

Ever since Squid 2.7 eternity. The world has changed and now the bulk of
the traffic is https. Which in general is not cached or must not cached
for many reasons.

And even in this case, Squid 3.3 too antique. I have updated to at least
version 3.5.


20.12.15 0:56, Jean Christophe Ventura &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm currently working to migrate RHEL5 2.7 Squid to RHEL7 3.3.
</I>&gt;<i>
</I>&gt;<i> I have migrated the config files to be 3.3 compliant (CIDR, remove of
</I>&gt;<i> deprecated function,change cache from UFS to AUFS) without any change
</I>&gt;<i> (cache mem, policy, smp)
</I>&gt;<i>
</I>&gt;<i> The new platform is a 4 node R610 (24 proc hyperthreading activate)
</I>&gt;<i> with 48GB of RAM, only 143GB disk in RAID for OS and cache. Each node
</I>&gt;<i> is connected to the network using 2x1Gbit bonding 2/3 level (some
</I>&gt;<i> network port are available on the server).
</I>&gt;<i>
</I>&gt;<i> bandwidth allocated for Internet users 400Mbit
</I>&gt;<i>
</I>&gt;<i> The difference between the old plateform and the new one doesn't seem
</I>&gt;<i> to be very fantastic :P
</I>&gt;<i> I have read the mailing list history alot.
</I>&gt;<i>
</I>&gt;<i> Squid release:
</I>&gt;<i> So i know 3.3 isn't anymore maintain but this infrastructure will be
</I>&gt;<i> not maintain by myself and i don't think that people behind will do
</I>&gt;<i> the update them self
</I>&gt;<i> If a official repository exist, maybe this question will be reopen
</I>&gt;<i> (from what i have read it's more some of you build packages from
</I>&gt;<i> source and give them to people)
</I>&gt;<i>
</I>&gt;<i> Squid auth:
</I>&gt;<i> It's transparent/basic auth only filtering some ip with acl.
</I>&gt;<i>
</I>&gt;<i> Squid bandwidth:
</I>&gt;<i> Currently a squid node treat something like 30/50Mbit (information
</I>&gt;<i> recovered using iftop)
</I>&gt;<i> From previous viewed mail i think it's normal for a non-smp configuration
</I>&gt;<i>
</I>&gt;<i> Squid measure:
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at xxxx</A> ~]# squidclient mgr:5min | grep 'client_http.requests'
</I>&gt;<i> client_http.requests = 233.206612/sec
</I>&gt;<i> other info
</I>&gt;<i> Cache information for squid:
</I>&gt;<i>         Hits as % of all requests:      5min: 6.8%, 60min: 7.1%
</I>&gt;<i>         Hits as % of bytes sent:        5min: 4.7%, 60min: 4.4%
</I>&gt;<i>         Memory hits as % of hit requests:       5min: 21.4%, 60min: 21.5%
</I>&gt;<i>         Disk hits as % of hit requests: 5min: 34.7%, 60min: 30.8%
</I>&gt;<i>         Storage Swap size:      9573016 KB
</I>&gt;<i>         Storage Swap capacity:  91.3% used,  8.7% free
</I>&gt;<i>         Storage Mem size:       519352 KB
</I>&gt;<i>         Storage Mem capacity:   99.1% used,  0.9% free
</I>&gt;<i>         Mean Object Size:       47.71 KB
</I>&gt;<i>
</I>&gt;<i> Now question and advise :
</I>&gt;<i>
</I>&gt;<i> This metrics seem too low for me. anyone of you agree ?
</I>&gt;<i>
</I>&gt;<i> 4 node x 50Mbit node= 200Mbit
</I>&gt;<i> To treat the maxbandwidth (400Mbit) + the lost of one host i need to
</I>&gt;<i> configure 4 thread by node.
</I>&gt;<i> Is there any reason or brillant idea for more (i will have some core
</I>&gt;<i> still available) ? calculation too empirical ?
</I>&gt;<i>
</I>&gt;<i> This url <A HREF="http://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster">http://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster</A>
</I>&gt;<i> seem to be a good start :P
</I>&gt;<i> Using this method i can interconnect each proxy to share their cache
</I>&gt;<i> (maybe using dedicated network port). Usefull or not ? may this
</I>&gt;<i> increase the hit ratio ? if this idea is'nt stupid interconnet using
</I>&gt;<i> the frontend only or directy to each ?
</I>&gt;<i>
</I>&gt;<i> For now i have :
</I>&gt;<i> - 100GB of disk available for cache
</I>&gt;<i> - 40GB   of RAM (let 8 for OS + squid disk cache related ram usage)
</I>&gt;<i>
</I>&gt;<i> 1 front with the RAM cache and 4 back with disk cache.
</I>&gt;<i> AUFS or ROCK cache? mix of them ? 50% each ? maybe another rules ?
</I>&gt;<i> (i think it's will be linked to the cache content but any advise or
</I>&gt;<i> method is welcome)
</I>&gt;<i>
</I>&gt;<i> I can get more speed and/or space for disk cache using SAN, do you
</I>&gt;<i> know if the data is sequential or random ?
</I>&gt;<i>
</I>&gt;<i> Any advise/rules to increase the hit ratio ? :)
</I>&gt;<i> Any general advise/rules ?
</I>&gt;<i>
</I>&gt;<i> Thanks for your help
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Jean Christophe VENTURA
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJWdbHPAAoJENNXIZxhPexGizoIAM3CBf4DkJKybKh25ST4DBrz
2h790u7XgUpKrUYq+aZ4X1m55hNHsIgdOtsNpNXSZUtoYyCSRwM0nSYLHPm47Ov4
31nkO3/7hYfQoOkw514ZwGvI8YfkZJhBUZ8Nupev3HoRpbPMFf6XGaRji2LIFine
tne5JrOkQb2fkY0ev1FakPW8qcEzNtgDHC/2aoumxaq2MSKCPz34+j4W1QBYUDgy
ob7Dt7iT2bXb2pfLyXETY5K/7rznBLcMXcAaXcT6gxTOjGUpHZyq/QuZK4Db6WoD
45PwJelTkoSz8HFzajW6Du/5XItxejcLzvJq0X/wMzCvMFJaLzaL+FU49raDUl8=
=J9OH
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008396.html">[squid-users] Fwd: Squid configuration advise
</A></li>
	<LI>Next message (by thread): <A HREF="008398.html">[squid-users] Fwd: Squid configuration advise
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8397">[ date ]</a>
              <a href="thread.html#8397">[ thread ]</a>
              <a href="subject.html#8397">[ subject ]</a>
              <a href="author.html#8397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
