<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Host header forgery affects pure splice environment too?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Host%20header%20forgery%20affects%20pure%20splice%0A%20environment%20too%3F&In-Reply-To=%3C56807800.6040508%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008428.html">
   <LINK REL="Next"  HREF="008432.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Host header forgery affects pure splice environment too?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Host%20header%20forgery%20affects%20pure%20splice%0A%20environment%20too%3F&In-Reply-To=%3C56807800.6040508%40measurement-factory.com%3E"
       TITLE="[squid-users] Host header forgery affects pure splice environment too?">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Dec 27 23:45:04 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008428.html">[squid-users] Host header forgery affects pure splice environment too?
</A></li>
        <LI>Next message (by thread): <A HREF="008432.html">[squid-users] Host header forgery affects pure splice environment too?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8429">[ date ]</a>
              <a href="thread.html#8429">[ thread ]</a>
              <a href="subject.html#8429">[ subject ]</a>
              <a href="author.html#8429">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/27/2015 03:13 PM, Jason Haar wrote:
&gt;<i> Surely if all you are doing is
</I>&gt;<i> splice-only, it shouldn't be doing that check at all?
</I>

The situation is not that black-and-white, unfortunately. This general
problem can be viewed under several different angles:

A. You are not using a splice-only configuration.

As you said, you are peeking at SNI before splicing. Thus, your overall
configuration (and Squid involvement) is much more complex than
&quot;splice-only&quot;. Pure splicing would have worked fine (or would fail for
different reasons).


B. Your splicing intent is unknown to Squid.

There are several common reasons for splicing, including:

1.  To avoid bumping things that cannot or should not be bumped.
2a. To log connection details.
2b. To return errors when connections fail certain validation checks.


C. Your final action may be unknown to validating Squid.

During a &quot;peek&quot; or &quot;stare&quot; action, Squid does not yet know whether the
final SslBump action is going to be &quot;splice&quot;, &quot;bump&quot;, or &quot;terminate&quot;.
Thus, even if we manage to agree that &quot;splice&quot; means &quot;check nothing&quot;,
Squid would not be able to apply that agreement to the &quot;peek&quot; action,
unless we also agree that &quot;peek&quot; means &quot;check nothing&quot;.

And if neither peek nor splice should check anything, then how can an
admin rewrite her currently-working configuration that validates server
certificates without bumping connections to sites that pass validation?


AFAICT, given the above mixture, Squid cannot reliably determine your
true peeking-and-splicing intent and disable the right set of checks
accordingly while supporting everything it already supports. Do we need
more configuration knobs to help Squid to make the right decision?

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008428.html">[squid-users] Host header forgery affects pure splice environment too?
</A></li>
	<LI>Next message (by thread): <A HREF="008432.html">[squid-users] Host header forgery affects pure splice environment too?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8429">[ date ]</a>
              <a href="thread.html#8429">[ thread ]</a>
              <a href="subject.html#8429">[ subject ]</a>
              <a href="author.html#8429">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
