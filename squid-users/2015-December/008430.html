<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Refresh pattern issue in squid 3.1.20
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Refresh%20pattern%20issue%20in%20squid%203.1.20&In-Reply-To=%3CCA%2B86yMj103mX7674_rep-Q9i-sNWyrOgf83PFWce7weeTevrTw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008487.html">
   <LINK REL="Next"  HREF="008431.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Refresh pattern issue in squid 3.1.20</H1>
    <B>SaRaVanAn</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Refresh%20pattern%20issue%20in%20squid%203.1.20&In-Reply-To=%3CCA%2B86yMj103mX7674_rep-Q9i-sNWyrOgf83PFWce7weeTevrTw%40mail.gmail.com%3E"
       TITLE="[squid-users] Refresh pattern issue in squid 3.1.20">saravanan.nagarajan87 at gmail.com
       </A><BR>
    <I>Mon Dec 28 00:30:57 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008487.html">[squid-users] Host header forgery affects pure splice	environment too?
</A></li>
        <LI>Next message (by thread): <A HREF="008431.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8430">[ date ]</a>
              <a href="thread.html#8430">[ thread ]</a>
              <a href="subject.html#8430">[ subject ]</a>
              <a href="author.html#8430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
We are using squid 3.1.20 in our box. We are facing issues on configuring
and validating the refresh patterns. It looks like squid is not honoring
the refresh patterns properly.


*configuration*
*refresh_pattern -i ^<A HREF="http://.wsj./.*">http://.wsj./.*</A> 10 200% 10 override-expire
override-lastmod reload-into-ims ignore-reload*
refresh_pattern -i \.(gif|png|jpg|jpeg|ico)$ 480 100% 480 override-expire
override-lastmod reload-into-ims
refresh_pattern -i \.(htm|html|js|css)$ 480 100% 480 override-expire
override-lastmod reload-into-ims

refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320


As per above refresh pattern squid should refresh the cache every ten
minutes for &quot;*^<A HREF="http://.wsj./.*">http://.wsj./.*</A>&quot; .  *But I am always getting either
TCP_HIT/TCP_MEM_HIT even after hours. Why is it so? . Please find the logs
below

*Log*

1261741.309      0 172.19.131.180 TCP_MEM_HIT/200 7635 GET
<A HREF="http://si.wsj.net/public/resources/images/BN-LW172_DRO">http://si.wsj.net/public/resources/images/BN-LW172_DRO</A>
<A HREF="http://si.wsj.net/public/resources/images/BN-LV628_CITIOF_BR_20151223170624.jpg">http://si.wsj.net/public/resources/images/BN-LV628_CITIOF_BR_20151223170624.jpg</A>
- NONE/- image/jpeg
1451261741.336      0 172.19.131.180 TCP_HIT/200 10595 GET
<A HREF="http://si.wsj.net/public/resources/images/MI-CN459_ELNINO_BR_20151227175637.jpg">http://si.wsj.net/public/resources/images/MI-CN459_ELNINO_BR_20151227175637.jpg</A>
- NONE/- image/jpeg
1451261741.343      0 172.19.131.180 TCP_MEM_HIT/200 3986 GET
<A HREF="http://si.wsj.net/public/resources/images/BN-LV846_Tape_0_Z120_20151224145546.jpg">http://si.wsj.net/public/resources/images/BN-LV846_Tape_0_Z120_20151224145546.jpg</A>
- NONE/- image/jpeg
1451261741.354      0 172.19.131.180 TCP_MEM_HIT/200 3432 GET
<A HREF="http://si.wsj.net/public/resources/images/BN-LV849_Oileco_Z120_20151224150223.jpg">http://si.wsj.net/public/resources/images/BN-LV849_Oileco_Z120_20151224150223.jpg</A>
- NONE/- image/jpeg
1451261741.361      0 172.19.131.180 TCP_MEM_HIT/200 2385 GET
<A HREF="http://video-api.wsj.com/api-video/player/v2/css/play_btn_80.png">http://video-api.wsj.com/api-video/player/v2/css/play_btn_80.png</A> - NONE/-
image/png
1451261741.389      0 172.19.131.180 TCP_MEM_HIT/200 1675 GET
<A HREF="http://video-api.wsj.com/api-video/player/v2/css/play_btn_50.png">http://video-api.wsj.com/api-video/player/v2/css/play_btn_50.png</A> - NONE/-
image/png
1451261741.407    756 172.19.131.180 TCP_HIT/200 534151 GET
<A HREF="http://vir.wsj.net/fp/assets/1e6e09e66457156e0903/SectionPage.js">http://vir.wsj.net/fp/assets/1e6e09e66457156e0903/SectionPage.js</A> - NONE/-
application/javascript
1451261742.341     51 172.19.131.180 TCP_HIT/200 65486 GET
<A HREF="http://m.wsj.net/video/20151227/122715storms/122715storms_960x540.jpg">http://m.wsj.net/video/20151227/122715storms/122715storms_960x540.jpg</A> -
NONE/- image/jpeg
1451261742.428    132 172.19.131.180 TCP_HIT/200 53668 GET
<A HREF="http://m.wsj.net/video/20151223/121415barpilots/121415barpilots_960x540.jpg">http://m.wsj.net/video/20151223/121415barpilots/121415barpilots_960x540.jpg</A>
- NONE/
NE1_D_20151227175102.jpg - NONE/- image/jpeg
1451261741.310      0 172.19.131.180 TCP_MEM_HIT/200 8302 GET
<A HREF="http://si.wsj.net/public/resources/images/BN-LW104_itarge_D_20151227070713.jpg">http://si.wsj.net/public/resources/images/BN-LW104_itarge_D_20151227070713.jpg</A>
- NONE/- image/jpeg
1451261741.318      0 172.19.131.180 TCP_HIT/200 12217 GET
<A HREF="http://si.wsj.net/public/resources/images/BN-LW010_OVERST_D_20151225160015.jpg">http://si.wsj.net/public/resources/images/BN-LW010_OVERST_D_20151225160015.jpg</A>
- NONE/- image/jpeg


Regards,
Saravanan N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151227/2c43eb2c/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151227/2c43eb2c/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008487.html">[squid-users] Host header forgery affects pure splice	environment too?
</A></li>
	<LI>Next message (by thread): <A HREF="008431.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8430">[ date ]</a>
              <a href="thread.html#8430">[ thread ]</a>
              <a href="subject.html#8430">[ subject ]</a>
              <a href="author.html#8430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
