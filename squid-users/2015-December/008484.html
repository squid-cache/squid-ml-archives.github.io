<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Refresh pattern issue in squid 3.1.20
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Refresh%20pattern%20issue%20in%20squid%203.1.20&In-Reply-To=%3CCA%2B86yMiqcM_6sioa1Qq-tNHoxfLsx%3D5BH7ENDTz8jzLDncDJ1A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008441.html">
   <LINK REL="Next"  HREF="008496.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Refresh pattern issue in squid 3.1.20</H1>
    <B>SaRaVanAn</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Refresh%20pattern%20issue%20in%20squid%203.1.20&In-Reply-To=%3CCA%2B86yMiqcM_6sioa1Qq-tNHoxfLsx%3D5BH7ENDTz8jzLDncDJ1A%40mail.gmail.com%3E"
       TITLE="[squid-users] Refresh pattern issue in squid 3.1.20">saravanan.nagarajan87 at gmail.com
       </A><BR>
    <I>Wed Dec 30 22:48:38 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008441.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
        <LI>Next message (by thread): <A HREF="008496.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8484">[ date ]</a>
              <a href="thread.html#8484">[ thread ]</a>
              <a href="subject.html#8484">[ subject ]</a>
              <a href="author.html#8484">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, All,
I tired suggested refresh pattern, still i was getting TCP_HIT/MEM_HIT.
It's not getting refreshed after 10 minutes.


*Conf*
refresh_pattern -i ^<A HREF="http://[a-z\-\_\.A-Z0-9">http://[a-z\-\_\.A-Z0-9</A>]+\.wsj\.(net|net|com|edu)/ 10
200% 10 override-expire override-lastmod reload-into-ims ignore-reload

*Logs*


Wed Dec 30 21:31:44 2015.976   1915 172.19.131.180 TCP_MISS/200 619 GET
<A HREF="http://s.wsj.net/javascript/pushdownAd.js">http://s.wsj.net/javascript/pushdownAd.js</A> - DIRECT/184.86.240.217
application/x-javascript
*Wed Dec 30 21:31:44 2015.976   1915 172.19.131.180 TCP_MISS/200 667 GET
<A HREF="http://s.wsj.net/static_html_files/pushdownAd.css">http://s.wsj.net/static_html_files/pushdownAd.css</A>
&lt;<A HREF="http://s.wsj.net/static_html_files/pushdownAd.css">http://s.wsj.net/static_html_files/pushdownAd.css</A>&gt; - DIRECT/184.86.240.217
&lt;<A HREF="http://184.86.240.217">http://184.86.240.217</A>&gt; text/css*
*Wed Dec 30 21:52:38 2015.577      0 172.19.131.180 TCP_MEM_HIT/200 676 GET
<A HREF="http://s.wsj.net/static_html_files/pushdownAd.css">http://s.wsj.net/static_html_files/pushdownAd.css</A>
&lt;<A HREF="http://s.wsj.net/static_html_files/pushdownAd.css">http://s.wsj.net/static_html_files/pushdownAd.css</A>&gt; - NONE/- text/css*
Wed Dec 30 21:52:38 2015.577      0 172.19.131.180 TCP_MEM_HIT/200 628 GET
<A HREF="http://s.wsj.net/javascript/pushdownAd.js">http://s.wsj.net/javascript/pushdownAd.js</A> - NONE/- application/x-javascript


I have gone through the packet captures. It looks like expiry time is
greater than min time of refresh_pattern. But i have used override options.
Here  I am confused whether precedence goes to expiry time or min time .I
am not clear on how it works.

Can you guide me on how it works and why it is not getting refreshed ? I
need experts guidance here


*pushdownAd.css repsonse header timings*

Last-Modified: Mon, 14 Dec 2015 04:37:00 GMT\r\n

Expires: Thu, 31 Dec 2015 01:10:17 GMT\r\n

Date: Wed, 30 Dec 2015 21:31:46 GMT\r\n

Regards,
Saravanan N

On Mon, Dec 28, 2015 at 6:13 AM, Matus UHLAR - fantomas &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A>&gt;
wrote:

&gt;<i> On 28.12.15 06:50, Eliezer Croitoru wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> And you can tweak it a bit to something like:
</I>&gt;&gt;<i> refresh_pattern -i ^<A HREF="http://[a-z\-\_\.A-Z0-9">http://[a-z\-\_\.A-Z0-9</A>]+\.wsj\.(net|net|com|edu)/
</I>&gt;&gt;<i> 10 200% 10 \
</I>&gt;&gt;<i>         override-expire reload-into-ims
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> - I would avoid the underscore. underscore is not valid character for an
</I>&gt;<i> internet hostname
</I>&gt;<i> - dash at the begin or end of [] will eliminate the need for an underscore
</I>&gt;<i>
</I>&gt;<i> [a-zA-Z0-9.-]+ should do it.
</I>&gt;<i> --
</I>&gt;<i> Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
</I>&gt;<i> Warning: I wish NOT to receive e-mail advertising to this address.
</I>&gt;<i> Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
</I>&gt;<i> &quot;To Boot or not to Boot, that's the question.&quot; [WD1270 Caviar]
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151230/54cc591a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151230/54cc591a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008441.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
	<LI>Next message (by thread): <A HREF="008496.html">[squid-users] Refresh pattern issue in squid 3.1.20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8484">[ date ]</a>
              <a href="thread.html#8484">[ thread ]</a>
              <a href="subject.html#8484">[ subject ]</a>
              <a href="author.html#8484">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
