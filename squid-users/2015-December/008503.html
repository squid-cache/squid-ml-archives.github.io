<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] youtube video, caching, disabling QUIC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20youtube%20video%2C%20caching%2C%20disabling%20QUIC&In-Reply-To=%3COFAB8639EA.6EC153C3-ONC1257F2C.0048CEDE-C1257F2C.004B8860%40asl.bergamo.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008488.html">
   <LINK REL="Next"  HREF="008504.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] youtube video, caching, disabling QUIC</H1>
    <B>Massimo.Sala at asl.bergamo.it</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20youtube%20video%2C%20caching%2C%20disabling%20QUIC&In-Reply-To=%3COFAB8639EA.6EC153C3-ONC1257F2C.0048CEDE-C1257F2C.004B8860%40asl.bergamo.it%3E"
       TITLE="[squid-users] youtube video, caching, disabling QUIC">Massimo.Sala at asl.bergamo.it
       </A><BR>
    <I>Thu Dec 31 13:45:17 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008488.html">[squid-users] ip-based ACL under transparent mode
</A></li>
        <LI>Next message (by thread): <A HREF="008504.html">[squid-users] youtube video, caching, disabling QUIC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8503">[ date ]</a>
              <a href="thread.html#8503">[ thread ]</a>
              <a href="subject.html#8503">[ subject ]</a>
              <a href="author.html#8503">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When you request a video on Youtube, its web servers send two new HTTP 
headers to the browser :

        alt-svc
        alternate-protocol

suggesting to the browser to switch to the new protocol QUIC.


Unfortunately

1) QUIC, working over UDP, is not cacheable by squid 3.4

2) even if cacheable, IT admins have to upgrade many tools to support and 
account videos over QUIC ( proxy, firewall, bandwidth shaping, etc... )

See :
        <A HREF="http://wiki.squid-cache.org/KnowledgeBase/Block%20QUIC%20protocol">http://wiki.squid-cache.org/KnowledgeBase/Block%20QUIC%20protocol</A>


We want to disable QUIC, so the servers and browsers fallbacks to normal 
HTTP for videos.

---

I asked in another thread

        3) support for Alternate-Protocol HTTP header.


Amos' answer :

As for #3, the Alternate-Protocol header patch is just automating these 
squid.conf settings, which you can use explicitly in any Squid version:

  acl AP rep_header_regex Alternate-Protocol .
  reply_header_access deny AP


With that syntax :

squid3 -k reconfigure

2015/12/31 14:34:21| FATAL: Invalid ACL type 'rep_header_regex'
FATAL: Bungled /etc/squid3/squid.conf line 43: acl AP rep_header_regex 
alternate-protocol .
Squid Cache (Version 3.4.8): Terminated abnormally.
CPU Usage: 0.016 seconds = 0.008 user + 0.008 sys
Maximum Resident Size: 37936 KB
Page faults with physical i/o: 0



Is it rep_header, not rep_header_regex ?

Is it reply_header_access with 3 parameters ?

&gt;<i>From 
</I><A HREF="http://www.squid-cache.org/Versions/v3/3.4/cfgman/reply_header_access.html">http://www.squid-cache.org/Versions/v3/3.4/cfgman/reply_header_access.html</A>
        Usage: reply_header_access header_name allow|deny [!]aclname ...


Which is the correct syntax to suppress in the replies these headers ?
        alt-svc
        alternate-protocol

best regards, Sala


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008488.html">[squid-users] ip-based ACL under transparent mode
</A></li>
	<LI>Next message (by thread): <A HREF="008504.html">[squid-users] youtube video, caching, disabling QUIC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8503">[ date ]</a>
              <a href="thread.html#8503">[ thread ]</a>
              <a href="subject.html#8503">[ subject ]</a>
              <a href="author.html#8503">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
