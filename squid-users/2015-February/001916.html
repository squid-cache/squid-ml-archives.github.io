<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Order of http_access allow/deny
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Order%20of%20http_access%20allow/deny&In-Reply-To=%3C54D20CFD.1060000%40solutti.com.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001915.html">
   <LINK REL="Next"  HREF="001918.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Order of http_access allow/deny</H1>
    <B>Leonardo Rodrigues</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Order%20of%20http_access%20allow/deny&In-Reply-To=%3C54D20CFD.1060000%40solutti.com.br%3E"
       TITLE="[squid-users] Order of http_access allow/deny">leolistas at solutti.com.br
       </A><BR>
    <I>Wed Feb  4 12:13:49 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001915.html">[squid-users] Order of http_access allow/deny
</A></li>
        <LI>Next message (by thread): <A HREF="001918.html">[squid-users] Antwort: Re:  Order of http_access allow/deny
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1916">[ date ]</a>
              <a href="thread.html#1916">[ thread ]</a>
              <a href="subject.html#1916">[ subject ]</a>
              <a href="author.html#1916">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/02/15 09:19, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">Andreas.Reschke at mahle.com</A> wrote:
&gt;<i> Hi there,
</I>&gt;<i> Is there a order of http_access allow/deny? If I activate &quot;http_access 
</I>&gt;<i> deny !chkglwebhttp&quot; nobody can use the proxy, squid allways ask for 
</I>&gt;<i> user and password (user and password is correct)
</I>&gt;<i>
</I>&gt;<i> ######
</I>&gt;<i> acl chkglwebhttp external LDAPLookup GGPY-LO-Web-Http
</I>&gt;<i> acl sellingUser external LDAPLookup GGPY-LO-Web-Allowed-Selling
</I>&gt;<i> acl socialUser external LDAPLookup GGPY-LO-Web-Allowed-Social
</I>&gt;<i> acl allforbUser external LDAPLookup GGPY-LO-Web-Allowed-All
</I>&gt;<i> acl ftpputUser external LDAPLookup GGPY-LO-Web-Ftp-Put
</I>&gt;<i> acl loggingUser external LDAPLookup GGPY-LO-Web-Log-User
</I>&gt;<i> acl auth proxy_auth REQUIRED
</I>&gt;<i> acl permitt_ips src 10.143.10.247/32
</I>&gt;<i> acl FTP proto FTP
</I>&gt;<i> acl PUT method PUT
</I>&gt;<i>
</I>&gt;<i> # whitelisten
</I>&gt;<i> http_access allow open-sites all
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> http_access allow permitt_ips !denied-sites !social-sites
</I>&gt;<i> http_access allow indien DAY
</I>&gt;<i> http_access deny indien
</I>&gt;<i> #http_access deny !chkglwebhttp
</I>&gt;<i> http_access allow selling-sites sellingUser
</I>&gt;<i> http_access allow social-sites socialUser
</I>
     Actually, and i dont know if this a bug or a desired behavior, 
denying a group seems to always (at least to me) brings the 
authentication popup. To avoid that and make things really work as 
expected, i usually add an 'all' to the denying clause. As the 'all' 
rule will match anything, it wont change the denying or not of your 
rule. And it will make things work. Actually this hint was found on the 
mailing list archives.

     So, instead of

http_access deny !chkglwebhttp

     try using

http_access deny !chkglwebhttp all

     if your 'indien' acl, which is also used on a deny rule, is also a 
group rule (that cannot be confirmed on the conf you posted), just add 
the all as well. In summary, always add an 'all' to an http_access rule 
which envolves denying by any king of group checking.





-- 


	Atenciosamente / Sincerily,
	Leonardo Rodrigues
	Solutti Tecnologia
	<A HREF="http://www.solutti.com.br">http://www.solutti.com.br</A>

	Minha armadilha de SPAM, N&#195;O mandem email
	<A HREF="https://lists.squid-cache.org/listinfo/squid-users">gertrudes at solutti.com.br</A>
	My SPAMTRAP, do not email it


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150204/3472a509/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150204/3472a509/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001915.html">[squid-users] Order of http_access allow/deny
</A></li>
	<LI>Next message (by thread): <A HREF="001918.html">[squid-users] Antwort: Re:  Order of http_access allow/deny
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1916">[ date ]</a>
              <a href="thread.html#1916">[ thread ]</a>
              <a href="subject.html#1916">[ subject ]</a>
              <a href="author.html#1916">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
