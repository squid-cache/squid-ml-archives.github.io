<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Correct order of acl rules?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Correct%20order%20of%20acl%20rules%3F&In-Reply-To=%3C54D513A8.2010606%40mathemainzel.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001971.html">
   <LINK REL="Next"  HREF="001973.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Correct order of acl rules?</H1>
    <B>Walter H.</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Correct%20order%20of%20acl%20rules%3F&In-Reply-To=%3C54D513A8.2010606%40mathemainzel.info%3E"
       TITLE="[squid-users] Correct order of acl rules?">Walter.H at mathemainzel.info
       </A><BR>
    <I>Fri Feb  6 19:19:04 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001971.html">[squid-users] Tunnelled devices losing access to squid
</A></li>
        <LI>Next message (by thread): <A HREF="001973.html">[squid-users] Correct order of acl rules?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1972">[ date ]</a>
              <a href="thread.html#1972">[ thread ]</a>
              <a href="subject.html#1972">[ subject ]</a>
              <a href="author.html#1972">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

my squid.conf contains the following lines - in this order ...

acl allow_urlpaths urlpath_regex -i 
&quot;/etc/squid/allowurlpaths-regex-acl.squid&quot;
acl block_urlpaths urlpath_regex -i 
&quot;/etc/squid/blockurlpaths-regex-acl.squid&quot;
acl allow_urls url_regex -i &quot;/etc/squid/allowurls-regex-acl.squid&quot; &lt;--
acl block_urls url_regex -i &quot;/etc/squid/blockurls-regex-acl.squid&quot; &lt;--
acl allow_domains_list dstdomain &quot;/etc/squid/allowdomains-list-acl.squid&quot;
acl block_domains_list dstdomain &quot;/etc/squid/blockdomains-list-acl.squid&quot;
acl block_domains_listex dstdomain 
&quot;/etc/squid/blockdomains-listex-acl.squid&quot;
acl allow_domains_regex dstdom_regex -i 
&quot;/etc/squid/allowdomains-regex-acl.squid&quot;
acl block_domains_regex dstdom_regex -i 
&quot;/etc/squid/blockdomains-regex-acl.squid&quot;
deny_info ERR_URL_BLOCKED block_urlpaths
deny_info ERR_URL_BLOCKED block_urls
deny_info ERR_DOMAIN_BLOCKED block_domains_list
deny_info ERR_DOMAIN_BLOCKED block_domains_listex
deny_info ERR_DOMAIN_BLOCKED block_domains_regex
http_access allow allow_urlpaths
http_access deny block_urlpaths
http_access allow allow_urls &lt;--
http_access deny block_urls &lt;--
http_access allow allow_domains_list
http_access deny block_domains_list
http_access deny block_domains_listex
http_access allow allow_domains_regex
http_access deny block_domains_regex

I marked 4 lines and I get a quite strange - or correct - behaviour ...

the file blockurls-regex-acl.squid
contains e.g.
^http:\/\/s[0-9]\.domain\.tld\/

the file allowurls-regex-acl.squid
contains e.g.
^http:\/\/s[1-2]+\.domain\.tld\/[a-z0-9\_\-\.]+\.gif

the purpose should be, that only gif images of root directory of only 
the subdomains beginning with s1 or s2 of domain.tld should be allowed

the following url is blocked

<A HREF="http://s2443.domain.tld/ghfhfhf.gif">http://s2443.domain.tld/ghfhfhf.gif</A>

why?

Thanks,
Walter


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 5971 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150206/c8be98fa/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150206/c8be98fa/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001971.html">[squid-users] Tunnelled devices losing access to squid
</A></li>
	<LI>Next message (by thread): <A HREF="001973.html">[squid-users] Correct order of acl rules?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1972">[ date ]</a>
              <a href="thread.html#1972">[ thread ]</a>
              <a href="subject.html#1972">[ subject ]</a>
              <a href="author.html#1972">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
