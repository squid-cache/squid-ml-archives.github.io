<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] kid registration timed out
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20kid%20registration%20timed%20out&In-Reply-To=%3C54D92689.4020005%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002006.html">
   <LINK REL="Next"  HREF="002020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] kid registration timed out</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20kid%20registration%20timed%20out&In-Reply-To=%3C54D92689.4020005%40treenet.co.nz%3E"
       TITLE="[squid-users] kid registration timed out">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Feb  9 21:28:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002006.html">[squid-users] kid registration timed out
</A></li>
        <LI>Next message (by thread): <A HREF="002020.html">[squid-users] kid registration timed out
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2011">[ date ]</a>
              <a href="thread.html#2011">[ thread ]</a>
              <a href="subject.html#2011">[ subject ]</a>
              <a href="author.html#2011">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/02/2015 5:11 a.m., Alfredo Rezinovsky wrote:
&gt;<i> I have one of these lines for each cache disc (sdb, sdc, etc)
</I>&gt;<i> 
</I>&gt;<i> cache_dir aufs /cache/sdb/${process_number} 230000 16 256 min-size=1
</I>&gt;<i> max-size=838860800
</I>&gt;<i> 
</I>&gt;<i> I'm using 4 or 5 discs to increase the cache I/O.
</I>&gt;<i> 
</I>&gt;<i> The cach&#233; size is a little less than disk_size/workers
</I>&gt;<i> 
</I>&gt;<i> There's a way to run a full store rebuild and exit. So I'm sure the stores
</I>&gt;<i> are clean after starting the real squid and enabling transparent proxy
</I>&gt;<i> iptables rules?
</I>
I already mentioned to you about disk I/O contention right?

The rule-of-thumb about one cache_dir per physical disk spindle is not
removed by multiple workers. A *single* Squid process can push any disk
hardware to its bare-metal I/O write capacity. Sharing between workers
just makes disks cap-out faster.


During that startup all Squid is doing with those disks is reading the
swap.state files from each AUFS cache_dir and scanning across the rock
cache_dir slots in MB sized chunks. Provided you are right about the
caches being clean (having a non-corrupt swap.state journal).

 ... why do you think increasing the number of workers makes them slow
down until one hits that 10 second timeout?

And consider what would happen later when your full network bandwidth
get thrown at the workers (hint approx. 4/5 of network I/O gets written
to disk).

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002006.html">[squid-users] kid registration timed out
</A></li>
	<LI>Next message (by thread): <A HREF="002020.html">[squid-users] kid registration timed out
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2011">[ date ]</a>
              <a href="thread.html#2011">[ thread ]</a>
              <a href="subject.html#2011">[ subject ]</a>
              <a href="author.html#2011">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
