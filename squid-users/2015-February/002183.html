<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/logs/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3CCALTPfpH56aP8RRUkXtoY5N3d-7R68MW81iYiDtAg_huHGBg9tA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002181.html">
   <LINK REL="Next"  HREF="002194.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)</H1>
    <B>Priya Agarwal</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/logs/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3CCALTPfpH56aP8RRUkXtoY5N3d-7R68MW81iYiDtAg_huHGBg9tA%40mail.gmail.com%3E"
       TITLE="[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)">priyaiitmandi at gmail.com
       </A><BR>
    <I>Fri Feb 13 11:45:18 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002181.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
        <LI>Next message (by thread): <A HREF="002194.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2183">[ date ]</a>
              <a href="thread.html#2183">[ thread ]</a>
              <a href="subject.html#2183">[ subject ]</a>
              <a href="author.html#2183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# chown -R nobody:nogroup /var/logs
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# /usr/sbin/squid -k parse
2015/02/13 12:27:14| Startup: Initializing Authentication Schemes ...
2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'basic'
2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'digest'
2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'negotiate'
2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'ntlm'
2015/02/13 12:27:14| Startup: Initialized Authentication.
2015/02/13 12:27:14| Processing Configuration File: /etc/squid.conf (depth
0)
2015/02/13 12:27:14| Processing: cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">priyaiitmandi at gmail.com</A>
2015/02/13 12:27:14| Processing: visible_hostname t4240qds
2015/02/13 12:27:14| Processing: cache_effective_user nobody
2015/02/13 12:27:14| Processing: dns_nameservers 8.8.8.8
2015/02/13 12:27:14| Processing: acl mynet src 10.116.65.0/24
2015/02/13 12:27:14| Processing: acl localnet src 10.0.0.0/8    # RFC1918
possible internal network
2015/02/13 12:27:14| Processing: acl localnet src 172.16.0.0/12    #
RFC1918 possible internal network
2015/02/13 12:27:14| Processing: acl localnet src 192.168.0.0/16    #
RFC1918 possible internal network
2015/02/13 12:27:14| Processing: acl localnet src fc00::/7       # RFC 4193
local private network range
2015/02/13 12:27:14| Processing: acl localnet src fe80::/10      # RFC 4291
link-local (directly plugged) machines
2015/02/13 12:27:14| Processing: acl SSL_ports port 443
2015/02/13 12:27:14| Processing: acl Safe_ports port 80        # http
2015/02/13 12:27:14| Processing: acl Safe_ports port 21        # ftp
2015/02/13 12:27:14| Processing: acl Safe_ports port 443        # https
2015/02/13 12:27:14| Processing: acl Safe_ports port 70        # gopher
2015/02/13 12:27:14| Processing: acl Safe_ports port 210        # wais
2015/02/13 12:27:14| Processing: acl Safe_ports port 1025-65535    #
unregistered ports
2015/02/13 12:27:14| Processing: acl Safe_ports port 280        # http-mgmt
2015/02/13 12:27:14| Processing: acl Safe_ports port 488        # gss-http
2015/02/13 12:27:14| Processing: acl Safe_ports port 591        # filemaker
2015/02/13 12:27:14| Processing: acl Safe_ports port 777        # multiling
http
2015/02/13 12:27:14| Processing: acl CONNECT method CONNECT
2015/02/13 12:27:14| Processing: http_access deny !Safe_ports
2015/02/13 12:27:14| Processing: http_access deny CONNECT !SSL_ports
2015/02/13 12:27:14| Processing: http_access allow localhost manager
2015/02/13 12:27:14| Processing: http_access deny manager
2015/02/13 12:27:14| Processing: http_access allow mynet
2015/02/13 12:27:14| Processing: http_access allow localnet
2015/02/13 12:27:14| Processing: http_access allow localhost
2015/02/13 12:27:14| Processing: http_access deny all
2015/02/13 12:27:14| Processing: http_port 10.116.65.155:8080
2015/02/13 12:27:14| Processing: cache_dir ufs /var/cache/squid 100 16 256
2015/02/13 12:27:14| Processing: coredump_dir /var/cache/squid
2015/02/13 12:27:14| Processing: refresh_pattern ^ftp:        1440
20%    10080
2015/02/13 12:27:14| Processing: refresh_pattern ^gopher:    1440    0%
1440
2015/02/13 12:27:14| Processing: refresh_pattern -i (/cgi-bin/|\?) 0
0%    0
2015/02/13 12:27:14| Processing: refresh_pattern .        0    20%    4320
WARNING: Cannot write log file: /var/logs/cache.log
/var/logs/cache.log: Permission denied
         messages will be sent to 'stderr'.
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# ls -ld /var/logs
drwx------ 2 nobody nogroup 4096 Feb 13 11:49 /var/logs


On Fri, Feb 13, 2015 at 5:12 PM, Priya Agarwal &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">priyaiitmandi at gmail.com</A>&gt;
wrote:

&gt;<i> Then It is unable to write cache.log:
</I>&gt;<i> Here is the output:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# /usr/sbin/squid -k parse
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initializing Authentication Schemes ...
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'basic'
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'digest'
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'negotiate'
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'ntlm'
</I>&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication.
</I>&gt;<i> 2015/02/13 12:27:14| Processing Configuration File: /etc/squid.conf (depth
</I>&gt;<i> 0)
</I>&gt;<i> 2015/02/13 12:27:14| Processing: cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">priyaiitmandi at gmail.com</A>
</I>&gt;<i> 2015/02/13 12:27:14| Processing: visible_hostname t4240qds
</I>&gt;<i> 2015/02/13 12:27:14| Processing: cache_effective_user nobody
</I>&gt;<i> 2015/02/13 12:27:14| Processing: dns_nameservers 8.8.8.8
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl mynet src 10.116.65.0/24
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl localnet src 10.0.0.0/8    # RFC1918
</I>&gt;<i> possible internal network
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl localnet src 172.16.0.0/12    #
</I>&gt;<i> RFC1918 possible internal network
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl localnet src 192.168.0.0/16    #
</I>&gt;<i> RFC1918 possible internal network
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl localnet src fc00::/7       # RFC
</I>&gt;<i> 4193 local private network range
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl localnet src fe80::/10      # RFC
</I>&gt;<i> 4291 link-local (directly plugged) machines
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl SSL_ports port 443
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 80        # http
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 21        # ftp
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 443        # https
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 70        # gopher
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 210        # wais
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 1025-65535    #
</I>&gt;<i> unregistered ports
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 280        # http-mgmt
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 488        # gss-http
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 591        # filemaker
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl Safe_ports port 777        #
</I>&gt;<i> multiling http
</I>&gt;<i> 2015/02/13 12:27:14| Processing: acl CONNECT method CONNECT
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access deny !Safe_ports
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access deny CONNECT !SSL_ports
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access allow localhost manager
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access deny manager
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access allow mynet
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access allow localnet
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access allow localhost
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_access deny all
</I>&gt;<i> 2015/02/13 12:27:14| Processing: http_port 10.116.65.155:8080
</I>&gt;<i> 2015/02/13 12:27:14| Processing: cache_dir ufs /var/cache/squid 100 16 256
</I>&gt;<i> 2015/02/13 12:27:14| Processing: coredump_dir /var/cache/squid
</I>&gt;<i> 2015/02/13 12:27:14| Processing: refresh_pattern ^ftp:        1440
</I>&gt;<i> 20%    10080
</I>&gt;<i> 2015/02/13 12:27:14| Processing: refresh_pattern ^gopher:    1440    0%
</I>&gt;<i> 1440
</I>&gt;<i> 2015/02/13 12:27:14| Processing: refresh_pattern -i (/cgi-bin/|\?) 0
</I>&gt;<i> 0%    0
</I>&gt;<i> 2015/02/13 12:27:14| Processing: refresh_pattern .        0    20%    4320
</I>&gt;<i> WARNING: Cannot write log file: /var/logs/cache.log
</I>&gt;<i> /var/logs/cache.log: Permission denied
</I>&gt;<i>          messages will be sent to 'stderr'.
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# ls -ld /var/logs
</I>&gt;<i> drwx------ 2 nobody nogroup 4096 Feb 13 11:49 /var/logs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Feb 13, 2015 at 5:04 PM, Antony Stone &lt;
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">Antony.Stone at squid.open.source.it</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Friday 13 Feb 2015 at 11:06, Priya Agarwal wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; So sorry. In squid.conf I had done cache_effective_user to nobody and
</I>&gt;&gt;<i> set
</I>&gt;&gt;<i> &gt; permissions of /var and /usr to nobody. So those are the permissions.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Are you saying that /var is owned by 'nobody'?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That sounds like a problem for the system to me.  /var should be owned by
</I>&gt;&gt;<i> root; if you want to have subdirectories owned by 'nobody', or with
</I>&gt;&gt;<i> permissions to let 'nobody' write to them, that's okay, but I think /var
</I>&gt;&gt;<i> being
</I>&gt;&gt;<i> owned by 'nobody' will cause more problems than just for squid.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:/var/logs# ls -al /var/logs/access.log
</I>&gt;&gt;<i> &gt; ls: cannot access /var/logs/access.log: No such file or directory
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:/var/logs# ls -ld /var/logs
</I>&gt;&gt;<i> &gt; drwx------ 2 nobody nogroup 4096 Feb 13 11:49 /var/logs
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Maybe someone more familiar with squid than I am can comment on this, but
</I>&gt;&gt;<i> isn't the log file opened before squid drops its privileges (same as the
</I>&gt;&gt;<i> network sockets), so you don't actually need the logfile path to be
</I>&gt;&gt;<i> writable
</I>&gt;&gt;<i> by the squid_effective_user?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Antony.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> All generalisations are inaccurate.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>                                                    Please reply to the
</I>&gt;&gt;<i> list;
</I>&gt;&gt;<i>                                                          please *don't*
</I>&gt;&gt;<i> CC me.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150213/f91e0b05/attachment-0001.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150213/f91e0b05/attachment-0001.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002181.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
	<LI>Next message (by thread): <A HREF="002194.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2183">[ date ]</a>
              <a href="thread.html#2183">[ thread ]</a>
              <a href="subject.html#2183">[ subject ]</a>
              <a href="author.html#2183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
