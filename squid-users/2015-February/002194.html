<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/logs/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3C54DE6A23.6090800%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002183.html">
   <LINK REL="Next"  HREF="002199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/logs/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3C54DE6A23.6090800%40treenet.co.nz%3E"
       TITLE="[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Feb 13 21:18:27 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002183.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
        <LI>Next message (by thread): <A HREF="002199.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2194">[ date ]</a>
              <a href="thread.html#2194">[ thread ]</a>
              <a href="subject.html#2194">[ subject ]</a>
              <a href="author.html#2194">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/02/2015 12:45 a.m., Priya Agarwal wrote:
&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# chown -R nobody:nogroup /var/logs
</I>

STOP!!!


You are demonstrating in the last few posts that you do not understand
how the command line tools or the permissions work.

Please stop right now from doing anything on your own. This may take a
while to get your system working again, but it is still possible.

If you have anyone who has a lot of experience with the OS you are using
and the command line in particualr please get them to check over the
permissions in your entire /var directory structure.


We can help guide you through what needs to be done for Squid, but only
if you follow the advice exactly as given and not take other steps.



&gt;<i> WARNING: Cannot write log file: /var/logs/cache.log
</I>&gt;<i> /var/logs/cache.log: Permission denied
</I>&gt;<i>          messages will be sent to 'stderr'.
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# ls -ld /var/logs
</I>&gt;<i> drwx------ 2 nobody nogroup 4096 Feb 13 11:49 /var/logs
</I>&gt;<i> 
</I>
What that means is that the permissions have gotten all screwed up.

As Anthony mentioned your setting of them on /var/ screwed the entire
operating system from being able to write content in the /var directory
and subdirectories.


The top /var directory is always owned by root and group with full read
and execute permissions.

  chown root:root /var
  chmod 755 /var

  chown root:root /var/logs /var/cache /var/run
  chmod 755 /var/cache
  chmod 775 /var/logs


Your proxy is built with the default username of &quot;squid&quot;. So there
should be a system user and group by that name

  addgroup --system squid
  adduser --system --no-create-home \
      --disabled-login --disabled-password \
      --ingroup squid squid

If the add* commands complain about existing user/group that is okay.


then show us the output of:
  ls -la /var
  ls -la /var/logs


&gt;<i> 
</I>&gt;<i> On Fri, Feb 13, 2015 at 5:12 PM, Priya Agarwal wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Then It is unable to write cache.log:
</I>&gt;&gt;<i> Here is the output:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at t4240qds</A>:~# /usr/sbin/squid -k parse
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initializing Authentication Schemes ...
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'basic'
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'digest'
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'negotiate'
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication Scheme 'ntlm'
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Startup: Initialized Authentication.
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Processing Configuration File: /etc/squid.conf (depth
</I>&gt;&gt;<i> 0)
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Processing: cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">priyaiitmandi at gmail.com</A>
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Processing: visible_hostname t4240qds
</I>&gt;&gt;<i> 2015/02/13 12:27:14| Processing: cache_effective_user nobody
</I>

There is no need for that directive in your squid.conf file.

Your Squid is explicitly built with username &quot;squid&quot;.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002183.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
	<LI>Next message (by thread): <A HREF="002199.html">[squid-users] logfileHandleWrite: daemon:/var/logs/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2194">[ date ]</a>
              <a href="thread.html#2194">[ thread ]</a>
              <a href="subject.html#2194">[ subject ]</a>
              <a href="author.html#2194">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
