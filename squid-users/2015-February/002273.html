<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Error when using peek/splice/terminate with Squid 3.5.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20when%20using%20peek/splice/terminate%20with%20Squid%0A%203.5.1&In-Reply-To=%3C54E26C72.3000702%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002233.html">
   <LINK REL="Next"  HREF="002234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Error when using peek/splice/terminate with Squid 3.5.1</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20when%20using%20peek/splice/terminate%20with%20Squid%0A%203.5.1&In-Reply-To=%3C54E26C72.3000702%40treenet.co.nz%3E"
       TITLE="[squid-users] Error when using peek/splice/terminate with Squid 3.5.1">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Feb 16 22:17:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002233.html">[squid-users] Error when using peek/splice/terminate with Squid	3.5.1
</A></li>
        <LI>Next message (by thread): <A HREF="002234.html">[squid-users] Squid stopped logging to access.log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2273">[ date ]</a>
              <a href="thread.html#2273">[ thread ]</a>
              <a href="subject.html#2273">[ subject ]</a>
              <a href="author.html#2273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/02/2015 6:54 p.m., John Killimangalam Jacob wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> I am trying to configure an intercept proxy with
</I>&gt;<i> peek/splice/terminate features in Squid 3.5.1 on CentOS 7 - 64 bit. I
</I>&gt;<i> wanted to peak at steps 1 and step 2 and to decide on terminate on
</I>&gt;<i> step 3 based on the SNI and server certificate values. It is working
</I>&gt;<i> only for <A HREF="https://www.google.com,">https://www.google.com,</A> but lot of other ssl sites (likes of
</I>&gt;<i> <A HREF="https://www.yahoo.com">https://www.yahoo.com</A> etc) are not getting loaded logging an &quot; Error
</I>&gt;<i> negotiating SSL on FD 36: error:140920E3:SSL
</I>&gt;<i> routines:SSL3_GET_SERVER_HELLO:parse tlsext  &quot;  in the cache.log
</I>&gt;<i> (trying the same sites using openssl s_client command works). I was
</I>&gt;<i> wondering if it has to do anything with my config or open ssl
</I>&gt;<i> (version 1.0.1e) or anything else. The web sites are being accessed
</I>&gt;<i> from a windows 7 workstation with IE 8 and Firefox 35.0.1 . Below is
</I>&gt;<i> the squid.config section for peek and splice I am using.
</I>&gt;<i> 
</I>
Your config looks fine to me. The complaints seem to be about peek on
the server TLS-extensions values havign something unknown in them.

There is a bug winding its way through QA right now to fix interaction
of peek/stare ons erver connections with sslproxy_options setting.
The workaround is to not set sslproxy_options for now.


I dont think OpenSSL version is related (maybe, maybe not) but do try to
use the latest OpenSSL version you can just because of security
vulnerabilities and bug fixes found in it over the last few months.

Also, there are SNI fixes in the latest 3.5.1 snapshot you will be needing.


PS. You may want to seriously consider removing that disclaimer from
public posts, particularly when discussing the legally borderline topic
of SSL-bump.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002233.html">[squid-users] Error when using peek/splice/terminate with Squid	3.5.1
</A></li>
	<LI>Next message (by thread): <A HREF="002234.html">[squid-users] Squid stopped logging to access.log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2273">[ date ]</a>
              <a href="thread.html#2273">[ thread ]</a>
              <a href="subject.html#2273">[ subject ]</a>
              <a href="author.html#2273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
