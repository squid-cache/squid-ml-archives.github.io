<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20comm.cc%3A769%3A%0A%09%22Comm%3A%3AIsConnOpen%28conn%29%22&In-Reply-To=%3C54E3F058.3040200%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002304.html">
   <LINK REL="Next"  HREF="002320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20comm.cc%3A769%3A%0A%09%22Comm%3A%3AIsConnOpen%28conn%29%22&In-Reply-To=%3C54E3F058.3040200%40treenet.co.nz%3E"
       TITLE="[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Feb 18 01:52:24 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002304.html">[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="002320.html">[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2312">[ date ]</a>
              <a href="thread.html#2312">[ thread ]</a>
              <a href="subject.html#2312">[ subject ]</a>
              <a href="author.html#2312">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/02/2015 10:44 a.m., HackXBack wrote:
&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at dotspot</A>:~# gdb /usr/sbin/squid /var/spool/squid/cache/squid/core.53359
</I>&gt;<i> GNU gdb (GDB) 7.4.1-debian
</I>
&gt;<i> Core was generated by `(squid-1) -YC -f /etc/squid/squid.conf'.
</I>&gt;<i> Program terminated with signal 6, Aborted.
</I>&gt;<i> #0  0x00007f81777ab165 in raise () from /lib/x86_64-linux-gnu/libc.so.6
</I>&gt;<i> (gdb) backtrace
</I>&gt;<i> #0  0x00007f81777ab165 in raise () from /lib/x86_64-linux-gnu/libc.so.6
</I>&gt;<i> #1  0x00007f81777ae3e0 in abort () from /lib/x86_64-linux-gnu/libc.so.6
</I>&gt;<i> #2  0x000000000055b10f in xassert (msg=&lt;optimized out&gt;, file=&lt;optimized
</I>&gt;<i> out&gt;, line=&lt;optimized out&gt;) at debug.cc:566
</I>&gt;<i> #3  0x00000000006adbc8 in commSetConnTimeout (conn=..., timeout=15,
</I>&gt;<i> callback=...) at comm.cc:769
</I>&gt;<i> #4  0x000000000052d9ca in ConnStateData::getSslContextDone
</I>&gt;<i> (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x1895518b8, sslContext=&lt;optimized out&gt;,
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">sslContext at entry</A>=0x1890abac0, isNew=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">isNew at entry</A>=false) at
</I>&gt;<i> client_side.cc:3997
</I>&gt;<i> #5  0x000000000052e530 in ConnStateData::getSslContextStart
</I>&gt;<i> (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x1895518b8) at client_side.cc:3907
</I>&gt;<i> #6  0x000000000052eb49 in ConnStateData::httpsPeeked (this=0x1895518b8,
</I>&gt;<i> serverConnection=...) at client_side.cc:4069
</I>&gt;<i> #7  0x0000000000596188 in UnaryMemFunT&lt;ConnStateData,
</I>&gt;<i> RefCount&lt;Comm::Connection&gt;, RefCount&lt;Comm::Connection&gt; &gt;::doDial
</I>&gt;<i> (this=0x188dcda00) at base/AsyncJobCalls.h:113
</I>
The client is disconnecting or some other error is happening to close
the connection before the SSL context is setup. The SSL-bump code in 3.4
and older does not handle that at all well.

If you are able can you please try 3.5 and see if the problem is
resolved. There was some timeout handling added there, but I'm not sure
if it covers this particular case.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002304.html">[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="002320.html">[squid-users] assertion failed: comm.cc:769:	&quot;Comm::IsConnOpen(conn)&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2312">[ date ]</a>
              <a href="thread.html#2312">[ thread ]</a>
              <a href="subject.html#2312">[ subject ]</a>
              <a href="author.html#2312">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
