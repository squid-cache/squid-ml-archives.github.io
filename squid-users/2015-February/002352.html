<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid-3.5.2 and FreeBSD 10.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.2%20and%20FreeBSD%2010.1&In-Reply-To=%3CCAAdA2WOZxAVvA17tM4ButCO0WDhsopaBah5fn-Uq6_DFAiDK%2Bg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002342.html">
   <LINK REL="Next"  HREF="002359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid-3.5.2 and FreeBSD 10.1</H1>
    <B>Odhiambo Washington</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.2%20and%20FreeBSD%2010.1&In-Reply-To=%3CCAAdA2WOZxAVvA17tM4ButCO0WDhsopaBah5fn-Uq6_DFAiDK%2Bg%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid-3.5.2 and FreeBSD 10.1">odhiambo at gmail.com
       </A><BR>
    <I>Fri Feb 20 09:09:30 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002342.html">[squid-users] Squid-3.5.2 and FreeBSD 10.1
</A></li>
        <LI>Next message (by thread): <A HREF="002359.html">[squid-users] Squid-3.5.2 and FreeBSD 10.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2352">[ date ]</a>
              <a href="thread.html#2352">[ thread ]</a>
              <a href="subject.html#2352">[ subject ]</a>
              <a href="author.html#2352">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20 February 2015 at 04:15, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 20/02/2015 5:15 a.m., Odhiambo Washington wrote:
</I>&gt;<i> &gt; On 19 February 2015 at 15:12, Odhiambo Washington &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">odhiambo at gmail.com</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Hi Amos,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I did see that thread. However, the discussion was still continuing
</I>&gt;<i> then.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I will apply it to my server and see.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Reporting back today!
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On 19 February 2015 at 14:07, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On 19/02/2015 10:49 p.m., Odhiambo Washington wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt; I have been hoping that 3.5.2 would possibly help address my problems
</I>&gt;<i> &gt;&gt;&gt; with
</I>&gt;<i> &gt;&gt;&gt;&gt; ACLs, but alas!
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Ah, I thought you saw this announcement made just after your last
</I>&gt;<i> &gt;&gt;&gt; message in Jan:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &lt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/pipermail/squid-users/2015-January/001745.html">http://lists.squid-cache.org/pipermail/squid-users/2015-January/001745.html</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Its sounds very much like what your last few threads have been
</I>&gt;<i> &gt;&gt;&gt; describing as happening. Signal handling issues will affect all the
</I>&gt;<i> &gt;&gt;&gt; squid -k operations.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Amos
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have compiled a custom kernel after applying this patch mentioned in
</I>&gt;<i> that
</I>&gt;<i> &gt; thread.
</I>&gt;<i>
</I>&gt;<i> Er. There were two patches mentioned as being applied in the FreeBSD
</I>&gt;<i> mail and bug reports.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">wash at mail</A>:~$ uname -a
</I>&gt;<i> &gt; FreeBSD mail.ili.or.ug 10.1-RELEASE-p5 FreeBSD 10.1-RELEASE-p5 #4: Thu
</I>&gt;<i> Feb
</I>&gt;<i> &gt; 19 16:55:56 EAT 2015     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at mail.ili.or.ug</A>:/usr/obj/usr/src/sys
</I>&gt;<i> &gt; /BEASTIE-10.x  amd64
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However, my issues still persist.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at mail</A>:/opt # /opt/squid-3.5.2/sbin/squid -k reconfigure
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt; 2015/02/19 19:10:53.639| Acl.cc(380) ~ACL: freeing ACL
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Would this then suggest there is a problem with my squid.conf
</I>&gt;<i> &gt; &lt;<A HREF="http://pastebin.com/wwwcnHnF">http://pastebin.com/wwwcnHnF</A>&gt; ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Or the FreeBSD problem isn't quite solved?
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Could you re-state what the problem is?
</I>&gt;<i>
</I>&gt;<i> Now your pastebin is expired all we have on record about this problems
</I>&gt;<i> is the sentence: &quot;it's crashing with errors as seen from &lt;DEAD URL&gt;&quot;
</I>&gt;<i>
</I>

Generally, Squid seems to partially ignore my time-based ACLS as seen in
the squid.conf

It would block one site but allow the others. I expect a standard blocking
within the specied time.

I have not been able to figure out why.

For instance, my ACL for TIMEWASTAGESITED contains .facebook.com, .gmail.com
and .youtube.com as dstdomains.

I find that youtube.com is blocked while facebook.com is not blocked. Both
should be blocked at this time (11:58)

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at mail</A>:/opt/squid-3.5.2/etc # tail -f /usr/local/squid/logs/access.log |
grep DENIED
1424422669.545    456 192.168.2.2 TCP_DENIED/403 4345 GET
<A HREF="http://youtube.com/">http://youtube.com/</A> - HIER_NONE/- text/html
1424422671.910      1 192.168.2.2 TCP_DENIED/403 4291 GET
<A HREF="http://youtube.com/favicon.ico">http://youtube.com/favicon.ico</A> - HIER_NONE/- text/html

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at mail</A>:/opt/squid-3.5.2/etc # tail -f /usr/local/squid/logs/access.log |
grep 192.168.2.2
1424422669.545    456 192.168.2.2 TCP_DENIED/403 4345 GET
<A HREF="http://youtube.com/">http://youtube.com/</A> - HIER_NONE/- text/html
1424422671.910      1 192.168.2.2 TCP_DENIED/403 4291 GET
<A HREF="http://youtube.com/favicon.ico">http://youtube.com/favicon.ico</A> - HIER_NONE/- text/html
1424422710.537    863 192.168.2.2 TCP_MISS/400 372 POST
<A HREF="http://bench.utorrent.com/e?i=36">http://bench.utorrent.com/e?i=36</A> - ORIGINAL_DST/54.221.228.66 text/html
1424422710.578    903 192.168.2.2 TCP_MISS/400 372 POST
<A HREF="http://bench.utorrent.com/e?i=36">http://bench.utorrent.com/e?i=36</A> - ORIGINAL_DST/54.197.243.221 text/html
1424422755.202   1239 192.168.2.2 TCP_MISS/200 280 POST
<A HREF="http://bench.utorrent.com/e?i=20">http://bench.utorrent.com/e?i=20</A> - ORIGINAL_DST/54.243.183.178 text/html
1424422756.602    846 192.168.2.2 TCP_MISS/200 1016 GET
<A HREF="http://cdn.ap.bittorrent.com/control/feature/tags/ut.json">http://cdn.ap.bittorrent.com/control/feature/tags/ut.json</A> - ORIGINAL_DST/
54.230.128.
193 application/json
1424422895.279    593 192.168.2.2 TCP_MISS/404 1792 GET
<A HREF="http://www.gstatic.com/chrome/profile_avatars/NothingToDownload">http://www.gstatic.com/chrome/profile_avatars/NothingToDownload</A> -
ORIGINAL_DST/196.0
.3.114 text/html


The odd part:

While facebook.com and gmail.com are accessible, nothing appears at all in
the access.log and cache.log (debug mode) about them yet this is an
intercept proxy. The sites just load. No log enties:(

I am willing to give access to both the Squid Server and the test machine
if someone can figure this out for me.


-- 
Best regards,
Odhiambo WASHINGTON,
Nairobi,KE
+254733744121/+254722743223
&quot;I can't hear you -- I'm using the scrambler.&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150220/c99e77a7/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150220/c99e77a7/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002342.html">[squid-users] Squid-3.5.2 and FreeBSD 10.1
</A></li>
	<LI>Next message (by thread): <A HREF="002359.html">[squid-users] Squid-3.5.2 and FreeBSD 10.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2352">[ date ]</a>
              <a href="thread.html#2352">[ thread ]</a>
              <a href="subject.html#2352">[ subject ]</a>
              <a href="author.html#2352">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
