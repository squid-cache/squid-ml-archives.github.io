<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Need better debug_options values to track down cache MISSes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20better%20debug_options%20values%20to%20track%20down%0A%20cache%20MISSes&In-Reply-To=%3C54EC9147.6070301%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002415.html">
   <LINK REL="Next"  HREF="002422.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Need better debug_options values to track down cache MISSes</H1>
    <B>Pavel Kazlenka</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20better%20debug_options%20values%20to%20track%20down%0A%20cache%20MISSes&In-Reply-To=%3C54EC9147.6070301%40measurement-factory.com%3E"
       TITLE="[squid-users] Need better debug_options values to track down cache MISSes">pavel.kazlenka at measurement-factory.com
       </A><BR>
    <I>Tue Feb 24 14:57:11 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002415.html">[squid-users] Need better debug_options values to track down cache	MISSes
</A></li>
        <LI>Next message (by thread): <A HREF="002422.html">[squid-users] Need better debug_options values to track down	cache MISSes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2420">[ date ]</a>
              <a href="thread.html#2420">[ thread ]</a>
              <a href="subject.html#2420">[ subject ]</a>
              <a href="author.html#2420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Greg,

I use this combo to check if request is cached or no and why:
debug_options 20,9 27,9 31,9 70,9 82,9 22,9 84,9 90,9

Then in cache.log file you can search by 'YES' or 'NO' (uppercase) to 
see if the content is cacheable (and cached) or not and the reason of 
this decision. Hope this will help.

Best wishes,
Pavel

On 02/24/2015 03:54 PM, Greg wrote:
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I'm new to squid administration, with basic *nix admin skills. My task 
</I>&gt;<i> now is to replace an old Squid reverse proxy server (3.1.15 on an old 
</I>&gt;<i> Fedora) with a new one (Squid 3.3.8 on Ubuntu 14 LTS) and ran into a 
</I>&gt;<i> problem.
</I>&gt;<i>
</I>&gt;<i> I've spent 2 days tweaking-googling-debugging, now looking for some 
</I>&gt;<i> help...
</I>&gt;<i>
</I>&gt;<i> Problem is, with the ~same configuration, the old Squid caches HTML 
</I>&gt;<i> pages well and the new doesn't. This is a major concern, we're using 
</I>&gt;<i> Squid exactly to do that and get the load off our appservers.
</I>&gt;<i>
</I>&gt;<i> In this first mail, I'm only asking for a hint on what debug_options 
</I>&gt;<i> to use. In previous list emails I've seen that some details help, so 
</I>&gt;<i> here they are:
</I>&gt;<i> - Reverse proxy, port 80 only, one uplink straight to the app servers.
</I>&gt;<i> - Pretty standard configuration, standard refresh_patterns.
</I>&gt;<i> - Disk and memory cache, disk cache initialised with -z.
</I>&gt;<i> - Clocks are in sync (except for the old proxy server) using ntpd.
</I>&gt;<i> - Squid gives HITs for favicon.ico and RSS feeds only - these have 
</I>&gt;<i> different headers and mimetypes compared to HTML files (and that's by 
</I>&gt;<i> design).
</I>&gt;<i> - This new server seems to save accessed HTML files on disk but still 
</I>&gt;<i> gives X-Cache-Lookup:MISS for all of them later.
</I>&gt;<i> - I've found the debug_options sections page but section names are 
</I>&gt;<i> ambiguous for someone who's not a Squid programmer. I had to download 
</I>&gt;<i> the source code, analysed it and tried &quot;debug_options 11,1 22,6 85,3 
</I>&gt;<i> 88,5 33,1 31,5 90,5&quot; which is too much and &quot;debug_options 88,5 85,5 
</I>&gt;<i> 22,6 11,5 33,1&quot; which might be too little.
</I>&gt;<i> - Headers look okay (Cache-Control, Pragma, Vary), stale/fresh 
</I>&gt;<i> calculation looks okay (pages are deemed fresh) in the debug log.
</I>&gt;<i> - The best I got so far is this: &quot;client_side_reply.cc(1618) 
</I>&gt;<i> identifyFoundObject: clientProcessRequest2: StoreEntry is NULL - 
</I>&gt;<i>  MISS&quot;, even for pages I see in the disk cache -- I'd like to know why 
</I>&gt;<i> does it occur, probably need some more good debug_options. I don't 
</I>&gt;<i> understand the code too well, don't know which direction to take.
</I>&gt;<i>
</I>&gt;<i> Please suggest some more good debug_options to continue with.
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i> Greg
</I>&gt;<i>
</I>&gt;<i> PS. Also, I'll submit another mail with the details of the problem + 
</I>&gt;<i> the config, hoping someone spots a problem right away.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150224/34361e7a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150224/34361e7a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002415.html">[squid-users] Need better debug_options values to track down cache	MISSes
</A></li>
	<LI>Next message (by thread): <A HREF="002422.html">[squid-users] Need better debug_options values to track down	cache MISSes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2420">[ date ]</a>
              <a href="thread.html#2420">[ thread ]</a>
              <a href="subject.html#2420">[ subject ]</a>
              <a href="author.html#2420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
