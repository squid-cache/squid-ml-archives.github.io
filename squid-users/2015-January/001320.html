<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3 SSL bump: Google drive application could not connect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%20connect&In-Reply-To=%3C54AA7AC0.7000707%40urlfilterdb.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001317.html">
   <LINK REL="Next"  HREF="001321.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3 SSL bump: Google drive application could not connect</H1>
    <B>Marcus Kool</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%20connect&In-Reply-To=%3C54AA7AC0.7000707%40urlfilterdb.com%3E"
       TITLE="[squid-users] Squid 3 SSL bump: Google drive application could not connect">marcus.kool at urlfilterdb.com
       </A><BR>
    <I>Mon Jan  5 11:51:28 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001317.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
        <LI>Next message (by thread): <A HREF="001321.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1320">[ date ]</a>
              <a href="thread.html#1320">[ thread ]</a>
              <a href="subject.html#1320">[ subject ]</a>
              <a href="author.html#1320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Much of the discussion so far has been about bumping traffic on port 443,
bumping SSL-encapsulated HTTP traffic and not bumping (allowing)
other traffic.  Since port 443 is used for many protocols, it is in many
cases dangerous to allow non-bumpable traffic: SSH tunnels using port 443
are common, so are VPNs.  Do you know a security officer who does not want
to block an SSH tunnel, or an app that can share corporate documents
on public websites?  If there is not more attention to these kinds of
applications that use port 443 to circumvent corporate firewalls,
Squid will be doomed to be used only in environments where the priority
for security is low to non-existent.  Just type &quot;punching holes in corporate
firewalls&quot; or &quot;ssh tunnel proxy&quot; in Google to see how easy it is to use an
SSH tunnel.

I am the author of ufdbGuard, a filter for Squid and besides filtering
based on URLs, ufdbGuard also probes port 443 to see what kind of traffic
the server is expecting.  By using probes, ufdbGuard can detect SSH tunnels,
popular chat protocols, etc. but it is not a 100% guaranteed solution
because ufdbGuard cannot not see the traffic that flows through the proxy,
i.e. there is not yet an interface for this type of traffic inspection.

Marcus


On 01/05/2015 07:59 AM, Eliezer Croitoru wrote:
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> Hey Yuri,
</I>&gt;<i>
</I>&gt;<i> Indeed there are other *NIX systems and for each and every one of them
</I>&gt;<i> there is a solution in need.
</I>&gt;<i>
</I>&gt;<i> SSL Pinned destinations cannot be identified automatically since the
</I>&gt;<i> are pinned inside a software and the certificate will not show
</I>&gt;<i> anything about that.
</I>&gt;<i> The basic tests we can do are:
</I>&gt;<i> - - The host is using ssl or tls or not at all(based on the selective
</I>&gt;<i> answer of the service)
</I>&gt;<i> - -
</I>&gt;<i> - - If the connection is using tls\ssl then inspect the components of
</I>&gt;<i> the certificate(such as rootCA validation against the local machine
</I>&gt;<i> certificates DB)
</I>&gt;<i>
</I>&gt;<i> Depend on the goal of the certificate validation the decision will be
</I>&gt;<i> made to either allow the connection &quot;uninspected&quot; or to &quot;bump&quot; it as
</I>&gt;<i> is without any smart identification.
</I>&gt;<i>
</I>&gt;<i> If indeed there is a database
</I>&gt;<i> sqlite3\mysql\postgres\redis\memcached\others it can be used in the
</I>&gt;<i> iptables level.
</I>&gt;<i> Also a point in this DB and this cache is that it will be persistent
</I>&gt;<i> so what so ever the *NIX system is there is an option once the IP +
</I>&gt;<i> port was tagged as non-bump-able it is better be in the FIREWALL level
</I>&gt;<i> override better then squid external_acl.
</I>&gt;<i> Reason: If the kernel does what it needs to do then squid should not
</I>&gt;<i> touch the packets.
</I>&gt;<i> It's not always right but it's a point in the issue.
</I>&gt;<i> I still do not know how to work with NFQUEUE and I am sure that there
</I>&gt;<i> is an option to make a fast decision and if not then let the
</I>&gt;<i> connection be BUMPED.
</I>&gt;<i>
</I>&gt;<i> I have written a small golang script that can check couple things
</I>&gt;<i> about the ssl session at:
</I>&gt;<i> <A HREF="http://www1.ngtech.co.il/squid/ssl_helpers/ssl_validator.go">http://www1.ngtech.co.il/squid/ssl_helpers/ssl_validator.go</A>
</I>&gt;<i>
</I>&gt;<i> Besides this helper there is another script which do couple things in
</I>&gt;<i> another level.
</I>&gt;<i>
</I>&gt;<i> ##########
</I>&gt;<i> If any thing will be decided for squid internals it will be after a
</I>&gt;<i> proof of concept that we can implement together.
</I>&gt;<i> Can we take this thread to storm and put on the table a proof of
</I>&gt;<i> concept logic for ssl inspection\bumping and bypassing?
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i> On 01/05/2015 10:40 AM, Yuri Voinov wrote:
</I>&gt;&gt;<i> Sounds good,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> but server world is not end on Linux. ;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now exists another *NIX systems. And will exists further.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also. I have an idea, gents.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Do we can easy and quickly detect SSL Pinned destinations? And
</I>&gt;&gt;<i> remember it, for example, in database?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In another words - both problems is similar. Either non-HTTPS
</I>&gt;&gt;<i> traffic over 443 port, or pinned certs.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can we detect both of them automatically and add to exclude list?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> WBR, Yuri
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v1
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBAgAGBQJUqmB0AAoJENxnfXtQ8ZQUPKkH/RQmpV8bVcQ1HKMWYLgzDIY1
</I>&gt;<i> qcW5AtSsiuuSQsDjew336/jE6WajfT3e5jKvvEKnLc993klJJcxlpETMRfqA+ekK
</I>&gt;<i> nMnycoMGSX66bgnKb/TX2PBdUNqYj3WsC5ujDyQ/37VBYY7NNIc95VR5W460jj+F
</I>&gt;<i> X9/sErTOsgy2/cYJ3Mz1+sHzH/IleehnosAtWaPBqXPCvi8Q4ud+SUFa8O3xgTPG
</I>&gt;<i> 7BMM26prgMT0C8mpC/GRnMydEn4Pir3E5FEgkNZmMB7ZeQuHp0ZVKwUzvHqW/WP3
</I>&gt;<i> 7pUydl3JKn1KP4bo1gXNO5m1Bf+X3xa9OiUTbzZ7VFrVPxXa7gOVKgZdCWpktcg=
</I>&gt;<i> =K9bZ
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001317.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
	<LI>Next message (by thread): <A HREF="001321.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1320">[ date ]</a>
              <a href="thread.html#1320">[ thread ]</a>
              <a href="subject.html#1320">[ subject ]</a>
              <a href="author.html#1320">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
