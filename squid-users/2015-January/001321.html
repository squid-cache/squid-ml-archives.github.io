<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3 SSL bump: Google drive application could not connect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%20connect&In-Reply-To=%3C54AA87BB.3060205%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001320.html">
   <LINK REL="Next"  HREF="001322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3 SSL bump: Google drive application could not connect</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203%20SSL%20bump%3A%20Google%20drive%20application%20could%0A%20not%20connect&In-Reply-To=%3C54AA87BB.3060205%40gmail.com%3E"
       TITLE="[squid-users] Squid 3 SSL bump: Google drive application could not connect">yvoinov at gmail.com
       </A><BR>
    <I>Mon Jan  5 12:46:51 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001320.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
        <LI>Next message (by thread): <A HREF="001322.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1321">[ date ]</a>
              <a href="thread.html#1321">[ thread ]</a>
              <a href="subject.html#1321">[ subject ]</a>
              <a href="author.html#1321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
I think,

non-HTTP/HTTPS security issues is never ever Squid function.

Squid is not all-in-one-security-solution. It's only HTTP proxy.

For others security breches (i.e SSH tunnels, various browser
tunnel-related plugins, Tor etc., ) we have another tools. Cisco NBAR
proticol discovery, other DPI solution.

AFAIK, primitive Cisco extended ACL + tcpiputils.com and simple sniffer
can make miracles.

Following I offer to retirn to the Earth and limit our functionality as
I said before. Just HTTP/HTTPS over 443 port.

I understand that exists wonderful and overall solutions like ufdbGuard.
But we talk not about it.

05.01.2015 17:51, Marcus Kool &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Much of the discussion so far has been about bumping traffic on port 443,
</I>&gt;<i> bumping SSL-encapsulated HTTP traffic and not bumping (allowing)
</I>&gt;<i> other traffic.  Since port 443 is used for many protocols, it is in many
</I>&gt;<i> cases dangerous to allow non-bumpable traffic: SSH tunnels using port 443
</I>&gt;<i> are common, so are VPNs.  Do you know a security officer who does not want
</I>&gt;<i> to block an SSH tunnel, or an app that can share corporate documents
</I>&gt;<i> on public websites?  If there is not more attention to these kinds of
</I>&gt;<i> applications that use port 443 to circumvent corporate firewalls,
</I>&gt;<i> Squid will be doomed to be used only in environments where the priority
</I>&gt;<i> for security is low to non-existent.  Just type &quot;punching holes in
</I>corporate
&gt;<i> firewalls&quot; or &quot;ssh tunnel proxy&quot; in Google to see how easy it is to use an
</I>&gt;<i> SSH tunnel.
</I>&gt;<i>
</I>&gt;<i> I am the author of ufdbGuard, a filter for Squid and besides filtering
</I>&gt;<i> based on URLs, ufdbGuard also probes port 443 to see what kind of traffic
</I>&gt;<i> the server is expecting.  By using probes, ufdbGuard can detect SSH
</I>tunnels,
&gt;<i> popular chat protocols, etc. but it is not a 100% guaranteed solution
</I>&gt;<i> because ufdbGuard cannot not see the traffic that flows through the proxy,
</I>&gt;<i> i.e. there is not yet an interface for this type of traffic inspection.
</I>&gt;<i>
</I>&gt;<i> Marcus
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 01/05/2015 07:59 AM, Eliezer Croitoru wrote:
</I>&gt;<i> Hey Yuri,
</I>&gt;<i>
</I>&gt;<i> Indeed there are other *NIX systems and for each and every one of them
</I>&gt;<i> there is a solution in need.
</I>&gt;<i>
</I>&gt;<i> SSL Pinned destinations cannot be identified automatically since the
</I>&gt;<i> are pinned inside a software and the certificate will not show
</I>&gt;<i> anything about that.
</I>&gt;<i> The basic tests we can do are:
</I>&gt;<i> - The host is using ssl or tls or not at all(based on the selective
</I>&gt;<i> answer of the service)
</I>&gt;<i> -
</I>&gt;<i> - If the connection is using tls\ssl then inspect the components of
</I>&gt;<i> the certificate(such as rootCA validation against the local machine
</I>&gt;<i> certificates DB)
</I>&gt;<i>
</I>&gt;<i> Depend on the goal of the certificate validation the decision will be
</I>&gt;<i> made to either allow the connection &quot;uninspected&quot; or to &quot;bump&quot; it as
</I>&gt;<i> is without any smart identification.
</I>&gt;<i>
</I>&gt;<i> If indeed there is a database
</I>&gt;<i> sqlite3\mysql\postgres\redis\memcached\others it can be used in the
</I>&gt;<i> iptables level.
</I>&gt;<i> Also a point in this DB and this cache is that it will be persistent
</I>&gt;<i> so what so ever the *NIX system is there is an option once the IP +
</I>&gt;<i> port was tagged as non-bump-able it is better be in the FIREWALL level
</I>&gt;<i> override better then squid external_acl.
</I>&gt;<i> Reason: If the kernel does what it needs to do then squid should not
</I>&gt;<i> touch the packets.
</I>&gt;<i> It's not always right but it's a point in the issue.
</I>&gt;<i> I still do not know how to work with NFQUEUE and I am sure that there
</I>&gt;<i> is an option to make a fast decision and if not then let the
</I>&gt;<i> connection be BUMPED.
</I>&gt;<i>
</I>&gt;<i> I have written a small golang script that can check couple things
</I>&gt;<i> about the ssl session at:
</I>&gt;<i> <A HREF="http://www1.ngtech.co.il/squid/ssl_helpers/ssl_validator.go">http://www1.ngtech.co.il/squid/ssl_helpers/ssl_validator.go</A>
</I>&gt;<i>
</I>&gt;<i> Besides this helper there is another script which do couple things in
</I>&gt;<i> another level.
</I>&gt;<i>
</I>&gt;<i> ##########
</I>&gt;<i> If any thing will be decided for squid internals it will be after a
</I>&gt;<i> proof of concept that we can implement together.
</I>&gt;<i> Can we take this thread to storm and put on the table a proof of
</I>&gt;<i> concept logic for ssl inspection\bumping and bypassing?
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i> On 01/05/2015 10:40 AM, Yuri Voinov wrote:
</I>&gt;<i> &gt;&gt;&gt; Sounds good,
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; but server world is not end on Linux. ;)
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Now exists another *NIX systems. And will exists further.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Also. I have an idea, gents.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Do we can easy and quickly detect SSL Pinned destinations? And
</I>&gt;<i> &gt;&gt;&gt; remember it, for example, in database?
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; In another words - both problems is similar. Either non-HTTPS
</I>&gt;<i> &gt;&gt;&gt; traffic over 443 port, or pinned certs.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Can we detect both of them automatically and add to exclude list?
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; WBR, Yuri
</I>&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBAgAGBQJUqoe7AAoJENNXIZxhPexGJqoH/2byMvv1s1Qgk5Wh1EwB8ai/
B6wsw6IvHitGvkrS77OEkEtZYjMsbTEv7XEpZuBvsylIGTr8Zp9amyjcTLOG/A+2
3L4FwlC2QHj6plf4owN5i3ydKwByZP4qRw97Ydg6rsXM/UpD3ePZl9tWf4TVZDLf
4bv7EErFYN4tnVjsDEKYWfwfbvJkbbOwt/v1LHTyhyhJiP4Q+bQW3iqGfsgyaMbW
3frxeuZrjNikH3OC9eqFI+bY41n4IUkz5pKdItqzTCEDAo6NghJJrACeG+jQA2+Q
3WotAv33ErIe7DiRKgBmSRGbzfe5Cbgd4LVn5BUUbsDboRaVb6NrIu2kwzE03OY=
=nev9
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150105/90bc952a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150105/90bc952a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001320.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
	<LI>Next message (by thread): <A HREF="001322.html">[squid-users] Squid 3 SSL bump: Google drive application could not connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1321">[ date ]</a>
              <a href="thread.html#1321">[ thread ]</a>
              <a href="subject.html#1321">[ subject ]</a>
              <a href="author.html#1321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
