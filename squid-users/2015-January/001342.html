<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Debugging slow access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20slow%20access&In-Reply-To=%3C54AACE86.5080708%40opendium.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001340.html">
   <LINK REL="Next"  HREF="001344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Debugging slow access</H1>
    <B>Steve Hill</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20slow%20access&In-Reply-To=%3C54AACE86.5080708%40opendium.com%3E"
       TITLE="[squid-users] Debugging slow access">steve at opendium.com
       </A><BR>
    <I>Mon Jan  5 17:48:54 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001340.html">[squid-users] Debugging slow access
</A></li>
        <LI>Next message (by thread): <A HREF="001344.html">[squid-users] Debugging slow access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1342">[ date ]</a>
              <a href="thread.html#1342">[ thread ]</a>
              <a href="subject.html#1342">[ subject ]</a>
              <a href="author.html#1342">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05.01.15 16:35, Eliezer Croitoru wrote:

&gt;<i> Can you share the &quot;squid -v&quot; output and the OS you are using?
</I>
Scientific Linux 6.6, see below for the squid -v output.

I've now more or less confirmed that this is the cause of my performance 
problems - every so often I see Squid using all the CPU whilst servicing 
very few requests.  Most of the CPU time is being used by the 
appendNewOnly() function.  For example, 228 milliseconds for 
appendNewOnly() to process a request with 2687 &quot;token&quot; notes attached to 
it, and this can happen more than once per request.


Squid Cache: Version 3.4.10
configure options:  '--build=x86_64-redhat-linux-gnu' 
'--host=x86_64-redhat-linux-gnu' '--target=x86_64-redhat-linux-gnu' 
'--program-prefix=' '--prefix=/usr' '--exec-prefix=/usr' 
'--bindir=/usr/bin' '--sbindir=/usr/sbin' '--sysconfdir=/etc' 
'--datadir=/usr/share' '--includedir=/usr/include' '--libdir=/usr/lib64' 
'--libexecdir=/usr/libexec' '--sharedstatedir=/var/lib' 
'--mandir=/usr/share/man' '--infodir=/usr/share/info' 
'--exec_prefix=/usr' '--libexecdir=/usr/lib64/squid' 
'--localstatedir=/var' '--datadir=/usr/share/squid' 
'--sysconfdir=/etc/squid' '--with-logdir=$(localstatedir)/log/squid' 
'--with-pidfile=$(localstatedir)/run/squid.pid' 
'--disable-dependency-tracking' '--enable-arp-acl' 
'--enable-follow-x-forwarded-for' '--enable-auth' 
'--enable-auth-basic-helpers=LDAP,MSNT,NCSA,PAM,SMB,YP,getpwnam,multi-domain-NTLM,SASL,DB,POP3,squid_radius_auth' 
'--enable-auth-ntlm-helpers=smb_lm,no_check,fakeauth' 
'--enable-auth-digest-helpers=password,ldap,eDirectory' 
'--enable-auth-negotiate-helpers=squid_kerb_auth' 
'--enable-external-acl-helpers=file_userip,LDAP_group,unix_group,wbinfo_group' 
'--enable-cache-digests' '--enable-cachemgr-hostname=localhost' 
'--enable-delay-pools' '--enable-epoll' '--enable-icap-client' 
'--enable-ident-lookups' '--enable-linux-netfilter' 
'--enable-referer-log' '--enable-removal-policies=heap,lru' 
'--enable-snmp' '--enable-ssl' '--enable-storeio=aufs,diskd,ufs,rock' 
'--enable-useragent-log' '--enable-wccpv2' '--enable-esi' '--with-aio' 
'--with-default-user=squid' '--with-filedescriptors=16384' '--with-dl' 
'--with-openssl' '--with-pthreads' 'build_alias=x86_64-redhat-linux-gnu' 
'host_alias=x86_64-redhat-linux-gnu' 
'target_alias=x86_64-redhat-linux-gnu' 'CFLAGS=-fPIE -Os -g -pipe 
-fsigned-char -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions 
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic' 
'LDFLAGS=-pie' 'CXXFLAGS=-fPIE -O2 -g -pipe -Wall 
-Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector 
--param=ssp-buffer-size=4 -m64 -mtune=generic' 
'PKG_CONFIG_PATH=/usr/lib64/pkgconfig:/usr/share/pkgconfig' 
--enable-ltdl-convenience


-- 
  - Steve Hill
    Technical Director
    Opendium Limited     <A HREF="http://www.opendium.com">http://www.opendium.com</A>

Direct contacts:
    Instant messager: xmpp:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
    Phone:            sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>

Sales / enquiries contacts:
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>
    Phone:            +44-1792-824568 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>

Support contacts:
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>
    Phone:            +44-1792-825748 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001340.html">[squid-users] Debugging slow access
</A></li>
	<LI>Next message (by thread): <A HREF="001344.html">[squid-users] Debugging slow access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1342">[ date ]</a>
              <a href="thread.html#1342">[ thread ]</a>
              <a href="subject.html#1342">[ subject ]</a>
              <a href="author.html#1342">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
