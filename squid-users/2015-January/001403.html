<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] strip Referer header based in source
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20strip%20Referer%20header%20based%20in%20source&In-Reply-To=%3CCAD1jQj5EXE8Zz_XgGzAEXov0giV9_F45snyAp-%2BMKJ3Xm2u4MA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001402.html">
   <LINK REL="Next"  HREF="001405.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] strip Referer header based in source</H1>
    <B>Prasad Yalla</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20strip%20Referer%20header%20based%20in%20source&In-Reply-To=%3CCAD1jQj5EXE8Zz_XgGzAEXov0giV9_F45snyAp-%2BMKJ3Xm2u4MA%40mail.gmail.com%3E"
       TITLE="[squid-users] strip Referer header based in source">mailmegoodies at gmail.com
       </A><BR>
    <I>Sun Jan 11 13:22:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001402.html">[squid-users] strip Referer header based in source
</A></li>
        <LI>Next message (by thread): <A HREF="001405.html">[squid-users] site cannot be accessed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1403">[ date ]</a>
              <a href="thread.html#1403">[ thread ]</a>
              <a href="subject.html#1403">[ subject ]</a>
              <a href="author.html#1403">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Putting src tries to match IP of the PC from which the request originated.
But thanks, I got this figured out with the referer_regex acl, it looks
something like this:

acl referer_allowsrc referer_regex -i  ^<A HREF="http://testing.abc.com">http://testing.abc.com</A>  [here
testing.abc.com is the referring site]
header_access Referer deny referer_allowsrc

this strips the reference header whenever there is testing.abc.com in the
reference header.

On Sun, Jan 11, 2015 at 3:36 AM, Yuri Voinov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/SquidFaq/SquidAcl#Differences_between_.27.27src.27.27_and_.27.27srcdomain.27.27_ACL_types">http://wiki.squid-cache.org/SquidFaq/SquidAcl#Differences_between_.27.27src.27.27_and_.27.27srcdomain.27.27_ACL_types</A>
</I>&gt;<i>
</I>&gt;<i> For the /srcdomain/ ACL type, Squid does a reverse lookup of the client's
</I>&gt;<i> IP address and checks the result with the domains given on the /acl
</I>&gt;<i> &lt;<A HREF="http://www.eu.squid-cache.org/Doc/config/acl">http://www.eu.squid-cache.org/Doc/config/acl</A>&gt;
</I>&gt;<i> &lt;<A HREF="http://www.eu.squid-cache.org/Doc/config/acl">http://www.eu.squid-cache.org/Doc/config/acl</A>&gt;/ line. With the/src/ ACL
</I>&gt;<i> type, Squid converts hostnames to IP addresses at startup and then only
</I>&gt;<i> compares the client's IP address. The /src/ ACL is preferred
</I>&gt;<i> over/srcdomain/ because it does not require address-to-name lookups for
</I>&gt;<i> each request.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 10.01.2015 19:45, Prasad Yalla &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; I have a requirement to remove Referer header when a certain of my sites
</I>&gt;<i> make a reference and not all.
</I>&gt;<i> &gt; I managed to remove Referer selectively based on the destination domain,
</I>&gt;<i> but how do I do it based on the originating site?
</I>&gt;<i> &gt; Here is how it did for destination domain:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; acl referer_allowdst dstdomain google.com &lt;<A HREF="http://google.com">http://google.com</A>&gt;
</I>&gt;<i> &lt;<A HREF="http://google.com">http://google.com</A>&gt;
</I>&gt;<i> &gt; header_access Referer deny referer_allowdst
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; When i use srcdomain here it doesn't work. This is an urgent
</I>&gt;<i> requirement, can someone help me with this please?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v2
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBAgAGBQJUsaJyAAoJENNXIZxhPexG3xQH/je1rGfb0MfMzYbmHSMD2SL0
</I>&gt;<i> Y2mc7hccrmoYpRTwjOCK1NmEvoenj3J6stbKGDidoB+BYhuUjt5/xJ+HDA3MjC7C
</I>&gt;<i> q+zpt4SdumnXBWiK+tn/RP/pK/TnjqOWcnEpnvctdpXbjJuhUvwf3pZ9/7EG1wPs
</I>&gt;<i> R86T8RURbKEBo1IfeSbQrjNWwxt93bt6bOjrRmnc1QEkh8TC+bNGYdug2RM3TkMl
</I>&gt;<i> +FBJUL7H/bmlile1vRUot/jEWNWGPP4GyP8rZhp0UcCzepCIX0QW8SepefSmwkQk
</I>&gt;<i> lavMU/hrHoIZQdioZkAw/s0uDxr2U3Z4zUg9kiQt58vC3DuWM96jqWndP1TkTug=
</I>&gt;<i> =02mh
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150111/f0f86d55/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150111/f0f86d55/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001402.html">[squid-users] strip Referer header based in source
</A></li>
	<LI>Next message (by thread): <A HREF="001405.html">[squid-users] site cannot be accessed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1403">[ date ]</a>
              <a href="thread.html#1403">[ thread ]</a>
              <a href="subject.html#1403">[ subject ]</a>
              <a href="author.html#1403">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
