<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Traffic prioritizing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Traffic%20prioritizing&In-Reply-To=%3C54B52F41.2070508%40lhanke.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001445.html">
   <LINK REL="Next"  HREF="001470.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Traffic prioritizing</H1>
    <B>Dr. Lars Hanke</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Traffic%20prioritizing&In-Reply-To=%3C54B52F41.2070508%40lhanke.de%3E"
       TITLE="[squid-users] Traffic prioritizing">lars at lhanke.de
       </A><BR>
    <I>Tue Jan 13 14:44:17 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001445.html">[squid-users] Traffic prioritizing
</A></li>
        <LI>Next message (by thread): <A HREF="001470.html">[squid-users] Traffic prioritizing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1450">[ date ]</a>
              <a href="thread.html#1450">[ thread ]</a>
              <a href="subject.html#1450">[ subject ]</a>
              <a href="author.html#1450">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Eliezer:

&gt;<i> There are couple aspects to the issue.
</I>&gt;<i> The options are:
</I>&gt;<i> - TOS marking of specific connections
</I>&gt;<i> - TPROXY(leaving the src IP the same)
</I>&gt;<i> - delay_pools
</I>&gt;<i>
</I>&gt;<i> If you have a shaping setup in place or device that is capable of
</I>&gt;<i> traffic shaping based on TOS marking you can take a look at this option.
</I>
TOS marking essentially will mark the GET/POST requests, right? However, 
the size/number of these requests does not correlate well with the 
download bandwidth. 100 AJAX requests may be much less than a single GET 
for some PDF.

Setting up a TPROXY configuration might be interesting, since my current 
transparent proxy appears to have issues with some special devices.

However, it all boils down to limit the outgoing bandwidth. Of course I 
could police incoming packets, but when they arrive the bandwidth is 
wasted already. If dropped, the server will resend and eat my bandwidth 
again.

So my idea was that Squid should have all data required about streams 
any may be the most suitable instance to take action, e.g. delay ACK and 
new requests. delay_pools in general look like the right choice, but I 
could not see a function similar to HTB or HFSC, which both would do the 
trick.

So it could be that I think too complicated, or that I miss something, 
or that there is simply no solution, yet.

If the latter is true, I'll try experimenting with the TOS solution. 
Joined with outgoing ACK throtteling it might work.

Appreciating your comments,
  - lars.

&gt;<i> On 13/01/2015 12:30, Dr. Lars Hanke wrote:
</I>&gt;&gt;<i> I want to prioritize traffic of some subnets over the the rest to avoid
</I>&gt;&gt;<i> leisure traffic killing critical business traffic over a slow network
</I>&gt;&gt;<i> connection. This of course would be a task for tools like tc, but behind
</I>&gt;&gt;<i> the proxy the information of the original IP is lost.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I do not want to statically limit the bandwidth of the non-priority
</I>&gt;&gt;<i> traffic. I just want the priority traffic to receive a major share of
</I>&gt;&gt;<i> the bandwidth, if it actually requires it. I'm not sure whether
</I>&gt;&gt;<i> delay_pools can do that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Any ideas how to accomplish this?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001445.html">[squid-users] Traffic prioritizing
</A></li>
	<LI>Next message (by thread): <A HREF="001470.html">[squid-users] Traffic prioritizing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1450">[ date ]</a>
              <a href="thread.html#1450">[ thread ]</a>
              <a href="subject.html#1450">[ subject ]</a>
              <a href="author.html#1450">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
