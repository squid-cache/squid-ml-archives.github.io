<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Odp: Re:  Only TCP_MISS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54b6f13ee45455.19980433%40wp.pl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001705.html">
   <LINK REL="Next"  HREF="001459.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Odp: Re:  Only TCP_MISS</H1>
    <B>Robert</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54b6f13ee45455.19980433%40wp.pl%3E"
       TITLE="[squid-users] Odp: Re:  Only TCP_MISS">wrkilu at wp.pl
       </A><BR>
    <I>Wed Jan 14 22:44:14 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001705.html">[squid-users] Fwd: Squid 3.4.10 RPMs release for CentOS 32 and	64 bit.
</A></li>
        <LI>Next message (by thread): <A HREF="001459.html">[squid-users] [squid-announce] Squid 3.4.11 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1458">[ date ]</a>
              <a href="thread.html#1458">[ thread ]</a>
              <a href="subject.html#1458">[ subject ]</a>
              <a href="author.html#1458">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dnia &#346;roda, 14 Stycznia 2015 10:17 Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; napisa&#322;(a)
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i> On 14/01/2015 10:28 a.m., Robert wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I think my Squid doesn't cache. I have Ubuntu 14, I installed Squid
</I>&gt;<i> &gt; from packages (3.3.8) and now from source (3.4.10). In both cases I
</I>&gt;<i> &gt; used just basic configuration like that basic from installing from
</I>&gt;<i> &gt; source. I typed in webbrowser proxy manually and in access.log I
</I>&gt;<i> &gt; get still e.g.:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1421183358.241    528 10.59.1.9 TCP_MISS/200 5430 CONNECT
</I>&gt;<i> &gt; tools.google.com:443 - HIER_DIRECT/2607:f8b0:400d:c06::8b -
</I>&gt;<i> &gt; 1421183397.402 313700 10.59.1.9 TCP_MISS/200 10327 CONNECT
</I>&gt;<i> &gt; s-static.ak.facebook.com:443 - HIER_DIRECT/2600:1404:14:189::236 -
</I>&gt;<i> CONNECT tunnels are not cacheable.
</I>&gt;<i> &gt; 1421183413.126    114 10.59.1.9 TCP_MISS/200 1701 GET
</I>&gt;<i> &gt; <A HREF="http://finance.services.appex.bing.com/Market.svc/AppTileV2?">http://finance.services.appex.bing.com/Market.svc/AppTileV2?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.100.184 application/xml 1421183413.136    121
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/200 1657 GET
</I>&gt;<i> &gt; <A HREF="http://en-us.appex-rf.msn.com/cgtile/v1/en-US/News/Today.xml">http://en-us.appex-rf.msn.com/cgtile/v1/en-US/News/Today.xml</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.100.184 application/xml 1421183413.145    129
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/200 1593 GET
</I>&gt;<i> &gt; <A HREF="http://en-us.appex-rf.msn.com/cgtile/v1/en-US/HealthAndFitness/Home.xml?">http://en-us.appex-rf.msn.com/cgtile/v1/en-US/HealthAndFitness/Home.xml?</A>
</I>&gt;<i> &gt; - HIER_DIRECT/23.220.100.184 application/xml 1421183413.147    131
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/200 305 GET
</I>&gt;<i> &gt; <A HREF="http://service.weather.microsoft.com/appex/DesktopTile/PreInstallLiveTile?">http://service.weather.microsoft.com/appex/DesktopTile/PreInstallLiveTile?</A>
</I>&gt;<i> &gt; - HIER_DIRECT/23.220.115.174 - 1421183413.216     88 10.59.1.9
</I>&gt;<i> &gt; TCP_MISS/200 1554 GET
</I>&gt;<i> &gt; <A HREF="http://en-us.appex-rf.msn.com/cgtile/v1/en-US/Sports/Today.xml?">http://en-us.appex-rf.msn.com/cgtile/v1/en-US/Sports/Today.xml?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.100.184 application/xml
</I>&gt;<i> There are no repeat requests in the above trace. Thus no way to tell
</I>&gt;<i> whether a HIT was even possible.
</I>&gt;<i> Without query string details the only testable URI was the
</I>&gt;<i> News/Today.xml and that says:
</I>&gt;<i> * its cacheable for only 6 minutes 5 seconds. Squid will use a
</I>&gt;<i> revalidation contitional request to update it on repeat visitors
</I>&gt;<i> outside that time...
</I>&gt;<i> * The ETag used to identify the reply object uniquely is constantly
</I>&gt;<i> changing even when the reply object has *not* changed. So even if
</I>&gt;<i> Squid does cache one reply the next update/revalidation check will
</I>&gt;<i> says the object changed - which is a MISS instead of REFRESH. Causing...
</I>&gt;<i> * An If-None-Match conditional request returned the full content
</I>&gt;<i> unchanged.
</I>&gt;<i> * An If-Modified-Since conditional request returned the full content
</I>&gt;<i> unchanged.
</I>&gt;<i> All of that means Squid only ever gets told by the server to discard
</I>&gt;<i> its cached content and waste bandwidth re-downloading it. IMHO these
</I>&gt;<i> are signs of a rather badly designed site.
</I>&gt;<i> &gt; 1421183413.322    185 10.59.1.9 TCP_MISS_ABORTED/503 1541 GET
</I>&gt;<i> &gt; <A HREF="http://www.amazon.com/gp/am/metro/application/livetileRedirect?">http://www.amazon.com/gp/am/metro/application/livetileRedirect?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/205.251.242.103 text/html
</I>&gt;<i> &gt; 1421183415.611    132 10.59.1.9 TCP_MISS/206 8526 GET
</I>&gt;<i> &gt; <A HREF="http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87i9P.jpg?">http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87i9P.jpg?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.133.211 image/jpeg 1421183416.619     34
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/206 834 GET
</I>&gt;<i> &gt; <A HREF="http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87i9P.jpg?">http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87i9P.jpg?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.133.211 image/jpeg 1421183417.094     76
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/206 11123 GET
</I>&gt;<i> &gt; <A HREF="http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA86gtq.jpg?">http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA86gtq.jpg?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.133.211 image/jpeg 1421183418.269     52
</I>&gt;<i> &gt; 10.59.1.9 TCP_MISS/206 4882 GET
</I>&gt;<i> <A HREF="http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87zJF.jpg?">http://img.stb.s-msn.com/usappex/tenant/amp/entityid/AA87zJF.jpg?</A> -
</I>&gt;<i> &gt; HIER_DIRECT/23.220.133.211 image/jpeg
</I>&gt;<i> Partial messages (206) from servers are not cacheable by Squid. And
</I>&gt;<i> again the non-logged query parameters may make what appears to be
</I>&gt;<i> identical requests actually quite different.
</I>&gt;<i> &gt; I don't have any TCP_HIT :( , so what is going on ? why Squid
</I>&gt;<i> &gt; doesn't work ? :(
</I>&gt;<i> &gt;
</I>&gt;<i> For testing configure:
</I>&gt;<i>   strip_query_terms off
</I>&gt;<i> Also, how are you doing the testing?
</I>&gt;<i> HTTP clients are able to send explicit instructions to proxies
</I>&gt;<i> forbidding the use of cache. The curl tools do that by default, and
</I>&gt;<i> also the browser &quot;Refresh&quot; or &quot;Reload&quot; buttons.
</I>&gt;<i>  
</I>
1. ok , so testing I do by surfing on two sites wp.pl and kosmos.pl , if you think they are wrong please give me samples of sites which will be good for testing 
2. I'm testing by going few time through the same links and also using refresh , and I get most :
TCP_MISS/200
sometimes:
TCP_REFRESH_UNMODIFIED/304 





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001705.html">[squid-users] Fwd: Squid 3.4.10 RPMs release for CentOS 32 and	64 bit.
</A></li>
	<LI>Next message (by thread): <A HREF="001459.html">[squid-users] [squid-announce] Squid 3.4.11 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1458">[ date ]</a>
              <a href="thread.html#1458">[ thread ]</a>
              <a href="subject.html#1458">[ subject ]</a>
              <a href="author.html#1458">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
