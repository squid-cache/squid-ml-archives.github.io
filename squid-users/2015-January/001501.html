<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20%20Odp%3A%20%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54B8743E.2010202%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001498.html">
   <LINK REL="Next"  HREF="001499.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20%20Odp%3A%20%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54B8743E.2010202%40treenet.co.nz%3E"
       TITLE="[squid-users] Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan 16 02:15:26 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001498.html">[squid-users] Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
        <LI>Next message (by thread): <A HREF="001499.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1501">[ date ]</a>
              <a href="thread.html#1501">[ thread ]</a>
              <a href="subject.html#1501">[ subject ]</a>
              <a href="author.html#1501">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 16/01/2015 10:07 a.m., Robert wrote:
&gt;<i> Dnia Czwartek, 15 Stycznia 2015 12:54 Yuri Voinov
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; napisa&#322;(a)
</I>&gt;&gt;<i> 
</I>&gt;<i> This URL
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Images/img4.jpg">http://www.squid-cache.org/Images/img4.jpg</A>
</I>&gt;<i> 
</I>&gt;<i> produces HIT on second query.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> Ok, this is working - give TCP_MEM_HIT/200
</I>&gt;<i> 
</I>&gt;&gt;<i> But can anybody explain me why such a images are not cached ? 
</I>&gt;&gt;<i> 1421355736.332 341144 10.59.1.9 TCP_MISS/200 9228 CONNECT
</I>&gt;&gt;<i> api.instagram.com:443 - HIER_DIRECT/107.23.224.121 - 
</I>&gt;&gt;<i> 1421355736.332  14042 10.59.1.9 TCP_MISS/200 255 CONNECT
</I>&gt;&gt;<i> www.facebook.com:443 - HIER_DIRECT/2a03:2880:f000:1:face:b00c:0:1
</I>&gt;&gt;<i> - 1421355736.577   1980 10.59.1.9 TCP_MISS/200 62566 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/8334168249_1b5c1a6e7a_k-726x400.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/11/8334168249_1b5c1a6e7a_k-726x400.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355736.828    738
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 48321 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/2335080161_6c96f831b1_b-726x400.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/11/2335080161_6c96f831b1_b-726x400.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355737.010   3036
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 124617 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/277485096_a64e491f09_o-726x400.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/11/277485096_a64e491f09_o-726x400.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355737.461    376
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 627 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/themes/rigel/images/main_slider_bg.png">http://www.blogojciec.pl/wp-content/themes/rigel/images/main_slider_bg.png</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/png 1421355737.842    357
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 447 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/plugins/facebook-page-promoter-lightbox/includes/front/scs/blank.gif">http://www.blogojciec.pl/wp-content/plugins/facebook-page-promoter-lightbox/includes/front/scs/blank.gif</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/gif 1421355738.547   1695
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 138449 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2013/09/DSC_1397.jpg">http://www.blogojciec.pl/wp-content/uploads/2013/09/DSC_1397.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355738.819   2937
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 143772 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/6947435171_465587a2d4_k-726x400.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/11/6947435171_465587a2d4_k-726x400.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355741.078   7149
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 384465 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/AMNESTY_STOP_1-716x400.png">http://www.blogojciec.pl/wp-content/uploads/2014/11/AMNESTY_STOP_1-716x400.png</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/png 1421355741.339 240241
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 5106 CONNECT clients2.google.com:443 -
</I>&gt;&gt;<i> HIER_DIRECT/2607:f8b0:4002:c07::8a - 1421355744.032   7405
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 538419 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/Rachels-header-with-Ben-added-and-name-726x400.png">http://www.blogojciec.pl/wp-content/uploads/2014/11/Rachels-header-with-Ben-added-and-name-726x400.png</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/png 1421355744.092   8379
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 470427 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/11/poland-726x400.png">http://www.blogojciec.pl/wp-content/uploads/2014/11/poland-726x400.png</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/png 1421355746.084   1964
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 60489 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2015/01/4815760850_4b06e8e3d1_b-960x430.jpg">http://www.blogojciec.pl/wp-content/uploads/2015/01/4815760850_4b06e8e3d1_b-960x430.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355746.333 351147
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 9257 CONNECT api.instagram.com:443 -
</I>&gt;&gt;<i> HIER_DIRECT/107.23.224.121 - 1421355746.333  20041 10.59.1.9
</I>&gt;&gt;<i> TCP_MISS/200 173 CONNECT fbstatic-a.akamaihd.net:443 -
</I>&gt;&gt;<i> HIER_DIRECT/2600:1404:14::17dc:64b3 - 1421355746.333  20039
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 173 CONNECT fbstatic-a.akamaihd.net:443 -
</I>&gt;&gt;<i> HIER_DIRECT/2600:1404:14::17dc:64b3 - 1421355746.507   2373
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 152416 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/03/4957524690_62271cbc0f_o-e1409310201525-960x430.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/03/4957524690_62271cbc0f_o-e1409310201525-960x430.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355747.597   3462
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 207217 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/05/sad.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/05/sad.jpg</A> -
</I>&gt;&gt;<i> HIER_DIRECT/185.23.21.14 image/jpeg 1421355747.698   1184
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 61353 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/12/6697132255_2ddb665dd7_o-800x430.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/12/6697132255_2ddb665dd7_o-800x430.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355748.101   2006
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 62702 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2015/01/1902628132_1dc03a6544_b-960x430.jpg">http://www.blogojciec.pl/wp-content/uploads/2015/01/1902628132_1dc03a6544_b-960x430.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355750.199   6060
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 87128 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/06/kitchenok.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/06/kitchenok.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355750.357   2745
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 91760 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/12/14296826765_557697dc2a_k-960x430.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/12/14296826765_557697dc2a_k-960x430.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg 1421355750.542   6399
</I>&gt;&gt;<i> 10.59.1.9 TCP_MISS/200 174792 GET
</I>&gt;&gt;<i> <A HREF="http://www.blogojciec.pl/wp-content/uploads/2014/05/spiderman.jpg">http://www.blogojciec.pl/wp-content/uploads/2014/05/spiderman.jpg</A>
</I>&gt;&gt;<i> - HIER_DIRECT/185.23.21.14 image/jpeg ^C
</I>&gt;<i> 
</I>&gt;&gt;<i> My testing was: - first I opened this blog site in Chrome - then
</I>&gt;&gt;<i> I opened it in IE
</I>&gt;<i> 
</I>&gt;&gt;<i> so why ?
</I>

The site is using HTTP header &quot;Vary: User-Agent&quot;.

So each time you change browser Squid has to discard its content and
fetch new ones. There is nothing that can be done about that short of
getting the website itself fixed.

FYI: I checked these URLs with the tool you can find at
<A HREF="http://redbot.org/.">http://redbot.org/.</A> Simply pick a URL you think should be cached, and
paste it into the redbot tool. It runs a series of tests and lists all
the HTTP problems it can find.


For testing ensure that you;
* use only one browser at a time
 - two is fine overall, BUT only use one for a series of tests before
switching and repeating the whole series. if you switch in the middle
of the series or after only one request things liek Vary in HTTP will
make your test shave garbage results (eg. constant MISS you are seeing).

* make several requests in a row from your chosen browser *without*
using the refresh/reload button (instead click in address bar and
press enter).

* clear the *browser* cach if you like between requests to see what
Squid does with multiple clients.



Also, please note that several different result tags/codes (HIT,
REFRESH, SWAPFAIL, SHARED, STALE, OFFLINE, etc) are all &quot;cache hits&quot;.
See
&lt;<A HREF="http://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_result_codes">http://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_result_codes</A>&gt;
for details on what the tags all mean.

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUuHQ9AAoJELJo5wb/XPRjlH4IAMyzMsSIXsym+bjDJG2NThyf
lUCsrvFUKxE10WBc32tjzyArjM/Ve+YT2zUvjHWYkgd+/YSH+3IvwpFd4jplaUWZ
H5faFquaK/75uOtGPSyZxrjaLOCo0F/HNO4U/7XQrULpFpSJolDFDmCASW3wtO9a
LdH+7J1SwP+jz1jQ2h02oyqkuxdg8669ZDzxcztkSJnZwP3GSg0R4IjWE2hb/HKK
DstGLlLJUgeJtor0KJAN459IOHE5pv590gGuWQdGZO0abANphDdWdKdve2ClVn5B
MTR70O+LuRwkfSdsC9FqUd5fMs8dQv8YQ1ue/7le/ypx/X6UpkHYKqOlAlB46MM=
=deb/
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001498.html">[squid-users] Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
	<LI>Next message (by thread): <A HREF="001499.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1501">[ date ]</a>
              <a href="thread.html#1501">[ thread ]</a>
              <a href="subject.html#1501">[ subject ]</a>
              <a href="author.html#1501">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
