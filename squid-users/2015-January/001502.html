<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20Odp%3A%20Re%3A%20%20Odp%3A%20%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54B88116.1010600%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001499.html">
   <LINK REL="Next"  HREF="001504.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Odp%3A%20Re%3A%20Odp%3A%20Re%3A%20%20Odp%3A%20%20Odp%3A%20Re%3A%20%20Only%20TCP_MISS&In-Reply-To=%3C54B88116.1010600%40treenet.co.nz%3E"
       TITLE="[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan 16 03:10:14 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001499.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
        <LI>Next message (by thread): <A HREF="001504.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1502">[ date ]</a>
              <a href="thread.html#1502">[ thread ]</a>
              <a href="subject.html#1502">[ subject ]</a>
              <a href="author.html#1502">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 16/01/2015 10:35 a.m., Robert wrote:
&gt;<i> Dnia Czwartek, 15 Stycznia 2015 22:16 Yuri Voinov napisa&#322;(a)
</I>&gt;&gt;<i> Oh,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> of course - you must to warm up cache first also.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> :)
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 1. warm up cache What the hell is that ? ;) , no Squid installation
</I>&gt;<i> guide says about it, please give me link to some (simple) guide to
</I>&gt;<i> warm up my swap to cache as much as possible
</I>&gt;<i> 
</I>
Squid of course *does not* come bundled with an installed copy of the
entire Internet.

A freshly installed or restarted[1] proxy has a cache in state called
&quot;cold&quot;. Each repeat fetch for a URL &quot;warms&quot; it.URL which are often
requested are called &quot;hot&quot;.

You have to make one request where a MISS is guaranteed. That request
tells Squid whether to cache the reply for *future* use. All that
first request will tell you is whether the URL is possible to fetch.
Nothing about caching in access.log.

To know if a reply has been cached requires at least a second request.
That ones access.log details say whether *it* was a hit or miss or
refresh.


[1] disk cache persist across restart. So simply restarting Squid
resets to either cold or warm states depending on disk usage. Usually
the hottest objects will be exclusively in RAM and the latest copy
need fetching from the network on restart - this ensures that hot
objects are always up to date and accurate.


&gt;<i> 2. &quot;First reason - HTTP headers. I.e, no cache. etc. You can
</I>&gt;<i> override them with refresh_patterns violations. :)&quot; Again, please
</I>&gt;<i> tell me what refresh_patterns should I set to increase as most
</I>&gt;<i> caching , also with headers caching if this is possible
</I>&gt;<i> 
</I>
Please don't go that way. At least not now. So far it has been your
testing methodology which is broken, not the sites operation. (Except
that one doing Vary:User-Agent and nothing can be done in squid.conf
about that.)

Many of the refresh_pattern override/ignore options *break* HTTP and
are only to be used if you understand the impact of what that use
means, with a specific broken website that requires it. You need to
know exactly *what* is broken about the website to be able to
configure the overrides correctly for it.


If you want better caching, ensure that you have the latest Squid
available. We are constantly searching out ways to safely improve the
amount Squid can store and remove the need for those overrides to
exist at all.



&gt;<i> 3. I did next text with site pkp.pl: 1421356447.223    193
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 4657 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/disab.png">http://rozklad-pkp.pl/img/content/icons/disab.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.270    200
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 4505 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/direct.png">http://rozklad-pkp.pl/img/content/icons/direct.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.274    961
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 80175 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/css/lato-bold-webfont.woff">http://rozklad-pkp.pl/css/lato-bold-webfont.woff</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 text/plain 1421356447.297    190
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1683 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/arrow-down-3.png">http://rozklad-pkp.pl/img/content/icons/arrow-down-3.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.442    198
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1732 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/main/plus.png">http://rozklad-pkp.pl/img/content/icons/main/plus.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.455    193
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1834 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/header/search.png">http://rozklad-pkp.pl/img/header/search.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.476    209
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1665 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/main/from.png">http://rozklad-pkp.pl/img/content/icons/main/from.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.502    228
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1641 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/main/cal.png">http://rozklad-pkp.pl/img/content/icons/main/cal.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.525      2
</I>&gt;<i> 10.59.1.9 TCP_MEM_HIT/200 46701 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/map/mapa3.png">http://rozklad-pkp.pl/img/content/icons/map/mapa3.png</A> - HIER_NONE/-
</I>&gt;<i> image/png 1421356447.530    246 10.59.1.9 TCP_MISS/200 1666 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/main/to.png">http://rozklad-pkp.pl/img/content/icons/main/to.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.569    266
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1735 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/arrow-up-2.png">http://rozklad-pkp.pl/img/content/icons/arrow-up-2.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.901    445
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 8944 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/bg/bn-na.png">http://rozklad-pkp.pl/img/content/bg/bn-na.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.932    471
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 7638 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/bg/bn-na_780.png">http://rozklad-pkp.pl/img/content/bg/bn-na_780.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356447.959    478
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 6506 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/bg/bn-na_480.png">http://rozklad-pkp.pl/img/content/bg/bn-na_480.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356448.457    916
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1573 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/main/minus.png">http://rozklad-pkp.pl/img/content/icons/main/minus.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356448.477    932
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1786 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/hafas-res/img/sel_prod_ice.gif">http://rozklad-pkp.pl/hafas-res/img/sel_prod_ice.gif</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/gif 1421356448.552    979
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1771 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/hafas-res/img/sel_prod_ic.gif">http://rozklad-pkp.pl/hafas-res/img/sel_prod_ic.gif</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/gif 1421356448.586   1281
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 672 GET
</I>&gt;<i> <A HREF="http://bbcdn-bbnaut.ibillboard.com/server-static-files/bbnaut-b.swf">http://bbcdn-bbnaut.ibillboard.com/server-static-files/bbnaut-b.swf</A>
</I>&gt;<i> - HIER_DIRECT/194.213.222.30 application/x-shockwave-flash 
</I>&gt;<i> 1421356448.668    741 10.59.1.9 TCP_MISS/200 1823 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/hafas-res/img/sel_prod_ir-d.gif">http://rozklad-pkp.pl/hafas-res/img/sel_prod_ir-d.gif</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/gif 1421356448.694    757
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1868 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/hafas-res/img/sel_prod_re-rb.gif">http://rozklad-pkp.pl/hafas-res/img/sel_prod_re-rb.gif</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/gif 1421356448.956    467
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 9284 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/banners/banner3.jpg">http://rozklad-pkp.pl/img/content/banners/banner3.jpg</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/jpeg 1421356448.973    477
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 4047 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/arrow-up-4.png">http://rozklad-pkp.pl/img/content/icons/arrow-up-4.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356448.976    417
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 636 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/css/images/ui-bg_flat_75_ffffff_40x100.png">http://rozklad-pkp.pl/css/images/ui-bg_flat_75_ffffff_40x100.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356449.045    324
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 5414 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/bullet-active.png">http://rozklad-pkp.pl/img/content/icons/bullet-active.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356449.064    338
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 4736 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/icons/bullet.png">http://rozklad-pkp.pl/img/content/icons/bullet.png</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/png 1421356449.110    917
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 16451 GET
</I>&gt;<i> <A HREF="http://rozklad-pkp.pl/img/content/banners/banner2.jpg">http://rozklad-pkp.pl/img/content/banners/banner2.jpg</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/jpeg 1421356449.321    179
</I>&gt;<i> 10.59.1.9 TCP_MISS/200 1594 GET <A HREF="http://rozklad-pkp.pl/favicon.ico">http://rozklad-pkp.pl/favicon.ico</A> -
</I>&gt;<i> HIER_DIRECT/213.199.225.44 image/vnd.microsoft.icon 1421356449.658
</I>&gt;<i> 348 10.59.1.9 TCP_MISS/304 167 GET
</I>&gt;<i> <A HREF="http://bbnaut.ibillboard.com/g/ca2">http://bbnaut.ibillboard.com/g/ca2</A> - HIER_DIRECT/62.209.227.210 -
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> .. and once again I see many picture files not cached , why ?
</I>
The servers clock is out of sync. And there is again only one fetch
for each object in your log so no way to know if they are cold
requests or whats going on. bit of a mstery even why mapa3.png *does* HIT.


Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUuIEWAAoJELJo5wb/XPRjAxkH/2C9fzceKXb/OQ+I912SRZjm
QbQ+4WgN/1MAw4PLatu9NIhQGC2rnh3cipnQX5dbYA8iqlocWjkt6mvkhW3kJMfE
4FDjJChaewQ0VkduLQF6bKFrND9rG7mCXnxNcWneLrtEFOzIEn9uB8phiVRWS9mZ
zXerPWjW2aqOJ+aVPMxUROAFIhpJot6s0c8unFXSQ3jqDidqgiPeFWp56o45bDdt
LSm79pU1dadcFsGxN84xKsKIDDvSmJSHLDJ78v4ixlUna5saRuPgSj2v+Zd4a/Sg
ki4+tDnT3NCz7jMnZqmBhHXfXWlqPVacBFC6jYoWQ1od5kCZfeiqaMMQDeMhvjY=
=K81h
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001499.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
	<LI>Next message (by thread): <A HREF="001504.html">[squid-users] Odp: Re: Odp: Re:  Odp:  Odp: Re:  Only TCP_MISS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1502">[ date ]</a>
              <a href="thread.html#1502">[ thread ]</a>
              <a href="subject.html#1502">[ subject ]</a>
              <a href="author.html#1502">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
