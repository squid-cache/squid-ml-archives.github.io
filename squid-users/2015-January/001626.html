<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl-bump doesn't like valid web server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl-bump%20doesn%27t%20like%20valid%20web%20server&In-Reply-To=%3C54C00A67.8080802%40trimble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001635.html">
   <LINK REL="Next"  HREF="001622.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl-bump doesn't like valid web server</H1>
    <B>Jason Haar</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl-bump%20doesn%27t%20like%20valid%20web%20server&In-Reply-To=%3C54C00A67.8080802%40trimble.com%3E"
       TITLE="[squid-users] ssl-bump doesn't like valid web server">Jason_Haar at trimble.com
       </A><BR>
    <I>Wed Jan 21 20:21:59 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001635.html">[squid-users] ssl-bump doesn't like valid web server
</A></li>
        <LI>Next message (by thread): <A HREF="001622.html">[squid-users] Internal error on squid_peer_access configuration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1626">[ date ]</a>
              <a href="thread.html#1626">[ thread ]</a>
              <a href="subject.html#1626">[ subject ]</a>
              <a href="author.html#1626">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/01/15 22:21, Steve Hill wrote:
&gt;<i> Probably not very helpful, but it works for me (squid-3.4.10,
</I>&gt;<i> Scientific Linux 6.6, bump-server-first, but not using ssl_crtd).  I
</I>&gt;<i> also can't see anything wrong with the certificate chain.
</I>Found the problem. It's only occurring via transparent https - not
explicit proxy-bumping of https

The index.txt file shows two entries for the same site.

V    171122224624Z        7D33A943166DE91162FDEEA69C6E6D7E62054DC3   
unknown   
/serialNumber=TDtNUZuQo4Ts9hs8qd1ksekvefvr7hdo/OU=GT11048499/OU=See
www.rapidssl.com/resources/cps (c)14/OU=Domain Control Validated -
RapidSSL(R)/CN=*.snap.net.nz+Sign=signTrusted
V    171122224624Z        231617D3B75F4C18A238EF42EAFC568BF27A3485   
unknown   
/serialNumber=TDtNUZuQo4Ts9hs8qd1ksekvefvr7hdo/OU=GT11048499/OU=See
www.rapidssl.com/resources/cps (c)14/OU=Domain Control Validated -
RapidSSL(R)/CN=*.snap.net.nz+Sign=signUntrusted


The &quot;signUntrusted&quot; would be via starting the cert learning process with
an IP address, whereas the first would have been via knowing in advance
it was myaccount.snap.net.nz

So what's the root cause? Is this an example of why the peek/splice
feature of 3.5 is so important to the success of transparent HTTPS
bumping? (ie is it because there wasn't a SNI hostname)


-- 
Cheers

Jason Haar
Corporate Information Security Manager, Trimble Navigation Ltd.
Phone: +1 408 481 8171
PGP Fingerprint: 7A2E 0407 C9A6 CAF6 2B9F 8422 C063 5EBB FE1D 66D1


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001635.html">[squid-users] ssl-bump doesn't like valid web server
</A></li>
	<LI>Next message (by thread): <A HREF="001622.html">[squid-users] Internal error on squid_peer_access configuration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1626">[ date ]</a>
              <a href="thread.html#1626">[ thread ]</a>
              <a href="subject.html#1626">[ subject ]</a>
              <a href="author.html#1626">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
