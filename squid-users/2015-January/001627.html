<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] benefits of using ext_kerberos_ldap_group_acl	instead of ext_ldap_group_acl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20benefits%20of%20using%20ext_kerberos_ldap_group_acl%0A%09instead%20of%20ext_ldap_group_acl&In-Reply-To=%3Cm9p47l%247d4%241%40ger.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001604.html">
   <LINK REL="Next"  HREF="001616.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] benefits of using ext_kerberos_ldap_group_acl	instead of ext_ldap_group_acl</H1>
    <B>Markus Moeller</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20benefits%20of%20using%20ext_kerberos_ldap_group_acl%0A%09instead%20of%20ext_ldap_group_acl&In-Reply-To=%3Cm9p47l%247d4%241%40ger.gmane.org%3E"
       TITLE="[squid-users] benefits of using ext_kerberos_ldap_group_acl	instead of ext_ldap_group_acl">huaraz at moeller.plus.com
       </A><BR>
    <I>Wed Jan 21 21:03:42 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001604.html">[squid-users] benefits of using ext_kerberos_ldap_group_acl instead of ext_ldap_group_acl
</A></li>
        <LI>Next message (by thread): <A HREF="001616.html">[squid-users] benefits of using ext_kerberos_ldap_group_acl  instead of ext_ldap_group_acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1627">[ date ]</a>
              <a href="thread.html#1627">[ thread ]</a>
              <a href="subject.html#1627">[ subject ]</a>
              <a href="author.html#1627">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>&quot;Amos Jeffries&quot;  wrote in message news:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">54BE53B2.9070200 at treenet.co.nz...</A>
</I>&gt;<i>
</I>&gt;<i>-----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i>Hash: SHA1
</I>&gt;<i>
</I>&gt;<i>On 21/01/2015 1:38 a.m., Simon Staeheli wrote:
</I>&gt;&gt;&gt;<i> Whatever floats your boat. The point of the Addon/Plugin/helpers
</I>&gt;&gt;&gt;<i> API is that you can use scripts if thy serve your needs better.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> All the usual Open Source benefits of &quot;many eyeballs&quot; and
</I>&gt;&gt;&gt;<i> somebody else doing code maintenance for you applies to using a
</I>&gt;&gt;&gt;<i> bundled helper over a custom written one.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Beyond that the kerberos helper also provides automatic detection
</I>&gt;&gt;&gt;<i> of which LDAP server to use via mutiple auto-configuration
</I>&gt;&gt;&gt;<i> methods.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you can demonstrate that the ext_kerberos_ldap_group_acl does
</I>&gt;&gt;&gt;<i> provides a superset of the functionality of ext_ldap_group_acl
</I>&gt;&gt;&gt;<i> helper then I can de-duplicate the two helpers.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Amos
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks for the hint regarding automatic detection of LDAP servers.
</I>&gt;&gt;<i> I am just trying to find what the differences between the two
</I>&gt;&gt;<i> helpers are and which one does fit my needs better. Any others?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Nothing I can pick out easily.
</I>&gt;<i>
</I>&gt;&gt;<i> Do you know anything about the feature in
</I>&gt;&gt;<i> ext_kerberos_ldap_group_acl mentioned by Markus Moeller in an
</I>&gt;&gt;<i> earlier post?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;I have a new method in my squid 3.4 patch which uses the Group
</I>&gt;&gt;<i> Information MS is putting in the ticket. This would eliminate the
</I>&gt;&gt;<i> ldap lookup completely.&quot;
</I>&gt;&gt;<i> (<A HREF="http://www.squid-cache.org/mail-archive/squid-users/201309/0046.html">http://www.squid-cache.org/mail-archive/squid-users/201309/0046.html</A>)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>I think that refers to a work in progress. Markus maintains the
</I>&gt;<i>un-bundled version of his helpers a little in advance of what has made
</I>&gt;<i>it into the Squid stable branch. Some of what is available in his
</I>&gt;<i>helper downloads is only in the Squid-3.HEAD alpha development code so
</I>&gt;<i>far.
</I>&gt;<i>
</I>&gt;<i>I am working on obsoleting the need for external group helpers. From
</I>&gt;<i>3.5 auth helpers can deliver to Squid a set of group= kv-pair in their
</I>&gt;<i>response. Those can be used with the note ACL type to check group
</I>&gt;<i>names without any external_acl_type helper lookup (making group checks
</I>&gt;<i>possible in 'fast' access controls).
</I>&gt;<i>
</I>&gt;<i>Markus joined me in this project and his latest kerberos auth helper
</I>&gt;<i>(in 3.HEAD and his versions - *not* the 3.5 bundled version) produces
</I>&gt;<i>group= kv-pair. Unfortunately they are in the obscure S-*-*-* registry
</I>&gt;<i>ID format MS uses. The external_acl_type helper interface cannot yet
</I>&gt;<i>be passed notes to decipher that to a known group name.
</I>&gt;<i>
</I>
The Kerberos authentication helper extracts the Microsoft authorisation data 
from the Kerberos ticket. This so called  PAC data contains the AD Security 
Groups a user belongs too ( even over a forest/domain as far as I recall and 
nested groups).   The format of the authorisation data is the AD objectsid 
which the helper returns in base64  encoding.  So now instead of querying 
LDAP an external helper just need to compare the base64 encoded SID with a 
predefined SID.  You just have to know the SID when you setup the 
configuration in the same way as you have to know the AD group name with an 
ldap helper.

&gt;<i>From a Unix system you can easily get the object sid if you know the 
</I>groupname. e.g.

# kinit <A HREF="https://lists.squid-cache.org/listinfo/squid-users">markus at WIN2003R2.HOME</A>
# ldapsearch -LLL -H <A HREF="ldap://w2k3r2.win2003r2.home">ldap://w2k3r2.win2003r2.home</A> -s sub -b 
DC=WIN2003R2,DC=HOME &quot;(CN=SOCKS_ALLOW)&quot; objectsid
SASL/GSSAPI authentication started
SASL username: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">markus at WIN2003R2.HOME</A>
SASL SSF: 56
SASL data security layer installed.
dn: CN=SOCKS_ALLOW,OU=Groups,DC=win2003r2,DC=home
objectSid:: AQUAAAAAAAUVAAAAploCbWTufUFPWoiaiwQAAA==

Any ldap browser like ldapadmin can also show the objectsid.

I have also a tool which I can provide to convert a SID into a base64 value

Examples:

# ./convert_sid S-1-5-21-1828870822-1098772068-2592627279-1163
base64 encoded: AQUAAAAAAAUVAAAAploCbWTufUFPWoiaiwQAAA==
hexadecimal: 01 05 00 00 00 00 00 05 15 00 00 00 a6 5a 02 6d 64 ee 7d 41 4f 
5a 88 9a 8b 04 00 00
SID: S-1-5-21-1828870822-1098772068-2592627279-1163

# ./convert_sid AQUAAAAAAAUVAAAAploCbWTufUFPWoiaiwQAAA==
base64 encoded: AQUAAAAAAAUVAAAAploCbWTufUFPWoiaiwQAAA==
hexadecimal: 01 05 00 00 00 00 00 05 15 00 00 00 a6 5a 02 6d 64 ee 7d 41 4f 
5a 88 9a 8b 04 00 00
SID: S-1-5-21-1828870822-1098772068-2592627279-1163

# ./convert_sid 01 05 00 00 00 00 00 05 15 00 00 00 a6 5a 02 6d 64 ee 7d 41 
4f 5a 88 9a 8b 04 00 00
base64 encoded: AQUAAAAAAAUVAAAAploCbWTufUFPWoiaiwQAAA==
hexadecimal: 01 05 00 00 00 00 00 05 15 00 00 00 a6 5a 02 6d 64 ee 7d 41 4f 
5a 88 9a 8b 04 00 00
SID: S-1-5-21-1828870822-1098772068-2592627279-1163


Please let me know if you have questions, comments or ideas

Regards
Markus


&gt;<i>Amos
</I>&gt;<i>
</I>&gt;<i>-----BEGIN PGP SIGNATURE-----
</I>&gt;<i>Version: GnuPG v2.0.22 (MingW32)
</I>&gt;<i>
</I>&gt;<i>iQEcBAEBAgAGBQJUvlOyAAoJELJo5wb/XPRjZskH/3VQdCv4juTHZ0QAOyQvCdLP
</I>&gt;<i>L1ZRDF/ix4MkVIsblsPL20G1KznKRbDBdDZ+DWM4lHDp7m1rwXD972GUmI7JZQDV
</I>&gt;<i>VvjQVMrXfZ3h8VcwpzPXKKiIOJp3+P5e7XpVDQGYAzOBJjnvs2OsIKGGsGwo4kXE
</I>&gt;<i>lElRU9WbspurY4ic07hjSCcM3VAdWMtIy8FVoq2bdegH6qor1dGeoVIMYVnSOBUG
</I>&gt;<i>9gTqWBYxkltI5S19f6zWjk2Kscn7ZYWvPezN38NHouL4ueM0rAHxvUNP2ueudUwR
</I>&gt;<i>tZBavBNpiCJ08dXbhU1nUivyTQX99w8t0VMmYeomTc2Q7znofsX0FefFRFZ1GcY=
</I>&gt;<i>=Yg6k
</I>&gt;<i>-----END PGP SIGNATURE-----
</I>&gt;<i>_______________________________________________
</I>&gt;<i>squid-users mailing list
</I>&gt;<i><A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i><A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001604.html">[squid-users] benefits of using ext_kerberos_ldap_group_acl instead of ext_ldap_group_acl
</A></li>
	<LI>Next message (by thread): <A HREF="001616.html">[squid-users] benefits of using ext_kerberos_ldap_group_acl  instead of ext_ldap_group_acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1627">[ date ]</a>
              <a href="thread.html#1627">[ thread ]</a>
              <a href="subject.html#1627">[ subject ]</a>
              <a href="author.html#1627">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
