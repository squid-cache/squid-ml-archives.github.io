<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid versions and FreeBSD-10.1 headache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20versions%20and%20FreeBSD-10.1%20headache&In-Reply-To=%3C54C24796.5010601%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001650.html">
   <LINK REL="Next"  HREF="001653.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid versions and FreeBSD-10.1 headache</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20versions%20and%20FreeBSD-10.1%20headache&In-Reply-To=%3C54C24796.5010601%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid versions and FreeBSD-10.1 headache">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan 23 13:07:34 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001650.html">[squid-users] Squid versions and FreeBSD-10.1 headache
</A></li>
        <LI>Next message (by thread): <A HREF="001653.html">[squid-users] Squid versions and FreeBSD-10.1 headache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1651">[ date ]</a>
              <a href="thread.html#1651">[ thread ]</a>
              <a href="subject.html#1651">[ subject ]</a>
              <a href="author.html#1651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 24/01/2015 1:47 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> Once more. You CANNOT have neither web-server nor other service
</I>&gt;<i> with listening port 80 on the same host as transparent Squid proxy.
</I>&gt;<i> This is one and only reason you have looping.
</I>&gt;<i> 
</I>
That is not correct. It can be done, but depends on how the firewall
operates and what ruleset is used.

One has to intercept traffic transiting the machine, but ignore
traffic destined *to* or *from* the local machines running processes.

&gt;<i> Look. On my transparent 3.4.11 (which was early 2.7) IPFilter
</I>&gt;<i> redirects 80 port to proxy. My web server on the same host listens
</I>&gt;<i> only 8080, 8088 and 8888 ports. No one service except NAT is using
</I>&gt;<i> 80 port.
</I>&gt;<i> 
</I>&gt;<i> And finally I have no looping 4 years.
</I>&gt;<i> 
</I>&gt;<i> Obvious, is it?
</I>&gt;<i> 
</I>
Maybe there was, maybe there wasn't.

Squid-2.7 ignored a lot of NAT related errors and even silently did
some Very Bad Things(tm) - none of which Squid-3.2+ will allow to
happen anymore.


Odhiambo:
I suspect it might be related to your use of &quot;rdr&quot; firewall rules. In
OpenBSD PF at least rdr rules do not work properly and divert-to rules
needs to be used instead (divert-to can be used for either TPROXY or
NAT Squid listening ports on BSD).

Amos
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (MingW32)

iQEcBAEBAgAGBQJUwkeWAAoJELJo5wb/XPRjImUIANjXvqdDsm7FUGmSG0lCikPS
EBl2xGqatglZnQOQQ1KnVX4oLtcDqtFUaAMNUedGrQc0JNsGHIIOqNioehJuTSko
ET/gYf6otuqGyjGz2CZIXcoaFUOwXNd7jkt8jx3n4k5D0HemfOYH//bAdMRarNuZ
NV7YPoWOxjYQHFvBE2fFCDl9yslXSYrvBbCJxueFVTkI0SQ1NoRtotaOeOZFe9hy
Y1zWihly/5koQfTg99tYCuUpNgRYuNslRaSYSfx1PTFQQTTYkw20OeYES6ZFxMp1
jt2vARsvxePndzVFT+rmadoQQDgCk6NbwON4LpexoulhJcGzuH5xb6z1CQaZvE0=
=Joqh
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001650.html">[squid-users] Squid versions and FreeBSD-10.1 headache
</A></li>
	<LI>Next message (by thread): <A HREF="001653.html">[squid-users] Squid versions and FreeBSD-10.1 headache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1651">[ date ]</a>
              <a href="thread.html#1651">[ thread ]</a>
              <a href="subject.html#1651">[ subject ]</a>
              <a href="author.html#1651">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
