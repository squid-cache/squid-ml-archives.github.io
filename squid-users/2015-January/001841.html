<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] The email notification feature does not work after 10 days
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20The%20email%20notification%20feature%20does%20not%20work%0A%20after%2010%20days&In-Reply-To=%3CCABBDWwf2EdSncWmAaMpddmCL3bSgYXzNEwa-REgPYJYY9BzesQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001837.html">
   <LINK REL="Next"  HREF="001842.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] The email notification feature does not work after 10 days</H1>
    <B>Tianyin Xu</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20The%20email%20notification%20feature%20does%20not%20work%0A%20after%2010%20days&In-Reply-To=%3CCABBDWwf2EdSncWmAaMpddmCL3bSgYXzNEwa-REgPYJYY9BzesQ%40mail.gmail.com%3E"
       TITLE="[squid-users] The email notification feature does not work after 10 days">tixu at cs.ucsd.edu
       </A><BR>
    <I>Sat Jan 31 21:25:14 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001837.html">[squid-users] The email notification feature does not work after 10 days
</A></li>
        <LI>Next message (by thread): <A HREF="001842.html">[squid-users] The email notification feature does not work after 10 days
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1841">[ date ]</a>
              <a href="thread.html#1841">[ thread ]</a>
              <a href="subject.html#1841">[ subject ]</a>
              <a href="author.html#1841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Amos,

Thanks for the explanation. It's interesting that the 10-day feature is for
encouraging users to apply the daily released snapshots. I'm never aware of
this.

Actually, I totally understand the users who are running old stable
versions (e.g., 3.1.6). They are reluctant to change or have no time to
test out the new versions as long as the current one works ok. I'm not
talking about the production uses such as in Baidu and in Flickr where a
big team of admins watching these servers on a 24*7 basis. The email
feature is attractive for users like me who uses Squid for non-production
scenarios but still requires certain level of availability. I think that's
why the feature is still there for years and I do appreciate it :-)

Thanks again, Amos! Have a great weekend!

Best,
Tianyin


On Sat, Jan 31, 2015 at 2:04 AM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 31/01/2015 6:41 p.m., Tianyin Xu wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm trying to use the email notification feature specified in the
</I>&gt;<i> document.
</I>&gt;<i> &gt; <A HREF="http://www.squid-cache.org/Doc/config/mail_program/">http://www.squid-cache.org/Doc/config/mail_program/</A>
</I>&gt;<i> &gt; <A HREF="http://www.squid-cache.org/Doc/config/cache_mgr/">http://www.squid-cache.org/Doc/config/cache_mgr/</A>
</I>&gt;<i> &gt; <A HREF="http://www.squid-cache.org/Doc/config/mail_from/">http://www.squid-cache.org/Doc/config/mail_from/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Basically, if the Squid proxy server dies, I can receive an email
</I>&gt;<i> &gt; notification by configuring &quot;mail_program&quot;, &quot;cache_mgr&quot;, and
</I>&gt;<i> &gt; &quot;mail_from&quot;. This is a very nice feature.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However, when I start Squid and then intentionally kill Squid by
</I>&gt;<i> &gt; issuing SEGV, Squid dies without sending any email to me. Diving into
</I>&gt;<i> &gt; the code, I see that the email notification feature is disabled by the
</I>&gt;<i> &gt; following if condition,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     /* src/tools.cc */
</I>&gt;<i> &gt;     ....
</I>&gt;<i> &gt;     if (squid_curtime - SQUID_RELEASE_TIME &lt; 864000) {
</I>&gt;<i> &gt;         /* skip if more than 10 days old */
</I>&gt;<i> &gt;         if (Config.adminEmail)
</I>&gt;<i> &gt;             mail_warranty();
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         puts(dead_msg());
</I>&gt;<i> &gt;     }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; From the comment, it seems that intentionally the feature is disabled
</I>&gt;<i> &gt; if the current time is latter than 10 days after the release time
</I>&gt;<i> &gt; (which is my case). This totally makes no sense to me because most
</I>&gt;<i> &gt; users like me will use this feature after 10 days latter than the
</I>&gt;<i> &gt; release date...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Could anyone explain this? I moved the if-condition and the feature does
</I>&gt;<i> work.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I also opened a bugzilla report here,
</I>&gt;<i> &gt; <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4184">http://bugs.squid-cache.org/show_bug.cgi?id=4184</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It is a difficult situation.
</I>&gt;<i>
</I>&gt;<i> The 10 day limit is itself a feature designed to reduce spam emails
</I>&gt;<i> being delivered from production systems which are stuck long-term on
</I>&gt;<i> &quot;stable&quot; version packages. Often long after the crash being notified
</I>&gt;<i> about is found and fixed. There are people still running Squid 3.1.6 for
</I>&gt;<i> example, despite years having passed and numerous crashes having been
</I>&gt;<i> fixed.
</I>&gt;<i>
</I>&gt;<i> Squid auto-restarts after crashes to ensure minimal downtime and user
</I>&gt;<i> impact. There are also numerous other things that could happen that are
</I>&gt;<i> only ever logged - that includes the reason for the crash being
</I>&gt;<i> notified.  So you should have log monitoring in place for production
</I>&gt;<i> systems anyway which mails you on criteria you are interested in. Making
</I>&gt;<i> this feature much less interesting for production systems using the
</I>&gt;<i> formal release for long periods of time.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It is much more interesting / useful to hear about crashes in newer code
</I>&gt;<i> with less production use and testing behind it.
</I>&gt;<i>
</I>&gt;<i> The development code and daily snapshots define SQUID_RELEASE_TIME to be
</I>&gt;<i> squid_curtime so the if-condition always matches and enables the feature
</I>&gt;<i> for experimental installations.
</I>&gt;<i>
</I>&gt;<i> This combined with the fact that the only way to resolve crash
</I>&gt;<i> conditions is to patch the code and/or build latest release snapshot,
</I>&gt;<i> means that people who are actually interested in avoiding those type of
</I>&gt;<i> problem are usually running the snapshot code where the 10-day limit
</I>&gt;<i> does not apply.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150131/3abab04d/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150131/3abab04d/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001837.html">[squid-users] The email notification feature does not work after 10 days
</A></li>
	<LI>Next message (by thread): <A HREF="001842.html">[squid-users] The email notification feature does not work after 10 days
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1841">[ date ]</a>
              <a href="thread.html#1841">[ thread ]</a>
              <a href="subject.html#1841">[ subject ]</a>
              <a href="author.html#1841">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
