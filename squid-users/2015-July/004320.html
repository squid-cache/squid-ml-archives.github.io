<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid3 authentification proxy and method CONNECT SSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid3%20authentification%20proxy%20and%20method%20CONNECT%0A%20SSL&In-Reply-To=%3C5593D5FE.7030100%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004316.html">
   <LINK REL="Next"  HREF="004324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid3 authentification proxy and method CONNECT SSL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid3%20authentification%20proxy%20and%20method%20CONNECT%0A%20SSL&In-Reply-To=%3C5593D5FE.7030100%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid3 authentification proxy and method CONNECT SSL">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jul  1 11:58:54 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004316.html">[squid-users] Squid3 authentification proxy and method CONNECT SSL
</A></li>
        <LI>Next message (by thread): <A HREF="004324.html">[squid-users] Squid3 authentification proxy and method CONNECT SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4320">[ date ]</a>
              <a href="thread.html#4320">[ thread ]</a>
              <a href="subject.html#4320">[ subject ]</a>
              <a href="author.html#4320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/07/2015 8:55 p.m., Alexandre Magnat wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I use Squid3 (3.1.20) 
</I>
Please upgrade.

&gt;<i> with Squidguard filtering linked with an user 's
</I>&gt;<i> authentication  on a OpenLDAP.
</I>&gt;<i> But, recurrently, Firefox, Thunderbird, Chrome (certainly IE) ask again
</I>&gt;<i> frequently the login and password in a popup.
</I>&gt;<i> 
</I>&gt;<i> It seem, the popup authentication appear when the browser try a request
</I>&gt;<i> on a CONNECT method like this:
</I>&gt;<i> 172.16.1.215 - - [01/Jul/2015:10:40:18 +0200] &quot;CONNECT
</I>&gt;<i> fhr.data.mozilla.com:443 HTTP/1.1&quot; 407 3812 TCP_DENIED:NONE
</I>&gt;<i> or like this:
</I>&gt;<i> 172.16.1.207 - - [01/Jul/2015:10:39:40 +0200] &quot;CONNECT
</I>&gt;<i> safebrowsing.google.com:443 HTTP/1.1&quot; 407 3824 TCP_DENIED:NONE
</I>&gt;<i> 
</I>
1) no credentials were presented. Thus 407 - Auth required.

OR

2) credentials presented were rejected by the auth system. Thus 407 -
Auth requires different credentials (or scheme).

OR

3) NTLM or Negotiate handshake underway. Thus 407 - Auth requires
handshake completion.


&gt;<i> 
</I>&gt;<i> But, I think, I have configured correctly Squid3 for accept this kind of
</I>&gt;<i> request:
</I>&gt;<i> 
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> 
</I>
Those lines have nothing to do with auth. They are for rejecting non-
port 443 connection attempts.

&gt;<i> 
</I>&gt;<i> It's a boring problem for my user to have 4 or 5 times per day this kind
</I>&gt;<i> of popup :-(
</I>&gt;<i> Anybody have an idea for helping me to resolve this ?
</I>&gt;<i> 
</I>
Firefox and Thunderbird it may be
&lt;<A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=318253">https://bugzilla.mozilla.org/show_bug.cgi?id=318253</A>&gt;. I'm not sure how
long it will take Mozilla to get a fixed version of their software out.
At least they have now finally found the problem.

Chrome and IE may have similar issues. They all tend to copy each others
behaviour with things like this.

Meanwhile there is a workaround that should work - add whichever is
relavant to your config:
 auth_param ntlm keep_alive off
 auth_param negotiate keep_alive off

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004316.html">[squid-users] Squid3 authentification proxy and method CONNECT SSL
</A></li>
	<LI>Next message (by thread): <A HREF="004324.html">[squid-users] Squid3 authentification proxy and method CONNECT SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4320">[ date ]</a>
              <a href="thread.html#4320">[ thread ]</a>
              <a href="subject.html#4320">[ subject ]</a>
              <a href="author.html#4320">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
