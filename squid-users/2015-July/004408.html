<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] transparent proxy splice using dstdomain issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20splice%20using%20dstdomain%20issue&In-Reply-To=%3C559BCC59.1090403%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004407.html">
   <LINK REL="Next"  HREF="004415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] transparent proxy splice using dstdomain issue</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20transparent%20proxy%20splice%20using%20dstdomain%20issue&In-Reply-To=%3C559BCC59.1090403%40treenet.co.nz%3E"
       TITLE="[squid-users] transparent proxy splice using dstdomain issue">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jul  7 12:55:53 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004407.html">[squid-users] transparent proxy splice using dstdomain issue
</A></li>
        <LI>Next message (by thread): <A HREF="004415.html">[squid-users] transparent proxy splice using dstdomain issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4408">[ date ]</a>
              <a href="thread.html#4408">[ thread ]</a>
              <a href="subject.html#4408">[ subject ]</a>
              <a href="author.html#4408">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/07/2015 11:45 p.m., S.Kirschner wrote:
&gt;<i> Hi I&#180;m using squid version 3.5.3 as transparent proxy in pfsense and got an
</I>&gt;<i> issue with my configuration.
</I>&gt;<i> 
</I>&gt;<i> I would like to bump ssl connections and some should be spliced(for the
</I>&gt;<i> example I used &quot;sparkasse.de&quot;), in my case banking sites should be spliced.
</I>&gt;<i> 
</I>&gt;<i> Its working fine when i use IP&#180;s for the acl&#180;s or insert the hostname in the
</I>&gt;<i> /etc/hosts,
</I>&gt;<i> but I think both cant be the solution.
</I>&gt;<i> 
</I>&gt;<i> I think the issues exist because the reverse lookup dont got the anwser
</I>&gt;<i> &quot;sparkasse.de&quot;, but why it does not use the hostname from the dns request to
</I>&gt;<i> the dns-server ?
</I>
Because Squid is not a DNS server.

The HTTP message details including URL where dstdomain comes from are
encrypted at the time you are trying to use the dstdomain ACL.

Please upgrade to the latest 3.5 release (today that is 3.5.6) and use
the &quot;ssl::server_name&quot; ACL instead of dstdomain for ssl_bump access
controls. It grabs the domain name (if any) from TLS directly without
needing decryption first.

&gt;<i> 
</I>&gt;<i> Also got errors that the ssl accept failed.
</I>&gt;<i> 
</I>&gt;<i> Below you could see my squid.conf and the entries from the cache.log for
</I>&gt;<i> both cases.
</I>&gt;<i> 
</I>&gt;<i> *Without hostname in etc/hosts*
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> *With hostname in etc/hosts*
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> *SSL accept log entries*
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> *Squid.conf*
</I>&gt;<i> 
</I>
Please be aware when using Nabble interface that fancy embeded
quotations are not sent to the mailing list. Only the plain message text.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004407.html">[squid-users] transparent proxy splice using dstdomain issue
</A></li>
	<LI>Next message (by thread): <A HREF="004415.html">[squid-users] transparent proxy splice using dstdomain issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4408">[ date ]</a>
              <a href="thread.html#4408">[ thread ]</a>
              <a href="subject.html#4408">[ subject ]</a>
              <a href="author.html#4408">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
