<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Question about squid-3.5-13849.patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20about%20squid-3.5-13849.patch&In-Reply-To=%3C559D34B2.5010408%40ufscar.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004412.html">
   <LINK REL="Next"  HREF="004431.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Question about squid-3.5-13849.patch</H1>
    <B>Paulo Matias</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20about%20squid-3.5-13849.patch&In-Reply-To=%3C559D34B2.5010408%40ufscar.br%3E"
       TITLE="[squid-users] Question about squid-3.5-13849.patch">matias at ufscar.br
       </A><BR>
    <I>Wed Jul  8 14:33:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004412.html">[squid-users] Question about squid-3.5-13849.patch
</A></li>
        <LI>Next message (by thread): <A HREF="004431.html">[squid-users] Question about squid-3.5-13849.patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4430">[ date ]</a>
              <a href="thread.html#4430">[ thread ]</a>
              <a href="subject.html#4430">[ subject ]</a>
              <a href="author.html#4430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On 07-07-2015 11:05, Amos Jeffries wrote:
&gt;<i> On 8/07/2015 1:37 a.m., dweimer wrote:
</I>&gt;&gt;<i> System is Running on FreeBSD 10.1-RELEASE-p14, using OpenSSL included in
</I>&gt;&gt;<i> base FreeBSD.
</I>&gt;<i> 
</I>&gt;<i> No, the change is automatic for all Squid built against an OpenSSL
</I>&gt;<i> library that supports the library API option. If it is not working, then
</I>&gt;<i> the library you are using probably does not support that option.
</I>&gt;<i> 
</I>&gt;<i> AFAIK you need at least OpenSSL 0.9.8m for anything related to that
</I>&gt;<i> vulnerability to be fixable. The latest 1.x libraries do not support the
</I>&gt;<i> flag we use because they do the rejection internally without needing any
</I>&gt;<i> help from Squid.
</I>
Unfortunately this seems not to be the case. I have installed
FreeBSD 10.1-RELEASE-p14 in a VM for testing. Running &quot;openssl version&quot;
reports &quot;OpenSSL 1.0.1l-freebsd 15 Jan 2015&quot;. I was able to reproduce
Dean's issue (renegotiation does not get disabled), but I was not able
to fix it so far.

For OpenSSL version comparison purposes, Debian wheezy (which the patch
was able to harden) ships 1.0.1e. Debian jessie (which was already hardened
out-of-the-box, without the patch) ships 1.0.1k. It is strange that FreeBSD's
more recent OpenSSL version (1.0.1l) presents the issue.

The SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS define exists in FreeBSD OpenSSL headers,
the relevant code gets compiled in squid executable, SSL_CTX_set_info_callback
runs, but *the ssl_info_cb callback is never called* (I tested by inserting
a debug message inside the &quot;#if defined&quot;, just after SSL_CTX_set_info_callback,
and another one at the beginning of the callback).

Maybe we could try to adapt nginx's solution, but it does not seem to be
trivial to do that in the current codebase
<A HREF="https://github.com/nginx/nginx/commit/70bd187c4c386d82d6e4d180e0db84f361d1be02">https://github.com/nginx/nginx/commit/70bd187c4c386d82d6e4d180e0db84f361d1be02</A>


Best regards,
Paulo Matias

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004412.html">[squid-users] Question about squid-3.5-13849.patch
</A></li>
	<LI>Next message (by thread): <A HREF="004431.html">[squid-users] Question about squid-3.5-13849.patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4430">[ date ]</a>
              <a href="thread.html#4430">[ thread ]</a>
              <a href="subject.html#4430">[ subject ]</a>
              <a href="author.html#4430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
