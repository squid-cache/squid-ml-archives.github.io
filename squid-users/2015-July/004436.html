<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Issue with Citrix sessions and squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Issue%20with%20Citrix%20sessions%20and%20squid&In-Reply-To=%3C559D958D.9050708%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004435.html">
   <LINK REL="Next"  HREF="004449.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Issue with Citrix sessions and squid</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Issue%20with%20Citrix%20sessions%20and%20squid&In-Reply-To=%3C559D958D.9050708%40treenet.co.nz%3E"
       TITLE="[squid-users] Issue with Citrix sessions and squid">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jul  8 21:26:37 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004435.html">[squid-users] Issue with Citrix sessions and squid
</A></li>
        <LI>Next message (by thread): <A HREF="004449.html">[squid-users] Issue with Citrix sessions and squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4436">[ date ]</a>
              <a href="thread.html#4436">[ thread ]</a>
              <a href="subject.html#4436">[ subject ]</a>
              <a href="author.html#4436">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/07/2015 7:01 a.m., David Touzeau wrote:
&gt;<i> Thanks Yuri,
</I>&gt;<i> 
</I>&gt;<i> Any tips how to increase TCP/IP stack ?
</I>&gt;<i> Did you means TCP/IP stack on the Citrix Server side or on the squid
</I>&gt;<i> box  or both ?
</I>
I'm thinking its a problem related to TCP sockets.
A rough estimate calculatino of:
 10 users x10 tabs x20 avg domains per page x 2 for happy eyeballs
makes it somewhere up to 4k sockets in active use at any time. if the
users are accessing domains with larger numbers ofdomains per page (ie
Facebook has up to 100) that could be 20k concurrent sockets just from
the browser.
 By the time that goes through Squid it becomes 40k, and if you have
ICAP it becomes &quot;up to 80K&quot; (out of an available 64k sockets).

Then there is all the OS background services that use HTTP through the
proxy, etc.

Without Citrix the users internal src-IPs vary. Making available a 64k
sockets per-user. Which is harder to reach, and the browser silently
limits itself when socekts start to run out.

Without Squid the Citrix connections are going to N different domains
with varying dst-IP. Which again raises the available port numbers per-user.


If the assumptino behind the above is right you should be able to
alleviate the problem by having Squid listen on multiple ports and/or
IPs. Then spreading the client connections out across those Squid ports.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004435.html">[squid-users] Issue with Citrix sessions and squid
</A></li>
	<LI>Next message (by thread): <A HREF="004449.html">[squid-users] Issue with Citrix sessions and squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4436">[ date ]</a>
              <a href="thread.html#4436">[ thread ]</a>
              <a href="subject.html#4436">[ subject ]</a>
              <a href="author.html#4436">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
