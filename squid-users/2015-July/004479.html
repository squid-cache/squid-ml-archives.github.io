<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Transparent Squid Proxy Server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20Squid%20Proxy%20Server&In-Reply-To=%3CCAGUJm7b3YsSefZBPkEVRPOKXT3U4Ht0fpE4GLM5fdvKmFioEsw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004478.html">
   <LINK REL="Next"  HREF="004482.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Transparent Squid Proxy Server</H1>
    <B>Nathan Hoad</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20Squid%20Proxy%20Server&In-Reply-To=%3CCAGUJm7b3YsSefZBPkEVRPOKXT3U4Ht0fpE4GLM5fdvKmFioEsw%40mail.gmail.com%3E"
       TITLE="[squid-users] Transparent Squid Proxy Server">nathan at getoffmalawn.com
       </A><BR>
    <I>Sun Jul 12 01:02:35 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004478.html">[squid-users] IMPORTANT: mailing list changes
</A></li>
        <LI>Next message (by thread): <A HREF="004482.html">[squid-users] issue with multiple outgoing addresses for same	source address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4479">[ date ]</a>
              <a href="thread.html#4479">[ thread ]</a>
              <a href="subject.html#4479">[ subject ]</a>
              <a href="author.html#4479">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using 3.5 with transparent server first bumping in ~100 deployments so
far, it works just fine, excluding with SNI and everything.
On 12/07/2015 10:58 am, &quot;Yuri Voinov&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; wrote:

&gt;<i>  Man,
</I>&gt;<i>
</I>&gt;<i> 3.5.x don't work with server-first. It must be for backward compatibility
</I>&gt;<i> - but don't be.
</I>&gt;<i>
</I>&gt;<i> Also, AFAIK, 3.5.x series don't work with transparent NAT interception in
</I>&gt;<i> bump mode. Fake certs are generated, but with IP against hostnames (in all
</I>&gt;<i> my test installations).
</I>&gt;<i>
</I>&gt;<i> So, if you strictly need working bump with transparent interception,
</I>&gt;<i> rollback to 3.4.
</I>&gt;<i>
</I>&gt;<i> WBR, Yuri.
</I>&gt;<i>
</I>&gt;<i> 24.06.15 12:04, Reet Vyas &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i>
</I>&gt;<i>  Hi
</I>&gt;<i>   Below is my squid file , I have configured squid 3.5.3 with ssl, but I
</I>&gt;<i> cant filter https traffic and also in access log I cant see https in access
</I>&gt;<i> logs.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i> # Recommended minimum configuration:
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # Example rule allowing access from your local networks.
</I>&gt;<i> # Adapt to list your (internal) IP networks from where browsing
</I>&gt;<i> # should be allowed
</I>&gt;<i> acl localnet src 116.72.152.37 192.168.0.0/24 # Sesuaikan dengan ip
</I>&gt;<i> client/local
</I>&gt;<i>
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80  # http
</I>&gt;<i> acl Safe_ports port 21  # ftp
</I>&gt;<i> acl Safe_ports port 443  # https
</I>&gt;<i> acl Safe_ports port 70  # gopher
</I>&gt;<i> acl Safe_ports port 210  # wais
</I>&gt;<i> acl Safe_ports port 1025-65535 # unregistered ports
</I>&gt;<i> acl Safe_ports port 280  # http-mgmt
</I>&gt;<i> acl Safe_ports port 488  # gss-http
</I>&gt;<i> acl Safe_ports port 591  # filemaker
</I>&gt;<i> acl Safe_ports port 777  # multiling http
</I>&gt;<i> # storeid *test*
</I>&gt;<i> acl urlrewrite dstdomain .fbcdn.net .akamaihd.net
</I>&gt;<i> acl speedtest url_regex -i speedtest\/.*\.(jpg|txt)\?.*
</I>&gt;<i> acl reverbnation url_regex -i reverbnation.*audio_player.*ec_stream_song.*$
</I>&gt;<i> acl utmgif url_regex -i utm.gif.*
</I>&gt;<i> acl playstoreandroid url_regex -i
</I>&gt;<i> c.android.clients.google.com.market.GetBinary.GetBinary.*
</I>&gt;<i> acl idyoutube url_regex -i
</I>&gt;<i> youtube.*(ptracking|stream_204|player_204).*(v\=|docid\=|video_id\=).*$
</I>&gt;<i> acl videoyoutube url_regex -i (youtube|googlevideo).*videoplayback\?
</I>&gt;<i> acl videoyoutube url_regex -i (youtube|googlevideo).*videoplayback\?
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> acl getmethod method GET
</I>&gt;<i> acl loop_302 http_status 302
</I>&gt;<i> acl step1 at_step SslBump1
</I>&gt;<i> acl youtube dstdomain .youtube.com
</I>&gt;<i> acl blocksites dstdomain &quot;/etc/squid/restricted-sites.squid&quot;
</I>&gt;<i> # TAG: QUERY
</I>&gt;<i> #
</I>&gt;<i> -----------------------------------------------------------------------------
</I>&gt;<i> acl QUERY urlpath_regex -i
</I>&gt;<i> (hackshield|blank.html|infinity.js|hshield.da|renew_session_token.php|recaptcha.js|dat.asp|notice.swf|patchlist.txt|hackshield|captcha|reset.css|update.ver|notice.html|updates.txt|gamenotice|images.kom|patchinfo.xml|noupdate.ui|\.Xtp|\.htc|\.txt)
</I>&gt;<i> acl QUERY urlpath_regex -i
</I>&gt;<i> (patch.conf|uiimageset.xml.iop|gashaponwnd.xml.iop|loading.swf|download.swf|version.list|version.ini|launch.jnlp|server_patch.cfg.iop|core.swf|Loading.swf|resouececheck.sq|mainloading.swf|config.xml|gemmaze.swf|xml.png|size.xml|resourcesbar.swf|version.xml|version.list|delete.ini)
</I>&gt;<i> acl QUERY urlpath_regex -i \.(jsp|asp|aspx|cfg|iop|zip|php|xml|html)(\?|$)
</I>&gt;<i> cache deny QUERY
</I>&gt;<i> cache deny youtube
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i> acl dontstore url_regex ^http:\/\/((
</I>&gt;<i> [\d\w-]*(\.[^\.\-]*?\..*?))(\/\mosalsal\/[\d]{4}\/.*\/)(.*\.flv))\?start.*
</I>&gt;<i> acl dontstore url_regex redbot\.org \.php
</I>&gt;<i> acl dontstore url_regex -i ^http:\/\/.*gemscool\.com\/.*
</I>&gt;<i> acl dontstore url_regex \.(aspx|php)\?
</I>&gt;<i> acl dontstore url_regex goldprice\.org\/NewCharts\/gold\/images\/.*\.png
</I>&gt;<i> acl dontstore url_regex google\.co(m|\.[a-z]{2})\/complete\/search\?
</I>&gt;<i> acl dontstore url_regex
</I>&gt;<i> redirector\.([0-9.]{4}|.*\.youtube\.com|.*\.googlevideo\.com|.*\.video\.google\.com)\/(get_video\?|videodownload\?|videoplayback.*id|get_video_info\?|ptracking\?|player_204\?|stream_204\?).*
</I>&gt;<i>
</I>&gt;<i> acl store_yt_id url_regex -i
</I>&gt;<i> youtube.*(ptracking|stream_204|playback|player_204|watchtime|set_awesome|s\?|ads).*(video_id|docid|\&amp;v|content_v)\=([^\&amp;\s]*).*$
</I>&gt;<i> acl store_id_list_yt url_regex -i (youtube|googlevideo).*videoplayback.*$
</I>&gt;<i> acl store_id_list_yt url_regex
</I>&gt;<i> ^https?\:\/\/([0-9.]{4}|.*\.youtube\.com|.*\.googlevideo\.com|.*\.video\.google\.com)\/(get_video\?|videodownload\?|videoplayback.*id).*
</I>&gt;<i>
</I>&gt;<i> acl store-id_list urlpath_regex -i dl\.sourceforge\.net
</I>&gt;<i> acl store-id_list urlpath_regex -i \.ytimg\.com
</I>&gt;<i> acl store-id_list urlpath_regex -i \.(akamaihd|fbcdn)\.net
</I>&gt;<i> acl store_id_list urlpath_regex -i
</I>&gt;<i> [a-zA-Z]{2}[0-9]*\.4shared\.com\/download\/
</I>&gt;<i>
</I>&gt;<i> acl store_id_list_url url_regex ^http:\/\/
</I>&gt;<i> [0-9]\.bp\.blogspot\.com.*\.(jpeg|jpg|png|gif|ico)
</I>&gt;<i> acl store_id_list_url url_regex
</I>&gt;<i> ^http[s]?:\/\/.*\.twimg\.com\/(.*)\.(gif|jpeg|jpg|png|js|css)
</I>&gt;<i> acl store_id_list_url url_regex
</I>&gt;<i> ^http[s]?:\/\/(media|static)\.licdn\.com\/.*\.(png|jpg|gif|woff)
</I>&gt;<i> acl store_id_list_url url_regex ^https:\/\/fb(static|cdn)\-.*\-
</I>&gt;<i> a.akamaihd.net\/(.*)\.(gif|jpeg|jpg|png|js|css|mp4)
</I>&gt;<i> acl store_id_list_url url_regex ^http:\/\/.*\.ak\.fbcdn\.net\/.*\.(gif
</I>&gt;<i> |jpg|png|js|mp4)
</I>&gt;<i>
</I>&gt;<i> # pass requests
</I>&gt;<i> url_rewrite_program /etc/squid/phpredir.php
</I>&gt;<i> url_rewrite_access allow youtube
</I>&gt;<i>
</I>&gt;<i> request_header_access Range deny store_id_list_yt
</I>&gt;<i> range_offset_limit 10 KB store_id_list_yt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # Recommended minimum Access Permission configuration:
</I>&gt;<i> #
</I>&gt;<i> # Deny requests to certain unsafe ports
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access deny blocksites
</I>&gt;<i> http_access allow localhost manager
</I>&gt;<i> http_access deny manager
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> http_access deny all
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # squid ssl_bump option
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> always_direct allow all
</I>&gt;<i> ssl_bump server-first all
</I>&gt;<i> sslproxy_cert_error deny all
</I>&gt;<i> sslproxy_flags DONT_VERIFY_PEER
</I>&gt;<i> sslcrtd_program /usr/lib/squid/ssl_crtd -s /var/lib/squid/ssl_db -M 4MB
</I>&gt;<i> sslcrtd_children 8 startup=1 idle=1
</I>&gt;<i> #ssl_bump peek step1
</I>&gt;<i> #ssl_bump bump all
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # Squid normally listens to port 3128
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> https_port 3130 intercept ssl-bump generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=4MB cert=/etc/squid/ssl_certs/squid.crt
</I>&gt;<i> key=/etc/squid/ssl_certs/squid.key
</I>&gt;<i> http_port 3129 intercept
</I>&gt;<i> http_port 3128
</I>&gt;<i>
</I>&gt;<i> # TAG: Store-id Program
</I>&gt;<i> #
</I>&gt;<i> -----------------------------------------------------------------------------
</I>&gt;<i> store_id_program /usr/bin/perl /etc/squid/store-id.pl
</I>&gt;<i> store_id_children 100 startup=0 idle=1 concurrency=1000
</I>&gt;<i>
</I>&gt;<i> # TAG: Store-id Access
</I>&gt;<i> #
</I>&gt;<i> -----------------------------------------------------------------------------
</I>&gt;<i> store_id_access allow urlrewrite
</I>&gt;<i> store_id_access allow speedtest
</I>&gt;<i> store_id_access allow reverbnation
</I>&gt;<i> store_id_access allow utmgif
</I>&gt;<i> store_id_access allow playstoreandroid
</I>&gt;<i> store_id_access allow idyoutube
</I>&gt;<i> store_id_access allow videoyoutube
</I>&gt;<i> store_id_access deny dontstore
</I>&gt;<i> store_id_access deny !getmethod
</I>&gt;<i> store_id_access allow store_id_list_yt
</I>&gt;<i> store_id_access allow store_yt_id
</I>&gt;<i> store_id_access allow store-id_list
</I>&gt;<i> store_id_access deny all
</I>&gt;<i> store_id_bypass on
</I>&gt;<i>
</I>&gt;<i> # TAG: Youtube 302
</I>&gt;<i> #
</I>&gt;<i> -----------------------------------------------------------------------------
</I>&gt;<i> store_miss deny store_id_list_yt loop_302
</I>&gt;<i> send_hit deny store_id_list_yt loop_302
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## MEMORY CACHE OPTIONS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> client_dst_passthru on
</I>&gt;<i> cache_mem 1024 MB
</I>&gt;<i> maximum_object_size_in_memory 1024 KB
</I>&gt;<i> memory_cache_shared off
</I>&gt;<i> memory_cache_mode disk
</I>&gt;<i> memory_replacement_policy heap GDSF
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## DISK CACHE OPTIONS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> cache_replacement_policy heap LFUDA
</I>&gt;<i> minimum_object_size 1 bytes
</I>&gt;<i> maximum_object_size 10 GB
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # Uncomment and adjust the following to add a disk cache directory.
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> cache_dir aufs /usr/local/cache_proxy 25000 16 256 # sesuaikan dengan
</I>&gt;<i> drive penyimpanan cache
</I>&gt;<i> store_dir_select_algorithm round-robin
</I>&gt;<i> cache_swap_low 90
</I>&gt;<i> cache_swap_high 95
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # Leave coredumps in the first cache dir
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> coredump_dir /var/spool/squid
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## LOGFILE OPTIONS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> #access_log daemon:/tmp/access.log !log
</I>&gt;<i> #logfile_daemon /usr/lib/squid/log_file_daemon
</I>&gt;<i> cache_store_log none
</I>&gt;<i> logfile_rotate 1
</I>&gt;<i> mime_table /etc/squid/mime.conf
</I>&gt;<i> pid_filename /var/run/squid.pid
</I>&gt;<i> strip_query_terms off
</I>&gt;<i> buffered_logs off
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## OPTIONS FOR TROUBLESHOOTING
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> #cache_log /tmp/cache.log
</I>&gt;<i> cache_log /dev/null
</I>&gt;<i> #debug_options ALL,1 22,3
</I>&gt;<i> coredump_dir /var/spool/squid
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## OPTIONS FOR TUNING THE CACHE
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> max_stale 1 years
</I>&gt;<i> vary_ignore_expire on
</I>&gt;<i> shutdown_lifetime 10 seconds
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> # Add any of your own refresh_pattern entries above these.
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> refresh_pattern ^ftp:  1440 20% 10080
</I>&gt;<i> refresh_pattern ^gopher: 1440 0% 1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?) 0 0% 0
</I>&gt;<i> # Youtube Video
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> (get_video\?|videoplayback\?|videodownload\?|\.mp4|\.webm|\.flv|((audio|video)\/(webm|mp4)))
</I>&gt;<i> 241920 100% 241920 override-expire ignore-reload ignore-private
</I>&gt;<i> ignore-no-store ignore-must-revalidate reload-into-ims ignore-auth
</I>&gt;<i> store-stale
</I>&gt;<i> refresh_pattern -i ^https?\:\/\/.*\.googlevideo\.com\/videoplayback.*
</I>&gt;<i> 10080 99% 43200 override-lastmod override-expire ignore-reload
</I>&gt;<i> reload-into-ims ignore-private reload-into-ims ignore-auth store-stale
</I>&gt;<i> refresh_pattern -i ^https?\:\/\/.*\.googlevideo\.com\/videoplayback.*$
</I>&gt;<i> 241920 100% 241920 override-expire ignore-reload ignore-private
</I>&gt;<i> ignore-no-store ignore-must-revalidate reload-into-ims ignore-auth
</I>&gt;<i> store-stale
</I>&gt;<i>
</I>&gt;<i> refresh_pattern (akamaihd|fbcdn)\.net 14400 99% 518400  ignore-no-store
</I>&gt;<i> ignore-private ignore-reload ignore-must-revalidate store-stale
</I>&gt;<i> refresh_pattern -i squid\.internal 14400 99% 518400  ignore-no-store
</I>&gt;<i> ignore-private ignore-reload ignore-must-revalidate store-stale
</I>&gt;<i> refresh_pattern \.(jpg|png|gif|css|ico)($|\?) 14400 99% 518400
</I>&gt;<i> ignore-no-store ignore-private reload-into-ims ignore-must-revalidate
</I>&gt;<i> store-stale
</I>&gt;<i> refresh_pattern . 0 99% 518400  ignore-no-store ignore-private
</I>&gt;<i> reload-into-ims store-stale
</I>&gt;<i> # Image Youtube
</I>&gt;<i> refresh_pattern -i (yimg|twimg)\.com\.*         1440 100% 129600
</I>&gt;<i> override-expire ignore-reload reload-into-ims
</I>&gt;<i> refresh_pattern -i (ytimg|ggpht)\.com\.*        1440 80% 129600
</I>&gt;<i> override-expire override-lastmod ignore-auth ignore-reload reload-into-ims
</I>&gt;<i>
</I>&gt;<i> #images facebook
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> fbcdn.*net\/.*\.((jp(e?g|e|2)|gif|pn[pg]|bm?|tiff?|ico|swf|css|js)|(jp(e?g|e|2)|gif|pn[pg]|bm?|tiff?|ico|swf|css|js)(\?|.*$))
</I>&gt;<i> 241920 99% 241920 ignore-no-store ignore-private override-expire
</I>&gt;<i> override-lastmod reload-into-ims ignore-auth
</I>&gt;<i> refresh_pattern -i pixel\.facebook\.com.*\.(jpg|png|gif|ico|css|js) 241920
</I>&gt;<i> 80% 241920 override-expire ignore-reload reload-into-ims ignore-auth
</I>&gt;<i> refresh_pattern -i \.akamaihd\.net.*\.(jpg|png|gif|ico|css|js) 241920 80%
</I>&gt;<i> 241920 override-expire ignore-reload reload-into-ims ignore-auth
</I>&gt;<i> refresh_pattern -i ((facebook.com)|(85.131.151.39))\.(jpg|png|gif) 241920
</I>&gt;<i> 99% 241920 ignore-reload override-expire ignore-no-store store-stale
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> fbcdn\.net\/.*\.((jp(e?g|e|2)|gif|pn[pg]|bm?|tiff?|ico|swf|css|js)|(jp(e?g|e|2)|gif|pn[pg]|bm?|tiff?|ico|swf|css|js)(\?|.*$))
</I>&gt;<i> 241920 99% 241920 ignore-no-store ignore-private override-expire
</I>&gt;<i> override-lastmod reload-into-ims ignore-auth
</I>&gt;<i> refresh_pattern static\.(xx|ak)\.fbcdn\.net*\.(jpg|gif|png) 241920 99%
</I>&gt;<i> 241920 ignore-reload override-expire ignore-no-store
</I>&gt;<i> refresh_pattern ^https?\:\/\/profile\.ak\.fbcdn.net*\.(jpg|gif|png)
</I>&gt;<i> 241920 99% 241920 ignore-reload override-expire ignore-no-store
</I>&gt;<i>
</I>&gt;<i> # Video Facebook
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.video.ak.fbcdn.net.*\.(mp4|flv|mp3|amf)                    10080 80%
</I>&gt;<i> 43200 override-expire ignore-reload reload-into-ims ignore-private
</I>&gt;<i> ignore-no-store ignore-must-revalidate
</I>&gt;<i> refresh_pattern (audio|video)\/(webm|mp4) 129600 99% 129600 ignore-reload
</I>&gt;<i> override-expire override-lastmod ignore-must-revalidate  ignore-private
</I>&gt;<i> ignore-no-store ignore-auth store-stale
</I>&gt;<i> refresh_pattern -i ^<A HREF="http://.*squid\.internal.*">http://.*squid\.internal.*</A>  241920 100% 241920
</I>&gt;<i> override-lastmod override-expire ignore-reload ignore-must-revalidate
</I>&gt;<i> ignore-private ignore-no-store ignore-auth store-stale
</I>&gt;<i>
</I>&gt;<i> # All File
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.(3gp|7z|ace|asx|bin|deb|divx|dvr-ms|ram|rpm|exe|inc|cab|qt) 10080 80%
</I>&gt;<i> 10080 override-expire override-lastmod reload-into-ims
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.(rar|jar|gz|tgz|bz2|iso|m1v|m2(v|p)|mo(d|v)|arj|lha|lzh|zip|tar|iop|nzp|pak|mar|msp)
</I>&gt;<i> 10080 80% 10080 override-expire override-lastmod reload-into-ims
</I>&gt;<i> ignore-reload
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.(jp(e?g|e|2)|gif|pn[pg]|bm?|tiff?|ico|swf|dat|ad|txt|dll) 10080 80% 10080
</I>&gt;<i> override-expire override-lastmod reload-into-ims
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.(avi|ac4|mp(e?g|a|e|1|2|3|4)|mk(a|v)|ms(i|u|p)|og(x|v|a|g)|rm|r(a|p)m|snd|vob|webm)
</I>&gt;<i> 10080 80% 10080 override-expire override-lastmod reload-into-ims
</I>&gt;<i> refresh_pattern -i
</I>&gt;<i> \.(pp(t?x)|s|t)|pdf|rtf|wax|wm(a|v)|wmx|wpl|cb(r|z|t)|xl(s?x)|do(c?x)|flv|x-flv)
</I>&gt;<i> 10080 80% 10080 override-expire override-lastmod reload-into-ims
</I>&gt;<i> refresh_pattern .  0 20% 4320
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## ADMINISTRATIVE PARAMETERS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">reetika at foxymoron.org</A>
</I>&gt;<i> cache_effective_user proxy
</I>&gt;<i> cache_effective_group proxy
</I>&gt;<i> visible_hostname foxysquid.foxymoron.tv
</I>&gt;<i> unique_hostname foxysquid.foxymoron.tv
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## PERSISTENT CONNECTION HANDLING
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> detect_broken_pconn on
</I>&gt;<i> client_persistent_connections off
</I>&gt;<i> server_persistent_connections on
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## ERROR PAGE OPTIONS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> error_directory /usr/share/squid/errors/en
</I>&gt;<i> error_log_languages off
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## DNS OPTIONS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> check_hostnames off
</I>&gt;<i> hosts_file /etc/hosts
</I>&gt;<i> connect_retries 2
</I>&gt;<i> ipcache_low 90
</I>&gt;<i> ipcache_high 95
</I>&gt;<i> ipcache_size 84024                        # 2x Besar RAM
</I>&gt;<i> fqdncache_size 64024                        # real RAM Hardware
</I>&gt;<i> pipeline_prefetch 100
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> ## MISCELLANEOUS
</I>&gt;<i>
</I>&gt;<i> ###############################################################################
</I>&gt;<i> memory_pools off
</I>&gt;<i> reload_into_ims on
</I>&gt;<i> uri_whitespace strip
</I>&gt;<i> max_filedescriptors 65536
</I>&gt;<i>
</I>&gt;<i>  IPtable rules :
</I>&gt;<i>
</I>&gt;<i> ................................................
</I>&gt;<i>
</I>&gt;<i>  My IPtables Rules
</I>&gt;<i>
</I>&gt;<i> Chain PREROUTING (policy ACCEPT 27405 packets, 1872K bytes)
</I>&gt;<i>  pkts bytes target     prot opt in     out     source
</I>&gt;<i> destination
</I>&gt;<i> 76873 4457K DNAT       tcp  --  eth1   *       0.0.0.0/0
</I>&gt;<i> 0.0.0.0/0            tcp dpt:80 to:192.168.0.200:3129
</I>&gt;<i>    26  1184 REDIRECT   tcp  --  eth0   *       0.0.0.0/0
</I>&gt;<i> 0.0.0.0/0            tcp dpt:80 redir ports 3129
</I>&gt;<i>     0     0 DNAT       tcp  --  eth0   *       0.0.0.0/0
</I>&gt;<i> 0.0.0.0/0            tcp dpt:443 to:192.168.0.200:3130
</I>&gt;<i>
</I>&gt;<i> Chain INPUT (policy ACCEPT 9321 packets, 543K bytes)
</I>&gt;<i>  pkts bytes target     prot opt in     out     source
</I>&gt;<i> destination
</I>&gt;<i>
</I>&gt;<i> Chain OUTPUT (policy ACCEPT 1426 packets, 85560 bytes)
</I>&gt;<i>  pkts bytes target     prot opt in     out     source
</I>&gt;<i> destination
</I>&gt;<i>
</I>&gt;<i> Chain POSTROUTING (policy ACCEPT 1426 packets, 85560 bytes)
</I>&gt;<i>  pkts bytes target     prot opt in     out     source
</I>&gt;<i> destination
</I>&gt;<i> 81432   14M MASQUERADE  all  --  *      eth0    192.168.0.0/24
</I>&gt;<i> 0.0.0.0/0
</I>&gt;<i>
</I>&gt;<i> On Fri, Jun 5, 2015 at 1:43 PM, Reet Vyas &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">reet.vyas28 at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>  Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Thanks for reply. I am trying to cache youtube using this wiki
</I>&gt;&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/DynamicContent/YouTube">http://wiki.squid-cache.org/ConfigExamples/DynamicContent/YouTube</A> but I
</I>&gt;&gt;<i> cant cache youtube.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  I want to cache facebook and youtube. SSl certificate installation that
</I>&gt;&gt;<i> I have to do . Please suggest some links.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Thu, Jun 4, 2015 at 6:48 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 5/06/2015 12:55 a.m., Reet Vyas wrote:
</I>&gt;&gt;&gt;<i> &gt; Thank you everyone for helping me to setup squid , Now its working but
</I>&gt;&gt;&gt;<i> in
</I>&gt;&gt;&gt;<i> &gt; access.logs  I only see tcp_miss if m using same website. I mean squid
</I>&gt;&gt;&gt;<i> is
</I>&gt;&gt;&gt;<i> &gt; not caching
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You will get MISS a fair bit more with intercepted traffic than with
</I>&gt;&gt;&gt;<i> normal proxied traffic. Particularly on certain major CDN who play
</I>&gt;&gt;&gt;<i> tricks with DNS.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The reasons and some workarounds to need to be doing are explained in
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://wiki.squid-cache.org/KnowledgeBase/HostHeaderForgery">http://wiki.squid-cache.org/KnowledgeBase/HostHeaderForgery</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Amos
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing <A HREF="https://lists.squid-cache.org/listinfo/squid-users">listsquid-users at lists.squid-cache.orghttp</A>://lists.squid-cache.org/listinfo/squid-users
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150712/7ff761e0/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150712/7ff761e0/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004478.html">[squid-users] IMPORTANT: mailing list changes
</A></li>
	<LI>Next message (by thread): <A HREF="004482.html">[squid-users] issue with multiple outgoing addresses for same	source address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4479">[ date ]</a>
              <a href="thread.html#4479">[ thread ]</a>
              <a href="subject.html#4479">[ subject ]</a>
              <a href="author.html#4479">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
