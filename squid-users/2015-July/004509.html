<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] accessing google.com
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20accessing%20google.com&In-Reply-To=%3C989593634.6519.1436862867634.JavaMail.zimbra%40megatel.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004490.html">
   <LINK REL="Next"  HREF="004464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] accessing google.com</H1>
    <B>Philipp Wehling</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20accessing%20google.com&In-Reply-To=%3C989593634.6519.1436862867634.JavaMail.zimbra%40megatel.de%3E"
       TITLE="[squid-users] accessing google.com">philipp.wehling at megatel.de
       </A><BR>
    <I>Tue Jul 14 08:34:27 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004490.html">[squid-users] accessing google.com
</A></li>
        <LI>Next message (by thread): <A HREF="004464.html">[squid-users] TAG_NONE/xxxx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4509">[ date ]</a>
              <a href="thread.html#4509">[ thread ]</a>
              <a href="subject.html#4509">[ subject ]</a>
              <a href="author.html#4509">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

&gt;<i> Nothing that woudl be helpful Im afraid. Cleaning it up and writing a how-to blog has been on my todo list for years now :-(
</I>
Thats too bad. This really would be helpful.

&gt;<i> The debugs output should show you the squid.conf line its processing, then the 0/1/-1 (aka fail, pass, async-delay) results of each individual test run for that line. Then the line result action 0/1/-1 (aka allow, deny, dunno/skip)
</I>
I dont see any line number in cache.log - even with 28,9

&gt;<i> The debugs trace will result in a deny action in one of the access control lines. Which then logs something like &quot;Request for ... DENIED due to ...&quot;.
</I>
I dont see any of this lines either. Same with 28,9. An I forced a ACL-Block.

&gt;<i> There are other things forbidden by the protocol, or errors that can happen which Squid just responds with a DENIED page to. No ACL processing required for that to happen.
</I>
This is the way im trying to find out what is causing the problems and pin down the failure.


Im using squid 3.1.22-1 on CentOS 5 - if this is important.



kind regards,
pwe

----- Urspr&#252;ngliche Mail -----
Von: &quot;Amos Jeffries&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
An: &quot;Philipp Wehling&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">philipp.wehling at megatel.de</A>&gt;
CC: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Gesendet: Montag, 13. Juli 2015 13:14:25
Betreff: Re: [squid-users] accessing google.com

On 13/07/2015 10:39 p.m., Philipp Wehling wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> thank you for your answer.
</I>&gt;<i> 
</I>&gt;&gt;<i> This is where you really do need to understand the 28,3 debug output.
</I>&gt;<i> 
</I>&gt;<i> I thought squid works in a &quot;first-match&quot;-manner... Do you have any documentation, I can read about?
</I>
Nothing that woudl be helpful Im afraid. Cleaning it up and writing a
how-to blog has been on my todo list for years now :-(

Its currently a matter of following the trace and eyeballing what it
says its doing vs what your squid.conf contains.

The debugs output should show you the squid.conf line its processing,
then the 0/1/-1 (aka fail, pass, async-delay) results of each individual
test run for that line.
Then the line result action 0/1/-1 (aka allow, deny, dunno/skip)


&gt;<i> 
</I>&gt;&gt;<i> That is of course following your assumption that Squid is actively rejecting the traffic with ACLs (you provide no evidence of that).
</I>&gt;<i> 
</I>&gt;<i> How can I proof that? When the error comes up, I get the default ACL-Block-Page.
</I>
The debugs trace will result in a deny action in one of the access
control lines. Which then logs something like &quot;Request for ... DENIED
due to ...&quot;.

There are other things forbidden by the protocol, or errors that can
happen which Squid just responds with a DENIED page to. No ACL
processing required for that to happen.

&gt;<i> 
</I>&gt;&gt;<i> Chances are rather high these days that it has nothing to do with Squid since Google prefer to use HTTPS, QUIC, SPDY, or HTTP/2 protocols. All of which normally bypass Squid processing entirely.
</I>&gt;<i> 
</I>&gt;<i> That answer is interesting, because we have some company (blocking) policies regarding drive.google.com and everything works fine. How is it possible, that google.com bypasses these rules? Please give me more hints for my investigation.
</I>&gt;<i> 
</I>
They hard-code the Chrome web browser and other apps or scripts they
produce to try the other protocols first when connnecting to their own
servers. HTTP messages coming out of their servers also contain headers
such as Alternative-Protocol or Alt-Svc requesting the cleint software
uses non-HTTP protocols.

The latest release of Squid automatically strip the HTTP headers away on
related responses. You still have to also firewall block ports UDP/443
and UDP/80 to avoid QUICK protocol. Only HTTPS decryption will prevent
HTTP/2, SPDY, and WebSockets usage since they are either inside TLS or
CONNECT tunnels.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004490.html">[squid-users] accessing google.com
</A></li>
	<LI>Next message (by thread): <A HREF="004464.html">[squid-users] TAG_NONE/xxxx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4509">[ date ]</a>
              <a href="thread.html#4509">[ thread ]</a>
              <a href="subject.html#4509">[ subject ]</a>
              <a href="author.html#4509">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
