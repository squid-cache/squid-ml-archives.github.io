<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] AUFS vs. DISKS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20AUFS%20vs.%20DISKS&In-Reply-To=%3C55A65F89.9040104%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004548.html">
   <LINK REL="Next"  HREF="004550.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] AUFS vs. DISKS</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20AUFS%20vs.%20DISKS&In-Reply-To=%3C55A65F89.9040104%40gmail.com%3E"
       TITLE="[squid-users] AUFS vs. DISKS">yvoinov at gmail.com
       </A><BR>
    <I>Wed Jul 15 13:26:33 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004548.html">[squid-users] AUFS vs. DISKS
</A></li>
        <LI>Next message (by thread): <A HREF="004550.html">[squid-users] AUFS vs. DISKS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4549">[ date ]</a>
              <a href="thread.html#4549">[ thread ]</a>
              <a href="subject.html#4549">[ subject ]</a>
              <a href="author.html#4549">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
Here is my stats:

client_http.all_median_svc_time = 0.097357 seconds
client_http.miss_median_svc_time = 0.097357 seconds
client_http.nm_median_svc_time = 0.000000 seconds
client_http.nh_median_svc_time = 0.000000 seconds
client_http.hit_median_svc_time = 0.000000 seconds
icp.query_median_svc_time = 0.000000 seconds
icp.reply_median_svc_time = 0.000000 seconds
dns.median_svc_time = 0.000000 seconds
client_http.all_median_svc_time = 0.102812 seconds
client_http.miss_median_svc_time = 0.108570 seconds
client_http.nm_median_svc_time = 0.000000 seconds
client_http.nh_median_svc_time = 0.127833 seconds
client_http.hit_median_svc_time = 0.000000 seconds
icp.query_median_svc_time = 0.000000 seconds
icp.reply_median_svc_time = 0.000000 seconds
dns.median_svc_time = 0.000000 seconds
client_http.all_median_svc_time = 0.102812 seconds
client_http.miss_median_svc_time = 0.108570 seconds
client_http.nm_median_svc_time = 0.000911 seconds
client_http.nh_median_svc_time = 0.127833 seconds
client_http.hit_median_svc_time = 0.010350 seconds
icp.query_median_svc_time = 0.000000 seconds
icp.reply_median_svc_time = 0.000000 seconds
dns.median_svc_time = 0.000000 seconds

Diskd:

sent_count: 103224
recv_count: 103224
max_away: 129
max_shmuse: 129
open_fail_queue_len: 0
block_queue_len: 15478

              OPS   SUCCESS    FAIL
   open      4180      4180       0
 create      4057      4057       0
  close      8237      8237       0
 unlink       737       737       0
   read     16741     16741       0
  write     69272     69272       0

You has too long queue, so this indicates bottleneck in IO. Need to find
and resolve.

15.07.15 19:18, FredB &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Did you check the TCP_HIT response times with the Diskd ?
</I>&gt;<i>
</I>&gt;<i> Yes
</I>&gt;<i>
</I>&gt;<i> 192.x.x.x - fred [15/Jul/2015:14:30:27 +0200] &quot;GET
</I><A HREF="http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe">http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe</A>
HTTP/1.0&quot; 200 10096376 TCP_HIT:HIER_NONE &quot;Wget/1.13.4 (linux-gnu)&quot;
&gt;<i> 192.x.x.x - fred [15/Jul/2015:14:30:31 +0200] &quot;GET
</I><A HREF="http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe">http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe</A>
HTTP/1.0&quot; 200 10096376 TCP_HIT:HIER_NONE &quot;Wget/1.13.4 (linux-gnu)&quot;
&gt;<i> 192.x.x.x - fred [15/Jul/2015:14:36:56 +0200] &quot;GET
</I><A HREF="http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe">http://ec.ccm2.net/www.commentcamarche.net/download/files/youtube_downloader_hd_setup-2.9.9.23.exe</A>
HTTP/1.0&quot; 200 10096376 TCP_HIT:HIER_NONE &quot;Wget/1.13.4 (linux-gnu)&quot;
&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> During our tests, we have seen than it's sometime better to download
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> object from internet again instead using the one from the cache, we
</I>&gt;&gt;<i> got
</I>&gt;&gt;<i> better response times...
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Now I can't tell because I have a lot of bandwidth free (hundreds),
</I>but a request from squid cache to user is fast
&gt;<i> Something between 6 and 10 M/s (En Fran&#231;ais 6 and 10 MO -&gt; 32 and 80
</I>mbits) and I'm not sure than my lan network is unused ...
&gt;<i>
</I>&gt;<i> So with hundreds of concurrent users I think that there is no special
</I>problem.
&gt;<i>
</I>&gt;<i> FI more informations: username_cache tells me 4612 users
</I>&gt;<i>
</I>&gt;<i> Diskd stats
</I>&gt;<i>
</I>&gt;<i> squidclient -p 8080 mgr:diskd
</I>&gt;<i>
</I>&gt;<i> sent_count: 23105099
</I>&gt;<i> recv_count: 23105042
</I>&gt;<i> max_away: 143
</I>&gt;<i> max_shmuse: 141
</I>&gt;<i> open_fail_queue_len: 40114
</I>&gt;<i> block_queue_len: 629596120
</I>&gt;<i>
</I>&gt;<i>               OPS   SUCCESS    FAIL
</I>&gt;<i>    open   2192154   2192133       4
</I>&gt;<i>  create   1284546   1284546       0
</I>&gt;<i>   close   3476648   3476630       4
</I>&gt;<i>  unlink    981134    981131       2
</I>&gt;<i>    read   6541304   6541279       0
</I>&gt;<i>   write   8629313   8629313       0
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Last five minutes:
</I>&gt;<i>
</I>&gt;<i> squidclient -p 8080 mgr:5min
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> sample_start_time = 1436965191.905545 (Wed, 15 Jul 2015 12:59:51 GMT)
</I>&gt;<i> sample_end_time = 1436965491.907754 (Wed, 15 Jul 2015 13:04:51 GMT)
</I>&gt;<i> client_http.requests = 334.370871/sec
</I>&gt;<i> client_http.hits = 114.399158/sec
</I>&gt;<i> client_http.errors = 22.943164/sec
</I>&gt;<i> client_http.kbytes_in = 2948.928286/sec
</I>&gt;<i> client_http.kbytes_out = 6090.041824/sec
</I>&gt;<i> client_http.all_median_svc_time = 0.050460 seconds
</I>&gt;<i> client_http.miss_median_svc_time = 0.177113 seconds
</I>&gt;<i> client_http.nm_median_svc_time = 0.000911 seconds
</I>&gt;<i> client_http.nh_median_svc_time = 0.038286 seconds
</I>&gt;<i> client_http.hit_median_svc_time = 0.007665 seconds
</I>&gt;<i> server.all.requests = 237.598250/sec
</I>&gt;<i> server.all.errors = 0.000000/sec
</I>&gt;<i> server.all.kbytes_in = 5110.549036/sec
</I>&gt;<i> server.all.kbytes_out = 2765.982966/sec
</I>&gt;<i> server.http.requests = 185.981964/sec
</I>&gt;<i> server.http.errors = 0.000000/sec
</I>&gt;<i> server.http.kbytes_in = 1963.482209/sec
</I>&gt;<i> server.http.kbytes_out = 162.952133/sec
</I>&gt;<i> server.ftp.requests = 0.000000/sec
</I>&gt;<i> server.ftp.errors = 0.000000/sec
</I>&gt;<i> server.ftp.kbytes_in = 0.000000/sec
</I>&gt;<i> server.ftp.kbytes_out = 0.000000/sec
</I>&gt;<i> server.other.requests = 51.616287/sec
</I>&gt;<i> server.other.errors = 0.000000/sec
</I>&gt;<i> server.other.kbytes_in = 3147.070160/sec
</I>&gt;<i> server.other.kbytes_out = 2603.030833/sec
</I>&gt;<i> icp.pkts_sent = 0.000000/sec
</I>&gt;<i> icp.pkts_recv = 0.000000/sec
</I>&gt;<i> icp.queries_sent = 0.000000/sec
</I>&gt;<i> icp.replies_sent = 0.000000/sec
</I>&gt;<i> icp.queries_recv = 0.000000/sec
</I>&gt;<i> icp.replies_recv = 0.000000/sec
</I>&gt;<i> icp.replies_queued = 0.000000/sec
</I>&gt;<i> icp.query_timeouts = 0.000000/sec
</I>&gt;<i> icp.kbytes_sent = 0.000000/sec
</I>&gt;<i> icp.kbytes_recv = 0.000000/sec
</I>&gt;<i> icp.q_kbytes_sent = 0.000000/sec
</I>&gt;<i> icp.r_kbytes_sent = 0.000000/sec
</I>&gt;<i> icp.q_kbytes_recv = 0.000000/sec
</I>&gt;<i> icp.r_kbytes_recv = 0.000000/sec
</I>&gt;<i> icp.query_median_svc_time = 0.000000 seconds
</I>&gt;<i> icp.reply_median_svc_time = 0.000000 seconds
</I>&gt;<i> dns.median_svc_time = 0.005733 seconds
</I>&gt;<i> unlink.requests = 2.859979/sec
</I>&gt;<i> page_faults = 0.010000/sec
</I>&gt;<i> select_loops = 6428.069335/sec
</I>&gt;<i> select_fds = 7919.858350/sec
</I>&gt;<i> average_select_fd_period = 0.000000/fd
</I>&gt;<i> median_select_fds = 0.000000
</I>&gt;<i> swap.outs = 62.482873/sec
</I>&gt;<i> swap.ins = 129.082383/sec
</I>&gt;<i> swap.files_cleaned = 0.000000/sec
</I>&gt;<i> aborted_requests = 14.339894/sec
</I>&gt;<i> syscalls.disk.opens = 192.085252/sec
</I>&gt;<i> syscalls.disk.closes = 192.045253/sec
</I>&gt;<i> syscalls.disk.reads = 376.233896/sec
</I>&gt;<i> syscalls.disk.writes = 499.342990/sec
</I>&gt;<i> syscalls.disk.seeks = 0.000000/sec
</I>&gt;<i> syscalls.disk.unlinks = 57.879574/sec
</I>&gt;<i> syscalls.sock.accepts = 243.548207/sec
</I>&gt;<i> syscalls.sock.sockets = 131.322366/sec
</I>&gt;<i> syscalls.sock.connects = 131.322366/sec
</I>&gt;<i> syscalls.sock.binds = 0.000000/sec
</I>&gt;<i> syscalls.sock.closes = 377.267222/sec
</I>&gt;<i> syscalls.sock.reads = 3535.117303/sec
</I>&gt;<i> syscalls.sock.writes = 3999.197219/sec
</I>&gt;<i> syscalls.sock.recvfroms = 21.509842/sec
</I>&gt;<i> syscalls.sock.sendtos = 10.876587/sec
</I>&gt;<i> cpu_time = 170.718669 seconds
</I>&gt;<i> wall_time = 300.002209 seconds
</I>&gt;<i> cpu_usage = 56.905804%
</I>&gt;<i>  
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJVpl+JAAoJENNXIZxhPexGk2IH/1zGNmtNl9xvTRjoyS2T2Js2
Xl7k4jU4n/63hSWki8FbZ8vdcDaiErZKx2SwrYhGW144Xp2ldShnEi9O0vpt5NIa
3gT/J3xO8+GQTqnUa58BwFag+ROlvuvUYSqcJIMJ7O5bcPCOgYP+dZC1sEcGATQS
avq5F1NjmCn3f+Xk+lQP1xXipCI1gPYkvNXUbCkM0JODYsdGe2AdMoJ5fGQ397np
SpmSvkXdQxqL720qgtuFgjIH/xXomMsW9MPusDDUos2IMvMtz1m8OtZu1sK4J9SW
F5oAJowK7Y1Bd2L+DWKcwcXXdmpSuPuiUS9YLSEP+IJyAoKQceCC+O23UuHwu0A=
=NtRA
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004548.html">[squid-users] AUFS vs. DISKS
</A></li>
	<LI>Next message (by thread): <A HREF="004550.html">[squid-users] AUFS vs. DISKS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4549">[ date ]</a>
              <a href="thread.html#4549">[ thread ]</a>
              <a href="subject.html#4549">[ subject ]</a>
              <a href="author.html#4549">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
