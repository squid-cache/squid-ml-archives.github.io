<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 3.5 with auth and chroot
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.5%20with%20auth%20and%20chroot&In-Reply-To=%3CCAMeoTH%3D02cRGiVjZk%3DcyFtgjv0GU7aJOLidPdx_SLYBeD6Dx5Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004757.html">
   <LINK REL="Next"  HREF="004760.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 3.5 with auth and chroot</H1>
    <B>Jorgeley Junior</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.5%20with%20auth%20and%20chroot&In-Reply-To=%3CCAMeoTH%3D02cRGiVjZk%3DcyFtgjv0GU7aJOLidPdx_SLYBeD6Dx5Q%40mail.gmail.com%3E"
       TITLE="[squid-users] squid 3.5 with auth and chroot">jorgeley at gmail.com
       </A><BR>
    <I>Fri Jul 24 14:22:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004757.html">[squid-users] squid 3.5 with auth and chroot
</A></li>
        <LI>Next message (by thread): <A HREF="004760.html">[squid-users] squid 3.5 with auth and chroot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4758">[ date ]</a>
              <a href="thread.html#4758">[ thread ]</a>
              <a href="subject.html#4758">[ subject ]</a>
              <a href="author.html#4758">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you so much for the help.
So, I use the directive 'chroot' in the squid.conf.
I start squid this way:
cd /etc/squid-3.5.6
sbin/squid
and it starts normally, but when I open the client browser and do an
authentication it logs the errors and don't authenticate, but the squid
doesn't stop running, just it logs the error and do not authenticate.
How I told you before, if I do: chroot /etc/squid-3.5.6
libexec/basic_ncsa_auth it runs, that's why I'm sure that basic_ncsa_auth
it's running correctly, I suspect maybe this IPCcreate run as another user
that cannot access the basic_ncsa_auth or maybe IPCcreate its located in a
directory that cannot see the libexec/basice_ncsa relative path
That's a weird scenario.

2015-07-24 11:02 GMT-03:00 Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:

&gt;<i> On 25/07/2015 12:10 a.m., Jorgeley Junior wrote:
</I>&gt;<i> &gt; please guys, help me.
</I>&gt;<i> &gt; Any suggestions?
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Squid is not generally run in a chroot. The master / coordinator daemon
</I>&gt;<i> manager process requires root access for several things and spawns
</I>&gt;<i> workers that are dropped automatically to highly restricted access
</I>&gt;<i> anyway. You already found out how big the dependency pool of libraries is.
</I>&gt;<i>
</I>&gt;<i> I guess what I'm getting at is that this is a rarely tested situation.
</I>&gt;<i>
</I>&gt;<i> To complicate matters there are three different combinations of &quot;chroot&quot;
</I>&gt;<i> that Squid can run.
</I>&gt;<i>
</I>&gt;<i> * External chroot. Where you enter the chroot before starting Squid and
</I>&gt;<i> it thinks the chroot content is the whole system.
</I>&gt;<i>
</I>&gt;<i> * configured chroot. Where you configure Squid master process to chroot
</I>&gt;<i> its low-privilege workers with the squid.conf chroot directive.
</I>&gt;<i>
</I>&gt;<i> * Linux containers. Similar to the first, but you dont have to copy
</I>&gt;<i> files into a separate chroot area. Just assign visibility/access to the
</I>&gt;<i> OS areas.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The error is pretty clear though. The problem is that something is
</I>&gt;<i> unable to load a file during helper startup.
</I>&gt;<i> Either Squid is unable to read/open/see the helper binary file itself.
</I>&gt;<i> Or the helper is unable to open a file it needs to operate.
</I>&gt;<i>
</I>&gt;<i> &quot;ipcCreate:&quot; is a big hint that its Squid not finding the helper binary
</I>&gt;<i> named.
</I>&gt;<i>
</I>&gt;<i> So is Squid being run from inside the chroot, or using &quot;chroot&quot;
</I>&gt;<i> directive in squid.conf?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150724/f8ad5471/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150724/f8ad5471/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004757.html">[squid-users] squid 3.5 with auth and chroot
</A></li>
	<LI>Next message (by thread): <A HREF="004760.html">[squid-users] squid 3.5 with auth and chroot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4758">[ date ]</a>
              <a href="thread.html#4758">[ thread ]</a>
              <a href="subject.html#4758">[ subject ]</a>
              <a href="author.html#4758">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
