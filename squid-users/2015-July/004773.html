<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ISSUE accssing content
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ISSUE%20accssing%20content&In-Reply-To=%3C55B28A90.1010006%40afo.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004790.html">
   <LINK REL="Next"  HREF="004779.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ISSUE accssing content</H1>
    <B>Mike</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ISSUE%20accssing%20content&In-Reply-To=%3C55B28A90.1010006%40afo.net%3E"
       TITLE="[squid-users] ISSUE accssing content">mcsnv96 at afo.net
       </A><BR>
    <I>Fri Jul 24 18:57:20 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004790.html">[squid-users] ISSUE accssing content
</A></li>
        <LI>Next message (by thread): <A HREF="004779.html">[squid-users] ISSUE accssing content
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4773">[ date ]</a>
              <a href="thread.html#4773">[ thread ]</a>
              <a href="subject.html#4773">[ subject ]</a>
              <a href="author.html#4773">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I see a few issues.

1. The report from the log shows a 192.168.*.* address, common LAN IP

Then in the squid.conf:
2. You have wvdial destination as 10.1.*.* addresses, which is a 
completely different internal network.
Typically there will be no internal routing or communication from a 
192.168..*.* address to/from a 10.*.*.* address without a custom routing 
server with 2 network connections, one from each IP set and to act as 
the DNS intermediary for routing. Otherwise for network/internet 
connections, the computer/browser sees its own IP as local network, and 
everything else including 10.*.*.* as an external address out on the 
internet. I would suggest getting both the browsing computer and the 
server on the same IP subset, as in 192.168.122.x or 10.1.4.x, otherwise 
these issues are likely to continue.

3. Next in the squid.conf is http_port which should be port number only, 
no IP address, especially 0.0.0.0 which can cause conflicts with squid 
3.x versions. Best bet is use just port only, as in: &quot;http_port 3128&quot; or 
in your case &quot;http_port 8080&quot;, which is the port (with server IP found 
in ifconfig) the browser will use to connect through the squid server.
4. The bypass local network means any IP connection attempt to a local 
network IP will not use the proxy. This goes back to the 2 different IP 
subsets. One option is to enter a proxy exception as 10.*.*.* (if the 
websense server is using 10.x.x.x IP address).


Mike


On 7/24/2015 10:35 AM, Jagannath Naidu wrote:
&gt;<i> Dear List,
</I>&gt;<i>
</I>&gt;<i> I have been working on this for last two weeks, but never got it 
</I>&gt;<i> resolved.
</I>&gt;<i>
</I>&gt;<i> We have a application server (SERVER) in our local network and a 
</I>&gt;<i> desktop  application (CLIENT). The application picks proxy settings 
</I>&gt;<i> from IE. And we also have a wensense proxy server
</I>&gt;<i>
</I>&gt;<i> case 1: when there is no proxy set
</I>&gt;<i> application works. No logs in squid server access.log
</I>&gt;<i>
</I>&gt;<i> case 2: when proxy ip address set and checked &quot;bypass local network&quot;
</I>&gt;<i> application works. No logs in squid server access.log
</I>&gt;<i>
</I>&gt;<i> case 3: when proxy ip address is set to wensense proxy server. 
</I>&gt;<i> UNCHECKED &quot;bypass local network&quot;
</I>&gt;<i> application works. We dont have access to websense server and hence we 
</I>&gt;<i> can not check logs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> case 4: when proxy ip address is set to proxy server ip address. 
</I>&gt;<i> UNCHECKED &quot;bypass local network&quot;
</I>&gt;<i> application does not work :-(. Below are the logs.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 1437751240.149      7 192.168.122.1 TCP_MISS/404 579 GET 
</I>&gt;<i> <A HREF="http://dlwvdialce.htmedia.net/UADInstall/UADPresentationLayer.application">http://dlwvdialce.htmedia.net/UADInstall/UADPresentationLayer.application</A> 
</I>&gt;<i> - HIER_DIRECT/10.1.4.46 &lt;<A HREF="http://10.1.4.46">http://10.1.4.46</A>&gt; text/html
</I>&gt;<i> 1437751240.992     94 192.168.122.1 TCP_DENIED/407 3757 CONNECT 
</I>&gt;<i> 0.client-channel.google.com:443 
</I>&gt;<i> &lt;<A HREF="http://0.client-channel.google.com:443">http://0.client-channel.google.com:443</A>&gt; - HIER_NONE/- text/html
</I>&gt;<i> 1437751240.996      0 192.168.122.1 TCP_DENIED/407 4059 CONNECT 
</I>&gt;<i> 0.client-channel.google.com:443 
</I>&gt;<i> &lt;<A HREF="http://0.client-channel.google.com:443">http://0.client-channel.google.com:443</A>&gt; - HIER_NONE/- text/html
</I>&gt;<i> 1437751242.327      5 192.168.122.1 TCP_MISS/404 579 GET 
</I>&gt;<i> <A HREF="http://dlwvdialce.htmedia.net/UADInstall/uadprop.htm">http://dlwvdialce.htmedia.net/UADInstall/uadprop.htm</A> - 
</I>&gt;<i> HIER_DIRECT/10.1.4.46 &lt;<A HREF="http://10.1.4.46">http://10.1.4.46</A>&gt; text/html
</I>&gt;<i> 1437751244.777      1 192.168.122.1 TCP_MISS/503 4048 POST 
</I>&gt;<i> <A HREF="http://cs-711-core.htmedia.net:8180/ConcertoAgentPortal/services/ConcertoAgentPortal">http://cs-711-core.htmedia.net:8180/ConcertoAgentPortal/services/ConcertoAgentPortal</A> 
</I>&gt;<i> - HIER_NONE/- text/html
</I>&gt;<i>
</I>&gt;<i> squid -v
</I>&gt;<i> Squid Cache: Version 3.3.8
</I>&gt;<i> configure options:  '--build=x86_64-redhat-linux-gnu' 
</I>&gt;<i> '--host=x86_64-redhat-linux-gnu' '--program-prefix=' '--prefix=/usr' 
</I>&gt;<i> '--exec-prefix=/usr' '--bindir=/usr/bin' '--sbindir=/usr/sbin' 
</I>&gt;<i> '--sysconfdir=/etc' '--datadir=/usr/share' '--includedir=/usr/include' 
</I>&gt;<i> '--libdir=/usr/lib64' '--libexecdir=/usr/libexec' 
</I>&gt;<i> '--sharedstatedir=/var/lib' '--mandir=/usr/share/man' 
</I>&gt;<i> '--infodir=/usr/share/info' '--disable-strict-error-checking' 
</I>&gt;<i> '--exec_prefix=/usr' '--libexecdir=/usr/lib64/squid' 
</I>&gt;<i> '--localstatedir=/var' '--datadir=/usr/share/squid' 
</I>&gt;<i> '--sysconfdir=/etc/squid' '--with-logdir=$(localstatedir)/log/squid' 
</I>&gt;<i> '--with-pidfile=$(localstatedir)/run/squid.pid' 
</I>&gt;<i> '--disable-dependency-tracking' '--enable-eui' 
</I>&gt;<i> '--enable-follow-x-forwarded-for' '--enable-auth' 
</I>&gt;<i> '--enable-auth-basic=DB,LDAP,MSNT,MSNT-multi-domain,NCSA,NIS,PAM,POP3,RADIUS,SASL,SMB,getpwnam' 
</I>&gt;<i> '--enable-auth-ntlm=smb_lm,fake' 
</I>&gt;<i> '--enable-auth-digest=file,LDAP,eDirectory' 
</I>&gt;<i> '--enable-auth-negotiate=kerberos' 
</I>&gt;<i> '--enable-external-acl-helpers=file_userip,LDAP_group,time_quota,session,unix_group,wbinfo_group' 
</I>&gt;<i> '--enable-cache-digests' '--enable-cachemgr-hostname=localhost' 
</I>&gt;<i> '--enable-delay-pools' '--enable-epoll' '--enable-icap-client' 
</I>&gt;<i> '--enable-ident-lookups' '--enable-linux-netfilter' 
</I>&gt;<i> '--enable-removal-policies=heap,lru' '--enable-snmp' '--enable-ssl' 
</I>&gt;<i> '--enable-ssl-crtd' '--enable-storeio=aufs,diskd,ufs' 
</I>&gt;<i> '--enable-wccpv2' '--enable-esi' '--enable-ecap' '--with-aio' 
</I>&gt;<i> '--with-default-user=squid' '--with-filedescriptors=16384' '--with-dl' 
</I>&gt;<i> '--with-openssl' '--with-pthreads' 
</I>&gt;<i> 'build_alias=x86_64-redhat-linux-gnu' 
</I>&gt;<i> 'host_alias=x86_64-redhat-linux-gnu' 'CFLAGS=-O2 -g -pipe -Wall 
</I>&gt;<i> -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong 
</I>&gt;<i> --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic 
</I>&gt;<i> -fpie' 'LDFLAGS=-Wl,-z,relro  -pie -Wl,-z,relro -Wl,-z,now' 
</I>&gt;<i> 'CXXFLAGS=-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions 
</I>&gt;<i> -fstack-protector-strong --param=ssp-buffer-size=4 
</I>&gt;<i> -grecord-gcc-switches   -m64 -mtune=generic -fpie' 
</I>&gt;<i> 'PKG_CONFIG_PATH=%{_PKG_CONFIG_PATH}:/usr/lib64/pkgconfig:/usr/share/pkgconfig'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> squid.conf
</I>&gt;<i>
</I>&gt;<i> acl localnet src 10.0.0.0/8 &lt;<A HREF="http://10.0.0.0/8">http://10.0.0.0/8</A>&gt;     # RFC1918 possible 
</I>&gt;<i> internal network
</I>&gt;<i> acl localnet src 172.16.0.0/12 &lt;<A HREF="http://172.16.0.0/12">http://172.16.0.0/12</A>&gt;  # RFC1918 
</I>&gt;<i> possible internal network
</I>&gt;<i> acl localnet src 192.168.0.0/16 &lt;<A HREF="http://192.168.0.0/16">http://192.168.0.0/16</A>&gt; # RFC1918 
</I>&gt;<i> possible internal network
</I>&gt;<i> acl localnet src fc00::/7       # RFC 4193 local private network range
</I>&gt;<i> acl localnet src fe80::/10      # RFC 4291 link-local (directly 
</I>&gt;<i> plugged) machines
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i> acl Safe_ports port 70          # gopher
</I>&gt;<i> acl Safe_ports port 210         # wais
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> acl Safe_ports port 280         # http-mgmt
</I>&gt;<i> acl Safe_ports port 488         # gss-http
</I>&gt;<i> acl Safe_ports port 591         # filemaker
</I>&gt;<i> acl Safe_ports port 777         # multiling http
</I>&gt;<i> acl Safe_ports port 8180
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> acl wvdial dst 10.1.4.45 10.1.4.50 10.1.4.53 10.1.4.48 10.1.4.54 
</I>&gt;<i> 10.1.4.46 10.1.4.51 10.1.4.47 10.1.4.55 10.1.4.49 10.1.4.52 10.1.2.4
</I>&gt;<i> http_access allow wvdial
</I>&gt;<i> acl dialer dstdomain .htmedia.net &lt;<A HREF="http://htmedia.net">http://htmedia.net</A>&gt;
</I>&gt;<i> http_access allow dialer
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access allow localhost manager
</I>&gt;<i> http_access deny manager
</I>&gt;<i> visible_hostname = NOIDAPROXY01.MYDOMAIN.NET 
</I>&gt;<i> &lt;<A HREF="http://NOIDAPROXY01.MYDOMAIN.NET">http://NOIDAPROXY01.MYDOMAIN.NET</A>&gt;
</I>&gt;<i> append_domain  .mydomain.net &lt;<A HREF="http://mydomain.net">http://mydomain.net</A>&gt;
</I>&gt;<i> ignore_expect_100 on
</I>&gt;<i> dns_v4_first on
</I>&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth --diagnostics 
</I>&gt;<i> --helper-protocol=squid-2.5-ntlmssp --domain=HTMEDIA.NET 
</I>&gt;<i> &lt;<A HREF="http://HTMEDIA.NET">http://HTMEDIA.NET</A>&gt;
</I>&gt;<i> auth_param ntlm children 1000
</I>&gt;<i> auth_param ntlm keep_alive off
</I>&gt;<i> auth_param basic program /usr/bin/ntlm_auth 
</I>&gt;<i> --helper-protocol=squid-2.5-basic
</I>&gt;<i> auth_param basic children 100
</I>&gt;<i> auth_param basic realm Squid proxy-caching web server
</I>&gt;<i> auth_param basic credentialsttl 2 hours
</I>&gt;<i> acl auth proxy_auth REQUIRED
</I>&gt;<i> http_access allow all auth
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> http_access deny all
</I>&gt;<i> http_port 0.0.0.0:8080 &lt;<A HREF="http://0.0.0.0:8080">http://0.0.0.0:8080</A>&gt;
</I>&gt;<i> coredump_dir /var/spool/squid
</I>&gt;<i> refresh_pattern ^ftp:           1440    20%     10080
</I>&gt;<i> refresh_pattern ^gopher:        1440    0%      1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
</I>&gt;<i> refresh_pattern .               0       20%     4320
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It was the same behavior with squid-3.1.10-19. I thought, upgrading to 
</I>&gt;<i> squid 3.3 would help. Please help me resolving this mystery.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> Thanks &amp; Regards
</I>&gt;<i>
</I>&gt;<i> Jagannath Naidu
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150724/eb73c1ce/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150724/eb73c1ce/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004790.html">[squid-users] ISSUE accssing content
</A></li>
	<LI>Next message (by thread): <A HREF="004779.html">[squid-users] ISSUE accssing content
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4773">[ date ]</a>
              <a href="thread.html#4773">[ thread ]</a>
              <a href="subject.html#4773">[ subject ]</a>
              <a href="author.html#4773">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
