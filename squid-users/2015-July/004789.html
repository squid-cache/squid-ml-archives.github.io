<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cannot leave empty workers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cannot%20leave%20empty%20workers&In-Reply-To=%3C55B2DE57.2030106%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004785.html">
   <LINK REL="Next"  HREF="004795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cannot leave empty workers</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cannot%20leave%20empty%20workers&In-Reply-To=%3C55B2DE57.2030106%40treenet.co.nz%3E"
       TITLE="[squid-users] cannot leave empty workers">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jul 25 00:54:47 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004785.html">[squid-users] cannot leave empty workers
</A></li>
        <LI>Next message (by thread): <A HREF="004795.html">[squid-users] cannot leave empty workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4789">[ date ]</a>
              <a href="thread.html#4789">[ thread ]</a>
              <a href="subject.html#4789">[ subject ]</a>
              <a href="author.html#4789">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/07/2015 11:53 a.m., Alex Wu wrote:
&gt;<i> further analysis indicated that master process created quid-ssl_session_cache.shm.
</I>&gt;<i> 
</I>&gt;<i> In other words, it needs a https_port or http_port with ssl-bump in outside any process number to create this shared memeory segment.
</I>&gt;<i> 
</I>&gt;<i> Furthermore, the code  should be simplied like this:
</I>&gt;<i> 
</I>&gt;<i> diff --git a/squid-3.5.6/src/ssl/support.cc b/squid-3.5.6/src/ssl/support.cc
</I>&gt;<i> index 85305ce..0ce95f9 100644
</I>&gt;<i> --- a/squid-3.5.6/src/ssl/support.cc
</I>&gt;<i> +++ b/squid-3.5.6/src/ssl/support.cc
</I>&gt;<i> @@ -2084,9 +2084,6 @@ SharedSessionCacheRr::useConfig()
</I>&gt;<i>  void
</I>&gt;<i>  SharedSessionCacheRr::create()
</I>&gt;<i>  {
</I>&gt;<i> -    if (!isSslServer()) //no need to configure ssl session cache.
</I>&gt;<i> -        return;
</I>&gt;<i> -
</I>&gt;<i>      int items;
</I>&gt;<i>      items = Config.SSL.sessionCacheSize / sizeof(Ipc::MemMap::Slot);
</I>&gt;<i>      if (items)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> This code is called in master that may not have configuration to ensure isSsslServer return true.
</I>&gt;<i> 
</I>
The bug is in why that SharedSessionCacheRr is not being run by the worker.

AFAIK, it is the way the worker is supposed to attach to the shared
memory. First process to access the SHM does the create, others attach.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004785.html">[squid-users] cannot leave empty workers
</A></li>
	<LI>Next message (by thread): <A HREF="004795.html">[squid-users] cannot leave empty workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4789">[ date ]</a>
              <a href="thread.html#4789">[ thread ]</a>
              <a href="subject.html#4789">[ subject ]</a>
              <a href="author.html#4789">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
