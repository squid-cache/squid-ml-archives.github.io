<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Website causing 3.5.5 squid crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Website%20causing%203.5.5%20squid%20crash&In-Reply-To=%3C5573248B.2090401%40afo.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003936.html">
   <LINK REL="Next"  HREF="003920.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Website causing 3.5.5 squid crash</H1>
    <B>Mike</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Website%20causing%203.5.5%20squid%20crash&In-Reply-To=%3C5573248B.2090401%40afo.net%3E"
       TITLE="[squid-users] Website causing 3.5.5 squid crash">mcsnv96 at afo.net
       </A><BR>
    <I>Sat Jun  6 16:49:15 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003936.html">[squid-users] PAM/Radius authentication question with	Squid.3.1.10
</A></li>
        <LI>Next message (by thread): <A HREF="003920.html">[squid-users] Website causing 3.5.5 squid crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3905">[ date ]</a>
              <a href="thread.html#3905">[ thread ]</a>
              <a href="subject.html#3905">[ subject ]</a>
              <a href="author.html#3905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Running Scientific Linux 6.6 (based on CentOS), compiled squid 3.5.5 
with no errors.
Issue happens with both squid 3.5.5, and the newer 3.5.5-20150528-r13841.
Starting squid service and running for a while, any attempt to access a 
website like www.nwfdailynews.com causes squid to crash and restart. The 
associated squid log entries from the same time squid crashes, seems to 
be several &quot;TCP_SWAPFAIL_MISS&quot; at that time:

1433608644.053    117 192.168.2.110 TCP_SWAPFAIL_MISS/200 17246 GET 
<A HREF="http://launch.newsinc.com/77/css/NdnEmbed.css">http://launch.newsinc.com/77/css/NdnEmbed.css</A> - 
HIER_DIRECT/184.51.234.134 text/css

Other normal use including facebook and other website do not have any 
problems, so it has to be something relating to this site setup causing 
the crash. We are using this in a testing server for now but hoping to 
roll out to production level used by a few thousand people.

These are the only modified entries in squid:

-----
http_port 3128
# this port is what will be used for SSL Proxy on client browser
http_port 3129 intercept
https_port 3130 intercept ssl-bump connection-auth=off 
generate-host-certificates=on dynamic_cert_mem_cache_size=16MB 
cert=/etc/squid/ssl/squid.pem key=/etc/squid/ssl/squid.key 
cipher=ECDHE-RSA-RC4-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:DHE-RSA-CAMELLIA128-SHA:AES128-SHA:RC4-SHA:HIGH:!aNULL:!MD5:!ADH

sslcrtd_program /usr/lib64/squid/ssl_crtd -s /var/lib/squid_ssl_db -M 16MB
sslcrtd_children 50 startup=5 idle=1
ssl_bump server-first all
ssl_bump none localhost

#Also for log watching to check for errors, add these lines:

cache_log /var/log/squid/cache.log
cache_effective_user squid
debug_options ALL,0
logfile_rotate 10
cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">myemail at myemail.com</A>
pinger_enable off
visible_hostname A7750

# Uncomment and adjust the following to add a disk cache directory.
cache_dir aufs /var/cache/squid 10000 32 512
-----

Let me know anything else you may need or suggestions.

Mike


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003936.html">[squid-users] PAM/Radius authentication question with	Squid.3.1.10
</A></li>
	<LI>Next message (by thread): <A HREF="003920.html">[squid-users] Website causing 3.5.5 squid crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3905">[ date ]</a>
              <a href="thread.html#3905">[ thread ]</a>
              <a href="subject.html#3905">[ subject ]</a>
              <a href="author.html#3905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
