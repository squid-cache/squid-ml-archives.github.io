<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't write logs via rsyslog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20write%20logs%20via%20rsyslog&In-Reply-To=%3C55761F60.3060404%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003945.html">
   <LINK REL="Next"  HREF="003933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't write logs via rsyslog</H1>
    <B>Brendan Kearney</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20write%20logs%20via%20rsyslog&In-Reply-To=%3C55761F60.3060404%40gmail.com%3E"
       TITLE="[squid-users] Squid doesn't write logs via rsyslog">bpk678 at gmail.com
       </A><BR>
    <I>Mon Jun  8 23:04:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003945.html">[squid-users] Squid doesn't write logs via rsyslog
</A></li>
        <LI>Next message (by thread): <A HREF="003933.html">[squid-users] Odp: Re:  Squid doesn't write logs via rsyslog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3947">[ date ]</a>
              <a href="thread.html#3947">[ thread ]</a>
              <a href="subject.html#3947">[ subject ]</a>
              <a href="author.html#3947">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/08/2015 06:46 PM, Amos Jeffries wrote:
&gt;<i> On 8/06/2015 11:02 p.m., Antony Stone wrote:
</I>&gt;&gt;<i> On Monday 08 June 2015 at 12:53:00 (EU time), Robert Lasota wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> the problem is it still writes logs to files /var/log/access.log or
</I>&gt;&gt;&gt;<i> /opt/var/log/access.log (depends what I set in conf) but never to rsyslog.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I mean, I have set rsyslog to it send logs to remote central server, and
</I>&gt;&gt;&gt;<i> from other apps like sshd or named its working and rsyslog send them , but
</I>&gt;&gt;&gt;<i> Squid still not care that and writes locally to files.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I set different combinations in squid.conf but nothing, even:
</I>&gt;&gt;&gt;<i> access_log syslog squid
</I>&gt;&gt;&gt;<i> cache_log syslog squid.
</I>&gt;&gt;&gt;<i> ..also nothing
</I>&gt;&gt;<i> You appear to be missing the facility and priority settings (ie: telling
</I>&gt;&gt;<i> syslogd how to handle the messages).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> See <A HREF="http://www.squid-cache.org/Doc/config/access_log/">http://www.squid-cache.org/Doc/config/access_log/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Try something such as:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> access_log syslog:daemon.info
</I>&gt;<i>
</I>&gt;<i> Also, cache.log is the unified stderr output of all Squid sub-processes
</I>&gt;<i> (workers, diskers, helpers etc). It cannot use syslog at this time.
</I>&gt;<i>
</I>&gt;<i> You can possibly make cache.log file point at a unix socket device that
</I>&gt;<i> pipes somewhere like syslog though.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>to stop rsyslog from writing something, i use:

if $programname startswith 'NetworkManager' then -/dev/null
&amp;~

all messages from NetworkManager are written out to /dev/null in 
asynchronous fashion (does not wait for confirmation of the write action 
succeeding, or fire-and-forget mode).  the &amp;~ is a hard stop action so 
all processing of rules stops if the criteria are met.

you would probably want something like that, but will have to play 
around with it, to make it do what you want.

by the by, are you using plain rsyslog forwarding ala:

*.* @@remote-host:514

i am using RELP (Reliable Event Log Processing) to forward all logs from 
all my boxes to a central device where they are loaded into mariadb.  
the relp module creates a &quot;store-and-forward&quot; fifo queue that can 
overcome network outages (length of outage handled is dictated by queue 
size), and also uses TCP for reliability.  there are modules for 
encryption, authentication, etc for relp, too. there is also phplogcon, 
which i use to review the logs in the database.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003945.html">[squid-users] Squid doesn't write logs via rsyslog
</A></li>
	<LI>Next message (by thread): <A HREF="003933.html">[squid-users] Odp: Re:  Squid doesn't write logs via rsyslog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3947">[ date ]</a>
              <a href="thread.html#3947">[ thread ]</a>
              <a href="subject.html#3947">[ subject ]</a>
              <a href="author.html#3947">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
