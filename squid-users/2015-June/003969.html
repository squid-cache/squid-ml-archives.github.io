<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] High-availability and load-balancing between N squid servers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20High-availability%20and%20load-balancing%20between%20N%0A%20squid%20servers&In-Reply-To=%3CCAJ%2BQ1PW0BOCjdePbUYkMbBXUd1Lg_gNdnAGuqNUoiU56AsDrww%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003955.html">
   <LINK REL="Next"  HREF="003953.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] High-availability and load-balancing between N squid servers</H1>
    <B>Alex Samad</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20High-availability%20and%20load-balancing%20between%20N%0A%20squid%20servers&In-Reply-To=%3CCAJ%2BQ1PW0BOCjdePbUYkMbBXUd1Lg_gNdnAGuqNUoiU56AsDrww%40mail.gmail.com%3E"
       TITLE="[squid-users] High-availability and load-balancing between N squid servers">alex at samad.com.au
       </A><BR>
    <I>Wed Jun 10 03:59:03 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003955.html">[squid-users] High-availability and load-balancing between N squid servers
</A></li>
        <LI>Next message (by thread): <A HREF="003953.html">[squid-users] High-availability and load-balancing between N squid servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3969">[ date ]</a>
              <a href="thread.html#3969">[ thread ]</a>
              <a href="subject.html#3969">[ subject ]</a>
              <a href="author.html#3969">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I run 2 squid boxes, and I use pacemaker to float 2 VIP's between the 2 boxes.

Basically I just run squid on both and I create a VIP resource that
test if squid is running to allocate the VIP.

But this doesn't really give you load balancing. but very good resilience.


Pacemaker and Linux have the ability to do load balancing, by using a
share IP and some hashing algo , I haven't tested it though



On 9 June 2015 at 22:51, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i> On 9/06/2015 7:15 p.m., Rafael Akchurin wrote:
</I>&gt;&gt;<i> Hi Amos,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;snip&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> There seems to be a bit of a myth going around about how HAProxy does
</I>&gt;&gt;&gt;<i> load balancing. HAProxy is an HTTP layer proxy. Just like Squid.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> They both do the same things to received TCP connections. But HAProxy
</I>&gt;&gt;&gt;<i> supports less HTTP features, so its somewhat simpler processing is also
</I>&gt;&gt;&gt;<i> a bit faster when you want it to be a semi-dumb load balancer.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> We are somewhat recently added basic support for the PROXY protocol to Squid.
</I>&gt;&gt;&gt;<i> So HAProxy can relay port 80 connections to Squid-3.5+ without
</I>&gt;&gt;&gt;<i> processing them fully. However Squid does not yet support that on
</I>&gt;&gt;&gt;<i> https_port, which means the TLS connections still wont have client IP
</I>&gt;&gt;&gt;<i> details passed through.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So what would be your proposition for the case of SSL Bump?
</I>&gt;&gt;<i> How to get the connecting client IP and authenticated user name passed to the ICAP server when a cluster of squids somehow getting the CONNECT tunnel established?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Assume we left away the haproxy and rely solely on squid - how would you approach this and how many instances of squid would you deploy?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> From my limited knowledge the FQDN proxy name being resolved to a number of IP addresses running one squid per IP address is the simplest approach.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes, it would seem to be the only form which meets all your criteria
</I>&gt;<i> too. Everything else runs up against the HTTPS brick wall.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003955.html">[squid-users] High-availability and load-balancing between N squid servers
</A></li>
	<LI>Next message (by thread): <A HREF="003953.html">[squid-users] High-availability and load-balancing between N squid servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3969">[ date ]</a>
              <a href="thread.html#3969">[ thread ]</a>
              <a href="subject.html#3969">[ subject ]</a>
              <a href="author.html#3969">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
