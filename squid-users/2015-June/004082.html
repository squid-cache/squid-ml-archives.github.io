<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.5 fails to build for Solaris
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.5%20fails%20to%20build%20for%20Solaris&In-Reply-To=%3C558128FC.9020506%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004079.html">
   <LINK REL="Next"  HREF="004083.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.5 fails to build for Solaris</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.5%20fails%20to%20build%20for%20Solaris&In-Reply-To=%3C558128FC.9020506%40gmail.com%3E"
       TITLE="[squid-users] Squid 3.5.5 fails to build for Solaris">yvoinov at gmail.com
       </A><BR>
    <I>Wed Jun 17 07:59:56 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004079.html">[squid-users] Squid 3.5.5 fails to build for Solaris
</A></li>
        <LI>Next message (by thread): <A HREF="004083.html">[squid-users] bypass proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4082">[ date ]</a>
              <a href="thread.html#4082">[ thread ]</a>
              <a href="subject.html#4082">[ subject ]</a>
              <a href="author.html#4082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I use this configuration parameters to build 64 bit 3.5.x Squid on Solaris:

'--prefix=/usr/local/squid' '--enable-translation' 
'--enable-external-acl-helpers=none' '--enable-ecap' 
'--enable-ipf-transparent' '--enable-storeio=diskd' 
'--enable-removal-policies=lru,heap' '--disable-wccp' 
'--enable-http-violations' '--enable-follow-x-forwarded-for' 
'--enable-arp-acl' '--enable-htcp' '--enable-cache-digests' '--with-dl' 
'--enable-auth-negotiate=none' '--disable-auth-digest' 
'--disable-auth-ntlm' '--disable-url-rewrite-helpers' 
'--enable-storeid-rewrite-helpers=file' 
'--enable-log-daemon-helpers=file' '--enable-ssl-crtd' 
'--with-openssl=/opt/csw' '--enable-zph-qos' '--disable-snmp' 
'--with-build-environment=POSIX_V6_LP64_OFF64' 'CFLAGS=-O3 -m64 
-mtune=core2 -pipe -Wno-write-strings' 'CXXFLAGS=-O3 -m64 -mtune=core2 
-pipe -Wno-write-strings' 'LIBOPENSSL_CFLAGS=-I/opt/csw/include/openssl' 
'CPPFLAGS=-I/opt/csw/include' 'PKG_CONFIG_PATH=/usr/local/lib/pkgconfig' 
--enable-build-info=&quot;Intercept/WCCPv2/OpenSSL/CRTD/DISKD/ECAP/64/GCC 
Production&quot;

This is good enough to build well 64 bit executables.

Note: I've use dual 32/54 bit libraries from OpenCSW repository and 
specified crle libraries path:

root @ cthulhu / # crle

Configuration file [version 4]: /var/ld/ld.config
   Platform:     32-bit LSB 80386
   Default Library Path (ELF): 
/lib:/usr/lib:/usr/local/lib:/opt/csw/lib:/usr/sfw/lib
   Trusted Directories (ELF):    /lib/secure:/usr/lib/secure  (system 
default)

Command line:
   crle -c /var/ld/ld.config -l 
/lib:/usr/lib:/usr/local/lib:/opt/csw/lib:/usr/sfw/lib

root @ cthulhu / # crle -64

Configuration file [version 4]: /var/ld/64/ld.config
   Platform:     64-bit LSB AMD64
   Default Library Path (ELF): 
/lib/64:/usr/lib/64:/opt/csw/lib/64:/usr/sfw/lib/64
   Trusted Directories (ELF):    /lib/secure/64:/usr/lib/secure/64 
(system default)

Command line:
   crle -64 -c /var/ld/64/ld.config -l 
/lib/64:/usr/lib/64:/opt/csw/lib/64:/usr/sfw/lib/64

Hope this helps.

17.06.15 4:47, Stacy Yeh &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> I am attempting to update from Squid 3.1.23 to the latest version 
</I>&gt;<i> 3.5.5 for Solaris and am running into the following build error. From 
</I>&gt;<i> my understanding (correct me if I'm wrong), the issue is that the link 
</I>&gt;<i> is trying to link against the 32-bit version of libtool, although a 
</I>&gt;<i> 64-bit version also exists.
</I>&gt;<i>
</I>&gt;<i> [snip]
</I>&gt;<i> libtool: link: /usr/gcc/4.8/bin/g++ -m64 -Wall -Wpointer-arith 
</I>&gt;<i> -Wwrite-strings -Wcomments -Wshadow -Werror -pipe -D_REENTRANT 
</I>&gt;<i> -pthreads -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -g -O2 
</I>&gt;<i> -march=native -std=c++11 -m64 -o basic_ncsa_auth basic_ncsa_auth.o 
</I>&gt;<i> crypt_md5.o -m64  ../../../lib/.libs/libmisccontainers.a 
</I>&gt;<i> ../../../lib/.libs/libmiscencoding.a 
</I>&gt;<i> ../../../compat/.libs/libcompat-squid.a -lcrypt -lmd5 -lm -lresolv 
</I>&gt;<i> -pthreads
</I>&gt;<i> ld: warning: file ../../../lib/.libs/libmiscencoding.a(md5.o): wrong 
</I>&gt;<i> ELF class: ELFCLASS32
</I>&gt;<i> Undefined                       first referenced
</I>&gt;<i>  symbol                             in file
</I>&gt;<i> rfc1738_unescape                    basic_ncsa_auth.o
</I>&gt;<i> SquidMD5Update                      crypt_md5.o
</I>&gt;<i> SquidMD5Init                        crypt_md5.o
</I>&gt;<i> SquidMD5Final                       crypt_md5.o
</I>&gt;<i> ld: fatal: symbol referencing errors
</I>&gt;<i> collect2: error: ld returned 1 exit status
</I>&gt;<i> make[4]: *** [basic_ncsa_auth] Error 1
</I>&gt;<i> make[4]: Leaving directory 
</I>&gt;<i> `/builds/skyeh/squid-19581055-s12/components/squid/build/amd64/helpers/basic_auth/NCSA'
</I>&gt;<i> make[3]: *** [all-recursive] Error 1
</I>&gt;<i> make[3]: Leaving directory 
</I>&gt;<i> `/builds/skyeh/squid-19581055-s12/components/squid/build/amd64/helpers/basic_auth'
</I>&gt;<i> make[2]: *** [all-recursive] Error 1
</I>&gt;<i> make[2]: Leaving directory 
</I>&gt;<i> `/builds/skyeh/squid-19581055-s12/components/squid/build/amd64/helpers'
</I>&gt;<i> make[1]: *** [all-recursive] Error 1
</I>&gt;<i> make[1]: Leaving directory 
</I>&gt;<i> `/builds/skyeh/squid-19581055-s12/components/squid/build/amd64'
</I>&gt;<i> gmake: *** 
</I>&gt;<i> [/builds/skyeh/squid-19581055-s12/components/squid/build/amd64/.built] 
</I>&gt;<i> Error 2
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Any suggestions on how to fix this? For what it's worth, here are the 
</I>&gt;<i> configure options I am using:
</I>&gt;<i>
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-arp-acl
</I>&gt;<i> CONFIGURE_OPTIONS += 
</I>&gt;<i> --enable-auth-basic='DB,NCSA,LDAP,PAM,getpwnam,MSNT-multi-domain,POP3,SMB,SASL'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-cache-digests
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-carp
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-coss-aio-ops
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-delay-pools
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-auth-digest='LDAP'
</I>&gt;<i> CONFIGURE_OPTIONS += 
</I>&gt;<i> --enable-external-acl-helpers='file_userip,unix_group,LDAP_group,wbinfo_group'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-follow-x-forwarded-for
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-forward-log
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-forw-via-db
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-htcp
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-icmp
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-large-cache-files
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-multicast-miss
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-auth-negotiate='kerberos'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-auth-ntlm='smb_lm,fake'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-ntlm-fail-open
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-removal-policies='heap,lru'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-snmp
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-ssl
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-storeio='aufs,diskd,ufs'
</I>&gt;<i> CONFIGURE_OPTIONS += --enable-x-accelerator-vary
</I>&gt;<i> CONFIGURE_OPTIONS += --with-aio
</I>&gt;<i> CONFIGURE_OPTIONS += --with-aufs-threads=8
</I>&gt;<i> CONFIGURE_OPTIONS += --with-large-files
</I>&gt;<i> CONFIGURE_OPTIONS += --with-build-environment=POSIX_V6_ILP32_OFFBIG
</I>&gt;<i> CONFIGURE_OPTIONS += --with-pthreads
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Best,
</I>&gt;<i> Stacy Yeh
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004079.html">[squid-users] Squid 3.5.5 fails to build for Solaris
</A></li>
	<LI>Next message (by thread): <A HREF="004083.html">[squid-users] bypass proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4082">[ date ]</a>
              <a href="thread.html#4082">[ thread ]</a>
              <a href="subject.html#4082">[ subject ]</a>
              <a href="author.html#4082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
