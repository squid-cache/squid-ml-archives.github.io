<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Recommended Multi-CPU Configuration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Recommended%20Multi-CPU%20Configuration&In-Reply-To=%3C1343388597.644083624.1434647469665.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004101.html">
   <LINK REL="Next"  HREF="004088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Recommended Multi-CPU Configuration</H1>
    <B>FredB</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Recommended%20Multi-CPU%20Configuration&In-Reply-To=%3C1343388597.644083624.1434647469665.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E"
       TITLE="[squid-users] Recommended Multi-CPU Configuration">fredbmail at free.fr
       </A><BR>
    <I>Thu Jun 18 17:11:09 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004101.html">[squid-users] Recommended Multi-CPU Configuration
</A></li>
        <LI>Next message (by thread): <A HREF="004088.html">[squid-users] split horizon dns proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4107">[ date ]</a>
              <a href="thread.html#4107">[ thread ]</a>
              <a href="subject.html#4107">[ subject ]</a>
              <a href="author.html#4107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> 
</I>&gt;<i> Which one would be good for capacity\load? I have a very, very large
</I>&gt;<i> environment. I have 220,000 users on 8 Gig to the INTERNET. I am
</I>&gt;<i> running a load balancer, ipvsadm (Direct Routing) with 20 proxies
</I>&gt;<i> behind it. I am interested in handling load.
</I>&gt;<i> 
</I>&gt;<i> Michael
</I>&gt;<i> 
</I>&gt;<i> 
</I>
I'm working in a close environment + web filtering (e2guardian) - less bandwidth 
Before beginning be aware of SMP limitations, <A HREF="http://wiki.squid-cache.org/Features/SmpScale">http://wiki.squid-cache.org/Features/SmpScale</A> (look at &quot;What can workers share?&quot; )

I tried multi-CPU, to be honest not very recently, but the limitations were annoying for me and I encountered some issues with high load (crashes)

For the moment I can still manage with hardware over 5 years old, squid core reach 50 % of cpu usage with 700/900 request/s, diskd, basic + digest authentication, delay pool and caches 2 x 300 Go. The web filtering are using the other cores. 
The CPU usage was really reduced but without SMP I do not have any problem at all, I known no pain no gain but ...

My advice, more than CPU buy RAM to support thousand of users you will never have enough RAM ! (64 Go if you can) and really fast disks - dedicated to cache -

Also there are some little things that you can do to help you to improve your capacity, a squid restart each day, tuning the network, tuning the system, etc 

The bandwidth is a point, but the requests by second is THE point 

20 users can get some 4K videos on youtube your bandwidth is consumed but your load average still close to 0.0
20 users with a spyware (or something similar) can push hundreds of requests by seconds, in this case your bandwidth can still stable - with the cache - but your load average increases

It depends   

Fred    


 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004101.html">[squid-users] Recommended Multi-CPU Configuration
</A></li>
	<LI>Next message (by thread): <A HREF="004088.html">[squid-users] split horizon dns proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4107">[ date ]</a>
              <a href="thread.html#4107">[ thread ]</a>
              <a href="subject.html#4107">[ subject ]</a>
              <a href="author.html#4107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
