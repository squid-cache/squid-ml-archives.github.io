<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] acl for redirect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20for%20redirect&In-Reply-To=%3C558CE354.9000304%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004218.html">
   <LINK REL="Next"  HREF="004224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] acl for redirect</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20for%20redirect&In-Reply-To=%3C558CE354.9000304%40treenet.co.nz%3E"
       TITLE="[squid-users] acl for redirect">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jun 26 05:29:56 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004218.html">[squid-users] acl for redirect
</A></li>
        <LI>Next message (by thread): <A HREF="004224.html">[squid-users] acl for redirect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4223">[ date ]</a>
              <a href="thread.html#4223">[ thread ]</a>
              <a href="subject.html#4223">[ subject ]</a>
              <a href="author.html#4223">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 26/06/2015 2:36 a.m., Mike wrote:
&gt;<i> Amos, thanks for info.
</I>&gt;<i> 
</I>&gt;<i> The primary settings being used in squid.conf:
</I>&gt;<i> 
</I>&gt;<i> http_port 8080
</I>&gt;<i> # this port is what will be used for SSL Proxy on client browser
</I>&gt;<i> http_port 8081 intercept
</I>&gt;<i> 
</I>&gt;<i> https_port 8082 intercept ssl-bump connection-auth=off
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=16MB
</I>&gt;<i> cert=/etc/squid/ssl/squid.pem key=/etc/squid/ssl/squid.key
</I>&gt;<i> cipher=ECDHE-RSA-RC4-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:DHE-RSA-CAMELLIA128-SHA:AES128-SHA:RC4-SHA:HIGH:!aNULL:!MD5:!ADH
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> sslcrtd_program /usr/lib64/squid/ssl_crtd -s /var/lib/squid_ssl_db -M 16MB
</I>&gt;<i> sslcrtd_children 50 startup=5 idle=1
</I>&gt;<i> ssl_bump server-first all
</I>&gt;<i> ssl_bump none localhost
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Then e2guardian uses 10101 for the browsers, and uses 8080 for
</I>&gt;<i> connecting to squid on the same server.
</I>
Doesn;t matter. Due to TLS security requirements Squid ensures the TLS
connection in re-encrypted on outgoing.


I am doubtful eth nord works anymore since Googles own documentation for
schools states that one must install a MITM proxy that does the traffic
filtering - e2guardian is not one of those. IMO you should convert your
e2guardian config into Squid ACL rules that can be applied to the bumped
traffic without forcing <A HREF="http://">http://</A>

But if nord does work, so should the deny_info in Squid. Something like
this probably:

 acl google dstdomain .google.com
 deny_info 301:<A HREF="http://%H%R?nord=1">http://%H%R?nord=1</A> google

 acl GwithQuery urlpath_regex ?
 deny_info 301:<A HREF="http://%H%R&amp;nord=1">http://%H%R&amp;nord=1</A> GwithQuery

 http_access deny google Gquery
 http_access deny google


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004218.html">[squid-users] acl for redirect
</A></li>
	<LI>Next message (by thread): <A HREF="004224.html">[squid-users] acl for redirect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4223">[ date ]</a>
              <a href="thread.html#4223">[ thread ]</a>
              <a href="subject.html#4223">[ subject ]</a>
              <a href="author.html#4223">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
