<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Mikrotik and Squid Transparent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Mikrotik%20and%20Squid%20Transparent&In-Reply-To=%3CCAJ%2BQ1PVi0aQzwqj27K_Fmq7WdPQGvrgxnTkgi87%2BQx6xg%2BnxhA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004237.html">
   <LINK REL="Next"  HREF="004243.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Mikrotik and Squid Transparent</H1>
    <B>Alex Samad</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Mikrotik%20and%20Squid%20Transparent&In-Reply-To=%3CCAJ%2BQ1PVi0aQzwqj27K_Fmq7WdPQGvrgxnTkgi87%2BQx6xg%2BnxhA%40mail.gmail.com%3E"
       TITLE="[squid-users] Mikrotik and Squid Transparent">alex at samad.com.au
       </A><BR>
    <I>Fri Jun 26 22:02:44 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004237.html">[squid-users] Mikrotik and Squid Transparent
</A></li>
        <LI>Next message (by thread): <A HREF="004243.html">[squid-users] Mikrotik and Squid Transparent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4242">[ date ]</a>
              <a href="thread.html#4242">[ thread ]</a>
              <a href="subject.html#4242">[ subject ]</a>
              <a href="author.html#4242">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

Sorry missing something here.

I thought this was a mikrotek rtr , presumably acting as a default
gateway for the local lan to the internet.
it has a DNAT rule to capture all internet traffic that is port 80
(and presumably at some point in time port 443) and it DNATS it to the
SQUID box.

and there needs to be a special rule on the DGW to allow squid access
out to the internet with out resending it back to the squid and
creating a loop.

from memory thats how I used to do this. unless the DGW is large
enough to run squid, then DNAT to the local box and onto squid.

Why would there be a DoS for SQUID on another box, the only resources
I can think of is the NAT table, maybe conntrack

Alex



On 26 June 2015 at 22:49, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i> On 27/06/2015 12:14 a.m., Alex Samad wrote:
</I>&gt;&gt;<i> aren't squid and nat box different ? that was my presumption..
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Best not to.
</I>&gt;<i>
</I>&gt;<i> The dst-IP:port on the TCP packets entering the Squid machine is where
</I>&gt;<i> Squid will send the outgoing server requests. If that dst-IP is the IP
</I>&gt;<i> of the Squid machine itself you get into big DoS-level trouble really fast.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004237.html">[squid-users] Mikrotik and Squid Transparent
</A></li>
	<LI>Next message (by thread): <A HREF="004243.html">[squid-users] Mikrotik and Squid Transparent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4242">[ date ]</a>
              <a href="thread.html#4242">[ thread ]</a>
              <a href="subject.html#4242">[ subject ]</a>
              <a href="author.html#4242">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
