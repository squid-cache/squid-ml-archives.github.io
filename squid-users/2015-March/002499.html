<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20meet%20a%20problem%20%2C%0A%20---%20Unsupported%20Request%20Method%20and%20Protocol%27%27%20for%20such%20connections%0A%20%28%20non-HTTP%20connections%20%29%20based%2080%20port%20----%2C%20if%20possible%20%2C%0A%20please%20give%20me%20some%20advisement%20or%20help&In-Reply-To=%3C54F29BBB.5010505%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002498.html">
   <LINK REL="Next"  HREF="002503.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20meet%20a%20problem%20%2C%0A%20---%20Unsupported%20Request%20Method%20and%20Protocol%27%27%20for%20such%20connections%0A%20%28%20non-HTTP%20connections%20%29%20based%2080%20port%20----%2C%20if%20possible%20%2C%0A%20please%20give%20me%20some%20advisement%20or%20help&In-Reply-To=%3C54F29BBB.5010505%40treenet.co.nz%3E"
       TITLE="[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Mar  1 04:55:23 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002498.html">[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help
</A></li>
        <LI>Next message (by thread): <A HREF="002503.html">[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2499">[ date ]</a>
              <a href="thread.html#2499">[ thread ]</a>
              <a href="subject.html#2499">[ subject ]</a>
              <a href="author.html#2499">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/03/2015 4:46 p.m., johnzeng wrote:
&gt;<i> Hello  Eliezer:
</I>&gt;<i> 
</I>&gt;<i>                        Thanks for your reply ,  although squid 2.7
</I>&gt;<i> stables 9 don't support Tproxy really , but We realize the function via
</I>&gt;<i> patch third patch .
</I>&gt;<i> 
</I>&gt;<i>                        Why we meet the problem (  Unsupported Request
</I>&gt;<i> Method and Protocol ) ?  although some special application communicate
</I>&gt;<i> based 80 port ,
</I>&gt;<i> 
</I>&gt;<i>                        they don't use http protocol or they change http
</I>&gt;<i> protocol and method isn't GET OR POST . for example : QQ application and
</I>&gt;<i> some QQ game .
</I>

In Squid-2.7 you need to use the extension_methods directive to tell
Squid what non-HTTP/1.0 methods to accept.

Squid-3 accepts the full range of HTTP/1.1 and extension methods by
default with no configuration needed.


I seem to remember QQ application working through Squid-3 though, so it
should work after the upgrade. If not I would like to see a copy of what
the message protocol they use.


&gt;<i> 
</I>&gt;<i>                        But squid don't support other protocol except
</I>&gt;<i> normal http protocol  or don't support other method except GET .. of
</I>&gt;<i> http protocol , for example HEAD.
</I>&gt;<i> 
</I>&gt;<i>                        So if it's a transparent proxy , and you will
</I>&gt;<i> access these application , We have to face the problem .
</I>&gt;<i> 
</I>&gt;<i>                       Why i don't use highest version ago , include
</I>&gt;<i> squid 3.5.2 ,
</I>&gt;<i> 
</I>&gt;<i>                       because  squid 2.7 stable 9 can support coss for
</I>&gt;<i> small http object
</I>&gt;<i> 
</I>&gt;<i>                       and We don't confirm whether squid 3.5.2 can
</I>&gt;<i> support small http object via rock or coss .
</I>

COSS is obsolete. It was replaced by Rock storage format.

Squid has always been able to store small objects in various ways. The
type of cache storage formats available is not affecting that.



&gt;<i> 
</I>&gt;<i>                      i know these are some function (
</I>&gt;<i> on_unsupported_protocol ) in 3.HEAD and ,
</I>&gt;<i> 
</I>&gt;<i>                      it won't be very stable or we have to use
</I>&gt;<i> trunk-non-HTTP-bypass-v8.patch for squid 3.5.2
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Versions/v3/3.HEAD/cfgman/on_unsupported_protocol.html">http://www.squid-cache.org/Versions/v3/3.HEAD/cfgman/on_unsupported_protocol.html</A>
</I>&gt;<i> 
</I>

That feature change will not help you with this problem.

IF the method is just an HTTP/1.1 extension method, then the protocol is
HTTP/1.1 and *is* supported by Squid-3.2 and later.


IF, the application is being both abusive and broken by sending a
non-HTTP protocol Squid is rejecting abuse. Detecting and preventing
this type of network abuse is one of the major benefits of using a proxy
like Squid.

The QQ application (and others) are responsible for A) using their own
port suitable to the protocol they are sending, and/or B) accepting the
HTTP messages Squid returns to them on port 80.


Consider what would happen if you tried living underwater? does not work
if you stay the way you are right now. You have to have breathing
apparatus etc to make you compatible with the water environment.

Same goes for applications using the registered ports 0-1024 which have
specific protocols assigned to them. Applications need to understand and
use HTTP to use port 80.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002498.html">[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help
</A></li>
	<LI>Next message (by thread): <A HREF="002503.html">[squid-users] i meet a problem , --- Unsupported Request Method and Protocol'' for such connections ( non-HTTP connections ) based 80 port ----, if possible , please give me some advisement or help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2499">[ date ]</a>
              <a href="thread.html#2499">[ thread ]</a>
              <a href="subject.html#2499">[ subject ]</a>
              <a href="author.html#2499">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
