<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Redirecting traffic to fake parent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Redirecting%20traffic%20to%20fake%20parent&In-Reply-To=%3C54F66EAF.7070307%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002560.html">
   <LINK REL="Next"  HREF="002569.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Redirecting traffic to fake parent</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Redirecting%20traffic%20to%20fake%20parent&In-Reply-To=%3C54F66EAF.7070307%40treenet.co.nz%3E"
       TITLE="[squid-users] Redirecting traffic to fake parent">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Mar  4 02:32:15 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002560.html">[squid-users] Redirecting traffic to fake parent
</A></li>
        <LI>Next message (by thread): <A HREF="002569.html">[squid-users] Redirecting traffic to fake parent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2563">[ date ]</a>
              <a href="thread.html#2563">[ thread ]</a>
              <a href="subject.html#2563">[ subject ]</a>
              <a href="author.html#2563">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/03/2015 9:35 a.m., Sebastian Goicochea wrote:
&gt;<i> Hello everyone, I'm experimenting with cache_peer directive and node.js:
</I>&gt;<i> 
</I>&gt;<i> cache_peer 10.0.0.90 parent 8888 0 no-query no-digest proxy-only name=test
</I>&gt;<i> 
</I>&gt;<i> in that port I have a node.js Proxy receiveing connections in the same
</I>&gt;<i> host, it extracts some information I need and saves it to a DB, then
</I>&gt;<i> redirects Squid with a 302 response with some garbage added to the url.
</I>&gt;<i> I use that garbage to match an access list so I can prevent looping.
</I>&gt;<i> 
</I>&gt;<i> Squid is working in transparent mode, the problem I'm facing is that if
</I>&gt;<i> I don't configure a tcp_outgoing_address Squid does not reach port 8888
</I>&gt;<i> on localhost. If I set a tcp_outgoing_address Squid can reach
</I>&gt;<i> localhost:8888 but with his own IP address and I need it to be
</I>&gt;<i> transparent, I need the real client IP address.
</I>
Why? what is all this for?

HTTP is designed to operate just fine without forging client IPs on
proxy outgoing traffic. Some web applications are seriously broken, but
since its on your localhost you obviously are in a great position to fix
this one.


also, it sounds to me like you are using all this complex 4-party
interaction to replicate something that an ICAP/eCAP service does much
faster and simpler. Or perhapse you are trying to implement Squids
StoreID feature using layers of proxies.


&gt;<i> 
</I>&gt;<i> Is there a way to configure tcp_outgoing_address to use the client's IP
</I>&gt;<i> when fetching something?
</I>
No. You can only bind to IP addresses which have been assigned to the
machine Squid is running on. Lookup the &quot;triangular routing&quot; problem if
you want all the gory details.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002560.html">[squid-users] Redirecting traffic to fake parent
</A></li>
	<LI>Next message (by thread): <A HREF="002569.html">[squid-users] Redirecting traffic to fake parent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2563">[ date ]</a>
              <a href="thread.html#2563">[ thread ]</a>
              <a href="subject.html#2563">[ subject ]</a>
              <a href="author.html#2563">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
