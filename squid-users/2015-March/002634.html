<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid intercept config
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20intercept%20config&In-Reply-To=%3C54FAFC27.50909%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002633.html">
   <LINK REL="Next"  HREF="002635.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid intercept config</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20intercept%20config&In-Reply-To=%3C54FAFC27.50909%40treenet.co.nz%3E"
       TITLE="[squid-users] squid intercept config">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Mar  7 13:24:55 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002633.html">[squid-users] squid intercept config
</A></li>
        <LI>Next message (by thread): <A HREF="002635.html">[squid-users] squid intercept config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2634">[ date ]</a>
              <a href="thread.html#2634">[ thread ]</a>
              <a href="subject.html#2634">[ subject ]</a>
              <a href="author.html#2634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/03/2015 1:09 a.m., Monah Baki wrote:
&gt;<i> Forgot to paste my test.
</I>&gt;<i> 
</I>&gt;<i> Basically from my squid server:
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at ISN-PHC-CACHE</A>:/cache/squid/bin # ./squidclient -h www.cnn.com -H
</I>&gt;<i> 'Host: www.cnn.com\n' -p 80
</I>&gt;<i> HTTP/1.1 302 Found
</I>&gt;<i> Server: Varnish
</I>&gt;<i> Retry-After: 0
</I>&gt;<i> Content-Length: 0
</I>&gt;<i> Location: <A HREF="http://edition.cnn.com80">http://edition.cnn.com80</A>
</I>
Um, that redirect URL is invalid. This Varnish is outputting garbage.


However, this test result does prove that output traffic from your Squid
should be fine. The test connecting to your port 3128 should confirm
that by getting the same or very similar result for normal traffic.


So the problem is on the input. It could still be at the client end, or
in the NAT redirection.

One thing I've not seen clarified in the discussion is which machine the
NAT rules have been placed (Squid box? or router?). Sorry if I missed that.
 The NAT operation MUST be done on the Squid box or the local machines
NAT system tells it the client was connecting to connect to
itself/Squid:3129 (which is the forwarding loop).

The router looks liek a Cisco device, so it must do L2 routing
redirection or WCCP to deliver packets to the Squid machine without
having altered their IP:port details in any way.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002633.html">[squid-users] squid intercept config
</A></li>
	<LI>Next message (by thread): <A HREF="002635.html">[squid-users] squid intercept config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2634">[ date ]</a>
              <a href="thread.html#2634">[ thread ]</a>
              <a href="subject.html#2634">[ subject ]</a>
              <a href="author.html#2634">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
