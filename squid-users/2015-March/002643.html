<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Whether%20squid%203.5.2%20can%20support%20rock%20at%20wccp%20tproxy%0A%20environment%20really%20%3F&In-Reply-To=%3C54FD15D4.4030109%40yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002642.html">
   <LINK REL="Next"  HREF="002645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?</H1>
    <B>johnzeng</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Whether%20squid%203.5.2%20can%20support%20rock%20at%20wccp%20tproxy%0A%20environment%20really%20%3F&In-Reply-To=%3C54FD15D4.4030109%40yahoo.com%3E"
       TITLE="[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?">johnzeng2013 at yahoo.com
       </A><BR>
    <I>Mon Mar  9 03:39:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002642.html">[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?
</A></li>
        <LI>Next message (by thread): <A HREF="002645.html">[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2643">[ date ]</a>
              <a href="thread.html#2643">[ thread ]</a>
              <a href="subject.html#2643">[ subject ]</a>
              <a href="author.html#2643">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Hello Dear All :

I face a problem recently , When i config wccp ( tproxy ) environment (
via using squid 3.5.2 ) ,

if i disable cache_dir rock part ,and it will be success for wccp(
tproxy) , and enable cache_dir aufs

#cache_dir rock /accerater/webcache3/storage/rock1 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350

but if i enable cache_dir rock part ,and it will be failure for wccp(
tproxy) and enable cache_dir aufs

cache_dir rock /accerater/webcache3/storage/rock1 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350


Whether some of my config is error , if possible , please give me some
advisement


This is my config


thanks

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

coredump_dir /accerater/logs/webcache3/
unlinkd_program /accerater/webcache3/libexec/unlinkd
pid_filename /accerater/logs/webcache3/opmizer1/cache.pid


workers 2
cpu_affinity_map process_numbers=1,2 cores=1,3

cache_dir rock /accerater/webcache3/storage/rock1 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350
cache_dir rock /accerater/webcache3/storage/rock1 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350


if ${process_number} = 1

cache_swap_state /accerater/logs/webcache3/opmizer1_swap_log1
access_log stdio:/accerater/logs/webcache3/opmizer1_access.log squid
cache_log /accerater/logs/webcache3/opmizer1_cache.log
cache_store_log stdio:/accerater/logs/webcache3/opmizer1_store.log
url_rewrite_program /accerater/webcache3/media/mediatool/media2
store_id_program /accerater/webcache3/media/mediatool/media1
unique_hostname fast_opmizer1
snmp_port 3401

#cache_dir rock /accerater/webcache3/storage/rock1 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350

cache_dir aufs /accerater/webcache3/storage/aufs1/${process_number} 5200
16 64 min-size=262145

else

#endif


if ${process_number} = 2


cache_swap_state /accerater/logs/webcache3/opmizer2_swap_log
access_log stdio:/accerater/logs/webcache3/opmizer2_access.log squid
cache_log /accerater/logs/webcache3/opmizer2_cache.log
cache_store_log stdio:/accerater/logs/webcache3/opmizer2_store.log
url_rewrite_program /accerater/webcache3/media/mediatool/media4
store_id_program /accerater/webcache3/media/mediatool/media3
unique_hostname fast_opmizer2
snmp_port 3402

#cache_dir rock /accerater/webcache3/storage/rock2 2646 min-size=4096
max-size=262144 max-swap-rate=250 swap-timeout=350

cache_dir aufs /accerater/webcache3/storage/aufs1/${process_number} 5200
16 64 min-size=262145

endif

endif



http_port 127.0.0.1:3220
http_port 3221 tproxy

wccp_version 2
wccp2_router 192.168.2.1
wccp2_forwarding_method 1
wccp2_return_method 1
wccp2_assignment_method 1
wccp2_service dynamic 80
wccp2_service dynamic 90
wccp2_service_info 80 protocol=tcp flags=src_ip_hash priority=240 ports=80
wccp2_service_info 90 protocol=tcp flags=dst_ip_hash,ports_source
priority=240 ports=80

tcp_outgoing_address 192.168.2.2


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002642.html">[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?
</A></li>
	<LI>Next message (by thread): <A HREF="002645.html">[squid-users] Whether squid 3.5.2 can support rock at wccp tproxy environment really ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2643">[ date ]</a>
              <a href="thread.html#2643">[ thread ]</a>
              <a href="subject.html#2643">[ subject ]</a>
              <a href="author.html#2643">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
