<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] One Time Password with squid, exists?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20One%20Time%20Password%20with%20squid%2C%20exists%3F&In-Reply-To=%3C550101C7.2000908%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002707.html">
   <LINK REL="Next"  HREF="002710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] One Time Password with squid, exists?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20One%20Time%20Password%20with%20squid%2C%20exists%3F&In-Reply-To=%3C550101C7.2000908%40treenet.co.nz%3E"
       TITLE="[squid-users] One Time Password with squid, exists?">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 12 03:02:31 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002707.html">[squid-users] One Time Password with squid, exists?
</A></li>
        <LI>Next message (by thread): <A HREF="002710.html">[squid-users] One Time Password with squid, exists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2709">[ date ]</a>
              <a href="thread.html#2709">[ thread ]</a>
              <a href="subject.html#2709">[ subject ]</a>
              <a href="author.html#2709">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/03/2015 3:25 p.m., Eliezer Croitoru wrote:
&gt;<i> Thanks Amos,
</I>&gt;<i> 
</I>&gt;<i> So NTLM has &quot;two steps&quot; authentication which means that there is a basic
</I>&gt;<i> negotiation over the http connection to the proxy which makes it less
</I>&gt;<i> secure then kerberos.
</I>&gt;<i> 
</I>&gt;<i> (speculating)
</I>&gt;<i> The main reason it's less secure then kerberos is that every part of the
</I>&gt;<i> password negotiation steps is being done in the same channel that the
</I>&gt;<i> proxy is being contacted and there for cannot apply a third party
</I>&gt;<i> &quot;verification&quot; for the authenticity of any of the tokens.
</I>&gt;<i> As a matter of fact NTLM http proxy authentication may be intercepted
</I>&gt;<i> and can do lots of bad things to the connections.
</I>
No, quite. The main reason is that NTLM (without NTLMv2 extensions)
contains silent downgrade to several LM protocol versions that either
send the password in username:password form or only encode it with a
8-bit hash that can be decoded as easily as base64 Basic auth. NTLMv1
does that whenever the client/attacker wants it to. NTLMv2 is better,
but still has relatively easily decrypted keys and the interception
problem you are aware of.

The Squid SMB_LM helpers work by using that LM weakness. Which is why
they dont work with Windows systems newer than 2006 when MS started
removing NTLMv1 support at the code level.

&gt;<i> 
</I>&gt;<i> I will try to read more about Digest authentication to make sure I will
</I>&gt;<i> not create something when it's not needed.
</I>&gt;<i> 
</I>&gt;<i> But in any case that there is an option to make the proxy to client
</I>&gt;<i> connection one level more secure then plain http proxy port it should be
</I>&gt;<i> considered better, right?
</I>
Perhapse. It depends on whether that step-up is actually better. There
are a lot of attempts and possible ways to do it that leave people worse
off than where they started (ie the LM issues).

The most secure authentication I've seen so far was simply Basic auth
with a per-message client PKI key exchange in the username:password
fields and server response encrypted using the provided key. Thats a bit
over the top for most uses though, it require a lot of CPU time at both
ends and ability to create many keys fast.


PS. I also have that experimental branch containing OAuth 2.0 Bearer
implementation for Squid which can simplify things at least for Squids part.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002707.html">[squid-users] One Time Password with squid, exists?
</A></li>
	<LI>Next message (by thread): <A HREF="002710.html">[squid-users] One Time Password with squid, exists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2709">[ date ]</a>
              <a href="thread.html#2709">[ thread ]</a>
              <a href="subject.html#2709">[ subject ]</a>
              <a href="author.html#2709">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
