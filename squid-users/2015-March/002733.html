<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20%22internal%3F%22%20loop%20-%20with%20no%20firewall%20nat%0A%20going%20on..%3F&In-Reply-To=%3C55018123.3010607%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002727.html">
   <LINK REL="Next"  HREF="002735.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20%22internal%3F%22%20loop%20-%20with%20no%20firewall%20nat%0A%20going%20on..%3F&In-Reply-To=%3C55018123.3010607%40treenet.co.nz%3E"
       TITLE="[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 12 12:05:55 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002727.html">[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?
</A></li>
        <LI>Next message (by thread): <A HREF="002735.html">[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2733">[ date ]</a>
              <a href="thread.html#2733">[ thread ]</a>
              <a href="subject.html#2733">[ subject ]</a>
              <a href="author.html#2733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/03/2015 12:27 a.m., Klavs Klavsen wrote:
&gt;<i> Klavs Klavsen wrote on 03/12/2015 12:15 PM:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> the routing example didn't seem to work :(
</I>&gt;&gt;<i>
</I>&gt;<i> As I understand it.. I can't use DNAT on client machine to get packages
</I>&gt;<i> to squid box.. and since it's locally generated packages(ie. I want to
</I>&gt;<i> capture on the clients - instead of capturing on their default gateway),
</I>&gt;<i> the packages only traverse POSTROUTING and OUTPUT..
</I>&gt;<i> 
</I>&gt;<i> any hints appreciated :)
</I>&gt;<i> 
</I>
You can either, set the clients default gateway to be the Squid machine
which just forwards non-HTTP packets on to the actual gateway router
which is set as Squid machines default gateway.

Or, add policy routing into the gateway router diverting just the port
80 traffic from the real clients (but excluding the Squid machine) to
the Squid machine as its upstream router.

In both those cases both the normal gateway and the Squid machine are
configured as routers with the Squid machine using the real gateway as
its default gateway.

Or, you can run Squid on the main gateway router - provided it has
enough memory for what you want it doing.

You can also physically plug the Squid machine into the network path as
a router before the main gateway router. This is same as the first
option but hard-wired as well as configured.


Capture wont work on client devices because Squid cant make system calls
directly into their remote machines kernel / NAT driver. You end up with
wrong IPs know to Squid and those loops.

So, pick one of the two above options and lets see why the routing is
&quot;not working&quot;.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002727.html">[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?
</A></li>
	<LI>Next message (by thread): <A HREF="002735.html">[squid-users] squid &quot;internal?&quot; loop - with no firewall nat going on..?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2733">[ date ]</a>
              <a href="thread.html#2733">[ thread ]</a>
              <a href="subject.html#2733">[ subject ]</a>
              <a href="author.html#2733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
