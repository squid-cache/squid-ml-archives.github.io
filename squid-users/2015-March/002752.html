<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl_bump for specific dstdomain
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_bump%20for%20specific%20dstdomain&In-Reply-To=%3C5502A807.6080700%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002749.html">
   <LINK REL="Next"  HREF="002962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl_bump for specific dstdomain</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_bump%20for%20specific%20dstdomain&In-Reply-To=%3C5502A807.6080700%40treenet.co.nz%3E"
       TITLE="[squid-users] ssl_bump for specific dstdomain">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Mar 13 09:04:07 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002749.html">[squid-users] ssl_bump for specific dstdomain
</A></li>
        <LI>Next message (by thread): <A HREF="002962.html">[squid-users] ssl_bump for specific dstdomain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2752">[ date ]</a>
              <a href="thread.html#2752">[ thread ]</a>
              <a href="subject.html#2752">[ subject ]</a>
              <a href="author.html#2752">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/03/2015 6:39 p.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 13.03.15 2:37, Mukul Gandhi &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> On Thu, Mar 12, 2015 at 11:04 AM, Yuri Voinov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; 
</I>&gt;&gt;<i> wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> You only have external helper (which is must wrote yourself) in 
</I>&gt;&gt;<i> 3.4.x.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> Are there any examples that I can look at to implemented this 
</I>&gt;&gt;&gt;<i> external helper for doing selective ssl_bumps. And what would 
</I>&gt;&gt;&gt;<i> this helper script do anyways? All we have is the destination IP 
</I>&gt;&gt;&gt;<i> address which is not really going to give us the actual HTTP 
</I>&gt;&gt;&gt;<i> hostname.
</I>&gt;<i> Yes and no. There is one third-party helper in list archives, written
</I>&gt;<i> on python. No one of this including in squid distribution.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> Works with domains in ssl bump fully available at least 3.5.x
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> Does the 3.5.x implementation decrypt the whole payload and then 
</I>&gt;&gt;&gt;<i> do the ssl_bump? The &quot;peek&quot; option seems to imply that only the 
</I>&gt;&gt;&gt;<i> HTTP headers are peeked at.
</I>&gt;<i> Of course. As by 3.4.x. The difference is only with mechanisms.
</I>
And no at the same time. HTTP message headers inside the encryption are
encrypted and unavailable until after the decryption is decided (bumped).

What gets peeked at is the TLS ClientHello and TLS ServerHello details.
SNI may become available by peeking when raw-IP was all that was in the
HTTP CONNECT message or intercepted TCP packets.

You can then use those non-private TLS details to decide between reject,
splice (pass-thru) or bump (decrypt) for the encrypted HTTPS data.


&gt;<i> 
</I>&gt;&gt;&gt;<i> I guess what I am asking is, is there any way we can do this 
</I>&gt;&gt;&gt;<i> without actually decrypting the payload?
</I>&gt;<i> 3.5.x peek-and-splise functionality do bump splitted by stages.
</I>&gt;<i> Against 3.4.x, which is makes bump in one stage.
</I>&gt;<i> 
</I>
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002749.html">[squid-users] ssl_bump for specific dstdomain
</A></li>
	<LI>Next message (by thread): <A HREF="002962.html">[squid-users] ssl_bump for specific dstdomain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2752">[ date ]</a>
              <a href="thread.html#2752">[ thread ]</a>
              <a href="subject.html#2752">[ subject ]</a>
              <a href="author.html#2752">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
