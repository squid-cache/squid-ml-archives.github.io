<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Server-first SSL bump in Squid 3.5.x
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Server-first%20SSL%20bump%20in%20Squid%203.5.x&In-Reply-To=%3C550A6A4F.9050409%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002864.html">
   <LINK REL="Next"  HREF="002866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Server-first SSL bump in Squid 3.5.x</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Server-first%20SSL%20bump%20in%20Squid%203.5.x&In-Reply-To=%3C550A6A4F.9050409%40treenet.co.nz%3E"
       TITLE="[squid-users] Server-first SSL bump in Squid 3.5.x">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 19 06:18:55 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002864.html">[squid-users] Server-first SSL bump in Squid 3.5.x
</A></li>
        <LI>Next message (by thread): <A HREF="002866.html">[squid-users] Server-first SSL bump in Squid 3.5.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2865">[ date ]</a>
              <a href="thread.html#2865">[ thread ]</a>
              <a href="subject.html#2865">[ subject ]</a>
              <a href="author.html#2865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/03/2015 6:36 p.m., Dan Charlesworth wrote:
&gt;<i> Hey y&#8217;all
</I>&gt;<i> 
</I>&gt;<i> Finally got 3.5.2 running. I was under the impression that using server-first SSL bump would still be compatible, despite all the Peek &amp; Splice changes, but apparently not. Hopefully someone can explain what might be going wrong here ...
</I>&gt;<i> 
</I>
Sadly &quot;being compatible&quot; with an broken design does not mean &quot;working&quot;.
server-first only works nicely if the client, Squid, and server are
operating with the same TLS features - which is uncommon.


&gt;<i> Using the same SSL Bump config that we used for 3.4, we now seeing this happen:
</I>&gt;<i> 19/Mar/2015-16:21:32     22 d4:f4:6f:71:90:e6 10.0.1.71 TCP_DENIED 200 0 CONNECT 94.31.29.230:443 - server-first - HIER_NONE/- - -
</I>&gt;<i> 
</I>
The CONNECT request in the clear-text HTTP layer is now subject to
access controls before any bumping takes place. Earlier Squid would let
the CONNECT through if you were bumping, even if it would have been
blocked by your access controls normally.

This is unrelated to server-first or any other ssl_bump action.

&gt;<i> Instead of this:
</I>&gt;<i> 19/Mar/2015-14:42:04    736 d4:f4:6f:71:90:e6 10.0.1.71 TCP_MISS 200 96913 GET <A HREF="https://code.jquery.com/jquery-1.11.0.min.js">https://code.jquery.com/jquery-1.11.0.min.js</A> - server-first Mozilla/5.0%20(iPhone;%20CPU%20iPhone%20OS%208_2%20like%20Mac%20OS%20X)%20AppleWebKit/600.1.4%20(KHTML,%20like%20Gecko)%20Mobile/12D508 ORIGINAL_DST/94.31.29.53 application/x-javascript -
</I>&gt;<i> 
</I>
That is a different HTTP message from inside the encryption.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002864.html">[squid-users] Server-first SSL bump in Squid 3.5.x
</A></li>
	<LI>Next message (by thread): <A HREF="002866.html">[squid-users] Server-first SSL bump in Squid 3.5.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2865">[ date ]</a>
              <a href="thread.html#2865">[ thread ]</a>
              <a href="subject.html#2865">[ subject ]</a>
              <a href="author.html#2865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
