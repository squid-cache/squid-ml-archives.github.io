<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid not responding during file upload.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20not%20responding%20during%20file%20upload.&In-Reply-To=%3C550A962A.6070707%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002867.html">
   <LINK REL="Next"  HREF="002875.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid not responding during file upload.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20not%20responding%20during%20file%20upload.&In-Reply-To=%3C550A962A.6070707%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid not responding during file upload.">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 19 09:26:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002867.html">[squid-users] Squid not responding during file upload.
</A></li>
        <LI>Next message (by thread): <A HREF="002875.html">[squid-users] Squid not responding during file upload.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2872">[ date ]</a>
              <a href="thread.html#2872">[ thread ]</a>
              <a href="subject.html#2872">[ subject ]</a>
              <a href="author.html#2872">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/03/2015 8:11 p.m., Saravanan Coimbatore wrote:
&gt;<i> Hello all, 
</I>&gt;<i> 
</I>&gt;<i> I am using Squid 3.4 to inspect content that heads out to the cloud from enterprise. I have two c-icap filter that does the content inspection. 
</I>&gt;<i> 
</I>&gt;<i> Observation: 
</I>&gt;<i> - Upload 3000 1M files to cloud passes through successfully. 
</I>&gt;<i> - Upload 300 40M files to cloud results in multiple failures. Some of errors: 400 Bad Request, Request Timed out.. 
</I>&gt;<i> 
</I>&gt;<i> Tcpdump of the 40MB file upload tests indicate the following:
</I>&gt;<i> - Boto client used to upload sends packet to squid proxy. 
</I>
 Squid on receiving requests sends them to the ICAP REQMOD service,
   and waits for its response,
 then sends the ICAP REQMOD result to the origin server,
   and waits for its response,
 then sends that to the ICAP RESPMOD service,
   and waits for its response,
 then sends that to the client.

So...
 What is the ICAP service and the origin server doing?


&gt;<i> - Proxy does not acknowledge. 
</I>
What type of &quot;acknowledge&quot; are you expecting here? HTTP or TCP level?

&gt;<i> - Client sends the data again at least 6 times, Squid does not respond. 
</I>
At TCP or HTTP layer?

&gt;<i> - After 20-25 seconds of this (where Squid did not send any data to cloud), Cloud storage vendor returns a &quot;BAD Request&quot; response. 
</I>&gt;<i> 
</I>&gt;<i> Uploading 300 files seems to be a load that should be manageable by Squid. Can anyone guide me on how to optimize Squid for the above scenario? Are there any performance parameters that I can tweak so Squid handles this correctly?
</I>&gt;<i> 
</I>

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002867.html">[squid-users] Squid not responding during file upload.
</A></li>
	<LI>Next message (by thread): <A HREF="002875.html">[squid-users] Squid not responding during file upload.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2872">[ date ]</a>
              <a href="thread.html#2872">[ thread ]</a>
              <a href="subject.html#2872">[ subject ]</a>
              <a href="author.html#2872">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
