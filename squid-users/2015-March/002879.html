<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20client_side.cc%3A1515%3A%0A%09%22connIsUsable%28http-%3EgetConn%28%29%29&In-Reply-To=%3CC344A272-1AE8-4EE9-B474-54FB73A7998B%40getbusi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002540.html">
   <LINK REL="Next"  HREF="002887.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())</H1>
    <B>Dan Charlesworth</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20client_side.cc%3A1515%3A%0A%09%22connIsUsable%28http-%3EgetConn%28%29%29&In-Reply-To=%3CC344A272-1AE8-4EE9-B474-54FB73A7998B%40getbusi.com%3E"
       TITLE="[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())">dan at getbusi.com
       </A><BR>
    <I>Fri Mar 20 00:07:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002540.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
        <LI>Next message (by thread): <A HREF="002887.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2879">[ date ]</a>
              <a href="thread.html#2879">[ thread ]</a>
              <a href="subject.html#2879">[ subject ]</a>
              <a href="author.html#2879">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Well I got 3.5.2 into production for a few hours and Bad Things happened:

1) A hefty performance hit
Load average was maybe a tad higher but CPU. memory and I/O were about the same. However the system seemed to top out at around 40 requests per second (on a client that usually hits 100&#8212;150 rps) and squid became very slow to respond to squidclient requests:
[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy-LS5</A> ~]# time squidclient -p 8080 mgr:utilization | grep client_http.requests
client_http.requests = 40.965955/sec
client_http.requests = 41.168528/sec
client_http.requests = 42.111847/sec
client_http.requests = 166646

real	0m7.163s
user	0m0.002s
sys	0m0.006s

2) Lots of Segment Violations
These obviously suck. Backtrace attached.

Just cannot win. Is it possible these two issues are due to the patch for #4206?


&gt;<i> On 16 Mar 2015, at 6:18 pm, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On 16/03/2015 7:16 p.m., Dan Charlesworth wrote:
</I>&gt;&gt;<i> Hey again Amos -
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Unfortunately the patch for #4206 won&#8217;t apply to squid-3.4.12. I was going to try creating a new one but couldn&#8217;t find an equivalent line in client_side.cc for that version.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I guess the #4206 issue doesn&#8217;t apply to v3.4.x after all?
</I>&gt;<i> 
</I>&gt;<i> Correct. Oh well.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> [Not a C programmer]
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks for your time today.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> P.S. I'd love to upgrade to v3.5 but I'm waiting for somebody smarter than me to take the lead on a CentOS 6 RPM SPEC file.
</I>&gt;<i> 
</I>&gt;<i> Eliezer to the rescue ;-)
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/KnowledgeBase/CentOS#Squid-3.5">http://wiki.squid-cache.org/KnowledgeBase/CentOS#Squid-3.5</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment.htm</A>&gt;
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 352-segment-violation.txt
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment.txt">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment.txt</A>&gt;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment-0001.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150320/23f8693a/attachment-0001.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002540.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
	<LI>Next message (by thread): <A HREF="002887.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2879">[ date ]</a>
              <a href="thread.html#2879">[ thread ]</a>
              <a href="subject.html#2879">[ subject ]</a>
              <a href="author.html#2879">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
