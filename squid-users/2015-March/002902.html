<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20client_side.cc%3A1515%3A%0A%09%22connIsUsable%28http-%3EgetConn%28%29%29&In-Reply-To=%3C550BCC16.3040103%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002893.html">
   <LINK REL="Next"  HREF="002937.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20client_side.cc%3A1515%3A%0A%09%22connIsUsable%28http-%3EgetConn%28%29%29&In-Reply-To=%3C550BCC16.3040103%40treenet.co.nz%3E"
       TITLE="[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Mar 20 07:28:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002893.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
        <LI>Next message (by thread): <A HREF="002937.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2902">[ date ]</a>
              <a href="thread.html#2902">[ thread ]</a>
              <a href="subject.html#2902">[ subject ]</a>
              <a href="author.html#2902">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/03/2015 1:07 p.m., Dan Charlesworth wrote:
&gt;<i> Well I got 3.5.2 into production for a few hours and Bad Things happened:
</I>&gt;<i> 
</I>&gt;<i> *1) A hefty performance hit*
</I>&gt;<i> Load average was maybe a tad higher but CPU. memory and I/O were about the same. 
</I>&gt;<i> However the system seemed to top out at around 40 requests per second (on a 
</I>&gt;<i> client that usually hits 100&#8212;150 rps) and squid became very slow to respond to 
</I>&gt;<i> squidclient requests:
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy-LS5</A> ~]# time squidclient -p 8080 mgr:utilization | grep 
</I>&gt;<i> client_http.requests
</I>&gt;<i> client_http.requests = 40.965955/sec
</I>&gt;<i> client_http.requests = 41.168528/sec
</I>&gt;<i> client_http.requests = 42.111847/sec
</I>&gt;<i> client_http.requests = 166646
</I>&gt;<i> 
</I>&gt;<i> real0m7.163s
</I>&gt;<i> user0m0.002s
</I>&gt;<i> sys0m0.006s
</I>&gt;<i> 
</I>&gt;<i> *2) Lots of Segment Violations*
</I>&gt;<i> These obviously suck. Backtrace attached.
</I>
Still with symbols erased so I cant see what is going on :-(

(&quot;HackXBack&quot; is having a very similar set of issues, but on different
traffic)

&gt;<i> 
</I>&gt;<i> Just cannot win. Is it possible these two issues are due to the patch for #4206?
</I>&gt;<i> 
</I>
Doubtful, 4206 patch was only affecting the tunnel.cc code handling for
CONNECT payloads. Your assertion is in client_side.cc

FWIW, the sponsor of that patch is happily running a 3.5.2 snapshot in a
very busy production system (~975 RPS at peak) with no problems reported
to me since it went live.
 We did find and fix a few of the other bugs that are patched in the
snapshot to get it to that state though. So if you are having problems
with the basic 3.5.2 bundle the latest snapshot may be worth a try as well.
There are also some patches in squid-4 that I'm due to be backporting in
the next few hrs related to worker security permissions (being denied
when they should be allowed), and PID fiel issues

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002893.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
	<LI>Next message (by thread): <A HREF="002937.html">[squid-users] assertion failed: client_side.cc:1515:	&quot;connIsUsable(http-&gt;getConn())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2902">[ date ]</a>
              <a href="thread.html#2902">[ thread ]</a>
              <a href="subject.html#2902">[ subject ]</a>
              <a href="author.html#2902">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
