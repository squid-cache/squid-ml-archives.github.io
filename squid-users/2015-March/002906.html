<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] i want to block images with size more than 40 KB
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20want%20to%20block%20images%20with%20size%20more%20than%2040%20KB&In-Reply-To=%3C000101d06363%245f9fba80%241edf2f80%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002935.html">
   <LINK REL="Next"  HREF="002907.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] i want to block images with size more than 40 KB</H1>
    <B>snakeeyes</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20want%20to%20block%20images%20with%20size%20more%20than%2040%20KB&In-Reply-To=%3C000101d06363%245f9fba80%241edf2f80%24%40netstream.ps%3E"
       TITLE="[squid-users] i want to block images with size more than 40 KB">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Fri Mar 20 23:12:44 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002935.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
        <LI>Next message (by thread): <A HREF="002907.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2906">[ date ]</a>
              <a href="thread.html#2906">[ thread ]</a>
              <a href="subject.html#2906">[ subject ]</a>
              <a href="author.html#2906">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I did try with google.com and yahoo.com

It seems not blocking images there 

Can u help with that plz ?

-----Original Message-----
From: snakeeyes [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ahmed.zaeem at netstream.ps</A>] 
Sent: Friday, March 20, 2015 4:06 PM
To: 'Amos Jeffries'
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: RE: [squid-users] i want to block images with size more than 40 KB

Hi amos , thanks for reply
I have tried @ top of squidf.conf

acl images rep_header Content-Type ^image/ ^x-image/ acl small rep_header Content-Length ^[1234]?[0-9]$ http_reply_access deny small images

are you sure that its blocking images with size &gt;40KB ????
also I didn&#8217;t see extensions like jpg or bmp or similar like that ??!!

I have used many several sites , its being all allowed Can you  advise ?




regards

-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Wednesday, March 18, 2015 9:41 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] i want to block images with size more than 40 KB

On 19/03/2015 1:35 p.m., snakeeyes wrote:
&gt;<i> Thank you so much  Amos and leonardo
</I>&gt;<i> Can you provide me any sample config to start with ?
</I>&gt;<i> I feel it so difficult to me .
</I>&gt;<i> I had a look @ &quot;&quot;ACL elements&quot;&quot; section in thw wiki about matching size of image but didn&#8217;t find clear thing.
</I>&gt;<i> So again I feel that I will create access list that match size &gt; than 50 Byte and with mime type like jpg or bmp and then deny it.
</I>&gt;<i> 
</I>&gt;<i> Could you help me with startup config plz ?
</I>
You mean hand over a cut-n-paste example that you can use and when things go wrong not understand how to fix?

Sure:
 acl images rep_header Content-Type ^image/ ^x-image/  acl small rep_header Content-Length ^[1234]?[0-9]$  http_reply_access deny small images


BUT like Leonardo said, censoring the Internet not as easy as all that.

* Images come in *many* data formats (Content-Type values), some of which are shared with other non-image things - like octet-stream which literally means &quot;unknown binary data&quot;. They can come embedded inside other objects, JSON, CSS, archive files (like zip / gzip / xz / ar /
cab) ... even plain old HTML can have base64 blobs of image data in them which gets decoded by a script... and so on.

For every point of censorship there is a bypass.

* The Content-Length is also not guaranteed to be existing. The object may be of undefined length streamed in small chunks or as a blob with no size known until the end of the transaction.


What it comes down to is that you need to know exactly what you are looking for in the protocol, and use the appropriate ACL types to match with. Which in turn requires knowing what ACLs you have available and how to use them to construct *_access rules matching your needs.


When you do have to make abnormal things happen be as precise and specific as you can. Every bit of fuzz/approximation *will* cause trouble at some point during production traffic.


So, why are you doing this?

Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002935.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
	<LI>Next message (by thread): <A HREF="002907.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2906">[ date ]</a>
              <a href="thread.html#2906">[ thread ]</a>
              <a href="subject.html#2906">[ subject ]</a>
              <a href="author.html#2906">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
