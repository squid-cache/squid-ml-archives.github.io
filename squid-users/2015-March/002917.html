<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] i want to block images with size more than 40 KB
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20want%20to%20block%20images%20with%20size%20more%20than%2040%20KB&In-Reply-To=%3C001a01d06394%248c26ff60%24a474fe20%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002912.html">
   <LINK REL="Next"  HREF="002918.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] i want to block images with size more than 40 KB</H1>
    <B>snakeeyes</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20i%20want%20to%20block%20images%20with%20size%20more%20than%2040%20KB&In-Reply-To=%3C001a01d06394%248c26ff60%24a474fe20%24%40netstream.ps%3E"
       TITLE="[squid-users] i want to block images with size more than 40 KB">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Sat Mar 21 05:04:44 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002912.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
        <LI>Next message (by thread): <A HREF="002918.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2917">[ date ]</a>
              <a href="thread.html#2917">[ thread ]</a>
              <a href="subject.html#2917">[ subject ]</a>
              <a href="author.html#2917">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Amos , thanks  it seems okay for normal http sites

I want to ask , is there a trick can we do it so that it be applied to google &amp; yahoo images search ??

Here is wt I see in yahoo logs , just small logs and all images are allowed and not blocked
=====

1426881748.078  70740 x.70 TCP_MISS/200 11790 CONNECT js.dmtry.com:443 - DIRECT/184.170.128.58 -
1426881749.077    103 xx.70 TCP_MISS/200 2228 POST <A HREF="http://sd.symcd.com/">http://sd.symcd.com/</A> - DIRECT/23.9.123.27 application/ocsp-response
1426881749.752     29 xx.70 TCP_MISS/200 2228 POST <A HREF="http://sd.symcd.com/">http://sd.symcd.com/</A> - DIRECT/23.9.123.27 application/ocsp-response
1426881750.098     21 xx.70 TCP_MISS/200 393 GET <A HREF="http://ping.chartbeat.net/ping?">http://ping.chartbeat.net/ping?</A> - DIRECT/23.21.149.132 image/gif
1426881750.731  62443 xx.70 TCP_MISS/200 122185 CONNECT www.gstatic.com:443 - DIRECT/206.126.112.185 -
1426881751.476   xx.70 TCP_MISS/200 4191 CONNECT secure.footprint.net:443 - DIRECT/8.12.219.125 -
1426881752.215    505 xxx.70 TCP_MISS/200 459 CONNECT secure.footprint.net:443 - DIRECT/8.12.219.125 -
1426881753.005   1091 xx.70 TCP_MISS/200 5303 CONNECT av.beap.bc.yahoo.com:443 - DIRECT/76.13.28.21 -
1426881762.280  12994 188.161.107.70 TCP_MISS/200 5502 CONNECT d.adgear.com:443 - DIRECT/205.204.71.140 -
1426881764.215  16497 xx70 TCP_MISS/200 9832 CONNECT ads.yahoo.com:443 - DIRECT/98.139.225.43 -
1426881764.216  16453 x.70 TCP_MISS/200 6534 CONNECT ads.yahoo.com:443 - DIRECT/98.139.225.43 -
1426881765.044  18777 x.70 TCP_MISS/200 11132 CONNECT ads.yahoo.com:443 - DIRECT/98.139.225.43 -
1426881765.681  15193 xx.107.70 TCP_MISS/200 6225 CONNECT comet.yahoo.com:443 - DIRECT/72.30.196.161 -
1426881765.691  14149 xx.107.70 TCP_MISS/200 832 CONNECT comet.yahoo.com:443 - DIRECT/72.30.196.161 -
1426881766.046 116219 xx.70 TCP_MISS/200 529 CONNECT d31qbv1cthcecs.cloudfront.net:443 - DIRECT/54.230.16.189 -
1426881766.714    296 xx.70 TCP_MISS/200 2228 POST <A HREF="http://ocsp.verisign.com/">http://ocsp.verisign.com/</A> - DIRECT/23.9.123.27 application/ocsp-response
1426881770.049 117609 xx107.70 TCP_MISS/200 711 CONNECT d5nxst8fruw4z.cloudfront.net:443 - DIRECT/54.240.160.97 -
1426881780.403  67786 xx.70 TCP_MISS/200 852 CONNECT www.yahoo.com:443 - DIRECT/98.139.180.149 -
1426881781.519    353 xx.70 TCP_MISS/200 571 GET <A HREF="http://data.cnn.com/jsonp/breaking_news/domestic.json?">http://data.cnn.com/jsonp/breaking_news/domestic.json?</A> - DIRECT/157.166.249.67 application/javascript
1426881782.057 118788 xx.70 TCP_MISS/200 19972 CONNECT cdn2sitescout-a.akamaihd.net:443 - DIRECT/23.15.4.18 -
1426881790.558  71055 xx TCP_MISS/200 26805 CONNECT s.yimg.com:443 - DIRECT/206.190.56.191 -
1426881814.445 100461 xx TCP_MISS/200 124129 CONNECT ca.yahoo.com:443 - DIRECT/98.139.180.149 -
1426881818.437  70709 xx70 TCP_MISS/200 8503 CONNECT beap-bc.yahoo.com:443 - DIRECT/206.190.57.60 -


regards

-----Original Message-----
From: Amos Jeffries [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>] 
Sent: Friday, March 20, 2015 9:56 AM
To: snakeeyes
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] i want to block images with size more than 40 KB

On 21/03/2015 12:05 p.m., snakeeyes wrote:
&gt;<i> Hi amos , thanks for reply
</I>&gt;<i> I have tried @ top of squidf.conf
</I>&gt;<i> 
</I>&gt;<i> acl images rep_header Content-Type ^image/ ^x-image/ acl small 
</I>&gt;<i> rep_header Content-Length ^[1234]?[0-9]$ http_reply_access deny small 
</I>&gt;<i> images
</I>&gt;<i> 
</I>&gt;<i> are you sure that its blocking images with size &gt;40KB ????
</I>
Sorry I slightly mis-read your request. What I gave is blocking images
*smaller* than 40 bytes (see what I mean about cut-n-paste without understanding?).

To block images *over* 40 bytes change that to:
 http_reply_access deny !small images


&gt;<i> also I didn&#8217;t see extensions like jpg or bmp or similar like that ??!!
</I>
Because HTTP does not transfer files. It transfers data. Sometimes data can *also* be found inside &quot;files&quot;, sometimes not.

HTTP Content-Type header describes what format the data is. In this case you requested images in general, so thats the pattern I gave.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002912.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
	<LI>Next message (by thread): <A HREF="002918.html">[squid-users] i want to block images with size more than 40 KB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2917">[ date ]</a>
              <a href="thread.html#2917">[ thread ]</a>
              <a href="subject.html#2917">[ subject ]</a>
              <a href="author.html#2917">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
