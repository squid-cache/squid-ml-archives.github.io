<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.2 ssl_crtd kids causing abnormal	termination of startup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.2%20ssl_crtd%20kids%20causing%20abnormal%0A%09termination%20of%20startup&In-Reply-To=%3CCANLNtGQWYObuYo1piJNyE92Js48aQGkdHMsQ7Ec3Wnb%2BXWB-9w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002964.html">
   <LINK REL="Next"  HREF="002973.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.2 ssl_crtd kids causing abnormal	termination of startup</H1>
    <B>Stanford Prescott</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.2%20ssl_crtd%20kids%20causing%20abnormal%0A%09termination%20of%20startup&In-Reply-To=%3CCANLNtGQWYObuYo1piJNyE92Js48aQGkdHMsQ7Ec3Wnb%2BXWB-9w%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid 3.5.2 ssl_crtd kids causing abnormal	termination of startup">stan.prescott at gmail.com
       </A><BR>
    <I>Sun Mar 29 15:15:18 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="002964.html">[squid-users] Squid behaviour with external_acl_type
</A></li>
        <LI>Next message (by thread): <A HREF="002973.html">[squid-users] Squid 3.5.2 ssl_crtd kids causing abnormal termination of startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2970">[ date ]</a>
              <a href="thread.html#2970">[ thread ]</a>
              <a href="subject.html#2970">[ subject ]</a>
              <a href="author.html#2970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm still pulling my hair out trying to figure out why Squid 3.5.2 with SSL
caching enabled will only start after the /var/spool/squid/cache is
emptied. This is the debug info I am getting when starting Squid when the
cache is not emptied.

*2015/03/29 10:27:56.896| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.900| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.900| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.900| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.900| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56 kid1| Current Directory is /*
*2015/03/29 10:27:56 kid1| Creating missing swap directories*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache exists*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/00 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/00*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/01 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/01*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/02 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/02*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/03 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/03*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/04 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/04*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/05 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/05*
*2015/03/29 10:27:56.928| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.928| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.929| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/06 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/06*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/07 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/07*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/08 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/08*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/09 exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/09*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0A exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0A*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0B exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0B*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0C exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0C*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0D exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0D*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0E exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0E*
*2015/03/29 10:27:56 kid1| /var/spool/squid/cache/0F exists*
*2015/03/29 10:27:56 kid1| Making directories in /var/spool/squid/cache/0F*
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.954 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.955 kid1| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56.956| Acl.cc(380) ~ACL: freeing ACL *
*2015/03/29 10:27:56 kid1| Current Directory is /*
*2015/03/29 10:27:56 kid1| Starting Squid Cache version 3.5.2 for
i586-pc-linux-gnu...*
*2015/03/29 10:27:56 kid1| Service Name: squid*
*2015/03/29 10:27:56 kid1| Process ID 1349*
*2015/03/29 10:27:56 kid1| Process Roles: worker*
*2015/03/29 10:27:56 kid1| With 1024 file descriptors available*
*2015/03/29 10:27:56 kid1| Initializing IP Cache...*
*2015/03/29 10:27:56 kid1| DNS Socket created at 0.0.0.0, FD 8*
*2015/03/29 10:27:56 kid1| Adding nameserver 127.0.0.1 from
/etc/resolv.conf*
*2015/03/29 10:27:56 kid1| helperOpenServers: Starting 5/5 'ssl_crtd'
processes*
*FATAL: Ipc::Mem::Segment::open failed to
shm_open(/squid-ssl_session_cache.shm): (2) No such file or directory*

*Squid Cache (Version 3.5.2): Terminated abnormally.*
*CPU Usage: 0.010 seconds = 0.003 user + 0.007 sys*
*Maximum Resident Size: 26720 KB*
*Page faults with physical i/o: 0*


This snippet of the debug messages is repeated 5 times, one for each of the
five ssl_crtd processes (kids?) that are trying to start.

I have patched the &quot;src/main.cc&quot; file using a modified version of the patch
file found here &lt;
<A HREF="http://www.squid-cache.org/Versions/v4/changesets/squid-4-13984.patch">http://www.squid-cache.org/Versions/v4/changesets/squid-4-13984.patch</A>&gt;.
However, the patch file at this link no longer matches the main.cc file for
3.5.2 so I had to make my best guess what that patch file should be.

*--- squid-3.5.2/src/main.cc.orig 2015-03-19 20:27:40.092678987 -0500*
*+++ squid-3.5.2/src/main.cc 2015-03-19 15:42:26.000000000 -0500*
*@@ -871,6 +871,7 @@*
*     }*

*     writePidFile();     /* write PID file */*
*+    enter_suid(); // writePidFile() uses leave_suid()*

*     reconfiguring = 0;*
* }*
*@@ -1123,11 +1124,19 @@*

*     if (!configured_once)*
*         writePidFile();     /* write PID file */*
*+ enter_suid(); // writePidFile() uses leave_suid()*

* #if defined(_SQUID_LINUX_THREADS_)*

*     squid_signal(SIGQUIT, rotate_logs, SA_RESTART);*

*+    removePidFile();*
*+    enter_suid(); // removePidFile() uses leave_suid()*
*+    if (TheKids.someSignaled(SIGINT) || TheKids.someSignaled(SIGTERM)) {*
*+         syslog(LOG_ALERT, &quot;Exiting due to unexpected forced shutdown&quot;);*
*+         exit(1);*
*+    }*
*+*
*     squid_signal(SIGTRAP, sigusr2_handle, SA_RESTART);*

* #else*


The patch did nothing to fix the issue I am having with the errors I am
getting above with the five ssl_crtd kids failing to start giving that
error message :

*FATAL: Ipc::Mem::Segment::open failed to
shm_open(/squid-ssl_session_cache.shm): (2) No such file or directory*

Here are my squid 3.5.2 compile options

*CONFIG_OPTS += --enable-storeio=&quot;diskd,ufs,aufs&quot; --enable-linux-netfilter
\*
*      --enable-removal-policies=&quot;heap,lru&quot; --enable-delay-pools
--libdir=/usr/lib/ \*
*      --localstatedir=/var --with-dl --with-openssl
--enable-http-violations \*
*      --with-large-files --with-libcap --disable-ipv6
--with-swapdir=/var/spool/squid \*
*      --enable-ssl-crtd --enable-follow-x-forwarded-for*


And here is my squid.conf file with SSL caching enabled

*visible_hostname smoothwall*

*# Uncomment the following to send debug info to /var/log/squid/cache.log*
*debug_options ALL,1 33,2 28,9*

*# ACCESS CONTROLS*
*# ----------------------------------------------------------------*
*acl localhostgreen src 192.168.100.1*
*acl localnetgreen src 192.168.100.0/24 &lt;<A HREF="http://192.168.100.0/24">http://192.168.100.0/24</A>&gt;*

*acl SSL_ports port 445 443 441 563*
*acl Safe_ports port 80     # http*
*acl Safe_ports port 81     # smoothwall http*
*acl Safe_ports port 21     # ftp *
*acl Safe_ports port 445 443 441 563 # https, snews*
*acl Safe_ports port 70     # gopher*
*acl Safe_ports port 210       # wais  *
*acl Safe_ports port 1025-65535 # unregistered ports*
*acl Safe_ports port 280       # http-mgmt*
*acl Safe_ports port 488       # gss-http *
*acl Safe_ports port 591       # filemaker*
*acl Safe_ports port 777       # multiling http*

*acl CONNECT method CONNECT*

*# TAG: http_access*
*# ----------------------------------------------------------------*


*http_access deny !Safe_ports*
*http_access deny CONNECT !SSL_ports*

*http_access allow localnetgreen*
*http_access allow CONNECT localnetgreen*

*http_access allow localhostgreen*
*http_access allow CONNECT localhostgreen*

*# http_port and https_port*
*#----------------------------------------------------------------------------*

*# A random port for forward-proxy port needed for SSL*
*http_port 8081*

*http_port 192.168.100.1:800 &lt;<A HREF="http://192.168.100.1:800">http://192.168.100.1:800</A>&gt; intercept ssl-bump
generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
cert=/var/smoothwall/mods/proxy/ssl_cert/squidCA.pem*

*https_port 192.168.100.1:808 &lt;<A HREF="http://192.168.100.1:808">http://192.168.100.1:808</A>&gt; intercept ssl-bump
generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
cert=/var/smoothwall/mods/proxy/ssl_cert/squidCA.pem*

*sslproxy_cert_error allow all*
*sslproxy_flags DONT_VERIFY_PEER*
*ssl_bump server-first all*

*ssl_bump none localhostgreen*
*sslcrtd_program /var/smoothwall/mods/proxy/libexec/ssl_crtd -s
/var/smoothwall/mods/proxy/lib/ssl_db -M 4MB*
*sslcrtd_children 5*

*sslproxy_session_cache_size 4 MB*

*http_access deny all*

*cache_replacement_policy heap GDSF*
*memory_replacement_policy heap GDSF*

*# CACHE OPTIONS*
*#
----------------------------------------------------------------------------*
*cache_effective_user squid*
*cache_effective_group squid*

*cache_swap_high 100*
*cache_swap_low 80*

*cache_mem 8 MB*
*maximum_object_size_in_memory 512 KB*

*cache_access_log /var/log/squid/access.log*
*cache_log /var/log/squid/cache.log*

*cache_dir diskd /var/spool/squid/cache 1024 16 256 Q1=64 Q2=72*

*maximum_object_size 33 MB*

*minimum_object_size 0 KB*


*request_body_max_size 0 KB*

*# OTHER OPTIONS*
*#
----------------------------------------------------------------------------*
*forwarded_for off*

*pid_filename /var/run/squid.pid*

*shutdown_lifetime 30 seconds*
*icp_port 3130*

*half_closed_clients off*

*umask 022*

*logfile_rotate 0*

*strip_query_terms off*

I think I am about ready to give up on trying to get Squid 3.5.2 working
and just fall back to Squid 3.4.10 which was the last version that worked
correctly and didn't give me these startup issues.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20150329/69c75e97/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20150329/69c75e97/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="002964.html">[squid-users] Squid behaviour with external_acl_type
</A></li>
	<LI>Next message (by thread): <A HREF="002973.html">[squid-users] Squid 3.5.2 ssl_crtd kids causing abnormal termination of startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2970">[ date ]</a>
              <a href="thread.html#2970">[ thread ]</a>
              <a href="subject.html#2970">[ subject ]</a>
              <a href="author.html#2970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
