<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2015:1 Incorrect	X509 server	certificate valdidation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2015%3A1%20Incorrect%0A%09X509%20server%09certificate%20valdidation&In-Reply-To=%3C55439D27.2090500%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003421.html">
   <LINK REL="Next"  HREF="003370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2015:1 Incorrect	X509 server	certificate valdidation</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2015%3A1%20Incorrect%0A%09X509%20server%09certificate%20valdidation&In-Reply-To=%3C55439D27.2090500%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2015:1 Incorrect	X509 server	certificate valdidation">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri May  1 15:35:03 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003421.html">[squid-users] Squid-deb-proxy legacy-tools_0.1_all.deb Size	mismatch
</A></li>
        <LI>Next message (by thread): <A HREF="003370.html">[squid-users] [squid-announce] Squid 3.2.14 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3367">[ date ]</a>
              <a href="thread.html#3367">[ thread ]</a>
              <a href="subject.html#3367">[ subject ]</a>
              <a href="author.html#3367">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

    Squid Proxy Cache Security Update Advisory SQUID-2015:1
__________________________________________________________________

Advisory ID:            SQUID-2015:1
Date:                   May 01, 2015
Summary:                Incorrect X509 server certificate valdidation
Affected versions:      Squid 3.2 -&gt; 3.2.13
                        Squid 3.3 -&gt; 3.3.13
                        Squid 3.4 -&gt; 3.4.12
                        Squid 3.5 -&gt; 3.5.3
Fixed in version:       Squid 3.5.4, 3.4.13, 3.3.14, 3.2.14
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2015_1.txt">http://www.squid-cache.org/Advisories/SQUID-2015_1.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3455">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3455</A>
__________________________________________________________________

Problem Description:

 Squid configured with client-first SSL-bump does not correctly
 validate X509 server certificate domain / hostname fields.

__________________________________________________________________

Severity:

 The bug is important because it allows remote servers to bypass
 client certificate validation. Some attackers may also be able
 to use valid certificates for one domain signed by a global
 Certificate Authority to abuse an unrelated domain.

 However, the bug is exploitable only if you have configured
 Squid to perform SSL Bumping with the &quot;client-first&quot; or &quot;bump&quot;
 mode of operation.

 Sites that do not use SSL-Bump are not vulnerable.

__________________________________________________________________

Updated Packages:

 This bug is fixed by Squid version 3.5.4, 3.4.13, 3.3.14, and
 3.2.14.

 In addition, patches addressing this problem for stable releases
 can be found in our patch archives:

Squid 3.2:
<A HREF="http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11836.patch">http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11836.patch</A>

Squid 3.3:
<A HREF="http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12690.patch">http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12690.patch</A>

Squid 3.4:
<A HREF="http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13222.patch">http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13222.patch</A>

Squid 3.5:
<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13817.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-13817.patch</A>

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 All Squid-2.x, 3.0 and 3.1 are not vulnerable to the problem.

1) Run &quot;squid -v&quot; to determine if SSL support is enabled.

 All Squid built without SSL support are not vulnerable to the
 problem.


2) Run &quot;squid -k parse 2&gt;&amp;1 | grep ssl_bump&quot; to determine if
SSL-Bump is being used.

 All Squid-3.2, 3.3, 3.4, and 3.5 operating with ssl_bump omitted
 from squid.conf are not vulnerable to the problem.

 All unpatched Squid-3.x operating with &quot;ssl_bump client-first&quot;
 in squid.conf are vulnerable to the problem.

 All unpatched Squid-3.x operating with &quot;ssl_bump bump&quot; in
 squid.conf are vulnerable to the problem.

__________________________________________________________________

Workaround:

 There is no workaround for Squid-3.2.

 For Squid-3.3 and 3.4, upgrade the squid.conf settings to use
 &quot;ssl_bump server-first&quot;.

 For Squid-3.5, upgrade the squid.conf settings to use a
 &quot;ssl_bump peek&quot; operation before the &quot;bump&quot; operation.

  NOTE that these workarounds do not resolve the vulnerability,
  but allow Squid to relay (or mimic) the invalid certificate to
  clients and depends on validation in the client.


Or,

 Disable SSL-Bump. Which may be done in the following ways:

 * Build Squid-3.2, 3.3, or 3.4 with ./configure --disable-ssl

 * Build Squid-3.5 with ./configure --without-openssl

 * Remove from squid.conf (and include'd files) any ssl_bump
   directives.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A> mailing list is your primary
 support point. For subscription details see
 <A HREF="http://www.squid-cache.org/Support/mailing-lists.html.">http://www.squid-cache.org/Support/mailing-lists.html.</A>

 For reporting of non-security bugs in the latest release
 the squid bugzilla database should be used
 <A HREF="http://bugs.squid-cache.org/.">http://bugs.squid-cache.org/.</A>

 For reporting of security sensitive bugs send an email to the
 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at squid-cache.org</A> mailing list. It's a closed list
 (though anyone can post) and security related bug reports are
 treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 The vulnerability was discovered and reported by a contributor
 who wishes to remain anonymous.

 The vulnerability was fixed and tested by
  Amos Jeffries, Treehouse Networks Ltd. and
  Christos Tsantilas, The Measurement Factory.

__________________________________________________________________

Revision history:

 2015-04-29 01:35 GMT Initial Report
 2015-05-01 13:49 GMT CVE Assignment
 2015-05-01 12:50 GMT Patches and Packages Released
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003421.html">[squid-users] Squid-deb-proxy legacy-tools_0.1_all.deb Size	mismatch
</A></li>
	<LI>Next message (by thread): <A HREF="003370.html">[squid-users] [squid-announce] Squid 3.2.14 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3367">[ date ]</a>
              <a href="thread.html#3367">[ thread ]</a>
              <a href="subject.html#3367">[ subject ]</a>
              <a href="author.html#3367">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
