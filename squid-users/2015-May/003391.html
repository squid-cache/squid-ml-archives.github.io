<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20comm.cc%3A178%3A%0A%20%22fd_table%5Bconn-%3Efd%5D.halfClosedReader%20%21%3D%20NULL%22&In-Reply-To=%3C5545B0A5.9070304%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003385.html">
   <LINK REL="Next"  HREF="003393.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20comm.cc%3A178%3A%0A%20%22fd_table%5Bconn-%3Efd%5D.halfClosedReader%20%21%3D%20NULL%22&In-Reply-To=%3C5545B0A5.9070304%40treenet.co.nz%3E"
       TITLE="[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun May  3 05:22:45 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003385.html">[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="003393.html">[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3391">[ date ]</a>
              <a href="thread.html#3391">[ thread ]</a>
              <a href="subject.html#3391">[ subject ]</a>
              <a href="author.html#3391">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/05/2015 10:59 a.m., HackXBack wrote:
&gt;<i> Thanks you amos for giving time,
</I>&gt;<i> but about this part :
</I>&gt;<i> 
</I>&gt;<i> ####for looping 302 on youtube
</I>&gt;<i> acl text-html rep_mime_type text/html
</I>&gt;<i> acl http302 http_status 302
</I>&gt;<i> 
</I>&gt;<i> store_miss deny text-html
</I>&gt;<i> store_miss deny http302
</I>&gt;<i> send_hit deny text-html
</I>&gt;<i> send_hit deny http302
</I>&gt;<i> 
</I>&gt;<i> i use this config with patch file to make youtube not making loop 302 and
</I>&gt;<i> then videos will not open and give tv old screen with error accrued ,
</I>&gt;<i> 
</I>
My comment was only about the single line:

 &quot;store_miss deny text-html&quot;


The oddness is thusly:


When forcing almost everything to cache you notice that many pages dont
show up right, dynamic ones dont always work right, or content is not
being updated properly when it should.

Your solution then is obviously to prevent forcing of just the text/html
parts. Is *seems* the right thing to do - but isn't.


In doing that you overlook the fact that the text/html part is what
makes the other non-HTML parts so &quot;dynamic&quot;. Every single page load of
the text/html part may be pointing to different scripts, images, videos
etc causing the ones already in your cache to be ignored and the new
ones fetched. This is a drag on your cache now having to track N copies
of what the page *used* to look like, but those images/videos/etc may
never again be used.

What we call the &quot;cache control&quot; headers (date, cache-control, expires,
last-modified, etag etc) are not what makes the content dynamic, they
are just indications by the site author / server of how long the HTML
parts of the site are going to be making use of those objects. The
dynamic bit is usually the HTML and how it references things.


Store-ID gets around that a little bit by telling your cache that *you
think* certain objects are going to be used under multiple names with
some pattern regex can match _reliably_.

The *right* thing to be doing is to let sites determine their own
caching and only use the forced caching for specific sites (and if
possible specific URLs) which are found to be broken.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003385.html">[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="003393.html">[squid-users] assertion failed: comm.cc:178: &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3391">[ date ]</a>
              <a href="thread.html#3391">[ thread ]</a>
              <a href="subject.html#3391">[ subject ]</a>
              <a href="author.html#3391">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
