<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] IPv6 and syntax?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IPv6%20and%20syntax%3F&In-Reply-To=%3C5556FC47.4040409%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003585.html">
   <LINK REL="Next"  HREF="003587.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] IPv6 and syntax?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IPv6%20and%20syntax%3F&In-Reply-To=%3C5556FC47.4040409%40treenet.co.nz%3E"
       TITLE="[squid-users] IPv6 and syntax?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat May 16 08:13:59 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003585.html">[squid-users] IPv6 and syntax?
</A></li>
        <LI>Next message (by thread): <A HREF="003587.html">[squid-users] IPv6 and syntax?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3586">[ date ]</a>
              <a href="thread.html#3586">[ thread ]</a>
              <a href="subject.html#3586">[ subject ]</a>
              <a href="author.html#3586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/05/2015 6:22 p.m., Walter H. wrote:
&gt;<i> On 16.05.2015 01:41, Amos Jeffries wrote:
</I>&gt;&gt;<i> On 16/05/2015 6:14 a.m., Walter H. wrote:
</I>&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> is IPv6 somewhat similar to IPv4?
</I>&gt;&gt;<i> Somewhat, yes.
</I>&gt;<i> I just wondered because of the &quot;different&quot; behaviour;
</I>&gt;&gt;&gt;<i> e.g.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I would write
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> acl block_ipv4_range dst  84.84.84.0/24
</I>&gt;&gt;&gt;<i> deny_info errorpage block_ipv4_range
</I>&gt;&gt;&gt;<i> http_access deny block_ipv4_range
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> to block any hosts within this IPv4 range
</I>&gt;&gt;<i> Taking a step asside, that is not quite what those rules do. They block
</I>&gt;&gt;<i> access from anywhere *to* the IP address range (TCP/IP packet
</I>&gt;&gt;<i> destination on the request messages).
</I>&gt;&gt;<i>
</I>&gt;<i> yes this should be the intention, that you get an error (in this case
</I>&gt;<i> the errorpage) when
</I>&gt;<i> you have e.g.  <A HREF="http://84.84.84.2/">http://84.84.84.2/</A> or <A HREF="https://84.84.84.2/">https://84.84.84.2/</A> as URL in your
</I>&gt;<i> browser ...
</I>
It will block that, and any domain name which resolves to those IPs.


&gt;&gt;<i> If you were trying to prevent those hosts themselves from accessing
</I>&gt;&gt;<i> anything through the proxy you need the &quot;src&quot; ACL type.
</I>&gt;<i> I know;
</I>&gt;&gt;&gt;<i> how would be the syntax for blocking any hosts within a specific IPv6
</I>&gt;&gt;&gt;<i> subnet
</I>&gt;&gt;&gt;<i> e.g. [2408:8000::]/24
</I>&gt;&gt;<i> FYI the [] syntax is URL format - for uses when a port may exist. So the
</I>&gt;&gt;<i> ':' between IP:port dont get confused.
</I>&gt;&gt;<i>
</I>&gt;<i> I noticed the difference, but wondered why e.g. /etc/hosts.deny contains
</I>&gt;<i> this:
</I>&gt;<i> sshd: [2408:8000::]/24
</I>
It differs by program. Depends on how v6-experienced the developer who
wrote the code was. There are some new to IPv6 seems to think they
always have to use []. Same as there are people who believe every domain
name begins with www, or email addresses have to contain alphanumerics.

&gt;<i> 
</I>&gt;&gt;&gt;<i> should it be this?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> acl block_ipv6_subnet dst 2408:8000::/24
</I>&gt;&gt;&gt;<i> deny_info errorpage block_ipv6_subnet
</I>&gt;&gt;&gt;<i> http_access deny block_ipv6_subnet
</I>&gt;&gt;<i> Yes. Though the /N CIDR range is probably different. An IPv4 /24 is
</I>&gt;&gt;<i> equivalent to an IPv6 /52  (255 separate pieces of hardware with a
</I>&gt;&gt;<i> mandatory /64 each).
</I>&gt;&gt;<i>
</I>&gt;<i> why I'm asking, because; when having both sections in squid.conf and
</I>&gt;<i> doing SSL-bump
</I>&gt;<i> you get a different reaction in the browser:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://84.84.84.22/">https://84.84.84.22/</A>
</I>&gt;<i> brings the 'errorpage' as expected
</I>&gt;<i> the generated certificate has the IP-address (84.84.84.22) as its common
</I>&gt;<i> name;
</I>&gt;<i> 
</I>&gt;<i> but
</I>&gt;<i> <A HREF="https://[2408:8000::3">https://[2408:8000::3</A>]/
</I>&gt;<i> behaves different in various browsers:
</I>&gt;<i> 
</I>&gt;<i> - IE 7: brings a certificate error, when accepting you get the errorpage
</I>&gt;<i>            the generated certificate has the IP-address 2408:8000::3 as
</I>&gt;<i> its common name
</I>&gt;<i> 
</I>&gt;<i> - later FF (17+) do nothing, older FF (3.6) bring
</I>&gt;<i>        &quot;The proxy server is refusing connections
</I>&gt;<i>        Firefox is configured to use a proxy server that is refusing
</I>&gt;<i> connections.&quot;
</I>&gt;<i> 
</I>&gt;<i> - Chrome 42 brings ' Your connection is not private' and
</I>&gt;<i> NET::ERR_CERT_COMMON_NAME_INVALID
</I>&gt;<i>      when clicking advanced and proceed with warning you get the errorpage
</I>&gt;<i>            the generated certificate has the IP-address 2408:8000::3 as
</I>&gt;<i> its common name
</I>&gt;<i> 
</I>&gt;<i> trying <A HREF="https://[2408:8000:0:0:0:0:0:3">https://[2408:8000:0:0:0:0:0:3</A>]/  does an automatic reduction to
</I>&gt;<i> <A HREF="https://[2408:8000::3">https://[2408:8000::3</A>]/ by the browser
</I>&gt;<i> 
</I>&gt;<i> does it seem to be problematic, when having an TLS-server with an IPv6
</I>&gt;<i> address only without DNS, because of the comm name?
</I>
That is a different issue entirely.

X.509 certificate format explicitly states that the field contains the
domain name registered to the entity the certificate was issued to.
There are certain things that are done with it that can only be done
with a domain name (wildcard validation, domain name comparisons, etc).

Going by that description it seems Firefox and Chrome are a bit broken.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003585.html">[squid-users] IPv6 and syntax?
</A></li>
	<LI>Next message (by thread): <A HREF="003587.html">[squid-users] IPv6 and syntax?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3586">[ date ]</a>
              <a href="thread.html#3586">[ thread ]</a>
              <a href="subject.html#3586">[ subject ]</a>
              <a href="author.html#3586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
