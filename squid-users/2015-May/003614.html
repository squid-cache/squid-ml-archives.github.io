<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.3 to 3.5 url_rewrite_program changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.3%20to%203.5%20url_rewrite_program%20changes&In-Reply-To=%3C555AD2BF.9060901%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003613.html">
   <LINK REL="Next"  HREF="003657.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.3%20to%203.5%20url_rewrite_program%20changes&In-Reply-To=%3C555AD2BF.9060901%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue May 19 06:05:51 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003613.html">[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes
</A></li>
        <LI>Next message (by thread): <A HREF="003657.html">[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3614">[ date ]</a>
              <a href="thread.html#3614">[ thread ]</a>
              <a href="subject.html#3614">[ subject ]</a>
              <a href="author.html#3614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/05/2015 12:33 p.m., PSA4444 wrote:
&gt;<i> I tried to upgrade from squid 3.2.x to 3.5.x and found my url rewrite script
</I>&gt;<i> no longer works.
</I>&gt;<i> After trial and error, I found the latest version it works in is the latest
</I>&gt;<i> 3.3.x so I've upgraded to this for now.
</I>&gt;<i> 
</I>&gt;<i> Here is my url_rewrite_program: <A HREF="http://pastebin.com/uaYUCkyY">http://pastebin.com/uaYUCkyY</A>
</I>&gt;<i> 
</I>&gt;<i> I haven't been able to figure out how to port this over to the new
</I>&gt;<i> url_rewrite_program format.
</I>&gt;<i> 
</I>
Take a read through &lt;<A HREF="http://wiki.squid-cache.org/Features/AddonHelpers">http://wiki.squid-cache.org/Features/AddonHelpers</A>&gt;.

Notice how the helper input and output lines have different syntax. Your
helper is just taking the input line, adjusting its URL and dumping it
straight back at Squid with all the extra input parameters. That has not
been correct operation since Squid-2.4 (when there were no extra
parameters).


Anyhow your helper is doing the equivalent of:

 acl HTTPS proto HTTPS
 acl api urlpath_regex ^/api

 acl site dstdomain site.domain.com
 deny_info 301:<A HREF="https://api.domain.com%R">https://api.domain.com%R</A> site
 http_access deny HTTPS api site

 acl site2 dstdomain site2.domain.com
 http_access deny HTTPS api site2
 deny_info 301:<A HREF="https://api2.domain.com%R">https://api2.domain.com%R</A> site2


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003613.html">[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes
</A></li>
	<LI>Next message (by thread): <A HREF="003657.html">[squid-users] Squid 3.3 to 3.5 url_rewrite_program changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3614">[ date ]</a>
              <a href="thread.html#3614">[ thread ]</a>
              <a href="subject.html#3614">[ subject ]</a>
              <a href="author.html#3614">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
