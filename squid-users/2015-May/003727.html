<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [PATCH] SSL: Add suport for EECDH and disable client-initiated renegotiation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BPATCH%5D%20SSL%3A%20Add%20suport%20for%20EECDH%20and%20disable%0A%20client-initiated%20renegotiation&In-Reply-To=%3C55632798.1090906%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003726.html">
   <LINK REL="Next"  HREF="003729.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [PATCH] SSL: Add suport for EECDH and disable client-initiated renegotiation</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BPATCH%5D%20SSL%3A%20Add%20suport%20for%20EECDH%20and%20disable%0A%20client-initiated%20renegotiation&In-Reply-To=%3C55632798.1090906%40treenet.co.nz%3E"
       TITLE="[squid-users] [PATCH] SSL: Add suport for EECDH and disable client-initiated renegotiation">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon May 25 13:46:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003726.html">[squid-users] [PATCH] SSL: Add suport for EECDH and disable	client-initiated renegotiation
</A></li>
        <LI>Next message (by thread): <A HREF="003729.html">[squid-users] [PATCH] SSL: Add suport for EECDH and disable client-initiated renegotiation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3727">[ date ]</a>
              <a href="thread.html#3727">[ thread ]</a>
              <a href="subject.html#3727">[ subject ]</a>
              <a href="author.html#3727">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/05/2015 11:30 p.m., Paulo Matias wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Sorry for getting this sent to squid-users instead of the adequate
</I>&gt;<i> mailing list for patches (squid-dev). We have tried to send the
</I>&gt;<i> patch to squid-dev without a subscription (as recommended in
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Support/mailing-lists.html#squid-dev">http://www.squid-cache.org/Support/mailing-lists.html#squid-dev</A>),
</I>&gt;<i> but perhaps the message did not get to the list administrator.
</I>&gt;<i> 
</I>
Could you subscribe then please and post it (or the updated version
after below). This has effects that I'd like our SSL devs to double check.


For my part on the audit:


* please separate into two patches - one for the renegotiation changes,
one for the EECDH.


* please avoid #ifdef and #ifndef in new code.
 - use #if defined() style instead.


Renegotiation:

* please wrap the entire ssl_info_cb() definition in the #if
conditionals and the appropriate calling lines.
 I know its a bit messy, but increasingly the library builds are lacking
renegtiation support entirely so this means smaller/faster builds.


EECDH:

FYI: with the deprecation of SSLv3 I'm working now towards a cleanup of
the SSL options with removals where possible.


* the DH parameters I think would be better added as a new option
&quot;tls-dh=curve:/path/to/params&quot; where the 'curve' part is optional and
implies EC when present - non-EC when absent.


* SINGLE_ECDH_USE needs to be documented in release-4.sgml
 &quot;New &lt;em&gt;options=SINGLE_ECDH_USE&lt;/em&gt; parameter to ...&quot;


* The ECDH changes affect both https_port and http_port. They need
separate listings for each under changed directives, duplicate text on
the line items is fine.


* please implement (duplicate) all this UI parse change using the
Security::PeerOptions object (src/security/PeerOptions.*)
 - the src/ssl/* code for UI parsing and config storage is 'legacy' only
use by http(s)_port directives.
 - this may require some small changes suitable for use on client contexts
 - UI options added to Security::PeerOptions get documented in
release-4.sgml as changes for both cache_peer and tls_outgoing_options.
 - also in cf.data.pre for those directives


* configureSslEECDH() return true in the event that the chosen
configuration options are not even available.
 - please make an #else condition that displays an ERROR message at
level DBG_CRITICAL about the option(s) not being available, then return
false.
 - variable 'ok' can then become const (define on assignment) and move
fully inside the #if case.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003726.html">[squid-users] [PATCH] SSL: Add suport for EECDH and disable	client-initiated renegotiation
</A></li>
	<LI>Next message (by thread): <A HREF="003729.html">[squid-users] [PATCH] SSL: Add suport for EECDH and disable client-initiated renegotiation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3727">[ date ]</a>
              <a href="thread.html#3727">[ thread ]</a>
              <a href="subject.html#3727">[ subject ]</a>
              <a href="author.html#3727">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
