<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Outgoing IPv6 address with no IPv4 address access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Outgoing%20IPv6%20address%20with%20no%20IPv4%20address%20access&In-Reply-To=%3C5636EF30.4090402%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007488.html">
   <LINK REL="Next"  HREF="007498.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Outgoing IPv6 address with no IPv4 address access</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Outgoing%20IPv6%20address%20with%20no%20IPv4%20address%20access&In-Reply-To=%3C5636EF30.4090402%40treenet.co.nz%3E"
       TITLE="[squid-users] Outgoing IPv6 address with no IPv4 address access">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Nov  2 05:05:52 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007488.html">[squid-users] Outgoing IPv6 address with no IPv4 address access
</A></li>
        <LI>Next message (by thread): <A HREF="007498.html">[squid-users] Outgoing IPv6 address with no IPv4 address access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7490">[ date ]</a>
              <a href="thread.html#7490">[ thread ]</a>
              <a href="subject.html#7490">[ subject ]</a>
              <a href="author.html#7490">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/11/2015 2:07 p.m., Eliezer Croitoru wrote:
&gt;<i> Hey Robert,
</I>&gt;<i> 
</I>&gt;<i> It is really unclear what you need or want(at least to me).
</I>&gt;<i> The basic way that the routing world works is that if you try to access
</I>&gt;<i> an IPV4 address is by using the IPV4 routing world.
</I>&gt;<i> It means that you need to use an IPV4 address to access IPV4 resources
</I>&gt;<i> or networks.
</I>&gt;<i> 
</I>&gt;<i> I remember talks here and there about making it possible from a routing
</I>&gt;<i> and networking aspect of things to be able to use an IPV6 address to
</I>&gt;<i> access an IPV4 network. From what I know it requires some special
</I>&gt;<i> networking settings and special equipment\software.
</I>&gt;<i> In any case you would need somewhere in your setup a place which can
</I>&gt;<i> access either two stacks(IPV4+IPV6) or some other solution which I
</I>&gt;<i> suspect doesn't exist yet.
</I>
There is NAT64 nowdays. But that is even more nasty than two layers of
NAT44.

There are also ALG translators for most protocols. Squid being one of
those for HTTP.

What Robert is possibly seeing may be Squid ALG features translating
between IPv4-only servers and IPv6 clients.

&gt;<i> 
</I>&gt;<i> From squid aspect it can interact the world with both IPV6 and IPV4
</I>&gt;<i> while the decision is based on the DNS response which is either an A
</I>&gt;<i> record or AAAA record.
</I>&gt;<i> If you would use an IPV6 DNS servers the answer would be the same for
</I>&gt;<i> both A and AAAA queries, V4 or V6..
</I>&gt;<i> The default from squid point of view is to use it's own IP address while
</I>&gt;<i> accessing the network unless you are using TPROXY.
</I>&gt;<i> 
</I>&gt;<i> What you see is how things should work.
</I>&gt;<i> 
</I>&gt;<i> All The Bests,
</I>&gt;<i> Eliezer Croitoru
</I>&gt;<i> 
</I>&gt;<i> On 01/11/2015 18:38, Robert Conlustro wrote:
</I>&gt;&gt;<i> I have an IPv6 outgoing address setup and it works correctly but when
</I>&gt;&gt;<i> I access a website that has an IPv4 address it uses the main IP of the
</I>&gt;&gt;<i> server,
</I>
This should not be for _any_ website with IPv4. Squid by default will
use IPv6 in preference over IPv4 when both are available. Only using
IPv4 if there is no IPv6 connectivity to the server.

You have to have explicitly configured &quot;dns_v4_first on&quot; to make Squid
use IPv4 when there is working IPv6 to the server. Using that option is
discouraged.
In this case, make sure it is removed entirely from your config.


&gt;&gt;<i> is there any way to disable the use of the main IPv4 address
</I>&gt;&gt;<i> of the server and only use the IPv6 outgoing address? I have tried to
</I>&gt;&gt;<i> add only IPv6 DNS nameservers and that didn&#8217;t work. Any ideas would be
</I>&gt;&gt;<i> greatly appreciated.
</I>
Not when contacting IPv4 servers. src-IP and dst-IP must be of the same
IP version to make a connection.

The best way to prevent IPv4 traffic flowing around your network is to
firewall IPv4 so that it meets your requirements. If a firewall rejects
IPv4 connectivity properly Squid will obey and move on to other IPs the
site has or send a 5xx error to the client informing them it is
unavailable. No Squid config needed.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007488.html">[squid-users] Outgoing IPv6 address with no IPv4 address access
</A></li>
	<LI>Next message (by thread): <A HREF="007498.html">[squid-users] Outgoing IPv6 address with no IPv4 address access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7490">[ date ]</a>
              <a href="thread.html#7490">[ thread ]</a>
              <a href="subject.html#7490">[ subject ]</a>
              <a href="author.html#7490">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
