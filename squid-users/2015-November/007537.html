<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl bump and url_rewrite_program (like squidguard)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl%20bump%20and%20url_rewrite_program%20%28like%20squidguard%29&In-Reply-To=%3C563A003A.8060600%40e-gaulue.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007523.html">
   <LINK REL="Next"  HREF="007538.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl bump and url_rewrite_program (like squidguard)</H1>
    <B>Edouard Gaulu&#233;</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl%20bump%20and%20url_rewrite_program%20%28like%20squidguard%29&In-Reply-To=%3C563A003A.8060600%40e-gaulue.com%3E"
       TITLE="[squid-users] ssl bump and url_rewrite_program (like squidguard)">edouard at e-gaulue.com
       </A><BR>
    <I>Wed Nov  4 12:55:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007523.html">[squid-users] ssl bump and url_rewrite_program (like squidguard)
</A></li>
        <LI>Next message (by thread): <A HREF="007538.html">[squid-users] ssl bump and url_rewrite_program (like squidguard)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7537">[ date ]</a>
              <a href="thread.html#7537">[ thread ]</a>
              <a href="subject.html#7537">[ subject ]</a>
              <a href="author.html#7537">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 04/11/2015 11:00, Amos Jeffries a &#233;crit :
&gt;<i> On 4/11/2015 12:48 p.m., Marcus Kool wrote:
</I>&gt;&gt;<i> I suspect that the problem is that you redirect a HTTPS-based URL to an
</I>&gt;&gt;<i> HTTP URL and Squid does not like that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Marcus
</I>To give it a try in that direction I now redirect to an https server. 
And I get :

The following error was encountered while trying to retrieve the URL: 
<A HREF="https://https/*">https://https/*</A>

    *Unable to determine IP address from host name &quot;https&quot;*

The DNS server returned:

    Name Error: The domain name does not exist.


Moreover this would leads sometimes to HTTP-based URL to an HTTPS URL 
and I don't know how much squid likes it either.

&gt;<i> No it is apparently the fact that the domain name being redirected to is
</I>&gt;<i> &quot;http&quot;.
</I>&gt;<i>
</I>&gt;<i> As in:&quot;<A HREF="http://http/something">http://http/something</A>&quot;
</I>&gt;<i>
</I>I can assure my rewrite_url looks like 
&quot;<A HREF="https://proxyweb.xxxxx.xxxxx/var1=xxxx&amp;...">https://proxyweb.xxxxx.xxxxx/var1=xxxx&amp;...</A>&quot;.

And this confirm ssl_bump parse this result and get the left part before 
the &quot;:&quot;. To play with, I have also redirect to 
&quot;proxyweb.xxxxx.xxxxx:443/var1=xxxx&amp;...&quot; (ie. I removed the &quot;<A HREF="https://">https://</A>&quot; 
and add a &quot;:443&quot;) to force the parsing. Then I don't get this message 
anymore, but Mozilla gets crazy waiting for the ad.doubleclick.net 
certificate and getting the proxyweb.xxxxx.xxxxx one. And of course it 
breaks my SG configuration and can't be production solution.
&gt;<i> Which brings up the question of why you are using SG to block adverts?
</I>&gt;<i>
</I>&gt;<i> squid.conf:
</I>&gt;<i>   acl ads dstdomain .doubleclick.net
</I>&gt;<i>   http_access deny ads
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>I don't use SG to specificaly block adverts, I use it to block 90 % of 
the web. Here it's just an example with ads but it could be with so much 
other things...

I just want to try make SG and ssl_bump live together.

Is this possible to have a rule like &quot;if it has been rewrite then don't 
try to ssl_bump&quot;?

Regards, EG
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151104/3aa19d5d/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151104/3aa19d5d/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007523.html">[squid-users] ssl bump and url_rewrite_program (like squidguard)
</A></li>
	<LI>Next message (by thread): <A HREF="007538.html">[squid-users] ssl bump and url_rewrite_program (like squidguard)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7537">[ date ]</a>
              <a href="thread.html#7537">[ thread ]</a>
              <a href="subject.html#7537">[ subject ]</a>
              <a href="author.html#7537">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
