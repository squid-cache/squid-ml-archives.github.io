<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid: Small packets and low performance between squid and icap
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%3A%20Small%20packets%20and%20low%20performance%20between%0A%20squid%20and%20icap&In-Reply-To=%3C563B7252.2080500%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007564.html">
   <LINK REL="Next"  HREF="007577.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid: Small packets and low performance between squid and icap</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%3A%20Small%20packets%20and%20low%20performance%20between%0A%20squid%20and%20icap&In-Reply-To=%3C563B7252.2080500%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid: Small packets and low performance between squid and icap">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Nov  5 15:14:26 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007564.html">[squid-users] Squid: Small packets and low performance between squid and icap
</A></li>
        <LI>Next message (by thread): <A HREF="007577.html">[squid-users] Squid: Small packets and low performance between squid and icap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7571">[ date ]</a>
              <a href="thread.html#7571">[ thread ]</a>
              <a href="subject.html#7571">[ subject ]</a>
              <a href="author.html#7571">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/11/2015 10:41 p.m., Prashanth Prabhu wrote:
&gt;<i> Hello Amos,
</I>&gt;<i> 
</I>&gt;<i> Thanks for the quick response.
</I>&gt;<i> 
</I>&gt;<i> I failed to mention that I am on 3.5.1. And, readSomeData() is already &quot;fixed&quot;:
</I>
Bug 4353 exists because the initial fix for 4206 was not enough to fully
remove the behaviour. Sometimes yes, sometimes no.

Only the nasty hack of allocating buffers twice and throwing one away
unused seems to work fully so far. That is the patch in 4353.


&gt;<i> ----
</I>&gt;<i> void
</I>&gt;<i> ConnStateData::readSomeData()
</I>&gt;<i> {
</I>&gt;<i>     if (reading())
</I>&gt;<i>         return;
</I>&gt;<i> 
</I>&gt;<i>     debugs(33, 4, HERE &lt;&lt; clientConnection &lt;&lt; &quot;: reading request...&quot;);
</I>&gt;<i> 
</I>&gt;<i>     if (!in.maybeMakeSpaceAvailable())
</I>&gt;<i>         return;
</I>&gt;<i> 
</I>&gt;<i>     typedef CommCbMemFunT&lt;ConnStateData, CommIoCbParams&gt; Dialer;
</I>&gt;<i>     reader = JobCallback(33, 5, Dialer, this, ConnStateData::clientReadRequest);
</I>&gt;<i>     Comm::Read(clientConnection, reader);
</I>&gt;<i> }
</I>&gt;<i> ----
</I>&gt;<i> 
</I>&gt;<i> I am planning to try the &quot;patch client_side.cc to call
</I>&gt;<i> maybeMakeSpaceAvailable()&quot; from #4206. Anything else, I should try?
</I>
The patch from 4353.

And also upgrading to 3.5.11 unless that was a typo in the version
number *.1 above.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007564.html">[squid-users] Squid: Small packets and low performance between squid and icap
</A></li>
	<LI>Next message (by thread): <A HREF="007577.html">[squid-users] Squid: Small packets and low performance between squid and icap
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7571">[ date ]</a>
              <a href="thread.html#7571">[ thread ]</a>
              <a href="subject.html#7571">[ subject ]</a>
              <a href="author.html#7571">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
