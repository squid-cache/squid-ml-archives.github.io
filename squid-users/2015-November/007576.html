<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.10 ldap helpers can't &quot;reconfigure&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.10%20ldap%20helpers%20can%27t%20%22reconfigure%22&In-Reply-To=%3C563B994D.6090304%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007574.html">
   <LINK REL="Next"  HREF="007580.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.10 ldap helpers can't &quot;reconfigure&quot;</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.10%20ldap%20helpers%20can%27t%20%22reconfigure%22&In-Reply-To=%3C563B994D.6090304%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 3.5.10 ldap helpers can't &quot;reconfigure&quot;">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Nov  5 18:00:45 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007574.html">[squid-users] Squid 3.5.10 ldap helpers can't &quot;reconfigure&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="007580.html">[squid-users] authentication of every GET request from part of URL?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7576">[ date ]</a>
              <a href="thread.html#7576">[ thread ]</a>
              <a href="subject.html#7576">[ subject ]</a>
              <a href="author.html#7576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/11/2015 5:21 a.m., Fabio Almeida wrote:
&gt;<i> Hi folks,
</I>&gt;<i> 
</I>&gt;<i> I have and Squid 3.5.10 instance that I can't reconfigure, it crashes if
</I>&gt;<i> there's many spawned ldap helpers.
</I>&gt;<i> But, if there's not many people connect it reconfigure normal as expected.
</I>&gt;<i> 
</I>&gt;<i> It's running on a FreeBSD 10.1-RELEASE-p19 amd64 with the following
</I>&lt;snip&gt;
&gt;<i> There's a total of 439 ldap group helpers enabled.
</I>
Why so many? external ACL lookups are both merged and cached, so this
many helpers suggests an overly complex configuration.


&gt;<i> For user's authentication there's 127 helpers enabled.
</I>&gt;<i> 
</I>&gt;<i> It works as expected, except when um run &quot;squid -k reconfigure&quot;, it crashes.
</I>&gt;<i> 
</I>&gt;<i> Is there a 'magical' total number of helpers it can manage?
</I>
Depends on exactly why the crash happens.


I suspect it is issues inherent in fork(). The machine needs lots of
virtual memory capacity to run helpers. Not actual memory, or swap space
just virtual memory capacity.

On reconfigure it comes out at something like (N+1)*M + (N+1)*m where N
is the number of helpers, M is Squid current memory usage, and m Squid
memory usage when the existing helpers started.

On startup that is just (N+1)*M, with a smaller value of M so its not so
noticable what will happen later.

The M varies relative to the amount of currently active users. With its
minimum value being cache_mem plus index size.

The dynamic helpers feature can reduce the N down to the minimum Squid
actually needs to operate. But does not solve the problem entirely, and
can make the values of m be a bit larger.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007574.html">[squid-users] Squid 3.5.10 ldap helpers can't &quot;reconfigure&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="007580.html">[squid-users] authentication of every GET request from part of URL?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7576">[ date ]</a>
              <a href="thread.html#7576">[ thread ]</a>
              <a href="subject.html#7576">[ subject ]</a>
              <a href="author.html#7576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
