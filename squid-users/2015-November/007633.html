<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] What does this error mean?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20does%20this%20error%20mean%3F&In-Reply-To=%3C5641F145.4020006%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007632.html">
   <LINK REL="Next"  HREF="007629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] What does this error mean?</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20does%20this%20error%20mean%3F&In-Reply-To=%3C5641F145.4020006%40gmail.com%3E"
       TITLE="[squid-users] What does this error mean?">yvoinov at gmail.com
       </A><BR>
    <I>Tue Nov 10 13:29:41 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007632.html">[squid-users] What does this error mean?
</A></li>
        <LI>Next message (by thread): <A HREF="007629.html">[squid-users] Assert, followed by shm_open() fail.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7633">[ date ]</a>
              <a href="thread.html#7633">[ thread ]</a>
              <a href="subject.html#7633">[ subject ]</a>
              <a href="author.html#7633">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 


10.11.15 18:43, Patrick Flaherty &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On
</I>&gt;<i> Behalf Of <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i> Sent: Tuesday, November 10, 2015 5:09 AM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: squid-users Digest, Vol 15, Issue 26
</I>&gt;<i>
</I>&gt;<i> Send squid-users mailing list submissions to
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific than
</I>&gt;<i> &quot;Re: Contents of squid-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: What does this error mean? (Amos Jeffries)
</I>&gt;<i>    2. Re: Subject: Re: authentication of every GET request from
</I>&gt;<i>       part of URL? (Sreenath BH)
</I>&gt;<i>    3. Re: Subject: Re: authentication of every GET request from
</I>&gt;<i>       part of URL? (Amos Jeffries)
</I>&gt;<i>    4. Assert, followed by shm_open() fail. (Steve Hill)
</I>&gt;<i>    5. Help, long response time(2 seconds) in squid! (=?GBK?B?0OzTwL2h?=)
</I>&gt;<i>    6. cache peer problem with Https only !! (Ahmad Alzaeem)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Tue, 10 Nov 2015 05:38:42 +1300
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] What does this error mean?
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5640CC12.7080907 at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 10/11/2015 1:54 a.m., Yuri Voinov wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This mean that client sent RST packet. You can ignore this error.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well, its not always the client sending it. Could be a NAT device
</I>somewhere
&gt;<i> hitting some timeout or connnection limit and aborting idle connections.
</I>&gt;<i>
</I>&gt;<i> If it is occuring a lot then it might be worth investigating. Having long
</I>&gt;<i> live TCP connections just sitting around unused for very long periods
</I>is not
&gt;<i> very good for resource utilization. Hardware device tables overflowing
</I>in a
&gt;<i> NAT or router device is also pretty bad.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Thank you Yuri and Amos for your responses. The log entry points to the
</I>&gt;<i> Squid IP and one of my client IP addresses. They are connect through an
</I>&gt;<i> 'Internal' network using Oracle's Virtual Box. So there is nothing in
</I>&gt;<i> between meaning it's the client connecting to Squid directly. So it
</I>must be
&gt;<i> out client software creating a RST or the Windows Stack itself.
</I>If your client uses Oracle Virtual Box, guest os usually uses NAT for
external access by default. This explains error.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Patrick
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Mon, 9 Nov 2015 22:42:08 +0530
</I>&gt;<i> From: Sreenath BH &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">bhsreenath at gmail.com</A>&gt;
</I>&gt;<i> To: Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i> Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Subject: Re: authentication of every GET
</I>&gt;<i>     request from part of URL?
</I>&gt;<i> Message-ID:
</I>&gt;<i>     &lt;CALgKBSkUH9JUSB5-ZetZitnUYhW0Keik3QQj2rk-wsjC=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">mM+Bg at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;<i>
</I>&gt;<i> Hi Alex,
</I>&gt;<i>
</I>&gt;<i> thanks for your detailed asnwers.
</I>&gt;<i>
</I>&gt;<i> Here are more details.
</I>&gt;<i> 1. If the URL does not have any token, we would like to send an error
</I>&gt;<i> message back to the browser/client, without doing a cache lookup, or going
</I>&gt;<i> to backend apache server.
</I>&gt;<i>
</I>&gt;<i> 2. If the token is invalid (that is we can't find it in a database), that
</I>&gt;<i> means we can not serve data. In this case we would like to send back a
</I>HTTP
&gt;<i> error (something like a  401 or 404, along with a more descriptive
</I>message)
&gt;<i>
</I>&gt;<i> 3. If the token is valid(found), remove the token from the URL, and use
</I>&gt;<i> remaining part of URL as the key to look in Squid cache.
</I>&gt;<i>
</I>&gt;<i> 4. If found return that data, along with proper HTTP status code.
</I>&gt;<i> 5. If cache lookup fails(not cached), send HTTP request to back-end apache
</I>&gt;<i> server (removing the token), get returned result, store in cache, and
</I>return
&gt;<i> to client/browser.
</I>&gt;<i>
</I>&gt;<i> I read about ACL helper programs, and it appears I can do arbitrary
</I>&gt;<i> validations in it, so should work.
</I>&gt;<i> Is it correct to assume that the external ACL code runs before url
</I>&gt;<i> rewriting?,
</I>&gt;<i>
</I>&gt;<i> Does the URL rewriter run before a cache lookup?
</I>&gt;<i>
</I>&gt;<i> thanks,
</I>&gt;<i> Sreenath
</I>&gt;<i>
</I>&gt;<i> On 11/8/15, Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;&gt;<i> On 11/08/2015 06:34 AM, Sreenath BH wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is there a way for me to invoke some custom code for every request
</I>&gt;&gt;&gt;<i> that Squid receives?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, there are several interfaces, including a built-in ACL, an
</I>&gt;&gt;<i> external ACL helper, a URL rewriter, an eCAP/ICAP service. Roughly
</I>&gt;&gt;<i> speaking, the former ones are easier to use and the latter ones are more
</I>&gt;<i> powerful.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That script would do the following:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1. Extract part of the URL(the token) and look up in a database to
</I>&gt;&gt;&gt;<i> see if it is valid.
</I>&gt;&gt;&gt;<i>     If valid, proceed to lookup cached object, other wise go to
</I>&gt;&gt;&gt;<i> back-end fetch, etc.
</I>&gt;&gt;&gt;<i> 2. If the token is not found in database, return with an error, so
</I>&gt;&gt;&gt;<i> that Squid can send back a not found type (some HTTP error) of
</I>&gt;&gt;&gt;<i> response.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If the above are your requirements, avoid the word &quot;authentication&quot;
</I>&gt;&gt;<i> might help. It confuses people into thinking you want something far
</I>&gt;&gt;<i> more complex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The validation in step #1 can be done by an external ACL. However, you
</I>&gt;&gt;<i> probably forgot to mention that the found token should be removed from
</I>&gt;&gt;<i> the URL. To edit the URL, you need to use a URL rewriter or an
</I>&gt;&gt;<i> eCAP/ICAP service.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Everything else can be done by built-in ACLs unless you need to serve
</I>&gt;&gt;<i> very custom error messages. In the latter case, you will need an eCAP
</I>&gt;&gt;<i> or ICAP service.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However, if &quot;go to back-end fetch&quot; means loading response from some
</I>&gt;&gt;<i> storage external to Squid without using HTTP, then you need an eCAP or
</I>&gt;&gt;<i> ICAP service to do that fetching.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I recommend that you clarify these parts of your specs:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What do you want to do when the token is not found in the URL?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What do you want to do when an invalid token is found in the URL?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Will sending a response using a simple template filled with some basic
</I>&gt;&gt;<i> request details suffice when a valid token is not found in the database?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 7/11/2015 1:33 a.m., Sreenath BH wrote:
</I>&gt;&gt;&gt;&gt;<i> Hi
</I>&gt;&gt;&gt;&gt;<i> I am very new to Squid, and think have a strange requirement.
</I>&gt;&gt;&gt;&gt;<i> We want to serve cached content only if the client has been
</I>&gt;&gt;&gt;&gt;<i> authenticated before.
</I>&gt;&gt;&gt;&gt;<i> Since we don't expect the client software to send any information in
</I>&gt;&gt;&gt;&gt;<i> headers, we embed a token in the URL that we present to the user.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Um, you know how sending username and password in plain-text Basic
</I>&gt;&gt;&gt;<i> auth headers is supposed to be the worst form of security around?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It's not quite. Sending credentials in the URL is worse. Even if its
</I>&gt;&gt;&gt;<i> just an encoded token.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Why are you avoiding actual HTTP authentication?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Why be so actively hostile to every other cache in existence?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> So when the client s/w uses this URL, we want to extract the token
</I>&gt;&gt;&gt;&gt;<i> from URL and do a small database query to ensure that the token is
</I>&gt;&gt;&gt;&gt;<i> valid.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> This is in accelerator mode.
</I>&gt;&gt;&gt;&gt;<i> Is it possible to use something similar to basic_fake_auth and put
</I>&gt;&gt;&gt;&gt;<i> my code there that does some database query?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The &quot;basic_..._auth&quot; parts of that helpers name mean that it performs
</I>&gt;&gt;&gt;<i> HTTP Basic authentication.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The &quot;fake&quot; part means that it does not perform any kind of validation.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> All of the text above has been describing how you want to perform
</I>&gt;&gt;&gt;<i> actions which are the direct opposite of everything basic_fake_auth
</I>does.
&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If the query fails, we don't return the cached content?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> What do you want to be delivered instead?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Amos
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Tue, 10 Nov 2015 06:42:27 +1300
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Subject: Re: authentication of every GET
</I>&gt;<i>     request from part of URL?
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5640DB03.8030200 at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 10/11/2015 6:12 a.m., Sreenath BH wrote:
</I>&gt;&gt;<i> Hi Alex,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> thanks for your detailed asnwers.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here are more details.
</I>&gt;&gt;<i> 1. If the URL does not have any token, we would like to send an error
</I>&gt;&gt;<i> message back to the browser/client, without doing a cache lookup, or
</I>&gt;&gt;<i> going to backend apache server.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. If the token is invalid (that is we can't find it in a database),
</I>&gt;&gt;<i> that means we can not serve data. In this case we would like to send
</I>&gt;&gt;<i> back a HTTP error (something like a  401 or 404, along with a more
</I>&gt;&gt;<i> descriptive message)
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All of the above is external_acl_type helper operations.
</I>&gt;<i>
</I>&gt;&gt;<i> 3. If the token is valid(found), remove the token from the URL, and
</I>&gt;&gt;<i> use remaining part of URL as the key to look in Squid cache.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 4. If found return that data, along with proper HTTP status code.
</I>&gt;<i>
</I>&gt;<i> The above is url_rewrite_program operations.
</I>&gt;<i>
</I>&gt;&gt;<i> 5. If cache lookup fails(not cached), send HTTP request to back-end
</I>&gt;&gt;<i> apache server (removing the token), get returned result, store in
</I>&gt;&gt;<i> cache, and return to client/browser.
</I>&gt;<i>
</I>&gt;<i> And that part is normal caching. Squid will do it by default.
</I>&gt;<i>
</I>&gt;<i> Except the &quot;removing the token&quot; part. Which was done at step #4
</I>already, so
&gt;<i> has no relevance here at step #5.
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I read about ACL helper programs, and it appears I can do arbitrary
</I>&gt;&gt;<i> validations in it, so should work.
</I>&gt;&gt;<i> Is it correct to assume that the external ACL code runs before url
</I>&gt;&gt;<i> rewriting?,
</I>&gt;<i>
</I>&gt;<i> The http_access tests are run before re-writing.
</I>&gt;<i> If the external ACL is one of those http_access tests the answer is yes.
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does the URL rewriter run before a cache lookup?
</I>&gt;<i>
</I>&gt;<i> Yes.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Although, please note that despite this workaround for your cache. It
</I>really
&gt;<i> is *only* your proxy which will work nicely. Every other cache on the
</I>planet
&gt;<i> will see your applications URLs are being unique and needing different
</I>&gt;<i> caching slots.
</I>&gt;<i>
</I>&gt;<i> This not only wastes cache space for them, but also forces them to pass
</I>&gt;<i> extra traffic in the form of full-object fetches at your proxy. Which
</I>raises
&gt;<i> the bandwidth costs for both them and you far beyond what proper header
</I>&gt;<i> based authentication or authorization would.
</I>&gt;<i>
</I>&gt;<i> As the other sysadmin around the world notice this unnecessarily
</I>raised cost
&gt;<i> they will start to hack their configs to force-cache the responses
</I>from your
&gt;<i> application. Which will bypass your protection system entirely since your
</I>&gt;<i> proxy may not not even see many of the requests.
</I>&gt;<i>
</I>&gt;<i> The earlier you can get the application re-design underway to remove the
</I>&gt;<i> credentials token from URL, the earlier the external problems and
</I>costs will
&gt;<i> start to dsappear.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 4
</I>&gt;<i> Date: Mon, 9 Nov 2015 17:58:59 +0000
</I>&gt;<i> From: Steve Hill &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: [squid-users] Assert, followed by shm_open() fail.
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5640DEE3.1030003 at opendium.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;; Format=&quot;flowed&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Squid 3.5.11 I'm seeing occasional asserts:
</I>&gt;<i>
</I>&gt;<i> 2015/11/09 13:45:21 kid1| assertion failed: DestinationIp.cc:41:
</I>&gt;<i> &quot;checklist-&gt;conn() &amp;&amp; checklist-&gt;conn()-&gt;clientConnection != NULL&quot;
</I>&gt;<i>
</I>&gt;<i> More concerning though, is that usually when a Squid process crashes,
</I>it is
&gt;<i> automatically restarted, but following these asserts I'm often seeing:
</I>&gt;<i>
</I>&gt;<i> FATAL: Ipc::Mem::Segment::open failed to
</I>&gt;<i> shm_open(/squidnocache-squidnocache-cf__metadata.shm): (2) No such file or
</I>&gt;<i> directory
</I>&gt;<i>
</I>&gt;<i> After this, Squid is still running, but won't service requests and
</I>requires
&gt;<i> a manual restart.
</I>&gt;<i>
</I>&gt;<i> Has anyone seen this before?
</I>&gt;<i>
</I>&gt;<i> Cheers.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i>   - Steve Hill
</I>&gt;<i>     Technical Director
</I>&gt;<i>     Opendium Limited     <A HREF="http://www.opendium.com">http://www.opendium.com</A>
</I>&gt;<i>
</I>&gt;<i> Direct contacts:
</I>&gt;<i>     Instant messager: xmpp:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
</I>&gt;<i>     Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
</I>&gt;<i>     Phone:            sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
</I>&gt;<i>
</I>&gt;<i> Sales / enquiries contacts:
</I>&gt;<i>     Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>
</I>&gt;<i>     Phone:            +44-1792-824568 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>
</I>&gt;<i>
</I>&gt;<i> Support contacts:
</I>&gt;<i>     Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>
</I>&gt;<i>     Phone:            +44-1792-825748 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> A non-text attachment was scrubbed...
</I>&gt;<i> Name: steve.vcf
</I>&gt;<i> Type: text/x-vcard
</I>&gt;<i> Size: 283 bytes
</I>&gt;<i> Desc: not available
</I>&gt;<i> URL:
</I>&gt;<i>
</I>&lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151109/392">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151109/392</A>
&gt;<i> 307ce/attachment-0001.vcf&gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 5
</I>&gt;<i> Date: Tue, 10 Nov 2015 16:49:27 +0800
</I>&gt;<i> From: &quot;=?GBK?B?0OzTwL2h?=&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yongjianchn at sina.com</A>&gt;
</I>&gt;<i> To: &quot;squid-users&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> Subject: [squid-users] Help, long response time(2 seconds) in squid!
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">20151110084927.3A98EDD8001 at webmail.sinamail.sina.com.cn</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=GBK
</I>&gt;<i>
</I>&gt;<i> Hi, All:
</I>&gt;<i> I tried to use squid as a web cache server today, but when I test it with
</I>&gt;<i> http_load, I found squid may have a latency of 2 seconds in some cases.
</I>&gt;<i> Someone help me? Thanks!
</I>&gt;<i> The test is
</I>&gt;<i> -------
</I>&gt;<i> http_load -parallel 1 -seconds 20 url.txt # the content in url.txt is
</I>&gt;<i> `<A HREF="http://10.210.136.51:3128/xyj/1`">http://10.210.136.51:3128/xyj/1`</A>
</I>&gt;<i> ------
</I>&gt;<i> config for squid is
</I>&gt;<i> -----
</I>&gt;<i> http_port 3128 accel vhost vport
</I>&gt;<i> cache_peer 10.210.136.51 parent 8888 0
</I>&gt;<i> # use mem only
</I>&gt;<i> cache_mem 1000 MB
</I>&gt;<i> -----
</I>&gt;<i> The access log
</I>&gt;<i> -----
</I>&gt;<i> 1447142491.264     39 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream
</I>&gt;<i> 1447142491.283     37 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream
</I>&gt;<i> 1447142493.288   2023 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream #
</I>&gt;<i> 2023 ms! why?
</I>&gt;<i> 1447142493.307   2023 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream #
</I>&gt;<i> 2023 ms! why?
</I>&gt;<i> 1447142493.326     38 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream
</I>&gt;<i> 1447142493.348     40 10.210.136.54 TCP_MEM_HIT_ABORTED/200 4165 GET
</I>&gt;<i> <A HREF="http://10.210.136.51:3128/xyj/1">http://10.210.136.51:3128/xyj/1</A> - HIER_NONE/- application/octet-stream
</I>&gt;<i> -----
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 6
</I>&gt;<i> Date: Tue, 10 Nov 2015 12:08:50 +0300
</I>&gt;<i> From: &quot;Ahmad Alzaeem&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ahmed.zaeem at netstream.ps</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> Subject: [squid-users] cache peer problem with Https only !!
</I>&gt;<i> Message-ID: &lt;000b01d11b97$6a894e10$3f9bea30$@netstream.ps&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i> Hi im using pfsense with cache peer
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Squid version is 3.4.10
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> I have peer proxy on port 80 and I can use it with http and https
</I>&gt;<i>
</I>&gt;<i> Now if I use pfsense in the middle and let pfsense go to remote proxy
</I>&gt;<i> (10.12.0.32  port 80 )
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> And I get internt from the pfsense proxy
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> I only have http websites working !!!
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> But https websites don't work
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Any help ?
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Here is my pfsnese config :
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # This file is automatically generated by pfSense
</I>&gt;<i>
</I>&gt;<i> # Do not edit manually !
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> http_port 172.23.101.253:3128
</I>&gt;<i>
</I>&gt;<i> icp_port 0
</I>&gt;<i>
</I>&gt;<i> dns_v4_first on
</I>&gt;<i>
</I>&gt;<i> pid_filename /var/run/squid/squid.pid
</I>&gt;<i>
</I>&gt;<i> cache_effective_user proxy
</I>&gt;<i>
</I>&gt;<i> cache_effective_group proxy
</I>&gt;<i>
</I>&gt;<i> error_default_language en
</I>&gt;<i>
</I>&gt;<i> icon_directory /usr/pbi/squid-amd64/local/etc/squid/icons
</I>&gt;<i>
</I>&gt;<i> visible_hostname mne
</I>&gt;<i>
</I>&gt;<i> cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>
</I>&gt;<i>
</I>&gt;<i> access_log /var/squid/logs/access.log
</I>&gt;<i>
</I>&gt;<i> cache_log /var/squid/logs/cache.log
</I>&gt;<i>
</I>&gt;<i> cache_store_log none
</I>&gt;<i>
</I>&gt;<i> netdb_filename /var/squid/logs/netdb.state
</I>&gt;<i>
</I>&gt;<i> pinger_enable off
</I>&gt;<i>
</I>&gt;<i> pinger_program /usr/pbi/squid-amd64/local/libexec/squid/pinger
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> logfile_rotate 2
</I>&gt;<i>
</I>&gt;<i> debug_options rotate=2
</I>&gt;<i>
</I>&gt;<i> shutdown_lifetime 3 seconds
</I>&gt;<i>
</I>&gt;<i> # Allow local network(s) on interface(s)
</I>&gt;<i>
</I>&gt;<i> acl localnet src  172.23.101.0/24
</I>&gt;<i>
</I>&gt;<i> forwarded_for off
</I>&gt;<i>
</I>&gt;<i> via off
</I>&gt;<i>
</I>&gt;<i> httpd_suppress_version_string on
</I>&gt;<i>
</I>&gt;<i> uri_whitespace strip
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> acl dynamic urlpath_regex cgi-bin ?
</I>&gt;<i>
</I>&gt;<i> cache deny dynamic
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> cache_mem 64 MB
</I>&gt;<i>
</I>&gt;<i> maximum_object_size_in_memory 256 KB
</I>&gt;<i>
</I>&gt;<i> memory_replacement_policy heap GDSF
</I>&gt;<i>
</I>&gt;<i> cache_replacement_policy heap LFUDA
</I>&gt;<i>
</I>&gt;<i> minimum_object_size 0 KB
</I>&gt;<i>
</I>&gt;<i> maximum_object_size 4 MB
</I>&gt;<i>
</I>&gt;<i> cache_dir ufs /var/squid/cache 100 16 256
</I>&gt;<i>
</I>&gt;<i> offline_mode off
</I>&gt;<i>
</I>&gt;<i> cache_swap_low 90
</I>&gt;<i>
</I>&gt;<i> cache_swap_high 95
</I>&gt;<i>
</I>&gt;<i> cache allow all
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Add any of your own refresh_pattern entries above these.
</I>&gt;<i>
</I>&gt;<i> refresh_pattern ^ftp:    1440  20%  10080
</I>&gt;<i>
</I>&gt;<i> refresh_pattern ^gopher:  1440  0%  1440
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|?) 0  0%  0
</I>&gt;<i>
</I>&gt;<i> refresh_pattern .    0  20%  4320
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> #Remote proxies
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Setup some default acls
</I>&gt;<i>
</I>&gt;<i> # From 3.2 further configuration cleanups have been done to make things
</I>&gt;<i> easier and safer. The manager, localhost, and to_localhost ACL definitions
</I>&gt;<i> are now built-in.
</I>&gt;<i>
</I>&gt;<i> # acl localhost src 127.0.0.1/32
</I>&gt;<i>
</I>&gt;<i> acl allsrc src all
</I>&gt;<i>
</I>&gt;<i> acl safeports port 21 70 80 210 280 443 488 563 591 631 777 901  3128 3127
</I>&gt;<i> 1025-65535
</I>&gt;<i>
</I>&gt;<i> acl sslports port 443 563 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # From 3.2 further configuration cleanups have been done to make things
</I>&gt;<i> easier and safer. The manager, localhost, and to_localhost ACL definitions
</I>&gt;<i> are now built-in.
</I>&gt;<i>
</I>&gt;<i> #acl manager proto cache_object
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> acl purge method PURGE
</I>&gt;<i>
</I>&gt;<i> acl connect method CONNECT
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Define protocols used for redirects
</I>&gt;<i>
</I>&gt;<i> acl HTTP proto HTTP
</I>&gt;<i>
</I>&gt;<i> acl HTTPS proto HTTPS
</I>&gt;<i>
</I>&gt;<i> http_access allow manager localhost
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> http_access deny manager
</I>&gt;<i>
</I>&gt;<i> http_access allow purge localhost
</I>&gt;<i>
</I>&gt;<i> http_access deny purge
</I>&gt;<i>
</I>&gt;<i> http_access deny !safeports
</I>&gt;<i>
</I>&gt;<i> http_access deny CONNECT !sslports
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Always allow localhost connections
</I>&gt;<i>
</I>&gt;<i> # From 3.2 further configuration cleanups have been done to make things
</I>&gt;<i> easier and safer.
</I>&gt;<i>
</I>&gt;<i> # The manager, localhost, and to_localhost ACL definitions are now
</I>built-in.
&gt;<i>
</I>&gt;<i> # http_access allow localhost
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> request_body_max_size 0 KB
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> delay_access 1 allow allsrc
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Reverse Proxy settings
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Custom options before auth
</I>&gt;<i>
</I>&gt;<i> dns_nameservers 8.8.8.8 10.12.0.33
</I>&gt;<i>
</I>&gt;<i> cache_peer 10.12.0.32  parent 80 0 no-query no-digest no-tproxy proxy-only
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> # Setup allowed acls
</I>&gt;<i>
</I>&gt;<i> # Allow local network(s) on interface(s)
</I>&gt;<i>
</I>&gt;<i> http_access allow localnet
</I>&gt;<i>
</I>&gt;<i> # Default block all to be sure
</I>&gt;<i>
</I>&gt;<i> http_access deny allsrc
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> cheers
</I>&gt;<i>
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL:
</I>&gt;<i>
</I>&lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/9d3">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/9d3</A>
&gt;<i> a01a2/attachment.html&gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of squid-users Digest, Vol 15, Issue 26
</I>&gt;<i> *******************************************
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJWQfFFAAoJENNXIZxhPexGJzUH/2fsssCEk/U15HSfAv1ItWEv
IEIejXtS7CRK+TPhRG71qQUqA/WAuPEGg3VPMlbr+PgWJtkhR075SXbuPaG6A/IQ
ql3OXptyo3rh37wQhFV7nsORHZuX8dzF7XhZ0W8eLFoQ0WcMr6wIo1ojauNoJu/0
zG+WvYBoT5VxgXomYAtNKoBfQPj0bHiHDDLWRYAomepSMbl2Bh/xRdnthQo7DV9q
rhKLJw/WOVdYtxBOlKb9jUMPHIkI+NK94JtDcCrdPOK3dKM20OcPGBZ1Ei/xraUh
Yazy5Uw/nzInreJpoFl44Blo5JPtEVwS8YXOh8xzG+cRjUpPkjgg7ABtISGk+IE=
=4e/5
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007632.html">[squid-users] What does this error mean?
</A></li>
	<LI>Next message (by thread): <A HREF="007629.html">[squid-users] Assert, followed by shm_open() fail.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7633">[ date ]</a>
              <a href="thread.html#7633">[ thread ]</a>
              <a href="subject.html#7633">[ subject ]</a>
              <a href="author.html#7633">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
