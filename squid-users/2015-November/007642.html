<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache peer only forward http , not https !!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C56422E1D.9030103%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007641.html">
   <LINK REL="Next"  HREF="007644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache peer only forward http , not https !!!</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C56422E1D.9030103%40gmail.com%3E"
       TITLE="[squid-users] cache peer only forward http , not https !!!">yvoinov at gmail.com
       </A><BR>
    <I>Tue Nov 10 17:49:17 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007641.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
        <LI>Next message (by thread): <A HREF="007644.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7642">[ date ]</a>
              <a href="thread.html#7642">[ thread ]</a>
              <a href="subject.html#7642">[ subject ]</a>
              <a href="author.html#7642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
1. You need to configure Squid with SSL Bump to capture HTTPS traffic.
2. You need to configure forwarded requests with splice/no bump. :)

10.11.15 22:42, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi Guys I want proxy  and I want it to forward http &amp; https to remote proxy
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Does the command below enogh ?
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> cache_peer 10.12.0.32  parent 8080  0 no-query no-digest no-tproxy
</I>&gt;<i> proxy-only
</I>No.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> or I need to add other line for https ??
</I>No.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> BTW the command line above work only for http not for https
</I>Sure.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Any help ?
</I>
*** DISCLAMER: THIS IS MY OWN CONFIG SNIPPET. DON'T BLIND COPY-N-PASTE
IT IN YOUR ENVIRONMENT! ***

# Privoxy+Tor acl
acl tor_url dstdom_regex &quot;C:/Squid/etc/squid/url.tor&quot;

# SSL bump rules
sslproxy_cert_error allow all
acl DiscoverSNIHost at_step SslBump1
ssl_bump peek DiscoverSNIHost
acl NoSSLIntercept ssl::server_name_regex -i &quot;C:/Squid/etc/squid/url.nobump&quot;
acl NoSSLIntercept ssl::server_name_regex -i &quot;C:/Squid/etc/squid/url.tor&quot;
ssl_bump splice NoSSLIntercept
ssl_bump bump all

# Privoxy+Tor access rules
never_direct allow tor_url

# Local Privoxy is cache parent
cache_peer 127.0.0.1 parent 8118 0 no-query no-digest default

cache_peer_access 127.0.0.1 allow tor_url
cache_peer_access 127.0.0.1 deny all

As you can see, this is just example. The idea described with first two
lines of my answer above.
This snippet works for torified sites described in tor_url acl.
NB: I do not guarantee this will work on your environment!

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJWQi4dAAoJENNXIZxhPexG0SEH/jjiJogO+BkgsjCLjt394UQ6
0qniwV6kBg9daS/3AWrLE3VizP8LnsHwLo3EQi/hdcuY0QPZUwablWt0emGlkZ/w
EnUUeyuZwqV9EP2z+I3apwg49E9vVV/dv6+HJSkorj0ibMlTPvdT4nMKr/zywnp7
fLmyQ8Gfn418g8+SHcQvouHFGRRecLjLi/B9OjdsT29O0tpH628Spv5+JYBzGrqh
FulBz6tzRLpE8W3JHMJjSXEuXbjeI8F2TVPd23g0TeBQaNMKAJwR9qPiYBgBJBhW
9Wk45ccPcwFHxZJgVZCkfj0SHVvnNX3A7tCwldQNFh9DveKtobRJTntMGqljwWI=
=dgIc
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/09fd2594/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/09fd2594/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007641.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
	<LI>Next message (by thread): <A HREF="007644.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7642">[ date ]</a>
              <a href="thread.html#7642">[ thread ]</a>
              <a href="subject.html#7642">[ subject ]</a>
              <a href="author.html#7642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
