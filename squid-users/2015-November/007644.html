<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache peer only forward http , not https !!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C005501d11bdb%24db1a0b80%24914e2280%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007642.html">
   <LINK REL="Next"  HREF="007645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache peer only forward http , not https !!!</H1>
    <B>Ahmad Alzaeem</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C005501d11bdb%24db1a0b80%24914e2280%24%40netstream.ps%3E"
       TITLE="[squid-users] cache peer only forward http , not https !!!">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Tue Nov 10 17:18:45 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007642.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
        <LI>Next message (by thread): <A HREF="007645.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7644">[ date ]</a>
              <a href="thread.html#7644">[ thread ]</a>
              <a href="subject.html#7644">[ subject ]</a>
              <a href="author.html#7644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you , 

 

Can you just guide me for the https peer directive plz ?

I can take care of https intercept

 

So with http , we have directive cache_peer 10.12.0.32  parent 8080  0 no-query no-digest

 

As ok

 

Now what about https directive ?

Can u help me

 

Thanks a lot a lot a lot for your help

 

cheers

 

 

From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Yuri Voinov
Sent: Tuesday, November 10, 2015 8:49 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] cache peer only forward http , not https !!!

 


-----BEGIN PGP SIGNED MESSAGE----- 
Hash: SHA256 
 
1. You need to configure Squid with SSL Bump to capture HTTPS traffic.
2. You need to configure forwarded requests with splice/no bump. :)

10.11.15 22:42, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi Guys I want proxy  and I
</I>
      want it to forward http &amp; https to remote proxy



      &gt;



      &gt;  



      &gt;



      &gt; Does the command below enogh ?



      &gt;



      &gt;  



      &gt;



      &gt; cache_peer 10.12.0.32  parent 8080  0 no-query no-digest

      no-tproxy



      &gt; proxy-only
No.
&gt;<i>
</I>


      &gt;



      &gt;  



      &gt;



      &gt; or I need to add other line for https ??
No.
&gt;<i>
</I>


      &gt;



      &gt;  



      &gt;



      &gt; BTW the command line above work only for http not for https 
Sure.
&gt;<i>
</I>


      &gt;



      &gt;  



      &gt;



      &gt; Any help ?

*** DISCLAMER: THIS IS MY OWN CONFIG SNIPPET. DON'T BLIND COPY-N-PASTE IT IN YOUR ENVIRONMENT! ***

# Privoxy+Tor acl
acl tor_url dstdom_regex &quot;C:/Squid/etc/squid/url.tor&quot;

# SSL bump rules
sslproxy_cert_error allow all
acl DiscoverSNIHost at_step SslBump1
ssl_bump peek DiscoverSNIHost
acl NoSSLIntercept ssl::server_name_regex -i &quot;C:/Squid/etc/squid/url.nobump&quot;
acl NoSSLIntercept ssl::server_name_regex -i &quot;C:/Squid/etc/squid/url.tor&quot;
ssl_bump splice NoSSLIntercept
ssl_bump bump all

# Privoxy+Tor access rules
never_direct allow tor_url

# Local Privoxy is cache parent
cache_peer 127.0.0.1 parent 8118 0 no-query no-digest default

cache_peer_access 127.0.0.1 allow tor_url
cache_peer_access 127.0.0.1 deny all

As you can see, this is just example. The idea described with first two lines of my answer above.
This snippet works for torified sites described in tor_url acl.
NB: I do not guarantee this will work on your environment!

&gt;<i>
</I>


      &gt;



      &gt;  



      &gt;



      &gt;  



      &gt;



      &gt;



     &gt;



      &gt;



      &gt; _______________________________________________



      &gt; squid-users mailing list



      &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 



      &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

-----BEGIN PGP SIGNATURE----- 
Version: GnuPG v2 
 
iQEcBAEBCAAGBQJWQi4dAAoJENNXIZxhPexG0SEH/jjiJogO+BkgsjCLjt394UQ6 
0qniwV6kBg9daS/3AWrLE3VizP8LnsHwLo3EQi/hdcuY0QPZUwablWt0emGlkZ/w 
EnUUeyuZwqV9EP2z+I3apwg49E9vVV/dv6+HJSkorj0ibMlTPvdT4nMKr/zywnp7 
fLmyQ8Gfn418g8+SHcQvouHFGRRecLjLi/B9OjdsT29O0tpH628Spv5+JYBzGrqh 
FulBz6tzRLpE8W3JHMJjSXEuXbjeI8F2TVPd23g0TeBQaNMKAJwR9qPiYBgBJBhW 
9Wk45ccPcwFHxZJgVZCkfj0SHVvnNX3A7tCwldQNFh9DveKtobRJTntMGqljwWI= 
=dgIc 
-----END PGP SIGNATURE----- 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/1f2388e2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151110/1f2388e2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007642.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
	<LI>Next message (by thread): <A HREF="007645.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7644">[ date ]</a>
              <a href="thread.html#7644">[ thread ]</a>
              <a href="subject.html#7644">[ subject ]</a>
              <a href="author.html#7644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
