<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache peer only forward http , not https !!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C564237B0.9000308%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007645.html">
   <LINK REL="Next"  HREF="007647.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache peer only forward http , not https !!!</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C564237B0.9000308%40gmail.com%3E"
       TITLE="[squid-users] cache peer only forward http , not https !!!">yvoinov at gmail.com
       </A><BR>
    <I>Tue Nov 10 18:30:08 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007645.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
        <LI>Next message (by thread): <A HREF="007647.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7646">[ date ]</a>
              <a href="thread.html#7646">[ thread ]</a>
              <a href="subject.html#7646">[ subject ]</a>
              <a href="author.html#7646">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
I'm probably a little misled. The fact that my configuration is a proxy
with a bump. What complicates the task. In the case of conventional
non-transparent proxy no tricks are usually not required except that it
is necessary to enforce drive of the encrypted traffic to the proxy.

10.11.15 23:18, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Thank you , 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Can you just guide me for the https peer directive plz ?
</I>&gt;<i>
</I>&gt;<i> I can take care of https intercept
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> So with http , we have directive cache_peer 10.12.0.32  parent 8080  0
</I>no-query no-digest
&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> As ok
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Now what about https directive ?
</I>&gt;<i>
</I>&gt;<i> Can u help me
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> Thanks a lot a lot a lot for your help
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> cheers
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>]
</I>On Behalf Of Yuri Voinov
&gt;<i> Sent: Tuesday, November 10, 2015 8:49 PM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] cache peer only forward http , not https !!!
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 1. You need to configure Squid with SSL Bump to capture HTTPS traffic.
</I>&gt;<i> 2. You need to configure forwarded requests with splice/no bump. :)
</I>&gt;<i>
</I>&gt;<i> 10.11.15 22:42, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; Hi Guys I want proxy  and I
</I>&gt;<i>
</I>&gt;<i>       want it to forward http &amp; https to remote proxy
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; Does the command below enogh ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; cache_peer 10.12.0.32  parent 8080  0 no-query no-digest
</I>&gt;<i>
</I>&gt;<i>       no-tproxy
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; proxy-only
</I>&gt;<i> No.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; or I need to add other line for https ??
</I>&gt;<i> No.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; BTW the command line above work only for http not for https
</I>&gt;<i> Sure.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; Any help ?
</I>&gt;<i>
</I>&gt;<i> *** DISCLAMER: THIS IS MY OWN CONFIG SNIPPET. DON'T BLIND COPY-N-PASTE
</I>IT IN YOUR ENVIRONMENT! ***
&gt;<i>
</I>&gt;<i> # Privoxy+Tor acl
</I>&gt;<i> acl tor_url dstdom_regex &quot;C:/Squid/etc/squid/url.tor&quot;
</I>&gt;<i>
</I>&gt;<i> # SSL bump rules
</I>&gt;<i> sslproxy_cert_error allow all
</I>&gt;<i> acl DiscoverSNIHost at_step SslBump1
</I>&gt;<i> ssl_bump peek DiscoverSNIHost
</I>&gt;<i> acl NoSSLIntercept ssl::server_name_regex -i
</I>&quot;C:/Squid/etc/squid/url.nobump&quot;
&gt;<i> acl NoSSLIntercept ssl::server_name_regex -i &quot;C:/Squid/etc/squid/url.tor&quot;
</I>&gt;<i> ssl_bump splice NoSSLIntercept
</I>&gt;<i> ssl_bump bump all
</I>&gt;<i>
</I>&gt;<i> # Privoxy+Tor access rules
</I>&gt;<i> never_direct allow tor_url
</I>&gt;<i>
</I>&gt;<i> # Local Privoxy is cache parent
</I>&gt;<i> cache_peer 127.0.0.1 parent 8118 0 no-query no-digest default
</I>&gt;<i>
</I>&gt;<i> cache_peer_access 127.0.0.1 allow tor_url
</I>&gt;<i> cache_peer_access 127.0.0.1 deny all
</I>&gt;<i>
</I>&gt;<i> As you can see, this is just example. The idea described with first
</I>two lines of my answer above.
&gt;<i> This snippet works for torified sites described in tor_url acl.
</I>&gt;<i> NB: I do not guarantee this will work on your environment!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; _______________________________________________
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; squid-users mailing list
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJWQjewAAoJENNXIZxhPexGIdcH/Rf/cWyQd0iOxDOe2ICKLe3j
TEAeDl3kRPZ0tBER2EUgUScgTPYrUycQKNQ6FFX59pZMhekyWihsQoyG4o5Kr+GF
VjISK4RGGm3u9nma5uX4ksz1EcxRkfW+fdR+qfQvz4mjH22vC8Y2sC6IzogekwoJ
GSkP7QLWGAKJgJzmy7edsNUFkSXdKKxmmItL5ZfEIoc+f4zRLg7czfL1/D9Kh1Pt
YsSCJtTbb5k6H/IGgQmIxBYjDMsG04VoVjHjqgVTmb+8tcmScwxnHiBpn97AtepY
1oj5TnizKqCIgsUQeb/yi71l7JXl+9JskLrOMsca27h67woz2aA0FSJ4BlBBd/M=
=CD0W
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/17cfa989/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/17cfa989/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007645.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
	<LI>Next message (by thread): <A HREF="007647.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7646">[ date ]</a>
              <a href="thread.html#7646">[ thread ]</a>
              <a href="subject.html#7646">[ subject ]</a>
              <a href="author.html#7646">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
