<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache peer only forward http , not https !!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C56431282.4040208%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007656.html">
   <LINK REL="Next"  HREF="007660.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache peer only forward http , not https !!!</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C56431282.4040208%40gmail.com%3E"
       TITLE="[squid-users] cache peer only forward http , not https !!!">yvoinov at gmail.com
       </A><BR>
    <I>Wed Nov 11 10:03:46 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007656.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
        <LI>Next message (by thread): <A HREF="007660.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7657">[ date ]</a>
              <a href="thread.html#7657">[ thread ]</a>
              <a href="subject.html#7657">[ subject ]</a>
              <a href="author.html#7657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You need to locate URLs which must be forward to parent.

If this is all URL's, config must looks like this:

never_direct allow all
cache_peer &lt;peer_ip&gt; parent &lt;peer_port&gt; 0 no-query no-digest default
cache_peer_access 127.0.0.1 allow all

And, finally, you must use Squid 3.5.x. Thit will not be work on 3.4.x.

11.11.15 14:39, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i>
</I>&gt;<i> Here is what I mean
</I>&gt;<i>
</I>&gt;<i> [2.2.2-RELEASE][<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at pfSense.mne</A>]/root: tail -f 
</I>&gt;<i> /var/squid/logs/access.log
</I>&gt;<i>
</I>&gt;<i> 1447234509.328 9718 172.23.101.251 TCP_MISS/200 1448 CONNECT 
</I>&gt;<i> tiles-cloudfront.cdn.mozilla.net:443 - HIER_DIRECT/54.192.55.248 -
</I>&gt;<i>
</I>&gt;<i> 1447234514.482 9622 172.23.101.251 TCP_MISS/200 1448 CONNECT 
</I>&gt;<i> shavar.services.mozilla.com:443 - HIER_DIRECT/54.187.101.179 -
</I>&gt;<i>
</I>&gt;<i> 1447234519.858 59952 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> www.youtube.com:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234560.135 71105 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> incoming.telemetry.mozilla.org:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234569.644 70033 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234569.644 70033 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234569.644 70033 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234575.091 60607 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> shavar.services.mozilla.com:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234605.998 76379 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> self-repair.mozilla.org:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> 1447234651.018 75705 172.23.101.251 TCP_MISS/503 0 CONNECT 
</I>&gt;<i> safebrowsing.google.com:443 - HIER_NONE/- -
</I>&gt;<i>
</I>&gt;<i> cheers
</I>&gt;<i>
</I>&gt;<i> *From:*Yuri Voinov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>]
</I>&gt;<i> *Sent:* Wednesday, November 11, 2015 12:49 AM
</I>&gt;<i> *To:* Ahmad Alzaeem
</I>&gt;<i> *Cc:* <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>; 'Amos Jeffries'
</I>&gt;<i> *Subject:* Re: [squid-users] cache peer only forward http , not https !!!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA256
</I>&gt;<i>
</I>&gt;<i> Are you see in access.log ip:443 CONNECT records?
</I>&gt;<i>
</I>&gt;<i> I.e., does your HTTPS traffic incoming to Squid?
</I>&gt;<i>
</I>&gt;<i> 11.11.15 1:45, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; Hi I don&#8217;t have ssl pump
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; All my users user ip:port to have internet
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; I already have ISA windows server and it works with http and
</I>&gt;<i>
</I>&gt;<i>       https
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; Im wondering why all complexity needed for peer https
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; !!!
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; Anyway hnere is squid.conf
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; # This file is automatically generated by pfSense
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; # Do not edit manually !
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; http_port 172.23.101.253:3128
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; icp_port 0
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; dns_v4_first on
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; pid_filename /var/run/squid/squid.pid
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; cache_effective_user proxy
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; cache_effective_group proxy
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; error_default_language en
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; icon_directory /usr/pbi/squid-amd64/local/etc/squid/icons
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; visible_hostname mne
</I>&gt;<i>
</I>&gt;<i>       &gt;
</I>&gt;<i>
</I>&gt;<i>       &gt; cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt; 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt;
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/db26dde8/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/db26dde8/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007656.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
	<LI>Next message (by thread): <A HREF="007660.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7657">[ date ]</a>
              <a href="thread.html#7657">[ thread ]</a>
              <a href="subject.html#7657">[ subject ]</a>
              <a href="author.html#7657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
