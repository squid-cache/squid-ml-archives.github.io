<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache peer only forward http , not https !!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C000701d11c68%245f0e1530%241d2a3f90%24%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007657.html">
   <LINK REL="Next"  HREF="007661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache peer only forward http , not https !!!</H1>
    <B>Ahmad Alzaeem</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20peer%20only%20forward%20http%20%2C%20not%20https%20%21%21%21&In-Reply-To=%3C000701d11c68%245f0e1530%241d2a3f90%24%40netstream.ps%3E"
       TITLE="[squid-users] cache peer only forward http , not https !!!">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Wed Nov 11 10:04:36 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007657.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
        <LI>Next message (by thread): <A HREF="007661.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7660">[ date ]</a>
              <a href="thread.html#7660">[ thread ]</a>
              <a href="subject.html#7660">[ subject ]</a>
              <a href="author.html#7660">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bro you were awsome !

 

Thank you it worked

 

I appreciate your help a lot

 

I wish there is feedback in mailing list to give you 5/5 stars

:<i>)
</I>
 

cheers

 

From: Yuri Voinov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>] 
Sent: Wednesday, November 11, 2015 1:04 PM
To: Ahmad Alzaeem
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] cache peer only forward http , not https !!!

 

You need to locate URLs which must be forward to parent.

If this is all URL's, config must looks like this:

never_direct allow all
cache_peer &lt;peer_ip&gt; parent &lt;peer_port&gt; 0 no-query no-digest default
cache_peer_access 127.0.0.1 allow all

And, finally, you must use Squid 3.5.x. Thit will not be work on 3.4.x.

11.11.15 14:39, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:

Here is what I mean 

[2.2.2-RELEASE][<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at pfSense.mne</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at pfSense.mne</A>&gt; ]/root: tail -f /var/squid/logs/access.log 

1447234509.328   9718 172.23.101.251 TCP_MISS/200 1448 CONNECT tiles-cloudfront.cdn.mozilla.net:443 - HIER_DIRECT/54.192.55.248 -

1447234514.482   9622 172.23.101.251 TCP_MISS/200 1448 CONNECT shavar.services.mozilla.com:443 - HIER_DIRECT/54.187.101.179 -

1447234519.858  59952 172.23.101.251 TCP_MISS/503 0 CONNECT www.youtube.com:443 &lt;<A HREF="http://www.youtube.com:443">http://www.youtube.com:443</A>&gt;  - HIER_NONE/- -

1447234560.135  71105 172.23.101.251 TCP_MISS/503 0 CONNECT incoming.telemetry.mozilla.org:443 - HIER_NONE/- -

1447234569.644  70033 172.23.101.251 TCP_MISS/503 0 CONNECT tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -

1447234569.644  70033 172.23.101.251 TCP_MISS/503 0 CONNECT tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -

1447234569.644  70033 172.23.101.251 TCP_MISS/503 0 CONNECT tiles-cloudfront.cdn.mozilla.net:443 - HIER_NONE/- -

1447234575.091  60607 172.23.101.251 TCP_MISS/503 0 CONNECT shavar.services.mozilla.com:443 - HIER_NONE/- -

1447234605.998  76379 172.23.101.251 TCP_MISS/503 0 CONNECT self-repair.mozilla.org:443 - HIER_NONE/- -

1447234651.018  75705 172.23.101.251 TCP_MISS/503 0 CONNECT safebrowsing.google.com:443 - HIER_NONE/- -

 

cheers

 

From: Yuri Voinov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>] 
Sent: Wednesday, November 11, 2015 12:49 AM
To: Ahmad Alzaeem
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>; 'Amos Jeffries'
Subject: Re: [squid-users] cache peer only forward http , not https !!!

 


-----BEGIN PGP SIGNED MESSAGE----- 
Hash: SHA256 
 
Are you see in access.log ip:443 CONNECT records?

I.e., does your HTTPS traffic incoming to Squid?

11.11.15 1:45, Ahmad Alzaeem &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi I don&#8217;t have ssl pump
</I>



      &gt;




      &gt;  




      &gt;




      &gt; All my users user ip:port to have internet




      &gt;




      &gt;  




      &gt;




      &gt;  




      &gt;




      &gt; I already have ISA windows server and it works with http and

      https




      &gt;




      &gt;  




      &gt;




      &gt; Im wondering why all complexity needed for peer https 




      &gt;




      &gt; !!!




      &gt;




      &gt;  




      &gt;




      &gt;  




      &gt;




      &gt; Anyway hnere is squid.conf




      &gt;




      &gt;  




      &gt;




      &gt; # This file is automatically generated by pfSense




      &gt;




      &gt; # Do not edit manually !




      &gt;




      &gt;  




      &gt;




      &gt; http_port 172.23.101.253:3128




      &gt;




      &gt; icp_port 0




      &gt;




      &gt; dns_v4_first on




      &gt;




      &gt; pid_filename /var/run/squid/squid.pid




      &gt;




      &gt; cache_effective_user proxy




      &gt;




      &gt; cache_effective_group proxy




      &gt;




      &gt; error_default_language en




      &gt;




      &gt; icon_directory /usr/pbi/squid-amd64/local/etc/squid/icons




      &gt;




      &gt; visible_hostname mne




      &gt;




      &gt; cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt;   &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">azaeem at mne.ps</A>&gt; 
 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/1af04a5d/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151111/1af04a5d/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007657.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
	<LI>Next message (by thread): <A HREF="007661.html">[squid-users] cache peer only forward http , not https !!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7660">[ date ]</a>
              <a href="thread.html#7660">[ thread ]</a>
              <a href="subject.html#7660">[ subject ]</a>
              <a href="author.html#7660">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
