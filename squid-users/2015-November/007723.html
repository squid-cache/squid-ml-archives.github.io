<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid &quot;bumping&quot; traffic despite using &quot;splice&quot; directive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%22bumping%22%20traffic%20despite%20using%20%22splice%22%0A%20directive&In-Reply-To=%3C56452801.4090505%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007722.html">
   <LINK REL="Next"  HREF="007721.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid &quot;bumping&quot; traffic despite using &quot;splice&quot; directive</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%22bumping%22%20traffic%20despite%20using%20%22splice%22%0A%20directive&In-Reply-To=%3C56452801.4090505%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid &quot;bumping&quot; traffic despite using &quot;splice&quot; directive">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Nov 13 00:00:01 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007722.html">[squid-users] Squid &quot;bumping&quot; traffic despite using &quot;splice&quot; directive
</A></li>
        <LI>Next message (by thread): <A HREF="007721.html">[squid-users] disable/enable user accounts--please help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7723">[ date ]</a>
              <a href="thread.html#7723">[ thread ]</a>
              <a href="subject.html#7723">[ subject ]</a>
              <a href="author.html#7723">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/12/2015 04:47 PM, Amos Jeffries wrote:
&gt;<i> On 13/11/2015 8:12 a.m., Alex Rousskov wrote:
</I>&gt;&gt;<i> On 11/12/2015 11:31 AM, Tom Mowbray wrote:
</I>&gt;&gt;&gt;<i> acl sslallow ssl::server_name &quot;/path/to/file&quot;
</I>&gt;&gt;&gt;<i> ssl_bump peek all
</I>&gt;&gt;&gt;<i> ssl_bump splice sslallow
</I>&gt;&gt;&gt;<i> ssl_bump terminate all
</I>

&gt;<i> I am wondering if this is all a misunderstanding of what happens when a
</I>&gt;<i> peek is being done at step2 / server cert details ?
</I>&gt;<i> 
</I>&gt;<i> I think this ordering better matches the policy:
</I>&gt;<i> 
</I>&gt;<i>  ssl_bump splice sslallow
</I>&gt;<i>  ssl_bump peek all
</I>&gt;<i>  ssl_bump terminate all
</I>

This order will reduce the number of SSL validation errors (if any)
because splicing will often happen before step3 with this order, but it
cannot solve the actual problem IMO (only mask it and/or make it less
frequent).


On 11/12/2015 12:48 PM, Tom Mowbray wrote:
&gt;<i> We have squid set to &quot;deny all&quot; on certificate error.
</I>

Which instructs Squid to bump SSL connections that have certificate
validation or similar SSL errors (from Squid point of view).


&gt;<i> I don't see anything strange in the access log, just the initial CONNECT request
</I>
If there was an SSL validation error, Squid should reply with 200 OK to
the CONNECT but also log SSL validation error details (on the same
access.log line as the CONNECT transaction). Please add %err_code,
%err_detail, and %ssl::&lt;cert_errors to your access.log format line (if
not already there) and see if they give any clues.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007722.html">[squid-users] Squid &quot;bumping&quot; traffic despite using &quot;splice&quot; directive
</A></li>
	<LI>Next message (by thread): <A HREF="007721.html">[squid-users] disable/enable user accounts--please help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7723">[ date ]</a>
              <a href="thread.html#7723">[ thread ]</a>
              <a href="subject.html#7723">[ subject ]</a>
              <a href="author.html#7723">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
