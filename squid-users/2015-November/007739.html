<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] sslBump adventures in enterprise production environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslBump%20adventures%20in%20enterprise%20production%0A%20environment&In-Reply-To=%3C5645EB51.4060000%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007734.html">
   <LINK REL="Next"  HREF="007759.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] sslBump adventures in enterprise production environment</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslBump%20adventures%20in%20enterprise%20production%0A%20environment&In-Reply-To=%3C5645EB51.4060000%40gmail.com%3E"
       TITLE="[squid-users] sslBump adventures in enterprise production environment">yvoinov at gmail.com
       </A><BR>
    <I>Fri Nov 13 13:53:21 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007734.html">[squid-users] sslBump adventures in enterprise production	environment
</A></li>
        <LI>Next message (by thread): <A HREF="007759.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7739">[ date ]</a>
              <a href="thread.html#7739">[ thread ]</a>
              <a href="subject.html#7739">[ subject ]</a>
              <a href="author.html#7739">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
There is no solution for ICQ with Squid now.

You can only bypass proxying for ICQ clients.

13.11.15 14:41, Eugene M. Zheganin &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi.
</I>&gt;<i>
</I>&gt;<i> Today I discovered that a bunch of old legacy ICQ clients that some
</I>&gt;<i> people till use have lost the ability to use HTTP CONNECT tunneling with
</I>&gt;<i> sslBump. No matter what I tried to allow direct splicing for them, all
</I>&gt;<i> was useless:
</I>&gt;<i>
</I>&gt;<i> - arranging them by dst ACL, and splicing that ACL
</I>&gt;<i> - arranging them by ssl::server_name ACL, and splicing it
</I>&gt;<i>
</I>&gt;<i> So I had to turn of sslBumping. Looks like it somehow interferes with
</I>&gt;<i> HTTP CONNECT even when splicing it.
</I>&gt;<i> Last version of sslBump part in the config was looking like that:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> acl icqssl ssl::server_name login.icq.com
</I>&gt;<i> acl icqssl ssl::server_name go.icq.com
</I>&gt;<i> acl icqssl ssl::server_name ars.oscar.aol.com
</I>&gt;<i> acl icqssl ssl::server_name webim.qip.ru
</I>&gt;<i> acl icqssl ssl::server_name cb.icq.com
</I>&gt;<i> acl icqssl ssl::server_name wlogin.icq.com
</I>&gt;<i> acl icqssl ssl::server_name storage.qip.ru
</I>&gt;<i> acl icqssl ssl::server_name new.qip.ru
</I>&gt;<i>
</I>&gt;<i> acl icqlogin dst 178.237.20.58
</I>&gt;<i> acl icqlogin dst 178.237.19.84
</I>&gt;<i> acl icqlogin dst 94.100.186.23
</I>&gt;<i>
</I>&gt;<i> ssl_bump splice children
</I>&gt;<i> ssl_bump splice sbol
</I>&gt;<i> ssl_bump splice icqlogin
</I>&gt;<i> ssl_bump splice icqssl icqport
</I>&gt;<i> ssl_bump splice icqproxy icqport
</I>&gt;<i>
</I>&gt;<i> ssl_bump bump interceptedssl
</I>&gt;<i>
</I>&gt;<i> ssl_bump peek step1
</I>&gt;<i> ssl_bump bump unauthorized
</I>&gt;<i> ssl_bump bump entertainmentssl
</I>&gt;<i> ssl_bump splice all
</I>&gt;<i>
</I>&gt;<i> I'm not sure that ICQ clients use TLS, but in my previous experience
</I>&gt;<i> they were configured to use proxy, and to connect through proxy to the
</I>&gt;<i> login.icq.com host on port 443.
</I>&gt;<i> Sample log for unsuccessful attempts:
</I>&gt;<i>
</I>&gt;<i> 1447400500.311     21 192.168.2.117 TAG_NONE/503 0 CONNECT
</I>&gt;<i> login.icq.com:443 solodnikova_k HIER_NONE/- -
</I>&gt;<i> 1447400560.301     23 192.168.2.117 TAG_NONE/503 0 CONNECT
</I>&gt;<i> login.icq.com:443 solodnikova_k HIER_NONE/- -
</I>&gt;<i> 1447400624.832    359 192.168.2.117 TCP_TUNNEL/200 0 CONNECT
</I>&gt;<i> login.icq.com:443 solodnikova_k HIER_DIRECT/178.237.20.58 -
</I>&gt;<i> 1447400631.038    108 192.168.2.117 TCP_TUNNEL/200 0 CONNECT
</I>&gt;<i> login.icq.com:443 solodnikova_k HIER_DIRECT/178.237.20.58 -
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i> Eugene.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJWRetRAAoJENNXIZxhPexGbikH/0EqoRzosGamhDwM9h0tVMOJ
4rpARbMvHK3wejCgFkh+yp/X2kZi1+nRU9+baJ9vWAmKz6nqf7loFA3S+2s6HzNC
3WyAc+ICO5O2TtC+hSwPVOn4YCjbdROKSGTc/T6MoAnlfnEVIP9IV+Qb29F53bIE
vcMovH4iH2zE7XfPwtZY7eBqEiBsiSG51dg744LHfTzJEYZWmGwTjd7LAQtIwO5e
p+4FwG4oDxFksPXWEs4L2mpk8meKZvqP6CGTzTULYZdcokXcozTNw0YTz468MIzx
4zyDBZNdZXEZTLA5kL89OCVjfuXSm8WqggVvxq9SHqUYs2aJBVUHZRWNnvLhFMU=
=v1X4
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007734.html">[squid-users] sslBump adventures in enterprise production	environment
</A></li>
	<LI>Next message (by thread): <A HREF="007759.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7739">[ date ]</a>
              <a href="thread.html#7739">[ thread ]</a>
              <a href="subject.html#7739">[ subject ]</a>
              <a href="author.html#7739">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
