<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] sslBump adventures in enterprise production	environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslBump%20adventures%20in%20enterprise%20production%0A%09environment&In-Reply-To=%3C56478EC4.9040402%40mathemainzel.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007771.html">
   <LINK REL="Next"  HREF="007785.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] sslBump adventures in enterprise production	environment</H1>
    <B>Walter H.</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslBump%20adventures%20in%20enterprise%20production%0A%09environment&In-Reply-To=%3C56478EC4.9040402%40mathemainzel.info%3E"
       TITLE="[squid-users] sslBump adventures in enterprise production	environment">Walter.H at mathemainzel.info
       </A><BR>
    <I>Sat Nov 14 19:43:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007771.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
        <LI>Next message (by thread): <A HREF="007785.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7773">[ date ]</a>
              <a href="thread.html#7773">[ thread ]</a>
              <a href="subject.html#7773">[ subject ]</a>
              <a href="author.html#7773">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13.11.2015 14:53, Yuri Voinov wrote:
&gt;<i> There is no solution for ICQ with Squid now.
</I>&gt;<i>
</I>&gt;<i> You can only bypass proxying for ICQ clients.
</I>from where do the ICQ clients get the trusted root certificates?
maybe this is the problem, that e.g. the squid CA cert is only installed 
in FF
and nowhere else ...
&gt;<i> 13.11.15 14:41, Eugene M. Zheganin &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> Hi.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Today I discovered that a bunch of old legacy ICQ clients that some
</I>&gt;&gt;<i> people till use have lost the ability to use HTTP CONNECT tunneling with
</I>&gt;&gt;<i> sslBump. No matter what I tried to allow direct splicing for them, all
</I>&gt;&gt;<i> was useless:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - arranging them by dst ACL, and splicing that ACL
</I>&gt;&gt;<i> - arranging them by ssl::server_name ACL, and splicing it
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So I had to turn of sslBumping. Looks like it somehow interferes with
</I>&gt;&gt;<i> HTTP CONNECT even when splicing it.
</I>&gt;&gt;<i> Last version of sslBump part in the config was looking like that:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> acl icqssl ssl::server_name login.icq.com
</I>&gt;&gt;<i> acl icqssl ssl::server_name go.icq.com
</I>&gt;&gt;<i> acl icqssl ssl::server_name ars.oscar.aol.com
</I>&gt;&gt;<i> acl icqssl ssl::server_name webim.qip.ru
</I>&gt;&gt;<i> acl icqssl ssl::server_name cb.icq.com
</I>&gt;&gt;<i> acl icqssl ssl::server_name wlogin.icq.com
</I>&gt;&gt;<i> acl icqssl ssl::server_name storage.qip.ru
</I>&gt;&gt;<i> acl icqssl ssl::server_name new.qip.ru
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> acl icqlogin dst 178.237.20.58
</I>&gt;&gt;<i> acl icqlogin dst 178.237.19.84
</I>&gt;&gt;<i> acl icqlogin dst 94.100.186.23
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ssl_bump splice children
</I>&gt;&gt;<i> ssl_bump splice sbol
</I>&gt;&gt;<i> ssl_bump splice icqlogin
</I>&gt;&gt;<i> ssl_bump splice icqssl icqport
</I>&gt;&gt;<i> ssl_bump splice icqproxy icqport
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ssl_bump bump interceptedssl
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ssl_bump peek step1
</I>&gt;&gt;<i> ssl_bump bump unauthorized
</I>&gt;&gt;<i> ssl_bump bump entertainmentssl
</I>&gt;&gt;<i> ssl_bump splice all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not sure that ICQ clients use TLS, but in my previous experience
</I>&gt;&gt;<i> they were configured to use proxy, and to connect through proxy to the
</I>&gt;&gt;<i> login.icq.com host on port 443.
</I>&gt;&gt;<i> Sample log for unsuccessful attempts:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1447400500.311     21 192.168.2.117 TAG_NONE/503 0 CONNECT
</I>&gt;&gt;<i> login.icq.com:443 solodnikova_k HIER_NONE/- -
</I>&gt;&gt;<i> 1447400560.301     23 192.168.2.117 TAG_NONE/503 0 CONNECT
</I>&gt;&gt;<i> login.icq.com:443 solodnikova_k HIER_NONE/- -
</I>&gt;&gt;<i> 1447400624.832    359 192.168.2.117 TCP_TUNNEL/200 0 CONNECT
</I>&gt;&gt;<i> login.icq.com:443 solodnikova_k HIER_DIRECT/178.237.20.58 -
</I>&gt;&gt;<i> 1447400631.038    108 192.168.2.117 TCP_TUNNEL/200 0 CONNECT
</I>&gt;&gt;<i> login.icq.com:443 solodnikova_k HIER_DIRECT/178.237.20.58 -
</I>&gt;&gt;<i>
</I>maybe give 3.4.x a try, 3.5 seems to have bugs 3.4.x don't have ...
or this is caused by the above ...

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4312 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151114/ce3e7f05/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151114/ce3e7f05/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007771.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
	<LI>Next message (by thread): <A HREF="007785.html">[squid-users] sslBump adventures in enterprise production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7773">[ date ]</a>
              <a href="thread.html#7773">[ thread ]</a>
              <a href="subject.html#7773">[ subject ]</a>
              <a href="author.html#7773">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
