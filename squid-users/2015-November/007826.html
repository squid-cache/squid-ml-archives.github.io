<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Active Directory Authentication failing at the browser
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Active%20Directory%20Authentication%20failing%20at%20the%0A%20browser&In-Reply-To=%3CVI1PR04MB135905627FDFA365C51F055E8F1E0%40VI1PR04MB1359.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007847.html">
   <LINK REL="Next"  HREF="007807.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Active Directory Authentication failing at the browser</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Active%20Directory%20Authentication%20failing%20at%20the%0A%20browser&In-Reply-To=%3CVI1PR04MB135905627FDFA365C51F055E8F1E0%40VI1PR04MB1359.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] Active Directory Authentication failing at the browser">rafael.akchurin at diladele.com
       </A><BR>
    <I>Mon Nov 16 21:21:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007847.html">[squid-users] Active Directory Authentication failing at the browser
</A></li>
        <LI>Next message (by thread): <A HREF="007807.html">[squid-users] Slow read for ICAP REQMOD body
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7826">[ date ]</a>
              <a href="thread.html#7826">[ thread ]</a>
              <a href="subject.html#7826">[ subject ]</a>
              <a href="author.html#7826">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

If I am not terribly mistaken when you have a Kerberos auth scheme active - you are actually using SSO - i.e. when everything is configured normally you should *never* see the popup box - the fact that you see it means Kerberos is not working.

What I would check first is that you set your browser to use the proxy *by FQDN* and not by IP as you seem to (see the proxy address at screenshot). I would humbly recommend to check the trouble shooting checklist we have on our site - 
<A HREF="http://docs.diladele.com/administrator_guide_4_3/active_directory/troubleshooting.html">http://docs.diladele.com/administrator_guide_4_3/active_directory/troubleshooting.html</A>

Best regards,
Rafael Akchurin
Diladele B.V.


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Monday, November 16, 2015 9:18 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Active Directory Authentication failing at the browser

On 17/11/2015 3:19 a.m., Eugene M. Zheganin wrote:
&gt;<i> Hi.
</I>&gt;<i> 
</I>&gt;<i> On 16.11.2015 18:46, dolson wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Squid Version:  Squid 3.4.8
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> OS Version:  Debian 8 (8.2)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have installed Squid on a server using Debian 8 and seem to have 
</I>&gt;&gt;<i> the basics operating, at least when I start the squid service, I have 
</I>&gt;&gt;<i> am no longer getting any error messages.  At this time, the goal is 
</I>&gt;&gt;<i> to authenticate users from Active Directory and log the user and the websites they are accessing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The problem I am having is, when I set Firefox 35.0.1 on my Windows 7 
</I>&gt;&gt;<i> workstation to use the Squid proxy, I am getting the log in page (image below).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="imap://emz@mail.norma.perm.ru:143/fetch%3EUID%3E/INBOX/maillists/squi">imap://emz@mail.norma.perm.ru:143/fetch%3EUID%3E/INBOX/maillists/squi</A>
</I>&gt;&gt;<i> d-users%3E58459?header=quotebody&amp;part=1.1.2&amp;filename=image001.png
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have tried entering my user name in various form EXAMPLE/USERID, 
</I>&gt;&gt;<i> USERID, EXAMPLE/ADMINISTRATOR, ADMINISTRATOR and the password and I 
</I>&gt;&gt;<i> have not had a successful at this time.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have attached the squid.conf, smb.conf, krb5.conf, and access.log 
</I>&gt;&gt;<i> files for review.  If you would like to see the cache.log file, 
</I>&gt;&gt;<i> please contact me as the file is too large to include in this post.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> I suggest you first make Basic and NTLM working with active directory, 
</I>&gt;<i> and only then, having these 2 schemes working, you move to the 
</I>&gt;<i> GSS-SPNEGO scheme. This is because GSS-SPNEGO scheme is 
</I>&gt;<i> overcomplicated and difficult to debug, as it uses lots of components and can fall apart easily on any stage.
</I>&gt;<i> 
</I>
I suggest also using a current Firefox release. I am finding the 4x's series work a lot better than the earlier 3x's did on Windows 7.

Kerberos also uses the <A HREF="https://lists.squid-cache.org/listinfo/squid-users">USER at DOMAIN</A> format for user labeling. Sending it Basic USERID) or NTLM (DOMAIN/USERID) formatted labels may be the problem.

Kerberos and NTLM are both PITA protocols. But NTLM makes everything worse. If you are able to avoid using it at all and to actively turn NTLM off around your network the Kerberos side of things will work better.

Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007847.html">[squid-users] Active Directory Authentication failing at the browser
</A></li>
	<LI>Next message (by thread): <A HREF="007807.html">[squid-users] Slow read for ICAP REQMOD body
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7826">[ date ]</a>
              <a href="thread.html#7826">[ thread ]</a>
              <a href="subject.html#7826">[ subject ]</a>
              <a href="author.html#7826">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
