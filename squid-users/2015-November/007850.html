<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Some questions about ssl_bump.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Some%20questions%20about%20ssl_bump.&In-Reply-To=%3C564BA6EF.2090304%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007848.html">
   <LINK REL="Next"  HREF="007849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Some questions about ssl_bump.</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Some%20questions%20about%20ssl_bump.&In-Reply-To=%3C564BA6EF.2090304%40measurement-factory.com%3E"
       TITLE="[squid-users] Some questions about ssl_bump.">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Nov 17 22:15:11 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007848.html">[squid-users] Some questions about ssl_bump.
</A></li>
        <LI>Next message (by thread): <A HREF="007849.html">[squid-users] squid3.4.8 don't call external helpe :-(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7850">[ date ]</a>
              <a href="thread.html#7850">[ thread ]</a>
              <a href="subject.html#7850">[ subject ]</a>
              <a href="author.html#7850">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/17/2015 02:25 PM, Bruce Markey wrote:

&gt;<i> Looking at the squid docs for peek and splice
</I>&gt;<i> ( <A HREF="http://wiki.squid-cache.org/Features/SslPeekAndSplice">http://wiki.squid-cache.org/Features/SslPeekAndSplice</A> ).  
</I>&gt;<i> 
</I>&gt;<i> # Do no harm:
</I>&gt;<i> # Splice indeterminate traffic.
</I>&gt;<i> ssl_bump splice serverIsBank
</I>&gt;<i> ssl_bump bump haveServerName
</I>&gt;<i> ssl_bump peek all
</I>&gt;<i> ssl_bump splice all
</I>

&gt;<i> So my understanding of this.  
</I>&gt;<i> 
</I>&gt;<i> splice just passes through. 
</I>&gt;<i> then we bump everything else ?
</I>&gt;<i> then peek 
</I>&gt;<i> and finally splice all?
</I>
I see very little correlation between the above configuration and your
narrative describing it. Either I am completely misinterpreting your
narrative (especially the word &quot;then&quot;) or you need to [re]read what each
action does, which actions are final, and how ssl_bump lines are evaluated.


&gt;<i> Must you bump before peek? I assume so but I'm not sure.
</I>
No ssl_bump action can happen after a bump rule matches, so &quot;bump before
X&quot; does not make sense for any action X. Again, there appears to be some
fundamental misunderstanding here.

It is highly unlikely that one can understand how SslBump works by
reading configuration examples alone, unfortunately. If you have not
already, please do read the rest of the wiki page and

<A HREF="http://www.squid-cache.org/Versions/v4/cfgman/ssl_bump.html">http://www.squid-cache.org/Versions/v4/cfgman/ssl_bump.html</A>


Finally, please note that the wiki example assumes that the serverIsBank
ACL mismatches when Squid does not yet know the server name. That
assumption is very important in interpreting the sample configurations
correctly. Many folks cannot write their ssl_bump rules this way because
their ACLs are not that convenient and reliable. YMMV.


Alex.



&gt;<i> On Tue, Nov 17, 2015 at 3:33 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 18/11/2015 9:24 a.m., Bruce Markey wrote:
</I>&gt;<i>     &gt; Amos,
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; I knew something wasn't right.
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; Ok then I'm going to start there.  I had a heck of a time getting
</I>&gt;<i>     &gt; squidguard to even work due to its reliance on old berkely db packages, I'd
</I>&gt;<i>     &gt; be happy to see it go.
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; So that being said. I'm going to lose squidguard.  Upgrade squid to 3.5.
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; I haven't even looked at the 3.5 stuff.  How big of a config change am I
</I>&gt;<i>     &gt; looking at?  That being said, upgrade or start fresh?
</I>&gt;<i> 
</I>&gt;<i>     For the ssl_bump lines yes. They operate very differently, with a bit of
</I>&gt;<i>     a learning curve around the recursive/repeated ssl_bump processing.
</I>&gt;<i> 
</I>&gt;<i>     The rest of the config change should be smooth if it was working well
</I>&gt;<i>     with 3.3. &quot;squid -k parse&quot; can highlight the differences there.
</I>&gt;<i> 
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; Thanks again. This is the first definitive answer I've gotten!.
</I>&gt;<i>     &gt;
</I>&gt;<i> 
</I>&gt;<i>     Welcome.
</I>&gt;<i> 
</I>&gt;<i>     Amos
</I>&gt;<i> 
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     squid-users mailing list
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007848.html">[squid-users] Some questions about ssl_bump.
</A></li>
	<LI>Next message (by thread): <A HREF="007849.html">[squid-users] squid3.4.8 don't call external helpe :-(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7850">[ date ]</a>
              <a href="thread.html#7850">[ thread ]</a>
              <a href="subject.html#7850">[ subject ]</a>
              <a href="author.html#7850">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
