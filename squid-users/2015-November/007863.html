<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay pools: HTTPS and rep_mime_type support
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pools%3A%20HTTPS%20and%20rep_mime_type%20support&In-Reply-To=%3C564C50F0.1010104%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007860.html">
   <LINK REL="Next"  HREF="007864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay pools: HTTPS and rep_mime_type support</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pools%3A%20HTTPS%20and%20rep_mime_type%20support&In-Reply-To=%3C564C50F0.1010104%40treenet.co.nz%3E"
       TITLE="[squid-users] Delay pools: HTTPS and rep_mime_type support">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Nov 18 10:20:32 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007860.html">[squid-users] Delay pools: HTTPS and rep_mime_type support
</A></li>
        <LI>Next message (by thread): <A HREF="007864.html">[squid-users] Mutual Authentication Support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7863">[ date ]</a>
              <a href="thread.html#7863">[ thread ]</a>
              <a href="subject.html#7863">[ subject ]</a>
              <a href="author.html#7863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/11/2015 8:53 p.m., Filippo Martinelli wrote:
&gt;<i> I'm struggling with squid delay pools. The documentation I found is very
</I>&gt;<i> poor and on internet there is contradictory and possibly surpassed
</I>&gt;<i> information. I would appreciate if you can point me to exhaustive
</I>&gt;<i> information on delay pools.
</I>&gt;<i> 
</I>&gt;<i> First question:
</I>&gt;<i> 
</I>&gt;<i>     acl aclname url_regex -i \.exe
</I>&gt;<i> 
</I>&gt;<i> will it match an HTTPS request ? According to my experience and from some
</I>&gt;<i> posts it will not, so cannot find any easy way to limit the bandwidth used
</I>&gt;<i> to download .exe files from an HTTPS connection. Am I missing something ?
</I>&gt;<i> The only suggestion google gave is to use something like &quot;acl  aclname
</I>&gt;<i> methoid CONNECT&quot; but it is too generic and will not discriminate between
</I>&gt;<i> long .exe download or single page access on HTTPS connections.
</I>
&quot;HTTPS&quot; is not a single thing, or message type. It is a term to describe
an entire stack of multiple-layered protocols.

To do anything at all with URL or any other HTTP message details in what
could be termed an &quot;HTTPS request&quot; requires decrypting the TLS layer to
find the HTTP message secured inside it.


ItFrom that description it sounds to me like you are dealing with a
plain-text HTTP message of method CONNECT. There is almost zero
information in those. Apart from the domain name of the server the
client wants to talk to and maybe the client UA device, you are out of
luck using any of the more normal request/reply message details to
decide on the pool.

Squid should still be able to delay pool those CONNECT tunnels though.
But only as a whole thing, and there are still open bugs with unknown
causes. You need a fairly recent version of Squid for it to work even
halfway close to &quot;properly&quot;.

For bandwidth control it is often better to use the QoS / TOS
functionality provided by your OS. Squid can output per-request values
for those systems to work with using qos_flows, tcp_outgoing_tos or
tcp_outgoing_mark.


&gt;<i> 
</I>&gt;<i> Second question:
</I>&gt;<i> 
</I>&gt;<i>     acl streaming_exe rep_mime_type application/octet-stream
</I>&gt;<i> 
</I>&gt;<i> Can rep_mime_type be used with delay_access poolNumber allow ? Again,
</I>&gt;<i> according to my experience and to some very old posts in internet it will
</I>&gt;<i> not work, but the documentation lacks this important limitation.
</I>
Of the current Squid only 4.0.2 or later can do that. (re-)assiging
pools based on HTTP response details was only very recently ported from
Squid-2.6.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007860.html">[squid-users] Delay pools: HTTPS and rep_mime_type support
</A></li>
	<LI>Next message (by thread): <A HREF="007864.html">[squid-users] Mutual Authentication Support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7863">[ date ]</a>
              <a href="thread.html#7863">[ thread ]</a>
              <a href="subject.html#7863">[ subject ]</a>
              <a href="author.html#7863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
