<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Store-ID documentation could be a little clearer.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Store-ID%20documentation%20could%20be%20a%20little%20clearer.&In-Reply-To=%3C5653F23A.4060807%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007919.html">
   <LINK REL="Next"  HREF="007908.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Store-ID documentation could be a little clearer.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Store-ID%20documentation%20could%20be%20a%20little%20clearer.&In-Reply-To=%3C5653F23A.4060807%40treenet.co.nz%3E"
       TITLE="[squid-users] Store-ID documentation could be a little clearer.">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Nov 24 05:14:34 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007919.html">[squid-users] Store-ID documentation could be a little clearer.
</A></li>
        <LI>Next message (by thread): <A HREF="007908.html">[squid-users] How to block websites by string or substring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7925">[ date ]</a>
              <a href="thread.html#7925">[ thread ]</a>
              <a href="subject.html#7925">[ subject ]</a>
              <a href="author.html#7925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/11/2015 1:38 p.m., 1508 wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Thank you for your replies.  I spent a long time typeing this and I would be
</I>&gt;<i> grateful if you can read it all at least twice slowly before sending a
</I>&gt;<i> reply.
</I>&gt;<i> 
</I>&gt;<i> A reminder... Give yourself a smug smile if you find a spelling mistake, my
</I>&gt;<i> screen reader is used to my Typonese and my seeing eye dog can't proof read.  
</I>&gt;<i> 
</I>&gt;<i> Yes, I am almost blind but not daft... 
</I>&gt;<i> 
</I>&gt;<i> I also said 
</I>&gt;<i> 
</I>&gt;<i> I am not trying to pick any holes... You both are far cleverer than me. Vi
</I>&gt;<i> is rocket science, Nano is my friend. I am trying to establish some facts to
</I>&gt;<i> make an accurate bit of documentation... I want to do something to pay back
</I>&gt;<i> many peoples efforts.
</I>&gt;<i> 
</I>&gt;<i> Anyway, E (Sorry I cant type the rest of your name forgive me), I looked at
</I>&gt;<i> your article you found on google. I prefer the man pages first then the
</I>&gt;<i> programs web pages and documentation. Bear in mind I use a screen reader and
</I>&gt;<i> it takes ages to listen to stuff.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I would like to create a working example so I intend to use the sourceforge
</I>&gt;<i> example in the database. Id pick something that is reproduceable from
</I>&gt;<i> Sourceforge to help the new user check the database and script are working.
</I>&gt;<i> 
</I>
I think I get what you are trying to do. But we do things a little
differently in the Squid documentation.

Features/ wiki pages are for documenting the Squid feature and teaching
people about it. *NOT* providing working configurations. There are
usually just too many moving parts for the latter.

We have ConfigExamples/ wiki pages for narrow configuration how-to's
like I think you are proposing.

As far as I can see the Features/StoreID page already contains the full
and accurate information aboute StoreID feature itself. It may appear to
be missing a lot of info about setting up helpers, but that is because
this is a plugin interface feature.

The helpers and everything about setting any of them up is unrelated to
StoreID itself. The expectation is that there would be a helper for
every type of DB or storage engine anyone can dream up for putting the
StoreID data into, or for generating and calculating it on the fly.

&gt;<i> 
</I>&gt;<i> Amos, I am not being critical, one article you gave me said database entries
</I>&gt;<i> are separated by whitespace, the man page says:
</I>&gt;<i> 
</I>&gt;<i>  so I went with the man page.
</I>
There seems to be a misunderstanding here.

The Features/StoreID/DB page contains complete and accurate information
about the patterns registry we run. This is a simple set of pattern
pairs which are known to be checked and confirmed safe to use. It is
also *just* a flat-file DB. Many different helpers could use it or the
info provided.

The helper we provide is intended to be capable of reading the data D/L
from the wiki, if not there is a bug to be resolved. Possibly in the
helper docs or its internal regex. But it is not restrcted to those
datasets, nor required to use them.

In the general case, it is expected that the wiki pattern sets be
transformed into whatever DB format the helper being used needs. So the
wiki documents what format the examples displayed take, not what formats
it could potentially be mapped to. (Also partially in a way to clarify
what the HTML mangled view of the datases should be read as, you will
notice the line wrapping gets screwed up in the web view).

The helper-specific man page should document what format the DB used by
that helper takes. It is best to ensure that custom entries being added
for the helper DB meet the relevant helpers DB format. Even if D/L'ing
the dataset(s) from our wiki, for use in our provided flat-file helper.

&gt;<i> 
</I>&gt;<i> Now I know configuration files can be anywhere depending on what you are
</I>&gt;<i> running, windoze or Linux or coal fired abacus.  The thing is it would not
</I>&gt;<i> matter where the files are if we know the filenames and give an example on
</I>&gt;<i> how to find them eg:  in windows or  in Linux.
</I>&gt;<i> 
</I>&gt;<i> So the outline of my bit of documentation would be along the lines of (it is
</I>&gt;<i> not set in stone just something I cobbled up on my brailler) 
</I>&gt;<i> 
</I>
The Features/StoreID page is the central documentation for introducing
the feature and describing all this. I've split your descriptive test
and referenced what we have. It you notice carefully the orders match.

PS. the overall layout is a templated style, so all Feature pages should
have the same section layout to make learning Squid features an easy-ish
process (though older ones need updating sometimes).

&gt;<i> You want to use StoreID. 
</I>
Firstly we document what StoreID *is* (the &quot;Details&quot; section), what it
does and what the pros and cons of using it are (the &quot;Known Issues&quot;
section).
 No assuming they already know and want it. ToC is available if they
want to skip that part.

&gt;<i> OK you will need a few things like Squid,
</I>
This is assumed, the reader is on the Squid website reading about Squid
functionality/features. They may not already have Squid, but assume they
are fully aware that it will be needed.

&gt;<i> perl 
</I>
Perl is a basic system requirement of having Squid installed. No need to
state that.

NP: It is also not a requirement of StoreID, but of the specific helper.
Other helpers exist ...

&gt;<i> the rewrite script, and a database file
</I>
The &quot;Available Helpers&quot; section, lists both the Perl helper, with its
proper name and lists its DB requirement, with reference to where to D/L
the *many* different available DB files we have already.

It also lists references to other helpers that exist (Ruby ones in this
case).


NP: we then address a common mistake about StoreID being able to cache
YouTube content. Once upon a time it could, nowdays it can't do so
directly. YT devs changed their system.
 [ the text there is a bit confuzled and could do with an edit to
clarify its meaning and grammar. ]


&gt;<i> and an entry in the squid.conf file.
</I>
The &quot;Squid Configuration&quot; section.

Note though that being in Features/* page this is a generalized example
designed to explain the directives involved with this feature. It often
uses directives unnecessarily in order to display usage. cut-n-paste
ability is just a bonus, but even then doing so will usually leave one
with a overly-complex configuration that does not work very well.

To repeat:
  Features/* is educational material not run-time configuration.


&gt;<i> You can find the rewrite script by doing ...... command on linux or .... on
</I>&gt;<i> Windows (or .... on another OS if somebody has the command to tell me.) 
</I>
There are dozens of ways to do this per-OS. Squid has hundreds of
features. Multiply.

Repeating all that info in each Feature (or ConfigExample) description
page is a huge amount of text and very rarely has anything to do with
the feature or config itself. Usually its needed for Troubleshooting or
bug fixing text notes only.

The page is there to educate people about the specific feature of Squid,
not to teach sysadmin how to use their OS tools. We tell them what the
helper name is to look for, and leave the reader to use whatever method
they are familiar with already to find it quickly.


Because StoreID is a plugin interface we have a section documenting how
to write a custom helper and what I/O protocol the StoreID plugins are
required to communicate to Squid with when using this interface. So that
people interested can create their own custom ones as needed.

That is the entirety of the StoreID feature in Squid. Note how what you
want to add matches up wth what is there already. Which was my point
earlier, you dont need to re-document all that. :-)

Everything else is use-case specific. Including the rest of what you
propose writing. Which means a ConfigExample/CachingWithStoreId page for
that use-case. All about how to setup and configure a specific helper
plugin that *uses* StoreID interface for caching the contents in the
wiki provided pattern registry / DB / dataset.


I welcome your interest to write a ConfigExample page for using the
provided helper. Please take a short while to look at how the other
ConfigExample pages are structured (to avoid me or Francesco having to
re-edit it all). When creating a new example the page template contains
most of what you need, so just fill in the sections with your text.

Some hints on how to improve it inline below:

&gt;<i> You need to create a database file called .... and put (sourceforge example
</I>&gt;<i> in it) and save the file to ..... on Linux or ..... on windows. 
</I>
DB filename and location is completely optional. It is passed as the
command-line parameter of the helper.

&gt;<i> Make sure the entries on the database are sepearated by a .....
</I>&gt;<i> (tab/whitespace). 
</I>
repeating a snippet or referencing the man page text would be best.
There might need to be a paragraph on how to run a dataset converter
over the wiki contents to ensure its tab-delimited.

&gt;<i> When you have done this you can type ...........(example command to test the
</I>&gt;<i> script) in Linux or ............... in Windows to test your database works. 
</I>&gt;<i> If you see ERR then something is not right. 
</I>&gt;<i> If you see ............... congratulations. 
</I>
&gt;<i> You MAY have to tell squid set up the cache direcories if you have not done
</I>&gt;<i> it already with .... and then start Squid with ................ (give
</I>&gt;<i> examples like init.d or sysctrl etc for fedora ubuntu and other popular
</I>&gt;<i> linuxes windows abacus etc...) 
</I>
That is all just noise. OS-specific pages and/or FAQ elsewhere contain
details on how to run and manage Squid as a proxy. Assume the admin
knows what they are doing before they go near StoreID, if not they are
playing with explosives over an open fire.

The &quot;Details&quot; section of the ConfigExample page should list the use-case
for when this example is actually of any use. Squid needing to be
actually caching stuff is part of or implied by that use-case.


&gt;<i> Now go to your web browser and set up the proxy settings to the ip address
</I>&gt;<i> of your squid server and the correct port. 
</I>
That is completely irrelevant to StoreID. Or even to testing it. The
above test of the helper is all that is necessary. Assume that the proxy
is already working for clients or admin testing use before this feature
is even attempted.

There are some related issues around Squid not being able to run the
helper: ie if they get helper binary or DB file permissions wrong it
wont start, or perhapse helper-specific error messages that get logged
to cache.log.
The &quot;Troubleshooting&quot; section should enumerate those errors, how to
diagnose them and what/how to fix.


&gt;<i> Try the ........(example) in your web browser to see if the page arrives and
</I>&gt;<i> check the ... log file to see it was dealt with correctly (miss 1st time
</I>&gt;<i> then, hit after a few retries) linux cat ...log | grep .... or windows use
</I>&gt;<i> snaketail
</I>&gt;<i> 
</I>
This does not test what you seem to think it does. You can run it
successfully on a default Squid &quot;out-of-the-box&quot; without any storeid_*
related configuration setup.


&gt;<i> I can polish the documentation once WE CAN WORK TOGETHER to get the
</I>&gt;<i> information correct. Please give me a chance to put something back I dont
</I>&gt;<i> want any credit and you can licence it any way you wish.
</I>
If you need a wiki account please register for one, then let me know
(privately is fine) what username you chose for yourself so I can assign
editing privileges.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007919.html">[squid-users] Store-ID documentation could be a little clearer.
</A></li>
	<LI>Next message (by thread): <A HREF="007908.html">[squid-users] How to block websites by string or substring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7925">[ date ]</a>
              <a href="thread.html#7925">[ thread ]</a>
              <a href="subject.html#7925">[ subject ]</a>
              <a href="author.html#7925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
