<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squidguard and windows update
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squidguard%20and%20windows%20update&In-Reply-To=%3C5655A0BF.70607%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007970.html">
   <LINK REL="Next"  HREF="007972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squidguard and windows update</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squidguard%20and%20windows%20update&In-Reply-To=%3C5655A0BF.70607%40treenet.co.nz%3E"
       TITLE="[squid-users] squidguard and windows update">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Nov 25 11:51:27 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007970.html">[squid-users] squidguard and windows update
</A></li>
        <LI>Next message (by thread): <A HREF="007972.html">[squid-users] squidguard and windows update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7971">[ date ]</a>
              <a href="thread.html#7971">[ thread ]</a>
              <a href="subject.html#7971">[ subject ]</a>
              <a href="author.html#7971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/11/2015 11:52 p.m., Eliezer Croitoru wrote:
&gt;<i> On 25/11/2015 12:14, Magic Link wrote:
</I>&gt;&gt;<i> 1448445753.714      6 10.22.100.3 TCP_MISS/200 799
</I>&gt;&gt;<i> <A HREF="GEThttp://officecdn.microsoft.com/pr/39168D7E-077B-48E7-872C-B232C3E72675/Office/Data/v32.cab">GEThttp://officecdn.microsoft.com/pr/39168D7E-077B-48E7-872C-B232C3E72675/Office/Data/v32.cab</A> 
</I>&gt;&gt;<i> - HIER_DIRECT/127.0.0.1 text/html
</I>&gt;&gt;<i> But i do have the denied access page, I can't download the .cab from
</I>&gt;<i> the browser
</I>&gt;&gt;<i> 1448445766.529      5 10.22.100.3 TCP_MISS/200 834
</I>&gt;&gt;<i> <A HREF="GEThttp://au.v4.download.windowsupdate.com/d/msdownload/update/software/updt/2013/12/windows8.1-kb2909569-x64_da69540676fbda6cd24305056220322b8ef91729.cab">GEThttp://au.v4.download.windowsupdate.com/d/msdownload/update/software/updt/2013/12/windows8.1-kb2909569-x64_da69540676fbda6cd24305056220322b8ef91729.cab</A> 
</I>&gt;&gt;<i> - HIER_DIRECT/127.0.0.1 text/html
</I>&gt;&gt;<i> But i do have the denied access page, I can't download the .cab from
</I>&gt;<i> the browser
</I>&gt;&gt;<i> 1448445807.418     50 10.22.100.3 TCP_MISS/200 7450
</I>&gt;&gt;<i> <A HREF="GEThttp://v4.download.windowsupdate.com/d/msdownload/update/others/2015/11/19457798_2c503230affa03a9d1065dbf33a681b0fd9a0176.cab">GEThttp://v4.download.windowsupdate.com/d/msdownload/update/others/2015/11/19457798_2c503230affa03a9d1065dbf33a681b0fd9a0176.cab</A> 
</I>&gt;&gt;<i> - HIER_DIRECT/37.58.147.9 application/octet-stream
</I>&gt;&gt;<i> No denied access page, I can download the .cab from the browser
</I>&gt;<i> 
</I>&gt;<i> Hey,
</I>&gt;<i> 
</I>&gt;<i> From squid point of view there are two cases.
</I>&gt;<i> 1 - that is being fetched from 127.0.0.1 and the other is from some
</I>&gt;<i> origin server.
</I>&gt;<i> Have you tried to see what happens when you test\run SquidGuard from
</I>&gt;<i> command line and manually test the request?
</I>&gt;<i> Can you share you squid.conf(stripped blank and comments lines)
</I>&gt;<i> 
</I>
Wait up.

Magic has been fooled by the marketing words into thinking a &quot;deny page&quot;
from SquidGuard actually denies something. It does not.

All SG does. All it ever can do. Is tell Squid where to fetch the URL
from (rewrite), or to tell Squid to tell the client to try somewhere
else (redirect).

What Magic is thinking of as a &quot;deny&quot; is actually just a statement
&quot;here, fetch the data from 127.0.0.1&quot;. Then the SG (aka. 127.0.0.1) when
asked responds by dumping out its HTML &quot;error page&quot; text as the reply.
This unexpected response completely breaks whatever the client needed to
fetch. If the client is a browser then it happily displays the HTML
response (as seen in the test described), otherwise it just *breaks*
whatever application was running.

I expect the real clients are seeing lots of very annoying WindowsUpdate
8002something errors, getting pissed off, and then working to bypass the
&quot;that damn proxy&quot; which is breaking their Windows machines.

What this means for Squid (and sarg) is that the lines above get logged.
The server SG told Squid to contact *did* respond and the response *was*
an &quot;HTTP/1.1 200 OK&quot; reply message.



Magic; I suggest you drop SG and use squid.conf ACLs instead. Everything
SG can do so can Squid itself.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007970.html">[squid-users] squidguard and windows update
</A></li>
	<LI>Next message (by thread): <A HREF="007972.html">[squid-users] squidguard and windows update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7971">[ date ]</a>
              <a href="thread.html#7971">[ thread ]</a>
              <a href="subject.html#7971">[ subject ]</a>
              <a href="author.html#7971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
