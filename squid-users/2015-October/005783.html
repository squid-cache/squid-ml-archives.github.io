<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid cache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20cache&In-Reply-To=%3C560C7E69.4070908%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005782.html">
   <LINK REL="Next"  HREF="005784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid cache</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20cache&In-Reply-To=%3C560C7E69.4070908%40treenet.co.nz%3E"
       TITLE="[squid-users] squid cache">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Oct  1 00:29:29 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005782.html">[squid-users] squid cache
</A></li>
        <LI>Next message (by thread): <A HREF="005784.html">[squid-users] squid 3.5.5 bug 3279
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5783">[ date ]</a>
              <a href="thread.html#5783">[ thread ]</a>
              <a href="subject.html#5783">[ subject ]</a>
              <a href="author.html#5783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/10/2015 8:47 a.m., Antony Stone wrote:
&gt;<i> On Wednesday 30 September 2015 at 21:35:32, Magic Link wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi,i configure squid to use cache. It seems to work because when i did a
</I>&gt;&gt;<i> try with a software's download, the second download is TCP_HIT in the
</I>&gt;&gt;<i> access.log.
</I>&gt;<i> 
</I>&gt;<i> Congratulations.
</I>&gt;<i> 
</I>&gt;&gt;<i> The question i have is : why the majority of requests can't be cached (i
</I>&gt;&gt;<i> have a lot of tcp_miss/200) ?
</I>&gt;<i> 
</I>&gt;<i> Whether that is the *majority* of requests depends greatly upon what sort of 
</I>&gt;<i> content you are requesting.
</I>&gt;<i> 
</I>&gt;<i> That may sound trite, but I can't think of a better way of expressing it.  Get 
</I>&gt;<i> 10 users on your network to download the same image file (no, not all at the 
</I>&gt;<i> same time), and you'll see that the 9 who were not first get the content a lot 
</I>&gt;<i> faster than the 1 who was first.
</I>&gt;<i> 
</I>&gt;<i> If they're downloading other types of content, though, you may not get such a 
</I>&gt;<i> &quot;good&quot; result.
</I>&gt;<i> 
</I>
Or even if they are downloading different variations of the same object.
For example IE and Firefox request gzip'ed versions, but in different
ways. Chrome requests sdch compressed versions, Safari requests deflated
versions, and robots generally request identity (non-)encoded forms.
Thats up to 5 MISS that will get logged for one object before HITs
become the majority.


&gt;&gt;<i> i found that dynamic content is not cached but i don't understand.
</I>&gt;<i> 
</I>&gt;<i> What does &quot;dynamic&quot; mean?  It means it is not fixed / constant / stable.  In 
</I>&gt;<i> other words, requesting the &quot;same content&quot; twice might result in different 
</I>&gt;<i> answers, therefore if Squid gave you the first answer again in response to the 
</I>&gt;<i> second request, that would not be what you would have got from the remote 
</I>&gt;<i> server, and is therefore wrong.
</I>
Firstly check your config file for these, or some variation of them:
 acl QUERY url_regex cgi-bin \?
 cache deny QUERY

Remove them if you find them. This is how Squid-2 used to deal with
HTTP/1.1 dynamic content in the HTTP/1.0-only proxy. A lot of tutorisals
still exist and say to do it, but that is wrong for current Squid.

Current Squid (3.2+) are all HTTP/1.1 proxies and can safely deal with
caching all that dynamic content properly.


&gt;<i> 
</I>&gt;<i> Example: eBay
</I>&gt;<i> 
</I>&gt;<i> You look up an auction which is due to end in 2 minutes.  You see the current 
</I>&gt;<i> price and the number of bids (plus the details of what it is, etc).
</I>&gt;<i> 
</I>&gt;<i> 5 minutes later you request the same URL again.  It would be wrong of Squid to 
</I>&gt;<i> show you the same page, with 2 minutes to go, and the bidding at X currency 
</I>&gt;<i> units, from Y other bidders.  No, Squid should realise that the content it 
</I>&gt;<i> previously requested is now stale, and it needs to fetch the new current 
</I>&gt;<i> content and show you who won the auction and for how much.nt.
</I>&gt;<i> 
</I>&gt;<i> That is dynamic content.  The remote server tells Squid that there is no point 
</I>&gt;<i> in caching the page it just fetched, because within 1 second it may well be 
</I>&gt;<i> stale and need fetching anew.
</I>
In HTTP/1.0 that would have been the end of it. With the content not
cacheable.

But 1 whole second is a long time and popular auctions might have lots
of visitors during that time.

So in HTTP/1.1 the response *is* cacheable and even re-usable for that
whole second. The server response usually now instructs the proxy cache
to store the object, but do a fast revalidation (REFRESH) query to find
out if it as been changed before using it as a HIT. These get logged as
REFRESH instead of HIT or MISS.

&gt;<i> 
</I>&gt;<i> A lot of the Internet works that way these days.
</I>&gt;<i> 
</I>
The newer your Squid the better it will be at dealing with modern uses
of HTTP.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005782.html">[squid-users] squid cache
</A></li>
	<LI>Next message (by thread): <A HREF="005784.html">[squid-users] squid 3.5.5 bug 3279
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5783">[ date ]</a>
              <a href="thread.html#5783">[ thread ]</a>
              <a href="subject.html#5783">[ subject ]</a>
              <a href="author.html#5783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
