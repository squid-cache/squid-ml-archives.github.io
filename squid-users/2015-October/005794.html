<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Basic example for store.log analyzer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Basic%20example%20for%20store.log%20analyzer&In-Reply-To=%3C560D336D.4020206%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005792.html">
   <LINK REL="Next"  HREF="005839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Basic example for store.log analyzer</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Basic%20example%20for%20store.log%20analyzer&In-Reply-To=%3C560D336D.4020206%40ngtech.co.il%3E"
       TITLE="[squid-users] Basic example for store.log analyzer">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Oct  1 13:21:49 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005792.html">[squid-users] SSL Peek and Splice
</A></li>
        <LI>Next message (by thread): <A HREF="005839.html">[squid-users] Basic example for store.log analyzer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5794">[ date ]</a>
              <a href="thread.html#5794">[ thread ]</a>
              <a href="subject.html#5794">[ subject ]</a>
              <a href="author.html#5794">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I already had a plan to write something like that in the past and I had 
some time so I wrote this store.log tool:
<A HREF="http://paste.ngtech.co.il/pr3kbbf4q">http://paste.ngtech.co.il/pr3kbbf4q</A>

The tool is written in ruby and what it does is &quot;estimating&quot; what is in 
the cache_dir now based on reading the store.log.

Since I have not spent too much time on understanding the store.log but 
I had a basic idea of whats in it that seems to give some results for now.

The tool gets only one argument and it's the location of squid store.log 
and reads it like the store &quot;journal&quot; which takes view from nothing to 
what should exit now.
Each line in the store.log represents one operation and it is expected 
to be logger in the order of execution.
Due to this expectation we can predict that if a certain file was 
written to the disk(using SWAPOUT) and until the end of the log(which 
should represent now) it was not reported to be removed(RELEASE) from 
the cache it is still there but there is no guarantee that it will be 
used as a cache HIT.

The tool needs more functionality to be more accurate and to display the 
estimated cache_dir size.
For now running the script piping it with &quot;wc -l&quot;(reduce 1 line) will 
give you the result of how many objects you have in all your cache_dir 
on the server from the start time of the store.log.

Any suggestions and requests regarding the tool are welcome.

Eliezer

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005792.html">[squid-users] SSL Peek and Splice
</A></li>
	<LI>Next message (by thread): <A HREF="005839.html">[squid-users] Basic example for store.log analyzer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5794">[ date ]</a>
              <a href="thread.html#5794">[ thread ]</a>
              <a href="subject.html#5794">[ subject ]</a>
              <a href="author.html#5794">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
