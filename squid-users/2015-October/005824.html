<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20after%20changed%20from%203.4.13%20to%203.5.8%20sslbump%0A%20doesn%27t%20work%20for%20the%20site%20https%3A//banking.postbank.de/&In-Reply-To=%3C560F72CF.6080006%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005819.html">
   <LINK REL="Next"  HREF="005825.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20after%20changed%20from%203.4.13%20to%203.5.8%20sslbump%0A%20doesn%27t%20work%20for%20the%20site%20https%3A//banking.postbank.de/&In-Reply-To=%3C560F72CF.6080006%40treenet.co.nz%3E"
       TITLE="[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Oct  3 06:16:47 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005819.html">[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/
</A></li>
        <LI>Next message (by thread): <A HREF="005825.html">[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5824">[ date ]</a>
              <a href="thread.html#5824">[ thread ]</a>
              <a href="subject.html#5824">[ subject ]</a>
              <a href="author.html#5824">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/10/2015 7:08 a.m., Jason Haar wrote:
&gt;<i> On 02/10/15 23:43, Amos Jeffries wrote:
</I>&gt;&gt;<i> I'm suspecting the order of these options screws things up. Or maybe
</I>&gt;&gt;<i> just the use of &quot;ALL&quot;. sslproxy_options NO_SSLv2:NO_SSLv3:ALL
</I>&gt;<i> 
</I>&gt;<i> ...but I don't even use sslproxy_options.... There have been at least 3
</I>&gt;<i> people saying that bump doesn't work with that site - we all won't have
</I>&gt;<i> identical configs.
</I>&gt;<i> 
</I>&gt;<i> Chrome reports &quot;ERR_CONNECTION_CLOSED&quot; and Firefox &quot;The connection to
</I>&gt;<i> banking.postbank.de was interrupted while the page was loading.&quot; - that
</I>&gt;<i> doesn't even sound cert-related - more TCP related (between client and
</I>&gt;<i> squid). Remember: the site works fine when squid is set to splice that site
</I>&gt;<i> 
</I>&gt;<i> I have compared the fake cert generated by squid against the real one
</I>&gt;<i> and there's obvious differences (using &quot;openssl s_client -connect
</I>&gt;<i> banking.postbank.de:443 -servername banking.postbank.de|openssl x509
</I>&gt;<i> -noout -text&quot;). References to &quot;Certificate Policies&quot; and &quot;Certificate
</I>&gt;<i> Transparency&quot; are present in the real cert and there's no equivalent in
</I>&gt;<i> the Fake cert. How that could trigger a TCP reset is beyond me? I've
</I>&gt;<i> also cranked up logging and there was nothing overt showing an issue
</I>&gt;<i> 
</I>&gt;<i> Real:
</I>&gt;<i> 
</I>&gt;<i>              X509v3 Certificate Policies:
</I>&gt;<i>                 Policy: 2.16.840.1.113733.1.7.23.6
</I>&gt;<i>                   CPS: <A HREF="https://d.symcb.com/cps">https://d.symcb.com/cps</A>
</I>&gt;<i>                   User Notice:
</I>&gt;<i>                     Explicit Text: <A HREF="https://d.symcb.com/rpa">https://d.symcb.com/rpa</A>
</I>&gt;<i>            X509v3 Basic Constraints:
</I>&gt;<i>                 CA:FALSE
</I>&gt;<i>            1.3.6.1.4.1.11129.2.4.2:
</I>&gt;<i>                 ...k.i.w.......X......gp
</I>&gt;<i> .....N.........H0F.!......&lt;
</I>&gt;<i> ...u.V.../.......D.&gt;.Fv....\....U.......N...J.....F0D.
</I>&gt;<i> .W!....z...@'..n...C.W ....m.K/..
</I>&gt;<i> ....S.R,...K....T....u..)e.......w.h....d..:...(.L.qQ]g..D.
</I>&gt;<i> g..OO.....N.........H0F.!.....~F.n#
</I>&gt;<i> Y..&amp;^.v.....x.+........!<A HREF="https://lists.squid-cache.org/listinfo/squid-users">..n..J at 9.</A>[.....J.C.1.L5.(.%%..9..
</I>&gt;<i>     Signature Algorithm: sha256WithRSAEncryption
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Fake:
</I>&gt;<i> 
</I>&gt;<i>             X509v3 Basic Constraints:
</I>&gt;<i>                 CA:FALSE
</I>&gt;<i>     Signature Algorithm: sha256WithRSAEncryption
</I>&gt;<i> 
</I>
Those bits how the origin certificate to be an EV (Extended Validation)
certificate issued by Symantec. That could be causing trouble. I've not
looked into EV in particular detail, but it is supposed to be one of the
better ways to use TLS to prevent MITM like ssl-bump.


Also, Symantec have had a unusually large amount of trouble getting
certain of their CA certs to stay in the global trusted set. Something
to do with the clients they vouch for turning out to be bad, and again,
and again.
 Anyhow, there have been long periods (12-18 months IIRC) where they
were not trusted as a global CA. If your CA certificates set is from one
of those periods your Squid will not be able to verify trust of the
origin cert.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005819.html">[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/
</A></li>
	<LI>Next message (by thread): <A HREF="005825.html">[squid-users] after changed from 3.4.13 to 3.5.8 sslbump doesn't work for the site https://banking.postbank.de/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5824">[ date ]</a>
              <a href="thread.html#5824">[ thread ]</a>
              <a href="subject.html#5824">[ subject ]</a>
              <a href="author.html#5824">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
