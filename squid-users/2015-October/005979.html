<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl_crtd initialization SSL db error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_crtd%20initialization%20SSL%20db%20error&In-Reply-To=%3C561F05A8.7020203%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005973.html">
   <LINK REL="Next"  HREF="005980.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl_crtd initialization SSL db error</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_crtd%20initialization%20SSL%20db%20error&In-Reply-To=%3C561F05A8.7020203%40treenet.co.nz%3E"
       TITLE="[squid-users] ssl_crtd initialization SSL db error">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Oct 15 01:47:20 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005973.html">[squid-users] ssl_crtd initialization SSL db error
</A></li>
        <LI>Next message (by thread): <A HREF="005980.html">[squid-users] 3.5.8 intercept Whitelist http&amp;https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5979">[ date ]</a>
              <a href="thread.html#5979">[ thread ]</a>
              <a href="subject.html#5979">[ subject ]</a>
              <a href="author.html#5979">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/10/2015 9:51 a.m., Ian Silvester wrote:
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I'm following the instructions on this page
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit">http://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit</A>
</I>&gt;<i> to set up Squid as an end-point for HTTPS communications, and am hitting
</I>&gt;<i> an error when attempting to create and initialize an SSL certificates
</I>&gt;<i> cache directory.
</I>&gt;<i> 
</I>&gt;<i> Having taken care to ensure that my chosen directory exists
</I>&gt;<i> (/usr/local/var/cache/squid/ssl_db) and has the same ownership as the
</I>&gt;<i> user which I'm using to execute ssl_crtd, I execute the following
</I>&gt;<i> command from within squid's libexec directory:
</I>&gt;<i> 
</I>&gt;<i> ./ssl_crtd -c -s /usr/local/var/cache/squid/ssl_db
</I>&gt;<i> 
</I>&gt;<i> This gives the following output:
</I>&gt;<i> 
</I>&gt;<i> Initialization SSL db...
</I>&gt;<i> ./ssl_crtd: Cannot create /usr/local/var/cache/squid/ssl_db
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> All the mailing list searching I've done suggests that this is a
</I>&gt;<i> permissions issue, but the folder is owned by me, has permissions 755,
</I>&gt;<i> and I'm running ssl_crtd.
</I>&gt;<i> 
</I>&gt;<i> For what it's worth, I'm running v3.5.7 on OS X (via Homebrew) which was
</I>&gt;<i> built with --enable-ssl --enable-ssl-crtd --disable-eui
</I>
--enable-ssl does not exist in Squid-3.5. Use --with-openssl instead.

Please also try to get the very latest 3.5 release when dealing with
ssl-bump, the features are quite volatile still.

Currently that is 3.5.10 for stable production use or 4.0.1 (beta) if it
works for your needs.

&gt;<i> 
</I>&gt;<i> Can anyone suggest what my issue might be? Does ssl_crtd internally run
</I>&gt;<i> as an alternate user? I don't appear to have any user accounts dedicated
</I>&gt;<i> to Squid.
</I>
That does not matter until after the DB has been created. In order to
make sure the DB is useable by the Squid initiated helpers.

You should be able to run the above creation command with any account
having ownership of the directory - but not use the resulting DB with Squid.


Sadly that helper has quiet bad debugging output still. So you won't get
much better output from newer Squid releases, just better behaviour.


The following is how to determin your squid low-privilege account name:

* Run &quot;squid -k parse 2&gt;&amp;1 | grep cache_effective_user&quot; to see if
squid.conf has been configured to override the built-in account with
something specific to your install,

* if nothing is found; Run &quot;squid -v&quot; to see if the --with-default-user
build option has been set to any particular account name,

* Otherwise; the default is account &quot;nobody&quot;.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005973.html">[squid-users] ssl_crtd initialization SSL db error
</A></li>
	<LI>Next message (by thread): <A HREF="005980.html">[squid-users] 3.5.8 intercept Whitelist http&amp;https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5979">[ date ]</a>
              <a href="thread.html#5979">[ thread ]</a>
              <a href="subject.html#5979">[ subject ]</a>
              <a href="author.html#5979">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
