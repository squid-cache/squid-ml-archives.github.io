<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] nonce_garbage_interval problem?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20nonce_garbage_interval%20problem%3F&In-Reply-To=%3C875EC9DECC66D547B0E5B4328642CEDBDFC11D5F%40CG003SERVER.camegroup.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006148.html">
   <LINK REL="Next"  HREF="006138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] nonce_garbage_interval problem?</H1>
    <B>Athos Fiolo</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20nonce_garbage_interval%20problem%3F&In-Reply-To=%3C875EC9DECC66D547B0E5B4328642CEDBDFC11D5F%40CG003SERVER.camegroup.local%3E"
       TITLE="[squid-users] nonce_garbage_interval problem?">afiolo at came.com
       </A><BR>
    <I>Thu Oct 22 09:58:56 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="006148.html">[squid-users] Squid 3.5.10 SSL Bump whitelist domains
</A></li>
        <LI>Next message (by thread): <A HREF="006138.html">[squid-users] nonce_garbage_interval problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6127">[ date ]</a>
              <a href="thread.html#6127">[ thread ]</a>
              <a href="subject.html#6127">[ subject ]</a>
              <a href="author.html#6127">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, I'm facing a problem with the digest auth server responses.

Client requests a page, server responds with 407 + nonce, client gets the page correctly.
At every &quot;200 OK&quot; response the server sends a &quot;Proxy-Authentication-Info: nextnonce ...&quot; header, even if the &quot;nonce_garbage_interval&quot; is 5 minutes.
Client then tries to get the next page using the same auth data used before (this is a client problem, not involving squid), gets a  407 + new nonce, then gets correctly the page making a new request with the new auth params.

The Squid problem here is that the server gives the &quot;nextnonce&quot; header in every &quot;200 OK&quot; response.

POST <A HREF="http://my.server.com/my/page">http://my.server.com/my/page</A> HTTP/1.1
[...]

HTTP/1.1 407 Proxy Authentication Required
Proxy-Authenticate: [digest info, nonce=&quot;&lt;nonce1&gt;&quot;]
[...]

POST <A HREF="http://my.server.com/my/page">http://my.server.com/my/page</A> HTTP/1.1
Proxy-Authorization: [digest info, nonce=&quot;&lt;nonce1&gt;&quot;]
[...]

HTTP/1.1 200 OK
Proxy-Authentication-Info: nextnonce=&quot;&lt;nonce2&gt;&quot;
[...]
(gives a new nonce at every 200 OK answer)

POST <A HREF="http://my.server.com/my/page">http://my.server.com/my/page</A> HTTP/1.1
Proxy-Authorization: [digest info, nonce=&quot;&lt;nonce1&gt;&quot;]
[...]
(client using the old auth params..)

HTTP/1.1 407 Proxy Authentication Required
Proxy-Authenticate: [digest info, nonce=&quot;&lt;nonce3&gt;&quot;]
[...]

POST <A HREF="http://my.server.com/my/page">http://my.server.com/my/page</A> HTTP/1.1
Proxy-Authorization: [digest info, nonce=&quot; &lt;nonce3&gt;&quot;]
[...]

HTTP/1.1 200 OK
Proxy-Authentication-Info: nextnonce=&quot;&lt;nonce4&gt;&quot;
[...]

...

squid.conf digest settings:

#  TAG: auth_param
auth_param digest program /usr/bin/php /etc/squid3/mydigestscript.php
auth_param digest children 5
auth_param digest realm MyProxyRealm
auth_param digest nonce_garbage_interval 5 minutes
auth_param digest nonce_max_duration 2 hours
auth_param digest nonce_max_count 50

Any suggestion?


Athos Fiolo
Software Engineer
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">afiolo at came.com</A>
&lt;<A HREF="http://www.came.com/">http://www.came.com/</A>&gt;[cid:CAME.png]&lt;<A HREF="http://www.came.com">http://www.came.com</A>&gt;
Came S.p.A.
Sede Legale e Operativa: Via Martiri della Libert?, 15 - 31030 Dosson di Casier - Treviso - Italy
Tel. (+39) 0422 4940 - Fax (+39) 0422 4941 - <A HREF="https://lists.squid-cache.org/listinfo/squid-users">info at came.com</A>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">info at came.com</A>&gt; - www.came.com&lt;<A HREF="http://www.came.com">http://www.came.com</A>&gt;

Sede Operativa: Via Cornia, 1/b,c - 33079 Sesto al Reghena - Pordenone - Italy
Tel. (+39) 0434 698111 - Fax (+39) 0434 698434 - <A HREF="https://lists.squid-cache.org/listinfo/squid-users">infobpt at came.com</A>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">infobpt at came.com</A>&gt; - www.bpt.it&lt;<A HREF="http://www.bpt.it">http://www.bpt.it</A>&gt;
[cid:LogoExpo.png]

[cid:facebook.png]&lt;<A HREF="https://www.facebook.com/pages/CAME-Italia/1604586846431438?ref=hl">https://www.facebook.com/pages/CAME-Italia/1604586846431438?ref=hl</A>&gt; [cid:twitter.png] &lt;<A HREF="https://twitter.com/cameglobal">https://twitter.com/cameglobal</A>&gt;  [cid:youtube.png] &lt;<A HREF="https://www.youtube.com/user/CameChannel">https://www.youtube.com/user/CameChannel</A>&gt;  [cid:linkedin.png] &lt;<A HREF="https://www.linkedin.com/company/came?trk=top_nav_home">https://www.linkedin.com/company/came?trk=top_nav_home</A>&gt;

[cid:FooterCAME.png]

Il messaggio di posta elettronica contiene informazioni di carattere confidenziale specifiche per il destinatario. Nel caso non ne siate il destinatario, segnalatelo immediatamente al mittente ed eliminate dai vostri archivi quanto ricevuto (compresi i file allegati). L'uso, la diffusione, distribuzione o riproduzione del presente messaggio e dei suoi allegati da parte di ogni altra persona costituisce reato. Rif. Decreto legislativo 30 giugno 2003, n. 196 - Codice in materia di protezione dei dati personali.

The email message contains confidential information specific to the recipient. If you are not the recipient, write it to the sender immediately and delete from your files as received (including file attachments). Use, dissemination, distribution or reproduction of this message and its attachments by any other person is a criminal offense. References Legislative Decree 30 June 2003, n. 196 - Code for the protection of personal data.

Right to opposition:
The person concerned who receives the message has the right at any time to oppose its processing for forwarding commercial messages, advertising material or direct sales proposals, by clicking on the e-mail address below (or by traditional postal services by writing to: Came S.p.A., Via Martiri della Libert? 15, 31030 Dosson di Casier (TV) - Italy, or by sending a fax to +39 0422 4941. Furthermore the person concerned may exercise all the rights of access to the personal data as provided by art. 7, Legislative Decree no. 196/2003, including the rights to amendment, updating and deletion, by sending an e-mail to <A HREF="https://lists.squid-cache.org/listinfo/squid-users">privacy at came.com</A>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">privacy at came.com</A>&gt;.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CAME.png
Type: image/png
Size: 2939 bytes
Desc: CAME.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: LogoExpo.png
Type: image/png
Size: 23145 bytes
Desc: LogoExpo.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0001.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0001.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: facebook.png
Type: image/png
Size: 1289 bytes
Desc: facebook.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0002.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0002.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: twitter.png
Type: image/png
Size: 1334 bytes
Desc: twitter.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0003.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0003.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: youtube.png
Type: image/png
Size: 1403 bytes
Desc: youtube.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0004.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0004.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linkedin.png
Type: image/png
Size: 1323 bytes
Desc: linkedin.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0005.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0005.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FooterCAME.png
Type: image/png
Size: 23373 bytes
Desc: FooterCAME.png
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0006.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20151022/a504bbab/attachment-0006.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="006148.html">[squid-users] Squid 3.5.10 SSL Bump whitelist domains
</A></li>
	<LI>Next message (by thread): <A HREF="006138.html">[squid-users] nonce_garbage_interval problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6127">[ date ]</a>
              <a href="thread.html#6127">[ thread ]</a>
              <a href="subject.html#6127">[ subject ]</a>
              <a href="author.html#6127">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
