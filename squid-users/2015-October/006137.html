<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ssl-Bump and revoked server certificates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ssl-Bump%20and%20revoked%20server%20certificates&In-Reply-To=%3C5628CA78.1080304%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006135.html">
   <LINK REL="Next"  HREF="006221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ssl-Bump and revoked server certificates</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ssl-Bump%20and%20revoked%20server%20certificates&In-Reply-To=%3C5628CA78.1080304%40treenet.co.nz%3E"
       TITLE="[squid-users] Ssl-Bump and revoked server certificates">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Oct 22 11:37:28 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="006135.html">[squid-users] Ssl-Bump and revoked server certificates
</A></li>
        <LI>Next message (by thread): <A HREF="006221.html">[squid-users] Ssl-Bump and revoked server certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6137">[ date ]</a>
              <a href="thread.html#6137">[ thread ]</a>
              <a href="subject.html#6137">[ subject ]</a>
              <a href="author.html#6137">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 23/10/2015 12:02 a.m., Sebastian Kirschner wrote:
&gt;<i> Hi Amos ,
</I>&gt;<i> 
</I>&gt;<i> thanks for your reply.
</I>&gt;<i> 
</I>&gt;<i> Maybe we got an misunderstanding or I have an &quot;false&quot; opinion of the sentence I quoted before.
</I>&gt;<i> 
</I>&gt;<i> I thought you could say to me what for checks would definitely performed in &quot;standard&quot; installation with openssl,
</I>&gt;<i> 
</I>&gt;<i> not only that you believe that the X.509 certificate syntax and properties would be checked in correctness and the signer.
</I>&gt;<i> 
</I>
Currently it is an &quot;I believe&quot; because I am only part way through
learning the SSL related code and refactoring it for TLS support. Those
are the checks I have seen being enabled to happen so far, there may yet
be some more hiding elsewhere later in the transaction handling.

They are all configurable, and in my experience it is a rarity for
people to actually use the default config settings. Normally we see
configs being posted disabling the verifications or restricting ciphers
and OpenSSL feature usage.

The X.509 syntax and TLS extension checks are all library dependent to
begin with. The squid default config just enables the library to do its
default of those, and to check the system CA signings. Everthing else,
including whether the helper is used is administrative choice.


&gt;<i> I&#180;m sorry for these remark , but for me it's important to know what checks would performed to prevent another on the same thing and slow down the &quot;process&quot;.
</I>&gt;<i> 
</I>
Understood.

FWIW the result of the above checks (what gets done) gets passed to the
helper.

&gt;<i> 
</I>&gt;<i> Another question regarding the Options from &quot;sslcrtvalidator_program&quot;,
</I>&gt;<i> ttl &quot; TTL in seconds for cached results. The default is 60 secs&quot;
</I>&gt;<i> 
</I>&gt;<i> Is the cached results referred to the sslhost ?
</I>
I'm not sure. I've not reached the validator helper code yet in my
refactoring. IIRC that is the helper lookup cache TTL. To prevent the
helper being queried for the identical work multiple times in a row. All
helpers have such a cache. The cache key is the exact byte sequence for
the &quot;line&quot; passed to the helper, excluding the channel-ID field.

&gt;<i> 
</I>&gt;<i> For example , I configured that the TTL is 12 hours.
</I>&gt;<i> A request from Client A is performed to <A HREF="https://www.google.com">https://www.google.com</A> the validator report back to squid that the certificate is ok and the connection would be spliced/bumped,
</I>&gt;<i> 1 hour later Client B perform a request again too <A HREF="https://www.google.com">https://www.google.com</A> , would squid use the &quot;cached&quot; answer from the validator used ?
</I>&gt;<i> 
</I>
If a) my recollection is right, and b) the internal validation results
in the same helper query details being passed to the helper, then yes.

If something happens like different TLS extensions being negotiated and
resulting in even slightly different error message from internal
validation - then the lookups will be different and a re-check will be
needed.


&gt;<i> 
</I>&gt;<i> And another question regarding the cache option.
</I>&gt;<i> What from the response would be cached , the complete one or maybe only the sslhost and response code ?
</I>
The helper response cache stores helper response &quot;lines&quot;, excluding the
channel-ID. So it can act as if the helper was queried but produced the
same result as previous lookup.

&gt;<i> 
</I>&gt;<i> Would it be defined as byte in as the validator and speak ?
</I>
8 bits is one byte. This is network terminology, not specific to the
helper. The helper protocol is UTF-8 capable, though usually only the
ASCII characters are used.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="006135.html">[squid-users] Ssl-Bump and revoked server certificates
</A></li>
	<LI>Next message (by thread): <A HREF="006221.html">[squid-users] Ssl-Bump and revoked server certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6137">[ date ]</a>
              <a href="thread.html#6137">[ thread ]</a>
              <a href="subject.html#6137">[ subject ]</a>
              <a href="author.html#6137">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
