<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20has%20extremely%20low%20hit%20ratio%20due%20to%20lacks%0A%20of%20ignore-no-cache&In-Reply-To=%3C562D2AD6.3040705%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006186.html">
   <LINK REL="Next"  HREF="006191.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20has%20extremely%20low%20hit%20ratio%20due%20to%20lacks%0A%20of%20ignore-no-cache&In-Reply-To=%3C562D2AD6.3040705%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Oct 25 19:17:42 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="006186.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of	ignore-no-cache
</A></li>
        <LI>Next message (by thread): <A HREF="006191.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6190">[ date ]</a>
              <a href="thread.html#6190">[ thread ]</a>
              <a href="subject.html#6190">[ subject ]</a>
              <a href="author.html#6190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Yuri,

I am not sure if you think that Squid version 4 with extreme low hit 
ratio is bad or not but I can understand your sight about things.
Usually I am redirecting to this page: 
<A HREF="http://wiki.squid-cache.org/Features/StoreID/CollisionRisks#Several_real_world_examples">http://wiki.squid-cache.org/Features/StoreID/CollisionRisks#Several_real_world_examples</A>

But this time I can proudly say that the squid project is doing things 
the right way while it might not be understood by some.
Before you or anyone declares that there is a low hit ratio due to 
something that is missing I will try to put some sense into how things 
looks in the real world.
Small thing from a nice day of mine:
I was sitting talking with a friend of mine, a MD to be exact and while 
we were talking I was just comforting him about the wonders of Computers.
He was complaining on how the software in the office moves so slow and 
he needs to wait for the software to response with results. So I 
hesitated a bit but then I asked him &quot;What would have happen if some MD 
here in the office will receive the wrong content\results on a patient 
from the software? he described it to me terrified from the question 'He 
can get the wrong decision!' and then I described to him how he is in 
such a good place when he doesn't need to fear from such scenarios.
In this same office Squid is being used for many things and it's crucial 
that besides the option to cache content the possibility to validate 
cache properly will be set right.

I do understand that there is a need for caches and sometimes it is 
crucial in order to give the application more CPU cycles or more RAM but 
sometimes the hunger for cache can consume the actual requirement for 
the content integrity and it must be re-validated from time to time.

I have seen couple times how a cache in a DB or other levels results 
with a very bad and unwanted result while I do understand some of the 
complexity and caution that the programmers take when building all sort 
of systems with cache in them.

If you do want to understand more about the subject pick your favorite 
scripting language and just try to implement a simple object caching.
You would then see how complex the task can be and you can maybe then 
understand why caches are not such a simple thing and specially why 
ignore-no-cache should not be used in any environment if it is possible.

While I do advise you to not use it I would hint you and others on 
another approach to the subject.
If you are greedy and you have hunger for cache for specific 
sites\traffic and you would like to be able to benefit from over-caching 
there is a solution for that!
- You can alter\hack squid code to meet your needs
- You can write an ICAP service that will be able to alter the response 
headers so squid would think it is cachable by default.
- You can write an ECAP module that will be able to alter the response 
headers ...
- Write your own cache service with your algorithms in it.

Take in account that the squid project tries to be as fault tolerance as 
possible due to it being a very sensitive piece of software in very big 
production systems.
Squid doesn't try to meet the requirement of &quot;Maximum Cache&quot; and it is 
not squid that as a caching proxy makes a reduction of any cache percentage!
The reason that the content is not cachable is due to all these 
application that describe their content as not cachable!
For a second of sanity from the the squid project, try to contact 
google\youtube admins\support\operators\forces\what-ever to understand 
how would you be able to benefit from a local cache.
If and when you do manage to contact them let them know I was looking 
for a contact and I never managed to find one of these available to me 
on the phone or email. You cannot say anything like that on the squid 
project, the squid project can be contacted using an email and if 
required you can get a hold of the man behind the software(while he is a 
human).

And I will try to write it in a geeky way:
deny_info 302:<A HREF="https://support.google.com/youtube/">https://support.google.com/youtube/</A> 
big_system_that_doesnt_want_to_be_cached

Eliezer

* P.S If you do want to write an ICAP service or an ECAP module to 
replace the &quot;ignore-no-cache&quot; I can give you some code that will might 
help you as a starter.


On 25/10/2015 17:17, Yuri Voinov wrote:
&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA256
</I>&gt;<i>
</I>&gt;<i> Hi gents,
</I>&gt;<i>
</I>&gt;<i> Pay attention to whether someone from the test SQUID 4 as extremely low
</I>&gt;<i> of cache hits from the new version? Particularly with respect to sites
</I>&gt;<i> HTTPS directive &quot;no cache&quot;? After replacing the Squid 3.4 to 4 squid
</I>&gt;<i> cache hit collapsed from 85 percent or more on the level of 5-15
</I>&gt;<i> percent. I believe this is due to the exclusion of support guidelines
</I>&gt;<i> ignore-no-cache, which eliminates the possibility of aggressive caching
</I>&gt;<i> and reduces the value of caching proxy to almost zero.
</I>&gt;<i>
</I>&gt;<i> This HTTP caches normally. However, due to the widespread use of HTTPS
</I>&gt;<i> trends - caching dramatically decreased to unacceptable levels.
</I>&gt;<i>
</I>&gt;<i> Noticed there anyone else this effect? And what is now with caching?
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v2
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBCAAGBQJWLPKOAAoJENNXIZxhPexGCx4H/j0R2aAxOPp5K1kYwHPgkBF1
</I>&gt;<i> oH/7nqKRWLbRJ32tqkRtQIE4zbyqqNjmGamRoa59UCK/xs6H3Z8t8Y2Bbkx6umDH
</I>&gt;<i> lwUWjlksVxATVAxbjIWowkmjU4FVc20dM0p6quvz1A9LqdcZHu5x4AzLGLs2re4b
</I>&gt;<i> Dy7urAjn8dA5jgvQ05rTBLkqgOeDUlakyBaMlHaK8VUJ829H3YreSWpbobjCKAIz
</I>&gt;<i> /Bu5pLSRXDvdPqEzOa4MRwSirggntKHET1ThxwVN9xDa1wCc3SW4cRoKmqobmSv/
</I>&gt;<i> F7ryEkTFC05AcCiGb7ArEjGQf7R7zi4PXybOoUIypEyhipvd5hv2PKdw3Dha4OY=
</I>&gt;<i> =m/MT
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="006186.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of	ignore-no-cache
</A></li>
	<LI>Next message (by thread): <A HREF="006191.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6190">[ date ]</a>
              <a href="thread.html#6190">[ thread ]</a>
              <a href="subject.html#6190">[ subject ]</a>
              <a href="author.html#6190">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
