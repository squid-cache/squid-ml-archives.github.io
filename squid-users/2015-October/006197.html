<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20has%20extremely%20low%20hit%20ratio%20due%20to%20lacks%0A%20of%20ignore-no-cache&In-Reply-To=%3C562D845F.9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006192.html">
   <LINK REL="Next"  HREF="006203.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20has%20extremely%20low%20hit%20ratio%20due%20to%20lacks%0A%20of%20ignore-no-cache&In-Reply-To=%3C562D845F.9%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Oct 26 01:39:43 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="006192.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
        <LI>Next message (by thread): <A HREF="006203.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6197">[ date ]</a>
              <a href="thread.html#6197">[ thread ]</a>
              <a href="subject.html#6197">[ subject ]</a>
              <a href="author.html#6197">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 26/10/2015 8:29 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> In a nutshell - I need no possible explanation. I want to know - it's a
</I>&gt;<i> bug or so conceived?
</I>
Well, I don't think it is what you think.

For starters ignore-no-cache was removed back in 3.2, so your 3.4
version working okay shows that its not that parameter.

Secondly, what ignore-no-cache did when it was supported was *prevent*
things marked with Cache-Control:no-cache by servers from caching. Quite
the opposite of what most proxy admin seemed to think.


What has been removed in 4.x is:
1) ignore-auth which again was preventing things being cached,

2) ignore-must-revalidate which was causing auth credentials, Cookies,
and per-user payload things to be delivered from cache to the wrong
users in some/many proxies.

As a result ignore-private is now relatively safe to use. Before it
utterly wiped out cache integrity when combined with the (2) behaviours.

Also ignore-expires is now safe to use. Since Squid should be acting
like a proper HTTP/1.1 cache with revalidations of stale content.


60% -ish sounds about right for the proportion of traffic using
Cache-Control: with any of must-revalidate, proxy-revalidate, no-cache,
private, or authentication.

If you are only looking at *_HIT you will see a massive decline. But
that is an illusion. In 4.x you need to count REFRESH_UNMODIFIED as a
HIT, and look at the cache ratio statistics for near-HITs as well as HITs.



Right after the upgrade from an older Squid it could be a case of your
cache having bad content in it. The revalidations would cause a burst of
replacements until that old content is updated. You would see that as a
sudden low point in the rate, increasing roughly exponentially back up
towards some new &quot;normal&quot; rate.

If you are having the huge decline even after revalidations are taken
into account and the new normal rate is reached, that is not expected.
You would need to analyse your traffic headers to find out what the
actual situation is.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="006192.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
	<LI>Next message (by thread): <A HREF="006203.html">[squid-users] Squid4 has extremely low hit ratio due to lacks of ignore-no-cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6197">[ date ]</a>
              <a href="thread.html#6197">[ thread ]</a>
              <a href="subject.html#6197">[ subject ]</a>
              <a href="author.html#6197">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
