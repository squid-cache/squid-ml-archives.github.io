<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] delay pools
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20delay%20pools&In-Reply-To=%3C562E9E70.9070904%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006236.html">
   <LINK REL="Next"  HREF="007322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] delay pools</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20delay%20pools&In-Reply-To=%3C562E9E70.9070904%40treenet.co.nz%3E"
       TITLE="[squid-users] delay pools">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Oct 26 21:43:12 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="006236.html">[squid-users] delay pools
</A></li>
        <LI>Next message (by thread): <A HREF="007322.html">[squid-users] R:  delay pools
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6245">[ date ]</a>
              <a href="thread.html#6245">[ thread ]</a>
              <a href="subject.html#6245">[ subject ]</a>
              <a href="author.html#6245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/10/2015 7:42 a.m., De Lazzari Matteo wrote:
&gt;<i> 
</I>&gt;<i> Hi, is it possible to use Active directory groups in delay pools
</I>&gt;<i> configuration?
</I>
Yes. Although to do it easily will require a Squid-3.4 or later where
transaction annotations are available. Also a helper that sends back the
group=X to Squid about what group(s) the user is in (could be auth
helper or external ACL helper).
 So far only the kerberos auth helper does that and it sends the SSID
value as the group=X value for all the groups listed in the Kerberos token.

With a helper returning the group names to Squid, a &quot;note&quot; type ACL can
be used to check the group=X annotation values in any access control
rules. Including delay_access.


&gt;<i> And someone can tell me an example about how to use
</I>&gt;<i> class 5 delay pool?
</I>&gt;<i> 
</I>
That delay pool requires that an external_acl_type helper is being used
and sending some tag=X back to Squid to attach 'tag' each request /
transaction.

That helper has to be tested on one of the *_access rules where async /
slow group lookups will work. The delay_access rules will *not* work
since they are a fast-group check. http_access is the usual place and
the heper decides both whether to allow use of Squid and what to tag the
request with.


You define the pool to be of class 5 with a Bytes/sec rate:
  delay_pools 1 1
  delay_parameters 1 5 20480

You define delay_access to match for the requests that are to have that
pools traffic rate limit applied:
  delay_access 1 allow localnet

Squid will automatically arrange so each unique tag=X value the helper
assigns to those pooled requests will have a pool. All requests to which
the helper replies 'tag=ZZ' will share a one pool, but requests the
helper replies with 'tag=YY' will have a different pool. etc.
 Requests not having a tag at all share one pool (I think, havent
checked that).

That is it.

The difficult bits are that only one tag= value can be assigned to a
transaction, attempts to repeat or alter one assigned wont work, and
that detail about the async/slow access lists being the only ones where
the helper can be checked.


HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="006236.html">[squid-users] delay pools
</A></li>
	<LI>Next message (by thread): <A HREF="007322.html">[squid-users] R:  delay pools
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6245">[ date ]</a>
              <a href="thread.html#6245">[ thread ]</a>
              <a href="subject.html#6245">[ subject ]</a>
              <a href="author.html#6245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
