<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid SNI at Step 2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20SNI%20at%20Step%202&In-Reply-To=%3C562FDD96.2080306%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007353.html">
   <LINK REL="Next"  HREF="006224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid SNI at Step 2</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20SNI%20at%20Step%202&In-Reply-To=%3C562FDD96.2080306%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid SNI at Step 2">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Oct 27 20:24:54 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007353.html">[squid-users] Squid SNI at Step 2
</A></li>
        <LI>Next message (by thread): <A HREF="006224.html">[squid-users] Squid SNI at Step 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7355">[ date ]</a>
              <a href="thread.html#7355">[ thread ]</a>
              <a href="subject.html#7355">[ subject ]</a>
              <a href="author.html#7355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/10/2015 9:11 a.m., Jatin Bhasin wrote:
&gt;<i> Hi Amos,
</I>&gt;<i> 
</I>&gt;<i> My client is sending sni. I have checked this. Squid only generates SNI
</I>&gt;<i> fake connect at step2 if sslbump action is splice. For all other ssl bump
</I>&gt;<i> actions it does not generate fake connect with sni.
</I>&gt;<i> Is this a bug or limitation in squid? Do you plan in future to change it?
</I>
Its bot a bug exactly. I'm not sure at this point what we will do about
it. Alex adn Christos are apparently doing a bit of redesign of the
process and I'm not sure how that is going or planned to be yet.

Conceptually the fake CONNECT represents the server authority named in
the protocol prior to TLS handshake beginning. Which is TCP and thus the
server-IP from the TCP SYN packet. That has already been accepted though
the http_access permissions in its raw-IP form.

Personally I am leaning more and more towards having Squid simply do the
step-1 peek in all traffic. So access controls and permissions start at
step 2 with SNI going through the http_access rules in the fake CONNECT.

But that would possibly have issues where people want or be required to
terminate or splice without peek happening first. From a security
standpoint it should not matter, but we sill have to verify that.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007353.html">[squid-users] Squid SNI at Step 2
</A></li>
	<LI>Next message (by thread): <A HREF="006224.html">[squid-users] Squid SNI at Step 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7355">[ date ]</a>
              <a href="thread.html#7355">[ thread ]</a>
              <a href="subject.html#7355">[ subject ]</a>
              <a href="author.html#7355">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
