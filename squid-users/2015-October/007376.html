<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Inconsistent accessing of the cache, craigslist.org images, wacky stuff.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Inconsistent%20accessing%20of%20the%20cache%2C%0A%20craigslist.org%20images%2C%20wacky%20stuff.&In-Reply-To=%3C56310654.3050401%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007372.html">
   <LINK REL="Next"  HREF="007377.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Inconsistent accessing of the cache, craigslist.org images, wacky stuff.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Inconsistent%20accessing%20of%20the%20cache%2C%0A%20craigslist.org%20images%2C%20wacky%20stuff.&In-Reply-To=%3C56310654.3050401%40treenet.co.nz%3E"
       TITLE="[squid-users] Inconsistent accessing of the cache, craigslist.org images, wacky stuff.">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Oct 28 17:31:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007372.html">[squid-users] Inconsistent accessing of the cache,	craigslist.org images, wacky stuff.
</A></li>
        <LI>Next message (by thread): <A HREF="007377.html">[squid-users] Inconsistent accessing of the cache,	craigslist.org images, wacky stuff.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7376">[ date ]</a>
              <a href="thread.html#7376">[ thread ]</a>
              <a href="subject.html#7376">[ subject ]</a>
              <a href="author.html#7376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/10/2015 4:06 a.m., Jester Purtteman wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On
</I>&gt;&gt;<i> Behalf Of Amos Jeffries
</I>&gt;&gt;<i> Sent: Tuesday, October 27, 2015 9:07 PM
</I>&gt;&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> Subject: Re: [squid-users] Inconsistent accessing of the cache, craigslist.org
</I>&gt;&gt;<i> images, wacky stuff.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 28/10/2015 2:05 p.m., Jester Purtteman wrote:
</I>&gt;&gt;&gt;<i> So, here is the problem:  I want to cache the images on craigslist.
</I>&gt;&gt;&gt;<i> The headers all look thoroughly cacheable, some browsers (I'm glairing
</I>&gt;&gt;&gt;<i> at you
</I>&gt;&gt;&gt;<i> Chrome) send with this thing that requests that they not be cachable,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;this thing&quot; being what exactly?
</I>&gt;&gt;<i>
</I>&gt;<i> Thing -&gt; rest of the request, (you'd think someone who spoke a language their entire life could use it, but clearly still need practice :)
</I>&gt;<i> 
</I>&gt;&gt;<i> I am aware of several nasty things Chrome sends that interfere with optimal
</I>&gt;&gt;<i> HTTP use. But nothing that directly prohibits caching like you describe.
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> The chrome version of the headers have two lines that make my eye twitch:
</I>&gt;<i> 
</I>&gt;<i>  Cache-Control: max-age=0
</I>&gt;<i>  Upgrade-Insecure-Requests: 1
</I>&gt;<i> 
</I>&gt;<i> Which (unless I don't understand what's going on, which is quite possible) means &quot;I don't want the response cached, and if possible, could we securely transfer this picture of an old overpriced tractor?  It's military grade intelligence information here that bad guys are trying to steal&quot;.  Am I interpreting that wrong?
</I>&gt;<i> 
</I>
max-age=0 from client means &quot;dont use whatever you have cached. Always
go to the server for new content.&quot;.
The rest you got.

Are you using the reload or refresh button in your testing? that is
expected to cause that max-age value.

If it is just sending that all the time anyway we will need to update
our hacks.


&gt;<i> 
</I>&gt;<i> So getting lazy and using 8.8.8.8 because I don't have to remember which server I installed bind or dnsmasq on has finally come back to haunt me...  I actually had a nightmare of a time getting another system working over the same problem, I'm giving this a rating of highly plausible.  I'll revise the structure, if that fixes the issue, I'll let you know. 
</I>&gt;<i> 
</I>
Introducing auto-configuration :-)

You don't have to configure Squid with dns_nameservers at all these
days. If you omit it entirely Squid will load the systems resolv.conf
and use whatever resolver(s) are in there.


&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So, big question, what debug level do I use to see this thing making
</I>&gt;&gt;&gt;<i> decisions on whether to cache, and any tips anyone has about this
</I>&gt;&gt;&gt;<i> would be appreciated.  Thank you!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> debug_options 85,3 22,3
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> I have used 22,3 which I gleaned from another post on this list, I find a lot of this in my cache.log:
</I>&gt;<i> 
</I>&gt;<i>  2015/10/27 18:23:18.402| ctx: enter level  0: '<A HREF="http://images.craigslist.org/00707_cL1v48AjUBR_300x300.jpg">http://images.craigslist.org/00707_cL1v48AjUBR_300x300.jpg</A>'
</I>&gt;<i> 2015/10/27 18:23:18.402| 22,3| http.cc(328) cacheableReply: NO because e:=p2XDIV/0x24afa00*3 has been released.
</I>&gt;<i> 2015/10/27 18:23:18.409| ctx: exit level  0
</I>&gt;<i> 
</I>&gt;<i> I'll let you know if fixing DNS takes that out.  
</I>&gt;<i> 
</I>
Hmm. I'm interested now. Will look that up when I have time later.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007372.html">[squid-users] Inconsistent accessing of the cache,	craigslist.org images, wacky stuff.
</A></li>
	<LI>Next message (by thread): <A HREF="007377.html">[squid-users] Inconsistent accessing of the cache,	craigslist.org images, wacky stuff.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7376">[ date ]</a>
              <a href="thread.html#7376">[ thread ]</a>
              <a href="subject.html#7376">[ subject ]</a>
              <a href="author.html#7376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
