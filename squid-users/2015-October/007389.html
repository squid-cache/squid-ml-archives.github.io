<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22NF%20getsockopt%28SO_ORIGINAL_DST%29%22%20filling%0A%20cache.log%20due%20to%20AWS%20ELB%20healthchecks&In-Reply-To=%3C56316819.6030508%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007387.html">
   <LINK REL="Next"  HREF="007395.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22NF%20getsockopt%28SO_ORIGINAL_DST%29%22%20filling%0A%20cache.log%20due%20to%20AWS%20ELB%20healthchecks&In-Reply-To=%3C56316819.6030508%40ngtech.co.il%3E"
       TITLE="[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Oct 29 00:28:09 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007387.html">[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks
</A></li>
        <LI>Next message (by thread): <A HREF="007395.html">[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7389">[ date ]</a>
              <a href="thread.html#7389">[ thread ]</a>
              <a href="subject.html#7389">[ subject ]</a>
              <a href="author.html#7389">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Why are you using an intercept port?
IF you don't need it you dont't.
Every time any direct conneciton is done to the proxy port 3128 it will 
show this line since the connection is a regular TCP one while the 
&quot;intercept&quot; directive instructs squid to fetch information which exists 
only on NATTED\REDIRECT traffic.
Pretty simple and straight forward and this is the way squid works..
You should verify if you need a http_port 1111 or http_port 1111 accel 
or http_port 1111 intercept.

I will be glad to help you in about 20 hours.

Eliezer

On 29/10/2015 02:06, John Smith wrote:
&gt;<i> Hi Eliezer,
</I>&gt;<i>
</I>&gt;<i> I've added a single line to my squid.conf:
</I>&gt;<i> http_port 3130
</I>&gt;<i>
</I>&gt;<i> And I've modified my AWS ELB healthcheck to monitor port 3130 instead of
</I>&gt;<i> 3128.
</I>&gt;<i> Now my instances are still in the ELB, and the proxy still works as
</I>&gt;<i> expected, AND the amount of garbage errors in the cache.log has been
</I>&gt;<i> significantly reduced.
</I>&gt;<i>
</I>&gt;<i> Unfortunately I'm seeing a single a single line in cache.log every time I
</I>&gt;<i> hit the proxy on port 3128:
</I>&gt;<i> 2015/10/28 23:53:32| IpIntercept.cc(137) NetfilterInterception:  NF
</I>&gt;<i> getsockopt(SO_ORIGINAL_DST) failed on FD 61: (92) Protocol not available
</I>&gt;<i>
</I>&gt;<i>  From other posts, it appears this warning message related to NAT.  I'm not
</I>&gt;<i> doing NAT on the squid proxies, the load balancer takes care of that.
</I>&gt;<i>
</I>&gt;<i> Any ideas how to remove the rest of the noise from my logs?
</I>&gt;<i>
</I>&gt;<i> Thanks again for the help!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007387.html">[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks
</A></li>
	<LI>Next message (by thread): <A HREF="007395.html">[squid-users] &quot;NF getsockopt(SO_ORIGINAL_DST)&quot; filling cache.log due to AWS ELB healthchecks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7389">[ date ]</a>
              <a href="thread.html#7389">[ thread ]</a>
              <a href="subject.html#7389">[ subject ]</a>
              <a href="author.html#7389">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
