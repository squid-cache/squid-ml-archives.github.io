<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Multiple connection resets TCP_MISS 000
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Multiple%20connection%20resets%20TCP_MISS%20000&In-Reply-To=%3CCAA9W1OMOnm2-5%2BE7g8Ainz9yXXYnTPFFivi2fPYQvejpKsntLQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007399.html">
   <LINK REL="Next"  HREF="007404.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Multiple connection resets TCP_MISS 000</H1>
    <B>Sunny Aujla</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Multiple%20connection%20resets%20TCP_MISS%20000&In-Reply-To=%3CCAA9W1OMOnm2-5%2BE7g8Ainz9yXXYnTPFFivi2fPYQvejpKsntLQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Multiple connection resets TCP_MISS 000">sunnyfedora99 at googlemail.com
       </A><BR>
    <I>Thu Oct 29 11:14:05 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007399.html">[squid-users] dynamic ssl cert and active directory
</A></li>
        <LI>Next message (by thread): <A HREF="007404.html">[squid-users] Multiple connection resets TCP_MISS 000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7400">[ date ]</a>
              <a href="thread.html#7400">[ thread ]</a>
              <a href="subject.html#7400">[ subject ]</a>
              <a href="author.html#7400">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We're having issues with multiple websites going through our Squid
proxy.  The issues only started to occur when we upgraded from Squid
3.1.8 to 3.5.2.

[Details]
1 - When running a speed test from speedtest.net, it fails when it
get's to the Upload test

2 - Logs show the following:
TCP_MISS_ABORTED 000 0 POST
<A HREF="http://speedtest.lon02.softlayer.com/speedtest/speedtest/upload.php?x=0.8349714460782707">http://speedtest.lon02.softlayer.com/speedtest/speedtest/upload.php?x=0.8349714460782707</A>
FIRSTUP_PARENT/SAML_Pri_Cluster-A

3 - I've gone directly through the firewall (by-passing Squid) and it
work fine.  it's only when we're going through our Squid proxy we see
this issue.

4 - Works fine when we were using Squid 3.1.8

5 - I have tried using Chrome, Firefox and IE

6 - We're using a cache-peer, but I've also tried to go direct through the Squid


[Request Info]
POST <A HREF="http://sl-01-lhr.uk.seacomnet.com/upload.php?x=0.2939773271791637">http://sl-01-lhr.uk.seacomnet.com/upload.php?x=0.2939773271791637</A> HTTP/1.1
Host: sl-01-lhr.uk.seacomnet.com
Proxy-Connection: keep-alive
Content-Length: 243751
Origin: <A HREF="http://c.speedtest.net">http://c.speedtest.net</A>
X-Requested-With: ShockwaveFlash/19.0.0.226
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML,
like Gecko) Chrome/45.0.2454.85 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Referer: <A HREF="http://c.speedtest.net/flash/speedtest.swf?v=352081">http://c.speedtest.net/flash/speedtest.swf?v=352081</A>
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8

content4=content4=TAKKAOQCPGSQPDSUUSHFELEKEJERNXKRRDRORIXCEYQXPEWEXSDROZEYBHMWSBUSKLALHUUKXBXMSNIWUINOHONWZVAZYJKZWBRHHHRKGCOHSKKSXSTRHHHSEMWNQREJKJTESUPWBQYEVXPTZVLBDORJUGQOFOMKZSSFREJYFAGVKATJAZGCGSHGUBGBKBIHRNJWHLWMTAVWCTHMKHYGYVEOJZTXCVWTZJVVYLTAKKAOQCPGSQPDSUUSHFELEKEJERNXKRRDRORIXCEYQXPEWEXSDROZEYBHMWSBUSKLALHUUKXBXMSNIWUINOHONWZVAZYJKZWBRHHHRKGCOHSKKSXSTRHHHSEMWNQREJKJTESUPWBQYEVXPTZVLBDORJUGQOFOMKZSSFREJYFAGVKATJAZGCGSHGUBGBKBIHRNJWHLWMTAVWCTHMKHYGYVEOJZTXCVWTZJVVYLTAKKAOQCPGSQPDSUUSHFELEKEJERNXKRRDRORIXCEYQXPEWEXSDROZEYBHMWSBUSKLALHUUKXBXMSNIWUINOHONWZVAZYJKZWBRHHHRKGCOHSKKSXSTRHHHS....
[Request Info]

[cache.log]
2015/10/29 10:51:10.148 kid2| AsyncCallQueue.cc(55) fireNext: entering
HttpStateData::sentRequestBody(local=&lt;squid_server&gt;:59056
remote=&lt;cache_peerr&gt;:8006 FD 28 flags=1, data=0x2730848)
2015/10/29 10:51:10.148 kid2| AsyncCall.cc(38) make: make call
HttpStateData::sentRequestBody [call69255]
2015/10/29 10:51:10.148 kid2| AsyncJob.cc(123) callStart:
HttpStateData status in: [ job4080]
2015/10/29 10:51:10.148 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 699: errflag 0.
2015/10/29 10:51:10.148 kid2| AsyncJob.cc(152) callEnd: HttpStateData
status out: [ job4080]
2015/10/29 10:51:10.148 kid2| AsyncCallQueue.cc(57) fireNext: leaving
HttpStateData::sentRequestBody(local=&lt;squid_server&gt;:59056
remote=&lt;cache_peerr&gt;:8006 FD 28 flags=1, data=0x2730848)
2015/10/29 10:51:10.154 kid3| Client.cc(345) sentRequestBody:
sentRequestBody: FD 24: size 59697: errflag 0.
2015/10/29 10:51:10.154 kid3| http.cc(2387)
handleRequestBodyProducerAborted: request body aborted:
local=&lt;squid_server&gt;:59055 remote=&lt;cache_peerr&gt;:8006 FD 24 flags=1
2015/10/29 10:51:10.154 kid3| http.cc(2417) abortTransaction: aborting
transaction for request body producer aborted;
local=&lt;squid_server&gt;:59055 remote=&lt;cache_peerr&gt;:8006 FD 24 flags=1,
this 0x1b211b8
2015/10/29 10:51:10.154 kid3| AsyncCall.cc(93) ScheduleCall:
IoCallback.cc(135) will call
HttpStateData::readReply(local=&lt;squid_server&gt;:59055
remote=&lt;cache_peerr&gt;:8006 FD 24 flags=1, errno=11, flag=-10,
data=0x1b211b8, size=0, buf=0x1bab460) [call89007]
2015/10/29 10:51:10.154 kid3| Client.cc(571) cleanAdaptation: cleaning
ICAP; ACL: 0
2015/10/29 10:51:10.154 kid3| http.cc(142) ~HttpStateData:
HttpStateData 0x1b211b8 destroyed; local=&lt;squid_server&gt;:59055
remote=&lt;cache_peerr&gt;:8006 flags=1
2015/10/29 10:51:10.154 kid3| AsyncCallQueue.cc(55) fireNext: entering
HttpStateData::readReply(local=&lt;squid_server&gt;:59055
remote=&lt;cache_peerr&gt;:8006 flags=1, errno=11, flag=-10, data=0x1b211b8,
size=0, buf=0x1bab460)
2015/10/29 10:51:10.154 kid3| AsyncCall.cc(38) make: make call
HttpStateData::readReply [call89007]
2015/10/29 10:51:10.155 kid3| AsyncCall.cc(56) cancel: will not call
HttpStateData::readReply [call89007] because job gone
2015/10/29 10:51:10.155 kid3| AsyncCall.cc(48) make: will not call
HttpStateData::readReply [call89007] because of job gone
2015/10/29 10:51:10.155 kid3| AsyncCallQueue.cc(57) fireNext: leaving
HttpStateData::readReply(local=&lt;squid_server&gt;:59055
remote=&lt;cache_peerr&gt;:8006 flags=1, errno=11, flag=-10, data=0x1b211b8,
size=0, buf=0x1bab460)
2015/10/29 10:51:10.155 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 36562: errflag 0.
2015/10/29 10:51:10.162 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 45358: errflag 0.
2015/10/29 10:51:10.170 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 38608: errflag 0.
2015/10/29 10:51:10.170 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 28388: errflag 0.
2015/10/29 10:51:10.177 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 39: errflag 0.
2015/10/29 10:51:10.178 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 51082: errflag 0.
2015/10/29 10:51:10.178 kid2| Client.cc(345) sentRequestBody:
sentRequestBody: FD 28: size 36803: errflag 0.
[cache.log]

I've tried several different config options in Squid.conf, but no luck.
example.:
dns_v4_first on
maximum_object_size 32 MB
client_request_buffer_max_size 10240 KB

Has anyone faced this issue or give me some tips?

Regards,
Sunny

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007399.html">[squid-users] dynamic ssl cert and active directory
</A></li>
	<LI>Next message (by thread): <A HREF="007404.html">[squid-users] Multiple connection resets TCP_MISS 000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7400">[ date ]</a>
              <a href="thread.html#7400">[ thread ]</a>
              <a href="subject.html#7400">[ subject ]</a>
              <a href="author.html#7400">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
