<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Host header forgery detected after upgrade from 3.5.8 to 3.5.9
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Host%20header%20forgery%20detected%20after%20upgrade%20from%0A%203.5.8%20to%203.5.9&In-Reply-To=%3C56325C54.3070703%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007423.html">
   <LINK REL="Next"  HREF="005851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Host header forgery detected after upgrade from 3.5.8 to 3.5.9</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Host%20header%20forgery%20detected%20after%20upgrade%20from%0A%203.5.8%20to%203.5.9&In-Reply-To=%3C56325C54.3070703%40measurement-factory.com%3E"
       TITLE="[squid-users] Host header forgery detected after upgrade from 3.5.8 to 3.5.9">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct 29 17:50:12 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007423.html">[squid-users] Host header forgery detected after upgrade from 3.5.8 to 3.5.9
</A></li>
        <LI>Next message (by thread): <A HREF="005851.html">[squid-users] Site not Working through SQUID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7424">[ date ]</a>
              <a href="thread.html#7424">[ thread ]</a>
              <a href="subject.html#7424">[ subject ]</a>
              <a href="author.html#7424">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/29/2015 11:29 AM, Matus UHLAR - fantomas wrote:
&gt;&gt;<i> On 10/28/2015 10:46 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i> NP: these problems do not exist for forward proxies. Only for traffic
</I>&gt;&gt;&gt;<i> hijacking interceptor proxies.
</I>&gt;<i> 
</I>&gt;<i> On 29.10.15 09:05, Alex Rousskov wrote:
</I>&gt;&gt;<i> For intercepted connections, Squid should, with an admin permission,
</I>&gt;&gt;<i> connect to the intended IP address without validating whether that IP
</I>&gt;&gt;<i> address matches the domain name (and without any side effects of such
</I>&gt;&gt;<i> validation). In interception mode, the proxy should be as &quot;invisible&quot;
</I>&gt;&gt;<i> (or as &quot;invasive&quot;) as the admin wants it to be IMO -- all validations
</I>&gt;&gt;<i> and protections should be optional. We could still enable them by
</I>&gt;&gt;<i> default, of course.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> SslBumped CONNECT-to-IP tunnels are essentially intercepted connections
</I>&gt;&gt;<i> as well, even if they are using forwarding (not intercepting) http_ports.
</I>
&gt;<i> the &quot;admin permission&quot; is the key qestion here.  
</I>
Agreed. And understanding of what giving that permission implies!


&gt;<i> There's possible problem
</I>&gt;<i> where the malicious client can connect to malicious server, ask for any
</I>&gt;<i> server name and the malicious content could get cached by squid as a proper
</I>&gt;<i> response.
</I>
Very true, provided that Squid trusts the unverified domain name to do
caching. Squid does not have to do that. As Amos have noted, there are
smart ways to minimize most of these problems, but they require more
development work.

IMHO, it is important to establish the &quot;do no harm&quot; principle first and
then use that to guide our development efforts. Unfortunately, some of
the validation code was introduced under different principles, and we
may still be debating what &quot;harm&quot; really means in this context while
adjusting that code to meet varying admin needs.

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007423.html">[squid-users] Host header forgery detected after upgrade from 3.5.8 to 3.5.9
</A></li>
	<LI>Next message (by thread): <A HREF="005851.html">[squid-users] Site not Working through SQUID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7424">[ date ]</a>
              <a href="thread.html#7424">[ thread ]</a>
              <a href="subject.html#7424">[ subject ]</a>
              <a href="author.html#7424">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
