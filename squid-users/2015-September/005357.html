<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] nf getsockopt(so_original_dst) failed on local=192.168.1.1:3128 remote=192.168.1.120 FD 518 flags=33: (2) No such file or directory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20nf%20getsockopt%28so_original_dst%29%20failed%20on%0A%20local%3D192.168.1.1%3A3128%20remote%3D192.168.1.120%20FD%20518%20flags%3D33%3A%20%282%29%20No%20such%0A%20file%20or%20directory&In-Reply-To=%3C55E749FF.3070608%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005354.html">
   <LINK REL="Next"  HREF="005360.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] nf getsockopt(so_original_dst) failed on local=192.168.1.1:3128 remote=192.168.1.120 FD 518 flags=33: (2) No such file or directory</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20nf%20getsockopt%28so_original_dst%29%20failed%20on%0A%20local%3D192.168.1.1%3A3128%20remote%3D192.168.1.120%20FD%20518%20flags%3D33%3A%20%282%29%20No%20such%0A%20file%20or%20directory&In-Reply-To=%3C55E749FF.3070608%40treenet.co.nz%3E"
       TITLE="[squid-users] nf getsockopt(so_original_dst) failed on local=192.168.1.1:3128 remote=192.168.1.120 FD 518 flags=33: (2) No such file or directory">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Sep  2 19:11:59 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005354.html">[squid-users] nf getsockopt(so_original_dst) failed on	local=192.168.1.1:3128 remote=192.168.1.120 FD 518 flags=33:	(2) No such file or directory
</A></li>
        <LI>Next message (by thread): <A HREF="005360.html">[squid-users] doing user/pass auth and src acl on same instance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5357">[ date ]</a>
              <a href="thread.html#5357">[ thread ]</a>
              <a href="subject.html#5357">[ subject ]</a>
              <a href="author.html#5357">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/09/2015 5:22 a.m., Juan Porter wrote:
&gt;<i> 
</I>&gt;<i> Hello there! :)
</I>&gt;<i> 
</I>&gt;<i> Can you tell me what it means?  The following line in my cache.log file:
</I>&gt;<i> 
</I>&gt;<i> nf getsockopt(so_original_dst) failed on local=192.168.1.1:3128
</I>&gt;<i> remote=192.168.1.120 FD 518 flags=33: (2) No such file or directory
</I>&gt;<i> 
</I>&gt;<i> When this kind of lines appear in my log, also the CPU goes to 100 % with
</I>&gt;<i> the squid process to top.
</I>&gt;<i> 
</I>&gt;<i> What it means that log line?
</I>
It means the traffic arriving at an intercept port on Squid did not come
from your operating systems NAT module.


HTTP/1.x has two slightly different protocol syntaxes, and NAT/TPROXY
each have different ways to lookup the IPs, all of which are mutually
exclusive.

You MUST use different http_ports to receive each type of traffic. For
example;

  http_port 3128
  http_port 3129 intercept


You also need to ensure the firewall on the Squid machine has rules
preventing anything outside the OS itself from sending packets to the
Squid interception port(s).

For netfilter / iptables that is the mangle table rule which can be seen
in the config examples such as:
&lt;<A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect">http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect</A>&gt;

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005354.html">[squid-users] nf getsockopt(so_original_dst) failed on	local=192.168.1.1:3128 remote=192.168.1.120 FD 518 flags=33:	(2) No such file or directory
</A></li>
	<LI>Next message (by thread): <A HREF="005360.html">[squid-users] doing user/pass auth and src acl on same instance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5357">[ date ]</a>
              <a href="thread.html#5357">[ thread ]</a>
              <a href="subject.html#5357">[ subject ]</a>
              <a href="author.html#5357">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
