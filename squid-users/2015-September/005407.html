<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Default ssl-bump that works with chrome/opera
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Default%20ssl-bump%20that%20works%20with%20chrome/opera&In-Reply-To=%3C55EAE78A.9060406%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005406.html">
   <LINK REL="Next"  HREF="005408.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Default ssl-bump that works with chrome/opera</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Default%20ssl-bump%20that%20works%20with%20chrome/opera&In-Reply-To=%3C55EAE78A.9060406%40gmail.com%3E"
       TITLE="[squid-users] Default ssl-bump that works with chrome/opera">yvoinov at gmail.com
       </A><BR>
    <I>Sat Sep  5 13:00:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005406.html">[squid-users] Default ssl-bump that works with chrome/opera
</A></li>
        <LI>Next message (by thread): <A HREF="005408.html">[squid-users] Squid3 Authentication don't work properly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5407">[ date ]</a>
              <a href="thread.html#5407">[ thread ]</a>
              <a href="subject.html#5407">[ subject ]</a>
              <a href="author.html#5407">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 


05.09.15 18:30, Xen &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> On 09/05/2015 02:22 PM, Rafael Akchurin wrote:
</I>&gt;&gt;<i> Hello Xen,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate warning was most probably indeed caused by default
</I>SHA-1 signature of the mimicked certificate in stock version of Squid
present by default in popular Linux distribs. Latest version does that
correctly and your &quot;not private&quot; connection warnings in Chrome/etc is
now gone.
&gt;&gt;<i>
</I>&gt;&gt;<i> Please see
</I><A HREF="http://docs.diladele.com/faq/filtering/chrome_not_private.html">http://docs.diladele.com/faq/filtering/chrome_not_private.html</A> - I tried
to explain it clearly.
&gt;&gt;<i> Please note this is may also be caused by your trusted root
</I>certificates expiring in 2017+.
&gt;&gt;<i>
</I>&gt;&gt;<i> Hope other members of the list know better the cipher set. I am very
</I>interested in this too.
&gt;&gt;<i>
</I>&gt;&gt;<i> Best regards,
</I>&gt;&gt;<i> Rafael Akchurin
</I>&gt;&gt;<i> Diladele B.V.
</I>&gt;<i>
</I>&gt;<i> Thank you mr. Diladele. Actually when I first ran into this I was
</I>using your packaged version of Squid on Windows. I just couldn't get it
working, although I had a wrong certificate (generated in a different
way on Debian) at first and I didn't notice. But after that was fixed,
if I remember correclty, I still had the problems with Opera and Chrome.
&gt;<i>
</I>&gt;<i> I have no clue what changed now to remove this problem. Maybe my
</I>memory is incorrect of this.
&gt;<i>
</I>&gt;<i> The Diladele Squid, of course, was a version 3.5
</I>&gt;<i>
</I>&gt;<i> But if you say the SHA1 warning created the Invalid Certificate
</I>warning (as you indicate) then perhaps I am mistaken about my Windows
problems now. In any case I upgraded and now it seems to work :).
&gt;<i>
</I>&gt;<i> Regards...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>]
</I>On Behalf Of Xen
&gt;&gt;<i> Sent: Saturday, September 5, 2015 1:58 PM
</I>&gt;&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> Subject: [squid-users] Default ssl-bump that works with chrome/opera
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hey,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Might I perhaps ask.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Currently with the default minimum configuration for ssl-bump that is
</I>advocated everywhere, my Firefox bumping works but Chrome and Opera are
more strict and will say my certificate is invalid.
&gt;&gt;<i>
</I>&gt;&gt;<i> The certificate was simply generated (self-signed) with openssl x509
</I>with no additional options for cipher or message digest or whatever.
&gt;&gt;<i> Browsers typically complain that the certificate was signed using an
</I>insecure hash (sha1). I don't know if this is the result of my own
certificate or whether it is the result of what Squid does to it using
the regen it does.
All you need just re-generate your proxy CA with right options. Look at
the examples:

# SHA1 signing
openssl req -x509 -new -nodes -config D:\OpenSSL-Win64\bin\openssl.cfg
-key rootCA.key -days 10950 -out rootCA.crt
# SHA256 signing
openssl req -x509 -sha256 -new -nodes -config
D:\OpenSSL-Win64\bin\openssl.cfg -key rootCA.key -days 10950 -out rootCA.crt

# High grade:
openssl genrsa -out rootCA.key 3072
openssl req -x509 -sha512 -new -nodes -config
D:\OpenSSL-Win64\bin\openssl.cfg -key rootCA.key -days 10950 -out rootCA.crt

# Highest grade:
openssl genrsa -out rootCA.key 4096
openssl req -x509 -sha512 -new -nodes -config
D:\OpenSSL-Win64\bin\openssl.cfg -key rootCA.key -days 10950 -out rootCA.crt


&gt;&gt;<i>
</I>&gt;&gt;<i> Actually Chromium works fine now, I don't know why that change. I had
</I>so many problems with it.
&gt;&gt;<i>
</I>&gt;&gt;<i> In fact, I don't know what happened. Both Chromium and Opera now work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I did upgrade to 3.5.7 but I tested after.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> All browsers mostly complain about using obsolete cipher suites though.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So that is the question I wanted to ask: Is there a default SSL
</I>configuration for Squid that will limit or reduce or do away with those
obsolete cipher questions and remarks?
Feel free to read Squid wiki. :)

<A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit#Hardening">http://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit#Hardening</A>

&gt;&gt;<i>
</I>&gt;&gt;<i> I have been trying to find configs on the web, but they go into great
</I>technical detail about those ciphers and also require you to make
difficult choices you can't make until and unless you are a security expert.
&gt;&gt;<i>
</I>&gt;&gt;<i> I believe going from RSA to ECDHE_ECDSA (or something similar) will
</I>do the trick. But I also read here about Squid supporting something only
in version 4.
&gt;&gt;<i>
</I>&gt;&gt;<i> Even typing that word makes me sick. ECDHE_ECDSA buh.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does it have to be anything more difficult :P.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there a smallest subset SSL configuration for Squid that will
</I>simply reduce those messages and allow the level of security of the
original site not to go down as much? I would think that Squid doesn't
communicate with that server any different than it does with me. So the
whole chain is now using something less than it did before.
&gt;&gt;<i>
</I>&gt;&gt;<i> So that is my question: give me 3 lines of code (or configuration)
</I>that will allow this?
&gt;&gt;<i>
</I>&gt;&gt;<i> I beg of you :p :).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards, X.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJV6ueKAAoJENNXIZxhPexG3tIH/RrrcT5IMnYb3tuPqNs1PfCu
Fj6tpYGbC9g/VS5Iv8DAe4xV27PcLXdG2+RLUrEM3/8OLxb0pDfDdCHLKU9ZsXZS
2TI3sjkXAVFjSJDRt1JMBGQRY/DYp6cLMNfrkyeBvPVr8psopI/haoGUBX1y0eot
Bo+ULvxNAdksIiFLt6ecY9wUBDyUO/iUKztC+Mg73fsjqh28JyD55aCrKldNs2Es
iXdJvypEjk7xz/aBoesi1T/xJb/P2U0Vv0oD9leDx05tlPdutK0L/O8YkTrUl7Zt
8xpj2pXwptT9w76aGNuQ3mfxFypoEJYzv5rKaC3CMC67ROF6FqFrKBnN+FtKJ5c=
=wOcF
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005406.html">[squid-users] Default ssl-bump that works with chrome/opera
</A></li>
	<LI>Next message (by thread): <A HREF="005408.html">[squid-users] Squid3 Authentication don't work properly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5407">[ date ]</a>
              <a href="thread.html#5407">[ thread ]</a>
              <a href="subject.html#5407">[ subject ]</a>
              <a href="author.html#5407">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
