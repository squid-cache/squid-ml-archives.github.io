<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.8 RPMs release for CentOS 32 and 64 bit
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.8%20RPMs%20release%20for%20CentOS%2032%20and%2064%20bit&In-Reply-To=%3C55EE0C75.1020405%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005403.html">
   <LINK REL="Next"  HREF="005404.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.8 RPMs release for CentOS 32 and 64 bit</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.8%20RPMs%20release%20for%20CentOS%2032%20and%2064%20bit&In-Reply-To=%3C55EE0C75.1020405%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid 3.5.8 RPMs release for CentOS 32 and 64 bit">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Sep  7 22:15:17 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005403.html">[squid-users] [squid-announce] Squid 3.5.8 is available
</A></li>
        <LI>Next message (by thread): <A HREF="005404.html">[squid-users] Default ssl-bump that works with chrome/opera
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5442">[ date ]</a>
              <a href="thread.html#5442">[ thread ]</a>
              <a href="subject.html#5442">[ subject ]</a>
              <a href="author.html#5442">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Published at: <A HREF="http://www1.ngtech.co.il/wpe/?p=142">http://www1.ngtech.co.il/wpe/?p=142</A>



I am happy to release the new RPMs of squid 3.5.8 for Centos 6 64bit, 
32bit and CentOS 7 64bit.

The new release includes couple bug fixes and improvements.
The details about the the RPMs repository are at 
squid-wiki[<A HREF="http://wiki.squid-cache.org/KnowledgeBase/CentOS">http://wiki.squid-cache.org/KnowledgeBase/CentOS</A>].
* couple important notes about this release in the end of the article

Do we need to protect squid?

Squid comes also to protect other applications but the past lessons 
teach us that squid like any other software is vulnerable. It can act as 
an internal management service inside a company or an external service 
connecting an external network to some internal systems.
Places that use squid do not always say they do but universities is one 
of the users of squid around the internet. Most of them give access to 
some internal system using a user credentials, a single sign-on pass or 
other authentication methods. In all of these places there is a chance 
that some hacker will try to hack the proxy and use it to access these 
internal systems or to access the internet through it. The basics to 
defend a proxy service is to block clients which are using wrong 
authentication credentials.
In most cases the basic act would be to just DROP the IP traffic in the 
firewall. I do not think it&#8217;s a bad way but I do think that using some 
iptables DNAT\REDIRECT rule instead of DROPPING the connection  is kind 
of nicer. especially if it&#8217;s a system that gives users access to work or 
office applications and systems.
Fail2ban is one of the great tools to allow the proxy to defend 
itself(using squid access.log) from basic attacks. And of-course depends 
on the sensitivity of the system a DROP rule can be the right solution 
to mitigate the effect of some attackers.
If you would choose to give the blocked user some information about his 
situation and who to contact about it please use a very lightweight http 
service that can take load and use 100% static pages for that 
purpose.(IE don&#8217;t use apache with PHP in it).
For this action you would require a special action from fail2ban in the 
mangle table of iptables.

An example fail2ban action file: &#8220;action.d/iptables-redirect.conf&#8221;
# Fail2Ban configuration file
#
# Author: Cyril Jaquier
# Modified by Yaroslav Halchenko for multiport banning
# Modified by Eliezer Croitoru for DNAT into a ban page\service

[INCLUDES]
before = iptables-common.conf

[Definition]
actionstart = &lt;iptables&gt; -t nat -N f2b-&lt;name&gt;
               &lt;iptables&gt; -t nat -A f2b-&lt;name&gt; -j &lt;returntype&gt;
               &lt;iptables&gt; -t nat -I &lt;chain&gt; -p &lt;protocol&gt; -m multiport 
--dports &lt;port&gt; -j f2b-&lt;name&gt;

actionstop = &lt;iptables&gt; -t nat -D &lt;chain&gt; -p &lt;protocol&gt; -m multiport 
--dports &lt;port&gt; -j f2b-&lt;name&gt;
              &lt;iptables&gt; -t nat -F f2b-&lt;name&gt;
              &lt;iptables&gt; -tnat -X f2b-&lt;name&gt;

actioncheck = &lt;iptables&gt; -n -L &lt;chain&gt; | grep -q 'f2b-&lt;name&gt;[ \t]'

actionban = &lt;iptables&gt; -t nat -I f2b-&lt;name&gt; 1 -p &lt;protocol&gt; -s &lt;ip&gt; -j 
REDIRECT --to-ports 8080

actionunban = &lt;iptables&gt; -t nat -D f2b-&lt;name&gt; -p &lt;protocol&gt; -s &lt;ip&gt; -j 
REDIRECT --to-ports 8080

[Init]
##END

I hope it will help others to improve their service.

In this release I will recommend about a nice tutorial video about DDOS 
from Krassimir Tzvetanov, A10 Networks, 
Inc.[<A HREF="https://www.youtube.com/watch?v=POFEMlQw6Rc">https://www.youtube.com/watch?v=POFEMlQw6Rc</A>]
This talk covers the principles and particular implementations of DDoS. 
It goes in detail as to what are the bottlenecks that are generally 
exploited/overloaded, the attack types and the solutions to those.

Or a local mirror at:
Tutorial: Denial of Service 
101[<A HREF="http://ngtech.co.il/squid/videos/POFEMlQw6Rc.mp4">http://ngtech.co.il/squid/videos/POFEMlQw6Rc.mp4</A>]

A note: From this RPM release for the CentOS 7 RPM I have replaced the 
sysV init script with a systemd scripts that can monitor squid but 
requires a special script to make sure that systemd will not halt the 
system before squid was able to shutdown properly.
Also the default number of open file descriptors per process is set to 
16384 and if you want to change it use one of the two options that are 
mentioned in the systemd mailing list :
solution 1, override the unit 
file[<A HREF="http://lists.freedesktop.org/archives/systemd-devel/2015-September/034094.html">http://lists.freedesktop.org/archives/systemd-devel/2015-September/034094.html</A>]
solution 2, override the service relevant 
variable[<A HREF="http://lists.freedesktop.org/archives/systemd-devel/2015-September/034095.html">http://lists.freedesktop.org/archives/systemd-devel/2015-September/034095.html</A>]
The upgrade into the systemd unit file will be reflected when stopping, 
restarting, upgrading or any other stop related usage of the unit.

More details about the repository at 
squid-wiki[<A HREF="http://wiki.squid-cache.org/KnowledgeBase/CentOS">http://wiki.squid-cache.org/KnowledgeBase/CentOS</A>].

All The Bests,
Eliezer Croitoru

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005403.html">[squid-users] [squid-announce] Squid 3.5.8 is available
</A></li>
	<LI>Next message (by thread): <A HREF="005404.html">[squid-users] Default ssl-bump that works with chrome/opera
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5442">[ date ]</a>
              <a href="thread.html#5442">[ thread ]</a>
              <a href="subject.html#5442">[ subject ]</a>
              <a href="author.html#5442">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
