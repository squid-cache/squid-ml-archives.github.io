<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 3.5.8 &#8212; SSL Bump questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%3D%3Futf-8%3Fq%3F3%3D2E5%3D2E8_%3DE2%3D80%3D94_SSL_Bump_questions%3F%3D&In-Reply-To=%3C55EFC926.5040606%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005472.html">
   <LINK REL="Next"  HREF="005453.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 3.5.8 &#8212; SSL Bump questions</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%3D%3Futf-8%3Fq%3F3%3D2E5%3D2E8_%3DE2%3D80%3D94_SSL_Bump_questions%3F%3D&In-Reply-To=%3C55EFC926.5040606%40treenet.co.nz%3E"
       TITLE="[squid-users] 3.5.8 &#8212; SSL Bump questions">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Sep  9 05:52:38 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005472.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
        <LI>Next message (by thread): <A HREF="005453.html">[squid-users] Squid reverse proxy with SSL bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5478">[ date ]</a>
              <a href="thread.html#5478">[ thread ]</a>
              <a href="subject.html#5478">[ subject ]</a>
              <a href="author.html#5478">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/09/2015 8:42 a.m., James Lay wrote:
&gt;<i> On 2015-09-08 02:32 PM, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 09/08/2015 02:18 PM, James Lay wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm currently having great success with 3.5.8 and this
</I>&gt;&gt;&gt;<i> peek/splice only method using transparent intercept:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ###############################
</I>&gt;&gt;&gt;<i> acl step1 at_step SslBump1
</I>&gt;&gt;&gt;<i> acl step2 at_step SslBump2
</I>&gt;&gt;&gt;<i> acl step3 at_step SslBump3
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ssl_bump peek step1 all
</I>&gt;&gt;&gt;<i> ssl_bump peek step2 all
</I>&gt;&gt;&gt;<i> acl allowed_https_sites ssl::server_name_regex
</I>&gt;&gt;&gt;<i> &quot;/opt/etc/squid/http_url.txt&quot;
</I>&gt;&gt;&gt;<i> ssl_bump splice step3 allowed_https_sites
</I>&gt;&gt;&gt;<i> ssl_bump terminate all
</I>&gt;&gt;&gt;<i> ###############################
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Bugs notwithstanding, the above can be further simplified (in v3.5.8 and
</I>&gt;&gt;<i> later):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  acl allowed_https_sites ...
</I>&gt;&gt;<i>  ssl_bump peek all
</I>&gt;&gt;<i>  ssl_bump splice allowed_https_sites
</I>&gt;&gt;<i>  ssl_bump terminate all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;<i> Hey thanks Alex...I will give that a test with 3.5.8.  I also recall in
</I>&gt;<i> earlier builds that &quot;ssl_bump peek all&quot; only matched SNI, but did not
</I>&gt;<i> match the cert subject, which is why I forced it with peeking at step1
</I>&gt;<i> and step2.  Thanks again.
</I>&gt;<i> 
</I>
Prior to 3.5.8 a &quot;peek all&quot; would have matched at step3 and caused weird
things to happen later.

As of 3.5.8 it is ignored properly and the splice gets to check the
server cert. Alex suggested config should work identically to yours.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005472.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
	<LI>Next message (by thread): <A HREF="005453.html">[squid-users] Squid reverse proxy with SSL bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5478">[ date ]</a>
              <a href="thread.html#5478">[ thread ]</a>
              <a href="subject.html#5478">[ subject ]</a>
              <a href="author.html#5478">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
