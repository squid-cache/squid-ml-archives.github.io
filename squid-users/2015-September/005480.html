<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 3.5.8 &#8212; SSL Bump questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%3D%3Futf-8%3Fq%3F3%3D2E5%3D2E8_%3DE2%3D80%3D94_SSL_Bump_questions%3F%3D&In-Reply-To=%3C55EFF505.90606%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005479.html">
   <LINK REL="Next"  HREF="005490.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 3.5.8 &#8212; SSL Bump questions</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%3D%3Futf-8%3Fq%3F3%3D2E5%3D2E8_%3DE2%3D80%3D94_SSL_Bump_questions%3F%3D&In-Reply-To=%3C55EFF505.90606%40treenet.co.nz%3E"
       TITLE="[squid-users] 3.5.8 &#8212; SSL Bump questions">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Sep  9 08:59:49 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005479.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
        <LI>Next message (by thread): <A HREF="005490.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5480">[ date ]</a>
              <a href="thread.html#5480">[ thread ]</a>
              <a href="subject.html#5480">[ subject ]</a>
              <a href="author.html#5480">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/09/2015 7:39 p.m., Jason Haar wrote:
&gt;<i> On 08/09/15 20:32, Amos Jeffries wrote:
</I>&gt;&gt;<i> The second one is a fake CONNECT generated internally by Squid using
</I>&gt;<i> Is it too late to propose that intercepted SSL transactions be logged as
</I>&gt;<i> something besides &quot;CONNECT&quot;? I know I find it confusing - and so do
</I>&gt;<i> others. I appreciate the logic behind it - but people are people :-)
</I>&gt;<i> 
</I>
Yeah.  theres people - they need to stop looking at the *HTTP messages
log* and thinking it says anything about bumping. All it says this the
*side effects* of bumping which happen in the HTTP layer.

Then there is the actual log processing software. And access.log is an
HTTP transaction log, the detail being logged is the HTTP method being
enacted by the HTTP software (Squid).


TLS/SSL is a different protocol to HTTP. It should not be warped into
HTTP log syntax. Trying to do so is what is confusing you. And the HTTP
side effects are not clear.


Try this (a log for the actual TLS / SSL-bump details):

logformat tlslog %tS %6tr %&gt;a:%&gt;p %&gt;la:%&gt;lp \
  %ssl::bump_mode %ssl::&gt;sni %&lt;A/%&lt;a \
  &quot;%ssl::&gt;cert_subject&quot; &quot;%ssl::&gt;cert_issuer&quot;

access_log stdio:/var/log/squid/tls.log tlslog SSL_ports

That is;
 the time things started,
 how long it took in ms,
 the client IP:port,
 server IP:port it was connecting to (might be Squid),
 the bumping mode squid was doing,
 SNI (if any),
 the server actually connected to (FQDN and IP),
 the cert details that server presented.

I'm not sure which format code gets populated with SSL error details
when cert validation fails. That should be added on the end too.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005479.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
	<LI>Next message (by thread): <A HREF="005490.html">[squid-users] 3.5.8 &#8212; SSL Bump questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5480">[ date ]</a>
              <a href="thread.html#5480">[ thread ]</a>
              <a href="subject.html#5480">[ subject ]</a>
              <a href="author.html#5480">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
