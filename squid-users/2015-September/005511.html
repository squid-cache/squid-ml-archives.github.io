<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] redirect directly to error page
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20redirect%20directly%20to%20error%20page&In-Reply-To=%3C55F7E9D7.7080007%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005507.html">
   <LINK REL="Next"  HREF="005516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] redirect directly to error page</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20redirect%20directly%20to%20error%20page&In-Reply-To=%3C55F7E9D7.7080007%40treenet.co.nz%3E"
       TITLE="[squid-users] redirect directly to error page">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Sep 15 09:50:15 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005507.html">[squid-users] redirect directly to error page
</A></li>
        <LI>Next message (by thread): <A HREF="005516.html">[squid-users] redirect directly to error page
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5511">[ date ]</a>
              <a href="thread.html#5511">[ thread ]</a>
              <a href="subject.html#5511">[ subject ]</a>
              <a href="author.html#5511">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/09/2015 3:13 a.m., Matus UHLAR - fantomas wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> we have squidguard on a few servers and I'd like to redirect client's
</I>&gt;<i> request
</I>&gt;<i> directly to squid's error page, e.g.  ERR_ACCESS_DENIED
</I>&gt;<i> Is that possible directly through e.g. internal URL, or do I have to play
</I>&gt;<i> with special page and acl?
</I>&gt;<i> (it should work for CONNECT requests too)
</I>&gt;<i> 
</I>&gt;<i> squid-3.1.20 (debian 7) here
</I>&gt;<i> 
</I>
This is a very good example of how SG and tools like it are abusing
Squid. The URL-rewrite/redirect interface they are plugged into is
intended and designed to mangle the URL. Nothing more.

By the time the URL-rewrite helper lookup is sent the access controls
have already determined that the request access is *accepted* and
*allowed*. It is even almost finished being processed. Far too late to
deny it.


The right way to perform access authorization is with the http_access or
adapted_http_access rules. That is also the only way to *generate*
ERR_ACCESS_DENIED.

Those rules have an external_acl_type helper interface for performing
helper lookups and dont need any fancy trickery with URLs or web
servers. deny_info is provided for presenting custom pages (or HTTP
redirect URLs) from any ACL results.

And yes, doing it the right way will work with CONNECT too. In so far as
Squid output is concerned anyway. The popular browsers are still
refusing to honour any kind of non-200 response from proxies.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005507.html">[squid-users] redirect directly to error page
</A></li>
	<LI>Next message (by thread): <A HREF="005516.html">[squid-users] redirect directly to error page
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5511">[ date ]</a>
              <a href="thread.html#5511">[ thread ]</a>
              <a href="subject.html#5511">[ subject ]</a>
              <a href="author.html#5511">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
