<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Is it possible to send the connection, starting with the CONNECT, to cache-peer?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Is%20it%20possible%20to%20send%20the%20connection%2C%0A%20starting%20with%20the%20CONNECT%2C%20to%20cache-peer%3F&In-Reply-To=%3C55F85BB2.90308%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005528.html">
   <LINK REL="Next"  HREF="005532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Is it possible to send the connection, starting with the CONNECT, to cache-peer?</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Is%20it%20possible%20to%20send%20the%20connection%2C%0A%20starting%20with%20the%20CONNECT%2C%20to%20cache-peer%3F&In-Reply-To=%3C55F85BB2.90308%40gmail.com%3E"
       TITLE="[squid-users] Is it possible to send the connection, starting with the CONNECT, to cache-peer?">yvoinov at gmail.com
       </A><BR>
    <I>Tue Sep 15 17:56:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005528.html">[squid-users] Is it possible to send the connection,	starting with the CONNECT, to cache-peer?
</A></li>
        <LI>Next message (by thread): <A HREF="005532.html">[squid-users] List of all additional parameters for url_rewrite	helpers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5529">[ date ]</a>
              <a href="thread.html#5529">[ thread ]</a>
              <a href="subject.html#5529">[ subject ]</a>
              <a href="author.html#5529">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
Hi Antony,

thank your for answer.

My problem is a bit specific.

I have some permanently ISP-banned sites. I need to pass-through it from
transparent interception Squid to cache_peer - both plain HTTP and HTTPS
tunnels without decryption. Sites defined in ACL.

HTTP-only sessions forwarded correctly, but HTTPS is not. They goes
directly.

I can't pass all connections via tunnel. Just some specific sites.

Example: torproject.org is permanently HTTPS now. Session starts with
CONNECT method.
If IP's banned by ISP, forwarding into parent (with Tor) does not work.

I've tried to solve this, but unseccessful.

Yes, I can use Tor browser itself. But via Squid+Privoxy+Tor - doesn't work.

15.09.15 23:49, Antony Stone &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> On Tuesday 15 September 2015 at 19:45:05, Yuri Voinov wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I want to get the answer the people who did it. And not those that
</I>&gt;&gt;<i> suggest that they could do it.
</I>&gt;<i>
</I>&gt;<i> I have a suggestion which I hope may help - show us a configuration
</I>you have
&gt;<i> tried, following the documentation, and tell us in what way it fails
</I>to work
&gt;<i> as expected - then we may be able to show you where the error is.
</I>&gt;<i>
</I>&gt;<i> It's quite significant that in your original question, you did not
</I>mention you
&gt;<i> were using Squid in transparent SSL Bump mode, therefore the answer you
</I>&gt;<i> received did not take this into account.
</I>&gt;<i>
</I>&gt;<i> The more information you give us about what you want to achieve, what
</I>you've
&gt;<i> done so far, and what goes wrong, the more we are able to help you
</I>debug the
&gt;<i> problem.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Antony.
</I>&gt;<i>
</I>&gt;&gt;<i> 15.09.15 23:42, Matus UHLAR - fantomas &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;&gt;&gt;<i> On 15.09.15 22:45, Yuri Voinov wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Does anyone know - is it possible to send the connection, starting
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> with the CONNECT, to cache-peer?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 15.09.15 23:17, Matus UHLAR - fantomas &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;&gt;&gt;<i> cache_peer_access with proper ACLs should do that.
</I>&gt;&gt;&gt;&gt;&gt;<i> note that always_direct can avoid it.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 15.09.15 23:33, Yuri Voinov wrote:
</I>&gt;&gt;&gt;&gt;<i> Squid working in transparent SSL Bump mode.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> AFAIK, here is SSL decrypts. AFAIK, decrypted tunnel denied to be
</I>&gt;&gt;&gt;&gt;<i> forwarded to parent.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I need to forward some URLs without decryption to peer. Whole session
</I>&gt;&gt;&gt;&gt;<i> starting with CONNECT.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Problem: Peer must accepts both HTTP and HTTPS connections. Yes, there
</I>&gt;&gt;&gt;&gt;<i> is Privoxy, which can tunnel CONNECT. How to tell Squid - &quot;Forward this
</I>&gt;&gt;&gt;&gt;<i> URL and this URL into peer, whenever HTTP or HTTPS&quot;?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> disable sslbump (enable &quot;splice&quot;) with proper ACLs:
</I>&gt;&gt;&gt;<i> <A HREF="http://www.squid-cache.org/Doc/config/ssl_bump/">http://www.squid-cache.org/Doc/config/ssl_bump/</A>
</I>&gt;<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJV+FuyAAoJENNXIZxhPexGH4UH/i2tix795ui5wyJYud2dri4X
aNvxYHDEKY0fT94y7CKZm2uHAXv1UxY/GWT3DCXkF63jFIrXKvLlm+pfQT7cvpos
O2up5jrgXVg86/8MoTuFH5A3MSNYH01N0qfG85+YW/qGpVRvXdpfDZFrj/dBtefA
t2+geOcPZ7LIcwzqCuuoJ8VVJMTmYBVDcpSFFdGcieVPUq3kuMP++kRC/Gn7znGh
L9NgHCuUcQ7g7CUQViX5I3a8rU6SDhl0gLj9KUvkp0zqUO9cSifZakmFowTBzTyd
Ix8AgE0R5puGpLv4PyGyuI6Be3cSQCpitQYlB0jrvsfqOqO2v3LMIDZAlh1yj5M=
=GK+k
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005528.html">[squid-users] Is it possible to send the connection,	starting with the CONNECT, to cache-peer?
</A></li>
	<LI>Next message (by thread): <A HREF="005532.html">[squid-users] List of all additional parameters for url_rewrite	helpers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5529">[ date ]</a>
              <a href="thread.html#5529">[ thread ]</a>
              <a href="subject.html#5529">[ subject ]</a>
              <a href="author.html#5529">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
