<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] AUFS vs. DISKS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20AUFS%20vs.%20DISKS&In-Reply-To=%3C1890093659.143588513.1443078610354.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005671.html">
   <LINK REL="Next"  HREF="005668.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] AUFS vs. DISKS</H1>
    <B>FredB</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20AUFS%20vs.%20DISKS&In-Reply-To=%3C1890093659.143588513.1443078610354.JavaMail.root%40zimbra4-e1.priv.proxad.net%3E"
       TITLE="[squid-users] AUFS vs. DISKS">fredbmail at free.fr
       </A><BR>
    <I>Thu Sep 24 07:10:10 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005671.html">[squid-users] AUFS vs. DISKS
</A></li>
        <LI>Next message (by thread): <A HREF="005668.html">[squid-users] Open StoreID http interface from ngtech.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5673">[ date ]</a>
              <a href="thread.html#5673">[ thread ]</a>
              <a href="subject.html#5673">[ subject ]</a>
              <a href="author.html#5673">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> 
</I>&gt;<i> If you want to achieve highest performance it is best to resolve that
</I>&gt;<i> process collision issue. The wrongly indexed entries will be causing
</I>&gt;<i> others to get expired earlier and maybe reduce HIT rate on them.
</I>&gt;<i> 
</I>&gt;<i> The (rather large amount of) extra work Squid is doing to cope with
</I>&gt;<i> the
</I>&gt;<i> missing objects is also sucking away CPU and disk I/O cyces that
</I>&gt;<i> would
</I>&gt;<i> be better used serving traffic.
</I>&gt;<i> 
</I>&gt;<i> So its not a big issue generally, but for high performance it can be
</I>&gt;<i> an
</I>&gt;<i> extra latency issue.
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>

I agree there is no difference under 400 requests by second, I'm speaking about load average, but beyond diskd wins without message like that 
When squid reaches 500 r the difference is huge 

Actually with fast HDD and diskd I'm just CPU limited, beyond 60 % Squid is more slow and there are latency. 

Every day my size Log file is approximately 3.5/4 Go 

iostat -dx 5
sdb and sdc = caches

Linux 3.2.0-4-amd64 (proxy1) 	24/09/2015 	_x86_64_	(6 CPU)

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,01     0,78    0,88    0,94    58,51    49,13   118,47     0,01    4,51    1,46    7,37   0,36   0,06
sdb               3,27    35,83   54,40   21,65   296,05   421,81    18,88     0,17   12,12   10,45   16,30   1,25   9,53
sdc               3,27    35,88   54,67   21,50   298,02   421,97    18,90     0,15   11,89   10,30   15,91   1,24   9,45

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     1,20    0,00    1,80     0,00   141,60   157,33     0,00    0,00    0,00    0,00   0,00   0,00
sdb               0,00   121,20   48,00   27,20   298,40  1334,40    43,43     0,50    6,71   10,18    0,59   1,51  11,36
sdc               0,00   111,00   47,40   20,40   220,80   730,40    28,06     0,34    5,01    7,17    0,00   1,01   6,88

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     1,00    0,00    1,40     0,00   352,00   502,86     0,00    0,57    0,00    0,57   0,57   0,08
sdb               0,00   130,40  118,20   25,40   664,80  1433,60    29,23     1,27    8,84   10,59    0,69   1,11  16,00
sdc               0,00   112,60  116,00   24,60   632,80   748,80    19,65     1,01    7,16    8,63    0,23   0,92  12,96

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     0,40    0,00    0,40     0,00     3,20    16,00     0,00    0,00    0,00    0,00   0,00   0,00
sdb               0,00   118,00  108,80   24,80   596,00   759,20    20,29     0,90    6,77    8,26    0,23   1,31  17,44
sdc               0,00   123,40  160,40   24,40   923,20   796,80    18,61     1,40    7,60    7,89    5,74   1,31  24,24

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     0,40    0,00    0,40     0,00     3,20    16,00     0,00    0,00    0,00    0,00   0,00   0,00
sdb               0,00   106,00  102,60   17,60   669,60   788,80    24,27     0,85    7,06    8,23    0,23   1,54  18,48
sdc               0,00   287,40  166,20  416,40   829,60  3232,00    13,94     3,59    6,16    9,77    4,72   0,42  24,24

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     0,60    0,00    0,60     0,00     4,80    16,00     0,00    0,00    0,00    0,00   0,00   0,00
sdb               0,00   259,20   40,40  452,60   320,00  2967,20    13,34     4,87    9,86   26,53    8,37   0,55  27,12
sdc               0,00   110,20  101,00   20,60   452,00   739,20    19,59     1,88   15,47   18,43    0,97   2,39  29,12

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sda               0,00     0,40    0,00    1,60     0,00     8,00    10,00     0,00    0,50    0,00    0,50   0,50   0,08
sdb               0,00    80,60   87,20   13,60   668,00   444,00    22,06     1,05   10,57   12,22    0,00   2,97  29,92
sdc               0,00   104,60  146,40    6,60   749,60   475,20    16,01     1,82   11,89    8,57   85,45   1,64  25,12


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005671.html">[squid-users] AUFS vs. DISKS
</A></li>
	<LI>Next message (by thread): <A HREF="005668.html">[squid-users] Open StoreID http interface from ngtech.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5673">[ date ]</a>
              <a href="thread.html#5673">[ thread ]</a>
              <a href="subject.html#5673">[ subject ]</a>
              <a href="author.html#5673">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
