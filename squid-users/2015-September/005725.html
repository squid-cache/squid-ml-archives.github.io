<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Streaming Radio blocked
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Streaming%20Radio%20blocked&In-Reply-To=%3C56087CCC.7090100%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005724.html">
   <LINK REL="Next"  HREF="005726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Streaming Radio blocked</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Streaming%20Radio%20blocked&In-Reply-To=%3C56087CCC.7090100%40treenet.co.nz%3E"
       TITLE="[squid-users] Streaming Radio blocked">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Sep 27 23:33:32 UTC 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005724.html">[squid-users] Streaming Radio blocked
</A></li>
        <LI>Next message (by thread): <A HREF="005726.html">[squid-users] Streaming Radio blocked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5725">[ date ]</a>
              <a href="thread.html#5725">[ thread ]</a>
              <a href="subject.html#5725">[ subject ]</a>
              <a href="author.html#5725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/09/2015 9:12 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> It not seems blocked.
</I>&gt;<i> 
</I>&gt;<i> Blocked URL has TCP_DENIED tag.
</I>&gt;<i> 
</I>
Unless the media portion is not even using HTTP. The problem would then
be somewhere else outside Squid.


&gt;<i> 28.09.15 1:54, Henry McLaughlin &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 27 September 2015 at 17:07, Henry McLaughlin wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am having problems using a radio streaming application on my
</I>&gt;<i> phone. The
</I>&gt;&gt;&gt;&gt;<i> phone connection is routed via squid proxy server. If I by pass
</I>&gt;<i> squid then
</I>&gt;&gt;&gt;&gt;<i> the radio application works. The application is TuneIn radio
</I>&gt;<i> (tunein.com).
</I>&gt;&gt;&gt;&gt;<i> I have read a number of posts regarding blocking streaming services
</I>&gt;<i> however
</I>&gt;&gt;&gt;&gt;<i> have not found how to unblock one as I suspect the service is blocked by
</I>&gt;&gt;&gt;&gt;<i> default.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The following appears in the access log:
</I>&gt;&gt;&gt;&gt;<i> 1443337149.538   3239 192.168.1.102 TCP_MISS/200 653 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://ads.tunein.com/creatives?">http://ads.tunein.com/creatives?</A> - HIER_DIRECT/176.34.44.113
</I>&gt;&gt;&gt;&gt;<i> application/json
</I>&gt;&gt;&gt;&gt;<i> 1443337151.830   1968 192.168.1.102 TCP_MISS/200 6367 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://ads.mopub.com/m/ad?">http://ads.mopub.com/m/ad?</A> - HIER_DIRECT/192.44.68.3 text/html
</I>&gt;&gt;&gt;&gt;<i> 1443337152.292   3661 192.168.1.102 TCP_MISS/200 478 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://opml.radiotime.com/Report.ashx?">http://opml.radiotime.com/Report.ashx?</A> - HIER_DIRECT/204.69.221.89
</I>&gt;&gt;&gt;&gt;<i> text/xml
</I>&gt;&gt;&gt;&gt;<i> 1443337152.355   4029 192.168.1.102 TCP_MISS_ABORTED/200 3250 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://67.212.174.228:10001/">http://67.212.174.228:10001/</A> - HIER_DIRECT/67.212.174.228 audio/mpeg
</I>

The only problem in this log seems to be the request above. Which is
apparently successfully getting put through to the required server, but
the client aborts it after 4 seconds with only a tiny/3KB amount of
response getting back.

When I try it myself I get an ICY stream back. Squid does support those.
At least 3.1 and later do, if you are using an older Squid you *really*
need to upgrade.



There is a chance that your ISP or some device upstream is blocking the
traffic. Since its aparently getting the response, but not much I
suspect MTU issues somewhere. The HTTP reply headers would get through
as small packets, but the media itself may need large ones that get dropped.


There is a huge amount of advertising being thrown at the client. It
might be spending all its time processing that and not get around to the
actual content you want. Try adding this to squid.conf to eliminate that
and see if things work better:

 acl ads dstdomain ads-bidder-api.twitter.com \
      .google-analytics.com ads.tunein.com ads.mopub.com
 http_access deny ads


The site also has a bunch of HTTP violations:

 * Pragma: no-cache is a request directive, not a response directive.
 * A ranged request returned another representation.
 * The X-XSS-Protection header's syntax isn't valid.
 * Response is negotiated, but doesn't have an appropriate Vary header.
 * The resource doesn't send Vary consistently.

While these are only from the web pages and images of the site they are
bad signs about the developers abilities.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005724.html">[squid-users] Streaming Radio blocked
</A></li>
	<LI>Next message (by thread): <A HREF="005726.html">[squid-users] Streaming Radio blocked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5725">[ date ]</a>
              <a href="thread.html#5725">[ thread ]</a>
              <a href="subject.html#5725">[ subject ]</a>
              <a href="author.html#5725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
