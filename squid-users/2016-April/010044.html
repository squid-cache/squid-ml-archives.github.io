<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] select parent proxy based on ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20select%20parent%20proxy%20based%20on%20ACL&In-Reply-To=%3C57051528.7090409%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010042.html">
   <LINK REL="Next"  HREF="010050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] select parent proxy based on ACL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20select%20parent%20proxy%20based%20on%20ACL&In-Reply-To=%3C57051528.7090409%40treenet.co.nz%3E"
       TITLE="[squid-users] select parent proxy based on ACL">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Apr  6 13:54:48 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010042.html">[squid-users] select parent proxy based on ACL
</A></li>
        <LI>Next message (by thread): <A HREF="010050.html">[squid-users] select parent proxy based on ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10044">[ date ]</a>
              <a href="thread.html#10044">[ thread ]</a>
              <a href="subject.html#10044">[ subject ]</a>
              <a href="author.html#10044">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Comments inline, For the TL;DR skip to the bottom.

On 7/04/2016 1:14 a.m., Pascal Watteel wrote:
&gt;<i> Ok maybe it was't all clear.
</I>&gt;<i> 
</I>&gt;<i> I live in Dubai. Our local ISP limits the bandwith per TCP connection
</I>&gt;<i> when connections are made outside of the gulf.
</I>&gt;<i> Don't ask me why, they just do.
</I>&gt;<i> I have a fast 128Mbit link but as i'm limited to 4Mbit per TCP, the
</I>&gt;<i> moment i download a file from a non local mirror it's slow.
</I>
That is very odd. Are you sure its not a problem created by some
partially broken hardware somewhere? if they are selling you 128Mbps it
should work (close to) full rate with 1 TCP connection as well as with many.
Perhapse you should try and talk to the ISP sysadmin to see if it is
intentional (if so why its done) or a bug in the network itself.

&gt;<i> 
</I>&gt;<i> Aria2c or Uget works perfect on my desktop but i wanted a solution that
</I>&gt;<i> would work universal without any software on a pc.
</I>&gt;<i> 
</I>&gt;<i> the solution is ranged downloads if the server supports it.
</I>&gt;<i> This will make my download split in example 16 ranged byte gets -&gt; 16
</I>&gt;<i> TCP connections =&gt; 16X 4Mbit =&gt; descent download speed.
</I>
&quot;descent&quot; is the right word for it. Descent into network congestion for
your ISP. :-P

If they are doing their job well you will find that this type of
behaviour actually lowers your network performance and/or raises the
monetary cost. If you actually tested and found that 16x increase
happens then they are not doing their job well - or perhapse the 'limit'
is actually an artifact of the network structure rather than any imposed
shaping.

If they are doing their job very badly you might find the same, only
everyone else using them has worse network experience too as the
congestion hits everyone.


&gt;<i> 
</I>&gt;<i> My solution was to write a python based proxy.
</I>&gt;<i> <A HREF="https://github.com/intagger/paraproxio">https://github.com/intagger/paraproxio</A>
</I>&gt;<i> 
</I>&gt;<i> It does exaclty that but in a proxy form. 
</I>&gt;<i> Anything that is not .iso .zip or other that you can define in the
</I>&gt;<i> config will just be transparent. Anything that is defined will be split
</I>&gt;<i> in segmented downloads and so downloaded faster on my ISP.
</I>&gt;<i> 
</I>&gt;<i> Now i already have a Squid proxy in my network with a another Squid
</I>&gt;<i> proxy parent in AWS.
</I>&gt;<i> I use the proxy for local caching nothing fancy, But use the parent
</I>&gt;<i> with an acl to send specific domains to the parent and so enable me to
</I>&gt;<i> access sites without the need of a VPN.
</I>&gt;<i> 
</I>&gt;<i> I now want to add my Python based proxy as another parent.
</I>&gt;<i> However i have no option to tell squid what parent to use.
</I>&gt;<i> I would like to create a regex acl in squid and someway tell squid to
</I>&gt;<i> use parent proxy X for ACL_X and parent proxy Y for ACL Y.
</I>&gt;<i> But i can only use the ACL to say direct or indirect.
</I>&gt;<i> 
</I>&gt;<i> And use the proxy-peer-domain statement to choose the parent based on a
</I>&gt;<i> domain or tld.
</I>&gt;<i> 
</I>&gt;<i> so my question is how to make squid choose the parent based on an ACL.
</I>&gt;<i> 
</I>&gt;<i> hope this explanes it better for you.
</I>&gt;<i> what my parent does, is not important. It could be anyother parent
</I>&gt;<i> proxy.
</I>&gt;<i> 
</I>
Okay. What you are wanting is definitely
&lt;<A HREF="http://www.squid-cache.org/Doc/config/cache_peer_access/">http://www.squid-cache.org/Doc/config/cache_peer_access/</A>&gt;.

I suggest you may also want to look into the Store-ID and collapsed
forwarding features in Squid if you have one that supports them. Both of
them allow Squid to de-duplicate requests for identical objects. If your
custom Range requests reach a Squid with collapsed forwarding enabled
that Squid might even de-duplicate them back into a single fetch (for
example in your ISPs network).

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010042.html">[squid-users] select parent proxy based on ACL
</A></li>
	<LI>Next message (by thread): <A HREF="010050.html">[squid-users] select parent proxy based on ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10044">[ date ]</a>
              <a href="thread.html#10044">[ thread ]</a>
              <a href="subject.html#10044">[ subject ]</a>
              <a href="author.html#10044">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
