<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Error starting 3.5.16 on FreeBSD-8.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20starting%203.5.16%20on%20FreeBSD-8.4&In-Reply-To=%3CCAAdA2WPD4GS0ULA8tStG9J9mECcs%3DV2D06%3DQaxz8Z5bGbVP_rQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010087.html">
   <LINK REL="Next"  HREF="010093.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Error starting 3.5.16 on FreeBSD-8.4</H1>
    <B>Odhiambo Washington</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20starting%203.5.16%20on%20FreeBSD-8.4&In-Reply-To=%3CCAAdA2WPD4GS0ULA8tStG9J9mECcs%3DV2D06%3DQaxz8Z5bGbVP_rQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Error starting 3.5.16 on FreeBSD-8.4">odhiambo at gmail.com
       </A><BR>
    <I>Fri Apr  8 17:23:49 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010087.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
        <LI>Next message (by thread): <A HREF="010093.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10092">[ date ]</a>
              <a href="thread.html#10092">[ thread ]</a>
              <a href="subject.html#10092">[ subject ]</a>
              <a href="author.html#10092">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Yuri,

Sorry to be a thorn in the flesh in this one.

Which source code were you applying this patch against?

I applied this patch on the released squid-4.0.8.tar.xz and it doesn't
apply cleanly for starters... Maybe I am doing it wrongly? Just doing patch
&lt; /path/to/patch

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">wash at mail</A>:~/ILI/Squid/4.x/squid-4.0.8$ patch &lt; ../squid-4-14633.patch
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|<i>------------------------------------------------------------
</I>|<i>revno: 14633
</I>|<i>revision-id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz-20160408073547-xtjco0mpai4lr920</A>
</I>|<i>parent: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">chtsanti at users.sourceforge.net-20160407163610-yl8zzhc08l1ysv5f</A>
</I>|<i>committer: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>|<i>branch nick: trunk
</I>|<i>timestamp: Fri 2016-04-08 19:35:47 +1200
</I>|<i>message:
</I>|<i>  Fix shm_open error message after rev.14625
</I>|<i>------------------------------------------------------------
</I>|<i># Bazaar merge directive format 2 (Bazaar 0.90)
</I>|<i># revision_id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz-20160408073547-xtjco0mpai4lr920</A>
</I>|<i># target_branch: <A HREF="http://bzr.squid-cache.org/bzr/squid3/trunk/">http://bzr.squid-cache.org/bzr/squid3/trunk/</A>
</I>|<i># testament_sha1: c1983f6601c29e4d03f936e60ecee221a860f932
</I>|<i># timestamp: 2016-04-08 07:51:00 +0000
</I>|<i># source_branch: <A HREF="http://bzr.squid-cache.org/bzr/squid3/trunk">http://bzr.squid-cache.org/bzr/squid3/trunk</A>
</I>|<i># base_revision_id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">chtsanti at users.sourceforge.net-20160407163610-</A>\
</I>|<i>#   yl8zzhc08l1ysv5f
</I>|<i>#
</I>|<i># Begin patch
</I>|<i>=== modified file 'src/ipc/mem/Segment.cc'
</I>|<i>--- src/ipc/mem/Segment.cc     2016-04-03 23:41:58 +0000
</I>|<i>+++ src/ipc/mem/Segment.cc     2016-04-08 07:35:47 +0000
</I>--------------------------
Patching file src/ipc/mem/Segment.cc using Plan A...
Hunk #1 failed at 91.
Hunk #2 succeeded at 105 (offset -4 lines).
Hunk #3 succeeded at 121 (offset -4 lines).
Hunk #4 succeeded at 151 (offset -1 lines).
1 out of 4 hunks failed--saving rejects to src/ipc/mem/Segment.cc.rej
Hmm...  The next patch looks like a unified diff to me...
The text leading up to this was:
--------------------------
|<i>
</I>|<i>=== modified file 'src/ipc/mem/Segment.h'
</I>|<i>--- src/ipc/mem/Segment.h      2016-03-24 17:02:25 +0000
</I>|<i>+++ src/ipc/mem/Segment.h      2016-04-08 07:35:47 +0000
</I>--------------------------
Patching file src/ipc/mem/Segment.h using Plan A...
Hunk #1 succeeded at 53.
Hmm...  Ignoring the trailing garbage.
done


Then when I compile, the compilation fails as follows (though without the
patch the compilation succeeds):

libtool: compile:  clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../.. -I../../include
-I../../lib -I../../src -I../../include -I/usr/include -I/usr/include
-I../../libltdl -I/usr/include -I/usr/local/include/libxml2
-I/usr/local/include/libxml2 -Werror -Qunused-arguments
-Wno-deprecated-register -D_REENTRANT -g -O2 -march=native -std=c++11
-I/usr/local/include -MT mem/Pages.lo -MD -MP -MF mem/.deps/Pages.Tpo -c
mem/Pages.cc  -fPIC -DPIC -o mem/.libs/Pages.o
libtool: compile:  clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../.. -I../../include
-I../../lib -I../../src -I../../include -I/usr/include -I/usr/include
-I../../libltdl -I/usr/include -I/usr/local/include/libxml2
-I/usr/local/include/libxml2 -Werror -Qunused-arguments
-Wno-deprecated-register -D_REENTRANT -g -O2 -march=native -std=c++11
-I/usr/local/include -MT mem/Pages.lo -MD -MP -MF mem/.deps/Pages.Tpo -c
mem/Pages.cc -o mem/Pages.o &gt;/dev/null 2&gt;&amp;1
depbase=`echo mem/PageStack.lo | sed 's|[^/]*$|.deps/&amp;|;s|\.lo$||'`;
/bin/sh ../../libtool  --tag=CXX    --mode=compile clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot;    -I../..
-I../../include  -I../../lib -I../../src  -I../../include  -I/usr/include
 -I/usr/include  -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2  -I/usr/local/include/libxml2  -Werror
-Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/PageStack.lo -MD -MP
-MF $depbase.Tpo -c -o mem/PageStack.lo mem/PageStack.cc &amp;&amp; mv -f
$depbase.Tpo $depbase.Plo
libtool: compile:  clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../.. -I../../include
-I../../lib -I../../src -I../../include -I/usr/include -I/usr/include
-I../../libltdl -I/usr/include -I/usr/local/include/libxml2
-I/usr/local/include/libxml2 -Werror -Qunused-arguments
-Wno-deprecated-register -D_REENTRANT -g -O2 -march=native -std=c++11
-I/usr/local/include -MT mem/PageStack.lo -MD -MP -MF
mem/.deps/PageStack.Tpo -c mem/PageStack.cc  -fPIC -DPIC -o
mem/.libs/PageStack.o
libtool: compile:  clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../.. -I../../include
-I../../lib -I../../src -I../../include -I/usr/include -I/usr/include
-I../../libltdl -I/usr/include -I/usr/local/include/libxml2
-I/usr/local/include/libxml2 -Werror -Qunused-arguments
-Wno-deprecated-register -D_REENTRANT -g -O2 -march=native -std=c++11
-I/usr/local/include -MT mem/PageStack.lo -MD -MP -MF
mem/.deps/PageStack.Tpo -c mem/PageStack.cc -o mem/PageStack.o &gt;/dev/null
2&gt;&amp;1
depbase=`echo mem/Segment.lo | sed 's|[^/]*$|.deps/&amp;|;s|\.lo$||'`; /bin/sh
../../libtool  --tag=CXX    --mode=compile clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot;    -I../..
-I../../include  -I../../lib -I../../src  -I../../include  -I/usr/include
 -I/usr/include  -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2  -I/usr/local/include/libxml2  -Werror
-Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/Segment.lo -MD -MP
-MF $depbase.Tpo -c -o mem/Segment.lo mem/Segment.cc &amp;&amp; mv -f $depbase.Tpo
$depbase.Plo
libtool: compile:  clang++ -DHAVE_CONFIG_H
-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../.. -I../../include
-I../../lib -I../../src -I../../include -I/usr/include -I/usr/include
-I../../libltdl -I/usr/include -I/usr/local/include/libxml2
-I/usr/local/include/libxml2 -Werror -Qunused-arguments
-Wno-deprecated-register -D_REENTRANT -g -O2 -march=native -std=c++11
-I/usr/local/include -MT mem/Segment.lo -MD -MP -MF mem/.deps/Segment.Tpo
-c mem/Segment.cc  -fPIC -DPIC -o mem/.libs/Segment.o
mem/Segment.cc:96:22: error: too few arguments to function call, single
argument 'err' was not specified
    if (!createFresh() &amp;&amp; errno == EEXIST) {
         ~~~~~~~~~~~ ^
../../src/ipc/mem/Segment.h:56:5: note: 'createFresh' declared here
    bool createFresh(int &amp;err);
    ^
mem/Segment.cc:98:21: error: too few arguments to function call, single
argument 'err' was not specified
        createFresh();
        ~~~~~~~~~~~ ^
../../src/ipc/mem/Segment.h:56:5: note: 'createFresh' declared here
    bool createFresh(int &amp;err);
    ^
mem/Segment.cc:108:9: error: use of undeclared identifier 'xerrno'
        xerrno = errno;
        ^
mem/Segment.cc:110:66: error: use of undeclared identifier 'xerrno'
        debugs(54, 5, &quot;ftruncate &quot; &lt;&lt; theName &lt;&lt; &quot;: &quot; &lt;&lt; xstrerr(xerrno));
                                                                 ^
../../src/Debug.h:107:21: note: expanded from macro 'debugs'
            _dbo &lt;&lt; CONTENT; \
                    ^
mem/Segment.cc:112:45: error: use of undeclared identifier 'xerrno'
               theName.termedBuf(), xstrerr(xerrno));
                                            ^
5 errors generated.
*** Error code 1

Stop.
make[3]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src/ipc
*** Error code 1

Stop.
make[2]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src
*** Error code 1

Stop.
make[1]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src
*** Error code 1

Stop.
make: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8


Okay, I know I am being a bug here myself since I am focused on 3.5 now
more than 4.x but I also like giving the little feedback I can from these
FreeBSD servers I have:-)





On 8 April 2016 at 17:19, Yuri Voinov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA256
</I>&gt;<i>
</I>&gt;<i> Seems fixed.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4486#c2">http://bugs.squid-cache.org/show_bug.cgi?id=4486#c2</A>
</I>&gt;<i>
</I>&gt;<i> 08.04.16 18:05, Amos Jeffries &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; On 8/04/2016 10:28 p.m., Odhiambo Washington wrote:
</I>&gt;<i> &gt;&gt; Hello Yuri,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Thanks, but this patch is for squid-4.0.8, right??
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes the patch in that bug report is specific to the latest 4.0 snapshot,
</I>&gt;<i> &gt; which Yuri is running.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As Alex mentioned the errno usage in Squid was a bit wrong. The latest
</I>&gt;<i> &gt; 4.0 have a patch to fix that, which is causing Yuri's problem. Your 3.5
</I>&gt;<i> &gt; issue may or may not be related. But we wont know until after Yuri
</I>&gt;<i> &gt; applies that patch and checks the results.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Amos
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v2
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBCAAGBQJXB74GAAoJENNXIZxhPexGwkwH/ipdtdS23EuZHIQHWEN7DeSM
</I>&gt;<i> aJ+b1lhRb+052wbL1vx8uyvhwGf++QVZcvFTGcxwFN0yQ1EaN1b1tE6IYlosG8IC
</I>&gt;<i> 1rCOkARyZnyLK0MZKqvajrv4RZMR9CAvcRspv7DftQwS/2/h2uhnakc2PZYKBSUO
</I>&gt;<i> eF+hkxjUq2bSySY0sQ6tMTCr/U5x9IKzpg21VEE2tnn2S1HujnAEQ/C7pyi1ws7U
</I>&gt;<i> SXyqQBOVr25wxQq3AZMg5Sk6uZ7pSF02soCaIon7SeBdx6K+eWTngg9/t1Rn5zit
</I>&gt;<i> EGSrVLdEHsVFID/y5PsDMylpy4TwL+m0VCWSPbwYDGM+rp3tikfU/XAorFMR79M=
</I>&gt;<i> =mVL9
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Best regards,
Odhiambo WASHINGTON,
Nairobi,KE
+254 7 3200 0004/+254 7 2274 3223
&quot;Oh, the cruft.&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/ebd7a6ef/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/ebd7a6ef/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010087.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
	<LI>Next message (by thread): <A HREF="010093.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10092">[ date ]</a>
              <a href="thread.html#10092">[ thread ]</a>
              <a href="subject.html#10092">[ subject ]</a>
              <a href="author.html#10092">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
