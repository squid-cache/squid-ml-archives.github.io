<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Error starting 3.5.16 on FreeBSD-8.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20starting%203.5.16%20on%20FreeBSD-8.4&In-Reply-To=%3C5707E9C7.8030303%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010092.html">
   <LINK REL="Next"  HREF="010094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Error starting 3.5.16 on FreeBSD-8.4</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20starting%203.5.16%20on%20FreeBSD-8.4&In-Reply-To=%3C5707E9C7.8030303%40gmail.com%3E"
       TITLE="[squid-users] Error starting 3.5.16 on FreeBSD-8.4">yvoinov at gmail.com
       </A><BR>
    <I>Fri Apr  8 17:26:31 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010092.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
        <LI>Next message (by thread): <A HREF="010094.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10093">[ date ]</a>
              <a href="thread.html#10093">[ thread ]</a>
              <a href="subject.html#10093">[ subject ]</a>
              <a href="author.html#10093">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
Note: Codebase for 4.0.x is different with 3.5.x.  So, most patches for
4.x.x series can't be applied onto 3.5.x.

08.04.16 23:23, Odhiambo Washington &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Hi Yuri,
</I>&gt;<i>
</I>&gt;<i> Sorry to be a thorn in the flesh in this one.
</I>&gt;<i>
</I>&gt;<i> Which source code were you applying this patch against?
</I>&gt;<i>
</I>&gt;<i> I applied this patch on the released squid-4.0.8.tar.xz and it doesn't
</I>apply cleanly for starters... Maybe I am doing it wrongly? Just doing
patch &lt; /path/to/patch
&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">wash at mail</A>:~/ILI/Squid/4.x/squid-4.0.8$ patch &lt; ../squid-4-14633.patch
</I>&gt;<i> Hmm...  Looks like a unified diff to me...
</I>&gt;<i> The text leading up to this was:
</I>&gt;<i> --------------------------
</I>&gt;<i> |------------------------------------------------------------
</I>&gt;<i> |revno: 14633
</I>&gt;<i> |revision-id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz-20160408073547-xtjco0mpai4lr920</A>
</I>&gt;<i> |parent: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">chtsanti at users.sourceforge.net-20160407163610-yl8zzhc08l1ysv5f</A>
</I>&gt;<i> |committer: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;&gt;
&gt;<i> |branch nick: trunk
</I>&gt;<i> |timestamp: Fri 2016-04-08 19:35:47 +1200
</I>&gt;<i> |message:
</I>&gt;<i> |  Fix shm_open error message after rev.14625
</I>&gt;<i> |------------------------------------------------------------
</I>&gt;<i> |# Bazaar merge directive format 2 (Bazaar 0.90)
</I>&gt;<i> |# revision_id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz-20160408073547-xtjco0mpai4lr920</A>
</I>&gt;<i> |# target_branch: <A HREF="http://bzr.squid-cache.org/bzr/squid3/trunk/">http://bzr.squid-cache.org/bzr/squid3/trunk/</A>
</I>&gt;<i> |# testament_sha1: c1983f6601c29e4d03f936e60ecee221a860f932
</I>&gt;<i> |# timestamp: 2016-04-08 07:51:00 +0000
</I>&gt;<i> |# source_branch: <A HREF="http://bzr.squid-cache.org/bzr/squid3/trunk">http://bzr.squid-cache.org/bzr/squid3/trunk</A>
</I>&gt;<i> |# base_revision_id: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">chtsanti at users.sourceforge.net-20160407163610-</A>\
</I>&gt;<i> |#   yl8zzhc08l1ysv5f
</I>&gt;<i> |#
</I>&gt;<i> |# Begin patch
</I>&gt;<i> |=== modified file 'src/ipc/mem/Segment.cc'
</I>&gt;<i> |--- src/ipc/mem/Segment.cc     2016-04-03 23:41:58 +0000
</I>&gt;<i> |+++ src/ipc/mem/Segment.cc     2016-04-08 07:35:47 +0000
</I>&gt;<i> --------------------------
</I>&gt;<i> Patching file src/ipc/mem/Segment.cc using Plan A...
</I>&gt;<i> Hunk #1 failed at 91.
</I>&gt;<i> Hunk #2 succeeded at 105 (offset -4 lines).
</I>&gt;<i> Hunk #3 succeeded at 121 (offset -4 lines).
</I>&gt;<i> Hunk #4 succeeded at 151 (offset -1 lines).
</I>&gt;<i> 1 out of 4 hunks failed--saving rejects to src/ipc/mem/Segment.cc.rej
</I>&gt;<i> Hmm...  The next patch looks like a unified diff to me...
</I>&gt;<i> The text leading up to this was:
</I>&gt;<i> --------------------------
</I>&gt;<i> |
</I>&gt;<i> |=== modified file 'src/ipc/mem/Segment.h'
</I>&gt;<i> |--- src/ipc/mem/Segment.h      2016-03-24 17:02:25 +0000
</I>&gt;<i> |+++ src/ipc/mem/Segment.h      2016-04-08 07:35:47 +0000
</I>&gt;<i> --------------------------
</I>&gt;<i> Patching file src/ipc/mem/Segment.h using Plan A...
</I>&gt;<i> Hunk #1 succeeded at 53.
</I>&gt;<i> Hmm...  Ignoring the trailing garbage.
</I>&gt;<i> done
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Then when I compile, the compilation fails as follows (though without
</I>the patch the compilation succeeds):
&gt;<i>
</I>&gt;<i> libtool: compile:  clang++ -DHAVE_CONFIG_H
</I>-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../..
-I../../include -I../../lib -I../../src -I../../include -I/usr/include
-I/usr/include -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2 -I/usr/local/include/libxml2 -Werror
-Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/Pages.lo -MD -MP
-MF mem/.deps/Pages.Tpo -c mem/Pages.cc  -fPIC -DPIC -o mem/.libs/Pages.o
&gt;<i> libtool: compile:  clang++ -DHAVE_CONFIG_H
</I>-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../..
-I../../include -I../../lib -I../../src -I../../include -I/usr/include
-I/usr/include -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2 -I/usr/local/include/libxml2 -Werror
-Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/Pages.lo -MD -MP
-MF mem/.deps/Pages.Tpo -c mem/Pages.cc -o mem/Pages.o &gt;/dev/null 2&gt;&amp;1
&gt;<i> depbase=`echo mem/PageStack.lo | sed 's|[^/]*$|.deps/&amp;|;s|\.lo$||'`;
</I>/bin/sh ../../libtool  --tag=CXX    --mode=compile clang++
-DHAVE_CONFIG_H -DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot;   
-I../.. -I../../include  -I../../lib -I../../src  -I../../include 
-I/usr/include  -I/usr/include  -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2  -I/usr/local/include/libxml2  -Werror
-Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/PageStack.lo -MD
-MP -MF $depbase.Tpo -c -o mem/PageStack.lo mem/PageStack.cc &amp;&amp; mv -f
$depbase.Tpo $depbase.Plo
&gt;<i> libtool: compile:  clang++ -DHAVE_CONFIG_H
</I>-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../..
-I../../include -I../../lib -I../../src -I../../include -I/usr/include
-I/usr/include -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2 -I/usr/local/include/libxml2 -Werror
-Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/PageStack.lo -MD
-MP -MF mem/.deps/PageStack.Tpo -c mem/PageStack.cc  -fPIC -DPIC -o
mem/.libs/PageStack.o
&gt;<i> libtool: compile:  clang++ -DHAVE_CONFIG_H
</I>-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../..
-I../../include -I../../lib -I../../src -I../../include -I/usr/include
-I/usr/include -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2 -I/usr/local/include/libxml2 -Werror
-Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/PageStack.lo -MD
-MP -MF mem/.deps/PageStack.Tpo -c mem/PageStack.cc -o mem/PageStack.o
&gt;<i>/dev/null 2&gt;&amp;1
</I>&gt;<i> depbase=`echo mem/Segment.lo | sed 's|[^/]*$|.deps/&amp;|;s|\.lo$||'`;
</I>/bin/sh ../../libtool  --tag=CXX    --mode=compile clang++
-DHAVE_CONFIG_H -DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot;   
-I../.. -I../../include  -I../../lib -I../../src  -I../../include 
-I/usr/include  -I/usr/include  -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2  -I/usr/local/include/libxml2  -Werror
-Qunused-arguments -Wno-deprecated-register  -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/Segment.lo -MD -MP
-MF $depbase.Tpo -c -o mem/Segment.lo mem/Segment.cc &amp;&amp; mv -f
$depbase.Tpo $depbase.Plo
&gt;<i> libtool: compile:  clang++ -DHAVE_CONFIG_H
</I>-DDEFAULT_STATEDIR=\&quot;/opt/squid-4/var/run/squid\&quot; -I../..
-I../../include -I../../lib -I../../src -I../../include -I/usr/include
-I/usr/include -I../../libltdl -I/usr/include
-I/usr/local/include/libxml2 -I/usr/local/include/libxml2 -Werror
-Qunused-arguments -Wno-deprecated-register -D_REENTRANT -g -O2
-march=native -std=c++11 -I/usr/local/include -MT mem/Segment.lo -MD -MP
-MF mem/.deps/Segment.Tpo -c mem/Segment.cc  -fPIC -DPIC -o
mem/.libs/Segment.o
&gt;<i> mem/Segment.cc:96:22: error: too few arguments to function call,
</I>single argument 'err' was not specified
&gt;<i>     if (!createFresh() &amp;&amp; errno == EEXIST) {
</I>&gt;<i>          ~~~~~~~~~~~ ^
</I>&gt;<i> ../../src/ipc/mem/Segment.h:56:5: note: 'createFresh' declared here
</I>&gt;<i>     bool createFresh(int &amp;err);
</I>&gt;<i>     ^
</I>&gt;<i> mem/Segment.cc:98:21: error: too few arguments to function call,
</I>single argument 'err' was not specified
&gt;<i>         createFresh();
</I>&gt;<i>         ~~~~~~~~~~~ ^
</I>&gt;<i> ../../src/ipc/mem/Segment.h:56:5: note: 'createFresh' declared here
</I>&gt;<i>     bool createFresh(int &amp;err);
</I>&gt;<i>     ^
</I>&gt;<i> mem/Segment.cc:108:9: error: use of undeclared identifier 'xerrno'
</I>&gt;<i>         xerrno = errno;
</I>&gt;<i>         ^
</I>&gt;<i> mem/Segment.cc:110:66: error: use of undeclared identifier 'xerrno'
</I>&gt;<i>         debugs(54, 5, &quot;ftruncate &quot; &lt;&lt; theName &lt;&lt; &quot;: &quot; &lt;&lt; xstrerr(xerrno));
</I>&gt;<i>                                                                  ^
</I>&gt;<i> ../../src/Debug.h:107:21: note: expanded from macro 'debugs'
</I>&gt;<i>             _dbo &lt;&lt; CONTENT; \
</I>&gt;<i>                     ^
</I>&gt;<i> mem/Segment.cc:112:45: error: use of undeclared identifier 'xerrno'
</I>&gt;<i>                theName.termedBuf(), xstrerr(xerrno));
</I>&gt;<i>                                             ^
</I>&gt;<i> 5 errors generated.
</I>&gt;<i> *** Error code 1
</I>&gt;<i>
</I>&gt;<i> Stop.
</I>&gt;<i> make[3]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src/ipc
</I>&gt;<i> *** Error code 1
</I>&gt;<i>
</I>&gt;<i> Stop.
</I>&gt;<i> make[2]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src
</I>&gt;<i> *** Error code 1
</I>&gt;<i>
</I>&gt;<i> Stop.
</I>&gt;<i> make[1]: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8/src
</I>&gt;<i> *** Error code 1
</I>&gt;<i>
</I>&gt;<i> Stop.
</I>&gt;<i> make: stopped in /usr/home/wash/ILI/Squid/4.x/squid-4.0.8
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Okay, I know I am being a bug here myself since I am focused on 3.5
</I>now more than 4.x but I also like giving the little feedback I can from
these FreeBSD servers I have:-)
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 8 April 2016 at 17:19, Yuri Voinov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt;&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Seems fixed.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4486#c2">http://bugs.squid-cache.org/show_bug.cgi?id=4486#c2</A>
</I>&gt;<i>
</I>&gt;<i> 08.04.16 18:05, Amos Jeffries &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; On 8/04/2016 10:28 p.m., Odhiambo Washington wrote:
</I>&gt;<i> &gt;&gt; Hello Yuri,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Thanks, but this patch is for squid-4.0.8, right??
</I>&gt;<i> &gt;&gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Yes the patch in that bug report is specific to the latest 4.0 snapshot,
</I>&gt;<i> &gt; which Yuri is running.
</I>&gt;<i>
</I>&gt;<i> &gt; As Alex mentioned the errno usage in Squid was a bit wrong. The latest
</I>&gt;<i> &gt; 4.0 have a patch to fix that, which is causing Yuri's problem. Your 3.5
</I>&gt;<i> &gt; issue may or may not be related. But we wont know until after Yuri
</I>&gt;<i> &gt; applies that patch and checks the results.
</I>&gt;<i>
</I>&gt;<i> &gt; Amos
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     squid-users mailing list
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Best regards,
</I>&gt;<i> Odhiambo WASHINGTON,
</I>&gt;<i> Nairobi,KE
</I>&gt;<i> +254 7 3200 0004/+254 7 2274 3223
</I>&gt;<i> &quot;Oh, the cruft.&quot;
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJXB+nGAAoJENNXIZxhPexGPbwH/2vQ0DotjjMQ8rtS+bUYri27
qtF91SKYcxUVlpMYqZ4WkCY4J6f9R0s2lyejUM2UxXaPK+Y5Sule4OSzUzjUt/TH
bmHWlfEQ4m/RP8fcAI9LVLfrJauT7MagnT6DsE/Yz3CAKFGJ5E1TnGy7ppzbVA0K
mEqlspld/ZDnFAJTCz616BKGfmZIXISd7KxxB9V4uOgLjVKwSydczDSse4xqA+GQ
MFW4MHf3RtS7TAU6CwSdykGrTGGlO8JE+c0E2MPcZs+gYjwoE2qFjv/U8PKC1482
AZZxJ05+Ew5c/VN7mJpjSRavC1yeBy0l0ReiZlKpcuno2cuXIp6qeZ7OjxIj7oc=
=9dU1
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/3fdaca9a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/3fdaca9a/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/3fdaca9a/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160408/3fdaca9a/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010092.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
	<LI>Next message (by thread): <A HREF="010094.html">[squid-users] Error starting 3.5.16 on FreeBSD-8.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10093">[ date ]</a>
              <a href="thread.html#10093">[ thread ]</a>
              <a href="subject.html#10093">[ subject ]</a>
              <a href="author.html#10093">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
