<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP RDP on squid Pfsense not woking
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20RDP%20on%20squid%20Pfsense%20not%20woking&In-Reply-To=%3CE0943D77-75E8-46AC-B061-D89502E952D5%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010120.html">
   <LINK REL="Next"  HREF="010121.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP RDP on squid Pfsense not woking</H1>
    <B>--Ahmad--</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20RDP%20on%20squid%20Pfsense%20not%20woking&In-Reply-To=%3CE0943D77-75E8-46AC-B061-D89502E952D5%40netstream.ps%3E"
       TITLE="[squid-users] TCP RDP on squid Pfsense not woking">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Mon Apr 11 06:40:03 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010120.html">[squid-users] a strange problem ( ORIGINAL_DST( can't be cache ) HIER_DIRECT ( can be cache )
</A></li>
        <LI>Next message (by thread): <A HREF="010121.html">[squid-users] TCP RDP on squid Pfsense not woking
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10118">[ date ]</a>
              <a href="thread.html#10118">[ thread ]</a>
              <a href="subject.html#10118">[ subject ]</a>
              <a href="author.html#10118">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi dev ,

when i use socks5 client on my pc to connect to squid proxy on centos  , i can tunnel RDP traffic using squid .

recently when i changed to pfsense , 
I&#8217;m unable to use RDP  using proxy .

MY CACHE PEER proxy is 10.12.0.32 , if  i use it directly i can use RDP.

but RDP from pfsense always forbidden and i already allowed rdp port in the ports in pfsense squid config .!


i will paste my squid config below and the error i face when i try .

===============
[2.2.2-RELEASE][admin &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;@ &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;pfSense &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;]/root: squid -k parse
2016/04/11 09:25:53| Startup: Initializing Authentication Schemes ...
2016/04/11 09:25:53| Startup: Initialized Authentication Scheme 'basic'
2016/04/11 09:25:53| Startup: Initialized Authentication Scheme 'digest'
2016/04/11 09:25:53| Startup: Initialized Authentication Scheme 'negotiate'
2016/04/11 09:25:53| Startup: Initialized Authentication Scheme 'ntlm'
2016/04/11 09:25:53| Startup: Initialized Authentication.
2016/04/11 09:25:53| Processing Configuration File: /usr/local/etc/squid/squid.conf (depth 0)
2016/04/11 09:25:53| Processing: http_port 10.12.140.254:8080
2016/04/11 09:25:53| Processing: http_port 127.0.0.1:8080
2016/04/11 09:25:53| Processing: icp_port 0
2016/04/11 09:25:53| Processing: dns_v4_first off
2016/04/11 09:25:53| Processing: pid_filename /var/run/squid/squid.pid
2016/04/11 09:25:53| Processing: cache_effective_user proxy
2016/04/11 09:25:53| Processing: cache_effective_group proxy
2016/04/11 09:25:53| Processing: error_default_language en
2016/04/11 09:25:53| Processing: icon_directory /usr/pbi/squid-amd64/local/etc/squid/icons
2016/04/11 09:25:53| Processing: visible_hostname mpwh
2016/04/11 09:25:53| Processing: cache_mgr <A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at localhost</A>
2016/04/11 09:25:53| Processing: access_log /var/squid/logs/access.log
2016/04/11 09:25:53| Processing: cache_log /var/squid/logs/cache.log
2016/04/11 09:25:53| Processing: cache_store_log none
2016/04/11 09:25:53| Processing: netdb_filename /var/squid/logs/netdb.state
2016/04/11 09:25:53| Processing: pinger_enable on
2016/04/11 09:25:53| Processing: pinger_program /usr/pbi/squid-amd64/local/libexec/squid/pinger
2016/04/11 09:25:53| Processing: logfile_rotate 0
2016/04/11 09:25:53| Processing: debug_options rotate=0
2016/04/11 09:25:53| Processing: shutdown_lifetime 3 seconds
2016/04/11 09:25:53| Processing: acl localnet src  10.12.140.0/24 127.0.0.0/8
2016/04/11 09:25:53| Processing: forwarded_for on
2016/04/11 09:25:53| Processing: uri_whitespace strip
2016/04/11 09:25:53| Processing: acl dynamic urlpath_regex cgi-bin \?
2016/04/11 09:25:53| Processing: cache deny dynamic
2016/04/11 09:25:53| Processing: cache_mem 64 MB
2016/04/11 09:25:53| Processing: maximum_object_size_in_memory 256 KB
2016/04/11 09:25:53| Processing: memory_replacement_policy heap GDSF
2016/04/11 09:25:53| Processing: cache_replacement_policy heap LFUDA
2016/04/11 09:25:53| Processing: minimum_object_size 0 KB
2016/04/11 09:25:53| Processing: maximum_object_size 4 MB
2016/04/11 09:25:53| Processing: cache_dir ufs /var/squid/cache 100 16 256
2016/04/11 09:25:53| Processing: offline_mode off
2016/04/11 09:25:53| Processing: cache_swap_low 90
2016/04/11 09:25:53| Processing: cache_swap_high 95
2016/04/11 09:25:53| Processing: cache allow all
2016/04/11 09:25:53| Processing: refresh_pattern ^ftp:    1440  20%  10080
2016/04/11 09:25:53| Processing: refresh_pattern ^gopher:  1440  0%  1440
2016/04/11 09:25:53| Processing: refresh_pattern -i (/cgi-bin/|\?) 0  0%  0
2016/04/11 09:25:53| Processing: refresh_pattern .    0  20%  4320
2016/04/11 09:25:53| Processing: acl allsrc src all
2016/04/11 09:25:53| Processing: acl safeports port 3389 21 70 80 210 280 443 488 563 591 631 777 901  8080 3129 1025-65535
2016/04/11 09:25:53| Processing: acl sslports port 443 563
2016/04/11 09:25:53| Processing: acl safeports port 3389 12345
2016/04/11 09:25:53| Processing: acl purge method PURGE
2016/04/11 09:25:53| Processing: acl connect method CONNECT
2016/04/11 09:25:53| Processing: acl HTTP proto HTTP
2016/04/11 09:25:53| Processing: acl HTTPS proto HTTPS
2016/04/11 09:25:53| Processing: http_access allow manager localhost
2016/04/11 09:25:53| Processing: http_access deny manager
2016/04/11 09:25:53| Processing: http_access allow purge localhost
2016/04/11 09:25:53| Processing: http_access deny purge
2016/04/11 09:25:53| Processing: http_access deny !safeports
2016/04/11 09:25:53| Processing: http_access deny CONNECT !sslports
2016/04/11 09:25:53| Processing: request_body_max_size 0 KB
2016/04/11 09:25:53| Processing: delay_pools 1
2016/04/11 09:25:53| Processing: delay_class 1 2
2016/04/11 09:25:53| Processing: delay_parameters 1 -1/-1 -1/-1
2016/04/11 09:25:53| Processing: delay_initial_bucket_level 100
2016/04/11 09:25:53| Processing: delay_access 1 allow allsrc
2016/04/11 09:25:53| Processing: acl rdp dat XXXX.XX.70.0/24
2016/04/11 09:25:53| Processing: http_access allow rdp
2016/04/11 09:25:53| Processing: dns_nameservers 8.8.8.8 10.12.0.33
2016/04/11 09:25:53| Processing: never_direct allow all
2016/04/11 09:25:53| Processing: cache_peer  10.12.0.32 parent  80 0 no-query no-digest default
2016/04/11 09:25:53| Processing: http_access allow localnet
2016/04/11 09:25:53| Processing: http_access deny allsrc
2016/04/11 09:25:53| Initializing https proxy context
[2.2.2-RELEASE][admin &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;@ &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;pfSense. &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at pfsense.mpwh.ps</A>&gt;/root: 






and here is the error when i try to connect RDP :
1460356516.600      0 10.12.140.114 TCP_DENIED/403 3450 CONNECT XX/XX.XX.26:3389 - HIER_NONE/- text/html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160411/41392b03/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160411/41392b03/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010120.html">[squid-users] a strange problem ( ORIGINAL_DST( can't be cache ) HIER_DIRECT ( can be cache )
</A></li>
	<LI>Next message (by thread): <A HREF="010121.html">[squid-users] TCP RDP on squid Pfsense not woking
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10118">[ date ]</a>
              <a href="thread.html#10118">[ thread ]</a>
              <a href="subject.html#10118">[ subject ]</a>
              <a href="author.html#10118">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
