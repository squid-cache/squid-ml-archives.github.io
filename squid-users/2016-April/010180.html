<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Stuggling with 3.5.16 on FreeBSD-9.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Stuggling%20with%203.5.16%20on%20FreeBSD-9.3&In-Reply-To=%3C57110524.5080405%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010179.html">
   <LINK REL="Next"  HREF="010181.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Stuggling%20with%203.5.16%20on%20FreeBSD-9.3&In-Reply-To=%3C57110524.5080405%40treenet.co.nz%3E"
       TITLE="[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Apr 15 15:13:40 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010179.html">[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3
</A></li>
        <LI>Next message (by thread): <A HREF="010181.html">[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10180">[ date ]</a>
              <a href="thread.html#10180">[ thread ]</a>
              <a href="subject.html#10180">[ subject ]</a>
              <a href="author.html#10180">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/04/2016 1:29 a.m., Odhiambo Washington wrote:
&gt;<i>
</I>&gt;<i> With luck, I have managed to get squid to compile successfully (after
</I>&gt;<i> upgrading a few components here and there). I used:
</I>
Yay!

&gt;<i> 
</I>&gt;<i> I have it running now (redirecting using IPFilter/IPNAT), but once in a
</I>&gt;<i> while I see this error about NAT:
</I>&gt;<i> 
</I>&lt;snip&gt;
&gt;<i> 2016/04/15 16:17:23| ERROR: NAT/TPROXY lookup failed to locate original IPs
</I>&gt;<i> on local=192.168.55.254:13128 remote=192.168.55.62:57724 FD 29 flags=33
</I>
These are the kernel NAT system telling Squid the connection being
looked up has not record there.

It could be TCP connections being made straight to the intercept port.
If so you need to update the firewall config to prevent them, even from
localhost.
 In Linux we use a mangle table rule, since that is the filter pre-NAT
that can do it. I'm not sure how FreeBSD would do that. It has to be
done on packets first arrival pre-NAT. Any filter that is applied after
the NAT action will get it wrong due to the NAT changes.


It could be the NAT systems table of connections filling up and
overflowing. If so there should be a kernel sysctl somewhere to increase
that table size.

&gt;<i> 
</I>&gt;<i> In any case, I am planning to rewrite the IPNAT rules into PF and use PF.
</I>&gt;<i> It's the inception stage so I haven't delved deep into ssl-bump
</I>&gt;<i> configurations...
</I>&gt;<i> 
</I>
HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010179.html">[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3
</A></li>
	<LI>Next message (by thread): <A HREF="010181.html">[squid-users] Stuggling with 3.5.16 on FreeBSD-9.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10180">[ date ]</a>
              <a href="thread.html#10180">[ thread ]</a>
              <a href="subject.html#10180">[ subject ]</a>
              <a href="author.html#10180">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
