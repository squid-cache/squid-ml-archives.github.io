<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl_bump newbie troubles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_bump%20newbie%20troubles&In-Reply-To=%3CCAAdA2WOKT6XzmZFERyxaL2U4_V-B39viW1asmiFLBXDrx-5qJA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010249.html">
   <LINK REL="Next"  HREF="010254.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl_bump newbie troubles</H1>
    <B>Odhiambo Washington</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl_bump%20newbie%20troubles&In-Reply-To=%3CCAAdA2WOKT6XzmZFERyxaL2U4_V-B39viW1asmiFLBXDrx-5qJA%40mail.gmail.com%3E"
       TITLE="[squid-users] ssl_bump newbie troubles">odhiambo at gmail.com
       </A><BR>
    <I>Wed Apr 20 20:22:23 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010249.html">[squid-users] ssl_bump newbie troubles
</A></li>
        <LI>Next message (by thread): <A HREF="010254.html">[squid-users] ssl_bump newbie troubles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10253">[ date ]</a>
              <a href="thread.html#10253">[ thread ]</a>
              <a href="subject.html#10253">[ subject ]</a>
              <a href="author.html#10253">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20 April 2016 at 18:38, Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
wrote:

&gt;<i> On 04/20/2016 08:16 AM, Odhiambo Washington wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I even wonder if this config is correct:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; acl ssl_bump_broken_sites  dstdomain ...
</I>&gt;<i> &gt; ssl_bump none ssl_bump_broken_sites
</I>&gt;<i> &gt; ssl_bump peek step1
</I>&gt;<i> &gt; ssl_bump stare step2
</I>&gt;<i> &gt; ssl_bump bump all
</I>&gt;<i>
</I>&gt;<i> You did not say what you want Squid to do, so it is difficult to say
</I>&gt;<i> whether the config is correct. However, the following combinations look
</I>&gt;<i> strange to me:
</I>&gt;<i>
</I>&gt;<i> * old &quot;none&quot; and new &quot;peek&quot; actions; use &quot;splice&quot; instead of &quot;none&quot;
</I>&gt;<i> * sometimes contradictory &quot;peek&quot; and &quot;stare&quot; actions; pick one kind
</I>&gt;<i> * sometimes contradictory &quot;peek&quot; and &quot;bump&quot; actions; if you intend to
</I>&gt;<i> bump, use &quot;stare&quot;
</I>&gt;<i>
</I>Also, you may want to use ssl::server_name ACL instead of dstdomain.
&gt;<i> Remember that Squid may have no domain information until it is too late
</I>&gt;<i> to splice. Here is a polished config that may or may not do what you want:
</I>&gt;<i>
</I>&gt;<i>   # Bump aggressively, including discovered-too-late broken_sites:
</I>&gt;<i>   acl ssl_bump_broken_sites ssl::server_name ...
</I>&gt;<i>   ssl_bump splice ssl_bump_broken_sites
</I>&gt;<i>   ssl_bump stare all
</I>&gt;<i>   ssl_bump bump all
</I>&gt;<i>
</I>
Hi Alex,

Thank you for looking into and advising about this. I really do not want to
get intrusive on the setup.
All I want is the ability to intercept SSL sites and control access to them
using TIME ACLs. That's all.
Sites should be accessed without any interference apart from determining at
what time they can be
accessed by certain restricted users. Think about restricting facebook.com,
youtube.com, etc which
otherwise I would not have control over in a normal intercept. That's the
only reaon I need this ssl_bump stuff.

So in simple:
1. UserX tries to access facebook.com/youtube.com
2. I intercept transparently https traffic
3. I tell squid &quot;don't allow this user to access facebook.com at this time,
but let them access at some-other-time
4. If time is right, let userX access the site.

I still need to wrap my hear around thise 'stare' and 'peek' and what
happens with them.


&gt;<i> &gt; I had to import my CA to all devices (as a trusted CA) on
</I>&gt;<i> &gt; the network so that they don't get the MITM notification. [...] People
</I>&gt;<i> &gt; don't like intrusive changes.
</I>&gt;<i>
</I>&gt;<i> &quot;ssl_bump bump&quot; implies intrusiveness. You need to decide whether
</I>&gt;<i> bumping connections is important enough to be intrusive. The alternative
</I>&gt;<i> is passive monitoring/splicing that does not require intrusive changes
</I>&gt;<i> but gives you less control. Pick your poison.
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>

So looks like all I need is a setup of passive monitoring, given my
explanation above, right?
Don't bump, just monitor and restrict access to some users based on time.
Generally I want to
control access to those sites users usually waste time on during work
hours:-)




-- 
Best regards,
Odhiambo WASHINGTON,
Nairobi,KE
+254 7 3200 0004/+254 7 2274 3223
&quot;Oh, the cruft.&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160420/e21378ee/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160420/e21378ee/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010249.html">[squid-users] ssl_bump newbie troubles
</A></li>
	<LI>Next message (by thread): <A HREF="010254.html">[squid-users] ssl_bump newbie troubles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10253">[ date ]</a>
              <a href="thread.html#10253">[ thread ]</a>
              <a href="subject.html#10253">[ subject ]</a>
              <a href="author.html#10253">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
