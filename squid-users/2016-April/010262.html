<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY SQUID-2016:6 Multiple	issues in ESI	processing.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%20SQUID-2016%3A6%20Multiple%0A%09issues%20in%20ESI%09processing.&In-Reply-To=%3C5718B97B.8060502%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010261.html">
   <LINK REL="Next"  HREF="010264.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY SQUID-2016:6 Multiple	issues in ESI	processing.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%20SQUID-2016%3A6%20Multiple%0A%09issues%20in%20ESI%09processing.&In-Reply-To=%3C5718B97B.8060502%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY SQUID-2016:6 Multiple	issues in ESI	processing.">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Apr 21 11:28:59 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010261.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2016:5 Buffer	overflow in	cachemgr.cgi
</A></li>
        <LI>Next message (by thread): <A HREF="010264.html">[squid-users] High CPU Usage with ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10262">[ date ]</a>
              <a href="thread.html#10262">[ thread ]</a>
              <a href="subject.html#10262">[ subject ]</a>
              <a href="author.html#10262">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2016:6
__________________________________________________________________

Advisory ID:        SQUID-2016:6
Date:               April 20, 2016
Summary:            Multiple issues in ESI processing.
Affected versions:  Squid 3.x -&gt; 3.5.16
                    Squid 4.x -&gt; 4.0.8
Fixed in version:   Squid 3.5.17, 4.0.9
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2016_6.txt">http://www.squid-cache.org/Advisories/SQUID-2016_6.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4052">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4052</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4053">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4053</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4054">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4054</A>
    CESG REF: 56284998 / VULNERABILITY ID: 393536
__________________________________________________________________

Problem Description:

 Due to buffer overflow issues Squid is vulnerable to a denial
 of service attack when processing ESI responses.

 Due to incorrect input validation Squid is vulnerable to public
 information disclosure of the server stack layout when processing
 ESI responses.

 Due to incorrect input validation and buffer overflow Squid is
 vulnerable to remote code execution when processing ESI
 responses.
__________________________________________________________________

Severity:

 These problems allow ESI components to be used to perform a
 denial of service attack on the Squid service and all other
 services on the same machine.

 Under certain build conditions these problems allow remote
 clients to view large sections of the server memory.

 However, the bugs are exploitable only if you have built and
 configured the ESI features to be used by a reverse-proxy and if
 the ESI components being processed by Squid can be controlled by
 an attacker.
__________________________________________________________________

Updated Packages:

 These bugs are fixed by Squid version 3.5.17 and 4.0.9.

 In addition, patches addressing this problem for stable releases
 can be found in our patch archives:

Squid 3.2:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11841.patch">http://www.squid-cache.org/Versions/v3/3.2/changesets/squid-3.2-11841.patch</A>&gt;

Squid 3.3:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12697.patch">http://www.squid-cache.org/Versions/v3/3.3/changesets/squid-3.3-12697.patch</A>&gt;

Squid 3.4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13235.patch">http://www.squid-cache.org/Versions/v3/3.4/changesets/squid-3.4-13235.patch</A>&gt;

Squid 3.5:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-14034.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-14034.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

Use the command 'squid -v' to view version and build details of
your proxy;

 All Squid 2.x are not vulnerable.

 All Squid built with --disable-esi are not vulnerable.

 All Squid built without --enable-esi are not vulnerable.


Check squid.conf or use the (version 3.4+) command
  (squid -k parse 2&gt;&amp;1) | grep &quot;Processing: http.*_port&quot;
to view the active configuration settings for your proxy;

 Unpatched Squid 3.x and 4.x built with --enable-esi and
 configured with 'accel' or 'vhost' or 'defaultsite=' or
 'ssl-bump' on an http_port or https_port are vulnerable.

 All Squid configured without reverse-proxy or ssl-bump are
 not vulnerable.

__________________________________________________________________

Workaround:

 Build Squid with --disable-esi if ESI is not needed.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 <A HREF="http://www.squid-cache.org/Support/mailing-lists.html.">http://www.squid-cache.org/Support/mailing-lists.html.</A>

 For reporting of non-security bugs in the latest release
 the squid bugzilla database should be used
 <A HREF="http://bugs.squid-cache.org/.">http://bugs.squid-cache.org/.</A>

 For reporting of security sensitive bugs send an email to the
 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at squid-cache.org</A> mailing list. It is a closed list
 (though anyone can post) and security related bug reports are
 treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 The vulnerability was reported by CESG.

 Fixed by Amos Jeffries, Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2016-04-15 10:54:39 GMT Initial Report
 2016-04-20 03:54:54 GMT Patches Released
 2016-04-20 13:42:00 GMT Packages Released
 2016-04-20 15:47:01 GMT CVE Assigned
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010261.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2016:5 Buffer	overflow in	cachemgr.cgi
</A></li>
	<LI>Next message (by thread): <A HREF="010264.html">[squid-users] High CPU Usage with ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10262">[ date ]</a>
              <a href="thread.html#10262">[ thread ]</a>
              <a href="subject.html#10262">[ subject ]</a>
              <a href="author.html#10262">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
