<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Need help with Squid on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20help%20with%20Squid%20on%20Windows&In-Reply-To=%3Cdaf6423a-c117-ba4a-cb7a-611c2fe0bdf0%40spegalnetworks.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010342.html">
   <LINK REL="Next"  HREF="010305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Need help with Squid on Windows</H1>
    <B>Jason Spegal</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20help%20with%20Squid%20on%20Windows&In-Reply-To=%3Cdaf6423a-c117-ba4a-cb7a-611c2fe0bdf0%40spegalnetworks.net%3E"
       TITLE="[squid-users] Need help with Squid on Windows">jspegal at spegalnetworks.net
       </A><BR>
    <I>Fri Apr 22 15:09:04 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010342.html">[squid-users] change between squid 3.1 and 3.3.8
</A></li>
        <LI>Next message (by thread): <A HREF="010305.html">[squid-users] Need help with Squid on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10299">[ date ]</a>
              <a href="thread.html#10299">[ thread ]</a>
              <a href="subject.html#10299">[ subject ]</a>
              <a href="author.html#10299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,

I need help with an issue that is now beyond me. I've installed squid 
3.5.16 (From: <A HREF="http://squid.diladele.com/">http://squid.diladele.com/</A>) on my Windows 10 laptop, and 
I'm trying to enable the URL Rewrite helpers that I wrote in perl for my 
linux server. I've already done the necessary adjustments to them to 
make them work on windows. Running them directly seems to be fine, 
however when squid runs them they fail to execute. I've gotten as far as 
finding out perl is executing okay, however the script is not. I am 
unable to figure out how to debug it further. Running squid with full 
debugging (squid.exe -N -X -d 7) did not produce any significant 
information as to why they were not executing. My linux server is 
running squid 3.5.11 and is not having any issues with the helpers. The 
very first thing the helpers do is open a log file and write an 
initialization statement to it. I'm not seeing this when squid tried to 
execute it, so I'm fairly certain it has something to do with the 
execution of the script rather than a problem with the script itself. 
I've also examined the permissions, and those should be good.

Thanks in advance for the help.

--Jason


squid.conf
-------------------------------------------
url_rewrite_program /cygdrive/c/strawberry/perl/bin/perl.exe 
C:\Squid\etc\squid\filtered_sites\squidRed.pl
url_rewrite_children 100 startup=10 idle=1 concurrency=10
url_rewrite_access allow all
url_rewrite_bypass off


Also tried url_rewrite_program 
/cygdrive/c/squid/etc/squid/filtered_sites/squidRed.pl


cache.log
-------------------------------------------
Squid Cache (Version 3.5.16): Terminated abnormally.
CPU Usage: 0.281 seconds = 0.078 user + 0.203 sys
Maximum Resident Size: 1371136 KB
Page faults with physical i/o: 5488
2016/04/22 08:53:06 kid1| Set Current Directory to 
/cygdrive/c/squid/var/cache/squid
2016/04/22 08:53:06 kid1| Starting Squid Cache version 3.5.16 for 
x86_64-unknown-cygwin...
2016/04/22 08:53:06 kid1| Service Name: squid
2016/04/22 08:53:06 kid1| Process ID 10296
2016/04/22 08:53:06 kid1| Process Roles: worker
2016/04/22 08:53:06 kid1| With 256 file descriptors available
2016/04/22 08:53:06 kid1| Initializing IP Cache...
2016/04/22 08:53:06 kid1| parseEtcHosts: /etc/hosts: (2) No such file or 
directory
2016/04/22 08:53:06 kid1| DNS Socket created at [::], FD 5
2016/04/22 08:53:06 kid1| DNS Socket created at 0.0.0.0, FD 6
2016/04/22 08:53:06 kid1| Adding nameserver 10.10.124.1 from squid.conf
2016/04/22 08:53:06 kid1| Adding nameserver 10.10.122.250 from squid.conf
2016/04/22 08:53:06 kid1| Adding nameserver 8.8.8.8 from squid.conf
2016/04/22 08:53:06 kid1| helperOpenServers: Starting 5/32 
'ssl_crtd.exe' processes
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| helperOpenServers: Starting 10/100 'perl.exe' 
processes
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| Logfile: opening log 
daemon:/var/log/squid/access.log
2016/04/22 08:53:06 kid1| Logfile Daemon: opening log 
/var/log/squid/access.log
2016/04/22 08:53:06 kid1| WARNING: no_suid: setuid(0): (22) Invalid argument
2016/04/22 08:53:06 kid1| Store logging disabled
2016/04/22 08:53:06 kid1| Swap maxSize 2097152 + 131072 KB, estimated 
171401 objects
2016/04/22 08:53:06 kid1| Target number of buckets: 8570
2016/04/22 08:53:06 kid1| Using 16384 Store buckets
2016/04/22 08:53:06 kid1| Max Mem  size: 131072 KB
2016/04/22 08:53:06 kid1| Max Swap size: 2097152 KB
2016/04/22 08:53:06 kid1| Rebuilding storage in /cygdrive/c/squid/cache 
(clean log)
2016/04/22 08:53:06 kid1| Using Least Load store dir selection
2016/04/22 08:53:06 kid1| Set Current Directory to 
/cygdrive/c/squid/var/cache/squid
2016/04/22 08:53:06 kid1| Finished loading MIME types and icons.
2016/04/22 08:53:06 kid1| HTCP Disabled.
2016/04/22 08:53:06 kid1| Configuring Parent 10.10.124.1/3128/3130
2016/04/22 08:53:06 kid1| Configuring Parent 10.10.122.250/3128/3130
2016/04/22 08:53:06 kid1| Squid plugin modules loaded: 0
2016/04/22 08:53:06 kid1| Adaptation support is off.
2016/04/22 08:53:06 kid1| Accepting SSL bumped HTTP Socket connections 
at local=[::]:3128 remote=[::] FD 43 flags=9
2016/04/22 08:53:06 kid1| Done reading /cygdrive/c/squid/cache swaplog 
(98 entries)
2016/04/22 08:53:06 kid1| Finished rebuilding storage from disk.
2016/04/22 08:53:06 kid1|        98 Entries scanned
2016/04/22 08:53:06 kid1|         0 Invalid entries.
2016/04/22 08:53:06 kid1|         0 With invalid flags.
2016/04/22 08:53:06 kid1|        98 Objects loaded.
2016/04/22 08:53:06 kid1|         0 Objects expired.
2016/04/22 08:53:06 kid1|         0 Objects cancelled.
2016/04/22 08:53:06 kid1|         0 Duplicate URLs purged.
2016/04/22 08:53:06 kid1|         0 Swapfile clashes avoided.
2016/04/22 08:53:06 kid1|   Took 0.10 seconds (967.63 objects/sec).
2016/04/22 08:53:06 kid1| Beginning Validation Procedure
2016/04/22 08:53:06 kid1|   Completed Validation Procedure
2016/04/22 08:53:06 kid1|   Validated 98 Entries
2016/04/22 08:53:06 kid1|   store_swap_size = 4280.00 KB
2016/04/22 08:53:06 kid1| WARNING: redirector #Hlpr6 exited
2016/04/22 08:53:06 kid1| Too few redirector processes are running (need 
1/100)
2016/04/22 08:53:06 kid1| Closing HTTP port [::]:3128
2016/04/22 08:53:06 kid1| storeDirWriteCleanLogs: Starting...
2016/04/22 08:53:06 kid1|   Finished.  Wrote 98 entries.
2016/04/22 08:53:06 kid1|   Took 0.00 seconds (58965.10 entries/sec).
FATAL: The redirector helpers are crashing too rapidly, need help!

Squid Cache (Version 3.5.16): Terminated abnormally.
CPU Usage: 0.218 seconds = 0.109 user + 0.109 sys
Maximum Resident Size: 1371648 KB
Page faults with physical i/o: 5489


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010342.html">[squid-users] change between squid 3.1 and 3.3.8
</A></li>
	<LI>Next message (by thread): <A HREF="010305.html">[squid-users] Need help with Squid on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10299">[ date ]</a>
              <a href="thread.html#10299">[ thread ]</a>
              <a href="subject.html#10299">[ subject ]</a>
              <a href="author.html#10299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
