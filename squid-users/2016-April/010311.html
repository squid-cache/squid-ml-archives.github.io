<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Need help with Squid on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20help%20with%20Squid%20on%20Windows&In-Reply-To=%3CVI1PR04MB135930DB77E62C7DA7B178738F600%40VI1PR04MB1359.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010305.html">
   <LINK REL="Next"  HREF="010312.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Need help with Squid on Windows</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Need%20help%20with%20Squid%20on%20Windows&In-Reply-To=%3CVI1PR04MB135930DB77E62C7DA7B178738F600%40VI1PR04MB1359.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] Need help with Squid on Windows">rafael.akchurin at diladele.com
       </A><BR>
    <I>Sat Apr 23 12:26:59 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010305.html">[squid-users] Need help with Squid on Windows
</A></li>
        <LI>Next message (by thread): <A HREF="010312.html">[squid-users] Need help with Squid on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10311">[ date ]</a>
              <a href="thread.html#10311">[ thread ]</a>
              <a href="subject.html#10311">[ subject ]</a>
              <a href="author.html#10311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Jason, Amos, all,

Possibly the issue can be related to Squid being compiled with Cygwin <A HREF="https://cygwin.com/ml/cygwin/2012-03/msg00302.html,">https://cygwin.com/ml/cygwin/2012-03/msg00302.html,</A> I'm not sure whether this issue with standard output has been fixed in the current Cygwin.

One of the workarounds that could possibly work is to install Cygwin and build squid yourself as described here: <A HREF="http://docs.diladele.com/tutorials/build_squid_windows/index.html,">http://docs.diladele.com/tutorials/build_squid_windows/index.html,</A> this should start helpers from Cygwin terminal instead of cmd.

Best regards,
Rafael Akchurin
Diladele B.V. 
<A HREF="http://www.quintolabs.com">http://www.quintolabs.com</A> 
<A HREF="http://www.diladele.com">http://www.diladele.com</A> 

--
Please take a look at Web Safety - our ICAP based web filter server for Squid proxy at <A HREF="http://www.diladele.com.">http://www.diladele.com.</A>



-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Saturday, April 23, 2016 5:42 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Need help with Squid on Windows

On 23/04/2016 3:09 a.m., Jason Spegal wrote:
&gt;<i> Hello all,
</I>&gt;<i> 
</I>&gt;<i> I need help with an issue that is now beyond me. I've installed squid
</I>&gt;<i> 3.5.16 (From: <A HREF="http://squid.diladele.com/">http://squid.diladele.com/</A>) on my Windows 10 laptop, and 
</I>&gt;<i> I'm trying to enable the URL Rewrite helpers that I wrote in perl for 
</I>&gt;<i> my linux server. I've already done the necessary adjustments to them 
</I>&gt;<i> to make them work on windows. Running them directly seems to be fine, 
</I>&gt;<i> however when squid runs them they fail to execute. I've gotten as far 
</I>&gt;<i> as finding out perl is executing okay, however the script is not. I am 
</I>&gt;<i> unable to figure out how to debug it further. Running squid with full 
</I>&gt;<i> debugging (squid.exe -N -X -d 7) did not produce any significant 
</I>&gt;<i> information as to why they were not executing.
</I>
You usually need to enable debugging in the helper itself to get that.
Squid only knows that the helper died on startup.


&gt;<i> My linux server is
</I>&gt;<i> running squid 3.5.11 and is not having any issues with the helpers. 
</I>&gt;<i> The very first thing the helpers do is open a log file and write an 
</I>&gt;<i> initialization statement to it. I'm not seeing this when squid tried 
</I>&gt;<i> to execute it, so I'm fairly certain it has something to do with the 
</I>&gt;<i> execution of the script rather than a problem with the script itself.
</I>&gt;<i> I've also examined the permissions, and those should be good.
</I>&gt;<i> 
</I>
FWIW: Nothing has changed inside Squid for helpers between those two releases.


&gt;<i> Thanks in advance for the help.
</I>&gt;<i> 
</I>&gt;<i> --Jason
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> squid.conf
</I>&gt;<i> -------------------------------------------
</I>&gt;<i> url_rewrite_program /cygdrive/c/strawberry/perl/bin/perl.exe
</I>&gt;<i> C:\Squid\etc\squid\filtered_sites\squidRed.pl
</I>&gt;<i> url_rewrite_children 100 startup=10 idle=1 concurrency=10 
</I>&gt;<i> url_rewrite_access allow all url_rewrite_bypass off
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Also tried url_rewrite_program
</I>&gt;<i> /cygdrive/c/squid/etc/squid/filtered_sites/squidRed.pl
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> cache.log
</I>&gt;<i> -------------------------------------------
</I>&gt;<i> Squid Cache (Version 3.5.16): Terminated abnormally.
</I>
Maybe something left over from this previous aborted Squid instance and its helpers that kills the next one to start?

&gt;<i> CPU Usage: 0.281 seconds = 0.078 user + 0.203 sys Maximum Resident 
</I>&gt;<i> Size: 1371136 KB Page faults with physical i/o: 5488
</I>&gt;<i> 2016/04/22 08:53:06 kid1| Set Current Directory to 
</I>&gt;<i> /cygdrive/c/squid/var/cache/squid
</I>&gt;<i> 2016/04/22 08:53:06 kid1| Starting Squid Cache version 3.5.16 for 
</I>&gt;<i> x86_64-unknown-cygwin...
</I>...
&gt;<i> 2016/04/22 08:53:06 kid1| helperOpenServers: Starting 10/100 'perl.exe'
</I>&gt;<i> processes
</I>...
&gt;<i> 2016/04/22 08:53:06 kid1| WARNING: redirector #Hlpr6 exited
</I>...
&gt;<i> 2016/04/22 08:53:06 kid1| Too few redirector processes are running 
</I>&gt;<i> (need
</I>&gt;<i> 1/100)
</I>...
&gt;<i> FATAL: The redirector helpers are crashing too rapidly, need help!
</I>
Note that it is only the 6th helper that dies. The first 5 seem to be okay at this point.

Maybe something they share which has a limited connection count?

Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010305.html">[squid-users] Need help with Squid on Windows
</A></li>
	<LI>Next message (by thread): <A HREF="010312.html">[squid-users] Need help with Squid on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10311">[ date ]</a>
              <a href="thread.html#10311">[ thread ]</a>
              <a href="subject.html#10311">[ subject ]</a>
              <a href="author.html#10311">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
