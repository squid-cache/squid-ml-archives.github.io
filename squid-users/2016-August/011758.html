<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] different results every time
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20different%20results%20every%20time&In-Reply-To=%3CCALBG%3DMEoJH9XO8PpimnVgSKtoupXoAP1pvUXU0_8Q-LxH-KCGw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011757.html">
   <LINK REL="Next"  HREF="011764.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] different results every time</H1>
    <B>Sam M</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20different%20results%20every%20time&In-Reply-To=%3CCALBG%3DMEoJH9XO8PpimnVgSKtoupXoAP1pvUXU0_8Q-LxH-KCGw%40mail.gmail.com%3E"
       TITLE="[squid-users] different results every time">samm.abcd at gmail.com
       </A><BR>
    <I>Wed Aug  3 02:06:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011757.html">[squid-users] different results every time
</A></li>
        <LI>Next message (by thread): <A HREF="011764.html">[squid-users] different results every time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11758">[ date ]</a>
              <a href="thread.html#11758">[ thread ]</a>
              <a href="subject.html#11758">[ subject ]</a>
              <a href="author.html#11758">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Reading through the documentation of Collapsed Forwarding feature I don't
know if this feature would help as the problem to what I'm feeling is the
squid eviction process and decision. It looks like squid is storing more
what is being set in the cache_dir and not evicting the least recently used
files at the right time because of the heavy request load.

Does that make sense, or is there other explanation to the issue I'm having?

Sam

On Tue, Aug 2, 2016 at 9:51 PM, Sam M &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">samm.abcd at gmail.com</A>&gt; wrote:

&gt;<i> Hi Eliezer,
</I>&gt;<i>
</I>&gt;<i> Thanks for your prompt reply. We are testing our squid configuration
</I>&gt;<i> before we use it. That said, all objects are 1 MB in size and in order to
</I>&gt;<i> test squid we queried a sequence of files multiple times in a manner that
</I>&gt;<i> theoretically at the end of the querying process we should get the same
</I>&gt;<i> number of hits from cache1, cache2, cache3, and cache4.
</I>&gt;<i>
</I>&gt;<i> Structure of test network is: User (using a script) -&gt; cache1 -&gt; cache2 -&gt;
</I>&gt;<i> cache3 -&gt; cache4 -&gt; web server (stores the queried files).
</I>&gt;<i>
</I>&gt;<i> I'm gonna try the Collapsed Forwarding feature and will post back if this
</I>&gt;<i> fixes the issue.
</I>&gt;<i>
</I>&gt;<i> Thank you,
</I>&gt;<i> Sam
</I>&gt;<i>
</I>&gt;<i> On Tue, Aug 2, 2016 at 2:03 AM, Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hey Sam,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> From what I understand it seems that your expectation doesn't meet the
</I>&gt;&gt;<i> reality but I am unsure yet.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It seems that the goal is to fetch and save everything to disk and from
</I>&gt;&gt;<i> disk, right?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> During the time that your clients and proxy are fetching the object using
</I>&gt;&gt;<i> squid, you cannot serve this &quot;in-transit&quot; content to other clients.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Collapsed Forwarding feature of squid should satisfy your use case but
</I>&gt;&gt;<i> depends on the size of the object it might not be the right choice for you.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What objects size are we talking about?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Eliezer
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Eliezer Croitoru &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt;
</I>&gt;&gt;<i> Linux System Administrator
</I>&gt;&gt;<i> Mobile: +972-5-28704261
</I>&gt;&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *From:* squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] *On
</I>&gt;&gt;<i> Behalf Of *Sam M
</I>&gt;&gt;<i> *Sent:* Tuesday, August 2, 2016 8:43 AM
</I>&gt;&gt;<i> *To:* <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> *Subject:* [squid-users] different results every time
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm querying lots of files through 4 cache servers connected through
</I>&gt;&gt;<i> parent hierarchy. I clean all the caches before I start and then I query
</I>&gt;&gt;<i> the files again in the same exact order. Weirdly, every time I check the
</I>&gt;&gt;<i> logs, I see a different cache served a file compared with the previous
</I>&gt;&gt;<i> test. The query process is done through a python script that uses wget
</I>&gt;&gt;<i> through a proxy to the cache, hence the query process is really fast.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Interestingly, if I put a delay of 1 second between each query, the
</I>&gt;&gt;<i> result will be stable and same every time I run the script.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Following a snippet from the config file after changing it too many times
</I>&gt;&gt;<i> to make it re-produce the same results yet, that didn't help:
</I>&gt;&gt;<i> cache_dir ufs /var/spool/squid 9 16 256
</I>&gt;&gt;<i> cache_mem 0 MB
</I>&gt;&gt;<i> memory_pools off
</I>&gt;&gt;<i> cache_swap_low 100
</I>&gt;&gt;<i> cache_swap_high 100
</I>&gt;&gt;<i> maximum_object_size_in_memory 0 KB
</I>&gt;&gt;<i> cache_replacement_policy lru
</I>&gt;&gt;<i> range_offset_limit 0
</I>&gt;&gt;<i> quick_abort_min 0 KB
</I>&gt;&gt;<i> quick_abort_max 0 KB
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can someone shed some light on the issue and how to fix it please?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sam
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160802/ac59de77/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160802/ac59de77/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 11308 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160802/ac59de77/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160802/ac59de77/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011757.html">[squid-users] different results every time
</A></li>
	<LI>Next message (by thread): <A HREF="011764.html">[squid-users] different results every time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11758">[ date ]</a>
              <a href="thread.html#11758">[ thread ]</a>
              <a href="subject.html#11758">[ subject ]</a>
              <a href="author.html#11758">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
