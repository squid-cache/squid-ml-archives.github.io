<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSLBump just not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSLBump%20just%20not%20working&In-Reply-To=%3C9ae277aa-b036-23b2-3d51-bfdb19ff93e1%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011802.html">
   <LINK REL="Next"  HREF="011754.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSLBump just not working</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSLBump%20just%20not%20working&In-Reply-To=%3C9ae277aa-b036-23b2-3d51-bfdb19ff93e1%40treenet.co.nz%3E"
       TITLE="[squid-users] SSLBump just not working">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Aug  5 10:54:48 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011802.html">[squid-users] SSLBump just not working
</A></li>
        <LI>Next message (by thread): <A HREF="011754.html">[squid-users] different results every time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11804">[ date ]</a>
              <a href="thread.html#11804">[ thread ]</a>
              <a href="subject.html#11804">[ subject ]</a>
              <a href="author.html#11804">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/08/2016 2:13 p.m., JR Dalrymple wrote:
&gt;<i> 
</I>&gt;<i> For posterity's sake, here are the relevant parts of my working
</I>&gt;<i> configuration:
</I>&gt;<i> 
</I>&gt;<i> /etc/pf.conf:
</I>&gt;<i> pass in proto tcp to any port 80 divert-to 127.0.0.1 port 3128
</I>&gt;<i> pass in proto tcp to any port 443 divert-to 127.0.0.1 port 3129
</I>&gt;<i> 
</I>&gt;<i> squid.conf:
</I>&gt;<i> http_port 127.0.0.1:3128 intercept
</I>&gt;<i> https_port 127.0.0.1:3129 intercept ssl-bump generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=4MB cert=/usr/local/squid/etc/ssl/CA.pem
</I>&gt;<i> 
</I>
FYI: Since OpenBSD 4.4+ the PF divert-to rule performs their
implementation of TPROXY. So technically it is more correct to configure
&quot;tproxy&quot; option on the listening ports. But the &quot;intercept&quot; will also
work - it just makes Squid behave like a NAT instead of fully transparent.

Also, both styles can handle IPv6 as well as IPv4. That is currently
limited only by your explicit use of 127.0.0.1 in the rules and port
declarations.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011802.html">[squid-users] SSLBump just not working
</A></li>
	<LI>Next message (by thread): <A HREF="011754.html">[squid-users] different results every time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11804">[ date ]</a>
              <a href="thread.html#11804">[ thread ]</a>
              <a href="subject.html#11804">[ subject ]</a>
              <a href="author.html#11804">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
