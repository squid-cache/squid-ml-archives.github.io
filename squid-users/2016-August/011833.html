<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is 20840 and one of squid process is 57% , whether it will be fine ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20I%20redirect%20some%20http%20traffic%20to%20squid%20%28%2090Mbps%29%20and%20i%0A%20found%20TIME_WAIT%20is%2020840%20and%20one%20of%20squid%20process%20is%2057%25%20%2C%0A%20whether%20it%20will%20be%20fine%20%3F&In-Reply-To=%3C57A986ED.4060009%40yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011843.html">
   <LINK REL="Next"  HREF="011841.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is 20840 and one of squid process is 57% , whether it will be fine ?</H1>
    <B>johnzeng</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20I%20redirect%20some%20http%20traffic%20to%20squid%20%28%2090Mbps%29%20and%20i%0A%20found%20TIME_WAIT%20is%2020840%20and%20one%20of%20squid%20process%20is%2057%25%20%2C%0A%20whether%20it%20will%20be%20fine%20%3F&In-Reply-To=%3C57A986ED.4060009%40yahoo.com%3E"
       TITLE="[squid-users] I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is 20840 and one of squid process is 57% , whether it will be fine ?">johnzeng2013 at yahoo.com
       </A><BR>
    <I>Tue Aug  9 07:31:57 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011843.html">[squid-users] Rate limiting bad clients?
</A></li>
        <LI>Next message (by thread): <A HREF="011841.html">[squid-users] I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is 20840 and one of squid process is 57% , whether it will be fine ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11833">[ date ]</a>
              <a href="thread.html#11833">[ thread ]</a>
              <a href="subject.html#11833">[ subject ]</a>
              <a href="author.html#11833">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Hello Dear Sir

I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is
20840 and one of squid process is 57%

whether it will be normal condition ??

Whether we can balance cpu processing capacity
&lt;<A HREF="http://www.baidu.com/link?url=Rnht_DzfJLQPi_VnmfPjUfWfUdE4kaP1H7Vol-rTTZqKvF8npmGrx8-h947AFhU6-kqlwyWBW7W4ghqHWMs1iN1APnbkLMjrB7YI1PzephOCELHTqemcUEY1JH0mmw68">http://www.baidu.com/link?url=Rnht_DzfJLQPi_VnmfPjUfWfUdE4kaP1H7Vol-rTTZqKvF8npmGrx8-h947AFhU6-kqlwyWBW7W4ghqHWMs1iN1APnbkLMjrB7YI1PzephOCELHTqemcUEY1JH0mmw68</A>&gt;
for full squid process !

Because we use squid 3.5.2 and use cache_dir rock part . Maybe squid
3.5.2 require to do automatic scheduling at full cpu core

i don't know whether i can use taskset for squid 3.5.3 as squid 2.7 ??


if possible , please give me some advisement


___________________________________________________________
accerater
TIME_WAIT DETAIL
___________________________________________________________

TIME_WAIT 20840
CLOSE_WAIT 59
SYN_SENT 7
FIN_WAIT1 23
FIN_WAIT2 294
ESTABLISHED 5902
SYN_RECV 13
LAST_ACK 11


____________________________________________________________________

CPU STATUS
____________________________________________________________________


Tasks: 381 total, 1 running, 380 sleeping, 0 stopped, 0 zombie
Cpu(s): 4.1%us, 0.6%sy, 0.0%ni, 92.6%id, 0.2%wa, 0.0%hi, 2.5%si, 0.0%st
Mem: 65889452k total, 65038396k used, 851056k free, 790788k buffers
Swap: 976892k total, 0k used, 976892k free, 56220968k cached

PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
1904 sqiduser 20 0 33.5g 710m 271m S 57 1.1 978:34.74 squid
1903 sqiduser 20 0 33.4g 609m 271m S 32 0.9 497:59.29 squid
1906 sqiduser 20 0 33.3g 555m 271m S 22 0.9 266:41.47 squid
1902 sqiduser 20 0 33.4g 651m 271m S 20 1.0 710:04.17 squid
1901 sqiduser 20 0 33.5g 694m 271m S 15 1.1 616:40.25 squid
2028 sqiduser 20 0 2406m 75m 1888 S 7 0.1 297:56.70 named
1907 sqiduser 20 0 33.4g 589m 270m S 7 0.9 167:37.24 squid
1908 sqiduser 20 0 33.3g 545m 270m S 5 0.8 155:50.67 squid
1905 sqiduser 20 0 33.3g 553m 270m S 1 0.9 121:05.67 squid


___________________________________________________________________________

PART SQUID CONFIG
___________________________________________________________________________

cache_mem 32172 MB
workers 8
cpu_affinity_map process_numbers=1,2,3,4,5,6,7,8 cores=1,3,5,7,9,11,13,15
cache_dir rock /acapp/webcache3/storage/cossbig1/squid1 17280
min-size=4097 max-size=262144 max-swap-rate=250 swap-timeout=350
cache_dir rock /acapp/webcache3/storage/cosssmall1/squid1 1152
max-size=4096 max-swap-rate=250 swap-timeout=350
if ${process_number} = 1
unique_hostname fast_squid${process_number}
access_log stdio:/acapp/logs/webcache3/squid${process_number}/access.log
squid
cache_log /acapp/logs/webcache3/squid${process_number}/cache.log
snmp_port 3401
cache_dir aufs /acapp/webcache3/storage/aufs1/squid${process_number}
192000 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs2/squid${process_number}
192000 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs3/squid${process_number}
288096 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs4/squid${process_number}
288096 16 64 min-size=262145
endif
if ${process_number} = 2
unique_hostname fast_squid${process_number}
access_log stdio:/acapp/logs/webcache3/squid${process_number}/access.log
squid
cache_log /acapp/logs/webcache3/squid${process_number}/cache.log
snmp_port 3402
cache_dir aufs /acapp/webcache3/storage/aufs1/squid${process_number}
192000 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs2/squid${process_number}
192000 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs3/squid${process_number}
288096 16 64 min-size=262145
cache_dir aufs /acapp/webcache3/storage/aufs4/squid${process_number}
288096 16 64 min-size=262145
endif
................
..............................




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011843.html">[squid-users] Rate limiting bad clients?
</A></li>
	<LI>Next message (by thread): <A HREF="011841.html">[squid-users] I redirect some http traffic to squid ( 90Mbps) and i found TIME_WAIT is 20840 and one of squid process is 57% , whether it will be fine ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11833">[ date ]</a>
              <a href="thread.html#11833">[ thread ]</a>
              <a href="subject.html#11833">[ subject ]</a>
              <a href="author.html#11833">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
