<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid refresh_pattern / cache question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20refresh_pattern%20/%20cache%20question&In-Reply-To=%3C916606669CFF224AB6997E9DB783F6EACCCBF7DF%40ESCML200.corp.pjc.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011847.html">
   <LINK REL="Next"  HREF="011848.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid refresh_pattern / cache question</H1>
    <B>Berkes, David</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20refresh_pattern%20/%20cache%20question&In-Reply-To=%3C916606669CFF224AB6997E9DB783F6EACCCBF7DF%40ESCML200.corp.pjc.com%3E"
       TITLE="[squid-users] squid refresh_pattern / cache question">David.J.Berkes at pjc.com
       </A><BR>
    <I>Wed Aug 10 14:24:14 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011847.html">[squid-users] squid refresh_pattern / cache question
</A></li>
        <LI>Next message (by thread): <A HREF="011848.html">[squid-users] how can I coplete this squid tutorial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11851">[ date ]</a>
              <a href="thread.html#11851">[ thread ]</a>
              <a href="subject.html#11851">[ subject ]</a>
              <a href="author.html#11851">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much Amos.  Your support and the Squid product works very good for us.  It is handling all of our traffic very well and have not had any issues since the change.

-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Tuesday, August 09, 2016 6:12 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] squid refresh_pattern / cache question

On 10/08/2016 10:43 a.m., Berkes, David wrote:
&gt;<i>
</I>&gt;<i> I have a question about the caching mechanism and &quot;refresh_pattern&quot; specifically.  I had the following configured for my company.  Lateley there have been complaints that people are seeing old pages and not the recent content...specifically when going to www.bbc.com&lt;<A HREF="https://urldefense.proofpoint.com/v2/url?u=http-3A__www.bbc.com&amp;d=CwIGaQ&amp;c=y6v6TkqbF5T5q8gzoA5_qyxfBe6wpRCKPt3qOZXx4sE&amp;r=cEqld2WF5YXp35LOdsMCPdSMKFHyVQBUWZMc0D_9qzI&amp;m=XTlkALphJqTeTc9DfX4Rm5TaIO-jZtR0yZQ0tNYNHOE&amp;s=5GPJPKVFqHYAv0pEZYSGQSDS8GijxSR7NaGDZIjtvdM&amp;e=">https://urldefense.proofpoint.com/v2/url?u=http-3A__www.bbc.com&amp;d=CwIGaQ&amp;c=y6v6TkqbF5T5q8gzoA5_qyxfBe6wpRCKPt3qOZXx4sE&amp;r=cEqld2WF5YXp35LOdsMCPdSMKFHyVQBUWZMc0D_9qzI&amp;m=XTlkALphJqTeTc9DfX4Rm5TaIO-jZtR0yZQ0tNYNHOE&amp;s=5GPJPKVFqHYAv0pEZYSGQSDS8GijxSR7NaGDZIjtvdM&amp;e=</A> &gt;.
</I>&gt;<i>
</I>&gt;<i> Im not actually sure what is not allowing the bbc.com pages to not get updated, but at this point, I just want to let squid do normal caching without any refresh_pattern or &quot;fancy&quot; settings.
</I>&gt;<i>
</I>&gt;<i> My question is will I still get caching features/benefits of squid after I remove the &quot;refresh_pattern&quot; entries?
</I>
Yes you will get caching. Just on a slightly different set of objects than are being cached now.

The HTTP protocol defines an algorithm for heuristic caching. Which is based on the headers sent by the server (or not) for each object. All that refresh_pattern does is provide default values for the headers if the server did not send one or other. The ignore/override options make Squid calculate that algorithm as if certain header values were not sent even if they were.


I suggest you try the following changes first though:

* remove the ignore-no-cache ignore-no-store ignore-private options.

* add the refresh_pattern for correctly handling dynamic content. This should be placed as second to last pattern, just above the '.' one.

  refresh_pattern -i (/cgi-bin/|\?) 0 0% 0


That should make your Squid obey the HTTP protocol more accurately. If the problem remains after those changes, then you need to take a closer look at what exactly is going on with those problem URLs.


Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="https://urldefense.proofpoint.com/v2/url?u=http-3A__lists.squid-2Dcache.org_listinfo_squid-2Dusers&amp;d=CwIGaQ&amp;c=y6v6TkqbF5T5q8gzoA5_qyxfBe6wpRCKPt3qOZXx4sE&amp;r=cEqld2WF5YXp35LOdsMCPdSMKFHyVQBUWZMc0D_9qzI&amp;m=XTlkALphJqTeTc9DfX4Rm5TaIO-jZtR0yZQ0tNYNHOE&amp;s=dcU9dnoc_YN_qUGX_4NE01SGVn7A52SB_O3E2dm7BIA&amp;e=">https://urldefense.proofpoint.com/v2/url?u=http-3A__lists.squid-2Dcache.org_listinfo_squid-2Dusers&amp;d=CwIGaQ&amp;c=y6v6TkqbF5T5q8gzoA5_qyxfBe6wpRCKPt3qOZXx4sE&amp;r=cEqld2WF5YXp35LOdsMCPdSMKFHyVQBUWZMc0D_9qzI&amp;m=XTlkALphJqTeTc9DfX4Rm5TaIO-jZtR0yZQ0tNYNHOE&amp;s=dcU9dnoc_YN_qUGX_4NE01SGVn7A52SB_O3E2dm7BIA&amp;e=</A>
________________________________


Piper Jaffray &amp; Co. Since 1895. Member SIPC and NYSE. Learn more at www.piperjaffray.com. Piper Jaffray corporate headquarters is located at 800 Nicollet Mall, Minneapolis, MN 55402.

Piper Jaffray outgoing and incoming e-mail is electronically archived and recorded and is subject to review, monitoring and/or disclosure to someone other than the recipient. This e-mail may be considered an advertisement or solicitation for purposes of regulation of commercial electronic mail messages. If you do not wish to receive commercial e-mail communications from Piper Jaffray, go to: www.piperjaffray.com/do_not_email to review the details and submit your request to be added to the Piper Jaffray &quot;Do Not E-mail Registry.&quot; For additional disclosure information see www.piperjaffray.com/disclosures
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011847.html">[squid-users] squid refresh_pattern / cache question
</A></li>
	<LI>Next message (by thread): <A HREF="011848.html">[squid-users] how can I coplete this squid tutorial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11851">[ date ]</a>
              <a href="thread.html#11851">[ thread ]</a>
              <a href="subject.html#11851">[ subject ]</a>
              <a href="author.html#11851">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
