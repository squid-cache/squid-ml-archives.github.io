<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] A problem with a refresh pattern rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20A%20problem%20with%20a%20refresh%20pattern%20rule&In-Reply-To=%3Cc8f5e0c1-ecbe-5413-1b4f-7d9513a69dcc%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011858.html">
   <LINK REL="Next"  HREF="011862.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] A problem with a refresh pattern rule</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20A%20problem%20with%20a%20refresh%20pattern%20rule&In-Reply-To=%3Cc8f5e0c1-ecbe-5413-1b4f-7d9513a69dcc%40treenet.co.nz%3E"
       TITLE="[squid-users] A problem with a refresh pattern rule">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Aug 11 10:38:13 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011858.html">[squid-users] A problem with a refresh pattern rule
</A></li>
        <LI>Next message (by thread): <A HREF="011862.html">[squid-users] A problem with a refresh pattern rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11859">[ date ]</a>
              <a href="thread.html#11859">[ thread ]</a>
              <a href="subject.html#11859">[ subject ]</a>
              <a href="author.html#11859">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/08/2016 7:04 p.m., C. L. Martinez wrote:
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i>  I am doing some modifications in refresh_patterns rules in a squid host (release 3.5.20) and it seems they are working, with the exception of this one:
</I>&gt;<i> 
</I>&gt;<i> refresh_pattern -i \.(rar|jar|gz|tgz|tar|bz2|iso|m1v|m2(v|p)|mo(d|v)|(x-|)flv)  129600  80%  129600  override-expire override-lastmod reload-into-ims ignore-reload
</I>&gt;<i> 
</I>&gt;<i>  When I run 'squid -k parse' returns me the following error:
</I>&gt;<i> 
</I>&gt;<i> 2016/08/11 06:57:33| /etc/squid/squid.conf line 173: refresh_pattern -i \.(rar|jar|gz|tgz|tar|bz2|iso|m1v|m2(v|p)|mo(d|v)|(x-|)flv)     129600  80%  129600  override-expire override-lastmod reload-into-ims ignore-reload
</I>&gt;<i> 2016/08/11 06:57:33| refreshAddToList: Invalid regular expression '\.(rar|jar|gz|tgz|tar|bz2|iso|m1v|m2(v|p)|mo(d|v)|(x-|)flv)': empty (sub)expression
</I>&gt;<i> 
</I>&gt;<i>  Searching where I am doing the mistake, I don't find any problem with &quot;\.(rar|jar|gz|tgz|tar|bz2|iso|m1v|m2(v|p)|mo(d|v)|(x-|)flv)&quot;. Where am I doing the mistake??
</I>&gt;<i> 
</I>
That pattern works fine for me. Must be something to do with the regex
library on your system.

I think the error message is about the (x-|)flv piece. The absence of
anything between | and ) is the only bit that coudl be called an 'empty
sub-expression' there. You might have to change that to x-flv|flv.


&gt;<i>  On the other side, I see the following warnings also:
</I>&gt;<i> 
</I>&gt;<i> 2016/08/11 06:57:33| WARNING: use of 'override-expire' in 'refresh_pattern' violates HTTP
</I>&gt;<i> 2016/08/11 06:57:33| WARNING: use of 'override-lastmod' in 'refresh_pattern' violates HTTP
</I>&gt;<i> 2016/08/11 06:57:33| WARNING: use of 'reload-into-ims' in 'refresh_pattern' violates HTTP
</I>&gt;<i> 2016/08/11 06:57:33| WARNING: use of 'ignore-reload' in 'refresh_pattern' violates HTTP
</I>&gt;<i> 
</I>&gt;<i>  I have enabled these options &quot;override-expire override-lastmod reload-into-ims ignore-reload&quot; on some other patterns. Is this wrong??
</I>
Those are WARNINGs. Not an error. They instruct Squid to do things which
are outside the HTTP specification. You may encounter trouble with some
traffic because of that changed behaviour.

The warnings are there to make sure you awre aware something risky is
being done, and when you run into trouble with those options it is
probably not Squid bugs but your choice to violate the standard HTTP
behaviour which caused it.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011858.html">[squid-users] A problem with a refresh pattern rule
</A></li>
	<LI>Next message (by thread): <A HREF="011862.html">[squid-users] A problem with a refresh pattern rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11859">[ date ]</a>
              <a href="thread.html#11859">[ thread ]</a>
              <a href="subject.html#11859">[ subject ]</a>
              <a href="author.html#11859">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
