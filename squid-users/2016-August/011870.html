<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Inconsistent Cache Peer Selection in Accelerator mode	- Squid 3.3.8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Inconsistent%20Cache%20Peer%20Selection%20in%20Accelerator%20mode%0A%09-%20Squid%203.3.8&In-Reply-To=%3C46d669f7-9c47-f2a7-e48b-a096c465162f%40endpoint.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011901.html">
   <LINK REL="Next"  HREF="011871.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Inconsistent Cache Peer Selection in Accelerator mode	- Squid 3.3.8</H1>
    <B>Adam Vollrath</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Inconsistent%20Cache%20Peer%20Selection%20in%20Accelerator%20mode%0A%09-%20Squid%203.3.8&In-Reply-To=%3C46d669f7-9c47-f2a7-e48b-a096c465162f%40endpoint.com%3E"
       TITLE="[squid-users] Inconsistent Cache Peer Selection in Accelerator mode	- Squid 3.3.8">adam at endpoint.com
       </A><BR>
    <I>Thu Aug 11 18:25:04 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011901.html">[squid-users] How can I complete this tutorial?
</A></li>
        <LI>Next message (by thread): <A HREF="011871.html">[squid-users] Inconsistent Cache Peer Selection in Accelerator	mode - Squid 3.3.8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11870">[ date ]</a>
              <a href="thread.html#11870">[ thread ]</a>
              <a href="subject.html#11870">[ subject ]</a>
              <a href="author.html#11870">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good afternoon! I'm configuring Squid 3.3.8 on Ubuntu 14.04.5 LTS.  It's
in reverse proxy mode and has some explicit peers specified.  My issue
is that sometimes requests get forwarded to that specified peer, but
sometimes squid just forwards directly itself.

`squid.conf` has these lines:

http_port 127.0.1.2:80 accel ignore-cc act-as-origin allow-direct

cache_peer localhost parent 9900 0 no-query no-digest no-netdb-exchange
originserver name=example

cache_peer_domain example foo.example.com

Just after squid restarts, this all works as desired: Requests for
`foo.example.com` are forwarded to `localhost:9900`.  But after some
idle time, squid routes requests directly to `foo.example.com`,
bypassing `localhost:9900`.  I don't see any changes in the cache log.

How exactly does squid select upstream peers while in Accelerator mode?

Can I prevent it from forwarding requests directly?

Thank y'all for your time,
Adam Vollrath
End Point
<A HREF="http://www.endpoint.com">http://www.endpoint.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011901.html">[squid-users] How can I complete this tutorial?
</A></li>
	<LI>Next message (by thread): <A HREF="011871.html">[squid-users] Inconsistent Cache Peer Selection in Accelerator	mode - Squid 3.3.8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11870">[ date ]</a>
              <a href="thread.html#11870">[ thread ]</a>
              <a href="subject.html#11870">[ subject ]</a>
              <a href="author.html#11870">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
