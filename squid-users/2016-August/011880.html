<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] large downloads got interrupted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20large%20downloads%20got%20interrupted&In-Reply-To=%3Cb76a57b1-39f9-8db2-01d8-bda4a936bbe7%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011861.html">
   <LINK REL="Next"  HREF="011863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] large downloads got interrupted</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20large%20downloads%20got%20interrupted&In-Reply-To=%3Cb76a57b1-39f9-8db2-01d8-bda4a936bbe7%40treenet.co.nz%3E"
       TITLE="[squid-users] large downloads got interrupted">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Aug 12 06:51:03 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011861.html">[squid-users] large downloads got interrupted
</A></li>
        <LI>Next message (by thread): <A HREF="011863.html">[squid-users] Large memory leak with ssl_peek (now partly	understood)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11880">[ date ]</a>
              <a href="thread.html#11880">[ thread ]</a>
              <a href="subject.html#11880">[ subject ]</a>
              <a href="author.html#11880">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/08/2016 11:17 p.m., Eugene M. Zheganin wrote:
&gt;<i> Hi.
</I>&gt;<i> 
</I>&gt;<i> On 30.06.16 17:19, Amos Jeffries wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Okay, I wasn't suggesting you post it here. Its likely to be too big for
</I>&gt;&gt;<i> that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would look for the messages about the large object, and its FD. Then,
</I>&gt;&gt;<i> for anthing about why it was closed by Squid. Not sure what tha would be
</I>&gt;&gt;<i> at this point though.
</I>&gt;&gt;<i> There are some scripts in the Squid sources scripts/ directory that
</I>&gt;&gt;<i> might help wade through the log. Or the grep tool.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> I enabled logLevel 2 for all squid facilities, but so far I didn't
</I>&gt;<i> fugura out any pattern from log. The only thing I noticed - is that for
</I>&gt;<i> large download the Recv-Q value reported by the netstat for a particular
</I>&gt;<i> squid-to-server connection is extremely high, so is the Send-Q value for
</I>&gt;<i> a connection from squid to client. I don't know if it's a cause or a
</I>&gt;<i> consequence, but from my point of view this may indicate that buffers
</I>&gt;<i> are overflown for some reason, I think this may cause, in turn, RSTs and
</I>&gt;<i> connection closing - am I right ?. I still don't know whether it's a
</I>&gt;<i> squid fault of may be it's local OS misconfiguration.
</I>
Er. That indicates buffers are probably full, but not necessarily overflown.

If the Send-Q is high that means the client is not reading what Squid
has sent. If the client stays hung like that for too long (15min IIRC)
Squid will give up on it and close the connections so it can move on to
handle other more responsive clients. TCP has a much shorter timeout
than Squid, so it may not be Squid aborting, but the TCP stack. Either
way its for the same reason - client is not read(2)'ing the traffic.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011861.html">[squid-users] large downloads got interrupted
</A></li>
	<LI>Next message (by thread): <A HREF="011863.html">[squid-users] Large memory leak with ssl_peek (now partly	understood)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11880">[ date ]</a>
              <a href="thread.html#11880">[ thread ]</a>
              <a href="subject.html#11880">[ subject ]</a>
              <a href="author.html#11880">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
