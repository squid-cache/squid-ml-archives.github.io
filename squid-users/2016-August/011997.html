<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid cpu usage 100% from few days ago !!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20cpu%20usage%20100%25%20from%20few%20days%20ago%20%21%21&In-Reply-To=%3C024101d1f88c%2482aed1e0%24880c75a0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011990.html">
   <LINK REL="Next"  HREF="012000.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid cpu usage 100% from few days ago !!</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20cpu%20usage%20100%25%20from%20few%20days%20ago%20%21%21&In-Reply-To=%3C024101d1f88c%2482aed1e0%24880c75a0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid cpu usage 100% from few days ago !!">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Aug 17 13:37:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011990.html">[squid-users] Squid cpu usage 100% from few days ago !!
</A></li>
        <LI>Next message (by thread): <A HREF="012000.html">[squid-users] Squid cpu usage 100% from few days ago !!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11997">[ date ]</a>
              <a href="thread.html#11997">[ thread ]</a>
              <a href="subject.html#11997">[ subject ]</a>
              <a href="author.html#11997">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Antony!
It kind of disappeared from my mind\eyes despite to the fact that it's there.

Omid,
You are right about the expectation from a software to be polished.
I am with you on this but naturally port 80 should be used for http in a world which everybody obeys the holy RFC's.
There are couple options on how to resolve the issue but non of them are easy to put in production.

Amos can say what is to be expected from squid-4.
However I have it on my todo list to test the on_unsupported_protocol [<A HREF="http://www.squid-cache.org/Versions/v4/cfgman/on_unsupported_protocol.html">http://www.squid-cache.org/Versions/v4/cfgman/on_unsupported_protocol.html</A>] with hope it will give you and many others the right solution to weird scenarios.
Currently I do not have enough options\sites to test the issue also I am not sure about the expected result in a case of websockets.
I have compiled squid-4 but it will take me a bit more time to test over and over again.
If you have any suggestion on how to actually test this issue I would be happy to test the subject.
Currently my test lab is composed of:
- CentOS\Fedora\Ubuntu Intercept router
- Windows 7\8\10 Client
- Debian\Ubuntu\Fedora\CentOS\OpenSuse client
- Customized tcp service on port 80 which can serve both http and couple other protocols

Let me know about how I can verify the issue.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Antony Stone
Sent: Wednesday, August 17, 2016 12:04 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid cpu usage 100% from few days ago !!

On Wednesday 17 August 2016 at 11:01:40, Eliezer Croitoru wrote:

&gt;<i> Hey Omid,
</I>&gt;<i> 
</I>&gt;<i> Just to understand, are you intercepting traffic?
</I>
&gt;<i>From the original report: &quot;Squid is in tproxy mode with routing&quot;
</I>

Antony.

&gt;<i> -----Original Message-----
</I>&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] 
</I>&gt;<i> On Behalf Of Omid Kosari Sent: Wednesday, August 17, 2016 8:04 AM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Squid cpu usage 100% from few days ago !!
</I>&gt;<i> 
</I>&gt;<i> Even one ip address with less than 5 requests per second can grow 
</I>&gt;<i> squid cpu usage up to 30% . And 10 requests per second made 100% cpu 
</I>&gt;<i> usage . While there is nothing other than that client goes through 
</I>&gt;<i> squid . The client bandwidth is less than 10Kbps .
</I>&gt;<i> 
</I>&gt;<i> Isn't it crazy also ?
</I>
--
Salad is what food eats.

                                                   Please reply to the list;
                                                         please *don't* CC me.
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011990.html">[squid-users] Squid cpu usage 100% from few days ago !!
</A></li>
	<LI>Next message (by thread): <A HREF="012000.html">[squid-users] Squid cpu usage 100% from few days ago !!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11997">[ date ]</a>
              <a href="thread.html#11997">[ thread ]</a>
              <a href="subject.html#11997">[ subject ]</a>
              <a href="author.html#11997">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
