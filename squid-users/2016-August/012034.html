<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Checking SSL bump status in http_access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Checking%20SSL%20bump%20status%20in%20http_access&In-Reply-To=%3C542c8640-b0ba-c86a-99c3-e2b982502343%40opendium.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012015.html">
   <LINK REL="Next"  HREF="012044.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Checking SSL bump status in http_access</H1>
    <B>Steve Hill</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Checking%20SSL%20bump%20status%20in%20http_access&In-Reply-To=%3C542c8640-b0ba-c86a-99c3-e2b982502343%40opendium.com%3E"
       TITLE="[squid-users] Checking SSL bump status in http_access">steve at opendium.com
       </A><BR>
    <I>Thu Aug 18 09:18:35 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012015.html">[squid-users] Checking SSL bump status in http_access
</A></li>
        <LI>Next message (by thread): <A HREF="012044.html">[squid-users] Checking SSL bump status in http_access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12034">[ date ]</a>
              <a href="thread.html#12034">[ thread ]</a>
              <a href="subject.html#12034">[ subject ]</a>
              <a href="author.html#12034">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 17/08/16 17:18, Alex Rousskov wrote:

&gt;<i> This configuration problem should be at least partially addressed by the
</I>&gt;<i> upcoming annotate_transaction ACLs inserted into ssl_bump rules:
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html">http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html</A>
</I>
That looks good.  When implementing this, beware the note in comment 3 
of bug 4340: <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4340#c3">http://bugs.squid-cache.org/show_bug.cgi?id=4340#c3</A>
&quot;for transparent connections, the NotePairs instance used during the 
step-1 ssl_bump ACL is not the same as the instance used during the 
http_access ACL, but for non-transparent connections they are the same 
instance.  The upshot is that any notes set by an external ACL when 
processing the ssl_bump ACL during step 1 are discarded when handling 
transparent connections.&quot;  - It would greatly reduce the functionality 
of your proposed ACLs if the annotations were sometimes discarded part 
way through a connection or request.

Something I've been wanting to do for a while is attach a unique 
&quot;connection ID&quot; and &quot;request ID&quot; to requests so that:
1. An ICAP server can make decisions about the connection (e.g. how to 
authenticate, whether to bump, etc.) and then refer back to the data it 
knows/generated about the connection when it processes the requests 
contained within that connection.
2. When multiple ICAP requests will be generated, they can be linked 
together by the ICAP server - e.g. where a single request will generate 
a REQMOD followed by a RESPMOD it would be good for the ICAP server to 
know which REQMOD and RESPMOD relate to the same request.

It sounds like your annotations plan may address this to some extent. 
(We can probably already do some of this by having the ICAP server 
generate unique IDs and store them in ICAP headers to be passed along 
with the request, but I think the bug mentioned above would cause those 
headers to be discarded mid-request in some cases)

-- 
  - Steve Hill
    Technical Director
    Opendium    Online Safety / Web Filtering    <A HREF="http://www.opendium.com">http://www.opendium.com</A>

    Enquiries                 Support
    ---------                 -------
    <A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>        <A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>
    +44-1792-824568           +44-1792-825748

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012015.html">[squid-users] Checking SSL bump status in http_access
</A></li>
	<LI>Next message (by thread): <A HREF="012044.html">[squid-users] Checking SSL bump status in http_access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12034">[ date ]</a>
              <a href="thread.html#12034">[ thread ]</a>
              <a href="subject.html#12034">[ subject ]</a>
              <a href="author.html#12034">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
