<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Malformed HTTP on tproxy squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Malformed%20HTTP%20on%20tproxy%20squid&In-Reply-To=%3C1471519152724-4679009.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012048.html">
   <LINK REL="Next"  HREF="011979.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Malformed HTTP on tproxy squid</H1>
    <B>Omid Kosari</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Malformed%20HTTP%20on%20tproxy%20squid&In-Reply-To=%3C1471519152724-4679009.post%40n4.nabble.com%3E"
       TITLE="[squid-users] Malformed HTTP on tproxy squid">omidkosari at yahoo.com
       </A><BR>
    <I>Thu Aug 18 11:19:12 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012048.html">[squid-users] Malformed HTTP on tproxy squid
</A></li>
        <LI>Next message (by thread): <A HREF="011979.html">[squid-users] Linux Youtube video Rate limiting script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12035">[ date ]</a>
              <a href="thread.html#12035">[ thread ]</a>
              <a href="subject.html#12035">[ subject ]</a>
              <a href="author.html#12035">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Amos Jeffries wrote
&gt;<i> About the only thing you could do to speed it up is locate the error
</I>&gt;<i> page templates (file paths: en/ERR_INVALID_REQ and
</I>&gt;<i> templates/ERR_INVALID_REQ) and remove their contents. Then restart Squid.
</I>&gt;<i> That should remove at least a few of the vprintf() syscalls that your
</I>&gt;<i> earlier trace showed as being a significant source of CPU load.
</I>
Fine. This resolved the problem .
Thanks


samples  %        image name               symbol name
190728   34.3901  squid                    /usr/sbin/squid
26003     4.6886  r8169                    /r8169
22958     4.1396  libc-2.23.so             _int_malloc
13812     2.4904  nf_conntrack             /nf_conntrack
11146     2.0097  libc-2.23.so             re_search_internal
11044     1.9913  libc-2.23.so             _int_free
8748      1.5774  libstdc++.so.6.0.21     
/usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.21
7240      1.3054  reiserfs                 /reiserfs
6087      1.0975  libc-2.23.so             malloc_consolidate
5850      1.0548  libc-2.23.so             malloc
4840      0.8727  libc-2.23.so             vfprintf
4468      0.8056  ip_tables                /ip_tables
4423      0.7975  libm-2.23.so             __ieee754_log_avx
4364      0.7869  libc-2.23.so             __memcpy_sse2_unaligned
3935      0.7095  kallsyms                 sys_epoll_ctl
3929      0.7084  libc-2.23.so             free
3829      0.6904  libc-2.23.so             build_upper_buffer
3562      0.6423  kallsyms                 __fget
3413      0.6154  kallsyms                 copy_user_generic_string
3169      0.5714  libc-2.23.so             calloc
2815      0.5076  kallsyms                 delay_tsc
2767      0.4989  kallsyms                 csum_partial_copy_generic
2739      0.4939  kallsyms                 tcp_sendmsg
2454      0.4425  kallsyms                 memcpy
2192      0.3952  libc-2.23.so             _wordcopy_fwd_dest_aligned
2139      0.3857  kallsyms                 _raw_spin_lock_irqsave
2108      0.3801  kallsyms                 _raw_spin_lock
2075      0.3741  kallsyms                 nf_iterate
1916      0.3455  libc-2.23.so             __memset_sse2
1900      0.3426  [vdso] (tgid:12101 range:0x7fff9fbca000-0x7fff9fbcbfff)
[vdso] (tgid:12101 range:0x7fff9fbca000-0x7fff9fbcbfff
)
1842      0.3321  libc-2.23.so             __strcmp_sse2_unaligned
1794      0.3235  kallsyms                 sock_poll
1753      0.3161  libc-2.23.so             strlen
1702      0.3069  kallsyms                 entry_SYSCALL_64_after_swapgs
1618      0.2917  kallsyms                 tcp_poll
1611      0.2905  kallsyms                 irq_entries_start
1593      0.2872  kallsyms                 ep_send_events_proc
1567      0.2825  kallsyms                 ___slab_alloc
1539      0.2775  kallsyms                 __local_bh_enable_ip
1523      0.2746  nf_conntrack_ipv4        /nf_conntrack_ipv4
1467      0.2645  libc-2.23.so             re_string_reconstruct
1455      0.2624  kallsyms                 tcp_transmit_skb
1425      0.2569  nf_nat_ipv4              /nf_nat_ipv4
1366      0.2463  kallsyms                 _raw_spin_lock_bh
1333      0.2404  kallsyms                 __alloc_skb
1319      0.2378  kallsyms                 mutex_spin_on_owner.isra.3
1313      0.2367  kallsyms                 tcp_recvmsg
1307      0.2357  kallsyms                 tcp_write_xmit
1279      0.2306  kallsyms                 __fget_light
1266      0.2283  libc-2.23.so             __memmove_sse2
1234      0.2225  libnettle.so.6.2        
/usr/lib/x86_64-linux-gnu/libnettle.so.6.2
1202      0.2167  kallsyms                 __inet_lookup_established
1177      0.2122  kallsyms                 __lock_text_start
1116      0.2012  kallsyms                 common_file_perm
1080      0.1947  kallsyms                 tcp_ack
1075      0.1938  kallsyms                 tcp_clean_rtx_queue
1046      0.1886  kallsyms                 tcp_v4_rcv





--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Malformed-HTTP-on-tproxy-squid-tp4678951p4679009.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Malformed-HTTP-on-tproxy-squid-tp4678951p4679009.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012048.html">[squid-users] Malformed HTTP on tproxy squid
</A></li>
	<LI>Next message (by thread): <A HREF="011979.html">[squid-users] Linux Youtube video Rate limiting script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12035">[ date ]</a>
              <a href="thread.html#12035">[ thread ]</a>
              <a href="subject.html#12035">[ subject ]</a>
              <a href="author.html#12035">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
