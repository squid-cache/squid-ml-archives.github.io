<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Checking SSL bump status in http_access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Checking%20SSL%20bump%20status%20in%20http_access&In-Reply-To=%3C1b7cea2f-203c-6390-b50d-d8a52c0bcefc%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012034.html">
   <LINK REL="Next"  HREF="012045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Checking SSL bump status in http_access</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Checking%20SSL%20bump%20status%20in%20http_access&In-Reply-To=%3C1b7cea2f-203c-6390-b50d-d8a52c0bcefc%40measurement-factory.com%3E"
       TITLE="[squid-users] Checking SSL bump status in http_access">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Aug 18 14:54:36 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012034.html">[squid-users] Checking SSL bump status in http_access
</A></li>
        <LI>Next message (by thread): <A HREF="012045.html">[squid-users] Checking SSL bump status in http_access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12044">[ date ]</a>
              <a href="thread.html#12044">[ thread ]</a>
              <a href="subject.html#12044">[ subject ]</a>
              <a href="author.html#12044">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/18/2016 03:18 AM, Steve Hill wrote:
&gt;<i> On 17/08/16 17:18, Alex Rousskov wrote:
</I>&gt;&gt;<i> This configuration problem should be at least partially addressed by the
</I>&gt;&gt;<i> upcoming annotate_transaction ACLs inserted into ssl_bump rules:
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html">http://lists.squid-cache.org/pipermail/squid-dev/2016-July/006146.html</A>
</I>
&gt;<i> <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4340#c3">http://bugs.squid-cache.org/show_bug.cgi?id=4340#c3</A>
</I>&gt;<i> any notes set by an external ACL when
</I>&gt;<i> processing the ssl_bump ACL during step 1 are discarded when handling
</I>&gt;<i> transparent connections.
</I>
Annotations lifetime is a different problem IMO. If somebody needs
[more] connection annotations, they should extend existing clt_conn_tag
support to arbitrary key=value pairs, probably by adding a configuration
option that names connection-scope keys.

If somebody needs a third annotation lifetime scope, they should propose
to add support for it. For example:

1. Supported: HTTP request (including fake CONNECTs);
2. Supported: Client connection;
3. Proposed:  Compound transaction (e.g., all authenticatING requests
plus the first authenticatED request that follows them; all fake
CONNECTs plus the first bumped HTTP request that follows them).

Needless to say, compelling use cases must be presented to justify this
addition/complication along with a firm definition of which individual
transactions belong to the new scope, keeping the &quot;HTTP is stateless&quot;
mantra in mind.


&gt;<i> It would greatly reduce the functionality
</I>&gt;<i> of your proposed ACLs if the annotations were sometimes discarded part
</I>&gt;<i> way through a connection or request.
</I>
This is a separate issue, but annotations set by annotate_client ACL
will persist for the client connection lifetime and annotations set by
annotate_transaction ACL will persist for the transaction lifetime
(e.g., a single fake CONNECT request). See above if you need a
different/new lifetime scope. I recommend avoiding the term &quot;request&quot;
for labeling that new scope even if it is convenient for you to think of
all fake CONNECT requests as a single request.


&gt;<i> Something I've been wanting to do for a while is attach a unique
</I>&gt;<i> &quot;connection ID&quot; and &quot;request ID&quot; to requests
</I>
Yes, we already do that (in clients and servers) for testing purposes.
And some adaptation services do that to match responses with requests,
as you have mentioned. Adding that support to Squid would be a useful
feature. Official support must account for SMP needs and restarts, but
it is certainly doable.


Cheers,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012034.html">[squid-users] Checking SSL bump status in http_access
</A></li>
	<LI>Next message (by thread): <A HREF="012045.html">[squid-users] Checking SSL bump status in http_access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12044">[ date ]</a>
              <a href="thread.html#12044">[ thread ]</a>
              <a href="subject.html#12044">[ subject ]</a>
              <a href="author.html#12044">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
