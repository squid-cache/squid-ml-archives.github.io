<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Samba 4 and ntlm_auth concurrency question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Samba%204%20and%20ntlm_auth%20concurrency%20question&In-Reply-To=%3C71dcc4cd-f245-8a00-c1e8-14e1972d37f3%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012081.html">
   <LINK REL="Next"  HREF="012084.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Samba 4 and ntlm_auth concurrency question</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Samba%204%20and%20ntlm_auth%20concurrency%20question&In-Reply-To=%3C71dcc4cd-f245-8a00-c1e8-14e1972d37f3%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid Samba 4 and ntlm_auth concurrency question">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Aug 21 13:15:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012081.html">[squid-users] Squid Samba 4 and ntlm_auth concurrency question
</A></li>
        <LI>Next message (by thread): <A HREF="012084.html">[squid-users] dubt about kerberos authentication in the Squid 3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12086">[ date ]</a>
              <a href="thread.html#12086">[ thread ]</a>
              <a href="subject.html#12086">[ subject ]</a>
              <a href="author.html#12086">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/08/2016 1:34 a.m., David Webb wrote:
&gt;<i> 
</I>&gt;<i> I'm currently using the binary version of squid provided by yum with
</I>&gt;<i> RHEL 7.2  (3.3.8) with Samba 4's  winbind ntlm_auth to authenticate
</I>&gt;<i> against AD which is working fine
</I>&gt;<i> 
</I>&gt;<i> auth_param negotiate program /usr/bin/ntlm_auth
</I>&gt;<i> --helper-protocol=gss-spnego
</I>&gt;<i> auth_param negotiate children 250  startup=2 idle=1
</I>&gt;<i> auth_param negotiate keep_alive off
</I>&gt;<i> #
</I>&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth
</I>&gt;<i> --helper-protocol=squid-2.5-ntlmssp
</I>&gt;<i> auth_param ntlm children 250  startup=2 idle=1
</I>&gt;<i> auth_param ntlm keep_alive off
</I>&gt;<i> #
</I>&gt;<i> 
</I>&gt;<i> However I'm wondering if I can reduce the number of  ntlm_auth processes
</I>&gt;<i> created by introducing some concurrency.
</I>&gt;<i> 
</I>&gt;<i> I've seen mention of helper-mux.pl but from what I've seen on the web
</I>&gt;<i> I'm not sure if this will work with negotiate and ntlm.
</I>&gt;<i> Also it  looks like in the future with Squid 4  helper-mux.pl is being
</I>&gt;<i> retired.
</I>
Should not be. The use cases and need for it still exists. The way it
works needs to be completely different for the new ID numbering scheme
is all. So the Squid-3 version of the helper is not forward-compatible.

The Squid-4 helper should work** in any Squid version still. If its not
working that is a bug in Squid-4 we want to hear about.

** except on Logging, pinger, NTLM and Negotiate helper interfaces.


&gt;<i> I've also seen some mention of Samba 4 building in some concurrency
</I>&gt;<i> itself into ntlm_auth but I'm not sure that this is fully supported.
</I>&gt;<i> 
</I>&gt;<i> So my question is what is the current state of play for squid 3.x (and
</I>&gt;<i> upcoming squid 4) with respect to negotiate and ntlm concurrency with
</I>&gt;<i> samba4 ?
</I>
Squid does not support concurrency in the NTLM and Negotiate helper API
lookups. The helpers apparently do, but Squid wont do it. Not even
enough to experiment with yet.

NTLM has been deprecated for 10 years now (as of this month IIRC). You
should really not have many (or any) Windows 95/98/2k clients needing to
use it. Yes, even XP supports Kerberos.

The only way to reduce load with NTLM is to enable persistent HTTP
connections to clients (and servers where possible) - unrelated to that
&quot;keep_alive off&quot; setting. The more requests your clients can make on a
single connection without having to re-authenticate from scratch the
better. This also helps with Kerberos auth load as they upgrade.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012081.html">[squid-users] Squid Samba 4 and ntlm_auth concurrency question
</A></li>
	<LI>Next message (by thread): <A HREF="012084.html">[squid-users] dubt about kerberos authentication in the Squid 3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12086">[ date ]</a>
              <a href="thread.html#12086">[ thread ]</a>
              <a href="subject.html#12086">[ subject ]</a>
              <a href="author.html#12086">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
