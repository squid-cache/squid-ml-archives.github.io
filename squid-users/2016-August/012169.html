<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ext_kerberos_ldap_group_acl problem (Solved for me for now)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ext_kerberos_ldap_group_acl%20problem%20%28Solved%20for%0A%20me%20for%20now%29&In-Reply-To=%3Cvmime.57bef4be.3047.776bbd3242521d9e%40ms249-lin-003.rotterdam.bazuin.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012164.html">
   <LINK REL="Next"  HREF="012211.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ext_kerberos_ldap_group_acl problem (Solved for me for now)</H1>
    <B>L.P.H. van Belle</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ext_kerberos_ldap_group_acl%20problem%20%28Solved%20for%0A%20me%20for%20now%29&In-Reply-To=%3Cvmime.57bef4be.3047.776bbd3242521d9e%40ms249-lin-003.rotterdam.bazuin.nl%3E"
       TITLE="[squid-users] ext_kerberos_ldap_group_acl problem (Solved for me for now)">belle at bazuin.nl
       </A><BR>
    <I>Thu Aug 25 13:38:06 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012164.html">[squid-users] ext_kerberos_ldap_group_acl problem
</A></li>
        <LI>Next message (by thread): <A HREF="012211.html">[squid-users] ext_kerberos_ldap_group_acl problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12169">[ date ]</a>
              <a href="thread.html#12169">[ thread ]</a>
              <a href="subject.html#12169">[ subject ]</a>
              <a href="author.html#12169">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, found it. 

&#160;

So a resume for a squid 3.5.19 + samba 4.4.5, kerberos auth and kerberos groups on debian jessie. 

&#160;

By default the package libsasl2-modules-gssapi-mit&#160; was not installed. &#160;

So i installed it:&#160; apt-get install libsasl2-modules-gssapi-mit

I always install with, --no-install-recommends, here i missed this package. 

&#160;

After installing it works fine, at least, ..&#160; 

&#160;

This works : (SASL/GSSAPI over port 389) &#160;

/usr/lib/squid3/ext_kerberos_ldap_group_acl -g <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A>&#160; -D REALM&#160; -N <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A> 

&#160;

But with ssl enabled.. 

SASL/GSSAPI over port 636 (ldaps)

/usr/lib/squid3/ext_kerberos_ldap_group_acl -g <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A>&#160; -D REALM&#160; -N <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A> &#8211;s 

Or .. 

SASL/GSSAPI over port 636 (ldaps) without cert checks. &#160;

/usr/lib/squid3/ext_kerberos_ldap_group_acl -g <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A>&#160; -D REALM&#160; -N <A HREF="https://lists.squid-cache.org/listinfo/squid-users">group-mail at REALM</A> &#8211;s &#8211;a

&#160;

And with also tried adding this to the /etc/default/squid 

TLS_CACERTFILE=/etc/ssl/certs/ca-certificates.crt

export TLS_CACERTFILE

&#160;

And adding the _ldaps_._tcp records the samba4/bind_dlz dns didnt help. 

(samba-tool dns add ADDC.FQDN REALM _ldaps._tcp SRV &#160;'host.internal.domain.tld 636 0 100') 

&#160;

The log part of the remaining errors. &#160;

But no need to fix this for me, im putting this here so people can find it as reference. 

&#160;

DEBUG: Set SSL defaults

DEBUG: Disable server certificate check for ldap server.

ERROR: Error while setting start_tls for ldap server: Operations error

DEBUG: Bind to ldap server with SASL/GSSAPI

ERROR: ldap_sasl_interactive_bind_s error: Strong(er) authentication required

ERROR: Error while binding to ldap server with SASL/GSSAPI: Strong(er) authentication required

DEBUG: Setting up connection to ldap server hostname.internal.domain.tld:636

DEBUG: Set SSL defaults

DEBUG: Disable server certificate check for ldap server.

ERROR: Error while setting start_tls for ldap server: Operations error

DEBUG: Bind to ldap server with SASL/GSSAPI

ERROR: ldap_sasl_interactive_bind_s error: Strong(er) authentication required

&#160;

And if someone find the solution for this above, that would be nice to report here. 

&#160;

&#160;

Greetz, 

&#160;

Louis

&#160;

&#160;

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160825/4e60fa0b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160825/4e60fa0b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012164.html">[squid-users] ext_kerberos_ldap_group_acl problem
</A></li>
	<LI>Next message (by thread): <A HREF="012211.html">[squid-users] ext_kerberos_ldap_group_acl problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12169">[ date ]</a>
              <a href="thread.html#12169">[ thread ]</a>
              <a href="subject.html#12169">[ subject ]</a>
              <a href="author.html#12169">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
