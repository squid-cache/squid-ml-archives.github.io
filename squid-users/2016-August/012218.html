<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache object with vary
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20object%20with%20vary&In-Reply-To=%3C1472345785055-4679220.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012229.html">
   <LINK REL="Next"  HREF="012226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache object with vary</H1>
    <B>joe</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache%20object%20with%20vary&In-Reply-To=%3C1472345785055-4679220.post%40n4.nabble.com%3E"
       TITLE="[squid-users] cache object with vary">chip_pop at hotmail.com
       </A><BR>
    <I>Sun Aug 28 00:56:25 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012229.html">[squid-users] squid with random outgoing ip from pool of 1000	ips
</A></li>
        <LI>Next message (by thread): <A HREF="012226.html">[squid-users] cache object with vary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12218">[ date ]</a>
              <a href="thread.html#12218">[ thread ]</a>
              <a href="subject.html#12218">[ subject ]</a>
              <a href="author.html#12218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>is this bug or its made to work like that
lets say we have object in cache name 000000A5
url.com/some.js
vary=accept-encoding=&quot;gzip&quot;

if some browser get the same object
url.com/some.js
vary=accept-encoding=&quot;deflate&quot;

the md5 key wont match and it delete the old cached object with
accept-encoding=&quot;gzip&quot; and replace with
new one with vary=accept-encoding=&quot;deflate&quot; and prosess as TCP_MISS

that will result in &quot;varyEvaluateMatch: Oops. Not a Vary match on second
attempt
no match and the code in client_side.cc
return VARY_CANCEL

and in client_side_reply.cc

    case VARY_CANCEL:
        /* varyEvaluateMatch found a object loop. Process as miss */
        debugs(88, DBG_IMPORTANT, &quot;clientProcessHit: Vary object loop!&quot;);
        http-&gt;logType = LOG_TCP_MISS; // we lack a more precise LOG_*_MISS
code
        processMiss();
        return;

the way it should be instead of replacing the existing obj  should be
another object with the 
new vary
shuld be 2 file 000000A5
and    000000A6     example each one has different vary to match the correct
obj if its gzip or ident or deflate or with useragent
wen vary not matching shuld be new obj file to be saved as diferent cache
name 000000A7
so it match the correct object name with its vary





--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/cache-object-with-vary-tp4679220.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/cache-object-with-vary-tp4679220.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012229.html">[squid-users] squid with random outgoing ip from pool of 1000	ips
</A></li>
	<LI>Next message (by thread): <A HREF="012226.html">[squid-users] cache object with vary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12218">[ date ]</a>
              <a href="thread.html#12218">[ thread ]</a>
              <a href="subject.html#12218">[ subject ]</a>
              <a href="author.html#12218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
