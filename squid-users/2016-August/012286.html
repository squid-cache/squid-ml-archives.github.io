<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_TUNNEL_ABORTED/200?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_TUNNEL_ABORTED/200%3F&In-Reply-To=%3Ca2986a53-3256-0ae0-ca82-5963c43d4d43%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012277.html">
   <LINK REL="Next"  HREF="012285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_TUNNEL_ABORTED/200?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_TUNNEL_ABORTED/200%3F&In-Reply-To=%3Ca2986a53-3256-0ae0-ca82-5963c43d4d43%40measurement-factory.com%3E"
       TITLE="[squid-users] TCP_TUNNEL_ABORTED/200?">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Aug 31 15:53:22 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012277.html">[squid-users] TCP_TUNNEL_ABORTED/200?
</A></li>
        <LI>Next message (by thread): <A HREF="012285.html">[squid-users] TCP_TUNNEL_ABORTED/200?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12286">[ date ]</a>
              <a href="thread.html#12286">[ thread ]</a>
              <a href="subject.html#12286">[ subject ]</a>
              <a href="author.html#12286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/31/2016 08:25 AM, Amos Jeffries wrote:
&gt;<i> On 31/08/2016 8:20 p.m., Ralf Hildebrandt wrote:
</I>&gt;&gt;<i> I can't find anything on what exactly would cause a
</I>&gt;&gt;<i> &quot;TCP_TUNNEL_ABORTED/200&quot;
</I>
&gt;<i> A client that disconnects before the server has finished sending data,
</I>
If &quot;has finished sending&quot; means &quot;closed connection&quot;, then I do not think
that should trigger the _ABORTED suffix. If it does, it is a Squid bug
IMO. When tunneling, Squid should not assume that the server must close
the connection first.


&gt;<i> or before Squid has relayed the data it sent to the server.
</I>
That too should not trigger an _ABORTED suffix IMO, for similar reasons.
In general, nothing prevents Squid from relayed client data to the
server after the client has disconnected (or vice versa).


AFAICT, the tunnel code should add an _ABORTED suffix only if Squid has
data destined for an already closed connection. I did not check whether
the code actually obeys that, and the answer may be version-specific.

To make matters more complex, there are also so called half-closed TCP
connections. IIRC (and that is a big IF!), the tunneling code is one of
the areas where Squid does not handle them correctly. If my recollection
is correct, and the tunneled applications half-close, then Squid may
break those applications.


&gt;<i> The TUNNEL and 200 parts means Squid connected to the requested server.
</I>&gt;<i> The ABORTED that the client disconnected while tunnel data was still in
</I>&gt;<i> transit.
</I>
Agreed, provided &quot;data in transit&quot; means &quot;Squid-buffered bytes not yet
sent to that already-disconnected client&quot;.


Cheers,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012277.html">[squid-users] TCP_TUNNEL_ABORTED/200?
</A></li>
	<LI>Next message (by thread): <A HREF="012285.html">[squid-users] TCP_TUNNEL_ABORTED/200?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12286">[ date ]</a>
              <a href="thread.html#12286">[ thread ]</a>
              <a href="subject.html#12286">[ subject ]</a>
              <a href="author.html#12286">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
