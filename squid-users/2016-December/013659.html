<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] mangle ranges using ICAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20mangle%20ranges%20using%20ICAP&In-Reply-To=%3C54bed6ec-032c-7f73-7c87-592efd98126b%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013657.html">
   <LINK REL="Next"  HREF="013661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] mangle ranges using ICAP</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20mangle%20ranges%20using%20ICAP&In-Reply-To=%3C54bed6ec-032c-7f73-7c87-592efd98126b%40treenet.co.nz%3E"
       TITLE="[squid-users] mangle ranges using ICAP">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Dec  5 02:33:29 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013657.html">[squid-users] mangle ranges using ICAP
</A></li>
        <LI>Next message (by thread): <A HREF="013661.html">[squid-users] mangle ranges using ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13659">[ date ]</a>
              <a href="thread.html#13659">[ thread ]</a>
              <a href="subject.html#13659">[ subject ]</a>
              <a href="author.html#13659">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/12/2016 11:05 a.m., Alfredo Rezinovsky wrote:
&gt;<i> Let say a client asks for a URL using a range: 0-256000.
</I>&gt;<i> 
</I>&gt;<i> I want squid to ask just for 10.000 bytes and answer as if the request was
</I>&gt;<i> server side aborted.
</I>&gt;<i> 
</I>&gt;<i> I can change the request Range: &quot;bytes=0-256000&quot; to &quot;bytes=0-10000&quot; with
</I>&gt;<i> and icap server
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> In the answer I'm trying to change the Content-Range from &quot;0-10000/total&quot;
</I>&gt;<i> to &quot;0-256000/total&quot; and Content-Length from &quot;10001&quot; to &quot;256001&quot; squid won't
</I>&gt;<i> hung up and the client will stay waiting after the first 10001 bytes.
</I>&gt;<i> 
</I>&gt;<i> There's a way to make squid send what it gets from the icap and then drop
</I>&gt;<i> the TCP connection as in a server side aborted connection?
</I>

Squid is a network proxy for production use, not a piece of testing
software. To see what happens when a server disconnects early ... make
the server disconnect early.


There is also no relationship between client and server TCP connections
in HTTP proxying. And there is no server abort happening in your setup.
So the server abort handling is not going to happen. Period.


ICAP has told Squid there are 256000 bytes comming *from ICAP*, not from
any server. How those bytes are found/generated is not up to Squid.
Since ICAP only requested 10000 bytes from the server the rest is up to
the ICAP service to generate somehow. Squid is simply waiting for that
_ICAP_ transaction to complete.
 --&gt; What you are emulating is the handling of an ICAP service hanging.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013657.html">[squid-users] mangle ranges using ICAP
</A></li>
	<LI>Next message (by thread): <A HREF="013661.html">[squid-users] mangle ranges using ICAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13659">[ date ]</a>
              <a href="thread.html#13659">[ thread ]</a>
              <a href="subject.html#13659">[ subject ]</a>
              <a href="author.html#13659">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
