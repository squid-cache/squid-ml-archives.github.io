<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] HTTPS through http proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20through%20http%20proxy&In-Reply-To=%3C07f1fa27-abc1-53db-e819-75c1addcb62d%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013667.html">
   <LINK REL="Next"  HREF="013689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] HTTPS through http proxy</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20through%20http%20proxy&In-Reply-To=%3C07f1fa27-abc1-53db-e819-75c1addcb62d%40measurement-factory.com%3E"
       TITLE="[squid-users] HTTPS through http proxy">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Dec  5 20:11:38 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013667.html">[squid-users] HTTPS through http proxy
</A></li>
        <LI>Next message (by thread): <A HREF="013689.html">[squid-users] HTTPS through http proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13670">[ date ]</a>
              <a href="thread.html#13670">[ thread ]</a>
              <a href="subject.html#13670">[ subject ]</a>
              <a href="author.html#13670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/05/2016 10:40 AM, Blaxton wrote:

&gt;<i> I am using simple java app to test https connectivity through http proxy:
</I>&gt;<i> <A HREF="http://alvinalexander.com/blog/post/java/simple-https-example">http://alvinalexander.com/blog/post/java/simple-https-example</A>
</I>&gt;<i> 
</I>&gt;<i> If we run below command agains squid running on RedHat:
</I>&gt;<i> java -Dhttp.proxyHost=webcache.example.com -Dhttp.proxyPort=808
</I>&gt;<i> JavaHttpsExample
</I>&gt;<i> 
</I>&gt;<i> connection fails , and Squid log file won't even log any thing in log file.
</I>
If Squid does not listen on port 808 and the IP address(es) that
webcache.example.com resolves to, then what you observe is expected.


&gt;<i> but if we run:
</I>&gt;<i> 
</I>&gt;<i> java -Dhttps.proxyHost=webcache.example.com -Dhttps.proxyPort=8080
</I>&gt;<i> JavaHttpsExample
</I>&gt;<i> 
</I>&gt;<i> I get response and a line being recorded in log file.
</I>
If Squid listens on port 8080 and the IP address(es) that
webcache.example.com resolves to, then what you observe is expected.



&gt;<i> And now running the same app against different squid running on Centos,
</I>&gt;<i> I get response from both but nothing being logged with -Dhttp.proxyHost.
</I>
If you get a response from Squid and then terminate the connection to
Squid, then Squid should log something to its access.log file. There are
rare exceptions to that rule, but you are very unlikely to hit them with
a modern Squid version in such a simple test.


&gt;<i> If any one has any tips or any simple app to test different aspect of
</I>&gt;<i> https connectivity through squid please let me know.
</I>
I recommend the following initial tests:

1. ping the Squid listening IP address from the client box
2. telnet to the Squid listening port from the client box
3. use curl or wget on the client box to pass through Squid
4. Now it is time to test with a browser or some obscure Java app!

The step #2 (telnet) verifies TCP-level connectivity to the Squid
listening port. Typos like 808 instead of 8080 can be caught at this
stage. You should be able to connect to Squid, send some garbage input
in lieu of an encrypted HTTP request, and receive an error response (or
at least a connection termination) from Squid. However, some may
consider this telnet test to be too extreme for the 21st century.

In all these tests, in complex networking setups, you may have to tell
the test app to use the source IP address that the final/intended
application will use. It is usually not necessary though. Similarly,
some low-level tests cannot work in complex setups (e.g., something
between the client and Squid blocks non-SSL traffic), but they usually do.


If you cannot get curl or wget to work, then fiddling with some obscure
Java app is unlikely to speed up the triage. And if you can get them to
work, then you would have a working example to compare the app behavior
with.


If you continue to have problems, please do not forget to specify what
exactly you perceive the problem to be and exactly which logs you have
checked. Attaching Squid access.log entries and packet captures
(captured on the Squid box) often helps as well.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013667.html">[squid-users] HTTPS through http proxy
</A></li>
	<LI>Next message (by thread): <A HREF="013689.html">[squid-users] HTTPS through http proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13670">[ date ]</a>
              <a href="thread.html#13670">[ thread ]</a>
              <a href="subject.html#13670">[ subject ]</a>
              <a href="author.html#13670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
