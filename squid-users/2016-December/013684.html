<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_MISS/419
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/419&In-Reply-To=%3C58ee1d77-7cc6-4ead-2a9e-625b136ffd39%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013681.html">
   <LINK REL="Next"  HREF="013669.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_MISS/419</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/419&In-Reply-To=%3C58ee1d77-7cc6-4ead-2a9e-625b136ffd39%40treenet.co.nz%3E"
       TITLE="[squid-users] TCP_MISS/419">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Dec  6 14:22:19 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013681.html">[squid-users] TCP_MISS/419
</A></li>
        <LI>Next message (by thread): <A HREF="013669.html">[squid-users] IPv6 support for PF interception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13684">[ date ]</a>
              <a href="thread.html#13684">[ thread ]</a>
              <a href="subject.html#13684">[ subject ]</a>
              <a href="author.html#13684">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/12/2016 12:01 a.m., Ricardo Pardim Claus wrote:
&gt;<i> Dear Amos, 
</I>&gt;<i> Thanks for the initial contact. 
</I>&gt;<i> 
</I>&gt;<i> Now I'm getting an error message. 
</I>&gt;<i> I placed the domain in the allowed domain list. I still get the access denied message. 
</I>&gt;<i> Can you tell me why I'm getting this status code &quot;TCP_MISS / 403&quot;, which actually refers to &quot;Forbidden&quot;?
</I>&gt;<i> 
</I>
Because the client was forbidden to access those URLs at that time, in
that way, with the information in the request sent.


&gt;<i> In &quot;Squid Version 3.5.19&quot;, I have Squidguard running as well. In the logs I do not see anything that references the site in question. 
</I>&gt;<i> In Version 2.6.STABLE22, I have the Dansguardian running.
</I>

So you have a modern proxy with an obsolete traffic filtering plugin,
being compared with an obsolete Squid version chained end-to-end with an
unspecified version of another proxy software product.

What is the point?


&gt;<i> 
</I>&gt;<i> The following are performed only in Squid Version 3.5.19:
</I>&gt;<i> 
</I>&gt;<i> 1481019362.202      5 172.16.16.158 TCP_MISS/403 2836 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/">http://www3.centauroseg.com.br/centauroonline/</A> - HIER_DIRECT/172.16.16.7 text/html 
</I>&gt;<i> 1481019362.221      4 172.16.16.158 TCP_MISS/403 2828 GET <A HREF="http://www3.centauroseg.com.br/favicon.ico">http://www3.centauroseg.com.br/favicon.ico</A> - HIER_DIRECT/172.16.16.7 text/html 
</I>

The &quot;MISS&quot; part and the HEIR_DIRECT means almost certainly the response
was generated by the server. Though you could have configured that not
to be true.

Lacking any info about your software config (both Squid and everything
else plugged into it [squidguard]) that is the best anyone can say right
now.

The tool at redbot.org tells me there are 200 and 404 responses coming
out of the server now for those URLs.


&gt;<i> 
</I>&gt;<i> Squid Cache: Version 2.6.STABLE22 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 1481020252.226      0 172.16.16.158 TCP_OFFLINE_HIT/200 1017 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/login?UsrNome=05011810438502&amp;UsrSenha=Vm1wQmVGRXdNVlZWV0djOQ==">http://www3.centauroseg.com.br/centauroonline/servico/recurso/login?UsrNome=05011810438502&amp;UsrSenha=Vm1wQmVGRXdNVlZWV0djOQ==</A> - NONE/- application/json 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.226      0 172.16.16.158 TCP_OFFLINE_HIT/200 1017 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/login?UsrNome=05011810438502&amp;UsrSenha=Vm1wQmVGRXdNVlZWV0djOQ==">http://www3.centauroseg.com.br/centauroonline/servico/recurso/login?UsrNome=05011810438502&amp;UsrSenha=Vm1wQmVGRXdNVlZWV0djOQ==</A> - NONE/- application/json 
</I>&gt;<i> 1481020252.253     16 172.16.16.158 TCP_OFFLINE_HIT/200 768 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/permissoes?wUsrCodigo=113">http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/permissoes?wUsrCodigo=113</A> - NONE/- application/json 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.253     16 172.16.16.158 TCP_OFFLINE_HIT/200 768 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/permissoes?wUsrCodigo=113">http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/permissoes?wUsrCodigo=113</A> - NONE/- application/json 
</I>&gt;<i> 1481020252.274     20 172.16.16.158 TCP_OFFLINE_HIT/200 612 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/nomeUsuarioLogado?TabelaMaster=CADCOMISSIONADOS&amp;CodigoUsuario=45">http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/nomeUsuarioLogado?TabelaMaster=CADCOMISSIONADOS&amp;CodigoUsuario=45</A> - NONE/- application/json 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.274     20 172.16.16.158 TCP_OFFLINE_HIT/200 612 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/nomeUsuarioLogado?TabelaMaster=CADCOMISSIONADOS&amp;CodigoUsuario=45">http://www3.centauroseg.com.br/centauroonline/servico/recurso/relacao/nomeUsuarioLogado?TabelaMaster=CADCOMISSIONADOS&amp;CodigoUsuario=45</A> - NONE/- application/json 
</I>&gt;<i> 1481020252.350     19 172.16.16.158 TCP_IMS_HIT/304 351 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/images/linhaAcesso.png">http://www3.centauroseg.com.br/centauroonline/images/linhaAcesso.png</A> - NONE/- image/png 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.350     19 172.16.16.158 TCP_IMS_HIT/304 351 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/images/linhaAcesso.png">http://www3.centauroseg.com.br/centauroonline/images/linhaAcesso.png</A> - NONE/- image/png 
</I>&gt;<i> 1481020252.357      6 172.16.16.158 TCP_IMS_HIT/304 352 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/images/acessoCorretor.jpg">http://www3.centauroseg.com.br/centauroonline/images/acessoCorretor.jpg</A> - NONE/- image/jpeg 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.357      6 172.16.16.158 TCP_IMS_HIT/304 352 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/images/acessoCorretor.jpg">http://www3.centauroseg.com.br/centauroonline/images/acessoCorretor.jpg</A> - NONE/- image/jpeg 
</I>&gt;<i> 1481020252.377     19 172.16.16.158 TCP_IMS_HIT/304 363 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/fonts/Gotham/GothamBlack.woff">http://www3.centauroseg.com.br/centauroonline/fonts/Gotham/GothamBlack.woff</A> - NONE/- application/font-woff 
</I>&gt;<i> Dec  6 08:30:52 srv05 squid[17957]: 1481020252.377     19 172.16.16.158 TCP_IMS_HIT/304 363 GET <A HREF="http://www3.centauroseg.com.br/centauroonline/fonts/Gotham/GothamBlack.woff">http://www3.centauroseg.com.br/centauroonline/fonts/Gotham/GothamBlack.woff</A> - NONE/- application/font-woff 
</I>&gt;<i> 
</I>
Which if those lines is accessing the favicon.ico file ...

Consider:
&quot;
Grass in springtime is green if you go outside and look at it, but the
sky when looked at through a window is blue.

Do you believe there must be some problem with the window not making the
sky the same color as grass? just because the window exists?
&quot;

The log lines you are posting are all about different things, with no
overlap. Like sky compared to grass - they are simply different things
going on.


The proxy access.log is simply a statement of what happened. It does not
tell anyone the *why*. And nobody can do better than guesswork given
only log entries.


&gt;<i> 
</I>&gt;<i> See the logs when the failure occurs (when accessing the resource within the site, I'm redirected to the login page). 
</I>
4xx do not necessarily mean failure. They mean that the server needs the
client to send something different to get the resource at the URL being
requested. The value of the 4xx code and other details in the reply
indicate what needs to change (or may not).
 What you are calling a &quot;redirect&quot; seems to be in fact the payload of
the 419 message.

What you see in the logs appears to be how the website is designed to
operate. *Especially* since there are custom codes involved  The site
server is intentionally sending them. Both the 4xx code and the action
that happens because of that response are being forced by the server.



Squid-2.x is HTTP/1.0 software. It follows the RFC 1945 protocol. 2.6
follows some features of RFC 2616, but mostly not.

Squid-3.x is HTTP/1.1 software. It follows most of RFC 2616 and a few
bits of the new RFC 723x specifications.

Some things of the proxy behaviour is the same. But when the client and
server are both HTTP/1.1 as well the behaviour of 3.x can be very
different to Squid-2.x.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013681.html">[squid-users] TCP_MISS/419
</A></li>
	<LI>Next message (by thread): <A HREF="013669.html">[squid-users] IPv6 support for PF interception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13684">[ date ]</a>
              <a href="thread.html#13684">[ thread ]</a>
              <a href="subject.html#13684">[ subject ]</a>
              <a href="author.html#13684">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
