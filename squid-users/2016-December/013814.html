<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] sslpassword_program
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslpassword_program&In-Reply-To=%3C1482123577.4142040.823185569.4201259E%40webmail.messagingengine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013810.html">
   <LINK REL="Next"  HREF="013815.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] sslpassword_program</H1>
    <B>creditu at eml.cc</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslpassword_program&In-Reply-To=%3C1482123577.4142040.823185569.4201259E%40webmail.messagingengine.com%3E"
       TITLE="[squid-users] sslpassword_program">creditu at eml.cc
       </A><BR>
    <I>Mon Dec 19 04:59:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013810.html">[squid-users] sslpassword_program
</A></li>
        <LI>Next message (by thread): <A HREF="013815.html">[squid-users] sslpassword_program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13814">[ date ]</a>
              <a href="thread.html#13814">[ thread ]</a>
              <a href="subject.html#13814">[ subject ]</a>
              <a href="author.html#13814">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sun, Dec 18, 2016, at 01:21 PM, Michael Pelletier wrote:
&gt;<i> Check your file permissions on the key.
</I>&gt;<i> 
</I>&gt;<i> On Dec 18, 2016 2:13 PM, &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">creditu at eml.cc</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; I'm having trouble getting the sslpassword_program working for an
</I>&gt;<i> &gt; encrypted key.  Config looks like this:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; sslpassword_program /usr/local/bin/pass.sh
</I>&gt;<i> &gt; https_port 10.10.10.1:443 accel vhost cert=/etc/squid/www.crt
</I>&gt;<i> &gt; key=/etc/squid/private.key
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On start, cache log states &quot;Ignoring https_port 10.10.10.1:443 due to
</I>&gt;<i> &gt; SSL initialization failure.&quot;
</I>&gt;<i> &gt; On stop, console states &quot;Failed to acquire SSL private key
</I>&gt;<i> &gt; '/etc/squid/private.key': error:0200100D:system library:fopen:Permission
</I>&gt;<i> &gt; denied&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Removing the passphrase from the private key, squid starts normally.
</I>&gt;<i> &gt; Permissions on the encrypted and non-encrypted keys are the same.  I
</I>&gt;<i> &gt; also tried putting the pass.sh program in /bin.  The pass.sh program
</I>&gt;<i> &gt; looks like this:
</I>&gt;<i> &gt; #!/bin/sh
</I>&gt;<i> &gt; echo &quot;testing&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The hash of the private key modulus and the certificate modulus match as
</I>&gt;<i> &gt; well.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Am I missing something? This is on squid 3.1.
</I>&gt;<i> &gt; _______________________________________________
</I>
Checked the perms and they are identical as the private key that I
stripped the password out of.  They are also in the same directory.  The
one without a password works fine.  Also tried encrypting with des3
versus aes128 and that didn't make a difference either.   Gotta be
missing something.  The error points to a perms problem, but not seeing
how since everything is the same.  Also, added a line in the
sslpassword_program to touch a file to see if it got executed and it
didn't create the file. Additionally, ran the stat command on the 
/usr/local/bin/pass.sh after squid started up and the access time never
changes.  It seems like the shell script may not being executed for some
reason.  I'm able to launch the shell script from the command line and
it echos out the pass fine. 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013810.html">[squid-users] sslpassword_program
</A></li>
	<LI>Next message (by thread): <A HREF="013815.html">[squid-users] sslpassword_program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13814">[ date ]</a>
              <a href="thread.html#13814">[ thread ]</a>
              <a href="subject.html#13814">[ subject ]</a>
              <a href="author.html#13814">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
