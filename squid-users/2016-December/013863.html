<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Help: How to calculate all bytes when communicate with client for a request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%3A%20How%20to%20calculate%20all%20bytes%20when%20communicate%0A%20with%20client%20for%20a%20request&In-Reply-To=%3Ce2c334d8-4501-2005-ccac-6a19bc6024bc%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013843.html">
   <LINK REL="Next"  HREF="013868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Help: How to calculate all bytes when communicate with client for a request</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%3A%20How%20to%20calculate%20all%20bytes%20when%20communicate%0A%20with%20client%20for%20a%20request&In-Reply-To=%3Ce2c334d8-4501-2005-ccac-6a19bc6024bc%40measurement-factory.com%3E"
       TITLE="[squid-users] Help: How to calculate all bytes when communicate with client for a request">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Dec 20 16:38:46 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013843.html">[squid-users] Help: How to calculate all bytes when communicate with client for a request
</A></li>
        <LI>Next message (by thread): <A HREF="013868.html">[squid-users] Help: How to calculate all bytes when communicate with client for a request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13863">[ date ]</a>
              <a href="thread.html#13863">[ thread ]</a>
              <a href="subject.html#13863">[ subject ]</a>
              <a href="author.html#13863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/20/2016 03:56 AM, wei wrote:

&gt;<i> I want to calculate all bytes when a request is sent to squid,
</I>
According to squid.conf.documented, you can use the following logformat
%codes to get unencrypted HTTP request sizes:


&gt;<i> including:
</I>
&gt;<i>  1. the header length that client will send to squid
</I>
[http::]&gt;sh     Size of request headers received from client


&gt;<i>  2. the post content length that send to squid
</I>
[http::]&gt;st     Total size of request received from client.

minus

[http::]&gt;sh     Size of request headers received from client


&gt;<i>  3. the response length squid will reply to client
</I>

[http::]&lt;st     Total size of reply sent to client (after adaptation)

minus

[http::]&lt;sh     Size of reply headers sent to client (after adaptation)


Please note that you need Squid v3.5.22 or later for many size-related
logformat %codes to work reasonably well in some environments. There
were many size logging bugs in earlier versions!

If some of these %codes do not work in your tests with the latest Squid,
please consider filing a but report with an isolated test case
illustrating the problem.


&gt;<i> I don't need to know the request content, just want to know how many
</I>&gt;<i> bytes the client totally send including the post and https bytes, is it
</I>&gt;<i> possible to do this?
</I>
The only way to measure the size of encrypted HTTP message parts is to
decrypt that message. Thus, if you want to log HTTPS POST body sizes (as
opposed to just the number of encrypted bytes received from the HTTPS
client), then you have to tell Squid to decrypt that traffic. In most
cases, decryption is not worth the associated headaches if you just want
to log sizes.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013843.html">[squid-users] Help: How to calculate all bytes when communicate with client for a request
</A></li>
	<LI>Next message (by thread): <A HREF="013868.html">[squid-users] Help: How to calculate all bytes when communicate with client for a request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13863">[ date ]</a>
              <a href="thread.html#13863">[ thread ]</a>
              <a href="subject.html#13863">[ subject ]</a>
              <a href="author.html#13863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
