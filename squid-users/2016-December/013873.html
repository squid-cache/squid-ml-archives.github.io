<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Bypassed Proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypassed%20Proxy&In-Reply-To=%3C267a01d25bba%242c34ace0%24849e06a0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013872.html">
   <LINK REL="Next"  HREF="013876.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Bypassed Proxy</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypassed%20Proxy&In-Reply-To=%3C267a01d25bba%242c34ace0%24849e06a0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Bypassed Proxy">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Dec 21 18:43:50 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013872.html">[squid-users] Bypassed Proxy
</A></li>
        <LI>Next message (by thread): <A HREF="013876.html">[squid-users] Bypassed Proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13873">[ date ]</a>
              <a href="thread.html#13873">[ thread ]</a>
              <a href="subject.html#13873">[ subject ]</a>
              <a href="author.html#13873">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>How does squid.conf looks now?
It&#8217;s probably a typo or some settings exception.
You need to debug and check first if squidguard receives the request details
and what it does with it.
To see the relevant details you will need to use squid debug_options:
<A HREF="http://wiki.squid-cache.org/KnowledgeBase/DebugSections">http://wiki.squid-cache.org/KnowledgeBase/DebugSections</A>

Specifically section 61.
You should add to squid.conf the line
debug_options ALL,1 61,6

And your cache.log will be flooded with details about any request that is
being passed to squidguard.
I believe that this should be a start point that will show you if squid is
sending the request to squidguard and how squidguard answers.
If you want more help share with a paste the current squid.conf and
squidguard.conf.
This way even if it&#8217;s not related directly to squid we can see if there is a
hole in the setup you don&#8217;t see yet.

Eliezer

----
<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On
Behalf Of Sameh Onaissi
Sent: Wednesday, December 21, 2016 7:14 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Bypassed Proxy

Hello all, 

I got a transparent squid installed on Ubuntu 16.04

Using squid guard, I am blocking certain websites, including youtube.

Anytime a user tries accessing it, he/she is redirected to an access denied
page.

Except for ONE user!

One user is somehow, able to access you tube through squid!
That IP is not on the exempt list, and has no special configurations.

access.log:

1482339083.228&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4459 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339083.324&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4450 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339083.331&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4459 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339083.422&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4459 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339083.436&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4450 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339083.517&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4459 CONNECT s.youtube.com:443
- HIER_NONE/- text/html
1482339086.251&#160; &#160; &#160; 0 10.0.0.162 TAG_NONE/503 4450 CONNECT s.youtube.com:443
- HIER_NONE/- text/html


Any other user tries and gets:

1482339588.002&#160; &#160; 350 10.0.0.40 TCP_MISS/200 611 GET
<A HREF="https://www.youtube.com/">https://www.youtube.com/</A> - HIER_DIRECT/190.xxx.xxx.xxx text/html

That is the redirect html page.

My deny list where youtube is:

var/lib/squidguard/db/deny/urls has <A HREF="http://www.youtube.com">http://www.youtube.com</A>
var/lib/squidguard/db/deny/domains has <A HREF="http://youtube.com">http://youtube.com</A>


Any idea to how he is doing it?

I can add a rule to specifically deny 10.0.0.162, but I want to know how he
is doing it to prevent it for others. Also this is a dynamic IP.

Thank you,
Sam





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013872.html">[squid-users] Bypassed Proxy
</A></li>
	<LI>Next message (by thread): <A HREF="013876.html">[squid-users] Bypassed Proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13873">[ date ]</a>
              <a href="thread.html#13873">[ thread ]</a>
              <a href="subject.html#13873">[ subject ]</a>
              <a href="author.html#13873">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
