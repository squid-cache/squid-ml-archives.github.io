<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.0.17%20accept-encoding..%20sending%20gzip%3F%21&In-Reply-To=%3C3a5f01d2606e%24c1a99070%2444fcb150%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013914.html">
   <LINK REL="Next"  HREF="013923.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.0.17%20accept-encoding..%20sending%20gzip%3F%21&In-Reply-To=%3C3a5f01d2606e%24c1a99070%2444fcb150%24%40ngtech.co.il%3E"
       TITLE="[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!">eliezer at ngtech.co.il
       </A><BR>
    <I>Tue Dec 27 18:26:35 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013914.html">[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
</A></li>
        <LI>Next message (by thread): <A HREF="013923.html">[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13915">[ date ]</a>
              <a href="thread.html#13915">[ thread ]</a>
              <a href="subject.html#13915">[ subject ]</a>
              <a href="author.html#13915">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>And what shows in the access.log when you fetch this object?
The response headers are missing couple things.
Also you are using a heuristic refresh_pattern that should not work and it's
wrong to use such.
The first thing is to change the refresh pattern to something more connected
to reality rather then science fiction.
refresh_pattern -i
\.(jp[eg]{1,2}|pdf|gif|pn[pg]|bmp|tiff|ico|swf|css|js|ad|png)$ 1800 80% 7200

Try It and see if it changes something.
And a refence for the available options that can be used with enough details
to start to understand what you are doing:
<A HREF="http://www.squid-cache.org/Versions/v4/cfgman/refresh_pattern.html">http://www.squid-cache.org/Versions/v4/cfgman/refresh_pattern.html</A>

In this specific case there is a cache server.. Oracle at the other side and
the logs are the only one which will give us a glimpse into what is going on
for real.

Eliezer

----
<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On
Behalf Of Heiler Bemerguy
Sent: Tuesday, December 27, 2016 7:31 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] squid 4.0.17 accept-encoding.. sending gzip?!

Hi,
refresh_pattern -i
\.(jp[eg]{1,2}|pdf|gif|pn[pg]|bmp|tiff|ico|swf|css|js|ad|png)$ 10080 80%
120960 ignore-no-store ignore-reload ignore-must-revalidate ignore-private
override-expire store-stale
But it shouldn't change the length of the object, the encoding type of the
object, the &quot;Server&quot; header of the object..... or am I wrong?


-- 
Best Regards,

Heiler Bemerguy
Network Manager - CINBESA
55 91 98151-4894/3184-1751

Em 27/12/2016 14:26, Eliezer Croitoru escreveu:
May I ask how did you manager to tell squid to cache a no-cache object?
&gt;<i>From the dump it states:
</I>Cache-Control: max-age=0, no-cache, no-store, must-revalidate

Which means it should not be cached&#8230;.
&#160;
Eliezer
&#160;
----
<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>
Linux System Administrator
Mobile: +972-5-28704261
Email: mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>

&#160;
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On
Behalf Of Heiler Bemerguy
Sent: Tuesday, December 27, 2016 4:03 PM
To: mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A>
Subject: Re: [squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
&#160;
&#160;
The server doesn't define any &quot;content-encoding&quot;. This is the original
server reply, tcpdumped:
HTTP/1.1 200 OK 
Set-Cookie: ACE-STICKY=R1291873686; path=/; expires=Mon, 26-Dec-2016 
23:51:26 GMT 
Date: Mon, 26 Dec 2016 19:36:06 GMT 
Accept-Ranges: bytes 
Content-Length: 152264 
Content-Type: text/css; charset=UTF-8 
X-Powered-By: Servlet/3.0 JSP/2.2 
Cache-Control: max-age=0, no-cache, no-store, must-revalidate 
Pragma: no-cache 
Content-Language: en 
Set-Cookie: 
JSESSIONID=DCLCYhxGPHvpfnPNsPv51cGkS55GPqB4b3xJsybLgLJpyqPZZhNW!-162452808; 
path=/; HttpOnly 



-- 
Best Regards,
&#160;
Heiler Bemerguy
Network Manager - CINBESA
55 91 98151-4894/3184-1751
&#160;
Em 26/12/2016 21:07, Alex Rousskov escreveu:
On December 26, 2016 10:11:55 AM Heiler Bemerguy wrote: 



*Accept-Encoding: none* 



*Content-Encoding: gzip* 

These are end-to-end headers. Squid does not modify or add them (unless you
tell it to do that). 

The origin server does not honor the bogus &quot;none&quot; content coding requested
by the client. 

HTH, 

Alex. 


&#160;



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013914.html">[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
</A></li>
	<LI>Next message (by thread): <A HREF="013923.html">[squid-users] squid 4.0.17 accept-encoding.. sending gzip?!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13915">[ date ]</a>
              <a href="thread.html#13915">[ thread ]</a>
              <a href="subject.html#13915">[ subject ]</a>
              <a href="author.html#13915">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
