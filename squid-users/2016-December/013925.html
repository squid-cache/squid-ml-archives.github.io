<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Problem with ssl_crtd
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20ssl_crtd&In-Reply-To=%3C58a6b9fcba54f11bfa7e21ed4256e252%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013921.html">
   <LINK REL="Next"  HREF="013931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Problem with ssl_crtd</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20ssl_crtd&In-Reply-To=%3C58a6b9fcba54f11bfa7e21ed4256e252%40treenet.co.nz%3E"
       TITLE="[squid-users] Problem with ssl_crtd">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Dec 29 06:48:44 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013921.html">[squid-users] Problem with ssl_crtd
</A></li>
        <LI>Next message (by thread): <A HREF="013931.html">[squid-users] Problem with ssl_crtd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13925">[ date ]</a>
              <a href="thread.html#13925">[ thread ]</a>
              <a href="subject.html#13925">[ subject ]</a>
              <a href="author.html#13925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2016-12-29 06:16, Eduardo Carneiro wrote:
&gt;<i> Hi everyone.
</I>&gt;<i> 
</I>&gt;<i> I have a strange issue with my squid 3.5.19. When I enable ssl-bump and
</I>&gt;<i> url_rewrite in order to make dynamic content cache,
</I>

URL has nothing to do with cachability of dynamic content.
If that content is not cachign by default then you probably still have 
some very outdated rules in your squid.conf prohibiting that content 
from being stored.



&gt;<i> I've got, sporadically,
</I>&gt;<i> this error in my cache.log:
</I>&gt;<i> 
</I>&gt;<i> /assertion failed: Read.cc:69: &quot;fd_table[conn-&gt;fd].halfClosedReader !=
</I>&gt;<i> NULL&quot;/
</I>&gt;<i> 
</I>&gt;<i> When the error occur, my squid simply stops.
</I>&gt;<i> 
</I>&gt;<i> Here is a part of my cache.log:
</I>&gt;<i> 
</I>&gt;<i> ---
</I>&gt;<i> 2016/12/28 12:29:17 kid1| assertion failed: Read.cc:69:
</I>&gt;<i> &quot;fd_table[conn-&gt;fd].halfClosedReader != NULL&quot;
</I>

&lt;<A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4270">http://bugs.squid-cache.org/show_bug.cgi?id=4270</A>&gt;


&gt;<i> 2016/12/28 12:36:21 kid1| helperOpenServers: Starting 5/32 'ssl_crtd'
</I>&gt;<i> processes
</I>&gt;<i> FATAL: Ipc::Mem::Segment::open failed to
</I>&gt;<i> shm_open(/squid-ssl_session_cache.shm): (2) No such file or directory
</I>&gt;<i> 
</I>&gt;<i> Squid Cache (Version 3.5.19): Terminated abnormally.
</I>&gt;<i> 
</I>
Hmm, seems there is a part of bug 3805 still present
  &lt;<A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=3805">http://bugs.squid-cache.org/show_bug.cgi?id=3805</A>&gt;

&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i> If I disable ssl-bump and url_rewrite, the error does not occur. I saw 
</I>&gt;<i> here
</I>&gt;<i> in the list that this were a bug on squid 3.4, but I'm using squid 
</I>&gt;<i> 3.5.19.
</I>&gt;<i> 
</I>&gt;<i> Someone knows how to fix this?
</I>
The bug about it is still open. That usually means no.

However, I think we should look at why you have resorted to screwing 
around with URLs to &quot;make dynamic content cache&quot;. Squid-3.2 and later 
are quite good at caching dynamic content. Current 3.5 have even reached 
the point where private content can be cached safely.

  What is your squid.conf?
  and what do you have the re-writer doing?

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013921.html">[squid-users] Problem with ssl_crtd
</A></li>
	<LI>Next message (by thread): <A HREF="013931.html">[squid-users] Problem with ssl_crtd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13925">[ date ]</a>
              <a href="thread.html#13925">[ thread ]</a>
              <a href="subject.html#13925">[ subject ]</a>
              <a href="author.html#13925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
