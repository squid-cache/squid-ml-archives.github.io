<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] acls with the same name, last wins
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acls%20with%20the%20same%20name%2C%20last%20wins&In-Reply-To=%3C42b71fe3fb040dc3962e2f94331974da%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013936.html">
   <LINK REL="Next"  HREF="013938.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] acls with the same name, last wins</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acls%20with%20the%20same%20name%2C%20last%20wins&In-Reply-To=%3C42b71fe3fb040dc3962e2f94331974da%40treenet.co.nz%3E"
       TITLE="[squid-users] acls with the same name, last wins">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Dec 31 02:04:25 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013936.html">[squid-users] acls with the same name, last wins
</A></li>
        <LI>Next message (by thread): <A HREF="013938.html">[squid-users] ssl_bump - peek &amp; splice logging IP rather than	server name
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13937">[ date ]</a>
              <a href="thread.html#13937">[ thread ]</a>
              <a href="subject.html#13937">[ subject ]</a>
              <a href="author.html#13937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2016-12-31 10:58, Ivan Larionov wrote:
&gt;<i> I'm a bit confused now. Examples from default config:
</I>&gt;<i> 
</I>&gt;<i> acl localnet src 10.0.0.0/8 [2]     # RFC1918 possible internal
</I>&gt;<i> network
</I>&gt;<i> acl localnet src 172.16.0.0/12 [3]  # RFC1918 possible internal
</I>&gt;<i> network
</I>&gt;<i> acl localnet src 192.168.0.0/16 [4] # RFC1918 possible internal
</I>&gt;<i> network
</I>&gt;<i> acl localnet src fc00::/7       # RFC 4193 local private network range
</I>&gt;<i> acl localnet src fe80::/10      # RFC 4291 link-local (directly
</I>&gt;<i> plugged) machines
</I>&gt;<i> 
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i> acl Safe_ports port 70          # gopher
</I>&gt;<i> acl Safe_ports port 210         # wais
</I>&gt;<i> acl Safe_ports port 280         # http-mgmt
</I>&gt;<i> acl Safe_ports port 488         # gss-http
</I>&gt;<i> acl Safe_ports port 591         # filemaker
</I>&gt;<i> acl Safe_ports port 777         # multiling http
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> 
</I>&gt;<i> All these ACL work as OR, right?
</I>
Yes. They put the port or IP values into a bucket/set of values that are 
matched in OR style.


You can list the port/IP ACls values all on one line if you want and it 
works identically to listing them on separate lines.

&gt;<i> 
</I>&gt;<i> Why is req_header different?
</I>
With the req_header (and rep_header) in Squid-3 only the regex portion 
provides that &quot;line and list being identical&quot; property, the header name 
changing requires a new line.

Squid-2 appears to have implemented the ACL as a set of header names 
with the regex being a secondary lookup. So if any of the headers 
existed the set of regex were then tested and that was the overall 
result.


It can probably be made to work the Squid-2 way (if its really needed 
make a feature enhancement bug), but Squid-3 has the allof and anyof 
ACLs now to make an explicit logic tree where this type of OR 
requirement is clearly visible in the config file. These new ACL tests 
walk their tree of AND/OR ACL conditions and the overall match/non-match 
is whatever the leaf ACL test says. Thats a lot more flexible.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013936.html">[squid-users] acls with the same name, last wins
</A></li>
	<LI>Next message (by thread): <A HREF="013938.html">[squid-users] ssl_bump - peek &amp; splice logging IP rather than	server name
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13937">[ date ]</a>
              <a href="thread.html#13937">[ thread ]</a>
              <a href="subject.html#13937">[ subject ]</a>
              <a href="author.html#13937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
