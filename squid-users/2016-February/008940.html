<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TeamViewer and other http tunneled connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TeamViewer%20and%20other%20http%20tunneled%20connections&In-Reply-To=%3CCAFp%2B3KeJiH7y9n%2B0oKitBuP2Vj%2B4S3a65y%3DzKgupT-v96gP6GA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008941.html">
   <LINK REL="Next"  HREF="008942.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TeamViewer and other http tunneled connections</H1>
    <B>Markus</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TeamViewer%20and%20other%20http%20tunneled%20connections&In-Reply-To=%3CCAFp%2B3KeJiH7y9n%2B0oKitBuP2Vj%2B4S3a65y%3DzKgupT-v96gP6GA%40mail.gmail.com%3E"
       TITLE="[squid-users] TeamViewer and other http tunneled connections">markus.bytom.pl at gmail.com
       </A><BR>
    <I>Mon Feb  1 08:56:03 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008941.html">[squid-users] How squid cache ps4 game pkg file?
</A></li>
        <LI>Next message (by thread): <A HREF="008942.html">[squid-users] TeamViewer and other http tunneled connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8940">[ date ]</a>
              <a href="thread.html#8940">[ thread ]</a>
              <a href="subject.html#8940">[ subject ]</a>
              <a href="author.html#8940">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've got a Squid server (v. 3.5.x) configured that way, that only some
&quot;banking sites&quot; are allowed to be tunneled (spliced) - the rest of SSL
sites are bumped.
That works OK. I thought that it prevents me from illegal
tunneling-out by users. However recently I've realized that TeamViewer
is still able  to establish connection over my Squid.
Moreover user's PC are totally blocked on my firewall - they only have
access to the web via Squid-proxy (their browsers are proxy aware).

Of course I can block out teamviewer.com domain by ACL - and that
works. But I'm wondering if there is any way to prevent such
tunnel-connection in future. (I mean another -  mainly malicious
software)

I've captured some details using Etherreal and it looks like
Teamviewer app does a normal http GET request to the TeamViewer's ASP
script
<A HREF="http://master13.teamviewer.com/din.aspx?s=00000000&amp;id=0&amp;client=DynGate&amp;rnd=144452645&amp;p=10000001">http://master13.teamviewer.com/din.aspx?s=00000000&amp;id=0&amp;client=DynGate&amp;rnd=144452645&amp;p=10000001</A>

TeamViewer's server response is an application/octet-stream , but it
contains an ID which is presumably used later in client's POST
request.

See: <A HREF="http://dev.3d.pl/tmp/teamv.png">http://dev.3d.pl/tmp/teamv.png</A>  (screenshot from Ethereal) and
TCP the stream <A HREF="http://dev.3d.pl/tmp/teamv.txt">http://dev.3d.pl/tmp/teamv.txt</A>

My question is - does the TeamViewer tunnel traffic differ in any way
from normal http binary content transmission (eg. youtube or radio
streaming) ?


Can we somehow detect that this kind of transmission is probably a
tunnel traffic?

Sorry if my post is a bit chaotic, but I'm kinda confused now , how it works.

Please note - I'm not talking only about TeamViewer itself but in
general about HTTP-tunneled traffic.  Maybe an ICAP server could be
useful here? but how do I know what to look for? (how should
ACLs/rules look like)

or you want to tell me, that the only possible way is continuous
observation what's new &quot;on market&quot; and adding new rules?

many thanks for explanation!

Markus

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008941.html">[squid-users] How squid cache ps4 game pkg file?
</A></li>
	<LI>Next message (by thread): <A HREF="008942.html">[squid-users] TeamViewer and other http tunneled connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8940">[ date ]</a>
              <a href="thread.html#8940">[ thread ]</a>
              <a href="subject.html#8940">[ subject ]</a>
              <a href="author.html#8940">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
