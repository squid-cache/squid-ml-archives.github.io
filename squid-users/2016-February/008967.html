<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explanation%20needed%20for%20%22at_step%22-ACL%20in%20ssl_bump&In-Reply-To=%3C56AFAA8B.4020303%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008961.html">
   <LINK REL="Next"  HREF="008947.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explanation%20needed%20for%20%22at_step%22-ACL%20in%20ssl_bump&In-Reply-To=%3C56AFAA8B.4020303%40measurement-factory.com%3E"
       TITLE="[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Feb  1 18:57:15 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008961.html">[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump
</A></li>
        <LI>Next message (by thread): <A HREF="008947.html">[squid-users] substituing sniproxy for squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8967">[ date ]</a>
              <a href="thread.html#8967">[ thread ]</a>
              <a href="subject.html#8967">[ subject ]</a>
              <a href="author.html#8967">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/01/2016 09:55 AM, Tom Tom wrote:
&gt;<i> I'm still confused about the correct apply of the &quot;at_step&quot;-rules.
</I>&gt;<i> Does an action (ex. bump, peek, stare...) without providing a
</I>&gt;<i> step-argument implicit means step1, step2 AND step3?
</I>
There is no &quot;step argument&quot;.

The following may help you understand what is going on:

0. There is nothing really special or magical about &quot;step&quot; ACLs or the
&quot;all&quot; ACL. They have no side effects. The ACLs themselves do not enable
or trigger something. When Squid evaluates ACLs for a given rule, Squid
treats all ACLs the same.

1. All ssl_bump rules are considered at each of three bumping steps.

2. Rules with actions that are impossible at the current step are ignored.

3. The action of the first matching ssl_bump rule is applied at the end
of the current step. When considering a single ssl_bump rule, Squid
simply evaluates all ACLs attached to that rule, one-by-one, according
to regular ACL matching rules.

4. If no rules match at a given step, then the bump action is used if
you have been staring and the splice action is used otherwise. I am not
100% sure this is an accurate summary of the default behavior, and you
should avoid relying on such defaults if possible.


&gt;<i> Why does in my example the terminate-action triggers, although I
</I>&gt;<i> didn't defined a step?
</I>
You do not define steps. Squid goes through three hard-coded steps. At
each step, Squid applies a single ssl_bump action you have configured.
This &quot;stepping&quot; ends when the final action is applied during a step (see
above for the algorithm).

An ACL is nothing but a [named] condition: &quot;If foo, then declare a
match&quot;. An ACL itself does not enable any Squid action (there are some
ugly exceptions related to authentication but those are outside SslBump
scope).

Your terminate rule triggers at step N because:

i. Some non-final SslBump rule matched at all step(s) prior to N.

ii. Each rule above &quot;terminate&quot; was either not applicable at step N or
its ACL(s) did not match at step N.

iii. The terminate rule ACL(s) matched at step N.


Amos has described specific conditions that could result in the
terminate action.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008961.html">[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump
</A></li>
	<LI>Next message (by thread): <A HREF="008947.html">[squid-users] substituing sniproxy for squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8967">[ date ]</a>
              <a href="thread.html#8967">[ thread ]</a>
              <a href="subject.html#8967">[ subject ]</a>
              <a href="author.html#8967">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
