<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Debugging http_access and http_reply_access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20http_access%20and%20http_reply_access&In-Reply-To=%3C56B2CE45.90708%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008992.html">
   <LINK REL="Next"  HREF="008996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Debugging http_access and http_reply_access</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20http_access%20and%20http_reply_access&In-Reply-To=%3C56B2CE45.90708%40treenet.co.nz%3E"
       TITLE="[squid-users] Debugging http_access and http_reply_access">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Feb  4 04:06:29 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008992.html">[squid-users] Debugging http_access and http_reply_access
</A></li>
        <LI>Next message (by thread): <A HREF="008996.html">[squid-users] HTTP Keepalive (re bug 4426)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8994">[ date ]</a>
              <a href="thread.html#8994">[ thread ]</a>
              <a href="subject.html#8994">[ subject ]</a>
              <a href="author.html#8994">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/02/2016 1:21 p.m., squid-users wrote:
&gt;&gt;<i> debug_options 11,2 28,3
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 11,2 gives you the HTTP messages.
</I>&gt;&gt;<i> 28,3 gives you the ACL processing action and results.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Its a bit like quantum mechanics at the moment though. You can know 
</I>&gt;&gt;<i> the request mesage details. OR you can know the ACL matching. Not both 
</I>&gt;&gt;<i> at once.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Are there any other debug sections which would be more appropriate 
</I>&gt;&gt;&gt;<i> to the task?  If not, is there another more suitable approach?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Why exactly are you doing this? What are you trying to achieve with it?
</I>&gt;<i> 
</I>&gt;<i> The intent is to record which rule matched each request, for accounting &amp; historical purposes.  
</I>
That does not explain what you are trying to achieve.


&gt;<i> And also to help less-technical administrators to find (&amp; resolve)
</I>&gt;<i> unexpected behaviour in their http_access policies.
</I>
Hmm. What you are asking for will not help very much at all in that
direction unless the config is highly complex or very large. In which
case a medum-&gt;high level of knowledge will be needed to go beyond &quot;its
broken&quot; anyway and the process of debugging would be best to involve
isolating the HTTP transaction on a test server where the above debug
outputs can be done to see whats going on.

Specifically its most often not the rule that matched which matters, its
the entire trail of how Squid managed to reach that rule. ie. that 28,3
debug trace.


&gt;<i>  Ideally, it
</I>&gt;<i> would be great to be able to get this information through observation
</I>&gt;<i> alone, without making changes to a live config.
</I>
That is possible now. Though admittedly it does take understanding of
how access controls work to read it. But the so does everything. The
very words I've just written require you to have prior knowledge of
English and literacy just to understand. Some knowledge levels are just
mandatory.

If one has a basic level of understanding how Squid access controls work
(see <A HREF="http://wiki.squid-cache.org/SquidFaq/SquidAcls">http://wiki.squid-cache.org/SquidFaq/SquidAcls</A> - dont be afraid if
the page length it repeats a lot to ensure different types of people
understand properly) and a copy of the HTTP message (the 11,2 data).
Then it is fairly easy to eyeball the squid.conf and track what Squid
will do during the matching of that message.

Experience (or lack of it) only determines how _fast_ one can trace it.
Even a beginner should be able to do it given a few dozen minutes for
most configs. Most of what I/we do here is point out obvious things
people overlook because they are seeing what they expect to see, not
what is actually written.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008992.html">[squid-users] Debugging http_access and http_reply_access
</A></li>
	<LI>Next message (by thread): <A HREF="008996.html">[squid-users] HTTP Keepalive (re bug 4426)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8994">[ date ]</a>
              <a href="thread.html#8994">[ thread ]</a>
              <a href="subject.html#8994">[ subject ]</a>
              <a href="author.html#8994">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
