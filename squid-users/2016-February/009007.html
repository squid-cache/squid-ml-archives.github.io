<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ext_ldap_group_acl not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ext_ldap_group_acl%20not%20working&In-Reply-To=%3C1454602772702-4675880.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008945.html">
   <LINK REL="Next"  HREF="008946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ext_ldap_group_acl not working</H1>
    <B>alesironi</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ext_ldap_group_acl%20not%20working&In-Reply-To=%3C1454602772702-4675880.post%40n4.nabble.com%3E"
       TITLE="[squid-users] ext_ldap_group_acl not working">alesironi at yahoo.it
       </A><BR>
    <I>Thu Feb  4 16:19:32 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008945.html">[squid-users] ext_ldap_group_acl not working
</A></li>
        <LI>Next message (by thread): <A HREF="008946.html">[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9007">[ date ]</a>
              <a href="thread.html#9007">[ thread ]</a>
              <a href="subject.html#9007">[ subject ]</a>
              <a href="author.html#9007">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I performed additional testing using different helpers but nothing changed,
so decided to use alternative tools to bind AD. I used the tool ldapsearch
to verify that at least is possible to do a search on Active Directory and
it worked (it read all AD returning 271 objects).


 /usr/bin/ldapsearch -x -h domcon.kidanemehret.local -D
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at kidanemehret.local</A> -W -b &quot;dc=kidanemehret,dc=local&quot; -s sub &quot;(cn=*)&quot; cn
mail sn
Enter LDAP Password

# extended LDIF
#
# LDAPv3
# base &lt;dc=kidanemehret,dc=local&gt; with scope subtree
# filter: (cn=*)/
...
...
...

I then run the query again using ext_ldap_group_acl and when asking to check
if a user (test-full) is member of the AD group Internet_Users_Full if
returns ERR instead then OK.


/usr/lib/squid3/ext_ldap_group_acl -R -K -b &quot;OU=Service
Accounts,OU=USR,DC=kidanemehret,DC=local&quot; -D <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid at kidamemehret.local</A> -w
mypassword -f
&quot;(&amp;(objectclass=person)(sAMAccountName=%u)(memberof=cn=Internet_Users_Full,ou=Service
Accounts,ou=USR,dc=kidanemehret,dc=local))&quot; -h domcon.kidanemehret.local    
-d
test-full
ERR 


Of course test-full is is member of Internet_Users_Full and che cn of the
group is correct (verified in AD).

Additional strange thing (at least to me...) is that I may also use a wrong
password in the option -w and the result is the same: it's not returining an
authentication failure, just returnint ERR just like the user is not in the
group.
Note that I'm using the same account used in LDAPSEARCH to perform the
search.

Any hints?





--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/ext-ldap-group-acl-not-working-tp4675816p4675880.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/ext-ldap-group-acl-not-working-tp4675816p4675880.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008945.html">[squid-users] ext_ldap_group_acl not working
</A></li>
	<LI>Next message (by thread): <A HREF="008946.html">[squid-users] Explanation needed for &quot;at_step&quot;-ACL in ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9007">[ date ]</a>
              <a href="thread.html#9007">[ thread ]</a>
              <a href="subject.html#9007">[ subject ]</a>
              <a href="author.html#9007">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
