<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] script /usr/lib/squid3/log_db_daemon
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20script%20/usr/lib/squid3/log_db_daemon&In-Reply-To=%3C56BAF8AB.1090505%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009049.html">
   <LINK REL="Next"  HREF="009050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] script /usr/lib/squid3/log_db_daemon</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20script%20/usr/lib/squid3/log_db_daemon&In-Reply-To=%3C56BAF8AB.1090505%40treenet.co.nz%3E"
       TITLE="[squid-users] script /usr/lib/squid3/log_db_daemon">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Feb 10 08:45:31 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009049.html">[squid-users] script /usr/lib/squid3/log_db_daemon
</A></li>
        <LI>Next message (by thread): <A HREF="009050.html">[squid-users] Question about my SSL test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9085">[ date ]</a>
              <a href="thread.html#9085">[ thread ]</a>
              <a href="subject.html#9085">[ subject ]</a>
              <a href="author.html#9085">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/02/2016 11:23 p.m., Tony Pe&#241;a wrote:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> I want to modify the /usr/lib/squid3/log_db_daemon script, but I'm not know
</I>&gt;<i> very knowledge about PERL, so if i want to modify to get on the mysql
</I>&gt;<i> table, not epoch_time, and date_time in human readable i guess first change
</I>&gt;<i> the scheme...
</I>
Hi Tony,


If you change the stored format to be human-text then you have to change
*everything* touching or using that data. the logger, the database
functions procedures, the display logics. Right down to sorting and
comparisions between any two records by the DB software itself. Just
listing the records in the right order now needs to account for
leap-things (from years to nanoseconds), local machine clock skew,
governments changing your local TZ offsets (daylight savings) schedule,
etc, etc.
 It is a huge amount of avoidable complexity and performance drag all
the way through the code.

So, leave it all as the efficient epoch internally and do the time
conversion exactly once: at the point where its actually being displayed
to a human.

MySQL provides a built-in function for reformatting timestamps if it is
the point doing the display.
&lt;<A HREF="https://dev.mysql.com/doc/refman/5.6/en/date-and-time-functions.html#function_from-unixtime">https://dev.mysql.com/doc/refman/5.6/en/date-and-time-functions.html#function_from-unixtime</A>&gt;

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009049.html">[squid-users] script /usr/lib/squid3/log_db_daemon
</A></li>
	<LI>Next message (by thread): <A HREF="009050.html">[squid-users] Question about my SSL test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9085">[ date ]</a>
              <a href="thread.html#9085">[ thread ]</a>
              <a href="subject.html#9085">[ subject ]</a>
              <a href="author.html#9085">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
