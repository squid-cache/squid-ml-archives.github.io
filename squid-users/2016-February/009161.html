<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay Pools and HTTPS on Squid 3.x
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20and%20HTTPS%20on%20Squid%203.x&In-Reply-To=%3CCAJtELrj2UTDgtUpFeaF9%3DceR13kMFNcObG_uihn8xrfADHw_8g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009160.html">
   <LINK REL="Next"  HREF="009162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay Pools and HTTPS on Squid 3.x</H1>
    <B>Hery Martin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20and%20HTTPS%20on%20Squid%203.x&In-Reply-To=%3CCAJtELrj2UTDgtUpFeaF9%3DceR13kMFNcObG_uihn8xrfADHw_8g%40mail.gmail.com%3E"
       TITLE="[squid-users] Delay Pools and HTTPS on Squid 3.x">scorpionxii at gmail.com
       </A><BR>
    <I>Wed Feb 17 01:37:29 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009160.html">[squid-users] Squid configuration help
</A></li>
        <LI>Next message (by thread): <A HREF="009162.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9161">[ date ]</a>
              <a href="thread.html#9161">[ thread ]</a>
              <a href="subject.html#9161">[ subject ]</a>
              <a href="author.html#9161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everybody:

Since a few months ago I'm using squid to provide a solution as small
business proxy in the network of my work place.

I'm from Cuba, in our country the Internet is a very limited resource. I
have only one link of 2Mbps to share with 20 ~ 25 users (even with my
network have more than 60) this is the normal concurrent number.

When I start the squid deployment in my network I started using 2.7stable9
version, I made all arrangements to put it work with my AD to match ACLs
using AD Groups and everything works perfect.

I defined 1 class 2 delay pools to to limits traffic to 12 KBytes/s per
user approx.

delay_pool 1
delay_class 1 2
delay_parameters -1/-1 12228/12228

The delay pool works perfect, I was checking with real-time tool sqstat and
with squidclient mgr:delay

NOW.....

I recently upgrade squid to 3.3.8 and I notice that delay pool started to
going wrong when the users surf or download using HTTPS protocol

I checked in real-time and when the users browse HTTPS the pool goes in
negative numbers and start to grow and grow, its very easy to check, just
define a delay pool with 5KB and start a download from an HTTPS source and
you can check it with squidclient mgr:delay, the ip takes negative pool
value and keep growing until the download finish.

Frustrated with this behavior I put different squid versions in a
Virtualization Server and definitely I saw that the problem occurs with
squid 3.x versions, today I made a final test and I think that the
implementation of HTTP v1.1 is maybe related with that problem (I'm not
sure but tomorow I will make a few tests with squid 3.1 where HTTP v1.1 was
not yet implemented)

Please, if you have the opportunity, just test this in a Lab environment, I
decided to write to this email list because I asked to many people that
already have implemented squid as proxy in their networks and they didn't
believed to me until I demostrated the issue.

Have anyone information about this bug? There is any hope to fix this
problem at code level?

Anyway, I'm computer systems engineer, I use to write a lot C++ lines every
week... I'm not related with the squid development (never saw the code in
my life) but if somebody have any idea how to fix this and wants help just
count with me.

Greetings from Cuba and sorry about my English :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160216/56555126/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160216/56555126/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009160.html">[squid-users] Squid configuration help
</A></li>
	<LI>Next message (by thread): <A HREF="009162.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9161">[ date ]</a>
              <a href="thread.html#9161">[ thread ]</a>
              <a href="subject.html#9161">[ subject ]</a>
              <a href="author.html#9161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
