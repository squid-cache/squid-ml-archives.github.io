<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay Pools and HTTPS on Squid 3.x
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20and%20HTTPS%20on%20Squid%203.x&In-Reply-To=%3CCAJtELrh8bHpPa1ooMvHQCe6bQsgmiNwuuw24R4T%3D7hq7_7NzqA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009162.html">
   <LINK REL="Next"  HREF="009164.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay Pools and HTTPS on Squid 3.x</H1>
    <B>Hery Martin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20and%20HTTPS%20on%20Squid%203.x&In-Reply-To=%3CCAJtELrh8bHpPa1ooMvHQCe6bQsgmiNwuuw24R4T%3D7hq7_7NzqA%40mail.gmail.com%3E"
       TITLE="[squid-users] Delay Pools and HTTPS on Squid 3.x">scorpionxii at gmail.com
       </A><BR>
    <I>Wed Feb 17 02:37:05 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009162.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
        <LI>Next message (by thread): <A HREF="009164.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9163">[ date ]</a>
              <a href="thread.html#9163">[ thread ]</a>
              <a href="subject.html#9163">[ subject ]</a>
              <a href="author.html#9163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey djch Thanks for your quick reply...

Anyway, I know that delay pools are implemented at software layer, but
maybe the error was just a simple mistake porting the old squid 2 project.
Even when these days we have tools to do this more efficiently like TC-CBQ,
in environments where squid works as no transparent proxy, the delay pools
are very useful, in my country I'm pretty sure that a lot of network
administrator will be thankful about a fix. I was trying to handle this
using TC-CBQ in my proxy server but I read in many articles that you have
to mark the traffic in squid to make it work.

So... Do you think that maybe some developers can take the task if the bug
is reported?

As a secondary thing (Do you know any possible implementation using squid
and TC-CBQ?)

Cheers

On Tue, Feb 16, 2016 at 8:26 PM, djch [via Squid Web Proxy Cache] &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ml-node+s1019090n4676045h86 at n4.nabble.com</A>&gt; wrote:

&gt;<i> It's been a while since I've looked at this&#8212;because the software we use to
</I>&gt;<i> generate our squid.conf just works around now&#8212;but we found that Squid 3
</I>&gt;<i> would only enforce exactly half the configured rate on HTTP requests but
</I>&gt;<i> enforce the full rate on HTTPS requests.
</I>&gt;<i>
</I>&gt;<i> So we now make two delay pools for every &quot;restriction&quot;: one for HTTP which
</I>&gt;<i> is x2 the byte rate and one for HTTPS which is normal.
</I>&gt;<i>
</I>&gt;<i> I don't we looked much more into it or filed a bug 'cause none of the
</I>&gt;<i> developers seem very keen on pushing delay_pools forward, due their being
</I>&gt;<i> more robust network-level approaches these days.
</I>&gt;<i>
</I>&gt;<i> On Wed, 17 Feb 2016 at 12:37 Hery Martin &lt;[hidden email]
</I>&gt;<i> &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=0">http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=0</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hello everybody:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Since a few months ago I'm using squid to provide a solution as small
</I>&gt;&gt;<i> business proxy in the network of my work place.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm from Cuba, in our country the Internet is a very limited resource. I
</I>&gt;&gt;<i> have only one link of 2Mbps to share with 20 ~ 25 users (even with my
</I>&gt;&gt;<i> network have more than 60) this is the normal concurrent number.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I start the squid deployment in my network I started using
</I>&gt;&gt;<i> 2.7stable9 version, I made all arrangements to put it work with my AD to
</I>&gt;&gt;<i> match ACLs using AD Groups and everything works perfect.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I defined 1 class 2 delay pools to to limits traffic to 12 KBytes/s per
</I>&gt;&gt;<i> user approx.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> delay_pool 1
</I>&gt;&gt;<i> delay_class 1 2
</I>&gt;&gt;<i> delay_parameters -1/-1 12228/12228
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The delay pool works perfect, I was checking with real-time tool sqstat
</I>&gt;&gt;<i> and with squidclient mgr:delay
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> NOW.....
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I recently upgrade squid to 3.3.8 and I notice that delay pool started to
</I>&gt;&gt;<i> going wrong when the users surf or download using HTTPS protocol
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I checked in real-time and when the users browse HTTPS the pool goes in
</I>&gt;&gt;<i> negative numbers and start to grow and grow, its very easy to check, just
</I>&gt;&gt;<i> define a delay pool with 5KB and start a download from an HTTPS source and
</I>&gt;&gt;<i> you can check it with squidclient mgr:delay, the ip takes negative pool
</I>&gt;&gt;<i> value and keep growing until the download finish.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Frustrated with this behavior I put different squid versions in a
</I>&gt;&gt;<i> Virtualization Server and definitely I saw that the problem occurs with
</I>&gt;&gt;<i> squid 3.x versions, today I made a final test and I think that the
</I>&gt;&gt;<i> implementation of HTTP v1.1 is maybe related with that problem (I'm not
</I>&gt;&gt;<i> sure but tomorow I will make a few tests with squid 3.1 where HTTP v1.1 was
</I>&gt;&gt;<i> not yet implemented)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please, if you have the opportunity, just test this in a Lab environment,
</I>&gt;&gt;<i> I decided to write to this email list because I asked to many people that
</I>&gt;&gt;<i> already have implemented squid as proxy in their networks and they didn't
</I>&gt;&gt;<i> believed to me until I demostrated the issue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Have anyone information about this bug? There is any hope to fix this
</I>&gt;&gt;<i> problem at code level?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Anyway, I'm computer systems engineer, I use to write a lot C++ lines
</I>&gt;&gt;<i> every week... I'm not related with the squid development (never saw the
</I>&gt;&gt;<i> code in my life) but if somebody have any idea how to fix this and wants
</I>&gt;&gt;<i> help just count with me.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Greetings from Cuba and sorry about my English :)
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=1">http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=1</A>&gt;
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=2">http:///user/SendEmail.jtp?type=node&amp;node=4676045&amp;i=2</A>&gt;
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i> If you reply to this email, your message will be added to the discussion
</I>&gt;<i> below:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Delay-Pools-and-HTTPS-on-Squid-3-x-tp4676043p4676045.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Delay-Pools-and-HTTPS-on-Squid-3-x-tp4676043p4676045.html</A>
</I>&gt;<i> To unsubscribe from Delay Pools and HTTPS on Squid 3.x, click here
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4676043&amp;code=c2NvcnBpb254aWlAZ21haWwuY29tfDQ2NzYwNDN8MTE2NzYzMzM3NA==">http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4676043&amp;code=c2NvcnBpb254aWlAZ21haWwuY29tfDQ2NzYwNDN8MTE2NzYzMzM3NA==</A>&gt;
</I>&gt;<i> .
</I>&gt;<i> NAML
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml">http://squid-web-proxy-cache.1019090.n4.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml</A>&gt;
</I>&gt;<i>
</I>



--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Delay-Pools-and-HTTPS-on-Squid-3-x-tp4676043p4676046.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Delay-Pools-and-HTTPS-on-Squid-3-x-tp4676043p4676046.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009162.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
	<LI>Next message (by thread): <A HREF="009164.html">[squid-users] Delay Pools and HTTPS on Squid 3.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9163">[ date ]</a>
              <a href="thread.html#9163">[ thread ]</a>
              <a href="subject.html#9163">[ subject ]</a>
              <a href="author.html#9163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
