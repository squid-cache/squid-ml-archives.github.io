<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid None Aborted problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20None%20Aborted%20problem&In-Reply-To=%3C201602211347.00800.Antony.Stone%40squid.open.source.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009203.html">
   <LINK REL="Next"  HREF="009275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid None Aborted problem</H1>
    <B>Antony Stone</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20None%20Aborted%20problem&In-Reply-To=%3C201602211347.00800.Antony.Stone%40squid.open.source.it%3E"
       TITLE="[squid-users] Squid None Aborted problem">Antony.Stone at squid.open.source.it
       </A><BR>
    <I>Sun Feb 21 12:47:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009203.html">[squid-users] Squid None Aborted problem
</A></li>
        <LI>Next message (by thread): <A HREF="009275.html">[squid-users] Squid None Aborted problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9204">[ date ]</a>
              <a href="thread.html#9204">[ thread ]</a>
              <a href="subject.html#9204">[ subject ]</a>
              <a href="author.html#9204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sunday 21 February 2016 at 12:56:03, secoonder wrote:

&gt;<i> My Firewall eth0: 192.168.1.180
</I>&gt;<i>                   eth1:192.168.2.180
</I>
I'm guessing that eth0 is your route to the Internet, and eth1 points towards 
the clients trying to use Squid?

&gt;<i> ip_forwarding enable and more /proc/sys/net/ipv4/ip_forward =1
</I>&gt;<i> iptables -t nat -A POSTROUTING -s 192.168.5.0/255.255.255.0 -o eth0 -j
</I>&gt;<i> MASQUERADE
</I>
So, there's at least one more router (connecting 192.168.2.180 to 
192.168.5.0/24) between the clients and Squid...?

&gt;<i> This is no problem above it.The cilents could connect internet.
</I>
You mean, they can connect directly without using Squid at all.  Okay, so 
network routing is working, at least.

&gt;<i> And then i install squid 3.2.11.
</I>
Why?  That's nearly 3 years old - it dates from April 2013.

&gt;<i> i added iptables -t nat -A PREROUTING -i eth1-p tcp --dport 80 -j REDIRECT
</I>&gt;<i> --to-ports 3128 and save it.
</I>
Okay, so you are correctly doing the NAT on the machine running Squid.

Just out of interest, which distribution of Linux are you running on this 
machine, and which version of it?

&gt;<i> i redirect succesfully 80 port.i see it at tailf /var/log/squid3/access.log
</I>
Please show us what gets logged in access.log when a client tries to connect, 
and make sure you tell us what they were trying to connect to.

Also, it would be a good idea to make sure that Squid itself is working before 
trying to add the interception - configure one client to explicitly use the 
proxy on IP 192.168.2.180, and make some requests from that client and make 
sure both that they work, and they show up in Squid's access.log.

&gt;<i> But clients can not internet .
</I>&gt;<i> My squid3 -k parse...
</I>
Please show us your squid.conf file without comments or blank lines.

&gt;<i> 2016/02/21 14:20:56| Processing: http_port 3128 intercept ssl-bump
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
</I>&gt;<i> key=/etc/mydlp/ssl/private.pem cert=/etc/mydlp/ssl/public.pem
</I>
I strongly recommend that you keep things simple and avoid any SSL bumping 
until the basics are working.  Let's get HTTP intercept working first, and then 
you can think about SSL later (oh, and by the way, I saw no NAT rule to 
incercept SSL traffic on port 443 earlier, so I strongly suspect there's nothing 
to get bumped anyway, unless you have explicit proxy configuration in your 
clients).


Regards,


Antony.

-- 
&quot;In fact I wanted to be John Cleese and it took me some time to realise that 
the job was already taken.&quot;

 - Douglas Adams

                                                   Please reply to the list;
                                                         please *don't* CC me.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009203.html">[squid-users] Squid None Aborted problem
</A></li>
	<LI>Next message (by thread): <A HREF="009275.html">[squid-users] Squid None Aborted problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9204">[ date ]</a>
              <a href="thread.html#9204">[ thread ]</a>
              <a href="subject.html#9204">[ subject ]</a>
              <a href="author.html#9204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
