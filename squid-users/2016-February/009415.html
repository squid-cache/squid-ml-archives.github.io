<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20return%20gzip%20responses%20when%20I%20don%27t%0A%20include%20Accept-Encoding&In-Reply-To=%3C56D42FB8.4080802%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009414.html">
   <LINK REL="Next"  HREF="009418.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20return%20gzip%20responses%20when%20I%20don%27t%0A%20include%20Accept-Encoding&In-Reply-To=%3C56D42FB8.4080802%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Feb 29 11:47:04 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009414.html">[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding
</A></li>
        <LI>Next message (by thread): <A HREF="009418.html">[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9415">[ date ]</a>
              <a href="thread.html#9415">[ thread ]</a>
              <a href="subject.html#9415">[ subject ]</a>
              <a href="author.html#9415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/03/2016 12:08 a.m., Bermejo Gil, Alberto (EXT - ES) wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> In the squid proxy (3.3.3), if the first request is with the
</I>&gt;<i> Accept-Encoding: gzip header then all the next responses will also be
</I>&gt;<i> in gzip, whether I request with a specific Accept-Encoding or not.
</I>&gt;<i> 
</I>
What you describe is the behaviour that will happen if the server
responds with gzip and no Vary header.

That may be intentional on behalf of the server. There are some that try
to force 'efficiency' (aka bandwidth saving at any cost) by simply
returning gzip.


&gt;<i> I need something special in the squid.conf?
</I>&gt;<i> 
</I>&gt;<i> This is a rule for my domain:
</I>&gt;<i> 
</I>&gt;<i> refresh_pattern ^<A HREF="http://myip.com">http://myip.com</A> 60 100% 60 override-expire
</I>&gt;<i> override-lastmod reload-into-ims ignore-reload ignore-no-cache
</I>&gt;<i> ignore-private ignore-auth
</I>&gt;<i> 
</I>
Your pattern does not help. It forces Squid to cache the objects for a
minimum of 1 hour regardless of anything that might be used to correct
change or update the cached version (ie locating anything other than the
gzip one stored).

With these above settings the Vary header alone will be able to prevent
cache oddities like you are seeing.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009414.html">[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding
</A></li>
	<LI>Next message (by thread): <A HREF="009418.html">[squid-users] Squid proxy return gzip responses when I don't include Accept-Encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9415">[ date ]</a>
              <a href="thread.html#9415">[ thread ]</a>
              <a href="subject.html#9415">[ subject ]</a>
              <a href="author.html#9415">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
