<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay Pools or Traffic Shaping per port?!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20or%20Traffic%20Shaping%20per%20port%3F%21&In-Reply-To=%3C3F9E6BF9-67A4-4F6D-A956-1882ED3F4EC5%40fischie.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008555.html">
   <LINK REL="Next"  HREF="008568.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay Pools or Traffic Shaping per port?!</H1>
    <B>Christian Kunkel</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20Pools%20or%20Traffic%20Shaping%20per%20port%3F%21&In-Reply-To=%3C3F9E6BF9-67A4-4F6D-A956-1882ED3F4EC5%40fischie.com%3E"
       TITLE="[squid-users] Delay Pools or Traffic Shaping per port?!">ckunkel at fischie.com
       </A><BR>
    <I>Mon Jan  4 12:41:49 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008555.html">[squid-users] Delay Pools or Traffic Shaping per port?!
</A></li>
        <LI>Next message (by thread): <A HREF="008568.html">[squid-users] Delay Pools or Traffic Shaping per port?!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8558">[ date ]</a>
              <a href="thread.html#8558">[ thread ]</a>
              <a href="subject.html#8558">[ subject ]</a>
              <a href="author.html#8558">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

&gt;<i> Am 04.01.2016 um 12:46 schrieb Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:
</I>&gt;<i> 
</I>&gt;<i> Squid is limited to 64 listening ports. That can be extended a little in
</I>&gt;<i> exchange for reducing Squid operating speed, but 200-500 is going very
</I>&gt;<i> far. This will cause problems with your stated goal of handling Gbps,
</I>&gt;<i> Squid will need some fine tuning to get near that speed as it is.
</I>
ok. so actually i can run 3 or 4 instances of squid to acomplish my goal of 200 users? lets say the server needs to handle that amount of users and not squid. this would work i guess?

&gt;&gt;&gt;<i> Is there any reason you can't use authentication to identify different users?
</I>&gt;&gt;<i> it does not work with nated ips.
</I>&gt;<i> 
</I>&gt;<i> Authentication does.
</I>
ok. but i can not use authetication. the main os which will be used to connect to squid can not handle http auth headers. no arp and so on. or lets say it this way: no way to get something unique out of the os to autheticate or authorize on. only thing is used are ports. every user gets a unique port to work with. after login through captive this port is redirected to squid. that ports is actually opened for everyone for 48h. after that time user will see captive to login again. lets say: thats not the best way but the best way i could come up with to do something like authetication. maybe there is a better way but i did not find something to make it better.
&gt;<i> 
</I>&gt;&gt;<i> it autheticates with ip adress anyway.
</I>&gt;<i> 
</I>&gt;<i> That is *not* Authentication. That is IP based authorization (access
</I>&gt;<i> control).
</I>
explained above.
&gt;<i> 
</I>&gt;&gt;<i> so it will limit the ip to 10mbit but behind that ip there are maybe 10 or more ppl.
</I>&gt;<i> 
</I>&gt;<i> With authentication each of these &quot;ppl&quot; has different credentials and
</I>&gt;<i> messages using those credentials are used to count the bandwidth shaping
</I>&gt;<i> towards each user.
</I>&gt;<i> 
</I>&gt;<i> If your system defines a &quot;user&quot; as being one IP address. Then the IP
</I>&gt;<i> address is what the traffic needs to be accounted against.
</I>
main problem of NATed users (in my case): their ip adresses changes from time to time or based on their location. so if ip is used for authorization then a big amount gets ahthorized or they need to relogin constantly. not that nice.
&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> What stops users &quot;investigating&quot; the system, and finding out they can get extra 
</I>&gt;&gt;&gt;<i> bandwidth by using ports which haven't been assigned to them?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> thats the second problem to deal with. there is some kind of a captive portal with login but it opens the port after user autheticates so actually someone else can use that port. so if you have an idea. i would be really thankful :)
</I>&gt;<i> 
</I>&gt;<i> FYI: the only thing that Squid can do that OS level QoS controls cannot
</I>&gt;<i> easily do is base its shaping on HTTP message header values (ie the
</I>&gt;<i> users proxy-auth credentials).
</I>
the os does not really save those credentials. every http request then asks for the credentials. thats to messed up this way.
&gt;<i> 
</I>&gt;<i> Since you want to do this shaping &quot;per-user&quot; without authentication
</I>&gt;<i> credentials to correctly identify what a single &quot;user&quot; actually is and
</I>&gt;<i> are instead basing the definition of &quot;user&quot; as stuff coming from an IP
</I>&gt;<i> address (that IP based authorization) - then OS level QoS controls
</I>&gt;<i> shaping the traffic based on IP address is the best you are going to
</I>&gt;<i> get. Despite the NAT related issues.
</I>
see above for ports as unique definition of a user.
&gt;<i> 
</I>&gt;<i> The captive portal device is the right place for the bandwidth shaping
</I>&gt;<i> to be enacted. It has access to both the original client IP and whatever
</I>&gt;<i> authentication details is uses.
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>&gt;<i> ______________________________________________
</I>
Kind regards,

Chris
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008555.html">[squid-users] Delay Pools or Traffic Shaping per port?!
</A></li>
	<LI>Next message (by thread): <A HREF="008568.html">[squid-users] Delay Pools or Traffic Shaping per port?!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8558">[ date ]</a>
              <a href="thread.html#8558">[ thread ]</a>
              <a href="subject.html#8558">[ subject ]</a>
              <a href="author.html#8558">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
