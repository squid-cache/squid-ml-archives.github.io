<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 4.0.3 - sslflags not working?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.0.3%20-%20sslflags%20not%20working%3F&In-Reply-To=%3C5691E742.4010502%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008631.html">
   <LINK REL="Next"  HREF="008551.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 4.0.3 - sslflags not working?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.0.3%20-%20sslflags%20not%20working%3F&In-Reply-To=%3C5691E742.4010502%40treenet.co.nz%3E"
       TITLE="[squid-users] squid 4.0.3 - sslflags not working?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jan 10 05:08:18 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008631.html">[squid-users] squid 4.0.3 - sslflags not working?
</A></li>
        <LI>Next message (by thread): <A HREF="008551.html">[squid-users] Compile install Squid, configure default options.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8648">[ date ]</a>
              <a href="thread.html#8648">[ thread ]</a>
              <a href="subject.html#8648">[ subject ]</a>
              <a href="author.html#8648">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/01/2016 10:06 a.m., Florian Stamer wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> testet the latest Snapshot and the 4.0.4
</I>&gt;<i> 
</I>&gt;<i> Still the same.
</I>
Thanks for the quick feedback. Not sure what to look at this point, the
context creation logic in Squid all seems to be checking the right flags.

Hopefully Christos might have an idea what I'm overlooking, so cc'ing
just in case he has not seen this yet.

Amos

&gt;<i> -----Urspr&#252;ngliche Nachricht-----
</I>&gt;<i> Von: Amos Jeffries
</I>&gt;<i> 
</I>&gt;<i> On 4/01/2016 8:58 a.m., Florian Stamer wrote:
</I>&gt;&gt;<i> Hi I,m currently testing Squid 4.0.3 in Reverse Proxy Mode.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It seems that the sslflags directives &quot;DONT_VERIFY_PEER&quot; and &quot;DONT_VERIFY_DOMAIN&quot; do not work.
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Should be. They are planned for removal, but nothing towards that has ot happened yet.
</I>&gt;<i> 
</I>&gt;&gt;<i> Here is the relevant config:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> https_port 443 accel cert=/etc/squid/ssl/wildcard.cer
</I>&gt;&gt;<i> key=/etc/squid/ssl/wildcard.key defaultsite=externeURL
</I>&gt;&gt;<i> cipher=HIGH:!aNULL options=SINGLE_DH_USE,NO_SSLv3
</I>&gt;&gt;<i> dhparams=/etc/squid/ssl/dhparams.pem
</I>
&gt;&gt;<i> cache_peer localserver parent 443 0 proxy-only no-query no-digest
</I>&gt;&gt;<i> front-end-https=on originserver login=PASS ssl ssloptions=NO_SSLv3
</I>&gt;&gt;<i> sslflags=DONT_VERIFY_PEER,DONT_VERIFY_DOMAIN name=ExchangeCAS
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It perfectly workes in my production System based on Ubuntu LTS 14.04.3, Squid 3.3.8.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Everytime i try to access the site i get an error:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The system returned:
</I>&gt;&gt;<i> (71) Protocol error (TLS code: SQUID_X509_V_ERR_DOMAIN_MISMATCH)
</I>&gt;&gt;<i> Certificate does not match domainname
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm using a SAN Certificate...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can workaround this using the directive &quot;sslproxy_cert_error allow all&quot;. But that is not what i want...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Are there any issues known?
</I>&gt;&gt;<i> Is something wrong with my config?
</I>&gt;<i> 
</I>&gt;<i> Nothing obvious.
</I>&gt;<i> 
</I>&gt;<i> It might be related to one of the issues fixed since 4.0.3 was packaged.
</I>&gt;<i> Are you able to try the latest 4.x snapshot ?
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008631.html">[squid-users] squid 4.0.3 - sslflags not working?
</A></li>
	<LI>Next message (by thread): <A HREF="008551.html">[squid-users] Compile install Squid, configure default options.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8648">[ date ]</a>
              <a href="thread.html#8648">[ thread ]</a>
              <a href="subject.html#8648">[ subject ]</a>
              <a href="author.html#8648">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
