<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ssl-bump and accel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl-bump%20and%20accel&In-Reply-To=%3C56923CFE.7090903%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008654.html">
   <LINK REL="Next"  HREF="008597.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ssl-bump and accel</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ssl-bump%20and%20accel&In-Reply-To=%3C56923CFE.7090903%40treenet.co.nz%3E"
       TITLE="[squid-users] ssl-bump and accel">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jan 10 11:14:06 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008654.html">[squid-users] ssl-bump and accel
</A></li>
        <LI>Next message (by thread): <A HREF="008597.html">[squid-users] Intercepting BITS_POST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8655">[ date ]</a>
              <a href="thread.html#8655">[ thread ]</a>
              <a href="subject.html#8655">[ subject ]</a>
              <a href="author.html#8655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/01/2016 10:26 p.m., Nir Krakowski wrote:
&gt;<i> 1. You're forgetting I only refer specific traffic using /etc/hosts to
</I>&gt;<i> squid.
</I>
You missed my point.

1) clientConn is where the traffic *came from*. Not where it is going to.

2) Host: header verification is only relevant to MITM (intercept/tproxy
port) traffic. Patching it at all is wrong for accel port traffic. And
the patch you published is more than just dangerous when used on an MITM
proxy.

3) ssl-bump is not supported on accel ports:
 - http_port accel does not accept CONNECT, so nothing to bump.
 - https_port accel initializes its server TLS context differently to
ssl-bump, so the context created is bad for bumping.
 - https_port accel decrypts the TLS using different code than ssl-bump


&gt;<i> 2. What do you suggest ? I want to use the SNI as the direction of the
</I>&gt;<i> traffic, not the forwarded IP address.
</I>
&quot;accel&quot; mode traffic uses the URL for server selection. Both the
forwarded IP address and the SNI are irrelevant and ignored.

Think of it like this:
 If you take an apple and paint it to look like an apple. All you have
done is make it poisonous to eat. Not cease being an apple.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008654.html">[squid-users] ssl-bump and accel
</A></li>
	<LI>Next message (by thread): <A HREF="008597.html">[squid-users] Intercepting BITS_POST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8655">[ date ]</a>
              <a href="thread.html#8655">[ thread ]</a>
              <a href="subject.html#8655">[ subject ]</a>
              <a href="author.html#8655">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
