<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Compile install Squid, configure default options.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Compile%20install%20Squid%2C%20configure%20default%20options.&In-Reply-To=%3C56955FE3.7090000%40afo.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008723.html">
   <LINK REL="Next"  HREF="008713.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Compile install Squid, configure default options.</H1>
    <B>Mike</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Compile%20install%20Squid%2C%20configure%20default%20options.&In-Reply-To=%3C56955FE3.7090000%40afo.net%3E"
       TITLE="[squid-users] Compile install Squid, configure default options.">mcsnv96 at afo.net
       </A><BR>
    <I>Tue Jan 12 20:19:47 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008723.html">[squid-users] Compile install Squid, configure default options.
</A></li>
        <LI>Next message (by thread): <A HREF="008713.html">[squid-users] Compile install Squid, configure default options.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8696">[ date ]</a>
              <a href="thread.html#8696">[ thread ]</a>
              <a href="subject.html#8696">[ subject ]</a>
              <a href="author.html#8696">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When I used CentOS 7 (a variation of it), this is what I had to use:

  *

    yum -y install perl gcc gcc-c++ autoconf automake make

  *

    *yum -**y **install epel-release*

      o

        (has a few packages we need below)

  *

    yum -y install libxml2-devel libcap-devel avr-gcc-c++

  *

    yum -y install libtool-ltdl-devel openssl-devel

  *

    yum -y install ksh perl-Crypt-OpenSSL-X509

I prefer separate lines with only a few to be installed since if theres 
a problem with one, it is more likely to show an error rather than be 
buried.


With 3.5.5 they made some changes so for 3.5.5 and newer, certain 
configure options no longer work that previously did as far back as 
3.1.x. This is for 64bit, there are a few small differences for 32 bit OS.

  *

    ./configure '--program-prefix=' '--prefix=/usr' '--exec-prefix=/usr'
    '--bindir=/usr/bin' '--sbindir=/usr/sbin' '--sysconfdir=/etc'
    '--datadir=/usr/share' '--includedir=/usr/include'
    '--libdir=/usr/lib64' '--libexecdir=/usr/libexec'
    '--sharedstatedir=/var/lib' '--mandir=/usr/share/man'
    '--infodir=/usr/share/info' '--exec_prefix=/usr'
    '--libexecdir=/usr/lib64/squid' '--localstatedir=/var'
    '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid'
    '--with-logdir=$(localstatedir)/log/squid'
    '--with-pidfile=$(localstatedir)/run/squid.pid'
    '--disable-dependency-tracking' '--enable-follow-x-forwarded-for'
    '--enable-cache-digests' '--enable-cachemgr-hostname=localhost'
    '--enable-delay-pools' '--enable-epoll' '--enable-icap-client'
    '--enable-ident-lookups' '--enable-linux-netfilter'
    '--enable-removal-policies=heap,lru' '--enable-snmp'
    '--enable-storeio=aufs,diskd,ufs,rock' '--enable-wccpv2'
    '--enable-esi' '--enable-ssl' '--enable-ssl-crtd' '--enable-icmp'
    '--with-aio' '--with-default-user=squid'
    '--with-filedescriptors=1024' '--with-dl' '--with-openssl'
    '--with-pthreads' '--with-included-ltdl' '--disable-arch-native'
    'CFLAGS=-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
    -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic'
    'CXXFLAGS=-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
    -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic
    -fPIC' 'PKG_CONFIG_PATH=/usr/lib64/pkgconfig:/usr/share/pkgconfig'



There are small variations in CentOS that make it different from other 
linux operating systems, so when I've had issues with missing configure 
options, I installed the available version from yum, then went through 
one by one and found what I needed, mirrored it to an extent for 
building from source. I also added my ssl based options.
I have 2 different CentOS 7 based systems running squid with no problems 
using this setup.

Mike





On 1/12/2016 13:34 PM, Billy.Zheng(zw963) wrote:
&gt;&gt;&gt;<i> Or, just tell me, this worked, it is fine, and I will very happy to use.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> btw: When I first install, ./configure is passed, but make is failed.
</I>&gt;&gt;&gt;<i> because I am not install gcc-c++. I have to install gcc-c++, reconfigure
</I>&gt;&gt;&gt;<i> again, make is passed. I thought if ./configure could detect gcc-c++
</I>&gt;&gt;&gt;<i> is not installed, will more good.
</I>&gt;&gt;<i> What C++ compiler did you have installed instead of gcc-c++ ?
</I>&gt;<i> I use CentOS 7.0 in VPS.
</I>&gt;<i>
</I>&gt;<i> I just follow squid document from here: <A HREF="http://wiki.squid-cache.org/SquidFaq/CompilingSquid">http://wiki.squid-cache.org/SquidFaq/CompilingSquid</A>
</I>&gt;<i>
</I>&gt;<i> with following operation:
</I>&gt;<i>
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at vultr</A> squid-3.5.12]# yum install -y perl gcc autoconf automake make sudo wget
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at vultr</A> squid-3.5.12]# yum install openssl-devel
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at vultr</A> squid-3.5.12]# g++
</I>&gt;<i> -bash: g++: command not found
</I>&gt;<i>
</I>&gt;<i> and then run my new config, Thanks for guide.
</I>&gt;<i>
</I>&gt;<i>      ./configure --build=x86_64-linux-gnu \
</I>&gt;<i>          --prefix=/usr \
</I>&gt;<i>          --exec-prefix=/usr \
</I>&gt;<i>          '--bindir=${prefix}/bin' \
</I>&gt;<i>          '--sbindir=${prefix}/sbin' \
</I>&gt;<i>          '--libdir=${prefix}/lib64' \
</I>&gt;<i>          '--libexecdir=${prefix}/lib64/squid' \
</I>&gt;<i>          '--includedir=${prefix}/include' \
</I>&gt;<i>          '--datadir=${prefix}/share/squid' \
</I>&gt;<i>          '--mandir=${prefix}/share/man' \
</I>&gt;<i>          '--infodir=${prefix}/share/info' \
</I>&gt;<i>          --localstatedir=/var \
</I>&gt;<i>          '--with-logdir=${localstatedir}/log/squid' \
</I>&gt;<i>          '--with-pidfile=${localstatedir}/run/squid.pid' \
</I>&gt;<i>          '--with-swapdir=${localstatedir}/spool/squid' \
</I>&gt;<i>          --sysconfdir=/etc/squid \
</I>&gt;<i>          --with-openssl \
</I>&gt;<i>          --with-default-user=squid \
</I>&gt;<i>          --with-filedescriptors=16384
</I>&gt;<i>
</I>&gt;<i> it worked. and end with Makefile created.
</I>&gt;<i>
</I>&gt;<i> It seem like not c++ compile included initially, ./configure is not detect out
</I>&gt;<i> for it for this OS, so no any error occur.
</I>&gt;<i>
</I>&gt;<i> when I run make, it told me `g++: command not found'
</I>&gt;<i>
</I>&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at vultr</A> squid-3.5.12]# make
</I>&gt;<i> Making all in compat
</I>&gt;<i> make[1]: Entering directory `/root/squid-3.5.12/compat'
</I>&gt;<i> source='assert.cc' object='assert.lo' libtool=yes \
</I>&gt;<i> DEPDIR=.deps depmode=none /bin/sh ../cfgaux/depcomp \
</I>&gt;<i> /bin/sh ../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H   -I.. -I../include -I../lib -I../src -I../include   -I../libltdl    -c -o assert.lo assert.cc
</I>&gt;<i> libtool: compile:  g++ -DHAVE_CONFIG_H -I.. -I../include -I../lib -I../src -I../include -I../libltdl -c assert.cc  -o .libs/assert.o
</I>&gt;<i> ../libtool: line 1125: g++: command not found
</I>&gt;<i> make[1]: *** [assert.lo] Error 1
</I>&gt;<i> make[1]: Leaving directory `/root/squid-3.5.12/compat'
</I>&gt;<i> make: *** [all-recursive] Error 1
</I>&gt;<i>
</I>&gt;<i> following is a part of ./configure output:
</I>&gt;<i>
</I>&gt;<i> checking for a BSD-compatible install... /usr/bin/install -c
</I>&gt;<i> checking whether build environment is sane... yes
</I>&gt;<i> checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
</I>&gt;<i> checking for gawk... gawk
</I>&gt;<i> checking whether make sets $(MAKE)... yes
</I>&gt;<i> checking whether make supports nested variables... yes
</I>&gt;<i> checking whether UID '0' is supported by ustar format... yes
</I>&gt;<i> checking whether GID '0' is supported by ustar format... yes
</I>&gt;<i> checking how to create a ustar tar archive... gnutar
</I>&gt;<i> checking whether to enable maintainer-specific portions of Makefiles... no
</I>&gt;<i> checking for gcc... gcc
</I>&gt;<i> checking whether the C compiler works... yes
</I>&gt;<i> checking for C compiler default output file name... a.out
</I>&gt;<i> checking for suffix of executables...
</I>&gt;<i> checking whether we are cross compiling... no
</I>&gt;<i> checking for suffix of object files... o
</I>&gt;<i> checking whether we are using the GNU C compiler... yes
</I>&gt;<i> checking whether gcc accepts -g... yes
</I>&gt;<i> checking for gcc option to accept ISO C89... none needed
</I>&gt;<i> checking whether gcc understands -c and -o together... yes
</I>&gt;<i> checking for style of include used by make... GNU
</I>&gt;<i> checking dependency style of gcc... gcc3
</I>&gt;<i> checking for g++... no
</I>&gt;<i> checking for c++... no
</I>&gt;<i> checking for gpp... no
</I>&gt;<i> checking for aCC... no
</I>&gt;<i> checking for CC... no
</I>&gt;<i> checking for cxx... no
</I>&gt;<i> checking for cc++... no
</I>&gt;<i> checking for cl.exe... no
</I>&gt;<i> checking for FCC... no
</I>&gt;<i> checking for KCC... no
</I>&gt;<i> checking for RCC... no
</I>&gt;<i> checking for xlC_r... no
</I>&gt;<i> checking for xlC... no
</I>&gt;<i> checking whether we are using the GNU C++ compiler... no
</I>&gt;<i> checking whether g++ accepts -g... no
</I>&gt;<i> checking dependency style of g++... none
</I>&gt;<i> checking build system type... x86_64-pc-linux-gnu
</I>&gt;<i> checking host system type... x86_64-pc-linux-gnu
</I>&gt;<i> configure: CPU arch native optimization enabled: auto
</I>&gt;<i> checking whether compiler accepts -march=native... no
</I>&gt;<i> checking simplified host os... linux (version )
</I>&gt;<i> checking what kind of compiler we're using... none
</I>&gt;<i> checking whether g++ supports C++11 features by default... no
</I>&gt;<i> checking whether g++ supports C++11 features with -std=c++11... no
</I>&gt;<i> checking whether g++ supports C++11 features with -std=c++0x... no
</I>&gt;<i> configure: No compiler with C++11 support was found
</I>&gt;<i> checking for ranlib... ranlib
</I>&gt;<i> checking how to run the C preprocessor... gcc -E
</I>&gt;<i> checking whether ln -s works... yes
</I>&gt;<i> checking for egrep... /usr/bin/egrep
</I>&gt;<i> checking for sh... /usr/bin/sh
</I>&gt;<i> checking for false... /usr/bin/false
</I>&gt;<i> checking for true... /usr/bin/true
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160112/8673a49d/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160112/8673a49d/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008723.html">[squid-users] Compile install Squid, configure default options.
</A></li>
	<LI>Next message (by thread): <A HREF="008713.html">[squid-users] Compile install Squid, configure default options.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8696">[ date ]</a>
              <a href="thread.html#8696">[ thread ]</a>
              <a href="subject.html#8696">[ subject ]</a>
              <a href="author.html#8696">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
