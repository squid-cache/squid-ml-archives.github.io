<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 3.1 ldap authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.1%20ldap%20authentication&In-Reply-To=%3CCABrZ10xn7zMN4BDNx1SBm39VEGy-6tfKf5-%2BP8-waNg3dwdfjQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008888.html">
   <LINK REL="Next"  HREF="008915.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 3.1 ldap authentication</H1>
    <B>nando mendonca</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.1%20ldap%20authentication&In-Reply-To=%3CCABrZ10xn7zMN4BDNx1SBm39VEGy-6tfKf5-%2BP8-waNg3dwdfjQ%40mail.gmail.com%3E"
       TITLE="[squid-users] squid 3.1 ldap authentication">nandomendonca007 at gmail.com
       </A><BR>
    <I>Mon Jan 25 15:52:35 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008888.html">[squid-users] Squid 3.5.13 unable to establish ssl-bump connection
</A></li>
        <LI>Next message (by thread): <A HREF="008915.html">[squid-users] squid 3.1 ldap authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8891">[ date ]</a>
              <a href="thread.html#8891">[ thread ]</a>
              <a href="subject.html#8891">[ subject ]</a>
              <a href="author.html#8891">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,

I'm running squid 3.5.12, i'm using ldap for authentication. When trying to
browse the internet from clients it takes up to 10 minutes for the website
to load. Can you please assist me in troubleshooting what the issue is?
Below is my squid.conf file.




cache_mem 1048 MB

cache_log /usr/local/squid1/var/logs/cache.log

cache_swap_high 95

cache_swap_low 90

dns_nameservers x.x.x.x



#acl manager proto cache_object

#acl localhost src 127.0.0.1/32 ::1

#acl to_localhost dst 127.0.0.0/8 0.0.0.0/32 ::1


# Example rule allowing access from your local networks.

# Adapt to list your (internal) IP networks from where browsing

# should be allowed

#acl localnet src 10.0.0.0/8    # RFC1918 possible internal network

#acl localnet src x.x.x.x.0/24

#acl localnet src 172.16.0.0/12 # RFC1918 possible internal network

#acl localnet src 192.168.0.0/16        # RFC1918 possible internal network

#acl localnet src fc00::/7       # RFC 4193 local private network range

#acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
machines


## Ports to allow:

acl Safe_ports port 443         # https

acl Safe_ports port 80          # http

acl Safe_ports port 8080

#acl Safe_ports port 21         # ftp

#acl Safe_ports port 70         # gopher

#acl Safe_ports port 210                # wais

#acl Safe_ports port 1025-65535 # unregistered ports

#acl Safe_ports port 280                # http-mgmt

#acl Safe_ports port 488                # gss-http

#acl Safe_ports port 591                # filemaker

#acl Safe_ports port 777                # multiling http


## CONNECT method:

#acl CONNECT method CONNECT


## LDAP Authentication ##

auth_param basic program /usr/local/squid1/libexec/basic_ldap_auth -b
&quot;dc=ldap,dc=corp,dc=domain,dc=com&quot; -f &quot;uid=%s&quot; ldapserv.corp.domain.com

auth_param basic children 5

#auth_param basic realm Web-Proxy

auth_param basic credentialsttl 30 minutes

acl ldap-auth proxy_auth REQUIRED


## Visible Hostname ##

visible_hostname proxy-01



external_acl_type ldap_group %LOGIN
/usr/local/squid1/libexec/ext_ldap_group_acl -R -b
&quot;ou=groups,dc=gcsldap,dc=corp,dc=domain,dc=com&quot; -D
&quot;cn=cost,ou=admin,dc=gcsldap,dc=corp,dc=domain,dc=com&quot; -f &quot;(&amp;(memberuid=%u)
(cn=%a))&quot; -w password -h ldap.corp.domain.com



#external_acl_type ldap_group %LOGIN /usr/lib64/squid/squid_ldap_group -R
-b &quot;ou=groups,dc=mydomain,dc=net&quot; -D &quot;cn=root,dc=mydomain,dc=net&quot; -f
&quot;(&amp;(sn=%u) (cn=%a))&quot; -w password -h localhost


#http_access allow ldap-auth


## ACL's for group checking ##


acl yumrepo external ldap_group yumrepo

acl winupdate external ldap_group winupdate

acl network-update external ldap_group network-update


## ACL's for url domains ##


acl rule1 url_regex -i &quot;/usr/local/squid1/etc/allowed/yumrepo/domains&quot;

acl rule2 url_regex -i &quot;/usr/local/squid1/etc/allowed/winupdate/domains&quot;

acl rule3 url_regex -i
&quot;/usr/local/squid1/etc/allowed/network-update/domains&quot;



# Only allow cachemgr access from localhost

http_access allow manager localhost

http_access deny manager


# Deny requests to certain unsafe ports

http_access deny !Safe_ports


# Deny CONNECT to other than secure SSL ports

#http_access deny CONNECT !SSL_ports


# We strongly recommend the following be uncommented to protect innocent

# web applications running on the proxy server who think the only

# one who can access services on &quot;localhost&quot; is a local user

http_access deny to_localhost


#

# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS

#


# Example rule allowing access from your local networks.

# Adapt localnet in the ACL section to list your (internal) IP networks

# from where browsing should be allowed

#http_access allow localnet

#http_access allow localhost


http_access allow rule1 ldap-auth yumrepo

http_access allow rule2 ldap-auth winupdate

http_access allow rule3 ldap-auth network-update


# And finally deny all other access to this proxy

#http_access deny all


# Squid normally listens to port 3128

http_port 8080


# Uncomment and adjust the following to add a disk cache directory.

maximum_object_size 1000 MB

cache_dir ufs /var/spool/squid 1000 16 256


# Leave coredumps in the first cache dir

coredump_dir /var/spool/squid




# Add any of your own refresh_pattern entries above these.

#refresh_pattern ^ftp:          1440    20%     10080

#refresh_pattern ^gopher:       1440    0%      1440

#refresh_pattern -i (/cgi-bin/|\?) 0    0%      0

#refresh_pattern -i \.(iso|avi|wav|mp3|mp4|mpeg|swf|flv|x-flv)$ 43200 90%
432000 override-expire override-lastmod ignore-no-cache ignore-no-store
ignore-private

#refresh_pattern -i .(deb|rpm|exe|zip|tar|tgz|bz2|ram|rar|bin)$  129600
100% 129600 override-expire ignore-no-cache ignore-no-store


refresh_pattern .               0       20%     4320

debug_options ALL,1 33,2 28,9






























































On Wed, Oct 7, 2015 at 12:18 PM, nando mendonca &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">nandomendonca007 at gmail.com</A>&gt;
wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have squid 3.1 installed using ldap authentication. When i access a
</I>&gt;<i> browser i enter my ldap credentials and it works fine. I&#8217;m able to browse
</I>&gt;<i> all sites without any issues.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Is there a way to use ldap groups to allow certain groups access to a few
</I>&gt;<i> sites on the internet and then pretty much block everything else?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I&#8217;m able to restrict access to only a couple of sites and block everything
</I>&gt;<i> else without using ldap group authentication, was just hoping this can be
</I>&gt;<i> done with ldap group authentication.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Nando
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160125/589e0630/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160125/589e0630/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008888.html">[squid-users] Squid 3.5.13 unable to establish ssl-bump connection
</A></li>
	<LI>Next message (by thread): <A HREF="008915.html">[squid-users] squid 3.1 ldap authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8891">[ date ]</a>
              <a href="thread.html#8891">[ thread ]</a>
              <a href="subject.html#8891">[ subject ]</a>
              <a href="author.html#8891">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
