<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] forwarded_for problems log client ip apache 2.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20forwarded_for%20problems%20log%20client%20ip%20apache%202.4&In-Reply-To=%3C56AA3EB6.9000101%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008909.html">
   <LINK REL="Next"  HREF="008913.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] forwarded_for problems log client ip apache 2.4</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20forwarded_for%20problems%20log%20client%20ip%20apache%202.4&In-Reply-To=%3C56AA3EB6.9000101%40treenet.co.nz%3E"
       TITLE="[squid-users] forwarded_for problems log client ip apache 2.4">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Jan 28 16:15:50 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008909.html">[squid-users] forwarded_for problems log client ip apache 2.4
</A></li>
        <LI>Next message (by thread): <A HREF="008913.html">[squid-users] forwarded_for problems log client ip apache 2.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8910">[ date ]</a>
              <a href="thread.html#8910">[ thread ]</a>
              <a href="subject.html#8910">[ subject ]</a>
              <a href="author.html#8910">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/01/2016 2:38 a.m., L.P.H. van Belle wrote:
&gt;<i> Hai, 
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I having some troubles to get my client ip (and/or hostname) logged in my apache webserver. 
</I>&gt;<i> 
</I>&gt;<i> I do think this is something in my squid setup, but i can find it..  
</I>&gt;<i> 
</I>&gt;<i> So if anyone can help me out a bit, would be great. 
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I&#8217;ve tested with the forwarded_for options tried all options here.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Versions/v3/3.5/cfgman/forwarded_for.html">http://www.squid-cache.org/Versions/v3/3.5/cfgman/forwarded_for.html</A> 
</I>&gt;<i> 
</I>
&quot;forwarded_for on&quot; is the correct one - and the default value BTW, so
you dont need to configure anything for Squid to do its part of this.

I can see that being used in your squid.conf. So the problem is either
that the requests you see really do have *no* client, or a different
client to what you are thinking, or a problem in Apache.


&gt;<i> 
</I>&gt;<i> im using Debian Jessie, Apache 2.4 with mod_remoteip 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://httpd.apache.org/docs/current/mod/mod_remoteip.html#remoteipheader">http://httpd.apache.org/docs/current/mod/mod_remoteip.html#remoteipheader</A> 
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> My settings for remoteip   ( and yes the modules is enabled ) 
</I>&gt;<i> 
</I>&gt;<i> a2query -m | grep remote
</I>&gt;<i> 
</I>&gt;<i> remoteip (enabled by site administrator)
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> &lt;IfModule mod_remoteip&gt;
</I>&gt;<i> 
</I>&gt;<i>     # for remote proxy setup
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPHeader X-Forwarded-For
</I>&gt;<i> 
</I>&gt;<i>     # for cluster setup
</I>&gt;<i> 
</I>&gt;<i>     #RemoteIPHeader X-Real-IP
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPTrustedProxy 127.0.0.1/8
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPTrustedProxy 192.168.x.x/24
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPTrustedProxy 192.168.x.x/24
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPTrustedProxy prxy1.internal.domain.tld
</I>&gt;<i> 
</I>&gt;<i>     RemoteIPTrustedProxy prxy2.internal.domain.tld
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> #original : LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
</I>&gt;<i> 
</I>&gt;<i> LogFormat &quot;%a %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> &lt;/IfModule&gt;
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> any tips on howto debug this, i did find lots of things with google, but none worked for me. 
</I>&gt;<i> 
</I>
That is an issue to take up with the Apache support groups. If you are
lucky someone here might know, but its really off-topic.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008909.html">[squid-users] forwarded_for problems log client ip apache 2.4
</A></li>
	<LI>Next message (by thread): <A HREF="008913.html">[squid-users] forwarded_for problems log client ip apache 2.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8910">[ date ]</a>
              <a href="thread.html#8910">[ thread ]</a>
              <a href="subject.html#8910">[ subject ]</a>
              <a href="author.html#8910">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
