<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 3.1 ldap authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.1%20ldap%20authentication&In-Reply-To=%3C56AD6187.10407%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008915.html">
   <LINK REL="Next"  HREF="008916.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 3.1 ldap authentication</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.1%20ldap%20authentication&In-Reply-To=%3C56AD6187.10407%40ngtech.co.il%3E"
       TITLE="[squid-users] squid 3.1 ldap authentication">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Jan 31 01:21:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="008915.html">[squid-users] squid 3.1 ldap authentication
</A></li>
        <LI>Next message (by thread): <A HREF="008916.html">[squid-users] squid 3.1 ldap authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8934">[ date ]</a>
              <a href="thread.html#8934">[ thread ]</a>
              <a href="subject.html#8934">[ subject ]</a>
              <a href="author.html#8934">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Just to update the thread.

A basic CLI test showed it's not an issue related to anything in the 
LDAP helpers or settings.
The issue was IPV6 network level issue, there was a default gateway but 
for some unknown reason there was no IPV6 connectivity.
The test host could be any host with both IPV6 and IPV4 dns records that 
has at-least one IPV6 record. Due to request_start_timeout default of 5 
minutes the site took about 5 minutes to show up after the IPV6 try was 
timed out.
The basic way to test it is running a simple script on the host machine 
that will test IPV6 connectivity. The right way to do that should be 
using a basic IPV6 ping like this script:
- <A HREF="http://paste.ngtech.co.il/pxizenek2">http://paste.ngtech.co.il/pxizenek2</A>
- <A HREF="http://ngtech.co.il/squid/ipv6_test.sh">http://ngtech.co.il/squid/ipv6_test.sh</A>

But since it is known that opening the whole IPV6 ICMP protocol in 
FireWalls opens network vulnerabilities it is commonly disabled(while it 
be opened properly) and there for makes it's an issue to test IPV6 
connectivity based only on ICMP.

Example ip6tables ICMPv6 rules that will allow a router to pass a basic 
ping6 test:
ip6tables -A FORWARD -p icmpv6 --icmpv6-type destination-unreachable -j 
ACCEPT
ip6tables -A FORWARD -p icmpv6 --icmpv6-type packet-too-big -j ACCEPT
ip6tables -A FORWARD -p icmpv6 --icmpv6-type time-exceeded -j ACCEPT
ip6tables -A FORWARD -p icmpv6 --icmpv6-type parameter-problem -j ACCEPT
ip6tables -A FORWARD -p icmpv6 --icmpv6-type echo-request -j ACCEPT
ip6tables -A FORWARD -p icmpv6 --icmpv6-type echo-reply -j ACCEPT
ip6tables -A FORWARD -p icmpv6 -j DROP

Later I will upgrade the script to test tcp\http level connectivity so 
it will be more useful as a debugging tool.

* <A HREF="http://www.squid-cache.org/Doc/config/request_start_timeout/">http://www.squid-cache.org/Doc/config/request_start_timeout/</A>
* <A HREF="https://www.cert.org/downloads/IPv6/ip6tables_rules.txt">https://www.cert.org/downloads/IPv6/ip6tables_rules.txt</A>
* <A HREF="https://www.sixxs.net/wiki/IPv6_Firewalling">https://www.sixxs.net/wiki/IPv6_Firewalling</A>

On 29/01/2016 03:50, Nando Mendonca wrote:
&gt;<i> Thanks! I ran tcpdump, didnt really notice anything. Any other suggesstions?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Nando
</I>&gt;<i>
</I>&gt;&gt;<i> On Jan 25, 2016, at 10:07 AM, Anders Gustafsson &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Anders.Gustafsson at pedago.fi</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Do a packet trace on the LDAP connection. I bet the delay happens there. Also: I suspect that it might do the same LDAP lookup for EVERY HTTP session of which there might be thousands for a complex page.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> nando mendonca &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">nandomendonca007 at gmail.com</A>&gt; 2016-01-25 17:52 &gt;&gt;&gt;
</I>&gt;&gt;<i> I'm running squid 3.5.12, i'm using ldap for authentication. When trying to
</I>&gt;&gt;<i> browse the internet from clients it takes up to 10 minutes for the website
</I>&gt;&gt;<i> to load. Can you please assist me in troubleshooting what the issue is?
</I>&gt;&gt;<i> Below is my squid.conf file.
</I>&gt;&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="008915.html">[squid-users] squid 3.1 ldap authentication
</A></li>
	<LI>Next message (by thread): <A HREF="008916.html">[squid-users] squid 3.1 ldap authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8934">[ date ]</a>
              <a href="thread.html#8934">[ thread ]</a>
              <a href="subject.html#8934">[ subject ]</a>
              <a href="author.html#8934">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
