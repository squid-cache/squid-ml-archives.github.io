<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Skype, SSL bump and go.trouter.io
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Skype%2C%20SSL%20bump%20and%20go.trouter.io&In-Reply-To=%3C577E1672.2060204%40opendium.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011448.html">
   <LINK REL="Next"  HREF="011463.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Skype, SSL bump and go.trouter.io</H1>
    <B>Steve Hill</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Skype%2C%20SSL%20bump%20and%20go.trouter.io&In-Reply-To=%3C577E1672.2060204%40opendium.com%3E"
       TITLE="[squid-users] Skype, SSL bump and go.trouter.io">steve at opendium.com
       </A><BR>
    <I>Thu Jul  7 08:44:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011448.html">[squid-users] Skype, SSL bump and go.trouter.io
</A></li>
        <LI>Next message (by thread): <A HREF="011463.html">[squid-users] Skype, SSL bump and go.trouter.io
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11462">[ date ]</a>
              <a href="thread.html#11462">[ thread ]</a>
              <a href="subject.html#11462">[ subject ]</a>
              <a href="author.html#11462">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/07/16 20:44, Eliezer Croitoru wrote:

&gt;<i> There are couple options to the issue and a bad request can happen if
</I>&gt;<i> squid transforms or modifies the request. Did you tried to use basic
</I>&gt;<i> debug sections output to verify if you are able to &quot;replicate&quot; the
</I>&gt;<i> request using a tiny script or curl? I think that section 11 is the
</I>&gt;<i> right one to start with
</I>&gt;<i> (<A HREF="http://wiki.squid-cache.org/KnowledgeBase/DebugSections">http://wiki.squid-cache.org/KnowledgeBase/DebugSections</A>) There were
</I>&gt;<i> couple issues with intercepted https connections in the past but a
</I>&gt;<i> 400 means that something is bad and mainly in the expected input and
</I>&gt;<i> not a certificate but it is possible that other reasons are there. I
</I>&gt;<i> have not tried to use skype in a transparent environment for a very
</I>&gt;<i> long time but I can try to test it later.
</I>
I tcpdumped the icap REQMOD session to retrieve the request and tried it
manually (direct to the Skype server) with openssl s_client.  The Skype
server (not Squid) returned a 400.  But of course, the Skype request
contains various data that the server will probably (correctly) see as a
replay attack, so it isn't a very good test - all I can really say is
that the real Skype client was getting exactly the same error from the
server when the connection is bumped, but works fine when it is tunnelled.

Annoyingly, Skype doesn't include an SNI in the handshake, so peeking in
order to exclude it from being bumped isn't an option.

The odd thing is that I have had Skype working in a transparent 
environment previously (with the unprivalidged ports unfirewalled), so I 
wonder if this is something new from Microsoft.

-- 
  - Steve Hill
    Technical Director
    Opendium Limited     <A HREF="http://www.opendium.com">http://www.opendium.com</A>

Direct contacts:
    Instant messager: xmpp:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>
    Phone:            sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">steve at opendium.com</A>

Sales / enquiries contacts:
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>
    Phone:            +44-1792-824568 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sales at opendium.com</A>

Support contacts:
    Email:            <A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>
    Phone:            +44-1792-825748 / sip:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">support at opendium.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011448.html">[squid-users] Skype, SSL bump and go.trouter.io
</A></li>
	<LI>Next message (by thread): <A HREF="011463.html">[squid-users] Skype, SSL bump and go.trouter.io
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11462">[ date ]</a>
              <a href="thread.html#11462">[ thread ]</a>
              <a href="subject.html#11462">[ subject ]</a>
              <a href="author.html#11462">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
