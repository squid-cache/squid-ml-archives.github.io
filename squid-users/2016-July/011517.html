<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20url_rewrite_program%20shows%20IP%20addresses%20instead%20of%0A%20domain%20name%20when%20rewriting%20SSL/HTTPS&In-Reply-To=%3C83226d19-6243-565b-0026-76a1bd96db14%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011512.html">
   <LINK REL="Next"  HREF="011486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20url_rewrite_program%20shows%20IP%20addresses%20instead%20of%0A%20domain%20name%20when%20rewriting%20SSL/HTTPS&In-Reply-To=%3C83226d19-6243-565b-0026-76a1bd96db14%40treenet.co.nz%3E"
       TITLE="[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jul 13 10:52:35 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011512.html">[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS
</A></li>
        <LI>Next message (by thread): <A HREF="011486.html">[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11517">[ date ]</a>
              <a href="thread.html#11517">[ thread ]</a>
              <a href="subject.html#11517">[ subject ]</a>
              <a href="author.html#11517">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/07/2016 5:46 a.m., Moataz Elmasry wrote:
&gt;<i> Hi Amos,
</I>&gt;<i> 
</I>&gt;<i> I kinda solved the problem (Thanks to you!!!)
</I>&gt;<i> All what was needed is to peek the important domains in step2 in order not
</I>&gt;<i> to cause them harm and bump everything else in step3. In this case I'm able
</I>&gt;<i> to read the dns names in the redirect script and block them accordingly
</I>&gt;<i> 
</I>&gt;<i> Here is the relevant part:
</I>&gt;<i> acl http_sites dstdomain play.google.com mydomain.com
</I>&gt;<i> acl https_sites ssl::server_name play.google.com mydomain.com
</I>&gt;<i> 
</I>&gt;<i> ssl_bump peek step1 all
</I>&gt;<i> ssl_bump peek step2 https_sites
</I>&gt;<i> ssl_bump bump step3 all !https_sites #http_sites won't be bumped anyway.
</I>&gt;<i> But just to be sure
</I>&gt;<i> url_rewrite_access allow all !http_sites
</I>&gt;<i> 
</I>&gt;<i> Of course I'm still not able to rewrite https address as discussed, but
</I>&gt;<i> this is a different story I guess.
</I>&gt;<i> 
</I>&gt;<i> The SslPeekAndSplice wiki page needs serious rework though as many of the
</I>&gt;<i> stuff discussed here are not explained on the page, which makes life really
</I>&gt;<i> hard for noobs like me. Is there a way to contribute back a little bit by
</I>&gt;<i> reworking that wiki page? I'll try to write a small post about
</I>&gt;<i> the SslPeekAndSplice in the next few days.
</I>
The answer to that is &quot;yes, its a wiki so anyone in teh community can
improve it&quot;. The need to register as an editor is just a spam prevention
tactic.

For that particular page the lack of details is partially intentional.
Playing around with security protocols does requires a certain level of
understanding. The page assumes that level of understanding is present
first.

But you are right the page does need some improvements. I would prefer
though for this page if you proposed changes in the Discussion page
associated with the SslPeekAndSplice page. Then the authors who
understand the feature and TLS more fully can make the adjustments.

Cheers
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011512.html">[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS
</A></li>
	<LI>Next message (by thread): <A HREF="011486.html">[squid-users] url_rewrite_program shows IP addresses instead of domain name when rewriting SSL/HTTPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11517">[ date ]</a>
              <a href="thread.html#11517">[ thread ]</a>
              <a href="subject.html#11517">[ subject ]</a>
              <a href="author.html#11517">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
