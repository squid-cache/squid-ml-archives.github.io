<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] acl maxconn and max_user_ip config help please
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20maxconn%20and%20max_user_ip%20config%20help%20please&In-Reply-To=%3C20160717234946.GA3433%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011716.html">
   <LINK REL="Next"  HREF="011583.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] acl maxconn and max_user_ip config help please</H1>
    <B>B. Henry</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20maxconn%20and%20max_user_ip%20config%20help%20please&In-Reply-To=%3C20160717234946.GA3433%40gmail.com%3E"
       TITLE="[squid-users] acl maxconn and max_user_ip config help please">burt1iband at gmail.com
       </A><BR>
    <I>Sun Jul 17 23:49:46 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011716.html">[squid-users] cache peer communication about HIT/MISS between squid and and non-squid peer
</A></li>
        <LI>Next message (by thread): <A HREF="011583.html">[squid-users] acl maxconn and max_user_ip config help please
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11580">[ date ]</a>
              <a href="thread.html#11580">[ thread ]</a>
              <a href="subject.html#11580">[ subject ]</a>
              <a href="author.html#11580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I want to limit max simultanious connections for any user in group foo, and also limit how may different IPs they can have devices logged in from at any 
one time.

I've had squid3 working well with a very simple policy for years just allowing access from two different ip ranges, but now want to make my proxy server 
available to others. 
I have things working well with one group called foo listing some names, after using something very similar to the recommended minimum defaults. 

acl foo proxy_auth user1 dumbuser someoneelse

But when I add the lines below to try and set a limit for group fooI can not connect at all, get a connection denied error.
acl foo maxconn 15
acl foo max_user_ip -s 5
And these were the last httpaccess lines
http_access deny !foo
#http_access allow localnet
  
I am very new to anything other than some very basic configuration, so may be misunderstanding almost anything, so all help will be well received even if 
it just confirms something I thought.

Also if I want to make a more restrictive policy, i.e. fewer connections for folks not in group fooam I correct in thinking it would go before, the foo 
rule?
   I guess I'd either make another groupand give them access and change foo's access to allow insteal of deny, or is there a better way?
Sometimes I think I understand the basic rules about order and such pretty weell, but feel confused at the moment...lol
  
Actually my current working configuration has the allow localnet line above the foo acl line and 
 these as the last acl and httpaccess lines
http_access deny !foo
At this point should I have an allow all line since the httpaccess line for foo is deny, or should the last line always be deny all? Smoke started comming 
out of my ears trying to understand some of the explanation for that...
     
Thanks in advance for any and all help. 
BTW, I am stuck using 3.1.19 I think it is as my server is running ubuntu 12.04 for a bit still, i.e. I know some options have changed a bit since 
squid3.1.

-- 
     B.H.
   Registerd Linux User 521886

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 888 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160717/c2f52ed2/attachment.sig">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160717/c2f52ed2/attachment.sig</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011716.html">[squid-users] cache peer communication about HIT/MISS between squid and and non-squid peer
</A></li>
	<LI>Next message (by thread): <A HREF="011583.html">[squid-users] acl maxconn and max_user_ip config help please
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11580">[ date ]</a>
              <a href="thread.html#11580">[ thread ]</a>
              <a href="subject.html#11580">[ subject ]</a>
              <a href="author.html#11580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
