<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] dns children setting breaks my squid.conf
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dns%20children%20setting%20breaks%20my%20squid.conf&In-Reply-To=%3C53f7c6f5-a761-15ce-8109-87acc55093f6%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011581.html">
   <LINK REL="Next"  HREF="011586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] dns children setting breaks my squid.conf</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dns%20children%20setting%20breaks%20my%20squid.conf&In-Reply-To=%3C53f7c6f5-a761-15ce-8109-87acc55093f6%40treenet.co.nz%3E"
       TITLE="[squid-users] dns children setting breaks my squid.conf">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jul 18 04:47:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011581.html">[squid-users] dns children setting breaks my squid.conf
</A></li>
        <LI>Next message (by thread): <A HREF="011586.html">[squid-users] dns children setting breaks my squid.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11582">[ date ]</a>
              <a href="thread.html#11582">[ thread ]</a>
              <a href="subject.html#11582">[ subject ]</a>
              <a href="author.html#11582">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/07/2016 12:21 p.m., B. Henry wrote:
&gt;<i> Here's is what I have in my working squid.conf related to dns. 
</I>&gt;<i> Note that the dns children entry is commented out as when I try and use any value this breaks things and I can't use the server at all.
</I>&gt;<i> 
</I>&gt;<i> positive_dns_ttl 3 hours
</I>&gt;<i> 
</I>
Best Practice for DNS is servers should use a TTL of 24hrs. Squid
default is already reducing that to 6hrs.

&gt;<i> 
</I>&gt;<i> #dns_children 7
</I>&gt;<i> 
</I>
That setting requires that you have built Squid to use a custom DNS
plugin instead of doing DNS the normal way.

If you have the default Ubuntu package like I suspect you do. Then Squid
is built to use DNS the normal way.


&gt;<i> dns_timeout 90 seconds
</I>&gt;<i> 
</I>&gt;<i> #dns_nameser 208.67.222.2224.2.2.4
</I>&gt;<i>  
</I>
Two problems with this one:

 * &quot;dns_nameser&quot; is not an existing directive.

 * &quot;208.67.222.2224.2.2.4&quot; is not an IP address, despite the dots.

Note that if you *dont* list the dns_nameservers directive. Then your
machines normal /etc/resolv.conf settings are used by Squid instead of
any other DNS settings you might have

Using /etc/resolv.conf is really the best way to go as it allows your
networks auto-configuration to setup Squid properly with whatever the
local DNS systems are supposed to be using.


&gt;<i> This is squid 3.1.19 on ubuntu 12.04 64bit server. It's a openvz vps, not baremetal if that counts for anything.  
</I>&gt;<i> 
</I>&gt;<i> it uses two other google dns servers actually, so I defined the proxy to use an opendns and one google dns server, same ones I usually use on my local 
</I>&gt;<i> hardware.
</I>
Best Practice is to setup a local DNS recursive resolver, so all your
systems can use it. That resolver can use the Google, Open DNS resolvers
if you want. This ensures that regardless of where the results came from
they are consistent across your network. That consistency becomes a
critical need if you do interception with Squid.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011581.html">[squid-users] dns children setting breaks my squid.conf
</A></li>
	<LI>Next message (by thread): <A HREF="011586.html">[squid-users] dns children setting breaks my squid.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11582">[ date ]</a>
              <a href="thread.html#11582">[ thread ]</a>
              <a href="subject.html#11582">[ subject ]</a>
              <a href="author.html#11582">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
