<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Windows%20Updates%20a%20Caching%20Stub%20zone%2C%0A%09A%20windows%20updates%20store.&In-Reply-To=%3C042201d1e2fb%2457ad2a10%2407077e30%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011633.html">
   <LINK REL="Next"  HREF="011709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Windows%20Updates%20a%20Caching%20Stub%20zone%2C%0A%09A%20windows%20updates%20store.&In-Reply-To=%3C042201d1e2fb%2457ad2a10%2407077e30%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Jul 21 02:55:30 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011633.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
        <LI>Next message (by thread): <A HREF="011709.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11667">[ date ]</a>
              <a href="thread.html#11667">[ thread ]</a>
              <a href="subject.html#11667">[ subject ]</a>
              <a href="author.html#11667">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Omid,

After inspection of more data I have seen that there are couple cases which will result in disks space consumption.
Windows Updates supports a variety of languages. When you have more then one or two languages the amount of cache is rapidly changes.
To give some numbers to the picture:
- Each Windows version have multiple versions(starter, home, professional, enterprise..)
- Each cpu arch requires it's own updates(x86, x64) 
- Each Windows version can have a big update for multiple languages, depends on the locality of the system
- Each Windows product such as office has it's own language packs and updates(some updates are huge..)

Since I am not one of Microsoft Engineers or product\updates managers I cannot guarantee that my understanding of the subject is solid like the ground.
But in the other hand since I do have background with HTTP and it's structure I can guarantee some assurance that my research can be understood by most if not any HTTP expert.

Squid by it's nature honors specific caching rules and these are very general.
To my understanding Squid was not built to satisfy each use case but it helps many of them.
Since you also noticed that windows updates can consume lots of disk space then what you mentioned about last accessed time seems pretty reasonable for a cache.
You have the choice on how to manage your store\cache according to whatever is required\needed.
For example the command:
find /cache1/body/v1/  -atime +7 -type f|wc -l

Should give you some details about the files which was not accessed in the last week.
We can try to enhance the above command\idea to calculate statistics in a way that will help us to get an idea of what files or updates are downloaded periodically.
Currently only with the existence of the request files we can understand what responses belongs to what request.

Let me know if you want me to compose some script that will help you to decide what files to purge. (I will probably write it in ruby)
There is an option to &quot;blacklist&quot; a response from being fetched by the fetcher or to be used by the web-service but you will need to update to the latest version of the fetcher and to use the right cli option(don't remember now) or to use the command under a &quot;true&quot; pipe such as &quot;true | /location/fetcher ...&quot; to avoid any &quot;pause&quot; which it will cause.

Thanks,
Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Omid Kosari
Sent: Tuesday, July 19, 2016 1:59 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Windows Updates a Caching Stub zone, A windows updates store.

Eliezer Croitoru-2 wrote
&gt;<i> Hey Omid,
</I>&gt;<i> 
</I>&gt;<i> Indeed my preference is that if you can ask ask and I will try to give you
</I>&gt;<i> couple more details on the service and the subject.
</I>
Hey Eliezer,
&lt;SNIP&gt;

4.Current storage capacity is 500G andmore than 50% of it becomes full and
growing fast . Is there any mechanism for garbage collection in your code ?
If not is it good idea to remove files based on last access time (ls -ltu
/cache1/body/v1/) ? should i also delete old files from header and request
folders ?




--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Windows-Updates-a-Caching-Stub-zone-A-windows-updates-store-tp4678454p4678581.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Windows-Updates-a-Caching-Stub-zone-A-windows-updates-store-tp4678454p4678581.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011633.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
	<LI>Next message (by thread): <A HREF="011709.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11667">[ date ]</a>
              <a href="thread.html#11667">[ thread ]</a>
              <a href="subject.html#11667">[ subject ]</a>
              <a href="author.html#11667">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
