<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] What do the bytes and duration fields in squid log count for https (CONNECT)?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20do%20the%20bytes%20and%20duration%20fields%20in%20squid%0A%20log%20count%20for%20https%20%28CONNECT%29%3F&In-Reply-To=%3C4639d8f1-b4a3-3bd6-d50b-a570aaab209c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011713.html">
   <LINK REL="Next"  HREF="011719.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] What do the bytes and duration fields in squid log count for https (CONNECT)?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20do%20the%20bytes%20and%20duration%20fields%20in%20squid%0A%20log%20count%20for%20https%20%28CONNECT%29%3F&In-Reply-To=%3C4639d8f1-b4a3-3bd6-d50b-a570aaab209c%40treenet.co.nz%3E"
       TITLE="[squid-users] What do the bytes and duration fields in squid log count for https (CONNECT)?">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jul 25 12:52:28 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011713.html">[squid-users] What do the bytes and duration fields in squid	log count for https (CONNECT)?
</A></li>
        <LI>Next message (by thread): <A HREF="011719.html">[squid-users] Peer2Peer Url categorizing, black\white lists,	can it work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11714">[ date ]</a>
              <a href="thread.html#11714">[ thread ]</a>
              <a href="subject.html#11714">[ subject ]</a>
              <a href="author.html#11714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 26/07/2016 12:04 a.m., Henry S. Thompson wrote:
&gt;<i> Amos Jeffries writes:
</I>&gt;<i> 
</I>&gt;&gt;<i> On 25/07/2016 10:34 p.m., Henry S. Thompson wrote:
</I>&gt;&gt;&gt;<i> Standard squid config only logs one CONNECT line for any https
</I>&gt;&gt;&gt;<i> transaction. What is being counted/timed by the reported bytes and
</I>&gt;&gt;&gt;<i> duration fields in that line?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm guessing it's the total time taken and total bytes delivered to the
</I>&gt;&gt;&gt;<i> client by any and all transactions in the course of the TLS connection
</I>&gt;&gt;&gt;<i> established by that CONNECT, but I can't find anything in the log
</I>&gt;&gt;&gt;<i> documentation which confirms that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes. There is no HTTPS or TLS as far as Squid is concerned. (In modern
</I>&gt;&gt;<i> traffic you are also very likely to be wrong about it being HTTPS or TLS
</I>&gt;&gt;<i> on port 443. The (browser?) URL saying &quot;<A HREF="https://">https://</A>&quot; does not make it HTTPS
</I>&gt;&gt;<i> inside the tunnel).
</I>&gt;<i> 
</I>&gt;<i> Indeed, understood
</I>&gt;<i> 
</I>&gt;&gt;<i> An HTTP CONNECT message with opaque data is all Squid sees. Its duration
</I>&gt;&gt;<i> is how long it takes, and the opaque data is the size it is.
</I>&gt;<i> 
</I>&gt;<i> Thanks for your reply, but this part leaves me confused.  The CONNECT
</I>&gt;<i> message itself is short, as is the likely reply, and presumably doesn't
</I>&gt;<i> take long to process.  But the times and sizes I'm seeing are long/big,
</I>&gt;<i> so it doesn't seem likely that they are the time and size of the
</I>&gt;<i> response to the CONNECT as such, which is what you appear to be saying
</I>&gt;<i> above...
</I>&gt;<i> 
</I>&gt;<i> That is, what is the 'it' you refer to in your final sentence?
</I>
Sorry, coudl have been clearer.

Unless you are using SSL-Bump or such to process the contents specially.
The duration is from the CONNECT message arriving to the time TCP close
is used to end the tunnel. The size should be the bytes sent to the
client (excluding the 200 reply message itself) during that time.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011713.html">[squid-users] What do the bytes and duration fields in squid	log count for https (CONNECT)?
</A></li>
	<LI>Next message (by thread): <A HREF="011719.html">[squid-users] Peer2Peer Url categorizing, black\white lists,	can it work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11714">[ date ]</a>
              <a href="thread.html#11714">[ thread ]</a>
              <a href="subject.html#11714">[ subject ]</a>
              <a href="author.html#11714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
