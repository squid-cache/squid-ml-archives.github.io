<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Windows%20Updates%20a%20Caching%20Stub%20zone%2C%0A%09A%20windows%20updates%20store.&In-Reply-To=%3Cbf19801d1e675%246d65b840%24483128c0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011709.html">
   <LINK REL="Next"  HREF="011501.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Windows%20Updates%20a%20Caching%20Stub%20zone%2C%0A%09A%20windows%20updates%20store.&In-Reply-To=%3Cbf19801d1e675%246d65b840%24483128c0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Jul 25 13:06:58 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011709.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
        <LI>Next message (by thread): <A HREF="011501.html">[squid-users] Linking with *SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11715">[ date ]</a>
              <a href="thread.html#11715">[ thread ]</a>
              <a href="subject.html#11715">[ subject ]</a>
              <a href="author.html#11715">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Omid,

I will comment inline.
And there are couple details which we need to understand couple issues.

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Omid Kosari
Sent: Monday, July 25, 2016 12:15 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Windows Updates a Caching Stub zone, A windows updates store.

Hi,

Thanks for support .

recently i have seen a problem with version beta 0.2 . when fetcher is working the kernel logs lots of following error
TCP: out of memory -- consider tuning tcp_mem

# To verify the actual status we need the output of:
$ free -m
$ cat /proc/sys/net/ipv4/tcp_mem
$ top -n1 -b
$ cat /proc/net/sockstat
$ cat /proc/sys/net/ipv4/tcp_max_orphans 

I think the problem is about orphaned connections which i mentioned before .
Managed to try new version to see what happens.

# If you have an orphaned connections on the machine with or without the MS updates proxy, you should consider to analyze the machine structure and load in general.
If indeed there are orphan connections we need to verify if it's from the squid or my service or the combination of them together.


Also i have a feature request . Please provide a configuration file for example in /etc/foldername or even beside the binary files to have selective options for both fetcher and logger.

# With what options for the logger and fetcher?

I have seen following change log
beta 0.3 - 19/07/2016
+ Upgraded the fetcher to honour private and no-store cache-control  headers
when fetching objects.

As my point of view the more hits is better and there is no problem to store private and no-store objects if it helps to achieve more hits and bandwidth saving . So it would be fine to have an option in mentioned config file to change it myself .

# I understand your way of looking at things but this is a very wrong way to look at cache and store.
The problem with storing private and no-store responses is very simple.
These files are temporary and exists for one request only(in most cases).
Specifically for MS it is true and they do not use private files more then once.
I do not wish to offend you or anyone by not honoring such a request but since it's a public service this is the definition of it.
If you want to see the options of the fetcher and the service just add the &quot;-h&quot; option to see the available options.

I have considered to use some log file but yet to get to the point which I have a specific format that I want to work with.
I will try to see what can be done with log files and also what should be done to handle log rotation. 

Thanks again


## Resources
* <A HREF="http://blog.tsunanet.net/2011/03/out-of-socket-memory.html">http://blog.tsunanet.net/2011/03/out-of-socket-memory.html</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011709.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
	<LI>Next message (by thread): <A HREF="011501.html">[squid-users] Linking with *SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11715">[ date ]</a>
              <a href="thread.html#11715">[ thread ]</a>
              <a href="subject.html#11715">[ subject ]</a>
              <a href="author.html#11715">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
