<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] logging and proxy pac file help
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logging%20and%20proxy%20pac%20file%20help&In-Reply-To=%3C2036326954.956510.1464994308430.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010830.html">
   <LINK REL="Next"  HREF="010868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] logging and proxy pac file help</H1>
    <B>Andrew Meyer</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logging%20and%20proxy%20pac%20file%20help&In-Reply-To=%3C2036326954.956510.1464994308430.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[squid-users] logging and proxy pac file help">andrewm659 at yahoo.com
       </A><BR>
    <I>Fri Jun  3 22:51:48 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010830.html">[squid-users] Establishing secure conection problems (Chrome)
</A></li>
        <LI>Next message (by thread): <A HREF="010868.html">[squid-users] logging and proxy pac file help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10853">[ date ]</a>
              <a href="thread.html#10853">[ thread ]</a>
              <a href="subject.html#10853">[ subject ]</a>
              <a href="author.html#10853">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So I have squid (latest) running in a a jail, and I am able to use it communicate with it via the browser. But I am trying to set it up so that I can use a proxy.pac file. I have the proxy.pac configured. Firefox is being used as my testbed. When I switch over the pac file I get nothing in the logs. Not sure why. &#160; Below is my config.
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A>:/usr/local/etc/squid # cat squid.conf
#
# Recommended minimum configuration:
#

# Example rule allowing access from your local networks.
# Adapt to list your (internal) IP networks from where browsing
# should be allowed
acl localnet src 10.0.0.0/8    # RFC1918 possible internal network
acl localnet src 172.16.0.0/12    # RFC1918 possible internal network
acl localnet src 192.168.0.0/16    # RFC1918 possible internal network
acl localnet src fc00::/7       # RFC 4193 local private network range
acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged) machines

acl SSL_ports port 443
acl Safe_ports port 80        # http
acl Safe_ports port 21        # ftp
acl Safe_ports port 443        # https
acl Safe_ports port 70        # gopher
acl Safe_ports port 210        # wais
acl Safe_ports port 1025-65535    # unregistered ports
acl Safe_ports port 280        # http-mgmt
acl Safe_ports port 488        # gss-http
acl Safe_ports port 591        # filemaker
acl Safe_ports port 777        # multiling http
acl CONNECT method CONNECT

acl our_networks src 10.150.1.0/24
#
# Recommended minimum Access Permission configuration:
#
# Deny requests to certain unsafe ports
http_access deny !Safe_ports

# Deny CONNECT to other than secure SSL ports
http_access deny CONNECT !SSL_ports

# Only allow cachemgr access from localhost
http_access allow localhost manager our_networks
http_access deny manager

# We strongly recommend the following be uncommented to protect innocent
# web applications running on the proxy server who think the only
# one who can access services on &quot;localhost&quot; is a local user
#http_access deny to_localhost

#
# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
#

# Example rule allowing access from your local networks.
# Adapt localnet in the ACL section to list your (internal) IP networks
# from where browsing should be allowed
http_access allow localnet
http_access allow localhost

# And finally deny all other access to this proxy
http_access deny all

# Squid normally listens to port 3128
http_port 3128

# Uncomment and adjust the following to add a disk cache directory.
#cache_dir ufs /var/squid/cache 100 16 256

# Leave coredumps in the first cache dir
coredump_dir /var/squid/cache

#
# Add any of your own refresh_pattern entries above these.
#
refresh_pattern ^ftp:        1440    20%    10080
refresh_pattern ^gopher:    1440    0%    1440
refresh_pattern -i (/cgi-bin/|\?) 0    0%    0
refresh_pattern .        0    20%    4320

visible_hostname proxy01.borg.local

access_log /var/log/squid/access.log squid
#logformat custom %{%Y-%m-%d %H:%M:%S}tl %03tu %&gt;a %tr %ul %ui %&gt;Hs %mt %rm %ru %rv %st %Sh %Ss
logformat squid %tl %6tr %&gt;a %Ss/%03Hs %&lt;st %rm %ru %un %Sh/%&lt;A %mt
client_db on
dns_defnames on
httpd_suppress_version_string on
retry_on_error on
uri_whitespace strip
strip_query_terms off
#pipeline_prefetch on

cache deny all
#cache_dir null /tmp
ident_lookup_access deny all

## disable ads ( <A HREF="http://pgl.yoyo.org/adservers/">http://pgl.yoyo.org/adservers/</A> )
acl adsites url_regex -i &quot;/usr/local/etc/squid/ad_block.txt&quot;
http_access deny adsites
deny_info <A HREF="http://proxy.borg.local/blocked.html">http://proxy.borg.local/blocked.html</A> adsites
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A>:/usr/local/etc/squid # 

Proxy.pac

function FindProxyForURL(url, host) {
    //Don't proxy connections to the UTM web interface
    if (shExpMatch(url, &quot;<A HREF="https://${asg_hostname">https://${asg_hostname</A>}*&quot;)) return &quot;DIRECT&quot;;
    if (shExpMatch(url, &quot;<A HREF="https://">https://</A>&quot; + dnsResolve(host) + &quot;*&quot;)) return &quot;DIRECT&quot;;
    //Exclude non-fqdn hosts from being proxied
    if (isPlainHostName(host)) return &quot;DIRECT&quot;;
    //Don't proxy connections to the exempted URL matches
    if (shExpMatch(url, &quot;*borg.local*&quot;)) return &quot;DIRECT&quot;;
   if (isInNet(myIpAddress(), &quot;10.150.0.0&quot;, &quot;255.255.0.0&quot;))        {return &quot;PROXY proxy.borg.local:3128&quot; ;}

    return &quot;DIRECT&quot;;
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160603/5531127e/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160603/5531127e/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010830.html">[squid-users] Establishing secure conection problems (Chrome)
</A></li>
	<LI>Next message (by thread): <A HREF="010868.html">[squid-users] logging and proxy pac file help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10853">[ date ]</a>
              <a href="thread.html#10853">[ thread ]</a>
              <a href="subject.html#10853">[ subject ]</a>
              <a href="author.html#10853">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
