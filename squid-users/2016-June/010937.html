<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Vary object loop returns
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Vary%20object%20loop%20returns&In-Reply-To=%3Cf81cd644-5458-5eec-70e4-c8ad8364c8cb%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010933.html">
   <LINK REL="Next"  HREF="010938.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Vary object loop returns</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Vary%20object%20loop%20returns&In-Reply-To=%3Cf81cd644-5458-5eec-70e4-c8ad8364c8cb%40treenet.co.nz%3E"
       TITLE="[squid-users] Vary object loop returns">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun  7 10:36:16 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010933.html">[squid-users] Vary object loop returns
</A></li>
        <LI>Next message (by thread): <A HREF="010938.html">[squid-users] Vary object loop returns
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10937">[ date ]</a>
              <a href="thread.html#10937">[ thread ]</a>
              <a href="subject.html#10937">[ subject ]</a>
              <a href="author.html#10937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/06/2016 8:48 p.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> 07.06.2016 4:57, Amos Jeffries &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> On 7/06/2016 5:55 a.m., Yuri Voinov wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Squid DOES NOT and DON'T BE support gzip. The only way to do it - use
</I>&gt;&gt;&gt;<i> ecap + desupported ecap gzip adapter. Let's accept this. We can support
</I>&gt;&gt;&gt;<i> gzip. With restrictions. Ok.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> any other compression - false. No. No way. Get out. and so on.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  identity - this is uncompressed type.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That's all, folks.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Finally. As Joe does, we can remain only gzip and identity in
</I>&gt;&gt;&gt;<i> Accept-Encoding and truncate all remaining.
</I>&gt;<i> 
</I>&gt;&gt;<i> Locking the entire Internet to using your personal choice of gzip
</I>&gt;&gt;<i> compression or none.
</I>&gt;<i> 
</I>&gt;&gt;<i> gzip is the slowest and more resource hungry type of compression there
</I>&gt;&gt;<i> is. deflate is actually faster for clients and just as widely supported.
</I>&gt;<i> Unfortunately, Amos, no one has written any other compression algorithms
</I>&gt;<i> support module. We have to eat what they give.
</I>&gt;<i> 
</I>
Like I said deflate is widely available. Heiler's recent info shows that
lzma is becomming more visible on the public web, which should help fix
the one issue deflate has.

And noone appears to be fixing the remaining issues in the Squid gzip
eCAP module.

There also seems to be a big push back from browser and some server
vendors about compression in general. We had a fairly major fight in
IETF to get HTTP/2 to contain data compression at all. It is still only
in there as an optional extension that some are openly refusing to
implement.


&gt;<i> 
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Without any problem. Moreover, this type of can be push to all brunches
</I>&gt;&gt;&gt;<i> of squid without any problem, because of this dramatically increases
</I>&gt;&gt;&gt;<i> byte HIT.
</I>&gt;<i> 
</I>&gt;&gt;<i> Responding with a single object to all requests makes your HIT ratio
</I>&gt;&gt;<i> 100% guaranteed. The clients wont like you though if all they ever see
</I>&gt;&gt;<i> is the same cat picture.
</I>&gt;<i> 
</I>&gt;&gt;<i> It sounds ridiculous when put that way, but that is what these patches
</I>&gt;&gt;<i> are doing for a unknown number of those &quot;gained&quot; HITs. See my previous
</I>&gt;&gt;<i> post about how none of these patches are changing the request the server
</I>&gt;&gt;<i> gets.
</I>&gt;<i> But no one asked the question - why Squid in production installations
</I>&gt;<i> has such a low hit ratio
</I>
Yes that has been asked, even investigated. The reason(s) are many
complex details and small issues adding together to a big loss.

They range from protocol things like Vary not being fine-grained enough
(Key header being developed fixes that), through to client behaviour
(Chrome sdch doubles the variant count - almost halving useful cache
space), to server behaviour (Apache changing Vary header).

What your testing of joes patches is showing is that the sdch effect
Chrome has is probably way bigger than one would expect to be reasonable.


&gt;<i> that raises the question of expediency of
</I>&gt;<i> application caching proxy. We do believe that this is a caching proxy?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> You are once again sweeping asside the critical requirement of content
</I>&gt;&gt;<i> integrity to achieve high HIT ratio. Which is not something that I can
</I>&gt;&gt;<i> accept into Squid as a default action.
</I>&gt;<i> I continue to believe that 20% is unacceptably low cache hit ratio,
</I>&gt;<i> given the very aggressive settings and the active use of Store ID. Which
</I>&gt;<i> brings us back to the idea of the feasibility of using the SQUID as a whole.
</I>&gt;<i> 
</I>
That kind of &quot;unacceptable&quot; statement simply cannot be made about cache
HIT ratio. It is what it is. One cannot change the speed of light
because it takes unacceptable long to travel through space.

Two properly working caches in serial will have extremely different
caching ratios. The one with most direct client connections trends
towards 50-100% and the upstream one towards the servers will trend
towards zero. The total cacheable ratio is unchanged, but each cache
sees a different proportion of it and so shows different HIT ratios
relative to their clients portion.


Also, don't forget that browser cache disk space available are
increasingly large as well. So their caches are growing in size and
taking up a larger share of the total achievable HIT ratios in recent years.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010933.html">[squid-users] Vary object loop returns
</A></li>
	<LI>Next message (by thread): <A HREF="010938.html">[squid-users] Vary object loop returns
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10937">[ date ]</a>
              <a href="thread.html#10937">[ thread ]</a>
              <a href="subject.html#10937">[ subject ]</a>
              <a href="author.html#10937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
