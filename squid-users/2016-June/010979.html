<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Peek'n Splice (ssl_bump) and authentication	Somewhat OT: Content Filter with https
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Peek%27n%20Splice%20%28ssl_bump%29%20and%20authentication%0A%09Somewhat%20OT%3A%20Content%20Filter%20with%20https&In-Reply-To=%3C009201d1c1e3%247b67c430%2472374c90%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010999.html">
   <LINK REL="Next"  HREF="010977.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Peek'n Splice (ssl_bump) and authentication	Somewhat OT: Content Filter with https</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Peek%27n%20Splice%20%28ssl_bump%29%20and%20authentication%0A%09Somewhat%20OT%3A%20Content%20Filter%20with%20https&In-Reply-To=%3C009201d1c1e3%247b67c430%2472374c90%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Peek'n Splice (ssl_bump) and authentication	Somewhat OT: Content Filter with https">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Jun  9 00:11:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010999.html">[squid-users] Peek'n Splice (ssl_bump) and authentication Somewhat OT: Content Filter with https
</A></li>
        <LI>Next message (by thread): <A HREF="010977.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot bind	socket FD 782 to [::]: (2) No such file or directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10979">[ date ]</a>
              <a href="thread.html#10979">[ thread ]</a>
              <a href="subject.html#10979">[ subject ]</a>
              <a href="author.html#10979">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Sergio,

 

It depends on couple aspects of the setup.

The basic rule is that in the case you require authentication you are required to use a configured proxy and without Interception.

For SSL BUMP to work you need the clients to either access the proxy directly or to Intercept their connections.(Interception is not a must..) 

If your setup doesn't have terminal servers for multiple clients then you can use an IP to USER authentication using a variety of options such as:

-          Web Authentication portal

-          DHCP level Authentication

-          Radius based Authentication

-          Couple others..

(all the above are based on IP level restrictions)

 

HTTPS and HTTP filtering are a bit different but if you have a basic &quot;catch all&quot; rule it would be much simpler to move on from there with the logic and implementation.

Specifically for HTTPS connections if you have a list of sites that you don't need to bump and you will be using a directly configured proxy(non intercept) then you would be able to minimize the noise that comes with fake certificates generation.


My suggestion in general is to first declare squid as a &quot;first&quot; trial and testing stage for a solution.

For some places Squid's breaking web-sockets are an overhead that cannot be tolerated while in other places it is acceptable as a security breach blocker.

If the place is not huge(200+ users) then I would start with a simple forward proxy with SSL BUMP but in a splice first(since peek and splice might not be needed due to the clients stating their target Domain Name) and later add the bump step.

It will help you to try and see how the proxy takes the load(with filtering but without caching).
Then move on to the next step of authentication, maybe Kerberos or if &quot;transparent&quot; authentication is required but if not then a simple LDAP based one.

If SquidGuard functionality is good for you then use it.

If not then ufdbguard or any other solution that is in your mind.

I tend to not publish my work too much here but if you want to take a peek and see how it works for you then:
<A HREF="http://new.ngtech.co.il/squidblocker_en.html">http://new.ngtech.co.il/squidblocker_en.html</A> 

 

I also think that others work such as:

-          <A HREF="http://www.quintolabs.com/">http://www.quintolabs.com/</A>  Diladele

-          <A HREF="https://www.clearos.com/">https://www.clearos.com/</A>

-          <A HREF="https://www.censornet.com/">https://www.censornet.com/</A>

is worth mentioning due to their high quality.( I have tested some of them myself)

 

About ufdbguard, it's not doing authentication but only url filtering as far as I know.

Squid's way of handling authentication is one and it's not on the same &quot;channel&quot; as filtering but an ICAP service can do that too.

 

Hope It Helps,

Eliezer

 

----

 &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt; Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



 

From: Sergio Belkin [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sebelk at gmail.com</A>] 
Sent: Thursday, June 9, 2016 1:53 AM
To: Eliezer Croitoru
Cc: Squid Users
Subject: Re: Peek'n Splice (ssl_bump) and authentication [squid-users] Somewhat OT: Content Filter with https

 

2016-06-08 19:09 GMT-03:00 Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt; &gt;:

Hey Sergio,

 

There are couple approaches to content filtering in the Linux world and in other spaces.

Squid is open source and gives a lot but there are other ideas and ways to perform content filtering.

Squid was designed for caching and does things in a specific way while other solution might give a feature that would work &quot;without interception&quot;.

On http it is doable to perform filtering in a very efficient way that is similar to Squid's PEEK and SPLICE but there is a need in some level of Interception in one step or another to perform the actual &quot;block&quot; operation.

I do not know about Open Source products that offers everything and it is very simple to understand why.

What I know about are 

-          Squid + external tools(such as SquidGuard, ufdbguard, others)

-          Ntop layer 7 filtering

-          Custom DPI iptables modules

-          NFQUEUE based IPS\IDS which can act as a url filtering engine

 

Consider that if you require only filtering and not caching then you can get very high performance from many applications.

The fact that Squid was designed for Caching doesn't mean that you need to use it.
Also there are couple cases which caching will hold your line and users speed.

 

The best case scenario would be to not Intercept the traffic into squid while in many cases it is not possible.

 

Eliezer

 

----

 &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt; Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt; 



 

 

rg &lt;<A HREF="http://www.lpi.org">http://www.lpi.org</A>&gt; 

 

Thanks Eliezer, good summary. I've changed the subject to reflect better the issue. As far I undestand from documention one can bump https only by interception. 

But what about if one Windows user login against an Active Directory, will the authenticacion work to use the proxy?

I mean, what I'd want is:

- Only users of an Active Directory can use the proxy

- Block certains urls

Is that possible with squid+ufwdbguard?

Or should I use other tools/ways just like you mentioned?

Thanks in advance!



-- 

--
Sergio Belkin
LPIC-2 Certified - <A HREF="http://www.lpi.org">http://www.lpi.org</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 11308 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 11317 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment-0001.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160609/319b1c51/attachment-0001.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010999.html">[squid-users] Peek'n Splice (ssl_bump) and authentication Somewhat OT: Content Filter with https
</A></li>
	<LI>Next message (by thread): <A HREF="010977.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot bind	socket FD 782 to [::]: (2) No such file or directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10979">[ date ]</a>
              <a href="thread.html#10979">[ thread ]</a>
              <a href="subject.html#10979">[ subject ]</a>
              <a href="author.html#10979">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
