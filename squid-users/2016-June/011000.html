<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot bind socket FD 782 to [::]: (2) No such file or directory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Centos%207%20squid%203.5.2%20/%20kid2%7C%20commBind%3A%20Cannot%0A%20bind%20socket%20FD%20782%20to%20%5B%3A%3A%5D%3A%20%282%29%20No%20such%20file%20or%20directory&In-Reply-To=%3Ca08610af-2998-dbfd-e857-da6f790a5276%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010998.html">
   <LINK REL="Next"  HREF="011001.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot bind socket FD 782 to [::]: (2) No such file or directory</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Centos%207%20squid%203.5.2%20/%20kid2%7C%20commBind%3A%20Cannot%0A%20bind%20socket%20FD%20782%20to%20%5B%3A%3A%5D%3A%20%282%29%20No%20such%20file%20or%20directory&In-Reply-To=%3Ca08610af-2998-dbfd-e857-da6f790a5276%40treenet.co.nz%3E"
       TITLE="[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot bind socket FD 782 to [::]: (2) No such file or directory">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jun 10 10:55:14 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010998.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot	bind	socket FD 782 to [::]: (2) No such file or directory
</A></li>
        <LI>Next message (by thread): <A HREF="011001.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot	bind socket FD 782 to [::]: (2) No such file or directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11000">[ date ]</a>
              <a href="thread.html#11000">[ thread ]</a>
              <a href="subject.html#11000">[ subject ]</a>
              <a href="author.html#11000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/06/2016 9:13 p.m., --Ahmad-- wrote:
&gt;<i> again , if i use the  same steps below  on centos 6 is works fine  without any issue 
</I>&gt;<i> 
</I>
That means nothing. CentOS is based on RHEL, whic on ly gets updated
periodically. There are about five years worth of changes across the
entire IOS and everything installed with it between v6 and v7.

Obviously something in those changes to CentOS does not work with that
very old version of Squid and seems to work fine with the newer Squid.


&gt;&gt;<i> On Jun 10, 2016, at 11:54 AM, --Ahmad-- wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> hi eliezer
</I>&gt;&gt;<i> =============================================
</I>&gt;&gt;<i> 1- selinux is disabled
</I>&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# sestatus
</I>&gt;&gt;<i> SELinux status:                 disabled
</I>&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2-
</I>&gt;&gt;<i> i have the PID file with permission to squid
</I>&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# ls -l /var/run/squid.pid 
</I>&gt;&gt;<i> -rw-r--r-- 1 squid squid 5 Jun 10 04:45 /var/run/squid.pid
</I>&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# 
</I>
squid.pid should not exist when Squid is shutdown.

You should delete it and ensure that Squid is started by the root user,
which already should have permission to alter the /var/run directory and
create the squid.pid file correctly.

&gt;&gt;<i>
</I>&gt;&gt;<i> but here i don&#8217;t see the file /var/run/squid &#8230;&#8230;.i used to see file called /var/run/squid not /var/run/squid.pid
</I>&gt;&gt;<i>
</I>
/var/run/squid should be a directory. Its where the state data gets
placed now. It may be unused in your installation or just not.

squid.pid may be under /var/run/squid or /var/run depending on your
installation.

/run may be used instead of /var/run if you have a new enough system.


** For pre-packaged Squid. Don't worry about these unless Squid
explicitly complains. Just go with what the package installation chose.


** For custom builds, the &quot;make install&quot; action should create
/var/run/squid directory. If for some reason it does not (such as newly
building an already deprecated old Squid version - which one shodul
never do anyway). You may need to create it yourself, and assign
squid:squid ownership.


&gt;&gt;<i> i also tried to add directive to squid.conf ==&gt; pid_filename /var/run/squid.pid
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> but i have the same errror
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 3-im using kernel default for Centos 7 and it do support IPV6 , i didn&#8217;t compile any kernel 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> agin the error that i have is :
</I>&gt;&gt;<i> kid2| commBind: Cannot bind	socket FD 782 to [::]: (2) No such file or directory
</I>&gt;&gt;<i>
</I>
As mentioned in the URL Eliezer reference you to already
(&lt;<A HREF="http://wiki.squid-cache.org/Features/SmpScale#Cannot_bind_socket_FD_NN_to_.5B::.5D:_.2813.29_Permission_denied">http://wiki.squid-cache.org/Features/SmpScale#Cannot_bind_socket_FD_NN_to_.5B::.5D:_.2813.29_Permission_denied</A>&gt;)
that error is about the SMP UDS sockets.
More specifically it is about the system shared memory device (/dev/shm).

* Some systems need the /dev/shm device to be explicitly turned on
during startup. Check if it is enabled in your system and if not, what
you have to do to fix that. Hints in the wiki.

* Check that /dev/shm path is owned by root. Only the OS itself should
be doing things in there. Programs like Squid use kernel syscalls to
make changes.

* Older Squid like yours could leave UDS sockets after a crash or broken
config abort. Check that /dev/shm/ does not contain any &quot;files&quot; starting
with &quot;squid-&quot; or owned by Squid when Squid is shutdown.
 If some exist use 'rm' to remove them and try restarting Squid.


&gt;&gt;<i>
</I>&gt;&gt;<i> not 
</I>&gt;&gt;<i> kid2| commBind: Cannot bind	socket FD 782 to [::]: permission denied
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> here is again compile options :
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Squid Cache: Version 3.5.2
</I>&gt;&gt;&gt;&gt;<i> Service Name: squid
</I>&gt;&gt;&gt;&gt;<i> configure options:  '--prefix=/usr' '--includedir=/include' '--mandir=/share/man' '--infodir=/share/info' '--sysconfdir=/etc'
</I>&gt;&gt;<i> '--enable-cachemgr-hostname=Ahmad-Allzaeem'
</I>
... unusual URL for accessing management reports:
     <A HREF="http://Ahmad-Allzaeem/squid-internal-mgr/">http://Ahmad-Allzaeem/squid-internal-mgr/</A>

'cachemgr' means the Squid cache management API, specifically the
cachemgr.cgi tool. Not an administrators name.


&gt;&gt;<i> '--localstatedir=/var' '--libexecdir=/lib/squid' '--disable-maintainer-mode' '--disable-dependency-tracking' '--disable-silent-rules' '--srcdir=.' '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid' '--mandir=/usr/share/man' '--enable-inline' '--enable-async-io=8' '--enable-storeio=ufs,aufs,diskd,rock' '--enable-removal-policies=lru,heap' '--enable-delay-pools' '--enable-cache-digests' '--enable-underscores' '--enable-icap-client' '--enable-follow-x-forwarded-for' '--enable-auth' '--enable-basic-auth-helpers=LDAP,MSNT,NCSA,PAM,SASL,SMB,YP,DB,POP3,getpwnam,squid_radius_auth,multi-domain-NTLM' '--enable-ntlm-auth-helpers=smb_lm' '--enable-digest-auth-helpers=ldap,password' '--enable-negotiate-auth-helpers=squid_kerb_auth' '--enable-esi' '--disable-translation' '--with-logdir=/var/log/squid' '--with-pidfile=/var/run/squid.pid' '' '--with-large-files' '--with-default-user=squid' --with-openssl' '--enable-snmp' '--with-included-ltdl' '--disable-arch-native'
</I>&gt;&gt;&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> and here is squid.conf 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at localhost</A> ~]# cat /etc/squid/squid.conf | less
</I>&gt;&gt;<i> cache deny all
</I>&gt;&gt;<i> #################
</I>&gt;&gt;<i> #pid_filename /var/run/squid.pid
</I>&gt;&gt;<i> ####################
</I>&gt;&gt;<i> visible_hostname squid
</I>&gt;&gt;<i> cache_effective_user squid
</I>&gt;&gt;<i> cache_effective_group squid
</I>
You should not need to use cache_effective_group. Particularly if you
are wanting to use NTLM or Kerberos related functionality with Squid.


&gt;&gt;<i> ####################################
</I>&gt;&gt;<i> #workers 2
</I>&gt;&gt;<i> ########################################################################
</I>&gt;&gt;<i> # Lockdown Procedures
</I>&gt;&gt;<i> auth_param basic program /lib/squid/basic_ncsa_auth /etc/squid/squid_user
</I>&gt;&gt;<i> acl ncsa_users proxy_auth REQUIRED
</I>&gt;&gt;<i> http_access allow ncsa_users
</I>&gt;&gt;<i> ############################
</I>&gt;&gt;<i> f
</I>
Please move the auth and http_access lines down to below where it says:
&quot;
 # INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
&quot;

Doing complex things like auth up here at the top of the config your
proxy is made more vulnerable than it should be to various DoS and
traffic smuggling attacks.


&lt;snip&gt;
&gt;&gt;<i> #
</I>&gt;&gt;<i> # Recommended minimum Access Permission configuration:
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i> # Deny requests to certain unsafe ports
</I>&gt;&gt;<i> http_access deny !Safe_ports
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Deny CONNECT to other than secure SSL ports
</I>&gt;&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Only allow cachemgr access from localhost
</I>&gt;&gt;<i> http_access allow localhost manager
</I>&gt;&gt;<i> http_access deny manager
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # We strongly recommend the following be uncommented to protect innocent
</I>&gt;&gt;<i> # web applications running on the proxy server who think the only
</I>&gt;&gt;<i> # one who can access services on &quot;localhost&quot; is a local user
</I>&gt;&gt;<i> #http_access deny to_localhost
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i> # INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Example rule allowing access from your local networks.
</I>&gt;&gt;<i> # Adapt localnet in the ACL section to list your (internal) IP networks
</I>&gt;&gt;<i> # from where browsing should be allowed
</I>&gt;&gt;<i> http_access allow localnet
</I>&gt;&gt;<i> http_access allow localhost
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # And finally deny all other access to this proxy
</I>&gt;&gt;<i> http_access deny all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Squid normally listens to port 3128
</I>&gt;&gt;<i> http_port 1234
</I>
Why 1234? 3128 has been formally registered for Squid use.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010998.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot	bind	socket FD 782 to [::]: (2) No such file or directory
</A></li>
	<LI>Next message (by thread): <A HREF="011001.html">[squid-users] Centos 7 squid 3.5.2 / kid2| commBind: Cannot	bind socket FD 782 to [::]: (2) No such file or directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11000">[ date ]</a>
              <a href="thread.html#11000">[ thread ]</a>
              <a href="subject.html#11000">[ subject ]</a>
              <a href="author.html#11000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
