<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SECURITY ALARM, once more
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SECURITY%20ALARM%2C%20once%20more&In-Reply-To=%3C08e50d9d-60a1-4a24-63a8-5d10dd3ccfe1%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011130.html">
   <LINK REL="Next"  HREF="011118.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SECURITY ALARM, once more</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SECURITY%20ALARM%2C%20once%20more&In-Reply-To=%3C08e50d9d-60a1-4a24-63a8-5d10dd3ccfe1%40treenet.co.nz%3E"
       TITLE="[squid-users] SECURITY ALARM, once more">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun 21 10:43:46 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011130.html">[squid-users] SECURITY ALARM, once more
</A></li>
        <LI>Next message (by thread): <A HREF="011118.html">[squid-users] dead gateway, not dead peer..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11131">[ date ]</a>
              <a href="thread.html#11131">[ thread ]</a>
              <a href="subject.html#11131">[ subject ]</a>
              <a href="author.html#11131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/06/2016 9:44 p.m., reinerotto wrote:
&gt;&gt;<i> stay in sync 
</I>&gt;<i> naturally 90-something percent of the time. &lt;
</I>&gt;<i> I have a local dnsmasq running. squid and all clients synced to it.
</I>&gt;<i> But the last 10% seem to cause the SECURITY ALERT.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 2016/06/21 12:17:51.672 kid1| SECURITY ALERT: Host header forgery detected
</I>&gt;<i> on local=nn.nnn.nnn.nnn:443 remote=10.1.0.126:62222 FD 199 flags=33 (local
</I>&gt;<i> IP does not match any domain IP)
</I>&gt;<i> 2016/06/21 12:17:51.672 kid1| SECURITY ALERT: on URL: ib.adnxs.com:443
</I>&gt;<i> 
</I>&gt;<i> In  case, this messages shows up, is the connection terminated ?
</I>&gt;<i> 
</I>
The request continues to be handled same as any other. Except that it is
not cached and only allowed to go upstream to the same destination IP
address the client was trying to use (ORIGINAL_DST).

I'm not completely sure what happens to the SSL-Bump fake CONNECT
requests when the SNI value causes the alert. The fake request has the
above settings flagged, but the SSL-Bump logic may or may not follow
through for the decrypted requests. Those sub-requests should have the
validation check applied separately for their particular Host's anyway,
so maybe different results at that point.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011130.html">[squid-users] SECURITY ALARM, once more
</A></li>
	<LI>Next message (by thread): <A HREF="011118.html">[squid-users] dead gateway, not dead peer..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11131">[ date ]</a>
              <a href="thread.html#11131">[ thread ]</a>
              <a href="subject.html#11131">[ subject ]</a>
              <a href="author.html#11131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
