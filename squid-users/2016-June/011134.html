<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] dead gateway, not dead peer..
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dead%20gateway%2C%20not%20dead%20peer..&In-Reply-To=%3CCAOyb_Eyz6Nz8OnUzw%2B9f4FTH0%3D7aOgFo6Au5vfjfFiJRe%3Dh7RA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011128.html">
   <LINK REL="Next"  HREF="011138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] dead gateway, not dead peer..</H1>
    <B>B. Cook</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dead%20gateway%2C%20not%20dead%20peer..&In-Reply-To=%3CCAOyb_Eyz6Nz8OnUzw%2B9f4FTH0%3D7aOgFo6Au5vfjfFiJRe%3Dh7RA%40mail.gmail.com%3E"
       TITLE="[squid-users] dead gateway, not dead peer..">bcook at poughkeepsieschools.org
       </A><BR>
    <I>Tue Jun 21 19:12:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011128.html">[squid-users] dead gateway, not dead peer..
</A></li>
        <LI>Next message (by thread): <A HREF="011138.html">[squid-users] dead gateway, not dead peer..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11134">[ date ]</a>
              <a href="thread.html#11134">[ thread ]</a>
              <a href="subject.html#11134">[ subject ]</a>
              <a href="author.html#11134">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Jun 21, 2016 at 3:18 AM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> So you're trolling. The FAQ it is then:
</I>&gt;<i>  &lt;<A HREF="http://wiki.squid-cache.org/Features/CacheHierarchy">http://wiki.squid-cache.org/Features/CacheHierarchy</A>&gt;
</I>&gt;<i>  &lt;<A HREF="http://wiki.squid-cache.org/Features/LoadBalance">http://wiki.squid-cache.org/Features/LoadBalance</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&#8203;Thank you the response..

squid.conf (3.5.19 debian host 192.168.10.115)
cache_peer 10.20.12.144 parent 3128 0 no-digest no-netdb-exchange
proxy-only
cache_peer 10.20.12.194 parent 3128 0 no-digest no-netdb-exchange
proxy-only
cache_peer 10.20.32.99 parent 3128 0 no-digest no-netdb-exchange proxy-only
default
prefer_direct off
nonhierarchical_direct off

Turing off squid on host 10.20.12.144 immediately got 10.115 to pass
connections over to 12.194 (great) as denoted in the logs below..

&#8203;2016/06/21 15:02:16 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:16 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| TCP connection to 10.20.12.144/3128 failed
2016/06/21 15:02:24 kid1| Detected DEAD Parent: 10.20.12.144
2016/06/21 15:02:32 kid1| Detected REVIVED Parent: 10.20.12.144&#8203;

When I enabled squid on host 10.20.12.144 squid detected dead -&gt; revived
and passed traffic again.. (also great)..

but when host 10.20.12.144 loses it's gateway, the default route on 12.144
is dead.. traffic is still to 12.144.. squid didn't die, the process is
still running..

Nothing is detected and 12.194 is never contacted..

How do I get squid to detect that no valid data is being returned from
12.144.. or am I missing something?

-- 

This message may contain confidential information and is intended only for 
the individual(s) named. If you are not an intended recipient you are not 
authorized to disseminate, distribute or copy this e-mail. Please notify 
the sender immediately if you have received this e-mail by mistake and 
delete this e-mail from your system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160621/7bf4a69c/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160621/7bf4a69c/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011128.html">[squid-users] dead gateway, not dead peer..
</A></li>
	<LI>Next message (by thread): <A HREF="011138.html">[squid-users] dead gateway, not dead peer..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11134">[ date ]</a>
              <a href="thread.html#11134">[ thread ]</a>
              <a href="subject.html#11134">[ subject ]</a>
              <a href="author.html#11134">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
