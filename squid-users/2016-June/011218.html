<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] flickr.com redirect error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20flickr.com%20redirect%20error&In-Reply-To=%3CCAAFc9FjesKGpGAyOSjPaX1fM0Dam%2Bz0T1xa8AaDrqqcMcRdH4g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011216.html">
   <LINK REL="Next"  HREF="011219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] flickr.com redirect error</H1>
    <B>Ozgur Batur</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20flickr.com%20redirect%20error&In-Reply-To=%3CCAAFc9FjesKGpGAyOSjPaX1fM0Dam%2Bz0T1xa8AaDrqqcMcRdH4g%40mail.gmail.com%3E"
       TITLE="[squid-users] flickr.com redirect error">ozgurbtr at gmail.com
       </A><BR>
    <I>Fri Jun 24 14:23:26 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011216.html">[squid-users] flickr.com redirect error
</A></li>
        <LI>Next message (by thread): <A HREF="011219.html">[squid-users] flickr.com redirect error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11218">[ date ]</a>
              <a href="thread.html#11218">[ thread ]</a>
              <a href="subject.html#11218">[ subject ]</a>
              <a href="author.html#11218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Yuri,

Thank you. I put the #301 loop directives and restarted squid unfortunately
result is the same. Here is the access logs:

1466777191.791    235 ::1 TCP_MISS/301 987 GET <A HREF="https://www.flickr.com/">https://www.flickr.com/</A> -
HIER_DIRECT/188.125.93.100 text/html
1466777192.031    237 ::1 TCP_MISS/301 987 GET <A HREF="https://www.flickr.com/">https://www.flickr.com/</A> -
HIER_DIRECT/188.125.93.100 text/html
1466777192.386    352 ::1 TCP_MISS/301 987 GET <A HREF="https://www.flickr.com/">https://www.flickr.com/</A> -
HIER_DIRECT/188.125.93.100 text/html
1466777192.612    223 ::1 TCP_MISS/301 987 GET <A HREF="https://www.flickr.com/">https://www.flickr.com/</A> -
HIER_DIRECT/188.125.93.100 text/html
...

As I understand all responses are from origin server, there is no cache hit
with or without store_miss and send_hit. Confusing part is when directly
connected to server without proxy, flickr server does not send 301
response. When squid sends the same request somehow flickr server returns
301 with same URL.

Ozgur


On Fri, Jun 24, 2016 at 3:50 PM, Yuri &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">yvoinov at gmail.com</A>&gt; wrote:

&gt;<i> Try to do something like:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> # 301 loop
</I>&gt;<i> acl text_mime rep_mime_type text/html text/plain
</I>&gt;<i>
</I>&gt;<i> acl http301 http_status 301
</I>&gt;<i>
</I>&gt;<i> store_miss deny text_mime http301
</I>&gt;<i> send_hit deny text_mime http301
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 24.06.2016 18:14, Ozgur Batur &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i>
</I>&gt;<i> I receive too many redirects(301 responses with same page URL) error on browser when opening <A HREF="https://www.flickr.com">https://www.flickr.com</A> via Squid 3.5 proxy with SSL interception. If I connect to flickr website directly without Squid error does not happen.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I tested it on two different systems one is Centos other is Ubuntu. There is no acl, redirect or any other configuration in squid.conf except enabling SSL interception.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I opened <A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=4537">http://bugs.squid-cache.org/show_bug.cgi?id=4537</A> for this issue but later thought it is better to ask if you also experience the same issue.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ozgur
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing <A HREF="https://lists.squid-cache.org/listinfo/squid-users">listsquid-users at lists.squid-cache.orghttp</A>://lists.squid-cache.org/listinfo/squid-users
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160624/552babca/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160624/552babca/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011216.html">[squid-users] flickr.com redirect error
</A></li>
	<LI>Next message (by thread): <A HREF="011219.html">[squid-users] flickr.com redirect error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11218">[ date ]</a>
              <a href="thread.html#11218">[ thread ]</a>
              <a href="subject.html#11218">[ subject ]</a>
              <a href="author.html#11218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
