<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Problem with certificates and SSLBump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20certificates%20and%20SSLBump&In-Reply-To=%3Cc070e5a0-6db1-91d0-634e-4b07a5b5df3b%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011249.html">
   <LINK REL="Next"  HREF="011252.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Problem with certificates and SSLBump</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Problem%20with%20certificates%20and%20SSLBump&In-Reply-To=%3Cc070e5a0-6db1-91d0-634e-4b07a5b5df3b%40gmail.com%3E"
       TITLE="[squid-users] Problem with certificates and SSLBump">yvoinov at gmail.com
       </A><BR>
    <I>Sat Jun 25 18:04:41 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="011249.html">[squid-users] Problem with certificates and SSLBump
</A></li>
        <LI>Next message (by thread): <A HREF="011252.html">[squid-users] Some websites doesn't work with squid anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11250">[ date ]</a>
              <a href="thread.html#11250">[ thread ]</a>
              <a href="subject.html#11250">[ subject ]</a>
              <a href="author.html#11250">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 


25.06.2016 23:47, C. L. Martinez &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> On Sun 26.Jun'16 at  5:22:31 +1200, Amos Jeffries wrote:
</I>&gt;&gt;<i> On 26/06/2016 4:46 a.m., C. L. Martinez wrote:
</I>&gt;&gt;&gt;<i> On Sat 25.Jun'16 at 22:33:56 +0600, Yuri Voinov wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;&gt;&gt;&gt;<i> Hash: SHA256
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Use search.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Some days agi I've played around with ECDSA certs and drop it due to
</I>&gt;&gt;&gt;&gt;<i> extremal incompatibility with clients. Here was this thread.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is this the thread:
</I><A HREF="http://marc.info/?l=squid-users&amp;m=146625379320785&amp;w=2?">http://marc.info/?l=squid-users&amp;m=146625379320785&amp;w=2?</A>
&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thats the one that came to my mind when reading your problem description.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here is the solution he found to the cert content error:
</I>&gt;&gt;<i>  &lt;<A HREF="http://marc.info/?l=squid-users&amp;m=146633146001650&amp;w=2">http://marc.info/?l=squid-users&amp;m=146633146001650&amp;w=2</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> YMMV, on the bug 4497 issue. So far no-one has been able to replicate
</I>&gt;&gt;<i> the problem Yuri has. But if you do we would certainly like to know that
</I>&gt;&gt;<i> in the bug report.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (Yuri: sorry, I just noticed the captures you provided a week ago. Not
</I>&gt;&gt;<i> sure how I missed that. I hope to have the time to look them over later
</I>&gt;&gt;<i> today and see if some progress can finally happen on that bug.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Amos
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks Amos. In my case, I am using LibreSSL from OpenBSD. I have used
</I>the following commands to create the Root CA:
&gt;<i>
</I>&gt;<i> openssl ecparam -out private/ec-secp384r1.pem -name secp384r1
</I>&gt;<i> openssl req -config ../openssl.cnf -new -x509 -days 3652 -extensions
</I>v3_ca -sha512 -newkey ec:ec-secp384r1.pem -keyout ec-ca.key -out
../certs/ec-ca.crt
&gt;<i>
</I>&gt;<i>  And works without problems.
</I>&gt;<i>
</I>&gt;<i>  I have done another test: I have created a csr for squid's host
</I>without using ECDSA, using the following commands:
&gt;<i>
</I>&gt;<i> openssl genrsa -out server.key 4096
</I>&gt;<i> openssl req -nodes -key server.key -new -out server.csr
</I>&gt;<i>
</I>&gt;<i>  .. with the same result: fails.
</I>I've tried a bit different. Root CA without ECDSA (RSA4096+SHA256),
intermediate CA with ECDSA, signed by first root. This works on my
testing setups.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Arrived to this I don't know if it could be a best solution to deploy
</I>another CA without ECDSA ...
&gt;<i>
</I>&quot;Compatibility is more important than performance.&quot; (c)

Experience has shown that the compatibility of these certificates is
very questionable and is not supported by all, without exception,
possible clients. That is, in turn, to problems in the support.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJXbse5AAoJENNXIZxhPexGKegH/iMc7esyZ7ULeDF/ZQhiidd0
NV4JsIkIlwL5olbYgM3aDb1Il9ihkVfpcWuz4hPDPvAOz9xwxQbnjbvVeK7boiyE
pEHBomJhS0ZtHCYo3dH8B1AQj06bJCVjtb7gNFyakLVxs0GFF6qmbh/nzn/xG/ny
4inMclgurGcnBn1ejjm+x6l4q+0Tq5pKr3g7GHzcQUCfK06k09Nu35m9CkeDrda9
QBO2V8QT/B5QMVajwYVkGEHt6YQGtz2OmA8lWaR+HR8ftVm9QhgP4tpuSnmx3lRl
0CKzjhzbPZh4zj9ikrBH6TdlD7XTrIRodFhvhGO9xkrD3LaEQeTdx9NPdhlKvt0=
=K0na
-----END PGP SIGNATURE-----

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160626/31da36eb/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160626/31da36eb/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="011249.html">[squid-users] Problem with certificates and SSLBump
</A></li>
	<LI>Next message (by thread): <A HREF="011252.html">[squid-users] Some websites doesn't work with squid anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11250">[ date ]</a>
              <a href="thread.html#11250">[ thread ]</a>
              <a href="subject.html#11250">[ subject ]</a>
              <a href="author.html#11250">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
