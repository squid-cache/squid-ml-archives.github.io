<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sudden but sustained high bandwidth usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56D75C42.1020803%40cinbesa.com.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009471.html">
   <LINK REL="Next"  HREF="009496.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sudden but sustained high bandwidth usage</H1>
    <B>Heiler Bemerguy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56D75C42.1020803%40cinbesa.com.br%3E"
       TITLE="[squid-users] Sudden but sustained high bandwidth usage">heiler.bemerguy at cinbesa.com.br
       </A><BR>
    <I>Wed Mar  2 21:33:54 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009471.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
        <LI>Next message (by thread): <A HREF="009496.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9493">[ date ]</a>
              <a href="thread.html#9493">[ thread ]</a>
              <a href="subject.html#9493">[ subject ]</a>
              <a href="author.html#9493">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello guys..

Thanks for the tips. I've ajusted some stuff here and noticed these 
repeated GETS below.. they are HITS, but why is this happening? lol
I have &quot;*range_offset_limit none*&quot; for this domain (*ws.microsoft.com*) and:

*/refresh_pattern -i 
(microsoft|windowsupdate)\.com.*\.(cab|exe|ms[i|u|f]|dat|zip|psf|appx|esd) 
483840 80% 483840 override-expire ignore-reload/**/
/**/ignore-must-revalidate ignore-private ignore-no-store store-stale/*

These GETs have a &quot;?&quot; in the end, and some options which aren't logged 
but I tcpdumped it: 
*P1=1456938099&amp;P2=1&amp;P3=1&amp;P4=GlQQBGsBJE22%2bm1FQr3q1RnmAb8%3d*

Best Regards,

-- 
Heiler Bemerguy - (91) 98151-4894
Assessor T&#233;cnico - CINBESA (91) 3184-1751



1456953828.014      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953828.748      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953829.686      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953830.314      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953830.670      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953831.468      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953832.297      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953833.310      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953833.797      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953834.638      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953835.376      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953835.766      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953836.560      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953837.372      0 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953838.138      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953838.951      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953839.810      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953840.466      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953841.607      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953842.357      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953845.467      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953846.013      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953846.951      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953847.731      0 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953848.732      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953849.825      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953850.482      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953851.263      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953852.169      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953852.950      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953853.725      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953854.482      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953855.265      3 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953856.091      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953857.154      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953857.859      1 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream
1456953858.668      0 10.101.1.50 TCP_HIT/206 402 GET 
<A HREF="http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?">http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle?</A> 
- HIER_NONE/- application/octet-stream


Em 02/03/2016 01:06, Amos Jeffries escreveu:
&gt;<i> On 2/03/2016 10:57 a.m., Heiler Bemerguy wrote:
</I>&gt;&gt;<i> Hey guys.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For the third time, we got a sudden high bandwidth usage, almost saturating our
</I>&gt;&gt;<i> link, and it won't stop until squid is restarted.
</I>&gt;&gt;<i> I'm totally SURE this inbound traffic comes from squid. It's like it's download
</I>&gt;&gt;<i> stuff itself....
</I>&gt;&gt;<i>
</I>&gt;<i> Yes, it probably is. Or something very close...
</I>&gt;<i>
</I>&gt;&gt;<i> Look that after squid was restarted near 10:45, the network usage drops
</I>&gt;&gt;<i> immediately and won't increase as high as before anymore..
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This pattern started to happen when I changed from ROCK+AUFS to ROCK+ROCK, squid
</I>&gt;&gt;<i> 3.5.14 x64.
</I>&gt;<i> Please upgrade to 3.5.15 asap. Or better the latest snapshot if you have
</I>&gt;<i> trouble with the main release (a few more side effects have been fixed
</I>&gt;<i> this week).
</I>&gt;<i>
</I>&gt;&gt;<i> Here's the most important conf settings.. I appreciate all comments about it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /acl windowsupdate dstdomain .ws.microsoft.com .windowsupdate.microsoft.com
</I>&gt;&gt;<i> .update.microsoft.com .windowsupdate.com//
</I>&gt;&gt;<i> //http_access allow windowsupdate//
</I>&gt;&gt;<i> //range_offset_limit none windowsupdate//
</I>&gt;<i> I suspect you are hitting a case of clients aborting downloads of Win10
</I>&gt;<i> files early and Squid continuing to try to complete them.
</I>&gt;<i>
</I>&gt;<i> The secret downloads the GWX application does of multi-GB files on a
</I>&gt;<i> per-machine basis have been quite a problem for several people over the
</I>&gt;<i> last few months.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> //cache_mem 4 GB//
</I>&gt;&gt;<i> //maximum_object_size_in_memory 5 MB//
</I>&gt;&gt;<i> //memory_replacement_policy heap GDSF//
</I>&gt;&gt;<i> //cache_replacement_policy heap LFUDA//
</I>&gt;&gt;<i> //maximum_object_size 10 GB//
</I>&gt;&gt;<i> //cpu_affinity_map process_numbers=1,2,3,4,5,6 cores=1,2,3,4,5,6//
</I>&gt;&gt;<i> /*/workers 2/**/
</I>&gt;&gt;<i> /**/cache_dir rock /cache2/rock1 90000 min-size=0 max-size=32768/**/
</I>&gt;&gt;<i> /**/cache_dir rock /cache/rock1 300000 min-size=32768 max-size=10737418240/*/
</I>&gt;&gt;<i> //store_dir_select_algorithm round-robin//
</I>&gt;<i> Don't force-configure this when you have min/max controlling which dir
</I>&gt;<i> are usable. Squid default should try to round-robin anyway, but it may
</I>&gt;<i> select a better best-fit action.
</I>&gt;<i>
</I>&gt;&gt;<i> //read_ahead_gap 4096 KB//
</I>&gt;&gt;<i> //client_request_buffer_max_size 2048 KB//
</I>&gt;<i>
</I>&gt;<i>   !!! 2MB packets !??
</I>&gt;<i>
</I>&gt;<i> Please have a read of
</I>&gt;<i> &lt;<A HREF="http://www.bufferbloat.net/projects/bloat/wiki/Introduction">http://www.bufferbloat.net/projects/bloat/wiki/Introduction</A>&gt;
</I>&gt;<i>
</I>&gt;<i> Ths buffer only needs to store the maximum size of expected HTTP request
</I>&gt;<i> mime headers on a single request. That is ~64KB for Squid due to
</I>&gt;<i> hardcoded internal issues. Going far beyond that leads to trouble.
</I>&gt;<i>
</I>&gt;<i> Having larger buffer for multipe requests can be a small help with
</I>&gt;<i> pipelining. BUT you have completely disabled that performance enhancing
</I>&gt;<i> feature of HTTP in your proxy (the *_persistent_connections off settings
</I>&gt;<i> below)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> //dns_v4_first on//
</I>&gt;&gt;<i> //ipcache_size 80000//
</I>&gt;&gt;<i> //fqdncache_size 40000//
</I>&gt;&gt;<i> //memory_pools on//
</I>&gt;&gt;<i> //memory_pools_limit 150 MB//
</I>&gt;&gt;<i> //reload_into_ims on//
</I>&gt;&gt;<i> //connect_retries 3//
</I>&gt;&gt;<i> //cache_swap_low 98//
</I>&gt;&gt;<i> //cache_swap_high 99//
</I>&gt;&gt;<i> //store_avg_object_size 92 KB//
</I>&gt;&gt;<i> //client_idle_pconn_timeout 30 seconds//
</I>&gt;&gt;<i> //client_persistent_connections off//
</I>&gt;&gt;<i> //server_persistent_connections off/
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> error.log right in this moment:
</I>&gt;<i> Ayayeye, you got many troubles.
</I>&gt;<i>
</I>&gt;&gt;<i> 08:55:29 kid1| local=10.1.10.9:3080 remote=10.107.0.71:54515 FD 3665 flags=1:
</I>&gt;&gt;<i> read/write failure: (32) Broken pipe
</I>&gt;&gt;<i> 09:00:02 kid2| snmpHandleUdp: FD 55 recvfrom: (11) Resource temporarily unavailable
</I>&gt;&gt;<i> 09:00:02 kid1| snmpHandleUdp: FD 29 recvfrom: (11) Resource temporarily unavailable
</I>&gt;<i> Unresolved bug in Squid.
</I>&gt;<i>
</I>&gt;&gt;<i> 09:02:14 kid2| WARNING: Closing client connection due to lifetime timeout
</I>&gt;&gt;<i> 09:02:14 kid2|
</I>&gt;&gt;<i> <A HREF="http://prod.video.msn.com/tenant/amp/entityid/BBq7uZY?blobrefkey=103&amp;$blob=1">http://prod.video.msn.com/tenant/amp/entityid/BBq7uZY?blobrefkey=103&amp;$blob=1</A>
</I>&gt;<i> That would be a single HTTP request+reply transaction that took more
</I>&gt;<i> than 24hrs (!?) to complete.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> 09:03:34 kid1| WARNING: HTTP: Invalid Response: Bad header encountered from
</I>&gt;&gt;<i> <A HREF="http://sable.madmimi.com/view?id=24371.4971993.01561ff3">http://sable.madmimi.com/view?id=24371.4971993.01561ff3</A>
</I>&gt;&gt;<i> e8e7c09ac362ded25f80a76b AKA
</I>&gt;&gt;<i> sable.madmimi.com/view?id=24371.4971993.01561ff3e8e7c09ac362ded25f80a76b
</I>&gt;<i> Okay. That server is being a bad HTTP citizen. This is just info to help
</I>&gt;<i> with the client complaints you will probably get about the 4xx/5xx
</I>&gt;<i> errors contacting that site through Squid. If you want to assist fixing
</I>&gt;<i> you can report the issue to its admin.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> 09:03:38 kid1| WARNING: Closing client connection due to lifetime timeout
</I>&gt;&gt;<i> 09:03:38 kid1|
</I>&gt;&gt;<i> <A HREF="http://download.windowsupdate.com/d/msdownload/update/software/defu/2016/02/am_delta_patch_1.213.7305.0_59c57a">http://download.windowsupdate.com/d/msdownload/update/software/defu/2016/02/am_delta_patch_1.213.7305.0_59c57a</A>
</I>&gt;&gt;<i> caccbdfa7fa9dd5574f0a7ded60de11963.exe
</I>&gt;<i> Another 24hr one ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> 09:04:15 kid1| WARNING: HTTP: Invalid Response: Bad header encountered from
</I>&gt;&gt;<i> <A HREF="http://sable.madmimi.com/view?id=24371.4931972.b5133065">http://sable.madmimi.com/view?id=24371.4931972.b5133065</A>
</I>&gt;&gt;<i> c861d91790f59bf39ef1abf3 AKA
</I>&gt;&gt;<i> sable.madmimi.com/view?id=24371.4931972.b5133065c861d91790f59bf39ef1abf3
</I>&gt;&gt;<i> 09:04:28 kid2| WARNING: Closing client connection due to lifetime timeout
</I>&gt;&gt;<i> 09:04:28 kid2| <A HREF="http://www.ingressocerto.com/facet-search.json?f=/p-data-Offset:2">http://www.ingressocerto.com/facet-search.json?f=/p-data-Offset:2</A>
</I>&gt;<i> Getting a lot of these long transactions.
</I>&gt;<i>
</I>&gt;&gt;<i> 09:04:42 kid2| Could not parse headers from on disk object
</I>&gt;<i> This innocent seeming message is related to the CVE-2016-2571 issue. It
</I>&gt;<i> is a sign that the vulnerability has happened in some past transaction.
</I>&gt;<i> Squid is handling this part of the fallout though, so whats happened
</I>&gt;<i> *right now* is okay.
</I>&gt;<i>
</I>&gt;&gt;<i> 09:05:02 kid1| snmpHandleUdp: FD 29 recvfrom: (11) Resource temporarily unavailable
</I>&gt;&gt;<i> 09:05:02 kid2| snmpHandleUdp: FD 55 recvfrom: (11) Resource temporarily unavailable
</I>&gt;&gt;<i> 09:05:02 kid1| snmpHandleUdp: FD 29 recvfrom: (11) Resource temporarily unavailable
</I>&gt;&gt;<i> 09:05:18 kid2| SECURITY ALERT: Missing hostname in URL '<A HREF="http://">http://</A>'. see access.log
</I>&gt;&gt;<i> for details.
</I>&gt;<i> Should be self explanatory. Your proxy appears to be under attack.
</I>&gt;<i> &lt;<A HREF="http://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages">http://wiki.squid-cache.org/SquidFaq/SquidLogs#Squid_Error_Messages</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &lt;snip many repeats of earier problems&gt;
</I>&gt;&gt;<i> 09:25:49 kid1| urlParse: URL too large (8231 bytes)
</I>&gt;&gt;<i> 09:27:24 kid1| urlParse: URL too large (8231 bytes)
</I>&gt;&gt;<i> 09:27:46 kid2| urlParse: URL too large (10742 bytes)
</I>&gt;<i> These should also be self-explanatory. They are also attack signatures
</I>&gt;<i> for certain types of buffer-overrun attacks.
</I>&gt;<i> Squid is coping, but you should really do something forceful to whack
</I>&gt;<i> the source of these requests over the head.
</I>&gt;<i>
</I>&gt;<i> It might be related to the ALERT situation. For example a &quot;GET
</I>&gt;<i> <A HREF="http://...">http://...</A> HTTP/1.1&quot; where the ... is a 8-10 KB long &quot;domain name&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;snip more repeats&gt;
</I>&gt;&gt;<i> 09:50:28 kid1| Could not parse headers from on disk object
</I>&gt;&gt;<i> 09:50:28 kid1| varyEvaluateMatch: Oops. Not a Vary object on second attempt,
</I>&gt;&gt;<i> '<A HREF="http://pix04.revsci.net/D08734/a1/0/3/0.js?DM_LOC=%3D">http://pix04.revsci.net/D08734/a1/0/3/0.js?DM_LOC=%3D</A>
</I>&gt;&gt;<i> http%3A%2F%2Fna.com%3FdlxInitiated%3Dtrue%26nada%3D%26naid%3D2015121611542932923036123812%26namp%3D'
</I>&gt;&gt;<i> 'accept-encoding=&quot;gzip,%20deflate,%20sdch
</I>&gt;&gt;<i> &quot;'
</I>&gt;&gt;<i> 09:50:28 kid1| clientProcessHit: Vary object loop!
</I>&gt;<i> Probably a side effect of the other nasties going on. Though some people
</I>&gt;<i> do see this happening and it has open bug report(s), we are still trying
</I>&gt;<i> to get to the bottom of it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> 09:50:46 kid1| helperHandleRead: unexpected reply on channel 0 from redirector
</I>&gt;&gt;<i> #Hlpr301 'OK'
</I>&gt;&gt;<i> 09:50:46 kid1| helperHandleRead: unexpected reply on channel 0 from redirector
</I>&gt;&gt;<i> #Hlpr301 'OK'
</I>&gt;<i> ** URGENT PROBLEM: **
</I>&gt;<i>
</I>&gt;<i> The redirector helper you are using is broken. It is presenting either
</I>&gt;<i> multiple-lines for each reply, or replies without being asked about any URL.
</I>&gt;<i> In both cases Squid will be given wrong instructions to re-write random
</I>&gt;<i> requests to some other URL for producing the reply.
</I>&gt;<i>
</I>&gt;<i> This could be the root cause behind some of those weird long request
</I>&gt;<i> timeouts or aborted transaction issues. It will *definitely* result in
</I>&gt;<i> clients randomly being given wrong objects to their replies.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So, my advice:
</I>&gt;<i>
</I>&gt;<i>   * fix the redirector. See what other issues / side effects of that
</I>&gt;<i> disappear.
</I>&gt;<i>
</I>&gt;<i>   * if they remain track down what those SECURITY ALERT are about. Get
</I>&gt;<i> that fixed if you can.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I expect the high bandwith will reduce with those two above issues gone
</I>&gt;<i> and the WU settings altered.
</I>&gt;<i>
</I>&gt;<i> You can also further improve things by looking into the too-long URL
</I>&gt;<i> issues if they remain.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160302/d74c7654/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160302/d74c7654/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009471.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
	<LI>Next message (by thread): <A HREF="009496.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9493">[ date ]</a>
              <a href="thread.html#9493">[ thread ]</a>
              <a href="subject.html#9493">[ subject ]</a>
              <a href="author.html#9493">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
