<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Kerberos (Negotiate) problem with win2008 AD users
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Kerberos%20%28Negotiate%29%20problem%20with%20win2008%20AD%20users&In-Reply-To=%3C20160306234934.GA5378%40baea.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009564.html">
   <LINK REL="Next"  HREF="009703.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Kerberos (Negotiate) problem with win2008 AD users</H1>
    <B>LYMN</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Kerberos%20%28Negotiate%29%20problem%20with%20win2008%20AD%20users&In-Reply-To=%3C20160306234934.GA5378%40baea.com.au%3E"
       TITLE="[squid-users] Kerberos (Negotiate) problem with win2008 AD users">brett.lymn at baesystems.com
       </A><BR>
    <I>Sun Mar  6 23:49:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009564.html">[squid-users] Kerberos (Negotiate) problem with win2008 AD users
</A></li>
        <LI>Next message (by thread): <A HREF="009703.html">[squid-users] Kerberos (Negotiate) problem with win2008 AD users
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9570">[ date ]</a>
              <a href="thread.html#9570">[ thread ]</a>
              <a href="subject.html#9570">[ subject ]</a>
              <a href="author.html#9570">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Mar 06, 2016 at 07:18:18PM +0600, Victor Sudakov wrote:
&gt;<i> 
</I>&gt;<i> On a more practical note, the Windows command to extract the squid
</I>&gt;<i> keytab from the AD was
</I>&gt;<i> 
</I>&gt;<i> ktpass -princ HTTP/<A HREF="https://lists.squid-cache.org/listinfo/squid-users">proxy2.sibptus.ru at STN.TN.CORP</A> -mapuser squiduser +rndPass -out squid.keytab -ptype KRB5_NT_PRINCIPAL /target x.x.x.x -kvno 1 -crypto All 
</I>&gt;<i> 
</I>&gt;<i> probably the &quot;-kvno 1&quot; is to blame. If anyone is experienced with the
</I>&gt;<i> Microsoft Kerberos implementation, is this a correct command? Is it
</I>&gt;<i> necessary to explicitly specify the kvno?
</I>&gt;<i> 
</I>
You should not be specifying the kvno normally.  If you specify the kvno
that is the number that gets written to the keytab but the one in AD is
not set to that number.  I think it is only useful if you are exporting
the keytab for multiple principals, in that case you specify the kvno
that will be in effect once you have done all the principals, if that
makes sense.

&gt;<i> The Squid Wiki recommends msktutil instead of ktpass.exe though.
</I>&gt;<i> 
</I>
Which is fine if you are able to install those tools in your
environment.  The ktpass command is a bit clunky but can get the job
done in most instances.

-- 
Brett Lymn
This email has been sent on behalf of one of the following companies within the BAE Systems Australia group of companies:

    BAE Systems Australia Limited - Australian Company Number 008 423 005
    BAE Systems Australia Defence Pty Limited - Australian Company Number 006 870 846
    BAE Systems Australia Logistics Pty Limited - Australian Company Number 086 228 864

Our registered office is Evans Building, Taranaki Road, Edinburgh Parks,
Edinburgh, South Australia, 5111. If the identity of the sending company is
not clear from the content of this email please contact the sender.

This email and any attachments may contain confidential and legally
privileged information.  If you are not the intended recipient, do not copy or
disclose its content, but please reply to this email immediately and highlight
the error to the sender and then immediately delete the message.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009564.html">[squid-users] Kerberos (Negotiate) problem with win2008 AD users
</A></li>
	<LI>Next message (by thread): <A HREF="009703.html">[squid-users] Kerberos (Negotiate) problem with win2008 AD users
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9570">[ date ]</a>
              <a href="thread.html#9570">[ thread ]</a>
              <a href="subject.html#9570">[ subject ]</a>
              <a href="author.html#9570">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
