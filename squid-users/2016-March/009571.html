<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSL Bump Issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20Bump%20Issue&In-Reply-To=%3CCA%2Bbb48ULapy0uZBQuhBFvniZpRRDBDtqRMYBw3Ps0Srtg_af1A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009535.html">
   <LINK REL="Next"  HREF="009574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSL Bump Issue</H1>
    <B>Ali Jawad</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20Bump%20Issue&In-Reply-To=%3CCA%2Bbb48ULapy0uZBQuhBFvniZpRRDBDtqRMYBw3Ps0Srtg_af1A%40mail.gmail.com%3E"
       TITLE="[squid-users] SSL Bump Issue">alijawad1 at gmail.com
       </A><BR>
    <I>Mon Mar  7 01:50:26 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009535.html">[squid-users] SSL Bump Issue
</A></li>
        <LI>Next message (by thread): <A HREF="009574.html">[squid-users] SSL Bump Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9571">[ date ]</a>
              <a href="thread.html#9571">[ thread ]</a>
              <a href="subject.html#9571">[ subject ]</a>
              <a href="author.html#9571">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi
Pardon me if I am mistaken but isnt it the case that 1 :

iptables -t nat -A PREROUTING -p tcp  --dport 443 --destination
162.220.xx.xx -j REDIRECT --to-ports 3129
The rule above would only match for the IP of squid and squid should be
heading to the actual IP of the site in question which is not on the same
server

and 2 :

If Squid is intercepting the PREROUTING chain would not apply anymore, as
traffic passing through local daemons goes through OUTPUT and POSTROUTING
chains

As for

iptables -t nat -A PREROUTING -s $SQUIDIP -p tcp --dport 80 -j ACCEPT


All traffic set to ACCEPT ..thanks !

Regards

On Fri, Mar 4, 2016 at 11:11 AM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 4/03/2016 10:01 p.m., Ali Jawad wrote:
</I>&gt;<i> &gt; Actually, now that I am using 3.15 it seems I get the error for port 80
</I>&gt;<i> -&gt;
</I>&gt;<i> &gt; 3128 intercepts again
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; TCP_MISS/503 4274 GET <A HREF="http://www.whereIwantToVisit.net/">http://www.whereIwantToVisit.net/</A> - ORIGINAL_DST/
</I>&gt;<i> &gt; 162.220.244.7 text/html
</I>&gt;<i>
</I>&gt;<i> This is the same problem happening for both port 443 and port 80.
</I>&gt;<i> You need to exclude the squid outgoing traffic from the iptables NAT
</I>&gt;<i> REDIRECT.
</I>&gt;<i>
</I>&gt;<i> Compare the tutorial rules with what you have:
</I>&gt;<i> &lt;<A HREF="http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect">http://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxRedirect</A>&gt;
</I>&gt;<i>
</I>&gt;<i> I believe you are missing that first rule with &quot;-s $SQUIDIP -p tcp
</I>&gt;<i> --dport 80 -j ACCEPT&quot;.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160307/25f9d510/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160307/25f9d510/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009535.html">[squid-users] SSL Bump Issue
</A></li>
	<LI>Next message (by thread): <A HREF="009574.html">[squid-users] SSL Bump Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9571">[ date ]</a>
              <a href="thread.html#9571">[ thread ]</a>
              <a href="subject.html#9571">[ subject ]</a>
              <a href="author.html#9571">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
