<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sudden but sustained high bandwidth usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDBB65.3090907%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009601.html">
   <LINK REL="Next"  HREF="009602.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sudden but sustained high bandwidth usage</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDBB65.3090907%40ngtech.co.il%3E"
       TITLE="[squid-users] Sudden but sustained high bandwidth usage">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Mar  7 17:33:25 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009601.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
        <LI>Next message (by thread): <A HREF="009602.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9597">[ date ]</a>
              <a href="thread.html#9597">[ thread ]</a>
              <a href="subject.html#9597">[ subject ]</a>
              <a href="author.html#9597">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/03/2016 16:29, Heiler Bemerguy wrote:
&gt;<i> We're still getting all these SWAPFAIL and our link is
</I>&gt;<i> skyrocketing...... please help! I think it didn't happen on older
</I>&gt;<i> versions (.14 and below)
</I>
Hey,

What do you mean by skyrocketing?? like in the graph??
Also it is not clear to me something about the machine, is this machine 
a FW\ROUTER\GW?
If so is it for a lan?
How many interface this machine has?
Is it a pfsense? if so what version?
What is the FS used for the cache directories?
Did you also measured CPU when you see the spikes? if so what is it?
How clients access the proxy service? transparently or using a browser 
setings or WPAD with dhcp settings?
Also I have seen you are using 2 workers, is it because one worker 
doesn't seem to do the job?
Did you tried to change the values of:
cache_swap_low 98
cache_swap_high 99

from this high to lower numbers such as:
cache_swap_low 90
cache_swap_high 95

or even lower?
cache_swap_low 80
cache_swap_high 85

I am unsure about this since in the docs at:
<A HREF="http://www.squid-cache.org/Doc/config/cache_swap_low/">http://www.squid-cache.org/Doc/config/cache_swap_low/</A>
<A HREF="http://www.squid-cache.org/Doc/config/cache_swap_high/">http://www.squid-cache.org/Doc/config/cache_swap_high/</A>

the ROCK storage is not mentioned.

Also on what hardware are you running? what disks?

All the above are important and in your case it is possible that there 
is something wrong in how the network is planned or the software doing 
something wrong.

In scenarios like this I offer to verify two things:
- test what happens when you disable disk cache.(from CPU, bandwidth, 
DISK aspect)
- dump the cache manager info page to see basic statistics about the 
proxy traffic using: 
http:/cache_ip_or_visiblie_host_name:3128/squid-internal-mgr/info

For scenarios like this I started working on a logging\monitoring 
service\script that will run in the background of the machine and will 
dump content of some statistics to enable couple squid developers eyes 
to see these and then have a better understanding the nature of the issue.
For now the script\service is not ready and will not be able to help us 
so we need these dumps and information..

Eliezer

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009601.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
	<LI>Next message (by thread): <A HREF="009602.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9597">[ date ]</a>
              <a href="thread.html#9597">[ thread ]</a>
              <a href="subject.html#9597">[ subject ]</a>
              <a href="author.html#9597">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
