<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sudden but sustained high bandwidth usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDD187.3080808%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009602.html">
   <LINK REL="Next"  HREF="009605.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sudden but sustained high bandwidth usage</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDD187.3080808%40ngtech.co.il%3E"
       TITLE="[squid-users] Sudden but sustained high bandwidth usage">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Mar  7 19:07:51 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009602.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
        <LI>Next message (by thread): <A HREF="009605.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9604">[ date ]</a>
              <a href="thread.html#9604">[ thread ]</a>
              <a href="subject.html#9604">[ subject ]</a>
              <a href="author.html#9604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry about the confusion\misunderstanding.. my brains cache is kind of 
tiny\short and I am not sure but was it you that asked about the big 
NETAPP cache a question not long ago? or was it someone else? I am maybe 
confusing because the other one had more clients but a similar issue.

I will later read and try to understand the info page again but I just 
wanted to clear something out about storage which might be known in some 
places but not to everybody.

Every storage system requires some logical and physical layer and each 
and every one of them is doing something to any IO that happens!!!
I do not say that there is an issue with the raid or the storage but it 
is clear that the storage else then the RAID needs some kind of &quot;cache&quot; 
or some level of buffering in order to work better. It's the same for 
DAS, SAN, NAS and any other form of storage. This is the design of such 
products. The only place which a storage is almost always directly 
accessed by most IO calls is the RAM and in the DAS area it's SSD and 
RAM+battery based products which &quot;cache&quot; is only slowing down the RAM 
and CPU.

I am not sure I interpret the cache_dir the docs state:
<A HREF="http://west.squid-cache.org/Doc/config/cache_dir/">http://west.squid-cache.org/Doc/config/cache_dir/</A>
	    cache_dir rock Directory-Name Mbytes [options]

which means that you are using:
cache_dir rock /cache2/rock1 90000 min-size=0 max-size=32768
cache_dir rock /cache/rock1 300000 min-size=32769 max-size=10737418240

90K MB on the first?
300K MB o the second? right?

How much is it in GB??

Eliezer

On 07/03/2016 20:38, Heiler Bemerguy wrote:
&gt;<i> skyrocketing = using our maximum link download bandwidth.
</I>&gt;<i> This machine is only proxying. Not being a firewall, not a router, nor a
</I>&gt;<i> gateway. It has access to the internet through our gateway/firewall
</I>&gt;<i> (pfsense).
</I>&gt;<i> Lots of LAN clients are connected to the proxy, this is their only way
</I>&gt;<i> to the internet. 1 interface, debian linux. EXT4 FS. CPU/MEM usage is
</I>&gt;<i> always stable.
</I>&gt;<i> Clients use it explicitly or via wpad. Never transparently. Now I'm
</I>&gt;<i> using 3 workers, because 1 is not enough and we have spare cores.
</I>&gt;<i> It's a VM machine with netapp storage. lots of raid disks.
</I>&gt;<i> SQUID was running perfectly without cache_dirs.
</I>&gt;<i>
</I>&gt;<i> I think squid is downloading and redownloading the same files over and
</I>&gt;<i> over again because: 1- these are segmented downloads and
</I>&gt;<i> range_offset_limit is set to NONE for these files. 2- it can't store the
</I>&gt;<i> downloaded files on the cache but I don't know why!
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009602.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
	<LI>Next message (by thread): <A HREF="009605.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9604">[ date ]</a>
              <a href="thread.html#9604">[ thread ]</a>
              <a href="subject.html#9604">[ subject ]</a>
              <a href="author.html#9604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
