<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sudden but sustained high bandwidth usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDDFB5.1050404%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009604.html">
   <LINK REL="Next"  HREF="009608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sudden but sustained high bandwidth usage</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DDDFB5.1050404%40gmail.com%3E"
       TITLE="[squid-users] Sudden but sustained high bandwidth usage">yvoinov at gmail.com
       </A><BR>
    <I>Mon Mar  7 20:08:21 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009604.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
        <LI>Next message (by thread): <A HREF="009608.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9605">[ date ]</a>
              <a href="thread.html#9605">[ thread ]</a>
              <a href="subject.html#9605">[ subject ]</a>
              <a href="author.html#9605">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
90 Gb first, 300 Gb second.

08.03.16 1:07, Eliezer Croitoru &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Sorry about the confusion\misunderstanding.. my brains cache is kind of tiny\short and
</I>I am not sure but was it you that asked about the big NETAPP cache a
question not long ago? or was it someone else? I am maybe confusing
because the other one had more clients but a similar issue.
&gt;<i>
</I>&gt;<i> I will later read and try to understand the info page again but I just
</I>wanted to clear something out about storage which might be known in some
places but not to everybody.
&gt;<i>
</I>&gt;<i> Every storage system requires some logical and physical layer and each
</I>and every one of them is doing something to any IO that happens!!!
&gt;<i> I do not say that there is an issue with the raid or the storage but
</I>it is clear that the storage else then the RAID needs some kind of
&quot;cache&quot; or some level of buffering in order to work better. It's the
same for DAS, SAN, NAS and any other form of storage. This is the design
of such products. The only place which a storage is almost always
directly accessed by most IO calls is the RAM and in the DAS area it's
SSD and RAM+battery based products which &quot;cache&quot; is only slowing down
the RAM and CPU.
&gt;<i>
</I>&gt;<i> I am not sure I interpret the cache_dir the docs state:
</I>&gt;<i> <A HREF="http://west.squid-cache.org/Doc/config/cache_dir/">http://west.squid-cache.org/Doc/config/cache_dir/</A>
</I>&gt;<i>         cache_dir rock Directory-Name Mbytes [options]
</I>&gt;<i>
</I>&gt;<i> which means that you are using:
</I>&gt;<i> cache_dir rock /cache2/rock1 90000 min-size=0 max-size=32768
</I>&gt;<i> cache_dir rock /cache/rock1 300000 min-size=32769 max-size=10737418240
</I>&gt;<i>
</I>&gt;<i> 90K MB on the first?
</I>&gt;<i> 300K MB o the second? right?
</I>&gt;<i>
</I>&gt;<i> How much is it in GB??
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i> On 07/03/2016 20:38, Heiler Bemerguy wrote:
</I>&gt;&gt;<i> skyrocketing = using our maximum link download bandwidth.
</I>&gt;&gt;<i> This machine is only proxying. Not being a firewall, not a router, nor a
</I>&gt;&gt;<i> gateway. It has access to the internet through our gateway/firewall
</I>&gt;&gt;<i> (pfsense).
</I>&gt;&gt;<i> Lots of LAN clients are connected to the proxy, this is their only way
</I>&gt;&gt;<i> to the internet. 1 interface, debian linux. EXT4 FS. CPU/MEM usage is
</I>&gt;&gt;<i> always stable.
</I>&gt;&gt;<i> Clients use it explicitly or via wpad. Never transparently. Now I'm
</I>&gt;&gt;<i> using 3 workers, because 1 is not enough and we have spare cores.
</I>&gt;&gt;<i> It's a VM machine with netapp storage. lots of raid disks.
</I>&gt;&gt;<i> SQUID was running perfectly without cache_dirs.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I think squid is downloading and redownloading the same files over and
</I>&gt;&gt;<i> over again because: 1- these are segmented downloads and
</I>&gt;&gt;<i> range_offset_limit is set to NONE for these files. 2- it can't store the
</I>&gt;&gt;<i> downloaded files on the cache but I don't know why!
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJW3d+0AAoJENNXIZxhPexGtrwH/RX6Jq0YRghYxYTblcG7FZAE
AU7MUklAulu4NMT8xTupv3j1zfqdj8Mj3SIOZIiugJv9ByYcSp3QF0J2wfmHatHk
E6U58mFj22bCTNnvMUjMzDCEMq8+I8mwoSlk50OonXR11HQvaDak92A6IQ0w7KQs
Ic6YjD+Hn2/4diQ5gg4nvtTWYm7oBcVVqKdEZ9NKlzqXTICKwBD6Nk8WfmCMDtBb
xdQd4zhnOLihIKOwH2mYtiYh2d8oayBvKLRimKhYA3XLM71+oEdEqkC27yzKx+3F
sKZWCCQNWn9wN331gKZl6TCUgHmeX5YvRHBPJ3tKjixvqfgzrGcjuSW86Hl354I=
=uE/j
-----END PGP SIGNATURE-----

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160308/6a6d2691/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160308/6a6d2691/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009604.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
	<LI>Next message (by thread): <A HREF="009608.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9605">[ date ]</a>
              <a href="thread.html#9605">[ thread ]</a>
              <a href="subject.html#9605">[ subject ]</a>
              <a href="author.html#9605">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
