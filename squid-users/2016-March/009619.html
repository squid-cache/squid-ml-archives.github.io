<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sudden but sustained high bandwidth usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DEEF2F.80404%40cinbesa.com.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009617.html">
   <LINK REL="Next"  HREF="009632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sudden but sustained high bandwidth usage</H1>
    <B>Heiler Bemerguy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sudden%20but%20sustained%20high%20bandwidth%20usage&In-Reply-To=%3C56DEEF2F.80404%40cinbesa.com.br%3E"
       TITLE="[squid-users] Sudden but sustained high bandwidth usage">heiler.bemerguy at cinbesa.com.br
       </A><BR>
    <I>Tue Mar  8 15:26:39 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009617.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
        <LI>Next message (by thread): <A HREF="009632.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9619">[ date ]</a>
              <a href="thread.html#9619">[ thread ]</a>
              <a href="subject.html#9619">[ subject ]</a>
              <a href="author.html#9619">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
This way it won't cache any &quot;range&quot; downloads as &quot;range_offset_limit 0&quot; 
is the default option and it will make squid only download what the 
client requested.

 From squid-cache.org: &quot;A size of 0 causes Squid to never fetch more 
than the client requested. (default)&quot;

What I'm trying to accomplish here, and have done while using AUFS, is 
to make squid CACHE/STORE RANGED REQUESTS for windowsupdate.com, instead 
of its default action of aborting.

How can I monitor whats the reason of all the &quot;TCP_SWAPFAIL_MISS&quot; on 
range downloads like these:

1457381845.725    241 10.101.1.23 TCP_SWAPFAIL_MISS/206 33123 GET 
<A HREF="http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf">http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf</A> 
- HIER_DIRECT/201.49.144.135 application/pdf
1457381846.036    293 10.101.1.23 TCP_SWAPFAIL_MISS/206 151352 GET 
<A HREF="http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf">http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf</A> 
- HIER_DIRECT/201.49.144.135 application/pdf
1457381846.120     66 10.101.1.23 TCP_SWAPFAIL_MISS/206 33129 GET 
<A HREF="http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf">http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf</A> 
- HIER_DIRECT/201.49.144.135 application/pdf
1457381846.310     66 10.101.1.23 TCP_SWAPFAIL_MISS/206 33129 GET 
<A HREF="http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf">http://www.stf.jus.br/arquivo/biblioteca/NovasAquisicoes/2015-10/1043520/sumario.pdf</A> 
- HIER_DIRECT/201.49.144.135 application/pdf

Best Regards,

-- 
Heiler Bemerguy - (91) 98151-4894
Assessor T&#233;cnico - CINBESA (91) 3184-1751


Em 08/03/2016 05:04, L.P.H. van Belle escreveu:
&gt;<i>
</I>&gt;<i> I had this problem to.
</I>&gt;<i>
</I>&gt;<i> I fixed this as followed
</I>&gt;<i>
</I>&gt;<i> - Updated my windowsupdate acl
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain windowsupdate.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain .update.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain download.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain redir.metaservices.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain images.metaservices.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain c.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain www.download.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain wustat.windows.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain crl.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain sls.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain productactivation.one.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain ntservicepack.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain au.download.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain ds.download.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain ctldl.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain .data.microsoft.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain .l.windowsupdate.com
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain .microsoft.com.akadns.net
</I>&gt;<i>
</I>&gt;<i> acl windowsupdate dstdomain .deploy.akamaitechnologies.com
</I>&gt;<i>
</I>&gt;<i> I updated the refresh_pattern&#8230;
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i 
</I>&gt;<i> windowsupdate.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 
</I>&gt;<i> 43200 80% 129600 reload-into-ims
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i 
</I>&gt;<i> microsoft.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 
</I>&gt;<i> 43200 80% 129600 reload-into-ims
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i 
</I>&gt;<i> windows.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 
</I>&gt;<i> 80% 129600 reload-into-ims
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i 
</I>&gt;<i> microsoft.com.akadns.net/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 
</I>&gt;<i> 43200 80% 129600 reload-into-ims
</I>&gt;<i>
</I>&gt;<i> refresh_pattern -i 
</I>&gt;<i> deploy.akamaitechnologies.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 
</I>&gt;<i> 43200 80% 129600 reload-into-imsI change above
</I>&gt;<i>
</I>&gt;<i> and i change these :
</I>&gt;<i>
</I>&gt;<i> range_offset_limit 0
</I>&gt;<i>
</I>&gt;<i> quick_abort_min 0 KB
</I>&gt;<i>
</I>&gt;<i> quick_abort_max 0 KB
</I>&gt;<i>
</I>&gt;<i> quick_abort_pct 90
</I>&gt;<i>
</I>&gt;<i> now the download for windows updates wont eat up your bandwith..
</I>&gt;<i>
</I>&gt;<i> Greetz,
</I>&gt;<i>
</I>&gt;<i> Louis
</I>&gt;<i>
</I>&gt;<i> &gt; -----Oorspronkelijk bericht-----
</I>&gt;<i>
</I>&gt;<i> &gt; Van: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] Namens
</I>&gt;<i>
</I>&gt;<i> &gt; Alex Rousskov
</I>&gt;<i>
</I>&gt;<i> &gt; Verzonden: dinsdag 8 maart 2016 6:05
</I>&gt;<i>
</I>&gt;<i> &gt; Aan: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> &gt; Onderwerp: Re: [squid-users] Sudden but sustained high bandwidth usage
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; On 03/07/2016 07:00 PM, Amos Jeffries wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; Its a minor bug in the report display that they are not having more
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; columns with separate numbers for each worker.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; IMHO, the *summary* page should not include such noise. There should be
</I>&gt;<i>
</I>&gt;<i> &gt; a way to request worker-specific stats instead.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Even for stats at the lower than mgr:info level, it may be a design bug
</I>&gt;<i>
</I>&gt;<i> &gt; to start including per-worker &quot;columns&quot; in human readable output format.
</I>&gt;<i>
</I>&gt;<i> &gt; Such &quot;zooming&quot; and &quot;scoping&quot; is best done by wrapper tools that can use
</I>&gt;<i>
</I>&gt;<i> &gt; HTML tables, links, Javascript boxes, and other visualization tools
</I>&gt;<i>
</I>&gt;<i> &gt; meant for navigating complex multi-layered information.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; On 03/07/2016 07:57 PM, Eliezer Croitoru wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; I didn't found any bug report that is related to the subject.
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; I will try to add it into the bugzilla later.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; If you do, please copy my objections there as well.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Thank you,
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Alex.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i>
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i>
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160308/69669377/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160308/69669377/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009617.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
	<LI>Next message (by thread): <A HREF="009632.html">[squid-users] Sudden but sustained high bandwidth usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9619">[ date ]</a>
              <a href="thread.html#9619">[ thread ]</a>
              <a href="subject.html#9619">[ subject ]</a>
              <a href="author.html#9619">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
