<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] clientProcessHit
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20clientProcessHit&In-Reply-To=%3C56E15832.5080108%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009683.html">
   <LINK REL="Next"  HREF="009657.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] clientProcessHit</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20clientProcessHit&In-Reply-To=%3C56E15832.5080108%40treenet.co.nz%3E"
       TITLE="[squid-users] clientProcessHit">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 10 11:19:14 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009683.html">[squid-users] clientProcessHit
</A></li>
        <LI>Next message (by thread): <A HREF="009657.html">[squid-users] clientProcessHit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9685">[ date ]</a>
              <a href="thread.html#9685">[ thread ]</a>
              <a href="subject.html#9685">[ subject ]</a>
              <a href="author.html#9685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/03/2016 10:57 p.m., joe wrote:
&gt;<i> 
</I>&gt;&gt;<i> Ah, you said you understood Vary. But this mail indicates that you do
</I>&gt;&gt;<i> not quite understand it well enough.
</I>&gt;<i> i do understand may be the way sometime i try to explain it goes buggy lol
</I>&gt;<i> like those bug any way
</I>&gt;<i> 
</I>&gt;&gt;<i> I prune away the extra headers to clarify:
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> Firefox:
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> GET /en_US/embeds.js HTTP/1.1
</I>&gt;&gt;&gt;<i> Accept-Encoding: gzip, deflate
</I>&gt;<i>  
</I>&gt;&gt;&gt;<i> HTTP/1.1 200 OK
</I>&gt;&gt;&gt;<i> Vary: Accept-Encoding
</I>&gt;&gt;&gt;<i> ----------------------------------------------------------
</I>&gt;<i> 
</I>&gt;&gt;<i> Chrome:
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> GET /en_US/embeds.js HTTP/1.1
</I>&gt;&gt;&gt;<i> Accept-Encoding: gzip, deflate, sdch
</I>&gt;<i> 
</I>&gt;&gt;<i> ... notice how Accept-Encoding changed.
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> HTTP/1.1 200 OK
</I>&gt;&gt;&gt;<i> Vary: Accept-Encoding
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> The Vary header tells Squid that these objects are to be stored with the
</I>&gt;&gt;<i> *content* of the requests Accept-Encoding header added to their URL on
</I>&gt;&gt;<i> the cache index.
</I>&gt;<i> 
</I>&gt;&gt;<i> The Accept-Encoding details are effectively being added to the URL
</I>&gt;&gt;<i> query-string without actually being added to the public URL users see.
</I>&gt;<i> yup
</I>&gt;&gt;<i> Since the Accept-Encoding headers are different on the Chrome requests
</I>&gt;&gt;<i> these objects are as different in cache.
</I>&gt;<i> yup
</I>&gt;&gt;<i> Firefox shares Accept-Encoding value with IE, and with some command-line
</I>&gt;&gt;<i> tools. So they have no problems caching for one and re-using the cached
</I>&gt;&gt;<i> object for another.
</I>&gt;<i> yup
</I>&gt;&gt;<i> But Chome do the Google sdch thing, so it cant use those objects and has
</I>&gt;&gt;<i> to have a separate object cached just for Google products.
</I>&gt;<i> 
</I>&gt;<i> yup but event if i force gzip only as
</I>&gt;<i> # Normalize Accept-Encoding to support compression for better caching 
</I>&gt;<i> request_header_access Accept-Encoding deny all 
</I>&gt;<i> request_header_replace Accept-Encoding gzip
</I>
Manipulating what Squid sends to the server does not affect what the
client has sent to Squid earlier.

The server sends back to Squid the same response in all cases. Caching
those same instructions will always have the same outcome on future
requests.


&gt;<i> 
</I>&gt;<i> chrome still get miss so its forcing the use of Google sdch or what im
</I>&gt;<i> missing 
</I>&gt;<i> 
</I>&gt;<i> so what will happen. dose chrome use this instead of  gzip
</I>&gt;<i> since Vary: Accept-Encoding   ar same reply 
</I>&gt;<i> and squid request only  gzip
</I>&gt;<i> and all reply Vary: Accept-Encoding is it bad ?? to do so ?? for other app
</I>&gt;<i> in mobile
</I>&gt;<i> 
</I>
The server is sending back gzip content. It was the very act of Chrome
telling Squid that is supported sdch that leads to the difference.

The odd part is that it says &quot;Not a Vary match&quot; when it does find
something in the cache for the Chrome objects location.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009683.html">[squid-users] clientProcessHit
</A></li>
	<LI>Next message (by thread): <A HREF="009657.html">[squid-users] clientProcessHit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9685">[ date ]</a>
              <a href="thread.html#9685">[ thread ]</a>
              <a href="subject.html#9685">[ subject ]</a>
              <a href="author.html#9685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
