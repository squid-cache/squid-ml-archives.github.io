<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] pages not being cached
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20pages%20not%20being%20cached&In-Reply-To=%3CCACxQaDww9Be85weWFK87r-jtwa8zwtCU%3DR%3DS7kpcgcQ-r6UhMg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009687.html">
   <LINK REL="Next"  HREF="009689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] pages not being cached</H1>
    <B>Cindy Cicalese</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20pages%20not%20being%20cached&In-Reply-To=%3CCACxQaDww9Be85weWFK87r-jtwa8zwtCU%3DR%3DS7kpcgcQ-r6UhMg%40mail.gmail.com%3E"
       TITLE="[squid-users] pages not being cached">cindom at gmail.com
       </A><BR>
    <I>Thu Mar 10 14:22:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009687.html">[squid-users] Squid reverse proxy and WebSockets.
</A></li>
        <LI>Next message (by thread): <A HREF="009689.html">[squid-users] pages not being cached
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9688">[ date ]</a>
              <a href="thread.html#9688">[ thread ]</a>
              <a href="subject.html#9688">[ subject ]</a>
              <a href="author.html#9688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am using Squid for caching with Apache and MediaWiki over HTTPS only.
Unfortunately, no pages are being cached; each request is being sent from
Squid to Apache. I would appreciate help figuring out how to get caching to
work.

My configuration is as follows:

   - Squid is configured to listen on &lt;external ip&gt;:443 for HTTPS requests
   and forwards them to Apache on port 8080

https_port &lt;external ip&gt;:443 cert=&lt;path to cert&gt; key=&lt;path to key&gt;
defaultsite=&lt;server name&gt; vhost
cache_peer 127.0.0.1 parent 8080 no-query originserver login=PASS


   - Squid also listens on 127.0.0.1:80 for PURGE requests from MediaWiki
   because I could not figure out how to configure MediaWiki to send PURGE
   requests with HTTPS

http_port 127.0.0.1:80 defaultsite=&lt;server name&gt; vhost


   - Apache is listening on 127.0.0.1:8080 for requests from Squid
   - Apache is also listening on &lt;external ip&gt;:80 which is set up as a
   permanent redirect to HTTPS
   - MediaWiki is configured as follows:

$wgUseSquid = true;
$wgSquidServers = array('127.0.0.1'); // this is where PURGE requests are
sent
$wgSquidServersNoPurge = array('&lt;external ip&gt;');

GET requests are being received by MediaWiki with Cache-Control: max-age=0
in the headers. The response sent by MediaWiki includes the following
headers:

Cache-Control: s-maxage=18000, must-revalidate, max-age=0
X-Cache: MISS from &lt;server name&gt;
X-Cache-Lookup: HIT from &lt;server name&gt;:80

I am suspicious why the last line says port 80 rather than 8080, but I'm
not sure if that is relevant.

Please let me know if there is an more relevant information that will help
to troubleshoot this. Thank you in advance for your assistance!

Cindy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160310/14a85ce2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160310/14a85ce2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009687.html">[squid-users] Squid reverse proxy and WebSockets.
</A></li>
	<LI>Next message (by thread): <A HREF="009689.html">[squid-users] pages not being cached
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9688">[ date ]</a>
              <a href="thread.html#9688">[ thread ]</a>
              <a href="subject.html#9688">[ subject ]</a>
              <a href="author.html#9688">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
