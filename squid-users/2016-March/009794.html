<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] access from same ID and different IP addresses.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20access%20from%20same%20ID%20and%20different%20IP%20addresses.&In-Reply-To=%3C20160316.130617.737004071327924626.asakura%40ioc.dnp.co.jp%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009837.html">
   <LINK REL="Next"  HREF="009809.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] access from same ID and different IP addresses.</H1>
    <B>asakura at ioc.dnp.co.jp</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20access%20from%20same%20ID%20and%20different%20IP%20addresses.&In-Reply-To=%3C20160316.130617.737004071327924626.asakura%40ioc.dnp.co.jp%3E"
       TITLE="[squid-users] access from same ID and different IP addresses.">asakura at ioc.dnp.co.jp
       </A><BR>
    <I>Wed Mar 16 04:06:17 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009837.html">[squid-users] Two connections per client
</A></li>
        <LI>Next message (by thread): <A HREF="009809.html">[squid-users] access from same ID and different IP addresses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9794">[ date ]</a>
              <a href="thread.html#9794">[ thread ]</a>
              <a href="subject.html#9794">[ subject ]</a>
              <a href="author.html#9794">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Recently, in our environment, CPU load on the squid proxy server
is happening trouble to become a 100%.

example----
PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
29767 squid     20   0 1430m 1.3g 5332 R 99.1 17.4   6836:56 squid
16856 squid     20   0 29764 3280 1620 S  2.0  0.0  68:46.34 squid_kerb_auth
16860 squid     20   0 29760 3272 1616 S  1.7  0.0  43:53.67 squid_kerb_auth
16855 squid     20   0 22636 1244 1000 S  0.3  0.0   2:57.66 negotiate_wrapp
21437 asakura   20   0 15432 1632  932 R  0.3  0.0   0:01.02 top
26167 root      20   0 19088 2248 1060 S  0.3  0.0   1016:14 syslog-ng
---

As a result of investigation, We suspect that CPU load become a 100%
when user attempts to log in from more than different ip addresses. 

This time, squid has been accessed from 20 or more units of
the PC with the same user ID.
When we disable user authentication from target segment, CPU load be low.

We want to know whether CPU load goes up when squid is accessed from
a large number of different IP addresses with the same user ID.

Our environment is below,
- squid-3.5.1 with squid_kerb_auth(sorry old version...) x5 server
- using BIG-IP LTM load balancer
- enable &quot;follow_x_fowarded_for&quot; option
- User ID number is about 5300
- IP address number is about 6300
- Most user authentication is ActiveDirectory(Kerberos), NTLM is only a little
- Normaly, CPU load is about 20%

Regards,
Kazuhiro

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009837.html">[squid-users] Two connections per client
</A></li>
	<LI>Next message (by thread): <A HREF="009809.html">[squid-users] access from same ID and different IP addresses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9794">[ date ]</a>
              <a href="thread.html#9794">[ thread ]</a>
              <a href="subject.html#9794">[ subject ]</a>
              <a href="author.html#9794">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
