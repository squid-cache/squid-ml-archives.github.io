<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22ACCESS%20DENIED%22%20page%20by%20ssl_bump%20terminate&In-Reply-To=%3C56F923DA.1080707%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009919.html">
   <LINK REL="Next"  HREF="009921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22ACCESS%20DENIED%22%20page%20by%20ssl_bump%20terminate&In-Reply-To=%3C56F923DA.1080707%40gmail.com%3E"
       TITLE="[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate">yvoinov at gmail.com
       </A><BR>
    <I>Mon Mar 28 12:30:18 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009919.html">[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate
</A></li>
        <LI>Next message (by thread): <A HREF="009921.html">[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9920">[ date ]</a>
              <a href="thread.html#9920">[ thread ]</a>
              <a href="subject.html#9920">[ subject ]</a>
              <a href="author.html#9920">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
I suggests the order is important and must be:

ssl_bump terminate blocked_https
deny_info <A HREF="http://www.example.com">http://www.example.com</A> blocked_https

28.03.16 11:59, Alexandr Yatskin &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Directive &quot;deny_info&quot; didn't work when we blocked https site with option &quot;ssl_bump&quot;.
</I>&gt;<i> Maybe, is there another method?
</I>&gt;<i>
</I>&gt;<i> --------------------------------------------------------------------
</I>&gt;<i> acl blocked_https ssl::server_name  &quot;/etc/squid/blocked_https.txt&quot;
</I>&gt;<i> acl step1 at_step SslBump1
</I>&gt;<i> ssl_bump peek step1
</I>&gt;<i>
</I>&gt;<i> deny_info <A HREF="http://www.example.com">http://www.example.com</A> blocked_https
</I>&gt;<i> ssl_bump terminate blocked_https
</I>&gt;<i> --------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 25.03.2016 17:14, Yuri Voinov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i>
</I>&gt;<i> #  TAG: deny_info
</I>&gt;<i> #    Usage:   deny_info err_page_name acl
</I>&gt;<i> #    or       deny_info <A HREF="http://...">http://...</A> acl
</I>&gt;<i> #    or       deny_info TCP_RESET acl
</I>&gt;<i> #
</I>&gt;<i> #    This can be used to return a ERR_ page for requests which
</I>&gt;<i> #    do not pass the 'http_access' rules.  Squid remembers the last
</I>&gt;<i> #    acl it evaluated in http_access, and if a 'deny_info' line exists
</I>&gt;<i> #    for that ACL Squid returns a corresponding error page.
</I>&gt;<i> #
</I>&gt;<i> #    The acl is typically the last acl on the http_access deny line which
</I>&gt;<i> #    denied access. The exceptions to this rule are:
</I>&gt;<i> #    - When Squid needs to request authentication credentials. It's then
</I>&gt;<i> #      the first authentication related acl encountered
</I>&gt;<i> #    - When none of the http_access lines matches. It's then the last
</I>&gt;<i> #      acl processed on the last http_access line.
</I>&gt;<i> #    - When the decision to deny access was made by an adaptation service,
</I>&gt;<i> #      the acl name is the corresponding eCAP or ICAP service_name.
</I>&gt;<i> #
</I>&gt;<i> #    NP: If providing your own custom error pages with error_directory
</I>&gt;<i> #        you may also specify them by your custom file name:
</I>&gt;<i> #        Example: deny_info ERR_CUSTOM_ACCESS_DENIED bad_guys
</I>&gt;<i> #
</I>&gt;<i> #    By defaut Squid will send &quot;403 Forbidden&quot;. A different 4xx or 5xx
</I>&gt;<i> #    may be specified by prefixing the file name with the code and a
</I>colon.
&gt;<i> #    e.g. 404:ERR_CUSTOM_ACCESS_DENIED
</I>&gt;<i> #
</I>&gt;<i> #    Alternatively you can tell Squid to reset the TCP connection
</I>&gt;<i> #    by specifying TCP_RESET.
</I>&gt;<i> #
</I>&gt;<i> #    Or you can specify an error URL or URL pattern. The browsers will
</I>&gt;<i> #    get redirected to the specified URL after formatting tags have
</I>&gt;<i> #    been replaced. Redirect will be done with 302 or 307 according to
</I>&gt;<i> #    HTTP/1.1 specs. A different 3xx code may be specified by prefixing
</I>&gt;<i> #    the URL. e.g. 303:<A HREF="http://example.com/">http://example.com/</A>
</I>&gt;<i> #
</I>&gt;<i> #    URL FORMAT TAGS:
</I>&gt;<i> #        %a    - username (if available. Password NOT included)
</I>&gt;<i> #        %B    - FTP path URL
</I>&gt;<i> #        %e    - Error number
</I>&gt;<i> #        %E    - Error description
</I>&gt;<i> #        %h    - Squid hostname
</I>&gt;<i> #        %H    - Request domain name
</I>&gt;<i> #        %i    - Client IP Address
</I>&gt;<i> #        %M    - Request Method
</I>&gt;<i> #        %o    - Message result from external ACL helper
</I>&gt;<i> #        %p    - Request Port number
</I>&gt;<i> #        %P    - Request Protocol name
</I>&gt;<i> #        %R    - Request URL path
</I>&gt;<i> #        %T    - Timestamp in RFC 1123 format
</I>&gt;<i> #        %U    - Full canonical URL from client
</I>&gt;<i> #              (HTTPS URLs terminate with *)
</I>&gt;<i> #        %u    - Full canonical URL from client
</I>&gt;<i> #        %w    - Admin email from squid.conf
</I>&gt;<i> #        %x    - Error name
</I>&gt;<i> #        %%    - Literal percent (%) code
</I>&gt;<i> #
</I>&gt;<i> #Default:
</I>&gt;<i> # none
</I>&gt;<i>
</I>&gt;<i> ?
</I>&gt;<i>
</I>&gt;<i> 25.03.16 16:15, Alexandr Yatskin &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i> &gt; Hello everyone!
</I>&gt;<i>
</I>&gt;<i>       &gt; How redirect users to &quot;Access Denied&quot; page when they go to
</I>&gt;<i>       blocked https sites?
</I>&gt;<i>
</I>&gt;<i>       &gt; Now users only can see such error: &quot;ERR_CONNECTION_CLOSED&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; There are several lines from our config:
</I>&gt;<i>
</I>&gt;<i>       &gt; ------------------------------------------
</I>&gt;<i>
</I>&gt;<i>       &gt; acl blocked_https ssl::server_name
</I>&gt;<i>       &quot;/etc/squid/blocked_https.txt&quot;
</I>&gt;<i>
</I>&gt;<i>       &gt; ssl_bump terminate blocked_https
</I>&gt;<i>
</I>&gt;<i>       &gt; ------------------------------------------
</I>&gt;<i>
</I>&gt;<i>       &gt; Thanks in advance.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; _______________________________________________
</I>&gt;<i>
</I>&gt;<i>       &gt; squid-users mailing list
</I>&gt;<i>
</I>&gt;<i>       &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i>       &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJW+SPZAAoJENNXIZxhPexGn0wIALLPgsRZLfdfo6j2cxRiYU2W
wREfDnN+i02rLBmboPiP1h9kk59r6wd37Fzbk8Ltp+zpQVv150Uo9ivHEfbOyeCk
/enX/vaBhnyaIk3BGHkdrmI2FcRMVFV+fh/C+nLixyRfswTq1Xv/cmY9YrkSBtDM
yt39353FlJFNwcz3wV+xlfibCQeMvJ8vLAa0jVGALeb0KwKgXJ90WlL2AssaiTRC
G74KCXSnF0eqgj9Mjbh0SN/b9YrINAnjjOBiYAx8epMLD2Rl2VxXNFcWNUKRUiiV
0mHOocOe4Q8Wrqh5WS2NUcN921FEoW5bwsKdbItAl0xQs0Ow9Cax8aVIKWDYQyo=
=FmF4
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160328/61098fb7/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160328/61098fb7/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160328/61098fb7/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160328/61098fb7/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009919.html">[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate
</A></li>
	<LI>Next message (by thread): <A HREF="009921.html">[squid-users] &quot;ACCESS DENIED&quot; page by ssl_bump terminate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9920">[ date ]</a>
              <a href="thread.html#9920">[ thread ]</a>
              <a href="subject.html#9920">[ subject ]</a>
              <a href="author.html#9920">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
