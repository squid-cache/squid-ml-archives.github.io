<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Log
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Log&In-Reply-To=%3C56F9E10B.1070607%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009922.html">
   <LINK REL="Next"  HREF="009927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Log</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Log&In-Reply-To=%3C56F9E10B.1070607%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid Log">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Mar 29 01:57:31 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009922.html">[squid-users] Squid Log
</A></li>
        <LI>Next message (by thread): <A HREF="009927.html">[squid-users] Squid Log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9926">[ date ]</a>
              <a href="thread.html#9926">[ thread ]</a>
              <a href="subject.html#9926">[ subject ]</a>
              <a href="author.html#9926">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/03/2016 2:53 a.m., Marc Mapplebeck wrote:
&gt;<i> I am currently using squid for our proxy, and recently decided to use
</I>&gt;<i> WPAD/PAC to also capture HTTPS traffic.  I am having one very annoying
</I>&gt;<i> issue with lightsquid, and wondering if anybody has any insight.
</I>&gt;<i> 
</I>&gt;<i> All my lightsquid information looks like the attached image.  It also does
</I>&gt;<i> not consolidate the first part of the domain name(even this would be fine,
</I>&gt;<i> so that I can differentiate HTTPS traffic, as long as subdomains are
</I>&gt;<i> combined)
</I>&gt;<i> 
</I>&gt;<i> I have been modifying my lightparser.pl file to consolidate subdomains,
</I>&gt;<i> however, this is only working for HTTP traffic, as all HTTPS sites are
</I>&gt;<i> showing the port number like mail.google.ca:443
</I>
That is the correct URL for those requests. And no they are not &quot;HTTPS&quot;.
They are tunnels through the proxy to the server and port indicated,
which may or may not have HTTPS inside them.
In fact if that is Google software contacting Google servers it is far
more likely to be SPDY or WebSockets protocol.


&gt;<i> The code I am using is:
</I>&gt;<i> $url =~ s/([a-z]+:\/\/)??.*\.(google\.*)/$2/o;
</I>&gt;<i> 
</I>&gt;<i> Has anybody found a way around this or even thought about this?  I was
</I>&gt;<i> thinking of telling squid to not include the port, however, it seems to not
</I>&gt;<i> be working.  Any other suggestions/thoughts?
</I>
I suggest you double-check your regex. That pattern contains several
major mistakes. &quot;??&quot; and &quot;\.*&quot; for starters.
 &lt;<A HREF="http://www.regexr.com/">http://www.regexr.com/</A>&gt;

The pattern for matching &quot;google.*&quot; in the domain is:
  s/^([a-z\-\+]+:\/\/)?([^\/?#:]+)?(google\.[^\/?#:]+)/$3/o

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009922.html">[squid-users] Squid Log
</A></li>
	<LI>Next message (by thread): <A HREF="009927.html">[squid-users] Squid Log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9926">[ date ]</a>
              <a href="thread.html#9926">[ thread ]</a>
              <a href="subject.html#9926">[ subject ]</a>
              <a href="author.html#9926">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
