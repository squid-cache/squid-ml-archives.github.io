<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Only%20listening%20to%20ipv6%20%28bug%29%20still%20present%3F%0A%20http_port%20IGNORE%20PEBCAK&In-Reply-To=%3C2e58f062-dda4-7831-8c0b-6016e8744440%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010409.html">
   <LINK REL="Next"  HREF="010411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Only%20listening%20to%20ipv6%20%28bug%29%20still%20present%3F%0A%20http_port%20IGNORE%20PEBCAK&In-Reply-To=%3C2e58f062-dda4-7831-8c0b-6016e8744440%40treenet.co.nz%3E"
       TITLE="[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed May  4 03:57:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010409.html">[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK
</A></li>
        <LI>Next message (by thread): <A HREF="010411.html">[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10410">[ date ]</a>
              <a href="thread.html#10410">[ thread ]</a>
              <a href="subject.html#10410">[ subject ]</a>
              <a href="author.html#10410">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/05/2016 3:22 p.m., Tory M Blue wrote:
&gt;<i> On Tue, May 3, 2016 at 5:58 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
</I>&gt;&gt;<i> On 4/05/2016 11:12 a.m., Tory M Blue wrote:
</I>&gt;&gt;&gt;<i> My configs have always consisted of http_port 80 accel vhost.. With
</I>&gt;&gt;&gt;<i> the latest 3.5.17 (I guess) if you don't list 0.0.0.0:80 squid won't
</I>&gt;&gt;&gt;<i> even attempt to listen, talk on ivp4..
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So adding 0.0.0.0:80 allows it to at least talk via ipv4.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This seems wrong, odd.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I understand you are removing methods to disable ipv6, however forcing
</I>&gt;&gt;&gt;<i> folks to us only ipv6 seems like a stretch :)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks
</I>&gt;&gt;&gt;<i> Tory
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> CentOS 7
</I>&gt;&gt;&gt;<i> squid-3.5.17-1.el7.centos.x86_64
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What is Squid saying on startup about the stack type detected?
</I>&gt;&gt;<i>  (may have to set debug_options 3,2)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Linux has a hybrid TCP stack. Which means IPv6 ports can receive IPv4
</I>&gt;&gt;<i> traffic unless you change something. Have you got any custom config in
</I>&gt;&gt;<i> your TCP/IP settings that might have changed the stacks v4-mapping
</I>&gt;&gt;<i> behaviour?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Amos
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Hey Amos
</I>&gt;<i> 
</I>&gt;<i> Other than disabling ipv6, there are no other tweaks.
</I>
Um. &quot;disabling ipv6&quot; is not possible in any Linux or BSD based OS. All
the tutorials and advice that claim to mention ways to do so are
actually just screwing up the internal TCP stack state so the IPv6 fails
on various ways.

I think what is going on is that your chosen method of disable is/was
breaking the v4-mapping ability in the stack but not in a way Squid can
detect.

FYI: the &quot;Right Way&quot; to stop IPv6 being used is to configure ip6tables
firewall to REJECT all IPv6 traffic attempting to arrive or leave the
box. Treat v6 (and v6 variants of common protocols) as just another
protocol to block or permit at the firewall and you should be fine.

Some people like DROP in the firewall, but that is just another way to
cause breakage. It results in connections hanging.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010409.html">[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK
</A></li>
	<LI>Next message (by thread): <A HREF="010411.html">[squid-users] Only listening to ipv6 (bug) still present? http_port IGNORE PEBCAK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10410">[ date ]</a>
              <a href="thread.html#10410">[ thread ]</a>
              <a href="subject.html#10410">[ subject ]</a>
              <a href="author.html#10410">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
