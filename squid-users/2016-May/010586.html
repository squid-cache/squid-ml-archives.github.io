<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Getting the full file content on a range request,	but not on EVERY get ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Getting%20the%20full%20file%20content%20on%20a%20range%20request%2C%0A%09but%20not%20on%20EVERY%20get%20...&In-Reply-To=%3C2050051.gqqp5FEbAA%40xrated%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010578.html">
   <LINK REL="Next"  HREF="010587.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Getting the full file content on a range request,	but not on EVERY get ...</H1>
    <B>Hans-Peter Jansen</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Getting%20the%20full%20file%20content%20on%20a%20range%20request%2C%0A%09but%20not%20on%20EVERY%20get%20...&In-Reply-To=%3C2050051.gqqp5FEbAA%40xrated%3E"
       TITLE="[squid-users] Getting the full file content on a range request,	but not on EVERY get ...">hpj at urpla.net
       </A><BR>
    <I>Thu May 12 18:57:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010578.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
        <LI>Next message (by thread): <A HREF="010587.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10586">[ date ]</a>
              <a href="thread.html#10586">[ thread ]</a>
              <a href="subject.html#10586">[ subject ]</a>
              <a href="author.html#10586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Heiler,

On Donnerstag, 12. Mai 2016 13:28:00 Heiler Bemerguy wrote:
&gt;<i> Hi Pete, thanks for replying... let me see if I got it right..
</I>&gt;<i> 
</I>&gt;<i> Will I need to specify every url/domain I want it to act on ? I want
</I>&gt;<i> squid to do it for every range-request downloads that should/would be
</I>&gt;<i> cached (based on other rules, pattern_refreshs etc)
</I>
Yup, that's right. At least, that's the common approach to deal with CDNs.
I think, that disallowing range requests is too drastic to work fine on the 
long run, but let us know, if you get to satisfactory solution this way.

&gt;<i> It doesn't need to delay any downloads as long as it isn't a dupe of
</I>&gt;<i> what's already being downloaded.....
</I>
You can set to delay to zero of course.

This is only one side of the issues with CDNs. The other, more problematic 
side of it is, that many server with different URLs provide the same files.
Every new address will result in a new download of otherwise identical 
content.
 
Here's an example of openSUSE:

#
# this file was generated by gen_openSUSE_dedups
# from <A HREF="http://mirrors.opensuse.org/list/all.html">http://mirrors.opensuse.org/list/all.html</A>
# with timestamp Thu, 12 May 2016 05:30:18 +0200
#
[openSUSE]
match:
    # openSUSE Headquarter
    http\:\/\/[a-z0-9]+\.opensuse\.org\/(.*)
    # South Africa (za)
    http\:\/\/ftp\.up\.ac\.za\/mirrors\/opensuse\/opensuse\/(.*)
    # Bangladesh (bd)
    http\:\/\/mirror\.dhakacom\.com\/opensuse\/(.*)
    http\:\/\/mirrors\.ispros\.com\.bd\/opensuse\/(.*)
    # China (cn)
    http\:\/\/mirror\.bjtu\.edu\.cn\/opensuse\/(.*)
    http\:\/\/fundawang\.lcuc\.org\.cn\/opensuse\/(.*)
    http\:\/\/mirrors\.tuna\.tsinghua\.edu\.cn\/opensuse\/(.*)
    http\:\/\/mirrors\.skyshe\.cn\/opensuse\/(.*)
    http\:\/\/mirrors\.hust\.edu\.cn\/opensuse\/(.*)
    http\:\/\/c\.mirrors\.lanunion\.org\/opensuse\/(.*)
    http\:\/\/mirrors\.hustunique\.com\/opensuse\/(.*)
    http\:\/\/mirrors\.sohu\.com\/opensuse\/(.*)
    http\:\/\/mirrors\.ustc\.edu\.cn\/opensuse\/(.*)
    # Hong Kong (hk)
    http\:\/\/mirror\.rackspace\.hk\/openSUSE\/(.*)
    # Indonesia (id)
    http\:\/\/mirror\.linux\.or\.id\/linux\/opensuse\/(.*)
    http\:\/\/buaya\.klas\.or\.id\/opensuse\/(.*)
    http\:\/\/kartolo\.sby\.datautama\.net\.id\/openSUSE\/(.*)
    http\:\/\/opensuse\.idrepo\.or\.id\/opensuse\/(.*)
    http\:\/\/mirror\.unej\.ac\.id\/opensuse\/(.*)
    http\:\/\/download\.opensuse\.or\.id\/(.*)
    http\:\/\/repo\.ugm\.ac\.id\/opensuse\/(.*)
    http\:\/\/dl2\.foss\-id\.web\.id\/opensuse\/(.*)
    # Israel (il)
    http\:\/\/mirror\.isoc\.org\.il\/pub\/opensuse\/(.*)
	
	[...] -&gt; this list contains about 180 entries

replace: <A HREF="http://download.opensuse.org.%(intdomain">http://download.opensuse.org.%(intdomain</A>)s/\1
# fetch all redirected objects explicitly
fetch: true


This is, how CDNs work, but it's a nightmare for caching proxies.
In such scenarios squid_dedup comes to rescue.

Cheers,
Pete

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010578.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
	<LI>Next message (by thread): <A HREF="010587.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10586">[ date ]</a>
              <a href="thread.html#10586">[ thread ]</a>
              <a href="subject.html#10586">[ subject ]</a>
              <a href="author.html#10586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
