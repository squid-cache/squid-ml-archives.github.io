<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ACL is used in context without an HTTP response.	Assuming mismatch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20is%20used%20in%20context%20without%20an%20HTTP%20response.%0A%09Assuming%20mismatch&In-Reply-To=%3C001001d1ace6%24034b7f30%2409e27d90%24%40articatech.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010603.html">
   <LINK REL="Next"  HREF="010614.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ACL is used in context without an HTTP response.	Assuming mismatch</H1>
    <B>David Touzeau</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20is%20used%20in%20context%20without%20an%20HTTP%20response.%0A%09Assuming%20mismatch&In-Reply-To=%3C001001d1ace6%24034b7f30%2409e27d90%24%40articatech.com%3E"
       TITLE="[squid-users] ACL is used in context without an HTTP response.	Assuming mismatch">david at articatech.com
       </A><BR>
    <I>Fri May 13 07:06:46 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010603.html">[squid-users] ACL is used in context without an HTTP response. Assuming mismatch
</A></li>
        <LI>Next message (by thread): <A HREF="010614.html">[squid-users] ACL is used in context without an HTTP response. Assuming mismatch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10609">[ date ]</a>
              <a href="thread.html#10609">[ thread ]</a>
              <a href="subject.html#10609">[ subject ]</a>
              <a href="author.html#10609">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Alex

Any ACLs  tips to avoid these warning ? or just assume it's normal in this situation... ?


-----Message d'origine-----
De : Alex Rousskov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>] 
Envoy&#233; : vendredi 13 mai 2016 00:40
&#192; : <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Cc : David Touzeau &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">david at articatech.com</A>&gt;
Objet : Re: [squid-users] ACL is used in context without an HTTP response. Assuming mismatch

On 05/12/2016 04:04 PM, David Touzeau wrote:
&gt;<i> 
</I>&gt;<i> acl CODE_TCP_DENIED http_status 407
</I>&gt;<i> access_log none CODE_TCP_DENIED
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> But squid claim :  
</I>&gt;<i> 
</I>&gt;<i> 2016/05/12 23:44:07 kid1| WARNING: CODE_TCP_DENIED ACL is used in 
</I>&gt;<i> context without an HTTP response. Assuming mismatch.
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Why this rule is wrong ?
</I>
Squid attempts to log every access(*). Sometimes, Squid is accessed, but there is no response to log(**). Your rule assumes that there is always a response. Squid warns that your assumption is wrong for the specific access it is logging.

If there is no ACL that can be used to test the presence of a response (and a request) in a master transaction [without triggering such warnings], then we should add it.


Also, some Squids have bugs where there _is_ a response but Squid logging code does not know about it. If you are running a relatively recent Squid v4 release, you might be hitting one of those bugs (although I would expect more/different error messages in that case).


Endnotes:

(*) Squid fails to log certain accesses. We are fixing one of those bugs right now.

(**) Imagine, for example, a client that starts sending an HTTP request but closes the connection to Squid before finishing. Depending on what state Squid was in when the connection got closed, there may be no response created for that unfinished request.


HTH,

Alex.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010603.html">[squid-users] ACL is used in context without an HTTP response. Assuming mismatch
</A></li>
	<LI>Next message (by thread): <A HREF="010614.html">[squid-users] ACL is used in context without an HTTP response. Assuming mismatch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10609">[ date ]</a>
              <a href="thread.html#10609">[ thread ]</a>
              <a href="subject.html#10609">[ subject ]</a>
              <a href="author.html#10609">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
