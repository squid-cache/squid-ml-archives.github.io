<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Peek and splice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Peek%20and%20splice&In-Reply-To=%3C1834a08e-7e03-cf08-0d15-e84ee63cd200%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010607.html">
   <LINK REL="Next"  HREF="010665.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Peek and splice</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Peek%20and%20splice&In-Reply-To=%3C1834a08e-7e03-cf08-0d15-e84ee63cd200%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid Peek and splice">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri May 13 11:07:56 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010607.html">[squid-users] Squid Peek and splice
</A></li>
        <LI>Next message (by thread): <A HREF="010665.html">[squid-users] Squid Peek and splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10612">[ date ]</a>
              <a href="thread.html#10612">[ thread ]</a>
              <a href="subject.html#10612">[ subject ]</a>
              <a href="author.html#10612">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/05/2016 5:58 p.m., Reet Vyas wrote:
&gt;<i> Hi Amos/Yuri,
</I>&gt;<i> 
</I>&gt;<i> Currently my squid is configured with ssl bump, now I want to use peek and
</I>&gt;<i> splice. I read in some forum that we don't need to install certificate on
</I>&gt;<i> client's machine.
</I>&gt;<i> 
</I>
Splice does not require it. But what you want to do with Squid may
prevent splice being used. So &quot;it depends&quot; ...


&gt;<i> As I have already asked before in mailing list to install SSL certificate
</I>&gt;<i> on Android devices, which is not working.
</I>&gt;<i> 
</I>&gt;<i> So my question is If I want to use peek and splice for example I want https
</I>&gt;<i> filtering for 
</I>
 ... on how you define &quot;filter&quot;.

&gt;<i> proxy websites 
</I>
Not sure what you mean by that term.

&gt;<i> and I dont want ssl for bank websites and
</I>&gt;<i> facebook youtube and gmail. how will it work? Do i need to install SSL
</I>&gt;<i> certifcate on client or not, I am bit confused with peek and splice thing.
</I>
When you intercept port 443 normally only the raw-IP is available from
TCP. Peek allows Squid to get the server name the client was trying to
connect to out of the TLS. So that Squid can handle the intercepted
connection as if it had received a CONNECT message (which usually have
server/domain names).

Splicing can be thought of as handling a intercepted port 443 connection
as if it were a CONNECT message, with no decryption. It is treated as a
single &quot;thing&quot;, with some limited control possibilities.


So...

In order to bump (decrypt) some traffic and splice (not decrypt) other
traffic you need to have a way to decide which type is being dealt with.
That is the peek or stare actions - to get data out of the TLS handshake
for you to use in ACL decisions.

You might now want to re-read the SslPeekAndSplice documentation again
to see if you understand it better. I skipped a lot of important details
to make the description clear.


&gt;<i> 
</I>&gt;<i> Please let me know is that possible to configure squid 3.5.19 in such a way
</I>&gt;<i> so that it will bump  only proxy websites not FB youtube etc.
</I>&gt;<i> 
</I>
Ah. So what are these &quot;proxy websites&quot; you speak of ?

One thing you need to be clear about is that once the TCP packets enter
Squid they *have* to be &quot;proxied&quot;. There is no way to undo TCP accept()
and read() operations. But there are many ways of handling them that
Squid can do.

PS. you could post your existing config so we can suggest alterations to
it that will lead to it doing your new policy. That can be another way
to learn how the relevant-to-you part of the features work without
diving into the full complexity of what *might* be doable.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010607.html">[squid-users] Squid Peek and splice
</A></li>
	<LI>Next message (by thread): <A HREF="010665.html">[squid-users] Squid Peek and splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10612">[ date ]</a>
              <a href="thread.html#10612">[ thread ]</a>
              <a href="subject.html#10612">[ subject ]</a>
              <a href="author.html#10612">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
