<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Getting the full file content on a range request, but not on EVERY get ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Getting%20the%20full%20file%20content%20on%20a%20range%20request%2C%0A%20but%20not%20on%20EVERY%20get%20...&In-Reply-To=%3C6af1d850-03d4-33bd-25d8-bf9ca202afd9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010620.html">
   <LINK REL="Next"  HREF="010628.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Getting the full file content on a range request, but not on EVERY get ...</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Getting%20the%20full%20file%20content%20on%20a%20range%20request%2C%0A%20but%20not%20on%20EVERY%20get%20...&In-Reply-To=%3C6af1d850-03d4-33bd-25d8-bf9ca202afd9%40treenet.co.nz%3E"
       TITLE="[squid-users] Getting the full file content on a range request, but not on EVERY get ...">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri May 13 13:52:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010620.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
        <LI>Next message (by thread): <A HREF="010628.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10625">[ date ]</a>
              <a href="thread.html#10625">[ thread ]</a>
              <a href="subject.html#10625">[ subject ]</a>
              <a href="author.html#10625">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/05/2016 12:38 a.m., Garri Djavadyan wrote:
&gt;<i> On Fri, 2016-05-13 at 08:36 +1200, Amos Jeffries wrote:
</I>&gt;&gt;<i> Have you given collapsed_forwarding a try? Its supposed to prevent
</I>&gt;&gt;<i> all
</I>&gt;&gt;<i> the duplicate requests making all those extra upstream connections
</I>&gt;&gt;<i> unti
</I>&gt;&gt;<i> at least the first one has finished getting the object.
</I>&gt;<i> 
</I>&gt;<i> Amos, I believe that the above quote describes default Squid's action,
</I>&gt;<i> which does not require collapsed_forwarding. The details of my
</I>&gt;<i> experiments can be found here <A HREF="http://bugs.squid-cache.org/show_bug.cgi?">http://bugs.squid-cache.org/show_bug.cgi?</A>
</I>&gt;<i> id=4511#c0. Thanks.
</I>&gt;<i> 
</I>
The default action should be to fetch each range request separately and
in parallel. Not caching the results.

When admin has set only the range offset &amp; quick-abort to force full
object retrieval the behaviour Heiler mentions happens - lots of
upstream bandwidth used for N copies.
 The first one to complete starts to be used as a HIT for future
reuqests. But as each of the initial transfers completes it replaces the
previously cached object as the one being hit on.

So timing is critical, if Squid happens to delay any of the parallel
requests just long enough in its TCP accept() queue, auth or ACL
processing they could become HITs on an already finished object.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010620.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
	<LI>Next message (by thread): <A HREF="010628.html">[squid-users] Getting the full file content on a range request, but not on EVERY get ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10625">[ date ]</a>
              <a href="thread.html#10625">[ thread ]</a>
              <a href="subject.html#10625">[ subject ]</a>
              <a href="author.html#10625">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
