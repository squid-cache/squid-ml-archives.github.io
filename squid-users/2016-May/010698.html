<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Internet%20Browsing%20very%20slow%20after%20implementing%0A%20Squid%20peek%20%26%20splice%20%2B%20Access%20log%20not%20tracing%20full%20URL&In-Reply-To=%3Cbd8b242b-0fb7-9504-54cd-ff922a3c73ca%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010694.html">
   <LINK REL="Next"  HREF="010702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Internet%20Browsing%20very%20slow%20after%20implementing%0A%20Squid%20peek%20%26%20splice%20%2B%20Access%20log%20not%20tracing%20full%20URL&In-Reply-To=%3Cbd8b242b-0fb7-9504-54cd-ff922a3c73ca%40treenet.co.nz%3E"
       TITLE="[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed May 18 17:27:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010694.html">[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL
</A></li>
        <LI>Next message (by thread): <A HREF="010702.html">[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10698">[ date ]</a>
              <a href="thread.html#10698">[ thread ]</a>
              <a href="subject.html#10698">[ subject ]</a>
              <a href="author.html#10698">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/05/2016 2:21 a.m., Garri Djavadyan wrote:
&gt;<i> On Thu, 2016-05-19 at 00:39 +1200, Amos Jeffries wrote:
</I>&gt;&gt;<i> Using ignore-private and ignore-must-revalidate on the same
</I>&gt;&gt;<i> refresh_pattern is *extremely* dangerous. Just asking to get your
</I>&gt;&gt;<i> cache pwned.
</I>&gt;<i> 
</I>&gt;<i> I'm also using the both options on the same refresh_pattern for several
</I>&gt;<i> years. Can you explain the consequences? I couldn't find enough
</I>&gt;<i> information in Squid's reference and RFC2616. Thanks in advance!
</I>&gt;<i> 
</I>
The 'private' cache-control is supposed to only be used when the
response contains sensitive credentials or private data.

ignore-private has a long history of causing (not allowing. *causing*)
people to login to other peoples accounts on various services. One might
have heard about the recent Steam account login having &quot;an issue with
our proxy settings&quot;. I'd bet a lot it was somebody turing on
&quot;ignore-private&quot; or the equivalent in their systems.

With the HTTP/1.1 changes I made it tell Squid to treat 'private' the
same as 'must-revalidate', so that private stuff could still be forced
to cache but much more safely.

Ignoring both brings back all the security and privacy breach problems.

One should not be afraid of revalidation. It is the backbone of most of
the mechanisms that make HTTP/1.1 more performant than 1.0.

So IMO, stay away from ignore-private like it was plague. If you really
have a reason to use it. At least dont use ignore-revalidate on the same
traffic.

(I've similar advice for ignore-no-store. But at least no-store does not
have the same security/privacy/credentials tie-in as private.)

&gt;<i> 
</I>&gt;&gt;<i> Also ignore-auth makes things *not* be cacheable in all the auth
</I>&gt;&gt;<i> related cases when it would normally be stored by Squid.
</I>&gt;<i> 
</I>&gt;<i> I always thought that the purpose of the option is exact opposite.
</I>&gt;<i> Squid's reference any trivial test confirmed my thoughts. Sorry, but
</I>&gt;<i> maybe I understood the quote incorrectly?
</I>&gt;<i> 
</I>
It tells Squid to ignore the auth headers in a request.

In HTTP/1.0 messages the presence of auth meant the object was
non-cacheable due to sensitive credentials. So the control let people
make that traffic cache.

In HTTP/1.1 messages the presence of auth is often equivalent to
must-revalidate. So ignoring the headers makes the alternative controls
in the headers kick in and force non-caching. The opposite of what is
usually intended.


(FYI: both ignore-auth and ignore-must-revalidate are gone in Squid-4.
For the above reasons.)

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010694.html">[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL
</A></li>
	<LI>Next message (by thread): <A HREF="010702.html">[squid-users] Internet Browsing very slow after implementing Squid peek &amp; splice + Access log not tracing full URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10698">[ date ]</a>
              <a href="thread.html#10698">[ thread ]</a>
              <a href="subject.html#10698">[ subject ]</a>
              <a href="author.html#10698">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
