<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] The system returned: (111) Connection refused;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20The%20system%20returned%3A%20%28111%29%20Connection%20refused%3B&In-Reply-To=%3CCA%2BqV5kKsahx91qeejOpQha7%2BE50T9Xob%3DHVmOu6G9xMNguez%3Dw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010754.html">
   <LINK REL="Next"  HREF="010751.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] The system returned: (111) Connection refused;</H1>
    <B>deepa ganu</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20The%20system%20returned%3A%20%28111%29%20Connection%20refused%3B&In-Reply-To=%3CCA%2BqV5kKsahx91qeejOpQha7%2BE50T9Xob%3DHVmOu6G9xMNguez%3Dw%40mail.gmail.com%3E"
       TITLE="[squid-users] The system returned: (111) Connection refused;">deepaganu at gmail.com
       </A><BR>
    <I>Fri May 27 15:03:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010754.html">[squid-users] The system returned: (111) Connection refused;
</A></li>
        <LI>Next message (by thread): <A HREF="010751.html">[squid-users] missing negotiate_kerberos_auth on my squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10759">[ date ]</a>
              <a href="thread.html#10759">[ thread ]</a>
              <a href="subject.html#10759">[ subject ]</a>
              <a href="author.html#10759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On May 27, 2016 5:43 PM, &quot;Amos Jeffries&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On 27/05/2016 8:55 p.m., deepa ganu wrote:
</I>&gt;<i> &gt; Hi
</I>&gt;<i> &gt; I am using squid as a reverse.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; #http_port  80 accel defaultsite=202.53.13.19
</I>&gt;<i> &gt; https_port 443 accel  cert=/var/www/html/webrtc/imp/teleuniv.net.crt
</I>&gt;<i> &gt; key=/var/www/html/webrtc/imp/teleuniv.net.key
</I>&gt;<i> &gt; cafile=/var/www/html/webrtc/imp/intermediate.crt
</I>defaultsite=202.53.13.19
&gt;<i> &gt; no-vhost
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; #this ACL is url path specific which accepts only portal urls and deny
</I>&gt;<i> &gt; others.
</I>&gt;<i> &gt; acl portal urlpath_regex ^/portal6may
</I>&gt;<i> &gt; cache_peer 172.20.36.144 parent 80 0 no-query originserver
</I>name=portalserver
&gt;<i> &gt; cache_peer_access portalserver allow portal
</I>&gt;<i> &gt; cache_peer_access portalserver deny all
</I>&gt;<i> &gt; http_access allow portal
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; cache_peer 172.20.36.150 parent 443 0 no-query originserver ssl
</I>&gt;<i> &gt; sslflags=DONT_VERIFY_PEER login=PASS connection-auth=off name=teleuniv
</I>&gt;<i> &gt; acl our_sites dstdomain 202.53.13.19
</I>&gt;<i> &gt; http_access allow our_sites
</I>&gt;<i> &gt; cache_peer_access teleuniv allow our_sites
</I>&gt;<i> &gt; cache_peer_access teleuniv deny all
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SO when i try to access the url <A HREF="https://202.53.13.19/">https://202.53.13.19/</A> I get the
</I>following
&gt;<i> &gt; error
</I>&gt;<i> &gt; &quot;The following error was encountered while trying to retrieve the URL:
</I>The
&gt;<i> &gt; system returned: (111) Connection refused; The remote host or network
</I>may
&gt;<i> &gt; be down. Please try the request again.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It only gives for 172.20.36.144 not for the urlpath acl.
</I>&gt;<i>
</I>&gt;<i> You have configured Squid to:
</I>&gt;<i>
</I>&gt;<i>  1) &quot;no-vhost&quot; - ignore the Host header the client sent indicating what
</I>&gt;<i> domain name it was contacting.
</I>It usually is vhost and the domain name is teleuniv.com but for testing
purposes we use public IP 202.53.13.19
&gt;<i>
</I>&gt;<i>  2) defaultsite=202.53.13.19 - use &quot;202.53.13.19&quot; as the domain *name*
</I>&gt;<i> for all requests received through that https_port.
</I>&gt;<i>
</I>&gt;<i> Why would you expect to see anything other than <A HREF="https://202.53.13.19">https://202.53.13.19</A> in
</I>&gt;<i> the URL when you have configured those?
</I>Didnt understand the above mentioned point
&gt;<i>
</I>&gt;<i> &gt; But this happens
</I>&gt;<i> &gt; only sometimes. When I physically go to that server (172.20.36.150) and
</I>&gt;<i> &gt; click on the wired connection (one of the LAN options using linux). It
</I>&gt;<i> &gt; works again. I am very confused
</I>&gt;<i>
</I>&gt;<i> Your use of &quot;physically&quot; seems to be incorrect. You walked up to the
</I>&gt;<i> machine hardware and did what ?
</I>&gt;<i> I logged in the machine and click on &quot;wired connection&quot;
</I>&gt;<i> &quot;Clicking&quot; seems to be that you logged in (not physically) and changed
</I>&gt;<i> something which affected how Squid was able to connect to it.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All traffic with the domain name &quot;202.53.13.19&quot; and not the path
</I>&gt;<i> &quot;/portal6may&quot; gets sent to the second cache_peer (172.20.36.150).
</I>&gt;<i>
</I>&gt;<i> So what do you expect to happen when the server 172.20.36.150 receives a
</I>&gt;<i> request with Host: header domain name set to &quot;202.53.13.19&quot;  ?
</I>&gt;<i>I didn't understand the host: header part any references to understand
</I>&gt;<i>
</I>&gt;<i> It seems like the servers connectivity is a bit flakey and getting
</I>&gt;<i> disconnected occasionally. But the wrong Squid configuration could be
</I>&gt;<i> hiding some other issue.
</I>&gt;<i> I read somewhere it happens when cache is full. Can u tell me what should
</I>be cache size if my HDD 500 gb and 32 MB RAM
&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-user">http://lists.squid-cache.org/listinfo/squid-user</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160527/31e62ef1/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160527/31e62ef1/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010754.html">[squid-users] The system returned: (111) Connection refused;
</A></li>
	<LI>Next message (by thread): <A HREF="010751.html">[squid-users] missing negotiate_kerberos_auth on my squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10759">[ date ]</a>
              <a href="thread.html#10759">[ thread ]</a>
              <a href="subject.html#10759">[ subject ]</a>
              <a href="author.html#10759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
