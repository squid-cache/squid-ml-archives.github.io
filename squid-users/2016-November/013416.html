<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] NCSA-auth don't work for file contain too many passswords
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20NCSA-auth%20don%27t%20work%20for%20file%20contain%20too%20many%0A%20passswords&In-Reply-To=%3C887623bf-2ab6-9c9e-99e3-cc0f63e2f936%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013413.html">
   <LINK REL="Next"  HREF="013420.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] NCSA-auth don't work for file contain too many passswords</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20NCSA-auth%20don%27t%20work%20for%20file%20contain%20too%20many%0A%20passswords&In-Reply-To=%3C887623bf-2ab6-9c9e-99e3-cc0f63e2f936%40treenet.co.nz%3E"
       TITLE="[squid-users] NCSA-auth don't work for file contain too many passswords">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Nov 12 02:48:30 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013413.html">[squid-users] NCSA-auth don't work for file contain too many passswords
</A></li>
        <LI>Next message (by thread): <A HREF="013420.html">[squid-users] NCSA-auth don't work for file contain too many passswords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13416">[ date ]</a>
              <a href="thread.html#13416">[ thread ]</a>
              <a href="subject.html#13416">[ subject ]</a>
              <a href="author.html#13416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/11/2016 6:29 a.m., Garri Djavadyan wrote:
&gt;<i> On 2016-11-11 21:05, --Ahmad-- wrote:
</I>&gt;&gt;<i> hi squid users .
</I>&gt;&gt;<i> i have problem when i use basic_ncsa auth
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> the auth work when i have few passwords in the file of auth .
</I>&gt;&gt;<i> as example
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> auth_param basic program /lib/squid/basic_ncsa_auth /etc/squid/squid_user
</I>&gt;&gt;<i> acl ncsa_users proxy_auth REQUIRED
</I>&gt;&gt;<i> auth_param basic children 100
</I>&gt;&gt;<i> http_access allow ncsa_users
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> user like 30 in the file /etc/squid/squid_user  is ok
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> but when i use like 20K password &#8230;.. squid always give me wrong pwd .
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> is there any turning i need ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I&#8217;m using squid 3.5.2
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> BTW i use the cmd as ex &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&gt;     htpasswd -db /etc/squid/squid_user
</I>&gt;&gt;<i> user1 user1
</I>
Ahmad, what do you think &quot;-db&quot; means?

Hint: htpasswd tells you what the 'd' and the 'b' mean.


&gt;<i> 
</I>&gt;<i> Hi Ahmad,
</I>&gt;<i> 
</I>&gt;<i> I can't reproduce the problem using Squid 3.5.22. I used following
</I>&gt;<i> method to verify the case:
</I>&gt;<i> 
</I>
Unfortunately your test uses the 'openssl' tool below instead of
htpasswd to create the password file. There are some big differences in
security algorithms each uses to reate the password file.

&gt;<i> 
</I>&gt;<i> 2. Create ncsa passwords db for 20k users.
</I>&gt;<i> # for i in {1..20000}; do echo &quot;user${i}:$(openssl passwd -apr1
</I>&gt;<i> pass${i})&quot; &gt;&gt; /usr/local/squid35/etc/passwd; done
</I>&gt;<i> 
</I>
This test *will* fail when &quot;htpasswd -db&quot; is used to generate the
password file from those password strings. Notice that the test 'i'
values of 10000+ create passwords like &quot;pass10000&quot; which are 9
characters long.

The htpasswd -d uses DES encryption which has an 8 character limit on
password length. It will *silently* truncate the password to the first 8
characters.

Recent basic_ncsa_auth helper versions will detect and reject
authentication using DES algorithm when password is longer than 8
characters.

NP: users can still log into Squid which were configured with that DES
file, but must only type in the first 8 characters of their password
when doing so.

You need to use the htpasswd -m (MD5) or -s (SHA) options to hash the
passwords. Avoid DES (-d) as much as you can.


&gt;<i> 
</I>&gt;<i> Can you try the method using Squid 3.5.2? If it would fail, can you try
</I>&gt;<i> Squid 3.5.22?
</I>&gt;<i> 
</I>
Please do the Squid upgrade anyway since there are many serious security
issues fixed in 3.5 since the .2 release.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013413.html">[squid-users] NCSA-auth don't work for file contain too many passswords
</A></li>
	<LI>Next message (by thread): <A HREF="013420.html">[squid-users] NCSA-auth don't work for file contain too many passswords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13416">[ date ]</a>
              <a href="thread.html#13416">[ thread ]</a>
              <a href="subject.html#13416">[ subject ]</a>
              <a href="author.html#13416">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
