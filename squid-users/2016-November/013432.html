<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid multithread
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20multithread&In-Reply-To=%3C41de64dc-e946-8952-121e-5406772e824a%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013430.html">
   <LINK REL="Next"  HREF="013433.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid multithread</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20multithread&In-Reply-To=%3C41de64dc-e946-8952-121e-5406772e824a%40gmail.com%3E"
       TITLE="[squid-users] Squid multithread">yvoinov at gmail.com
       </A><BR>
    <I>Mon Nov 14 17:09:30 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013430.html">[squid-users] Squid multithread
</A></li>
        <LI>Next message (by thread): <A HREF="013433.html">[squid-users] Squid multithread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13432">[ date ]</a>
              <a href="thread.html#13432">[ thread ]</a>
              <a href="subject.html#13432">[ subject ]</a>
              <a href="author.html#13432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

14.11.2016 21:59, Eduardo Carneiro &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Yuri Voinov wrote
</I>&gt;&gt;<i> <A HREF="http://wiki.squid-cache.org/Features/SmpScale">http://wiki.squid-cache.org/Features/SmpScale</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://wiki.squid-cache.org/MultipleInstances">http://wiki.squid-cache.org/MultipleInstances</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 14.11.2016 20:22, Eduardo Carneiro &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;<i> Hi everyone!
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I have a Squid 3.5.19 with dynamic content cache using url rewrite. It's
</I>&gt;&gt;&gt;<i> a
</I>&gt;&gt;&gt;<i> virtual machine (VMWare) with 2 quad-core processors each. Squid proccess
</I>&gt;&gt;&gt;<i> is
</I>&gt;&gt;&gt;<i> 100% in one of my eight cores and the access it's getting very slow.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> There exists any way to compile squid with multithread option? The idea
</I>&gt;&gt;&gt;<i> is
</I>&gt;&gt;&gt;<i> spread this processing beetwen the 8 cores.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> View this message in context:
</I>&gt;&gt;&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-multithread-tp4680488.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-multithread-tp4680488.html</A>
</I>&gt;&gt;&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at .squid-cache</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i> -- 
</I>&gt;&gt;<i> Cats - delicious. You just do not know how to cook them.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at .squid-cache</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 0x613DEC46.asc (2K)
</I>&gt;&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/attachment/4680489/0/0x613DEC46.asc&amp;gt;">http://squid-web-proxy-cache.1019090.n4.nabble.com/attachment/4680489/0/0x613DEC46.asc&gt;</A>
</I>&gt;&gt;<i> signature.asc (484 bytes)
</I>&gt;&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/attachment/4680489/1/signature.asc&amp;gt;">http://squid-web-proxy-cache.1019090.n4.nabble.com/attachment/4680489/1/signature.asc&gt;</A>
</I>&gt;<i> From what I understood I will need to use each instance in different ports,
</I>&gt;<i> right? This does not solve my problem. There are any way to separate one
</I>&gt;<i> instance for accesses and another for cache?
</I>

      What can workers share?

Using Coordinator and common configuration files, Squid workers can
receive identical configuration information and synchronize some of
their activities. By default, Squid workers share the following: 

  * Squid executable, 
  * general configuration, 
  * listening ports (but shared ICP and HTCP ports do not work well; see
    below), 
  * logs, 
  * memory object cache (in most environments), 
  * disk object cache (with Rock Store only), 
  *

    insecure cache manager statistics (detailed elsewhere
    &lt;<A HREF="http://wiki.squid-cache.org/Features/CacheManager#SMP_considerations">http://wiki.squid-cache.org/Features/CacheManager#SMP_considerations</A>&gt;), 

  * SNMP statistics.

Cache indexes are shared without copying. Other shared information is
usually small in terms of RAM use and is essentially copied to avoid
locking and associated performance overheads. 

Conditional configuration and worker-dependent macros can be used to
limit sharing. For example, each worker can be given a dedicated
http_port to listen on. 

Currently, Squid workers do not share and do not synchronize other
resources and services, including (but not limited to): 

  * memory object cache (in some environments), 
  * disk object cache (except for Rock Store), 
  * DNS caches (ipcache and fqdncache), 
  * helper processes and daemons, 
  *

    stateful HTTP authentication (e.g., digest authentication; see
    bug 3517 &lt;<A HREF="http://bugs.squid-cache.org/show_bug.cgi?id=3517">http://bugs.squid-cache.org/show_bug.cgi?id=3517</A>&gt;), 

  * delay pools, 
  * SSL session cache (there is an active project to allow session
    sharing among workers), 
  *

    secure cache manager statistics (detailed elsewhere
    &lt;<A HREF="http://wiki.squid-cache.org/Features/CacheManager#SMP_considerations">http://wiki.squid-cache.org/Features/CacheManager#SMP_considerations</A>&gt;), 

  *

    ICP/HTCP (works with a caveat: If multiple workers share the same
    ICP/HTCP port, an ICP/HTCP response may not go the worker that sent
    the request, causing timeouts at the requesting worker; use a
    dedicated ICP/HTCP port as a workaround
    &lt;<A HREF="http://www.squid-cache.org/mail-archive/squid-users/201308/0358.html">http://www.squid-cache.org/mail-archive/squid-users/201308/0358.html</A>&gt;). 

Some SMP-unaware features continue to work in SMP mode (e.g., DNS
responses are going to be cached by individual workers), but their
performance suffers from the lack of synchronization and they require
more resources due to duplication of information (e.g., each worker may
independently resolve and cache the IP of the same domain name). Some
SMP-unaware features break badly (e.g., ufs-based cache_dirs become
corrupted) unless squid.conf conditionals are used to prevent such
breakage. Some SMP-unaware features will appear to work but will do so
incorrectly (e.g., delay pools will limit bandwidth on per-worker basis,
without sharing traffic information among workers and without dividing
bandwidth limits among workers).

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-multithread-tp4680488p4680490.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-multithread-tp4680488p4680490.html</A>
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
-- 
Cats - delicious. You just do not know how to cook them.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.key</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.sig">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161114/51c824b1/attachment.sig</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013430.html">[squid-users] Squid multithread
</A></li>
	<LI>Next message (by thread): <A HREF="013433.html">[squid-users] Squid multithread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13432">[ date ]</a>
              <a href="thread.html#13432">[ thread ]</a>
              <a href="subject.html#13432">[ subject ]</a>
              <a href="author.html#13432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
