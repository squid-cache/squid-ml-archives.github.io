<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid-users Digest, Vol 27, Issue 28
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2027%2C%20Issue%2028&In-Reply-To=%3C002401d23fa0%246b6c42a0%244244c7e0%24%40verizon.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013450.html">
   <LINK REL="Next"  HREF="013458.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid-users Digest, Vol 27, Issue 28</H1>
    <B>vze2k3sa at verizon.net</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2027%2C%20Issue%2028&In-Reply-To=%3C002401d23fa0%246b6c42a0%244244c7e0%24%40verizon.net%3E"
       TITLE="[squid-users] squid-users Digest, Vol 27, Issue 28">vze2k3sa at verizon.net
       </A><BR>
    <I>Wed Nov 16 00:28:56 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013450.html">[squid-users] Trusted CA Certificate with ssl_bump
</A></li>
        <LI>Next message (by thread): <A HREF="013458.html">[squid-users] squid-users Digest, Vol 27, Issue 28
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13457">[ date ]</a>
              <a href="thread.html#13457">[ thread ]</a>
              <a href="subject.html#13457">[ subject ]</a>
              <a href="author.html#13457">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/11/2016 9:05 a.m., Patrick Flaherty wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Can anyone tell me if the 'HIER_NONE' entries below is Squid not able 
</I>&gt;<i> to connect to www.website.com? The 21 sec timeout is a classic Windows 
</I>&gt;<i> TCP connection timeout. I just need confirmation that that Squid on 
</I>&gt;<i> these 2 clients behalf (10.10.15.96 &amp; 10.10.15.81) could not connect 
</I>&gt;<i> to www.website.com and timed out after ~21 secs.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> 09/Nov/2016:11:54:53 -0500  21029 10.10.15.96 TAG_NONE/503 0 CONNECT
</I>&gt;<i> www.website.com:443 - HIER_NONE/- -
</I>&gt;<i> 
</I>&gt;<i> 09/Nov/2016:11:54:53 -0500  21029 10.10.15.81 TAG_NONE/503 0 CONNECT www.
</I>&gt;<i> website.com:443 - HIER_NONE/- -
</I>
HIER_NONE - no upstream server was involved / contacted.

503 - Squid encountered an error which prevented upstream server transaction being successful.

TAG_NONE - non-TCP protocol occuring.


This NONE/503 combo appears usually when SSL-Bump feature is doing TLS interception - either the TLS handshake failed or your configured choice of bumping action is not possible.

Amos
---------------------------
Thanks Amos for that clarity although now I'm not sure why this happened. If the upstream server did not respond (which is what I thought) I would say I understand. But if Squid actually made no attempt to contact the server, then Squid itself had an issue. I do not use SSL-Bump so maybe Squid had some internal error?
When you say ' HIER_NONE - no upstream server was involved / contacted.' does that mean Squid did not even try to connect to the upstream server or could it mean that it tried to connect and there was no response?

Here is my Squid.conf file in case of misconfiguration.
****
# Smart911 CPE/Smart911 Console Squid Proxy Configuration

# Network(s) where proxy traffic is originating
# acl localnet src 10.0.0.0/8	# RFC1918 possible internal network
# acl localnet src 172.16.0.0/12	# RFC1918 possible internal network
# acl localnet src 192.168.0.0/16	# RFC1918 possible internal network
acl localnet src all

# acl and http_access (&quot;rmsc.txt&quot;)
acl whitelist dstdomain  &quot;c:/squid/etc/squid/rmsc.txt&quot;
http_access 	allow 	whitelist

acl http      proto      http
acl https     proto      https
acl SSL_ports port 443
acl Safe_ports port 80		# http
acl Safe_ports port 443		# https
acl CONNECT method CONNECT

# rules allowing proxy access
http_access allow http  Safe_ports whitelist localnet
http_access allow https SSL_ports whitelist localnet

# Deny requests to certain unsafe ports
http_access deny !Safe_ports

# Deny CONNECT to other than secure SSL ports
http_access deny CONNECT !SSL_ports

# Lastly deny all other access to this proxy
http_access deny all

# Listens to port 3128
http_port 3128

# DNS servers 
dns_nameservers 8.8.8.8 8.8.4.4

# Roll log file daily and keep 30 days
logfile_rotate 30

# Access log format
logformat squid %tl %6tr %&gt;a %Ss/%03&gt;Hs %&lt;st %rm %ru %un %Sh/%&lt;A %mt

# Debug 
# debug_options	ALL,2

# Use IPv4 based DNS first
dns_v4_first on

# Log definitions
access_log stdio:c:/Squid/var/log/squid/access.log
cache_store_log stdio:c:/Squid/var/log/squid/store.log
buffered_logs on

****
Thanks Amos!
Patrick




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013450.html">[squid-users] Trusted CA Certificate with ssl_bump
</A></li>
	<LI>Next message (by thread): <A HREF="013458.html">[squid-users] squid-users Digest, Vol 27, Issue 28
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13457">[ date ]</a>
              <a href="thread.html#13457">[ thread ]</a>
              <a href="subject.html#13457">[ subject ]</a>
              <a href="author.html#13457">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
