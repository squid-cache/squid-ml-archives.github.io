<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ubiquiti: Anyone interested in instructions how	to route traffic to a squid box?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubiquiti%3A%20Anyone%20interested%20in%20instructions%20how%0A%09to%20route%20traffic%20to%20a%20squid%20box%3F&In-Reply-To=%3C0dfd01d243e1%24b3eb71a0%241bc254e0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013514.html">
   <LINK REL="Next"  HREF="013553.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ubiquiti: Anyone interested in instructions how	to route traffic to a squid box?</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubiquiti%3A%20Anyone%20interested%20in%20instructions%20how%0A%09to%20route%20traffic%20to%20a%20squid%20box%3F&In-Reply-To=%3C0dfd01d243e1%24b3eb71a0%241bc254e0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Ubiquiti: Anyone interested in instructions how	to route traffic to a squid box?">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Nov 21 10:26:21 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013514.html">[squid-users] Ubiquiti: Anyone interested in instructions how to route traffic to a squid box?
</A></li>
        <LI>Next message (by thread): <A HREF="013553.html">[squid-users] Ubiquiti: Anyone interested in instructions how	to route traffic to a squid box?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13516">[ date ]</a>
              <a href="thread.html#13516">[ thread ]</a>
              <a href="subject.html#13516">[ subject ]</a>
              <a href="author.html#13516">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have the main idea on to implement it but just need my testing lab up and running.
The first place to start would be:
<A HREF="https://help.ubnt.com/hc/en-us/articles/204952274-EdgeMAX-Policy-based-routing-source-address-based-">https://help.ubnt.com/hc/en-us/articles/204952274-EdgeMAX-Policy-based-routing-source-address-based-</A>

Which for me that have some experience with vyatta and vyos makes sense.
We need two things:
- exception rules space(override or even just for the proxy)
- rules for out-bound\outgoing traffic redirection
- rules for in-bound\incomming traffic redirection

1. We need all traffic from lan with destination ports 80 to be routed towards the proxy.
2. We need all traffic from wan with source ports 80 to be routed towards the proxy.

The same thing can be done for other ports such as 53 or 443.
For each scenario you might need to add exceptions like for local traffic which should not be routed towards the proxy.

I will try to sit on it tomorrow on my free time.

Couple more examples on PBR:
<A HREF="https://latencyzero.wordpress.com/2014/06/30/ubiquiti-edge-router-poe-policy-based-routing-source-rule/">https://latencyzero.wordpress.com/2014/06/30/ubiquiti-edge-router-poe-policy-based-routing-source-rule/</A>
<A HREF="https://community.ubnt.com/t5/EdgeMAX/Edgerouter-Lite-Policy-based-routing/td-p/1452095">https://community.ubnt.com/t5/EdgeMAX/Edgerouter-Lite-Policy-based-routing/td-p/1452095</A>
<A HREF="https://www.youtube.com/watch?v=0cKWISB_pMQ">https://www.youtube.com/watch?v=0cKWISB_pMQ</A>
<A HREF="https://www.youtube.com/watch?v=3hvmzEv8iNQ">https://www.youtube.com/watch?v=3hvmzEv8iNQ</A>
<A HREF="https://www.dennogumi.org/2015/01/policy-based-routing-for-single-ips-using-edgeos/">https://www.dennogumi.org/2015/01/policy-based-routing-for-single-ips-using-edgeos/</A>
<A HREF="http://community.ubnt.com/t5/EdgeMAX/Redirect-all-traffic-from-a-signle-IP-to-a-VPN-interface/m-p/1140025">http://community.ubnt.com/t5/EdgeMAX/Redirect-all-traffic-from-a-signle-IP-to-a-VPN-interface/m-p/1140025</A>

And just as a reference couple VYOS PBR links:
<A HREF="http://www.five-ten-sg.com/mapper/policy-based-routing">http://www.five-ten-sg.com/mapper/policy-based-routing</A>
<A HREF="https://yosida95.com/2015/05/17/203841.html">https://yosida95.com/2015/05/17/203841.html</A>

Eliezer


----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Marcus Kool
Sent: Sunday, November 20, 2016 22:00
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Ubiquiti: Anyone interested in instructions how to route traffic to a squid box?

Is it an EdgeRouter ?
I am interested since Ubiquiti has poor documentation.

Marcus


On 11/20/2016 05:31 PM, Eliezer Croitoru wrote:
&gt;<i> I have a tiny Ubiquiti edge router here and I can publish the rules 
</I>&gt;<i> for routing ports 80 and 443 and 53 into the squid\dns box.
</I>&gt;<i> Any interest in such a guide in the wiki?
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i> ----
</I>&gt;<i> Eliezer Croitoru &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt; Linux System 
</I>&gt;<i> Administrator
</I>&gt;<i> Mobile: +972-5-28704261
</I>&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013514.html">[squid-users] Ubiquiti: Anyone interested in instructions how to route traffic to a squid box?
</A></li>
	<LI>Next message (by thread): <A HREF="013553.html">[squid-users] Ubiquiti: Anyone interested in instructions how	to route traffic to a squid box?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13516">[ date ]</a>
              <a href="thread.html#13516">[ thread ]</a>
              <a href="subject.html#13516">[ subject ]</a>
              <a href="author.html#13516">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
