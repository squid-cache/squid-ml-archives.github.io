<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Hint for howto wanted ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Hint%20for%20howto%20wanted%20...&In-Reply-To=%3C005301d24960%24d20a8ac0%24761fa040%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013611.html">
   <LINK REL="Next"  HREF="013617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Hint for howto wanted ...</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Hint%20for%20howto%20wanted%20...&In-Reply-To=%3C005301d24960%24d20a8ac0%24761fa040%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Hint for howto wanted ...">eliezer at ngtech.co.il
       </A><BR>
    <I>Mon Nov 28 10:18:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013611.html">[squid-users] Hint for howto wanted ...
</A></li>
        <LI>Next message (by thread): <A HREF="013617.html">[squid-users] Hint for howto wanted ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13613">[ date ]</a>
              <a href="thread.html#13613">[ thread ]</a>
              <a href="subject.html#13613">[ subject ]</a>
              <a href="author.html#13613">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Walter,

I am not sure you understand the direction of things or what I am aiming for.
First if the client has CentOS 6.8 There are RPM's for newer versions which I am building manually for the public use.
Second: You can simplify the picture from Intercepting traffic using the local squid into &quot;route&quot; the traffic in the IP level towards the remote proxy.
You can open a gre tunnel or to use some kind of simple VPN service to tunnel between the client box to the 3.5.20 box.
If you will route the clients traffic towards the proxy in the IP level you would be free from handling the 3.1.X proxy.

You should prioritize your goals between:
- Caching
-  ACL
- Others

Once you will open your mind from resolving and issue and convert it into a second form which is functionality I think I would be able to assist you.

What is missing from the 3.1.X proxy?
Is the SSL BUMP missing?
What iptables rules are you using on the client machine(3.1.X)?

All the above matters to understand how to offer the right solution.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: Walter H. [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">walter.h at mathemainzel.info</A>] 
Sent: Monday, November 28, 2016 10:59
To: Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt;
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: RE: [squid-users] Hint for howto wanted ...

On Mon, November 28, 2016 06:56, Eliezer Croitoru wrote:
&gt;<i> OK so the next step is:
</I>
&gt;<i> Routing over tunnel to the other proxy and on it(which has ssl-bump) 
</I>&gt;<i> intercept.
</I>by now only the 3.5.20 squid on the local VM does SSL-bump

&gt;<i> If you have a public on the remote proxies which can use ssl-bump then 
</I>&gt;<i> route the traffic to there using Policy Based routing.
</I>how do I configure this?

&gt;<i> You can selectively route by source or destination IP addresses.
</I>by now the remote has in its iptables to only accept port 3128 from my home IP (IPv6 and IPv4), but the IPv4 at home changes several times a year; means it is not fix;

&gt;<i>
</I>&gt;<i> Now my main question is: Can't you just install 3.5 on the 3.1.23 
</I>&gt;<i> machine and bump there?
</I>SSL bump and parent proxy together doesn't work, if this worked I wouldn't need the 3.1.23 machine at all ...
the 3.1.23 machine has the other 2 proxies (3.4.14-remote and
3.5.20-local) as parent ...

I should mention that the 3.5.20 box also has ClamAV (SquidClam) which does malware checking ...
(the remote proxy can't run ClamAV)

&gt;<i> How are you intercepting the connections? What are the iptables rules 
</I>&gt;<i> you are using?
</I>
the client have configured the 3.1.23 squid box as proxy

&gt;<i> What OS are you running on top of the Squid boxes?
</I>
all squid boxes run CentOS 6.8

Thanks,
Walter




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013611.html">[squid-users] Hint for howto wanted ...
</A></li>
	<LI>Next message (by thread): <A HREF="013617.html">[squid-users] Hint for howto wanted ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13613">[ date ]</a>
              <a href="thread.html#13613">[ thread ]</a>
              <a href="subject.html#13613">[ subject ]</a>
              <a href="author.html#13613">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
