<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.21: ftp_port intercept doesn't work
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.21%3A%20ftp_port%20intercept%20doesn%27t%20work&In-Reply-To=%3CCAFfuDwx5PfZJ32J2WsGDZzPw7PncSLyEdknZ7aiUMf1%2BUFqfpw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012881.html">
   <LINK REL="Next"  HREF="012833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.21: ftp_port intercept doesn't work</H1>
    <B>oleg gv</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.21%3A%20ftp_port%20intercept%20doesn%27t%20work&In-Reply-To=%3CCAFfuDwx5PfZJ32J2WsGDZzPw7PncSLyEdknZ7aiUMf1%2BUFqfpw%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid 3.5.21: ftp_port intercept doesn't work">oagvozd at gmail.com
       </A><BR>
    <I>Mon Oct  3 12:36:29 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012881.html">[squid-users] Squid crash - 3.5.21
</A></li>
        <LI>Next message (by thread): <A HREF="012833.html">[squid-users] Squid 3.5.21: ftp_port intercept doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12827">[ date ]</a>
              <a href="thread.html#12827">[ thread ]</a>
              <a href="subject.html#12827">[ subject ]</a>
              <a href="author.html#12827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello

I've setup in Squid 3.5.21 on my gateway : ftp_port 10.0.0.1:2121 intercept
and create nat rule to redirect from port 21 to 2121 for client source
address (for example 10.0.0.10)

Then trying to go through browser to <A HREF="ftp://ftp.intel.com">ftp://ftp.intel.com</A> from client
10.0.0.10

And in browser got Password prompt window: i set user anonymous and
password <A HREF="https://lists.squid-cache.org/listinfo/squid-users">a at a</A>

Then got error message 501 Missing Host.

In squid log I see:

2016/10/03 15:34:24.504 kid1| 20,2| store.cc(949) checkCachable:
StoreEntry::checkCachable: NO: not cachable
2016/10/03 15:34:24.508 kid1| 33,2| client_side.cc(816) swanSong: local=
10.0.0.1:2121 remote=10.0.0.10:37016 flags=1
2016/10/03 15:34:24.508 kid1| 5,2| TcpAcceptor.cc(220) doAccept: New
connection on FD 10
2016/10/03 15:34:24.508 kid1| 5,2| TcpAcceptor.cc(295) acceptNext:
connection on local=0.0.0.0:2121 remote=[::] FD 10 flags=9
2016/10/03 15:34:29.534 kid1| 33,2| FtpServer.cc(699) parseOneRequest:
&gt;&gt;<i>ftp USER anonymous
</I>2016/10/03 15:34:29.534 kid1| 20,2| store.cc(949) checkCachable:
StoreEntry::checkCachable: NO: not cachable
2016/10/03 15:34:29.534 kid1| 20,2| store.cc(949) checkCachable:
StoreEntry::checkCachable: NO: not cachable
2016/10/03 15:34:29.534 kid1| 20,2| store.cc(949) checkCachable:
StoreEntry::checkCachable: NO: not cachable
2016/10/03 15:34:29.534 kid1| 88,2| client_side_reply.cc(2005)
processReplyAccessResult: The reply for NONE error:ftp-missing-host is
ALLOWED, because it matched NO ACL's
2016/10/03 15:34:29.534 kid1| 9,2| FtpServer.cc(1208)
writeForwardedReplyAndCall: FTP Client local=10.0.0.254:2121 remote=
10.0.0.10:37018 FD 13 flags=1
2016/10/03 15:34:29.534 kid1| 9,2| FtpServer.cc(1210)
writeForwardedReplyAndCall: FTP Client REPLY:
---------
501 Missing host

----------
2016/10/03 15:34:29.534 kid1| 20,2| store.cc(949) checkCachable:
StoreEntry::checkCachable: NO: not cachable
2016/10/03 15:34:29.574 kid1| 33,2| client_side.cc(816) swanSong: local=
10.0.0.1:2121 remote=10.0.0.10:37018 flags=1


Though I can not use native ftp relay to go to ftp servers.

Please, could you help ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161003/319f49d2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161003/319f49d2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012881.html">[squid-users] Squid crash - 3.5.21
</A></li>
	<LI>Next message (by thread): <A HREF="012833.html">[squid-users] Squid 3.5.21: ftp_port intercept doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12827">[ date ]</a>
              <a href="thread.html#12827">[ thread ]</a>
              <a href="subject.html#12827">[ subject ]</a>
              <a href="author.html#12827">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
