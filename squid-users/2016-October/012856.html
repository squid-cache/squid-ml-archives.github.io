<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid - AD kerberos auth and Linux Server proxy access not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20-%20AD%20kerberos%20auth%20and%20Linux%20Server%20proxy%0A%20access%20not%20working&In-Reply-To=%3Cd35ad0ca-761d-60e3-c594-04697110afdc%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012852.html">
   <LINK REL="Next"  HREF="012871.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid - AD kerberos auth and Linux Server proxy access not working</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20-%20AD%20kerberos%20auth%20and%20Linux%20Server%20proxy%0A%20access%20not%20working&In-Reply-To=%3Cd35ad0ca-761d-60e3-c594-04697110afdc%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid - AD kerberos auth and Linux Server proxy access not working">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Oct  4 11:11:08 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012852.html">[squid-users] Squid - AD kerberos auth and Linux Server proxy	access not working
</A></li>
        <LI>Next message (by thread): <A HREF="012871.html">[squid-users] Squid - AD kerberos auth and Linux Server proxy	access not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12856">[ date ]</a>
              <a href="thread.html#12856">[ thread ]</a>
              <a href="subject.html#12856">[ subject ]</a>
              <a href="author.html#12856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/10/2016 11:36 p.m., Antony Stone wrote:
&gt;<i> On Tuesday 04 October 2016 at 12:28:44, Nilesh Gavali wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hello Antony;
</I>&gt;&gt;<i> I have double checked the current working configuration of my squid.conf
</I>&gt;&gt;<i> and it has same settings which I posted earlier. somehow it is working for
</I>&gt;&gt;<i> us.
</I>&gt;<i> 
</I>&gt;<i> I'm not saying the whole thing won't work; I'm saying there is no point in 
</I>&gt;<i> having a line &quot;http_access allow ad_auth&quot; following the line &quot;http_access deny 
</I>&gt;<i> all&quot;.  The ad_auth line can never be invoked.
</I>
Not knowing why authentication works is dangerous. You might have been
allowing non-authenticated traffic and invalid user accounts through.

The only reason it does &quot;work&quot; is that the ACL called &quot;USERS&quot; is _not_
actually checking user logins. It is a group checking ACL which requires
authentication to happen before it can be checked.

In this specific case invalid logins cannot be a member of the group. So
they will not get through the proxy.

However, people who accidentally type the user/password wrong, or whose
machines automatically login with an account not a member of the group
will not be allowed any way to try again short of shutting down their
browser or maybe even logging out of the machine and trying from another
one.

That may or may not be a problem for you.

&gt;<i> 
</I>&gt;&gt;<i> below is the error from access.log file.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1475518342.279      0 10.xx.15.103 TCP_DENIED/407 3589 CONNECT
</I>&gt;&gt;<i> vseries-test.bottomline.com:443 - NONE/- text/html
</I>&gt;<i> 
</I>&gt;<i> Error 407 is &quot;proxy auth required&quot;, so the proxy is expecting authentication 
</I>&gt;<i> for some reason.
</I>&gt;<i> 
</I>&gt;<i> Can you confirm that the hostname vseries-test.bottomline.com is contained in 
</I>&gt;<i> your site file /etc/squid/sitelist/dbs_allowed_site ?
</I>&gt;<i> 
</I>&gt;<i> Can you temporarily change the line &quot;http_access allow IWCCP01 allowedsite&quot; to 
</I>&gt;<i> &quot;http_access allow IWCCP01&quot; and see whether the machine then gets access?
</I>&gt;<i> 
</I>
If that works, please list the output of the command:
  grep &quot;bottomline.com&quot; /etc/squid/sitelist/dbs_allowed_site

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012852.html">[squid-users] Squid - AD kerberos auth and Linux Server proxy	access not working
</A></li>
	<LI>Next message (by thread): <A HREF="012871.html">[squid-users] Squid - AD kerberos auth and Linux Server proxy	access not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12856">[ date ]</a>
              <a href="thread.html#12856">[ thread ]</a>
              <a href="subject.html#12856">[ subject ]</a>
              <a href="author.html#12856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
