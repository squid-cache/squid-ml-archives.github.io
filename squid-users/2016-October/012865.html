<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Caching http google deb files
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20http%20google%20deb%20files&In-Reply-To=%3CCA%2BsSnVYVSAwBrswBumpn0C2yKGwdxhRgT_TRgBBPOU-AoUjc3Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012879.html">
   <LINK REL="Next"  HREF="012869.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Caching http google deb files</H1>
    <B>Hardik Dangar</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20http%20google%20deb%20files&In-Reply-To=%3CCA%2BsSnVYVSAwBrswBumpn0C2yKGwdxhRgT_TRgBBPOU-AoUjc3Q%40mail.gmail.com%3E"
       TITLE="[squid-users] Caching http google deb files">hardikdangar+squid at gmail.com
       </A><BR>
    <I>Tue Oct  4 13:05:48 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012879.html">[squid-users] Squid-3.5.21: filter FTP content or FTP commands
</A></li>
        <LI>Next message (by thread): <A HREF="012869.html">[squid-users] Caching http google deb files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12865">[ date ]</a>
              <a href="thread.html#12865">[ thread ]</a>
              <a href="subject.html#12865">[ subject ]</a>
              <a href="author.html#12865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am trying to cache following deb files as its most requested file in
network. ( google chrome almost every few days many clients update it ).

<A HREF="http://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb">http://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</A>
<A HREF="http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-beta_current_i386.deb">http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-beta_current_i386.deb</A>

Response headers for both contains Last modified date which is 10 to 15
days old but squid does not seem to cache it somehow. here is sample
response header for one of the file,

HTTP Response Header

Status: HTTP/1.1 200 OK
Accept-Ranges: bytes
Content-Length: 6662208
Content-Type: application/x-debian-package
Etag: &quot;fa383&quot;
Last-Modified: Thu, 15 Sep 2016 19:24:00 GMT
Server: downloads
Vary: *
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-Xss-Protection: 1; mode=block
Date: Tue, 04 Oct 2016 12:51:57 GMT
Alt-Svc: quic=&quot;:443&quot;; ma=2592000; v=&quot;36,35,34,33,32&quot;
Connection: close


I have tried various refresh patterns to cache it but it seems somehow it's
not cached no matter what i try, below are 6 different methods i have
already tried one by one

1) refresh_pattern dl-ssl.google.com  2160 100% 10080 ignore-no-cache
reload-into-ims

2) refresh_pattern
<A HREF="http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-stable_current_i386.deb">http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-stable_current_i386.deb</A>
129600 100% 129600 reload-into-ims

3) refresh_pattern dl-ssl.google.com\/dl\/linux\/direct/.*\(.deb|.zip)
43200 80% 129600 reload-into-ims override-lastmod ignore-no-store
refresh-ims store-stale

4) refresh_pattern ^http:\/\/dl-ssl.google.com.*\.(deb|zip)  43200 80%
129600 reload-into-ims

5) refresh_pattern dl.google.com\/.*\.(deb)  129600 100% 129600
reload-into-ims

6) refresh_pattern dl-ssl.google.com\/.*\.(deb)  129600 100% 129600
reload-into-ims


My cache is working fine as at the same time i am able to cache files in
oracle servers via following refresh pattern,
refresh_pattern -i download.oracle.com 5259487 20% 5259487 override-expire
override-lastmod ignore-reload ignore-private ignore-auth


So i am not sure what's the issue with <A HREF="http://dl.google.com/linux">http://dl.google.com/linux</A> servers.
Can anyone give me any clue why it is not working ? anyone out there who
are able to cache those files from google?

Here is the TCP_Miss entry in squid's access.log file for the above file,
04/Oct/2016:16:37:07 +0530.695  78902 192.168.1.76 TCP_MISS/200 6662561 GET
<A HREF="http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-stable_current_i386.deb">http://dl-ssl.google.com/dl/linux/direct/mod-pagespeed-stable_current_i386.deb</A>
- HIER_DIRECT/74.125.68.91 application/x-debian-package

Here is my squid config file,
<A HREF="http://pastebin.com/raw/jY57XJPp">http://pastebin.com/raw/jY57XJPp</A>


Thanks.
Hardik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161004/b27d8d6f/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161004/b27d8d6f/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012879.html">[squid-users] Squid-3.5.21: filter FTP content or FTP commands
</A></li>
	<LI>Next message (by thread): <A HREF="012869.html">[squid-users] Caching http google deb files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12865">[ date ]</a>
              <a href="thread.html#12865">[ thread ]</a>
              <a href="subject.html#12865">[ subject ]</a>
              <a href="author.html#12865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
