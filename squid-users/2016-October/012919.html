<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Whitelist domain ignored?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Whitelist%20domain%20ignored%3F&In-Reply-To=%3C32081c3d-3b75-1f36-08a2-8d0bbadb943e%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012918.html">
   <LINK REL="Next"  HREF="012921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Whitelist domain ignored?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Whitelist%20domain%20ignored%3F&In-Reply-To=%3C32081c3d-3b75-1f36-08a2-8d0bbadb943e%40measurement-factory.com%3E"
       TITLE="[squid-users] Whitelist domain ignored?">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Oct  5 21:07:24 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012918.html">[squid-users] Whitelist domain ignored?
</A></li>
        <LI>Next message (by thread): <A HREF="012921.html">[squid-users] Whitelist domain ignored?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12919">[ date ]</a>
              <a href="thread.html#12919">[ thread ]</a>
              <a href="subject.html#12919">[ subject ]</a>
              <a href="author.html#12919">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/05/2016 02:59 PM, Jose Torres-Berrocal wrote:
&gt;<i> Please confirm equivalence:
</I>&gt;<i> 
</I>&gt;<i> 1.
</I>&gt;<i> acl whitelist1 dstdomain .familymedicinepr.com .mail.yahoo.com
</I>&gt;<i> .neodecksoftware.com .office.net
</I>&gt;<i> =
</I>&gt;<i> acl whitelist2 dstdom_regex ^familymedicinepr\.com$ ^mail\.yahoo\.com$
</I>&gt;<i> ^neodecksoftware\.com$ ^office\.net$
</I>&gt;<i> 
</I>&gt;<i> OR
</I>&gt;<i> 
</I>&gt;<i> 2.
</I>&gt;<i> acl whitelist1 dstdomain .familymedicinepr.com .mail.yahoo.com
</I>&gt;<i> .neodecksoftware.com .office.net
</I>&gt;<i> =
</I>&gt;<i> acl whitelist2 dstdom_regex ^familymedicinepr\.com$ ^mail\.yahoo\.com$
</I>&gt;<i> ^neodecksoftware\.com$ ^office\.net$ \familymedicinepr\.com$
</I>&gt;<i> \mail\.yahoo\.com$ \neodecksoftware\.com$ \office\.net$
</I>

Neither pair contains equivalent ACLs. The second attempt was closer to
the correct version but you missed the leading &quot;.&quot; in the first of the
two regular expressions for each domain. For example, it is
&quot;\.office\.net$&quot; not &quot;\office\.net$&quot;.

I also recommend splitting dstdom_regex ACL into multiple lines, one
regular expression per line, for readability sake.


As others have already recommended, it is best to learn how regular
expressions work before proceeding further. They are a very valuable
tool for a sysadmin!

Alex.


&gt;<i> On Wed, Oct 5, 2016 at 4:43 PM, Alex Rousskov wrote:
</I>&gt;&gt;<i> To map any leaf FQDN &quot;foo.bar.baz&quot;:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   1. start with &quot;^&quot;;
</I>&gt;&gt;<i>   2. add &quot;foo.bar.baz&quot; where every period is escaped with &quot;\&quot;;
</I>&gt;&gt;<i>   3. end with &quot;$&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   In summary, use the following regular expression: ^foo\.bar\.baz$
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To map a whole &quot;.bar.baz&quot; domain, including any subdomains, use the
</I>&gt;&gt;<i> following two regular expressions:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   \.bar\.baz$
</I>&gt;&gt;<i>   ^bar\.baz$
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This untested suggestion is based on how regular expressions work; it
</I>&gt;&gt;<i> assumes that Squid does not add anything to the specified expressions.
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012918.html">[squid-users] Whitelist domain ignored?
</A></li>
	<LI>Next message (by thread): <A HREF="012921.html">[squid-users] Whitelist domain ignored?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12919">[ date ]</a>
              <a href="thread.html#12919">[ thread ]</a>
              <a href="subject.html#12919">[ subject ]</a>
              <a href="author.html#12919">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
