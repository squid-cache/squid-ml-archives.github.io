<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS code: SQUID_ERR_SSL_HANDSHAKE)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20squid%20tproxy%20ssl-bump%20and%20Protocol%20error%20%28TLS%0A%20code%3A%20SQUID_ERR_SSL_HANDSHAKE%29&In-Reply-To=%3C506329095.5248673.1475739997409%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012992.html">
   <LINK REL="Next"  HREF="012935.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS code: SQUID_ERR_SSL_HANDSHAKE)</H1>
    <B>Vieri</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20squid%20tproxy%20ssl-bump%20and%20Protocol%20error%20%28TLS%0A%20code%3A%20SQUID_ERR_SSL_HANDSHAKE%29&In-Reply-To=%3C506329095.5248673.1475739997409%40mail.yahoo.com%3E"
       TITLE="[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS code: SQUID_ERR_SSL_HANDSHAKE)">rentorbuy at yahoo.com
       </A><BR>
    <I>Thu Oct  6 07:46:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012992.html">[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS	code: SQUID_ERR_SSL_HANDSHAKE)
</A></li>
        <LI>Next message (by thread): <A HREF="012935.html">[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS code: SQUID_ERR_SSL_HANDSHAKE)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12929">[ date ]</a>
              <a href="thread.html#12929">[ thread ]</a>
              <a href="subject.html#12929">[ subject ]</a>
              <a href="author.html#12929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,



----- Original Message -----
&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;&gt;<i> Is it correct to assume at this point that the current openssl build
</I>&gt;&gt;<i> on this system is &quot;OK&quot; as far as supporting &quot;Win XP TLS 1.0 ciphers
</I>&gt;&gt;<i> to access at least google.com&quot;?
</I>&gt;<i>
</I>&gt;<i> Yes. The build is capable of it. That is one of 3 conditions that must
</I>
&gt;<i> be met for it to work.&gt; 
</I>&gt;<i> The other two being:
</I>&gt;<i>
</I>&gt;<i> * whether it is enabled in the library config.
</I>&gt;<i> - OpenSSL library has its own conf file somewhere.
</I>&gt;<i> - it is possible that curl and other tools whose primary design purpose
</I>
&gt;<i> is communication (not testing) override the library normal defaults for&gt; their own use, or re-try certain things after failures. That needs to be
</I>
&gt;<i> eliminated to be sure.&gt; 
</I>&gt;<i> * that the squid.conf settings combine with those library settings to
</I>
&gt;<i> cause it to be (or stay) enabled.[...]
</I>&gt;<i> So far we can assume that it is either a Squid bug relaying the
</I>
&gt;<i> available cipher list between the two remote endpoints. Or that the set
</I>&gt;<i> of ciphers available to Squid does not include the DES-CBC3-SHA one.[...]
</I>
&gt;<i> The fact that the library can be
</I>
&gt;<i> configured independent of any application using it throws a rather big
</I>
&gt;<i> spanner into the expected behaviour logics.
</I>[...]
&gt;<i> So far your tests are showing that it is about a 50/50 chance of being a
</I>&gt;<i> bug in Squid versus a Squid/OpenSSL misconfiguration somewhere.
</I>

I don't know what a library configuration file is. OpenSSL has a CONF library/functions to read its own .cnf files. An application such as Squid can use these functions to read a conf file, or not.

I'm assuming that at compile time, both the openssl library and squid were built with most features.
Is there a way to list available openssl ciphers from squid (like a squid command line tool)?
As if Squid were to call an openssl library function to &quot;list available ciphers&quot;,or something.


&gt;<i> To test that last detail you probably need to setup a normal https_port
</I>&gt;<i> with SSL and see if you can connect to it with TLSv1.0 and only that
</I>&gt;<i> cipher in curl. That will eliminate any possible server details
</I>&gt;<i> polluting the test result.
</I>
What is a &quot;normal https_port with SSL&quot;?
eg. https_port 3132 cert=/etc/ssl/squid/proxyserver.pem
I would appreciate a full conf example so there are no squid misconfigurations that would make the test results even more confusing.

BTW, does sslproxy_cipher default to ALL if undefined in squid.conf?

&gt;<i> So throwing blame at anyone when it &quot;fails&quot; without a bug being clearly
</I>
&gt;<i> in evidence is the wrong thing to do. It is usually a sign that
</I>&gt;<i> everybody is actually doing &quot;The Right Thing&quot;.
</I>
Correct me if I'm wrong but I sense friction here. It was not my intention of &quot;blaming&quot; anyone. That's a harsh word, in my opinion. I love Squid. As with many huge projects, there are bound to be bugs or lacking features. I never said it WAS the case here anyway. I'm just trying to help and pinpoint the root cause of an issue I'm seeing. I guess I'm frustrated because I still have WinXP&amp;IE8 clients lying around and I'm sure that's the sole source of problems. Squid &quot;debug_options&quot; is already very verbose but maybe it would help in this case to add extra information as to how Squid is calling openssl (and maybe seeing if it's possible to get the cipher list). 


Thanks,

Vieri

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012992.html">[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS	code: SQUID_ERR_SSL_HANDSHAKE)
</A></li>
	<LI>Next message (by thread): <A HREF="012935.html">[squid-users] FW: squid tproxy ssl-bump and Protocol error (TLS code: SQUID_ERR_SSL_HANDSHAKE)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12929">[ date ]</a>
              <a href="thread.html#12929">[ thread ]</a>
              <a href="subject.html#12929">[ subject ]</a>
              <a href="author.html#12929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
