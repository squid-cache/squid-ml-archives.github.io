<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Issues with authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Issues%20with%20authentication&In-Reply-To=%3C41a8d3ec-5010-e524-d124-aff896c71839%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012998.html">
   <LINK REL="Next"  HREF="012996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Issues with authentication</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Issues%20with%20authentication&In-Reply-To=%3C41a8d3ec-5010-e524-d124-aff896c71839%40treenet.co.nz%3E"
       TITLE="[squid-users] Issues with authentication">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Oct 11 06:46:30 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012998.html">[squid-users] Issues with authentication
</A></li>
        <LI>Next message (by thread): <A HREF="012996.html">[squid-users] ERROR: Cannot connect to 127.0.0.1:3128
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12999">[ date ]</a>
              <a href="thread.html#12999">[ thread ]</a>
              <a href="subject.html#12999">[ subject ]</a>
              <a href="author.html#12999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/10/2016 6:18 p.m., Joe O wrote:
&gt;<i> Thanks for the reply Amos! I started following another thread in which you were helping some one else with showing pages to / redirecting unauthenticated users
</I>&gt;<i> but still haven&#8217;t been able to get that to work either. The thread was this one <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/redirecting-unauthenticated-users-td1038146.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/redirecting-unauthenticated-users-td1038146.html</A> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/redirecting-unauthenticated-users-td1038146.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/redirecting-unauthenticated-users-td1038146.html</A>&gt;
</I>&gt;<i> I think this approach would work well for what I am doing if I could get it working :)
</I>
That thread is about having one specific URL being visited cause proxy
authentication to happen. With any unauthenticated visitors redirected
to that URL.

You are dealing with CONNECT requests. Which do not have URL, just
authority-URI and cannot be redirected.

&gt;<i> 
</I>&gt;<i> error_directory /usr/share/squid/errors/en
</I>&gt;<i> cache deny all
</I>&gt;<i> debug_options ALL,1 11,3 20,3
</I>&gt;<i> acl whitelist dstdomain .whitelist.com 127.0.0.1
</I>&gt;<i> 
</I>&gt;<i> acl localhost src 127.0.0.1/32 ::1
</I>&gt;<i> acl to_localhost dst 127.0.0.0/8 0.0.0.0/32 ::1
</I>
These ACLs should be defined by default and Squid complain about these
adding duplicate entries on startup or reconfigure. If it does not you
should upgrade to a more recent Squid.


&gt;<i> 
</I>&gt;<i> acl localnet src 127.0.0.1      # RFC1918 possible internal network
</I>

127.0.0.1 is not a possible internal network. It is localhost.

&gt;<i> acl localnet src 10.0.0.0/8
</I>&gt;<i> acl localhost src 127.0.0.1/32 ::1
</I>
You already defined locahost. Your Squid should be complaining about
this  on startup or reconfigure. If it does not you should upgrade to a
more recent Squid.

&gt;<i> 
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i> acl Safe_ports port 70          # gopher
</I>&gt;<i> acl Safe_ports port 210         # wais
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> acl Safe_ports port 280         # http-mgmt
</I>&gt;<i> acl Safe_ports port 488         # gss-http
</I>&gt;<i> acl Safe_ports port 591         # filemaker
</I>&gt;<i> acl Safe_ports port 777         # multiling http
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> 
</I>&gt;<i> http_access allow manager localhost
</I>&gt;<i> http_access deny manager
</I>&gt;<i> 
</I>
The manager rules are more efficient security when performed after the
&quot;CONNECT !SSL_ports&quot; rule.


&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> 
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> 
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> 
</I>
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012998.html">[squid-users] Issues with authentication
</A></li>
	<LI>Next message (by thread): <A HREF="012996.html">[squid-users] ERROR: Cannot connect to 127.0.0.1:3128
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12999">[ date ]</a>
              <a href="thread.html#12999">[ thread ]</a>
              <a href="subject.html#12999">[ subject ]</a>
              <a href="author.html#12999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
