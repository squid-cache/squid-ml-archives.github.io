<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_MISS/304 question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/304%20question&In-Reply-To=%3C24b8aec3-527d-0e96-2b21-439d9535f3ab%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013029.html">
   <LINK REL="Next"  HREF="013031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_MISS/304 question</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/304%20question&In-Reply-To=%3C24b8aec3-527d-0e96-2b21-439d9535f3ab%40measurement-factory.com%3E"
       TITLE="[squid-users] TCP_MISS/304 question">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct 13 18:28:46 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013029.html">[squid-users] TCP_MISS/304 question
</A></li>
        <LI>Next message (by thread): <A HREF="013031.html">[squid-users] TCP_MISS/304 question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13030">[ date ]</a>
              <a href="thread.html#13030">[ thread ]</a>
              <a href="subject.html#13030">[ subject ]</a>
              <a href="author.html#13030">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/13/2016 11:52 AM, Yuri Voinov wrote:
&gt;<i> When we seen ??????/304 with only headers - most probably content behind
</I>&gt;<i> proxy already and this is CLIENT_IMS_HIT observed.
</I>&gt;<i> 
</I>&gt;<i> Yes, of course, we don't know is this content really in client cache.
</I>&gt;<i> But this is don't care - proxy shared cache contains not modified copy
</I>&gt;<i> of content.
</I>&gt;<i> 
</I>&gt;<i> Right?
</I>
Wrong.

A 304 code sent by Squid to the client means &quot;Squid told the client that
the client has a fresh copy (or equivalent)&quot;. It does not tell us how
Squid came up with that answer, or what Squid has in its cache: We do
not know whether Squid had the corresponding entry cached when the
client request came. If Squid had that entry cached, then Squid may or
may not have tried to validate it. If Squid tried to validate, then
Squid may or may not have gotten an entry from the origin server.
Finally, we do not know whether Squid kept, replaced, or deleted the
cache entry as the result of that validation attempt.

For an extreme example, consider Squid without a cache. Such a
configuration will still have lots of /304 entries in access.log!

A single access.log line (and often even a single Squid result code on
that line!) is telling us what happened when Squid talked to the client
_and_ what happened when Squid talked to the server (if it did talk to
the server). One cannot gain that vital information from a single HTTP
status code alone.


Many folks disagree regarding the best way to structure Squid result
codes. Many also disagree regarding the best definition for &quot;cache hit&quot;.
All the different approaches make it very difficult to discuss these
matters and maintain related code. A /304 field alone means the client
got an HTTP 304 response. Whether you call that a &quot;hit&quot; from Squid point
of view depends on your definition of &quot;hit&quot; _and_ (depending on that
definition) on other factors that /304 does not reveal. For example:

* if your definition of a &quot;hit&quot; is &quot;Squid did not talk to the origin
server or peer&quot;, then /304 alone does not necessarily mean a hit.

* if your definition of a &quot;hit&quot; is &quot;Squid did not receive a large
response from the origin server or peer&quot;, then /304 alone does not
necessarily mean a hit.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013029.html">[squid-users] TCP_MISS/304 question
</A></li>
	<LI>Next message (by thread): <A HREF="013031.html">[squid-users] TCP_MISS/304 question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13030">[ date ]</a>
              <a href="thread.html#13030">[ thread ]</a>
              <a href="subject.html#13030">[ subject ]</a>
              <a href="author.html#13030">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
