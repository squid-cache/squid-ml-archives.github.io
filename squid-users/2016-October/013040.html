<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_MISS/304 question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/304%20question&In-Reply-To=%3C38b1f59b-80bc-9cf7-84b5-dcbe58e93443%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013038.html">
   <LINK REL="Next"  HREF="013043.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_MISS/304 question</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS/304%20question&In-Reply-To=%3C38b1f59b-80bc-9cf7-84b5-dcbe58e93443%40gmail.com%3E"
       TITLE="[squid-users] TCP_MISS/304 question">yvoinov at gmail.com
       </A><BR>
    <I>Fri Oct 14 11:34:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013038.html">[squid-users] TCP_MISS/304 question
</A></li>
        <LI>Next message (by thread): <A HREF="013043.html">[squid-users] TCP_MISS/304 question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13040">[ date ]</a>
              <a href="thread.html#13040">[ thread ]</a>
              <a href="subject.html#13040">[ subject ]</a>
              <a href="author.html#13040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 
A bit more details.

This is 4 transactions in chronological order. Two from wget -S and two
from same PC via browser for the same URL:

*root @ khorne /tmp # wget -S
<A HREF="http://www.gazeta.ru/nm2015/js/gazeta.media.query.js*">http://www.gazeta.ru/nm2015/js/gazeta.media.query.js*</A>
- --2016-10-14 17:18:05-- 
<A HREF="http://www.gazeta.ru/nm2015/js/gazeta.media.query.js">http://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 301 Moved Permanently
  Server: nginx
  Date: Fri, 14 Oct 2016 11:18:07 GMT
  Content-Type: text/html
  Content-Length: 178
  Location: <A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A>
  X-Cache: MISS from khorne
  X-Cache-Lookup: MISS from khorne:3128
  Connection: keep-alive
Location: <A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A> [following]
- --2016-10-14 17:18:07-- 
<A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 200 OK
  Server: nginx
  Date: Fri, 14 Oct 2016 10:45:57 GMT
  Content-Type: application/javascript; charset=windows-1251
  Last-Modified: Fri, 30 Oct 2015 12:33:38 GMT
  ETag: W/&quot;cdf370-758-52351a306ac80&quot;
  Cache-Control: max-age=3600
  Expires: Fri, 14 Oct 2016 11:45:57 GMT
  Access-Control-Allow-Origin: *
  Age: 1930
  X-Cache: HIT from khorne
  X-Cache-Lookup: HIT from khorne:3128
  Transfer-Encoding: chunked
  Connection: keep-alive
Length: unspecified [application/javascript]
Saving to: 'gazeta.media.query.js'

gazeta.media.query.     [ &lt;=&gt;               ]   1.84K  --.-KB/s    in
0s     

2016-10-14 17:18:07 (138 MB/s) - 'gazeta.media.query.js' saved [1880]

/HTTP object in cache and HIT./
*
**root @ khorne /tmp # wget -S
<A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js*">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js*</A>
- --2016-10-14 17:18:30-- 
<A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 200 OK
  Server: nginx
  Date: Fri, 14 Oct 2016 10:45:57 GMT
  Content-Type: application/javascript; charset=windows-1251
  Last-Modified: Fri, 30 Oct 2015 12:33:38 GMT
  ETag: W/&quot;cdf370-758-52351a306ac80&quot;
  Cache-Control: max-age=3600
  Expires: Fri, 14 Oct 2016 11:45:57 GMT
  Access-Control-Allow-Origin: *
  Age: 1953
  X-Cache: HIT from khorne
  X-Cache-Lookup: HIT from khorne:3128
  Transfer-Encoding: chunked
  Connection: keep-alive
Length: unspecified [application/javascript]
Saving to: 'gazeta.media.query.js.1'

gazeta.media.query.     [ &lt;=&gt;               ]   1.84K  --.-KB/s    in
0s     

2016-10-14 17:18:30 (120 MB/s) - 'gazeta.media.query.js.1' saved [1880]

/HTTPS object in cache and HIT too./

This is ok.

*Ctrl+F5 (force reload) from browser:*

1476443947.419     92 192.168.100.103 TCP_MISS/200 2323 GET
<A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A> -
HIER_DIRECT/81.19.72.0 application/javascript

MISS - it is ok too, client browser sends no-cache.

At this point we sure object in cache, right? Both in proxy cache and in
client cache (client is the same in attempt 3 and 4). Now - refresh from
browser on the same page (same session), which is equivalent of page
auto-refresh.

*F5 (refresh) from the same browser:*

1476443997.252     96 192.168.100.103 TCP_MISS/304 353 GET
<A HREF="https://www.gazeta.ru/nm2015/js/gazeta.media.query.js">https://www.gazeta.ru/nm2015/js/gazeta.media.query.js</A> -
HIER_DIRECT/81.19.72.0 -

Here is it. Object in proxy cache, in client cache, revalidation is ok -
object not changed. It must be TCP_REFRESH_UNMODIFIED, and this tag
we've got with HTTP object via browser.

/But shit! HTTPS goes TCP_MISS/304! We're expected to get
TCP_REFRESH_UNMODIFIED/304! Because this is refresh operation, we're
sure object in both caches - proxy and client, revalidation is ok, but
this marks as MISS./

Why HTTP refresh goes with TCP_REFRESH_UNMODIFIED, and the same object
via HTTPS goes with TCP_MISS? As shown above, object has no headers
preventing caching.

Is it bug or feature? Because of, when site goes under HTTPS, it will
has lower hit with the same content. It seems wrong.

Note: This is news site. There is no private headers or any other
cache-preventing headers.

14.10.2016 15:57, Yuri Voinov &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i>
</I>&gt;<i> It seems I found the root of problem.
</I>&gt;<i>
</I>&gt;<i> When cached object refreshed and goes via HTTP, it gives
</I>TCP_REFRESH_UNMODIFIED in access.log, which is correct.
&gt;<i> When the _same_ _cached_ _object_ refreshes and goes via HTTPS, it
</I>gives TCP_MISS/304 in access.log, and this is wrong.
&gt;<i>
</I>&gt;<i> It seems like bug.
</I>&gt;<i>
</I>&gt;<i> 14.10.2016 3:44, Yuri Voinov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; 14.10.2016 2:48, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; On 10/13/2016 01:44 PM, Yuri Voinov wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; However, this is nothing more than word games, Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; ... unless the definition of a hit affects your billing
</I>&gt;<i>       or your
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; interpretation of Squid documentation or the developer
</I>&gt;<i>       interpretation of
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; the code. Definitions matter! You yourself have seen
</I>&gt;<i>       their importance
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; when you showed your excellent byte hit ratio results
</I>&gt;<i>       but folks were
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; looking at the ordinary document hit ratio numbers
</I>&gt;<i>       instead.
</I>&gt;<i>
</I>&gt;<i>       &gt; Sure. But difference with TCP_HIT itself and byte hit is
</I>&gt;<i>       obvious.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; The question is -
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; can we more or less significant differences from
</I>&gt;<i>       known what hit proxy
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; code level and / or transactions which, obviously,
</I>&gt;<i>       on the proxy level,
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; we can see in its entirety.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; Sorry, I do not understand the question.
</I>&gt;<i>
</I>&gt;<i>       &gt; I want to say that on the proxy level, seeing the transaction
</I>&gt;<i>       as a
</I>&gt;<i>
</I>&gt;<i>       &gt; whole, we are able to differentiate hit or his likeness from
</I>&gt;<i>       all other
</I>&gt;<i>
</I>&gt;<i>       &gt; transactions. We see the whole session in its entirety. We
</I>&gt;<i>       see repeated
</I>&gt;<i>
</I>&gt;<i>       &gt; queries of the same client to the same resource. Accordingly,
</I>&gt;<i>       we can
</I>&gt;<i>
</I>&gt;<i>       &gt; quite clearly be judged by the behavior of the header from
</I>&gt;<i>       the client or
</I>&gt;<i>
</I>&gt;<i>       &gt; server that is happening. Correctly?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; Specifically, in this particular case. Proxy IMS settings is
</I>&gt;<i>       enabled:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; refresh_all_ims on
</I>&gt;<i>
</I>&gt;<i>       &gt; reload_into_ims on
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; On web-page level we have: periodically reload/refresh
</I>&gt;<i>       directive, which
</I>&gt;<i>
</I>&gt;<i>       &gt; is forces to check (after initially store in shared cache)
</I>&gt;<i>       freshness of
</I>&gt;<i>
</I>&gt;<i>       &gt; content.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; In this situation (and I've checked this web-page elements
</I>&gt;<i>       stored in
</I>&gt;<i>
</I>&gt;<i>       &gt; cache) TCP_MISS/304 means TCP_REFRESH_UNMODIFIED.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; So, this is HIT exactly.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; I'm not saying - literally. And in fact. Correctly?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt;&gt; Unfortunately, there are too many definitions of
</I>&gt;<i>       a &quot;hit&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; There is no many definitions of hit. We are talking
</I>&gt;<i>       about the caching
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; proxy, which is basically no different from all the
</I>&gt;<i>       other caches, and
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; subject to the same rules.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; You are oversimplifying a complex subject matter. If
</I>&gt;<i>       Squid delivers a
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; single response comprising 1000 bytes from the cache and
</I>&gt;<i>       10 bytes from
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; the origin server, is that a hit or a miss? If Squid
</I>&gt;<i>       delivers the entire
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; response from the cache but spends 10 minutes talking to
</I>&gt;<i>       the origin
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; server about that object first, is that a hit or a miss?
</I>&gt;<i>       Different
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; people will give you different answers to those
</I>&gt;<i>       questions.
</I>&gt;<i>
</I>&gt;<i>       &gt; 10 minutes a bit above TCP timeout and will be aborted, I
</I>&gt;<i>       think. So,
</I>&gt;<i>
</I>&gt;<i>       &gt; Squid's write TCP_MISS_ABORTED in access.log. :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; We have [poorly defined] byte hits, document hits,
</I>&gt;<i>       revalidation hits,
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; stale hits, partial hits, etc., etc.
</I>&gt;<i>
</I>&gt;<i>       &gt; What yes - yes. The documentation is the problem.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; If the first access does not find an object in the
</I>&gt;<i>       cache, it requests
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; from the network,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; yes
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; saves in the cache,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; or does not
</I>&gt;<i>
</I>&gt;<i>       &gt; Yes. May be or may be not. But in this case we are:
</I>&gt;<i>
</I>&gt;<i>       &gt; 1) Know about transaction history and we know the object(s)
</I>&gt;<i>       in cache.
</I>&gt;<i>
</I>&gt;<i>       &gt; 2) Proxy can easy check it, right? Just swap in object from
</I>&gt;<i>       disk in
</I>&gt;<i>
</I>&gt;<i>       &gt; memory. If this success, object in cache, so we can qualify
</I>&gt;<i>       it as HIT.
</I>&gt;<i>
</I>&gt;<i>       &gt; Otherwise, exactly MISS.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; and re-treatment or gets a hit,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; or does not
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; &quot;the object is not changed.&quot; Dot.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; or the Squid-cached object did not change but the
</I>&gt;<i>       client-cached object
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; did. Or vice versa.
</I>&gt;<i>
</I>&gt;<i>       &gt; Client-cached object gives from Squid. They (ideally) must
</I>&gt;<i>       not be the
</I>&gt;<i>
</I>&gt;<i>       &gt; different. Client cache and squid's cache operates like
</I>&gt;<i>       chain, one is
</I>&gt;<i>
</I>&gt;<i>       &gt; source for another.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; If the time in the cache
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; object lifetime expires, or a lifetime on the server
</I>&gt;<i>       timed out - the
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; object is requested again and a miss is recorded.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; * Yes, if you define a miss as &quot;contact with the origin
</I>&gt;<i>       server&quot;.
</I>&gt;<i>
</I>&gt;<i>       &gt; I want to add: &quot;contact with the origin server for get
</I>&gt;<i>       content&quot;. Not for
</I>&gt;<i>
</I>&gt;<i>       &gt; revalidation purposes. If revalidation returns &quot;Object not
</I>&gt;<i>       changed&quot; -
</I>&gt;<i>
</I>&gt;<i>       &gt; this is positive and must be qualified as HIT IMO.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; * No, if contact with the origin server is OK for a hit
</I>&gt;<i>       as long as the
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; server does not send the response _body_ back to Squid.
</I>&gt;<i>
</I>&gt;<i>       &gt; .... when revalidation true - i.e. object in shared cache not
</I>&gt;<i>       stale,
</I>&gt;<i>
</I>&gt;<i>       &gt; this is HIT. We're not interested in client browser's cache
</I>&gt;<i>       state. Only
</I>&gt;<i>
</I>&gt;<i>       &gt; shared cache matters.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; if
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; the proxy responds to the client &quot;has not changed&quot;,
</I>&gt;<i>       it means, in fact,
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; that the client has a copy of the object
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; Yes.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; and a copy of the proxy object,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; The copy in the proxy cache may be different from the
</I>&gt;<i>       copy in the client
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; cache or may not exist at all.
</I>&gt;<i>
</I>&gt;<i>       &gt; Yes. If object not exists in proxy - this is proxy MISS. If
</I>&gt;<i>       client cache
</I>&gt;<i>
</I>&gt;<i>       &gt; not contains object - client go to proxy and asks it about
</I>&gt;<i>       object. Found
</I>&gt;<i>
</I>&gt;<i>       &gt; - excellent, for client this is MISS, for proxy - HIT. If
</I>&gt;<i>       proxy also not
</I>&gt;<i>
</I>&gt;<i>       &gt; contains object - it will be MISS-MISS and loading object
</I>&gt;<i>       from origin.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; the proxy and responds to the client, performing
</I>&gt;<i>       REFRESH that the object
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt;&gt; did not change. What is this, if not hit?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; Assuming the proxy asked the origin server whether the
</I>&gt;<i>       object in the
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; client (or the proxy, depending on the circumstances)
</I>&gt;<i>       cache is fresh,
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; for many, it is
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; * a [document] miss (because there was a potentially
</I>&gt;<i>       very slow contact
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; with the origin server) or
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; * a [byte] hit (because the response body came from the
</I>&gt;<i>       Squid cache and
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; not from the origin server).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; Resisting the existence of different valid hit
</I>&gt;<i>       definitions is futile
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; IMO. State what _your_ definition is (be as precise as
</I>&gt;<i>       possible; this
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; may require several iterations) and then you may ask
</I>&gt;<i>       whether a
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; particular transaction is a hit.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; &gt; Alex.
</I>&gt;<i>
</I>&gt;<i>       &gt; I agree that there are a number of boundary cases. However,
</I>&gt;<i>       in most
</I>&gt;<i>
</I>&gt;<i>       &gt; cases we are dealing with a relatively simple chain, which
</I>&gt;<i>       should be
</I>&gt;<i>
</I>&gt;<i>       &gt; considered and, in my opinion. How is it to be regarded
</I>&gt;<i>       revalidation
</I>&gt;<i>
</I>&gt;<i>       &gt; facilities and its results? If revalidation confirms that the
</I>&gt;<i>       object is
</I>&gt;<i>
</I>&gt;<i>       &gt; not stale and not expired - it's a hit, is not it?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; If revalidation fails - object stale/expired - everything is
</I>&gt;<i>       clear and
</I>&gt;<i>
</I>&gt;<i>       &gt; there is nothing to discuss. Definitely miss.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; Well, let's say we do not know and can not know about the
</I>&gt;<i>       object in the
</I>&gt;<i>
</I>&gt;<i>       &gt; client cache. Assume also that we do not want to check -
</I>&gt;<i>       whether this
</I>&gt;<i>
</I>&gt;<i>       &gt; object is in the cache proxy. Let us assume that we do not
</I>&gt;<i>       want to spend
</I>&gt;<i>
</I>&gt;<i>       &gt; resources to figure out what happened to the object in the
</I>&gt;<i>       future, in
</I>&gt;<i>
</I>&gt;<i>       &gt; client's browser, or on proxy's disk cache. Ok. Is, in this
</I>&gt;<i>       case, would
</I>&gt;<i>
</I>&gt;<i>       &gt; not be more correct to write in log TCP_NONE/304?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; In this case, we're talking directly - &quot;We do not know, hit
</I>&gt;<i>       it or not.
</I>&gt;<i>
</I>&gt;<i>       &gt; We only know that the object has not changed since the last
</I>&gt;<i>
</I>&gt;<i>       &gt; request/revalidation. We do not want to know, and you can
</I>&gt;<i>       interpret it
</I>&gt;<i>
</I>&gt;<i>       &gt; any way you like&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt;  It would be more correct, it seems to me, than just to say -
</I>&gt;<i>
</I>&gt;<i>       &gt; &quot;TCP_MISS/304 - This is a cache miss, whatever it was not
</I>&gt;<i>       really.&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       &gt; WBR, Yuri
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJYAMKnAAoJENNXIZxhPexGLz4H/RjDMSnsVTHDHpBqksSB28jd
SbeNAv34cRd9ECGFb0kM1I7tYe4CdwBEbXWLMdDhYc4vW9AGq70Tc55d+CMl65BV
VW/vkVcDge6g4yJ1YHTZE+sb3djlTIkjurDUTo+VZ6LUXcly58IFR2DoFNTNtU6D
K0n5zfSKkYuw9TKr3tTp9hVyldDRHI3iSvBBsE70AM1iwdTTcLKg8P6i6q51MZEx
SliuJ6gWT3o05guceGspSusBL5fRdU0twUpJhcXohI4oM0JafNmhV29CYhi4t3KU
OaCDraL8ntIHzIcLMHB74Mz0vGrHXojeot+bZ8crtpsumMt9BuUDg5HZTEj3KEU=
=4K9l
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161014/3f3659be/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161014/3f3659be/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20161014/3f3659be/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20161014/3f3659be/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013038.html">[squid-users] TCP_MISS/304 question
</A></li>
	<LI>Next message (by thread): <A HREF="013043.html">[squid-users] TCP_MISS/304 question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13040">[ date ]</a>
              <a href="thread.html#13040">[ thread ]</a>
              <a href="subject.html#13040">[ subject ]</a>
              <a href="author.html#13040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
