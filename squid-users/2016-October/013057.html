<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid SMP workers crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20SMP%20workers%20crash&In-Reply-To=%3C04d101d2273f%24f265b3a0%24d7311ae0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013101.html">
   <LINK REL="Next"  HREF="013071.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid SMP workers crash</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20SMP%20workers%20crash&In-Reply-To=%3C04d101d2273f%24f265b3a0%24d7311ae0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid SMP workers crash">eliezer at ngtech.co.il
       </A><BR>
    <I>Sat Oct 15 23:57:54 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013101.html">[squid-users] Squid SMP workers crash
</A></li>
        <LI>Next message (by thread): <A HREF="013071.html">[squid-users] Squid SMP workers crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13057">[ date ]</a>
              <a href="thread.html#13057">[ thread ]</a>
              <a href="subject.html#13057">[ subject ]</a>
              <a href="author.html#13057">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

I can try to replicate the same configuration removing couple settings just to make it simpler to verify if the issue since it's similar to the next testing lab I have planned.
Can you give more detail about the OS? CentOS, Ubuntu, Other?
If it's a self compiled versions then &quot;squid -v&quot; output.
I have also seen that you are intercepting both http and https traffic, have you tried looking at the logs?

If you don't hear me from me fast enough just bump me with an email.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile+WhatsApp: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Deniz Eren
Sent: Thursday, October 13, 2016 10:53 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Squid SMP workers crash

Hi,

I'm using squid's SMP functionality to distribute requests to many
squid instances and distribute workload to multiple processors.
However while running squid's workers after a while worker processes
crash with the error below and coordinator does not start them again:
...
FATAL: Ipc::Mem::Segment::open failed to
shm_open(/squid-cf__metadata.shm): (2) No such file or directory
Squid Cache (Version 3.5.20): Terminated abnormally.
...

Does a solution exists for this problem? (permissions are OK in /dev/shm)


When everything is OK coordinator listens to http_ports/https_port and
distributes connections to workers(at least that's the conclusion I
got from looking access.logs).
[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squidbox</A> ~]# netstat -nlp|grep squid
tcp        0      0 0.0.0.0:8080                0.0.0.0:*
     LISTEN      7887/(squid-coord-1
tcp        0      0 0.0.0.0:3127                0.0.0.0:*
     LISTEN      7887/(squid-coord-1
tcp        0      0 0.0.0.0:3128                0.0.0.0:*
     LISTEN      7887/(squid-coord-1
tcp        0      0 0.0.0.0:3130                0.0.0.0:*
     LISTEN      7887/(squid-coord-1
tcp        0      0 0.0.0.0:8443                0.0.0.0:*
     LISTEN      7887/(squid-coord-1
udp        0      0 0.0.0.0:57850               0.0.0.0:*
                 7897/(squid-1)
udp        0      0 0.0.0.0:33643               0.0.0.0:*
                 7894/(squid-4)
udp        0      0 0.0.0.0:50485               0.0.0.0:*
                 7896/(squid-2)
udp        0      0 0.0.0.0:46427               0.0.0.0:*
                 7887/(squid-coord-1
udp        0      0 0.0.0.0:58938               0.0.0.0:*
                 7895/(squid-3)


Also is my way of using SMP functionality correct, since I want to
distribute all connections between workers and to listen only specific
ports?

I have attached the squid.conf.

Regards,


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013101.html">[squid-users] Squid SMP workers crash
</A></li>
	<LI>Next message (by thread): <A HREF="013071.html">[squid-users] Squid SMP workers crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13057">[ date ]</a>
              <a href="thread.html#13057">[ thread ]</a>
              <a href="subject.html#13057">[ subject ]</a>
              <a href="author.html#13057">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
