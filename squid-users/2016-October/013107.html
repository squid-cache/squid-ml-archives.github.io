<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Additional ecap/icap questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Additional%20ecap/icap%20questions&In-Reply-To=%3Cab6755dddb0c4327dae997c795fbda8c%40localhost%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013074.html">
   <LINK REL="Next"  HREF="013075.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Additional ecap/icap questions</H1>
    <B>James Lay</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Additional%20ecap/icap%20questions&In-Reply-To=%3Cab6755dddb0c4327dae997c795fbda8c%40localhost%3E"
       TITLE="[squid-users] Additional ecap/icap questions">jlay at slave-tothe-box.net
       </A><BR>
    <I>Wed Oct 19 14:13:32 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013074.html">[squid-users] Additional ecap/icap questions
</A></li>
        <LI>Next message (by thread): <A HREF="013075.html">[squid-users] Squid 3.5 conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13107">[ date ]</a>
              <a href="thread.html#13107">[ thread ]</a>
              <a href="subject.html#13107">[ subject ]</a>
              <a href="author.html#13107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2016-10-17 15:01, Alex Rousskov wrote:
&gt;<i> On 10/17/2016 11:51 AM, James Lay wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Here's what I'm wanting to accomplish and it's been proving a 
</I>&gt;&gt;<i> challenge:
</I>&gt;&gt;<i>  Detect keywords (think DLP maybe) in http/https flows.  I've got ecap
</I>&gt;&gt;<i> and icap compiled in and working.  My challenges:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> a)with icap, it appears that the filter content adapters only work 
</I>&gt;&gt;<i> with
</I>&gt;&gt;<i> responses, not requests....I need both.
</I>&gt;<i> 
</I>&gt;<i> It depends on the ICAP service. Some work with requests, some with
</I>&gt;<i> responses, some with both kinds of messages.
</I>&gt;<i> 
</I>
I'm specifically looking at 
<A HREF="http://c-icap.sourceforge.net/c-icap-modules.conf-0.4.x.html#tag_srv_content_filtering_MaxBodyData.">http://c-icap.sourceforge.net/c-icap-modules.conf-0.4.x.html#tag_srv_content_filtering_MaxBodyData.</A> 
  This looks like it will do what I need, but as from my previous posts, 
it appears it only works with RESPMOD, not requests.

&gt;&gt;<i> b)with icap, if I use the &quot;echo&quot; adapter I can see everything on the 
</I>&gt;&gt;<i> lo
</I>&gt;&gt;<i> interface, but decoding it has proven fruitless for me
</I>&gt;<i> 
</I>&gt;<i> If you are trying to manually decode ICAP traffic on a loopback
</I>&gt;<i> interface, please clarify what you are trying to accomplish with that.
</I>
I'm trying to match text in a stream, somehow.  Either with the above 
icap method, which would appear to be designed for this purpose, but 
only responses not request, or by decoding the stream and sending the 
decoded traffic to an interface where an IDS can match content.  In 
short, if someone drops an f-bomb in a chat let's say, I want it known.

&gt;<i> 
</I>&gt;&gt;<i> c)with ecap, I configured per
</I>&gt;&gt;<i> <A HREF="http://wiki.squid-cache.org/ConfigExamples/ContentAdaptation/eCAP,">http://wiki.squid-cache.org/ConfigExamples/ContentAdaptation/eCAP,</A>
</I>&gt;&gt;<i> but I'm confused on the ecap_service line..examples show
</I>&gt;&gt;<i> &quot;<A HREF="ecap://www.vigos.com/ecap_gzip">ecap://www.vigos.com/ecap_gzip</A>&quot;, but what do I put in?
</I>&gt;<i> 
</I>&gt;<i> Just like with ICAP, you configure an eCAP adapter/service that you 
</I>&gt;<i> want
</I>&gt;<i> to use. I do not know whether it exists or needs to be written. For
</I>&gt;<i> example, if you want to find viruses, you can use an eCAP ClamAV 
</I>&gt;<i> adapter.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> I thought I
</I>&gt;&gt;<i> didn't need a service for ecap..do I point this to localhost or 
</I>&gt;&gt;<i> something?
</I>&gt;<i> 
</I>&gt;<i> With eCAP, you do not need a server. With both ICAP and eCAP you need a
</I>&gt;<i> service or &quot;adapter&quot; that does whatever you want to do. ICAP and eCAP
</I>&gt;<i> are just protocols/API -- they cannot do anything useful on their own.
</I>&gt;<i> 
</I>&gt;<i> The eCAP service URI is just an identifier. It does not &quot;point&quot; to any
</I>&gt;<i> specific location. It is only used to distinguish one loaded eCAP
</I>&gt;<i> service from another loaded eCAP service.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Overall, you need some software that will &quot;detect keywords&quot;. That
</I>&gt;<i> detection is not going to happen magically on its own. ICAP and eCAP 
</I>&gt;<i> are
</I>&gt;<i> just two ways to get the HTTP messages to that software. Some call that
</I>&gt;<i> _kind_ of software &quot;ICAP service&quot;, &quot;ICAP server plugin&quot;, &quot;eCAP 
</I>&gt;<i> service&quot;,
</I>&gt;<i> &quot;eCAP adapter&quot;, etc. You need to find or write a specific
</I>&gt;<i> service/plugin/adapter/etc. that does keyword detection.
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>
Thanks Alex....I can't imagine that I'm the only one wanting to do this 
purely with open source software, but it appears that way.

James

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013074.html">[squid-users] Additional ecap/icap questions
</A></li>
	<LI>Next message (by thread): <A HREF="013075.html">[squid-users] Squid 3.5 conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13107">[ date ]</a>
              <a href="thread.html#13107">[ thread ]</a>
              <a href="subject.html#13107">[ subject ]</a>
              <a href="author.html#13107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
