<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20Google%20Chrome%0A%20googlechromestandaloneenterprise64.msi&In-Reply-To=%3C1477373709.16301.25.camel%40comnet.uz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013202.html">
   <LINK REL="Next"  HREF="013216.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi</H1>
    <B>Garri Djavadyan</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20Google%20Chrome%0A%20googlechromestandaloneenterprise64.msi&In-Reply-To=%3C1477373709.16301.25.camel%40comnet.uz%3E"
       TITLE="[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi">garryd at comnet.uz
       </A><BR>
    <I>Tue Oct 25 05:35:09 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013202.html">[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi
</A></li>
        <LI>Next message (by thread): <A HREF="013216.html">[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13215">[ date ]</a>
              <a href="thread.html#13215">[ thread ]</a>
              <a href="subject.html#13215">[ subject ]</a>
              <a href="author.html#13215">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2016-10-24 at 21:05 +0500, Garri Djavadyan wrote:
&gt;<i> On 2016-10-24 19:40, Garri Djavadyan wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So, the big G sends 304 only to HEAD requests, although it is a
</I>&gt;<i> &gt; violation [1], AIUI:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; curl --head -H 'If-Modified-Since: Thu, 20 Oct 2016 08:29:09 GMT'
</I>&gt;<i> &gt; -H
</I>&gt;<i> &gt; 'If-None-Match: &quot;101395&quot;' <A HREF="http://dl.google.com/linux/direct/google-">http://dl.google.com/linux/direct/google-</A>
</I>&gt;<i> &gt; chro
</I>&gt;<i> &gt; me-stable_current_amd64.deb
</I>&gt;<i> &gt; HTTP/1.1 304 Not Modified
</I>&gt;<i> &gt; ETag: &quot;101395&quot;
</I>&gt;<i> &gt; Server: downloads
</I>&gt;<i> &gt; Vary: *
</I>&gt;<i> &gt; X-Content-Type-Options: nosniff
</I>&gt;<i> &gt; X-Frame-Options: SAMEORIGIN
</I>&gt;<i> &gt; X-Xss-Protection: 1; mode=block
</I>&gt;<i> &gt; Date: Mon, 24 Oct 2016 14:36:32 GMT
</I>&gt;<i> &gt; Connection: keep-alive
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; ---
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; $ curl --verbose -H 'If-Modified-Since: Thu, 20 Oct 2016 08:29:09
</I>&gt;<i> &gt; GMT'
</I>&gt;<i> &gt; -H 'If-None-Match: &quot;101395&quot;' <A HREF="http://dl.google.com/linux/direct/goog">http://dl.google.com/linux/direct/goog</A>
</I>&gt;<i> &gt; le-c
</I>&gt;<i> &gt; hrome-stable_current_amd64.deb &gt; /dev/null
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; GET /linux/direct/google-chrome-stable_current_amd64.deb HTTP/1.1
</I>&gt;<i> &gt; &gt; Host: dl.google.com
</I>&gt;<i> &gt; &gt; User-Agent: curl/7.50.3
</I>&gt;<i> &gt; &gt; Accept: */*
</I>&gt;<i> &gt; &gt; If-Modified-Since: Thu, 20 Oct 2016 08:29:09 GMT
</I>&gt;<i> &gt; &gt; If-None-Match: &quot;101395&quot;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &lt; HTTP/1.1 200 OK
</I>&gt;<i> &gt; &lt; Accept-Ranges: bytes
</I>&gt;<i> &gt; &lt; Content-Type: application/x-debian-package
</I>&gt;<i> &gt; &lt; ETag: &quot;101395&quot;
</I>&gt;<i> &gt; &lt; Last-Modified: Thu, 20 Oct 2016 08:29:09 GMT
</I>&gt;<i> &gt; &lt; Server: downloads
</I>&gt;<i> &gt; &lt; Vary: *
</I>&gt;<i> &gt; &lt; X-Content-Type-Options: nosniff
</I>&gt;<i> &gt; &lt; X-Frame-Options: SAMEORIGIN
</I>&gt;<i> &gt; &lt; X-Xss-Protection: 1; mode=block
</I>&gt;<i> &gt; &lt; Date: Mon, 24 Oct 2016 14:38:19 GMT
</I>&gt;<i> &gt; &lt; Content-Length: 45532350
</I>&gt;<i> &gt; &lt; Connection: keep-alive
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; [1] <A HREF="https://tools.ietf.org/html/rfc7234#section-4.3.5">https://tools.ietf.org/html/rfc7234#section-4.3.5</A>
</I>&gt;<i> 
</I>&gt;<i> Actually I mixed SHOULD agains MUST. The RFC 7231, section 4.3.2
</I>&gt;<i> states&#160;
</I>&gt;<i> [1]:
</I>&gt;<i> ...
</I>&gt;<i> The server SHOULD send the same header fields in response to a HEAD&#160;
</I>&gt;<i> request as it would have sent if
</I>&gt;<i> the request had been a GET, except that the payload header fields&#160;
</I>&gt;<i> (Section 3.3) MAY be omitted.
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i> So, big G does not follow the recommendation, but does not violate
</I>&gt;<i> the&#160;
</I>&gt;<i> standard.
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="https://tools.ietf.org/html/rfc7231#section-4.3.2">https://tools.ietf.org/html/rfc7231#section-4.3.2</A>
</I>&gt;<i> 
</I>&gt;<i> Garri
</I>
I've overlooked that the statement applies to header _fields_, not to
reply code. The full paragraph states:

&#160; &#160;The HEAD method is identical to GET except that the server MUST NOT
&#160;&#160;&#160;send a message body in the response (i.e., the response terminates
&#160; &#160;at the end of the header section).&#160;&#160;The server SHOULD send the same
&#160;&#160;&#160;header fields in response to a HEAD request as it would have sent if
&#160;&#160;&#160;the request had been a GET, except that the payload header fields
&#160;&#160;&#160;(Section 3.3) MAY be omitted.&#160;&#160;This method can be used for obtaining
&#160;&#160;&#160;metadata about the selected representation without transferring the
&#160;&#160;&#160;representation data and is often used for testing hypertext links &#160;
&#160; &#160;for validity, accessibility, and recent modification.

Nevertheless, the last sentence in the above excerpt use word 'can',
same for the following excerpt from section 4.3.5 [1]:

&#160; &#160;A response to the HEAD method is identical to what an equivalent
&#160;&#160;&#160;request made with a GET would have been, except it lacks a body.
&#160; &#160;This property of HEAD responses can be used to invalidate or update
&#160; &#160;a cached GET response if the more efficient conditional GET request
&#160;&#160;&#160;mechanism is not available (due to no validators being present in &#160;
&#160; &#160;the stored response) or if transmission of the representation body &#160;
&#160; &#160;is not desired even if it has changed.

So, HEAD request _can_ be used as a reliable source for object
revalidation. How the 'can' should it be interpreted? RFC2119 [2] does
not specifies that.


AIUI, that exact case leaves two choices:

* Implement something like 'revalidate_using_head [[!]acl]
* Contact Google and inform about the behavior

The former is RFC-compliant way to solve that particular case, but
requires costly development efforts and may be useless after some time.
The latter may break HEAD revalidation also, but gives hopes that the
GET conditionals may be fixed.

[1]&#160;<A HREF="https://tools.ietf.org/html/rfc7234#section-4.3.5">https://tools.ietf.org/html/rfc7234#section-4.3.5</A>
[2]&#160;<A HREF="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013202.html">[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi
</A></li>
	<LI>Next message (by thread): <A HREF="013216.html">[squid-users] Caching Google Chrome googlechromestandaloneenterprise64.msi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13215">[ date ]</a>
              <a href="thread.html#13215">[ thread ]</a>
              <a href="subject.html#13215">[ subject ]</a>
              <a href="author.html#13215">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
