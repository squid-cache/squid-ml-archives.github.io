<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Connection problem when you reload in squid3.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Connection%20problem%20when%20you%20reload%20in%20squid3.4&In-Reply-To=%3C5810E990.6020602%40ltu.sld.cu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013259.html">
   <LINK REL="Next"  HREF="013260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Connection problem when you reload in squid3.4</H1>
    <B>Yurian Gonzalez</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Connection%20problem%20when%20you%20reload%20in%20squid3.4&In-Reply-To=%3C5810E990.6020602%40ltu.sld.cu%3E"
       TITLE="[squid-users] Connection problem when you reload in squid3.4">yuriang at ltu.sld.cu
       </A><BR>
    <I>Wed Oct 26 17:36:16 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013259.html">[squid-users] Problems with acltype &quot;dst&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="013260.html">[squid-users] filtering http(s) sites, transparently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13254">[ date ]</a>
              <a href="thread.html#13254">[ thread ]</a>
              <a href="subject.html#13254">[ subject ]</a>
              <a href="author.html#13254">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a problem with squid3.4:
The situation is:
I have a web application that writes into several files for example:
ip_lan.txt -&gt; IP subnet of PC LAN
     mac_lan.txt -&gt; Mac PC LAN subnet

These files are used by squid3 to allow access, so that whenever the 
application modifies these files have to do a reload to squid3 to 
recognize the new modifications.

also I use cahe_peer, internet service provider.

I can navigate normally, but when I reload, there as a connection 
outage, because what I receive from cache_peer is the following message:
--- ERROR IN THE BROWSER ------------------------------------------- 
--------------
ERROR
The requested URL could not get
the following error when trying to retrieve the URL is found: / Sports
Invalid URL
Some aspect of the requested URL is incorrect.
Some possible problems are:
Missing or incorrect access protocol (should be &quot;http: //&quot; or similar)
Missing hostname
There is an illegal double-escape on the path of the URL
There are illegal characters in the hostname; the underscore character 
(_) is not allowed.
Your cache administrator is <A HREF="https://lists.squid-cache.org/listinfo/squid-users">admin at algo.com.</A>
-------------------------------------------------- 
-------------------------------------------------- ----------
Then I do a F5, update the page and then functions, ie can browse normally.
Previously worked in the vercion 3.1 squid3 and not pass this, I could 
even make multiple reload, and this situation did not happen.

##### cache.log #####
2016/10/26 06:17:30 kid1| Reconfiguring Squid Cache (version 3.4.8)...
2016/10/26 06:17:30 kid1| Closing HTTP port [::]:3128
2016/10/26 06:17:30 kid1| Closing Pinger socket on FD 30
2016/10/26 06:17:30 kid1| Logfile: closing log 
daemon:/var/log/squid3/access.log
2016/10/26 06:17:30 kid1| Logfile Daemon: closing log 
daemon:/var/log/squid3/access.log
2016/10/26 06:17:30 kid1| Startup: Initializing Authentication Schemes ...
2016/10/26 06:17:30 kid1| Startup: Initialized Authentication Scheme 'basic'
2016/10/26 06:17:30 kid1| Startup: Initialized Authentication Scheme 
'digest'
2016/10/26 06:17:30 kid1| Startup: Initialized Authentication Scheme 
'negotiate'
2016/10/26 06:17:30 kid1| Startup: Initialized Authentication Scheme 'ntlm'
2016/10/26 06:17:30 kid1| Startup: Initialized Authentication.
2016/10/26 06:17:30 kid1| Processing Configuration File: 
/etc/squid3/squid.conf (depth 0)
2016/10/26 06:17:30 kid1| Logfile: opening log 
daemon:/var/log/squid3/access.log
2016/10/26 06:17:30 kid1| Logfile Daemon: opening log 
/var/log/squid3/access.log
2016/10/26 06:17:30 kid1| Squid plugin modules loaded: 0
2016/10/26 06:17:30 kid1| Adaptation support is off.
2016/10/26 06:17:30 kid1| Store logging disabled
2016/10/26 06:17:30 kid1| DNS Socket created at [::], FD 13
2016/10/26 06:17:30 kid1| DNS Socket created at 0.0.0.0, FD 14
2016/10/26 06:17:30 kid1| Adding nameserver 201.220.222.131 from squid.conf
2016/10/26 06:17:30 kid1| HTCP Disabled.
2016/10/26 06:17:30 kid1| Pinger socket opened on FD 19
2016/10/26 06:17:30 kid1| Configuring Parent proxy.sld.cu/3128/0
2016/10/26 06:17:30| pinger: Initialising ICMP pinger ...
2016/10/26 06:17:30| pinger: ICMP socket opened.
2016/10/26 06:17:30| pinger: ICMPv6 socket opened
2016/10/26 06:17:30 kid1| Finished loading MIME types and icons.
2016/10/26 06:17:30 kid1| Accepting HTTP Socket connections at 
local=[::]:3128 remote=[::] FD 15 flags=9
2016/10/26 06:17:40| Pinger exiting.

##### squid.conf (minimum configuration) ######
acl ucm_net src 192.168.1.0/24    # LOCALNET
acl SSL_ports port 443
acl Safe_ports port 80        # http
acl Safe_ports port 21        # ftp
acl Safe_ports port 443        # https
acl Safe_ports port 70        # gopher
acl Safe_ports port 210        # wais
acl Safe_ports port 1025-65535    # unregistered ports
acl Safe_ports port 280        # http-mgmt
acl Safe_ports port 488        # gss-http
acl Safe_ports port 591        # filemaker
acl Safe_ports port 777        # multiling http
acl CONNECT method CONNECT
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access allow localhost
http_access allow ucm_net
http_access deny all
http_port 3128
cache_peer proxy.enet.com parent 3128 0 no-query no-digest default
cache_peer_domain proxy.enet.com !.enet.com
hierarchy_stoplist cgi-bin ?
never_direct allow all
prefer_direct off
cache_log /var/log/squid3/cache.log
debug_options ALL,1
coredump_dir /var/spool/squid3
refresh_pattern ^ftp:        1440    20%    10080
refresh_pattern ^gopher:    1440    0%    1440
refresh_pattern -i (/cgi-bin/|\?) 0    0%    0
refresh_pattern .        0    20%    4320
dns_nameservers 201.200.200.201
#############################################
This configuration is practically the default brings the squid3.4.8, to 
Nonstop an ACL, the cache_peer and dns_nameservers.
I've tried reinstalling the server, only install squid and no other 
pakete, besides setting is minimal.
---------------------------------------------------------------
Please appreciate if someone could help me.
this is my email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">yuriang at ltu.sld.cu.</A>


--
Este mensaje le ha llegado mediante el servicio de correo electronico que ofrece Infomed para respaldar el cumplimiento de las misiones del Sistema Nacional de Salud. La persona que envia este correo asume el compromiso de usar el servicio a tales fines y cumplir con las regulaciones establecidas

Infomed: <A HREF="http://www.sld.cu/">http://www.sld.cu/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013259.html">[squid-users] Problems with acltype &quot;dst&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="013260.html">[squid-users] filtering http(s) sites, transparently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13254">[ date ]</a>
              <a href="thread.html#13254">[ thread ]</a>
              <a href="subject.html#13254">[ subject ]</a>
              <a href="author.html#13254">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
