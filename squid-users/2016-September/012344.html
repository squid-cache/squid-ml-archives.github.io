<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] More host header forgery pain with peek/splice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20More%20host%20header%20forgery%20pain%20with%20peek/splice&In-Reply-To=%3Cb1fde5e0-7725-7264-4039-17f34cf7e6fb%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012343.html">
   <LINK REL="Next"  HREF="012346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] More host header forgery pain with peek/splice</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20More%20host%20header%20forgery%20pain%20with%20peek/splice&In-Reply-To=%3Cb1fde5e0-7725-7264-4039-17f34cf7e6fb%40treenet.co.nz%3E"
       TITLE="[squid-users] More host header forgery pain with peek/splice">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Sep  4 16:12:21 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012343.html">[squid-users] Acl to deny all sites, and allow some sites
</A></li>
        <LI>Next message (by thread): <A HREF="012346.html">[squid-users] More host header forgery pain with peek/splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12344">[ date ]</a>
              <a href="thread.html#12344">[ thread ]</a>
              <a href="subject.html#12344">[ subject ]</a>
              <a href="author.html#12344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 31/08/2016 5:25 a.m., Marcus Kool wrote:
&gt;<i> Do I understand it correctly that Squid in normal proxy mode
</I>&gt;<i> allows malware to do a CONNECT to any destination, while in
</I>&gt;<i> transparent proxy mode does extra security checks which causes
</I>&gt;<i> some regular (non-malware) clients to fail?
</I>

Intercepted traffic has different processing applied, different
assumptions made about the traffic, and different security model
relevant to its messages.

The short answer is &quot;yes&quot;, but reality is not that simple black/white.


&gt;<i> 
</I>&gt;<i> And philosophical questions: is Squid the right tool
</I>&gt;<i> to stop malware?  If yes, is it acceptable that connections
</I>&gt;<i> of regular (non-malware) clients are wrongly dropped?
</I>
No more or less than any software.

Squid manages the HTTP that flows through it. If the malware uses HTTP
messages to communicate then it very much part of Squid's job to prevent
that. Other protocols Squid is not responsible for, except to prevent
itself being a vector of attack.

&gt;<i> 
</I>&gt;<i> IMO Squid should do all it can to be a secure proxy.
</I>
Which is the case for Host forgery atacks. If Squid did not MITM the
network traffic, there would not be a vulnerability to Host forgery
issues. Therefore an intercept/tproxy Squid is very much responsible for
preventing this particular type of attack which it causes to exist.

A forward-proxy or reverse-proxy does not have that vulnerability,
therefore does not need to check the same things.


&gt;<i> Doing security checks on connections in an attempt
</I>&gt;<i> to stop malware sounds like a job for an antivirus / IDS tool.
</I>&gt;<i> 
</I>
Additional to what Squid does. Indeed many of those tools use a proxy
service which performs the same or similar checks to what Squid does,
with far more intrusive behaviour, or are themselves also vulnerable to
becoming vectors of the Host attack(s). The Host attack(s) are
vulnerability built into the concept of MITM'ing HTTP(S) traffic. It is
not something specific to Squid.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012343.html">[squid-users] Acl to deny all sites, and allow some sites
</A></li>
	<LI>Next message (by thread): <A HREF="012346.html">[squid-users] More host header forgery pain with peek/splice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12344">[ date ]</a>
              <a href="thread.html#12344">[ thread ]</a>
              <a href="subject.html#12344">[ subject ]</a>
              <a href="author.html#12344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
