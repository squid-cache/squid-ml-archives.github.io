<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] windows update not working squid 3.5.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20windows%20update%20not%20working%20squid%203.5.2&In-Reply-To=%3C763AFEA6-52DE-4DCB-805D-DA1136933178%40netstream.ps%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012402.html">
   <LINK REL="Next"  HREF="012371.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] windows update not working squid 3.5.2</H1>
    <B>--Ahmad--</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20windows%20update%20not%20working%20squid%203.5.2&In-Reply-To=%3C763AFEA6-52DE-4DCB-805D-DA1136933178%40netstream.ps%3E"
       TITLE="[squid-users] windows update not working squid 3.5.2">ahmed.zaeem at netstream.ps
       </A><BR>
    <I>Tue Sep  6 14:59:36 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012402.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
        <LI>Next message (by thread): <A HREF="012371.html">[squid-users] windows update not working squid 3.5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12370">[ date ]</a>
              <a href="thread.html#12370">[ thread ]</a>
              <a href="subject.html#12370">[ subject ]</a>
              <a href="author.html#12370">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi squid users .

I&#8217;m trying to catch windows updates as cached object 
im testing with  windows 10 pc

i see all request as tcp_miss and the caching store is not getting increase .

=========
1473173748.014   3603 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.022  12146 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.057   5321 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.155   3684 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.355   4832 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.612  12645 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.650   7276 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.720  12654 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173748.816   5064 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.022   4159 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.048   5618 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.177   7817 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.208   3383 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.318   5096 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.395   3986 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173749.850  13837 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173750.015    914 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173750.029   1365 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream
1473173750.420   7126 192.168.0.10 TCP_MISS/206 1049229 GET <A HREF="http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf">http://fg.v4.download.windowsupdate.com/d/msdownload/update/software/crup/2016/08/windows10.0-kb3176938-x64_6e080b0ebebeb8a463a297f5b14fcd03690eb1b8.psf</A> - ORIGINAL_DST/13.107.4.50 application/octet-stream

=======================

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# du -sh /var/cache/squid/
17M     /var/cache/squid/
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# 

==============
here is squid config :

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# cat /etc/squid/squid.conf
#########
acl windowsupdate dstdomain windowsupdate.microsoft.com
acl windowsupdate dstdomain .update.microsoft.com
acl windowsupdate dstdomain download.windowsupdate.com
acl windowsupdate dstdomain redir.metaservices.microsoft.com
acl windowsupdate dstdomain images.metaservices.microsoft.com
acl windowsupdate dstdomain c.microsoft.com
acl windowsupdate dstdomain www.download.windowsupdate.com
acl windowsupdate dstdomain wustat.windows.com
acl windowsupdate dstdomain crl.microsoft.com
acl windowsupdate dstdomain sls.microsoft.com
acl windowsupdate dstdomain productactivation.one.microsoft.com
acl windowsupdate dstdomain ntservicepack.microsoft.com

acl CONNECT method CONNECT
acl wuCONNECT dstdomain www.update.microsoft.com
acl wuCONNECT dstdomain sls.microsoft.com

#######################
refresh_pattern -i microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200 reload-into-ims
refresh_pattern -i windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200 reload-into-ims
refresh_pattern -i windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200 reload-into-ims
# DONT MODIFY THESE LINES
refresh_pattern \^ftp:           1440    20%     10080
refresh_pattern \^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320
#################################################################
###########################
#
# Recommended minimum configuration:
#

# Example rule allowing access from your local networks.
# Adapt to list your (internal) IP networks from where browsing
# should be allowed
acl localnet src 10.0.0.0/8     # RFC1918 possible internal network
acl localnet src 172.16.0.0/12  # RFC1918 possible internal network
acl localnet src 192.168.0.0/16 # RFC1918 possible internal network
acl localnet src fc00::/7       # RFC 4193 local private network range
acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged) machines

acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl CONNECT method CONNECT


http_access allow CONNECT wuCONNECT localnet
http_access allow windowsupdate localnet
http_access deny !Safe_ports

# Deny CONNECT to other than secure SSL ports
http_access deny CONNECT !SSL_ports

# Only allow cachemgr access from localhost
http_access allow localhost manager
http_access deny manager


http_access allow localnet
http_access allow localhost

# And finally deny all other access to this proxy
http_access deny all

# Squid normally listens to port 3128
http_port 192.168.0.1:3128

# Uncomment and adjust the following to add a disk cache directory.
cache_dir ufs /var/cache/squid 100 16 256

# Leave coredumps in the first cache dir
coredump_dir /var/cache/squid


#############
range_offset_limit 200 MB windowsupdate
maximum_object_size 200 MB
quick_abort_min -1
#########
http_port 3129 intercept
maximum_object_size 200000 KB




thank you 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012402.html">[squid-users] Windows Updates a Caching Stub zone,	A windows updates store.
</A></li>
	<LI>Next message (by thread): <A HREF="012371.html">[squid-users] windows update not working squid 3.5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12370">[ date ]</a>
              <a href="thread.html#12370">[ thread ]</a>
              <a href="subject.html#12370">[ subject ]</a>
              <a href="author.html#12370">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
