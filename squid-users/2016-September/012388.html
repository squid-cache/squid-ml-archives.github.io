<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] windows update not working squid 3.5.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20windows%20update%20not%20working%20squid%203.5.2&In-Reply-To=%3Cvmime.57cfd7da.1000.3ad64af64ad35c7a%40ms249-lin-003.rotterdam.bazuin.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012382.html">
   <LINK REL="Next"  HREF="012390.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] windows update not working squid 3.5.2</H1>
    <B>L.P.H. van Belle</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20windows%20update%20not%20working%20squid%203.5.2&In-Reply-To=%3Cvmime.57cfd7da.1000.3ad64af64ad35c7a%40ms249-lin-003.rotterdam.bazuin.nl%3E"
       TITLE="[squid-users] windows update not working squid 3.5.2">belle at bazuin.nl
       </A><BR>
    <I>Wed Sep  7 09:03:22 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012382.html">[squid-users] windows update not working squid 3.5.2
</A></li>
        <LI>Next message (by thread): <A HREF="012390.html">[squid-users] windows update not working squid 3.5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12388">[ date ]</a>
              <a href="thread.html#12388">[ thread ]</a>
              <a href="subject.html#12388">[ subject ]</a>
              <a href="author.html#12388">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hai, 

&#160;

Change this part : 

#############

range_offset_limit 5 Gb windowsupdate

maximum_object_size 5 Gb

quick_abort_min -1

#########

&#160;

To 

&#160;

range_offset_limit 0

quick_abort_min 0 KB

quick_abort_max 0 KB

quick_abort_pct 90

&#160;

and see what happens. 

&#160;

&#160;

Greetz, 

&#160;

Louis

&#160;

&#160;

&#160;

&#160;

&#160;


Van: --Ahmad-- [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ahmed.zaeem at netstream.ps</A>] 
Verzonden: woensdag 7 september 2016 9:40
Aan: L.P.H. van Belle
CC: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A>
Onderwerp: Re: [squid-users] windows update not working squid 3.5.2


&#160;

thanks for reply&#160;

&#160;


but i still &#160;don&#8217;t see even the hdd drive getting increasing when windows updates go on !!!!


&#160;


i tested it on windows 7&#160;


&#160;


i never seen TCP_HIT and &#160;the hdd size still the same !!!


&#160;


&#160;


here is again my &#160;squid.conf in final form on my server :


&#160;


<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at raspberrypi</A>:~# cat /etc/squid/squid.conf


#########


acl windowsupdate dstdomain windowsupdate.microsoft.com


acl windowsupdate dstdomain .update.microsoft.com


acl windowsupdate dstdomain download.windowsupdate.com


acl windowsupdate dstdomain redir.metaservices.microsoft.com


acl windowsupdate dstdomain images.metaservices.microsoft.com


acl windowsupdate dstdomain c.microsoft.com


acl windowsupdate dstdomain www.download.windowsupdate.com


acl windowsupdate dstdomain wustat.windows.com


acl windowsupdate dstdomain crl.microsoft.com


acl windowsupdate dstdomain sls.microsoft.com


acl windowsupdate dstdomain productactivation.one.microsoft.com


acl windowsupdate dstdomain ntservicepack.microsoft.com


acl windowsupdate dstdomain au.download.windowsupdate.com


acl windowsupdate dstdomain ds.download.windowsupdate.com


acl windowsupdate dstdomain ctldl.windowsupdate.com


acl windowsupdate dstdomain .data.microsoft.com


acl windowsupdate dstdomain .l.windowsupdate.com


acl windowsupdate dstdomain .microsoft.com.akadns.net


acl windowsupdate dstdomain .deploy.akamaitechnologies.com


###################################################&#160;


acl CONNECT method CONNECT


acl wuCONNECT dstdomain www.update.microsoft.com


acl wuCONNECT dstdomain sls.microsoft.com


####################################


refresh_pattern -i windowsupdate.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


refresh_pattern -i microsoft.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


refresh_pattern -i windows.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


refresh_pattern -i microsoft.com.akadns.net/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


refresh_pattern -i deploy.akamaitechnologies.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


########################################################


refresh_pattern \^ftp: &#160; &#160; &#160; &#160; &#160; 1440 &#160; &#160;20% &#160; &#160; 10080


refresh_pattern \^gopher: &#160; &#160; &#160; &#160;1440 &#160; &#160;0% &#160; &#160; &#160;1440


refresh_pattern -i (/cgi-bin/|\?) 0 &#160; &#160; 0% &#160; &#160; &#160;0


refresh_pattern . &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0 &#160; &#160; &#160; 20% &#160; &#160; 4320


########################################################


acl localnet src 10.0.0.0/8 &#160; &#160; # RFC1918 possible internal network


acl localnet src 172.16.0.0/12 &#160;# RFC1918 possible internal network


acl localnet src 192.168.0.0/16 # RFC1918 possible internal network


acl localnet src fc00::/7 &#160; &#160; &#160; # RFC 4193 local private network range


acl localnet src fe80::/10 &#160; &#160; &#160;# RFC 4291 link-local (directly plugged) machines


&#160;


acl SSL_ports port 443


acl Safe_ports port 80 &#160; &#160; &#160; &#160; &#160;# http


acl Safe_ports port 21 &#160; &#160; &#160; &#160; &#160;# ftp


acl Safe_ports port 443 &#160; &#160; &#160; &#160; # https


acl Safe_ports port 70 &#160; &#160; &#160; &#160; &#160;# gopher


acl Safe_ports port 210 &#160; &#160; &#160; &#160; # wais


acl Safe_ports port 1025-65535 &#160;# unregistered ports


acl Safe_ports port 280 &#160; &#160; &#160; &#160; # http-mgmt


acl Safe_ports port 488 &#160; &#160; &#160; &#160; # gss-http


acl Safe_ports port 591 &#160; &#160; &#160; &#160; # filemaker


acl Safe_ports port 777 &#160; &#160; &#160; &#160; # multiling http


acl CONNECT method CONNECT


&#160;


#


# Recommended minimum Access Permission configuration:


#


# Deny requests to certain unsafe ports


http_access allow CONNECT wuCONNECT localnet


http_access allow windowsupdate localnet


http_access deny !Safe_ports


&#160;


# Deny CONNECT to other than secure SSL ports


http_access deny CONNECT !SSL_ports


&#160;


# Only allow cachemgr access from localhost


http_access allow localhost manager


http_access deny manager


&#160;


# We strongly recommend the following be uncommented to protect innocent


# web applications running on the proxy server who think the only


# one who can access services on &quot;localhost&quot; is a local user


#http_access deny to_localhost


&#160;


#


# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS


#


&#160;


# Example rule allowing access from your local networks.


# Adapt localnet in the ACL section to list your (internal) IP networks


# from where browsing should be allowed


http_access allow localnet


http_access allow localhost


&#160;


# And finally deny all other access to this proxy


http_access deny all


&#160;


# Squid normally listens to port 3128


http_port 192.168.0.1:3128


&#160;


# Uncomment and adjust the following to add a disk cache directory.


cache_dir ufs /var/cache/squid 20000 16 256


&#160;


# Leave coredumps in the first cache dir


coredump_dir /var/cache/squid


&#160;


#


# Add any of your own refresh_pattern entries above these.


#


#refresh_pattern ^ftp: &#160; &#160; &#160; &#160; &#160;1440 &#160; &#160;20% &#160; &#160; 10080


#refresh_pattern ^gopher: &#160; &#160; &#160; 1440 &#160; &#160;0% &#160; &#160; &#160;1440


#refresh_pattern -i (/cgi-bin/|\?) 0 &#160; &#160;0% &#160; &#160; &#160;0


#refresh_pattern . &#160; &#160; &#160; &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; 20% &#160; &#160; 4320


#############


range_offset_limit 5 Gb windowsupdate


maximum_object_size 5 Gb


quick_abort_min -1


#########


http_port 3129 intercept


#####################


&#160;


&#160;


&#160;


&#160;


&#160;


any other suggestions ???


&#160;


&#160;


&#160;


kind regards


On Sep 7, 2016, at 10:32 AM, L.P.H. van Belle &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">belle at bazuin.nl</A>&gt; wrote:


&#160;

acl windowsupdate dstdomain&#160;au.download.windowsupdate.com


acl windowsupdate dstdomain&#160;ds.download.windowsupdate.com


acl windowsupdate dstdomain&#160;ctldl.windowsupdate.com


acl windowsupdate dstdomain .data.microsoft.com


acl windowsupdate dstdomain .l.windowsupdate.com


acl windowsupdate dstdomain .microsoft.com.akadns.net


acl windowsupdate dstdomain .deploy.akamaitechnologies.com


&#160;


and add this one to your refresh.


refresh_pattern -i&#160;deploy.akamaitechnologies.com/.*\.(cab|exe|ms[i|u|f|p]|[ap]sf|wm[v|a]|dat|zip|psf) 43200 80% 129600 reload-into-ims


&#160;




&#160;



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160907/c4c07ec0/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160907/c4c07ec0/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012382.html">[squid-users] windows update not working squid 3.5.2
</A></li>
	<LI>Next message (by thread): <A HREF="012390.html">[squid-users] windows update not working squid 3.5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12388">[ date ]</a>
              <a href="thread.html#12388">[ thread ]</a>
              <a href="subject.html#12388">[ subject ]</a>
              <a href="author.html#12388">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
