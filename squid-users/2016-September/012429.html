<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Web Whatsapp, Dropbox... problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Web%20Whatsapp%2C%20Dropbox...%20problem&In-Reply-To=%3C005d01d20a0e%2443dea3d0%24cb9beb70%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012758.html">
   <LINK REL="Next"  HREF="012313.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Web Whatsapp, Dropbox... problem</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Web%20Whatsapp%2C%20Dropbox...%20problem&In-Reply-To=%3C005d01d20a0e%2443dea3d0%24cb9beb70%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Web Whatsapp, Dropbox... problem">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Sep  8 20:19:13 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012758.html">[squid-users] Web Whatsapp, Dropbox... problem
</A></li>
        <LI>Next message (by thread): <A HREF="012313.html">[squid-users] Web Whatsapp, Dropbox... problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12429">[ date ]</a>
              <a href="thread.html#12429">[ thread ]</a>
              <a href="subject.html#12429">[ subject ]</a>
              <a href="author.html#12429">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Can it be verified using some kind of dumps?

The issues is that if I will try to access <A HREF="https://web.whatsapp.com/">https://web.whatsapp.com/</A> it will probably won't work despite to the fact that I have or do not have a certificate.

&gt;<i>From my eyes it's not a certificate issue but rather a websocket one.
</I>
The simplest way to see it would be using this firefox dump:

curl &quot;<A HREF="https://w1.web.whatsapp.com/ws">https://w1.web.whatsapp.com/ws</A>&quot; -H &quot;Host: w1.web.whatsapp.com&quot; -H &quot;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0&quot; -H &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot; -H &quot;Accept-Language: en-US,he;q=0.7,en;q=0.3&quot; --compressed -H &quot;Sec-WebSocket-Version: 13&quot; -H &quot;Origin: <A HREF="https://web.whatsapp.com">https://web.whatsapp.com</A>&quot; -H &quot;Sec-WebSocket-Extensions: permessage-deflate&quot; -H &quot;Sec-WebSocket-Key: 323TCNi3BxG0LJ+nTi2V1g==&quot; -H &quot;Connection: keep-alive, Upgrade&quot; -H &quot;Pragma: no-cache&quot; -H &quot;Cache-Control: no-cache&quot; -H &quot;Upgrade: websocket&quot;

 

I believe that we can somehow make sure how it will be secure &quot;enough&quot; to mangle the response headers and change any Connection into a &quot;close&quot; one and then splice the client and the server.

It's not safe for many systems but when the sysadmins are using whatsapp to send internal messages it would be ridicules to restrict the network users for these apps.

But in the other hand maybe the sysadmins are smart and the other users are not enough so I am not sure what would be the best option.

For this case a configuration would be appropriate.

 

Eliezer

 

----

 &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt; Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



 

From: Chico Venancio [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">chicocvenancio at gmail.com</A>] 
Sent: Thursday, September 8, 2016 11:05 PM
To: Eliezer Croitoru
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Web Whatsapp, Dropbox... problem

 

We had that trouble with whatsapp web. We simply put it in the splice rule. It seems whatsapp checks the client certificate. 

Chico Venancio 

 

Em 08/09/2016 16:09, &quot;Eliezer Croitoru&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt; &gt; escreveu:

Hey,

Can I reproduce this by just entering the url in chrome\chromium\firefox\Internet Exploere\Edge\other?
I am testing Squid 4 but it's moving slow compared to what I could in the past.
I have a squid 4 up and running and I will try to see if I can reproduce it.
Can you provide more details about the squid.conf?

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261 &lt;tel:%2B972-5-28704261&gt; 
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt; 


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; ] On Behalf Of erdosain9
Sent: Thursday, September 8, 2016 3:38 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 
Subject: Re: [squid-users] Web Whatsapp, Dropbox... problem

Finally i update to squid 3.5 and try the acl with dstdomain


Craddock, Tommy wrote
&gt;<i> Hello,
</I>&gt;<i> Create an ACL that will be a list of domains, either in the ACL or in
</I>&gt;<i> a txt file that the ACL refers to, and place any URLs you want
</I>&gt;<i> bypassed by the proxy into the ACL.  Something like this:
</I>&gt;<i> ACL Section of your squid.conf:
</I>&gt;<i> acl bypass_dst_dom  dstdomain &quot;/etc/squid/bypass_dst_domain.txt&quot;
</I>&gt;<i> Then in the http_access section:
</I>&gt;<i> http_access allow bypass_dst_dom
</I>
But dosent work....  the web keep loading &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/n4679426/Captura_de_pantalla_de_2016-09-08_09-40-14.png">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/n4679426/Captura_de_pantalla_de_2016-09-08_09-40-14.png</A>&gt;




--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Web-Whatsapp-Dropbox-problem-tp4679299p4679426.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Web-Whatsapp-Dropbox-problem-tp4679299p4679426.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160908/8d05c243/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160908/8d05c243/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 11308 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160908/8d05c243/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160908/8d05c243/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012758.html">[squid-users] Web Whatsapp, Dropbox... problem
</A></li>
	<LI>Next message (by thread): <A HREF="012313.html">[squid-users] Web Whatsapp, Dropbox... problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12429">[ date ]</a>
              <a href="thread.html#12429">[ thread ]</a>
              <a href="subject.html#12429">[ subject ]</a>
              <a href="author.html#12429">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
