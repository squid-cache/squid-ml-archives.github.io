<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] caching store increase then decrease during caching windows updates and all request are TCP_MISS ??!!!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20caching%20store%20increase%20then%20decrease%20during%0A%20caching%20windows%20updates%20and%20all%20request%20are%20TCP_MISS%20%3F%3F%21%21%21&In-Reply-To=%3C5ba94d28-710f-39eb-83a4-d265fa6df96e%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012464.html">
   <LINK REL="Next"  HREF="012468.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] caching store increase then decrease during caching windows updates and all request are TCP_MISS ??!!!</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20caching%20store%20increase%20then%20decrease%20during%0A%20caching%20windows%20updates%20and%20all%20request%20are%20TCP_MISS%20%3F%3F%21%21%21&In-Reply-To=%3C5ba94d28-710f-39eb-83a4-d265fa6df96e%40treenet.co.nz%3E"
       TITLE="[squid-users] caching store increase then decrease during caching windows updates and all request are TCP_MISS ??!!!">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Sep 13 03:04:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012464.html">[squid-users] caching store increase then decrease during	caching windows updates and all request are TCP_MISS ??!!!
</A></li>
        <LI>Next message (by thread): <A HREF="012468.html">[squid-users] caching store increase then decrease during	caching windows updates and all request are TCP_MISS ??!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12465">[ date ]</a>
              <a href="thread.html#12465">[ thread ]</a>
              <a href="subject.html#12465">[ subject ]</a>
              <a href="author.html#12465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/09/2016 8:26 a.m., --Ahmad-- wrote:
&gt;<i> amos thank you so much for reply 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> how can i correct the patterns below ?
</I>&gt;<i> 
</I>
Remove the ([^.]+.)? and ([^.]+.|) parts.

Replace the . where you want to match a '.' with \.


&gt;<i> 
</I>&gt;<i> im not sure if the other patterns are doing the game 
</I>&gt;<i> 
</I>&gt;<i> but so far i don&#8217;t have disk increasing at all
</I>&gt;<i> 
</I>&gt;<i> only  the disk start increase when only i add :
</I>&gt;&gt;&gt;<i> refresh_pattern ([^.]+.)?(download|(windows)?update).(microsoft.)?com/.*.(cab|exe|msi|msp|psf) 4320 100% 43200 reload-into-ims
</I>&gt;&gt;&gt;<i> refresh_pattern ([^.]+.|)(download|adcdownload).(apple.|)com/.*.(pkg|dmg) 4320 100% 43200 reload-into-ins
</I>&gt;<i> 
</I>&gt;<i> but  i still don&#8217;t have HITs 
</I>&gt;<i> 
</I>
You have many CLIENT_REFRESH/20x. Which means cached content was found,
but the client required it to be refreshed. When revalidated the server
returned an entire new object.

With the above refresh_rattern, the client may have required the cached
data to be reloaded (Cache-Control:max-age=0) and the reload-into-ims
converted it to a CLIENT_REFRESH from a MISS.


&gt;<i> im not sure where should i tune ?
</I>
There is not much you can do when the server returns whole objects in
response to revalidation requests.

The client is requiring that only the latest copy be used, and the
server is insisting that the object has changed.

Since this is an OS update process it is exremely unsafe to make
assumptions yourself about anything being differently cacheable than
what the server is insisting. It is entirely possible that each response
is encrypted and hashed independently - so actually is different.


&gt;<i> 
</I>&gt;<i> i also added stip query terms to off
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> not sure  what should i do next &#8230;&#8230;. all i need is windows updates go ok , I&#8217;m not interested with other caching 
</I>&gt;<i> 
</I>
With query-terms in the access.log you can better see what requests
should be MISS and which ones have a chance of being HITs (or near-HITs).

Once you can tell which requests actually should be HIT-able you can
then look at the messages going through (in cache.log with debug_options
11,2) for those requests to see what else might be done.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012464.html">[squid-users] caching store increase then decrease during	caching windows updates and all request are TCP_MISS ??!!!
</A></li>
	<LI>Next message (by thread): <A HREF="012468.html">[squid-users] caching store increase then decrease during	caching windows updates and all request are TCP_MISS ??!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12465">[ date ]</a>
              <a href="thread.html#12465">[ thread ]</a>
              <a href="subject.html#12465">[ subject ]</a>
              <a href="author.html#12465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
