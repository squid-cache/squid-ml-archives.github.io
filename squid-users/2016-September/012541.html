<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] c-icap load balancing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20c-icap%20load%20balancing&In-Reply-To=%3CDB6PR0401MB2680ABCEE19ECE7D19A66F5F8FF30%40DB6PR0401MB2680.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012540.html">
   <LINK REL="Next"  HREF="012576.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] c-icap load balancing</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20c-icap%20load%20balancing&In-Reply-To=%3CDB6PR0401MB2680ABCEE19ECE7D19A66F5F8FF30%40DB6PR0401MB2680.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] c-icap load balancing">rafael.akchurin at diladele.com
       </A><BR>
    <I>Fri Sep 16 08:28:03 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012540.html">[squid-users] c-icap load balancing
</A></li>
        <LI>Next message (by thread): <A HREF="012576.html">[squid-users] c-icap load balancing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12541">[ date ]</a>
              <a href="thread.html#12541">[ thread ]</a>
              <a href="subject.html#12541">[ subject ]</a>
              <a href="author.html#12541">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Yanghe,
Why not to setup HAproxy in front of your ICAP instances?
ICAP is relatively easily can be load balanced by HAProxy.
We have it in place up and running.

Best regards,

Rafael Akchurin

Diladele B.V.

<A HREF="http://www.quintolabs.com">http://www.quintolabs.com</A>

<A HREF="http://www.diladele.com">http://www.diladele.com</A>



--

Please take a look at Web Safety - our ICAP based web filter server for Squid proxy.



From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of yanghe
Sent: Friday, September 16, 2016 10:19 AM
To: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
Subject: Re: [squid-users] c-icap load balancing

On 09/14/2016 09:51 PM,  wrote: &quot;Alex Rousskov&quot;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;
&gt;<i> Unfortunately, Squid does not support true load
</I>&gt;<i> However, there is a workaround: Use
</I>
Thanks for your adivice.
IF I do not use adaptation_service_set or adaptation_service_chain to list N c-icap services.the traffic will only go to the first.
Get your advice.I tried configure the &quot;random&quot; ACLs,But,It is not successful
Here is my squid.conf
balance_on_multiple_ip on
acl halfpercent random 0.5
tcp_outgoing_address 192.168.1.4 halfpercent
tcp_outgoing_address 192.168.1.2

icap_service service_req reqmod_precache bypass=0 <A HREF="icap://192.168.1.4:1344/echo">icap://192.168.1.4:1344/echo</A>
adaptation_access service_req allow all
icap_service service_req_two reqmod_precache bypass=0 <A HREF="icap://192.168.1.2:1344/echo">icap://192.168.1.2:1344/echo</A>
adaptation_access service_req_two allow all
This is mistake in cache.log
&quot;commBind: Cannot bind socket FD 18 to 192.168.1.2: (99) Cannot assign requested address&quot;
&quot;commBind: Cannot bind socket FD 18 to 192.168.1.4: (99) Cannot assign requested address&quot;

That's why
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160916/4f5d8156/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160916/4f5d8156/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012540.html">[squid-users] c-icap load balancing
</A></li>
	<LI>Next message (by thread): <A HREF="012576.html">[squid-users] c-icap load balancing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12541">[ date ]</a>
              <a href="thread.html#12541">[ thread ]</a>
              <a href="subject.html#12541">[ subject ]</a>
              <a href="author.html#12541">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
