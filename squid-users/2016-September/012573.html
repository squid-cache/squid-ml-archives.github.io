<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid kid/SMP limitation like 1024 ips/opened sessions ?????
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20kid/SMP%20limitation%20like%201024%20ips/opened%0A%20sessions%20%3F%3F%3F%3F%3F&In-Reply-To=%3Ce2f330d8-8232-65f2-4bef-06abbe8de773%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012570.html">
   <LINK REL="Next"  HREF="012574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid kid/SMP limitation like 1024 ips/opened sessions ?????</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20kid/SMP%20limitation%20like%201024%20ips/opened%0A%20sessions%20%3F%3F%3F%3F%3F&In-Reply-To=%3Ce2f330d8-8232-65f2-4bef-06abbe8de773%40treenet.co.nz%3E"
       TITLE="[squid-users] squid kid/SMP limitation like 1024 ips/opened sessions ?????">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Sep 18 08:49:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012570.html">[squid-users] squid kid/SMP limitation like 1024 ips/opened	sessions ?????
</A></li>
        <LI>Next message (by thread): <A HREF="012574.html">[squid-users] squid kid/SMP limitation like 1024 ips/opened	sessions ?????
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12573">[ date ]</a>
              <a href="thread.html#12573">[ thread ]</a>
              <a href="subject.html#12573">[ subject ]</a>
              <a href="author.html#12573">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/09/2016 6:38 a.m., Ahmed Alzaeem wrote:
&gt;<i> thanks amos for clarification 
</I>&gt;<i> 
</I>&gt;<i> i expanded the kernel to  handle high traffic 
</I>&gt;<i> but still the issue in squid  i believe &#8230;&#8230;.
</I>&gt;<i> 
</I>&gt;<i> is there anything can i do to let squid expand the 1024 sessions form kernel ?
</I>
It is not a limit on number of &quot;sessions&quot;. It is queues inside both the
kernel and Squid getting so full of actions that need to happen that
small ~50 byte packets travelling between worker processes (running
inside the same machine!) take over 6 whole seconds to arrive.

For processes on the same machine 'whole seconds' is thousands if not
millions of times slower than it should be.


&gt;<i> 
</I>&gt;<i> you can imagine that I&#8217;m talking about the # of sockets seems limited to 1024 .
</I>&gt;<i> 
</I>
The key word is &quot;seems&quot;. To you it seems that way. Reality is that
number you are looking at is just a side effect of how fast your CPU is.
Faster or slower CPU will have different number show up as the limit -
because they will be able to process more or less actions before delays
get longer than the timeout.

Around about 1024 (or was it 1022? or 1028? or ...) the coordinator
process and kernel are doing so much work the worker processes start
thinking they have been orphaned and self-terminate.



&gt;<i> can i expand it form squid ?
</I>&gt;<i> 
</I>&gt;<i> any squid building compilation settings needed ?
</I>&gt;<i> 
</I>
You can edit src/ipc/Strand.cc and change the number parameter of the line:
  setTimeout(6, &quot;Ipc::Strand::timeoutHandler&quot;);

I would advise against making it too much different from the existing
value though.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012570.html">[squid-users] squid kid/SMP limitation like 1024 ips/opened	sessions ?????
</A></li>
	<LI>Next message (by thread): <A HREF="012574.html">[squid-users] squid kid/SMP limitation like 1024 ips/opened	sessions ?????
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12573">[ date ]</a>
              <a href="thread.html#12573">[ thread ]</a>
              <a href="subject.html#12573">[ subject ]</a>
              <a href="author.html#12573">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
