<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] What's the algorithm to achieve AclRandom
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%27s%20the%20algorithm%20to%20achieve%20AclRandom&In-Reply-To=%3Ca85c96e4-b422-ee70-539a-ef6f9279330a%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012575.html">
   <LINK REL="Next"  HREF="012583.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] What's the algorithm to achieve AclRandom</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%27s%20the%20algorithm%20to%20achieve%20AclRandom&In-Reply-To=%3Ca85c96e4-b422-ee70-539a-ef6f9279330a%40measurement-factory.com%3E"
       TITLE="[squid-users] What's the algorithm to achieve AclRandom">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Sep 18 14:59:10 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012575.html">[squid-users] What's the algorithm to achieve AclRandom
</A></li>
        <LI>Next message (by thread): <A HREF="012583.html">[squid-users] What's the algorithm to achieve AclRandom
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12578">[ date ]</a>
              <a href="thread.html#12578">[ thread ]</a>
              <a href="subject.html#12578">[ subject ]</a>
              <a href="author.html#12578">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/18/2016 05:41 AM, yanghe wrote:

&gt;<i> I have two ICAP servers and want load balancing.If I
</I>&gt;<i> use AclRandom,the traffic will be averagely distributed to
</I>&gt;<i> the two ICAP servers,but it can't guarantee the integrity of
</I>&gt;<i> the session.For example,I sent a message with 5
</I>&gt;<i> attachments,which were randomly assigned to two ICAP servers.
</I>
&gt;<i>From Squid point of view, the &quot;session&quot; you are talking about does not
</I>exist and, hence, there is no &quot;integrity of the session&quot; issue.


&gt;<i>                 If I want the 5 attachments to go to only one ICAP to
</I>&gt;<i>             maintain the integrity of the session and load banlacing as
</I>&gt;<i>             far as possible,which parameters can be used.
</I>
HTTP itself does not tie an &quot;attachment&quot; transaction to the &quot;parent&quot;
transaction to form what you call a &quot;session&quot;. Each HTTP
request/response pair are independent from other pairs. You are thinking
in application terms that Squid/HTTP does not understand/support.

Going forward, you have two basic options:

A. Define &quot;session&quot; in HTTP or Squid terms that Squid understands. Write
ACLs (likely including an external ACL or an eCAP adapter) that will
define a &quot;session&quot; for any given transaction and annotate same-session
transactions accordingly. Load balance based on sessions instead of
random events. The same external ACL or eCAP adapter can define load
balancing by annotating the transaction according to the ICAP service it
should be directed to.

B. Adjust the ICAP service to store information about &quot;sessions&quot; in such
a way that different service instances can share it. For example, if all
ICAP services run on the same machine, they can use shared memory
segments to exchange information among each other.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012575.html">[squid-users] What's the algorithm to achieve AclRandom
</A></li>
	<LI>Next message (by thread): <A HREF="012583.html">[squid-users] What's the algorithm to achieve AclRandom
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12578">[ date ]</a>
              <a href="thread.html#12578">[ thread ]</a>
              <a href="subject.html#12578">[ subject ]</a>
              <a href="author.html#12578">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
