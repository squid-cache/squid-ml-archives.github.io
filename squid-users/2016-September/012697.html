<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%3A%20Is%20it%20possible%20adaptation_service_chain%0A%20from%20services%20with%20different%20access%20lists%3F&In-Reply-To=%3C2ea6f023-e6c6-45cd-0e6a-60b83d843809%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012695.html">
   <LINK REL="Next"  HREF="012699.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%3A%20Is%20it%20possible%20adaptation_service_chain%0A%20from%20services%20with%20different%20access%20lists%3F&In-Reply-To=%3C2ea6f023-e6c6-45cd-0e6a-60b83d843809%40measurement-factory.com%3E"
       TITLE="[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Sep 26 16:25:07 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012695.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
        <LI>Next message (by thread): <A HREF="012699.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12697">[ date ]</a>
              <a href="thread.html#12697">[ thread ]</a>
              <a href="subject.html#12697">[ subject ]</a>
              <a href="author.html#12697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/26/2016 09:44 AM, Yuri Voinov wrote:

&gt;<i> I have to adaptation service A, which has the access list &quot;All&quot;.
</I>&gt;<i> 
</I>&gt;<i> And B adaptation service that has access list &quot;only text types&quot;.
</I>
&gt;<i> I want to chain both services in  adaptation_service_chain with next logic:
</I>
&gt;<i> In this scheme, service A must adapt all content and pass positive
</I>&gt;<i> (adapted) results to service B, which must filter and adapt only text
</I>&gt;<i> types from incoming transaction, and pass another unchanged.
</I>
The last part does not make sense to me: Why send non-text messages to
service B that does not want them? I assume you meant that Squid should
not send service B non-text messages at all.


&gt;<i> Question: Does this scheme of adaptation possible?
</I>
Yes, there are several ways to accomplish this.

1. Static decision using ACLs:

  adaptation_service_chain vegetarianChain serviceA serviceB

  acl messageIsText ...
  adaptation_access vegetarianChain messageIsText
  adaptation_access serviceA all


2. Dynamic decision inside ServiceA:

   Modify ServiceA to emit an appropriate ICAP X-Next-Services header
[for text messages]. Do not forget to configure ServiceA with
routing=on! Search for X-Next-Services in squid.conf.documented.


&gt;<i> If yes - how it can be done, given the fact that the service A can block
</I>&gt;<i> access to content and has an inside access control from a subset of
</I>&gt;<i> &quot;All&quot;, and the service B has an outside access control list (squid's
</I>&gt;<i> driven)?
</I>
You can generalize the above solutions to virtually any combination of
access lists. Just do not think in terms of access control lists for
individual services. Think of access control lists for chains (a
single-service chain is just a corner case which you can optimize by
replacing the chain with the service as shown in #1 above).


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012695.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
	<LI>Next message (by thread): <A HREF="012699.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12697">[ date ]</a>
              <a href="thread.html#12697">[ thread ]</a>
              <a href="subject.html#12697">[ subject ]</a>
              <a href="author.html#12697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
