<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%3A%20Is%20it%20possible%20adaptation_service_chain%0A%20from%20services%20with%20different%20access%20lists%3F&In-Reply-To=%3C4c37cb2d-8fd1-8ea5-b82b-e879c46b816e%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012697.html">
   <LINK REL="Next"  HREF="012700.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%3A%20Is%20it%20possible%20adaptation_service_chain%0A%20from%20services%20with%20different%20access%20lists%3F&In-Reply-To=%3C4c37cb2d-8fd1-8ea5-b82b-e879c46b816e%40gmail.com%3E"
       TITLE="[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?">yvoinov at gmail.com
       </A><BR>
    <I>Mon Sep 26 16:42:07 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012697.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
        <LI>Next message (by thread): <A HREF="012700.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12699">[ date ]</a>
              <a href="thread.html#12699">[ thread ]</a>
              <a href="subject.html#12699">[ subject ]</a>
              <a href="author.html#12699">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
 


26.09.2016 22:25, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> On 09/26/2016 09:44 AM, Yuri Voinov wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I have to adaptation service A, which has the access list &quot;All&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> And B adaptation service that has access list &quot;only text types&quot;.
</I>&gt;<i>
</I>&gt;&gt;<i> I want to chain both services in  adaptation_service_chain with next
</I>logic:
&gt;<i>
</I>&gt;&gt;<i> In this scheme, service A must adapt all content and pass positive
</I>&gt;&gt;<i> (adapted) results to service B, which must filter and adapt only text
</I>&gt;&gt;<i> types from incoming transaction, and pass another unchanged.
</I>&gt;<i>
</I>&gt;<i> The last part does not make sense to me: Why send non-text messages to
</I>&gt;<i> service B that does not want them? I assume you meant that Squid should
</I>&gt;<i> not send service B non-text messages at all.
</I>And how to do it? To adapt the chain is only one access control list.
Suppose I, for whatever reason, can not modify the services at the level
of source code. It's not uncommon that the adaptation services are
proprietary code, is not it? How can I make a chain of adaptation with
different acl's for different chained services?
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Question: Does this scheme of adaptation possible?
</I>&gt;<i>
</I>&gt;<i> Yes, there are several ways to accomplish this.
</I>&gt;<i>
</I>&gt;<i> 1. Static decision using ACLs:
</I>&gt;<i>
</I>&gt;<i>   adaptation_service_chain vegetarianChain serviceA serviceB
</I>&gt;<i>
</I>&gt;<i>   acl messageIsText ...
</I>&gt;<i>   adaptation_access vegetarianChain messageIsText
</I>&gt;<i>   adaptation_access serviceA all
</I>Here from this place can be a bit more detail. And if versa? A service
receives all of the transactions, and the service B is limited to text
answers?

How will it look like in practice and how to really work?
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2. Dynamic decision inside ServiceA:
</I>&gt;<i>
</I>&gt;<i>    Modify ServiceA to emit an appropriate ICAP X-Next-Services header
</I>&gt;<i> [for text messages]. Do not forget to configure ServiceA with
</I>&gt;<i> routing=on! Search for X-Next-Services in squid.conf.documented.
</I>As I understand it, there is required a modification service code, right?

And is it possible specific example here:

#    routing=on|off|1|0
#        If set to 'on' or '1', the ICAP service is allowed to
#        dynamically change the current message adaptation plan by
#        returning a chain of services to be used next. The services
#        are specified using the X-Next-Services ICAP response header
#        value, formatted as a comma-separated list of service names.
#        Each named service should be configured in squid.conf. Other
#        services are ignored. An empty X-Next-Services value results
#        in an empty plan which ends the current adaptation.
#
#        Dynamic adaptation plan may cross or cover multiple supported
#        vectoring points in their natural processing order.
#
#        Routing is not allowed by default: the ICAP X-Next-Services
#        response header is ignored.

For me personally, this paragraph does not explain anything.

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> If yes - how it can be done, given the fact that the service A can block
</I>&gt;&gt;<i> access to content and has an inside access control from a subset of
</I>&gt;&gt;<i> &quot;All&quot;, and the service B has an outside access control list (squid's
</I>&gt;&gt;<i> driven)?
</I>&gt;<i>
</I>&gt;<i> You can generalize the above solutions to virtually any combination of
</I>&gt;<i> access lists. Just do not think in terms of access control lists for
</I>&gt;<i> individual services. Think of access control lists for chains (a
</I>&gt;<i> single-service chain is just a corner case which you can optimize by
</I>&gt;<i> replacing the chain with the service as shown in #1 above).
</I>Should we understand this statement as something that we can not set
different access to services in the chain and the chain can have only
one level of access is the same for all the services within it?

Because then this assertion is contrary to the above.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTH,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
 
iQEcBAEBCAAGBQJX6U/fAAoJENNXIZxhPexGw+8H/07twJ6EEhw8FPypWFVyg3OY
dcQ42xuQTyXEqeCl2JwAOcgDEN90uacVEFRfA3HUcZhLIyaWwqarHeYOMwVtiCK9
IhLA9K+WzlhqGSR4VQNN6cNv/2OyMRwepBz9xo6KOF4TIxPkYpy6YhZ4mbCBd3xY
Jxhr1RfQxRn6YBfhCLTDJpMP+Lam3VApdkvfCmvKHmGNtKXTDSJXLi2fWM6/Pc62
dzf8CMgeEMP7FQ/8RUH3qS3wR3gxW2al5xmbHP/JR76qoEf2KntAtuIKK+pp7I0c
UOhXa//JiVodGgF63bg89a0n5gxSOwtcvhUVzy1TVX3z2znTLhQTpalX1QyNuWI=
=mvCb
-----END PGP SIGNATURE-----

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160926/71125c2e/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160926/71125c2e/attachment.key</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012697.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
	<LI>Next message (by thread): <A HREF="012700.html">[squid-users] Question: Is it possible adaptation_service_chain from services with different access lists?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12699">[ date ]</a>
              <a href="thread.html#12699">[ thread ]</a>
              <a href="subject.html#12699">[ subject ]</a>
              <a href="author.html#12699">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
