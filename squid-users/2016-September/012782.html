<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Caching application/octet-stream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20application/octet-stream&In-Reply-To=%3CCAHhBkD1E1dFS3wTHXFjE16ES0HEcxA_ePAusrF2q-WwZ-QtfTg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012732.html">
   <LINK REL="Next"  HREF="012784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Caching application/octet-stream</H1>
    <B>Michael Varun</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Caching%20application/octet-stream&In-Reply-To=%3CCAHhBkD1E1dFS3wTHXFjE16ES0HEcxA_ePAusrF2q-WwZ-QtfTg%40mail.gmail.com%3E"
       TITLE="[squid-users] Caching application/octet-stream">michael.varun at inmobi.com
       </A><BR>
    <I>Fri Sep 30 07:10:54 UTC 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="012732.html">[squid-users] Caching application/octet-stream
</A></li>
        <LI>Next message (by thread): <A HREF="012784.html">[squid-users] Caching application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12782">[ date ]</a>
              <a href="thread.html#12782">[ thread ]</a>
              <a href="subject.html#12782">[ subject ]</a>
              <a href="author.html#12782">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here is the snippet of debug logs
I dont get to see anything missing out there . It does a GET call to the
docker registry on behalf of the requesting client The registry listens on
443 so squid mimicks  client TLS connections post which does a GET call to
the docker registry on the requested blobs


Logs
=====


---------
GET
/v2/idp/mtd-log-viewer/blobs/sha256:7f24efe711014be87fc45d3ccdc15bb419f45f26ab1f7dd4652b83890ba16294
HTTP/1.1
Host: dockerregistry.com
User-Agent: docker/1.12.1 go/go1.6.3 git-commit/23cf638
kernel/3.16.0-71-generic os/linux arch/amd64
UpstreamClient(Docker-Client/1.12.1 \(linux\))
Authorization: Bearer
AKCp2V5yYCcLhiuTrm6gvr2h6At9FfzhpxEB61CncxQsQxoRNT4tmcSLbWjecmnSFT4gtvF1q
Accept-Encoding: gzip
Connection: close


----------
2016/09/30 07:05:26.100| 11,2| http.cc(2201) sendRequest: HTTP Server local=
10.88.92.129:56249 remote=xx.xx.xx.xx:443 FD 16 flags=1
2016/09/30 07:05:26.100| 11,2| http.cc(2202) sendRequest: HTTP Server
REQUEST:
---------
GET
/v2/idp/mtd-log-viewer/blobs/sha256:7f24efe711014be87fc45d3ccdc15bb419f45f26ab1f7dd4652b83890ba16294
HTTP/1.1
User-Agent: docker/1.12.1 go/go1.6.3 git-commit/23cf638
kernel/3.16.0-71-generic os/linux arch/amd64
UpstreamClient(Docker-Client/1.12.1 \(linux\))
Host: dockerregistry.com
Via: 1.1 proxyserver (squid/3.5.20-20160817-r14075)
Surrogate-Capability: proxyserver=&quot;Surrogate/1.0&quot;
X-Forwarded-For: 10.88.84.102
Cache-Control: max-age=600
Connection: keep-alive


----------
2016/09/30 07:05:27.046| ctx: enter level  0: '
<A HREF="https://dockerregistry.com/v2/blobs/sha256:3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c">https://dockerregistry.com/v2/blobs/sha256:3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c</A>
'
2016/09/30 07:05:27.046| 11,2| http.cc(717) processReplyHeader: HTTP Server
local=10.88.92.129:56250 remote=xx.xx.xx.xx:443 FD 21 flags=1
2016/09/30 07:05:27.046| 11,2| http.cc(718) processReplyHeader: HTTP Server
REPLY:
---------
HTTP/1.1 200 OK
Server: nginx
Date: Fri, 30 Sep 2016 07:06:12 GMT
Content-Type: application/octet-stream
Content-Length: 1256
Connection: keep-alive
X-Artifactory-Id: fb4bb806eccd564b:-7d2d7c9a:156cf92100e:-8000
Last-Modified: Tue, 13 Sep 2016 06:03:06 GMT
ETag: ca5755fd72e65e6cc42e608eb7524d4956c9a358
X-Checksum-Sha1: ca5755fd72e65e6cc42e608eb7524d4956c9a358
Accept-Ranges: bytes
X-Checksum-Md5: a15d3dcf76f3334177fa44e6ad0af578
X-Artifactory-Filename:
sha256__3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c
Docker-Distribution-Api-Version: registry/2.0
Docker-Content-Digest:
sha256:3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c

&#65533;
----------
2016/09/30 07:05:27.046| ctx: exit level  0
2016/09/30 07:05:27.046| 11,2| client_side.cc(1392) sendStartOfMessage:
HTTP Client local=10.88.92.129:443 remote=10.88.84.102:41429 FD 18 flags=1
2016/09/30 07:05:27.046| 11,2| client_side.cc(1393) sendStartOfMessage:
HTTP Client REPLY:
---------
HTTP/1.1 200 OK
Server: nginx
Date: Fri, 30 Sep 2016 07:06:12 GMT
Content-Type: application/octet-stream
Content-Length: 1256
X-Artifactory-Id: fb4bb806eccd564b:-7d2d7c9a:156cf92100e:-8000
Last-Modified: Tue, 13 Sep 2016 06:03:06 GMT
ETag: ca5755fd72e65e6cc42e608eb7524d4956c9a358
X-Checksum-Sha1: ca5755fd72e65e6cc42e608eb7524d4956c9a358
Accept-Ranges: bytes
X-Checksum-Md5: a15d3dcf76f3334177fa44e6ad0af578
X-Artifactory-Filename:
sha256__3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c
Docker-Distribution-Api-Version: registry/2.0
Docker-Content-Digest:
sha256:3071a8ec2f6e96d06697a8069a385f889fa318ef479a0c2557baddb0e06a9b2c
X-Cache: MISS from proxyserver
&lt;=======================================================================================
MISS
X-Cache-Lookup: MISS from
proxyserver:443&lt;=============================================================================
LOOKUP MISS
Via: 1.1 proxyserver (squid/3.5.20-20160817-r14075)
Connection: close

On Wed, Sep 28, 2016 at 7:54 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 28/09/2016 11:17 p.m., Michael Varun wrote:
</I>&gt;<i> &gt; Team -
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Would like to know is there any specific config that we need to enable to
</I>&gt;<i> &gt; cache MIME attachement of application/octet-stream type
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We are trying to caching docker image blobs which is of
</I>&gt;<i> &gt; application/octet-stream  and everytime we hit the docker registry
</I>&gt;<i> via)GET
</I>&gt;<i> &gt; call squid throws up TCP_MISS/200  I had never got a CACHE HIT or MEM HIT
</I>&gt;<i> &gt; for these contents. Can someone show pointers to how to succeed in cache
</I>&gt;<i> &gt; hit
</I>&gt;<i>
</I>&gt;<i> The object mime type does not matter for caching. What does matter are
</I>&gt;<i> the URL and identifier headers, plus headers about the objects age,
</I>&gt;<i> Vary, Expires and Cache-Control.
</I>&gt;<i>
</I>&gt;<i> You can configure &quot;debug_options 11,2&quot; to get a cache.log trace of the
</I>&gt;<i> messages going through the proxy. Taking a closer look at those message
</I>&gt;<i> headers to find out why caching is not happening.
</I>&gt;<i>
</I>&gt;<i> You could also use the tool at redbot.org. It takes a public URL and
</I>&gt;<i> displays the cacheability situation for it.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>
-- 
_____________________________________________________________
The information contained in this communication is intended solely for the 
use of the individual or entity to whom it is addressed and others 
authorized to receive it. It may contain confidential or legally privileged 
information. If you are not the intended recipient you are hereby notified 
that any disclosure, copying, distribution or taking any action in reliance 
on the contents of this information is strictly prohibited and may be 
unlawful. If you have received this communication in error, please notify 
us immediately by responding to this email and then delete it from your 
system. The firm is neither liable for the proper and complete transmission 
of the information contained in this communication nor for any delay in its 
receipt.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20160930/3ef8ac31/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20160930/3ef8ac31/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="012732.html">[squid-users] Caching application/octet-stream
</A></li>
	<LI>Next message (by thread): <A HREF="012784.html">[squid-users] Caching application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12782">[ date ]</a>
              <a href="thread.html#12782">[ thread ]</a>
              <a href="subject.html#12782">[ subject ]</a>
              <a href="author.html#12782">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
