<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] What squid should do with RFC non-compliant	response header?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20squid%20should%20do%20with%20RFC%20non-compliant%0A%09response%20header%3F&In-Reply-To=%3C066901d2afa1%24dce275f0%2496a761d0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014898.html">
   <LINK REL="Next"  HREF="014888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] What squid should do with RFC non-compliant	response header?</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20What%20squid%20should%20do%20with%20RFC%20non-compliant%0A%09response%20header%3F&In-Reply-To=%3C066901d2afa1%24dce275f0%2496a761d0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] What squid should do with RFC non-compliant	response header?">eliezer at ngtech.co.il
       </A><BR>
    <I>Fri Apr  7 13:21:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014898.html">[squid-users] What squid should do with RFC non-compliant response header?
</A></li>
        <LI>Next message (by thread): <A HREF="014888.html">[squid-users] squid cache analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14908">[ date ]</a>
              <a href="thread.html#14908">[ thread ]</a>
              <a href="subject.html#14908">[ subject ]</a>
              <a href="author.html#14908">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Amos and Alex,

I have seen a scenario like that but while working with haproxy.
I believe that there is a difference between a &quot;security&quot; proxy appliance to some other kinds.
The enforcement of the RFC for headers computability seems like the right way to go for any general http proxy.
The issue may arise when some developer might do some mistake in php or another customisd service. Php doesn't enforce the header syntax and it is possible that a developer will run broken code.

For the case with haproxy it returned a 500 wrong response.
To test the issue I had to compare two\three cases such as:
- plain text file
- plain html file
- simple phpinfo() php script

When testing these the conclusion was that there is something wrong with the php code that the developer wrote.
At least I can say that I have not seen such an error in any open source web application that is based on php. So I believe that they have some hidden quality to do things the right way.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Alex Rousskov
Sent: Thursday, April 6, 2017 8:45 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] What squid should do with RFC non-compliant response header?

On 04/06/2017 10:07 AM, Amos Jeffries wrote:
&gt;<i> On 6/04/2017 7:32 a.m., Eliezer  Croitoru wrote:
</I>&gt;&gt;<i> Technically I would expect squid to pass it but it's might have the potential for a CVE in some casese.
</I>

&gt;<i> There is actually a CVE problem &quot;HTTP request/response smuggling&quot; in 
</I>&gt;<i> all cases of the type you described.
</I>

&gt;<i> There are exactly two things that can be done by a proxy when this 
</I>&gt;<i> type of error is encountered:
</I>
&gt;<i>  1) [send an error message]
</I>&gt;<i>  2) truncate the message at the CRLF before the garbage
</I>
There are many other reasonable things a proxy can do, with admin permission, but it is pointless to discuss their details on squid-users IMO. And yes, pretty much all of them may cause HTTP message smuggling.
They are useful as temporary compatibility workarounds, not universal default solutions.

Alex.

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014898.html">[squid-users] What squid should do with RFC non-compliant response header?
</A></li>
	<LI>Next message (by thread): <A HREF="014888.html">[squid-users] squid cache analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14908">[ date ]</a>
              <a href="thread.html#14908">[ thread ]</a>
              <a href="subject.html#14908">[ subject ]</a>
              <a href="author.html#14908">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
