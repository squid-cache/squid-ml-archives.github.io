<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.4.8 Reverse with multiple SSL Sites and multiple Certs/Domains
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.8%20Reverse%20with%20multiple%20SSL%20Sites%20and%0A%20multiple%20Certs/Domains&In-Reply-To=%3CE8C0D58036A98440B317EA23130CF55B67947A%40ms-exchange-01.provit.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014929.html">
   <LINK REL="Next"  HREF="014936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.4.8 Reverse with multiple SSL Sites and multiple Certs/Domains</H1>
    <B>Maik Linnemann</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.4.8%20Reverse%20with%20multiple%20SSL%20Sites%20and%0A%20multiple%20Certs/Domains&In-Reply-To=%3CE8C0D58036A98440B317EA23130CF55B67947A%40ms-exchange-01.provit.info%3E"
       TITLE="[squid-users] Squid 3.4.8 Reverse with multiple SSL Sites and multiple Certs/Domains">maik.linnemann at modelco.de
       </A><BR>
    <I>Tue Apr 11 10:44:55 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014929.html">[squid-users] Squid Redirection Scripting
</A></li>
        <LI>Next message (by thread): <A HREF="014936.html">[squid-users] Squid 3.4.8 Reverse with multiple SSL Sites and multiple Certs/Domains
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14931">[ date ]</a>
              <a href="thread.html#14931">[ thread ]</a>
              <a href="subject.html#14931">[ subject ]</a>
              <a href="author.html#14931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Dear List, 

i use squid3 as reverse Proxy since a while for multiple sites, hosted on different targets. All those sites work with SSL they use a wildcard cert. It works well so far. Now i need to host another site, with a different domain and another ssl certificate. Can i configure squid to use cert by the requested url likewise? i just tried to copy my existing stuff and edit it to another cert, but this doesnt take me far as squid always takes the main cert file. my config is like:

&lt;FROM HERE I AM GOOD&gt;

https_port &lt;IP&gt;:443 accel vhost defaultsite=webmail.somedomain.info cert=/etc/squid3/certs/wildcard/wirldcard.crt key=/etc/squid3/certs/wildcard/wildcard.key
cache_peer 192.168.111.20 parent 443 0 proxy-only no-query no-digest login=PASS connection-auth=off ssl sslflags=DONT_VERIFY_PEER,DONT_VERIFY_DOMAIN originserver name=webmail
cache_peer_domain webmail ssl webmail.somedomain.info
acl url_allow url_regex -i ^<A HREF="https://webmail.somedomain.info/owa.*$">https://webmail.somedomain.info/owa.*$</A>
acl url_allow url_regex -i ^<A HREF="https://webmail.somedomain.info/ecp.*$">https://webmail.somedomain.info/ecp.*$</A>

cache_peer 192.168.111.51 parent 443 0 proxy-only no-query no-digest login=PASS connection-auth=off ssl sslflags=DONT_VERIFY_PEER,DONT_VERIFY_DOMAIN originserver name=git
cache_peer_domain git ssl git.somedomain.info
acl url_allow url_regex -i ^<A HREF="https://git.somedomain.info/.*$">https://git.somedomain.info/.*$</A>

&lt;UNTIL HERE I AM GOOD&gt;

&lt;THIS IS NOT REALLY WORKING&gt;

https_port www.anotherdomain.de:443 accel vhost defaultsite=anotherdomain.de cert=/etc/ssl/certs-anotherdomain.de/anotherdomain.de.pem key=/etc/ssl/private-anotherdomain.de/anotherdomain.de.key
cache_peer 192.168.1.1 parent 443 0 proxy-only no-query no-digest login=PASS connection-auth=off ssl sslflags=DONT_VERIFY_PEER,DONT_VERIFY_DOMAIN originserver name=anotherdomain

&lt;THIS IS NOT REALLY WORKING&gt;

How can i host multiple Sites and tell squid to use the cert i attach to each site or domain?

thanks in advance, 

with regards,

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014929.html">[squid-users] Squid Redirection Scripting
</A></li>
	<LI>Next message (by thread): <A HREF="014936.html">[squid-users] Squid 3.4.8 Reverse with multiple SSL Sites and multiple Certs/Domains
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14931">[ date ]</a>
              <a href="thread.html#14931">[ thread ]</a>
              <a href="subject.html#14931">[ subject ]</a>
              <a href="author.html#14931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
