<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-dev] [RFC] Changes to http_access defaults
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-dev%5D%20%5BRFC%5D%20Changes%20to%20http_access%20defaults&In-Reply-To=%3Cb75c27f2-bdb1-6131-d104-eb8bef2c9c3d%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014975.html">
   <LINK REL="Next"  HREF="014978.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-dev] [RFC] Changes to http_access defaults</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-dev%5D%20%5BRFC%5D%20Changes%20to%20http_access%20defaults&In-Reply-To=%3Cb75c27f2-bdb1-6131-d104-eb8bef2c9c3d%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-dev] [RFC] Changes to http_access defaults">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Apr 14 12:22:48 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014975.html">[squid-users] [RFC] Changes to http_access defaults
</A></li>
        <LI>Next message (by thread): <A HREF="014978.html">[squid-users] [RFC] Changes to http_access defaults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14966">[ date ]</a>
              <a href="thread.html#14966">[ thread ]</a>
              <a href="subject.html#14966">[ subject ]</a>
              <a href="author.html#14966">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/04/2017 3:58 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 13.04.2017 21:14, Dan Purgert &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> Quoting Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 04/12/2017 12:16 PM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Changes to http_access defaults
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Clearly stating what you are trying to accomplish with these changes may
</I>&gt;&gt;&gt;<i> help others evaluate your proposal. Your initial email focuses on _how_
</I>&gt;&gt;&gt;<i> you are going to accomplish some implied/vague goal. What is the goal
</I>&gt;&gt;&gt;<i> here?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I have become convinced that Squid always checks those
</I>&gt;&gt;&gt;&gt;<i> security rules, then do the custom access rules. All other orderings
</I>&gt;&gt;&gt;&gt;<i> seem to have turned out to be problematic and security-buggy in some
</I>&gt;&gt;&gt;&gt;<i> edge cases or another.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> s/Squid always checks/Squid should always check/
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> What are peoples opinions about making the following items built-in
</I>&gt;&gt;&gt;&gt;<i> defaults?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  acl Safe_ports port 21 80 443
</I>&gt;&gt;&gt;&gt;<i>  acl CONNECT_ports port 443
</I>&gt;&gt;&gt;&gt;<i>  acl CONNECT method CONNECT
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  http_acces deny !Safe_ports
</I>&gt;&gt;&gt;&gt;<i>  http_access deny CONNECT !CONNECT_ports
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The above change will have some effect on installations that try to use
</I>&gt;&gt;&gt;&gt;<i> an empty squid.conf.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> And on many other existing installations, of course, especially on those
</I>&gt;&gt;&gt;<i> with complex access rules which are usually the most difficult to
</I>&gt;&gt;&gt;<i> modify/adjust. In other words, this is a pretty serious change.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How would a &quot;built-in default&quot; alter an existing setup? I mean, in
</I>&gt;&gt;<i> every other instance that I can think of, if the config file includes
</I>&gt;&gt;<i> the directive, the config file's version overrides the default ...
</I>&gt;<i> This is normal behaviour. System administrator should have possibility
</I>&gt;<i> to override ANY default.
</I>
Yes, and override remains possible. Just in a way that does not involve
deleting lines from squid.conf.

To override the propsed default you *add* ports to the Safe_ports and
CONNECT_ports (ala SSL_Ports) lines to make them no longer be denied.

For example;

 today to make Squid an open proxy you _erase_ these lines:

  http_access deny !Safe_ports
  http_access deny CONNECT !SSL_ports

Alternatively you can also *add* these lines:

 acl Safe_ports port 0-65535
 acl SSL_Ports port 0-65535

That second way will work both before and after the proposed change.
(Module the proposed rename of SSL_ports to CONNECT_ports). This makes
it a little but harder for newbies or naive people to get themselves
into trouble, without removing ability for advanced needs.


As Alex pointed out it does mean change for anyone with those advanced
configs. So it is a matter of whether the pain is too great or there is
a better way. Thus 'RFC' to everyone.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014975.html">[squid-users] [RFC] Changes to http_access defaults
</A></li>
	<LI>Next message (by thread): <A HREF="014978.html">[squid-users] [RFC] Changes to http_access defaults
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14966">[ date ]</a>
              <a href="thread.html#14966">[ thread ]</a>
              <a href="subject.html#14966">[ subject ]</a>
              <a href="author.html#14966">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
