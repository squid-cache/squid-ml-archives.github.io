<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid proxy with ssl-bump - unrecognized: 'ssl-bump' error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20with%20ssl-bump%20-%20unrecognized%3A%0A%20%27ssl-bump%27%20error&In-Reply-To=%3C9fc0edda-d810-e7c2-0994-a59b836fdf14%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014969.html">
   <LINK REL="Next"  HREF="014971.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid proxy with ssl-bump - unrecognized: 'ssl-bump' error</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20with%20ssl-bump%20-%20unrecognized%3A%0A%20%27ssl-bump%27%20error&In-Reply-To=%3C9fc0edda-d810-e7c2-0994-a59b836fdf14%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid proxy with ssl-bump - unrecognized: 'ssl-bump' error">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Apr 14 13:32:43 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014969.html">[squid-users] Squid proxy with ssl-bump - unrecognized: 'ssl-bump'	error
</A></li>
        <LI>Next message (by thread): <A HREF="014971.html">[squid-users] Multiple http_access Logic At the same time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14973">[ date ]</a>
              <a href="thread.html#14973">[ thread ]</a>
              <a href="subject.html#14973">[ subject ]</a>
              <a href="author.html#14973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/04/2017 1:17 a.m., Mohammed al-jakry wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Dears, 
</I>&gt;<i> 
</I>&gt;<i> Thanks for adding me to the list&#8230;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I would like to install squid proxy with SSL bump, I am working on my Virtual lab and once everything is ok I will Test it on the real network. I already created I directory for the cert and generated the cert as below:
</I>&gt;<i> #Generate Private Key
</I>&gt;<i> openssl genrsa -out MSY.com.private 2048  
</I>&gt;<i> 
</I>&gt;<i> # Create Certificate Signing Request
</I>&gt;<i> openssl req -new -key MSY.com.private -out MSY.com.csr
</I>&gt;<i> 
</I>&gt;<i> # Sign Certificate
</I>&gt;<i> openssl x509 -req -days 3652 -in MSY.com.csr -signkey MSY.com.private -out 
</I>&gt;<i> MSY.com.cert
</I>&gt;<i> # Generate certificate cache
</I>&gt;<i> /usr/lib64/squid/ssl_crtd -c -s /var/lib/ssl_db
</I>&gt;<i> # Change ownership of the certificate cache
</I>&gt;<i> chown squid: /var/lib/ssl_db
</I>&gt;<i> then I fill the info and put the 'Common Name' something other than the domain or server_name. in addition, please find the below lines from the squid configuration file:
</I>&gt;<i> # Squid listen Port
</I>&gt;<i> http_port 3128  
</I>&gt;<i> ssl-bump generate-host-certificates=on dynamic_cert_mem_cache_size=4MB key=/etc/squid/MSY.com.private cert=/etc/squid/MSY.com.cert  
</I>&gt;<i> # SSL Bump Config
</I>&gt;<i> always_direct allow all  
</I>&gt;<i> ssl_bump server-first all  
</I>
&gt;<i> sslproxy_cert_error deny all  
</I>&gt;<i> sslproxy_flags DONT_VERIFY_PEER  
</I>
The above two lines are actively dangerous.


NOTE that &quot;Just for testing&quot; is not a good excuse either. They actively
hide TLS problems, testing will &quot;work fine&quot; and production use of the
same config fail with horrible results - or worse; production &quot;work
perfectly&quot; and the horrible results happening invisibly anyway.

When testing, let Squid tell you about errors. Resolve them in other
ways (ie properly) and then you wont need these setting in production
use either. :-)


&gt;<i> sslcrtd_program /usr/lib64/squid/ssl_crtd -s /var/lib/ssl_db -M 4MB sslcrtd_children 8 startup=1 idle=1 
</I>&gt;<i> and it&#8217;s not working with SSL bump configuration, it work only when I remove the ssl bump configuration but for sure without ssl certificate.
</I>&gt;<i> also i check the journalctl -xe and found the below error:
</I>&gt;<i> /etc/squid/squid.conf:3 unrecognized: 'ssl-bump'
</I>&gt;<i> any ideas ?
</I>
Either the line(s) you mentioned above:

&gt;<i> http_port 3128
</I>&gt;<i> ssl-bump generate-host-certificates=on ...
</I>
are actually two lines in your config file instead of an email line
wrapping mistake.

Or, the squid binary being run is not built with OpenSSL support.


Probably the former, but what is the output of the command &quot;squid -v&quot;
anyway ?


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014969.html">[squid-users] Squid proxy with ssl-bump - unrecognized: 'ssl-bump'	error
</A></li>
	<LI>Next message (by thread): <A HREF="014971.html">[squid-users] Multiple http_access Logic At the same time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14973">[ date ]</a>
              <a href="thread.html#14973">[ thread ]</a>
              <a href="subject.html#14973">[ subject ]</a>
              <a href="author.html#14973">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
