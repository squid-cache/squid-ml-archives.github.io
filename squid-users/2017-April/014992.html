<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid generated certificate for IP rather than domain when using ssl_bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20generated%20certificate%20for%20IP%20rather%20than%20domain%0A%20when%20using%20ssl_bump&In-Reply-To=%3C803880255.1827853.1492439932286%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014989.html">
   <LINK REL="Next"  HREF="014993.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid generated certificate for IP rather than domain when using ssl_bump</H1>
    <B>Shanmugam Sundaram</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20generated%20certificate%20for%20IP%20rather%20than%20domain%0A%20when%20using%20ssl_bump&In-Reply-To=%3C803880255.1827853.1492439932286%40mail.yahoo.com%3E"
       TITLE="[squid-users] Squid generated certificate for IP rather than domain when using ssl_bump">shanmuga_karna at yahoo.com
       </A><BR>
    <I>Mon Apr 17 14:38:52 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014989.html">[squid-users] Squid SSL-bump - Not working - No errors
</A></li>
        <LI>Next message (by thread): <A HREF="014993.html">[squid-users] Squid generated certificate for IP rather than domain when using ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14992">[ date ]</a>
              <a href="thread.html#14992">[ thread ]</a>
              <a href="subject.html#14992">[ subject ]</a>
              <a href="author.html#14992">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I'm new to Squid, and having trouble getting SSL filtering work.
I have a blanket block setup with Squid as Transparent proxy where access it allowed only to github.com. But, squid generates certificates for IP address instead of domain name and SSL validation fails.Squid version: 3.5.25-20170408-r14154When I use curl (I have imported my self signed SSL to the certificate store)
curl: (51) SSL: certificate subject name (192.30.255.112) does not match target host name 'github.com
How to configure properly to splice a whitelist and block all other domains. Below is my current configurationhttp_port 3128
http_port 3129 intercept
https_port 3130intercept ssl-bump enerate-host-certificates=on dynamic_cert_mem_cache_size=4MB 
cert=/etc/squid/ssl_certs/myca.pem key=/etc/squid/ssl_certs/myca.pem

acl whitelist ssl::server_name .github.com
acl step1 at_step SslBump1

ssl_bump peek step1
ssl_bump splice whitelist
ssl_bump bump all

Please help me fixing the issue.
thanks,Shan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170417/3475f5ce/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170417/3475f5ce/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014989.html">[squid-users] Squid SSL-bump - Not working - No errors
</A></li>
	<LI>Next message (by thread): <A HREF="014993.html">[squid-users] Squid generated certificate for IP rather than domain when using ssl_bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14992">[ date ]</a>
              <a href="thread.html#14992">[ thread ]</a>
              <a href="subject.html#14992">[ subject ]</a>
              <a href="author.html#14992">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
