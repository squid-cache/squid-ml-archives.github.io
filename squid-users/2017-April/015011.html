<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Access-Control-* headers missing when going through	squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Access-Control-%2A%20headers%20missing%20when%20going%20through%0A%09squid&In-Reply-To=%3C9BA9BBFF-4737-4F5B-8C1B-98BAEBEC7869%40getbusi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015014.html">
   <LINK REL="Next"  HREF="015013.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Access-Control-* headers missing when going through	squid</H1>
    <B>Dan Charlesworth</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Access-Control-%2A%20headers%20missing%20when%20going%20through%0A%09squid&In-Reply-To=%3C9BA9BBFF-4737-4F5B-8C1B-98BAEBEC7869%40getbusi.com%3E"
       TITLE="[squid-users] Access-Control-* headers missing when going through	squid">dan at getbusi.com
       </A><BR>
    <I>Wed Apr 19 01:12:24 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015014.html">[squid-users] option to auto-recreate the ssl db ?
</A></li>
        <LI>Next message (by thread): <A HREF="015013.html">[squid-users] Access-Control-* headers missing when going through squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15011">[ date ]</a>
              <a href="thread.html#15011">[ thread ]</a>
              <a href="subject.html#15011">[ subject ]</a>
              <a href="author.html#15011">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone,

This is a super weird one!

This Pressreader site (<A HREF="http://sheppartonnews.pressreader.com/shepparton-news">http://sheppartonnews.pressreader.com/shepparton-news</A>) gets a totally different (erroneous) response from the server when accessing it through squid on a particular school's network.

It doesn&#8217;t happen through any other squid box on any other network I&#8217;ve tried, yet at this site you bypass squid through the same gateway and its fine; you use squid and it fails.

The only errors I can see in the browser (that happen when it fails) are CORS errors on several of the requests. Comparing the headers it looks like the erroneous requests lack these from the response:

Access-Control-Allow-Credentials: true
Access-Control-Allow-Origin: <A HREF="http://sheppartonnews.pressreader.com">http://sheppartonnews.pressreader.com</A>
Access-Control-Expose-Headers: ndstate,X-PD-AProfile,X-PD-Profile,X-PD-Ticket,X-PD-Auth,X-PD-PAuth,X-PD-Token

No, the squid config we&#8217;re using never touches headers. Every HTTP/S request from the client is being allowed and is a 200/304 in both situations.

(see attached for the full request response headers)

Make any sense to anyone?

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: erroneous.txt
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170419/f748710e/attachment.txt">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170419/f748710e/attachment.txt</A>&gt;
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: normal.txt
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170419/f748710e/attachment-0001.txt">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170419/f748710e/attachment-0001.txt</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015014.html">[squid-users] option to auto-recreate the ssl db ?
</A></li>
	<LI>Next message (by thread): <A HREF="015013.html">[squid-users] Access-Control-* headers missing when going through squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15011">[ date ]</a>
              <a href="thread.html#15011">[ thread ]</a>
              <a href="subject.html#15011">[ subject ]</a>
              <a href="author.html#15011">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
