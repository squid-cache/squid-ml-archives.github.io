<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] HTTPS woes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20woes&In-Reply-To=%3C1705244303.3763617.1492619407976%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015019.html">
   <LINK REL="Next"  HREF="015024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] HTTPS woes</H1>
    <B>Olly Lennox</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20woes&In-Reply-To=%3C1705244303.3763617.1492619407976%40mail.yahoo.com%3E"
       TITLE="[squid-users] HTTPS woes">oliver at lennox-it.uk
       </A><BR>
    <I>Wed Apr 19 16:30:07 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015019.html">[squid-users] HTTPS woes
</A></li>
        <LI>Next message (by thread): <A HREF="015024.html">[squid-users] HTTPS woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15022">[ date ]</a>
              <a href="thread.html#15022">[ thread ]</a>
              <a href="subject.html#15022">[ subject ]</a>
              <a href="author.html#15022">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry it's back,


I've narrowed down the problem, hopefully someone can help. When Squid starts it creates the directory /var/run/squid as user proxy:proxy. 

If I remove this or leave it as is then the application won't launch on subsequent reboots.

If I chown the directory as root:root then the application will launch on boot but proxy:proxy takes back ownership and it won't launch again on subsequent reboots.

I'm guessing this is something to do with the running processes, does anyone know what's going wrong?

Cheers,

Olly


------------
 



Never mind I've sorted it! The issue was due to the /var/run directory and the program not being able to create squid.pid. I amended the permissions and seems to be working fine now
 

Thanks a lot for the link, I'll implement that once I get this problem fixed. Sadly the change hasn't worked. My current /etc/fstab looks like this:


proc            /proc           proc    defaults          0       0 
PARTUUID=0d001852-01  /boot           vfat    defaults          0       2 
PARTUUID=0d001852-02  /               ext4    defaults,noatime  0       1 
# a swapfile is not a swap partition, no line here 
#   use  dphys-swapfile swap[on|off]  for that 
tmpfs /cache tmpfs defaults,noatime,nosuid,size=8000m 0 0 
none      /dev/shm        tmpfs  defaults        0 0 

could the existing tmpfs line be causing problems?

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">oliver at lennox-it.uk</A>
lennox-it.uk
tel: 07900 648 252



________________________________
From: L. P. H.  van Belle &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">belle at bazuin.nl</A>&gt;
To: &quot;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.</A> org&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at squid-cache.org</A>&gt; 
Sent: Wednesday, 19 April 2017, 11:05
Subject: Re: [squid-users] HTTPS woes



Hai, 


Im guess, squid is starting to soon, or there is not /dev/shm 


Check/Try adding, if not already in /etc/fstab 


none      /dev/shm        tmpfs   defaults        0 0 


And reboot the server. 



Or, i dont know and someone else can tell you. ;-) 

But on my jessie with squid 3.5.24+ssl i dont see this problem. 


A small tip about the certificates on debian or ubuntu. 

Install ca-certificates ( apt-get install ca-certificates ) 

And read : <A HREF="https://www.brightbox.com/blog/2014/03/04/add-cacert-ubuntu-debian/">https://www.brightbox.com/blog/2014/03/04/add-cacert-ubuntu-debian/</A> 




Greetz, 


Louis








&gt;<i> -----Oorspronkelijk bericht-----
</I>
&gt;<i> Van: squid-users 
</I>
&gt;<i> [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] Namens Olly Lennox
</I>
&gt;<i> Verzonden: woensdag 19 april 2017 11:22
</I>
&gt;<i> Aan: Amos Jeffries; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>
&gt;<i> Onderwerp: Re: [squid-users] HTTPS woes
</I>
&gt;<i> 
</I>
&gt;<i> Thanks Amos, I'll install this. One last question if I may! 
</I>
&gt;<i> Squid is working fine now with both HTTP and HTTPS but for 
</I>
&gt;<i> some reason it is refusing to launch on boot. 
</I>
&gt;<i> 
</I>
&gt;<i> It works perfectly when started with &quot;service squid start&quot; 
</I>
&gt;<i> but not boot. The error is:
</I>
&gt;<i> squid.service - LSB: Squid HTTP Proxy version 3.x
</I>
&gt;<i>    Loaded: loaded (/etc/init.d/squid; generated; vendor 
</I>
&gt;<i> preset: enabled)
</I>
&gt;<i>    Active: failed (Result: resources) since Wed 2017-04-19 
</I>
&gt;<i> 10:19:18 BST; 53s ago
</I>
&gt;<i>      Docs: man:systemd-sysv-generator(8)
</I>
&gt;<i>   Process: 598 ExecStart=/etc/init.d/squid start 
</I>
&gt;<i> (code=exited, status=0/SUCCESS)
</I>
&gt;<i> 
</I>
&gt;<i> Apr 19 10:19:13 raspberrypi (squid-1)[1606]: 
</I>
&gt;<i> Ipc::Mem::Segment::open failed to 
</I>
&gt;<i> shm_open(/squid-ssl_session_cache.shm): (2) No such file or 
</I>
&gt;<i> direct Apr 19 10:19:13 raspberrypi squid[1283]: Squid Parent: 
</I>
&gt;<i> (squid-1) process 1606 exited with status 1 Apr 19 10:19:16 
</I>
&gt;<i> raspberrypi squid[1283]: Squid Parent: (squid-1) process 1633 
</I>
&gt;<i> started Apr 19 10:19:18 raspberrypi squid[1283]: Squid 
</I>
&gt;<i> Parent: (squid-1) process 1633 exited with status 1 Apr 19 
</I>
&gt;<i> 10:19:18 raspberrypi squid[1283]: Squid Parent: (squid-1) 
</I>
&gt;<i> process 1633 will not be restarted due to repeated, frequent 
</I>
&gt;<i> failures Apr 19 10:19:18 raspberrypi squid[1283]: Exiting due 
</I>
&gt;<i> to repeated, frequent failures Apr 19 10:19:18 raspberrypi 
</I>
&gt;<i> systemd[1]: squid.service: Daemon never wrote its PID file. Failing.
</I>
&gt;<i> Apr 19 10:19:18 raspberrypi systemd[1]: Failed to start LSB: 
</I>
&gt;<i> Squid HTTP Proxy version 3.x.
</I>
&gt;<i> Apr 19 10:19:18 raspberrypi systemd[1]: squid.service: Unit 
</I>
&gt;<i> entered failed state.
</I>
&gt;<i> Apr 19 10:19:18 raspberrypi systemd[1]: squid.service: Failed 
</I>
&gt;<i> with result 'resources'.
</I>
&gt;<i> 
</I>
&gt;<i> Any ideas?
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> ________________________________
</I>
&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>
&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>
&gt;<i> Sent: Wednesday, 19 April 2017, 5:22
</I>
&gt;<i> Subject: Re: [squid-users] HTTPS woes
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> Olly,  Debian provides a ca-certificates package containing 
</I>
&gt;<i> the Mozilla CA list. It is updated whenever the CA set 
</I>
&gt;<i> changes. Though of course you should have apt connected to 
</I>
&gt;<i> the relevant security repository (jesse-security?) for 
</I>
&gt;<i> regular updates.
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> Amos
</I>
&gt;<i> 
</I>
&gt;<i> 
</I>
&gt;<i> On 19/04/17 03:10, Olly Lennox wrote:
</I>
&gt;<i> 
</I>
&gt;<i> Would you mind sharing the script you use?
</I>
&gt;<i> &gt; 
</I>
&gt;<i> &gt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">oliver at lennox-it.uk</A>
</I>
&gt;<i> &gt;lennox-it.uk
</I>
&gt;<i> &gt;tel: 07900 648 252
</I>
&gt;<i> &gt;
</I>
&gt;<i> 
</I>

_______________________________________________

squid-users mailing list

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>

<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015019.html">[squid-users] HTTPS woes
</A></li>
	<LI>Next message (by thread): <A HREF="015024.html">[squid-users] HTTPS woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15022">[ date ]</a>
              <a href="thread.html#15022">[ thread ]</a>
              <a href="subject.html#15022">[ subject ]</a>
              <a href="author.html#15022">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
