<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Intermittent 409 Error to google.com
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Intermittent%20409%20Error%20to%20google.com&In-Reply-To=%3C1502957939687-4683329.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016144.html">
   <LINK REL="Next"  HREF="016146.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Intermittent 409 Error to google.com</H1>
    <B>hoje</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Intermittent%20409%20Error%20to%20google.com&In-Reply-To=%3C1502957939687-4683329.post%40n4.nabble.com%3E"
       TITLE="[squid-users] Intermittent 409 Error to google.com">hazri at ymail.com
       </A><BR>
    <I>Thu Aug 17 08:18:59 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016144.html">[squid-users] Squid custom error pages and javascript/css	url	sources
</A></li>
        <LI>Next message (by thread): <A HREF="016146.html">[squid-users] Intermittent 409 Error to google.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16145">[ date ]</a>
              <a href="thread.html#16145">[ thread ]</a>
              <a href="subject.html#16145">[ subject ]</a>
              <a href="author.html#16145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have setup a squid server (squid-3.5.26-20170702-r14182) to filter
http/https. It was working fine with up to 90 users except one thing. Few
PCs  would not be able connect to https sites (e.g google,yahoo,facebook)
intermittently. By clearing SSL State in user PCs (Windows-&gt;Control
Panel-&gt;Internet Properties) , it helps sometime (sometime not). Please
advice. Thank you.

my squid setup
----------------
(WAN)---(router)---(linux+bridge+squid)---(user)

e.g access.log
---------------
1502955689.139      0 10.40.21.24 TAG_NONE/409 4088 CONNECT
www.google.com:443 - HIER_NONE/- text/html

my squid.conf
---------------
max_filedesc 65535
dns_v4_first on
request_timeout 5 minutes

acl localnet src 10.0.0.0/8     # RFC1918 possible internal network
acl localnet src fc00::/7       # RFC 4193 local private network range
acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
machines
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl CONNECT method CONNECT

http_access deny !Safe_ports
http_access allow localhost manager
http_access allow localnet manager
http_access deny manager
http_access allow localnet
http_access allow localhost
http_access deny all

http_port 0.0.0.0:3128 intercept
http_port 0.0.0.0:3130
https_port 0.0.0.0:3129 intercept ssl-bump connection-auth=off
cert=/etc/squid/squidCA.pem

cache_mem 256 MB
always_direct allow all
sslproxy_cert_error allow all
sslproxy_flags DONT_VERIFY_PEER

acl test ssl::server_name &quot;/etc/squid/test.txt&quot;
acl step1 at_step SslBump1
ssl_bump peek step1
ssl_bump terminate test
ssl_bump splice all
sslcrtd_program /usr/lib/squid/ssl_crtd -s /var/lib/ssl_db -M 4MB

cache_dir ufs /var/spool/squid 15360 16 256
cache_swap_low 87
cache_swap_high 90

coredump_dir /var/spool/squid

refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320

url_rewrite_program /usr/bin/squidGuard
redirect_program /usr/bin/squidGuard -c /etc/squidguard/squidGuard.conf





--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Intermittent-409-Error-to-google-com-tp4683329.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Intermittent-409-Error-to-google-com-tp4683329.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016144.html">[squid-users] Squid custom error pages and javascript/css	url	sources
</A></li>
	<LI>Next message (by thread): <A HREF="016146.html">[squid-users] Intermittent 409 Error to google.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16145">[ date ]</a>
              <a href="thread.html#16145">[ thread ]</a>
              <a href="subject.html#16145">[ subject ]</a>
              <a href="author.html#16145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
