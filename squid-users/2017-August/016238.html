<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Reverse Proxy and WebDAV caching
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Reverse%20Proxy%20and%20WebDAV%20caching&In-Reply-To=%3CAM5PR0901MB0898A8E95E8E01F12B8CDD47E19C0%40AM5PR0901MB0898.eurprd09.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016236.html">
   <LINK REL="Next"  HREF="016239.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Reverse Proxy and WebDAV caching</H1>
    <B>Olivier MARCHETTA</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Reverse%20Proxy%20and%20WebDAV%20caching&In-Reply-To=%3CAM5PR0901MB0898A8E95E8E01F12B8CDD47E19C0%40AM5PR0901MB0898.eurprd09.prod.outlook.com%3E"
       TITLE="[squid-users] Squid Reverse Proxy and WebDAV caching">olivier.marchetta at outlook.com
       </A><BR>
    <I>Wed Aug 30 10:17:06 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016236.html">[squid-users] Squid Reverse Proxy and WebDAV caching
</A></li>
        <LI>Next message (by thread): <A HREF="016239.html">[squid-users] Squid Reverse Proxy and WebDAV caching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16238">[ date ]</a>
              <a href="thread.html#16238">[ thread ]</a>
              <a href="subject.html#16238">[ subject ]</a>
              <a href="author.html#16238">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Amos,

This morning, for some reasons, I can't reproduce the Hits in the memory.
Squid is only routed for tenant.sharepoint.com so I don't know what I was Hitting yesterday.

But I have collected extended info. 
I repeatedly loaded the same .jpg file several times.
Always a Miss (high latency to access the file).
Information below:

Logs from the client (by Fiddler)
-------------------------------------------------------------------------
GET /sites/Marketing/Shared%20Documents/test_img_1.jpg HTTP/1.1
Cache-Control: no-cache
Connection: Keep-Alive
Pragma: no-cache
User-Agent: Microsoft-WebDAV-MiniRedir/10.0.14393
translate: f
Host: tenant.sharepoint.com
Cookie: FedAuth=*

HTTP/1.1 200 OK
Cache-Control: private,max-age=0
Content-Length: 1708509
Content-Type: image/jpeg
Expires: Tue, 15 Aug 2017 09:53:27 GMT
Last-Modified: Tue, 29 Aug 2017 14:06:14 GMT
Accept-Ranges: bytes
ETag: &quot;{852B897C-67C8-4620-AC40-53FB915EB62D},7&quot;
P3P: CP=&quot;ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI&quot;
Set-Cookie: rtFa=*; domain=sharepoint.com; path=/; secure; HttpOnly
Set-Cookie: FedAuth=*; path=/; secure; HttpOnly
Set-Cookie: rtFa=*; domain=sharepoint.com; path=/; secure; HttpOnly
Set-Cookie: FedAuth=*; path=/; secure; HttpOnly
X-SharePointHealthScore: 0
ResourceTag: rt:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">852B897C-67C8-4620-AC40-53FB915EB62D at 00000000007</A>
Public-Extension: <A HREF="http://schemas.microsoft.com/repl-2">http://schemas.microsoft.com/repl-2</A>
SPRequestGuid: c24b149e-009e-4000-7792-b7ee64e3b853
request-id: c24b149e-009e-4000-7792-b7ee64e3b853
Strict-Transport-Security: max-age=31536000
X-FRAME-OPTIONS: SAMEORIGIN
SPRequestDuration: 320
SPIisLatency: 6
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 16.0.0.6823
X-Content-Type-Options: nosniff
X-MS-InvokeApp: 1; RequireReadOnly
X-MSEdge-Ref: Ref A: 5BF5463E978A400CB13978F6A380BACF Ref B: AMS04EDGE0816 Ref C: 2017-08-30T09:53:27Z
Date: Wed, 30 Aug 2017 09:53:26 GMT
X-Cache: MISS from squidserver.local
Via: 1.1 squidserver.local (squid/3.5.26)
Connection: keep-alive
-------------------------------------------------------------------------


Log from the Squid server - cache.log
-------------------------------------------------------------------------
----------
2017/08/30 10:53:10.401 kid1| 11,2| http.cc(2230) sendRequest: HTTP Server local=123.123.123.123:54129 remote=13.107.6.151:443 FD 22 flags=1
2017/08/30 10:53:10.401 kid1| 11,2| http.cc(2231) sendRequest: HTTP Server REQUEST:
----------
GET /sites/Marketing/Shared%20Documents/test_img_1.jpg HTTP/1.1
Pragma: no-cache
User-Agent: Microsoft-WebDAV-MiniRedir/10.0.14393
Translate: f
Cookie: FedAuth=*
Host: tenant.sharepoint.com
Via: 1.1 sharepoint.virtualdesk.cloud (squid/3.5.26)
Surrogate-Capability: sharepoint.virtualdesk.cloud=&quot;Surrogate/1.0&quot;
X-Forwarded-For: 92.222.48.79
Cache-Control: no-cache
Connection: keep-alive


----------
2017/08/30 10:53:10.765 kid1| ctx: enter level  0: '<A HREF="https://olicomp.sharepoint.com/sites/Marketing/Shared%20Documents/test_img_1.jpg">https://olicomp.sharepoint.com/sites/Marketing/Shared%20Documents/test_img_1.jpg</A>'
2017/08/30 10:53:10.765 kid1| 11,2| http.cc(735) processReplyHeader: HTTP Server local=123.123.123.123:54129 remote=13.107.6.151:443 FD 22 flags=1
2017/08/30 10:53:10.765 kid1| 11,2| http.cc(736) processReplyHeader: HTTP Server REPLY:
---------
HTTP/1.1 200 OK
Cache-Control: private,max-age=0
Content-Length: 1708509
Content-Type: image/jpeg
Expires: Tue, 15 Aug 2017 09:53:27 GMT
Last-Modified: Tue, 29 Aug 2017 14:06:14 GMT
Accept-Ranges: bytes
ETag: &quot;{852B897C-67C8-4620-AC40-53FB915EB62D},7&quot;
P3P: CP=&quot;ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI&quot;
Set-Cookie: rtFa=*; domain=sharepoint.com; path=/; secure; HttpOnly
Set-Cookie: FedAuth=*=; path=/; secure; HttpOnly
Set-Cookie: rtFa=*; domain=sharepoint.com; path=/; secure; HttpOnly
Set-Cookie: FedAuth=*=; path=/; secure; HttpOnly
X-SharePointHealthScore: 0
ResourceTag: rt:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">852B897C-67C8-4620-AC40-53FB915EB62D at 00000000007</A>
Public-Extension: <A HREF="http://schemas.microsoft.com/repl-2">http://schemas.microsoft.com/repl-2</A>
SPRequestGuid: c24b149e-009e-4000-7792-b7ee64e3b853
request-id: c24b149e-009e-4000-7792-b7ee64e3b853
Strict-Transport-Security: max-age=31536000
X-FRAME-OPTIONS: SAMEORIGIN
SPRequestDuration: 320
SPIisLatency: 6
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 16.0.0.6823
X-Content-Type-Options: nosniff
X-MS-InvokeApp: 1; RequireReadOnly
X-MSEdge-Ref: Ref A: 5BF5463E978A400CB13978F6A380BACF Ref B: AMS04EDGE0816 Ref C: 2017-08-30T09:53:27Z
Date: Wed, 30 Aug 2017 09:53:26 GMT
-------------------------------------------------------------------------

Log from the Squid server - access.log
-------------------------------------------------------------------------
TCP_MISS/200 1712549 GET <A HREF="https://tenant.sharepoint.com/sites/Marketing/Shared%20Documents/test_img_1.jpg">https://tenant.sharepoint.com/sites/Marketing/Shared%20Documents/test_img_1.jpg</A> - FIRSTUP_PARENT/13.107.6.151 image/jpeg


Any help for the analysis would be welcome.


Regards,
Olivier MARCHETTA
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016236.html">[squid-users] Squid Reverse Proxy and WebDAV caching
</A></li>
	<LI>Next message (by thread): <A HREF="016239.html">[squid-users] Squid Reverse Proxy and WebDAV caching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16238">[ date ]</a>
              <a href="thread.html#16238">[ thread ]</a>
              <a href="subject.html#16238">[ subject ]</a>
              <a href="author.html#16238">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
