<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20net%3A%3Aerr_cert_common_name_invalid%20just%20in%20squid%0A%20page%20with%20dstdomain%20block&In-Reply-To=%3Cf79d0f42-90d3-ddc1-f4ac-507318591860%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017092.html">
   <LINK REL="Next"  HREF="017094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20net%3A%3Aerr_cert_common_name_invalid%20just%20in%20squid%0A%20page%20with%20dstdomain%20block&In-Reply-To=%3Cf79d0f42-90d3-ddc1-f4ac-507318591860%40measurement-factory.com%3E"
       TITLE="[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Dec  5 21:08:51 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017092.html">[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block
</A></li>
        <LI>Next message (by thread): <A HREF="017094.html">[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17093">[ date ]</a>
              <a href="thread.html#17093">[ thread ]</a>
              <a href="subject.html#17093">[ subject ]</a>
              <a href="author.html#17093">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/05/2017 12:33 PM, erdosain9 wrote:

&gt;<i> i dont get it, how this is possible, if the bumping is working well. 
</I>
Depending on your configuration and traffic, Squid may have more origin
server information when generating certificates for (future)
successfully bumped connections compared to when generating certificates
for (future) error responses. Lack of information often leads to bumping
failures.


&gt;<i> This is log from Chrome with port 
</I>
I did not find the client source port in your access log lines. 80 and
443 are server ports. If you were using the correct %&gt;p code, try the
opposite one (%&lt;p) and file a bug report. You can always log both, of
course.

Also, to reduce analysis time in the future, while working on this
specific thread/question, please post only access log lines related to a
single problematic TCP connection that starts with a CONNECT request.
There is no need to post other/unrelated traffic.


&gt;<i> &quot;How do you compare the two certificates? &quot;
</I>&gt;<i> 
</I>&gt;<i> I see the certificate, and look detail (both, firefox and chrome).
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t376870/Captura_de_pantalla_de_2017-12-05_16-25-48.png">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t376870/Captura_de_pantalla_de_2017-12-05_16-25-48.png</A>&gt; 
</I>
That screenshot does not show the certificate detail, so I cannot
confirm or deny your claim that the CN is the same in both FireFox and
Chrome cases. To see certificate details, you need to (at least) click
on the &quot;View Certificate&quot; button shown on that screenshot.


&gt;<i> is the same CN :squid.mydomain.lan
</I>
That CN is wrong for bumped connections to Facebook (or WhatsApp). If
that is indeed the certificate CN for the error response connection, and
that connection was trying to get to Facebook (or WhatsApp), then Chrome
may be telling you the truth!

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017092.html">[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block
</A></li>
	<LI>Next message (by thread): <A HREF="017094.html">[squid-users] net::err_cert_common_name_invalid just in squid page with dstdomain block
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17093">[ date ]</a>
              <a href="thread.html#17093">[ thread ]</a>
              <a href="subject.html#17093">[ subject ]</a>
              <a href="author.html#17093">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
