<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 503 issue after accessing https svn
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20503%20issue%20after%20accessing%20https%20svn&In-Reply-To=%3C8894a268-4e5d-22ff-44a8-47b0f5d56d76%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017098.html">
   <LINK REL="Next"  HREF="017104.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 503 issue after accessing https svn</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20503%20issue%20after%20accessing%20https%20svn&In-Reply-To=%3C8894a268-4e5d-22ff-44a8-47b0f5d56d76%40treenet.co.nz%3E"
       TITLE="[squid-users] 503 issue after accessing https svn">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Dec  6 10:18:35 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017098.html">[squid-users] 503 issue after accessing https svn
</A></li>
        <LI>Next message (by thread): <A HREF="017104.html">[squid-users] Problem using auth digest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17101">[ date ]</a>
              <a href="thread.html#17101">[ thread ]</a>
              <a href="subject.html#17101">[ subject ]</a>
              <a href="author.html#17101">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/12/17 21:07, G~D~Lunatic wrote:
&gt;<i> my squid is a transparent proxy. and the problem is that i can't access 
</I>&gt;<i> the svn server.
</I>&gt;<i> the access.log shows that
</I>&gt;<i> 1512545348.844&#160;&#160;&#160; 380 192.168.51.15 TAG_NONE/200 0 CONNECT 
</I>&gt;<i> 192.168.52.6:443 - ORIGINAL_DST/192.168.52.6 -
</I>&gt;<i> 1512545348.920&#160;&#160;&#160;&#160;&#160; 0 192.168.51.15 TAG_NONE/503 4324 OPTIONS 
</I>&gt;<i> <A HREF="https://192.168.52.6/svn/WATMdev/trunk/development/third_period/icapServer">https://192.168.52.6/svn/WATMdev/trunk/development/third_period/icapServer</A> 
</I>&gt;<i> - HIER_NONE/- text/html
</I>&gt;<i> 
</I>&gt;<i> but when i use splice step . the access is normal. so i want to know  
</I>&gt;<i> what's the problem.
</I>&gt;<i> 
</I>
You will have to check the 503 that Squid is delivering there.

There does not appear to be any server name known, which might have 
something to do with it. Its not easy to generate a proper server 
certificate without a server name.



&gt;<i> Here is my configure
</I>&gt;<i> 
</I>&gt;<i> https_port 192.168.51.200:3129 intercept ssl-bump connection-auth=off 
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB 
</I>&gt;<i> cert=/usr/local/squid/ssl_cert/myCA.pem 
</I>&gt;<i> key=/usr/local/squid/ssl_cert/myCA.pem options=NO_SSLv3,NO_SSLv2
</I>&gt;<i> 
</I>
It may have something to with these restrictions against SSLv2 and v3.

Do you have anything similar on the sslproxy_* options?

&gt;<i> 
</I>&gt;<i> acl broken_sites ssl::server_name matchweb.sports.qq.com
</I>&gt;<i> acl ssl_step1 at_step SslBump1
</I>&gt;<i> acl ssl_step2 at_step SslBump2
</I>&gt;<i> acl ssl_step3 at_step SslBump3
</I>&gt;<i> ssl_bump splice broken_sites
</I>&gt;<i> #ssl_bump splice all
</I>&gt;<i> ssl_bump stare ssl_step1
</I>
&lt;<A HREF="https://wiki.squid-cache.org/Features/SslPeekAndSplice#Limitations">https://wiki.squid-cache.org/Features/SslPeekAndSplice#Limitations</A>&gt;
The splice above is likely not possible to be done with the step1 or 
step2 data after this stare happens.
  Note that is a *maybe*. You will have to check the traffic, the error 
messages etc to know for sure what is going on.

&gt;<i> ssl_bump bump ssl_step2
</I>&gt;<i> ssl_bump terminate ssl_step3
</I>&gt;<i> 
</I>
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017098.html">[squid-users] 503 issue after accessing https svn
</A></li>
	<LI>Next message (by thread): <A HREF="017104.html">[squid-users] Problem using auth digest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17101">[ date ]</a>
              <a href="thread.html#17101">[ thread ]</a>
              <a href="subject.html#17101">[ subject ]</a>
              <a href="author.html#17101">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
