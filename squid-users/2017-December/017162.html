<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Groups and authorization SQUID
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Groups%20and%20authorization%20SQUID&In-Reply-To=%3C8eb9c36c-3880-1bda-78d3-9412d8eed02c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017154.html">
   <LINK REL="Next"  HREF="017186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Groups and authorization SQUID</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Groups%20and%20authorization%20SQUID&In-Reply-To=%3C8eb9c36c-3880-1bda-78d3-9412d8eed02c%40treenet.co.nz%3E"
       TITLE="[squid-users] Groups and authorization SQUID">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Dec 12 01:03:22 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017154.html">[squid-users] Groups and authorization SQUID
</A></li>
        <LI>Next message (by thread): <A HREF="017186.html">[squid-users] Groups and authorization SQUID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17162">[ date ]</a>
              <a href="thread.html#17162">[ thread ]</a>
              <a href="subject.html#17162">[ subject ]</a>
              <a href="author.html#17162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/12/17 09:48, Edwin Quijada wrote:
&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> *From:* Antony Stone
</I>&gt;<i> On Saturday 09 December 2017 at 15:35:51, Edwin Quijada wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> &gt; On Friday 08 December 2017 at 22:08:33, Edwin Quijada wrote:
</I>&gt;&gt;<i> &gt; 
</I>&gt;&gt;<i> &gt; &gt; I have 4 different groups in my company each group has access different
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Please explain what &quot;access different&quot; means.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The first group has accees to 2 pages, second 3 differents pages and&#160; 3 and
</I>&gt;&gt;<i> 4 everything
</I>&gt;<i> 
</I>&gt;<i> Okay, understood.
</I>&gt;<i> 
</I>
FYI: please be aware that HTTP has no concept of &quot;page&quot;. That is a human 
UI concept. Squid and HTTP deal only with messages about URLs. A &quot;page&quot; 
as we know it can be many different transactions and URL messages.

We can get into that more later when you have auth working, just be 
aware for now that there is no natural connection between auth 
credentials and &quot;page&quot;.


&gt;&gt;<i> &gt; &gt; These groups and users are in a remote server
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; What sort of server?&#160; How are the groups defined?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It is a web server
</I>&gt;<i> 
</I>&gt;<i> Er, okay...
</I>&gt;<i> 
</I>&gt;&gt;<i> &gt; &gt; that I use with a webservice
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &gt; What does &quot;webservice&quot; mean?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Remote method/function that respond me when I sent&#160; user/pass this respond
</I>&gt;&gt;<i> me with the group that user belongs I have another method/function/script
</I>&gt;&gt;<i> by http that respond me what is the group that user belongs
</I>&gt;<i> 
</I>&gt;<i> Okay, I guess it might be possible to get Squid to use ACLs based on the
</I>&gt;<i> result of an HTTP request, but I've never seen it done like this before.
</I>&gt;<i> 
</I>&gt;<i> This part is not a problem for me.
</I>&gt;<i> 
</I>&gt;<i> Maybe someone else on the list can suggest how this might be made to work.
</I>&gt;<i> 
</I>&gt;&gt;<i> &gt; &gt; so with I have created a helper for authorization
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Tell us how this helper works.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I thought that using a helper for autorization I can restricted the pages
</I>&gt;&gt;<i> used for each member group
</I>&gt;<i> 
</I>&gt;<i> Have you created a helper, or not?
</I>&gt;<i> Yes!!
</I>&gt;<i> 
</I>&gt;<i> If you have created one, please tell us how it works.
</I>&gt;<i> 
</I>&gt;<i> This helper that I created
</I>&gt;<i> &lt;?php
</I>&gt;<i> 
</I>&gt;<i> $f = fopen(&quot;<A HREF="php://stdin">php://stdin</A>&quot;, &quot;r&quot;);
</I>&gt;<i> while (!(feof($f))) {
</I>&gt;<i>  &#160;&#160;&#160; $line = fgets($f);
</I>&gt;<i>  &#160;&#160;&#160; if ($line) {
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; $fields = explode(' ', trim($line));
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; $username = rawurldecode($fields[0]);
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; $password = rawurldecode($fields[1]);
</I>&gt;<i> //
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if ($username==&quot;edwin&quot; &amp;&amp;&#160; $password==&quot;1234&quot;)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fwrite(STDOUT, &quot;OK\n&quot;);
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; else
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fwrite(STDOUT, &quot;ERR\n&quot;);
</I>&gt;<i>  &#160;&#160;&#160; }
</I>&gt;<i> }
</I>&gt;<i> ?&gt;
</I>&gt;<i> This helper is just for testing , but when I tested it doent work
</I>&gt;<i> 
</I>
What are your squid.conf settings using that helper?


FYI: PHP has known problems that prevent it being a successful helper 
language most of the time 
&lt;<A HREF="https://wiki.squid-cache.org/Features/AddonHelpers#What_language_are_helper_meant_to_be_written_in.3F">https://wiki.squid-cache.org/Features/AddonHelpers#What_language_are_helper_meant_to_be_written_in.3F</A>&gt;

Squid bundles with *_fake_auth helpers you can base your code on when 
developing a custom helper. They handle the I/O with Squid properly for 
their matching Squid version and should be easily extended for doing 
actual auth checks.


&gt;&gt;<i> &gt; How does it identify one group from another?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Uhm...the structere are differents , really there are in different tables
</I>&gt;&gt;<i> in my DB that is in the server
</I>&gt;<i> 
</I>&gt;<i> So, you're doing an HTTP request to a web server, which then looks up 
</I>&gt;<i> the user
</I>&gt;<i> in a database, and returns a result as an HTTP response...
</I>&gt;<i> 
</I>&gt;<i> Surely it would be easier (and quicker / more efficient) to get Squid to
</I>&gt;<i> interrogate the database?
</I>&gt;<i> 
</I>&gt;&gt;<i> &gt; &gt; the problem is how can i do this ACL
</I>&gt;<i> 
</I>&gt;<i> I wouldn't start from there, so I hope someone else here can suggest a 
</I>&gt;<i> way of
</I>&gt;<i> getting this to work.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> What made you start with this approach in the first place?
</I>&gt;<i> 
</I>&gt;<i> Now, I changed the approach , I just want one group for everything and 
</I>&gt;<i> other, localnet restricted,instead of use 4 groups just 2 one for admin, 
</I>&gt;<i> other for
</I>&gt;<i> 
</I>
The weird thing is this use of a web server as an intermediary between 
Squid and the actual user/group database. What made you use it in the 
first place instead of connecting Squid to the database?

[ I am one of the people who can help you get it to work, but it is only 
with the trouble doing at all if there is a good reason. Auth is a 
complex enough topic already just by itself. ]

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017154.html">[squid-users] Groups and authorization SQUID
</A></li>
	<LI>Next message (by thread): <A HREF="017186.html">[squid-users] Groups and authorization SQUID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17162">[ date ]</a>
              <a href="thread.html#17162">[ thread ]</a>
              <a href="subject.html#17162">[ subject ]</a>
              <a href="author.html#17162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
