<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FTP proxy chain with native ftp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FTP%20proxy%20chain%20with%20native%20ftp&In-Reply-To=%3C8b6d84f8-a085-588d-2136-8b366406af7d%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017181.html">
   <LINK REL="Next"  HREF="017183.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FTP proxy chain with native ftp</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FTP%20proxy%20chain%20with%20native%20ftp&In-Reply-To=%3C8b6d84f8-a085-588d-2136-8b366406af7d%40treenet.co.nz%3E"
       TITLE="[squid-users] FTP proxy chain with native ftp">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Dec 12 16:56:08 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017181.html">[squid-users] FTP proxy chain with native ftp
</A></li>
        <LI>Next message (by thread): <A HREF="017183.html">[squid-users] FTP proxy chain with native ftp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17182">[ date ]</a>
              <a href="thread.html#17182">[ thread ]</a>
              <a href="subject.html#17182">[ subject ]</a>
              <a href="author.html#17182">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/12/17 04:51, Sticher, Jascha wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> we're currently upgrading our proxy environment to squid 3.5.23 (Debian Stretch) and would like to use the native FTP proxy feature to replace our old FTP proxy solution (frox).
</I>&gt;<i> 
</I>&gt;<i> Due to some design choices, we have a proxy hierarchy for HTTP as well as FTP traffic. Is there a way (yet) to tell my first squid instance to use another squid as a forward proxy with native FTP?
</I>&gt;<i> 
</I>&gt;<i> IIRC, the cache_peer directive always uses HTTP requests, so this seems as a dead end.
</I>&gt;<i> 
</I>

The FTP traffic arriving at Squids ftp_port is converted from a stream 
of FTP messages to a stream of HTTP messages for handling.

AFAIK those resulting HTTP messages can be routed through a cache_peer 
same as any other HTTP traffic. BUT at very least the peer needs to also 
have the same &quot;native FTP&quot; implementation to successfully convert them 
from HTTP back to FTP native messages on the outgoing server connections 
at the other side of the cache hierarchy.

There may be other internal state checks on the HTTP messages to make 
them get the &quot;native FTP&quot; conversion on outgoing. So YMMV.

If the peer delivery does not work you may be required to do the same 
workaround SSL-Bump sometimes requires. Do allow the front-end Squid to 
re-FTP the traffic to the appropriate server then intercept it 
independently into the backend with its own ftp_port accepting the 
&quot;native FTP&quot; coming out of the frontend.

FYI: I do know there are conversion issues with FTP &lt;-&gt; HTTP 
authentication recently uncovered and not yet resolved. So if you need 
proxy auth at all staying with Frox would be better for now.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017181.html">[squid-users] FTP proxy chain with native ftp
</A></li>
	<LI>Next message (by thread): <A HREF="017183.html">[squid-users] FTP proxy chain with native ftp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17182">[ date ]</a>
              <a href="thread.html#17182">[ thread ]</a>
              <a href="subject.html#17182">[ subject ]</a>
              <a href="author.html#17182">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
