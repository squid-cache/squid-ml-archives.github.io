<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Logs to confirm packets dropped/not forwarded by squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Logs%20to%20confirm%20packets%20dropped/not%20forwarded%20by%0A%20squid&In-Reply-To=%3C256d4781-8b41-91c0-8352-073811fb8cfe%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014393.html">
   <LINK REL="Next"  HREF="014399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Logs to confirm packets dropped/not forwarded by squid</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Logs%20to%20confirm%20packets%20dropped/not%20forwarded%20by%0A%20squid&In-Reply-To=%3C256d4781-8b41-91c0-8352-073811fb8cfe%40treenet.co.nz%3E"
       TITLE="[squid-users] Logs to confirm packets dropped/not forwarded by squid">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Feb  6 22:44:28 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014393.html">[squid-users] Logs to confirm packets dropped/not forwarded by	squid
</A></li>
        <LI>Next message (by thread): <A HREF="014399.html">[squid-users] Does squid update itself ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14396">[ date ]</a>
              <a href="thread.html#14396">[ thread ]</a>
              <a href="subject.html#14396">[ subject ]</a>
              <a href="author.html#14396">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/02/2017 7:04 a.m., Anonymous cross wrote:
&gt;<i> We are using squid with tproxy4. All the packets destined to port 80 are
</I>&gt;<i> forwarded to tproxy port 3129 using the below guide
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://wiki.squid-cache.org/Features/Tproxy4">http://wiki.squid-cache.org/Features/Tproxy4</A>
</I>&gt;<i> 
</I>&gt;<i> Normal HTTP GET requests forwarded to Squid are working fine. But we do see
</I>&gt;<i> problems with TCP segments which holds HTTP data. I am not sure how squid
</I>&gt;<i> TCP reassembly logic works. I need some way to find out where it's getting
</I>&gt;<i> dropped in squid.
</I>
As Matus said; Squid does not do any TCP level packet handling. That is
all done in the networking stack, same as for any other program.

TPROXY only affects the TCP accept() logic related to the TCP SYN
packet. Once that is over it is just a regular network socket I/O. Squid
uses the system read() for as much data as it can get. Then parses HTTP
messages out of the received data.

With &quot;debug_options 11,2&quot; configured Squid will log to cache.log all the
messages it is handling an the connection they occured on.


PS. Squid-4 logs to access.log connections which were received and
terminated or had errors before the HTTP message was received. Squid-3
just lets those connections die quietly.

HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014393.html">[squid-users] Logs to confirm packets dropped/not forwarded by	squid
</A></li>
	<LI>Next message (by thread): <A HREF="014399.html">[squid-users] Does squid update itself ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14396">[ date ]</a>
              <a href="thread.html#14396">[ thread ]</a>
              <a href="subject.html#14396">[ subject ]</a>
              <a href="author.html#14396">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
