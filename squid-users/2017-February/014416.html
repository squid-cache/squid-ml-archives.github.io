<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FTP relay with active client is broken?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FTP%20relay%20with%20active%20client%20is%20broken%3F&In-Reply-To=%3Ce5f12bb5-cbd9-2f98-6002-81e708707cb1%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014414.html">
   <LINK REL="Next"  HREF="014443.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FTP relay with active client is broken?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FTP%20relay%20with%20active%20client%20is%20broken%3F&In-Reply-To=%3Ce5f12bb5-cbd9-2f98-6002-81e708707cb1%40measurement-factory.com%3E"
       TITLE="[squid-users] FTP relay with active client is broken?">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Feb  8 16:11:32 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014414.html">[squid-users] FTP relay with active client is broken?
</A></li>
        <LI>Next message (by thread): <A HREF="014443.html">[squid-users] FTP relay with active client is broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14416">[ date ]</a>
              <a href="thread.html#14416">[ thread ]</a>
              <a href="subject.html#14416">[ subject ]</a>
              <a href="author.html#14416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/08/2017 06:10 AM, Alex wrote:

&gt;<i> I've specified
</I>&gt;<i> 'ftp_port 2121 intercept' and made squid intercept outgoing FTP
</I>&gt;<i> traffic according to the following rules:
</I>
&gt;<i> iptables -t nat -A OUTPUT -p tcp -m owner --gid-owner squid -j ACCEPT
</I>&gt;<i> iptables -t nat -A OUTPUT -p tcp --dport 21 -j REDIRECT --to-port 2121
</I>
&gt;<i> 07.02.2017, 16:23, &quot;Alex&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">gozzy at yandex.ru</A>&gt;:
</I>
&gt;&gt;<i> I thought that active mode will cause less problems, but it seems
</I>&gt;&gt;<i> that what squid tries to do is illegal. As far as I understand, in
</I>&gt;&gt;<i> active mode squid tries to connect to a client and spoofs source IP
</I>&gt;&gt;<i> address.
</I>
Since spoofing client IP addresses is common for many working Squid
interception setups doing HTTP, it has to be technically possible (i.e.,
&quot;legal&quot; in your terminology). Unfortunately, I do not know enough
low-level details to guide you further. Most likely, the FTP-specific
Squid code facilitating IP spoofing is buggy or you are doing something
wrong (or both).

FWIW, IIRC, FTP interception code has worked for many folks.

Let's hope that somebody with a working FTP interception setup speaks up.

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014414.html">[squid-users] FTP relay with active client is broken?
</A></li>
	<LI>Next message (by thread): <A HREF="014443.html">[squid-users] FTP relay with active client is broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14416">[ date ]</a>
              <a href="thread.html#14416">[ thread ]</a>
              <a href="subject.html#14416">[ subject ]</a>
              <a href="author.html#14416">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
