<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Configure squid 3.5 to use different parent proxies for different listening ports
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Configure%20squid%203.5%20to%20use%20different%20parent%20proxies%0A%20for%20different%20listening%20ports&In-Reply-To=%3CCAM1T%3DoctjBG4u0sSKU9_LH8ZQabffywkBHCr6-8E7eMeHCKxpg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014521.html">
   <LINK REL="Next"  HREF="014487.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Configure squid 3.5 to use different parent proxies for different listening ports</H1>
    <B>Damir Bagapov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Configure%20squid%203.5%20to%20use%20different%20parent%20proxies%0A%20for%20different%20listening%20ports&In-Reply-To=%3CCAM1T%3DoctjBG4u0sSKU9_LH8ZQabffywkBHCr6-8E7eMeHCKxpg%40mail.gmail.com%3E"
       TITLE="[squid-users] Configure squid 3.5 to use different parent proxies for different listening ports">damir.k.bagapov at gmail.com
       </A><BR>
    <I>Mon Feb 20 21:05:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014521.html">[squid-users] Squid 3.5.24 - Url_rewrite with ssl_bump in Transparent Mode
</A></li>
        <LI>Next message (by thread): <A HREF="014487.html">[squid-users] Configure squid 3.5 to use different parent proxies for different listening ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14486">[ date ]</a>
              <a href="thread.html#14486">[ thread ]</a>
              <a href="subject.html#14486">[ subject ]</a>
              <a href="author.html#14486">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have following configuration:

# Squid normally listens to port 3128
http_port 3128

cache_peer proxy1_address parent proxy1_port 0 proxy-only default
login=name1:pass1
never_direct allow all

And I need to configure squid in a way when all incoming requests to 3128
port will be redirected to proxy1 (as it works now), and all incoming
requests to 3127 will be redirected to proxy2. Is it possible to do?

I've tried to use ACL described here <A HREF="http://wiki.squid-cache.o">http://wiki.squid-cache.o</A>
rg/ConfigExamples/Reverse/MultipleWebservers#Other_Criteria_than_Domain

http_port 3128
http_port 3127

acl port_3128 port 3128
acl port_3127 port 3127

# 3128
cache_peer proxy01 parent 3128 0 no-query originserver name=proxy3128
cache_peer_access proxy3128 allow port_3128
cache_peer_access proxy3128 deny port_3127

# 3127
cache_peer proxy02 parent 3128 0 no-query originserver name=proxy3127
cache_peer_access proxy3127 allow port_3127
cache_peer_access proxy3127 deny port_3128

But its not working =(

-- 
Best regards,
Damir
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170220/ad577dba/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170220/ad577dba/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014521.html">[squid-users] Squid 3.5.24 - Url_rewrite with ssl_bump in Transparent Mode
</A></li>
	<LI>Next message (by thread): <A HREF="014487.html">[squid-users] Configure squid 3.5 to use different parent proxies for different listening ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14486">[ date ]</a>
              <a href="thread.html#14486">[ thread ]</a>
              <a href="subject.html#14486">[ subject ]</a>
              <a href="author.html#14486">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
