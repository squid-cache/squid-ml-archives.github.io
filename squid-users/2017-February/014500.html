<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] URL encoding in squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20encoding%20in%20squid&In-Reply-To=%3C44537d73-a70c-1bcb-b0fb-0011455f4bd2%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014497.html">
   <LINK REL="Next"  HREF="014501.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] URL encoding in squid</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20encoding%20in%20squid&In-Reply-To=%3C44537d73-a70c-1bcb-b0fb-0011455f4bd2%40treenet.co.nz%3E"
       TITLE="[squid-users] URL encoding in squid">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Feb 21 20:17:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014497.html">[squid-users] URL encoding in squid
</A></li>
        <LI>Next message (by thread): <A HREF="014501.html">[squid-users] URL encoding in squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14500">[ date ]</a>
              <a href="thread.html#14500">[ thread ]</a>
              <a href="subject.html#14500">[ subject ]</a>
              <a href="author.html#14500">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/02/2017 11:43 p.m., Anton wrote:
&gt;<i> Good day.
</I>&gt;<i> 
</I>&gt;<i> I have squid+squidguard configuration. I need to filter a lot o URLs with national
</I>&gt;<i> symbols in it. My URL list consist mostly from percent-encoded URLs. So when squid
</I>&gt;<i> checks such URLs by squidGuard it transmits URL as-is with no percent-encoding.
</I>&gt;<i> 
</I>&gt;<i> SquidGuard see no URL because it has percent-encoded this URL.
</I>&gt;<i> 
</I>&gt;<i> URL list made from &quot;zapret-info&quot; if some one knows :-). It can contain non-consistent data:
</I>&gt;<i> %-encoded URLs can be in cp1251 or utf-8 after decoding and some URLs are not encoded at all.
</I>&gt;<i> I cannot to decode URLs from % in a right way.
</I>
Ew.

&gt;<i> 
</I>&gt;<i> IMHO it is better way is to %-encode not-encoded URLs to %-encoded and to use others as is.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> So can squd+squdGuard make dial with percent-encoded URLs ?
</I>&gt;<i> 
</I>
Squid should be normalizing the %-encoding on the URLs as they arrive,
but I'm not seeing where it does that in the code so maybe not. What
SquidGuard does with them or its input data file is not under Squid control.

Also SG is very outdated and no longer maintained, you might find
ufdbGuard better able to handle this nasty input. I've bcc'd Marcus in
case there is something he can (or has) do about this type of mess in
that helper.

&gt;<i> Is it possible to path %-encoded URL to squidGuard ?
</I>
Not with Squid-3.4. The 3.5 releases have a url_rewrite_extras directive
which takes logformat codes. You could use that to send an extra
%-encoded copy of the URL to the helper in addition to the normal URL
input. (sorry there is no package yet in Debian 8 for 3.5).

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014497.html">[squid-users] URL encoding in squid
</A></li>
	<LI>Next message (by thread): <A HREF="014501.html">[squid-users] URL encoding in squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14500">[ date ]</a>
              <a href="thread.html#14500">[ thread ]</a>
              <a href="subject.html#14500">[ subject ]</a>
              <a href="author.html#14500">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
