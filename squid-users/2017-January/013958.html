<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Intercept mode failing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Intercept%20mode%20failing&In-Reply-To=%3C201701031139.38364.Antony.Stone%40squid.open.source.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013956.html">
   <LINK REL="Next"  HREF="013959.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Intercept mode failing</H1>
    <B>Antony Stone</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Intercept%20mode%20failing&In-Reply-To=%3C201701031139.38364.Antony.Stone%40squid.open.source.it%3E"
       TITLE="[squid-users] Intercept mode failing">Antony.Stone at squid.open.source.it
       </A><BR>
    <I>Tue Jan  3 10:39:38 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="013956.html">[squid-users] Intercept mode failing
</A></li>
        <LI>Next message (by thread): <A HREF="013959.html">[squid-users] Intercept mode failing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13958">[ date ]</a>
              <a href="thread.html#13958">[ thread ]</a>
              <a href="subject.html#13958">[ subject ]</a>
              <a href="author.html#13958">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tuesday 03 January 2017 at 11:13:33, Hoggins! wrote:

&gt;<i> Okay, I get that.
</I>&gt;<i> 
</I>&gt;<i> Le 03/01/2017 &#224; 10:33, Antony Stone a &#233;crit :
</I>&gt;<i> &gt; No - you must do the NAT (or REDIRECT) rule *on the Squid server*.
</I>&gt;<i> 
</I>&gt;<i> Well, my Squid server is not on the same network as my clients, so I
</I>&gt;<i> need something else than just a REDIRECT on the Squid itself.
</I>
I'm not sure you fully understand what REDIRECT does.  It changes the 
destination address of the packets which *were* going to random web servers 
around the Internet, and have now reached your Squid box, so thatthey go to 
the local address of your Squid machien instead (and therefore Squid can see 
them and process them).

&gt;<i> &gt; If you need to use policy routing to get the packets to the Squid machine
</I>&gt;<i> &gt; in the first place, that's okay, but this *must* be packet routing, not
</I>&gt;<i> &gt; address translation
</I>&gt;<i> 
</I>&gt;<i> Policy routing was my first choice, but there is one important detail in
</I>&gt;<i> my setup : between my gateway (192.168.22.10) and my Squid
</I>&gt;<i> (192.168.55.3), there's an IPSec tunnel. My gateway does not have a
</I>&gt;<i> link-local route to 192.168.55.3 so I can't add the default route to it
</I>&gt;<i> inside a routing table (I get &quot;Network is unreachable&quot;, which is expected).
</I>
So, if you can't route packets from the gateway to Squid, how was your NAT 
setup getting them there?

You said in your original posting: &quot;192.168.55.3 being the Squid server, 
directly connected to the Internet, on a network my gateway has the routes 
for&quot;, suggesting that your gateway *can* route to the Squid server.

&gt;<i> So I guess I'm stuck.
</I>
Maybe you need to do policy routing on the gateway to the IPsec endpoint, and 
then further routing from there to Squid?


Antony.

-- 
&quot;Remember: the S in IoT stands for Security.&quot;

 - Jan-Piet Mens

                                                   Please reply to the list;
                                                         please *don't* CC me.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="013956.html">[squid-users] Intercept mode failing
</A></li>
	<LI>Next message (by thread): <A HREF="013959.html">[squid-users] Intercept mode failing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13958">[ date ]</a>
              <a href="thread.html#13958">[ thread ]</a>
              <a href="subject.html#13958">[ subject ]</a>
              <a href="author.html#13958">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
