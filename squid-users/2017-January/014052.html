<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Transparent Proxy in AWS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20Proxy%20in%20AWS&In-Reply-To=%3CCAFChrgL%2BanWFYKtP4ArVokuL8REcyyTv9S4nVyUfK7Yy9JschQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014054.html">
   <LINK REL="Next"  HREF="014056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Transparent Proxy in AWS</H1>
    <B>Jason Haar</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20Proxy%20in%20AWS&In-Reply-To=%3CCAFChrgL%2BanWFYKtP4ArVokuL8REcyyTv9S4nVyUfK7Yy9JschQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Transparent Proxy in AWS">jason_haar at trimble.com
       </A><BR>
    <I>Thu Jan 12 00:39:28 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014054.html">[squid-users] TCP 403 Denied on new squid build out
</A></li>
        <LI>Next message (by thread): <A HREF="014056.html">[squid-users] squid-users Digest, Vol 29, Issue 26
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14052">[ date ]</a>
              <a href="thread.html#14052">[ thread ]</a>
              <a href="subject.html#14052">[ subject ]</a>
              <a href="author.html#14052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Dec 2, 2016 at 6:27 AM, klops &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">lo.kenneth at gmail.com</A>&gt; wrote:

&gt;<i> Does this mean the squid box has to be the overall gateway for the internal
</I>&gt;<i> network for transparrancy to work?
</I>&gt;<i>
</I>&gt;<i> The reason the proposed setup the way it is is because AWS VPC  service has
</I>&gt;<i> a service based NAT gateway which we have not low level control over and it
</I>&gt;<i> is the default gateway. We want to only route http/https traffic over to
</I>&gt;<i> squid and the rest via their NAT gateway
</I>&gt;<i>
</I>
Couldn't you configure those VPC networks so that the AWS default route is
dead by blocking all outbound (ie of no useable value to the EC2 hosts) and
tell the EC2 hosts owners to change their boot scripts to delete the
default gateway and replace it with your squid router? (which does have
Internet access). That way you are &quot;regaining control&quot; of your network, and
EC2 owners are &quot;motivated&quot; to Do The Right Thing :-)

Then there'd be no need for iptable tricks on the clients. Also means you
could apply this to Windows EC2 systems too

I'm not an AWS guru so I have no idea if that works. I'm assuming a VPC is
like a VLAN

-- 
Cheers

Jason Haar
Information Security Manager, Trimble Navigation Ltd.
Phone: +1 408 481 8171
PGP Fingerprint: 7A2E 0407 C9A6 CAF6 2B9F 8422 C063 5EBB FE1D 66D1
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170112/2a2f0bb1/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170112/2a2f0bb1/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014054.html">[squid-users] TCP 403 Denied on new squid build out
</A></li>
	<LI>Next message (by thread): <A HREF="014056.html">[squid-users] squid-users Digest, Vol 29, Issue 26
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14052">[ date ]</a>
              <a href="thread.html#14052">[ thread ]</a>
              <a href="subject.html#14052">[ subject ]</a>
              <a href="author.html#14052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
