<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] A bunch of SSL errors I am not sure why
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20A%20bunch%20of%20SSL%20errors%20I%20am%20not%20sure%20why&In-Reply-To=%3C000c01d271b1%24fbe0ced0%24f3a26c70%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014103.html">
   <LINK REL="Next"  HREF="014105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] A bunch of SSL errors I am not sure why</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20A%20bunch%20of%20SSL%20errors%20I%20am%20not%20sure%20why&In-Reply-To=%3C000c01d271b1%24fbe0ced0%24f3a26c70%24%40ngtech.co.il%3E"
       TITLE="[squid-users] A bunch of SSL errors I am not sure why">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Jan 18 17:40:39 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014103.html">[squid-users] A bunch of SSL errors I am not sure why
</A></li>
        <LI>Next message (by thread): <A HREF="014105.html">[squid-users] A bunch of SSL errors I am not sure why
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14104">[ date ]</a>
              <a href="thread.html#14104">[ thread ]</a>
              <a href="subject.html#14104">[ subject ]</a>
              <a href="author.html#14104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the detail Amos,

I noticed that couple major Root CA certificates was revoked so it could be one thing.
And can you give some more details on how to fetch the certificated using the openssl tools?
(Maybe redirect towards an article about it)
I think that if some sites are have issues then a simple script that will run the openssl tools to fetch the certificates and add them to the system can be useful for those which are running 3.5 and yet to jump into the 4.0 testing.
I can write the script that will do come of the work for these admins.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Wednesday, January 18, 2017 6:06 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] A bunch of SSL errors I am not sure why

On 19/01/2017 3:29 a.m., Sameh Onaissi wrote:
&gt;<i> Hello Eliezer, all
</I>&gt;<i> 
</I>&gt;<i> Sorry for the late reply.
</I>&gt;<i> 
</I>&gt;<i> When I configure the browser to access a non intercept port, the errors do not show up and the site is accessed without a problem.
</I>&gt;<i> 
</I>&gt;<i> The client machine has the .crt file installed, but still shows the error.
</I>&gt;<i> 
</I>&gt;<i> Other pages with errors:
</I>&gt;<i> <A HREF="http://pasteboard.co/nA20FD7om.png">http://pasteboard.co/nA20FD7om.png</A>
</I>&gt;<i> <A HREF="http://pasteboard.co/nA2yWRyTE.png">http://pasteboard.co/nA2yWRyTE.png</A>
</I>&gt;<i> 
</I>&gt;<i> Here is the second page in a browser without an intercepted port:
</I>&gt;<i> <A HREF="http://pasteboard.co/nA39CEFGU.png">http://pasteboard.co/nA39CEFGU.png</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Thanks in advance.
</I>&gt;<i> Some of these sites are used to pay company bills, so it&#8217;s important to get this issue resolves ASAP.
</I>
I assume from that first part that the most important of these sites are a small enough set to deal with as a special case without becoming a maintenance nightmare.

The error messages both show that Squid at least cannot find one of the CA required to verify the servers cert.

Soo...
 you can probably use the openssl client tool to identify and fetch the certs manually; then

1a) add the root CA (only if needed) into your machines global CA set,

1b) add any intermediary certs to the file Squid loads through sslproxy_foreign_intermediate_certs directive.
&lt;<A HREF="http://www.squid-cache.org/Doc/config/sslproxy_foreign_intermediate_certs/">http://www.squid-cache.org/Doc/config/sslproxy_foreign_intermediate_certs/</A>&gt;

OR

2) create a cache_peer to the domains server port 443, using the originserver option and sslcafile= option to specify what its CA chain is supposed to be.
&lt;<A HREF="http://www.squid-cache.org/Doc/config/cache_peer/">http://www.squid-cache.org/Doc/config/cache_peer/</A>&gt;


&gt;<i> Worth mentioning that this was not a problem about 10 days ago.
</I>
Nod, these types of things can appear out of nowhere as servers certs expire or get blacklisted, ciphers etc suddenly get rejected by browsers as insecure. TLS advocates deny it, but F*ups happen far too often in reality when dealing with certs.


&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> * Try the latest Squid-4, which can auto-download intermediate certificates.
</I>&gt;<i> 
</I>&gt;<i> Is squid-4 stable for production?
</I>&gt;<i> 
</I>
Sorry I missed this in your earlier post.

Well strictly speaking no. It still has a handful of critical bugs to be tracked down and quashed. But whether those affect you, or if they do whether its worth an occasional crash to avoid these SSL isues is a different matter.

Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014103.html">[squid-users] A bunch of SSL errors I am not sure why
</A></li>
	<LI>Next message (by thread): <A HREF="014105.html">[squid-users] A bunch of SSL errors I am not sure why
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14104">[ date ]</a>
              <a href="thread.html#14104">[ thread ]</a>
              <a href="subject.html#14104">[ subject ]</a>
              <a href="author.html#14104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
