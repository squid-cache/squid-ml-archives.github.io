<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.x: Intermediate certificates downloader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.x%3A%20Intermediate%20certificates%20downloader&In-Reply-To=%3C72ea7116-3e24-7caf-ffcc-dc39c360c4aa%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014177.html">
   <LINK REL="Next"  HREF="014189.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.x: Intermediate certificates downloader</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.x%3A%20Intermediate%20certificates%20downloader&In-Reply-To=%3C72ea7116-3e24-7caf-ffcc-dc39c360c4aa%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 4.x: Intermediate certificates downloader">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jan 23 22:59:17 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014177.html">[squid-users] Squid 4.x: Intermediate certificates downloader
</A></li>
        <LI>Next message (by thread): <A HREF="014189.html">[squid-users] Squid 4.x: Intermediate certificates downloader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14185">[ date ]</a>
              <a href="thread.html#14185">[ thread ]</a>
              <a href="subject.html#14185">[ subject ]</a>
              <a href="author.html#14185">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/01/2017 8:22 a.m., Yuri Voinov wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 24.01.2017 0:06, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> On 01/23/2017 10:41 AM, Yuri Voinov wrote:
</I>&gt;&gt;&gt;<i> 23.01.2017 23:31, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;&gt;<i> On 01/23/2017 04:28 AM, Yuri wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 2. How this feature is related to sslproxy_foreign_intermediate_certs,
</I>&gt;&gt;&gt;&gt;&gt;<i> how it can interfere with it?
</I>&gt;&gt;&gt;&gt;<i> AFAICT by looking at the code, Squid only downloads certificates that
</I>&gt;&gt;&gt;&gt;<i> Squid is missing when trying to build a complete certificate chain for a
</I>&gt;&gt;&gt;&gt;<i> given server connection. Any sslproxy_foreign_intermediate_certs are
</I>&gt;&gt;&gt;&gt;<i> used as needed during the chain building process (i.e., they are _not_
</I>&gt;&gt;&gt;&gt;<i> &quot;missing&quot;).
</I>&gt;&gt;&gt;<i> Ok, so, this file uses for complete chains, and it contains statically
</I>&gt;&gt;&gt;<i> added (manually) certs only, right?
</I>&gt;&gt;<i> Yes, the sslproxy_foreign_intermediate_certs file is maintained by the
</I>&gt;&gt;<i> Squid administrator. Squid does not update it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I.e., downloader should not save fetched intermediate CA's here,
</I>&gt;&gt;<i> Correct.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> which will be logically, isn't it?
</I>&gt;&gt;<i> I believe it is better to use the regular Squid cache for storing the
</I>&gt;&gt;<i> fetched missing certificates. I would not call abusing the
</I>&gt;&gt;<i> sslproxy_foreign_intermediate_certs file for this purpose completely
</I>&gt;&gt;<i> illogical, but such abuse would create more problems than it would solve
</I>&gt;&gt;<i> IMO. We have also considered using a dedicated storage for the fetched
</I>&gt;&gt;<i> missing certificates, but have decided (for many reasons) that it would
</I>&gt;&gt;<i> be worse than reusing the existing caching infrastructure.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> FWIW, IMO, storing the generated fake certificates in the regular Squid
</I>&gt;&gt;<i> cache would also be better than using an OpenSSL-administered database.
</I>&gt;<i> Exactly.
</I>
There is one drawback to that suggestion though.

The certs which are downloaded are publicly available information and
intended to be such. Anyone can download them from source just like
browsers and Squid-4 do. So there is no harm in having the data stored
in a semi-insecure cache.

The cert generated by Squid are pollution as far as TLS is concerned.
Intended for use only by that proxy installation with the specific set
of details involved with the origin certificate on that connection.
Re-usability is purely a bonus. People could get into connectivity
trouble if they were stored long-term like other cache items.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014177.html">[squid-users] Squid 4.x: Intermediate certificates downloader
</A></li>
	<LI>Next message (by thread): <A HREF="014189.html">[squid-users] Squid 4.x: Intermediate certificates downloader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14185">[ date ]</a>
              <a href="thread.html#14185">[ thread ]</a>
              <a href="subject.html#14185">[ subject ]</a>
              <a href="author.html#14185">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
