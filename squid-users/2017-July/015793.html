<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Has anyone seen v3.5.x.x authenication work in an all windows environment?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Has%20anyone%20seen%20v3.5.x.x%20authenication%20work%20in%20an%0A%20all%20windows%20environment%3F&In-Reply-To=%3Cbb56f829-1ef4-6ddf-45e3-c7f5780871fe%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015792.html">
   <LINK REL="Next"  HREF="015791.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Has anyone seen v3.5.x.x authenication work in an all windows environment?</H1>
    <B>Dijxie</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Has%20anyone%20seen%20v3.5.x.x%20authenication%20work%20in%20an%0A%20all%20windows%20environment%3F&In-Reply-To=%3Cbb56f829-1ef4-6ddf-45e3-c7f5780871fe%40gmail.com%3E"
       TITLE="[squid-users] Has anyone seen v3.5.x.x authenication work in an all windows environment?">dijxie at gmail.com
       </A><BR>
    <I>Mon Jul  3 11:33:31 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015792.html">[squid-users] Has anyone seen v3.5.x.x authenication work in an	all windows environment?
</A></li>
        <LI>Next message (by thread): <A HREF="015791.html">[squid-users] How long this object should be left in the cache?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15793">[ date ]</a>
              <a href="thread.html#15793">[ thread ]</a>
              <a href="subject.html#15793">[ subject ]</a>
              <a href="author.html#15793">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>W dniu 03.07.2017 o 09:43, Todd Pearson pisze:
&gt;<i>
</I>&gt;<i> I have spent the past few days working to get the latest version 
</I>&gt;<i> working in an all windows environment.  I am unable to get kerberos 
</I>&gt;<i> authentication to work.  I am struggling with getting the keytab file 
</I>&gt;<i> correct.
</I>&gt;<i> Wondering if there is anyone who has seen it actually work in an all 
</I>&gt;<i> windows environment.  I have had earlier version (v2.X stable) with 
</I>&gt;<i> NTLM authentication, but unfortunately I do not have the binaries to 
</I>&gt;<i> implement in v3.5.x.x.
</I>&gt;<i>
</I>&gt;<i> I continue to struggle to find the secret forumula for SPN and keytab.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Todd
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

Hi,

I have 4 squid serves, 3 of them are 3.5.9 @centos 7.x. Everything is 
working fine, both pure NTLM and NEGOTIATE helpers are working 
flawlessly. I've created local group on squid servers like 
keytab-readers, then:
chown root:keytab-readers /etc/krb5.keytab
chmod 740 /etc/keytab-readers
and added squid to keytab-readers.

Squid clients are windows workstations, mostly 8.1 and 10.

Why do you need to have Squid on Windows server so badly? Less 
documentation, less support. And nowadays, my guess is  almost every MS 
security update can brake things down.

My guess is when you're using squid on Windows server, you have to, 
alternatively:
1. Run squid on NT AUTHORITY/SYSTEM or NT AUTHORITY/NETWORK SERVICE 
account and put SPN  squid_accessible_name to AD machine account. So, if 
Your squid DNS name is squidproxy.corpo.local and your server name is 
srvSquid01.corpo.local, machine account srvSquid01$ has to have 
HOST/squidproxy SPN also.
2. Run squid on dedicated domain account (user account). Create user 
like &quot;squid01&quot;, give it all nessecary permissions on squid server and 
then give this user SPN. And there's the problem: what kind of SPN in 
this configuration... I would say that HTTP/squidproxy, and then in DNS 
you'll have to have presumably CNAME (not A) pointing squidproxy to 
srvSquid01.corpo.local. And domain user squid01 will have to read acces 
to keytab, as well as keytab will have to have apropriate content (it 
should be a user, not machine keytab).

<A HREF="https://support.microsoft.com/en-us/help/929650/how-to-use-spns-when-you-configure-web-applications-that-are-hosted-on">https://support.microsoft.com/en-us/help/929650/how-to-use-spns-when-you-configure-web-applications-that-are-hosted-on</A> 


-- 
Greets, Dijx

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170703/f7428a0e/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170703/f7428a0e/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015792.html">[squid-users] Has anyone seen v3.5.x.x authenication work in an	all windows environment?
</A></li>
	<LI>Next message (by thread): <A HREF="015791.html">[squid-users] How long this object should be left in the cache?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15793">[ date ]</a>
              <a href="thread.html#15793">[ thread ]</a>
              <a href="subject.html#15793">[ subject ]</a>
              <a href="author.html#15793">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
