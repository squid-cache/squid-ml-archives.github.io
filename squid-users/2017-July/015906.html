<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Does squid generates/adds additional HTTP headers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20squid%20generates/adds%20additional%20HTTP%20headers%3F&In-Reply-To=%3C96be5c39-361f-100d-9c23-f6ef302cc141%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015888.html">
   <LINK REL="Next"  HREF="015882.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Does squid generates/adds additional HTTP headers?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20squid%20generates/adds%20additional%20HTTP%20headers%3F&In-Reply-To=%3C96be5c39-361f-100d-9c23-f6ef302cc141%40treenet.co.nz%3E"
       TITLE="[squid-users] Does squid generates/adds additional HTTP headers?">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jul 12 14:13:49 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015888.html">[squid-users] Does squid generates/adds additional HTTP headers?
</A></li>
        <LI>Next message (by thread): <A HREF="015882.html">[squid-users] WARNING: Disk space over limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15906">[ date ]</a>
              <a href="thread.html#15906">[ thread ]</a>
              <a href="subject.html#15906">[ subject ]</a>
              <a href="author.html#15906">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/07/17 04:36, Sonya Roy wrote:
&gt;<i> As Alex mentioned its not possible to do with squid. I modified the 
</I>&gt;<i> squid source code to do this a month ago. Its not hard to do, you will 
</I>&gt;<i> only need to modify http.cc and client_side.cc a bit.
</I>&gt;<i> 
</I>
What you did and what avi_h is asking about does not match what avi_h 
says they want to happen.


On 12/07/17 07:00, avi_h wrote:
 &gt; make
 &gt; some server(s) think that the
 &gt; request is coming directly from a user agent



Even sending the entire HTTP headers as-is through to the server cannot 
prevent proxy detection if the server is actively trying to detect it. 
Some naive services look only at the headers, others inject code into 
the client to scan the Browsers view of the network environment and send 
that back to the server for comparison of what the server environment 
contains - yelling &quot;proxy&quot; if anything appears different, regardless of 
whether a proxy actually exists.


So as Alex hinted but did not state - what would help is info about the 
specific websites/services one is trying to work around. Narrowing the 
problem down to certain sites, and what behaviour you want to stop them 
having would be a great first step.


FWIW; in my experience most of the real traffic problems are not caused 
by proxy detection at all. That seems to be purely users/admin getting 
thrown off by other equally broken problem-detection websites, or 
blaming the proxy when something else is causing problems.

The real problem is usually servers dying in horrible ways when 
unexpected HTTP headers are given to them - even fully standardized 
headers like Via (RFC 2068, 2616, 7231) with standard values is beyond 
some server scripts ability to parse.

Not many web dev seems to understand that HTTP headers can contain 
arbitrary-length comments. &quot;via off&quot; is not so much preventing the proxy 
causing problems, but preventing clients behind the proxy injecting 
bogus XSS code into the server script through it - by granting any 
attacker more complete anonimity to do other attacks.

(sorry for the rant - I'm just tired of people thinking that hiding 
their proxy actually helps).

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015888.html">[squid-users] Does squid generates/adds additional HTTP headers?
</A></li>
	<LI>Next message (by thread): <A HREF="015882.html">[squid-users] WARNING: Disk space over limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15906">[ date ]</a>
              <a href="thread.html#15906">[ thread ]</a>
              <a href="subject.html#15906">[ subject ]</a>
              <a href="author.html#15906">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
