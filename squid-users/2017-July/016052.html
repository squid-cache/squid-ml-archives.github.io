<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSL options on different http_port resolving into a single config for all ports
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20options%20on%20different%20http_port%20resolving%20into%0A%20a%20single%20config%20for%20all%20ports&In-Reply-To=%3Cfa982de3-3b2e-7fd5-1488-eb1ec3eab663%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016044.html">
   <LINK REL="Next"  HREF="016058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSL options on different http_port resolving into a single config for all ports</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20options%20on%20different%20http_port%20resolving%20into%0A%20a%20single%20config%20for%20all%20ports&In-Reply-To=%3Cfa982de3-3b2e-7fd5-1488-eb1ec3eab663%40treenet.co.nz%3E"
       TITLE="[squid-users] SSL options on different http_port resolving into a single config for all ports">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jul 28 04:24:42 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016044.html">[squid-users] SSL options on different http_port resolving into a single config for all ports
</A></li>
        <LI>Next message (by thread): <A HREF="016058.html">[squid-users] SSL options on different http_port resolving into a single config for all ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16052">[ date ]</a>
              <a href="thread.html#16052">[ thread ]</a>
              <a href="subject.html#16052">[ subject ]</a>
              <a href="author.html#16052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/07/17 19:57, Wahaj Ali wrote:
&gt;<i> Resending the logs as they were not formatted correctly:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> First request going to port 3128
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at madmin-VirtualBox</A>:/home/madmin# export https_proxy=&quot;127.0.0.1:3128&quot;
</I>
AFAIK, the above is in valid value for the https_proxy variable. It is 
missing the URL scheme which tells curl whether HTTP or TLS is used to 
connect to the proxy.



Since you are sending identical plain-text CONNECT requests in the two 
ports the first one to receive the request forms the security context 
used by the TLS server connection.

I believe what you are seeing is a result of the fake server 
certificates being cached. The client requested domain is identical for 
all tests, so the cached cert should be identical. However curl is 
rejecting the certificate generated from SSLv3-enabled server connections.

Try with the dynamic_cert_mem_cache_size=0 option to disable cert caching.


Also, I highly recommend leaving port 443 for encrypted connections 
(https_port directive). Using plain-text over it (http_port directive) 
can be extremely problematic.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016044.html">[squid-users] SSL options on different http_port resolving into a single config for all ports
</A></li>
	<LI>Next message (by thread): <A HREF="016058.html">[squid-users] SSL options on different http_port resolving into a single config for all ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16052">[ date ]</a>
              <a href="thread.html#16052">[ thread ]</a>
              <a href="subject.html#16052">[ subject ]</a>
              <a href="author.html#16052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
