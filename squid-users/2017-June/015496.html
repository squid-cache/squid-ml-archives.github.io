<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Help troubleshooting proxy&lt;--&gt;client https
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%20troubleshooting%20proxy%3C--%3Eclient%20https&In-Reply-To=%3C988c6f80-52e6-d59c-79f9-3e778ee8b7a5%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015494.html">
   <LINK REL="Next"  HREF="015509.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Help troubleshooting proxy&lt;--&gt;client https</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%20troubleshooting%20proxy%3C--%3Eclient%20https&In-Reply-To=%3C988c6f80-52e6-d59c-79f9-3e778ee8b7a5%40treenet.co.nz%3E"
       TITLE="[squid-users] Help troubleshooting proxy&lt;--&gt;client https">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Jun  1 12:07:24 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015494.html">[squid-users] Help troubleshooting proxy&lt;--&gt;client https
</A></li>
        <LI>Next message (by thread): <A HREF="015509.html">[squid-users] Help troubleshooting proxy&lt;--&gt;client https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15496">[ date ]</a>
              <a href="thread.html#15496">[ thread ]</a>
              <a href="subject.html#15496">[ subject ]</a>
              <a href="author.html#15496">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/06/17 14:15, Masha Lifshin wrote:
&gt;<i> Thank you, very helpful.  Some more clarifying questions for you.
</I>&gt;<i>
</I>&gt;<i> Sorry for the imprecise language, I mean not interception but rather 
</I>&gt;<i> accepting connections to that port.  Our browsers will be explicitly 
</I>&gt;<i> configured to connect our proxy, so I believe that is not interception?
</I>
Yes, however for HTTP/1.x it is also not the same traffic syntax as port 
80 or 443. It is a proxy specific syntax which port 3128 is registered for.


&gt;<i>
</I>&gt;<i> If we want to only allow encrypted traffic between the browser and 
</I>&gt;<i> proxy, does that mean we'd only want to use the following line from 
</I>&gt;<i> your example?
</I>
Depends on what you mean by encrypted in context of the proxy syntax.


&gt;<i>
</I>&gt;<i> # HTTPS proxy; clients establish TLS connections to 31443 (your item #1)
</I>&gt;<i> https_port 31443 ssl-bump ...
</I>&gt;<i>
</I>&gt;<i> Once a handshake is done and tls connection is established here, would 
</I>&gt;<i> it be possible to have all http and https traffic from the browser go 
</I>&gt;<i> through 31443?  So squid would not need to have ports 80 and 443 open?
</I>&gt;<i>
</I>
Think about it as two separate things.

  1) the transport used to get HTTP(S) to the proxy.
   That can be TCP (http_port) or TLS (https_port).

  2) the protocol the browser is talking to some origin on the other 
side of the proxy.
  That can be HTTP or HTTPS (aka HTTP-over-TLS).

These layers stack. So Squid supports:

http_port 3128
# HTTP-over-TCP
# HTTPS-over-TCP (aka HTTP-over-TLS-over-TCP)

https_port 3129
# HTTP-over-TLS   (aka HTTP-over-TLS-over-TCP)
# HTTPS-over-TLS (aka HTTP-over-TLS-over-TLS-over-TCP)


SSL-Bump is about decrypting the HTTPS traffic destined to some origin 
(not the proxy itself), it has effectively no relation to the transport 
(TCP or TLS) used to send that traffic to the proxy. ie. It peeks down 
to get the HTTP message layer in those 'aka' stacks.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015494.html">[squid-users] Help troubleshooting proxy&lt;--&gt;client https
</A></li>
	<LI>Next message (by thread): <A HREF="015509.html">[squid-users] Help troubleshooting proxy&lt;--&gt;client https
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15496">[ date ]</a>
              <a href="thread.html#15496">[ thread ]</a>
              <a href="subject.html#15496">[ subject ]</a>
              <a href="author.html#15496">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
