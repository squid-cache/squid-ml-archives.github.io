<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] this config is ok? is ok the order?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20this%20config%20is%20ok%3F%20is%20ok%20the%20order%3F&In-Reply-To=%3C723b8c10-d7bf-5539-70aa-f7e32ccc05c9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015528.html">
   <LINK REL="Next"  HREF="015548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] this config is ok? is ok the order?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20this%20config%20is%20ok%3F%20is%20ok%20the%20order%3F&In-Reply-To=%3C723b8c10-d7bf-5539-70aa-f7e32ccc05c9%40treenet.co.nz%3E"
       TITLE="[squid-users] this config is ok? is ok the order?">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun  6 01:29:58 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015528.html">[squid-users] this config is ok? is ok the order?
</A></li>
        <LI>Next message (by thread): <A HREF="015548.html">[squid-users] this config is ok? is ok the order?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15529">[ date ]</a>
              <a href="thread.html#15529">[ thread ]</a>
              <a href="subject.html#15529">[ subject ]</a>
              <a href="author.html#15529">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/06/17 07:24, Antony Stone wrote:
&gt;<i> On Monday 05 June 2017 11:50:42 erdosain9 wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi. For what I understood. It is important ttl of dns names.
</I>&gt;<i> Yes, TTL is important.  It tells caching DNS servers how long they may
</I>&gt;<i> remember the last answer they got from the authoritative server, before they
</I>&gt;<i> need to ask the authoritative server again.
</I>&gt;<i>
</I>&gt;&gt;<i> So, I wanted to know when the squid server would ask for resolution again.
</I>&gt;<i> Well, that's a different question.
</I>&gt;<i>
</I>&gt;<i> Q: When will Squid ask [its configured name server] for resolution again?
</I>&gt;<i> A: When it needs to know the answer again.
</I>&gt;<i>
</I>&gt;<i> Q: When will the [recursive] DNS server which Squid asks, ask for resolution
</I>&gt;<i> again?
</I>&gt;<i> A: When the TTL has expired.
</I>&gt;<i>
</I>&gt;&gt;<i> That is, how long was the record kept.
</I>&gt;<i> That is the TTL.
</I>&gt;<i>
</I>&gt;&gt;<i> ;; ANSWER SECTION:
</I>&gt;&gt;<i> yahoo.com.		590	IN	A	98.138.253.109
</I>&gt;&gt;<i> ;; ANSWER SECTION:
</I>&gt;&gt;<i> pijamasurf.com.		299	IN	A	104.24.25.112
</I>&gt;&gt;<i> I wish I could put a bigger ttl to avoid being asked every &quot;little amount of
</I>&gt;&gt;<i> time&quot; by one address.
</I>&gt;<i> Why?  What does it matter to you that Yahoo asks your DNS server to refresh
</I>&gt;<i> its results no more than 30 minutes after the last time (your example of 590
</I>&gt;<i> fails to mention that you clearly asked your local name server for yahoo.com
</I>&gt;<i> 1210 seconds previously).  If you want to know the real TTL, ask an
</I>&gt;<i> authoritative name server:
</I>&gt;<i>
</I>&gt;<i> $ dig @ns1.yahoo.com. yahoo.com
</I>&gt;<i>
</I>&gt;<i> ;; ANSWER SECTION:
</I>&gt;<i> yahoo.com.              1800    IN      A       98.139.183.24
</I>&gt;<i>
</I>&gt;<i> If you only ask your local caching server, all you are finding out is how much
</I>&gt;<i> longer its cached answer is valid for, before it will ask (the authoritative
</I>&gt;<i> servers) again.
</I>&gt;<i>
</I>&gt;&gt;<i> For example pijamasurf.com = 299 and yahoo = 590, so
</I>&gt;&gt;<i> who manage that time??
</I>&gt;<i> Whoever maintains the zone files (DNS records) for those domains.
</I>&gt;<i>
</I>&gt;&gt;<i> how can i put more time to live?
</I>&gt;<i> You cannot (and should not).
</I>&gt;<i>
</I>&gt;&gt;<i> Or does this make no sense?
</I>&gt;<i> Why do you want to change the TTL on somebody else's domain?
</I>&gt;<i>
</I>&gt;<i> What (do you think) is the benefit for you?
</I>&gt;<i>
</I>&gt;&gt;<i> Maybe I did not understand Amos's comment.
</I>&gt;<i> Please repeat the comment which led you to trying to change the TTL of other
</I>&gt;<i> people's domains - maybe that will help us better understand what you are
</I>&gt;<i> trying to achieve,
</I>&gt;<i>
</I>
I suspect it was this comment:

&gt;<i> The core issue is the speed at which that service rotates its response 
</I>&gt;<i> IP lists, which is directly related to each request going to entirely 
</I>&gt;<i> different server in their farm. Simply having a single (and maybe more 
</I>&gt;<i> sane regarding TTLs) resolver as a networks focal point for the 
</I>&gt;<i> traffic before it reaches out to the Google service seems to bring 
</I>&gt;<i> sanity back to the performance. 
</I>
What I meant there was using a resolver that obeys the domain TTL it 
gets given and stores the result until that TTL expires.

The way the Google service load balances does not allow that to happen - 
your users query will reach a different server to your Squid query and 
to your test query later - all of which probably have different TTL 
values coming back (as you saw in that dig result 590 != 1800 and 299 != 
1800 ... the Google service is just a farm of recursive resolvers all 
with different cache contents). By having your own resolver between you 
and the Google service/farm that resolver takes only _one_ TTL period at 
a time from Google - and delivers all your clients and Squid etc that 
result until its single TTL period expires. After which it asks Google 
again and gets just one TTL to follow, and so on.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015528.html">[squid-users] this config is ok? is ok the order?
</A></li>
	<LI>Next message (by thread): <A HREF="015548.html">[squid-users] this config is ok? is ok the order?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15529">[ date ]</a>
              <a href="thread.html#15529">[ thread ]</a>
              <a href="subject.html#15529">[ subject ]</a>
              <a href="author.html#15529">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
