<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: store.cc &quot;EBIT_TEST(flags, ENTRY_ABORTED)&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20store.cc%20%22EBIT_TEST%28flags%2C%0A%20ENTRY_ABORTED%29%22&In-Reply-To=%3Cc3277d32-1149-8ba3-e54a-91976f883278%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015519.html">
   <LINK REL="Next"  HREF="015520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: store.cc &quot;EBIT_TEST(flags, ENTRY_ABORTED)&quot;</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20store.cc%20%22EBIT_TEST%28flags%2C%0A%20ENTRY_ABORTED%29%22&In-Reply-To=%3Cc3277d32-1149-8ba3-e54a-91976f883278%40treenet.co.nz%3E"
       TITLE="[squid-users] assertion failed: store.cc &quot;EBIT_TEST(flags, ENTRY_ABORTED)&quot;">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun  6 02:38:46 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015519.html">[squid-users] assertion failed: store.cc &quot;EBIT_TEST(flags,	ENTRY_ABORTED)&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="015520.html">[squid-users] squid 3.5.24 HTTPS/HTTP caching optimisation  Help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15532">[ date ]</a>
              <a href="thread.html#15532">[ thread ]</a>
              <a href="subject.html#15532">[ subject ]</a>
              <a href="author.html#15532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/06/17 19:27, alexander lunev wrote:
&gt;<i> Hello everyone!
</I>&gt;<i> I have two almost identical cache servers, both FreeBSD 10.3, both 
</I>&gt;<i> running latest squid-3.2.25 from ports in transparent mode, one runs 
</I>&gt;<i> OK and another is throwing this error:
</I>
Do you mean 3.5.25?  (3.2 series ended at 3.2.14)

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2017/06/04 10:19:08 kid1| storeLateRelease: released 0 objects
</I>&gt;<i> 2017/06/04 10:19:19 kid1| assertion failed: store.cc:1086: 
</I>&gt;<i> &quot;EBIT_TEST(flags, ENTRY_ABORTED)&quot;
</I>&gt;<i>
</I>
If you can obtain an updated stack/back-trace from that assertion it 
would be a help in identifying how it is happening. 
&lt;<A HREF="http://wiki.squid-cache.org/SquidFaq/BugReporting">http://wiki.squid-cache.org/SquidFaq/BugReporting</A>&gt; has info on how to 
report this type of bug, and how to obtain traces from production 
proxies with minimal service impact if you need it.



&gt;<i> After this squid is exiting.
</I>&gt;<i>
</I>&gt;<i> Beside some default configuration config contains:
</I>&gt;<i>
</I>&gt;<i> http_port 127.0.0.1:3127
</I>&gt;<i> http_port  127.0.0.1:3128 intercept
</I>&gt;<i> https_port 127.0.0.1:3129 intercept ssl-bump 
</I>&gt;<i> options=ALL:NO_SSLv3:NO_SSLv2 connection-auth=off 
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB 
</I>&gt;<i> cert=/usr/local/etc/squid/squid.pem key=/usr/local/etc/squid/squid.key
</I>&gt;<i>
</I>&gt;<i> sslcrtd_program /usr/local/libexec/squid/ssl_crtd -s 
</I>&gt;<i> /usr/local/etc/squid/ssl_db -M 4MB
</I>&gt;<i> sslcrtd_children 35
</I>&gt;<i>
</I>&gt;<i> cache deny all
</I>&gt;<i> url_rewrite_program /usr/local/bin/squidGuard -c 
</I>&gt;<i> /usr/local/etc/squid/squidGuard.conf
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> # Leave coredumps in the first cache dir
</I>&gt;<i> coredump_dir /var/squid/cache
</I>&gt;<i> #ssl_bump client-first all
</I>&gt;<i>
</I>&gt;<i> always_direct allow all
</I>
You can/should remove that above line. It is unnecessary for bumping 
since 3.1 series.

&gt;<i>
</I>&gt;<i> acl step1 at_step SslBump1
</I>&gt;<i> acl ssldomains ssl::server_name &quot;/usr/local/etc/squid/ssldomains.txt&quot;
</I>&gt;<i> ssl_bump peek step1
</I>&gt;<i> ssl_bump bump ssldomains
</I>&gt;<i> ssl_bump splice all
</I>&gt;<i>
</I>&gt;<i> sslproxy_cert_error allow all
</I>&gt;<i> sslproxy_flags DONT_VERIFY_PEER
</I>&gt;<i>
</I>
You should definitely remove both the above lines. They are hiding many 
potential TLS/SSL problems from *you* (not your users). The errors which 
may appear are real security problems with potentially major impacts on 
your users. They should usually be solved in ways other than simply 
hiding ones head in the sand.


&gt;<i>
</I>&gt;<i> Why is this and how it can be fixed?
</I>&gt;<i>
</I>
Something being cached is not being aborted when it was supposed to have 
been. More details are needed, please follow the instructions above.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015519.html">[squid-users] assertion failed: store.cc &quot;EBIT_TEST(flags,	ENTRY_ABORTED)&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="015520.html">[squid-users] squid 3.5.24 HTTPS/HTTP caching optimisation  Help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15532">[ date ]</a>
              <a href="thread.html#15532">[ thread ]</a>
              <a href="subject.html#15532">[ subject ]</a>
              <a href="author.html#15532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
