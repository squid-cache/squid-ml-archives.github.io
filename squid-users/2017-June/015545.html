<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FW:  FW: squid proxy 3.5 redhat 7.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20%20FW%3A%20squid%20proxy%203.5%20redhat%207.3&In-Reply-To=%3Cbbf7651c9be648cba439245cf8e8bd00%40rechtspraak.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015515.html">
   <LINK REL="Next"  HREF="015550.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FW:  FW: squid proxy 3.5 redhat 7.3</H1>
    <B>Madonna, A. (spir-it)</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20%20FW%3A%20squid%20proxy%203.5%20redhat%207.3&In-Reply-To=%3Cbbf7651c9be648cba439245cf8e8bd00%40rechtspraak.nl%3E"
       TITLE="[squid-users] FW:  FW: squid proxy 3.5 redhat 7.3">A.Madonna at rechtspraak.nl
       </A><BR>
    <I>Tue Jun  6 14:22:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015515.html">[squid-users] FW: squid proxy 3.5 redhat 7.3
</A></li>
        <LI>Next message (by thread): <A HREF="015550.html">[squid-users] FW:  FW: squid proxy 3.5 redhat 7.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15545">[ date ]</a>
              <a href="thread.html#15545">[ thread ]</a>
              <a href="subject.html#15545">[ subject ]</a>
              <a href="author.html#15545">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,


Know issue 2012 squid proxy 3.2

<A HREF="http://www.squid-cache.org/Versions/v3/3.2/RELEASENOTES.html#ss1.1">http://www.squid-cache.org/Versions/v3/3.2/RELEASENOTES.html#ss1.1</A>
&#8226;SSL-Bump not re-wrapping decrypted traffic in CONNECT for peers.

+ 5 years ago this already  was a known issue. Apparently even after + 5 years there is still proper solution. Can we expect anything regarding this in the near future?

This person already describes the issue in his blog and  offers a solution although its not perfect. 

<A HREF="https://www.mydlp.com/using-parent-proxy-ssl-bump-enabled-squid-3-2/">https://www.mydlp.com/using-parent-proxy-ssl-bump-enabled-squid-3-2/</A>


also it is still not clear to me if the traffic is encrypted again after leaving the squid proxy when doing ssl bump when using a parent proxy. 
Ssl_bump according to your wiki states that it decrypts and encrypts. However is it true if you are using a parent proxy (cache_peer) that the decrypted traffic does not get re-encrypted anymore, but is send clear text through the cache_peer ? 


-----Oorspronkelijk bericht-----
Van: Alex Rousskov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>] 
Verzonden: vrijdag 2 juni 2017 17:59
Aan: Madonna, A. (spir-it) &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">A.Madonna at rechtspraak.nl</A>&gt;; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Onderwerp: Re: [squid-users] FW: squid proxy 3.5 redhat 7.3

On 06/02/2017 01:37 AM, Madonna, A. (spir-it) wrote:

&gt;<i> Clients -&gt; squid proxy -&gt; internet.
</I>&gt;<i> This works with the config as previously mentioned.
</I>
OK.


&gt;<i> Clients -&gt; squid proxy (with cache_peer) -&gt; Parent Proxy (not Squid) 
</I>&gt;<i> -&gt; internet Does not work.
</I>
Even for regular HTTP traffic and non-bumped HTTPS traffic? If that traffic does not work, then you have misconfigured something or the Parent Proxy is badly broken. There is nothing special in the above setup as far as regular traffic is concerned.


&gt;<i> However I've also setup the following:
</I>&gt;<i> 
</I>&gt;<i> Cleints -&gt; Squid Proxy (with cache_peer) -&gt; Parent Proxy (Squid Proxy) 
</I>&gt;<i> -&gt; internet
</I>&gt;<i> 
</I>&gt;<i> This seems at least to work for http traffic, however, I don't see any HTTPS traffic coming into the Parent Proxy (Squid).
</I>
Squid does not know who made the parent proxy. The fact that one (presumably production-quality) proxy &quot;does not work&quot; and another &quot;seems to work&quot; implies that something is seriously misconfigured in one or both cases.


&gt;<i> Now this morning I will do some more tcpdumping to see where that traffic is going, but maybe you can already shed some light on this?
</I>
I cannot shed more light on problems described only as &quot;does not work&quot;
and &quot;no traffic&quot;.

Alex.


&gt;<i> -----Oorspronkelijk bericht-----
</I>&gt;<i> Van: Alex Rousskov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>]
</I>&gt;<i> Verzonden: donderdag 1 juni 2017 18:49
</I>&gt;<i> Aan: Madonna, A. (spir-it) &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">A.Madonna at rechtspraak.nl</A>&gt;; 
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Onderwerp: Re: [squid-users] squid proxy 3.5 redhat 7.3
</I>&gt;<i> 
</I>&gt;<i> On 06/01/2017 10:09 AM, Madonna, A. (spir-it) wrote:
</I>&gt;&gt;<i> can we use ssl_bump to intercept https traffic with a parent proxy (cache_peer).
</I>&gt;<i> 
</I>&gt;<i> IIRC, you may be able to use limited SslBump features, but not the full SslBump functionality: Peeking or staring at the origin server through a cache_peer is not supported (yet).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> ssl_bump peek step1
</I>&gt;&gt;<i> cache_peer ... parent 8080 0 no-query no-netdb-exchange no-digest
</I>&gt;<i> 
</I>&gt;<i> Bugs notwithstanding, the above combination should work because peeking at step1 does not require communication with a cache_peer and splicing at step2 should follow the regular (non-SslBump) tunneling path for CONNECTs, where modern Squids do support cache peers.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I recommend that you make everything work without a cache_peer and then add a cache_peer.
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________
</I>&gt;<i> 
</I>&gt;<i> Informatie van de Raad voor de rechtspraak, de rechtbanken, de gerechtshoven en de bijzondere colleges vindt u op www.rechtspraak.nl.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015515.html">[squid-users] FW: squid proxy 3.5 redhat 7.3
</A></li>
	<LI>Next message (by thread): <A HREF="015550.html">[squid-users] FW:  FW: squid proxy 3.5 redhat 7.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15545">[ date ]</a>
              <a href="thread.html#15545">[ thread ]</a>
              <a href="subject.html#15545">[ subject ]</a>
              <a href="author.html#15545">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
