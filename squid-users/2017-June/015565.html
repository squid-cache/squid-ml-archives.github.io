<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] https_port
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https_port&In-Reply-To=%3C764ecd5f-6f6c-0eb5-90b4-5591ab5e1920%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015562.html">
   <LINK REL="Next"  HREF="015574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] https_port</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https_port&In-Reply-To=%3C764ecd5f-6f6c-0eb5-90b4-5591ab5e1920%40treenet.co.nz%3E"
       TITLE="[squid-users] https_port">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jun  7 13:04:31 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015562.html">[squid-users] https_port
</A></li>
        <LI>Next message (by thread): <A HREF="015574.html">[squid-users] A youtube acl tool sketch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15565">[ date ]</a>
              <a href="thread.html#15565">[ thread ]</a>
              <a href="subject.html#15565">[ subject ]</a>
              <a href="author.html#15565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/06/17 03:28, Adiel Plasencia Herrera wrote:
&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> They would help me with a configuration of my squid that I want to 
</I>&gt;<i> implement.
</I>&gt;<i>
</I>&gt;<i> My proxy passes all traffic to a parent proxy and I want clients to 
</I>&gt;<i> connect to my proxy via https.
</I>&gt;<i>
</I>&gt;<i> Can you help me how to implement the connection to my proxy via https?
</I>&gt;<i>
</I>&gt;<i> To better explain what I want attached 2 pictures. The image with 
</I>&gt;<i> 1.jpg name shows my proxy configuration with type HTTp that connects 
</I>&gt;<i> well to internet.
</I>&gt;<i>
</I>&gt;<i> What I want is for the connection to my proxy to be by the form of the 
</I>&gt;<i> 2.jpg image that uses the HTTPS type.
</I>&gt;<i>
</I>&gt;<i> Or if it is possible then leave the 2 forms.
</I>
What operating system are you using, and what applications are you 
wanting to use this proxy connection?

The normal configuration is simply to add an https_port line with cert= 
parameter to your squid.conf. More details on that below.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is my current configuration:
</I>&gt;<i> acl trabajadores src 10.5.7.3 10.5.7.5
</I>&gt;<i>
</I>&lt;snip&gt;
&gt;<i>
</I>&gt;<i> http_access allow trabajadores
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>
You custom http_access rules (&quot;allow trabajadores&quot;) should be down here 
after the basic security checks.

&gt;<i> http_access deny all
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> http_port 3128
</I>
The above port is for receiving plain-text connections to the proxy. 
Most software supports this, with a few exceptions (usually Java apps).


To accept TLS connections to the proxy (not HTTPS *over* the proxy), 
what you do is add an https_port line here. That https_port line needs a 
cert= parameter containing the proxy server certificate. You may need 
other TLS/SSL parameters to fine tune what the TLS does, but just start 
with getting that basic setup to work.
  &lt;<A HREF="http://www.squid-cache.org/Doc/config/https_port/">http://www.squid-cache.org/Doc/config/https_port/</A>&gt;

For example:
   https_port 3129 cert=/etc/squid/proxy.pem

(the proxy.pem file here contains both the public server cert and 
private server key for that cert).

Many GUI applications (most notably browsers) do not support this type 
of connection to a proxy (or not well if they do). Which is where the 
Q's about your OS and applications come in. You may need to setup 
environment variables or PAC files to get the applications to work.


Note that this is *very* different situation to intercepting port 443 
traffic. Much more different than port 3128 vs. intercepted port 80. 
HTTPS traffic goes through these TLS proxy connections with 
double-layered encryption, so this setup does *not* magically make the 
proxy able to see inside HTTPS if that is what you are really after.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015562.html">[squid-users] https_port
</A></li>
	<LI>Next message (by thread): <A HREF="015574.html">[squid-users] A youtube acl tool sketch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15565">[ date ]</a>
              <a href="thread.html#15565">[ thread ]</a>
              <a href="subject.html#15565">[ subject ]</a>
              <a href="author.html#15565">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
