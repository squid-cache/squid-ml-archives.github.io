<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid authentication problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20authentication%20problem&In-Reply-To=%3C343154ec-dbd6-aa55-f867-216d3c261423%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015689.html">
   <LINK REL="Next"  HREF="015693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid authentication problem</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20authentication%20problem&In-Reply-To=%3C343154ec-dbd6-aa55-f867-216d3c261423%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid authentication problem">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jun 18 12:56:31 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015689.html">[squid-users] Squid authentication problem
</A></li>
        <LI>Next message (by thread): <A HREF="015693.html">[squid-users] Squid authentication problem (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15690">[ date ]</a>
              <a href="thread.html#15690">[ thread ]</a>
              <a href="subject.html#15690">[ subject ]</a>
              <a href="author.html#15690">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 18/06/17 17:50, Sonya Roy wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am running squid on a server with multiple public IPs and I want 
</I>&gt;<i> some users to be able to access the proxy through some of the IPs and 
</I>&gt;<i> other users through other IPs.
</I>&gt;<i>
</I>&gt;<i> At the moment I have acl rules of the form:-
</I>&gt;<i> acl abcd myip x.x.x.x
</I>&gt;<i>
</I>
What you need is an ACL that compares the username to the IP.

&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_file_userip_acl.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_file_userip_acl.html</A>&gt;
&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_edirectory_userip_acl.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_edirectory_userip_acl.html</A>&gt;
&lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_sql_session_acl.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_sql_session_acl.html</A>&gt;

or the new 'extras' feature for authenticators in Squid-3.5 that lets 
them use the IP as part of the auth approval. Though with this the thing 
to be aware of is that the IP becomes like a scope for the user login - 
the wrong IP being used to login from results in re-auth challenge just 
as would be seen if the password was wrong. So use carefully.
  &lt;<A HREF="http://www.squid-cache.org/Doc/config/auth_param/">http://www.squid-cache.org/Doc/config/auth_param/</A>&gt;
  &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/RELEASENOTES.html#ss2.2">http://www.squid-cache.org/Versions/v3/3.5/RELEASENOTES.html#ss2.2</A>&gt;

&gt;<i> and for these acl rules I have these tcp_outgoing_address:-
</I>&gt;<i> tcp_outgoing_address x.x.x.x abcd
</I>&gt;<i>
</I>
Why limit the outgoing? in HTTP that is independent to the incoming 
connection and restricting it will lower performance.

&gt;<i> And earlier I had proxy_auth acl rules separately, but that allowed 
</I>&gt;<i> any authenticated users to be able to access the proxy through any of 
</I>&gt;<i> those IPs. Since I wanted some users to be able to use the server 
</I>&gt;<i> through some IPs and others through different IPs, I tried this in 
</I>&gt;<i> those acl rules:-
</I>&gt;<i>
</I>&gt;<i> acl abcd myip x.x.x.x proxy_auth user1
</I>
FTR: that will match the IP address x.x.x.x and the IP address(es) of 
the servers with hostnames &quot;proxy_auth&quot; and &quot;user1&quot; in your local DNS.

Also, the myip ACL is deprecated because it matched different things 
based on the traffic type. myportname or localip ACLs are better if you 
need to do this at all. Your &quot;squid -k parse&quot; config checks should warn 
you about that.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015689.html">[squid-users] Squid authentication problem
</A></li>
	<LI>Next message (by thread): <A HREF="015693.html">[squid-users] Squid authentication problem (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15690">[ date ]</a>
              <a href="thread.html#15690">[ thread ]</a>
              <a href="subject.html#15690">[ subject ]</a>
              <a href="author.html#15690">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
