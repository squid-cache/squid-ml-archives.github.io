<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid authentication problem (Amos Jeffries)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20authentication%20problem%20%28Amos%20Jeffries%29&In-Reply-To=%3CCALSaDe14oG%3DszaNhVWqii14XxY0wS6LdaguuoAza_r8obGKddQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015690.html">
   <LINK REL="Next"  HREF="015695.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid authentication problem (Amos Jeffries)</H1>
    <B>Sonya Roy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20authentication%20problem%20%28Amos%20Jeffries%29&In-Reply-To=%3CCALSaDe14oG%3DszaNhVWqii14XxY0wS6LdaguuoAza_r8obGKddQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid authentication problem (Amos Jeffries)">sonyaroy75 at gmail.com
       </A><BR>
    <I>Mon Jun 19 12:09:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015690.html">[squid-users] Squid authentication problem
</A></li>
        <LI>Next message (by thread): <A HREF="015695.html">[squid-users] Squid authentication problem (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15693">[ date ]</a>
              <a href="thread.html#15693">[ thread ]</a>
              <a href="subject.html#15693">[ subject ]</a>
              <a href="author.html#15693">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i>From what I saw with using IP as part of then authentication, it checks
</I>which IP the user is connecting to the server from. What I want to check is
which public IP of the server the user is connecting to.

If someone connects to the server's IP address x.x.x.x, I want the outgoing
traffic to go through the same IP address x.x.x.x. That's why I put an acl
rule for each public IP of the server and specified the
tcp_outgoing_address for each of them.

So, for example, if the server has say 50 public IP address, I want to
create an user who will be able to connect to 25 of them and another to
another 25.

I hope this clarifies my original question.

With regards,
Sonya Roy.

On Mon, Jun 19, 2017 at 5:30 PM, &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>&gt;
wrote:

&gt;<i> Send squid-users mailing list submissions to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of squid-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: Squid authentication problem (Amos Jeffries)
</I>&gt;<i>    2. Re: squid 4.0.20 does not recognize ssl-bump option.
</I>&gt;<i>       (Alex Rousskov)
</I>&gt;<i>    3. Re: squid 4.0.20 does not recognize ssl-bump option.
</I>&gt;<i>       (Amos Jeffries)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Mon, 19 Jun 2017 00:56:31 +1200
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Squid authentication problem
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">343154ec-dbd6-aa55-f867-216d3c261423 at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8; format=flowed
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 18/06/17 17:50, Sonya Roy wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am running squid on a server with multiple public IPs and I want
</I>&gt;<i> &gt; some users to be able to access the proxy through some of the IPs and
</I>&gt;<i> &gt; other users through other IPs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; At the moment I have acl rules of the form:-
</I>&gt;<i> &gt; acl abcd myip x.x.x.x
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> What you need is an ACL that compares the username to the IP.
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext</A>_
</I>&gt;<i> file_userip_acl.html&gt;
</I>&gt;<i> &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext</A>_
</I>&gt;<i> edirectory_userip_acl.html&gt;
</I>&gt;<i> &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext</A>_
</I>&gt;<i> sql_session_acl.html&gt;
</I>&gt;<i>
</I>&gt;<i> or the new 'extras' feature for authenticators in Squid-3.5 that lets
</I>&gt;<i> them use the IP as part of the auth approval. Though with this the thing
</I>&gt;<i> to be aware of is that the IP becomes like a scope for the user login -
</I>&gt;<i> the wrong IP being used to login from results in re-auth challenge just
</I>&gt;<i> as would be seen if the password was wrong. So use carefully.
</I>&gt;<i>   &lt;<A HREF="http://www.squid-cache.org/Doc/config/auth_param/">http://www.squid-cache.org/Doc/config/auth_param/</A>&gt;
</I>&gt;<i>   &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/RELEASENOTES.html#ss2.2">http://www.squid-cache.org/Versions/v3/3.5/RELEASENOTES.html#ss2.2</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &gt; and for these acl rules I have these tcp_outgoing_address:-
</I>&gt;<i> &gt; tcp_outgoing_address x.x.x.x abcd
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Why limit the outgoing? in HTTP that is independent to the incoming
</I>&gt;<i> connection and restricting it will lower performance.
</I>&gt;<i>
</I>&gt;<i> &gt; And earlier I had proxy_auth acl rules separately, but that allowed
</I>&gt;<i> &gt; any authenticated users to be able to access the proxy through any of
</I>&gt;<i> &gt; those IPs. Since I wanted some users to be able to use the server
</I>&gt;<i> &gt; through some IPs and others through different IPs, I tried this in
</I>&gt;<i> &gt; those acl rules:-
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; acl abcd myip x.x.x.x proxy_auth user1
</I>&gt;<i>
</I>&gt;<i> FTR: that will match the IP address x.x.x.x and the IP address(es) of
</I>&gt;<i> the servers with hostnames &quot;proxy_auth&quot; and &quot;user1&quot; in your local DNS.
</I>&gt;<i>
</I>&gt;<i> Also, the myip ACL is deprecated because it matched different things
</I>&gt;<i> based on the traffic type. myportname or localip ACLs are better if you
</I>&gt;<i> need to do this at all. Your &quot;squid -k parse&quot; config checks should warn
</I>&gt;<i> you about that.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Sun, 18 Jun 2017 16:53:15 -0600
</I>&gt;<i> From: Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i> To: meym &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">meym at nym.mixmin.net</A>&gt;, Squid Users
</I>&gt;<i>         &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> Subject: Re: [squid-users] squid 4.0.20 does not recognize ssl-bump
</I>&gt;<i>         option.
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">9e834f7b-b20b-2cb5-e439-3fa0eaf1223e at measurement-factory.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=koi8-r
</I>&gt;<i>
</I>&gt;<i> On 06/18/2017 09:49 AM, meym wrote:
</I>&gt;<i> &gt;&gt; On 06/17/2017 10:09 AM, meym wrote:
</I>&gt;<i> &gt;&gt;&gt; Squid Cache: Version 4.0.20
</I>&gt;<i> &gt;&gt;&gt; &quot;FATAL: Unknown http_port option 'ssl-bump'.&quot;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Your Squid thinks it was built without OpenSSL support. OpenSSL support
</I>&gt;<i> &gt;&gt; is required for SslBump. Examine your ./configure options and output.
</I>&gt;<i>
</I>&gt;<i> &gt; With libressl actually.
</I>&gt;<i>
</I>&gt;<i> I do not know what you mean by that remark exactly, but what I said
</I>&gt;<i> applies to any library providing OpenSSL API, including LibreSSL. Moreover:
</I>&gt;<i>
</I>&gt;<i> * Squid does not know anything about LibreSSL. Somebody added the
</I>&gt;<i> letters &quot;LibreSSL&quot; to squid.conf.documented, but that was a mistake IMO.
</I>&gt;<i>
</I>&gt;<i> * Primary SslBump developers do not normally use or test with LibreSSL.
</I>&gt;<i>
</I>&gt;<i> * LibreSSL provides OpenSSL API so you can tell Squid to use LibreSSL as
</I>&gt;<i> if it was OpenSSL, and things should work as well as with OpenSSL itself
</I>&gt;<i> if (and only if) LibreSSL does a good job providing that OpenSSL API.
</I>&gt;<i>
</I>&gt;<i> * LibreSSL does not do a good job providing OpenSSL API and/or Squid
</I>&gt;<i> does not do a good job detecting OpenSSL API variations in a
</I>&gt;<i> LibreSSL-compatible way (depending on your point of view). See bug #4662
</I>&gt;<i> for more details.
</I>&gt;<i>
</I>&gt;<i> There have been recent improvements in LibreSSL-compatibility area, but
</I>&gt;<i> I am not sure those improvements (or the problems) are in your Squid
</I>&gt;<i> version and, at any rate, are taking significant additional risks by
</I>&gt;<i> using LibreSSL with SslBump. Whether those risks are worth using
</I>&gt;<i> something other than OpenSSL is your call, of course.
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Mon, 19 Jun 2017 21:12:57 +1200
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] squid 4.0.20 does not recognize ssl-bump
</I>&gt;<i>         option.
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">999533d5-0efa-8310-d32d-0ac0a10f34cd at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8; format=flowed
</I>&gt;<i>
</I>&gt;<i> On 19/06/17 10:53, Alex Rousskov wrote:
</I>&gt;<i> &gt; On 06/18/2017 09:49 AM, meym wrote:
</I>&gt;<i> &gt;&gt;&gt; On 06/17/2017 10:09 AM, meym wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt; Squid Cache: Version 4.0.20
</I>&gt;<i> &gt;&gt;&gt;&gt; &quot;FATAL: Unknown http_port option 'ssl-bump'.&quot;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Your Squid thinks it was built without OpenSSL support. OpenSSL support
</I>&gt;<i> &gt;&gt;&gt; is required for SslBump. Examine your ./configure options and output.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; With libressl actually.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I do not know what you mean by that remark exactly, but what I said
</I>&gt;<i> &gt; applies to any library providing OpenSSL API, including LibreSSL.
</I>&gt;<i>
</I>&gt;<i> To clarify that. This Squid is missing the --with-openssl build option,
</I>&gt;<i> which is required both by OpenSSL and any library derived from it.
</I>&gt;<i>
</I>&gt;<i> see &quot;squid -v&quot; for the details of a specific squid binary. This will now
</I>&gt;<i> distinguish between the OpenSSL vs LibreSSL vs other situation.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Moreover:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * Squid does not know anything about LibreSSL. Somebody added the
</I>&gt;<i> &gt; letters &quot;LibreSSL&quot; to squid.conf.documented, but that was a mistake IMO.
</I>&gt;<i>
</I>&gt;<i> The mentions of LibreSSL in the current file are for things which were
</I>&gt;<i> tested before the recent round of LibreSSL issues. Specifically loading
</I>&gt;<i> CA certs from a file. AFAIK that should still be working.
</I>&gt;<i>
</I>&gt;<i> ssl-bump is correctly not one of those options mentioning it. Also, note
</I>&gt;<i> that the fatal error message does not mention any particular library. It
</I>&gt;<i> is about lack of support from *any* library in the current build.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * Primary SslBump developers do not normally use or test with LibreSSL.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * LibreSSL provides OpenSSL API so you can tell Squid to use LibreSSL as
</I>&gt;<i> &gt; if it was OpenSSL, and things should work as well as with OpenSSL itself
</I>&gt;<i> &gt; if (and only if) LibreSSL does a good job providing that OpenSSL API.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * LibreSSL does not do a good job providing OpenSSL API and/or Squid
</I>&gt;<i> &gt; does not do a good job detecting OpenSSL API variations in a
</I>&gt;<i> &gt; LibreSSL-compatible way (depending on your point of view). See bug #4662
</I>&gt;<i> &gt; for more details.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; There have been recent improvements in LibreSSL-compatibility area, but
</I>&gt;<i> &gt; I am not sure those improvements (or the problems) are in your Squid
</I>&gt;<i> &gt; version and,
</I>&gt;<i>
</I>&gt;<i> They are. Though the release notes still say &quot;This release does not
</I>&gt;<i> support LibreSSL&quot; at present since we have had no positive feedback on
</I>&gt;<i> anything actually working yet.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; at any rate, are taking significant additional risks by
</I>&gt;<i> &gt; using LibreSSL with SslBump. Whether those risks are worth using
</I>&gt;<i> &gt; something other than OpenSSL is your call, of course.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Since the risk here is due to lack of testing... More testing is very
</I>&gt;<i> welcome of course. Especially with feedback about what works and what
</I>&gt;<i> does not.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of squid-users Digest, Vol 34, Issue 46
</I>&gt;<i> *******************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170619/1e214406/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170619/1e214406/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015690.html">[squid-users] Squid authentication problem
</A></li>
	<LI>Next message (by thread): <A HREF="015695.html">[squid-users] Squid authentication problem (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15693">[ date ]</a>
              <a href="thread.html#15693">[ thread ]</a>
              <a href="subject.html#15693">[ subject ]</a>
              <a href="author.html#15693">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
