<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] error:transaction-end-before-headers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20error%3Atransaction-end-before-headers&In-Reply-To=%3C1f310a8a-ae81-c4a6-463b-318bb92be401%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015780.html">
   <LINK REL="Next"  HREF="015782.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] error:transaction-end-before-headers</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20error%3Atransaction-end-before-headers&In-Reply-To=%3C1f310a8a-ae81-c4a6-463b-318bb92be401%40measurement-factory.com%3E"
       TITLE="[squid-users] error:transaction-end-before-headers">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Jun 30 15:30:06 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015780.html">[squid-users] error:transaction-end-before-headers
</A></li>
        <LI>Next message (by thread): <A HREF="015782.html">[squid-users] error:transaction-end-before-headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15781">[ date ]</a>
              <a href="thread.html#15781">[ thread ]</a>
              <a href="subject.html#15781">[ subject ]</a>
              <a href="author.html#15781">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/30/2017 03:35 AM, joseph wrote:
&gt;<i> i have over then 10000  daily this error befor was 0 or at least not much
</I>&gt;<i> using squid 5   latest patch  up to  r15228
</I>&gt;<i> my setup same nothing change
</I>
What Squid version did you run &quot;before&quot;?


&gt;<i> ps.. all my client produce this   
</I>&gt;<i> 
</I>&gt;<i> 1498793967.385      0 10.3.252.229 NONE/000 0 NONE
</I>&gt;<i> error:transaction-end-before-headers - HIER_NONE/- -
</I>
These errors are meant to be logged for clients that open and close
connections without sending any HTTP headers (or without sending
complete HTTP headers -- you can log HTTP request size to distinguish
these two cases).

I do not know whether Squid has a bug identifying these cases or you
just have a lot of these cases in your environment. If these are
frequent, then you should be able to learn more about them by capturing
network packets and matching them with the errors. Logging the
client/source TCP port number would help with that. There are a couple
of known problems with the detection code, but if this is some
new/unknown problem, it would be useful for developers to know more
about it. Please investigate if you can.

I do not know whether it is possible to match these cases with existing
ACLs so that you can stop logging them (if that is what you want).
Adding an ACL for this purpose is a known TODO, but I am not aware of
anybody working on that or sponsoring that work.

If you want to modify Squid to stop logging these cases, add &quot;return;&quot;
at the very beginning of ConnStateData::checkLogging() in
src/client_side.cc.

You forgot to ask a question, but I hope the above info is useful.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015780.html">[squid-users] error:transaction-end-before-headers
</A></li>
	<LI>Next message (by thread): <A HREF="015782.html">[squid-users] error:transaction-end-before-headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15781">[ date ]</a>
              <a href="thread.html#15781">[ thread ]</a>
              <a href="subject.html#15781">[ subject ]</a>
              <a href="author.html#15781">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
