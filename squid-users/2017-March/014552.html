<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid-users Digest, Vol 31, Issue 3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2031%2C%20Issue%203&In-Reply-To=%3CCAOLOQx0URyG3NMhjaDhq12ahFA%3D%3D-h1_FT7WLnoMnHBO4XhWvQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014551.html">
   <LINK REL="Next"  HREF="014555.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid-users Digest, Vol 31, Issue 3</H1>
    <B>Adrian Miller</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2031%2C%20Issue%203&In-Reply-To=%3CCAOLOQx0URyG3NMhjaDhq12ahFA%3D%3D-h1_FT7WLnoMnHBO4XhWvQ%40mail.gmail.com%3E"
       TITLE="[squid-users] squid-users Digest, Vol 31, Issue 3">adrian.m.miller at gmail.com
       </A><BR>
    <I>Thu Mar  2 03:14:53 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014551.html">[squid-users] SSL Bump and Certificate issue - RapidSSL	Intermediate Cert
</A></li>
        <LI>Next message (by thread): <A HREF="014555.html">[squid-users] Exclude users ip from white listed Ssl bump sites
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14552">[ date ]</a>
              <a href="thread.html#14552">[ thread ]</a>
              <a href="subject.html#14552">[ subject ]</a>
              <a href="author.html#14552">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Disregard last message, it seemed to work...once - quite possible i had the
proxy toggled off at the time...sheesh

Reverted my cipher chain back to the original and leaving the hell alone,
will send the site admin an email instead of fiddling further

On 2 March 2017 at 14:04, &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>&gt; wrote:

&gt;<i> Send squid-users mailing list submissions to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of squid-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: SSL Bump and Certificate issue - RapidSSL     Intermediate
</I>&gt;<i>       Cert (stylemessiah)
</I>&gt;<i>    2. Re: Failed to shm_open (Amos Jeffries)
</I>&gt;<i>    3. Re: Failed to shm_open (Amos Jeffries)
</I>&gt;<i>    4. Re: SSL Bump and Certificate issue - RapidSSL     Intermediate
</I>&gt;<i>       Cert (stylemessiah)
</I>&gt;<i>    5. Re: SSL Bump and Certificate issue - RapidSSL     Intermediate
</I>&gt;<i>       Cert (stylemessiah)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Wed, 1 Mar 2017 09:03:47 -0800 (PST)
</I>&gt;<i> From: stylemessiah &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i>         Intermediate Cert
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAOLOQx36wSy24sDDS-Qm=BSAeGsS5oiT5kGK5kP7s=sMQEffpQ@
</I>&gt;<i> mail.gmail.com&gt;
</I>&gt;<i> Content-Type: text/plain; charset=us-ascii
</I>&gt;<i>
</I>&gt;<i> Thanks Amos for the info, appreciate your tireless assistance for us
</I>&gt;<i> numpties :)
</I>&gt;<i>
</I>&gt;<i> On 2 Mar. 2017 4:06 am, &quot;Amos Jeffries [via Squid Web Proxy Cache]&quot; &lt;
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ml-node+s1019090n4681642h47 at n4.nabble.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; On 1/03/2017 4:58 a.m., stylemessiah wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; This is driving me nuts, its the only issue ive found running ssl bump
</I>&gt;<i> &gt; on my
</I>&gt;<i> &gt; &gt; home network for eons
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I cant see image thumbnails on xda-developers...
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; When i access a thread with them, i get text links, not thumbnails, and
</I>&gt;<i> &gt; if i
</I>&gt;<i> &gt; &gt; click on the links i get the following:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     (71) Protocol error (TLS code:
</I>&gt;<i> &gt; &gt; X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> &gt; &gt; /C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I figured out by googling how to (i hope) trace the problem certificate
</I>&gt;<i> &gt; via
</I>&gt;<i> &gt; &gt; s_client:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; OpenSSL&gt; s_client -showcerts -verify 32 -connect
</I>&gt;<i> &gt; dl.xda-developers.com:443
</I>&gt;<i> &gt; &gt; verify depth is 32
</I>&gt;<i> &gt; &gt; CONNECTED(0000012C)
</I>&gt;<i> &gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt; &gt; verify error:num=20:unable to get local issuer certificate
</I>&gt;<i> &gt; &gt; verify return:1
</I>&gt;<i> &gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt; &gt; verify error:num=21:unable to verify the first certificate
</I>&gt;<i> &gt; &gt; verify return:1
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; That command you used does not send data through the proxy. So that
</I>&gt;<i> &gt; confirms that the servers TLS is broken in a way unrelated to Squid.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; ---
</I>&gt;<i> &gt; &gt; Certificate chain
</I>&gt;<i> &gt; &gt;  0 s:/CN=*.xda-developers.com
</I>&gt;<i> &gt; &gt;    i:/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt; ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; ---
</I>&gt;<i> &gt; &gt; Server certificate
</I>&gt;<i> &gt; &gt; subject=/CN=*.xda-developers.com
</I>&gt;<i> &gt; &gt; issuer=/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt; &gt; ---
</I>&gt;<i> &gt; &gt; No client certificate CA names sent
</I>&gt;<i> &gt; &gt; Peer signing digest: SHA512
</I>&gt;<i> &gt; &gt; Server Temp Key: ECDH, P-256, 256 bits
</I>&gt;<i> &gt; &gt; ---
</I>&gt;<i> &gt; &gt; SSL handshake has read 2067 bytes and written 302 bytes
</I>&gt;<i> &gt; &gt; Verification error: unable to verify the first certificate
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Ive found the intermediate bundle from RapidSS, and added it to my
</I>&gt;<i> &gt; existing
</I>&gt;<i> &gt; &gt; pem bundle...no change
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You need to locate the root CA and/or intermediate CA certificates used
</I>&gt;<i> &gt; to sign the domain servers certificate.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You then need to identify *why* they are not being trusted by your OS
</I>&gt;<i> &gt; library.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Be sure to determine whether the CA which is missing is actually
</I>&gt;<i> &gt; trustworthy before adding it to your trusted set. More than a few of the
</I>&gt;<i> &gt; CA which are around are not trusted because they have been hacked or
</I>&gt;<i> &gt; caught signing forged certificates they should not have.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Added as a separate pem i.e. sslproxy_foreign_intermediate_certs
</I>&gt;<i> &gt; &gt; /cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem...no change
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; My sslbump related config lines are:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; http_port 127.0.0.1:3128 ssl-bump generate-host-certificates=on
</I>&gt;<i> &gt; &gt; dynamic_cert_mem_cache_size=10MB cert=/cygdrive/e/Squid/etc/
</I>&gt;<i> ssl/myCA.pem
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; capath=/cygdrive/e/Squid/etc/ssl
</I>&gt;<i> &gt; &gt; cafile=/cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem
</I>&gt;<i> &gt; &gt; tls-dh=/cygdrive/e/Squid/etc/ssl/dhparam.pem
</I>&gt;<i> &gt; &gt; options=NO_SSLv2,NO_SSLv3,SINGLE_ECDH_USE
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; PS.  EECDH will not work unless you configure a curve name in the
</I>&gt;<i> &gt; tls-dh= option. Just having dhparam.pem alone will only enable the less
</I>&gt;<i> &gt; secure DH ciphers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Amos
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0">http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0</A>&gt;
</I>&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------------------------------
</I>&gt;<i> &gt; If you reply to this email, your message will be added to the discussion
</I>&gt;<i> &gt; below:
</I>&gt;<i> &gt; <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-">http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-</A>
</I>&gt;<i> &gt; Bump-and-Certificate-issue-RapidSSL-Intermediate-Cert-
</I>&gt;<i> &gt; tp4681635p4681642.html
</I>&gt;<i> &gt; To unsubscribe from SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i> Intermediate
</I>&gt;<i> &gt; Cert, click here
</I>&gt;<i> &gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4681635&amp;code=
</I>&gt;<i> YWRyaWFuLm0ubWlsbGVyQGdtYWlsLmNvbXw0NjgxNjM1fDE5ODY3MjIyMDI=&gt;
</I>&gt;<i> &gt; .
</I>&gt;<i> &gt; NAML
</I>&gt;<i> &gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_
</I>&gt;<i> html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.
</I>&gt;<i> BasicNamespace-nabble.view.web.template.NabbleNamespace-
</I>&gt;<i> nabble.view.web.template.NodeNamespace&amp;breadcrumbs=
</I>&gt;<i> notify_subscribers%21nabble%3Aemail.naml-instant_emails%
</I>&gt;<i> 21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.">http://squid-web-proxy-cache.</A>
</I>&gt;<i> 1019090.n4.nabble.com/SSL-Bump-and-Certificate-issue-
</I>&gt;<i> RapidSSL-Intermediate-Cert-tp4681635p4681643.html
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Thu, 2 Mar 2017 06:19:27 +1300
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Failed to shm_open
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">97f1176a-f88d-9fbf-28dc-a8c2341dc612 at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 2/03/2017 4:06 a.m., erdosain9 wrote:
</I>&gt;<i> &gt; Hi.
</I>&gt;<i> &gt; Now squid stop... abnormaly.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2017/03/01 12:04:31 kid1| helperOpenServers: Starting 5/32 'ssl_crtd'
</I>&gt;<i> &gt; processes
</I>&gt;<i> &gt; FATAL: Ipc::Mem::Segment::open failed to
</I>&gt;<i> &gt; shm_open(/squid-ssl_session_cache.shm): (2) No such file or directory
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Squid Cache (Version 3.5.20): Terminated abnormally.
</I>&gt;<i> &gt; CPU Usage: 0.095 seconds = 0.074 user + 0.021 sys
</I>&gt;<i> &gt; Maximum Resident Size: 134144 KB
</I>&gt;<i> &gt; Page faults with physical i/o: 0
</I>&gt;<i> &gt; 2017/03/01 12:04:31| Set Current Directory to /var/spool/squid
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What is happend??
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> One of three things, in order of likelihood:
</I>&gt;<i>
</I>&gt;<i> a) your OS does not have /dev/shm running.
</I>&gt;<i>
</I>&gt;<i> b) your Squid was not started with appropriate privileges to access
</I>&gt;<i> /dev/shm and create the shared-memory area. ie root.
</I>&gt;<i>
</I>&gt;<i> c) a previous Squid process that was supposed to create that
</I>&gt;<i> shared-memory area is not running.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Thu, 2 Mar 2017 06:24:35 +1300
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Failed to shm_open
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">3245dc48-4a84-ffe4-5952-ee09921efd8f at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 2/03/2017 4:21 a.m., erdosain9 wrote:
</I>&gt;<i> &gt; no shared cipher
</I>&gt;<i>
</I>&gt;<i> Exactly what it says. There are no ciphers which both the client  and
</I>&gt;<i> the server are allowing to be used.
</I>&gt;<i>
</I>&gt;<i> One example of this is a client that only speaks SSLv2 and a server that
</I>&gt;<i> speaks only TLS/1.3.
</I>&gt;<i>
</I>&gt;<i> You will have to dig a bit deeper to figure out what ciphers are needed.
</I>&gt;<i> Unfortunately Squid does not have much useful debug information in this
</I>&gt;<i> area yet.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 4
</I>&gt;<i> Date: Wed, 1 Mar 2017 17:57:30 -0800 (PST)
</I>&gt;<i> From: stylemessiah &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i>         Intermediate Cert
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAOLOQx3n5MSOZHTiKSZJ8BfA=Q=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">LNd7KCVsncgLz2QZt0XaEOQ at mail.</A>
</I>&gt;<i> gmail.com&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;<i>
</I>&gt;<i> &gt;That command you used does not send data through the proxy. So that
</I>&gt;<i> &gt;confirms that the servers TLS is broken in a way unrelated to Squid.
</I>&gt;<i>
</I>&gt;<i> As that may be, when i go direct (sans proxy) i get thumbnails...no issues
</I>&gt;<i> Toggle the proxy back on and no thumbnails, and opening an image link gives
</I>&gt;<i> the
</I>&gt;<i> error initially reported.
</I>&gt;<i>
</I>&gt;<i> (71) Protocol error (TLS code:
</I>&gt;<i>  X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i>
</I>&gt;<i> SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> /C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i>
</I>&gt;<i> So both Ie and FF will just load anything from dl.xda-developers.com and
</I>&gt;<i> not
</I>&gt;<i> register an issue, but squid will refuse to load the content and generate
</I>&gt;<i> the error
</I>&gt;<i>
</I>&gt;<i> &gt;You need to locate the root CA and/or intermediate CA certificates used
</I>&gt;<i> &gt;to sign the domain servers certificate.
</I>&gt;<i>
</I>&gt;<i> &gt;You then need to identify *why* they are not being trusted by your OS
</I>&gt;<i> &gt;library.
</I>&gt;<i>
</I>&gt;<i> &gt;Be sure to determine whether the CA which is missing is actually
</I>&gt;<i> &gt;trustworthy before adding it to your trusted set. More than a few of the
</I>&gt;<i> &gt;CA which are around are not trusted because they have been hacked or
</I>&gt;<i> &gt;caught signing forged certificates they should not have.
</I>&gt;<i>
</I>&gt;<i> I aalways learn something when youre silly enough to reply :)
</I>&gt;<i>
</I>&gt;<i> When i ran dl.xda-developers.com through ssllabs (thanks google), it gave
</I>&gt;<i> me a less than glowing report, including
</I>&gt;<i> an incomplete cert chain (i say that like i understand it :) ) or as it put
</I>&gt;<i> it:
</I>&gt;<i>
</I>&gt;<i> This server is vulnerable to the OpenSSL CCS vulnerability (CVE-2014-0224)
</I>&gt;<i> &lt;<A HREF="https://community.qualys.com/blogs/securitylabs/2014/06/13/">https://community.qualys.com/blogs/securitylabs/2014/06/13/</A>
</I>&gt;<i> ssl-pulse-49-vulnerable-to-cve-2014-0224-14-exploitable&gt;
</I>&gt;<i> and exploitable. Grade set to F.
</I>&gt;<i> This server is vulnerable to the OpenSSL Padding Oracle vulnerability
</I>&gt;<i> (CVE-2016-2107)
</I>&gt;<i> &lt;<A HREF="https://blog.cloudflare.com/yet-another-padding-oracle-in-">https://blog.cloudflare.com/yet-another-padding-oracle-in-</A>
</I>&gt;<i> openssl-cbc-ciphersuites/&gt;
</I>&gt;<i> and insecure. Grade set to F.
</I>&gt;<i> This server accepts RC4 cipher, but only with older browsers. Grade capped
</I>&gt;<i> to B.  MORE INFO &#187;
</I>&gt;<i> &lt;<A HREF="https://community.qualys.com/blogs/securitylabs/2013/03/19/">https://community.qualys.com/blogs/securitylabs/2013/03/19/</A>
</I>&gt;<i> rc4-in-tls-is-broken-now-what&gt;
</I>&gt;<i> This server's certificate chain is incomplete. Grade capped to B.
</I>&gt;<i>
</I>&gt;<i> Full report here for the curious:
</I>&gt;<i> <A HREF="https://globalsign.ssllabs.com/analyze.html?d=dl.xda-">https://globalsign.ssllabs.com/analyze.html?d=dl.xda-</A>
</I>&gt;<i> developers.com&amp;hideResults=on
</I>&gt;<i>
</I>&gt;<i> For a few thumbnails im not going to torture myself, maybe ill send the
</I>&gt;<i> forum admin a note instead :)
</I>&gt;<i>
</I>&gt;<i> &gt;PS.  EECDH will not work unless you configure a curve name in the
</I>&gt;<i> &gt;tls-dh= option. Just having dhparam.pem alone will only enable the less
</I>&gt;<i> &gt;secure DH ciphers.
</I>&gt;<i>
</I>&gt;<i> I did add a curve to the tls-dh param, im guessing tis correct, little info
</I>&gt;<i> on which one to use (grabbing the list from my local openssl had me going
</I>&gt;<i> what the hell)
</I>&gt;<i>
</I>&gt;<i> tls-dh=prime256v1:/cygdrive/e/Squid/etc/ssl/dhparam.pem
</I>&gt;<i>
</I>&gt;<i> Note: this made no difference whatsoever with my issue
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Adrian Miller
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2 March 2017 at 04:08, Adrian Miller &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Thanks Amos for the info, appreciate your tireless assistance for us
</I>&gt;<i> &gt; numpties :)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 2 Mar. 2017 4:06 am, &quot;Amos Jeffries [via Squid Web Proxy Cache]&quot; &lt;
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ml-node+s1019090n4681642h47 at n4.nabble.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; On 1/03/2017 4:58 a.m., stylemessiah wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; This is driving me nuts, its the only issue ive found running ssl bump
</I>&gt;<i> &gt;&gt; on my
</I>&gt;<i> &gt;&gt; &gt; home network for eons
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I cant see image thumbnails on xda-developers...
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; When i access a thread with them, i get text links, not thumbnails,
</I>&gt;<i> and
</I>&gt;<i> &gt;&gt; if i
</I>&gt;<i> &gt;&gt; &gt; click on the links i get the following:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;     (71) Protocol error (TLS code:
</I>&gt;<i> &gt;&gt; &gt; X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;     SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> &gt;&gt; &gt; /C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I figured out by googling how to (i hope) trace the problem
</I>&gt;<i> certificate
</I>&gt;<i> &gt;&gt; via
</I>&gt;<i> &gt;&gt; &gt; s_client:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; OpenSSL&gt; s_client -showcerts -verify 32 -connect
</I>&gt;<i> &gt;&gt; dl.xda-developers.com:443
</I>&gt;<i> &gt;&gt; &gt; verify depth is 32
</I>&gt;<i> &gt;&gt; &gt; CONNECTED(0000012C)
</I>&gt;<i> &gt;&gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt;&gt; &gt; verify error:num=20:unable to get local issuer certificate
</I>&gt;<i> &gt;&gt; &gt; verify return:1
</I>&gt;<i> &gt;&gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt;&gt; &gt; verify error:num=21:unable to verify the first certificate
</I>&gt;<i> &gt;&gt; &gt; verify return:1
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; That command you used does not send data through the proxy. So that
</I>&gt;<i> &gt;&gt; confirms that the servers TLS is broken in a way unrelated to Squid.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt; &gt; Certificate chain
</I>&gt;<i> &gt;&gt; &gt;  0 s:/CN=*.xda-developers.com
</I>&gt;<i> &gt;&gt; &gt;    i:/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt; ...
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt; &gt; Server certificate
</I>&gt;<i> &gt;&gt; &gt; subject=/CN=*.xda-developers.com
</I>&gt;<i> &gt;&gt; &gt; issuer=/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt; &gt; No client certificate CA names sent
</I>&gt;<i> &gt;&gt; &gt; Peer signing digest: SHA512
</I>&gt;<i> &gt;&gt; &gt; Server Temp Key: ECDH, P-256, 256 bits
</I>&gt;<i> &gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt; &gt; SSL handshake has read 2067 bytes and written 302 bytes
</I>&gt;<i> &gt;&gt; &gt; Verification error: unable to verify the first certificate
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Ive found the intermediate bundle from RapidSS, and added it to my
</I>&gt;<i> &gt;&gt; existing
</I>&gt;<i> &gt;&gt; &gt; pem bundle...no change
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; You need to locate the root CA and/or intermediate CA certificates used
</I>&gt;<i> &gt;&gt; to sign the domain servers certificate.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; You then need to identify *why* they are not being trusted by your OS
</I>&gt;<i> &gt;&gt; library.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Be sure to determine whether the CA which is missing is actually
</I>&gt;<i> &gt;&gt; trustworthy before adding it to your trusted set. More than a few of the
</I>&gt;<i> &gt;&gt; CA which are around are not trusted because they have been hacked or
</I>&gt;<i> &gt;&gt; caught signing forged certificates they should not have.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; Added as a separate pem i.e. sslproxy_foreign_intermediate_certs
</I>&gt;<i> &gt;&gt; &gt; /cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem...no change
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; My sslbump related config lines are:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; http_port 127.0.0.1:3128 ssl-bump generate-host-certificates=on
</I>&gt;<i> &gt;&gt; &gt; dynamic_cert_mem_cache_size=10MB cert=/cygdrive/e/Squid/etc/
</I>&gt;<i> ssl/myCA.pem
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; capath=/cygdrive/e/Squid/etc/ssl
</I>&gt;<i> &gt;&gt; &gt; cafile=/cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem
</I>&gt;<i> &gt;&gt; &gt; tls-dh=/cygdrive/e/Squid/etc/ssl/dhparam.pem
</I>&gt;<i> &gt;&gt; &gt; options=NO_SSLv2,NO_SSLv3,SINGLE_ECDH_USE
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; PS.  EECDH will not work unless you configure a curve name in the
</I>&gt;<i> &gt;&gt; tls-dh= option. Just having dhparam.pem alone will only enable the less
</I>&gt;<i> &gt;&gt; secure DH ciphers.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Amos
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; squid-users mailing list
</I>&gt;<i> &gt;&gt; [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0">http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0</A>&gt;
</I>&gt;<i> &gt;&gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; ------------------------------
</I>&gt;<i> &gt;&gt; If you reply to this email, your message will be added to the discussion
</I>&gt;<i> &gt;&gt; below:
</I>&gt;<i> &gt;&gt; <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-Bump-">http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-Bump-</A>
</I>&gt;<i> &gt;&gt; and-Certificate-issue-RapidSSL-Intermediate-Cert-tp4681635p4681642.html
</I>&gt;<i> &gt;&gt; To unsubscribe from SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i> &gt;&gt; Intermediate Cert, click here
</I>&gt;<i> &gt;&gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4681635&amp;code=
</I>&gt;<i> YWRyaWFuLm0ubWlsbGVyQGdtYWlsLmNvbXw0NjgxNjM1fDE5ODY3MjIyMDI=&gt;
</I>&gt;<i> &gt;&gt; .
</I>&gt;<i> &gt;&gt; NAML
</I>&gt;<i> &gt;&gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_
</I>&gt;<i> html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.
</I>&gt;<i> BasicNamespace-nabble.view.web.template.NabbleNamespace-
</I>&gt;<i> nabble.view.web.template.NodeNamespace&amp;breadcrumbs=
</I>&gt;<i> notify_subscribers%21nabble%3Aemail.naml-instant_emails%
</I>&gt;<i> 21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> I hate to advocate *drugs*, *alcohol*,* violence *or
</I>&gt;<i> *insanity* to anyone, *but* they've *always* worked for* me*
</I>&gt;<i>
</I>&gt;<i> - Hunter S. Thompson
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.">http://squid-web-proxy-cache.</A>
</I>&gt;<i> 1019090.n4.nabble.com/SSL-Bump-and-Certificate-issue-
</I>&gt;<i> RapidSSL-Intermediate-Cert-tp4681635p4681646.html
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 5
</I>&gt;<i> Date: Wed, 1 Mar 2017 18:59:08 -0800 (PST)
</I>&gt;<i> From: stylemessiah &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i>         Intermediate Cert
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAOLOQx1-wRQ4RZcTjg6CqAT-mYyaBu-nCaPNkYFg4tW66E=F+w@
</I>&gt;<i> mail.gmail.com&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;<i>
</I>&gt;<i> Decided to fiddle with it one last time....
</I>&gt;<i>
</I>&gt;<i> If i change my cipher entries from
</I>&gt;<i>
</I>&gt;<i> EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:
</I>&gt;<i> EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:
</I>&gt;<i> EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:MEDIUM:!RC4:!aNULL:!
</I>&gt;<i> eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS
</I>&gt;<i>
</I>&gt;<i> to
</I>&gt;<i>
</I>&gt;<i> ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:
</I>&gt;<i> DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-
</I>&gt;<i> RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-
</I>&gt;<i> AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-
</I>&gt;<i> RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:
</I>&gt;<i> ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES256-GCM-
</I>&gt;<i> SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:
</I>&gt;<i> AES256-SHA:AES128-SHA:DES-CBC3-SHA:HIGH:!aNULL:!eNULL:!
</I>&gt;<i> EXPORT:!DES:!MD5:!PSK:!RC4
</I>&gt;<i>
</I>&gt;<i> I get content from dl.xda-developers.com just fine
</I>&gt;<i>
</I>&gt;<i> But i wont pretend i understand the cipher chain, or whether the change is
</I>&gt;<i> a good thing
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2 March 2017 at 13:01, Adrian Miller &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; &gt;That command you used does not send data through the proxy. So that
</I>&gt;<i> &gt; &gt;confirms that the servers TLS is broken in a way unrelated to Squid.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As that may be, when i go direct (sans proxy) i get thumbnails...no
</I>&gt;<i> issues
</I>&gt;<i> &gt; Toggle the proxy back on and no thumbnails, and opening an image link
</I>&gt;<i> &gt; gives the
</I>&gt;<i> &gt; error initially reported.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; (71) Protocol error (TLS code:
</I>&gt;<i> &gt;  X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> &gt; /C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So both Ie and FF will just load anything from dl.xda-developers.com and
</I>&gt;<i> &gt; not
</I>&gt;<i> &gt; register an issue, but squid will refuse to load the content and generate
</I>&gt;<i> &gt; the error
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;You need to locate the root CA and/or intermediate CA certificates used
</I>&gt;<i> &gt; &gt;to sign the domain servers certificate.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;You then need to identify *why* they are not being trusted by your OS
</I>&gt;<i> &gt; &gt;library.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;Be sure to determine whether the CA which is missing is actually
</I>&gt;<i> &gt; &gt;trustworthy before adding it to your trusted set. More than a few of the
</I>&gt;<i> &gt; &gt;CA which are around are not trusted because they have been hacked or
</I>&gt;<i> &gt; &gt;caught signing forged certificates they should not have.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I aalways learn something when youre silly enough to reply :)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; When i ran dl.xda-developers.com through ssllabs (thanks google), it
</I>&gt;<i> gave
</I>&gt;<i> &gt; me a less than glowing report, including
</I>&gt;<i> &gt; an incomplete cert chain (i say that like i understand it :) ) or as it
</I>&gt;<i> &gt; put it:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This server is vulnerable to the OpenSSL CCS vulnerability
</I>&gt;<i> (CVE-2014-0224)
</I>&gt;<i> &gt; &lt;<A HREF="https://community.qualys.com/blogs/securitylabs/2014/06/13/">https://community.qualys.com/blogs/securitylabs/2014/06/13/</A>
</I>&gt;<i> ssl-pulse-49-vulnerable-to-cve-2014-0224-14-exploitable&gt;
</I>&gt;<i> &gt; and exploitable. Grade set to F.
</I>&gt;<i> &gt; This server is vulnerable to the OpenSSL Padding Oracle vulnerability
</I>&gt;<i> &gt; (CVE-2016-2107)
</I>&gt;<i> &gt; &lt;<A HREF="https://blog.cloudflare.com/yet-another-padding-oracle-in-">https://blog.cloudflare.com/yet-another-padding-oracle-in-</A>
</I>&gt;<i> openssl-cbc-ciphersuites/&gt;
</I>&gt;<i> &gt; and insecure. Grade set to F.
</I>&gt;<i> &gt; This server accepts RC4 cipher, but only with older browsers. Grade
</I>&gt;<i> capped
</I>&gt;<i> &gt; to B.  MORE INFO &#187;
</I>&gt;<i> &gt; &lt;<A HREF="https://community.qualys.com/blogs/securitylabs/2013/03/19/">https://community.qualys.com/blogs/securitylabs/2013/03/19/</A>
</I>&gt;<i> rc4-in-tls-is-broken-now-what&gt;
</I>&gt;<i> &gt; This server's certificate chain is incomplete. Grade capped to B.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Full report here for the curious: <A HREF="https://globalsign.ssllabs.">https://globalsign.ssllabs.</A>
</I>&gt;<i> &gt; com/analyze.html?d=dl.xda-developers.com&amp;hideResults=on
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For a few thumbnails im not going to torture myself, maybe ill send the
</I>&gt;<i> &gt; forum admin a note instead :)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;PS.  EECDH will not work unless you configure a curve name in the
</I>&gt;<i> &gt; &gt;tls-dh= option. Just having dhparam.pem alone will only enable the less
</I>&gt;<i> &gt; &gt;secure DH ciphers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I did add a curve to the tls-dh param, im guessing tis correct, little
</I>&gt;<i> &gt; info on which one to use (grabbing the list from my local openssl had me
</I>&gt;<i> &gt; going what the hell)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; tls-dh=prime256v1:/cygdrive/e/Squid/etc/ssl/dhparam.pem
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Note: this made no difference whatsoever with my issue
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Adrian Miller
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 2 March 2017 at 04:08, Adrian Miller &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">adrian.m.miller at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Thanks Amos for the info, appreciate your tireless assistance for us
</I>&gt;<i> &gt;&gt; numpties :)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On 2 Mar. 2017 4:06 am, &quot;Amos Jeffries [via Squid Web Proxy Cache]&quot; &lt;
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ml-node+s1019090n4681642h47 at n4.nabble.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On 1/03/2017 4:58 a.m., stylemessiah wrote:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; This is driving me nuts, its the only issue ive found running ssl
</I>&gt;<i> bump
</I>&gt;<i> &gt;&gt;&gt; on my
</I>&gt;<i> &gt;&gt;&gt; &gt; home network for eons
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; I cant see image thumbnails on xda-developers...
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; When i access a thread with them, i get text links, not thumbnails,
</I>&gt;<i> &gt;&gt;&gt; and if i
</I>&gt;<i> &gt;&gt;&gt; &gt; click on the links i get the following:
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt;     (71) Protocol error (TLS code:
</I>&gt;<i> &gt;&gt;&gt; &gt; X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt;     SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> &gt;&gt;&gt; &gt; /C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; I figured out by googling how to (i hope) trace the problem
</I>&gt;<i> &gt;&gt;&gt; certificate via
</I>&gt;<i> &gt;&gt;&gt; &gt; s_client:
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; OpenSSL&gt; s_client -showcerts -verify 32 -connect
</I>&gt;<i> &gt;&gt;&gt; dl.xda-developers.com:443
</I>&gt;<i> &gt;&gt;&gt; &gt; verify depth is 32
</I>&gt;<i> &gt;&gt;&gt; &gt; CONNECTED(0000012C)
</I>&gt;<i> &gt;&gt;&gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt;&gt;&gt; &gt; verify error:num=20:unable to get local issuer certificate
</I>&gt;<i> &gt;&gt;&gt; &gt; verify return:1
</I>&gt;<i> &gt;&gt;&gt; &gt; depth=0 CN = *.xda-developers.com
</I>&gt;<i> &gt;&gt;&gt; &gt; verify error:num=21:unable to verify the first certificate
</I>&gt;<i> &gt;&gt;&gt; &gt; verify return:1
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; That command you used does not send data through the proxy. So that
</I>&gt;<i> &gt;&gt;&gt; confirms that the servers TLS is broken in a way unrelated to Squid.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt;&gt; &gt; Certificate chain
</I>&gt;<i> &gt;&gt;&gt; &gt;  0 s:/CN=*.xda-developers.com
</I>&gt;<i> &gt;&gt;&gt; &gt;    i:/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt;&gt; ...
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt;&gt; &gt; Server certificate
</I>&gt;<i> &gt;&gt;&gt; &gt; subject=/CN=*.xda-developers.com
</I>&gt;<i> &gt;&gt;&gt; &gt; issuer=/C=US/O=GeoTrust Inc./CN=RapidSSL SHA256 CA
</I>&gt;<i> &gt;&gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt;&gt; &gt; No client certificate CA names sent
</I>&gt;<i> &gt;&gt;&gt; &gt; Peer signing digest: SHA512
</I>&gt;<i> &gt;&gt;&gt; &gt; Server Temp Key: ECDH, P-256, 256 bits
</I>&gt;<i> &gt;&gt;&gt; &gt; ---
</I>&gt;<i> &gt;&gt;&gt; &gt; SSL handshake has read 2067 bytes and written 302 bytes
</I>&gt;<i> &gt;&gt;&gt; &gt; Verification error: unable to verify the first certificate
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; Ive found the intermediate bundle from RapidSS, and added it to my
</I>&gt;<i> &gt;&gt;&gt; existing
</I>&gt;<i> &gt;&gt;&gt; &gt; pem bundle...no change
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; You need to locate the root CA and/or intermediate CA certificates used
</I>&gt;<i> &gt;&gt;&gt; to sign the domain servers certificate.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; You then need to identify *why* they are not being trusted by your OS
</I>&gt;<i> &gt;&gt;&gt; library.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Be sure to determine whether the CA which is missing is actually
</I>&gt;<i> &gt;&gt;&gt; trustworthy before adding it to your trusted set. More than a few of
</I>&gt;<i> the
</I>&gt;<i> &gt;&gt;&gt; CA which are around are not trusted because they have been hacked or
</I>&gt;<i> &gt;&gt;&gt; caught signing forged certificates they should not have.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; Added as a separate pem i.e. sslproxy_foreign_intermediate_certs
</I>&gt;<i> &gt;&gt;&gt; &gt; /cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem...no change
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; My sslbump related config lines are:
</I>&gt;<i> &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; http_port 127.0.0.1:3128 ssl-bump generate-host-certificates=on
</I>&gt;<i> &gt;&gt;&gt; &gt; dynamic_cert_mem_cache_size=10MB cert=/cygdrive/e/Squid/etc/
</I>&gt;<i> ssl/myCA.pem
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &gt; capath=/cygdrive/e/Squid/etc/ssl
</I>&gt;<i> &gt;&gt;&gt; &gt; cafile=/cygdrive/e/Squid/etc/ssl/extra-intermediate-CA.pem
</I>&gt;<i> &gt;&gt;&gt; &gt; tls-dh=/cygdrive/e/Squid/etc/ssl/dhparam.pem
</I>&gt;<i> &gt;&gt;&gt; &gt; options=NO_SSLv2,NO_SSLv3,SINGLE_ECDH_USE
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; PS.  EECDH will not work unless you configure a curve name in the
</I>&gt;<i> &gt;&gt;&gt; tls-dh= option. Just having dhparam.pem alone will only enable the less
</I>&gt;<i> &gt;&gt;&gt; secure DH ciphers.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Amos
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt;&gt; squid-users mailing list
</I>&gt;<i> &gt;&gt;&gt; [hidden email] &lt;<A HREF="http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0">http:///user/SendEmail.jtp?type=node&amp;node=4681642&amp;i=0</A>&gt;
</I>&gt;<i> &gt;&gt;&gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; ------------------------------
</I>&gt;<i> &gt;&gt;&gt; If you reply to this email, your message will be added to the
</I>&gt;<i> discussion
</I>&gt;<i> &gt;&gt;&gt; below:
</I>&gt;<i> &gt;&gt;&gt; <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-Bump-">http://squid-web-proxy-cache.1019090.n4.nabble.com/SSL-Bump-</A>
</I>&gt;<i> &gt;&gt;&gt; and-Certificate-issue-RapidSSL-Intermediate-Cert-
</I>&gt;<i> tp4681635p4681642.html
</I>&gt;<i> &gt;&gt;&gt; To unsubscribe from SSL Bump and Certificate issue - RapidSSL
</I>&gt;<i> &gt;&gt;&gt; Intermediate Cert, click here
</I>&gt;<i> &gt;&gt;&gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=4681635&amp;code=
</I>&gt;<i> YWRyaWFuLm0ubWlsbGVyQGdtYWlsLmNvbXw0NjgxNjM1fDE5ODY3MjIyMDI=&gt;
</I>&gt;<i> &gt;&gt;&gt; .
</I>&gt;<i> &gt;&gt;&gt; NAML
</I>&gt;<i> &gt;&gt;&gt; &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/">http://squid-web-proxy-cache.1019090.n4.nabble.com/</A>
</I>&gt;<i> template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_
</I>&gt;<i> html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.
</I>&gt;<i> BasicNamespace-nabble.view.web.template.NabbleNamespace-
</I>&gt;<i> nabble.view.web.template.NodeNamespace&amp;breadcrumbs=
</I>&gt;<i> notify_subscribers%21nabble%3Aemail.naml-instant_emails%
</I>&gt;<i> 21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; I hate to advocate *drugs*, *alcohol*,* violence *or
</I>&gt;<i> &gt; *insanity* to anyone, *but* they've *always* worked for* me*
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Hunter S. Thompson
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> I hate to advocate *drugs*, *alcohol*,* violence *or
</I>&gt;<i> *insanity* to anyone, *but* they've *always* worked for* me*
</I>&gt;<i>
</I>&gt;<i> - Hunter S. Thompson
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.">http://squid-web-proxy-cache.</A>
</I>&gt;<i> 1019090.n4.nabble.com/SSL-Bump-and-Certificate-issue-
</I>&gt;<i> RapidSSL-Intermediate-Cert-tp4681635p4681647.html
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of squid-users Digest, Vol 31, Issue 3
</I>&gt;<i> ******************************************
</I>&gt;<i>
</I>


-- 
I hate to advocate *drugs*, *alcohol*,* violence *or
*insanity* to anyone, *but* they've *always* worked for* me*

- Hunter S. Thompson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170302/50651c8c/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170302/50651c8c/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014551.html">[squid-users] SSL Bump and Certificate issue - RapidSSL	Intermediate Cert
</A></li>
	<LI>Next message (by thread): <A HREF="014555.html">[squid-users] Exclude users ip from white listed Ssl bump sites
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14552">[ date ]</a>
              <a href="thread.html#14552">[ thread ]</a>
              <a href="subject.html#14552">[ subject ]</a>
              <a href="author.html#14552">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
