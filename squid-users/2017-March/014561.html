<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers	are	crashing too rapidly, need help!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.5.2%3D%3D%3E%20HTTPS%20FATAL%3A%20The%20ssl_crtd%20helpers%0A%09are%09crashing%20too%20rapidly%2C%20need%20help%21&In-Reply-To=%3C7ba701d2939c%24fa9adcc0%24efd09640%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014685.html">
   <LINK REL="Next"  HREF="014566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers	are	crashing too rapidly, need help!</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%203.5.2%3D%3D%3E%20HTTPS%20FATAL%3A%20The%20ssl_crtd%20helpers%0A%09are%09crashing%20too%20rapidly%2C%20need%20help%21&In-Reply-To=%3C7ba701d2939c%24fa9adcc0%24efd09640%24%40ngtech.co.il%3E"
       TITLE="[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers	are	crashing too rapidly, need help!">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Mar  2 21:35:57 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014685.html">[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers	are crashing too rapidly, need help!
</A></li>
        <LI>Next message (by thread): <A HREF="014566.html">[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers are crashing too rapidly, need help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14561">[ date ]</a>
              <a href="thread.html#14561">[ thread ]</a>
              <a href="subject.html#14561">[ subject ]</a>
              <a href="author.html#14561">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Really???
sslcrtd_children 1000 startup=1 idle=1

Are you series?
You don't need to google.
And before you delete the directory you need to save it first so you would be able to analyze what happen wrong with it.
There is a reason for these helpers to crash.
If they crash it's because of something...
You need to either find why they crash and to produce the issue.
How is it that my helpers do not crash but yours do crash?

For future testing save the /var/lib/ssl_db/ into a tar and then run offline the helper and see if it's crashing.
Also  on what OS are you running this?

Eliezer 

----
<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of --Ahmad--
Sent: Thursday, March 2, 2017 10:47 PM
To: Squid Users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
Subject: [squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers are crashing too rapidly, need help!

hey folks .
i have a problem with squid it get crashed after i enabled https !
cache log error =&gt; FATAL: The ssl_crtd helpers are crashing too rapidly, need help!

i googled many topics and relevant pages and couldnt find a clear solution .

the quick solution i made was i  removed the certs in file :
rm -rfv /var/lib/ssl_db/


then reinitiated the DB using cmd below :
/lib/squid/ssl_crtd -c -s /var/lib/ssl_db
chown -R squid.squid /var/lib/ssl_db
chown -R squid.squid /var/lib/ssl_db


the restarted squid .


but this is not a solution becuase squid get crashed again after certain time and i don&#8217;t know why !
my version is 3.5.2


here is squid.conf :
 /etc/squid/squid.conf
visible_hostname pcloud
acl ip1 myip 10.1.0.1
acl ip2 myip 192.168.10.210
tcp_outgoing_address 192.168.10.210 ip1
tcp_outgoing_address 192.168.10.210 ip2
#
# Recommended minimum configuration:
#

# Example rule allowing access from your local networks.
# Adapt to list your (internal) IP networks from where browsing
# should be allowed
acl localnet src 10.0.0.0/8     # RFC1918 possible internal network
acl localnet src 172.16.0.0/12  # RFC1918 possible internal network
acl localnet src 192.168.0.0/16 # RFC1918 possible internal network
acl localnet src fc00::/7       # RFC 4193 local private network range
acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged) machines

acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl CONNECT method CONNECT

#
# Recommended minimum Access Permission configuration:
#
# Deny requests to certain unsafe ports
http_access deny !Safe_ports

# Deny CONNECT to other than secure SSL ports
http_access deny CONNECT !SSL_ports
http_access allow  CONNECT 
# Only allow cachemgr access from localhost
http_access allow localhost manager
http_access deny manager

# We strongly recommend the following be uncommented to protect innocent
# web applications running on the proxy server who think the only
# one who can access services on &quot;localhost&quot; is a local user
#http_access deny to_localhost

#
# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
#

# Example rule allowing access from your local networks.
# Adapt localnet in the ACL section to list your (internal) IP networks
# from where browsing should be allowed
http_access allow localnet
http_access allow localhost

# And finally deny all other access to this proxy
http_access deny all

# Squid normally listens to port 3128
http_port 3128

# Uncomment and adjust the following to add a disk cache directory.
#cache_dir ufs /var/cache/squid 100 16 256

# Leave coredumps in the first cache dir
#coredump_dir /var/cache/squid

#
# Add any of your own refresh_pattern entries above these.
#
#

http_port 3126
#http_port 3128
#######################################
#cache_swap_low 90
#cache_swap_high 95
############################
cache_effective_user squid
cache_effective_group squid
memory_replacement_policy lru
cache_replacement_policy heap LFUDA
########################
maximum_object_size 10000 MB
#cache_mem 5000 MB
maximum_object_size_in_memory 10 MB
#########################
logfile_rotate 2
max_filedescriptors 131072
###############################
############
cache_dir aufs /var/cache/squid 600000 64 128
#######################################
https_port 3129 intercept ssl-bump generate-host-certificates=on dynamic_cert_mem_cache_size=4MB cert=/usr/local/squid/ssl_cert/myca.pem key=/usr/local/squid/ssl_cert/myca.pem
ssl_bump server-first all
sslcrtd_program /lib/squid/ssl_crtd -s /var/lib/ssl_db -M 4MB
sslcrtd_children 1000 startup=1 idle=1
###
minimum_object_size 0 bytes
#refresh patterns for caching static files
refresh_pattern ^ftp: 1440 20% 10080
refresh_pattern ^gopher: 1440 0% 1440
refresh_pattern -i .(gif|png|jpg|jpeg|ico)$ 10080 90% 43200 override-expire ignore-no-cache ignore-no-store ignore-private
refresh_pattern -i .(iso|avi|wav|mp3|mp4|mpeg|swf|flv|x-flv)$ 43200 90% 432000 override-expire ignore-no-cache ignore-no-store ignore-private
refresh_pattern -i .(deb|rpm|exe|zip|tar|tgz|ram|rar|bin|ppt|doc|tiff)$ 10080 90% 43200 override-expire ignore-no-cache ignore-no-store ignore-private
refresh_pattern -i .index.(html|htm)$ 0 40% 10080
refresh_pattern -i .(html|htm|css|js)$ 1440 40% 40320
refresh_pattern . 0 40% 40320
















any Joy Guys ?


should i update squid ? or downgrade squid ?


kind regards 



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014685.html">[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers	are crashing too rapidly, need help!
</A></li>
	<LI>Next message (by thread): <A HREF="014566.html">[squid-users] squid 3.5.2==&gt; HTTPS FATAL: The ssl_crtd helpers are crashing too rapidly, need help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14561">[ date ]</a>
              <a href="thread.html#14561">[ thread ]</a>
              <a href="subject.html#14561">[ subject ]</a>
              <a href="author.html#14561">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
