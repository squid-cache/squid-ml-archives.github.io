<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid workers question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C20170309171818.GB8584%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014631.html">
   <LINK REL="Next"  HREF="014650.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid workers question</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C20170309171818.GB8584%40fantomas.sk%3E"
       TITLE="[squid-users] squid workers question">uhlar at fantomas.sk
       </A><BR>
    <I>Thu Mar  9 17:18:18 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014631.html">[squid-users] squid workers question
</A></li>
        <LI>Next message (by thread): <A HREF="014650.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14644">[ date ]</a>
              <a href="thread.html#14644">[ thread ]</a>
              <a href="subject.html#14644">[ subject ]</a>
              <a href="author.html#14644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10.03.17 05:30, Amos Jeffries wrote:
&gt;&gt;<i> seems that my memory problem is somehow related to 4g of &quot;2K Buffers&quot;
</I>&gt;&gt;<i> whatever that means. This is cachrmgr output:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         (bytes)    KB/ch    obj/ch    (#)    used    free    part
</I>&gt;&gt;<i> %Frag    (#)    (KB)    high (KB)    high (hrs)    %Tot    (#)
</I>&gt;&gt;<i> (KB)    high (KB)    high (hrs)    %alloc    (#)    (KB)    high (KB)
</I>&gt;&gt;<i> (#)        %cnt    %vol    (#)/sec
</I>&gt;&gt;<i> 2K Buffer    2048                                1986398    3972796
</I>&gt;&gt;<i> 3972796        0.00        89.763    1986390    3972780
</I>&gt;&gt;<i> 3972796        0.00        100.000    8    16    198        10736355
</I>&gt;&gt;<i> 4.914    19.208    0.009
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Ah. So anything that is using a generic 2KB of memory. Tricky to track
</I>&gt;<i>down :-(.
</I>&gt;<i>
</I>&gt;<i>I would look at the next few entries to see if there is a good clue
</I>&gt;<i>about what system might be worth a closer look (largest amount of things
</I>&gt;<i>active, or anything else not being released). Mostly it is I/O using the
</I>&gt;<i>various Buffer's, but some other things do as well.
</I>
will be glad if this helps...

			(bytes)	KB/ch	obj/ch	(#)	used	free	part	%Frag	(#)	(KB)	high (KB)	high (hrs)	%Tot	(#)	(KB)	high (KB)	high (hrs)	%alloc	(#)	(KB)	high (KB)	(#)		%cnt	%vol	(#)/sec
mem_node		4136								62447	252228	274188		2.37		5.699	62423	252131	274188		2.37		99.962	24	97	26545		6917600		3.166	24.994	0.005
cbdata MemBuf (10)	64								2015362	125961	125961		0.01		2.846	2015348	125960	125961		0.01		99.999	14	1	103		3800466		1.739	0.212	0.004
Short Strings		40								670389	26188	28203		2.51		0.592	670008	26173	28203		2.51		99.943	381	15	1423		113557901	51.974	3.968	0.078


&gt;&gt;&gt;&gt;<i> cache_dir rock /var/spool/squid3/rock 1024 max-size=32768
</I>&gt;&gt;&gt;&gt;<i> #cache_dir aufs /var/spool/squid3 8192 16 256 min-size=32769
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> are those correct values? (bug 3411 says something about 256B metadata)
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Those 256 Byte will matter for Squid-3.4.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> doesn't it for later squid versions?
</I>&gt;<i>
</I>&gt;<i>Nope :-). Squid-3.5 'large rock' feature adds slots as needed to fit the
</I>&gt;<i>extra meta bytes. So 32KB is no longer an absolute limit.
</I>
will it waste whole slot or does it already support smaller chunks?

-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Linux - It's now safe to turn on your computer.
Linux - Teraz mozete pocitac bez obav zapnut.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014631.html">[squid-users] squid workers question
</A></li>
	<LI>Next message (by thread): <A HREF="014650.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14644">[ date ]</a>
              <a href="thread.html#14644">[ thread ]</a>
              <a href="subject.html#14644">[ subject ]</a>
              <a href="author.html#14644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
