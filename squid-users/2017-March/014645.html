<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Setting Up Squid - my scenario
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Setting%20Up%20Squid%20-%20my%20scenario&In-Reply-To=%3C3b7d2a8e-c915-59a4-b6c5-759b80b9a289%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014642.html">
   <LINK REL="Next"  HREF="014647.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Setting Up Squid - my scenario</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Setting%20Up%20Squid%20-%20my%20scenario&In-Reply-To=%3C3b7d2a8e-c915-59a4-b6c5-759b80b9a289%40treenet.co.nz%3E"
       TITLE="[squid-users] Setting Up Squid - my scenario">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar  9 17:19:48 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014642.html">[squid-users] Setting Up Squid - my scenario
</A></li>
        <LI>Next message (by thread): <A HREF="014647.html">[squid-users] Setting Up Squid - my scenario
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14645">[ date ]</a>
              <a href="thread.html#14645">[ thread ]</a>
              <a href="subject.html#14645">[ subject ]</a>
              <a href="author.html#14645">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/03/2017 6:00 a.m., S V Hareesh wrote:
&gt;<i> Ok, I tried that but it didnt work. I can put a conf file here. As a
</I>&gt;<i> start I am currently in a scenario trying to replace a simple CNTLM
</I>&gt;<i> HTTP proxy with Squid. I want to configure one account which
</I>&gt;<i> authenticates with parent proxy send the downstream requests with out
</I>&gt;<i> taking any creds.
</I>
If your CNTLM was running on the Squid machine and using the credentials
for the service account you have setup Squid to use now - then the
cache_peer login=NEGOTIATE should make Squid operate as equivalent to
what CNTLM was doing.

The config file would be useful for anyone who follows up (not just me,
who will be out of time shortly for another few days).

Also, if you can track what HTTP messages are happening and whether the
Kerberos is working properly for the Squid-&gt;parent messages it would be
useful.

The current Squid can provide HTTP details in cache.log with
&quot;debug_options 11,2&quot;. I'm not sure how you would test the Kerberos on a
Windows installation, but the Negotiate auth headers in those messages
might give a few clues anyway.

HTH
Amos


&gt;<i>   On Thu, Mar 9, 2017 at 4:50 PM, Amos Jeffrieswrote:
</I>&gt;&gt;<i>     On 10/03/2017 5:19 a.m., S V Hareesh wrote:
</I>&gt;&gt;<i> On top of the conf file from default setup on Windows, I added the following line in the conf. I added the dns servers and allowed localhost.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cache_peer &lt;corporate_proxy&gt; parent 80 0 default connection-auth=on proxy-only
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> never_direct allow all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I point my browser to this proxy, it gives me 407, auth required. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, configured squid service on windows to run with a service account that has access to Internet/corp proxy.
</I>&gt;<i> 
</I>&gt;<i> Squid cannot authenticate to a cache_peer using NTLM. It can only do
</I>&gt;<i> Nagotiate/Kerberos to the parent proxy, and only when &quot;login=NEGOTIATE&quot;
</I>&gt;<i> is added (with or without a named keytab file).
</I>&gt;<i> 
</I>&gt;<i> NOTE: 'connection-auth=on' is about allowing the browser to use NTLM or
</I>&gt;<i> Negotiate/Kerberos through the cache_peer. It needs to also have
</I>&gt;<i> &quot;login=PASSTHRU&quot; if that peer is a proxy (as opposed to a web or
</I>&gt;<i> Exchange server).
</I>&gt;<i> 
</I>&gt;<i> See the 'AUTHENTICATION OPTIONS' section of
</I>&gt;<i> &lt;<A HREF="http://www.squid-cache.org/Doc/config/cache_peer/">http://www.squid-cache.org/Doc/config/cache_peer/</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>   
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014642.html">[squid-users] Setting Up Squid - my scenario
</A></li>
	<LI>Next message (by thread): <A HREF="014647.html">[squid-users] Setting Up Squid - my scenario
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14645">[ date ]</a>
              <a href="thread.html#14645">[ thread ]</a>
              <a href="subject.html#14645">[ subject ]</a>
              <a href="author.html#14645">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
