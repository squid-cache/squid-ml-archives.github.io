<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid workers question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C7b386e00-97ed-054c-902f-0df367e8ec49%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014646.html">
   <LINK REL="Next"  HREF="014660.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid workers question</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C7b386e00-97ed-054c-902f-0df367e8ec49%40measurement-factory.com%3E"
       TITLE="[squid-users] squid workers question">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Mar  9 18:02:17 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014646.html">[squid-users] squid workers question
</A></li>
        <LI>Next message (by thread): <A HREF="014660.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14653">[ date ]</a>
              <a href="thread.html#14653">[ thread ]</a>
              <a href="subject.html#14653">[ subject ]</a>
              <a href="author.html#14653">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/09/2017 10:24 AM, Matus UHLAR - fantomas wrote:
&gt;&gt;<i> On 03/09/2017 09:54 AM, Matus UHLAR - fantomas wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Master is not a
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> kid (it is a parent of all kids), the first N kids are workers, the
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> next D kids are diskers, and the last kid is Coordinator. Please
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> see the
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> following wiki section for more details.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>   <A HREF="http://wiki.squid-cache.org/Features/SmpScale#Terminology">http://wiki.squid-cache.org/Features/SmpScale#Terminology</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Yes, &quot;1&quot; is the default value for the workers directive.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> and this is why I wonder we have three kids, both when &quot;workers&quot;
</I>&gt;&gt;&gt;&gt;&gt;<i> commented out and when set to 1.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In my earlier paragraph, N is the value of the workers directive. There
</I>&gt;&gt;&gt;&gt;<i> are other kids (D diskers and one Coordinator). D is the number of rock
</I>&gt;&gt;&gt;&gt;<i> cache_dirs. Both workers and diskers need shared memory and IPC.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If you want to turn off SMP while using rock store, start Squid with
</I>&gt;&gt;&gt;&gt;<i> -N.
</I>&gt;&gt;&gt;&gt;<i> When started with -N, there will be a single process playing all four
</I>&gt;&gt;&gt;&gt;<i> roles (master, worker, disker, and Coordinator).
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Will running with &quot;workers 1&quot; avoid this issue while using separate
</I>&gt;&gt;&gt;<i> processes for diskers?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 09.03.17 10:01, Alex Rousskov wrote:
</I>&gt;&gt;<i> No. Disker processes need shared memory to communicate with worker(s).
</I>&gt;<i> 
</I>&gt;<i> I should rephrase my question:
</I>&gt;<i> 
</I>&gt;<i> since aufs is incompatible with SMP and rockstore runs separate diskers,
</I>
To clarify: Rock store is supported with our without separate disker
processes. Rock is SMP-aware, SMP-capable, and nonSMP-capable. All other
stores are SMP-unaware and nonSMP-capable.


&gt;<i> is running aufs with rock store and safe, when not running with &quot;-N&quot;?
</I>
Running a combination of AUFS and Rock stores in non-SMP mode may be
safe but primary Rock store developers do not test this combination.

Running AUFS in SMP mode is unsafe by default but some admins use
configuration hacks to make it work for them. Primary Store developers
do not test such configurations (or AUFS in general).

Running a combination of AUFS and Rock stores in SMP mode is crazy.

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014646.html">[squid-users] squid workers question
</A></li>
	<LI>Next message (by thread): <A HREF="014660.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14653">[ date ]</a>
              <a href="thread.html#14653">[ thread ]</a>
              <a href="subject.html#14653">[ subject ]</a>
              <a href="author.html#14653">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
