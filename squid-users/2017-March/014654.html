<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] microsoft edge and proxy auth not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20microsoft%20edge%20and%20proxy%20auth%20not%20working&In-Reply-To=%3C2197768425D7F5479A0FFB3FEC212F7FF5D8D297%40aesmail.surcouf.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014652.html">
   <LINK REL="Next"  HREF="014655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] microsoft edge and proxy auth not working</H1>
    <B>Mike Surcouf</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20microsoft%20edge%20and%20proxy%20auth%20not%20working&In-Reply-To=%3C2197768425D7F5479A0FFB3FEC212F7FF5D8D297%40aesmail.surcouf.local%3E"
       TITLE="[squid-users] microsoft edge and proxy auth not working">mikes at surcouf.co.uk
       </A><BR>
    <I>Thu Mar  9 18:09:11 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014652.html">[squid-users] microsoft edge and proxy auth not working
</A></li>
        <LI>Next message (by thread): <A HREF="014655.html">[squid-users] microsoft edge and proxy auth not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14654">[ date ]</a>
              <a href="thread.html#14654">[ thread ]</a>
              <a href="subject.html#14654">[ subject ]</a>
              <a href="author.html#14654">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ah OK sorry
I am curious why you have a reason to use NTLM over Kerberos? :-)

-----Original Message-----
From: Rafael Akchurin [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rafael.akchurin at diladele.com</A>] 
Sent: 09 March 2017 18:01
To: Mike Surcouf
Cc: Amos Jeffries; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] microsoft edge and proxy auth not working

Hello Mike,

I specifically was debugging our NTLM implementation with Edge :)

Kerberos works just fine, you are correct.

Best regards,
Rafael Akchurin

&gt;<i> Op 9 mrt. 2017 om 18:57 heeft Mike Surcouf &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">mikes at surcouf.co.uk</A>&gt; het volgende geschreven:
</I>&gt;<i> 
</I>&gt;<i> Hi Rafael
</I>&gt;<i> 
</I>&gt;<i> Is there any reason you can't use Kerberos.
</I>&gt;<i> Note you will need to create a keytab but the setup is not that hard and in the docs.
</I>&gt;<i> I use it very successfully on window AD network.
</I>&gt;<i> 
</I>&gt;<i> auth_param negotiate program /usr/lib64/squid/negotiate_kerberos_auth
</I>&gt;<i> auth_param negotiate children 20
</I>&gt;<i> auth_param negotiate keep_alive on
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> 
</I>&gt;<i> Mike
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] 
</I>&gt;<i> On Behalf Of Rafael Akchurin
</I>&gt;<i> Sent: 09 March 2017 17:01
</I>&gt;<i> To: Amos Jeffries; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] microsoft edge and proxy auth not working
</I>&gt;<i> 
</I>&gt;<i> Hello Amos, Markus, all,
</I>&gt;<i> 
</I>&gt;<i> Just as a side note - I also suffered  from this error sometime before with Edge and our custom NTLM relay to domain controllers (run as auth helper by Squid). The strange thing it went away after installing some (unknown) Windows update.
</I>&gt;<i> 
</I>&gt;<i> I do have the &quot;auth_param ntlm keep_alive off&quot; in the config though.
</I>&gt;<i> 
</I>&gt;<i> It all makes me quite suspicious the error was/is in Edge or in my curly hands.
</I>&gt;<i> 
</I>&gt;<i> Best regards,
</I>&gt;<i> Rafael Akchurin
</I>&gt;<i> Diladele B.V.
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] 
</I>&gt;<i> On Behalf Of Amos Jeffries
</I>&gt;<i> Sent: Thursday, March 9, 2017 5:12 PM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] microsoft edge and proxy auth not working
</I>&gt;<i> 
</I>&gt;<i> On 8/03/2017 11:28 p.m., Rietzler, Markus (RZF, Aufg 324 /
</I>&gt;<i> &lt;RIETZLER_SOFTWARE&gt;) wrote:
</I>&gt;&gt;<i> i should add that we are using squid 3.5.24.
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Try with &quot;auth_param ntlm keep_alive off&quot;. Recently the browsers have been needing that.
</I>&gt;<i> 
</I>&gt;<i> Though frankly I am surprised if Edge supports NTLM at all. It was deprecated in April 2006 and MS announced removal was being actively pushed in all thier software since Win7.
</I>&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> -----Urspr&#252;ngliche Nachricht-----
</I>&gt;&gt;&gt;<i> Von: Rietzler, Markus
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> we have some windows 10 clients using microsoft edge browser.
</I>&gt;&gt;&gt;<i> access to internet is only allowed for authenticated users. we are 
</I>&gt;&gt;&gt;<i> using samba/winbind auth
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> auth_param ntlm program /usr/bin/ntlm_auth
</I>&gt;&gt;&gt;<i> --helper-protocol=squid-2.5- ntlmssp auth_param ntlm children 64
</I>&gt;&gt;&gt;<i> startup=24 idle=12 auth_param ntlm keep_alive on acl auth_user 
</I>&gt;&gt;&gt;<i> proxy_auth REQUIRED
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> on windows 10 clients with IE11 it is working (with ntlm automatic
</I>&gt;&gt;&gt;<i> auth) on the same machine, with Microsoft edge I get TCP_Denied/407 message.
</I>&gt;&gt;&gt;<i> seems I only get one single TCP_DENIED/407 line in accesslog and an 
</I>&gt;&gt;&gt;<i> auth dialog pops up. I have disabled basic auth via ntlm.
</I>&gt;&gt;&gt;<i> shouldn't there be 3 lines for proxy auth? with IE11 I see those 
</I>&gt;&gt;&gt;<i> three lines (2x TCP_DENIED/407 and 1x TCP_MISS/200), no popup at all.
</I>&gt;<i> 
</I>&gt;<i> Not specifically. There should be 1+ for NTLM. Success with NTLM shows
</I>&gt;<i> 2+. Failure shows 1 or 3 or infinite loop (hello Safari and Firefox 30-ish).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> winbind/samba itself seems to work, as I can do an user auth against 
</I>&gt;&gt;&gt;<i> apache with winbind/samba - even over some squid proxies with 
</I>&gt;&gt;&gt;<i> connection-auth allowed. but not for proxy-auth.
</I>&gt;&gt;&gt;<i> is there any option in squid.conf which prevents Edge to do a 
</I>&gt;&gt;&gt;<i> successful auth?
</I>&gt;<i> 
</I>&gt;<i> If other software succeeds then the only thing that might be related is the keep-alive option mentioned above. Otherwise the problem is in Edge itself.
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014652.html">[squid-users] microsoft edge and proxy auth not working
</A></li>
	<LI>Next message (by thread): <A HREF="014655.html">[squid-users] microsoft edge and proxy auth not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14654">[ date ]</a>
              <a href="thread.html#14654">[ thread ]</a>
              <a href="subject.html#14654">[ subject ]</a>
              <a href="author.html#14654">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
