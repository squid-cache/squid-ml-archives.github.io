<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid workers question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C01a401d29994%248cf2af10%24a6d80d30%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014633.html">
   <LINK REL="Next"  HREF="014634.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid workers question</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20workers%20question&In-Reply-To=%3C01a401d29994%248cf2af10%24a6d80d30%24%40ngtech.co.il%3E"
       TITLE="[squid-users] squid workers question">eliezer at ngtech.co.il
       </A><BR>
    <I>Fri Mar 10 11:50:38 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014633.html">[squid-users] squid workers question
</A></li>
        <LI>Next message (by thread): <A HREF="014634.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14665">[ date ]</a>
              <a href="thread.html#14665">[ thread ]</a>
              <a href="subject.html#14665">[ subject ]</a>
              <a href="author.html#14665">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Just to add that one of my current test labs of squid is a combination of:
1 haproxy as balancer(or a custom LB I wrote)
2+ squid instances with the proxy protocol enabled and each has it's own ufs\aufs cache_dir

The idea was to verify if it would be possible to let different instances communicate via htcp\icp as the &quot;signaling&quot; or &quot;communication&quot; channel instead of shared memory.
The situation is that I cannot continue testing it since there is a bug with the sibling proxies communication.

I would be happy if this is will be resolved and then the test might be able to let couple squid instances that runs on the same machine to be able to utilize aufs\ufs better(taking into account that there is an overhead to this whole setup..) for some places.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Thursday, March 9, 2017 6:36 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] squid workers question

On 10/03/2017 5:19 a.m., Matus UHLAR - fantomas wrote:
&gt;&gt;<i> On 03/09/2017 07:21 AM, Matus UHLAR - fantomas wrote:
</I>&gt;&gt;&gt;<i> I have installed squid 3.4.8 on linux 3.16/64bit (debian 8 / jessie
</I>&gt;&gt;&gt;<i> version)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> (I know it's old, but I prefer using distribution-provided SW unless 
</I>&gt;&gt;&gt;<i> it has real problem distribution isn't able to fix)
</I>&gt;<i> 
</I>&gt;<i> On 09.03.17 09:07, Alex Rousskov wrote:
</I>&gt;&gt;<i> My answers are based on v5 code. (I know v5 is new, but I do not 
</I>&gt;&gt;<i> remember v3.4 specifics and v5 answers will be valid for a longer 
</I>&gt;&gt;<i> time.)
</I>&gt;<i> 
</I>&gt;<i> OK
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> I configured rock store (for smaller files) and (later) standard 
</I>&gt;&gt;&gt;<i> aufs for others:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> cache_dir rock /var/spool/squid3/rock 1024 max-size=32768 #cache_dir 
</I>&gt;&gt;&gt;<i> aufs /var/spool/squid3 8192 16 256 min-size=32769
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> are those correct values? (bug 3411 says something about 256B 
</I>&gt;&gt;&gt;<i> metadata)
</I>&gt;<i> 
</I>&gt;&gt;<i> Both rock and AUFS stores support large objects so there is no 
</I>&gt;&gt;<i> requirement to split storage based on object sizes. Each store has 
</I>&gt;&gt;<i> various pros and cons, but lack of large object support is not one of 
</I>&gt;&gt;<i> the distinguishing characteristics.
</I>&gt;<i> 
</I>&gt;<i> I thought the cons of *ufs/disks is ineffective storage of small 
</I>&gt;<i> files, while rock is ineffective with big files...
</I>&gt;<i> 
</I>
Yes, *efficiency*, not lack of support.

[except in this case of your 3.4 where rock does explicitly lack the support].


&gt;&gt;&gt;<i> - do I get it right that kid1 is the Master, kid2 is the disker for rock
</I>&gt;&gt;&gt;<i>   store and kid3 is the single worker process?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In SMP mode (which, BTW, AUFS store does not support),
</I>&gt;<i> 
</I>&gt;<i> could it crash squid instead of complaining?
</I>
Are you talking about when AUFS is used in SMP mode? it is not that simple, there are ways to configure it to be used by a single worker (&quot;if&quot; directive, or $(process_number) macro) which is fine and work well for certain version-specific situations.


Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014633.html">[squid-users] squid workers question
</A></li>
	<LI>Next message (by thread): <A HREF="014634.html">[squid-users] squid workers question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14665">[ date ]</a>
              <a href="thread.html#14665">[ thread ]</a>
              <a href="subject.html#14665">[ subject ]</a>
              <a href="author.html#14665">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
