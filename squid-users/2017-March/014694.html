<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Setting Up Squid - my scenario
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Setting%20Up%20Squid%20-%20my%20scenario&In-Reply-To=%3C94682844.4059124.1489338359749%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014647.html">
   <LINK REL="Next"  HREF="014606.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Setting Up Squid - my scenario</H1>
    <B>S V Hareesh</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Setting%20Up%20Squid%20-%20my%20scenario&In-Reply-To=%3C94682844.4059124.1489338359749%40mail.yahoo.com%3E"
       TITLE="[squid-users] Setting Up Squid - my scenario">harishmeetsu at yahoo.com
       </A><BR>
    <I>Sun Mar 12 17:05:59 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014647.html">[squid-users] Setting Up Squid - my scenario
</A></li>
        <LI>Next message (by thread): <A HREF="014606.html">[squid-users] Getting lots of: &quot;WARNING: HTTP: Invalid Response: No	object data received for ...&quot; in cache.log squid 3.5.24
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14694">[ date ]</a>
              <a href="thread.html#14694">[ thread ]</a>
              <a href="subject.html#14694">[ subject ]</a>
              <a href="author.html#14694">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have put login=PASS and configured Squid service to run with a service account that has internet account, it started working.&#160;CheersS.V.<A HREF="Hareeshhttp://svhareesh.blogspot.com&#160;Say">Hareeshhttp://svhareesh.blogspot.com&#160;Say</A> no to plastic &amp; pollution.... go environment friendly 

    On Thursday, 9 March 2017 5:30 PM, S V Hareesh &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">harishmeetsu at yahoo.com</A>&gt; wrote:
 

 Here is the conf file.
http_port 3128cache_peer &lt;corp_proxy_IP&gt; parent &lt;Parent_proxy_port&gt; 0 no-query default proxy-only login=NEGOTIATE&#160;
acl manager proto cache_objectacl localhost src 127.0.0.1/255.255.255.255acl all src 0.0.0.0/0.0.0.0http_access allow allnever_direct allow allicp_access deny all
cache_effective_user squid#cache_effective_group wheel
max_filedescriptors 3200&#160;I am not sure what is it that I am missing. I have been wire sharking both the resultant packets when using CNTLM and when using squid, I can see the proxy auth header piece in the Squid packet missing.
CheersS.V.<A HREF="Hareeshhttp://svhareesh.blogspot.com&#160;">Hareeshhttp://svhareesh.blogspot.com&#160;</A>
 

    On Thursday, 9 March 2017 5:20 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
 

 On 10/03/2017 6:00 a.m., S V Hareesh wrote:
&gt;<i> Ok, I tried that but it didnt work. I can put a conf file here. As a
</I>&gt;<i> start I am currently in a scenario trying to replace a simple CNTLM
</I>&gt;<i> HTTP proxy with Squid. I want to configure one account which
</I>&gt;<i> authenticates with parent proxy send the downstream requests with out
</I>&gt;<i> taking any creds.
</I>
If your CNTLM was running on the Squid machine and using the credentials
for the service account you have setup Squid to use now - then the
cache_peer login=NEGOTIATE should make Squid operate as equivalent to
what CNTLM was doing.

The config file would be useful for anyone who follows up (not just me,
who will be out of time shortly for another few days).

Also, if you can track what HTTP messages are happening and whether the
Kerberos is working properly for the Squid-&gt;parent messages it would be
useful.

The current Squid can provide HTTP details in cache.log with
&quot;debug_options 11,2&quot;. I'm not sure how you would test the Kerberos on a
Windows installation, but the Negotiate auth headers in those messages
might give a few clues anyway.

HTH
Amos


&gt;<i>&#160; On Thu, Mar 9, 2017 at 4:50 PM, Amos Jeffrieswrote:
</I>&gt;&gt;<i>&#160; &#160; On 10/03/2017 5:19 a.m., S V Hareesh wrote:
</I>&gt;&gt;<i> On top of the conf file from default setup on Windows, I added the following line in the conf. I added the dns servers and allowed localhost.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cache_peer &lt;corporate_proxy&gt; parent 80 0 default connection-auth=on proxy-only
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> never_direct allow all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I point my browser to this proxy, it gives me 407, auth required. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, configured squid service on windows to run with a service account that has access to Internet/corp proxy.
</I>&gt;<i> 
</I>&gt;<i> Squid cannot authenticate to a cache_peer using NTLM. It can only do
</I>&gt;<i> Nagotiate/Kerberos to the parent proxy, and only when &quot;login=NEGOTIATE&quot;
</I>&gt;<i> is added (with or without a named keytab file).
</I>&gt;<i> 
</I>&gt;<i> NOTE: 'connection-auth=on' is about allowing the browser to use NTLM or
</I>&gt;<i> Negotiate/Kerberos through the cache_peer. It needs to also have
</I>&gt;<i> &quot;login=PASSTHRU&quot; if that peer is a proxy (as opposed to a web or
</I>&gt;<i> Exchange server).
</I>&gt;<i> 
</I>&gt;<i> See the 'AUTHENTICATION OPTIONS' section of
</I>&gt;<i> &lt;<A HREF="http://www.squid-cache.org/Doc/config/cache_peer/">http://www.squid-cache.org/Doc/config/cache_peer/</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Amos
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>&#160; 
</I>&gt;<i> 
</I>


   

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170312/7e8b0831/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170312/7e8b0831/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014647.html">[squid-users] Setting Up Squid - my scenario
</A></li>
	<LI>Next message (by thread): <A HREF="014606.html">[squid-users] Getting lots of: &quot;WARNING: HTTP: Invalid Response: No	object data received for ...&quot; in cache.log squid 3.5.24
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14694">[ date ]</a>
              <a href="thread.html#14694">[ thread ]</a>
              <a href="subject.html#14694">[ subject ]</a>
              <a href="author.html#14694">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
