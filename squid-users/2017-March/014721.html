<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] No failover when default parent proxy fails (Squid 3.5.12)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20No%20failover%20when%20default%20parent%20proxy%20fails%0A%20%28Squid%203.5.12%29&In-Reply-To=%3C046af0e9-0baa-2b1b-164e-9edb0de5fa69%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014720.html">
   <LINK REL="Next"  HREF="014723.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] No failover when default parent proxy fails (Squid 3.5.12)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20No%20failover%20when%20default%20parent%20proxy%20fails%0A%20%28Squid%203.5.12%29&In-Reply-To=%3C046af0e9-0baa-2b1b-164e-9edb0de5fa69%40treenet.co.nz%3E"
       TITLE="[squid-users] No failover when default parent proxy fails (Squid 3.5.12)">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Mar 16 08:27:36 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014720.html">[squid-users] No failover when default parent proxy fails (Squid 3.5.12)
</A></li>
        <LI>Next message (by thread): <A HREF="014723.html">[squid-users] No failover when default parent proxy fails (Squid 3.5.12)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14721">[ date ]</a>
              <a href="thread.html#14721">[ thread ]</a>
              <a href="subject.html#14721">[ subject ]</a>
              <a href="author.html#14721">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/03/2017 7:05 p.m., Jens Offenbach wrote:
&gt;<i> Thanks for your quick response...
</I>&gt;<i> 
</I>&gt;<i> I have also configured, but the value seems not to be honored: 
</I>&gt;<i> connect_timeout 30 seconds
</I>&gt;<i> 
</I>&gt;<i> The primary peer is down, but Squid does not print any &quot;Dead parent&quot;
</I>&gt;<i> in the logs. Every HTTPS request is forwarded to the primary peer and
</I>&gt;<i> it takes 1 minute until the secondary peer gets used, even with
</I>&gt;<i> &quot;connect_timeout 30 seconds&quot;. I think, I am facing the first issue
</I>&gt;<i> that has been fixed by your patch.
</I>&gt;<i> 
</I>
The global config options being ignored completely is correct because
your peer have individual connect-timeout=5 settings.

So, those 5sec timeouts should be used instead now as before.

Though note that they apply only to how long a TCP connection (SYN,
SYN-ACK) is waited for. There is also a dns_timeout and peer selection
timeout that apply separately to the act of connecting. And a
forward_timeout global limit that all those operations have to fit
within, including retries.


Did you have a chance to try the debug setting I suggested at the
beginning? That will give you an immediate view about what Squid is
detecting as usable paths for each and every request and at what times
relative to the DEAD/LIVE notice.



&gt;<i> Are there any plans to backport this fix to Xenial APT repositories
</I>&gt;<i> or to create a new Debian package for Squid4/5?
</I>
That is up to the Ubuntu server team, but I think it Unlikely. Zesty is
the current stable and things like this generally dont have enough
widespread impact to qualify for LTS backports.

Debian is now frozen to stabilize for the &quot;Buster&quot; release, that will
contain Squid-3.5.23 plus some few critical patches which are already
set. A Squid-4 package is ready and waiting for the release freeze to
end before it goes public in the Debian Unstable/Testing repos.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014720.html">[squid-users] No failover when default parent proxy fails (Squid 3.5.12)
</A></li>
	<LI>Next message (by thread): <A HREF="014723.html">[squid-users] No failover when default parent proxy fails (Squid 3.5.12)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14721">[ date ]</a>
              <a href="thread.html#14721">[ thread ]</a>
              <a href="subject.html#14721">[ subject ]</a>
              <a href="author.html#14721">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
