<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SMP and AUFS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP%20and%20AUFS&In-Reply-To=%3C075101d2a090%24db0bbcc0%2491233640%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014741.html">
   <LINK REL="Next"  HREF="014743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SMP and AUFS</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP%20and%20AUFS&In-Reply-To=%3C075101d2a090%24db0bbcc0%2491233640%24%40ngtech.co.il%3E"
       TITLE="[squid-users] SMP and AUFS">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Mar 19 09:11:49 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014741.html">[squid-users] SMP and AUFS
</A></li>
        <LI>Next message (by thread): <A HREF="014743.html">[squid-users] SMP and AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14742">[ date ]</a>
              <a href="thread.html#14742">[ thread ]</a>
              <a href="subject.html#14742">[ subject ]</a>
              <a href="author.html#14742">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think that some warning message like &quot;WARNING: be sure you know that UFS\AUFS doesn't support SMP\MultiWorkers&quot; should be added to the stderr or cache.log.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of senor
Sent: Sunday, March 19, 2017 7:12 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] SMP and AUFS

On 3/17/2017 7:45, Alex Rousskov wrote:
&gt;<i> On 03/16/2017 10:42 PM, senor wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> I understand that AUFS is not SMP aware but if each worker has its own
</I>&gt;&gt;<i> AUFS cache is there any problem other than the inefficiencies of
</I>&gt;&gt;<i> duplicate cache?
</I>&gt;<i> 
</I>&gt;<i> Yes. Clients may get stale cached entries, possibly breaking advanced
</I>&gt;<i> HTTP transactions that rely on a more-or-less compliant proxy cache.
</I>&gt;<i> 
</I>&gt;<i> Also, I do not know exactly how local and shared cache indexes interact
</I>&gt;<i> when SMP-unaware store updates its local index without updating the
</I>&gt;<i> shared one. Most likely, such partial updates lead to bugs. You may
</I>&gt;<i> reduce bugs probability by not mixing shared and ufs-based stores in SMP
</I>&gt;<i> mode, but I doubt you can eliminate all problems that way.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> I'm pretty sure that AUFS is used with squid running in SMP mode a lot.
</I>&gt;<i> 
</I>&gt;<i> I can think of many examples where a lot of people do things they should
</I>&gt;<i> not be doing and do not do things they should be doing. Just because
</I>&gt;<i> many use X to solve some problem, does not make using X a good idea and
</I>&gt;<i> certainly does not make it the best solution available.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> The squid wiki even has a CARP configuration example for this combination.
</I>&gt;<i> 
</I>&gt;<i> I hope there are no official examples advertising SMP AUFS
</I>&gt;<i> configurations. If there are, they should be removed IMO.
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>There are many references in the squid wiki, FAQ and Knowlegebase about
SMP but I don't see any of them reflecting the concerns you have brought
up. My point in mentioning that there are a lot of installations using
SMP and AUFS is that something widely used but buggy tends to be brought
up on this email list and I haven't seen it.

I'm not trying to claim there are no problems. I'm just making sure my
expectations are realistic. Your comments were the first I became aware
anyone thought poorly about the combination of AUFS with SMP. Rock is of
course preferred but it comes with more baggage than AUFS. My own
experience has been pretty good. Maybe just lucky.

Senor
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014741.html">[squid-users] SMP and AUFS
</A></li>
	<LI>Next message (by thread): <A HREF="014743.html">[squid-users] SMP and AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14742">[ date ]</a>
              <a href="thread.html#14742">[ thread ]</a>
              <a href="subject.html#14742">[ subject ]</a>
              <a href="author.html#14742">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
