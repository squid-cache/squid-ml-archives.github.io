<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] URL list from a URL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20list%20from%20a%20URL&In-Reply-To=%3C08aa01d2a338%24f3a7eb50%24daf7c1f0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014811.html">
   <LINK REL="Next"  HREF="014801.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] URL list from a URL</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20list%20from%20a%20URL&In-Reply-To=%3C08aa01d2a338%24f3a7eb50%24daf7c1f0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] URL list from a URL">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Mar 22 18:20:14 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014811.html">[squid-users] URL list from a URL
</A></li>
        <LI>Next message (by thread): <A HREF="014801.html">[squid-users] URL list from a URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14812">[ date ]</a>
              <a href="thread.html#14812">[ thread ]</a>
              <a href="subject.html#14812">[ subject ]</a>
              <a href="author.html#14812">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Almost, What I was talking about and meant was to take the current official StoreID helper written in perl and remove the parts of the ID replacement while leaving the regex matching intact.
Then pass to the StoreID helper the url and the source IP and let it match the url to the regex from the list in the &quot;DB file&quot;.
If it matches either return OK or ERR depends on the intention of the helper.
...The X code have almost everything needed so just convert it.
I am offering to convert it if there is some interest in it.

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Alex Rousskov
Sent: Wednesday, March 22, 2017 6:10 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] URL list from a URL

On 03/22/2017 09:25 AM, Eliezer Croitoru wrote:

&gt;<i> I didn't meant by convert the StoreID helper to convert it into an external_acl helper....
</I>&gt;<i> It has both OK and ERR and a &quot;checklist&quot; which would be a match or not.
</I>
Sigh. The combination of your answers does not make any sense to me.
Squid does not use StoreID helpers to block access, regardless of what a StoreID helper returns. It is certainly possible to take some StoreID helper code and make an external_acl helper out of it, but that falls under my option #2.

Perhaps what you meant to say is something like &quot;Use StoreID helper X available at Y to implement option #2 -- that X code has everything you need!&quot;?

Alex.


&gt;<i> -----Original Message-----
</I>&gt;<i> From: Alex Rousskov [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>]
</I>&gt;<i> Sent: Wednesday, March 22, 2017 3:51 PM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Cc: Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt;
</I>&gt;<i> Subject: Re: [squid-users] URL list from a URL
</I>&gt;<i> 
</I>&gt;<i> On 03/21/2017 06:17 PM, Eliezer Croitoru wrote:
</I>&gt;&gt;<i> The current StoreID helper can be converted pretty fast into what he needs.
</I>&gt;<i> 
</I>&gt;<i> Jason needs to block access. How can a [converted] StoreID helper 
</I>&gt;<i> block access without becoming an external_acl helper?
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] 
</I>&gt;&gt;<i> On Behalf Of Alex Rousskov
</I>&gt;&gt;<i> Sent: Tuesday, March 21, 2017 11:43 PM
</I>&gt;&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> Subject: Re: [squid-users] URL list from a URL
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 03/21/2017 02:30 PM, Jason B. Nance wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I should have mentioned that I'm not caching, I'm only using Squid 
</I>&gt;&gt;&gt;<i> for whitelisting in this case.  Would you still say this is the 
</I>&gt;&gt;&gt;<i> right path?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> No. You probably have two better options:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. Use a file with list of mirror URLs as an ACL parameter. Write a 
</I>&gt;&gt;<i> script that updates that file and reconfigures Squid as needed. 
</I>&gt;&gt;<i> Please keep in mind that Squid reconfiguration is currently a 
</I>&gt;&gt;<i> relatively heavy/intrusive operation, even if there were not changes 
</I>&gt;&gt;<i> except for that single ACL.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. Write an external_acl helper that will consult the mirror list. 
</I>&gt;&gt;<i> This will make each HTTP transaction a little slower (because it 
</I>&gt;&gt;<i> needs to go to the helper) but eliminates reconfigurations. The 
</I>&gt;&gt;<i> helper itself or some other script will still need to update the 
</I>&gt;&gt;<i> mirror list as needed, of course.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I'm using Squid 3.5.20 and wonder if it is possible to define an ACL which retrieves the list of URLs from another URL (similar to pointing to a file).  In this specific use case it is to allow a Foreman server to sync Yum content from the CentOS mirrors.  I tell Foreman to use the following URL:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=updates">http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=updates</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Which returns a list of URLs, such as:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://repo1.dal.innoscale.net/centos/7.3.1611/updates/x86_64/">http://repo1.dal.innoscale.net/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://linux.mirrors.es.net/centos/7.3.1611/updates/x86_64/">http://linux.mirrors.es.net/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://reflector.westga.edu/repos/CentOS/7.3.1611/updates/x86_64/">http://reflector.westga.edu/repos/CentOS/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirror.jax.hugeserver.com/centos/7.3.1611/updates/x86_64/">http://mirror.jax.hugeserver.com/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://ftp.linux.ncsu.edu/pub/CentOS/7.3.1611/updates/x86_64/">http://ftp.linux.ncsu.edu/pub/CentOS/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirror.nexcess.net/CentOS/7.3.1611/updates/x86_64/">http://mirror.nexcess.net/CentOS/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirror.web-ster.com/centos/7.3.1611/updates/x86_64/">http://mirror.web-ster.com/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://centos.host-engine.com/7.3.1611/updates/x86_64/">http://centos.host-engine.com/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirror.raystedman.net/centos/7.3.1611/updates/x86_64/">http://mirror.raystedman.net/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mirror.linux.duke.edu/pub/centos/7.3.1611/updates/x86_64/">http://mirror.linux.duke.edu/pub/centos/7.3.1611/updates/x86_64/</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Foreman then starts a new HTTP connection (not a redirect) to attempt to connect to those in turn until it works.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> So I would like to configure Squid to allow the Foreman server access to any of those URLs (the list changes somewhat often).
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I started to go down the external_acl_type but am wondering if I'm missing something obvious.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014811.html">[squid-users] URL list from a URL
</A></li>
	<LI>Next message (by thread): <A HREF="014801.html">[squid-users] URL list from a URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14812">[ date ]</a>
              <a href="thread.html#14812">[ thread ]</a>
              <a href="subject.html#14812">[ subject ]</a>
              <a href="author.html#14812">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
