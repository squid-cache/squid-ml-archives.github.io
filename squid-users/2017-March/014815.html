<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid stopped working after cache.log and	access.log	rotation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20stopped%20working%20after%20cache.log%20and%0A%09access.log%09rotation&In-Reply-To=%3C097b01d2a418%24588f1c70%2409ad5550%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014814.html">
   <LINK REL="Next"  HREF="014816.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid stopped working after cache.log and	access.log	rotation</H1>
    <B>Eliezer  Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20stopped%20working%20after%20cache.log%20and%0A%09access.log%09rotation&In-Reply-To=%3C097b01d2a418%24588f1c70%2409ad5550%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid stopped working after cache.log and	access.log	rotation">eliezer at ngtech.co.il
       </A><BR>
    <I>Thu Mar 23 20:59:21 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="014814.html">[squid-users] Squid stopped working after cache.log and	access.log rotation
</A></li>
        <LI>Next message (by thread): <A HREF="014816.html">[squid-users] Why do we have to set pinger_enable to off to get	Squid to work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14815">[ date ]</a>
              <a href="thread.html#14815">[ thread ]</a>
              <a href="subject.html#14815">[ subject ]</a>
              <a href="author.html#14815">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There is another option!
The log rotate script is doing something nasty or the systemd service file start up squid in a weird way.
The output of:
$ systemctl status squid
$ top -n1 -b
$ ps aux
$ df -h
$ netstat -ntulp
$ lsof -n|egrep &quot;proxy|squid&quot;

How many clients this system has?
Is the system facing the Internet directly or behind some nat(aws or another provider)?

The above are the basic required data to understand the situation.

All The Bests,
Eliezer

----
<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Chee M Gui
Sent: Wednesday, March 22, 2017 5:18 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Squid stopped working after cache.log and access.log rotation



Hi All

We recently installed Squid 3.5.12-1ubuntu7.3 on Ubuntu 16.04.2 LTS.  It ran fine at first but stopped working after a while.   telnet server 3128 still works, i.e., opens a blank window, but Squid is just not accepting requests.    Then we realized that there is no new access.log file.   The access.log file stopped rotated at 6:24AM on 3/17/2017.    It looks like Squid wasn't able to create a new access.log?  We could not find any error message in syslog or the cache.log.      We haven't rebooted the server because we want to know what went wrong.   It isn't the firewall blocking Squid because Squid was working fine all the while until recently.  Also after it stopped working, we disabled the firewall to see if it would work but it still didn't work.

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at paproxy</A>:/var/log/squid# ls -alt
total 15536
drwxr-xr-x 2 proxy proxy      4096 Mar 21 06:25 .
-rw-r----- 1 proxy proxy        63 Mar 21 06:25 cache.log
drwxrwxr-x 9 root  syslog     4096 Mar 21 06:25 ..
-rw-r----- 1 proxy proxy        63 Mar 20 06:25 cache.log.1
-rw-r----- 1 proxy proxy        83 Mar 19 06:25 cache.log.2.gz
-rw-r----- 1 proxy proxy  15759111 Mar 17 06:24 access.log.1
-rw-r----- 1 proxy proxy    117223 Mar 17 05:52 netdb.state

Any ideas what went wrong?

Thank you very much in anticipation.

Gui


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="014814.html">[squid-users] Squid stopped working after cache.log and	access.log rotation
</A></li>
	<LI>Next message (by thread): <A HREF="014816.html">[squid-users] Why do we have to set pinger_enable to off to get	Squid to work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14815">[ date ]</a>
              <a href="thread.html#14815">[ thread ]</a>
              <a href="subject.html#14815">[ subject ]</a>
              <a href="author.html#14815">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
