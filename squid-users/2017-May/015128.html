<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] URL sometimes reurns empty response
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20sometimes%20reurns%20empty%20response&In-Reply-To=%3C9a46cb5d-2a37-8835-30b2-391d03d5b24b%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015127.html">
   <LINK REL="Next"  HREF="015129.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] URL sometimes reurns empty response</H1>
    <B>Yuri Voinov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20URL%20sometimes%20reurns%20empty%20response&In-Reply-To=%3C9a46cb5d-2a37-8835-30b2-391d03d5b24b%40gmail.com%3E"
       TITLE="[squid-users] URL sometimes reurns empty response">yvoinov at gmail.com
       </A><BR>
    <I>Tue May  2 13:19:16 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015127.html">[squid-users] URL sometimes reurns empty response
</A></li>
        <LI>Next message (by thread): <A HREF="015129.html">[squid-users] URL sometimes reurns empty response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15128">[ date ]</a>
              <a href="thread.html#15128">[ thread ]</a>
              <a href="subject.html#15128">[ subject ]</a>
              <a href="author.html#15128">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmmmmm. See no issue from my side:

root @ khorne /patch # wget -S <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
--2017-05-02 19:16:11--  <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 200 OK
  Cache-Control: max-age=30,must-revalidate
  Content-Length: 14
  Content-Type: text/plain
  Last-Modified: Fri, 04 Mar 2016 06:55:23 GMT
  ETag: &quot;0x8D343F9F578A7F9&quot;
  Server: Microsoft-IIS/7.5
  x-ms-request-id: 45e06e80-0001-000b-6f15-be91d0000000
  x-ms-version: 2009-09-19
  x-ms-meta-CbModifiedTime: Tue, 01 Mar 2016 21:41:22 GMT
  x-ms-lease-status: unlocked
  x-ms-blob-type: BlockBlob
  X-ECN-P: RD0003FF838204
  Access-Control-Expose-Headers: X-MSEdge-Ref
  Access-Control-Allow-Origin: *
  Timing-Allow-Origin: *
  X-CID: 7
  X-CCC: SE
  X-MSEdge-Ref: Ref A: FFF0B969CF5F48DA856B48165D32542E Ref B:
STOEDGE0510 Ref C: Tue May  2 06:16:14 2017 PST
  X-MSEdge-Ref-OriginShield: Ref A: 9D033F6C12734D3A839C09F1BAFF798E Ref
B: AMS04EDGE0220 Ref C: Thu Apr 27 07:42:11 2017 PST
  Date: Tue, 02 May 2017 13:16:13 GMT
  X-Cache: MISS from khorne
  X-Cache-Lookup: MISS from khorne:3128
  Connection: keep-alive
Length: 14 [text/plain]
Saving to: 'ncsi.txt'

ncsi.txt            100%[===================&gt;]      14  --.-KB/s    in
0s     

2017-05-02 19:16:14 (2.07 MB/s) - 'ncsi.txt' saved [14/14]

root @ khorne /patch # wget -S <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
--2017-05-02 19:16:32--  <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 200 OK
  Cache-Control: max-age=30,must-revalidate
  Content-Length: 14
  Content-Type: text/plain
  Last-Modified: Fri, 04 Mar 2016 06:55:23 GMT
  ETag: &quot;0x8D343F9F578A7F9&quot;
  Server: Microsoft-IIS/7.5
  x-ms-request-id: 45e06e80-0001-000b-6f15-be91d0000000
  x-ms-version: 2009-09-19
  x-ms-meta-CbModifiedTime: Tue, 01 Mar 2016 21:41:22 GMT
  x-ms-lease-status: unlocked
  x-ms-blob-type: BlockBlob
  X-ECN-P: RD0003FF838204
  Access-Control-Expose-Headers: X-MSEdge-Ref
  Access-Control-Allow-Origin: *
  Timing-Allow-Origin: *
  X-CID: 7
  X-CCC: SE
  X-MSEdge-Ref: Ref A: FFF0B969CF5F48DA856B48165D32542E Ref B:
STOEDGE0510 Ref C: Tue May  2 06:16:14 2017 PST
  X-MSEdge-Ref-OriginShield: Ref A: 9D033F6C12734D3A839C09F1BAFF798E Ref
B: AMS04EDGE0220 Ref C: Thu Apr 27 07:42:11 2017 PST
  X-Origin-Date: Tue, 02 May 2017 13:16:13 GMT
  Date: Tue, 02 May 2017 13:16:32 GMT
  X-Cache-Age: 19
  X-Cache: HIT from khorne
  X-Cache-Lookup: HIT from khorne:3128
  Connection: keep-alive
Length: 14 [text/plain]
Saving to: 'ncsi.txt.1'

ncsi.txt.1          100%[===================&gt;]      14  --.-KB/s    in
0s     

2017-05-02 19:16:32 (1.90 MB/s) - 'ncsi.txt.1' saved [14/14]

root @ khorne /patch # wget -S <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
--2017-05-02 19:18:06--  <A HREF="http://www.msftconnecttest.com/ncsi.txt">http://www.msftconnecttest.com/ncsi.txt</A>
Connecting to 127.0.0.1:3128... connected.
Proxy request sent, awaiting response...
  HTTP/1.1 200 OK
  Content-Length: 14
  ETag: &quot;0x8D343F9F578A7F9&quot;
  Cache-Control: max-age=30,must-revalidate
  Content-Type: text/plain
  Last-Modified: Fri, 04 Mar 2016 06:55:23 GMT
  Server: Microsoft-IIS/7.5
  x-ms-request-id: 45e06e80-0001-000b-6f15-be91d0000000
  x-ms-version: 2009-09-19
  x-ms-meta-CbModifiedTime: Tue, 01 Mar 2016 21:41:22 GMT
  x-ms-lease-status: unlocked
  x-ms-blob-type: BlockBlob
  X-ECN-P: RD0003FF838204
  Access-Control-Expose-Headers: X-MSEdge-Ref
  Access-Control-Allow-Origin: *
  Timing-Allow-Origin: *
  X-CID: 7
  X-CCC: SE
  X-MSEdge-Ref: Ref A: 1F682D6F87124BF28456EB937B49B208 Ref B:
STOSCHEDGE0116 Ref C: Tue May  2 06:18:06 2017 PST
  X-MSEdge-Ref-OriginShield: Ref A: 9D033F6C12734D3A839C09F1BAFF798E Ref
B: AMS04EDGE0220 Ref C: Thu Apr 27 07:42:11 2017 PST
  Vary: Accept-Encoding
  X-Origin-Date: Tue, 02 May 2017 13:18:05 GMT
  Date: Tue, 02 May 2017 13:18:06 GMT
  X-Cache-Age: 1
  X-Cache: HIT from khorne
  X-Cache-Lookup: HIT from khorne:3128
  Connection: keep-alive
Length: 14 [text/plain]
Saving to: 'ncsi.txt.2'

ncsi.txt.2          100%[===================&gt;]      14  --.-KB/s    in
0s     

2017-05-02 19:18:06 (2.03 MB/s) - 'ncsi.txt.2' saved [14/14]

Seems correct. Will dig more.


02.05.2017 19:15, Ralf Hildebrandt &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> * Ralf Hildebrandt &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Ralf.Hildebrandt at charite.de</A>&gt;:
</I>&gt;<i>
</I>&gt;&gt;<i> It seems that squid is returning an incorrect Content-Lenght: header 
</I>&gt;&gt;<i> while the revalidation is still fresh/ongoing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I haven't yet tried tcpdumping the response to check if the 14 bytes
</I>&gt;&gt;<i> do indeed contain the correct string.
</I>&gt;<i> And voila - here we go (Content-Length: 0 but squid sends 14 bytes of excess data: &quot;Microsoft NCSI&quot;)
</I>&gt;<i>
</I>&gt;<i> 15:10:31.741436 IP proxy-cvk-1.charite.de.http-alt &gt; vsw-it-nw-10.54228: Flags [P.], seq 1:952, ack 156, win 235, options [nop,nop,TS val 126939588 ecr 1696144349], length 951: HTTP: HTTP/1.1 200 OK
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">E...cR at .</A>?....*...*......V?.....5....U......
</I>&gt;<i> ....e...HTTP/1.1 200 OK
</I>&gt;<i> Cache-Control: max-age=30,must-revalidate
</I>&gt;<i> Content-Length: 0
</I>&gt;<i> Content-Type: text/plain
</I>&gt;<i> Last-Modified: Fri, 04 Mar 2016 06:55:23 GMT
</I>&gt;<i> ETag: &quot;0x8D343F9F578A7F9&quot;
</I>&gt;<i> Server: Microsoft-IIS/7.5
</I>&gt;<i> x-ms-request-id: 6508a999-0001-0016-4fbc-c0483a000000
</I>&gt;<i> x-ms-version: 2009-09-19
</I>&gt;<i> x-ms-meta-CbModifiedTime: Tue, 01 Mar 2016 21:41:22 GMT
</I>&gt;<i> x-ms-lease-status: unlocked
</I>&gt;<i> x-ms-blob-type: BlockBlob
</I>&gt;<i> X-ECN-P: RD0003FF838204
</I>&gt;<i> Access-Control-Expose-Headers: X-MSEdge-Ref
</I>&gt;<i> Access-Control-Allow-Origin: *
</I>&gt;<i> Timing-Allow-Origin: *
</I>&gt;<i> X-CID: 7
</I>&gt;<i> X-CCC: US
</I>&gt;<i> X-MSEdge-Ref: Ref A: 2C6BD6F103A24795AE6784C3DC22E5F5 Ref B: BER30EDGE0115 Ref C: Tue May  2 06:10:31 2017 PST
</I>&gt;<i> X-MSEdge-Ref-OriginShield: Ref A: 5A9FC4FE82DC4E2DB26E51E59C50B50A Ref B: AMS04EDGE0506 Ref C: Sat Apr 29 05:30:12 2017 PST
</I>&gt;<i> Date: Tue, 02 May 2017 13:10:31 GMT
</I>&gt;<i> Age: 0
</I>&gt;<i> X-Cache: HIT from proxy-cvk-1
</I>&gt;<i> Via: 1.1 proxy-cvk-1 (squid/5.0.0-20170429-r15127)
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i>
</I>&gt;<i> Microsoft NCSI
</I>&gt;<i> 15:10:31.741454 IP vsw-it-nw-10.54228 &gt; proxy-cvk-1.charite.de.http-alt: Flags [.], ack 952, win 243, options [nop,nop,TS val 1696144352 ecr 126939588], length 0
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">E..4._ at .</A>@..=.*...*.........5V?.G.....O.....
</I>&gt;<i> e.......
</I>&gt;<i>
</I>
-- 
Bugs to the Future
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x613DEC46.asc
Type: application/pgp-keys
Size: 2437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170502/d450fe7a/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170502/d450fe7a/attachment.key</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170502/d450fe7a/attachment.sig">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170502/d450fe7a/attachment.sig</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015127.html">[squid-users] URL sometimes reurns empty response
</A></li>
	<LI>Next message (by thread): <A HREF="015129.html">[squid-users] URL sometimes reurns empty response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15128">[ date ]</a>
              <a href="thread.html#15128">[ thread ]</a>
              <a href="subject.html#15128">[ subject ]</a>
              <a href="author.html#15128">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
