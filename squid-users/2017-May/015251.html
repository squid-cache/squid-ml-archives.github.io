<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid tproxy net unreachable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20tproxy%20net%20unreachable&In-Reply-To=%3Ce196c3b6-cc54-ab9b-4506-071e07765c84%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015249.html">
   <LINK REL="Next"  HREF="015277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid tproxy net unreachable</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20tproxy%20net%20unreachable&In-Reply-To=%3Ce196c3b6-cc54-ab9b-4506-071e07765c84%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid tproxy net unreachable">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun May 14 12:16:23 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015249.html">[squid-users] Squid tproxy net unreachable
</A></li>
        <LI>Next message (by thread): <A HREF="015277.html">[squid-users] Squid tproxy net unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15251">[ date ]</a>
              <a href="thread.html#15251">[ thread ]</a>
              <a href="subject.html#15251">[ subject ]</a>
              <a href="author.html#15251">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/05/17 01:59, Abi Askushi wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have setup squid (v 3.1.20) with tproxy and relevant iptables and 
</I>&gt;<i> policy routes. It is functioning ok except one thing, squid is not 
</I>&gt;<i> able to redirect to deny page (located on same device) and it gives 
</I>&gt;<i> error &quot;101 network unreachable&quot;. I have squidguard in the setup as a 
</I>&gt;<i> helper program and squidguard is doing the redirection to a page on 
</I>&gt;<i> localhost. With squid in intercept mode this redirection to deny page 
</I>&gt;<i> is ok. I have also disabled rpfilter in kernel. I may provide more 
</I>&gt;<i> details on configs if needed.
</I>&gt;<i>
</I>&gt;<i> Did anyone encounter this? Any ideas?
</I>&gt;<i>
</I>
It is not possible to use a global IP address (eg the spoofed client IP) 
to connect to any machines lo (localhost) interface.

So Squid is not able to perform TPROXY spoofing to fetch the page your 
SG is *re-writing* (not redirecting) the URL to. If you actually are 
redirecting then the client cannot connect to the web server running in 
*its* localhost interface.


PS. please upgrade, no up to date OS releases I'm aware of still ship 
Squid-3.1.

Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015249.html">[squid-users] Squid tproxy net unreachable
</A></li>
	<LI>Next message (by thread): <A HREF="015277.html">[squid-users] Squid tproxy net unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15251">[ date ]</a>
              <a href="thread.html#15251">[ thread ]</a>
              <a href="subject.html#15251">[ subject ]</a>
              <a href="author.html#15251">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
