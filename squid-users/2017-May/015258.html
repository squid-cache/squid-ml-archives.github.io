<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Cannot access https site
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cannot%20access%20https%20site&In-Reply-To=%3Cb4b0357a-9a52-03b0-9332-5969ade0edf8%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015257.html">
   <LINK REL="Next"  HREF="015274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Cannot access https site</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cannot%20access%20https%20site&In-Reply-To=%3Cb4b0357a-9a52-03b0-9332-5969ade0edf8%40measurement-factory.com%3E"
       TITLE="[squid-users] Cannot access https site">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon May 15 17:25:12 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015257.html">[squid-users] Cannot access https site
</A></li>
        <LI>Next message (by thread): <A HREF="015274.html">[squid-users] Cannot access https site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15258">[ date ]</a>
              <a href="thread.html#15258">[ thread ]</a>
              <a href="subject.html#15258">[ subject ]</a>
              <a href="author.html#15258">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/15/2017 09:53 AM, Vieri wrote:

&gt;<i> My goal is to set up Squid so it can act as a transparent proxy for
</I>&gt;<i> local clients browsing the web. It should &quot;deny all&quot; except traffic
</I>&gt;<i> to the destination domains included in an ACL file.
</I>
&gt;<i> http_access deny intercepted !localnet
</I>&gt;<i> http_access deny interceptedssl !localnet
</I>&gt;<i> http_access deny !allowed_domains
</I>&gt;<i> http_access allow localnet
</I>...
&gt;<i> ssl_bump stare all
</I>&gt;<i> ssl_bump bump all
</I>

&gt;<i> What am I doing wrong?
</I>
You are denying fake CONNECT requests during SslBump step1. During that
step, intercepted SSL connections are represented by fake CONNECT
requests with IP addresses (not domain names). Such requests will often
match your &quot;http_access deny !allowed_domains&quot; rule. See &quot;Step 1&quot;
description at <A HREF="http://wiki.squid-cache.org/Features/SslPeekAndSplice">http://wiki.squid-cache.org/Features/SslPeekAndSplice</A>

What you probably want is to allow all reasonable fake CONNECT requests
during that step. There are several ways to do that, and I hope others
on the list can help you with that if you cannot figure it out. Please
do not forget to post your Squid version if you need further help (and
use the latest v3.5 or later if you are doing SslBump, regardless of
what your OS packages for you).

Some other configuration aspects are (or may be considered by some)
wrong as well, but it is best to fix one SslBump problem at a time IMHO.


&gt;<i> Also, would I have performance issues if the &quot;allowed.domains&quot; ACL
</I>&gt;<i> file becomes very big over time?
</I>
Naturally, the more domains you have, the slower ACL checks become. 1000
domains is not a problem, but 1000 million domains usually is. Define
&quot;very big&quot; and &quot;performance issues&quot;.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015257.html">[squid-users] Cannot access https site
</A></li>
	<LI>Next message (by thread): <A HREF="015274.html">[squid-users] Cannot access https site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15258">[ date ]</a>
              <a href="thread.html#15258">[ thread ]</a>
              <a href="subject.html#15258">[ subject ]</a>
              <a href="author.html#15258">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
