<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid custom error page
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20custom%20error%20page&In-Reply-To=%3C70010ca1-fa12-f781-d645-5004069a11ca%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015296.html">
   <LINK REL="Next"  HREF="015329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid custom error page</H1>
    <B>Dijxie</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20custom%20error%20page&In-Reply-To=%3C70010ca1-fa12-f781-d645-5004069a11ca%40gmail.com%3E"
       TITLE="[squid-users] Squid custom error page">dijxie at gmail.com
       </A><BR>
    <I>Wed May 17 14:25:03 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015296.html">[squid-users] Squid custom error page
</A></li>
        <LI>Next message (by thread): <A HREF="015329.html">[squid-users] Squid custom error page
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15294">[ date ]</a>
              <a href="thread.html#15294">[ thread ]</a>
              <a href="subject.html#15294">[ subject ]</a>
              <a href="author.html#15294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>W dniu 17.05.2017 o 13:32, chcs pisze:
&gt;<i> Firefox 53.0.2 , Chrome 58.3029 y Opera 44 display &quot;Proxy Server Refused
</I>&gt;<i> Connection&quot; page, instead of Squid custom error page, when connect to HTTPS
</I>&gt;<i> site which blocked by proxy server.
</I>&gt;<i> For example we try to connect to <A HREF="https://www.something.com">https://www.something.com</A> via Squid proxy
</I>&gt;<i> server which denied with 403 error this connect and send custom error page
</I>&gt;<i> with description of problem in older versions it's worked.
</I>&gt;<i> I'm using pfSense 2.4 (actual version squid 3.5.24).
</I>&gt;<i>
</I>&gt;<i> Reproducible: Always
</I>&gt;<i>
</I>&gt;<i> Steps to Reproduce:
</I>&gt;<i> 1. Configure Firefox to use proxy server (SSL Proxy).
</I>&gt;<i> 2. HTTPS/SSL Interception , Enable SSL filtering, splice all, CA: Let's
</I>&gt;<i> Encript autority
</I>&gt;<i> 3. Try to connect to HTTPS site, which will be blocked by proxy server
</I>&gt;<i>
</I>&gt;<i> Actual Results:
</I>&gt;<i> Firefox will display &quot;Page Load Error&quot; with description &quot;Proxy Server
</I>&gt;<i> Refused Connection. Firefox is configured to use a proxy server that is
</I>&gt;<i> refusing connections.&quot;
</I>&gt;<i> If we connect to HTTPS site which not blocked by proxy server OR using CA
</I>&gt;<i> self-signed issuer , all works fine.
</I>&gt;<i>
</I>&gt;<i> Expected Results:
</I>&gt;<i> Display proxy server error page with deny info.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-custom-error-page-tp4682433.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-custom-error-page-tp4682433.html</A>
</I>&gt;<i> Sent from the Squid - Users mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>
This is intentional Firefox behavior since long time ago:
<A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=493699">https://bugzilla.mozilla.org/show_bug.cgi?id=493699</A>

Even if this bug is outdated,  it is browser thing how to render error 
pages, not squid's fault.
You may try to redirect (instead of blocking) your blocked page to your 
custom page that looks exactly  like sqid's internal error page, but 
then You will see browser's SSL security warning, since page you have 
requested was SSL, and your error page is not - the same goes for 
internal error pages.
Proxies error pages are nowadays usually replaced by browsers due to 
security reasons in case of SSL pages.

If your custom-pretending-to-be-squid's-internal page would be SSL with 
valid cert, my guess is your problem is solved.

-- 
Greets, Dijx

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170517/6ed82198/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170517/6ed82198/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015296.html">[squid-users] Squid custom error page
</A></li>
	<LI>Next message (by thread): <A HREF="015329.html">[squid-users] Squid custom error page
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15294">[ date ]</a>
              <a href="thread.html#15294">[ thread ]</a>
              <a href="subject.html#15294">[ subject ]</a>
              <a href="author.html#15294">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
