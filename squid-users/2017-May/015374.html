<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] External ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20External%20ACL&In-Reply-To=%3C1495502728560-4682519.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015380.html">
   <LINK REL="Next"  HREF="015376.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] External ACL</H1>
    <B>avi_h</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20External%20ACL&In-Reply-To=%3C1495502728560-4682519.post%40n4.nabble.com%3E"
       TITLE="[squid-users] External ACL">harariboy at gmail.com
       </A><BR>
    <I>Tue May 23 01:25:28 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="015380.html">[squid-users] a bit off topic. New user question
</A></li>
        <LI>Next message (by thread): <A HREF="015376.html">[squid-users] External ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15374">[ date ]</a>
              <a href="thread.html#15374">[ thread ]</a>
              <a href="subject.html#15374">[ subject ]</a>
              <a href="author.html#15374">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm currently using the DB authentication (squid_db_auth).
This works flawlessly, however I have a need to enable authentication by a
list of IPs.
I tried using a simple ACL, but it's not dynamic so that doesn't answer my
need.
So I'm trying to create an external ACL.
For some reason the external ACL isn't working.
In order to check this, I commented out all the configs of squid_db_auth.
Please see the configurations below:

external_acl_type ip_checker children-max=20 %SRC
/usr/lib64/squid/ip_checker.sh
acl allowed_ips external ip_checker

http_access allow allowed_ips

cat /usr/lib64/squid/ip_checker.sh

#!/bin/bash

while read ip
do
  if ! grep -w &quot;$ip&quot; /etc/squid/allowed_ips.txt ; then
    echo &quot;ERR&quot;
  else echo &quot;OK&quot;
  fi
done

cat /etc/squid/allowed_ips.txt
192.168.1.1

The error message I'm getting:

2017/05/23 01:33:09.160 kid1| 82,2| external_acl.cc(786) aclMatchExternal:
ip_checker(&quot;192.168.1.1&quot;) = lookup needed
2017/05/23 01:33:09.160 kid1| WARNING: external ACL 'ip_checker' queue
overload. Request rejected '192.168.1.1'.

Thanks in advance,
Avi



--
View this message in context: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/External-ACL-tp4682519.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/External-ACL-tp4682519.html</A>
Sent from the Squid - Users mailing list archive at Nabble.com.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="015380.html">[squid-users] a bit off topic. New user question
</A></li>
	<LI>Next message (by thread): <A HREF="015376.html">[squid-users] External ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15374">[ date ]</a>
              <a href="thread.html#15374">[ thread ]</a>
              <a href="subject.html#15374">[ subject ]</a>
              <a href="author.html#15374">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
