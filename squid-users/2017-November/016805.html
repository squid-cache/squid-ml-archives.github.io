<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5 ICAP Problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5%20ICAP%20Problems&In-Reply-To=%3C3d7f5b00-c1f7-4277-e1b9-dfeac355c617%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016804.html">
   <LINK REL="Next"  HREF="016814.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5 ICAP Problems</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5%20ICAP%20Problems&In-Reply-To=%3C3d7f5b00-c1f7-4277-e1b9-dfeac355c617%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid 3.5 ICAP Problems">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Nov  2 17:21:33 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016804.html">[squid-users] Squid 3.5 ICAP Problems
</A></li>
        <LI>Next message (by thread): <A HREF="016814.html">[squid-users] Squid 3.5 ICAP Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16805">[ date ]</a>
              <a href="thread.html#16805">[ thread ]</a>
              <a href="subject.html#16805">[ subject ]</a>
              <a href="author.html#16805">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/02/2017 10:29 AM, Stephen Stark wrote:
&gt;<i> Adaptation::Icap::Xaction::noteCommConnected(local=[::]
</I>&gt;<i> remote=127.0.0.1:1344 flags=1, errno=101, ...
</I>
The logs you have provided do not show where/why exactly the TCP
connection to the ICAP service fails, but error number 101 is probably
&quot;network unreachable&quot;. This is unusual but not impossible for localhost
traffic. The next step depends on the failure cause. There are at least
two major cases to consider:

A) If Squid sends packets to 127.0.0.1:1344, then you can easily
reproduce the problem using something like &quot;telnet&quot; or &quot;nc&quot; on the Squid
box command line. Just make sure you use the right _source_ IP address
for the connection! It has to be the same source IP address that Squid
is using. It might not be 127.0.0.1. Running that command as Squid user
might also be important if the Squid box have some fancy user-specific
networking restrictions.

B) If Squid does not send packets to 127.0.0.1:1344, then one can figure
out what goes wrong by studying relevant ALL,9 logs. You may also want
to address other errors or warnings Squid logs to cache.log (if any).

You can determine whether Squid sends packets to 127.0.0.1:1344 by
collecting a packet trace (for all Squid box interfaces!) and/or running
strace (for the Squid worker process).


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016804.html">[squid-users] Squid 3.5 ICAP Problems
</A></li>
	<LI>Next message (by thread): <A HREF="016814.html">[squid-users] Squid 3.5 ICAP Problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16805">[ date ]</a>
              <a href="thread.html#16805">[ thread ]</a>
              <a href="subject.html#16805">[ subject ]</a>
              <a href="author.html#16805">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
