<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Slow speedtest results
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Slow%20speedtest%20results&In-Reply-To=%3C843f1b0c-0bcd-5b7d-4072-686be514ae3c%40pierce.co.za%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016940.html">
   <LINK REL="Next"  HREF="016942.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Slow speedtest results</H1>
    <B>Evan Pierce</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Slow%20speedtest%20results&In-Reply-To=%3C843f1b0c-0bcd-5b7d-4072-686be514ae3c%40pierce.co.za%3E"
       TITLE="[squid-users] Slow speedtest results">evan at pierce.co.za
       </A><BR>
    <I>Thu Nov 16 21:53:19 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016940.html">[squid-users] Slow speedtest results
</A></li>
        <LI>Next message (by thread): <A HREF="016942.html">[squid-users] Slow speedtest results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16941">[ date ]</a>
              <a href="thread.html#16941">[ thread ]</a>
              <a href="subject.html#16941">[ subject ]</a>
              <a href="author.html#16941">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2017/11/16 10:55 PM, Alex Rousskov wrote:
&gt;<i> On 11/16/2017 12:18 PM, Evan Pierce wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Any idea why when using www.speedtest.net on my squid proxy ( squid
</I>&gt;&gt;<i> 3.5.27 on Centos 6.9) gives consistently false/bad speeds while doing a
</I>&gt;&gt;<i> speed test. The actual speed when downloading a file from a actual web
</I>&gt;&gt;<i> server like say the microsoft website is consistently good (30Mb/s fiber
</I>&gt;&gt;<i> - download speed 3.4MB/s) but a speed test done at the same time sits at
</I>&gt;&gt;<i> around 3 to 4Mb/s. I have tried turning caching off and various other
</I>&gt;&gt;<i> &quot;tuning&quot; settings on squid but nothing has fundamentally altered the
</I>&gt;&gt;<i> speed. Running command line speedtest gives a correct speedtest from the
</I>&gt;&gt;<i> squid host. Test machine was machine running firefox and chrome with the
</I>&gt;&gt;<i> proxy statically configured and wasn't under any load. A similarly
</I>&gt;&gt;<i> configured squid on smaller hardware and the same service provider runs
</I>&gt;&gt;<i> consistently gives an accurate speedtest (same centos and squid
</I>&gt;&gt;<i> versions). Any one have any ideas?
</I>&gt;<i> I trust you have checked cache.log, system log, and network interface
</I>&gt;<i> statistics for warnings, errors, and red flags unique to the non-working
</I>&gt;<i> use case.
</I>Yes ... no obvious &quot;red flags&quot;
&gt;<i> Make sure that browser-proxy path is about the same in all tests you
</I>&gt;<i> compare. The problem might be related to browser-Squid communication.
</I>In both cases the test browser machines are physically cabled in to the 
same gigabit switch as the squid proxy/firewall machine

&gt;<i> Since you have a &quot;working&quot; case (on &quot;smaller hardware&quot;), I would try the
</I>&gt;<i> following using identical Squid versions:
</I>&gt;<i>
</I>&gt;<i> 1. Use the default Squid configuration with Squid memory caching
</I>&gt;<i> disabled on both boxes. Is one setup still a lot &quot;slower&quot; than the other?
</I>
Yes, however the &quot;bigger&quot; site has more vlans so it has slightly more 
https access lines and acls.
&gt;<i>
</I>&gt;<i> 2. Compare access.logs and mgr:info output of the two tests (one test
</I>&gt;<i> performed after a clean Squid start). Any unexpected differences?
</I>
Nothing jumps out at me.
&gt;<i>
</I>&gt;<i> 3. If you have not already, test a Squid configuration identical to that
</I>&gt;<i> &quot;working&quot; case (you can rename directories/hostnames if really needed,
</I>&gt;<i> of course, but do not change anything you do not have to change). Is one
</I>&gt;<i> setup still a lot &quot;slower&quot; than the other?
</I>Yes one is slower.
&gt;<i> 4. Comparing cache.logs of virtually identically configured Squids with
</I>&gt;<i> debug_options set to ALL,3 or higher may expose the critical difference.
</I>&gt;<i> Debugging will slow Squid down a lot, of course, but perhaps you will
</I>&gt;<i> see that one of the Squids is doing something that the other one does
</I>&gt;<i> not do.
</I>&gt;<i>
</I>I can't see anything but both are in production and being used while I 
was testing so generated a lot of data

&gt;<i> HTH,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016940.html">[squid-users] Slow speedtest results
</A></li>
	<LI>Next message (by thread): <A HREF="016942.html">[squid-users] Slow speedtest results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16941">[ date ]</a>
              <a href="thread.html#16941">[ thread ]</a>
              <a href="subject.html#16941">[ subject ]</a>
              <a href="author.html#16941">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
