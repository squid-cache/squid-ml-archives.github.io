<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Deny ports to users
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Deny%20ports%20to%20users&In-Reply-To=%3C72c307d0-8910-ac1d-acfd-3d84cde04ad6%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016938.html">
   <LINK REL="Next"  HREF="016943.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Deny ports to users</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Deny%20ports%20to%20users&In-Reply-To=%3C72c307d0-8910-ac1d-acfd-3d84cde04ad6%40treenet.co.nz%3E"
       TITLE="[squid-users] Deny ports to users">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Nov 17 03:29:44 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016938.html">[squid-users] Deny ports to users
</A></li>
        <LI>Next message (by thread): <A HREF="016943.html">[squid-users] CONNECT + custom data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16949">[ date ]</a>
              <a href="thread.html#16949">[ thread ]</a>
              <a href="subject.html#16949">[ subject ]</a>
              <a href="author.html#16949">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 17/11/17 08:42, Yuri wrote:
&gt;<i> You choose not appropriate tool for you task.
</I>&gt;<i> 
</I>&gt;<i> Squid is a proxy, not a firewall.
</I>&gt;<i> 
</I>
Indeed.


&gt;<i> 
</I>&gt;<i> 17.11.2017 1:40, Jonathan thomas Cho &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> Hello, I was curious how to restrict users from accessing ports .
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have 4 workers and need them to have their own ports and not able to 
</I>&gt;&gt;<i> use the other 3.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I currently use :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> http_port 3128 name=ip2
</I>&gt;&gt;<i> http_port 3129 name=ip3
</I>&gt;&gt;<i> http_port 3130 name=ip4
</I>
The above are directives for the *listening* ports receiving 
client&lt;-&gt;Squid connections.

You have here configured this Squid *process* (all workers of it) to use 
port 3128 on all IP addresses the machine has been assigned. Same for 
port 3129 and 3130.

Squid cannot control which port a client decides to connect to. It can 
only listen (or not).

I assume you mean you want each worker to use different listening ports. 
That can be done by using the ${process_number} config macro in the port 
number itself eg. http_port 313${Process_number}.
  However, be aware that will lead to issues with the coordinator 
process not being able to manage SMP port functionality and worker 
automatic restart after crashes will have issues since the process 
number changes there too. And you thus cannot reliably use the port 
name/number for other things like you seem to be wanting.


&gt;&gt;<i> &gt;&gt; acl ip2 myip x.x.x.2
</I>&gt;&gt;<i> acl ip3 myip x.x.x.3
</I>&gt;&gt;<i> acl ip4 myip x.x.x.4
</I>
&quot;myip&quot; is deprecated, it does not work at all well. Use &quot;myportname&quot; 
instead.

Your Squid should complain about this when you run '-k parse' to check 
your config validity. If your Squid does not support that new ACL type 
you definitely need to upgrade.


&gt;&gt;<i> tcp_outgoing_address x.x.x.2 ip2
</I>&gt;&gt;<i> tcp_outgoing_address x.x.x.3 ip3
</I>&gt;&gt;<i> tcp_outgoing_address x.x.x.4 ip4
</I>&gt;&gt;<i>
</I>
These are for Squid&lt;-&gt;server connections. Has nothing to do with 
client&lt;-&gt;Squid connections.

The OS selects which ports are use here. Not Squid.


&gt;&gt;<i> However 3129 still work on all 4 ports.
</I>&gt;&gt;<i>
</I>
3129 is a port number. Singular. It does not *listen* on other values.

The traffic arriving on connections *to* there is independent of the 
outgoing connection port numbers - which are not controllable as 
mentioned above. So it is not clear what you are trying to say by that.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016938.html">[squid-users] Deny ports to users
</A></li>
	<LI>Next message (by thread): <A HREF="016943.html">[squid-users] CONNECT + custom data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16949">[ date ]</a>
              <a href="thread.html#16949">[ thread ]</a>
              <a href="subject.html#16949">[ subject ]</a>
              <a href="author.html#16949">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
