<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] forward proxy to reverse proxy to app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20forward%20proxy%20to%20reverse%20proxy%20to%20app&In-Reply-To=%3C68bada7c-aebd-66cb-d6d8-1c480f508550%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016952.html">
   <LINK REL="Next"  HREF="016956.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] forward proxy to reverse proxy to app</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20forward%20proxy%20to%20reverse%20proxy%20to%20app&In-Reply-To=%3C68bada7c-aebd-66cb-d6d8-1c480f508550%40treenet.co.nz%3E"
       TITLE="[squid-users] forward proxy to reverse proxy to app">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Nov 17 09:58:10 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016952.html">[squid-users] forward proxy to reverse proxy to app
</A></li>
        <LI>Next message (by thread): <A HREF="016956.html">[squid-users] https://wiki.squid-cache.org provides invalid	certificate chain ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16955">[ date ]</a>
              <a href="thread.html#16955">[ thread ]</a>
              <a href="subject.html#16955">[ subject ]</a>
              <a href="author.html#16955">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 17/11/17 20:33, Bernhard D&#252;bi wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I try to configure squid for a very special usecase but can't get it
</I>&gt;<i> to work. So, if you could give me some hints on how to do it right,
</I>&gt;<i> that would be great
</I>&gt;<i> 
</I>&gt;<i> Here's what I try to achieve:
</I>&gt;<i> 
</I>&gt;<i> the browser has proxy:8080 configured as manual proxy
</I>&gt;<i> from the browser I access some websites
</I>&gt;<i> when the request is plain http then the reply must be a redirect to https
</I>&gt;<i> when the request is https then the ssl connection must be termintaed
</I>&gt;<i> on the proxy and the request must be forwarded as http to the
</I>&gt;<i> application server
</I>

A forward/explicit proxy like yours is required to ensure that the 
security level of traffic remains unchanged across both client and 
server connections. Never downgraded without explicit knowledge by both 
endpoints. Bad problems ensue if you downgrade with either endpoint 
thinking it is secure end-to-end.


&gt;<i> 
</I>&gt;<i> I know, I could just forget about ssl an go directly the app server
</I>&gt;<i> with http bt the customer insists on that particular setup
</I>&gt;<i> 
</I>&gt;<i> we use several domains like app1.doma.com, app2.domb.biz, app3.domc.org
</I>&gt;<i> in order to return the correct certificate for each request, I need a
</I>&gt;<i> dedicated ip:port combination for each certificate
</I>
That is only relevant for *reverse-proxy*, not a forward/explicit proxy 
like yours.

If you have a explicit TLS connection between the clients and Squid 
forward/explicit you only need a certificate confirming Squid's hostname 
to the client.

If you are using SSL-Bump to decrypt the HTTPS traffic Squid can 
auto-generate certificates on the client connection based on the 
upstream server cert details.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016952.html">[squid-users] forward proxy to reverse proxy to app
</A></li>
	<LI>Next message (by thread): <A HREF="016956.html">[squid-users] https://wiki.squid-cache.org provides invalid	certificate chain ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16955">[ date ]</a>
              <a href="thread.html#16955">[ thread ]</a>
              <a href="subject.html#16955">[ subject ]</a>
              <a href="author.html#16955">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
