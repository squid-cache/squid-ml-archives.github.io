<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SQUID memory error after vm.swappines changed from 60 to 10
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SQUID%20memory%20error%20after%20vm.swappines%20changed%0A%20from%2060%20to%2010&In-Reply-To=%3CCAAPixKjVmPO53HvCkfXVFLbueiytUpU4%3D-jYv_c%2Bto%2B%2BTdB0bg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016947.html">
   <LINK REL="Next"  HREF="016847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SQUID memory error after vm.swappines changed from 60 to 10</H1>
    <B>Bike dernikov1</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SQUID%20memory%20error%20after%20vm.swappines%20changed%0A%20from%2060%20to%2010&In-Reply-To=%3CCAAPixKjVmPO53HvCkfXVFLbueiytUpU4%3D-jYv_c%2Bto%2B%2BTdB0bg%40mail.gmail.com%3E"
       TITLE="[squid-users] SQUID memory error after vm.swappines changed from 60 to 10">dernikov1 at gmail.com
       </A><BR>
    <I>Fri Nov 17 19:03:55 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016947.html">[squid-users] SQUID memory error after vm.swappines changed from 60 to 10
</A></li>
        <LI>Next message (by thread): <A HREF="016847.html">[squid-users] squid and squidGuard redirect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16967">[ date ]</a>
              <a href="thread.html#16967">[ thread ]</a>
              <a href="subject.html#16967">[ subject ]</a>
              <a href="author.html#16967">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Nov 17, 2017 at 3:53 AM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i> On 17/11/17 03:49, Bike dernikov1 wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Thu, Nov 16, 2017 at 8:58 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 16/11/17 01:32, Bike dernikov1 wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If i can ask under same title:
</I>&gt;&gt;&gt;&gt;<i> Yesterday we had error in logs: syslog, cache.log, dmesg,access.log
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> segfault at 8 ip ....... sp ..... error 4 is squid
</I>&gt;&gt;&gt;&gt;<i> process pid exited due to signal 11 with status 0
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Squid restarted,  that was at the end of work, and i didn't  notice
</I>&gt;&gt;&gt;&gt;<i> change while surfing.
</I>&gt;&gt;&gt;&gt;<i> I noticed change in used memory, after i went trough logs, and found
</I>&gt;&gt;&gt;&gt;<i> segfault.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Can you point me, how to analyze what happened.
</I>&gt;&gt;&gt;&gt;<i> Can that be problem with kernel ?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> How to retrieve info about these type of things is detailed at
</I>&gt;&gt;&gt;<i> &lt;<A HREF="https://wiki.squid-cache.org/SquidFaq/BugReporting">https://wiki.squid-cache.org/SquidFaq/BugReporting</A>&gt;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I wasn't sure it is bug, so i didn't want to post it that is a  bug.
</I>&gt;&gt;<i> As you now confirm that it can be bug i will prepare for retriving
</I>&gt;&gt;<i> infos.
</I>&gt;&gt;<i> I just hope that bug won't  happen at high  load in middle of working day.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The how-to are just on that page because if you are reporting that kind of
</I>&gt;<i> bug those details are mandatory. You dont have to be reporting a bug to use
</I>&gt;<i> the techniques.
</I>&gt;<i>
</I>&gt;<i> That said, segfault is almost always a bug. Though it could be a bug in the
</I>&gt;<i> system environment or hardware rather than Squid. The details you get from
</I>&gt;<i> looking at the traces should indicate whether those are actual or not.
</I>
In the begining, we had many crashes, and we thought that we have hardware bug.
We had two different servers, Fujitsu RX600 and X3550M3.  We was
testing Squid  on Centos and Debian.
Debian won because of new squidguard version on  which work
authorization with ldap.
First upgrade to Debian 9 (stable) crashed installation on Fujitsu. It
couldn't boot with new kernel.
Same Debian worked on IBM X3550M3. So it was a nightmare for testing.
We returned to stable kernel, and problems disappeared until now.
Although only one segfault so far in 3 days.

&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> NP: If you do not have core files enabled, then the data from that
</I>&gt;&gt;&gt;<i> segfault
</I>&gt;&gt;&gt;<i> is probably gone irretrievably. You may need to use the script to capture
</I>&gt;&gt;&gt;<i> segfault details from a running proxy (the 'minimal downtime' section).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am sure that i didn't enabled it.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Okay, then you will need to for further diagnosis.
</I>
&gt;<i>From  Monday we will start with reconfiguration. Each day new problem.
</I>Migration slowed to stop :(

Today we had different problem (with exhausted inodes). Logs exploded,
with no space on disk errors (disk on 60% free)
Luckily, we found   what  was problem (sarg and scripted  generated
reports) under 5 minutes.
We lost half  day for rewriting scripts. I hope that we solve that
problem  for good :).

&gt;<i> Amos
</I>
We couldn't done it without you help.
Thanks a lot.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016947.html">[squid-users] SQUID memory error after vm.swappines changed from 60 to 10
</A></li>
	<LI>Next message (by thread): <A HREF="016847.html">[squid-users] squid and squidGuard redirect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16967">[ date ]</a>
              <a href="thread.html#16967">[ thread ]</a>
              <a href="subject.html#16967">[ subject ]</a>
              <a href="author.html#16967">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
