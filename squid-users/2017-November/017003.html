<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] block user agent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20block%20user%20agent&In-Reply-To=%3Cc56942ab-fe7d-782b-930c-0a969151d92f%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017001.html">
   <LINK REL="Next"  HREF="016962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] block user agent</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20block%20user%20agent&In-Reply-To=%3Cc56942ab-fe7d-782b-930c-0a969151d92f%40treenet.co.nz%3E"
       TITLE="[squid-users] block user agent">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Nov 22 12:41:30 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017001.html">[squid-users] block user agent
</A></li>
        <LI>Next message (by thread): <A HREF="016962.html">[squid-users] block user agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17003">[ date ]</a>
              <a href="thread.html#17003">[ thread ]</a>
              <a href="subject.html#17003">[ subject ]</a>
              <a href="author.html#17003">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/11/17 23:48, Vieri wrote:
&gt;<i> ________________________________
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you place that after the default &quot;deny CONNECT !SSL_ports&quot;, and
</I>&gt;&gt;<i> before your UA checks, AND if you are using ssl_bump on the allowed
</I>&gt;&gt;<i> tunnels then you can relatively safely use &quot;allow CONNECT&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Just be careful that the CONNECT allowed by that are always handled
</I>&gt;&gt;<i> safely by the ssl_bump rules you have.
</I>&gt;&gt;<i>    Meaning that you either bump or terminate traffic you are not sure is
</I>&gt;&gt;<i> okay, splice if you are reasonably sure, etc. it is a balancing effort
</I>&gt;&gt;<i> between &quot;splice as much as possible&quot; and &quot;terminate if unsure of the
</I>&gt;&gt;<i> traffic&quot; advice.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> As you say, I placed &quot;allow CONNECT&quot; after the default &quot;deny CONNECT !SSL_ports&quot;, and before my UA checks. I'm also using:
</I>&gt;<i> ssl_bump stare all
</I>&gt;<i> ssl_bump bump all
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Considering the following (taken from previous e-mail):
</I>&gt;<i> 
</I>&gt;<i> http_access deny intercepted !localnet
</I>&gt;<i> http_access deny interceptedssl !localnet
</I>&gt;<i> http_access deny explicit !ORG_all
</I>&gt;<i> http_access deny explicit SSL_ports
</I>&gt;<i> 
</I>&gt;<i> Would it be &quot;safer&quot; or &quot;indifferent&quot; to use the following right before the UA checks?
</I>&gt;<i> 
</I>&gt;<i> http_access allow CONNECT interceptedssl SSL_ports
</I>&gt;<i> 
</I>
All CONNECT transactions that get past that earlier line with !SSL_Ports 
will match SSL_Ports. So that part of the line is redundant.

The &quot;CONNECT interceptedssl&quot; is more restricted than just &quot;CONNECT&quot; - so 
is safer due to that yes. But also leaves some traffic open to the same 
denial problem you had earlier if non-UA CONNECT happen other ways. Up 
to you whether that is wanted or acceptible.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017001.html">[squid-users] block user agent
</A></li>
	<LI>Next message (by thread): <A HREF="016962.html">[squid-users] block user agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17003">[ date ]</a>
              <a href="thread.html#17003">[ thread ]</a>
              <a href="subject.html#17003">[ subject ]</a>
              <a href="author.html#17003">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
