<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] IP_FREEBIND or IP_TRANSPARENT support?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IP_FREEBIND%20or%20IP_TRANSPARENT%20support%3F&In-Reply-To=%3C03429e1a-958d-bcd8-1aad-eee01e7d99d9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016542.html">
   <LINK REL="Next"  HREF="016547.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] IP_FREEBIND or IP_TRANSPARENT support?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IP_FREEBIND%20or%20IP_TRANSPARENT%20support%3F&In-Reply-To=%3C03429e1a-958d-bcd8-1aad-eee01e7d99d9%40treenet.co.nz%3E"
       TITLE="[squid-users] IP_FREEBIND or IP_TRANSPARENT support?">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Oct  3 02:18:43 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016542.html">[squid-users] IP_FREEBIND or IP_TRANSPARENT support?
</A></li>
        <LI>Next message (by thread): <A HREF="016547.html">[squid-users] IP_FREEBIND or IP_TRANSPARENT support?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16546">[ date ]</a>
              <a href="thread.html#16546">[ thread ]</a>
              <a href="subject.html#16546">[ subject ]</a>
              <a href="author.html#16546">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/10/17 07:44, xpro6000 wrote:
&gt;<i> If one were to assign a whole /64 block of IPv6 IPs to a NIC on Linux 
</I>&gt;<i> then they would use the &quot;ip route add local&quot; method instead of adding 
</I>&gt;<i> each IP in the /etc/network/interfaces file.
</I>&gt;<i> 
</I>&gt;<i>  From the testing I have done the IPs that were assigned with the &quot;ip 
</I>&gt;<i> route add local&quot; don't work with Squid and the main reason for this is 
</I>&gt;<i> because Squid does not use IP_FREEBIND or IP_TRANSPARENT option on the 
</I>&gt;<i> socket connection.
</I>

Any machine can be setup to *route* traffic (ip route add ...). That is 
a very different proposition to assigning those IPs as belonging to that 
machine (ip addr add ...).

IP_TRANSPARENT is the spoofing part of the TPROXYv4 feature and is used 
by Squid when TPROXY is setup.


&gt;<i> 
</I>&gt;<i> You can read more about it here
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://serverfault.com/a/591435/141509">https://serverfault.com/a/591435/141509</A>
</I>&gt;<i> 
</I>
That whole SF entry is all kinds of mixed up. It is basically saying 
that to &quot;assign a whole range&quot; one has to *spoof* the IPs in that range. 
Which is a very wrong thing to do.

The list of 'ip addr add' settings in the original interfaces file is 
correct for what the person was wanting (and you?), though I'm not sure 
if there is another place to do them. I do the same but in a trigger 
script called from the interfaces file instead of listing them all in 
that file directly.

&gt;<i> 
</I>&gt;<i> Is there any option in the config file that enables this option?
</I>&gt;<i> 
</I>
Not for Squid.

Squid prefers the OS to select the IP which is used, though for a small 
number of IPs you can use tcp_outgoing_addr to tell the OS that any 
specific one of the set *assigned* to the machine should be used on 
server connections.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016542.html">[squid-users] IP_FREEBIND or IP_TRANSPARENT support?
</A></li>
	<LI>Next message (by thread): <A HREF="016547.html">[squid-users] IP_FREEBIND or IP_TRANSPARENT support?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16546">[ date ]</a>
              <a href="thread.html#16546">[ thread ]</a>
              <a href="subject.html#16546">[ subject ]</a>
              <a href="author.html#16546">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
