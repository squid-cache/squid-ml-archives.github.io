<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] New Squid 3.5 reconfigure causes service down
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20New%20Squid%203.5%20reconfigure%20causes%20service%20down&In-Reply-To=%3Cca4ee786-2297-0804-19a4-56ff4ba4afc9%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016575.html">
   <LINK REL="Next"  HREF="016579.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] New Squid 3.5 reconfigure causes service down</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20New%20Squid%203.5%20reconfigure%20causes%20service%20down&In-Reply-To=%3Cca4ee786-2297-0804-19a4-56ff4ba4afc9%40measurement-factory.com%3E"
       TITLE="[squid-users] New Squid 3.5 reconfigure causes service down">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct  5 16:25:53 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016575.html">[squid-users] New Squid 3.5 reconfigure causes service down
</A></li>
        <LI>Next message (by thread): <A HREF="016579.html">[squid-users] New Squid 3.5 reconfigure causes service down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16578">[ date ]</a>
              <a href="thread.html#16578">[ thread ]</a>
              <a href="subject.html#16578">[ subject ]</a>
              <a href="author.html#16578">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/05/2017 03:20 AM, Nicola Ferrari (#554252) wrote:

&gt;<i> issuing the &quot;squid -k reconfigure&quot; command (i.e. to
</I>&gt;<i> adjust acls in conf file) the result is not just a configuration reload,
</I>&gt;<i> but authenticators processes are restarting,
</I>
As you have discovered already, running heavy unnecessary actions is a
known problem with Squid hot reconfiguration support. An upgrade may
have an effect on certain aspects of that problem, but the problem
itself is as old as Squid.


&gt;<i> causing an &quot;out-of-service&quot; for all users, for a courple of minutes.
</I>
The &quot;couple of minutes&quot; part might be related to your upgrade and, if
so, you may be able to avoid such delays. For list readers not familiar
with Debian releases, which _Squid_ version are you upgrading from?


&gt;<i> Basically the same issue as in this thread:
</I>&gt;<i> <A HREF="https://serverfault.com/questions/247835/squid-3-reloading-makes-it-stop-serving-requests">https://serverfault.com/questions/247835/squid-3-reloading-makes-it-stop-serving-requests</A>
</I>
The symptoms are the same but the underlying cause may be different
(unless you have already checked but did not tell us).


&gt;<i> I'm in doubt if reducing helpers number would be a good idea, since we
</I>&gt;<i> need to serve ca. 300 simultaneous users.
</I>&gt;<i> 
</I>&gt;<i> Before the recent upgrade, with the previous Debian8, reload took some
</I>&gt;<i> seconds only..
</I>&gt;<i> 
</I>&gt;<i> Is there any best-practice to get an &quot;Hot-Configurable&quot; system?
</I>&gt;<i> Do you have any suggestion?
</I>

I suggest to start by figuring our what Squid is doing during those
&quot;couple of minutes&quot; if you have not already. The mailing list thread
linked from the above serverfault answer shows how to do that and has
several potentially useful comments. Compare the new logs with those of
your older Squid. What has changed related to the startup delays?


FWIW, there is now a low-priority project to support fast ACL-only
reconfiguration. We have the initial high-level design and some code,
but it will take a while (possibly a year or more) to complete at its
current priority.

<A HREF="http://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F">http://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F</A>


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016575.html">[squid-users] New Squid 3.5 reconfigure causes service down
</A></li>
	<LI>Next message (by thread): <A HREF="016579.html">[squid-users] New Squid 3.5 reconfigure causes service down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16578">[ date ]</a>
              <a href="thread.html#16578">[ thread ]</a>
              <a href="subject.html#16578">[ subject ]</a>
              <a href="author.html#16578">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
