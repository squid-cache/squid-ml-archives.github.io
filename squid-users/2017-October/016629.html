<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid not failing over to secondary DNS host
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20not%20failing%20over%20to%20secondary%20DNS%20host&In-Reply-To=%3CCAEq3_tdW_PmsAh2jT_ORLPKMx%2BsqKa86qHGo19egzoXn_HL3xw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016635.html">
   <LINK REL="Next"  HREF="016630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid not failing over to secondary DNS host</H1>
    <B>Geoffrey</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20not%20failing%20over%20to%20secondary%20DNS%20host&In-Reply-To=%3CCAEq3_tdW_PmsAh2jT_ORLPKMx%2BsqKa86qHGo19egzoXn_HL3xw%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid not failing over to secondary DNS host">geoffmaha at gmail.com
       </A><BR>
    <I>Thu Oct 12 02:04:44 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016635.html">[squid-users] Question about refresh_pattern and access time...
</A></li>
        <LI>Next message (by thread): <A HREF="016630.html">[squid-users] Squid not failing over to secondary DNS host
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16629">[ date ]</a>
              <a href="thread.html#16629">[ thread ]</a>
              <a href="subject.html#16629">[ subject ]</a>
              <a href="author.html#16629">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello folks,

I am finding that Squid will not use the secondary DNS if the first
one is taken offline. In this case the primary DNS is not able to
respond because I have taken it offline, and therefore the secondary
DNS should be queried by squid, but is not.

I have 2 Windows recursive DNS servers; 192.168.100.249 and
192.168.100.248, that are statically specified in /etc/resolv.conf. I
am authenticating against AD using i) Kerberos and ii) NTLM.

This looks like it is a Squid internal dns client response rather than
operating system. While 192.168.100.249 is offline, all other queries
done by command-line queries work OK which indicates the system is
using the secondary DNS server fine&#8230; just not Squid!

What we want to happen of course is that if the primary
(192.168.100.249) is down or it cannot contact root DNS servers, then
it contacts the secondary nameserver specified on the LAN (as per the
configuration in resolv.conf) and resolves the name.

*Squid is SUCCESSFULLY reading resolv.conf as proved in cache.log after reload
*Setting dns resolvers directly in the squid config file with
'dns_nameservers' does not resolve the issue as the symptom is
identical
*modified squid dns timeouts to a low value (less than 10 secs) for
testing but made no difference

Many thanks for any ideas you may have.

Kind regards,
Geoff

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016635.html">[squid-users] Question about refresh_pattern and access time...
</A></li>
	<LI>Next message (by thread): <A HREF="016630.html">[squid-users] Squid not failing over to secondary DNS host
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16629">[ date ]</a>
              <a href="thread.html#16629">[ thread ]</a>
              <a href="subject.html#16629">[ subject ]</a>
              <a href="author.html#16629">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
