<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid cpu usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20cpu%20usage&In-Reply-To=%3Cefb11c97-0368-a8ff-c1be-9781ac450026%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016719.html">
   <LINK REL="Next"  HREF="016724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid cpu usage</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20cpu%20usage&In-Reply-To=%3Cefb11c97-0368-a8ff-c1be-9781ac450026%40measurement-factory.com%3E"
       TITLE="[squid-users] squid cpu usage">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Oct 24 16:07:45 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016719.html">[squid-users] squid cpu usage
</A></li>
        <LI>Next message (by thread): <A HREF="016724.html">[squid-users] squid cpu usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16720">[ date ]</a>
              <a href="thread.html#16720">[ thread ]</a>
              <a href="subject.html#16720">[ subject ]</a>
              <a href="author.html#16720">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/24/2017 06:34 AM, Vieri wrote:

&gt;<i> Next time I get a 100% squid process that brings my proxy to a crawl
</I>&gt;<i> HTTP-wise, what can I try in order to get more info, and possibly see
</I>&gt;<i> the cause of this?
</I>
Here are two additional tricks to consider:

* If 100% CPU usage lasts for more than a few seconds, then attaching
gdb to the running Squid worker and generating a few backtraces (a few
seconds apart) may identify the code that got stuck. Make sure you give
gdb a non-stripped Squid binary when doing that. Squid wiki should have
more instructions about the whole process.

Please note that the above is less likely to help if your Squid
continues to respond to new requests while you see ~100% CPU usage. You
may increase your chances by blocking new traffic from reaching the
problematic Squid (e.g., by redirecting all traffic to other Squid(s)
that you have in load balancing or hot standby mode OR allowing all
traffic to bypass Squid). If you cannot easily remove a problematic
Squid from user traffic path, then use this problem as an excuse to fix
your deployment architecture so that you can :-).

* Another potentially useful trick is to log mgr:events every minute or
so. Perhaps 100% CPU usage is associated with a particular regularly
scheduled event?

Please note that some modern Squids abuse the events API for frequently
occurring notifications. If you see hundreds or more events in your log,
this trick may be too expensive/intrusive for your environment.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016719.html">[squid-users] squid cpu usage
</A></li>
	<LI>Next message (by thread): <A HREF="016724.html">[squid-users] squid cpu usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16720">[ date ]</a>
              <a href="thread.html#16720">[ thread ]</a>
              <a href="subject.html#16720">[ subject ]</a>
              <a href="author.html#16720">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
