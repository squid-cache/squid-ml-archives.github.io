<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid regex grammar
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20regex%20grammar&In-Reply-To=%3Ccc464e5b-71ab-cdd7-01b0-8a1a25e07e4c%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016740.html">
   <LINK REL="Next"  HREF="016743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid regex grammar</H1>
    <B>Yuri</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20regex%20grammar&In-Reply-To=%3Ccc464e5b-71ab-cdd7-01b0-8a1a25e07e4c%40gmail.com%3E"
       TITLE="[squid-users] Squid regex grammar">yvoinov at gmail.com
       </A><BR>
    <I>Fri Oct 27 15:43:09 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016740.html">[squid-users] Squid regex grammar
</A></li>
        <LI>Next message (by thread): <A HREF="016743.html">[squid-users] Squid regex grammar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16741">[ date ]</a>
              <a href="thread.html#16741">[ thread ]</a>
              <a href="subject.html#16741">[ subject ]</a>
              <a href="author.html#16741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

27.10.2017 21:33, Antony Stone &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> On Friday 27 October 2017 at 17:26:18, Yuri wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> 27.10.2017 21:17, Antony Stone &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;<i> On Friday 27 October 2017 at 17:06:01, Yuri wrote:
</I>&gt;&gt;&gt;&gt;<i> 27.10.2017 20:55, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;&gt;&gt;<i> When a regular expression is using extended features, the basic regular
</I>&gt;&gt;&gt;&gt;&gt;<i> expression compiler often (or even always?!) does not fail because it
</I>&gt;&gt;&gt;&gt;&gt;<i> views the extended features as ordinary plain characters. Thus, Squid
</I>&gt;&gt;&gt;&gt;&gt;<i> cannot tell that something went wrong.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> $ echo &quot;foobar&quot; | grep --basic-regexp    'foo|bar'
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> $ echo &quot;foobar&quot; | grep --extended-regexp 'foo|bar'
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> foobar
</I>&gt;&gt;&gt;&gt;&gt;<i> As you can see, the basic compiler is silent about the &quot;|&quot; character
</I>&gt;&gt;&gt;&gt;&gt;<i> that it does not support. Here is a similar example where a malformed
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> extended regular expression is silently accepted by the basic compiler:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> $ echo &quot;foobar&quot; | grep --basic-regexp 'foo(bar'
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> $ echo &quot;foobar&quot; | grep --extended-regexp 'foo(bar'
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> grep: Unmatched ( or \(
</I>&gt;&gt;&gt;&gt;<i> I would like either a clear documentation
</I>&gt;&gt;&gt;<i> That sounds entirely reasonable - a statement something like &quot;Squid is
</I>&gt;&gt;&gt;<i> guaranteed to use basic POSIX grammar, but extended grammar may be
</I>&gt;&gt;&gt;<i> available on different systems; the sysadmin should check&quot;?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> or some tool for checking whether the regular expression is correct from
</I>&gt;&gt;&gt;&gt;<i> the point of view of the current library used by Squid or not.
</I>&gt;&gt;&gt;<i> What does &quot;correct&quot; mean?
</I>&gt;&gt;<i> &quot;correct&quot; mean &quot;this will correctly works in Squid, not silently
</I>&gt;&gt;<i> ignored&quot;. This is simple and obvious, isn't it?
</I>&gt;<i> No.
</I>&gt;<i>
</I>&gt;<i> Suppose I write a | character (as per Alex's first example above) in my regex.
</I>&gt;<i>
</I>&gt;<i> Basic POSIX will match that literally.
</I>&gt;<i>
</I>&gt;<i> Extended grep will not.
</I>&gt;<i>
</I>&gt;<i> Judging purely from what is written in my regex, did I mean the character to 
</I>&gt;<i> be matched literally, or not?
</I>&gt;<i>
</I>&gt;<i> Squid cannot tell.
</I>Yes. You now understanding root case. If we're say - &quot;Squid uses POSIX
Basic until _admin_ specify 'POSIX Extended' in config option&quot; - we're
can expecting POSIX Basic behaviour and only it. Agree? But point is:
we're don't know and can't know, what library functionality exists and
what will work or will not.

So, in each separate case we're should make testcase for EACH regex in
acl to make sure it will or not will work.

Generally speaking, with thousands of regular expressions and thousands
of sites - it sounds pretty dumb, right? Many to many relasions,
thousands tests etc.
&gt;<i>
</I>&gt;&gt;<i> Adherence to standards provides interoperability - a familiar word?
</I>&gt;<i> Indeed.
</I>&gt;<i>
</I>&gt;&gt;<i> I asked a simple question. And wanted a simple answer.
</I>&gt;<i> Maybe there isn't one.
</I>Noooooooo.

What could be simpler is to clearly document the following: &quot;Never use
anything other than POSIX Basic in regular expressions because we do not
guarantee and can not guarantee it will work&quot;?
&gt;<i>
</I>&gt;&gt;<i> And not reasoning, what can be, and what can not.
</I>&gt;<i> Then I apologise for trying to explain.
</I>Yes, I understand everything, Anthony. It's easier to unsubscribe -
&quot;Test every regular expression yourself.&quot;
&gt;<i>
</I>&gt;&gt;<i> Interoperability is a simple thing.
</I>&gt;<i> Er, no, it isn't.
</I>Simple. You just have to follow standards and standard *documented*
behavior. As soon as rabbid's dances begin with self-made
interpretations of the standard, problems begin.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Antony.
</I>&gt;<i>
</I>
-- 
**************************
* C++: Bug to the future *
**************************

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0x3E3743A7.asc
Type: application/pgp-keys
Size: 2887 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20171027/52bce01f/attachment.key">http://lists.squid-cache.org/pipermail/squid-users/attachments/20171027/52bce01f/attachment.key</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 659 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20171027/52bce01f/attachment.sig">http://lists.squid-cache.org/pipermail/squid-users/attachments/20171027/52bce01f/attachment.sig</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016740.html">[squid-users] Squid regex grammar
</A></li>
	<LI>Next message (by thread): <A HREF="016743.html">[squid-users] Squid regex grammar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16741">[ date ]</a>
              <a href="thread.html#16741">[ thread ]</a>
              <a href="subject.html#16741">[ subject ]</a>
              <a href="author.html#16741">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
