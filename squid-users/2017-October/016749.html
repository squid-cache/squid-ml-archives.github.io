<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Manager access for statistics
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Manager%20access%20for%20statistics&In-Reply-To=%3C3b04ac5e-9188-45f6-6b67-9972b9690cf5%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016748.html">
   <LINK REL="Next"  HREF="016750.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Manager access for statistics</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Manager%20access%20for%20statistics&In-Reply-To=%3C3b04ac5e-9188-45f6-6b67-9972b9690cf5%40treenet.co.nz%3E"
       TITLE="[squid-users] Manager access for statistics">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Oct 29 11:54:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016748.html">[squid-users] Manager access for statistics
</A></li>
        <LI>Next message (by thread): <A HREF="016750.html">[squid-users] Manager access for statistics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16749">[ date ]</a>
              <a href="thread.html#16749">[ thread ]</a>
              <a href="subject.html#16749">[ subject ]</a>
              <a href="author.html#16749">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 29/10/17 20:02, James Moe wrote:
&gt;<i> Hello,
</I>&gt;<i>    opensuse v42.2
</I>&gt;<i>    linux v4.4.87-18.29-default x86_64
</I>&gt;<i>    squid v3.5.21
</I>&gt;<i> 
</I>&gt;<i>    On occasion I look at the squid statistics; it has been a while since
</I>&gt;<i> I last checked them, at least a month. The request was denied as not
</I>&gt;<i> having access privileges. I do not see why it is now being denied.
</I>&gt;<i>    My understanding is that the ACL names &quot;manager&quot; and &quot;manager_admin&quot;
</I>&gt;<i> would be allowed since they are first in the list (see below).
</I>&gt;<i>    What have I misunderstood?
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://proxy1.sma.com:3128/squid-internal-mgr/info">http://proxy1.sma.com:3128/squid-internal-mgr/info</A>
</I>&gt;<i> 
</I>&gt;<i> acl manager url_regex -i ^cache_<A HREF="object://">object://</A> /squid-internal-mgr/
</I>&gt;<i> acl manager_admin src 192.168.69.115
</I>&gt;<i> #
</I>...

&gt;<i> #
</I>&gt;<i> http_access allow manager_admin manager
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access deny all
</I>

Two things:

1) 'manager' is a pre-defined ACL. The your redefinition contradicts the 
case sensitive URI path. Best not to re-define it.


2) the current recommended practice is to place the manager ACLs after 
the 'CONNECT !SSL_Ports' line.
  That does not affect the admin access but prevents several more attack 
scenarios against Squid.


3) you are not denying manager access to any of the 'localnet' ranges. 
So the whole manager ACL section is pretty pointless.


&gt;<i> 
</I>&gt;<i> # Squid normally listens to port 3128
</I>&gt;<i> http_port 3128
</I>&gt;<i> 
</I>
What does access.log show for the manager request?
The above port is IPv6-enabled but the manager_admin ACL only allows an 
IPv4.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016748.html">[squid-users] Manager access for statistics
</A></li>
	<LI>Next message (by thread): <A HREF="016750.html">[squid-users] Manager access for statistics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16749">[ date ]</a>
              <a href="thread.html#16749">[ thread ]</a>
              <a href="subject.html#16749">[ subject ]</a>
              <a href="author.html#16749">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
