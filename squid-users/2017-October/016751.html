<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't reload webpage like other clients do
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20reload%20webpage%20like%20other%20clients%20do&In-Reply-To=%3Cf877aee786b8477e9c6191a9d6edc32a%40ocgepvsw3101.ocr.priv%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016772.html">
   <LINK REL="Next"  HREF="016755.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't reload webpage like other clients do</H1>
    <B>Troiano Alessio</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20reload%20webpage%20like%20other%20clients%20do&In-Reply-To=%3Cf877aee786b8477e9c6191a9d6edc32a%40ocgepvsw3101.ocr.priv%3E"
       TITLE="[squid-users] Squid doesn't reload webpage like other clients do">alessio.troiano at leonardocompany.com
       </A><BR>
    <I>Mon Oct 30 09:51:09 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016772.html">[squid-users] Manager access for statistics
</A></li>
        <LI>Next message (by thread): <A HREF="016755.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16751">[ date ]</a>
              <a href="thread.html#16751">[ thread ]</a>
              <a href="subject.html#16751">[ subject ]</a>
              <a href="author.html#16751">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
I've squid 3.5.20 running on RHEL 7.4.
I have a problem to access some websites, for example www.nato.int.
This website apply an Anti-DDoS system that reset the first connection after the TCP 3-way handshake (SYN/SYN-ACK/ACK/RST-ACK). All subsequent TCP connections are accepted. The website administrator say's it is by design.
When I browse that site directly with all browser (IE, FF, Chrome) I see the normal site showed. Anyway it is because after the first reset the client try to reload the page. I've the same behaviour also with wget:

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at soc-pe-nagios01</A> ~]# wget www.nato.int
--2017-10-30 10:02:50--  <A HREF="http://www.nato.int/">http://www.nato.int/</A>
Resolving www.nato.int... 152.152.31.120
Connecting to www.nato.int|152.152.31.120|:80... connected.
HTTP request sent, awaiting response... No data received.
Retrying.

--2017-10-30 10:02:51--  (try: 2)  <A HREF="http://www.nato.int/">http://www.nato.int/</A>
Connecting to www.nato.int|152.152.31.120|:80... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: <A HREF="https://www.nato.int/">https://www.nato.int/</A> [following]
--2017-10-30 10:02:51--  <A HREF="https://www.nato.int/">https://www.nato.int/</A>
Connecting to www.nato.int|152.152.31.120|:443... connected.
WARNING: cannot verify www.nato.int's certificate, issued by '/C=BE/O=GlobalSign nv-sa/CN=GlobalSign Organization Validation CA - SHA256 - G2':
  Unable to locally verify the issuer's authority.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: 'index.html.17'

    [      &lt;=&gt;                                                                                         ] 168,229      147K/s   in 1.1s

2017-10-30 10:03:39 (147 KB/s) - index.html.17 saved [168229]

When I browse the site with squid proxy the browser receive an &quot;Empty Response&quot; squid error page (HTTP error code 502 Bad Gateway) and doesn't do the automatic retry:

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at soc-pe-nagios01</A> ~]# wget www.nato.int -e use_proxy=yes -e http_proxy=172.31.1.67:8080
--2017-10-30 10:41:09--  <A HREF="http://www.nato.int/">http://www.nato.int/</A>
Connecting to 172.31.1.67:8080... connected.
Proxy request sent, awaiting response... 502 Bad Gateway
2017-10-30 10:41:09 ERROR 502: Bad Gateway.

I can't find an RFC that confirm if browser and proxyes should try a page reload, or if squid has an option to do that.

Any help is appreciated.

Best Regards, Alessio.

Il presente messaggio e-mail e ogni suo allegato devono intendersi indirizzati esclusivamente al destinatario indicato e considerarsi dal contenuto strettamente riservato e confidenziale. Se non siete l'effettivo destinatario o avete ricevuto il messaggio e-mail per errore, siete pregati di avvertire immediatamente il mittente e di cancellare il suddetto messaggio e ogni suo allegato dal vostro sistema informatico. Qualsiasi utilizzo, diffusione, copia o archiviazione del presente messaggio da parte di chi non ne &#232; il destinatario &#232; strettamente proibito e pu&#242; dar luogo a responsabilit&#224; di carattere civile e penale punibili ai sensi di legge.
Questa e-mail ha valore legale solo se firmata digitalmente ai sensi della normativa vigente.

The contents of this email message and any attachments are intended solely for the addressee(s) and contain confidential and/or privileged information.
If you are not the intended recipient of this message, or if this message has been addressed to you in error, please immediately notify the sender and then delete this message and any attachments from your system. If you are not the intended recipient, you are hereby notified that any use, dissemination, copying, or storage of this message or its attachments is strictly prohibited. Unauthorized disclosure and/or use of information contained in this email message may result in civil and criminal liability. &#8220;
This e-mail has legal value according to the applicable laws only if it is digitally signed by the sender
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016772.html">[squid-users] Manager access for statistics
</A></li>
	<LI>Next message (by thread): <A HREF="016755.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16751">[ date ]</a>
              <a href="thread.html#16751">[ thread ]</a>
              <a href="subject.html#16751">[ subject ]</a>
              <a href="author.html#16751">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
