<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't reload webpage like other clients do
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20reload%20webpage%20like%20other%20clients%20do&In-Reply-To=%3C91c062a2-5049-cf56-5a33-64ab3e30fc34%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016757.html">
   <LINK REL="Next"  HREF="016759.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't reload webpage like other clients do</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20reload%20webpage%20like%20other%20clients%20do&In-Reply-To=%3C91c062a2-5049-cf56-5a33-64ab3e30fc34%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid doesn't reload webpage like other clients do">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Oct 30 19:41:21 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016757.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
        <LI>Next message (by thread): <A HREF="016759.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16758">[ date ]</a>
              <a href="thread.html#16758">[ thread ]</a>
              <a href="subject.html#16758">[ subject ]</a>
              <a href="author.html#16758">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/30/2017 12:15 PM, Andrei wrote:
&gt;<i> You do realize that there's nothing &quot;weird&quot; about p0f, right?
</I>
Right. I do not know why you had to ask though: There is nothing related
to p0f (i.e., a passive traffic analysis tool) in my response. And the
original question is probably unrelated to p0f as well since active
connection resets are incompatible with the idea of passive analysis.

Alex.



&gt;<i> On Mon, Oct 30, 2017 at 11:22 AM, Alex Rousskov wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 10/30/2017 03:51 AM, Troiano Alessio wrote:
</I>&gt;<i> 
</I>&gt;<i>     &gt; I've squid 3.5.20 running on RHEL 7.4. I have a problem to access
</I>&gt;<i>     &gt; some websites, for example www.nato.int &lt;<A HREF="http://www.nato.int">http://www.nato.int</A>&gt;. This website apply an
</I>&gt;<i>     &gt; Anti-DDoS system that reset the first connection after the TCP 3-way
</I>&gt;<i>     &gt; handshake (SYN/SYN-ACK/ACK/RST-ACK). All subsequent TCP connections
</I>&gt;<i>     &gt; are accepted. The website administrator say's it is by design.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt; When I browse the site with squid proxy the browser receive an &quot;Empty
</I>&gt;<i>     &gt; Response&quot; squid error page (HTTP error code 502 Bad Gateway) and
</I>&gt;<i>     &gt; doesn't do the automatic retry:
</I>&gt;<i> 
</I>&gt;<i>     This is by design as well :-).
</I>&gt;<i> 
</I>&gt;<i>     We can change Squid behavior to retry connection resets, but I am sure
</I>&gt;<i>     that some folks will not like the new behavior because in _their_ use
</I>&gt;<i>     cases a retry is wasteful and/or painful. IMHO, the new behavior should
</I>&gt;<i>     be controlled by a configuration directive, possibly an ACL-driven one.
</I>&gt;<i> 
</I>&gt;<i>     Quality patches implementing the above feature should be welcomed IMO.
</I>&gt;<i>     The tip of the relevant code is probably in ERR_ZERO_SIZE_OBJECT
</I>&gt;<i>     handling inside FwdState::fail(). There is a similar code that handles
</I>&gt;<i>     persistent connection races there already, but the zero-size reply code
</I>&gt;<i>     may need a new dedicated FwdState flag to prevent infinite retry loops
</I>&gt;<i>     when the origin server is broken (a much more typical use case than the
</I>&gt;<i>     weird attempt at DDoS mitigation that you have described above).
</I>&gt;<i> 
</I>&gt;<i>     <A HREF="https://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F">https://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016757.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
	<LI>Next message (by thread): <A HREF="016759.html">[squid-users] Squid doesn't reload webpage like other clients do
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16758">[ date ]</a>
              <a href="thread.html#16758">[ thread ]</a>
              <a href="subject.html#16758">[ subject ]</a>
              <a href="author.html#16758">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
