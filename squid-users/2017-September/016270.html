<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] external ACL queue overload
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20external%20ACL%20queue%20overload&In-Reply-To=%3C0d241494-ab65-4df9-2ddc-ecbc79976a1a%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016265.html">
   <LINK REL="Next"  HREF="016278.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] external ACL queue overload</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20external%20ACL%20queue%20overload&In-Reply-To=%3C0d241494-ab65-4df9-2ddc-ecbc79976a1a%40treenet.co.nz%3E"
       TITLE="[squid-users] external ACL queue overload">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Sep  4 14:55:42 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016265.html">[squid-users] external ACL queue overload
</A></li>
        <LI>Next message (by thread): <A HREF="016278.html">[squid-users] external ACL queue overload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16270">[ date ]</a>
              <a href="thread.html#16270">[ thread ]</a>
              <a href="subject.html#16270">[ subject ]</a>
              <a href="author.html#16270">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/09/17 19:13, Vieri wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I sometimes get messages such as this one:
</I>&gt;<i> 
</I>&gt;<i> WARNING: external ACL 'bllookup' queue overload. Using stale result.
</I>&gt;<i> 
</I>&gt;<i> My squid.conf has this defined:
</I>&gt;<i> 
</I>&gt;<i> external_acl_type bllookup ttl=60 %URI /opt/custom/scripts/run/scripts/firewall/squid_url_lookup.pl -tbl_name=shallalist_bl adv,aggressive,...
</I>&gt;<i> 
</I>&gt;<i> Does it make sense to increase the following values:
</I>&gt;<i> 
</I>&gt;<i> ttl=86400 children-max=50 children-startup=2 children-idle=5
</I>&gt;<i> 
</I>
Maybe. The ttl= value is entirely up to you, it should be long enough 
not to send too many queries to the helper, and short enough that 
changes to the lists which result in OK responses do not lag overly 
long. Use negative_ttl= to tune the equivalent TTL for ERR results.



&gt;<i> I'd like to know what &quot;children-startup&quot; means exactly.
</I>
startup is the number of helpers Squid will start immediately on 
starting or reconfiguring. If used it should be set to about the number 
necessary for handling your baseline traffic load.

idle is the number of new helpers Squid will start in a batch together 
if it cannot send a lookup to the already running ones. This may take 
some seconds so the value needs to be large enough to pick up the minor 
peak of traffic accumulated during that delay - but otherwise is arbitrary.

max is the limit beyond which Squid will not start more helpers, even if 
idle says more are needed.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016265.html">[squid-users] external ACL queue overload
</A></li>
	<LI>Next message (by thread): <A HREF="016278.html">[squid-users] external ACL queue overload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16270">[ date ]</a>
              <a href="thread.html#16270">[ thread ]</a>
              <a href="subject.html#16270">[ subject ]</a>
              <a href="author.html#16270">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
