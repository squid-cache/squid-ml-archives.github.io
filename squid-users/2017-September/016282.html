<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL3_GET_SERVER_CERTIFICATE%3Acertificate%20verify%0A%20failed&In-Reply-To=%3C02ed068f-0aba-5e16-4f2f-30d36ee9d9f9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016272.html">
   <LINK REL="Next"  HREF="016273.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSL3_GET_SERVER_CERTIFICATE:certificate verify failed</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL3_GET_SERVER_CERTIFICATE%3Acertificate%20verify%0A%20failed&In-Reply-To=%3C02ed068f-0aba-5e16-4f2f-30d36ee9d9f9%40treenet.co.nz%3E"
       TITLE="[squid-users] SSL3_GET_SERVER_CERTIFICATE:certificate verify failed">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Sep  5 11:01:59 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016272.html">[squid-users] SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
</A></li>
        <LI>Next message (by thread): <A HREF="016273.html">[squid-users] DNS Server Failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16282">[ date ]</a>
              <a href="thread.html#16282">[ thread ]</a>
              <a href="subject.html#16282">[ subject ]</a>
              <a href="author.html#16282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/09/17 04:20, erdosain9 wrote:
&gt;<i> Hi.
</I>&gt;<i> Im having a lot of this in cache.log... is this normal?? The https is access
</I>&gt;<i> is working fine... but i have those error.
</I>&gt;<i> 
</I> &gt; 2017/09/04 13:10:58 kid1| Error negotiating SSL on FD 467:
 &gt; error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate 
verify
 &gt; failed (
 &gt; 1/-1/0)


Yes and no. &quot;Normal&quot; is relative to why it is happening.

eg if your network is under attack it is &quot;normal&quot; to see signs like 
this, but hardly desirable.

On the other hand if the CA certificate being verified has expired or 
revoked it is both normal and desirable to see these instead of letting 
the traffic though. Opinions on that differ a lot though.



* Check that your Squid machines ca-certificates are up to date with the 
latest ones available. That can make your proxy unable to deal with CA 
changes unless you stay up to date. Regular updates are on the order of 
weeks, but can happen with no notice if any CA is breached or goes rogue.

* Check that your crypto library is also the latest available. Some 
types of change in TLS extensions can lead to cert errors if the library 
does not understand what fields in the server cert mean. This also helps 
prevent many cipher related errors.

* Take a closer look at the HTTP(S) transaction using the mentioned FD 
number. That may need a section 11,2 trace to see the URL and server 
names and/or IP. See if the openssl command line tools can tell you what 
is non-verifiable about the server cert.

* If it turns out to be an intermediary cert not known by Squid, check 
carefully whether you actually want to trust it. If so you can use 
sslproxy_foreign_intermediate_certs to load it explicitly (or Squid-4 
should auto-download as needed).
&lt;<A HREF="http://www.squid-cache.org/Doc/config/sslproxy_foreign_intermediate_certs/">http://www.squid-cache.org/Doc/config/sslproxy_foreign_intermediate_certs/</A>&gt;


It is rarely any other type of occurance that can be solved by Squid. 
The above should provide some clues to further debugging if necessary.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016272.html">[squid-users] SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
</A></li>
	<LI>Next message (by thread): <A HREF="016273.html">[squid-users] DNS Server Failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16282">[ date ]</a>
              <a href="thread.html#16282">[ thread ]</a>
              <a href="subject.html#16282">[ subject ]</a>
              <a href="author.html#16282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
