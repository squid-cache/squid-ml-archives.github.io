<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TLS%3A%201st%20time%20w/intermediate%20cert%3A%20not%20working%3B%0A%20ideas%20on%20what%20I%27m%20doing%20wrong%3F&In-Reply-To=%3C59B1B6C0.9090605%40tlinx.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016306.html">
   <LINK REL="Next"  HREF="016300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?</H1>
    <B>L A Walsh</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TLS%3A%201st%20time%20w/intermediate%20cert%3A%20not%20working%3B%0A%20ideas%20on%20what%20I%27m%20doing%20wrong%3F&In-Reply-To=%3C59B1B6C0.9090605%40tlinx.org%3E"
       TITLE="[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?">squid-user at tlinx.org
       </A><BR>
    <I>Thu Sep  7 21:14:40 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016306.html">[squid-users] Looking for assistance with setting up a TLS proxy
</A></li>
        <LI>Next message (by thread): <A HREF="016300.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16299">[ date ]</a>
              <a href="thread.html#16299">[ thread ]</a>
              <a href="subject.html#16299">[ subject ]</a>
              <a href="author.html#16299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Got an error message from squid where I'm doing https-bumping:

--------------------------
The following error was encountered while trying to retrieve the URL: 
<A HREF="https://help.ea.com/">https://help.ea.com/</A>

    *Failed to establish a secure connection to 52.0.220.87*

The system returned:

    (71) Protocol error (TLS code: X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)

    SSL Certficate error: certificate issuer (CA) not known:
    /C=US/O=Symantec Corporation/OU=Symantec Trust Network/CN=Symantec
    Class 3 Secure Server CA - G4

This proxy and the remote host failed to negotiate a mutually acceptable 
security settings for handling your request. It is possible that the 
remote host does not support secure connections, or the proxy is not 
satisfied with the host security credentials.

--------------------------------

Googling found:
<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Howto-fix-X509-V-ERR-UNABLE-TO-GET-ISSUER-CERT-LOCALLY-Squid-error-td4682015.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Howto-fix-X509-V-ERR-UNABLE-TO-GET-ISSUER-CERT-LOCALLY-Squid-error-td4682015.html</A>

Used openssl.com to get the intermediate certs (2 hosts are referenced
in parallel chains).  The two certs looked like:

-----BEGIN CERTIFICATE-----
...hexstuff==
-----END CERTIFICATE-----


Added the certs to a file and that filename to my squid.conf on a line:

sslproxy_foreign_intermediate_certs /etc/squid/ssl_intermediates/cert.pem

restarted squid, but am still getting same error.

Am I missing some obvious step?

Looking for a clue... ;-)

Thanks!
-l







</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016306.html">[squid-users] Looking for assistance with setting up a TLS proxy
</A></li>
	<LI>Next message (by thread): <A HREF="016300.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16299">[ date ]</a>
              <a href="thread.html#16299">[ thread ]</a>
              <a href="subject.html#16299">[ subject ]</a>
              <a href="author.html#16299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
