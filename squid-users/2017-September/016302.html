<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TLS%3A%201st%20time%20w/intermediate%20cert%3A%20not%20working%3B%0A%20ideas%20on%20what%20I%27m%20doing%20wrong%3F&In-Reply-To=%3C1222937e-bb7f-a67d-d19f-c92bb2e99b74%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016301.html">
   <LINK REL="Next"  HREF="016305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?</H1>
    <B>Yuri</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TLS%3A%201st%20time%20w/intermediate%20cert%3A%20not%20working%3B%0A%20ideas%20on%20what%20I%27m%20doing%20wrong%3F&In-Reply-To=%3C1222937e-bb7f-a67d-d19f-c92bb2e99b74%40gmail.com%3E"
       TITLE="[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?">yvoinov at gmail.com
       </A><BR>
    <I>Thu Sep  7 21:26:27 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016301.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
        <LI>Next message (by thread): <A HREF="016305.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16302">[ date ]</a>
              <a href="thread.html#16302">[ thread ]</a>
              <a href="subject.html#16302">[ subject ]</a>
              <a href="author.html#16302">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Also. Symantec's root's can be already removed from most bundles (you
should hear about it, is it?).

So. May be can be required to add Symantec's root(s) manually to proxy
root CA bundle.


08.09.2017 3:24, Yuri &#1087;&#1080;&#1096;&#1077;&#1090;:
&gt;<i> Ooooops,
</I>&gt;<i>
</I>&gt;<i> miss end of message :)
</I>&gt;<i>
</I>&gt;<i> Check all CA's chain. It is possible your root CA's bundle not complete.
</I>&gt;<i>
</I>&gt;<i> I usually use root CA's from Mozilla (added to squid.conf as one file)
</I>&gt;<i> and own self-supported intermediate CA's list (file).
</I>&gt;<i>
</I>&gt;<i> But in addition I'm using Squid 5.x with working cert's downloader ;)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 08.09.2017 3:14, L A Walsh &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;<i> Got an error message from squid where I'm doing https-bumping:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --------------------------
</I>&gt;&gt;<i> The following error was encountered while trying to retrieve the URL:
</I>&gt;&gt;<i> <A HREF="https://help.ea.com/">https://help.ea.com/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160; *Failed to establish a secure connection to 52.0.220.87*
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The system returned:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160; (71) Protocol error (TLS code:
</I>&gt;&gt;<i> X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160; SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;&gt;<i> &#160;&#160; /C=US/O=Symantec Corporation/OU=Symantec Trust Network/CN=Symantec
</I>&gt;&gt;<i> &#160;&#160; Class 3 Secure Server CA - G4
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This proxy and the remote host failed to negotiate a mutually
</I>&gt;&gt;<i> acceptable security settings for handling your request. It is possible
</I>&gt;&gt;<i> that the remote host does not support secure connections, or the proxy
</I>&gt;&gt;<i> is not satisfied with the host security credentials.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Googling found:
</I>&gt;&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Howto-fix-X509-V-ERR-UNABLE-TO-GET-ISSUER-CERT-LOCALLY-Squid-error-td4682015.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Howto-fix-X509-V-ERR-UNABLE-TO-GET-ISSUER-CERT-LOCALLY-Squid-error-td4682015.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Used openssl.com to get the intermediate certs (2 hosts are referenced
</I>&gt;&gt;<i> in parallel chains).&#160; The two certs looked like:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----BEGIN CERTIFICATE-----
</I>&gt;&gt;<i> ...hexstuff==
</I>&gt;&gt;<i> -----END CERTIFICATE-----
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Added the certs to a file and that filename to my squid.conf on a line:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sslproxy_foreign_intermediate_certs /etc/squid/ssl_intermediates/cert.pem
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> restarted squid, but am still getting same error.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Am I missing some obvious step?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Looking for a clue... ;-)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks!
</I>&gt;&gt;<i> -l
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170908/3e08c025/attachment.sig">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170908/3e08c025/attachment.sig</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016301.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
	<LI>Next message (by thread): <A HREF="016305.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16302">[ date ]</a>
              <a href="thread.html#16302">[ thread ]</a>
              <a href="subject.html#16302">[ subject ]</a>
              <a href="author.html#16302">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
