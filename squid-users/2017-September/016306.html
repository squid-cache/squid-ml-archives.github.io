<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Looking for assistance with setting up a TLS proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Looking%20for%20assistance%20with%20setting%20up%20a%20TLS%20proxy&In-Reply-To=%3C53f77aba-d083-546e-c3a1-7543a7dd018f%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016298.html">
   <LINK REL="Next"  HREF="016299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Looking for assistance with setting up a TLS proxy</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Looking%20for%20assistance%20with%20setting%20up%20a%20TLS%20proxy&In-Reply-To=%3C53f77aba-d083-546e-c3a1-7543a7dd018f%40treenet.co.nz%3E"
       TITLE="[squid-users] Looking for assistance with setting up a TLS proxy">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Sep  7 21:47:42 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016298.html">[squid-users] Looking for assistance with setting up a TLS proxy
</A></li>
        <LI>Next message (by thread): <A HREF="016299.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16306">[ date ]</a>
              <a href="thread.html#16306">[ thread ]</a>
              <a href="subject.html#16306">[ subject ]</a>
              <a href="author.html#16306">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/09/17 07:28, Rohit Sodhia wrote:
&gt;<i> Greetings,
</I>&gt;<i> 
</I>&gt;<i> I'm a backend dev who's been suddenly assigned a task to create a squid 
</I>&gt;<i> proxy to intercept cURL/wget requests. We've got old servers that don't 
</I>&gt;<i> support TLS 1.2 and some of the services we use will be requiring it 
</I>&gt;<i> soon, so the decision was made to route cURL and wget requests through a 
</I>&gt;<i> pair of squid servers. Unfortunately, I'm not a sysop (or even really 
</I>&gt;<i> knowledgeable in this area) and am having some trouble, hoping someone 
</I>&gt;<i> wouldn't mind helping me out.
</I>&gt;<i> 
</I>&gt;<i> I've been through the squid documentation and been playing around with 
</I>&gt;<i> the examples on the squid site, including finding one for creating an 
</I>&gt;<i> interception proxy. However, if I'm correct, for squid to be able to 
</I>&gt;<i> upgrade the TLS requests from their current 1.0 to 1.2, squid would need 
</I>&gt;<i> to decrypt the incoming request, then reencrypt it?
</I>
Yes. The TLS messaging needs replacing to negotiate TLS/1.0 variants of 
things, and often the server cert itself needs replacing entirely due to 
TLS/1.1+ extension bits inside it.


&gt;<i> I'm hoping someone 
</I>&gt;<i> out there may be willing to help point me in the right direction; I've 
</I>&gt;<i> been given a tight deadline, and both learning about the technologies 
</I>&gt;<i> and find an effective solution is straining.
</I>&gt;<i> 
</I>&gt;<i> Thank you,
</I>&gt;<i> 
</I>
The feature details for Squid TLS interception capabilities is 
&lt;<A HREF="https://wiki.squid-cache.org/Features/SslPeekAndSplice">https://wiki.squid-cache.org/Features/SslPeekAndSplice</A>&gt;

The more you know about TLS messaging the easier it is to grasp what 
Squid is doing. But the basics as covered on that pages' second section 
should be sufficient to use the feature.

Some things that might trip you up:

* the &quot;stare&quot; and &quot;splice&quot; actions we normally advise using cannot be 
used when translating TLS versions. They deliver the client TLS version 
(at least) on messages to the server.

* bump at step1 (maybe step2) will do exactly what you need. This 
emulates the client-first bumping action which is documented as &quot;causes 
a lot of problems&quot; mostly in terms of adding major TLS vulnerabilities 
to the whole system - so minimize use as much as possible.

* TLS SNI and similar extensions are generally not sent by TLS/1.0 
clients. Which makes it difficult to tell what service is being 
requested, and thus to do that above minimization.


HTH
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016298.html">[squid-users] Looking for assistance with setting up a TLS proxy
</A></li>
	<LI>Next message (by thread): <A HREF="016299.html">[squid-users] TLS: 1st time w/intermediate cert: not working; ideas on what I'm doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16306">[ date ]</a>
              <a href="thread.html#16306">[ thread ]</a>
              <a href="subject.html#16306">[ subject ]</a>
              <a href="author.html#16306">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
