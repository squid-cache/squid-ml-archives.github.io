<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid-users Digest, Vol 37, Issue 50
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2037%2C%20Issue%2050&In-Reply-To=%3C1026131530.72470.1506047843278%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016454.html">
   <LINK REL="Next"  HREF="016415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid-users Digest, Vol 37, Issue 50</H1>
    <B>Sukhbaatar T</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid-users%20Digest%2C%20Vol%2037%2C%20Issue%2050&In-Reply-To=%3C1026131530.72470.1506047843278%40mail.yahoo.com%3E"
       TITLE="[squid-users] squid-users Digest, Vol 37, Issue 50">sukhbaatar_t at yahoo.com
       </A><BR>
    <I>Fri Sep 22 02:37:23 UTC 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="016454.html">[squid-users] delay pool not workin
</A></li>
        <LI>Next message (by thread): <A HREF="016415.html">[squid-users] squid-users Digest, Vol 37, Issue 50
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16414">[ date ]</a>
              <a href="thread.html#16414">[ thread ]</a>
              <a href="subject.html#16414">[ subject ]</a>
              <a href="author.html#16414">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello. Yesterday virus attack my squid proxy server. Lost my all config. Can you give me congfig file normal for Windows. 50gb size on hdd for cash, youtube, fb cashing, 8 gb ram. Forgot many command line for quick access. Forgot link for example.

Sent from Yahoo Mail for iPhone


On Friday, September 22, 2017, 9:03 AM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A> wrote:

Send squid-users mailing list submissions to
&#160;&#160;&#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>

To subscribe or unsubscribe via the World Wide Web, visit
&#160;&#160;&#160; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
or, via email, send a message with subject or body 'help' to
&#160;&#160;&#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>

You can reach the person managing the list at
&#160;&#160;&#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>

When replying, please edit your Subject line so it is more specific
than &quot;Re: Contents of squid-users digest...&quot;


Today's Topics:

&#160; 1. Re: When the redirect [301, 302, 307] is cached by Squid?
&#160; &#160; &#160; (Amos Jeffries)
&#160; 2. time error problem (Alex Guti&#233;rrez Mart&#237;nez)
&#160; 3. Re: When the redirect [301, 302,&#160;&#160;&#160; 307] is cached by Squid?
&#160; &#160; &#160; (kAja Ziegler)
&#160; 4. delay pool not workin (Alex Guti&#233;rrez Mart&#237;nez)
&#160; 5. Re: time error problem (Amos Jeffries)
&#160; 6. Re: delay pool not workin (Amos Jeffries)


----------------------------------------------------------------------

Message: 1
Date: Fri, 22 Sep 2017 00:24:11 +1200
From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] When the redirect [301, 302, 307] is cached
&#160;&#160;&#160; by Squid?
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5d9406a2-0192-de83-a2fc-2ca577b6c07b at treenet.co.nz</A>&gt;
Content-Type: text/plain; charset=utf-8; format=flowed

On 21/09/17 22:16, kAja Ziegler wrote:
&gt;<i>&#160; &#160; Thats what the &quot;must-revalidate&quot; means. It should work better with
</I>&gt;<i>&#160; &#160; just max-age or Expires header - and with a longer value than 60 sec
</I>&gt;<i>&#160; &#160; since this is supposed to be a *permanent* situation.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> As I know &quot;must-revalidate&quot; mean &quot;refuse to return stale responses to 
</I>&gt;<i> the user even if they say that stale responses are acceptable&quot; - cached 
</I>&gt;<i> object must be revalidated.
</I>&gt;<i> 
</I>&gt;<i> Max-age=60 was only used for testing.
</I>&gt;<i> 
</I>&gt;<i> The results of my testing:
</I>&gt;<i> 
</I>&gt;<i> - redirect 302 or 307 - to be cached needs Cache-Control max-age &gt; 0 or 
</I>&gt;<i> Expires &quot;access plus 1 seconds&quot;
</I>&gt;<i> - redirect 301 - to be cached needs Cache-Control max-age &gt; 60 or 
</I>&gt;<i> Expires &quot;access plus 61 seconds&quot;
</I>&gt;<i> 
</I>
There is no &gt;60 need on the 301. Just me suggesting that 60sec is too 
short caching time for a _permanent_ thing.

&gt;<i> This is strange because I thought that 301 is always cached without 
</I>&gt;<i> Cache-Control or Expires headers. And I can't find any information in 
</I>&gt;<i> the documentation which describes such behaviour.
</I>
It should be, so long as it is fresh so that means it does depend on 
refresh_pattern saying it is fresh when no controls are present.

Amos


------------------------------

Message: 2
Date: Thu, 21 Sep 2017 08:50:57 -0400
From: Alex Guti&#233;rrez Mart&#237;nez &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">alex at dvm.esines.cu</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] time error problem
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5a4045a0-b19f-3fd0-677d-fa6f2bdb8ba8 at dvm.esines.cu</A>&gt;
Content-Type: text/plain; charset=&quot;utf-8&quot;; Format=&quot;flowed&quot;

Hello everyone, i have an ubuntu 14.04 configured for time zone &quot;Havana&quot; 
on meridian -5. But when i get an error page on my squid, for whatever 
reason, it puts the time zone as if it were in meridian 0. Any idea why?


Thanks in advance

-- 
Saludos Cordiales

Lic. Alex Guti&#233;rrez Mart&#237;nez

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/b2e55dac/attachment-0001.html">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/b2e55dac/attachment-0001.html</A>&gt;

------------------------------

Message: 3
Date: Thu, 21 Sep 2017 15:16:04 +0200
From: kAja Ziegler &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ziegleka at gmail.com</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] When the redirect [301, 302,&#160;&#160;&#160; 307] is cached
&#160;&#160;&#160; by Squid?
Message-ID:
&#160;&#160;&#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">CAMuNeAuvGAPRg5cqzGjRVwtt3y03j4MXhu9ofhhOiYEs4op3ug at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=&quot;utf-8&quot;

&gt;<i>
</I>&gt;<i> There is no &gt;60 need on the 301. Just me suggesting that 60sec is too
</I>&gt;<i> short caching time for a _permanent_ thing.
</I>

There is - may be some misconfiguration in my squid.conf.

If I set max-age to values from interval &lt;1;60&gt; only 302 and 307 redirects
were cached (HIT) and no 301. When I increased the max-age value to 61 then
the 301 redirect was cached too.


But you are right, that the cause of no-caching the 301 redirect is the min
value of:

refresh_pattern .&#160;&#160;&#160; &#160;&#160;&#160; 0&#160;&#160;&#160; 20%&#160;&#160;&#160; 4320

But for redirects 302 and 307 the above-mentioned refresh_pattern is ignored.


My source server is Apache and the corresponding configuration is:

RewriteRule /img301.jpg /img.svg [R=301,L,E=rcache:1]

RewriteRule /img302.jpg /img.svg [R=302,L,E=rcache:1]
RewriteRule /img307.jpg /img.svg [R=307,L,E=rcache:1]

Header always set Cache-Control &quot;max-age=3&quot; env=rcache

zigi

On Thu, Sep 21, 2017 at 2:24 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 21/09/17 22:16, kAja Ziegler wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>&#160; &#160; Thats what the &quot;must-revalidate&quot; means. It should work better with
</I>&gt;&gt;<i>&#160; &#160; just max-age or Expires header - and with a longer value than 60 sec
</I>&gt;&gt;<i>&#160; &#160; since this is supposed to be a *permanent* situation.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As I know &quot;must-revalidate&quot; mean &quot;refuse to return stale responses to the
</I>&gt;&gt;<i> user even if they say that stale responses are acceptable&quot; - cached object
</I>&gt;&gt;<i> must be revalidated.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Max-age=60 was only used for testing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The results of my testing:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - redirect 302 or 307 - to be cached needs Cache-Control max-age &gt; 0 or
</I>&gt;&gt;<i> Expires &quot;access plus 1 seconds&quot;
</I>&gt;&gt;<i> - redirect 301 - to be cached needs Cache-Control max-age &gt; 60 or Expires
</I>&gt;&gt;<i> &quot;access plus 61 seconds&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> There is no &gt;60 need on the 301. Just me suggesting that 60sec is too
</I>&gt;<i> short caching time for a _permanent_ thing.
</I>&gt;<i>
</I>&gt;<i> This is strange because I thought that 301 is always cached without
</I>&gt;&gt;<i> Cache-Control or Expires headers. And I can't find any information in the
</I>&gt;&gt;<i> documentation which describes such behaviour.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It should be, so long as it is fresh so that means it does depend on
</I>&gt;<i> refresh_pattern saying it is fresh when no controls are present.
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/0d759f92/attachment-0001.html">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/0d759f92/attachment-0001.html</A>&gt;

------------------------------

Message: 4
Date: Thu, 21 Sep 2017 17:07:28 -0400
From: Alex Guti&#233;rrez Mart&#237;nez &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">alex at dvm.esines.cu</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] delay pool not workin
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">0e306c67-faed-9b4d-56e3-14f546e626a8 at dvm.esines.cu</A>&gt;
Content-Type: text/plain; charset=&quot;utf-8&quot;; Format=&quot;flowed&quot;

Could someone be so kind&#160; to explain to me why my rules do not work on 
my delays pools?


i got this acl &quot;lento&quot;, in spanish means slow

acl lento url_regex -i &quot;/etc/squid3/bloqueo/lento&quot;

his format is the next:


.youtube.com

.facebook.com


My delay config is the next:


###############################################################################
#Delay#
###############################################################################
delay_pools 3

#Canal 1 extensiones.
delay_class 1 2
delay_parameters 1 32768/32768 32768/32768
delay_access 1 deny !sociales lento navegacion !extensiones
#delay_access 1 deny all

#Canal 2 para usuarios.
delay_class 2 2
delay_parameters 2 65536/65536 32768/32768
delay_access 2 deny !navegacion extensiones lento sociales
#delay_access 2 deny all

#Canal 2 para usuarios.
delay_class 3 1
delay_parameters 3 16384/16384
delay_access 3 deny extensiones navegacion sociales !lento
#delay_access 2 deny all



my problem is simple, on my sqstat show the url's of &quot;lento&quot; with 0 on 
delay parameter, i do not understand why it happens. the program should 
show 3


thanks in advance

-- 
Saludos Cordiales

Lic. Alex Guti&#233;rrez Mart&#237;nez

Tel. +53 7 2710327

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/02ee6868/attachment-0001.html">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170921/02ee6868/attachment-0001.html</A>&gt;

------------------------------

Message: 5
Date: Fri, 22 Sep 2017 12:59:12 +1200
From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] time error problem
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">5a5eb457-9dd4-1fef-1c34-8442179c6ed4 at treenet.co.nz</A>&gt;
Content-Type: text/plain; charset=utf-8; format=flowed

On 22/09/17 00:50, Alex Guti&#233;rrez Mart&#237;nez wrote:
&gt;<i> Hello everyone, i have an ubuntu 14.04 configured for time zone &quot;Havana&quot; 
</I>&gt;<i> on meridian -5. But when i get an error page on my squid, for whatever 
</I>&gt;<i> reason, it puts the time zone as if it were in meridian 0. Any idea why?
</I>&gt;<i> 
</I>
Because the Internet runs on UTC not your local timezone.
Error pages are sent to anyone trying to access your proxy regardless of 
location (eg denying external access through it).

Amos


------------------------------

Message: 6
Date: Fri, 22 Sep 2017 13:03:49 +1200
From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] delay pool not workin
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">7b5d9b7d-7280-1cd6-4d8c-3257c267c942 at treenet.co.nz</A>&gt;
Content-Type: text/plain; charset=utf-8; format=flowed

On 22/09/17 09:07, Alex Guti&#233;rrez Mart&#237;nez wrote:
&gt;<i> Could someone be so kind&#160; to explain to me why my rules do not work on 
</I>&gt;<i> my delays pools?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> i got this acl &quot;lento&quot;, in spanish means slow
</I>&gt;<i> 
</I>&gt;<i> acl lento url_regex -i &quot;/etc/squid3/bloqueo/lento&quot;
</I>&gt;<i> 
</I>&gt;<i> his format is the next:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> .youtube.com
</I>&gt;<i> 
</I>&gt;<i> .facebook.com
</I>&gt;<i> 
</I>
First problem: you are putting domains in dstdomain format into a 
full-URL regex ACL.

Use dstdomain ACL type for these. Much faster.


&gt;<i> 
</I>&gt;<i> My delay config is the next:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ###############################################################################
</I>&gt;<i> #Delay#
</I>&gt;<i> ###############################################################################
</I>&gt;<i> delay_pools 3
</I>&gt;<i> 
</I>&gt;<i> #Canal 1 extensiones.
</I>&gt;<i> delay_class 1 2
</I>&gt;<i> delay_parameters 1 32768/32768 32768/32768
</I>&gt;<i> delay_access 1 deny !sociales lento navegacion !extensiones
</I>&gt;<i> #delay_access 1 deny all
</I>&gt;<i> 
</I>&gt;<i> #Canal 2 para usuarios.
</I>&gt;<i> delay_class 2 2
</I>&gt;<i> delay_parameters 2 65536/65536 32768/32768
</I>&gt;<i> delay_access 2 deny !navegacion extensiones lento sociales
</I>&gt;<i> #delay_access 2 deny all
</I>&gt;<i> 
</I>&gt;<i> #Canal 2 para usuarios.
</I>&gt;<i> delay_class 3 1
</I>&gt;<i> delay_parameters 3 16384/16384
</I>&gt;<i> delay_access 3 deny extensiones navegacion sociales !lento
</I>&gt;<i> #delay_access 2 deny all
</I>&gt;<i> 
</I>&gt;<i> 
</I>
Second problem: deny, deny all. Nothing allowed to use these pools.


Amos


------------------------------

Subject: Digest Footer

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


------------------------------

End of squid-users Digest, Vol 37, Issue 50
*******************************************



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20170922/1ce2c83d/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20170922/1ce2c83d/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="016454.html">[squid-users] delay pool not workin
</A></li>
	<LI>Next message (by thread): <A HREF="016415.html">[squid-users] squid-users Digest, Vol 37, Issue 50
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16414">[ date ]</a>
              <a href="thread.html#16414">[ thread ]</a>
              <a href="subject.html#16414">[ subject ]</a>
              <a href="author.html#16414">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
