<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid is very slow after moving to	production	environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20is%20very%20slow%20after%20moving%20to%0A%09production%09environment&In-Reply-To=%3CHE1PR04MB1148229664D2CD27C5FA2CA28FBF0%40HE1PR04MB1148.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018039.html">
   <LINK REL="Next"  HREF="018046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid is very slow after moving to	production	environment</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20is%20very%20slow%20after%20moving%20to%0A%09production%09environment&In-Reply-To=%3CHE1PR04MB1148229664D2CD27C5FA2CA28FBF0%40HE1PR04MB1148.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] Squid is very slow after moving to	production	environment">rafael.akchurin at diladele.com
       </A><BR>
    <I>Mon Apr  9 20:10:07 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018039.html">[squid-users] Squid is very slow after moving to production	environment
</A></li>
        <LI>Next message (by thread): <A HREF="018046.html">[squid-users] Squid is very slow after moving to production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18040">[ date ]</a>
              <a href="thread.html#18040">[ thread ]</a>
              <a href="subject.html#18040">[ subject ]</a>
              <a href="author.html#18040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Roberto,

When Squid is &quot;slow&quot; like users complain first thing to check is always the DNS settings.
Also sometimes switching to &quot;IPv4 DNS resolve first&quot; helps.

Look for &quot;squidclient mgr:idns&quot; and &quot;dns_v4_first on&quot; on Squid wiki.

Hope others have better answers.

Best regards,
Rafael Akchurin
Diladele B.V.

<A HREF="https://www.diladele.com/">https://www.diladele.com/</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Roberto Carna
Sent: Monday, April 9, 2018 9:59 PM
To: Antony Stone &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Antony.Stone at squid.open.source.it</A>&gt;
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid is very slow after moving to production environment

Dear Antony, both proxies are virtual machines in the same DMZ....they use the same DNS, the same firewall, the same Internet link, the same IP but different MAC Address.

Firewall rules are the same too.

The new proxy is slow because when users try to go to a web page, it is very slow in download the content page.....about 1 minute to do it.

The Dansguardian configuration is te same too.

I've past my configuration in the previous mail.

Thanks a lot !!!



2018-04-09 16:36 GMT-03:00 Antony Stone &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Antony.Stone at squid.open.source.it</A>&gt;:
&gt;<i> On Monday 09 April 2018 at 21:00:21, Roberto Carna wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Dear, I have implemented a server with Dansguardian 10.2.1.1 and 
</I>&gt;&gt;<i> Squid 3.5.23-5.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've tested it with 5 users for along 2 months and always it worked OK.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But today when a moved it to production environment, it worked but 
</I>&gt;&gt;<i> very very slow.
</I>&gt;<i>
</I>&gt;<i> 1. What is &quot;very very slow&quot;?  What difference are you noticing:
</I>&gt;<i>
</I>&gt;<i>  - limited bandwidth for downloads?
</I>&gt;<i>
</I>&gt;<i>  - high latency for reaching new URLs?
</I>&gt;<i>
</I>&gt;<i>  - reduced ability to handle new requests?
</I>&gt;<i>
</I>&gt;<i> Basically, how are you measuring the difference between test 
</I>&gt;<i> performance and production performance?
</I>&gt;<i>
</I>&gt;<i> 2. Please explain your networking setups for the test and production
</I>&gt;<i> environments:
</I>&gt;<i>
</I>&gt;<i>  - do they share the same Internet connection?
</I>&gt;<i>
</I>&gt;<i>  - do they both go through the same firewall?
</I>&gt;<i>
</I>&gt;<i>  - do they both use the same DNS server, or have their own DNS 
</I>&gt;<i> servers, or what?
</I>&gt;<i>
</I>&gt;<i>  - are the same traffic rules implemented for each procy on the firewall/s?
</I>&gt;<i>
</I>&gt;<i>  - do you use any form of user authentication, and if so, please give 
</I>&gt;<i> details
</I>&gt;<i>
</I>&gt;<i> 3. What volume of requests per hour / minute / day / whatever is 
</I>&gt;<i> convenient did you have in the test environment, and what volume do 
</I>&gt;<i> you have now in the production environment?
</I>&gt;<i>
</I>&gt;&gt;<i> I've just changed hostname and IP, in order to match with the old 
</I>&gt;&gt;<i> proxy server and flush de ARP table of the firewall (because ths 
</I>&gt;&gt;<i> server has the same IP but different MAC Address)....and no more. And 
</I>&gt;&gt;<i> let me say that in production environment, there are 30-40 users at 
</I>&gt;&gt;<i> all, it's not a big number of users at all.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Where can I start to see in order to analyze the problem? Any idea to 
</I>&gt;&gt;<i> help me?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Antony.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> I thought I had type A blood, but it turned out to be a typo.
</I>&gt;<i>
</I>&gt;<i>                                                    Please reply to the list;
</I>&gt;<i>                                                          please *don't* CC me.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018039.html">[squid-users] Squid is very slow after moving to production	environment
</A></li>
	<LI>Next message (by thread): <A HREF="018046.html">[squid-users] Squid is very slow after moving to production environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18040">[ date ]</a>
              <a href="thread.html#18040">[ thread ]</a>
              <a href="subject.html#18040">[ subject ]</a>
              <a href="author.html#18040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
