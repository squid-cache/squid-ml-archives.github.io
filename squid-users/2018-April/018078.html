<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ideas for better caching these popular urls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ideas%20for%20better%20caching%20these%20popular%20urls&In-Reply-To=%3C001901d3d1ef%249842a610%24c8c7f230%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018073.html">
   <LINK REL="Next"  HREF="018051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ideas for better caching these popular urls</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ideas%20for%20better%20caching%20these%20popular%20urls&In-Reply-To=%3C001901d3d1ef%249842a610%24c8c7f230%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Ideas for better caching these popular urls">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Apr 11 23:48:29 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018073.html">[squid-users] Ideas for better caching these popular urls
</A></li>
        <LI>Next message (by thread): <A HREF="018051.html">[squid-users] Secure Web Proxy Stress Testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18078">[ date ]</a>
              <a href="thread.html#18078">[ thread ]</a>
              <a href="subject.html#18078">[ subject ]</a>
              <a href="author.html#18078">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Omid,

I found the service I wrote and packed it in a RPM at:
<A HREF="http://ngtech.co.il/repo/centos/7/x86_64/response-dumper-icap-1.0.0-1.el7.centos.x86_64.rpm">http://ngtech.co.il/repo/centos/7/x86_64/response-dumper-icap-1.0.0-1.el7.centos.x86_64.rpm</A>

If you are using other OS let me know and I will try to package it for your OS.
Currently debian\ubuntu alien converts the RPM smoothly.

The dumps directory is at:
/var/response-dumper

But the cleanup and filtering ACL's are your job.
You can define which GET requests the service dump\log into the files.
Each individual file in this directory will be name in the next format:
&lt;int epoc time&gt;-&lt;8 bytes uuid&gt;-&lt;md5(GET:full url)&gt;

This format will allow multiple requests happen at the same time but have a different name but the URL hash is still the same so you can filter files by this.
To calculate the hash of a URL use:
$ echo -n &quot;GET:http:/url-to-has.com/path?query=terms&quot;|md5sum

In each and every file the full ICAP respmod details exits ie:
ICAP Request\r\n
HTTP Request \r\n
HTTP Response\r\n

By default cookies+authorization headers are censored from both request and response in the dump to avoid some privacy law issues.

Now the only missing feature is RedBot is to feed a single request and a single response to get a full analysis.

Let me know if it works OK for you(works here fine for a while now).

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of Omid Kosari
Sent: Wednesday, April 11, 2018 12:32
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Ideas for better caching these popular urls

Eliezer Croitoru wrote
&gt;<i> You will need more then just the urls but also the response headers for
</I>&gt;<i> these.
</I>&gt;<i> I might be able to write an ICAP service that will log requests and
</I>&gt;<i> response headers and it can assist Cache admins to improve their
</I>&gt;<i> efficiency but this can take a while.
</I>
Hi Eliezer,

Nice idea. I am ready to test/help/share what you need in real production
environment. Please also do a general thing which includes other domains in
first post attachment. They worth a try .

Thanks




--
Sent from: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html</A>
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018073.html">[squid-users] Ideas for better caching these popular urls
</A></li>
	<LI>Next message (by thread): <A HREF="018051.html">[squid-users] Secure Web Proxy Stress Testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18078">[ date ]</a>
              <a href="thread.html#18078">[ thread ]</a>
              <a href="subject.html#18078">[ subject ]</a>
              <a href="author.html#18078">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
