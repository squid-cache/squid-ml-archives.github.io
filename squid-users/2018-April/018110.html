<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Access Denied for manager
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Access%20Denied%20for%20manager&In-Reply-To=%3C7fbf4b36-beef-654d-d48c-3b94194d8b5b%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018108.html">
   <LINK REL="Next"  HREF="018112.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Access Denied for manager</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Access%20Denied%20for%20manager&In-Reply-To=%3C7fbf4b36-beef-654d-d48c-3b94194d8b5b%40treenet.co.nz%3E"
       TITLE="[squid-users] Access Denied for manager">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Apr 19 07:15:12 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018108.html">[squid-users] Access Denied for manager
</A></li>
        <LI>Next message (by thread): <A HREF="018112.html">[squid-users] Access Denied for manager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18110">[ date ]</a>
              <a href="thread.html#18110">[ thread ]</a>
              <a href="subject.html#18110">[ subject ]</a>
              <a href="author.html#18110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[ please keep replies on-list so others having this problem can also get
answers. ]


On 19/04/18 05:39, James Moe wrote:
&gt;<i> On 04/18/2018 12:08 AM, Amos Jeffries wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> For better ideas look as what your access.log states when the manager
</I>&gt;&gt;<i> report is attempted.
</I>&gt;&gt;<i>
</I>&gt;<i>   I commented the IPv6 &quot;localnet&quot; ACLs, reloaded squid.
</I>&gt;<i>   Still denied access. I do not see any new information here:
</I>&gt;<i> 
</I>&gt;<i> 1524072494.191      1 192.168.69.246 TCP_DENIED/403 4361 GET
</I>&gt;<i> <A HREF="http://sma-server3:3128/squid-internal-mgr/info">http://sma-server3:3128/squid-internal-mgr/info</A> - HIER_NONE/- text/html
</I>&gt;<i> 1524072494.193   5508 192.168.69.115 TCP_MISS/403 4469 GET
</I>&gt;<i> <A HREF="http://proxy1.sma.com:3128/squid-internal-mgr/info">http://proxy1.sma.com:3128/squid-internal-mgr/info</A> -
</I>&gt;<i> HIER_DIRECT/192.168.69.246 text/html
</I>

I see you have a forwarding loop:

 192.168.69.115 -&gt; Squid -&gt; 192.168.69.246 -&gt; Squid -&gt; DENIED.


That 192.168.69.115 is trying to fetch &quot;<A HREF="http://proxy1.sma.com">http://proxy1.sma.com</A>&quot;. But the
Squid appears to think its hostname is &quot;sma-server3&quot;.


Hmm, &quot;sma-server&quot; name rings a bell. I see you brought this same issue
up on 1 Nov 2017 as well and we do not seem to have resolved the issue then.

[ the following requires an understanding of host vs domain vs FQDN names
&lt;<A HREF="https://support.suso.com/supki/What_is_the_difference_between_a_hostname_and_a_domain_name">https://support.suso.com/supki/What_is_the_difference_between_a_hostname_and_a_domain_name</A>&gt;
]


To get any type of access to Squid internal resources working properly
you need both Squid and the external tools to be aware of what its
machines host name is AND that hostname to be publicly resolvable -
meaning it also has to be an FQDN.

 - for the icons ANY receiving Squid can (and usually will) respond if
it has the relevant icon.

 - for manager reports ONLY the individual proxy targeted by the URL
will respond with a successful report. The reasons for that should be
obvious.

If the machines hostname service is broken and cannot be fixed. For
example; producing something like &quot;sma-server3&quot; instead of the proper
sma-server3.sma.com hostname. You can workaround that with
visible_hostname and/or unique_hostname in squid.conf.
 &lt;<A HREF="http://www.squid-cache.org/Doc/config/visible_hostname/">http://www.squid-cache.org/Doc/config/visible_hostname/</A>&gt;
 &lt;<A HREF="http://www.squid-cache.org/Doc/config/unique_hostname/">http://www.squid-cache.org/Doc/config/unique_hostname/</A>&gt;

Be aware that any tools running on the localhost will probably still use
the machines hostname and may now appear to be broken when they &quot;worked&quot;
before. Those directives in squid.conf are _workarounds_ not fixes.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018108.html">[squid-users] Access Denied for manager
</A></li>
	<LI>Next message (by thread): <A HREF="018112.html">[squid-users] Access Denied for manager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18110">[ date ]</a>
              <a href="thread.html#18110">[ thread ]</a>
              <a href="subject.html#18110">[ subject ]</a>
              <a href="author.html#18110">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
