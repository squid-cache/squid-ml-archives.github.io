<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ntml auth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntml%20auth&In-Reply-To=%3Cc0b5adb4-fb2b-671f-a625-ade80d998131%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018887.html">
   <LINK REL="Next"  HREF="018908.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ntml auth</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ntml%20auth&In-Reply-To=%3Cc0b5adb4-fb2b-671f-a625-ade80d998131%40treenet.co.nz%3E"
       TITLE="[squid-users] ntml auth">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Aug  7 18:05:19 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018887.html">[squid-users] ntml auth
</A></li>
        <LI>Next message (by thread): <A HREF="018908.html">[squid-users] [squid-announce] Squid 4.2 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18894">[ date ]</a>
              <a href="thread.html#18894">[ thread ]</a>
              <a href="subject.html#18894">[ subject ]</a>
              <a href="author.html#18894">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/08/18 04:59, Alex Guti&#233;rrez Mart&#237;nez wrote:
&gt;<i> #Hello community, I am trying to connect my squid to my AD using ntml (i
</I>&gt;<i> can't use Kerberos).
</I>
Why not?


&gt;<i> The problem is that I have not found a way to make
</I>&gt;<i> the groups I have in the AD look in the squid.
</I>&gt;<i> 
</I>&gt;<i> #this is my current config using ldap using basic auth
</I>&gt;<i> 
</I>&gt;<i> auth_param basic program / usr / lib / squid / basic_ldap_auth -P -R -b
</I>&gt;<i> &quot;dc = mi, dc = company, dc = cu&quot; -D cn = proxy, ou = ST, dc = mi, dc =
</I>&gt;<i> company, dc = cu -W /etc/squid/ldap.txt -f sAMAccountName =% s -v 3 -s
</I>&gt;<i> sub -h 192.168.1.10
</I>&gt;<i> external_acl_type Group% LOGIN / usr / lib / squid / ext_ldap_group_acl
</I>&gt;<i> -R -b &quot;dc = mi, dc = company, dc = cu&quot; -D cn = proxy, ou = ST, dc = mi,
</I>&gt;<i> dc = company, dc = cu -W /etc/squid/ldap.txt -f &quot;(&amp; (objectclass = user)
</I>&gt;<i> (sAMAccountName =% u) (memberof = cn =% g, dc = mi, dc = company, dc =
</I>&gt;<i> cu))&quot; -h 192.168.1.10
</I>
NP: I hope all those spaces inside the paths and helper parameters are
an artifact from your emailer. If they exist in your config file that
could be causing problems.


&gt;<i> auth_param basic children 10
</I>&gt;<i> auth_param basic realm apolo.mi.empresa.cu
</I>&gt;<i> auth_param basic credentialsttl 2 hour
</I>&gt;<i> acl basic_ldap_auth proxy_auth REQUIRED
</I>&gt;<i> http_access deny! basic_ldap_auth
</I>&gt;<i> 
</I>&gt;<i> #from here i get 2 group
</I>&gt;<i> #
</I>&gt;<i> #i1 and i2
</I>&gt;<i> ###########################
</I>&gt;<i> acl i1 external Group Internet1
</I>&gt;<i> acl i2 external Group Internet2
</I>&gt;<i> 
</I>&gt;<i> ####################################################################################################
</I>&gt;<i> #####
</I>&gt;<i> 
</I>&gt;<i> #my configuration for ntml is
</I>&gt;<i> 
</I>&gt;<i> auth_param ntlm program / usr / bin / ntlm_auth --diagnostics
</I>&gt;<i> --helper-protocol = squid-2.5-ntlmssp --domain = my.company.cu
</I>&gt;<i> auth_param ntlm children 10
</I>&gt;<i> auth_param ntlm keep_alive off
</I>&gt;<i> auth_param ntlm credentialsttl 2 hour
</I>

&quot;credentialsttl&quot; is not a valid configuration setting for NTLM. All NTLM
credentials are valid for exactly and only the length the TCP connection
using them is alive.

Every new TCP connection needs its own credentials and 3-message
authentication handshake to set those up. This is part of why NTLM has
such horribly bad performance and why the default recommended config has
&quot;keep_alive on&quot;.


&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> #What I want is to know how to use the groups that are in my active
</I>&gt;<i> directory, specifically Internet1 and Internet2.
</I>&gt;<i> 
</I>
You need some policy for what each group is allowed (or not allowed) to
do with the proxy. We cannot make that kind of decision for you, only
help you configure your policy to be enforced correctly.

If you don't already have any such policy then there is no point even
looking up the groups.



&gt;<i> #Every time I run &quot;squid -k parse&quot; it shows me an error in the line
</I>&gt;<i> where I define the external groups.
</I>
You have a line defining a helper to lookup group names in LDAP, and two
lines defining ACL checks to test some group names.

 Which of those do you have an error with?

 and what is this error you mention?


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018887.html">[squid-users] ntml auth
</A></li>
	<LI>Next message (by thread): <A HREF="018908.html">[squid-users] [squid-announce] Squid 4.2 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18894">[ date ]</a>
              <a href="thread.html#18894">[ thread ]</a>
              <a href="subject.html#18894">[ subject ]</a>
              <a href="author.html#18894">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
