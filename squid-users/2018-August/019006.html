<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid + Squidguard Youtube URL video filtering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20Squidguard%20Youtube%20URL%20video%20filtering&In-Reply-To=%3CAM0PR04MB4753882C9E9A5CB1137EB2E08F3D0%40AM0PR04MB4753.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019004.html">
   <LINK REL="Next"  HREF="019010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid + Squidguard Youtube URL video filtering</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20Squidguard%20Youtube%20URL%20video%20filtering&In-Reply-To=%3CAM0PR04MB4753882C9E9A5CB1137EB2E08F3D0%40AM0PR04MB4753.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] Squid + Squidguard Youtube URL video filtering">rafael.akchurin at diladele.com
       </A><BR>
    <I>Fri Aug 17 05:55:14 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019004.html">[squid-users] Squid + Squidguard Youtube URL video filtering
</A></li>
        <LI>Next message (by thread): <A HREF="019010.html">[squid-users] Squid + Squidguard Youtube URL video filtering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19006">[ date ]</a>
              <a href="thread.html#19006">[ thread ]</a>
              <a href="subject.html#19006">[ subject ]</a>
              <a href="author.html#19006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Roberto,

Another way is to have a dedicated YouTube API rewriter or say ICAP filter (as we do in Web Safety version 6.4) and try to allow/block video by parsing out the video ID from request URL and looking up its related meta information on the fly in YouTube database.

See our rewriter in Web Safety ICAP filter for Squid available as part of virtual appliance at <A HREF="https://www.diladele.com/virtual_appliance.html.">https://www.diladele.com/virtual_appliance.html.</A>  The code in Python in /opt/websafety/bin/youtube_guard.py and if very easy to understand.

Please note our guard assumes the video partials from googlevideo.com are allowed. If you need to further prevent access to these partials and allow only your video no matter what - then keeping a close eye on the <A HREF="https://github.com/rg3/youtube-dl">https://github.com/rg3/youtube-dl</A> project is a must.

Please note in Web Safety 6.4 (ICAP for Squid) we have rewritten that functionality in golang to allow specifying different allow/deny videos/categories/channels per different group of proxy users. So be sure to get version 6.3.

Best regards,
Rafael Akchurin
Diladele B.V.
<A HREF="https://www.diladele.com">https://www.diladele.com</A>

 

-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Roberto Carna
Sent: Thursday, August 16, 2018 9:51 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid + Squidguard Youtube URL video filtering

Dear Amos, I've tried to sniff the HTTP requests when I ask for:

<A HREF="https://www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0">https://www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0</A>

After that I've created a Squidguard exception list as below:

ytimg.com
googlevideo.com
googleapis.com
www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0

But I can't see the video yet.

Please I need to know if using Squidguard it's just impossible to do this exception, so in this case I forget it.

Thanks a lot again!!!


2018-08-16 10:17 GMT-03:00 Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:
&gt;<i> On 17/08/18 00:43, Roberto Carna wrote:
</I>&gt;&gt;<i> Dear, I have Squid + Squidguard working OK.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Squidguard is filtering the entire www.youtube.com website.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But now I have to permit just one video from Youtube:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0">https://www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have added the below URL as an exception in Squidguard:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> www.youtube.com/embed/ff9sDLGtnK8?rel=0&amp;showinfo=0
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> but after that I can't see it, still blocked.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How can I enable just this URL from Squidguard preferently blocking 
</I>&gt;&gt;<i> the rest of Youtube ???
</I>&gt;<i>
</I>&gt;<i> Unfortunately only with a great deal of difficulty.
</I>&gt;<i>
</I>&gt;<i> The &quot;?v=...&quot; and &quot;/embed/...&quot; URLs are just public identifiers to 
</I>&gt;<i> access the YouTube APIs. At the HTTP level they result in a quite long 
</I>&gt;<i> series of sub-requests, redirections and the like bouncing all over 
</I>&gt;<i> the
</I>&gt;<i> youtube.* and googlevideos.* and googleapis.* domains.
</I>&gt;<i>  Yes all of them are involved multiple times. So whitelisting is an 
</I>&gt;<i> all-or-nothing prospect, with other G services being implicitly 
</I>&gt;<i> whitelisted as side effects.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Also, whenever the way to decipher the above maze of traffic gets 
</I>&gt;<i> published so we can do things like what you ask. YT shortly afterwards 
</I>&gt;<i> change how it operates - usually towards even more complexity. This 
</I>&gt;<i> has happened too many times to be coincidence IMO.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019004.html">[squid-users] Squid + Squidguard Youtube URL video filtering
</A></li>
	<LI>Next message (by thread): <A HREF="019010.html">[squid-users] Squid + Squidguard Youtube URL video filtering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19006">[ date ]</a>
              <a href="thread.html#19006">[ thread ]</a>
              <a href="subject.html#19006">[ subject ]</a>
              <a href="author.html#19006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
