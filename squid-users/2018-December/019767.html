<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Define%20and%20use%20a%20variable%20in%20squid.conf%20%28Was%3A%0A%20What%20happens%20when%20duplicate%20external_acl_type%20are%20mentioned%29&In-Reply-To=%3Cbc297342-7442-520d-5c8f-a5910c52c922%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019766.html">
   <LINK REL="Next"  HREF="019768.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Define%20and%20use%20a%20variable%20in%20squid.conf%20%28Was%3A%0A%20What%20happens%20when%20duplicate%20external_acl_type%20are%20mentioned%29&In-Reply-To=%3Cbc297342-7442-520d-5c8f-a5910c52c922%40measurement-factory.com%3E"
       TITLE="[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Dec  2 17:44:06 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019766.html">[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)
</A></li>
        <LI>Next message (by thread): <A HREF="019768.html">[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19767">[ date ]</a>
              <a href="thread.html#19767">[ thread ]</a>
              <a href="subject.html#19767">[ subject ]</a>
              <a href="author.html#19767">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/1/18 9:31 PM, Amish wrote:

&gt;<i> Now I am looking for alternate ways I can resolve my issue.
</I>
There are probably many ways to do this. There are ready-to-use
templating tools that may be a better solution (more on that further
below). However, I can offer a simple template-free approach that should
work:

   # main.conf
   ...
   include authentication.conf
   ...

and then do either

   cp -p foo.conf authentication.conf

or

   cp -p bar.conf authentication.conf

depending on which authentication mechanism you want to use with a
particular Squid instance.


&gt;<i> Does squid allow defining a variable
</I>
No, Squid does not. However, there must be ready-to-use templating tools
that can substitute a &quot;variable&quot; in squid.conf.template to generate
squid.conf without variables.


&gt;<i> and using it as argument or macro?
</I>
Squid has native support for simple preprocessor conditionals. Combined
with template variables (as discussed above), that support gives you
another way to accomplish the same outcome. The following sketch uses
${Amish::var} as a custom squid.conf.template variable:

    if ${Amish::ForceFoo} = 1
        ... configuration using approach foo ...
    else
        ... configuration using approach bar ...
    endif


&gt;<i> The reason I cant change main.conf directly is because its a
</I>&gt;<i> standardized packaged file and gets overwritten every time package is
</I>&gt;<i> updated.
</I>

That is not a valid argument IMO. You do not need to modify main.conf to
generate a configuration file that is actually used. My earlier
authentication.conf sketch is one example. And even something as simple
as the following sed-based script may work in many cases:

  sed s/AmishForceFoo/true/ main.conf &gt; squid.conf


&gt;<i> This &quot;define&quot; feature can also have several other use in future.
</I>
True. I had considered adding it in the past. The primary reasons it has
not been added yet are:

1. squid.conf terrible syntax makes it difficult to introduce new
syntax-related changes/features safely. For variables to be useful, they
should be usable in many contexts while not being expanded in some other
contexts. As we learned the hard way when general quoted strings were
introduced, getting this right is tricky and sometimes nearly impossible.

2. Templates and such offer a ready-to-use variable support that can
avoid the general problems of #1 in specific deployment environments.
See examples above.

3. Nobody has guided the required changes from an RFC to implementation.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019766.html">[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)
</A></li>
	<LI>Next message (by thread): <A HREF="019768.html">[squid-users] Define and use a variable in squid.conf (Was: What happens when duplicate external_acl_type are mentioned)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19767">[ date ]</a>
              <a href="thread.html#19767">[ thread ]</a>
              <a href="subject.html#19767">[ subject ]</a>
              <a href="author.html#19767">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
