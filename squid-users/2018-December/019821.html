<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] note macro - %{policy_}note passes old values along with new value
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20note%20macro%20-%20%25%7Bpolicy_%7Dnote%20passes%20old%20values%0A%20along%20with%20new%20value&In-Reply-To=%3C696c2b06-6ca0-b0e6-5d5b-82a86703640c%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019820.html">
   <LINK REL="Next"  HREF="019822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] note macro - %{policy_}note passes old values along with new value</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20note%20macro%20-%20%25%7Bpolicy_%7Dnote%20passes%20old%20values%0A%20along%20with%20new%20value&In-Reply-To=%3C696c2b06-6ca0-b0e6-5d5b-82a86703640c%40measurement-factory.com%3E"
       TITLE="[squid-users] note macro - %{policy_}note passes old values along with new value">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Dec 14 23:57:38 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019820.html">[squid-users] note macro - %{policy_}note passes old values along with new value
</A></li>
        <LI>Next message (by thread): <A HREF="019822.html">[squid-users] note macro - %{policy_}note passes old values along with new value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19821">[ date ]</a>
              <a href="thread.html#19821">[ thread ]</a>
              <a href="subject.html#19821">[ subject ]</a>
              <a href="author.html#19821">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/14/18 4:26 PM, Amish wrote:
&gt;<i> On 14/12/18 10:37 pm, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 12/14/18 9:26 AM, Amish wrote:
</I>
&gt;&gt;&gt;<i> How to pass only the latest value with note macro?
</I>
&gt;&gt;<i> With modern Squids, you should not do anything special to accomplish
</I>&gt;&gt;<i> that. Only the latest annotation value should be preserved. If that is
</I>&gt;&gt;<i> not happening in your tests, consider filing a bug report, especially if
</I>&gt;&gt;<i> you can reproduce with Squid v4+.
</I>
&gt;&gt;<i> <A HREF="https://github.com/squid-cache/squid/commit/457857fe7cf51037cd9e54e86c0985391d7ea594">https://github.com/squid-cache/squid/commit/457857fe7cf51037cd9e54e86c0985391d7ea594</A>
</I>
&gt;<i> I have not set any clt_conn_tag=TAG.
</I>&gt;<i> 
</I>&gt;<i> Does this feature of latest note value work only if I set clt_conn_tag=TAG?
</I>
No, the two are pretty much unrelated. The always-erase-the-old-value
fix (not really a feature!) in the above-referenced commit should apply
to all annotations, not just client connection annotations. IIRC, our
connection annotation work simply exposed the fact that we screwed up
with annotation updates earlier, and we fixed that bug in the same project.

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019820.html">[squid-users] note macro - %{policy_}note passes old values along with new value
</A></li>
	<LI>Next message (by thread): <A HREF="019822.html">[squid-users] note macro - %{policy_}note passes old values along with new value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19821">[ date ]</a>
              <a href="thread.html#19821">[ thread ]</a>
              <a href="subject.html#19821">[ subject ]</a>
              <a href="author.html#19821">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
