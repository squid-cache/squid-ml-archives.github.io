<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid4 with GnuTLS - specify ciphers or disable	protocols
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20with%20GnuTLS%20-%20specify%20ciphers%20or%20disable%0A%09protocols&In-Reply-To=%3CCADpL81ZCtgLMc6S%2BW-bpCGvZj2wA_dzZjQkQpJiDBRY1%3DwuCQA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019827.html">
   <LINK REL="Next"  HREF="019831.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid4 with GnuTLS - specify ciphers or disable	protocols</H1>
    <B>Martin Hoffmann</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid4%20with%20GnuTLS%20-%20specify%20ciphers%20or%20disable%0A%09protocols&In-Reply-To=%3CCADpL81ZCtgLMc6S%2BW-bpCGvZj2wA_dzZjQkQpJiDBRY1%3DwuCQA%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid4 with GnuTLS - specify ciphers or disable	protocols">m.hoffmann.bs at gmail.com
       </A><BR>
    <I>Tue Dec 18 14:44:40 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019827.html">[squid-users] Redirect youtube
</A></li>
        <LI>Next message (by thread): <A HREF="019831.html">[squid-users] Squid4 with GnuTLS - specify ciphers or disable protocols
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19828">[ date ]</a>
              <a href="thread.html#19828">[ thread ]</a>
              <a href="subject.html#19828">[ subject ]</a>
              <a href="author.html#19828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks that would be fine.
However meanwhile I have recompiled squid 4.4 with OpenSSL support
(added --enable-ssl
and --with-open-ssl=xxx  and removed --with-gnutls to debian/rules) just to
end with the same problems - I cannot seem to find how to disable certain
protocols or ciphers with squid 4.4.
With squid 3.3 / 3.5 it worked without problems with &quot;https_port ...
cipher=ALL:!xxx options=NO_TLSv1,....&quot;. However despite of the docs
&lt;<A HREF="http://www.squid-cache.org/Doc/config/http_port/">http://www.squid-cache.org/Doc/config/http_port/</A>&gt; saying these options
should still work Squid4.4 just exits with Error:

FATAL: Unknown https_port option 'cipher=
FATAL: Unknown https_port option 'options=

This seems to be the case regardless if I compile it with OpenSSL support
or GnuTLS Support or both. Btw. How does Squid &quot;know&quot; which library to
chose if it's compiled with both libraries?

So what exactly am I missing here? Is the docs simply wrong? Or outdated?
Which exact keyword should set the OpenSSL ciphers? Which one should set
the GnuTLS priority strings? Is it the same keyword with different values??

I have then experimented with e.g. *tls-options=NO_TLSv1* setting in
Squid4.4 with OpenSSL but without any luck:

FATAL: Unknown TLS option 'NO_TLSv1'

So please could anyone provide a proved working example for disabling TLS
v1 or any Cipher in Squid 4.4? Either OpenSSL or GnuTLS would suffice to
bring me back on the right track.

Thanks in advance,

Martin

Am Di., 18. Dez. 2018 um 07:46 Uhr schrieb Amos Jeffries &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:

&gt;<i> On 18/12/18 3:57 am, Martin Hoffmann wrote:
</I>&gt;<i> &gt; Sorry for my late response, but I have been very busy the last weeks.
</I>&gt;<i> &gt; So I could finally find the time to patch my Squid 4.4 with your Patch
</I>&gt;<i> &gt; <A HREF="https://github.com/squid-cache/squid/pull/330">https://github.com/squid-cache/squid/pull/330</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> No worries, similar situation here.
</I>&gt;<i>
</I>&gt;<i> &gt; However running patched squid with the following config still does
</I>&gt;<i> &gt; ignore all TLS specific settings (tls-options and tls-min-version):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; https_port 1.2.3.4:443 &lt;<A HREF="http://1.2.3.4:443">http://1.2.3.4:443</A>&gt; tls-cert=/path/cert.crt
</I>&gt;<i> &gt; tls-key=/path/cert.key tls-dh=/path/dhparams.pem tls-min-version=1.2
</I>&gt;<i> &gt; accel defaultsite=some.domain.de &lt;<A HREF="http://some.domain.de">http://some.domain.de</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; All attempts to disable certain ciphers or TLS version via
</I>&gt;<i> &gt; 'tls-options=SECURE128:+SECURE192:-VERS-ALL:+VERS-TLS1.2' also fails -
</I>&gt;<i> &gt; no change at all. It is as if squid totally ignores all GnuTLS specific
</I>&gt;<i> &gt; settings...? Is there still another bug regarding config?
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Just the unhelpful &quot;Hmm, thats odd&quot;. I intend to re-test all this in the
</I>&gt;<i> next month or so to be able to give a better indication of what to
</I>&gt;<i> expect working and see if any other regressions show up.
</I>&gt;<i>
</I>&gt;<i> Sorry,
</I>&gt;<i> Amos
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20181218/eb9c0cb0/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20181218/eb9c0cb0/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019827.html">[squid-users] Redirect youtube
</A></li>
	<LI>Next message (by thread): <A HREF="019831.html">[squid-users] Squid4 with GnuTLS - specify ciphers or disable protocols
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19828">[ date ]</a>
              <a href="thread.html#19828">[ thread ]</a>
              <a href="subject.html#19828">[ subject ]</a>
              <a href="author.html#19828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
