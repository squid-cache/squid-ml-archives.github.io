<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.4 security_file_certgen helpers crashing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.4%20security_file_certgen%20helpers%20crashing&In-Reply-To=%3C054e01d4a009%24b25546f0%2416ffd4d0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019866.html">
   <LINK REL="Next"  HREF="019867.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.4 security_file_certgen helpers crashing</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.4%20security_file_certgen%20helpers%20crashing&In-Reply-To=%3C054e01d4a009%24b25546f0%2416ffd4d0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] Squid 4.4 security_file_certgen helpers crashing">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Dec 30 06:34:20 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019866.html">[squid-users] Squid 4.4 security_file_certgen helpers crashing
</A></li>
        <LI>Next message (by thread): <A HREF="019867.html">[squid-users] Whitelisting youtube
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19874">[ date ]</a>
              <a href="thread.html#19874">[ thread ]</a>
              <a href="subject.html#19874">[ subject ]</a>
              <a href="author.html#19874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Alex,

I didn't had the time to sit and compose a STDINT/OUT input and output that can be used to test the security_file_certgen.
Can you or anyone of the related developers post in the wiki a simple &quot;example&quot; input that can be sent over STDIN to debug this type of issues?
I can just load the software as squid or proxy user but...
Another option is to point us towards the debug options that will give the testing admins(or me) an option to copy and paste the data that squid is sending to the helper.

Thanks,
Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Alex Rousskov
Sent: Friday, December 28, 2018 05:29
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid 4.4 security_file_certgen helpers crashing

On 12/27/18 2:30 PM, johnr wrote:

&gt;<i> I find the following in the cache log:
</I>
&gt;<i> 2018/12/27 21:15:40 kid1| WARNING:
</I>&gt;<i> /usr/local/squid/libexec/security_file_certgen -s
</I>&gt;<i> /usr/local/squid/var/cache/squid/ssl_db -M 4MB #Hlpr1 exited
</I>
We need to figure out why the helper is exiting. If there are no error
messages in cache.log, then your system log may have additional
information such as the process signal that killed the helper. If it was
a crash, then your core dump directory should have the corresponding
core dump (make sure you enable core dumps!) that you can examine with gdb.


&gt;<i> I ran the security_gen_helper under GDB and it seems to be crashing here:
</I>&gt;<i> <A HREF="https://github.com/squid-cache/squid/blob/master/src/ssl/gadgets.cc#L218">https://github.com/squid-cache/squid/blob/master/src/ssl/gadgets.cc#L218</A>
</I>
If you can reproduce helper crash while it has gdb attached, please post
the stack trace.


&gt;<i> I saw a commit supporting a newer version of openssl, I wonder if
</I>&gt;<i> that may have mistakenly broken support for older versions of
</I>&gt;<i> openssl?
</I>
Sure, it may have. Most likely, the changes are not tested in an
environment matching yours, and the bug may be environment-driven.


If you get more details such as a backtrace, please consider filing a
bug report with all the details.


Thank you,

Alex.
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019866.html">[squid-users] Squid 4.4 security_file_certgen helpers crashing
</A></li>
	<LI>Next message (by thread): <A HREF="019867.html">[squid-users] Whitelisting youtube
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19874">[ date ]</a>
              <a href="thread.html#19874">[ thread ]</a>
              <a href="subject.html#19874">[ subject ]</a>
              <a href="author.html#19874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
