<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to set up a reverse proxy using squid for a simplified scenario?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20set%20up%20a%20reverse%20proxy%20using%20squid%20for%20a%0A%20simplified%20scenario%3F&In-Reply-To=%3CCABrM6wnCwETo_0_TDX_eUAtvbkRUwsngiweMu_6UFSAbb_iCaw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017603.html">
   <LINK REL="Next"  HREF="017611.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to set up a reverse proxy using squid for a simplified scenario?</H1>
    <B>Peng Yu</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20set%20up%20a%20reverse%20proxy%20using%20squid%20for%20a%0A%20simplified%20scenario%3F&In-Reply-To=%3CCABrM6wnCwETo_0_TDX_eUAtvbkRUwsngiweMu_6UFSAbb_iCaw%40mail.gmail.com%3E"
       TITLE="[squid-users] How to set up a reverse proxy using squid for a simplified scenario?">pengyu.ut at gmail.com
       </A><BR>
    <I>Mon Feb 12 11:40:20 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017603.html">[squid-users] How to set up a reverse proxy using squid for a simplified scenario?
</A></li>
        <LI>Next message (by thread): <A HREF="017611.html">[squid-users] How to set up a reverse proxy using squid for a simplified scenario?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17605">[ date ]</a>
              <a href="thread.html#17605">[ thread ]</a>
              <a href="subject.html#17605">[ subject ]</a>
              <a href="author.html#17605">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It is still not difficult to completely comprehend the squid document
to see how to modify the example at derpturkey.com for my following
scenario.

I have a bunch of forward proxy servers whose IPs are ip1 and ip2,
..., ip_n (using port 3128). The reverse proxy will use the
round-robin policy to forward each incoming request to one of these
forward proxies.

Do you mind giving me a minimal working configuration for my scenario?
Working means that the configure must be used directly without
modification (except domain names or IP addresses). Minimal means that
anything not relevant to my scenario should not be included in the
configuration.

BTW, to make sure make sure my understanding of forward proxy is
correct, could you confirm whether the proxies here are forward
proxies?

<A HREF="https://free-proxy-list.net/">https://free-proxy-list.net/</A>

On Sat, Feb 10, 2018 at 12:09 PM, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:
&gt;<i> On 11/02/18 06:33, Peng Yu wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I see the following blog about setting up a reverse proxy using squid.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://derpturkey.com/squid-as-a-reverse-proxy/">http://derpturkey.com/squid-as-a-reverse-proxy/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But there seem to be more configurations than what I need.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For example, for the following line, I don't need to restrict the
</I>&gt;&gt;<i> access to a specific domain.
</I>&gt;&gt;<i> http_port 80 accel defaultsite=www.example.com
</I>&gt;<i>
</I>&gt;<i> The above does not *restrict*. It sets a default value for Squid to use
</I>&gt;<i> when the Host header is missing from HTTP requests.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Instead, any access to the IP of the reverse proxy should be OK. In
</I>&gt;&gt;<i> this sense, should I just use the following?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> http_port 80 accel
</I>&gt;<i>
</I>&gt;<i> You can if you want to. But be aware that any clients which omit the
</I>&gt;<i> Host header in their requests will be rejected by the proxy with an
</I>&gt;<i> error page.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, let's say I have two web servers server1 and server2 to be
</I>&gt;&gt;<i> proxied. Since I don't use a domain, I am not sure how Step 3 should
</I>&gt;&gt;<i> be adjusted.
</I>&gt;<i>
</I>&gt;<i> By using other types of ACLs in an arrangement which meets your desired
</I>&gt;<i> mapping.
</I>&gt;<i>
</I>&gt;<i> Please read the FAQ about how ACLs work. That includes a list of
</I>&gt;<i> different ACLs.
</I>&gt;<i> &lt;<A HREF="http://wiki.squid-cache.org/SquidFaq/SquidAcl">http://wiki.squid-cache.org/SquidFaq/SquidAcl</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So far as you have stated that would be &quot;cache_peer ... allow all&quot;.
</I>&gt;<i>
</I>&gt;<i> Which is a very bad idea...
</I>&gt;<i>
</I>&gt;<i> Be aware that the domain based config is itself a security layer to
</I>&gt;<i> prevent attackers and certain type of DoS reaching through the proxy to
</I>&gt;<i> attack the peers directly with bogus traffic. Using other types of ACLs,
</I>&gt;<i> particularly ones leading to &quot;no restriction&quot; like you describe make
</I>&gt;<i> your proxy and the origins all at risk for denial of service attacks.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> What is your reason for wanting &quot;no restrictions&quot;?
</I>&gt;<i>  it could be that you actually need something very different to what you
</I>&gt;<i> are asking about.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I also do not want any restrictions to my reverse proxy. But I am not
</I>&gt;&gt;<i> sure how Step 4 should be simplified.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Could anybody please let me know how to configure squid reverse proxy
</I>&gt;&gt;<i> in my simplified scenario?
</I>&gt;<i>
</I>&gt;<i> That tutorial is describing the simplest scenario possible with a
</I>&gt;<i> multiple peers in a reverse-proxy.
</I>&gt;<i>
</I>&gt;<i> Yours is actually the more complicated scenario since you apparently
</I>&gt;<i> need some unusual ACL configuration.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>


-- 
Regards,
Peng

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017603.html">[squid-users] How to set up a reverse proxy using squid for a simplified scenario?
</A></li>
	<LI>Next message (by thread): <A HREF="017611.html">[squid-users] How to set up a reverse proxy using squid for a simplified scenario?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17605">[ date ]</a>
              <a href="thread.html#17605">[ thread ]</a>
              <a href="subject.html#17605">[ subject ]</a>
              <a href="author.html#17605">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
