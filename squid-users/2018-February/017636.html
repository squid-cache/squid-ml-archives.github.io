<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid -k rec ,	seems has problem with ram leakage ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20-k%20rec%20%2C%0A%09seems%20has%20problem%20with%20ram%20leakage%20%3F&In-Reply-To=%3Ce40c23f9-777b-21bb-3182-7fd3e1f5d95f%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017635.html">
   <LINK REL="Next"  HREF="017638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid -k rec ,	seems has problem with ram leakage ?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20-k%20rec%20%2C%0A%09seems%20has%20problem%20with%20ram%20leakage%20%3F&In-Reply-To=%3Ce40c23f9-777b-21bb-3182-7fd3e1f5d95f%40treenet.co.nz%3E"
       TITLE="[squid-users] squid -k rec ,	seems has problem with ram leakage ?">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Feb 17 13:20:19 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017635.html">[squid-users] squid -k rec ,	seems has problem with ram leakage ?
</A></li>
        <LI>Next message (by thread): <A HREF="017638.html">[squid-users] squid -k rec ,	seems has problem with ram leakage ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17636">[ date ]</a>
              <a href="thread.html#17636">[ thread ]</a>
              <a href="subject.html#17636">[ subject ]</a>
              <a href="author.html#17636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/02/18 00:57, --Ahmad-- wrote:
&gt;<i> hi amos&#160;
</I>&gt;<i> 
</I>&gt;<i> i didnt use the version 3.5.22
</I>&gt;<i> 
</I>&gt;<i> &#160;but long time I&#8217;m using the 3.5.22 and its fine&#160;
</I>&gt;<i> 
</I>&gt;<i> the new thing is I&#8217;m using like 100 squid instances .
</I>&gt;<i> 
</I>&gt;<i> and &#160;hourly i have cron to change and update squid&#160;
</I>&gt;<i> 
</I>&gt;<i> so i just make rec option instead of having session drop .
</I>&gt;<i> 
</I>&gt;<i> i don&#8217;t have exact mount of statistics to tell you&#160;
</I>&gt;<i> 
</I>&gt;<i> but say i have 32 G ram&#160;
</I>&gt;<i> 
</I>&gt;<i> if i run 100 squid instances it take about 16 G ram .
</I>
So that is the amount before much traffic has happened.

When traffic goes through the proxy Squid gains data which uses more
memory for at least all the purposes listed at
&lt;<A HREF="https://wiki.squid-cache.org/SquidFaq/SquidMemory">https://wiki.squid-cache.org/SquidFaq/SquidMemory</A>&gt;.


&gt;<i> 
</I>&gt;<i> if i keep run the cron hourly by time say daily 12 times ( every 2 hours)&#160;
</I>&gt;<i> 
</I>&gt;<i> and after 1 week i go to server to see free ram using :
</I>&gt;<i> 
</I>&gt;<i> free -m command
</I>&gt;<i> 
</I>&gt;<i> i see the free ram be like 5 G free , while I&#8217;m supposed to see the free
</I>&gt;<i> as 16 G
</I>

+10GB for 100 instances means each is on average only using ~100 MB more
than you expected. This is also the net difference between when you
started the Squid and the peak traffic load within that whole week.

If you are not already graphing the memory usage I suggest you start
doing so and look at the graphs for patterns. They may show a different
story to what you (or I) are thinking is happening.


Also, Squid provides SNMP data for automated measurements if you want to
check the details rather than just the overall OS free measurement.

For example; comparing OID cacheMemUsage to cacheNumObjCount,
cacheClients and cacheCurrentFileDescrCnt shows roughly the relative
memory usage to each of the major dynamic memory consumers.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017635.html">[squid-users] squid -k rec ,	seems has problem with ram leakage ?
</A></li>
	<LI>Next message (by thread): <A HREF="017638.html">[squid-users] squid -k rec ,	seems has problem with ram leakage ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17636">[ date ]</a>
              <a href="thread.html#17636">[ thread ]</a>
              <a href="subject.html#17636">[ subject ]</a>
              <a href="author.html#17636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
