<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Kerberos negotiate slow avg service time
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Kerberos%20negotiate%20slow%20avg%20service%20time&In-Reply-To=%3Cbc2047b7-cd9a-37f0-7030-2fc607de19a3%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017708.html">
   <LINK REL="Next"  HREF="017719.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Kerberos negotiate slow avg service time</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Kerberos%20negotiate%20slow%20avg%20service%20time&In-Reply-To=%3Cbc2047b7-cd9a-37f0-7030-2fc607de19a3%40treenet.co.nz%3E"
       TITLE="[squid-users] Kerberos negotiate slow avg service time">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Feb 24 10:18:48 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017708.html">[squid-users] Kerberos negotiate slow avg service time
</A></li>
        <LI>Next message (by thread): <A HREF="017719.html">[squid-users] Kerberos negotiate slow avg service time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17710">[ date ]</a>
              <a href="thread.html#17710">[ thread ]</a>
              <a href="subject.html#17710">[ subject ]</a>
              <a href="author.html#17710">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 24/02/18 06:29, erdosain9 wrote:
&gt;<i> Hi to all.
</I>&gt;<i> I dont know why i have this bad values. My network is woking fine. How i can
</I>&gt;<i> do to fix this. I think is a high value.
</I>&gt;<i> 
</I>&gt;<i> HTTP/1.1 200 OK
</I>&gt;<i> Server: squid/3.5.27
</I>&gt;<i> Mime-Version: 1.0
</I>&gt;<i> Date: Fri, 23 Feb 2018 17:16:25 GMT
</I>&gt;<i> Content-Type: text/plain;charset=utf-8
</I>&gt;<i> Expires: Fri, 23 Feb 2018 17:16:25 GMT
</I>&gt;<i> Last-Modified: Fri, 23 Feb 2018 17:16:25 GMT
</I>&gt;<i> X-Cache: MISS from proxy.mydomain.lan
</I>&gt;<i> X-Cache-Lookup: MISS from proxy.mydomain.lan:3128
</I>&gt;<i> Via: 1.1 proxy.mydomain.lan (squid/3.5.27)
</I>&gt;<i> Connection: close
</I>&gt;<i> 
</I>&gt;<i> Negotiate Authenticator Statistics:
</I>&gt;<i> program: /lib64/squid/negotiate_kerberos_auth
</I>&gt;<i> number active: 50 of 50 (0 shutting down)
</I>&gt;<i> requests sent: 4106
</I>&gt;<i> replies received: 4105
</I>&gt;<i> queue length: 0
</I>&gt;<i> avg service time: 82 msec
</I>
The above &quot;avg service time&quot; is not bad for a system as complicated as
Kerberos. Note that this is significantly less than the outstanding
requests listed below in the report. That is a sign that a very large
number of the lookups are performed very, very fast.

In other words; what you see in the report is _only_ the odd ones that
do go slow enough to show up there. With maybe, at most, a few of the
faster ones that happened by chance to be partially done at the instant
the report was generated.


Be aware that it is normal for a helper which has not been used much to
require time to refresh its internal state in order to process a
request. Avoiding that problem is why you see the clear pattern of
#Requests going to one helper, with a second getting most of the
remainder and so on. Squid intentionally biases lookups towards the most
recently used/updated helper. Also, the longer delay times visible being
for the later helpers down the list is another side effect of that problem.


As Yuri cryptically asked, did this come to your attention due to
customer complaints? or just while observing the reports?
 if it is not causing observable issues to the clients I would not worry.

If you want to tune the helpers better than default, you can maybe
further reduce that state refresh by configuring the helper with
explicit details about what backed server to be contacting. A lot of the
delays are caused by sequences of DNS lookups and parsing + processing
the machine KeyTab files. The debug (-d) option of the helper itself can
assist you with identifying which of its internal processes is going
slowest. Just try not to drown in the flood of data from those very,
very fast ones.


&gt;<i> 
</I>&gt;<i>    ID #	     FD	    PID	 # Requests	  # Replies	 Flags	   Time	 Offset
</I>&gt;<i> Request
</I>&gt;<i>      21	     18	  57259	       1183	       1182	B R  	  0.293	      0	(none)
</I>&gt;<i>      22	     22	  57260	        652	        652	     	  0.164	      0	(none)
</I>...

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ###Kerberos Auth with ActiveDirectory###
</I>&gt;<i> auth_param negotiate program /lib64/squid/negotiate_kerberos_auth -s
</I>&gt;<i> HTTP/<A HREF="https://lists.squid-cache.org/listinfo/squid-users">proxy.empddh.lan at EMPDDH.LAN</A>
</I>&gt;<i> auth_param negotiate children 50 startup=0 idle=1
</I>&gt;<i> auth_param basic credentialsttl 2 hours
</I>&gt;<i> auth_param negotiate keep_alive on
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017708.html">[squid-users] Kerberos negotiate slow avg service time
</A></li>
	<LI>Next message (by thread): <A HREF="017719.html">[squid-users] Kerberos negotiate slow avg service time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17710">[ date ]</a>
              <a href="thread.html#17710">[ thread ]</a>
              <a href="subject.html#17710">[ subject ]</a>
              <a href="author.html#17710">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
