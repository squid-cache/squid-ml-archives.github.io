<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] help with the error TCP_MISS_ABORTED/000
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20help%20with%20the%20error%20TCP_MISS_ABORTED/000&In-Reply-To=%3Ce4446d00-7905-94c7-f7a8-0ca7b97400d3%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017721.html">
   <LINK REL="Next"  HREF="017731.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] help with the error TCP_MISS_ABORTED/000</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20help%20with%20the%20error%20TCP_MISS_ABORTED/000&In-Reply-To=%3Ce4446d00-7905-94c7-f7a8-0ca7b97400d3%40treenet.co.nz%3E"
       TITLE="[squid-users] help with the error TCP_MISS_ABORTED/000">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Feb 28 04:00:29 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017721.html">[squid-users] help with the error TCP_MISS_ABORTED/000
</A></li>
        <LI>Next message (by thread): <A HREF="017731.html">[squid-users] help with the error TCP_MISS_ABORTED/000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17722">[ date ]</a>
              <a href="thread.html#17722">[ thread ]</a>
              <a href="subject.html#17722">[ subject ]</a>
              <a href="author.html#17722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/02/18 15:12, L A Walsh wrote:
&gt;<i> Juan Manuel P wrote:
</I>&gt;&gt;<i> I am using Squid Cache: Version 3.5.12, but some pages give me the
</I>&gt;&gt;<i> next error:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1/Feb/2018:18:14:40 -0300 || - || 10.12.43.20 ||
</I>&gt;&gt;<i> TCP_MISS_ABORTED/000|| GET ||
</I>&gt;&gt;<i> <A HREF="http://www.rionegro.gov.ar/download/images/00033494.jpg">http://www.rionegro.gov.ar/download/images/00033494.jpg</A>
</I>&gt;&gt;<i> &lt;<A HREF="http://www.rionegro.gov.ar/download/images/00033494.jpg">http://www.rionegro.gov.ar/download/images/00033494.jpg</A>&gt; || -
</I>&gt;<i> ----
</I>&gt;<i> &#160;&#160; I don't know what causes it, but I see it frequently and have for a few
</I>&gt;<i> years.&#160; Currently am running 3.15.3.&#160; Was told it might be due to some
</I>
Er, which version exactly?

&gt;<i> cache corruption -- but having removed it several times over the past
</I>&gt;<i> few years, I sorta doubt that.&#160; Also, I'm attempting https interception,
</I>&gt;<i> now
</I>&gt;<i> but wasn't when I first encountered this message...
</I>
It can come from many reasons. One has to look at all the clues about
where the message came from, which (if any) server was involved, how
long it took, etc.

I could write a book on the things and ways it *might* happen. But
whether any of that is relevant or just hand-wavey ideas is anyones
guess at present.


&gt;<i>From what I know about it currently; corruption HTTP cache entries might
</I>be a side-effect, but very unlikely to be a cause of this.

Other types of caches used by Squid may be involved, eg the DNS cache
pointing Squid to a server IP that is not responding. But I don't recall
any instances of that data being corrupted, and the duration of the
transaction is far too short to have been some kind of timeout on the
server side of things (immediate TCP reject from invalid server IPs
shows up completely differently.)


* ABORTED almost always means the client[1] disconnected from the TCP
connection. That can happen for any number of reasons at the TCP, IP and
Ethernet layers which Squid is not party to.

... emphasis on &quot;almost&quot;. In the case of CONNECT messages and NTLM
Pinned connections the server can also trigger disconnect for both
endpoints.


* HTTPS introduces several additional possible causes. Primarily that
CONNECT message server abort just mentioned. But also if SSL-Bump is
being done, any TLS errors that result in &quot;terminate&quot; action will also
show up as aborts at the TCP and HTTP(S) layers. Squid logging of those
cases has been a bit buggy and there may be issues still yet to be found
there.
 That does not explain the pre-HTTPS occurances. But also due to the
vague nature of the abort reason those earlier aborts may be completely
different in cause from your current ones.


The &quot;/000&quot; status means no HTTP reply was received from a server. Abort
can also happen any time *after* a server response is received, but
those should be logged with their status codes not 000.
 - That may be because no server was even contacted. ie the client
disconnected immediately, or during the wait for server DNS records to
arrive, or for any other reason the client has.


SSL-Bump clouds the issue a lot because it will naturally time some
amount of time to do any of its checks and any server contact for server
cert details etc. Again the client can disconnect for any number of
reasons during all that, with the same ABORTED/000 end result.


So. Maybe bug, maybe not. &quot;insufficient data&quot;.


&gt;<i> 
</I>&gt;<i> &#160;&#160; Out of last 5000 requests in my squid log, I see 101 of the miss_aborted
</I>&gt;<i> statuses.&#160; I just wrote a note on stackexchange, then went to look for
</I>&gt;<i> something on amazon (this is output from a squid log compression tool
</I>&gt;<i> that was mostly for listing site, request time and size:&#160; A few lines
</I>&gt;<i> from no more than 15 minutes ago (usually shows time between requests, but
</I>&gt;<i> periodically, there's a full timestamp)...
</I>&gt;<i> 
</I>&gt;<i> &#160;&#160; Part of my shortening process removes the TCP_ before error messages,
</I>&gt;<i> thus my error is just &quot;MISS_ABORTED&quot;.
</I>&gt;<i> 
</I>&gt;<i> Since this is a grep of that shortened log, the time increments since
</I>&gt;<i> last message are not referring to line immediately above in the grep:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [0227_172940.00]&#160; 379ms; 0&#160;&#160;&#160; (0/0) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://qa.sockets.stackexchange.com/">https://qa.sockets.stackexchange.com/</A> - 198.252.206.25 -]
</I>&gt;<i> &#160;+0.38&#160;&#160; 372ms; 0&#160;&#160;&#160; (0/0) MISS_ABORTED/000 &lt;Athenae [GET&#160;
</I>&gt;<i> <A HREF="https://qa.sockets.stackexchange.com/">https://qa.sockets.stackexchange.com/</A> - 198.252.206.25 -]
</I>&gt;<i> &#160;+0.01&#160;&#160;&#160;&#160; 1ms; 0&#160;&#160;&#160; (0/0) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/61x0MG3xpeL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/61x0MG3xpeL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> &#160;+0.00&#160;&#160;&#160;&#160; 0ms; 0&#160;&#160;&#160; (-/-) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/813zL5eetaL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/813zL5eetaL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> &#160;+0.00&#160;&#160;&#160;&#160; 0ms; 0&#160;&#160;&#160; (-/-) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/61Uo2hXZlpL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/61Uo2hXZlpL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> &#160;+0.00&#160;&#160;&#160;&#160; 0ms; 0&#160;&#160;&#160; (-/-) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/71XggjYZ7qL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/71XggjYZ7qL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> &#160;+0.00&#160;&#160;&#160;&#160; 1ms; 0&#160;&#160;&#160; (-/0) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/71LT8PAs-OL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/71LT8PAs-OL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> &#160;+0.00&#160;&#160;&#160;&#160; 1ms; 0&#160;&#160;&#160; (-/0) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://images-na.ssl-images-amazon.com/images/I/51X+70QICxL._AC_UL160_SR160,160_.jpg">https://images-na.ssl-images-amazon.com/images/I/51X+70QICxL._AC_UL160_SR160,160_.jpg</A>
</I>&gt;<i> - 54.230.117.34 -]
</I>&gt;<i> [0227_173215.00]&#160;&#160; 16ms; 0&#160;&#160;&#160; (0/0) MISS_ABORTED/000 &lt;Athenae [GET
</I>&gt;<i> <A HREF="https://www.amazon.com/gp/uedata?ul&amp;v=0.200071.0&amp;id=TXSV6J9MMKFJ764232PB&amp;ctb=1&amp;m=1&amp;sc=TXSV6J9MMKFJ764232PB&amp;pc=3758697&amp;tc=-286&amp;hob=1&amp;hoe=3&amp;ul=3758697&amp;t=1519781535329&amp;csmtags=mouseHit&amp;pty=Detail&amp;spty=Glance&amp;pti=B079GH97R9&amp;tid=TXSV6J9MMKFJ764232PB&amp;aftb=1">https://www.amazon.com/gp/uedata?ul&amp;v=0.200071.0&amp;id=TXSV6J9MMKFJ764232PB&amp;ctb=1&amp;m=1&amp;sc=TXSV6J9MMKFJ764232PB&amp;pc=3758697&amp;tc=-286&amp;hob=1&amp;hoe=3&amp;ul=3758697&amp;t=1519781535329&amp;csmtags=mouseHit&amp;pty=Detail&amp;spty=Glance&amp;pti=B079GH97R9&amp;tid=TXSV6J9MMKFJ764232PB&amp;aftb=1</A>
</I>&gt;<i> - 23.192.244.68 -]
</I>&gt;<i> ====================================
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Of note -- a bunch were in trying to fetch a sockets address on
</I>&gt;<i> stackexchange, , while most of the amazon lines seem to be referring to
</I>&gt;<i> jpgs.&#160; Anyway, I too would be interested if you find the answer.
</I>
If anyone seeing these is up for some detective work I'm interested in
whether there is any kind of pattern for the real timing between those
lines, and between a failure and previous/next successful transaction to
the same server.
 Bonus points for getting the info with port numbers to see if there is
a pattern hidden in the client connection state.


While its nice to know the frequency is decreasing (IIRC first reporters
had unpleasantly large amounts, now to this ~2% of yours) that does not
really tell much of use for resolving it (or 'them' if multiple issues).


&gt;<i> 
</I>&gt;<i> Just thought I'd mention that your seeing the message isn't unique.
</I>&gt;<i> 
</I>&gt;<i> Found someone else who asked the same question back in May 2015...
</I>&gt;<i> 
</I>
Nod. It has been cropping up since the ABORTED log tag was first added,
and &quot;000&quot; status since long before that.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017721.html">[squid-users] help with the error TCP_MISS_ABORTED/000
</A></li>
	<LI>Next message (by thread): <A HREF="017731.html">[squid-users] help with the error TCP_MISS_ABORTED/000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17722">[ date ]</a>
              <a href="thread.html#17722">[ thread ]</a>
              <a href="subject.html#17722">[ subject ]</a>
              <a href="author.html#17722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
