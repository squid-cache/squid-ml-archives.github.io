<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Help with UA filtering in https connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%20with%20UA%20filtering%20in%20https%20connections&In-Reply-To=%3C20180103125233.GD504%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017288.html">
   <LINK REL="Next"  HREF="017300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Help with UA filtering in https connections</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%20with%20UA%20filtering%20in%20https%20connections&In-Reply-To=%3C20180103125233.GD504%40fantomas.sk%3E"
       TITLE="[squid-users] Help with UA filtering in https connections">uhlar at fantomas.sk
       </A><BR>
    <I>Wed Jan  3 12:52:33 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017288.html">[squid-users] Help with UA filtering in https connections
</A></li>
        <LI>Next message (by thread): <A HREF="017300.html">[squid-users] Help with UA filtering in https connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17297">[ date ]</a>
              <a href="thread.html#17297">[ thread ]</a>
              <a href="subject.html#17297">[ subject ]</a>
              <a href="author.html#17297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02.01.18 09:06, Alex Rousskov wrote:
&gt;<i>On 01/02/2018 07:08 AM, Matus UHLAR - fantomas wrote:
</I>&gt;&gt;<i> On 02.01.18 06:04, squidnoob wrote:
</I>&gt;&gt;&gt;<i> http_access allow CONNECT safe_ports
</I>&gt;&gt;&gt;<i> http_access deny CONNECT
</I>
&gt;&gt;<i> the two lines above unconditionally allow CONNECT anywhere,
</I>&gt;<i>
</I>&gt;<i>This is incorrect. The lines deny CONNECT to unsafe ports.
</I>
You miss something.

Those lines unconditionally allow CONNECT requests to safe ports ANYWHERE,
which is apparently not what was wanted/expected.

the first line ALLOWS all CONNECT requests to safe ports in the way they
CAN NOT BE DISABLED later.

the second line denies connect to unsafe ports.

the difference between lines above and the following one:

http_access deny CONNECT !safe_ports

is, that in this case you can deny the connect request later, unlike the
previous example, where the CONNECT was allowed and further checks are done.

However, what Amos proposed and what is in the default config is:

http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

which denies all access to unsafe ports, and denies CONNECT to non-SSL
ports, but does not allow access anywhere, so it must be allowed further.

-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
I wonder how much deeper the ocean would be without sponges. 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017288.html">[squid-users] Help with UA filtering in https connections
</A></li>
	<LI>Next message (by thread): <A HREF="017300.html">[squid-users] Help with UA filtering in https connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17297">[ date ]</a>
              <a href="thread.html#17297">[ thread ]</a>
              <a href="subject.html#17297">[ subject ]</a>
              <a href="author.html#17297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
