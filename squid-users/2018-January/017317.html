<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP out of memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20out%20of%20memory&In-Reply-To=%3C1042f27d-78e2-aa59-3fa7-804ded30ea13%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017314.html">
   <LINK REL="Next"  HREF="017319.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP out of memory</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20out%20of%20memory&In-Reply-To=%3C1042f27d-78e2-aa59-3fa7-804ded30ea13%40treenet.co.nz%3E"
       TITLE="[squid-users] TCP out of memory">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan  5 07:40:24 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017314.html">[squid-users] TCP out of memory
</A></li>
        <LI>Next message (by thread): <A HREF="017319.html">[squid-users] TCP out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17317">[ date ]</a>
              <a href="thread.html#17317">[ thread ]</a>
              <a href="subject.html#17317">[ subject ]</a>
              <a href="author.html#17317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/01/18 21:51, Vieri wrote:
&gt;<i> Hi again,
</I>&gt;<i> 
</I>&gt;<i> I haven't taken a look at Squid's source code, but I guess that when Squid communicates with a c-icap service it acts as a typical socket client, right?
</I>&gt;<i> eg. connect(), write(), read(), close()
</I>
Uh, Those are system calls for receiving TCP connections and data I/O.

Squid uses ICAP protocol to communicate with ICAP services. ICAP 
operates as a layer over TCP. So in a way yes, and in a way no.


&gt;<i> 
</I>&gt;<i> Does Squid consider forcing disconnection (close()) if the read() is &quot;too long&quot;?
</I>
If you mean &quot;too long&quot; in terms of memory size - there is no such thing 
in TCP. Squid provides a buffer and tells the kernel how much space is 
available there. The OS writes up to that much, no more, maybe less.

If your title &quot;TCP out of memory&quot; is an error you are seeing somewhere. 
That is entirely your system kernel and networking stacks issue. Squid 
has nothing to do with the internal memory management of TCP traffic.


&gt;<i> Is there such a timeout? Is it configurable in squid.conf (only for the c-icap connection)?
</I>&gt;<i> 
</I>
What timeout you speak of?

If you mean &quot;too long&quot; earlier in terms of duration to perform a read() 
- there is also no such thing. The OS tells Squid when data is ready and 
the data copy from OS memory to Squid buffer takes trivial amount of 
time to actually happen.


Timeouts can happen between different parts of the ICAP protocol waiting 
for I/O to happen for related message parts. But those have nothing to 
do with TCP memory unless you are suffering a bad case of buffer bloat 
in the network itself.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017314.html">[squid-users] TCP out of memory
</A></li>
	<LI>Next message (by thread): <A HREF="017319.html">[squid-users] TCP out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17317">[ date ]</a>
              <a href="thread.html#17317">[ thread ]</a>
              <a href="subject.html#17317">[ subject ]</a>
              <a href="author.html#17317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
