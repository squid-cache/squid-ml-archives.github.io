<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Behavior of Squid with SSL Bump and server persistent connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Behavior%20of%20Squid%20with%20SSL%20Bump%20and%20server%0A%20persistent%20connections&In-Reply-To=%3C7e2e6b3f-a642-307e-c53f-a59d3a32a877%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018575.html">
   <LINK REL="Next"  HREF="018600.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Behavior of Squid with SSL Bump and server persistent connections</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Behavior%20of%20Squid%20with%20SSL%20Bump%20and%20server%0A%20persistent%20connections&In-Reply-To=%3C7e2e6b3f-a642-307e-c53f-a59d3a32a877%40measurement-factory.com%3E"
       TITLE="[squid-users] Behavior of Squid with SSL Bump and server persistent connections">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Jul  2 23:57:54 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018575.html">[squid-users] Behavior of Squid with SSL Bump and server persistent	connections
</A></li>
        <LI>Next message (by thread): <A HREF="018600.html">[squid-users] Behavior of Squid with SSL Bump and server persistent connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18576">[ date ]</a>
              <a href="thread.html#18576">[ thread ]</a>
              <a href="subject.html#18576">[ subject ]</a>
              <a href="author.html#18576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/02/2018 05:34 PM, Vishali Somaskanthan wrote:

&gt;<i> I am trying out SSL Bump for my connections from Squid to server and
</I>&gt;<i> trying to put along server persistent connections as well. I would like
</I>&gt;<i> to know how squid behaves with both of these turned on??
</I>
In modern Squids, all(*) bumped SSL client HTTP requests (from client
connection C) should use the corresponding bumped connection to the
server (S). After the first HTTP request, if more requests arrive on
connection C, and they are all regular/basic requests, then they can all
go through connection S. Once HTTP rules, timeouts, or other factors
prohibit connection S or connection C reuse, Squid should close both
connections.

Please note that I do not know whether Squid correctly forces all(*)
HTTP requests on connection C to connection S, but it should. If it does
not, file a bug report. Same for closing connection C when connection S
becomes unusable.


&gt;<i> I see info in the squid wiki page that SSL Bump creates fake CONNECT
</I>&gt;<i> requests and Peeking at Step1 creates another CONNECT request. 
</I>
Peeking or staring may indeed produce internal fake CONNECT requests,
but they are unrelated to your question. They are used internally to
handle the client TLS connection and for giving adaptation services a
say in the matter. Persistency is an HTTP term that is applied to what
happens _after_ the TLS connections is bumped.

(Also, peeking is a part of the SslBump feature -- they are not two
different actions or stages as &quot;and&quot; in your summary implies).


HTH,

Alex.
P.S. (*) &quot;all&quot; should be interpreted as &quot;all that need a server
connection&quot; here -- pure cache hits, adaptation-satisfied requests, and
probably some erroneous requests (e.g., those blocked by http_access
rules?) do not use the server connection.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018575.html">[squid-users] Behavior of Squid with SSL Bump and server persistent	connections
</A></li>
	<LI>Next message (by thread): <A HREF="018600.html">[squid-users] Behavior of Squid with SSL Bump and server persistent connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18576">[ date ]</a>
              <a href="thread.html#18576">[ thread ]</a>
              <a href="subject.html#18576">[ subject ]</a>
              <a href="author.html#18576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
