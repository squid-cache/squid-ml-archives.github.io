<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Regression after upgrading 3.5.27 -&gt; 4.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Regression%20after%20upgrading%203.5.27%20-%3E%204.1&In-Reply-To=%3C411cc4b5-0ea3-9b5f-4864-3841f4db6d25%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018756.html">
   <LINK REL="Next"  HREF="018758.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Regression%20after%20upgrading%203.5.27%20-%3E%204.1&In-Reply-To=%3C411cc4b5-0ea3-9b5f-4864-3841f4db6d25%40treenet.co.nz%3E"
       TITLE="[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jul 23 00:59:55 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018756.html">[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1
</A></li>
        <LI>Next message (by thread): <A HREF="018758.html">[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18757">[ date ]</a>
              <a href="thread.html#18757">[ thread ]</a>
              <a href="subject.html#18757">[ subject ]</a>
              <a href="author.html#18757">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 23/07/18 01:29, Andrea Venturoli wrote:
&gt;<i> Hello.
</I>&gt;<i> 
</I>&gt;<i> I'm maintaining several installations on FreeBSD and I've been notified
</I>&gt;<i> a specific web application is not working anymore after the upgrade.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Accessing this app with FireFox and Squid 3.5.27, it works correctly.
</I>&gt;<i> 
</I>&gt;<i> Doing the same after the upgrade to 4.1 lets the user arrive up to a
</I>&gt;<i> point and then get a &quot;Loading&quot; message which will never go away.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Using FireFox network debugger, I see a couple of 400 error and in fact,
</I>&gt;<i> if I try to open those URL I get:
</I>&gt;<i> 
</I>&gt;&gt;<i> Invalid Request error was encountered while trying to process the
</I>&gt;&gt;<i> request:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Some possible problems are:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; Missing or unknown request method.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; Missing HTTP Identifier (HTTP/1.0).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; Request is too large.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; Content-Length missing for POST or PUT requests.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; Illegal character in hostname; underscores are not allowed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;&#160;&#160; HTTP/1.1 &quot;Expect:&quot; feature is being asked from an HTTP/1.0 software.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The above error is not quite informative (too broad)
</I>
There are a lot of things that can be wrong about requests sent. One of
them did. That list is not comprehensive either, just the things which
can be easily checked by users/admin without access to the proxy.

FYI: The template delivered has inline javascript for hiding the
messages that are irrelevant to this particular request. If you open the
URL in the browser (not debugging) it should reduce down to the ones
which are relevant.

You could also look at the debugger info abut the request message sent
and compare those values yourself.


&gt;<i> and there's nothing
</I>&gt;<i> useful in the logs.
</I>&gt;<i> 
</I>&gt;<i> Here are those two URL (which unfortunately I have to partially obfuscate):
</I>&gt;<i> 
</I>&gt;&gt;<i> <A HREF="http://xxxxxxxxxxx.xxxxxxxxxxx.xx/rest?method=navi_path.add&amp;opera=I029&amp;tipo=0&amp;descr=XXXXXXXXX%20-%20Xxxxxxx%20xxxxxxxxxxx%20xxx%2030/12/2014%20-%20XXXX&amp;xxxxx_xxxx=0&amp;params={idDoc:%27C0002019%27,clasDoc:%27XXXXXX%27,nomeDoc:%27XXXXXXXXX%20-%20Xxxxxxx%20xxxxxxxxxxx%20xxx%2030/12/2014%20-%20XXXX%27,_X_TRACK_ID:%xxxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx%27">http://xxxxxxxxxxx.xxxxxxxxxxx.xx/rest?method=navi_path.add&amp;opera=I029&amp;tipo=0&amp;descr=XXXXXXXXX%20-%20Xxxxxxx%20xxxxxxxxxxx%20xxx%2030/12/2014%20-%20XXXX&amp;xxxxx_xxxx=0&amp;params={idDoc:%27C0002019%27,clasDoc:%27XXXXXX%27,nomeDoc:%27XXXXXXXXX%20-%20Xxxxxxx%20xxxxxxxxxxx%20xxx%2030/12/2014%20-%20XXXX%27,_X_TRACK_ID:%xxxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx%27</A>}&amp;_ts=1532264445584&amp;_dc=1532264445584
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;&gt;<i> <A HREF="http://xxxxxxxxxxx.xxxxxxxxxxx.xx/php/ajax/openDocumentREST.php?core=xxxxxxxXXXX&amp;query={%22field%22:%22id%22,%22mode%22:%22EQUAL%22,%22value%22:%xxxxxxxxxx_XXXXXXXXX%22">http://xxxxxxxxxxx.xxxxxxxxxxx.xx/php/ajax/openDocumentREST.php?core=xxxxxxxXXXX&amp;query={%22field%22:%22id%22,%22mode%22:%22EQUAL%22,%22value%22:%xxxxxxxxxx_XXXXXXXXX%22</A>}&amp;nomeTab=&amp;arts=&amp;toHighlight=&amp;XXXXXXXX=I029
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> (the x and X are always alphanumeric characters).
</I>&gt;<i> 
</I>
That is not very helpful info. If anyone here is going to use it we need
the actual full URL to run tests on ourselves.


&gt;<i> 
</I>&gt;<i> I'm seeking help on how to better diagnose this: how can I find what
</I>&gt;<i> Squid 4 does not like in those URLs?
</I>&gt;<i> 
</I>
see above for initial things to check on.

For more details in cache.log configure:

 debug_options ALL,1 11,4 25,5, 33,5


This is best done on a test proxy where you don't have a flood of other
traffic happening in parallel.


&gt;<i> None of the above causes seems to apply, IMVHO.
</I>&gt;<i> 
</I>&gt;<i> Has some default changed from 3.5 to 4.1 which might trigger this problem?
</I>&gt;<i> 
</I>
There is increased HTTP compliance, checking and handling. The things
which are configurable are all listed in the release notes AFAIK.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018756.html">[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1
</A></li>
	<LI>Next message (by thread): <A HREF="018758.html">[squid-users] Regression after upgrading 3.5.27 -&gt; 4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18757">[ date ]</a>
              <a href="thread.html#18757">[ thread ]</a>
              <a href="subject.html#18757">[ subject ]</a>
              <a href="author.html#18757">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
