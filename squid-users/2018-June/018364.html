<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Question about traffic calculate
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20about%20traffic%20calculate&In-Reply-To=%3C4dd5dbf7-661a-3378-33be-a7a9da2912cf%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018362.html">
   <LINK REL="Next"  HREF="018376.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Question about traffic calculate</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20about%20traffic%20calculate&In-Reply-To=%3C4dd5dbf7-661a-3378-33be-a7a9da2912cf%40treenet.co.nz%3E"
       TITLE="[squid-users] Question about traffic calculate">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jun  5 03:25:30 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018362.html">[squid-users] Question about traffic calculate
</A></li>
        <LI>Next message (by thread): <A HREF="018376.html">[squid-users] Question about traffic calculate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18364">[ date ]</a>
              <a href="thread.html#18364">[ thread ]</a>
              <a href="subject.html#18364">[ subject ]</a>
              <a href="author.html#18364">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/06/18 11:34, Tiraen wrote:
&gt;<i> Good day.&#160;I apologize in advance if this has already been discussed, if
</I>&gt;<i> so - just give a link to the discussion
</I>&gt;<i> 
</I>&gt;<i> The proxy server has an interface for viewing current active sessions
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://{">http://{</A>}:{}/squid-internal-mgr/active_requests&#160;
</I>&gt;<i> 
</I>
Please be aware these are *not* &quot;sessions&quot;. These are transactions,
which  have one request, one response, and maybe some informational
messages.

A &quot;session&quot; as far as it relates to HTTP is a application level thing
which includes _multiple_ transactions, and possibly even multiple TCP
connections at the client end.


&gt;<i> or
</I>&gt;<i> 
</I>&gt;<i> cache_<A HREF="object://%s/active_requests">object://%s/active_requests</A>
</I>&gt;<i> 
</I>&gt;<i> There there is some set of parameters which allow to get the data on traffic
</I>&gt;<i> 
</I>&gt;<i> If the connection to the proxy goes directly and by http we see like this:
</I>&gt;<i> 
</I>&gt;<i> /Connection: 0x8050e0518/
</I>&gt;<i> /&#160; &#160; &#160; &#160; FD 29, read 4247, wrote 13479/
</I>&gt;<i> /&#160; &#160; &#160; &#160; FD desc: Reading next request/
</I>&gt;<i> /&#160; &#160; &#160; &#160; in: buf 0x8045a6fe0, used 0, free 39/
</I>&gt;<i> /&#160; &#160; &#160; &#160; remote: &#1061;&#1061;&#1061;&#1061;:50340/
</I>&gt;<i> /&#160; &#160; &#160; &#160; local: &#1061;&#1061;&#1061;&#1061;:8080/
</I>&gt;<i> /&#160; &#160; &#160; &#160; nrequests: 1/
</I>&gt;<i> /uri &#1061;&#1061;&#1061;:443/
</I>&gt;<i> /logType TCP_TUNNEL/
</I>&gt;<i> /out.offset 0, out.size 13440/
</I>&gt;<i> /req_sz 235/
</I>&gt;<i> /entry 0x0/N/A/
</I>&gt;<i> /start 1527608373.902584 (73.252258 seconds ago)/
</I>&gt;<i> /username -/
</I>&gt;<i> /delay_pool 0/
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> We have both traffic stat
</I>&gt;<i> 
</I>&gt;<i> /out.offset 0, out.size 13440/
</I>&gt;<i> /req_sz 235/
</I>&gt;<i> 
</I>
The latest transactions request was 235 bytes, its reply was 13440 bytes
(so far).


&gt;<i> But if there is a frontend in front of the SQUID (nghttpx for example
</I>&gt;<i> and https)&#160;
</I>&gt;<i> 
</I>&gt;<i> we have this
</I>&gt;<i> 
</I>&gt;<i> /Connection: 0x7f66a317ecf8/
</I>&gt;<i> /&#160; &#160; FD 222, read 9192, wrote 526/
</I>&gt;<i> /&#160; &#160; FD desc: Reading next request/
</I>&gt;<i> /&#160; &#160; in: buf 0x7f66a294fb90, used 0, free 39/
</I>&gt;<i> /&#160; &#160; remote: 127.0.0.1:2314 &lt;<A HREF="http://127.0.0.1:2314">http://127.0.0.1:2314</A>&gt;/
</I>&gt;<i> /&#160; &#160; local: 127.0.0.1:8081 &lt;<A HREF="http://127.0.0.1:8081">http://127.0.0.1:8081</A>&gt;/
</I>&gt;<i> /&#160; &#160; nrequests: 2/
</I>&gt;<i> /uri nererut.com:443 &lt;<A HREF="http://nererut.com:443">http://nererut.com:443</A>&gt;/
</I>&gt;<i> /logType TAG_NONE/
</I>&gt;<i> /out.offset 0, out.size 0/
</I>&gt;<i> /req_sz 334/
</I>&gt;<i> /entry (nil)/N/A/
</I>&gt;<i> /start 1527526715.189831 (81017.831772 seconds ago)/
</I>&gt;<i> /username 8355fcec-94fd-496c-94d1-a195a5ca7148/
</I>&gt;<i> /delay_pool 0
</I>&gt;<i> /
</I>&gt;<i> without out traffic
</I>&gt;<i> 
</I>&gt;<i> /out.offset 0, out.size 0/
</I>&gt;<i> /req_sz 334/
</I>
This transaction request was 334 bytes, its reply was 0 bytes (so far).


&gt;<i> 
</I>&gt;<i> I certainly did not test why it happens - due to https or proxy, but is
</I>&gt;<i> it possible to clarify this case?
</I>
The first transaction has reached the stage where a reply has started.

The second transaction has not yet reached that state despite 81017sec
having past.

That is all we can say without more information about things like for
example, which Squid version you are using, whether you are SSL-Bumping
the HTTPS traffic for either of those transactions, network topology on
the outgoing side of Squid, etc.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018362.html">[squid-users] Question about traffic calculate
</A></li>
	<LI>Next message (by thread): <A HREF="018376.html">[squid-users] Question about traffic calculate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18364">[ date ]</a>
              <a href="thread.html#18364">[ thread ]</a>
              <a href="subject.html#18364">[ subject ]</a>
              <a href="author.html#18364">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
