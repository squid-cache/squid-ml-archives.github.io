<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] host header forgery check in docker environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20host%20header%20forgery%20check%20in%20docker%20environment&In-Reply-To=%3C90baae2b-1856-3128-c39a-58126155d6b3%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018473.html">
   <LINK REL="Next"  HREF="018476.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] host header forgery check in docker environment</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20host%20header%20forgery%20check%20in%20docker%20environment&In-Reply-To=%3C90baae2b-1856-3128-c39a-58126155d6b3%40treenet.co.nz%3E"
       TITLE="[squid-users] host header forgery check in docker environment">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jun 18 07:43:19 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018473.html">[squid-users] host header forgery check in docker environment
</A></li>
        <LI>Next message (by thread): <A HREF="018476.html">[squid-users] Active Directory Authentication?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18474">[ date ]</a>
              <a href="thread.html#18474">[ thread ]</a>
              <a href="subject.html#18474">[ subject ]</a>
              <a href="author.html#18474">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/06/18 16:54, Kedar K wrote:
&gt;<i> Hi Amos,&#160;
</I>&gt;<i> Here is the topology:
</I>&gt;<i> 
</I>&gt;<i> client (curl from host running docker) --&gt; squid_child (docker, using
</I>&gt;<i> ssl-bump with intercept) --&gt; squid_parent (VM with internet connection,
</I>&gt;<i> https_port without ssl-bump) --&gt; origin server.
</I>
Consider where/how the child proxy is getting the origin servers' TLS
certificate details with which to forge a server certificate in the bump
action.


&gt;<i> 
</I>&gt;<i> local -&#160;72.19.0.2:443 &lt;<A HREF="http://72.19.0.2:443/">http://72.19.0.2:443/</A>&gt;&#160;is the container running
</I>&gt;<i> squid child
</I>&gt;<i> remote -&#160;remote=172.19.0.1:44522 &lt;<A HREF="http://172.19.0.1:44522/">http://172.19.0.1:44522/</A>&gt;&#160; is the host
</I>&gt;<i> machine where containers are running, I am using a curl to do initial
</I>&gt;<i> tests. Eventually, request would come from other containers or external
</I>&gt;<i> hosts on the docker daemon host.
</I>&gt;<i> 
</I>&gt;<i> With http traffic this works fine; wherein the request is forwarded to
</I>&gt;<i> Parent and then to origin server. However, with https header forgery
</I>&gt;<i> kicks in and tls is terminated.
</I>
Given that you are essentially void'ing what little security TLS
provides, there is no point in using it to secure any of these
connections. Just use curl (or squidclient) to send <A HREF="https://">https://</A> URLs in
plain text HTTP messages. It is just as (in)secure as your current setup
and works much more reliably.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018473.html">[squid-users] host header forgery check in docker environment
</A></li>
	<LI>Next message (by thread): <A HREF="018476.html">[squid-users] Active Directory Authentication?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18474">[ date ]</a>
              <a href="thread.html#18474">[ thread ]</a>
              <a href="subject.html#18474">[ subject ]</a>
              <a href="author.html#18474">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
