<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid callout sequence (Amos Jeffries)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20callout%20sequence%20%28Amos%20Jeffries%29&In-Reply-To=%3Cf985a899-7592-299d-ed2d-8e4df1092bdd%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018518.html">
   <LINK REL="Next"  HREF="018524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid callout sequence (Amos Jeffries)</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20callout%20sequence%20%28Amos%20Jeffries%29&In-Reply-To=%3Cf985a899-7592-299d-ed2d-8e4df1092bdd%40treenet.co.nz%3E"
       TITLE="[squid-users] squid callout sequence (Amos Jeffries)">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jun 25 03:24:26 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018518.html">[squid-users] squid callout sequence (Amos Jeffries)
</A></li>
        <LI>Next message (by thread): <A HREF="018524.html">[squid-users] Adobe CC behing Squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18519">[ date ]</a>
              <a href="thread.html#18519">[ thread ]</a>
              <a href="subject.html#18519">[ subject ]</a>
              <a href="author.html#18519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/06/18 14:59, Gordon Hsiao wrote:
&gt;<i>     &#160;On 25/06/18 05:15, Gordon Hsiao wrote:
</I>&gt;<i>     &gt; at <A HREF="https://wiki.squid-cache.org/SquidFaq/OrderIsImportant">https://wiki.squid-cache.org/SquidFaq/OrderIsImportant</A> I noticed
</I>&gt;<i>     &gt; redirectors are way ahead of ssl-bump in the callout order, in a
</I>&gt;<i>     &gt; https-ssl-bump case
</I>&gt;<i> 
</I>&gt;<i>     There is not really any &quot;https-ssl-bump&quot; case.
</I>&gt;<i> 
</I>&gt;<i>     There is SSL-Bump (decrypting a TLS stream - or not), and there is HTTPS
</I>&gt;<i>     (HTTP messages inside TLS).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt; you will need ssl-bump to run (so you can get full
</I>&gt;<i>     &gt; URL for example), then you can run redirector based on the result of
</I>&gt;<i>     &gt; ssl-bump, correct?
</I>&gt;<i> 
</I>&gt;<i>     No. SSL-Bump is an operation applied to a CONNECT message, when setting
</I>&gt;<i>     up the TLS tunnel. There are maybe also *multiple* CONNECT messages when
</I>&gt;<i>     SSL-Bump gets involved - which the FAQ text following that sequence
</I>&gt;<i>     describes.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     HTTP is stateless protocol. So the CONNECT message(s) are independent of
</I>&gt;<i>     both each other, and anything decrypted from inside the tunnel. Each and
</I>&gt;<i>     every message Squid handles gets its own cycle through the callout
</I>&gt;<i>     sequence.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt; why is redirector run before ssl-bump?
</I>&gt;<i> 
</I>&gt;<i>     Because Squid needs to know _where_ it is going before it can connect
</I>&gt;<i>     there. SSL-Bump is part of tunnel/connection setup.
</I>&gt;<i> 
</I>&gt;<i>     Amos
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> will SSL-Bump(not 'peek+splice', but the 'peek+bump' mode)&#160;decrypt all
</I>&gt;<i> the tcp packets? For example I connect to youtube.com/myvideo
</I>&gt;<i> &lt;<A HREF="http://youtube.com/myvideo">http://youtube.com/myvideo</A>&gt;, will peek+bump only decrypt the pseudo
</I>&gt;<i> CONNECT messages(I'm doing transparent proxy), or will it decrypt all
</I>&gt;<i> the video streams too? if it's the latter case the proxy will be cpu
</I>&gt;<i> intensive.
</I>
Sorry if I wasn't clear. The ssl_bump (directive and CONNECT handling)
part is the TLS handshake at the beginning of TLS connections. Once the
decrypt or splice is setup it just continues indefinitely. Whatever is
being decrypted from within that TLS is completely separate from the
bumping itself.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018518.html">[squid-users] squid callout sequence (Amos Jeffries)
</A></li>
	<LI>Next message (by thread): <A HREF="018524.html">[squid-users] Adobe CC behing Squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18519">[ date ]</a>
              <a href="thread.html#18519">[ thread ]</a>
              <a href="subject.html#18519">[ subject ]</a>
              <a href="author.html#18519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
