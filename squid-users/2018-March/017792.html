<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Exception with squid 3.5.25 in ICAP options path
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Exception%20with%20squid%203.5.25%20in%20ICAP%20options%20path&In-Reply-To=%3C802bb000-e886-f204-ac74-1f69a0714088%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017791.html">
   <LINK REL="Next"  HREF="017793.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Exception with squid 3.5.25 in ICAP options path</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Exception%20with%20squid%203.5.25%20in%20ICAP%20options%20path&In-Reply-To=%3C802bb000-e886-f204-ac74-1f69a0714088%40measurement-factory.com%3E"
       TITLE="[squid-users] Exception with squid 3.5.25 in ICAP options path">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Mar 13 04:32:06 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017791.html">[squid-users] Exception with squid 3.5.25 in ICAP options path
</A></li>
        <LI>Next message (by thread): <A HREF="017793.html">[squid-users] Settings for Bank &amp; Health
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17792">[ date ]</a>
              <a href="thread.html#17792">[ thread ]</a>
              <a href="subject.html#17792">[ subject ]</a>
              <a href="author.html#17792">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/12/2018 06:06 PM, Arunabha Saha wrote:
&gt;<i> Seeing a exception followed by termination fairly regularly with
</I>&gt;<i> Squid--&gt;Icap with this stacktrace on 3.5.25.&#160; &#160;
</I>
Disclaimer: The technical discussion below is more suited for squid-dev
or at least Bugzilla, not squid-users.

Please note that this exception is thrown from a destructor. If your
build environment enables C++11 (which is common these days), such
exceptions will kill Squid. Many of those exceptions were less harmful
before C++11. While well-written destructors should not have thrown even
before C++11, these deaths is one of a few seriously non-backward
compatible changes in C++11. We have only understood this a few months
ago, or I would have insisted on not enabling C++11 in v3, even
conditionally...

Modern Squids do a better job _reporting_ such deadly exceptions and a
couple of destructors have been fixed, but we have not gone through all
the relevant destructors to fix them because it takes time to analyze
and handle this properly (i.e., it is not a trivial
wrap-everything-and-forget change).


&gt;<i> Appreciate it if someone can comment on whether this is known and fixed
</I>&gt;<i> before i dig a little deeper.&#160; &#160;
</I>
FWIW, I do not recall any fixes in that area.

Alex.


&gt;<i> #0&#160; 0x00007ff944120428 in __GI_raise (sig=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sig at entry</A>=6) at
</I>&gt;<i> ../sysdeps/unix/sysv/linux/raise.c:54
</I>&gt;<i> #1&#160; 0x00007ff94412202a in __GI_abort () at abort.c:89
</I>&gt;<i> #2&#160; 0x00007ff944a670d5 in __gnu_cxx::__verbose_terminate_handler() ()
</I>&gt;<i> from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
</I>&gt;<i> #3&#160; 0x00007ff944a64cc6 in ?? () from
</I>&gt;<i> /usr/lib/x86_64-linux-gnu/libstdc++.so.6
</I>&gt;<i> #4&#160; 0x00007ff944a63bc9 in ?? () from
</I>&gt;<i> /usr/lib/x86_64-linux-gnu/libstdc++.so.6
</I>&gt;<i> #5&#160; 0x00007ff944a645b8 in __gxx_personality_v0 () from
</I>&gt;<i> /usr/lib/x86_64-linux-gnu/libstdc++.so.6
</I>&gt;<i> #6&#160; 0x00007ff9444c4f03 in ?? () from /lib/x86_64-linux-gnu/libgcc_s.so.1
</I>&gt;<i> #7&#160; 0x00007ff9444c5410 in _Unwind_RaiseException () from
</I>&gt;<i> /lib/x86_64-linux-gnu/libgcc_s.so.1
</I>&gt;<i> #8&#160; 0x00007ff944a64f47 in __cxa_throw () from
</I>&gt;<i> /usr/lib/x86_64-linux-gnu/libstdc++.so.6
</I>&gt;<i> #9&#160; 0x00000000006f3486 in Throw (message=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">message at entry</A>=0x8ae66e
</I>&gt;<i> &quot;!theOptionsFetcher&quot;, fileName=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">fileName at entry</A>=0x8ae647 &quot;ServiceRep.cc&quot;,
</I>&gt;<i> lineNo=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">lineNo at entry</A>=50,
</I>&gt;<i> &#160; &#160; id=149798962) at TextException.cc:93
</I>&gt;<i> #10 0x00000000008071f9 in Adaptation::Icap::ServiceRep::~ServiceRep
</I>&gt;<i> (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x1298b58, __in_chrg=&lt;optimized out&gt;,
</I>&gt;<i> __vtt_parm=&lt;optimized out&gt;)
</I>&gt;<i> &#160; &#160; at ServiceRep.cc:50
</I>&gt;<i> #11 0x00000000008073c9 in Adaptation::Icap::ServiceRep::~ServiceRep
</I>&gt;<i> (this=0x1298b58, __in_chrg=&lt;optimized out&gt;, __vtt_parm=&lt;optimized out&gt;)
</I>&gt;<i> at ServiceRep.cc:52
</I>&gt;<i> #12 0x000000000081d6c3 in RefCount&lt;Adaptation::Service&gt;::dereference
</I>&gt;<i> (newP=0x0, this=0x133ef88) at ../../../src/base/RefCount.h:79
</I>&gt;<i> #13 RefCount&lt;Adaptation::Service&gt;::~RefCount (this=0x133ef88,
</I>&gt;<i> __in_chrg=&lt;optimized out&gt;) at ../../../src/base/RefCount.h:35
</I>&gt;<i> #14 Adaptation::Icap::Launcher::~Launcher (this=0x133ef68,
</I>&gt;<i> __vtt_parm=0xb5e208 &lt;VTT for Adaptation::Icap::OptXactLauncher+8&gt;,
</I>&gt;<i> __in_chrg=&lt;optimized out&gt;)
</I>&gt;<i> &#160; &#160; at Launcher.cc:32
</I>&gt;<i> #15 0x0000000000830137 in
</I>&gt;<i> Adaptation::Icap::OptXactLauncher::~OptXactLauncher (this=0x133ef68,
</I>&gt;<i> __in_chrg=&lt;optimized out&gt;, __vtt_parm=&lt;optimized out&gt;)
</I>&gt;<i> &#160; &#160; at ../../../src/adaptation/icap/OptXact.h:55
</I>&gt;<i> #16 Adaptation::Icap::OptXactLauncher::~OptXactLauncher (this=0x133ef68,
</I>&gt;<i> __in_chrg=&lt;optimized out&gt;, __vtt_parm=&lt;optimized out&gt;)
</I>&gt;<i> &#160; &#160; at ../../../src/adaptation/icap/OptXact.h:55
</I>&gt;<i> #17 0x00000000006f0666 in AsyncJob::callEnd (this=0x133efa8) at
</I>&gt;<i> AsyncJob.cc:144
</I>&gt;<i> #18 0x00000000007f4732 in JobDialer&lt;Adaptation::Initiator&gt;::dial
</I>&gt;<i> (this=0x153f2f0, call=...) at ../../src/base/AsyncJobCalls.h:181
</I>&gt;<i> #19 0x00000000006ee331 in AsyncCall::make (this=0x153f2c0) at
</I>&gt;<i> AsyncCall.cc:40
</I>&gt;<i> #20 0x00000000006f26e5 in AsyncCallQueue::fireNext
</I>&gt;<i> (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0xdc2c60) at AsyncCallQueue.cc:56
</I>&gt;<i> #21 0x00000000006f2b09 in AsyncCallQueue::fire (this=0xdc2c60) at
</I>&gt;<i> AsyncCallQueue.cc:42
</I>&gt;<i> #22 0x000000000057def9 in EventLoop::dispatchCalls (this=0x7fffca605010)
</I>&gt;<i> at EventLoop.cc:143
</I>&gt;<i> #23 EventLoop::runOnce (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x7fffca605010) at EventLoop.cc:120
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017791.html">[squid-users] Exception with squid 3.5.25 in ICAP options path
</A></li>
	<LI>Next message (by thread): <A HREF="017793.html">[squid-users] Settings for Bank &amp; Health
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17792">[ date ]</a>
              <a href="thread.html#17792">[ thread ]</a>
              <a href="subject.html#17792">[ subject ]</a>
              <a href="author.html#17792">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
