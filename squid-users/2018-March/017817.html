<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ACL in custom error page
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20in%20custom%20error%20page&In-Reply-To=%3C004501d3bb5b%2491752d30%24b45f8790%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017816.html">
   <LINK REL="Next"  HREF="017818.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ACL in custom error page</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20in%20custom%20error%20page&In-Reply-To=%3C004501d3bb5b%2491752d30%24b45f8790%24%40ngtech.co.il%3E"
       TITLE="[squid-users] ACL in custom error page">eliezer at ngtech.co.il
       </A><BR>
    <I>Wed Mar 14 06:13:27 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017816.html">[squid-users] ACL in custom error page
</A></li>
        <LI>Next message (by thread): <A HREF="017818.html">[squid-users] Squid + SquidGuard : static block page not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17817">[ date ]</a>
              <a href="thread.html#17817">[ thread ]</a>
              <a href="subject.html#17817">[ subject ]</a>
              <a href="author.html#17817">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>And another one:
5) If you are using a deny_info configuration for a specific acl and you are redirecting to a url instead of squid inernal error page you can add some query term that will be used as a marker to the acl.

Example of usage:
acl blacklist-acl dstdomain block-test.org
deny_info <A HREF="http://&lt;SOME">http://&lt;SOME</A> SERVER NAME OR IP&gt;/block_page/?url=%u&amp;domain=%H&amp;acl= blacklist-acl blacklist-acl

acl localnet src 192.168.0.0/16

http_access deny ! blacklist-acl
http_access allow localnet

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Alex Rousskov
Sent: Wednesday, March 14, 2018 04:33
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] ACL in custom error page

On 03/13/2018 06:08 PM, Amos Jeffries wrote:
&gt;<i> On 14/03/18 05:46, Eduardo Carneiro wrote:
</I>&gt;&gt;<i> Hello everyone!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there any way to display, in my custom error pages, the acl that denied
</I>&gt;&gt;<i> access?
</I>&gt;<i> 
</I>&gt;<i> Two things:
</I>&gt;<i> 
</I>&gt;<i>  1) There is no single ACL that denied Access. There is always an entire
</I>&gt;<i> sequence of checks.
</I>&gt;<i> 
</I>&gt;<i> 2) The error page template code has not yet been updated to support
</I>&gt;<i> generic logformat codes which do have a code for the last ACL that was
</I>&gt;<i> tested (note that this may have been the one which _allowed logging_).
</I>
And two more:

3) We are working to support major logformat %codes in error pages. The
patches are going through internal review cycles right now.

4) In modern Squids, the best way to log access denial (and similar)
decisions is often via ACL-triggered annotations (rather than the old
&quot;the last ACL touched by somebody&quot; hack). See annotate_transaction in
squid.conf.documented. The corresponding %note logformat code should be
available in error page templates as the result of (3).


Cheers,

Alex.
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017816.html">[squid-users] ACL in custom error page
</A></li>
	<LI>Next message (by thread): <A HREF="017818.html">[squid-users] Squid + SquidGuard : static block page not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17817">[ date ]</a>
              <a href="thread.html#17817">[ thread ]</a>
              <a href="subject.html#17817">[ subject ]</a>
              <a href="author.html#17817">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
