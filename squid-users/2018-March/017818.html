<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid + SquidGuard : static block page not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20SquidGuard%20%3A%20static%20block%20page%20not%20working&In-Reply-To=%3C62856b3f-83e3-cb44-6b79-9c21ff202ab8%40microlinux.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017817.html">
   <LINK REL="Next"  HREF="017819.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid + SquidGuard : static block page not working</H1>
    <B>Nicolas Kovacs</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20SquidGuard%20%3A%20static%20block%20page%20not%20working&In-Reply-To=%3C62856b3f-83e3-cb44-6b79-9c21ff202ab8%40microlinux.fr%3E"
       TITLE="[squid-users] Squid + SquidGuard : static block page not working">info at microlinux.fr
       </A><BR>
    <I>Wed Mar 14 12:07:23 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017817.html">[squid-users] ACL in custom error page
</A></li>
        <LI>Next message (by thread): <A HREF="017819.html">[squid-users] Squid + SquidGuard : static block page not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17818">[ date ]</a>
              <a href="thread.html#17818">[ thread ]</a>
              <a href="subject.html#17818">[ subject ]</a>
              <a href="author.html#17818">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've been working with Squid + SquidGuard for a few years, though only
on Slackware. I'm currently transferring my proxy expertise to CentOS 7,
and right now I'm having a little problem with that.

Squid works perfectly so far as a transparent HTTP + HTTPS cache proxy.

The next step is to add SquidGuard, so I installed it and edited the
most basic /etc/squid/squidGuard.conf file possible.

In this setup, my workstation (192.168.2.2) is allowed to access
anything on the Web, and all other client machines on the networks are
blocked and should be redirected to the avertissement.html block page
for every request.

--8&lt;------------------------------------------------------------------
# /etc/squid/squidGuard.conf
dbhome /var/squidGuard
logdir /var/log/squidGuard

src admin {
  ip 192.168.2.2
}

acl {
  admin {
    pass any
  }
  default {
    pass none
    redirect <A HREF="http://nestor.microlinux.lan/avertissement.html">http://nestor.microlinux.lan/avertissement.html</A>
  }
}
--8&lt;------------------------------------------------------------------

I appended the following lines to /etc/squid/squid.conf:

--8&lt;------------------------------------------------------------------
# SquidGuard
url_rewrite_program /usr/bin/squidGuard -c /etc/squid/squidGuard.conf
url_rewrite_children 5
--8&lt;------------------------------------------------------------------

Now this setup sort of works. My workstation can access anything, other
clients are blocked. Unfortunately, the block page avertissement.html is
not displayed. Instead, I get a Squid error page:

  The following error was encountered while trying to retrieve the URL:
  <A HREF="https://http/*">https://http/*</A>

  Unable to determine IP address from host name &quot;http&quot;.

Any idea why my static block page avertissement.html is not displayed?

Cheers,

Niki
-- 
Microlinux - Solutions informatiques durables
7, place de l'&#233;glise - 30730 Montpezat
Site : <A HREF="https://www.microlinux.fr">https://www.microlinux.fr</A>
Blog : <A HREF="https://blog.microlinux.fr">https://blog.microlinux.fr</A>
Mail : <A HREF="https://lists.squid-cache.org/listinfo/squid-users">info at microlinux.fr</A>
T&#233;l. : 04 66 63 10 32

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017817.html">[squid-users] ACL in custom error page
</A></li>
	<LI>Next message (by thread): <A HREF="017819.html">[squid-users] Squid + SquidGuard : static block page not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17818">[ date ]</a>
              <a href="thread.html#17818">[ thread ]</a>
              <a href="subject.html#17818">[ subject ]</a>
              <a href="author.html#17818">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
