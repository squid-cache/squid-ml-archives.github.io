<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Volume quota management availablity
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Volume%20quota%20management%20availablity&In-Reply-To=%3C59ef9114-ea35-7225-8470-7761a7ed7eda%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017867.html">
   <LINK REL="Next"  HREF="017876.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Volume quota management availablity</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Volume%20quota%20management%20availablity&In-Reply-To=%3C59ef9114-ea35-7225-8470-7761a7ed7eda%40treenet.co.nz%3E"
       TITLE="[squid-users] Volume quota management availablity">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Mar 20 14:25:16 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017867.html">[squid-users] Volume quota management availablity
</A></li>
        <LI>Next message (by thread): <A HREF="017876.html">[squid-users] Volume quota management availablity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17875">[ date ]</a>
              <a href="thread.html#17875">[ thread ]</a>
              <a href="subject.html#17875">[ subject ]</a>
              <a href="author.html#17875">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/03/18 23:03, Anoop Sreedharan wrote:
&gt;<i> Dear Team,
</I>&gt;<i> We have an IT environment catering to educational institute wherein we
</I>&gt;<i> have approx more than 1000 users accessing the internet.
</I>&gt;<i> 
</I>&gt;<i> having a volume based internet subscription, we are in need to have a
</I>&gt;<i> solution wherein i need to restrict users to a certain volume of quota
</I>&gt;<i> per month and upon crossing that threshold, need to either stop their
</I>&gt;<i> access or throttle their bandwidth speed.
</I>&gt;<i> 
</I>&gt;<i> following is the scenario. having an internet link of 50Mbps in my campus
</I>&gt;<i> 
</I>&gt;<i> 1. users have to be authenticated via Active Directory&#160; -- i.e. users in
</I>&gt;<i> a certain AD group should only get access to internet
</I>&gt;<i> 2. should be able to define a volume threshold ( e.g 100GB per group/per
</I>&gt;<i> user)
</I>&gt;<i> 3. upon exhaustion of the volume the user bandwidth should b throttled
</I>&gt;<i> to, say, 256Kbps. OR block internet access to that user completely.
</I>&gt;<i> 4. this volume calculation should be done for both HTTP and HTTPS based
</I>&gt;<i> session.
</I>&gt;<i> 5. should be able to generate a monthly report showcasing the volume
</I>&gt;<i> consumed by specific user during a specific time-frame by showing the
</I>&gt;<i> spread of the volume distributed within websites visited/downloaded from.
</I>&gt;<i> &#160;
</I>&gt;<i> Kindly help to suggest this could be possible with Squid.&#160;
</I>&gt;<i> I am open to using some log analytics mechanism like sarg or anything
</I>&gt;<i> similar for reporting.
</I>
Quota is not a concept easily applied to HTTP messaging since it is a
stateless protocol and operates in terms of entire messages - not
packets or bytes. As such there is intentionally no mechanism to
maintain statefulness between transactions for quota controls to use in
Squid.

There is also a rather lot of traffic details outside of HTTP an unknown
to Squid which greatly affect the relationship between what Squid sees
as bandwidth and what actually occurs &quot;on wire&quot;. That all makes the OS
networking stack a much better place to do such management.

Most OS these days provide very capable tools for QoS bandwidth
management. Squid provides configuration features to integrate with
those, delivering packet TOS markings per-transaction or per-message for
the machines OS systems to utilize in their QoS flow identification and
accounting.



Log analysis (eg SARG) and helpers are other possibilities that worked
in the past ...

 BUT these methods have always suffered from the problem of only
accounting for traffic usage at the end of a completed HTTP transaction
and authorizing users only at the beginning. The difference can see
large amounts of over-usage and CONNECT tunnels are the worst-case
scenario there as they may last for days/weeks with &quot;infinite&quot; amount of
traffic usage meanwhile.

 Added to those problems we now face most traffic being HTTPS ... which
goes through proxies via CONNECT tunnels. So much for those ways of
doing quotas.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017867.html">[squid-users] Volume quota management availablity
</A></li>
	<LI>Next message (by thread): <A HREF="017876.html">[squid-users] Volume quota management availablity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17875">[ date ]</a>
              <a href="thread.html#17875">[ thread ]</a>
              <a href="subject.html#17875">[ subject ]</a>
              <a href="author.html#17875">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
