<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Possible Bug? &quot;parameters()&quot; syntax in acl dstdomain results in rule not working?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Possible%20Bug%3F%20%22parameters%28%29%22%20syntax%20in%20acl%0A%20dstdomain%20results%20in%20rule%20not%20working%3F&In-Reply-To=%3C53fb3c86-f0a5-03ae-5b87-2594bd4f1f57%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017898.html">
   <LINK REL="Next"  HREF="017900.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Possible Bug? &quot;parameters()&quot; syntax in acl dstdomain results in rule not working?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Possible%20Bug%3F%20%22parameters%28%29%22%20syntax%20in%20acl%0A%20dstdomain%20results%20in%20rule%20not%20working%3F&In-Reply-To=%3C53fb3c86-f0a5-03ae-5b87-2594bd4f1f57%40measurement-factory.com%3E"
       TITLE="[squid-users] Possible Bug? &quot;parameters()&quot; syntax in acl dstdomain results in rule not working?">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Mar 21 18:07:31 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="017898.html">[squid-users] Possible Bug? &quot;parameters()&quot; syntax in acl dstdomain	results in rule not working?
</A></li>
        <LI>Next message (by thread): <A HREF="017900.html">[squid-users] unsubscribe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17899">[ date ]</a>
              <a href="thread.html#17899">[ thread ]</a>
              <a href="subject.html#17899">[ subject ]</a>
              <a href="author.html#17899">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/21/2018 11:45 AM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">paul at thepottshouse.org</A> wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am running squid 3.5.23 on Debian 9. My goal was to try to set up a
</I>&gt;<i> simple proxy server for whitelisting.
</I>&gt;<i> 
</I>&gt;<i> It's working now, but I had some difficulty. In the release notes I came
</I>&gt;<i> across this example:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Versions/v3/3.5/squid-3.5.23-RELEASENOTES.html#s3">http://www.squid-cache.org/Versions/v3/3.5/squid-3.5.23-RELEASENOTES.html#s3</A>
</I>&gt;<i> 
</I>&gt;<i> It shows specifying a whitelist like so:
</I>&gt;<i> 
</I>&gt;<i> acl whitelist dstdomain parameters(&quot;/etc/squid/whitelist.txt&quot;)
</I>&gt;<i> 
</I>&gt;<i> So I tried this, and spent quite some time trying to figure out why it
</I>&gt;<i> didn't work. I got no errors, but this rule seemed to cause rejection of
</I>&gt;<i> all destination domains.
</I>&gt;<i> 
</I>&gt;<i> I finally realized there appeared to be something wrong with the
</I>&gt;<i> &quot;parameters&quot; handling of the external file, and turned it into:
</I>&gt;<i> 
</I>&gt;<i> acl WHITELIST dstdomain &quot;/etc/squid/whitelist.txt&quot;
</I>&gt;<i> 
</I>&gt;<i> With that one change it worked properly.
</I>&gt;<i> 
</I>&gt;<i> Is this a known bug?
</I>
IIRC, to use parameters(), you need to turn
configuration_includes_quoted_values on:

<A HREF="http://www.squid-cache.org/Doc/config/configuration_includes_quoted_values/">http://www.squid-cache.org/Doc/config/configuration_includes_quoted_values/</A>

Unfortunately, it is extremely difficult to upgrade squid.conf syntax
from the current ad hoc mess to something that can be easily validated,
extended, and improved. That directive was an attempt to solve one of
the major existing syntax problems (handling of spaces in directive
parameters), but we could not enable it by default because it could
cause difficult-to-detect problems in existing configurations. There
were also some regex-related problems IIRC.

AFAIK, nobody is working on improving this further. Rejecting or warning
about &quot;parameters(&quot; when configuration_includes_quoted_values is off
would be one of those improvements.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="017898.html">[squid-users] Possible Bug? &quot;parameters()&quot; syntax in acl dstdomain	results in rule not working?
</A></li>
	<LI>Next message (by thread): <A HREF="017900.html">[squid-users] unsubscribe
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17899">[ date ]</a>
              <a href="thread.html#17899">[ thread ]</a>
              <a href="subject.html#17899">[ subject ]</a>
              <a href="author.html#17899">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
