<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid logging to UDP logs multiple lines at the same	time
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20logging%20to%20UDP%20logs%20multiple%20lines%20at%20the%20same%0A%09time&In-Reply-To=%3C584668471.20243.1525423497004.JavaMail.zimbra%40pson.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018185.html">
   <LINK REL="Next"  HREF="018197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid logging to UDP logs multiple lines at the same	time</H1>
    <B>Matt Pson</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20logging%20to%20UDP%20logs%20multiple%20lines%20at%20the%20same%0A%09time&In-Reply-To=%3C584668471.20243.1525423497004.JavaMail.zimbra%40pson.org%3E"
       TITLE="[squid-users] Squid logging to UDP logs multiple lines at the same	time">squid at pson.org
       </A><BR>
    <I>Fri May  4 08:44:57 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018185.html">[squid-users] Squid 4 %R in deny_info
</A></li>
        <LI>Next message (by thread): <A HREF="018197.html">[squid-users] Squid logging to UDP logs multiple lines at the same time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18196">[ date ]</a>
              <a href="thread.html#18196">[ thread ]</a>
              <a href="subject.html#18196">[ subject ]</a>
              <a href="author.html#18196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
I have set up several Squid servers running 3.5.27 on Ubuntu 16.04 LTS (behind keepalived and haproxy to create a ha/load balanced setup) and having are some problems with logging. In order to have a single logfile I decided to send the log directly using UDP to a separate server running rsyslogd. 

Each Squid is configured with:

access_log     <A HREF="udp://squid-logserver.domain.com:10514">udp://squid-logserver.domain.com:10514</A>

The rsyslogd server is configured with:

Module (load=&quot;imudp&quot;)
# rsyslog Input Modules
input(type=&quot;imudp&quot; port=&quot;10514&quot; ruleset=&quot;Squid&quot;)
# Squid RulesSet
# make all squid input from the frontends end up here
ruleset(name=&quot;Squid&quot;) {
        action(type=&quot;omfile&quot;
                file=&quot;/var/log/squid/access.log&quot;)
        }

This works quite well and logs are sent to the server which receives them and puts them in the log file as expected. But the logs are not sent line by line but instead multiple lines at the same time (the size is approx. a UDP packet of lines, ~1300 bytes) which makes the log file quite messed up.

What am I missing here? 
I want my log to be readable ;)

/Matt Pson

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018185.html">[squid-users] Squid 4 %R in deny_info
</A></li>
	<LI>Next message (by thread): <A HREF="018197.html">[squid-users] Squid logging to UDP logs multiple lines at the same time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18196">[ date ]</a>
              <a href="thread.html#18196">[ thread ]</a>
              <a href="subject.html#18196">[ subject ]</a>
              <a href="author.html#18196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
