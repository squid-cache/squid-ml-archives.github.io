<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Collecting squid logs to DB
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Collecting%20squid%20logs%20to%20DB&In-Reply-To=%3CCABMULt%2B%2BCYhn7%2BSLKaDi6vuisBZkNXPbSw5LHY8oxu_ApmWOWw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018239.html">
   <LINK REL="Next"  HREF="018242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Collecting squid logs to DB</H1>
    <B>Alex K</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Collecting%20squid%20logs%20to%20DB&In-Reply-To=%3CCABMULt%2B%2BCYhn7%2BSLKaDi6vuisBZkNXPbSw5LHY8oxu_ApmWOWw%40mail.gmail.com%3E"
       TITLE="[squid-users] Collecting squid logs to DB">rightkicktech at gmail.com
       </A><BR>
    <I>Sat May 12 22:55:47 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018239.html">[squid-users] Collecting squid logs to DB
</A></li>
        <LI>Next message (by thread): <A HREF="018242.html">[squid-users] Collecting squid logs to DB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18240">[ date ]</a>
              <a href="thread.html#18240">[ thread ]</a>
              <a href="subject.html#18240">[ subject ]</a>
              <a href="author.html#18240">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>+++ Including list +++

Hi Eliezer,

I have used the following lines to instruct squid to log at mariadb:

logfile_daemon /usr/lib/squid/log_db_daemon
access_log daemon:/127.0.0.1/squid_log/access_log/squid/squid squid

Through testing it seems that sometimes squid is not logging anything. I
don't know why. After a restart it seems to unblock and write to DB.
The access_log table is currently InnoDB and I am wondering if MyISAM will
behave better.

I would prefer if I could have real time access log. My scenario is that
when a user disconnects from squid, an aggregated report of the sites that
the user browsed will be available under some web portal where the user has
access. Usually there will be up to 20 users connected concurrently so I
have to check if this approach is scalable. If this approach is not stable
then I might go with log parsing (perhaps logstash or some custom parser)
which will parse and generate an aggregated report once per hour or day.

Is there a way I format the log and pipe to DB only some interesting fields
in order to lessen the stress to DB?


On Sun, May 13, 2018 at 1:25 AM, Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>&gt;
wrote:

&gt;<i> Hey Alex,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> How did you used to log into the DB? What configuration lines have you
</I>&gt;<i> used?
</I>&gt;<i>
</I>&gt;<i> Also what log format have you used?
</I>&gt;<i>
</I>&gt;<i> Is it important to have realtime data in the DB or a periodic parsing is
</I>&gt;<i> also an option?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----
</I>&gt;<i>
</I>&gt;<i> Eliezer Croitoru
</I>&gt;<i> Linux System Administrator
</I>&gt;<i> Mobile: +972-5-28704261
</I>&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; *On
</I>&gt;<i> Behalf Of *Alex K
</I>&gt;<i> *Sent:* Saturday, May 5, 2018 01:20
</I>&gt;<i> *To:* <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> *Subject:* [squid-users] Collecting squid logs to DB
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I had a previous setup on Debian 7 with squid and I was using mysar to
</I>&gt;<i> collect squid logs and store them to DB and provide some browsing report at
</I>&gt;<i> the end of the day.
</I>&gt;<i>
</I>&gt;<i> Now at Debian 9, trying to upgrade the whole setup, I see that mysar does
</I>&gt;<i> not compile.
</I>&gt;<i>
</I>&gt;<i> Checking around I found mysar-ng but this has compilation issues on Debian
</I>&gt;<i> 9 also.
</I>&gt;<i>
</I>&gt;<i> Do you suggest any tool that does this job? Does squid support logging to
</I>&gt;<i> DB natively? (I am using mysql/mariadb)
</I>&gt;<i>
</I>&gt;<i> Some other tool I stumbled on is <A HREF="https://github.com/paranormal/blooper.">https://github.com/paranormal/blooper.</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanx a bunch,
</I>&gt;<i>
</I>&gt;<i> Alex
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20180513/4e08301a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20180513/4e08301a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018239.html">[squid-users] Collecting squid logs to DB
</A></li>
	<LI>Next message (by thread): <A HREF="018242.html">[squid-users] Collecting squid logs to DB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18240">[ date ]</a>
              <a href="thread.html#18240">[ thread ]</a>
              <a href="subject.html#18240">[ subject ]</a>
              <a href="author.html#18240">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
