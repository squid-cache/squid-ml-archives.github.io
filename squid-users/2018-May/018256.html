<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] restarting dead worker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20restarting%20dead%20worker&In-Reply-To=%3C491cede9-a8e9-bca6-24f9-53d01357ddda%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018255.html">
   <LINK REL="Next"  HREF="018263.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] restarting dead worker</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20restarting%20dead%20worker&In-Reply-To=%3C491cede9-a8e9-bca6-24f9-53d01357ddda%40treenet.co.nz%3E"
       TITLE="[squid-users] restarting dead worker">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon May 14 00:47:22 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018255.html">[squid-users] restarting dead worker
</A></li>
        <LI>Next message (by thread): <A HREF="018263.html">[squid-users] SECURITY ALERT: Host header forgery detected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18256">[ date ]</a>
              <a href="thread.html#18256">[ thread ]</a>
              <a href="subject.html#18256">[ subject ]</a>
              <a href="author.html#18256">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/05/18 09:47, senor wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> I had to change a monitor script to use squidclient ping instead of 
</I>&gt;<i> 'squid -k check' because the check would succeed even if all workers had 
</I>&gt;<i> died except for the coordinator and disker. Obviously, the real problem 
</I>&gt;<i> is that the workers are dying but what I'm looking for ATM is a way to 
</I>&gt;<i> restart individual workers. It seems a complete restart is necessary 
</I>&gt;<i> once the coordinator gives up after a few attempts. I'd like to trigger 
</I>&gt;<i> the coordinator to retry or something similar. Anything possible?
</I>
As you said; the coordinator already did retry many times before it gave
up. That is pretty clear evidence that coordinator retrying is not working.


&gt;<i> 
</I>&gt;<i> Bonus question: Where, if anywhere, is the cache manager use of &quot;kid=N&quot; 
</I>&gt;<i> documented? I haven't gone to the source code yet and would like not to.
</I>
Cache manager is a REST web API. So parameters like that are passed as
query-string in the URLs. Support for parameters is report-specific and
most of the reports are undocumented. It is mentioned in the SMP pages
somewhere IIRC, but only as a mention that it exists.

In regards to your problem. The cachemgr reports are executed by
workers, not the coordinator. So that API in its current form is highly
unlikely to help with restarting of a single worker. But if you find a
report that pays attention to that parameter it might be useful to see
if any workers are running.
 Ultimately watching the cache.log for worker death and restart messages
will be your best source of info about the deaths. You should even find
the reason the workers are dying in there.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018255.html">[squid-users] restarting dead worker
</A></li>
	<LI>Next message (by thread): <A HREF="018263.html">[squid-users] SECURITY ALERT: Host header forgery detected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18256">[ date ]</a>
              <a href="thread.html#18256">[ thread ]</a>
              <a href="subject.html#18256">[ subject ]</a>
              <a href="author.html#18256">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
