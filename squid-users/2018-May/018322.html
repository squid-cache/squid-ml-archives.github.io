<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Cert download from AIA information succeeds yet Squid reports ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cert%20download%20from%20AIA%20information%20succeeds%20yet%0A%20Squid%20reports%20ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY&In-Reply-To=%3Cf0798541-08ac-73ee-5c1c-bfc669d86774%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018317.html">
   <LINK REL="Next"  HREF="018319.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Cert download from AIA information succeeds yet Squid reports ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Cert%20download%20from%20AIA%20information%20succeeds%20yet%0A%20Squid%20reports%20ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY&In-Reply-To=%3Cf0798541-08ac-73ee-5c1c-bfc669d86774%40measurement-factory.com%3E"
       TITLE="[squid-users] Cert download from AIA information succeeds yet Squid reports ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue May 22 15:50:14 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018317.html">[squid-users] Cert download from AIA information succeeds yet Squid reports ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY
</A></li>
        <LI>Next message (by thread): <A HREF="018319.html">[squid-users] NetfilterInterception: NF &gt;	getsockopt(SO_ORIGINAL_DST) errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18322">[ date ]</a>
              <a href="thread.html#18322">[ thread ]</a>
              <a href="subject.html#18322">[ subject ]</a>
              <a href="author.html#18322">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05/21/2018 10:59 PM, Ahmad, Sarfaraz wrote:

&gt;<i> Websites where certificates just share AIA information using CA-issuer
</I>&gt;<i> method, those work just fine.
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> But try this one, <A HREF="https://community.verizonwireless.com/welcome">https://community.verizonwireless.com/welcome</A> (this
</I>&gt;<i> gets bumped in my setup)
</I>&gt;<i> 
</I>&gt;<i> Here the AIA information Is provided using both OCSP/CAissuer methods.
</I>&gt;<i> 
</I>&gt;<i> From Squid&#8217;s access logs, I can tell that the certificate gets downloaded.
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> 1526964147.929&#160;&#160;&#160; 160 - TCP_MISS/200 1868 GET
</I>&gt;<i> <A HREF="http://cacert.omniroot.com/vpssg142.crt">http://cacert.omniroot.com/vpssg142.crt</A> - HIER_DIRECT/64.18.25.46
</I>&gt;<i> application/x-x509-ca-cert
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> But squid still reports*:*
</I>&gt;<i> 
</I>&gt;<i> *(71) Protocol error (TLS code: X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> *SSL Certficate error: certificate issuer (CA) not known:
</I>&gt;<i> /C=NL/L=Amsterdam/O=Verizon Enterprise
</I>&gt;<i> Solutions/OU=Cybertrust/CN=Verizon Public SureServer CA G14-SHA2
</I>&gt;<i> 
</I>&gt;<i> *&#160;*
</I>&gt;<i> 
</I>&gt;<i> That is the only intermediate certificate needed in the chain. &#160;Here:
</I>&gt;<i> <A HREF="https://www.ssllabs.com/ssltest/analyze.html?d=community.verizonwireless.com&amp;latest">https://www.ssllabs.com/ssltest/analyze.html?d=community.verizonwireless.com&amp;latest</A>
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> When I download the intermediate certificate locally and try connecting
</I>&gt;<i> to the remote server using openssl &#8211;Cafile option, Openssl reports OK (0).
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> openssl s_client -connect 204.93.84.201:443 -showcerts -CAfile
</I>&gt;<i> vpssg142.crt &#8211;servername community.verizon.com
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> &#160;&#160;&#160;&#160;Verify return code: 0 (ok)
</I>

Nice triage! I do not know what went wrong, unfortunately. If you do not
find a solution on the mailing list, I recommend posting a bug report.
If possible, attach compressed partial cache.log (with debug_options set
to ALL,9) collected while reproducing the above problem without any
other transactions. This log might speed up resolution by exposing the
problem without the need to reproduce it locally.

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018317.html">[squid-users] Cert download from AIA information succeeds yet Squid reports ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY
</A></li>
	<LI>Next message (by thread): <A HREF="018319.html">[squid-users] NetfilterInterception: NF &gt;	getsockopt(SO_ORIGINAL_DST) errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18322">[ date ]</a>
              <a href="thread.html#18322">[ thread ]</a>
              <a href="subject.html#18322">[ subject ]</a>
              <a href="author.html#18322">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
