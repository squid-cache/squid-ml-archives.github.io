<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] GET requests remain in pending state with Squid and Kerberos auth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20GET%20requests%20remain%20in%20pending%20state%20with%20Squid%0A%20and%20Kerberos%20auth&In-Reply-To=%3C8f99cbfb-06fc-b3c7-15c0-3db6be3b1d83%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018330.html">
   <LINK REL="Next"  HREF="018333.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] GET requests remain in pending state with Squid and Kerberos auth</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20GET%20requests%20remain%20in%20pending%20state%20with%20Squid%0A%20and%20Kerberos%20auth&In-Reply-To=%3C8f99cbfb-06fc-b3c7-15c0-3db6be3b1d83%40treenet.co.nz%3E"
       TITLE="[squid-users] GET requests remain in pending state with Squid and Kerberos auth">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed May 23 12:18:18 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018330.html">[squid-users] GET requests remain in pending state with Squid and	Kerberos auth
</A></li>
        <LI>Next message (by thread): <A HREF="018333.html">[squid-users] multiple user + multiple ips
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18331">[ date ]</a>
              <a href="thread.html#18331">[ thread ]</a>
              <a href="subject.html#18331">[ subject ]</a>
              <a href="author.html#18331">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 23/05/18 19:11, Ahmad, Sarfaraz wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> I am using Squid as an explicit proxy (configured in the browsers) and
</I>&gt;<i> have configured it to authenticate all users with Kerberos.
</I>&gt;<i> 
</I>&gt;<i> Here are the relevant bits from squid.conf
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> auth_param negotiate program /usr/lib64/squid/negotiate_kerberos_auth -r
</I>&gt;<i> -s HTTP/<A HREF="https://lists.squid-cache.org/listinfo/squid-users">proxytest1.mydomain.com at MYDOMAIN.COM</A> -k /etc/squid/HTTP.keytab
</I>&gt;<i> 
</I>&gt;<i> auth_param negotiate children 10
</I>&gt;<i> 
</I>&gt;<i> auth_param negotiate keep_alive on
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> I know I should be expecting 407s for new TCP connections and pages do
</I>&gt;<i> load a bit slower compared to Basic Auth.
</I>
There should be no difference in timing or message status with Kerberos
than with Basic auth.


&gt;<i> 
</I>&gt;<i> But that isn&#8217;t the problem. The problem is at times some of the web
</I>&gt;<i> pages resources (GET requests mostly) just hang there endlessly. (Chrome
</I>&gt;<i> just says pending)
</I>
How long is this &quot;hang&quot; you mention?
 is there any specific timing to it?
 when it ends which piece of software is terminating the connection from
Browser to Squid?
 Do those transactions actually get sent to Squid? (it may seem dumb,
but Google have invented several protocols of their own which Chrome
uses instead of HTTP to fetch objects.)

Also,

 Do the request messages finish arriving at the proxy end of the
connections?
 Does the domain in the request resolve quickly?
 What does that request message look like on-wire?

Does Squid send anything to a server?
 Does the server respond?
 What does that response message look like on-wire?
 Does that response finish arriving to the proxy?
 Which endpoint on the Squid&lt;-&gt;server connection closes it?


You may need to configure &quot;debug_options 11,2&quot; to record the HTTP
message traffic to find the above details.


&gt;<i> 
</I>&gt;<i> When I do a refresh, the browser loads that very same resource(say a
</I>&gt;<i> .js/.css file) just fine.
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> This is just a test setup and I looked at the negotiate helper stats. Here
</I>&gt;<i> 
</I>...
&gt;<i> 
</I>&gt;<i> I don&#8217;t think they are the problem.
</I>
Agreed, at least from those stats.

&gt;<i> 
</I>&gt;<i> Any thoughts on what could be going on here? I don&#8217;t have a way to
</I>&gt;<i> reproduce this reliably so far and this happens intermittently.
</I>&gt;<i> 
</I>
You will have to dig a bit further into the traffic chain and hopefully
one of the questions above will lead you to find out what exactly is
hanging. What you have mentioned so far does not contain any clues.


HTH
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018330.html">[squid-users] GET requests remain in pending state with Squid and	Kerberos auth
</A></li>
	<LI>Next message (by thread): <A HREF="018333.html">[squid-users] multiple user + multiple ips
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18331">[ date ]</a>
              <a href="thread.html#18331">[ thread ]</a>
              <a href="subject.html#18331">[ subject ]</a>
              <a href="author.html#18331">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
