<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 3.5.27 to 4.4: a worker is dead
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.5.27%20to%204.4%3A%20a%20worker%20is%20dead&In-Reply-To=%3C810ddb3c-d5ff-a15d-b094-469ba3be61e1%40cinbesa.com.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019635.html">
   <LINK REL="Next"  HREF="019644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 3.5.27 to 4.4: a worker is dead</H1>
    <B>Heiler Bemerguy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.5.27%20to%204.4%3A%20a%20worker%20is%20dead&In-Reply-To=%3C810ddb3c-d5ff-a15d-b094-469ba3be61e1%40cinbesa.com.br%3E"
       TITLE="[squid-users] 3.5.27 to 4.4: a worker is dead">heiler.bemerguy at cinbesa.com.br
       </A><BR>
    <I>Wed Nov  7 11:24:57 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019635.html">[squid-users] squid-users Digest, Vol 51, Issue 6
</A></li>
        <LI>Next message (by thread): <A HREF="019644.html">[squid-users] 3.5.27 to 4.4: a worker is dead
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19638">[ date ]</a>
              <a href="thread.html#19638">[ thread ]</a>
              <a href="subject.html#19638">[ subject ]</a>
              <a href="author.html#19638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After some hours the worker 4 died unexpectely and didn't come back. I 
have cleaned the rock cache store before upgrading just to be safe.. 
COLD start........

proxy&#160;&#160;&#160; 15478&#160; 0.6&#160; 1.8 9518972 1207212 ?&#160;&#160;&#160;&#160; S&#160;&#160;&#160; Nov06&#160;&#160; 6:17 
(squid-5) --kid squid-5 -s
proxy&#160;&#160;&#160; 15480&#160; 0.4&#160; 1.4 9391808 954248 ?&#160;&#160;&#160;&#160;&#160; S&#160;&#160;&#160; Nov06&#160;&#160; 3:56 
(squid-3) --kid squid-3 -s
proxy&#160;&#160;&#160; 15481&#160; 1.1&#160; 2.5 9734420 1679360 ?&#160;&#160;&#160;&#160; S&#160;&#160;&#160; Nov06&#160; 10:45 
(squid-2) --kid squid-2 -s
proxy&#160;&#160;&#160; 26933&#160; 0.0&#160; 0.0 6501296 26768 ?&#160;&#160;&#160;&#160;&#160;&#160; S&#160;&#160;&#160; 00:25&#160;&#160; 0:01 
(squid-coord-9) --kid squid-coord-9 -s
proxy&#160;&#160;&#160; 26936&#160; 0.0&#160; 0.6 7424208 401788 ?&#160;&#160;&#160;&#160;&#160; S&#160;&#160;&#160; 00:25&#160;&#160; 0:07 
(squid-disk-6) --kid squid-disk-6 -s
proxy&#160;&#160;&#160; 27011&#160; 0.0&#160; 0.2 7424208 185580 ?&#160;&#160;&#160;&#160;&#160; S&#160;&#160;&#160; 00:28&#160;&#160; 0:03 
(squid-disk-7) --kid squid-disk-7 -s
proxy&#160;&#160;&#160; 27227&#160; 0.0&#160; 0.0 7424208 54980 ?&#160;&#160;&#160;&#160;&#160;&#160; S&#160;&#160;&#160; 00:37&#160;&#160; 0:01 
(squid-disk-8) --kid squid-disk-8 -s

AMD64 12-core, 64gb ram

cache_mem 5200 MB
maximum_object_size_in_memory 2 MB
maximum_object_size 4 GB
workers 5
cache_dir rock /cache2 131000 min-size=1 max-size=196608
cache_dir rock /cache3 131000 min-size=196609 max-size=624288
cache_dir rock /cache4 131000 min-size=624289 max-swap-rate=500 
swap-timeout=500

Squid Cache: Version 4.4
Service Name: squid

This binary uses OpenSSL 1.0.1t&#160; 3 May 2016. For legal restrictions on 
distribution see <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>

configure options:&#160; '--enable-delay-pools' '--with-openssl' 
'--enable-htcp' '--disable-maintainer-mode' 
'--disable-dependency-tracking' '--disable-wccp' '--disable-snmp' 
'--enable-inline' '--enable-async-io=32' '--enable-storeio=aufs,rock' 
'--enable-underscores' '--enable-removal-policies=lru,heap' 
'--enable-http-violations' '--disable-ident-lookups' 
'--with-large-files' '--enable-ssl' '--enable-ltdl-convenience' 
'--prefix=/usr' '--localstatedir=/var' '--libexecdir=/lib/squid' 
'--srcdir=.' '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid' 
'--with-default-user=proxy' '--with-logdir=/var/log' 
'--with-pidfile=/var/run/squid.pid' '--with-filedescriptors=16384' 
'--with-aufs-threads=32' '--disable-translation'


2018/11/07 07:06:19 kid4| clientProcessHit: URL mismatch, 
'[unknown_URI]' != 
'<A HREF="http://ocsp.godaddy.com//MEQwQjBAMD4wPDAJBgUrDgMCGgUABBTkIInKBAzXkF0Qh0pel3lfHJ9GPAQU0sSw0pHUTBFxs2HLPaH%2B3ahq1OMCAxvnFQ%3D%3D">http://ocsp.godaddy.com//MEQwQjBAMD4wPDAJBgUrDgMCGgUABBTkIInKBAzXkF0Qh0pel3lfHJ9GPAQU0sSw0pHUTBFxs2HLPaH%2B3ahq1OMCAxvnFQ%3D%3D</A>'
2018/11/07 07:07:11 kid4| WARNING: communication with /cache2/rock may 
be too slow or disrupted for about 7.00s; rescued 1 out of 1 I/Os
2018/11/07 07:07:11 kid4| clientProcessHit: URL mismatch, 
'[unknown_URI]' != '<A HREF="http://www.orm.com.br/templates/noticiaDev.php">http://www.orm.com.br/templates/noticiaDev.php</A>'
2018/11/07 07:13:26 kid4| clientProcessHit: URL mismatch, 
'[unknown_URI]' != 
'<A HREF="http://storage.googleapis.com/update-delta/hfnkpimlhhgieaddgfemjhofmfblmnib/4803/4802/b767e40b59c48c2ec52977502ac10e35b84c00600197162f42dd941b5095cafd.crxd">http://storage.googleapis.com/update-delta/hfnkpimlhhgieaddgfemjhofmfblmnib/4803/4802/b767e40b59c48c2ec52977502ac10e35b84c00600197162f42dd941b5095cafd.crxd</A>'
2018/11/07 07:17:03 kid4| FATAL: Dying from an exception handling 
failure; exception: check failed: false
 &#160;&#160;&#160; exception location: mem/PageStack.cc(106) push

2018/11/07 07:17:03 kid4| Current Directory is /etc/init.d
2018/11/07 07:17:03 kid4| Starting Squid Cache version 4.4 for 
x86_64-pc-linux-gnu...
2018/11/07 07:17:03 kid4| Service Name: squid
2018/11/07 07:17:03 kid4| Process ID 6320
2018/11/07 07:17:03 kid4| Process Roles: worker
2018/11/07 07:17:03 kid4| With 65536 file descriptors available
2018/11/07 07:17:03 kid4| Initializing IP Cache...
2018/11/07 07:17:03 kid4| DNS Socket created at [::], FD 5
2018/11/07 07:17:03 kid4| DNS Socket created at 0.0.0.0, FD 13
2018/11/07 07:17:03 kid4| Adding domain cinbesa.pmb from /etc/resolv.conf
2018/11/07 07:17:03 kid4| Adding nameserver 127.0.0.1 from /etc/resolv.conf
2018/11/07 07:17:03 kid4| helperOpenServers: Starting 8/16 'ufdbgclient' 
processes
2018/11/07 07:17:03 kid4| helperOpenServers: Starting 10/30 
'store-id.pl' processes
2018/11/07 07:17:03 kid4| Logfile: opening log 
daemon:/var/log/squid/access.log
2018/11/07 07:17:03 kid4| Logfile Daemon: opening log 
/var/log/squid/access.log
2018/11/07 07:17:03 kid4| Store logging disabled
2018/11/07 07:17:03 kid4| WARNING: disk-cache maximum object size is too 
large for mem-cache: 4194304.00 KB &gt; 2048.00 KB
2018/11/07 07:17:03 kid4| Swap maxSize 0 + 5324800 KB, estimated 118328 
objects
2018/11/07 07:17:03 kid4| Target number of buckets: 11832
2018/11/07 07:17:03 kid4| Using 16384 Store buckets
2018/11/07 07:17:03 kid4| Max Mem&#160; size: 5324800 KB [shared]
2018/11/07 07:17:03 kid4| Max Swap size: 0 KB
2018/11/07 07:17:03 kid4| Using Least Load store dir selection
2018/11/07 07:17:03 kid4| Current Directory is /etc/init.d
2018/11/07 07:17:03 kid4| Finished loading MIME types and icons.
2018/11/07 07:17:03 kid4| Configuring Parent 10.1.10.10/8081/0
2018/11/07 07:17:03 kid4| Squid plugin modules loaded: 0
2018/11/07 07:17:03 kid4| Adaptation support is off.
2018/11/07 07:17:09 kid4| Closing HTTP(S) port [::]:3080
2018/11/07 07:17:09 kid4| Not currently OK to rewrite swap log.
2018/11/07 07:17:09 kid4| storeDirWriteCleanLogs: Operation aborted.
2018/11/07 07:17:09 kid4| FATAL: kid4 registration timed out
2018/11/07 07:17:09 kid4| Squid Cache (Version 4.4): Terminated abnormally.
CPU Usage: 0.036 seconds = 0.024 user + 0.012 sys
Maximum Resident Size: 156240 KB
Page faults with physical i/o: 0
2018/11/07 07:17:09 kid4| Current Directory is /etc/init.d
2018/11/07 07:17:09 kid4| Starting Squid Cache version 4.4 for 
x86_64-pc-linux-gnu...
2018/11/07 07:17:09 kid4| Service Name: squid
2018/11/07 07:17:09 kid4| Process ID 6341
2018/11/07 07:17:09 kid4| Process Roles: worker
2018/11/07 07:17:09 kid4| With 65536 file descriptors available
2018/11/07 07:17:09 kid4| Initializing IP Cache...
2018/11/07 07:17:09 kid4| DNS Socket created at [::], FD 5
2018/11/07 07:17:09 kid4| DNS Socket created at 0.0.0.0, FD 13
2018/11/07 07:17:09 kid4| Adding domain cinbesa.pmb from /etc/resolv.conf
2018/11/07 07:17:09 kid4| Adding nameserver 127.0.0.1 from /etc/resolv.conf
2018/11/07 07:17:09 kid4| helperOpenServers: Starting 8/16 'ufdbgclient' 
processes
2018/11/07 07:17:09 kid4| helperOpenServers: Starting 10/30 
'store-id.pl' processes
2018/11/07 07:17:09 kid4| Logfile: opening log 
daemon:/var/log/squid/access.log
2018/11/07 07:17:09 kid4| Logfile Daemon: opening log 
/var/log/squid/access.log
2018/11/07 07:17:09 kid4| Store logging disabled
2018/11/07 07:17:09 kid4| WARNING: disk-cache maximum object size is too 
large for mem-cache: 4194304.00 KB &gt; 2048.00 KB
2018/11/07 07:17:09 kid4| Swap maxSize 0 + 5324800 KB, estimated 118328 
objects
2018/11/07 07:17:09 kid4| Target number of buckets: 11832
2018/11/07 07:17:09 kid4| Using 16384 Store buckets
2018/11/07 07:17:09 kid4| Max Mem&#160; size: 5324800 KB [shared]
2018/11/07 07:17:09 kid4| Max Swap size: 0 KB
2018/11/07 07:17:09 kid4| Using Least Load store dir selection
2018/11/07 07:17:09 kid4| Current Directory is /etc/init.d
2018/11/07 07:17:09 kid4| Finished loading MIME types and icons.
2018/11/07 07:17:09 kid4| Configuring Parent 10.1.10.10/8081/0
2018/11/07 07:17:09 kid4| Squid plugin modules loaded: 0
2018/11/07 07:17:09 kid4| Adaptation support is off.
2018/11/07 07:17:15 kid4| Closing HTTP(S) port [::]:3080
2018/11/07 07:17:15 kid4| Not currently OK to rewrite swap log.
2018/11/07 07:17:15 kid4| storeDirWriteCleanLogs: Operation aborted.
2018/11/07 07:17:15 kid4| FATAL: kid4 registration timed out
2018/11/07 07:17:15 kid4| Squid Cache (Version 4.4): Terminated abnormally.
CPU Usage: 0.040 seconds = 0.024 user + 0.016 sys
Maximum Resident Size: 156496 KB
Page faults with physical i/o: 0

(loop)

-- 
Atenciosamente,

Heiler Bensimon Bemerguy - CINBESA
Analista de Redes, Wi-Fi,
Virtualiza&#231;&#227;o e Servi&#231;os Internet
(55) 91 98151-4894


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019635.html">[squid-users] squid-users Digest, Vol 51, Issue 6
</A></li>
	<LI>Next message (by thread): <A HREF="019644.html">[squid-users] 3.5.27 to 4.4: a worker is dead
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19638">[ date ]</a>
              <a href="thread.html#19638">[ thread ]</a>
              <a href="subject.html#19638">[ subject ]</a>
              <a href="author.html#19638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
