<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 3.5.27 to 4.4: a worker is dead
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.5.27%20to%204.4%3A%20a%20worker%20is%20dead&In-Reply-To=%3Ce7275e18-8cba-567e-ff29-275ded92a119%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019648.html">
   <LINK REL="Next"  HREF="019639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 3.5.27 to 4.4: a worker is dead</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%203.5.27%20to%204.4%3A%20a%20worker%20is%20dead&In-Reply-To=%3Ce7275e18-8cba-567e-ff29-275ded92a119%40measurement-factory.com%3E"
       TITLE="[squid-users] 3.5.27 to 4.4: a worker is dead">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Nov  8 16:42:40 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019648.html">[squid-users] 3.5.27 to 4.4: a worker is dead
</A></li>
        <LI>Next message (by thread): <A HREF="019639.html">[squid-users] Squid crashes with	&quot;!Comm::MonitorsRead(serverConnection-&gt;fd)&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19651">[ date ]</a>
              <a href="thread.html#19651">[ thread ]</a>
              <a href="subject.html#19651">[ subject ]</a>
              <a href="author.html#19651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/8/18 8:49 AM, Heiler Bemerguy wrote:
&gt;&gt;&gt;<i> 2018/11/07 07:17:03 kid4| FATAL: Dying from an exception handling
</I>&gt;&gt;&gt;<i> failure; exception: check failed: false
</I>&gt;&gt;&gt;<i> &#160;&#160;&#160;&#160; exception location: mem/PageStack.cc(106) push
</I>
&gt;&gt;<i> The SMP shared-memory space has been asked to allocate more memory than
</I>&gt;&gt;<i> it has total capacity.
</I>
&gt;<i> Why would it do that?
</I>
I am not sure that explanation is accurate. The exception is thrown when
Squid's shared memory manager is given a (previously used/allocated)
shared memory page to add/return to the index of free (i.e. available
for future use) memory pages. When trying to add that free page, Squid
found that the entire index of free shared memory pages is full -- all
previously allocated shared memory pages for the given scope/segment
were already freed/indexed, and there could not have been one more free
page.

It is not clear whether Squid is wrong about the index being full or the
calling code is giving a free page that was already index (i.e. an
equivalent of a double-free bug). There could also be some (currently
unknown) and mishandled race condition when navigating the shared memory
index.

My bet is on a bug in Squid code that attempts to recover from disker
errors (you have reported some disker-related errors/timeouts that
preceded this exception IIRC). If I am right, then this exception is a
symptom of a Squid bug located elsewhere.

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019648.html">[squid-users] 3.5.27 to 4.4: a worker is dead
</A></li>
	<LI>Next message (by thread): <A HREF="019639.html">[squid-users] Squid crashes with	&quot;!Comm::MonitorsRead(serverConnection-&gt;fd)&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19651">[ date ]</a>
              <a href="thread.html#19651">[ thread ]</a>
              <a href="subject.html#19651">[ subject ]</a>
              <a href="author.html#19651">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
