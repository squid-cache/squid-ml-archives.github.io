<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Question on Many Clients to Many Proxy Lists
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20on%20Many%20Clients%20to%20Many%20Proxy%20Lists&In-Reply-To=%3CCAPL%3DMgfNnTD2G0C2oR64r4AQotCu1XaZunn-GgWRpSrSqBsmqg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019729.html">
   <LINK REL="Next"  HREF="019750.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Question on Many Clients to Many Proxy Lists</H1>
    <B>Wire Cutter</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Question%20on%20Many%20Clients%20to%20Many%20Proxy%20Lists&In-Reply-To=%3CCAPL%3DMgfNnTD2G0C2oR64r4AQotCu1XaZunn-GgWRpSrSqBsmqg%40mail.gmail.com%3E"
       TITLE="[squid-users] Question on Many Clients to Many Proxy Lists">wirecutter at shadycloud.com
       </A><BR>
    <I>Fri Nov 30 18:51:45 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019729.html">[squid-users] Question on Many Clients to Many Proxy Lists
</A></li>
        <LI>Next message (by thread): <A HREF="019750.html">[squid-users] Question on Many Clients to Many Proxy Lists
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19749">[ date ]</a>
              <a href="thread.html#19749">[ thread ]</a>
              <a href="subject.html#19749">[ subject ]</a>
              <a href="author.html#19749">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So thats exactly what I did.

#Rules for Peer group - list 1
       cache_peer_access peerA1 allow port_8080
       cache_peer_access peerA2 allow port_8080
       cache_peer_access peerA3 allow port_8080
       cache_peer_access peerA4 allow port_8080

#cache_peer
        cache_peer 192.168.1.2 parent 8800 0 round-robin no-query
name=peerA1
        cache_peer 192.168.2.2 parent 8800 0 round-robin no-query
name=peerA2
        cache_peer 192.168.2.5 parent 8800 0 round-robin no-query
name=peerA3
        cache_peer 192.168.2.6  parent 8800 0 round-robin no-query
name=peerA4

Then this is the error I get when I start the service

Nov 30 18:38:11 ubuntu systemd[1]: Starting LSB: Squid HTTP Proxy version
3.x...
Nov 30 18:38:11 ubuntu squid[13974]: Bungled /etc/squid/squid.conf line
3148: cache_peer_access peerA1 allow port_8080
Nov 30 18:38:11 ubuntu squid[13980]: Bungled /etc/squid/squid.conf line
3148: cache_peer_access peerA1 allow port_8080
Nov 30 18:38:11 ubuntu squid[13957]:  * FATAL: Bungled
/etc/squid/squid.conf line 3148: cache_peer_access peerA1 allow port_8080
Nov 30 18:38:11 ubuntu systemd[1]: squid.service: Control process exited,
code=exited status=3
Nov 30 18:38:11 ubuntu systemd[1]: squid.service: Failed with result
'exit-code'.
Nov 30 18:38:11 ubuntu systemd[1]: Failed to start LSB: Squid HTTP Proxy
version 3.x.



On Thu, Nov 29, 2018 at 10:44 AM Alex Rousskov &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:

&gt;<i> On 11/29/18 7:57 AM, Wire Cutter wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I&#8217;ve created 4 ports for clients to talk to, then created ACL lists for
</I>&gt;<i> &gt; those ports.  From there I&#8217;ve tried (and failed) to create naming groups
</I>&gt;<i> &gt; for cacheing peers, then added those to ACLs and it fails. Any ideas?
</I>&gt;<i>
</I>&gt;<i> Use cache_peer_access to allow http_port X traffic (and only that
</I>&gt;<i> traffic) to peer group Y:
</I>&gt;<i>
</I>&gt;<i>   # rules for peer group A
</I>&gt;<i>   cache_peer_access peerA1 allow receivedOnPortForPeersA
</I>&gt;<i>   cache_peer_access peerA2 allow receivedOnPortForPeersA
</I>&gt;<i>   cache_peer_access peerA3 allow receivedOnPortForPeersA
</I>&gt;<i>   ...
</I>&gt;<i>   # rules for peer group B
</I>&gt;<i>   cache_peer_access peerB1 allow receivedOnPortForPeersB
</I>&gt;<i>   cache_peer_access peerB2 allow receivedOnPortForPeersB
</I>&gt;<i>   ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Depending on your traffic and needs, you may also need to allow
</I>&gt;<i> non-hierarchical requests to go to peer:
</I>&gt;<i>
</I>&gt;<i>   nonhierarchical_direct off
</I>&gt;<i>
</I>&gt;<i> and/or to prohibit direct connections for portX:
</I>&gt;<i>
</I>&gt;<i>   never_direct allow receivedOnPortForPeersA
</I>&gt;<i>   never_direct allow receivedOnPortForPeersB
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Once you get this working, please make Squid documentation improvements
</I>&gt;<i> that would have allowed you to figure this out on your own.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTH,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

-- 
_________________________________________________________________________________

This transmission may contain information that is privileged, confidential
and exempt from disclosure under applicable law.  If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is STRICTLY PROHIBITED.  If you received this
transmission in error, please immediately contact the sender and destroy
the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20181130/bd848a29/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20181130/bd848a29/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019729.html">[squid-users] Question on Many Clients to Many Proxy Lists
</A></li>
	<LI>Next message (by thread): <A HREF="019750.html">[squid-users] Question on Many Clients to Many Proxy Lists
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19749">[ date ]</a>
              <a href="thread.html#19749">[ thread ]</a>
              <a href="subject.html#19749">[ subject ]</a>
              <a href="author.html#19749">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
