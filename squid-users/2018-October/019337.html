<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Chrome 69
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Chrome%2069&In-Reply-To=%3C6b380983-66eb-ab1b-2594-4fee5c51a825%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019333.html">
   <LINK REL="Next"  HREF="019346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Chrome 69</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Chrome%2069&In-Reply-To=%3C6b380983-66eb-ab1b-2594-4fee5c51a825%40treenet.co.nz%3E"
       TITLE="[squid-users] Chrome 69">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Oct  1 21:03:49 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019333.html">[squid-users] Chrome 69
</A></li>
        <LI>Next message (by thread): <A HREF="019346.html">[squid-users] Chrome 69
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19337">[ date ]</a>
              <a href="thread.html#19337">[ thread ]</a>
              <a href="subject.html#19337">[ subject ]</a>
              <a href="author.html#19337">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/10/18 9:28 AM, neok wrote:
&gt;<i> As far as I know, nothing's changed. The only thing that could have happened
</I>&gt;<i> is that Chrome was updated. I'm reviewing that.
</I>&gt;<i> 
</I>&gt;<i> This say Firefox when try acces to denied site:
</I>&gt;<i> The proxy server is refusing connections.
</I>&gt;<i> Firefox is configured to use a proxy server that is refusing connections.
</I>&gt;<i> 
</I>
As you an see from the access.log Squid is presenting 407 auth
challenged in response to these CONNECT requests.

It is welcome news to hear Chrome is finally been fixed to actually
perform authentication for CONNECT tunnels. While it may have been okay
with you the previous behaviour is actually a long-standing Browser bug
and violation of HTTP on their part.




On 2/10/18 8:53 AM, neok wrote:
&gt;<i>
</I>&gt;<i> Now Chrome shows me the login window every time I visit a denied site.
</I>&gt;<i> I suspect Chrome has been updated and changed its behavior. I'm currently
</I>&gt;<i> studying that possibility.
</I>&gt;<i> I'm also rethinking whether the way I'm denying sites is the right one.
</I>
...
&gt;<i>
</I>&gt;<i> http_access allow WEB_ACCESS_YT_ONLY LS_youtube
</I>&gt;<i> http_access deny WEB_ACCESS_YT_ONLY
</I>
The &quot;deny WEB_ACCESS_YT_ONLY&quot; line is triggering the re-authentication.

When the reason for denial is due to credentials (ie %LOGIN for the
external ACL evaluation) a 407 authentication challenge is produced.

Notice that in the config I helped you develop a few days ago all the
other uses of these external ACL tests for &quot;deny&quot; action are followed by
another ACL test that is unrelated to the auth process. Usually a regex
or dstdomain check. It is these other ACL checks which prevent any of
those lines triggering similar auth challenges as they deny traffic.


Since the next thing your config is doing is a &quot;deny all&quot; you can remove
this &quot;deny WEB_ACCESS_YT_ONLY&quot; line entirely and the popups should
disappear while still having that traffic denied.


If you have other config policies to be added later there are some other
things you can do. But those will depend on what the other policies are
going to require, so I wont cover it now. Just be aware you may have to
revisit that YT access rule when adding other policies.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019333.html">[squid-users] Chrome 69
</A></li>
	<LI>Next message (by thread): <A HREF="019346.html">[squid-users] Chrome 69
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19337">[ date ]</a>
              <a href="thread.html#19337">[ thread ]</a>
              <a href="subject.html#19337">[ subject ]</a>
              <a href="author.html#19337">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
