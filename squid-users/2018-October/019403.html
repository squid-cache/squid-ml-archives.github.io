<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Proxy client certificate authentication rewritten to username/password authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Proxy%20client%20certificate%20authentication%20rewritten%0A%20to%20username/password%20authentication&In-Reply-To=%3Cd7e2013b-1aa8-2583-b70c-49f23464e987%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019402.html">
   <LINK REL="Next"  HREF="019404.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Proxy client certificate authentication rewritten to username/password authentication</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Proxy%20client%20certificate%20authentication%20rewritten%0A%20to%20username/password%20authentication&In-Reply-To=%3Cd7e2013b-1aa8-2583-b70c-49f23464e987%40measurement-factory.com%3E"
       TITLE="[squid-users] Proxy client certificate authentication rewritten to username/password authentication">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Oct  9 22:37:43 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019402.html">[squid-users] Proxy client certificate authentication rewritten to username/password authentication
</A></li>
        <LI>Next message (by thread): <A HREF="019404.html">[squid-users] Proxy client certificate authentication rewritten to username/password authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19403">[ date ]</a>
              <a href="thread.html#19403">[ thread ]</a>
              <a href="subject.html#19403">[ subject ]</a>
              <a href="author.html#19403">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/09/2018 02:58 PM, Arnt Richard R&#248;rvik wrote:

&gt;<i> The origin server does not request any certificates from the client.
</I>&gt;<i> We can instruct the clients to use the proxy directly, if terminating
</I>&gt;<i> traffic directly in Squid can easen the implementation.
</I>
OK, I will assume that your clients will explicitly talk to the proxy
using TLS. In that case, certificate-based client authentication by
Squid should work OK.


&gt;<i> The general idea is to have a table in Squid (or make accessible such
</I>&gt;<i> a table from elsewhere) with a number of usernames and passwords,
</I>&gt;<i> that would match certain placeholders in the startup URL issued by
</I>&gt;<i> the clients
</I>
Understood. From Squid (and TLS and HTTP) point of view, this URL
rewriting will have nothing to do with usernames and passwords then.

Your custom URL rewriting helper or adaptation service, not Squid, will
contain all the placeholder substitution logic and will access the
tables that drive those substitutions. This separation from Squid is
actually a good thing in most cases.

For more about Squid adaptation interfaces, see
<A HREF="https://wiki.squid-cache.org/SquidFaq/ContentAdaptation">https://wiki.squid-cache.org/SquidFaq/ContentAdaptation</A>


&gt;&gt;<i> whether your clients are regular browsers (or custom software you control), 
</I>
&gt;<i> This would probably be the standard managed browser on iPads, that
</I>&gt;<i> is, Safari with policies. They could in theory be anything, but
</I>&gt;<i> manageability would normally dictate a managed browser.
</I>
You will need to check whether your target browser(s) support:

1. HTTPS proxies: Establishing a TLS connection to the proxy and then
sending HTTP traffic, including CONNECT requests for secure sites inside
that TLS connection to the proxy. FireFox and Chrome (semi-secretly)
support HTTPS proxies, but I do not know much about Safari.

2. Certificate-based proxy authentication: Supplying a client
certificate when requested by the proxy on the other end of the
client-proxy TLS connection described in #1.

If both #1 and #2 are supported, then what you want is

* fairly easy for HTTP origin servers and

* currently unsupported for HTTPS origin servers (but can be supported
by enhancing SslBump to bump TLS-inside-TLS).


Please note that if you want to rewrite URLs of secure web sites (e.g.,
&quot;<A HREF="https://example.com/">https://example.com/</A>&quot;), then you will be fighting an increasingly
uphill battle with modern browsers, even if Squid can do (or can be
enhanced to do) what you want. In many cases, an overall better solution
in that case is to rewrite those secure URLs inside the browser instead,
even though that approach often requires instrumenting several browsers
that increasingly resist instrumentation (i.e. another uphill battle
with popular browsers!).


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019402.html">[squid-users] Proxy client certificate authentication rewritten to username/password authentication
</A></li>
	<LI>Next message (by thread): <A HREF="019404.html">[squid-users] Proxy client certificate authentication rewritten to username/password authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19403">[ date ]</a>
              <a href="thread.html#19403">[ thread ]</a>
              <a href="subject.html#19403">[ subject ]</a>
              <a href="author.html#19403">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
