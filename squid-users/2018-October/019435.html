<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid on openwrt: aclhelper wrongly considered exited
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20on%20openwrt%3A%20aclhelper%20wrongly%20considered%0A%20exited&In-Reply-To=%3Cc8ef3617-cd8c-2767-b14c-ab82c576db4e%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019434.html">
   <LINK REL="Next"  HREF="019436.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid on openwrt: aclhelper wrongly considered exited</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20on%20openwrt%3A%20aclhelper%20wrongly%20considered%0A%20exited&In-Reply-To=%3Cc8ef3617-cd8c-2767-b14c-ab82c576db4e%40measurement-factory.com%3E"
       TITLE="[squid-users] squid on openwrt: aclhelper wrongly considered exited">rousskov at measurement-factory.com
       </A><BR>
    <I>Sun Oct 14 18:27:19 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019434.html">[squid-users] squid on openwrt: aclhelper wrongly considered exited
</A></li>
        <LI>Next message (by thread): <A HREF="019436.html">[squid-users] How to create a simple whitelist using regexes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19435">[ date ]</a>
              <a href="thread.html#19435">[ thread ]</a>
              <a href="subject.html#19435">[ subject ]</a>
              <a href="author.html#19435">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/14/2018 11:17 AM, reinerotto wrote:
&gt;<i> Running squid 4.3 on openwrt, I notice following warnings from time to time:
</I>&gt;<i> 
</I>&gt;<i> 2018/10/14 16:36:39 kid1| WARNING: helper.sh #Hlpr2 exited
</I>&gt;<i> 2018/10/14 16:36:39 kid1| Too few helper processes are running (need 1/5)
</I>&gt;<i> 2018/10/14 16:36:39 kid1| Starting new helpers
</I>&gt;<i> 2018/10/14 16:36:39 kid1| helperOpenServers: Starting 1/5 'helper.sh'
</I>&gt;<i> processes
</I>&gt;<i> 
</I>&gt;<i> which causes a new helper process to be created.
</I>&gt;<i> 
</I>&gt;<i> Howver, the process considered to have exited is still alive, according to
</I>&gt;<i> &quot;ps&quot;. I can kill it manually, not causing a new warning again.
</I>
IIRC, squid does not monitor helper processes as such. Squid monitors
helper standard output stream (that output stream closure is interpreted
by Squid as helper exit). Also, Squid closes helper standard input
stream as a signal to the helper that the helper should exit.


&gt;<i> Any idea, which debug level to activate, to get some more info ?
</I>&gt;<i> Because of limited resources, not too generous debugs, pls.
</I>
You can start with

    debug_options ALL,2 54,5 84,5

If this is your own helper, then check that it does not close its
standard output except when exiting.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019434.html">[squid-users] squid on openwrt: aclhelper wrongly considered exited
</A></li>
	<LI>Next message (by thread): <A HREF="019436.html">[squid-users] How to create a simple whitelist using regexes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19435">[ date ]</a>
              <a href="thread.html#19435">[ thread ]</a>
              <a href="subject.html#19435">[ subject ]</a>
              <a href="author.html#19435">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
