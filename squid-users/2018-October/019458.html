<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay pools and external acl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pools%20and%20external%20acl&In-Reply-To=%3Cc672c10a-e18f-8f4b-325b-62dd7bd2272f%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019443.html">
   <LINK REL="Next"  HREF="019474.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay pools and external acl</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pools%20and%20external%20acl&In-Reply-To=%3Cc672c10a-e18f-8f4b-325b-62dd7bd2272f%40treenet.co.nz%3E"
       TITLE="[squid-users] Delay pools and external acl">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Oct 17 03:38:03 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019443.html">[squid-users] Delay pools and external acl
</A></li>
        <LI>Next message (by thread): <A HREF="019474.html">[squid-users] Delay pools and external acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19458">[ date ]</a>
              <a href="thread.html#19458">[ thread ]</a>
              <a href="subject.html#19458">[ subject ]</a>
              <a href="author.html#19458">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/10/18 11:09 AM, Danilo V wrote:
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> Has anyone succeeded applying delay pools on groups from AD?
</I>&gt;<i> 
</I>&gt;<i> I'm using squid 3.5.23 with basic_ldap_auth.
</I>&gt;<i> I initially tried to combine mapping groups with external acl type
</I>&gt;<i> (ext_ldap_group_acl) to delay pools. It's a trap :-(
</I>&gt;<i> 
</I>
A trap?

For starters; &quot;group&quot; is an abstract concept buried in the depths of
authentication which has nothing to do with traffic. It is a purely
human scoping idea. Squid knows nothing of any &quot;group&quot;.


The external ACL type which handles such complex non-traffic things is
clearly listed in the Squid FAQ (and the 'acl' directive documentation)
as being a &quot;slow&quot; / async ACL type.

Delay pools is also clearly listed as an access control which only works
with &quot;fast&quot; category ACL types.

&lt;<A HREF="https://wiki.squid-cache.org/SquidFaq/SquidAcl#Fast_and_Slow_ACLs">https://wiki.squid-cache.org/SquidFaq/SquidAcl#Fast_and_Slow_ACLs</A>&gt;



&gt;<i> After doing more search I found about class 5 and note acl.
</I>&gt;<i> Has anyone a pratical implementation in this scenario?
</I>
Yes several admin have done so. But with custom helpers that integrate
with the new annotation system, or the Kerberos helpers that have been
upgraded to integrate as well. Other helpers have not been updated yet.


Your external ACL just needs to supply Squid with a &quot;tag=XX&quot; or
&quot;group=XX &quot; annotation to label the transaction with whichever group
matches.

 # login is required to do group checking...
 acl login proxy_auth REQUIRED
 http_access deny !login


 # the decision to allow the traffic into the proxy does group checks
and adds annotations...

 external_acl_type group %LOGIN ...
 acl some_group external group XX

 http_access allow some_group_check


 # the decision of what pool(s) to apply has to work FAST - so uses the
annotations already present or not present) as its decider:

 acl groupXX note group XX

 # or for older Squid
 acl groupXX note tag XX

 delay_access N allow groupXX


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019443.html">[squid-users] Delay pools and external acl
</A></li>
	<LI>Next message (by thread): <A HREF="019474.html">[squid-users] Delay pools and external acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19458">[ date ]</a>
              <a href="thread.html#19458">[ thread ]</a>
              <a href="subject.html#19458">[ subject ]</a>
              <a href="author.html#19458">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
