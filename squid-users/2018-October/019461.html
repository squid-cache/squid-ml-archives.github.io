<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Unable to open youtube.com
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20open%20youtube.com&In-Reply-To=%3C6e7a0b1a-d23d-a507-abb2-3915da215cec%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019460.html">
   <LINK REL="Next"  HREF="019463.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Unable to open youtube.com</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20open%20youtube.com&In-Reply-To=%3C6e7a0b1a-d23d-a507-abb2-3915da215cec%40treenet.co.nz%3E"
       TITLE="[squid-users] Unable to open youtube.com">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Oct 17 05:06:37 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019460.html">[squid-users] Unable to open youtube.com
</A></li>
        <LI>Next message (by thread): <A HREF="019463.html">[squid-users] Unable to open youtube.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19461">[ date ]</a>
              <a href="thread.html#19461">[ thread ]</a>
              <a href="subject.html#19461">[ subject ]</a>
              <a href="author.html#19461">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 17/10/18 5:17 PM, Timur Lagutenko wrote:
&gt;<i> i'm sure that the issue is not related to firewall rules.
</I>&gt;<i> because if I pass traffic from client IP (using NAT, browser is not
</I>&gt;<i> configured to use proxy) it works.
</I>
Ah, you said earlier that you did not have SSL-Bump features enabled.

How are you intercepting the port 443 HTTPS traffic with NAT and
converting it to port 80 or 3128 syntax HTTP for Squid to handle?

Squid cannot MITM the &quot;raw&quot; port 443 TLS without SSL-Bump being configured.


Also since it is a Google service it may not be using TCP port 443 at
all. It may actually be performing their QUIC protocol instead of HTTPS.
That has to be blocked entirely to be sure the proxy is actually
receiving all the relevant traffic.



&gt;<i> I think it is related to some SSL/TLS lib in the system.
</I>&gt;<i> Because today i've tried CLI browser - links.
</I>&gt;<i> Launching it directly from gateway (which has direct access to web), i
</I>&gt;<i> was able to browse any site in text mode.
</I>&gt;<i> Except youtube.
</I>&gt;<i> So i guess it is related to some missing ssl lib.
</I>&gt;<i> Could you please suggest how can i find all required libs for my squid?
</I>&gt;<i> 
</I>
If Squid starts without crashing the libs it has been compiled to use
are present on your machine.

If you built it yourself on the same machine, it only uses library
features that machine had at time of the build - so maybe a rebuild is
needed to get access to newer library features.

When it comes to TLS though the library itself is doing the config parse
and setup for crypto things. So Squid does not particularly need to even
be configured to use features the library enables by default. Which
usually includes the current industry-standard ciphers etc.


If Squid accepts your config file and does not produce an ERROR or FATAL
message when you run &quot;squid -k parse&quot; all the libs required to run your
config have been compiled in and loaded.


&gt;<i> # squid -v
</I>&gt;<i> Squid Cache: Version 3.5.28
</I>&gt;<i> Service Name: squid
</I>&gt;<i> 
</I>&gt;<i> This binary uses OpenSSL 1.0.2p&#160; 14 Aug 2018. For legal restrictions on
</I>&gt;<i> distribution see <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
</I>

Your problem may be TLS/1.3 related. OpenSSL 1.0.* only supports a max
of TLS/1.2. Squid-3.5 also only supports OpenSSL 1.0.* library.

AFAIK, Google are one of the organizations heavily pushing TLS changes
and bias their services towards forcing the latest crypto whenever they
can. It is strange that others have not reported issues en-mass, so this
is somewhat unlikely.


Other admin mentioning similar behaviour with YouTube have turned out to
be TLS restrictions that pretty much prohibit the weaker crypto Google
services still allow and only let the very advanced ones (not supported
by their Squid) work.

But also those restrictions were done via SSL-Bump configs. Since you
don't use SSL-Bump it is unlikely to be the same - which leaves us only
with the network/firewall level issues as known things to look at.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019460.html">[squid-users] Unable to open youtube.com
</A></li>
	<LI>Next message (by thread): <A HREF="019463.html">[squid-users] Unable to open youtube.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19461">[ date ]</a>
              <a href="thread.html#19461">[ thread ]</a>
              <a href="subject.html#19461">[ subject ]</a>
              <a href="author.html#19461">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
