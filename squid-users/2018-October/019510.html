<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Redirect certain sites to different gateway
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Redirect%20certain%20sites%20to%20different%20gateway&In-Reply-To=%3C15275882-0c1d-5bdc-58a1-fec6be570b6c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019509.html">
   <LINK REL="Next"  HREF="019516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Redirect certain sites to different gateway</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Redirect%20certain%20sites%20to%20different%20gateway&In-Reply-To=%3C15275882-0c1d-5bdc-58a1-fec6be570b6c%40treenet.co.nz%3E"
       TITLE="[squid-users] Redirect certain sites to different gateway">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Oct 22 06:10:09 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019509.html">[squid-users] Redirect certain sites to different gateway
</A></li>
        <LI>Next message (by thread): <A HREF="019516.html">[squid-users] Redirect certain sites to different gateway
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19510">[ date ]</a>
              <a href="thread.html#19510">[ thread ]</a>
              <a href="subject.html#19510">[ subject ]</a>
              <a href="author.html#19510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/10/18 12:54 PM, Donald Muller wrote:
&gt;<i> I have had squid running well for a while now on my NAS. The browser on
</I>&gt;<i> my PC was set up to use squid. A few weeks ago I started running a VPN
</I>&gt;<i> client on the same NAS. Everything still ran well. The other day I
</I>&gt;<i> change the VPN configuration so that all traffic on the NAS gets routed
</I>&gt;<i> through the VPN (VPN became the default gateway). Everything still ran
</I>&gt;<i> fine except for a few web sites. When I tried to reach my bank, let&#8217;s
</I>&gt;<i> say it is www.mybank.com,
</I>
You bank with &quot;United Bank &amp; Trust&quot;?

When making up fake domain names please use the reserved names in the
&quot;example&quot; namespace:  example.com, example.net, example.whatever

&quot;mybank&quot; is a registered domain name  - it may or may not be a real
bank. Either way no need to connect it with your problems.


&gt;<i> from my PC I received a &#8220;This site can&#8217;t be
</I>&gt;<i> reached&#8221; error. I&#8217;m assuming that the bank site won&#8217;t allow connections
</I>&gt;<i> from a VPN server.
</I>&gt;<i>
</I>
Assuming leads to problems and &quot;solutions&quot; that don't work. Test your
assumption
 - check your proxy cache.log for messages about traffic to that website
 - check your access.log for response status on traffic to that website
 - setup a test machine that makes requests via different gateways and
see what happens differently at the TCP (and if relevant TLS) layers.


&gt;<i> 
</I>&gt;<i> Not sure if it is doable but is it possible via squid to redirect a
</I>&gt;<i> request to a different gateway based on the URL (www.mybank.com
</I>&gt;<i> &lt;<A HREF="http://www.mybank.com">http://www.mybank.com</A>&gt;)? If possible how to accomplish this?
</I>&gt;<i> 
</I>
What you are calling &quot;redirect&quot; is not possible for Squid to do itself.
The OS routing system is responsible for selecting which routing gateway
traffic goes through.

What Squid can do is mark traffic selectively with a TOS
(tp_uotgoing_tos) or nefilter/iptables MARK (tcp_outgoing_mark) the OS
uses to decide on a NIC gateway for. The dstdomain ACL can be used to
label traffic by domain.


But until you actually confirm your assumption was true, it may not
actually do anything useful.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019509.html">[squid-users] Redirect certain sites to different gateway
</A></li>
	<LI>Next message (by thread): <A HREF="019516.html">[squid-users] Redirect certain sites to different gateway
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19510">[ date ]</a>
              <a href="thread.html#19510">[ thread ]</a>
              <a href="subject.html#19510">[ subject ]</a>
              <a href="author.html#19510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
