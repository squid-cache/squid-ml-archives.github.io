<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.3 assertion failed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.3%20assertion%20failed&In-Reply-To=%3C000c01d46c03%24aab5a640%240020f2c0%24%40yahoo.com.ar%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019541.html">
   <LINK REL="Next"  HREF="019518.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.3 assertion failed</H1>
    <B>Julian Perconti</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.3%20assertion%20failed&In-Reply-To=%3C000c01d46c03%24aab5a640%240020f2c0%24%40yahoo.com.ar%3E"
       TITLE="[squid-users] Squid 4.3 assertion failed">vh1988 at yahoo.com.ar
       </A><BR>
    <I>Thu Oct 25 01:40:07 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019541.html">[squid-users] Squid 4.3 assertion failed
</A></li>
        <LI>Next message (by thread): <A HREF="019518.html">[squid-users] Squid proxy not working when upgrade from 27 to 3.5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19543">[ date ]</a>
              <a href="thread.html#19543">[ thread ]</a>
              <a href="subject.html#19543">[ subject ]</a>
              <a href="author.html#19543">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; Program received signal SIGHUP, Hangup.
</I>
Yes, I did not realized that I have executed 'squid -k reconfigure', hence that SIGHUP signal.

I don not know if the following is relevant but:
When the exception occurred, I had executed (earlier) 'squid -k reconfigure'. 
Then, I made a full squid stop and clean squid start, then entered the site that caused Squid to crash and did not happen again, I tried many times without reach the crash again.

&gt;<i> &gt; By other hand, what can I do with those squid's crashes?
</I>&gt;<i> 
</I>&gt;<i> Please try the patch for bug 4864. That bug may be a duplicate of bug 4896,
</I>&gt;<i> and it has an unpolished/unofficial fix:
</I>
Let me know if I patched correctly:

~ (...)/squid-4.3-20181021-r17614d5# patch -p1 &lt; /etc/squid/debug/patches/SQUID-385-Comm_MonitorsRead-assertion-t3.patch
patching file src/FwdState.cc (without errors nor warnings)

make/make install and start Squid from systemd (i.e.: systemctl start squid.service) instead of gdb.

And now when I try to connect to site that made squid to crash, I get an error page from squid (instead of chrome page, like before) telling the same thing with different words: &quot;(...): (104) Connection reset by peer&quot;. And Squid does not crash.
Even doing a squid -k reconfigure and access again to that site, does not crash.

Anyway I am going to run squid via gdb again, and wait for a similar crash.

&gt;<i>   <A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=4864">https://bugs.squid-cache.org/show_bug.cgi?id=4864</A>
</I>&gt;<i> 
</I>&gt;<i> Please update bug 4896 to let us know whether bug 4864 fix worked for you
</I>&gt;<i> (including cases where the posted patch no longer applies).
</I>
I'll let you know if the patch definitely solves the bug , after test it few days.

Thank You!


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019541.html">[squid-users] Squid 4.3 assertion failed
</A></li>
	<LI>Next message (by thread): <A HREF="019518.html">[squid-users] Squid proxy not working when upgrade from 27 to 3.5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19543">[ date ]</a>
              <a href="thread.html#19543">[ thread ]</a>
              <a href="subject.html#19543">[ subject ]</a>
              <a href="author.html#19543">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
