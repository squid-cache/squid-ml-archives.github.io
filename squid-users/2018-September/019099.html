<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Transparent vs Tproxy: performance ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20vs%20Tproxy%3A%20performance%20%3F&In-Reply-To=%3C004801d442a5%2490ec9d90%24b2c5d8b0%24%40articatech.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019098.html">
   <LINK REL="Next"  HREF="019100.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Transparent vs Tproxy: performance ?</H1>
    <B>David Touzeau</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Transparent%20vs%20Tproxy%3A%20performance%20%3F&In-Reply-To=%3C004801d442a5%2490ec9d90%24b2c5d8b0%24%40articatech.com%3E"
       TITLE="[squid-users] Transparent vs Tproxy: performance ?">david at articatech.com
       </A><BR>
    <I>Sun Sep  2 10:13:16 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019098.html">[squid-users] Transparent vs Tproxy: performance ?
</A></li>
        <LI>Next message (by thread): <A HREF="019100.html">[squid-users] Transparent vs Tproxy: performance ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19099">[ date ]</a>
              <a href="thread.html#19099">[ thread ]</a>
              <a href="subject.html#19099">[ subject ]</a>
              <a href="author.html#19099">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Amos, 

Yes my question was &quot; if NAT is faster or slower than packet flow&quot; and yes you are right. 

&quot;Squid is not impacted to this question, this make sense.&quot;


I had a &quot;feeling&quot; (human sensation) - with 3.000 users that NAT was faster than Tproxy...

But you confirm that this is not relevant...

Best regards,


-----Message d'origine-----
De : squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; De la part de Amos Jeffries
Envoy&#233; : samedi 1 septembre 2018 17:07
&#192; : <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Objet : Re: [squid-users] Transparent vs Tproxy: performance ?

On 1/09/18 9:33 PM, David Touzeau wrote:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> We have 2 ways to make the squid in &#171; transparent mode. &#187;
</I>&gt;<i> 
</I>&gt;<i> The standard Transparent method and (with modern kernels)  the use of 
</I>&gt;<i> &#171; Tproxy &#187; method
</I>&gt;<i> 
</I>
Please clarify what this &quot;standard transparent&quot; thing is you referring to?

I suspect that you actually mean &quot;NAT&quot; which is completely separate from Squid and thus has no bearing on proxy performance.



&gt;<i> I would like to know which is the best according to the performance ?
</I>&gt;<i> 
</I>
This is a meaningless question. &quot;comparing apples to oranges&quot;, etc.

You might as well ask if NAT is faster or slower than packet flow?


Both NAT and TPROXY involve kernel managing tables of active connections and syscalls by Squid to search those tables on every accept(). Only the timing of those syscalls and the state listed in the tables differ. The limitations each imposes are more relevant than performance differences.

Specifically;

* TPROXY restricts the TCP ports available to clients to 31K, where normally they are 63K.

* NAT systems restrict ports to (63*M)/N where N is number of clients on the network, and M the number of IPs available to Squid outbound (usually 1).

As you can see those will impose a cap on both performance and capability of your network. How much is determined by your network size and traffic peak flows. Not by anything related to Squid.


Squid performance should be essentially the same for all traffic &quot;modes&quot;. It is driven by the HTTP features used in the messages happening, combined with what types of processing your config requires to be done on those messages.
So by crafting the very extreme types of message one can flood a Gbps network with a single HTTP request, or pass thousands of transactions quickly over a 56Kbps modem link.

Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019098.html">[squid-users] Transparent vs Tproxy: performance ?
</A></li>
	<LI>Next message (by thread): <A HREF="019100.html">[squid-users] Transparent vs Tproxy: performance ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19099">[ date ]</a>
              <a href="thread.html#19099">[ thread ]</a>
              <a href="subject.html#19099">[ subject ]</a>
              <a href="author.html#19099">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
