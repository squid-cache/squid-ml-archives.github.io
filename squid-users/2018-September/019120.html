<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid fails to bump where there are too many DNS names in SAN field
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20fails%20to%20bump%20where%20there%20are%20too%20many%20DNS%0A%20names%20in%20SAN%20field&In-Reply-To=%3Cf8f53369-c5ba-3536-aff0-3853ea9156ad%40urlfilterdb.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019119.html">
   <LINK REL="Next"  HREF="019113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid fails to bump where there are too many DNS names in SAN field</H1>
    <B>Marcus Kool</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20fails%20to%20bump%20where%20there%20are%20too%20many%20DNS%0A%20names%20in%20SAN%20field&In-Reply-To=%3Cf8f53369-c5ba-3536-aff0-3853ea9156ad%40urlfilterdb.com%3E"
       TITLE="[squid-users] Squid fails to bump where there are too many DNS names in SAN field">marcus.kool at urlfilterdb.com
       </A><BR>
    <I>Tue Sep  4 15:11:45 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019119.html">[squid-users] Squid fails to bump where there are too many DNS names in SAN field
</A></li>
        <LI>Next message (by thread): <A HREF="019113.html">[squid-users] Squid fails to bump where there are too many DNS names in SAN field
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19120">[ date ]</a>
              <a href="thread.html#19120">[ thread ]</a>
              <a href="subject.html#19120">[ subject ]</a>
              <a href="author.html#19120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 04/09/18 11:20, Amos Jeffries wrote:
&gt;<i> On 4/09/18 7:33 PM, Ahmad, Sarfaraz wrote:
</I>&gt;&gt;<i> With debug_options ALL,9 and retrieving just this page, I found the following relevant loglines (this is with an explicit CONNECT request) ,
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> ... skip TLS/1.2 clientHello arriving
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> Later on after about 10 secs
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 83,7| AsyncJob.cc(123) callStart: Ssl::PeekingPeerConnector status in: [ FD 12 job194686]
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 45,9| cbdata.cc(419) cbdataReferenceValid: 0xf67698
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 83,5| PeerConnector.cc(187) negotiate: SSL_connect session=0x122c430...
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 24,8| MemBlob.cc(101) memAlloc: blob1555830 memAlloc: requested=82887, received=82887
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 24,7| SBuf.cc(865) reAlloc: SBuf6002798 new store capacity: 82887
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 24,8| SBuf.cc(139) rawAppendStart: SBuf6002798 start appending up to 65535 bytes
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 83,5| bio.cc(140) read: FD 12 read 0 &lt;= 65535
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| 83,5| NegotiationHistory.cc(83) retrieveNegotiatedInfo: SSL connection info on FD 12 SSL version NONE/0.0 negotiated cipher
</I>&gt;&gt;<i> 2018/09/04 12:45:58.124 kid1| ERROR: negotiating TLS on FD 12: error:00000000:lib(0):func(0):reason(0) (5/0/0)
</I>&gt;<i> 
</I>&gt;<i> ... the server delivered 82KB of something which was not TLS/SSL syntax
</I>&gt;<i> according to OpenSSL.
</I>
I ran 'ufdbpeek', an OpenSSL-based utility that I wrote that peeks at the TLS certificate of a website and it displays a large correct certificate and that (in my case) cipher 
ECDHE-RSA-AES256-GCM-SHA384 is used.
OpenSSL 1.0.2k and 1.1.0g  have no issues with the certificate nor handshake.

Also sslLabs shows that all is well and that all popular modern browsers and OpenSSL 0.9.8 and 1.0.1 can connect to the site:
<A HREF="https://www.ssllabs.com/ssltest/analyze.html?d=www.extremetech.com">https://www.ssllabs.com/ssltest/analyze.html?d=www.extremetech.com</A>

Marcus

[...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019119.html">[squid-users] Squid fails to bump where there are too many DNS names in SAN field
</A></li>
	<LI>Next message (by thread): <A HREF="019113.html">[squid-users] Squid fails to bump where there are too many DNS names in SAN field
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19120">[ date ]</a>
              <a href="thread.html#19120">[ thread ]</a>
              <a href="subject.html#19120">[ subject ]</a>
              <a href="author.html#19120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
