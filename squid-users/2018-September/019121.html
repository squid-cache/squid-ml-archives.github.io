<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Kerberos%20helper%20leaking%20memory%20-%20OpenBSD%206.3&In-Reply-To=%3C7cdcb552-8393-40f0-0dd2-dd2a0fc53754%40coronamundi.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019117.html">
   <LINK REL="Next"  HREF="019123.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3</H1>
    <B>Silamael</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Kerberos%20helper%20leaking%20memory%20-%20OpenBSD%206.3&In-Reply-To=%3C7cdcb552-8393-40f0-0dd2-dd2a0fc53754%40coronamundi.de%3E"
       TITLE="[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3">silamael at coronamundi.de
       </A><BR>
    <I>Tue Sep  4 15:22:10 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019117.html">[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3
</A></li>
        <LI>Next message (by thread): <A HREF="019123.html">[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19121">[ date ]</a>
              <a href="thread.html#19121">[ thread ]</a>
              <a href="subject.html#19121">[ subject ]</a>
              <a href="author.html#19121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/04/2018 03:51 PM, Amos Jeffries wrote:
&gt;<i> On 5/09/18 1:24 AM, Silamael wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm currently investigating a memory leak in with the Kerberos negotiate
</I>&gt;&gt;<i> authentication helper in Squid 3.5.27 under OpenBSD 6.3. It's a own port
</I>&gt;&gt;<i> with added Kerberos support since OpenBSD's port does not support
</I>&gt;&gt;<i> Kerberos at all.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As library Heimdal 7.5.0 is used. So far I had no luck in finding the
</I>&gt;&gt;<i> memory leak itself.
</I>&gt;<i> 
</I>&gt;<i> Have you tried valgrind and either GCC or clang static analysis features
</I>&gt;<i> on your helper and/or library?
</I>
valgrind doesn't seem to work properly on OpenBSD. I get a bunch of 
nonsense output and then a segmentation fault...
What are the GCC/clang statistic features? I'm no C/C++ pro ;)

&gt;&gt;<i>
</I>&gt;&gt;<i> Would it be safe for Squid, to patch the helper code so that it does a
</I>&gt;&gt;<i> clean exit after every X processed requests?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Or will this bring new problems on Squid's side?
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Should be okay so long as the helpers do reply to at least some queries,
</I>&gt;<i> and do not exit all at once.
</I>&gt;<i> 
</I>&gt;<i> Squid-3.5 will log errors about helpers exiting unexpectedly, but should
</I>&gt;<i> only die if the helpers did so on their startup or many are dying within
</I>&gt;<i> a shifting 30sec window of time.
</I>At moment a helper will call exit(0) after 10000 requests. Don't know, 
how Squid distributes the requests over all helper processes and if we 
have too many helpers exiting within 30 seconds...
But good to know that there aren't any general objections.

&gt;<i> 
</I>&gt;<i> Squid-4 can use the auth_param on-persistent-overload=ERR option to
</I>&gt;<i> prevent even the death cases above.
</I>
Good to know.

-- Matthias

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019117.html">[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3
</A></li>
	<LI>Next message (by thread): <A HREF="019123.html">[squid-users] Squid Kerberos helper leaking memory - OpenBSD 6.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19121">[ date ]</a>
              <a href="thread.html#19121">[ thread ]</a>
              <a href="subject.html#19121">[ subject ]</a>
              <a href="author.html#19121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
