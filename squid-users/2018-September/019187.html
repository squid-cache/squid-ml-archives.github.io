<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.2 : caching is not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.2%20%3A%20caching%20is%20not%20working&In-Reply-To=%3Cd8d44413-51ca-6970-c1a6-00cbccd9d456%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019186.html">
   <LINK REL="Next"  HREF="019188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.2 : caching is not working</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.2%20%3A%20caching%20is%20not%20working&In-Reply-To=%3Cd8d44413-51ca-6970-c1a6-00cbccd9d456%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid 4.2 : caching is not working">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Sep 10 15:40:57 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019186.html">[squid-users] Squid 4.2 : caching is not working
</A></li>
        <LI>Next message (by thread): <A HREF="019188.html">[squid-users] Squid 4.2 : caching is not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19187">[ date ]</a>
              <a href="thread.html#19187">[ thread ]</a>
              <a href="subject.html#19187">[ subject ]</a>
              <a href="author.html#19187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/10/2018 09:03 AM, Hariharan Sethuraman wrote:

&gt;<i> 1) ok, the client does a GET /&lt;resource&gt; with authorization header. So I
</I>&gt;<i> cant cache unless I ask the site-owner to send the cache-control to
</I>&gt;<i> whatever it can enable the intermediate cache-server to persist it.
</I>&gt;<i> 2) Does squid-cache allow a way where I can upload the file into cache?
</I>
You may have one or two Squid-related options AFAICT:

1. Configure Squid to remove the authentication headers going to the
origin server (see request_header_access). If the origin server does not
actually require authentication for this specific resource, then Squid
will get a cachable response back. Assuming the server is not broken,
this approach is safe. However, this approach will _not_ work if the
server requires authentication for this resource.

2. Configure Squid to (use an adaptation service to) add Cache-Control
response headers that would allow Squid to cache the authenticated
response. Adding response headers pre-cache probably requires using an
adaptation service -- Squid itself does not have a directive that would
add response headers before the response is evaluated for cachability
(reply_header_access is a post-cache directive so it will not work
here). This approach should &quot;work&quot; regardless of the server behavior. As
Amos has said, this approach is _unsafe_ -- you may cache and share a
response with user-specific info in it. You should not do this unless
you are absolutely sure that the response is safe to share!

Changing the origin server behavior is the best option if it is
available to you.

Alex.


&gt;<i> On Mon, Sep 10, 2018 at 8:21 PM Amos Jeffries wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 11/09/18 2:27 AM, Hariharan Sethuraman wrote:
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; On Mon, 10 Sep 2018, 19:46 Amos Jeffries wrote:
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt;&#160; &#160; &#160;On 11/09/18 12:18 AM, Hariharan Sethuraman wrote:
</I>&gt;<i>     &gt;&#160; &#160; &#160;&gt; &#160;
</I>&gt;<i>     &gt;&#160; &#160; &#160;&gt; 2) With more debug_options enabled, I see that it is not caching
</I>&gt;<i>     &gt;&#160; &#160; &#160;because
</I>&gt;<i>     &gt;&#160; &#160; &#160;&gt; the response is part of authenticated flow. Is there a way I can
</I>&gt;<i>     &gt;&#160; &#160; &#160;&gt; override this?
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt;&#160; &#160; &#160;No. The server is supplying sufficient headers for caching to
</I>&gt;<i>     make it
</I>&gt;<i>     &gt;&#160; &#160; &#160;appear that the site authors intentionally are sending what
</I>&gt;<i>     does get
</I>&gt;<i>     &gt;&#160; &#160; &#160;delivered.
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; If I understand correctly, you are saying the caching will not be done
</I>&gt;<i>     &gt; on squid as the content is authorised by the specific client. We can't
</I>&gt;<i> 
</I>&gt;<i>     Authenticated, not authorized. This is one place where the difference
</I>&gt;<i>     matters.
</I>&gt;<i> 
</I>&gt;<i>     &gt; do anything until I ask site owners to change cache control as public?
</I>&gt;<i>     &gt;
</I>&gt;<i> 
</I>&gt;<i>     Pretty much, yes. I know Chrome at least used to deliver binaries whose
</I>&gt;<i>     installer contained details of the Google account of the user fetching
</I>&gt;<i>     it. So its not very safe to assume even downloaders are safely
</I>&gt;<i>     transferable.
</I>&gt;<i> 
</I>&gt;<i>     Amos
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019186.html">[squid-users] Squid 4.2 : caching is not working
</A></li>
	<LI>Next message (by thread): <A HREF="019188.html">[squid-users] Squid 4.2 : caching is not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19187">[ date ]</a>
              <a href="thread.html#19187">[ thread ]</a>
              <a href="subject.html#19187">[ subject ]</a>
              <a href="author.html#19187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
