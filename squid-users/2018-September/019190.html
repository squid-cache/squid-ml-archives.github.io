<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] About SSL peek-n-splice/bump configurations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20SSL%20peek-n-splice/bump%20configurations&In-Reply-To=%3C5400815d-9a82-97a9-5889-0e76c04a9ba0%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019189.html">
   <LINK REL="Next"  HREF="019198.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] About SSL peek-n-splice/bump configurations</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20SSL%20peek-n-splice/bump%20configurations&In-Reply-To=%3C5400815d-9a82-97a9-5889-0e76c04a9ba0%40measurement-factory.com%3E"
       TITLE="[squid-users] About SSL peek-n-splice/bump configurations">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Sep 10 19:46:33 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019189.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
        <LI>Next message (by thread): <A HREF="019198.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19190">[ date ]</a>
              <a href="thread.html#19190">[ thread ]</a>
              <a href="subject.html#19190">[ subject ]</a>
              <a href="author.html#19190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/10/2018 12:35 PM, Julian Perconti wrote:

&gt;<i> So, in a brief the confi is:
</I>&gt;<i> 
</I>&gt;<i> ssl_bump peek step1 all
</I>&gt;<i> ssl_bump peek step2 noBumpSites
</I>&gt;<i> ssl_bump stare step2 all
</I>
... which should be equivalent to an even simpler config:

  ssl_bump peek step1
  ssl_bump peek noBumpSites
  ssl_bump stare all

... which, for many reasonable definitions of noBumpSites (that match
during step1 if and only if they should match during step1), can be
simplified even further:

  ssl_bump peek noBumpSites
  ssl_bump stare all


However, please note that the three configs above implicitly rely on
Squid splicing (or bumping) at step3 because of the previously matching
step2 peek (or stare) action and the lack of an explicit step3 rule.
Whether Squid v4.2 actually does what it should be doing, I do not know.


&gt;<i> 1: Is this peek-n-splice ruleset insecure?
</I>
Define &quot;secure&quot;.


&gt;<i> 2: It is correct to say that those lines are not necessary/redundant?
</I>
They should be redundant, but I do not know whether Squid v4.2
implements this aspect of the specs correctly. I know that there were
related implementation bugs in some Squid v3 releases. You can test and,
if needed, file a bug report.


&gt;<i> (#ssl_bump splice step3 noBumpSites/#ssl_bump bump step3 all)
</I>
Please note that the meaning of your noBumpSites ACL changes from one
step to another (because it gets more/different info). Thus, it is
incorrect to say that

  ssl_bump peek step1
  ssl_bump peek step2 noBumpSites
  ssl_bump splice step3 noBumpSites
  ...

is always exactly equivalent to

  ssl_bump peek step1
  ssl_bump peek step2 noBumpSites
  ssl_bump splice step3 all # should be optional
  ...

When using the first configuration, it is possible that, in some
specific case, noBumpSites matches during step2 but does not match
during step3, and Squid proceeds to evaluating the remaining &quot;...&quot; rules
in that specific case. Such sequence of events is not possible in the
second configuration because splicing at step3 is unconditional there --
it does not rely on noBumpSites matches during step3.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019189.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
	<LI>Next message (by thread): <A HREF="019198.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19190">[ date ]</a>
              <a href="thread.html#19190">[ thread ]</a>
              <a href="subject.html#19190">[ subject ]</a>
              <a href="author.html#19190">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
