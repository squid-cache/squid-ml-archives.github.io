<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Delay pool not limiting each connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pool%20not%20limiting%20each%20connection&In-Reply-To=%3Cba3a2dff-8573-439d-d762-afc37365317a%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019234.html">
   <LINK REL="Next"  HREF="019242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Delay pool not limiting each connection</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Delay%20pool%20not%20limiting%20each%20connection&In-Reply-To=%3Cba3a2dff-8573-439d-d762-afc37365317a%40treenet.co.nz%3E"
       TITLE="[squid-users] Delay pool not limiting each connection">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Sep 17 15:02:10 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019234.html">[squid-users] Delay pool not limiting each connection
</A></li>
        <LI>Next message (by thread): <A HREF="019242.html">[squid-users] Delay pool not limiting each connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19235">[ date ]</a>
              <a href="thread.html#19235">[ thread ]</a>
              <a href="subject.html#19235">[ subject ]</a>
              <a href="author.html#19235">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/09/18 1:15 AM, Sekar Duraisamy wrote:
&gt;<i> Hello All,
</I>&gt;<i> 
</I>&gt;<i> I have tried to limit the bandwidth for each requests with 5Mbps speed
</I>&gt;<i> with below.
</I>&gt;<i> 
</I>&gt;<i> delay_pools 1
</I>&gt;<i> delay_class 1 2
</I>&gt;<i> delay_access 1 allow all
</I>&gt;<i> delay_parameters 1 625000/625000 625000/625000
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> But it is limiting total bandwidth of the squid only 625000 and not
</I>&gt;<i> allowing the same bandwdith for each and every requests coming through
</I>&gt;<i> squid.
</I>
Yes. That behaviour is exactly what you configured above.

  delay_parameters 1 aggregate individual


The &quot;aggregate&quot; is total bandwidth to be shared between individual
clients with each getting up to (but not exceeding) however much is
available.

By configuring aggregate and individual as exactly the same values you
have defined that any one client _could_ use the entire 625000 Bytes/sec
available. A second client only gets what that first one leaves unused.
A third only what those two leave unused, etc.

 ... which is exactly the &quot;class 1&quot; behaviour despite using a class 2
pool to do it.


To use a per-client limit, use a class 2 pools with an aggregate limit
of &quot;none&quot;.


Also, no delay pool limits per-request. They are per-network,
per-subnet, per-client, per-user, or per-tag.

The closest you will get to a per-request limit is to have an
external_acl_type helper tag each request with a unique &quot;tag=&quot;
identifier and use a class 5 pool.

However, please be aware that most traffic these days in HTTP/1.1 is
actually revalidation which only takes up a few hundred bytes, rarely
even a KB per-request. So having a Mbps per-request allocation is
pointless extra calculation and checking for a huge amount of requests.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019234.html">[squid-users] Delay pool not limiting each connection
</A></li>
	<LI>Next message (by thread): <A HREF="019242.html">[squid-users] Delay pool not limiting each connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19235">[ date ]</a>
              <a href="thread.html#19235">[ thread ]</a>
              <a href="subject.html#19235">[ subject ]</a>
              <a href="author.html#19235">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
