<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] About SSL peek-n-splice/bump configurations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20SSL%20peek-n-splice/bump%20configurations&In-Reply-To=%3C000901d45035%241ab16870%2450143950%24%40yahoo.com.ar%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019251.html">
   <LINK REL="Next"  HREF="019261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] About SSL peek-n-splice/bump configurations</H1>
    <B>Julian Perconti</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20SSL%20peek-n-splice/bump%20configurations&In-Reply-To=%3C000901d45035%241ab16870%2450143950%24%40yahoo.com.ar%3E"
       TITLE="[squid-users] About SSL peek-n-splice/bump configurations">vh1988 at yahoo.com.ar
       </A><BR>
    <I>Wed Sep 19 16:23:28 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019251.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
        <LI>Next message (by thread): <A HREF="019261.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19257">[ date ]</a>
              <a href="thread.html#19257">[ thread ]</a>
              <a href="subject.html#19257">[ subject ]</a>
              <a href="author.html#19257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>After a splice rule is applied, SslBump is over. No  more rules are 
</I>&gt;<i>checked. No more loops are iterated. Squid simply &quot;exits&quot; the  SslBump 
</I>&gt;<i>feature (and becomes a TCP tunnel).
</I>
How is that? What about the meaning of the ACL's at step1 when splice?

e.g.:
There only these two rules for ssl_bump statements:

ssl_bump step1 splice sitesAB
ssl_bump step1 splice SitesCD

I guess that here, Squid has to do 2 loops at outer/main loop to evaluate step1 twice, due to rules differs (sitesAB and sitesCD ACL) and see if both match to splice. 
Probably this example does not make sense: &quot;Why don't use just 1 ACL instead 2&quot;? But it is an example to understand and fix ideas.

Are You (perhaps) talking about the examples in the thread and not what happens &quot;in general&quot;?

&gt;<i> If noBumpSites matches at step2, then, yes, Squid will splice at step3 
</I>&gt;<i> by default. Otherwise, no; Squid will bump at step3 by default.
</I>
[... ]

You mentioned that explanation two times.
The question (maybe obvious) is: In which case the &quot;noBumpSites&quot; ACL could have not match? I mean if I tell a Squid: &quot;splice at step1 this.site.net&quot; How that matches can fail?
Maybe you refered in the case that a site is just not listed in the ACL.

&gt;<i> &gt;   ssl_bump splice noBumpSites # This line reachs a splice rule at step1
</I>&gt;<i> &gt;   ssl_bump stare
</I>&gt;<i> 
</I>&gt;<i> &gt; Squid is telling to the client: &quot;I will not touch any TLS byte. 
</I>&gt;<i> &gt; [...] I will do as many checks as possible then You will be connected...&quot;
</I>&gt;<i> 
</I>&gt;<i> The configuration above does not match your summary because the 
</I>&gt;<i> configuration has a &quot;stare&quot; action that may run at (step1 and) step2 
</I>&gt;<i> (and, hence, a possibility of the bump action at step3). Staring at
</I>&gt;<i> step2 and bumping (at any step) modify TLS bytes, of course.
</I>&gt;<i> 
</I>&gt;<i> Perhaps your summary only applies to the cases where noBumpSites 
</I>&gt;<i> matches (either at step1 or at step2), but the summary did not make 
</I>&gt;<i> that clear.
</I>
Here borns more ore less the same doubt like above and the final one.

&gt;<i> There is a big difference between explaining Squid actions for a 
</I>&gt;<i> particular transaction and summarizing what a particular configuration 
</I>&gt;<i> means (for all transactions). Unless noted otherwise, I am focusing on the latter.
</I>&gt;<i> 
</I>&gt;<i> AFAICT, the primary difference between
</I>&gt;<i> 
</I>&gt;<i>   ssl_bump peek noBumpSites
</I>&gt;<i>   ssl_bump stare
</I>&gt;<i> 
</I>&gt;<i> and
</I>&gt;<i> 
</I>&gt;<i>   ssl_bump splice noBumpSites
</I>&gt;<i>   ssl_bump stare
</I>&gt;<i> 
</I>&gt;<i> is that the former requires a noBumpSites match at step2 for the 
</I>&gt;<i> connections to be spliced.
</I>
Yes. The condition you say is mandatory but, again: Why that requirement could fail/no-match?

Thank You for the patience


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019251.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
	<LI>Next message (by thread): <A HREF="019261.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19257">[ date ]</a>
              <a href="thread.html#19257">[ thread ]</a>
              <a href="subject.html#19257">[ subject ]</a>
              <a href="author.html#19257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
