<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] external_acl_type LDAP for acl NOT related to auth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20external_acl_type%20LDAP%20for%20acl%20NOT%20related%20to%20auth&In-Reply-To=%3C593fa168-81b4-acb2-e14a-cc52d902f499%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019295.html">
   <LINK REL="Next"  HREF="019299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] external_acl_type LDAP for acl NOT related to auth</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20external_acl_type%20LDAP%20for%20acl%20NOT%20related%20to%20auth&In-Reply-To=%3C593fa168-81b4-acb2-e14a-cc52d902f499%40treenet.co.nz%3E"
       TITLE="[squid-users] external_acl_type LDAP for acl NOT related to auth">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Sep 24 23:08:36 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019295.html">[squid-users] external_acl_type LDAP for acl NOT related to auth
</A></li>
        <LI>Next message (by thread): <A HREF="019299.html">[squid-users] squid interception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19296">[ date ]</a>
              <a href="thread.html#19296">[ thread ]</a>
              <a href="subject.html#19296">[ subject ]</a>
              <a href="author.html#19296">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/09/18 7:48 AM, Marcio Vogel Merlone dos Santos wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Searched google but could not find anyone trying this. I want to use
</I>&gt;<i> some LDAP data to create an ACL not related to authentication or
</I>&gt;<i> users/groups. I want to create an ACL like this pseudo conf:
</I>&gt;<i> 
</I>&gt;&gt;<i> external_acl_type myServers ttl=300 ipv4 %SRC
</I>&gt;&gt;<i> /usr/lib/squid/ldap_lookup_acl -p
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> http_access allow myServers
</I>&gt;&gt;<i>
</I>&gt;<i> Where 'myServers' contains a list of machines that don't need to auth
</I>&gt;<i> the service, for example. Other uses would be to define a network list,
</I>&gt;<i> mac lists, people with youtube access, and so on. Is it possible, has
</I>&gt;<i> someone already made it, can anyone point me the direction?
</I>

Look at the example configuration for the eDirectory user-IP helper it
uses src-IP as &quot;username&quot; being looked up.
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_edirectory_userip_acl.html">http://www.squid-cache.org/Versions/v3/3.5/manuals/ext_edirectory_userip_acl.html</A>&gt;

Wrapping is currently broken in that doc, I've fixed that below for clarity:

  external_acl_type IPUser %SRC /usr/sbin/ext_edirectory_userip_acl

  acl edirectory_users_allowed external IPUser \
    cn=Internet_Allowed,ou=ORG,o=BASE

  acl edirectory_users_denied external IPUser \
    cn=Internet_Denied,ou=ORG,o=BASE

  http_access deny edirectory_users_denied
  http_access allow edirectory_users_allowed
  http_access deny all


The above config passes the LDAP path details as %DATA, so the helper
gets told to always use the src-IP as the &quot;username&quot; and each acl line
tells it which LDAP path/directory to check for that particular ACL
test. Allowing multiple tables for different whitelist or blacklist
checks by the same helper.


You may be able to use the above helper as-is, or use the existing AD
LDAP group helpers with %SRC in a similar way. Though the older AD
helpers probably need to use %g macro in the -f filter to specify where
the %DATA portion is to go.

Disclaimer: I have not tried this myself, so YMMV.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019295.html">[squid-users] external_acl_type LDAP for acl NOT related to auth
</A></li>
	<LI>Next message (by thread): <A HREF="019299.html">[squid-users] squid interception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19296">[ date ]</a>
              <a href="thread.html#19296">[ thread ]</a>
              <a href="subject.html#19296">[ subject ]</a>
              <a href="author.html#19296">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
