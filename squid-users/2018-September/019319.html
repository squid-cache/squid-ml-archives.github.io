<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Help: squid restarts and squidGuard die
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%3A%20squid%20restarts%20and%20squidGuard%20die&In-Reply-To=%3C%21%26%21AAAAAAAAAAAuAAAAAAAAAL3wsAcc8JBJkMCbPuiQMGEBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAAD3jhNc4xlaR6tlvz7g9NgqAQAAAAA%3D%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019273.html">
   <LINK REL="Next"  HREF="019245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Help: squid restarts and squidGuard die</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Help%3A%20squid%20restarts%20and%20squidGuard%20die&In-Reply-To=%3C%21%26%21AAAAAAAAAAAuAAAAAAAAAL3wsAcc8JBJkMCbPuiQMGEBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAAD3jhNc4xlaR6tlvz7g9NgqAQAAAAA%3D%40ngtech.co.il%3E"
       TITLE="[squid-users] Help: squid restarts and squidGuard die">eliezer at ngtech.co.il
       </A><BR>
    <I>Sat Sep 29 06:18:01 UTC 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019273.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
        <LI>Next message (by thread): <A HREF="019245.html">[squid-users] TCP_MISS/502 - audio stream - none default http ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19319">[ date ]</a>
              <a href="thread.html#19319">[ thread ]</a>
              <a href="subject.html#19319">[ subject ]</a>
              <a href="author.html#19319">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Gabriel,

 

The thread seems to me as a milestone in this mailing list and in Squid-Cache history.

&gt;<i>From what I understood there is an issue when SquidGuard receives a specific line from Squid.
</I>
In this whole long thread I have not seen any debug logs of what SquidGuard receives from Squid.

It&#8217;s crucial to understand what the issue is and why it happens regardless to whether SquidGuard is old or not.

Also it&#8217;s not related to an ICAP service or URL rewrite or external acl&#8230;

I do not remember by heart what debug log section is relevant but Amos and Alex should be able to direct us towards these.

When you will have the exact line that the url_rewrite helper receives we would be able to know and maybe understand some details.

For some admins this kind of setup is easy but.. any LDAP\NTLM\Kerberos related setup needs to be tested and I believe this is where you are at.

There is a possibility that SquidGuard as a url_rewrite helper doesn&#8217;t receive the relevant details it expects such as username or group.

The above can cause this issue.

 

If you can share with us the relevant line that SquidGuard receives and crashes it would help other admins who have yet to encounter it.

 

Eliezer

&#183;         I have a setup of above 800 users but&#8230; the cache features are tuned off and it&#8217;s only working for ACL checking.

 

 

----

 &lt;<A HREF="http://ngtech.co.il/lmgtfy/">http://ngtech.co.il/lmgtfy/</A>&gt; Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



 

From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Service MV
Sent: Monday, September 17, 2018 18:38
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Help: squid restarts and squidGuard die

 

Dear Ones, I draw on your experience in seeking help to determine whether or not it is possible to achieve the configuration I am looking for, due to a strange error I am having.

 

Before commenting on the bug I describe my testing environment:

- A VM CentOS 7 Core over VirtualBox 5.2, 1 NIC.

- My VM is attached to my domain W2012R2 (following this post <A HREF="https://www.rootusers.com/how-to-join-centos-linux-to-an-active-directory-domain/">https://www.rootusers.com/how-to-join-centos-linux-to-an-active-directory-domain/</A>) to achieve kerberos authentication transparent to the user. SElinux disabled. Owner permissions to user squid in all folders/files involved.

- squid 3.5.20 installed and working great with kerberos, NTLM and basic authentication. All authentication mechanisms tested and working great.

- SquidGuard: 1.4 Berkeley DB 5.3.21 installed and working great with blacklists and acl default.

 

My problem starts when I try to use source acl using ldapusersearch in squidGuard... 

 

systemctl status squid:

(squid-1)[12627]: The redirector helpers are crashing too rapidly, need help!

&lt;SNIP&gt;

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20180929/1cc3911a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20180929/1cc3911a/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 11308 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20180929/1cc3911a/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20180929/1cc3911a/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019273.html">[squid-users] About SSL peek-n-splice/bump configurations
</A></li>
	<LI>Next message (by thread): <A HREF="019245.html">[squid-users] TCP_MISS/502 - audio stream - none default http ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19319">[ date ]</a>
              <a href="thread.html#19319">[ thread ]</a>
              <a href="subject.html#19319">[ subject ]</a>
              <a href="author.html#19319">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
