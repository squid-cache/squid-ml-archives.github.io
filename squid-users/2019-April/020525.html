<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SQUID 4.6 - Kerberos Helper Error - FreeBSD
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SQUID%204.6%20-%20Kerberos%20Helper%20Error%20-%20FreeBSD&In-Reply-To=%3C002201d4f7bc%2458f328b0%240ad97a10%24%40bol.com.br%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020524.html">
   <LINK REL="Next"  HREF="020526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SQUID 4.6 - Kerberos Helper Error - FreeBSD</H1>
    <B>Fabricio Ferreira</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SQUID%204.6%20-%20Kerberos%20Helper%20Error%20-%20FreeBSD&In-Reply-To=%3C002201d4f7bc%2458f328b0%240ad97a10%24%40bol.com.br%3E"
       TITLE="[squid-users] SQUID 4.6 - Kerberos Helper Error - FreeBSD">guzzy at bol.com.br
       </A><BR>
    <I>Sat Apr 20 21:02:21 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020524.html">[squid-users] squid-users Digest, Vol 56, Issue 32
</A></li>
        <LI>Next message (by thread): <A HREF="020526.html">[squid-users] SQUID 4.6 - Kerberos Helper Error - FreeBSD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20525">[ date ]</a>
              <a href="thread.html#20525">[ thread ]</a>
              <a href="subject.html#20525">[ subject ]</a>
              <a href="author.html#20525">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Everyone,
Greetings.
Recently I had to upgrade my Squid to ver 4.6 - that&#180;s when my problems
started.
I can't use the KERBEROS helper anymore.
I am trying to use exactly the same configurtion I was using for Squid
3.5.27(by the way, I am using Squid with SAMBA 4.10 &#150; 
&gt;<i>From the command prompt, everything works fine. Keytab was successfully
</I>generated and it&#180;s working.
Also, NTLM is working fine with SQUID 4.6. It&#180;s just the KERBEROS who is
presenting errors)

Here my squid config (I always used this one with no issues)

#### NEGOTIATE KERBEROS AUTHENTICATION #### a
uth_param negotiate program /usr/local/libexec/squid/negotiate_kerberos_auth
-d -i -s mailto:HTTP/<A HREF="https://lists.squid-cache.org/listinfo/squid-users">server25.kontroldeb.corp at KONTROLDEB.CORP</A> 
auth_param negotiate children 10 startup=5 idle=2
auth_param negotiate keep_alive on

 #### STARTING CUSTOM ACLs #### 
acl auth proxy_auth REQUIRED 

#### STARTING CUSTOM AUTHORIZATION ACL ### 
http_access allow auth

***********************************************
Here the error messages (logs)
*****************************************
2019/04/20 17:59:52 kid1| Starting Squid Cache version 4.6 for
amd64-portbld-freebsd12.0...
2019/04/20 17:59:52 kid1| Service Name: squid
negotiate_kerberos_auth.cc(489): pid=93354 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Starting version 3.1.0sq
negotiate_kerberos_auth.cc(489): pid=93688 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Starting version 3.1.0sq
negotiate_kerberos_auth.cc(548): pid=93688 :negotiate_kerberos_auth.cc(489):
pid=93875 :negotiate_kerberos_auth.cc(548): pid=93354 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Setting keytab to /etc/krb5.keytab
negotiate_kerberos_auth.cc(489): pid=94044 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Starting version 3.1.0sq
2019/04/20 17:59:52| negotiate_kerberos_auth: INFO: Setting keytab to
/etc/krb5.keytab
negotiate_kerberos_auth.cc(572): pid=93688 :negotiate_kerberos_auth.cc(548):
pid=93875 :negotiate_kerberos_auth.cc(572): pid=93354 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Changed keytab to
MEMORY:negotiate_kerberos_auth_93688
2019/04/20 17:59:52| negotiate_kerberos_auth: INFO: Setting keytab to
/etc/krb5.keytab
2019/04/20 17:59:52| negotiate_kerberos_auth: INFO: Changed keytab to
MEMORY:negotiate_kerberos_auth_93354
negotiate_kerberos_auth.cc(572): pid=93875 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Changed keytab to
MEMORY:negotiate_kerberos_auth_93875
2019/04/20 17:59:52| negotiate_kerberos_auth: INFO: Starting version 3.1.0sq
negotiate_kerberos_auth.cc(548): pid=94044 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Setting keytab to /etc/krb5.keytab
negotiate_kerberos_auth.cc(572): pid=94044 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Changed keytab to
MEMORY:negotiate_kerberos_auth_94044
negotiate_kerberos_auth.cc(489): pid=94248 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Starting version 3.1.0sq
negotiate_kerberos_auth.cc(548): pid=94248 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Setting keytab to /etc/krb5.keytab
negotiate_kerberos_auth.cc(572): pid=94248 :2019/04/20 17:59:52|
negotiate_kerberos_auth: INFO: Changed keytab to
MEMORY:negotiate_kerberos_auth_94248
2019/04/20 17:59:53| pinger: Initialising ICMP pinger ...
negotiate_kerberos_auth.cc(612): pid=93354 :2019/04/20 18:00:01|
negotiate_kerberos_auth: DEBUG: Got 'YR
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' from squid
(length: 2575).
negotiate_kerberos_auth.cc(679): pid=93354 :2019/04/20 18:00:01|
negotiate_kerberos_auth: DEBUG: Decode
'YIIHhAYGKwYBBQUCoIIHeDCCB3SgMDAuBgkqhkiC9xIBAgIGCSqGSIb3EgECAgYKKwYBBAGCNwI
CHgYKKwYBBAGCNwICCqKCBz4Eggc6YIIHNgYJKoZIhvcSAQICAQBuggclMIIHIaADAgEFoQMCAQ6
iBwMFACAAAACjggU2YYIFMjCCBS6gAwIBBaERGw9LT05UUk9MREVCLkNPUlCiLzAtoAMCAQKhJjA
kGwRIVFRQGxxrb250cm9sMjVkZXYua29udHJvbGRlYi5jb3Jwo4IE4TCCBN2gAwIBEqEDAgECooI
EzwSCBMsEgu4Ba4hHYkQrneobn+MXZqZcJCLwMO2Gx4l7wq4OGeDstei8C8jxhfeuwryCLsG+bU3
1OZq/EoHKRRJK/tVhpSPnrPeUclcyBLXiXqH8gCnucNae0oiXasEayFjsKzpqmf/Tl/KuU+dYKVi
dpt6NMQ+3v3hP9T6hiJt95UFODTuIMT62Yrum52ztXs2u0JwnCX/cV6gVuj6gT3jrVD84EptCLKA
nBrd+m11FV8xq8aI9A0TZD4G1Bq6Nn4WS2VoIqUptxN1jmPWR2hiy1xB12Yh5N/wn+txVgoyZ+Aq
OR4ENS6kJVxeI6ZqVcqp0HGojX01V1Jq695VOzNw85nUkduczbTcdBx/xAP0M17X2EO5G7hDDsx+
BJ3mqRIok75CmzDLDF8jC7v3ZLwNvAlJRFS0RoFQiwB/hdN60t1pqetQTkGqlbF4GeXF/9HW8pW/
YiXvkAaQuepBkm/uOKSwF1KMpSGdoxGPBSL+VpwQ509whV1/HS/JQOB+Zbt/TbXuBgvdpCeK/AFf
Hd/BGtejN/k4BoHYAyEt1ApHpL1sEGNEBiK3LSsdHogxVRpQDrqv+jUMzph42HdJyLe52rfM8t7g
i6AlX/Ti5ss2/dBYZ10YTfixCekFxp/Rv9HPZYF4iWPz/L2DkZjBAjgwH8b8ZBUw581VjLkOs38V
FHU33wnoUY/jyyZAf52e+1uSoMuEhoMElMttR9g0s0jXBlfSEZ9N4sMiB/PF8+xefQieSQXCs37d
ahHewXmHctqoCF/+FTgmOK7zCqV9rAOSvq3fkAnaCMxVeiKpYLx4kf3XZlyhT8+l9k9Clz5V2VoT
dHWU1AJf99t8NEtertk1x7qO5eBFGugaWARykmLzLx18bwsOf1YomL1dpOhfq2DllTRRpZMV2m71
6oqne8iBDXpYm+wKuDV21j3t6MYF/iF7kkZU+ZXj35FVrPcPFoKOHHWsubCeGSJm5MXr4TrX+8si
Ip9LeLNAFVr3mcLhnb+5CxmpRo6+LUfg4bkhk9vGzytB9PxHPxrmCBegj0R8NXQn+b4GJekAZDsR
3FAgMawQwNcPc159RHGOkS8r6y4rZ2WU5F2VPuKUtpsUhbSmybD4J7CGZ2NgGXmuD67affV7X8i7
Tygb4qhmxbzjLnUeGvK1lcCD4tVgMPOpskhYK7bHc0MstWqdQZjJSidn33j9xn9IPBGcD2U9hMeS
ToGMxBP9h5vuEpRJuFOqbQOtoH+AKsl7lyhSqjil2t7bTS1Ao1+WcYst2tGvgFd8RpUILsQ9Swne
i//otQcnKw7PnMRtt6F0fXtMyjeFB8887HhmCfcnOMcA10xZ5ytrdgdWYmxFPaOAZhZpnbAocLd/
sxN2Kp2D1yGuvc6ioMOPRa8CzuBjbCy64VUbnC4Jhuf0SDcjvlJY2/EnqOjKSpFSP+GJyCtOgTBf
AWZI9K7cKSJ+zV12rhiqxeoHKj7nhLW4VxQ7jcP/pXPMXXSHSaFdGyie24UvuzjQSP28Rm4uH0Hk
v01psSVyX1t3X4zlq3FHzQMUMxHAeXobd0JCIxozZ8zKfyOjf/uNZjvrldcHujFfxvRUrI67q5VX
/qKnkxjtUdGvjmhZvi1bLheHVDiD5gAHQwcRICN3oeP2Dpu2kggHQMIIBzKADAgESooIBwwSCAb9
oaIF8EJ5Cq/22K8eKhEu/lhtFToakRCPvYYPhpInyylc3mFvS1d+HS915J1GJ43aWdNS/Acmc+cl
N8eooEpB5Yz2LpOj2op121UuA9OMuMsrxeymchWyr+McY+NDgRyBbgAL5jJce6vYG48aGYkzT8Jq
1eo16uZSIAVztyB/B09w3wVUHlRIUkNLKQoZWmA/mmN5OZrVX0KN6pYaz7zxEKUtheNpJ/sAiHvH
OMWiOUwhlxAFH++1EcuMvfzj+MMGOuCpwhfU+vBTFaiiVcVcFl31FnkW3jwh6BflpFnryLXJOFUc
42k03T1g7fArpdGX7h8sMharVxRPKg9H5j3+e+Sm3aBC/p2Xwl414mh/fsuUsjsxKYAheC9pGmsF
i5yk3tZ3+NUQfPJcLyIH/vISG4lFrBJtz690o2x/PuhgOrefmXV+vnFJ1OD06kV955ayFr0GxWz+
ArtSVKqmBi8jt8/+1ZmFrfW5JzslV9Evqb5on6OtxgokvRPFl2r+fm37g8PmvIA1L8cX3moP6UTP
rS2mBPxLlwubPUlstuk4RyvOQx4jtU0ToGDH8DZRZA78JaseKphULfJqVWWDJhK8=' (decoded
length estimate: 1929).
2019/04/20 18:00:01 kid1| WARNING: negotiateauthenticator #Hlpr1 exited
2019/04/20 18:00:01 kid1| FATAL: The negotiateauthenticator helpers are
crashing too rapidly, need help!

2019/04/20 18:00:01 kid1| Squid Cache (Version 4.6): Terminated abnormally.
CPU Usage: 0.066 seconds = 0.049 user + 0.016 sys
Maximum Resident Size: 105984 KB
Page faults with physical i/o: 0

##########################################

Anyone else having the same issue after upgrade to SQUID 4.6? (FreeBSD)

Any help is very welcome!
Thanks Much!
Fabricio.




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020524.html">[squid-users] squid-users Digest, Vol 56, Issue 32
</A></li>
	<LI>Next message (by thread): <A HREF="020526.html">[squid-users] SQUID 4.6 - Kerberos Helper Error - FreeBSD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20525">[ date ]</a>
              <a href="thread.html#20525">[ thread ]</a>
              <a href="subject.html#20525">[ subject ]</a>
              <a href="author.html#20525">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
