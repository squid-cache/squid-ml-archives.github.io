<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 3.5.27 not caching at all
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.27%20not%20caching%20at%20all&In-Reply-To=%3CCAK4%3Dzaui-Uun8a2RDrqapBcN45AeKb4c-MROk0RGwCu0FZAagA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020844.html">
   <LINK REL="Next"  HREF="020847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 3.5.27 not caching at all</H1>
    <B>Mohamed Ali Ahmed</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%203.5.27%20not%20caching%20at%20all&In-Reply-To=%3CCAK4%3Dzaui-Uun8a2RDrqapBcN45AeKb4c-MROk0RGwCu0FZAagA%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid 3.5.27 not caching at all">mbile20 at gmail.com
       </A><BR>
    <I>Sat Aug  3 13:18:50 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020844.html">[squid-users] Squid 3.5.27 not caching at all
</A></li>
        <LI>Next message (by thread): <A HREF="020847.html">[squid-users] Squid 3.5.27 not caching at all
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20845">[ date ]</a>
              <a href="thread.html#20845">[ thread ]</a>
              <a href="subject.html#20845">[ subject ]</a>
              <a href="author.html#20845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> You have not provided enough information for us to know whether this is
</I>&gt;<i> a problem or testing mistake.
</I>&gt;<i>
</I>&gt;<i> What is this unstated &quot;minimal change&quot; you made that made caching
</I>&gt;<i> suddenly stop working?
</I>
 The only change i have made is adding NOC ACL and uncommenting the
cache_dir ufs.

What exactly does &quot;visiting the same website over and over again&quot; mean?
&gt;<i> what exact actions did you do?
</I>&gt;<i>
</I>I expected when i visit a website for the time it will miss and after
retrieving it that squid will cache it internally. if i visit the same
website again, squid to read it from the local cache. i was visiting by
adding a new tap using chrome or visiting from another browser like MS edge
or IE.

Please do not do that &quot;allow all&quot;.
&gt;<i>
</I>&gt;<i> For one thing it makes your NOC ACL pointless, *everybody* is allowed to
</I>&gt;<i> use your proxy for whatever they want to do.
</I>&gt;<i>
</I>&gt;<i> If you did it to debug a caching problem, be aware that http_access has
</I>&gt;<i> nothing to do with cache.
</I>
Thank you amos, I have changed to  http_access deny all   instead of
http_access allow all
 Please ask me anything else i should share with so that you can help me.
thank you.

&gt;<i>
</I>&gt;<i>
</I>
 - Pressing refresh, Shift+reload, or CTL+refresh in a browser will
&gt;<i> *force* a MISS - yet comes under the description you gave.
</I>&gt;<i>   - some tools send headers to forbid cached contents being delivered by
</I>&gt;<i> default. So cannot be used for this kind of test without special options.
</I>&gt;<i>
</I>So what do you recommend i do in order to check if squid is caching or not?



On Sat, Aug 3, 2019 at 3:02 PM &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>&gt;
wrote:

&gt;<i> Send squid-users mailing list submissions to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of squid-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: sending certificate chain from squid reverse proxy
</I>&gt;<i>       (Martin Hoffmann)
</I>&gt;<i>    2. Squid 3.5.27 not caching at all (Mohamed Ali Ahmed)
</I>&gt;<i>    3. Re: Squid 3.5.27 not caching at all (Amos Jeffries)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Fri, 2 Aug 2019 13:08:50 -0500 (CDT)
</I>&gt;<i> From: Martin Hoffmann &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">m.hoffmann.bs at googlemail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] sending certificate chain from squid
</I>&gt;<i>         reverse proxy
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">1564769330895-0.post at n4.nabble.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=us-ascii
</I>&gt;<i>
</I>&gt;<i> Any ETA on this?
</I>&gt;<i>
</I>&gt;<i> This would really be a nice feature, since on debian/ubuntu squid comes
</I>&gt;<i> with
</I>&gt;<i> GnuTLS support, while OpenSSL Support means recompiling from source. So for
</I>&gt;<i> me, it seems, intermediate certificates is the last thing missing to be
</I>&gt;<i> able
</I>&gt;<i> to use squid/GnuTLS instead of squid/OpenSSL.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Sent from:
</I>&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Sat, 3 Aug 2019 12:45:14 +0300
</I>&gt;<i> From: Mohamed Ali Ahmed &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">mbile20 at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: [squid-users] Squid 3.5.27 not caching at all
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAK4=zavgzFG=yMv=+SCid3FB5VnNfXE5xYs5361r8PeE-c=
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">y3Q at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i> Hello everyone,
</I>&gt;<i> I have set up Squid 3.5.27 on ubuntu 18.04 from the packages. I have made
</I>&gt;<i> the minimal change but when i check the access.log i get tcp_miss 200 most
</I>&gt;<i> of the websites even visiting the same website over and over again.
</I>&gt;<i>
</I>&gt;<i> I have searched online and i did not come across any which solves my
</I>&gt;<i> problem.
</I>&gt;<i>
</I>&gt;<i> this is squid.conf file:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squid</A>:/etc/squid# sed 's/#.*//;s/^\s*$//;/^$/d' /etc/squid/squid.conf
</I>&gt;<i>  acl NOC src 154.73.26.5
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80
</I>&gt;<i> acl Safe_ports port 21
</I>&gt;<i> acl Safe_ports port 443
</I>&gt;<i> acl Safe_ports port 70
</I>&gt;<i> acl Safe_ports port 210
</I>&gt;<i> acl Safe_ports port 1025-65535
</I>&gt;<i> acl Safe_ports port 280
</I>&gt;<i> acl Safe_ports port 488
</I>&gt;<i> acl Safe_ports port 591
</I>&gt;<i> acl Safe_ports port 777
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access allow localhost manager
</I>&gt;<i> http_access deny manager
</I>&gt;<i> http_access allow localhost NOC
</I>&gt;<i> http_access allow all
</I>&gt;<i> http_port 3128
</I>&gt;<i> cache_dir ufs /var/spool/squid 100 16 256
</I>&gt;<i> coredump_dir /var/spool/squid
</I>&gt;<i> refresh_pattern -i \.(gif|png|jpg|jpeg|ico)$ 3600       90%     43200
</I>&gt;<i> refresh_pattern ^ftp:           1440    20%     10080
</I>&gt;<i> refresh_pattern ^gopher:        1440    0%      1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
</I>&gt;<i> refresh_pattern (Release|Packages(.gz)*)$      0       20%     2880
</I>&gt;<i> refresh_pattern .               0       20%     4320
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squid</A>:/etc/squid#
</I>&gt;<i>
</I>&gt;<i> here's access.log file:
</I>&gt;<i>
</I>&gt;<i> 1564825166.134    426 154.73.26.5 TCP_MISS/200 10644 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.layeranimation.min.js">http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.layeranimation.min.js</A>
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 application/javascript
</I>&gt;<i> 1564825166.142    436 154.73.26.5 TCP_MISS/200 8613 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.slideanims.min.js">http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.slideanims.min.js</A>
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 application/javascript
</I>&gt;<i> 1564825166.150    440 154.73.26.5 TCP_MISS/200 8771 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.navigation.min.js">http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.navigation.min.js</A>
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 application/javascript
</I>&gt;<i> 1564825166.156    450 154.73.26.5 TCP_MISS/200 2892 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.actions.min.js">http://somaliren.org/wp-content/plugins/revslider/public/assets/js/extensions/revolution.extension.actions.min.js</A>
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 application/javascript
</I>&gt;<i> 1564825166.804    454 154.73.26.5 TCP_MISS/200 7970 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/fonts/revicons/revicons.woff">http://somaliren.org/wp-content/plugins/revslider/public/assets/fonts/revicons/revicons.woff</A>
</I>&gt;<i> ?
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 font/woff
</I>&gt;<i> 1564825166.821    437 154.73.26.5 TCP_MISS/200 2982 GET
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://somaliren.org/wp-content/plugins/revslider/public/assets/assets/loader.gif">http://somaliren.org/wp-content/plugins/revslider/public/assets/assets/loader.gif</A>
</I>&gt;<i> - HIER_DIRECT/192.185.31.191 image/gif
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Here's cach.log file:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squid</A>:/etc/squid# tail /var/log/squid/cache.log
</I>&gt;<i> 2019/08/03 12:05:00 kid1|         0 Objects expired.
</I>&gt;<i> 2019/08/03 12:05:00 kid1|         0 Objects cancelled.
</I>&gt;<i> 2019/08/03 12:05:00 kid1|         0 Duplicate URLs purged.
</I>&gt;<i> 2019/08/03 12:05:00 kid1|         0 Swapfile clashes avoided.
</I>&gt;<i> 2019/08/03 12:05:00 kid1|   Took 0.10 seconds (  0.00 objects/sec).
</I>&gt;<i> 2019/08/03 12:05:00 kid1| Beginning Validation Procedure
</I>&gt;<i> 2019/08/03 12:05:00 kid1|   Completed Validation Procedure
</I>&gt;<i> 2019/08/03 12:05:00 kid1|   Validated 0 Entries
</I>&gt;<i> 2019/08/03 12:05:00 kid1|   store_swap_size = 0.00 KB
</I>&gt;<i> 2019/08/03 12:05:01 kid1| storeLateRelease: released 0 objects
</I>&gt;<i>
</I>&gt;<i> Any help would be appreciated.
</I>&gt;<i>
</I>&gt;<i> thanks,
</I>&gt;<i> Mohamed
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190803/28c6e860/attachment-0001.html">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190803/28c6e860/attachment-0001.html</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Sat, 3 Aug 2019 22:36:28 +1200
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Squid 3.5.27 not caching at all
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">1294aefe-7fb1-e096-3adb-511ccdc6f9be at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 3/08/19 9:45 pm, Mohamed Ali Ahmed wrote:
</I>&gt;<i> &gt; Hello everyone,
</I>&gt;<i> &gt; I have set up Squid 3.5.27 on ubuntu 18.04 from the packages. I have
</I>&gt;<i> &gt; made the minimal change but when i check the access.log i get tcp_miss
</I>&gt;<i> &gt; 200 most of the websites even visiting the same website over and over
</I>&gt;<i> again.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> You have not provided enough information for us to know whether this is
</I>&gt;<i> a problem or testing mistake.
</I>&gt;<i>
</I>&gt;<i> What is this unstated &quot;minimal change&quot; you made that made caching
</I>&gt;<i> suddenly stop working?
</I>&gt;<i>
</I>&gt;<i> What exactly does &quot;visiting the same website over and over again&quot; mean?
</I>&gt;<i> what exact actions did you do?
</I>&gt;<i>   - Pressing refresh, Shift+reload, or CTL+refresh in a browser will
</I>&gt;<i> *force* a MISS - yet comes under the description you gave.
</I>&gt;<i>   - some tools send headers to forbid cached contents being delivered by
</I>&gt;<i> default. So cannot be used for this kind of test without special options.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The more specific details you can give, the better anyone help can be.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I have searched online and i did not come across any which solves my
</I>&gt;<i> &gt; problem.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; this is squid.conf file:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at squid</A>:/etc/squid# sed 's/#.*//;s/^\s*$//;/^$/d'
</I>&gt;<i> /etc/squid/squid.conf
</I>&gt;<i> &gt;  acl NOC src 154.73.26.5
</I>&gt;<i> &gt; acl SSL_ports port 443
</I>&gt;<i> &gt; acl Safe_ports port 80
</I>&gt;<i> &gt; acl Safe_ports port 21
</I>&gt;<i> &gt; acl Safe_ports port 443
</I>&gt;<i> &gt; acl Safe_ports port 70
</I>&gt;<i> &gt; acl Safe_ports port 210
</I>&gt;<i> &gt; acl Safe_ports port 1025-65535
</I>&gt;<i> &gt; acl Safe_ports port 280
</I>&gt;<i> &gt; acl Safe_ports port 488
</I>&gt;<i> &gt; acl Safe_ports port 591
</I>&gt;<i> &gt; acl Safe_ports port 777
</I>&gt;<i> &gt; acl CONNECT method CONNECT
</I>&gt;<i> &gt; http_access deny !Safe_ports
</I>&gt;<i> &gt; http_access deny CONNECT !SSL_ports
</I>&gt;<i> &gt; http_access allow localhost manager
</I>&gt;<i> &gt; http_access deny manager
</I>&gt;<i> &gt; http_access allow localhost NOC
</I>&gt;<i> &gt; http_access allow all
</I>&gt;<i>
</I>&gt;<i> Please do not do that &quot;allow all&quot;.
</I>&gt;<i>
</I>&gt;<i> For one thing it makes your NOC ACL pointless, *everybody* is allowed to
</I>&gt;<i> use your proxy for whatever they want to do.
</I>&gt;<i>
</I>&gt;<i> If you did it to debug a caching problem, be aware that http_access has
</I>&gt;<i> nothing to do with cache.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of squid-users Digest, Vol 60, Issue 4
</I>&gt;<i> ******************************************
</I>&gt;<i>
</I>

-- 


Mohamed Ali Ahmed (Bile)
Head of Systems
Somali Research &amp; Education Network (SomaliREN)
+252 615 567671
Skype: bilesuper
Web:   <A HREF="http://www.somaliren.org">http://www.somaliren.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190803/c29f759a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190803/c29f759a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020844.html">[squid-users] Squid 3.5.27 not caching at all
</A></li>
	<LI>Next message (by thread): <A HREF="020847.html">[squid-users] Squid 3.5.27 not caching at all
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20845">[ date ]</a>
              <a href="thread.html#20845">[ thread ]</a>
              <a href="subject.html#20845">[ subject ]</a>
              <a href="author.html#20845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
