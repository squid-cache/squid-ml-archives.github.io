<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] HAProxy + Squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HAProxy%20%2B%20Squid&In-Reply-To=%3Cffa02b37-bd94-3e49-4040-2be2852203b9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020858.html">
   <LINK REL="Next"  HREF="020895.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] HAProxy + Squid</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HAProxy%20%2B%20Squid&In-Reply-To=%3Cffa02b37-bd94-3e49-4040-2be2852203b9%40treenet.co.nz%3E"
       TITLE="[squid-users] HAProxy + Squid">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Aug  9 06:45:30 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020858.html">[squid-users] HAProxy + Squid
</A></li>
        <LI>Next message (by thread): <A HREF="020895.html">[squid-users] HAProxy + Squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20863">[ date ]</a>
              <a href="thread.html#20863">[ thread ]</a>
              <a href="subject.html#20863">[ subject ]</a>
              <a href="author.html#20863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/08/19 1:44 am, neok wrote:
&gt;<i> Hi, I finally did the configuration differently. It's working very well for
</I>&gt;<i> me.
</I>&gt;<i> 
</I>
What you are doing is polluting every HTTP message with two new headers.

The way Rafael suggested is more efficient since the PROXY protocol
details are only delivered at the start of each TCP connection, and HTTP
messages do not need to be reformatted at the LB as they pass.

Note that Squid will be extending that XFF header itself anyway. But
with your way the LB IP address will be broadcast to the origin(s) in
the XFF header along with the client address. With PROXY protocol Squid
adds only the client address there.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020858.html">[squid-users] HAProxy + Squid
</A></li>
	<LI>Next message (by thread): <A HREF="020895.html">[squid-users] HAProxy + Squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20863">[ date ]</a>
              <a href="thread.html#20863">[ thread ]</a>
              <a href="subject.html#20863">[ subject ]</a>
              <a href="author.html#20863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
