<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ACL reply_header_access
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20reply_header_access&In-Reply-To=%3C25a5b27e-e8e4-949a-666d-f5fcf9b5c0f6%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021418.html">
   <LINK REL="Next"  HREF="021421.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ACL reply_header_access</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20reply_header_access&In-Reply-To=%3C25a5b27e-e8e4-949a-666d-f5fcf9b5c0f6%40treenet.co.nz%3E"
       TITLE="[squid-users] ACL reply_header_access">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Dec  5 08:49:21 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021418.html">[squid-users] ACL reply_header_access
</A></li>
        <LI>Next message (by thread): <A HREF="021421.html">[squid-users] TCP_TUNNEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21420">[ date ]</a>
              <a href="thread.html#21420">[ thread ]</a>
              <a href="subject.html#21420">[ subject ]</a>
              <a href="author.html#21420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/12/19 1:29 pm, creditu wrote:
&gt;<i> We have been using several squid servers in accelerator mode for a number of years mainly for load balancing to send public requests to backend servers.  The requests to the squids typically come via a well known commercial  caching service.   The squids don't do any caching, they just forward requests to the backend.
</I>&gt;<i> 
</I>&gt;<i> I need to remove the  X-Content-Type-Options: nosniff reply header when it's only going to a specific service that queries our web farm.
</I>&gt;<i>
</I>
Okay.

&gt;<i> I believe I can remove it from all replies by using reply_header_access X-Content-Type-Options deny all.  But, I need an ACL that will only remove it from those responses going to that service (client).
</I>&gt;<i> 
</I>&gt;<i> I'm used to writing ACLs based on Internet to our farm requests not the outbound to the clients.  I'm having trouble getting my head around the logic on the acl directives to use.  Do I need to look at the reply headers and craft the ACL based on that?   Can you write and ACL based on the original request from the client?
</I>
There is no difference in the ACL themselves beyond what data they have
available depends on when in the transaction the directive using them
occurs.

When Squid needs to decide something there is usually a directive to
assist with the decision. reply_header_access is indeed the one to use
when deciding what HTTP reply headers get delivered to the client.


&gt;<i> 
</I>&gt;<i> What I'd like to be able to do is write a acl that does not send back the X-Content-Type header to the client that requested: <A HREF="https://www.example.com/sound/ID/text/abcde.txt.">https://www.example.com/sound/ID/text/abcde.txt.</A>  
</I>
What you need to do is find an ACL which identifies the particular
client. eg 'src' ACL is simplest if the service IP is not shared or
changing. Otherwise you may need some other detail visible in the HTTP
request headers or TCP state.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021418.html">[squid-users] ACL reply_header_access
</A></li>
	<LI>Next message (by thread): <A HREF="021421.html">[squid-users] TCP_TUNNEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21420">[ date ]</a>
              <a href="thread.html#21420">[ thread ]</a>
              <a href="subject.html#21420">[ subject ]</a>
              <a href="author.html#21420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
