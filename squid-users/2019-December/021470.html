<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 4.9 https isue...unable import certificate in browser
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%204.9%20https%20isue...unable%20import%20certificate%20in%0A%20browser&In-Reply-To=%3Cafa34625-caac-fc61-63a6-aadfede083b9%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021467.html">
   <LINK REL="Next"  HREF="021469.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 4.9 https isue...unable import certificate in browser</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%204.9%20https%20isue...unable%20import%20certificate%20in%0A%20browser&In-Reply-To=%3Cafa34625-caac-fc61-63a6-aadfede083b9%40measurement-factory.com%3E"
       TITLE="[squid-users] 4.9 https isue...unable import certificate in browser">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Dec 10 15:12:55 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021467.html">[squid-users] 4.9 https isue...unable import certificate in browser
</A></li>
        <LI>Next message (by thread): <A HREF="021469.html">[squid-users] HTTPS interception proxy having issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21470">[ date ]</a>
              <a href="thread.html#21470">[ thread ]</a>
              <a href="subject.html#21470">[ subject ]</a>
              <a href="author.html#21470">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/10/19 6:19 AM, aw_wolfe wrote:
&gt;<i> I have squid 4.9 built with https support in which I created a certificate
</I>&gt;<i> following tutorial. Squid starts, appears to be running fine. http whitelist
</I>&gt;<i> with user groups working....trying to add https support.
</I>&gt;<i> 
</I>&gt;<i> copy/paste from example of what I did to create certificate.
</I>&gt;<i> 
</I>&gt;<i> openssl req -new -newkey rsa:2048 -sha256 -days 365 -nodes -x509 -extensions
</I>&gt;<i> v3_ca -keyout myCA.pem  -out myCA.pem
</I>&gt;<i> 
</I>&gt;<i> certtool --generate-privkey --outfile ca-key.pem
</I>&gt;<i> 
</I>&gt;<i> certtool --generate-self-signed --load-privkey ca-key.pem --outfile myCA.pem
</I>
You seem to be combining/overlapping two alternative ways to generate a
CA certificate: OpenSSL and GnuTLS. To avoid surprises, I recommend
using either one or another. I cannot speak for GnuTLS, but I know that
the OpenSSL commands did work at some point in the past.


&gt;<i> 1) problem when trying to import myCA.der certificate into firefox: &quot;This is
</I>&gt;<i> not a certificate authority certificate, so it can&#8217;t be imported into the
</I>&gt;<i> certificate authority list&quot;
</I>
CA certificates have a &quot;true&quot; CA basic constraint. Double check that
your certificate has a true CA extension:

    $ openssl x509 -in myCA.pem -noout -text | \
      grep -A1 'Basic Constraints'
                X509v3 Basic Constraints:
                   CA:TRUE

By default, your modern browser or OS might not trust _you_ with
deciding which CAs it should trust. If that is the case, you will need
to find a way to bypass that built-in browser/OS &quot;safety net&quot;. Modern
browsers/OSes usually have a way to do that because their
corporate/government clients require such workarounds.


&gt;<i> 2) My goal is simply to whitelist sites, I do not have a need to view the
</I>&gt;<i> traffic. Is following ssl-bump examples the right/only approach or is easier
</I>&gt;<i> way to let the client connect directly, but preventing any connection except
</I>&gt;<i> if on the whitelist?
</I>
FWIW, I do not understand what you mean by &quot;let the client connect
directly&quot; and/or how that differs from some of the SslBump examples.
Please detail that part.

Today, the fake CA certificate is needed to enable SslBump. It will be
used to report errors (including blocked access) to users.

If you do not want to report any errors to users, then you do not need
to import your CA certificate into browsers (but you still need to give
that certificate to Squid -- it is a limitation of the current
implementation). In this case, you should configure your Squid to
terminate the from-client TLS connection on any error. Doing so may be
difficult -- there is no single directive that can do that for you.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021467.html">[squid-users] 4.9 https isue...unable import certificate in browser
</A></li>
	<LI>Next message (by thread): <A HREF="021469.html">[squid-users] HTTPS interception proxy having issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21470">[ date ]</a>
              <a href="thread.html#21470">[ thread ]</a>
              <a href="subject.html#21470">[ subject ]</a>
              <a href="author.html#21470">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
