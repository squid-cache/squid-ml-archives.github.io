<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cant download microsoft cert file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cant%20download%20microsoft%20cert%20file&In-Reply-To=%3C744b7a54-6697-68aa-6e04-dc51fb9f4ce6%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021509.html">
   <LINK REL="Next"  HREF="021511.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cant download microsoft cert file</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cant%20download%20microsoft%20cert%20file&In-Reply-To=%3C744b7a54-6697-68aa-6e04-dc51fb9f4ce6%40treenet.co.nz%3E"
       TITLE="[squid-users] cant download microsoft cert file">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Dec 14 22:35:18 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021509.html">[squid-users] cant download microsoft cert file
</A></li>
        <LI>Next message (by thread): <A HREF="021511.html">[squid-users] cant download microsoft cert file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21510">[ date ]</a>
              <a href="thread.html#21510">[ thread ]</a>
              <a href="subject.html#21510">[ subject ]</a>
              <a href="author.html#21510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/12/19 4:21 am, robert k Wild wrote:
&gt;<i> so this is my config file -
</I>&gt;<i> 
</I>&gt;<i> #
</I>&gt;<i> # Recommended minimum configuration:
</I>&gt;<i> #
</I>&gt;<i> 
</I>&gt;<i> #SSL
</I>&gt;<i> http_port 3128 ssl-bump \
</I>&gt;<i> cert=/usr/local/squid/etc/ssl_cert/myCA.pem \
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
</I>
&gt;<i> sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s
</I>&gt;<i> /var/lib/ssl_db -M 4MB
</I>
&gt;<i> acl step1 at_step SslBump1
</I>&gt;<i> ssl_bump peek step1
</I>&gt;<i> ssl_bump bump all
</I>&gt;<i> 
</I>
(elided default localnet and port ACL definitions)

&gt;<i> 
</I>&gt;<i> #
</I>&gt;<i> # Recommended minimum Access Permission configuration:
</I>&gt;<i> #
</I>&gt;<i> # Deny requests to certain unsafe ports
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> 
</I>&gt;<i> # Deny CONNECT to other than secure SSL ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> 
</I>&gt;<i> # Only allow cachemgr access from localhost
</I>&gt;<i> http_access allow localhost manager
</I>&gt;<i> http_access deny manager
</I>&gt;<i> 
</I>&gt;<i> # We strongly recommend the following be uncommented to protect innocent
</I>&gt;<i> # web applications running on the proxy server who think the only
</I>&gt;<i> # one who can access services on &quot;localhost&quot; is a local user
</I>&gt;<i> #http_access deny to_localhost
</I>&gt;<i> 
</I>&gt;<i> #
</I>&gt;<i> # INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
</I>&gt;<i> #
</I>
  ^^^ HINT.

&gt;<i> 
</I>&gt;<i> # Example rule allowing access from your local networks.
</I>&gt;<i> # Adapt localnet in the ACL section to list your (internal) IP networks
</I>&gt;<i> # from where browsing should be allowed
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> 
</I>&gt;<i> # Squid normally listens to port 3128
</I>&gt;<i> http_port 3128
</I>&gt;<i> 
</I>
This is the second port 3128 config, and it does not match the earlier one.


&gt;<i> 
</I>&gt;<i> as you can see i have removed the whitelist/mime config lines
</I>&gt;<i> 
</I>&gt;<i> but when i come into activating office it just cant get online to do it
</I>&gt;<i> via the client app installed on my pc
</I>
If that is still happening with this default config I would be starting
to suspect things outside of Squid. Like firewall or routing rules, the
client app not supporting proxies properly - stuff like that.

Though 403 in the proxy log does indicate an explicitly forbidden
action. The way you truncated the log line cut away most of the useful
info that points at where to focus the troubleshooting efforts.


&gt;<i> 
</I>&gt;<i> but internet isnt blocked as i can go to any website
</I>&gt;<i> 
</I>
Do you want it to work with the whitelisting ACL you mentioned?

If yes, then you do need to show at least the http_access directives
using it and the exact entry you added for the microsoft.com domain(s).

Same for the &quot;mime&quot; config lines you mention, but for those any part of
it could be relevant so we will need to see the whole of that stuff.


You have omitted the default &quot;http_access deny all&quot; which should be the
last http_access line in your config. Not a problem in the config as
shown, but if you have other rules they can change the implicit default
into a bad situation very easily.



Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021509.html">[squid-users] cant download microsoft cert file
</A></li>
	<LI>Next message (by thread): <A HREF="021511.html">[squid-users] cant download microsoft cert file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21510">[ date ]</a>
              <a href="thread.html#21510">[ thread ]</a>
              <a href="subject.html#21510">[ subject ]</a>
              <a href="author.html#21510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
