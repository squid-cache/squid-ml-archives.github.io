<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP-Workers%20%2B%20Rock%20Cache%20not%20caching%20as%20much%20as%0A%20SMP-Workers%20%2B%20AUFS&In-Reply-To=%3C3bc48a45-6558-8897-db49-be56e7e347d5%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020098.html">
   <LINK REL="Next"  HREF="020121.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP-Workers%20%2B%20Rock%20Cache%20not%20caching%20as%20much%20as%0A%20SMP-Workers%20%2B%20AUFS&In-Reply-To=%3C3bc48a45-6558-8897-db49-be56e7e347d5%40treenet.co.nz%3E"
       TITLE="[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Feb  6 12:30:26 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020098.html">[squid-users] SMP-Workers + Rock Cache not caching as much as	SMP-Workers + AUFS
</A></li>
        <LI>Next message (by thread): <A HREF="020121.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20105">[ date ]</a>
              <a href="thread.html#20105">[ thread ]</a>
              <a href="subject.html#20105">[ subject ]</a>
              <a href="author.html#20105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/02/19 11:14 pm, Lucolo wrote:
&gt;<i> Hi everybody
</I>&gt;<i> 
</I>&gt;<i> I'm having some problems trying to best tune efficient web caching with
</I>&gt;<i> Squid.
</I>&gt;<i> 
</I>&gt;<i> After several configurations I realized that in my case SMP-Workers + AUFS
</I>&gt;<i> is more efficiente than SMP-Workers + Rock Cache.
</I>
Do you understand why that is?


&gt;<i> 
</I>&gt;<i> I tried to use the same parameters and options in both cases, just to make
</I>&gt;<i> sure no options was different, apart from Rock or AUFS.
</I>&gt;<i> 
</I>&gt;<i> These are my files:
</I>&gt;<i> Workers + AUFS:
</I>&gt;<i> squid_SMP_Workers_AUFS.conf
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/squid_SMP_Workers_AUFS.conf">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/squid_SMP_Workers_AUFS.conf</A>&gt;  
</I>&gt;<i> 
</I>&gt;<i> Workers + Rock Cache:
</I>&gt;<i> squid_CARP_SMP_Workers_Rock.conf
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/squid_CARP_SMP_Workers_Rock.conf">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/squid_CARP_SMP_Workers_Rock.conf</A>&gt;  
</I>&gt;<i> frontend.conf
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/frontend.conf">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/frontend.conf</A>&gt;  
</I>&gt;<i> backend.conf
</I>&gt;<i> &lt;<A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/backend.conf">http://squid-web-proxy-cache.1019090.n4.nabble.com/file/t377658/backend.conf</A>&gt;  
</I>&gt;<i> 
</I>
Er, those are vastly different configurations. The cache_dir parameters
may be the same, but the traffic flowing through has major differences.

The AUFS setup:
 - 4 workers operating independent of each other in full parallel.
 - any sized object allowed to cache.
 - TCP connection based load balancing by the OS.

The Rock setup:
 - all traffic funneled through one worker
 - 4 workers operating with shared caches.
 - objects larger than 131072 bytes not permitted to cache.
 - CARP load balancing selectively channels objects by URL to particular
worker.



&gt;<i> For example, my outputs:
</I>&gt;<i> 
</I>&gt;<i> Cache information for squid SMP-Workers + AUFS:
</I>&gt;<i>         Hits as % of all requests:      5min: 19.3%, 60min: 24.6%
</I>&gt;<i>         Hits as % of bytes sent:        5min: 8.6%, 60min: 13.3%
</I>&gt;<i>         Memory hits as % of hit requests:       5min: 0.0%, 60min: 0.0%
</I>&gt;<i>         Disk hits as % of hit requests: 5min: 65.1%, 60min: 66.4%
</I>&gt;<i> Files: Number of file desc currently in use: 6971
</I>&gt;<i> 
</I>&gt;<i> Cache information for squid SMP-Workers + Rock Cache:
</I>&gt;<i>         Hits as % of all requests:      5min: 4.6%, 60min: 5.3%
</I>&gt;<i>         Hits as % of bytes sent:        5min: 0.8%, 60min: 0.6%
</I>&gt;<i>         Memory hits as % of hit requests:       5min: 12.2%, 60min: 11.7%
</I>&gt;<i>         Disk hits as % of hit requests: 5min: 22.7%, 60min: 21.7%
</I>&gt;<i> Files: Number of file desc currently in use: 7366
</I>
Those numbers need to be placed in context of how much traffic is going
through each proxy.

For some reason you are not getting any memory hits in the AUFS setup.
Whereas &gt;10% of the traffic in the rock setup is not being slowed down
by the disk access.


&gt;<i> 
</I>&gt;<i> The question is, is there any plus config or option I have to configure in
</I>&gt;<i> rock cache to force more web caching, at least the same as AUFS
</I>&gt;<i> configuration?
</I>
That question does not make much sense. There is no option to force
caching with AUFS - so &quot;at least the same&quot; is already true in regards to
what you are asking for.


You missed out the rest of the squid -v output which says what
particular version and vendor build (or not) you are using.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020098.html">[squid-users] SMP-Workers + Rock Cache not caching as much as	SMP-Workers + AUFS
</A></li>
	<LI>Next message (by thread): <A HREF="020121.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20105">[ date ]</a>
              <a href="thread.html#20105">[ thread ]</a>
              <a href="subject.html#20105">[ subject ]</a>
              <a href="author.html#20105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
