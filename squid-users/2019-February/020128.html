<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP-Workers%20%2B%20Rock%20Cache%20not%20caching%20as%20much%20as%0A%20SMP-Workers%20%2B%20AUFS&In-Reply-To=%3C49bcb069-31ab-38ae-4b7b-adfc6f81cd4f%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020121.html">
   <LINK REL="Next"  HREF="020129.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SMP-Workers%20%2B%20Rock%20Cache%20not%20caching%20as%20much%20as%0A%20SMP-Workers%20%2B%20AUFS&In-Reply-To=%3C49bcb069-31ab-38ae-4b7b-adfc6f81cd4f%40measurement-factory.com%3E"
       TITLE="[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Feb  8 09:13:18 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020121.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
        <LI>Next message (by thread): <A HREF="020129.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20128">[ date ]</a>
              <a href="thread.html#20128">[ thread ]</a>
              <a href="subject.html#20128">[ subject ]</a>
              <a href="author.html#20128">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/7/19 01:21, Lucolo wrote:

&gt;<i> I follow your manual just to configure &quot;CARP Cluster of SMP workers with
</I>&gt;<i> rock&quot;, so I assume this is a working configuration
</I>&gt;<i> <A HREF="https://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster">https://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster</A>
</I>
FWIW, that old configuration should not be used except, perhaps, in some 
highly unusual/rare use cases. You are probably _not_ dealing with such 
a case.


&gt;<i> Since it's the basic configuration Squid recommends,
</I>
It is not basic and it is not generally recommended (despite being 
published on a Squid wiki).

Most modern SMP setups should use multiple workers and multiple Rock 
diskers, without SMP macros in squid.conf. The exact number of workers 
and diskers depends on the number of physical CPU cores, desired hit 
ratio, and actual workload -- there is no &quot;one size fits all&quot; formula. 
However, you may be able to start with

   W=C-2
   D=1

where W is the number of SMP workers, D is the number of rock cache_dir 
lines (i.e. the number of diskers), and C is the &quot;number of otherwise 
idle physical CPU cores&quot; on the Squid box. If your disker becomes 
overloaded, increase D (and probably decrease W) and/or reduce disk 
load. You can find more information at

   * <A HREF="https://wiki.squid-cache.org/Features/SmpScale">https://wiki.squid-cache.org/Features/SmpScale</A>

   * The tuning section of
     <A HREF="https://wiki.squid-cache.org/Features/RockStore">https://wiki.squid-cache.org/Features/RockStore</A>

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020121.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
	<LI>Next message (by thread): <A HREF="020129.html">[squid-users] SMP-Workers + Rock Cache not caching as much as SMP-Workers + AUFS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20128">[ date ]</a>
              <a href="thread.html#20128">[ thread ]</a>
              <a href="subject.html#20128">[ subject ]</a>
              <a href="author.html#20128">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
