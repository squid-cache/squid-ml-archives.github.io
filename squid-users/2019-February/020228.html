<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] | Ignoring non-issuer CA from ... while squid	-kparse
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%7C%20Ignoring%20non-issuer%20CA%20from%20...%20while%20squid%0A%09-kparse&In-Reply-To=%3C0e6c01d4cc40%24a1e3ef70%24e5abce50%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020225.html">
   <LINK REL="Next"  HREF="020241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] | Ignoring non-issuer CA from ... while squid	-kparse</H1>
    <B>eliezer at ngtech.co.il</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%7C%20Ignoring%20non-issuer%20CA%20from%20...%20while%20squid%0A%09-kparse&In-Reply-To=%3C0e6c01d4cc40%24a1e3ef70%24e5abce50%24%40ngtech.co.il%3E"
       TITLE="[squid-users] | Ignoring non-issuer CA from ... while squid	-kparse">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Feb 24 12:58:26 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020225.html">[squid-users] | Ignoring non-issuer CA from ... while squid -kparse
</A></li>
        <LI>Next message (by thread): <A HREF="020241.html">[squid-users] [squid-announce] Squid 4.6 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20228">[ date ]</a>
              <a href="thread.html#20228">[ thread ]</a>
              <a href="subject.html#20228">[ subject ]</a>
              <a href="author.html#20228">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I assume it's fine in general since it works.
I will try to run a request with openssl to see what is the certificate chain that I'm receiving.
The issue is that it's a special &quot;redirect all&quot; proxy for filtering only blacklisted domains.
So the squid receives all SSL requests and denies them with a 302 to another server so it's hard
for me to see in the browser if the chain received is full.

Thanks,
Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>


-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of Amos Jeffries
Sent: Sunday, February 24, 2019 10:14
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] | Ignoring non-issuer CA from ... while squid -kparse

On 24/02/19 3:36 pm, eliezer wrote:
&gt;<i> I am testing intermediate  certificates and I have just created a key
</I>&gt;<i> and certificate files.
</I>&gt;<i> 
</I>&gt;<i> The http line for ssl bump is:
</I>&gt;<i> 
</I>&gt;<i> http_port 23128 ssl-bump generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=16MB  cert=/etc/squid/ssl_cert/cert.pem
</I>&gt;<i> key=/etc/squid/ssl_cert/key.pem
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> While running squid -kparse I get the next output:
</I>&gt;<i> 
</I>&gt;<i> 2019/02/24 04:28:03| Using certificate in /etc/squid/ssl_cert/cert.pem
</I>&gt;<i> 
</I>&gt;<i> 2019/02/24 04:28:03| Using certificate chain in /etc/squid/ssl_cert/cert.pem
</I>&gt;<i> 
</I>&gt;<i> 2019/02/24 04:28:03| Ignoring non-issuer CA from
</I>&gt;<i> /etc/squid/ssl_cert/cert.pem: /C=IL/ST=Shomron/O=NgTech
</I>&gt;<i> LTD/CN=pxaa13a65c.ngtech.co.il
</I>&gt;<i> 
</I>&gt;<i> ## END OF OUTPUT SNIPPET
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I am not sure how to look at this.
</I>&gt;<i> 
</I>&gt;<i> I am almost sure I did something wrong, maybe when I created the root CA
</I>&gt;<i> or the intermidate?
</I>&gt;<i> 
</I>

Since you are not using a self-signed cert Squid is checking the
cert.pem file to see if any chain CAs exist in there.

Squid found one CA cert in the file and determined that it was not an
Issuer to place in the chain *after* the known signing CA.


Since this is the same file the cert= value came from you should expect
the first thing that it finds is the signing CA cert. That already
exists in the known bit of chain and is not its own Issuer. So should be
skipped.


&gt;<i>From your description the root CA was next in the chain and already
</I>configured into the Browser. So you should not see any chain info
actually loaded for this setup. Though if you want to send even the root
CA you could add it to the file and Squid would send the full chain.


There is only a problem if:

 * the file being loaded is not one you wanted to load,
or
 * the displayed CN is something you did not expect to see in that file, or
 * the CA with that CN supposed to be part of the CA chain which
signed/issued your cert= certificate.
  - Issuer sequence broken, or
  - Issuer sequence missing an entry, or
  - CAs not in correct chain order in the file.

Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020225.html">[squid-users] | Ignoring non-issuer CA from ... while squid -kparse
</A></li>
	<LI>Next message (by thread): <A HREF="020241.html">[squid-users] [squid-announce] Squid 4.6 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20228">[ date ]</a>
              <a href="thread.html#20228">[ thread ]</a>
              <a href="subject.html#20228">[ subject ]</a>
              <a href="author.html#20228">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
