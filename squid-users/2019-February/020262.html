<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Any way to get the client's connecting port number?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Any%20way%20to%20get%20the%20client%27s%20connecting%20port%20number%3F&In-Reply-To=%3C1000353910.6201625.1551302530657%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020279.html">
   <LINK REL="Next"  HREF="020264.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Any way to get the client's connecting port number?</H1>
    <B>Russel McDonald</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Any%20way%20to%20get%20the%20client%27s%20connecting%20port%20number%3F&In-Reply-To=%3C1000353910.6201625.1551302530657%40mail.yahoo.com%3E"
       TITLE="[squid-users] Any way to get the client's connecting port number?">russel_mcdonald at swbell.net
       </A><BR>
    <I>Wed Feb 27 21:22:10 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020279.html">[squid-users] HTTP2
</A></li>
        <LI>Next message (by thread): <A HREF="020264.html">[squid-users] Any way to get the client's connecting port	number?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20262">[ date ]</a>
              <a href="thread.html#20262">[ thread ]</a>
              <a href="subject.html#20262">[ subject ]</a>
              <a href="author.html#20262">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, is there any way to get the port number of the connecting client available to the adapter through ECAP interface? Not just the IP but the port number as well. I found that I can do that by a tiny change but it has to be int he squid source:In adaptation\ecap\XActionRep.cc, method clientIpValue:I added the sprintf:sprintf(&amp;ntoabuf[strlen(ntoabuf)], &quot;:%d&quot;, client_addr.port());&#160; &#160; &#160; &#160; &#160; &#160; return libecap::Area::FromTempBuffer(ntoabuf, strlen(ntoabuf));
The adapter then has access to the client's connecting port. I use that information to then look up the PID of the connecting process and hence user, using a Windows dll and method with increased privs.
So is there any existing way to get that port without a squid change? And if not then would the team be amenable to my joining as a dev contributor and submitting that? It could be as a separate value/option so as to not break any existing apps relying on that particular string just having the IP.
Russel McDonald
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190227/6da25550/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190227/6da25550/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020279.html">[squid-users] HTTP2
</A></li>
	<LI>Next message (by thread): <A HREF="020264.html">[squid-users] Any way to get the client's connecting port	number?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20262">[ date ]</a>
              <a href="thread.html#20262">[ thread ]</a>
              <a href="subject.html#20262">[ subject ]</a>
              <a href="author.html#20262">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
