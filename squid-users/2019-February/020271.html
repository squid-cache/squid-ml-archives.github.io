<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Disable tls1.3 support , can't get SNI / cert details when it's used
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Disable%20tls1.3%20support%20%2C%0A%20can%27t%20get%20SNI%20/%20cert%20details%20when%20it%27s%20used&In-Reply-To=%3C44a02e5c-a17c-bdc2-32a6-23d257d4d245%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020269.html">
   <LINK REL="Next"  HREF="020244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Disable tls1.3 support , can't get SNI / cert details when it's used</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Disable%20tls1.3%20support%20%2C%0A%20can%27t%20get%20SNI%20/%20cert%20details%20when%20it%27s%20used&In-Reply-To=%3C44a02e5c-a17c-bdc2-32a6-23d257d4d245%40treenet.co.nz%3E"
       TITLE="[squid-users] Disable tls1.3 support , can't get SNI / cert details when it's used">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Feb 28 01:52:04 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020269.html">[squid-users] Disable tls1.3 support , can't get SNI / cert details when it's used
</A></li>
        <LI>Next message (by thread): <A HREF="020244.html">[squid-users] /64 ipv6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20271">[ date ]</a>
              <a href="thread.html#20271">[ thread ]</a>
              <a href="subject.html#20271">[ subject ]</a>
              <a href="author.html#20271">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/02/19 12:25 pm, Stilyan Georgiev wrote:
&gt;<i> When testing like so: openssl s_client -connect google.com:443
</I>&gt;<i> I get tls1.2 back
</I>&gt;<i> 
</I>&gt;<i> Via mobile chrome browser (android) and the proxy I get tls1.3
</I>&gt;<i> Truly don't understand :)
</I>&gt;<i> 
</I>
I expect that Chrome is using their own custom SSL library and HTTP/3
protocol which does not go through Squid.

The openssl test will be strictly using a single TCP connection with a
CONNECT tunnels through your Squid. The SSL-Bump process you have setup
will be bumpign that and Squid begotiating teh TLS versio you have
configured.

The Chrome on the other hand may be negotiating TLS/1.3 handshake via
side channels and then resuming it as a normal TLS session resumption
over the Squid connection, OR possibly not even going via the proxy at
all (aka QUIC, HTTP/3).

Google products also has a preference for using Googles custom SSL
library rather than OpenSSL - so your custom OpenSSL may not be relevant
at the client endpoint. Whereas the openssl tools will be naturally be
using libssl like Squid.


If you are not using SSL-Bump in the way(s) indicated previously by
Alex, then your custom OpenSSL build and squid.conf options are
irrelevant. The CONNECT traffic would be going straight through the
proxy without being touched. To have any control over TLS the proxy must
be an _active_ agent participating in the TLS handshake.

HTH
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020269.html">[squid-users] Disable tls1.3 support , can't get SNI / cert details when it's used
</A></li>
	<LI>Next message (by thread): <A HREF="020244.html">[squid-users] /64 ipv6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20271">[ date ]</a>
              <a href="thread.html#20271">[ thread ]</a>
              <a href="subject.html#20271">[ subject ]</a>
              <a href="author.html#20271">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
