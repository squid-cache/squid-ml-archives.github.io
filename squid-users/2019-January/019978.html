<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 4.5, can't download certificate?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.5%2C%20can%27t%20download%20certificate%3F&In-Reply-To=%3C99ca5193-8868-1c93-1064-1ede4e0edeef%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019977.html">
   <LINK REL="Next"  HREF="019984.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 4.5, can't download certificate?</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%204.5%2C%20can%27t%20download%20certificate%3F&In-Reply-To=%3C99ca5193-8868-1c93-1064-1ede4e0edeef%40treenet.co.nz%3E"
       TITLE="[squid-users] squid 4.5, can't download certificate?">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jan 18 17:08:52 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019977.html">[squid-users] squid 4.5, can't download certificate?
</A></li>
        <LI>Next message (by thread): <A HREF="019984.html">[squid-users] squid 4.5, can't download certificate?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19978">[ date ]</a>
              <a href="thread.html#19978">[ thread ]</a>
              <a href="subject.html#19978">[ subject ]</a>
              <a href="author.html#19978">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/01/19 4:31 am, Alex Rousskov wrote:
&gt;<i> On 1/18/19 4:35 AM, Dmitry Melekhov wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 17.01.2019 21:02, Alex Rousskov &#1087;&#1080;&#1096;&#1077;&#1090;:
</I>&gt;&gt;&gt;<i> On 1/16/19 10:30 PM, Dmitry Melekhov wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 2019/01/17 09:18:21 kid1| ERROR: negotiating TLS on FD 55:
</I>&gt;&gt;&gt;&gt;<i> error:14090086:SSL routines:ssl3_get_server_certificate:certificate
</I>&gt;&gt;&gt;&gt;<i> verify failed (1/-1/0)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In access log:
</I>&gt;&gt;&gt;&gt;<i> 1547702300.945&#160;&#160;&#160;&#160;&#160; 0 192.168.22.229 NONE/503 329 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lkk-udm.esplus.ru/Services/Auth.asmx/Safe?">https://lkk-udm.esplus.ru/Services/Auth.asmx/Safe?</A> dm HIER_NONE/-
</I>&gt;&gt;&gt;&gt;<i> text/html
</I>&gt;&gt;&gt;&gt;<i> 1547702301.304&#160;&#160;&#160;&#160; 84 - TCP_MISS/404 162 GET
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://crt.sectigo.com/SectigoRSADomainValidationSecureServerCA.crt-/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff-GETmyip=-myport=0">http://crt.sectigo.com/SectigoRSADomainValidationSecureServerCA.crt-/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff-GETmyip=-myport=0</A>
</I>&gt;&gt;&gt;&gt;<i> - HIER_DIRECT/91.199.212.52 text/html
</I>&gt;&gt;&gt;<i> Your Squid (or some helper) appears to be adding an
</I>&gt;&gt;&gt;<i> &quot;-/ffff...GETmyip=-myport=0&quot; suffix to the crt.sectigo.com URL,
</I>&gt;&gt;&gt;<i> resulting in a 404 response from that server.
</I>&gt;<i> 
</I>&gt;&gt;<i> Yes, I suspected this, there is no helper which can add this, as far as
</I>&gt;&gt;<i> I know
</I>&gt;<i> 
</I>

These mangled URLs are the expected result of a URL-rewrite/redirector
helper written to use the long ago deprecated Squid-1.x version of
helper protocol. Being used in a Squid configured to allow whitespace in
URLs.

When those two features are combined there is no way for Squid to
identify garbage after the end of URL in helper 1.0 syntax response,
from a v2.x syntax response with whitespace in the URL.

Squid-3.5 and later are only backward compatible to the Squid-2.0 helper
protocol. The older syntax is no longer supported at all.


Details of the Squid helper protocol can be found at
&lt;<A HREF="https://wiki.squid-cache.org/Features/AddonHelpers#URL_manipulation">https://wiki.squid-cache.org/Features/AddonHelpers#URL_manipulation</A>&gt;.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019977.html">[squid-users] squid 4.5, can't download certificate?
</A></li>
	<LI>Next message (by thread): <A HREF="019984.html">[squid-users] squid 4.5, can't download certificate?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19978">[ date ]</a>
              <a href="thread.html#19978">[ thread ]</a>
              <a href="subject.html#19978">[ subject ]</a>
              <a href="author.html#19978">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
