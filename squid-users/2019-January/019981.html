<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] https debug
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20debug&In-Reply-To=%3C01e701d4b10d%24af2389a0%240d6a9ce0%24%40ngtech.co.il%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019878.html">
   <LINK REL="Next"  HREF="019985.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] https debug</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20https%20debug&In-Reply-To=%3C01e701d4b10d%24af2389a0%240d6a9ce0%24%40ngtech.co.il%3E"
       TITLE="[squid-users] https debug">eliezer at ngtech.co.il
       </A><BR>
    <I>Sun Jan 20 22:15:42 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="019878.html">[squid-users] https debug
</A></li>
        <LI>Next message (by thread): <A HREF="019985.html">[squid-users] https debug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19981">[ date ]</a>
              <a href="thread.html#19981">[ thread ]</a>
              <a href="subject.html#19981">[ subject ]</a>
              <a href="author.html#19981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You probably meant 4.5...
<A HREF="http://www1.ngtech.co.il/repo/centos/7/x86_64/squid-4.5-1.el7.x86_64.rpm">http://www1.ngtech.co.il/repo/centos/7/x86_64/squid-4.5-1.el7.x86_64.rpm</A>

Eliezer

----
Eliezer Croitoru
Linux System Administrator
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">eliezer at ngtech.co.il</A>



-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
Sent: Wednesday, January 2, 2019 12:01
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] https debug

On 2/01/19 10:30 pm, Sampei wrote:
&gt;<i> About way to use https protocol I think I use connect tunnel, here
</I>
When a CONNECT tunnel is being used and not SSL-Bump'ed then all TLS
related issues are problems with one of the endpoint software. Not
related to the proxy at all. Squid is just blindly relaying the TLS
bytes as-is between the endpoints.

That said, some specific configs may encounter issues due to explicitly
telling Squid to do certain things which cannot be done to CONNECT
tunnels (eg. URL-rewrite, ACL checks of path strings), or to deny the
CONNECT which obviously would make the TLS not &quot;work&quot; at all.


I suspect that in your case some other port is involved which you do not
know about and are thus not letting through Squid. The access.log should
show what Squid is dealing with there.


&gt;<i> parttial of my squid.conf
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> acl SSL_ports port 443          # https
</I>&gt;<i> acl SSL_ports port 563          # snews
</I>&gt;<i> ...
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i> ...
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>
Okay, but should be following the Safe_ports check. The default config
orders these checks by how common it is to encounter the attack types
they exist to prevent.

&gt;<i> http_access deny CONNECT !Safe_ports
</I>
The default config uses this instead:

 http_access deny !Safe_ports

The purpose of this Safe_ports ACL is to prevent the proxy handling
*any* traffic for protocols whose traffic syntax directly conflicts with
HTTP traffic syntax.

By limiting this check to only CONNECT messages, you are opening your
proxy to most of the attacks the Safe_port ACL was designed to prevent.



&gt;<i> acl test dstdomain example.com
</I>&gt;<i> http_access allow test
</I>&gt;<i> http_access allow CONNECT test
</I>
This latter is pointless. &quot;test&quot; was already allowed, so this line is
never reached by any traffic which it can match.


&gt;<i> I think to upgrade 4.x Squid but I'm looking for valid repository for
</I>&gt;<i> Centos 7 which contains this pkg.
</I>
The official repositories for CentOS are detailed at
&lt;<A HREF="https://wiki.squid-cache.org/KnowledgeBase/CentOS">https://wiki.squid-cache.org/KnowledgeBase/CentOS</A>&gt;

(I see that page needs an update Eliezer now has 4.4 in his main CentOS
repository &lt;<A HREF="http://www1.ngtech.co.il/repo/centos/7/x86_64/">http://www1.ngtech.co.il/repo/centos/7/x86_64/</A>&gt;)


Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="019878.html">[squid-users] https debug
</A></li>
	<LI>Next message (by thread): <A HREF="019985.html">[squid-users] https debug
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19981">[ date ]</a>
              <a href="thread.html#19981">[ thread ]</a>
              <a href="subject.html#19981">[ subject ]</a>
              <a href="author.html#19981">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
