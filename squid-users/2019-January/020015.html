<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20on%20openwrt%3A%20Possible%20to%20get%20rid%20of%20%22...%0A%20SECURITY%20ALERT%3A%20Host%20header%20forgery%20detected%20...%22%20msgs%20%3F&In-Reply-To=%3C1548251756880-0.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020014.html">
   <LINK REL="Next"  HREF="020017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?</H1>
    <B>reinerotto</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20on%20openwrt%3A%20Possible%20to%20get%20rid%20of%20%22...%0A%20SECURITY%20ALERT%3A%20Host%20header%20forgery%20detected%20...%22%20msgs%20%3F&In-Reply-To=%3C1548251756880-0.post%40n4.nabble.com%3E"
       TITLE="[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?">augustus_meyer at gmx.net
       </A><BR>
    <I>Wed Jan 23 13:55:56 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020014.html">[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?
</A></li>
        <LI>Next message (by thread): <A HREF="020017.html">[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20015">[ date ]</a>
              <a href="thread.html#20015">[ thread ]</a>
              <a href="subject.html#20015">[ subject ]</a>
              <a href="author.html#20015">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I suspect, these messages, for example, are not caused by any malware, but
somehow by skype:

2019/01/23 13:38:18 kid1| SECURITY ALERT: on URL:
mobile.pipe.aria.microsoft.com:443
2019/01/23 13:38:18 kid1| SECURITY ALERT: Host header forgery detected on
local=52.114.76.35:443 remote=192.168.182.10:59312 FD 31 flags=33 (local IP
does not match any domain IP)
2019/01/23 13:38:18 kid1| SECURITY ALERT: on URL:
mobile.pipe.aria.microsoft.com:443
2019/01/23 13:39:03 kid1| SECURITY ALERT: Host header forgery detected on
local=52.114.74.44:443 remote=192.168.182.10:59378 FD 37 flags=33 (local IP
does not match any domain IP)
2019/01/23 13:39:03 kid1| SECURITY ALERT: on URL:
mobile.pipe.aria.microsoft.com:443


May be,  some inconsistency of cached DNS in the client and the
openwrt-device, running squid.
There are some &quot;rumours&quot;, that not all browsers correctly honor TTL for
cached DNS.


Anyway, even, in case malware would trigger these messages, then this opens
the gate to attack resource limited squid-installations, like mine on
openwrt, by flooding cache.log, kept in RAM, and possibly forcing an
OOM-crash.
Simple fix would be to disable cache.log, but I am hesitating to do so, not
to drop more valuable messages.




--
Sent from: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020014.html">[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?
</A></li>
	<LI>Next message (by thread): <A HREF="020017.html">[squid-users] squid on openwrt: Possible to get rid of &quot;... SECURITY ALERT: Host header forgery detected ...&quot; msgs ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20015">[ date ]</a>
              <a href="thread.html#20015">[ thread ]</a>
              <a href="subject.html#20015">[ subject ]</a>
              <a href="author.html#20015">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
