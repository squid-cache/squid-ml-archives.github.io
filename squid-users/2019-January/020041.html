<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Only allow specific Users per Port
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Only%20allow%20specific%20Users%20per%20Port&In-Reply-To=%3CCANXaQcrGt1QrBGjE2x1ip79hqr3pPbSNMT3F_8Pw4k3hHH9ySg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020042.html">
   <LINK REL="Next"  HREF="020043.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Only allow specific Users per Port</H1>
    <B>Schokobecher</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Only%20allow%20specific%20Users%20per%20Port&In-Reply-To=%3CCANXaQcrGt1QrBGjE2x1ip79hqr3pPbSNMT3F_8Pw4k3hHH9ySg%40mail.gmail.com%3E"
       TITLE="[squid-users] Only allow specific Users per Port">schokobecher at gmail.com
       </A><BR>
    <I>Sat Jan 26 03:19:03 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020042.html">[squid-users] YouTube cache
</A></li>
        <LI>Next message (by thread): <A HREF="020043.html">[squid-users] Only allow specific Users per Port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20041">[ date ]</a>
              <a href="thread.html#20041">[ thread ]</a>
              <a href="subject.html#20041">[ subject ]</a>
              <a href="author.html#20041">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I'm struggling quite a bit with transitioning from basic_ncsa_auth to
basic_db_auth.
I have some ports where only certain users (sometimes just one) is allowed
to connect/pass the ACL check.

I'm running Squid 3.28 on Ubuntu

I have lines like this:
acl userA proxy_auth_regex -i userA

Which reads the htpasswd file and matches the user based on the regex.
Port config looks like this:

http_port 3201 name=3201
acl userA3201 myportname 3201
cache_peer example.com parent 3300 0 no-query no-digest proxy-only
standby=60 name=up01
cache_peer_access  up01  allow userA3201
never_direct allow userA3201
http_access allow  userA3201 userA

And that for multiple Ports.

I now want to transition to basic_db_auth and got it up and running, but
the problem is that the above does not work anymore. All authed users can
now connect to every port.

UserA can use Port 3201,3202,3206 for connecting to the proxy
UserB can't use these and only can use 3315

What is the best/cleanest way to regain the above functionality?

Thank you in advance!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190126/002715d5/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190126/002715d5/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020042.html">[squid-users] YouTube cache
</A></li>
	<LI>Next message (by thread): <A HREF="020043.html">[squid-users] Only allow specific Users per Port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20041">[ date ]</a>
              <a href="thread.html#20041">[ thread ]</a>
              <a href="subject.html#20041">[ subject ]</a>
              <a href="author.html#20041">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
