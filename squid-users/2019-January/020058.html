<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] using clang to compile squid 4-5
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20using%20clang%20to%20compile%20squid%204-5&In-Reply-To=%3C289180401.107999.1548837503168%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020006.html">
   <LINK REL="Next"  HREF="020060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] using clang to compile squid 4-5</H1>
    <B>graf huy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20using%20clang%20to%20compile%20squid%204-5&In-Reply-To=%3C289180401.107999.1548837503168%40mail.yahoo.com%3E"
       TITLE="[squid-users] using clang to compile squid 4-5">grafhuy at yahoo.fr
       </A><BR>
    <I>Wed Jan 30 08:38:23 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020006.html">[squid-users] using clang to compile squid 4-5
</A></li>
        <LI>Next message (by thread): <A HREF="020060.html">[squid-users] using clang to compile squid 4-5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20058">[ date ]</a>
              <a href="thread.html#20058">[ thread ]</a>
              <a href="subject.html#20058">[ subject ]</a>
              <a href="author.html#20058">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> Hi,
Using update-alternatives to set clang++ was a success, and export CC=/usr/bin/clang does the job (trying two differents methods). Debian project recommended to use export (CC,CCX) for versioning and only update-alternatives for alternative as it says.Anyway compilation with clang was as quick as gcc can do.
/usr/local/squid/sbin# ./squid -v
Squid Cache: Version 4.5
Service Name: squid

This binary uses OpenSSL 1.1.1a&#160; 20 Nov 2018. For legal restrictions on distribution see <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>

configure options:&#160; '--enable-ssl' '--enable-ssl-crtd' '--localstatedir=/var' '--datadir=/usr/share/squid' '--sysconfdir=/etc/squid' '--libexecdir=/usr/lib/squid' '--mandir=/usr/share/man' '--enable-inline' '--disable-arch-native' '--enable-async-io=8' '--enable-storeio=ufs,aufs,diskd,rock' '--enable-removal-policies=lru,heap' '--enable-delay-pools' '--enable-cache-digests' '--enable-icap-client' '--enable-follow-x-forwarded-for' '--enable-auth-basic=DB,fake,getpwnam,LDAP,NCSA,NIS,PAM,POP3,RADIUS,SASL,SMB' '--enable-auth-digest=file,LDAP' '--enable-auth-negotiate=kerberos,wrapper' '--enable-auth-ntlm=fake,SMB_LM' '--enable-external-acl-helpers=file_userip,kerberos_ldap_group,LDAP_group,session,SQL_session,time_quota,unix_group,wbinfo_group' '--enable-security-cert-validators=fake' '--enable-storeid-rewrite-helpers=file' '--enable-url-rewrite-helpers=fake' '--enable-eui' '--enable-esi' '--enable-icmp' '--enable-zph-qos' '--enable-ecap' '--disable-translation' '--with-swapdir=/var/spool/squid' '--with-logdir=/var/log/squid' '--with-pidfile=/var/run/squid.pid' '--with-filedescriptors=65536' '--with-large-files' '--with-default-user=proxy' '--with-gnutls' '--with-openssl' 'CC=/usr/bin/clang'



&gt;<i>Seconded. With both my Squid Project and Debian pkg-squid Team hat's on
</I>&gt;<i>I'd like to know why you feel any need to force the compiler?
</I>There were errors to patch with memcpy because of the gcc version&#160; 8.2.0-14 Debian wich considers some warnings as errors, besides some targets are BSD's.
smblib-util.c: In function &#8216;SMB_Negotiate&#8217;:
smblib-util.c:404:9: error: &#8216;strncpy&#8217; output may be truncated copying 79 bytes from a string of length 79 [-Werror=stringop-truncation]
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; strncpy(p, Con_Handle -&gt; Svr_PDom, sizeof(Con_Handle -&gt; Svr_PDom) - 1);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
smblib-util.c:427:9: error: &#8216;strncpy&#8217; output may be truncated copying 79 bytes from a string of length 79 [-Werror=stringop-truncation]
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; strncpy(p, Con_Handle -&gt; Svr_PDom, sizeof(Con_Handle -&gt; Svr_PDom) - 1);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
smblib-util.c: In function &#8216;SMB_TreeConnect&#8217;:
smblib-util.c:541:5: error: &#8216;strncpy&#8217; specified bound 129 equals destination size [-Werror=stringop-truncation]
&#160;&#160;&#160;&#160; strncpy(tree -&gt; path, path, sizeof(tree -&gt; path));
&#160;&#160;&#160;&#160; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
smblib-util.c:542:5: error: &#8216;strncpy&#8217; specified bound 20 equals destination size [-Werror=stringop-truncation]
&#160;&#160;&#160;&#160; strncpy(tree -&gt; device_type, device, sizeof(tree -&gt; device_type));
&#160;&#160;&#160;&#160; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Although my heart bleeds to use a compiler not compliant with GPL on Debian.
Great to known you are on this package, I thought there was only Luigi Gangitano (<A HREF="https://lists.squid-cache.org/listinfo/squid-users">luigi at debian.org</A>) for ages...

Best regards.


    Le mercredi 23 janvier 2019 &#224; 05:25:04 UTC+1, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; a &#233;crit :  
 
 On 23/01/19 5:17 am, Alex Rousskov wrote:
&gt;<i> On 1/22/19 6:21 AM, graf huy wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> The Makefile is modified so each line with gcc is replaced with clang
</I>&gt;&gt;<i> and each line of g++ replaced with clang++. But gcc is still used.
</I>&gt;<i> 
</I>&gt;<i> I am not sure you are doing that,
</I>
Seconded. With both my Squid Project and Debian pkg-squid Team hat's on
I'd like to know why you feel any need to force the compiler?


Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190130/832d0ef8/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190130/832d0ef8/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020006.html">[squid-users] using clang to compile squid 4-5
</A></li>
	<LI>Next message (by thread): <A HREF="020060.html">[squid-users] using clang to compile squid 4-5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20058">[ date ]</a>
              <a href="thread.html#20058">[ thread ]</a>
              <a href="subject.html#20058">[ subject ]</a>
              <a href="author.html#20058">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
