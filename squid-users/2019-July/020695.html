<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] delay_pools does not work in squid 4.x
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20delay_pools%20does%20not%20work%20in%20squid%204.x&In-Reply-To=%3Ca8a8b2ed-87f6-cf1e-24b5-c7c0b4b8c2e7%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020694.html">
   <LINK REL="Next"  HREF="020696.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] delay_pools does not work in squid 4.x</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20delay_pools%20does%20not%20work%20in%20squid%204.x&In-Reply-To=%3Ca8a8b2ed-87f6-cf1e-24b5-c7c0b4b8c2e7%40treenet.co.nz%3E"
       TITLE="[squid-users] delay_pools does not work in squid 4.x">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Jul  1 08:14:43 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020694.html">[squid-users] squid-users Digest, Vol 58, Issue 31
</A></li>
        <LI>Next message (by thread): <A HREF="020696.html">[squid-users] delay_pools does not work in squid 4.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20695">[ date ]</a>
              <a href="thread.html#20695">[ thread ]</a>
              <a href="subject.html#20695">[ subject ]</a>
              <a href="author.html#20695">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/07/19 4:18 am, sargen wrote:
&gt;&gt;&gt;<i> acl deny_blocked proxy_auth -i &quot;/usr/local/etc/squid/blocked_users.acl&quot;
</I>&gt;&gt;&gt;<i> delay_pools 1
</I>&gt;&gt;&gt;<i> delay_class 1 4
</I>&gt;&gt;&gt;<i> delay_access 1 allow deny_blocked
</I>&gt;&gt;&gt;<i> delay_access 1 deny all
</I>&gt;&gt;&gt;<i> delay_parameters 1 -1 / -1 -1 / -1 -1 / -1 8000/16000
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> If the above is an exact copy-paste of your cofig file then the syntax
</I>&gt;&gt;<i> is invalid. Squid-3 may have accepted it but Squid-4 is a bit more
</I>&gt;&gt;<i> pedantic about correct syntax.
</I>&gt;<i> 
</I>&gt;<i> Ok, may be.
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> After upgrading squid from version 3.5.28 to 4.5, delay_pools stopped
</I>&gt;&gt;&gt;<i> working.
</I>&gt;&gt;<i> How did it stop?
</I>&gt;<i> 
</I>&gt;<i> Sorry, I don't know English well enough.
</I>
Your English seems fine. The query was because you did not provide any
details about what the &quot;not working&quot; looked like. There are quite a few
known bugs with delay pools doing odd things - they are an extremely old
feature that pre-dates most QoS functionality people tend to be more
familiar with.


&gt;<i> On version 3.5.28 with such settings, users from the deny_blocked list used
</I>&gt;<i> a bandwidth of 64kbps.
</I>&gt;<i> On version 4.x with the same settings, users from the deny_blocked list used
</I>&gt;<i> the entire bandwidth without restrictions.
</I>&gt;<i> 
</I>
Okay.

&gt;&gt;<i> More to the point, why was the above working at all?
</I>&gt;<i> 
</I>&gt;<i> I dont know.
</I>&gt;<i> I just used delay pool class 4
</I>&gt;<i> (<A HREF="http://www.squid-cache.org/Versions/v4/cfgman/delay_class.html">http://www.squid-cache.org/Versions/v4/cfgman/delay_class.html</A>) with the
</I>&gt;<i> appropriate delay_parameters as described in the
</I>&gt;<i> <A HREF="http://www.squid-cache.org/Versions/v4/cfgman/delay_parameters.html">http://www.squid-cache.org/Versions/v4/cfgman/delay_parameters.html</A>
</I>&gt;<i> documentation, and this worked exactly as I wanted.
</I>&gt;<i> 
</I>&gt;&gt;<i> *If* Alex's guess is correct, then the bug will be fixed in Squid-5. You
</I>&gt;&gt;<i> can try that cutting-edge code. Whether that is actually your problem or
</I>&gt;&gt;<i> not, nobody knows.
</I>&gt;<i> 
</I>&gt;<i> Ok.
</I>&gt;<i> It was important for me to make sure that the developers were aware of the
</I>&gt;<i> problem. Thanks!
</I>&gt;<i> 
</I>
Well, yes and no. The small detail that nobody is sure the problem you
have is the one Alex was talking about still applies. Your problem may
be one none of us are aware of yet. We will not know for sure until you
run the v5 code and see whether it starts working.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020694.html">[squid-users] squid-users Digest, Vol 58, Issue 31
</A></li>
	<LI>Next message (by thread): <A HREF="020696.html">[squid-users] delay_pools does not work in squid 4.x
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20695">[ date ]</a>
              <a href="thread.html#20695">[ thread ]</a>
              <a href="subject.html#20695">[ subject ]</a>
              <a href="author.html#20695">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
