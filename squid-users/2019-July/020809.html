<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Cache Problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Cache%20Problem&In-Reply-To=%3C20190725065506.GA14953%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020808.html">
   <LINK REL="Next"  HREF="020811.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Cache Problem</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Cache%20Problem&In-Reply-To=%3C20190725065506.GA14953%40fantomas.sk%3E"
       TITLE="[squid-users] Squid Cache Problem">uhlar at fantomas.sk
       </A><BR>
    <I>Thu Jul 25 06:55:06 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020808.html">[squid-users] Squid Cache Problem
</A></li>
        <LI>Next message (by thread): <A HREF="020811.html">[squid-users] Squid Cache Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20809">[ date ]</a>
              <a href="thread.html#20809">[ thread ]</a>
              <a href="subject.html#20809">[ subject ]</a>
              <a href="author.html#20809">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25.07.19 00:41, Devilindisguise wrote:
&gt;<i>We have what is probably an easy one. Some Windows servers use a locally
</I>&gt;<i>installed Squid proxy instance for all outbound traffic. These servers also
</I>&gt;<i>make use of some F5 GTM (DNS) servers to provide a resilient inter-DC DNS
</I>&gt;<i>topology.
</I>&gt;<i>
</I>&gt;<i>Essentially what should happen is under steady state conditions any DNS
</I>&gt;<i>request should be given IP address a.a.a.a, then under failure be given
</I>&gt;<i>b.b.b.b. The GTM DNS TTL is 30 seconds.
</I>&gt;<i>
</I>&gt;<i>What we&#8217;re finding is that even after 5 mins of failure any HTTP request
</I>&gt;<i>from IE (configured with the Squid proxy) still targets a.a.a.a and traffic
</I>&gt;<i>is dropped. During this period if we remove the Squid proxy from the IE
</I>&gt;<i>settings, it works as now we target b.b.b.b.
</I>&gt;<i>
</I>&gt;<i>So clearly some sort of caching, possibly DNS, is being done on the Squid.
</I>
One of main points of DNS design is to be cacheable.
That is why DNS is not suited for load balancing and failover switching.

however, you should be able to look at content of DNS cache in squid using
cachemgr.cgi to see what's wrong there.

also, you can sniff the DNS traffic to see if only proper responses are
going to squid.
-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
REALITY.SYS corrupted. Press any key to reboot Universe.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020808.html">[squid-users] Squid Cache Problem
</A></li>
	<LI>Next message (by thread): <A HREF="020811.html">[squid-users] Squid Cache Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20809">[ date ]</a>
              <a href="thread.html#20809">[ thread ]</a>
              <a href="subject.html#20809">[ subject ]</a>
              <a href="author.html#20809">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
