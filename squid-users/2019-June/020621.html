<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Questions about connection pooling to origins when using squid as a HTTPS forward egress proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Questions%20about%20connection%20pooling%20to%20origins%20when%0A%20using%20squid%20as%20a%20HTTPS%20forward%20egress%20proxy&In-Reply-To=%3CCALnQT_4tm9xZDGb3feQHbznW-mU_--_hQNL9J5gP0aF99%2BhMPA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020620.html">
   <LINK REL="Next"  HREF="020624.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Questions about connection pooling to origins when using squid as a HTTPS forward egress proxy</H1>
    <B>Srikanth Raju</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Questions%20about%20connection%20pooling%20to%20origins%20when%0A%20using%20squid%20as%20a%20HTTPS%20forward%20egress%20proxy&In-Reply-To=%3CCALnQT_4tm9xZDGb3feQHbznW-mU_--_hQNL9J5gP0aF99%2BhMPA%40mail.gmail.com%3E"
       TITLE="[squid-users] Questions about connection pooling to origins when using squid as a HTTPS forward egress proxy">srikanth.raju at affirm.com
       </A><BR>
    <I>Fri Jun  7 09:30:33 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020620.html">[squid-users] Squid 3.5 Disable CONNECT TUNNEL
</A></li>
        <LI>Next message (by thread): <A HREF="020624.html">[squid-users] Questions about connection pooling to origins when using squid as a HTTPS forward egress proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20621">[ date ]</a>
              <a href="thread.html#20621">[ thread ]</a>
              <a href="subject.html#20621">[ subject ]</a>
              <a href="author.html#20621">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello!
We are planning to use squid as a forward egress proxy to whitelist
domains. In general, we configured it to whitelist/blacklist domains based
on the examples in the site and this seems to work with peek and splice on
our preliminary tests as a transparent egress proxy. We're doing this with
an AWS VPC using the standard techniques documented in their blogs

I had a few questions about the setup for some additional features

   - We want to have the ability to connection pool certain HTTPS calls
   going externally within from within squid. This would be specifically for
   some external partners that we know have slow connection setup time and or
   in case of misbehaving libraries.
   - WIth &quot;peek and splice&quot; method for HTTPS, this doesn't make sense,
   since it's a TCP tunnel basically. There shouldn't be a way to replay the
   handshake, hence it's impossible to pool at the squid layer.
   - We need to consider 'bump' for some use cases along with our own
   intermediate CA, which we're ok with, since we can choose the domains to
   'splice' and domains to 'bump'/
   - The biggest reason we care about TLS termination with bump is because
   we think it might give us performance benefits along some critical code
   paths *due to connection pooling to some slow upstreams within squid.*
   - Does squid automatically do this or does it need some extra config. I
   was looking at 'server_connections' config var. [Currently we roughly
   follow the config in the AWS Guide]
   &lt;<A HREF="https://aws.amazon.com/blogs/security/how-to-add-dns-filtering-to-your-nat-instance-with-squid/">https://aws.amazon.com/blogs/security/how-to-add-dns-filtering-to-your-nat-instance-with-squid/</A>&gt;


Another thing we cared about , with a much lower priority, was HTTP/2
translation. We would like to reap the benefits of HTTP/2 on external
services that do support it and we connect to, but our application does not
yet have any production-safe http2 clients(python).
Is there any roadmap for when that will land on Squid master?

Thanks y'all
- Srikanth

Platform and Online Frameworks. Affirm Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190607/95b0179b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190607/95b0179b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020620.html">[squid-users] Squid 3.5 Disable CONNECT TUNNEL
</A></li>
	<LI>Next message (by thread): <A HREF="020624.html">[squid-users] Questions about connection pooling to origins when using squid as a HTTPS forward egress proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20621">[ date ]</a>
              <a href="thread.html#20621">[ thread ]</a>
              <a href="subject.html#20621">[ subject ]</a>
              <a href="author.html#20621">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
