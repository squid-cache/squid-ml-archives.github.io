<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Empty ACL technical risks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Empty%20ACL%20technical%20risks&In-Reply-To=%3Cd3680ffd-49d9-d8c7-eac5-61134c5c71be%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020633.html">
   <LINK REL="Next"  HREF="020635.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Empty ACL technical risks</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Empty%20ACL%20technical%20risks&In-Reply-To=%3Cd3680ffd-49d9-d8c7-eac5-61134c5c71be%40treenet.co.nz%3E"
       TITLE="[squid-users] Empty ACL technical risks">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jun 12 05:58:19 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020633.html">[squid-users] Empty ACL technical risks
</A></li>
        <LI>Next message (by thread): <A HREF="020635.html">[squid-users] Empty ACL technical risks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20634">[ date ]</a>
              <a href="thread.html#20634">[ thread ]</a>
              <a href="subject.html#20634">[ subject ]</a>
              <a href="author.html#20634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/06/19 11:36 pm, &#1053;&#1080;&#1082;&#1080;&#1090;&#1072; &#1057;&#1077;&#1088;&#1105;&#1075;&#1080;&#1085; wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> If there is an empty acl in squid.conf, squid gives us warning message during restart/reconfigure.
</I>&gt;<i> 
</I>&gt;<i> We wonder if these warnings are just notifications for administrator, or there are some really technical risks.
</I>&gt;<i> 
</I>&gt;<i> Like here for example: <A HREF="https://bugs.launchpad.net/ubuntu/+source/squid-deb-proxy/+bug/1659567">https://bugs.launchpad.net/ubuntu/+source/squid-deb-proxy/+bug/1659567</A>
</I>&gt;<i> Amos Jeffries wrote: &quot;The check is a generic validity check used for all ACLs. Whether it is 'harmless' depends on future events at the time of checking. So just silencing or ignoring would leave a lot of nasty misconfigurations quietly accepted&quot;
</I>&gt;<i> 
</I>&gt;<i> Could these &quot;nasty misconfigurations&quot; be made only by administrator, or is it about squid possible wrong behavior?
</I>&gt;<i> 
</I>
The Ubuntu bug report you referenced is a good example why. The file
which is initially empty is explicitly being added to by non-admin
entities. Who then have an automated action to trigger reconfigure of
the running proxy.

The risk there is that those entities are not necessarily knowing what
valid ACL data is. Nor in a position to fix the resulting DoS if they
get it wrong and make Squid exit on the reconfigure.
 That breaking reconfigure may be a long time after the config change
was made.



&gt;<i> Are there any strong technical reasons to avoid using of empty ACLs in production environment?
</I>&gt;<i> 
</I>
The main reason is that risk of DoS-ing the proxy and everyone using it
for an indeterminate amount of time until the admin can be summoned and
track down why the proxy is not running.


Another reason is every transaction handled by Squid has to spend CPU
cycles setting up access checklists, fetching the data to be tested,
then calling the processing code - even if the ACL is empty and thus
immediately returns its DUNNO result.


Which brings us to DUNNO being the third match state. So things like:

 acl foo src &quot;/some/empty.file&quot;
 http_access allow foo
 http_access allow !foo

... results in the surprise *access denied*.


&gt;<i> And are there any news about explicit flag to indicate whether an ACL is allowed to be empty or not?
</I>&gt;<i> 
</I>
Nobody has submitted anything towards one.

As you noted at the start it is a *warning* message. Squid should
continue to run &quot;fine&quot;. Provided your definition of &quot;fine&quot; accounts for
the above technical issues and odd behaviour.

Cheers,
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020633.html">[squid-users] Empty ACL technical risks
</A></li>
	<LI>Next message (by thread): <A HREF="020635.html">[squid-users] Empty ACL technical risks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20634">[ date ]</a>
              <a href="thread.html#20634">[ thread ]</a>
              <a href="subject.html#20634">[ subject ]</a>
              <a href="author.html#20634">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
