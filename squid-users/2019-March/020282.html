<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid-3.5.28 slowdown
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.28%20slowdown&In-Reply-To=%3CE2D7AB5B-0C8F-4E91-B43E-F5FCDDB2CD1E%40data-core.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020281.html">
   <LINK REL="Next"  HREF="020297.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid-3.5.28 slowdown</H1>
    <B>Enrico Heine</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.28%20slowdown&In-Reply-To=%3CE2D7AB5B-0C8F-4E91-B43E-F5FCDDB2CD1E%40data-core.org%3E"
       TITLE="[squid-users] Squid-3.5.28 slowdown">flashdown at data-core.org
       </A><BR>
    <I>Fri Mar  1 11:04:35 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020281.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
        <LI>Next message (by thread): <A HREF="020297.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20282">[ date ]</a>
              <a href="thread.html#20282">[ thread ]</a>
              <a href="subject.html#20282">[ subject ]</a>
              <a href="author.html#20282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Michael, 

&gt;&gt;<i>just a shot into the dark&lt;&lt;, is it possible that you use the adaption service for ICAP?
</I>
If so, fast test, this should return 0 if u are not affected by this, if higher than 0 check the link below:
netstat -pa | grep CLOSE_WAIT | wc -l 

also have a look into /var/log/kern.log 

if so please checkout this bug <A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=4526">https://bugs.squid-cache.org/show_bug.cgi?id=4526</A>

So if it is your issue, please note that it seems that this issue may also be present in V4, but the bugreport for V4 has been closed as duplicate..

Best regards,
Flashdown

Am 1. M&#228;rz 2019 10:47:43 MEZ schrieb Michael Hendrie &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">michael at hendrie.id.au</A>&gt;:
&gt;<i>Hi Guys,
</I>&gt;<i>
</I>&gt;<i>I have a squid-3.5.28 installation that is deployed to do transparent
</I>&gt;<i>ssl-bump of HTTPS traffic (linux bridge, tproxy).  The server is not
</I>&gt;<i>overly busy, CPU and RAM usage is low + no swap being used yet
</I>&gt;<i>regularly the squid service is choking HTTPS traffic to a point where
</I>&gt;<i>websites are timing out.  Any other traffic flowing through the bridge
</I>&gt;<i>is unaffected and continues to operate at normal expected speeds.
</I>&gt;<i>
</I>&gt;<i>I have checked all obvious things, CPU/RAM usage, network interface
</I>&gt;<i>errors, conntrack table and TCP resource exhaustion yet all look fine.
</I>&gt;<i>There is no caching taking place and disk IO is not a problem.
</I>&gt;<i>
</I>&gt;<i>During the times where squid is slow, even using squidclient to query
</I>&gt;<i>squid state is extremely slow to respond, as you can see below snip
</I>&gt;<i>from the access.log the mgr:coutners and mgr:5min requests are taking
</I>&gt;<i>up to 30 seconds to complete when usually the response time is 0:
</I>&gt;<i>
</I>&gt;<i>1551397216.978     31 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397220.633      0 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397233.385      2 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397237.431     14 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397262.074      2 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397280.644     17 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397314.764      1 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397330.455      5 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397377.265      4 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397385.727      0 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397396.161     17 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>&gt;<i>1551397432.974     11 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397462.897     11 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397492.759      7 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397522.611      9 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397552.521     12 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397582.484     17 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>1551397612.446     10 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i>cache_<A HREF="object://localhost/counters">object://localhost/counters</A> - HIER_NONE/- - -
</I>&gt;<i>
</I>&gt;<i>I have a number of these severs deployed, all running same
</I>&gt;<i>hardware/config/squid versions and only this one is experiencing an
</I>&gt;<i>issue.....looking for suggestions on what could be occurring and how to
</I>&gt;<i>debug further?  
</I>&gt;<i>
</I>&gt;<i>Thanks,
</I>&gt;<i>
</I>&gt;<i>Michael
</I>
-- 
Diese Nachricht wurde von meinem Android-Ger&#228;t mit K-9 Mail gesendet.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190301/dbe5120a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190301/dbe5120a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020281.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
	<LI>Next message (by thread): <A HREF="020297.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20282">[ date ]</a>
              <a href="thread.html#20282">[ thread ]</a>
              <a href="subject.html#20282">[ subject ]</a>
              <a href="author.html#20282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
