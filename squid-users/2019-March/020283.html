<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid-3.5.28 slowdown
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.28%20slowdown&In-Reply-To=%3Cc8c06023-877c-4de1-52f8-2b43821652cf%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020308.html">
   <LINK REL="Next"  HREF="020284.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid-3.5.28 slowdown</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-3.5.28%20slowdown&In-Reply-To=%3Cc8c06023-877c-4de1-52f8-2b43821652cf%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid-3.5.28 slowdown">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Mar  1 12:21:37 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020308.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
        <LI>Next message (by thread): <A HREF="020284.html">[squid-users] Squid and url modifying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20283">[ date ]</a>
              <a href="thread.html#20283">[ thread ]</a>
              <a href="subject.html#20283">[ subject ]</a>
              <a href="author.html#20283">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/03/19 10:47 pm, Michael Hendrie wrote:
&gt;<i> Hi Guys,
</I>&gt;<i> 
</I>&gt;<i> I have a squid-3.5.28 installation that is deployed to do transparent
</I>&gt;<i> ssl-bump of HTTPS traffic (linux bridge, tproxy). &#160;The server is not
</I>&gt;<i> overly busy, CPU and RAM usage is low + no swap being used yet regularly
</I>&gt;<i> the squid service is choking HTTPS traffic to a point where websites are
</I>&gt;<i> timing out. &#160;Any other traffic flowing through the bridge is unaffected
</I>&gt;<i> and continues to operate at normal expected speeds.
</I>&gt;<i> 
</I>&gt;<i> I have checked all obvious things, CPU/RAM usage, network interface
</I>&gt;<i> errors, conntrack table and TCP resource exhaustion yet all look fine.
</I>&gt;<i> There is no caching taking place and disk IO is not a problem.
</I>&gt;<i> 
</I>&gt;<i> During the times where squid is slow, even using squidclient to query
</I>&gt;<i> squid state is extremely slow to respond, as you can see below snip from
</I>&gt;<i> the access.log the mgr:coutners and mgr:5min requests are taking up to
</I>&gt;<i> 30 seconds to complete when usually the response time is 0:
</I>&gt;<i> 
</I>&gt;<i> 1551397216.978&#160;&#160; &#160;&#160;31 127.0.0.1 TCP_MISS/000 0 GET
</I>&gt;<i> cache_<A HREF="object://localhost/5min">object://localhost/5min</A> - HIER_NONE/- - -
</I>
If that '31' is what you are meaning by &quot;30 seconds&quot; then please be
aware the duration column numbers are in *milli*-seconds.

So while in absolute terms this 31ms is significantly slower than
under-1ms (aka '0'). It is not humanly visible.

Any visible delays you may be having are not being shown by these log
entries. Which hints that they are somewhere in the delays between HTTP
transactions - either the I/O on traffic not yet logged, or in the TLS
handshake timings.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020308.html">[squid-users] Squid-3.5.28 slowdown
</A></li>
	<LI>Next message (by thread): <A HREF="020284.html">[squid-users] Squid and url modifying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20283">[ date ]</a>
              <a href="thread.html#20283">[ thread ]</a>
              <a href="subject.html#20283">[ subject ]</a>
              <a href="author.html#20283">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
