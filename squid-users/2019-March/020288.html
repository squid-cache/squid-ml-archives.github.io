<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] compiling squid 4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20compiling%20squid%204&In-Reply-To=%3Cvmime.5c794358.50c0.2392c76879617cd8%40ms249-lin-003.rotterdam.bazuin.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020295.html">
   <LINK REL="Next"  HREF="020289.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] compiling squid 4</H1>
    <B>L.P.H. van Belle</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20compiling%20squid%204&In-Reply-To=%3Cvmime.5c794358.50c0.2392c76879617cd8%40ms249-lin-003.rotterdam.bazuin.nl%3E"
       TITLE="[squid-users] compiling squid 4">belle at bazuin.nl
       </A><BR>
    <I>Fri Mar  1 14:36:08 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020295.html">[squid-users] ipv4 + ipv6
</A></li>
        <LI>Next message (by thread): <A HREF="020289.html">[squid-users] compiling squid 4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20288">[ date ]</a>
              <a href="thread.html#20288">[ thread ]</a>
              <a href="subject.html#20288">[ subject ]</a>
              <a href="author.html#20288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Its pretty simple.. 

Enable the debian sid source in your ubuntu 18
apt install -y software-properties-common debian-archive-keyring dirmngr
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 8B48AD6246925553
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 7638D0442B90D010

add-apt-repository &quot;deb-src <A HREF="http://ftp.nl.debian.org/debian">http://ftp.nl.debian.org/debian</A> sid main contrib non-free&quot;
apt-get update

I dont enable the deb line from sid because that prevents possible unwanted upgrades/replacements of files. 

# get build-depends
apt-get build-dep squid3

# get source and build squid
apt-get source squid3 -B

And wait. 
Thats what im doing now ;-) .. 15 min later done. 

 dpkg-genbuildinfo --build=binary
 dpkg-genchanges --build=binary &gt;../squid_4.6-1_amd64.changes
dpkg-genchanges: info: binary-only upload (no source code included)
 dpkg-source --after-build squid-4.6
dpkg-buildpackage: info: binary-only upload (no source included)

This results in a some debs, setup a file/web repo to use them so you can apt-get install them. 
Move all .deb files in a folder 

mkdir amd64
mv *.deb amd64/
apt-ftparchive packages amd64/ &gt; amd64/Packages

And add a line like this in your /etc/apt/sources.list.d/squid-local.list
echo &quot;deb [trusted=yes] file:/home/build/squid/ amd64/&quot; &gt; /etc/apt/sources.list.d/squid-local.list
# NOTE , dont forget to change the path here^^ 
You can move this to any place as long amd64/ exitst. 
You can change this to a webserver, then it looks like : #deb [trusted=yes] <A HREF="http://localhost/">http://localhost/</A> amd64/&quot;
And document root and webserver setup, if you move amd64 to /var/www/html/ 
Then it should work directly after you install a webserver. 

Results. 
apt-get update
apt-cache policy squid
squid:
  Installed: (none)
  Candidate: 4.6-1
  Version table:
     4.6-1 500
        500 file:/root amd64/ Packages
     3.5.27-1ubuntu1.1 500
        500 <A HREF="http://nl.archive.ubuntu.com/ubuntu">http://nl.archive.ubuntu.com/ubuntu</A> bionic-updates/main amd64 Packages
     3.5.27-1ubuntu1 500
        500 <A HREF="http://nl.archive.ubuntu.com/ubuntu">http://nl.archive.ubuntu.com/ubuntu</A> bionic/main amd64 Packages


apt-get install squid
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  libdbi-perl squid-common squid-langpack
Suggested packages:
  libmldbm-perl libnet-daemon-perl libsql-statement-perl squidclient squid-cgi squid-purge resolvconf smbclient ufw
The following NEW packages will be installed:
  libdbi-perl squid squid-common squid-langpack
0 upgraded, 4 newly installed, 0 to remove and 35 not upgraded.
Need to get 861 kB/3,752 kB of archives.
After this operation, 13.4 MB of additional disk space will be used.
Do you want to continue? [Y/n]
Get:1 file:/root amd64/ squid-common 4.6-1 [309 kB]
Get:2 file:/root amd64/ squid 4.6-1 [2,582 kB]
Get:3 <A HREF="http://nl.archive.ubuntu.com/ubuntu">http://nl.archive.ubuntu.com/ubuntu</A> bionic/main amd64 squid-langpack all 20170901-1 [137 kB]
Get:4 <A HREF="http://nl.archive.ubuntu.com/ubuntu">http://nl.archive.ubuntu.com/ubuntu</A> bionic/main amd64 libdbi-perl amd64 1.640-1 [724 kB]


Now you ;-) 

And why above works... 
Because of the fantastic work of the squid devs! 


Greetz, 

Louis


&gt;<i> -----Oorspronkelijk bericht-----
</I>&gt;<i> Van: squid-users 
</I>&gt;<i> [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] Namens 
</I>&gt;<i> Alex Guti&#233;rrez Mart&#237;nez
</I>&gt;<i> Verzonden: donderdag 28 februari 2019 22:03
</I>&gt;<i> Aan: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Onderwerp: [squid-users] compiling squid 4
</I>&gt;<i> 
</I>&gt;<i> Hello again community, I still have problems compiling squid 
</I>&gt;<i> 4. This is 
</I>&gt;<i> what i did this time
</I>&gt;<i> 
</I>&gt;<i> Soporte b&#225;sico necesario:
</I>&gt;<i> 
</I>&gt;<i> # apt install arj bzip2 xz-utils cabextract cpio file lzma lhasa lzop 
</I>&gt;<i> rpm2cpio gzip nomarch pax lzop rar unrar unzip zoo unace razor pyzor 
</I>&gt;<i> tnef ripole zip p7zip-full mc multitail ccze libcppunit-dev 
</I>&gt;<i> libsasl2-dev 
</I>&gt;<i> libxml2-dev libkrb5-dev libdb-dev libnetfilter-conntrack-dev 
</I>&gt;<i> libexpat1-dev libcap2-dev libldap2-dev libpam0g-dev libgnutls28-dev 
</I>&gt;<i> libssl-dev libdbi-perl libecap3 libecap3-dev libntlm0-dev 
</I>&gt;<i> libkf5kiontlm5 
</I>&gt;<i> samba-dev ldap-utils
</I>&gt;<i> 
</I>&gt;<i> Instalar binarios necesarios para compilar Squid4, the system 
</I>&gt;<i> retunr a 
</I>&gt;<i> error whe in start the service:
</I>&gt;<i> 
</I>&gt;<i> sudo apt install logrotate acl attr autoconf bison nettle-dev 
</I>&gt;<i> build-essential libacl1-dev libaio-dev libattr1-dev libblkid-dev 
</I>&gt;<i> libbsd-dev libcap2-dev libcppunit-dev libldap2-dev pkg-config 
</I>&gt;<i> libxml2-dev libdb-dev libgnutls28-dev openssl devscripts fakeroot 
</I>&gt;<i> libdbi-perl libssl1.0-dev libcppunit-dev libecap3-dev libkrb5-dev 
</I>&gt;<i> comerr-dev libnetfilter-conntrack-dev libpam0g-dev libsasl2-dev
</I>&gt;<i> 
</I>&gt;<i>  &#160;sudo groupadd -g 13 proxy
</I>&gt;<i>  &#160;sudo mkdir -p /var/spool/squid
</I>&gt;<i>  &#160;sudo mkdir -p /var/log/squid
</I>&gt;<i>  &#160;sudo useradd --system -g proxy -u 13 -d /var/spool/squid -M -s 
</I>&gt;<i> /usr/sbin/nologin proxy
</I>&gt;<i>  &#160;sudo chown proxy:proxy /var/spool/squid
</I>&gt;<i>  &#160;sudo chown proxy:proxy /var/log/squid
</I>&gt;<i> 
</I>&gt;<i> cd /opt
</I>&gt;<i> wget -c <A HREF="http://www.squid-cache.org/Versions/v4/squid-4.6.tar.xz">http://www.squid-cache.org/Versions/v4/squid-4.6.tar.xz</A>
</I>&gt;<i>  &#160;tar xfv squid-4.6.tar.xz
</I>&gt;<i> 
</I>&gt;<i> Configuramos las opciones b&#225;sicas que podamos necesitar:
</I>&gt;<i> 
</I>&gt;<i> ./configure --srcdir=. --prefix=/usr --localstatedir=/var/lib/squid 
</I>&gt;<i> --libexecdir=/usr/lib/squid --datadir=/usr/share/squid 
</I>&gt;<i> --sysconfdir=/etc/squid --with-default-user=proxy 
</I>&gt;<i> --with-logdir=/var/log/squid --with-open-ssl=/etc/ssl/openssl.cnf 
</I>&gt;<i> --with-openssl --enable-ssl --enable-ssl-crtd 
</I>&gt;<i> --build=x86_64-linux-gnu 
</I>&gt;<i> --with-pidfile=/var/run/squid.pid --enable-removal-policies=lru,heap 
</I>&gt;<i> --enable-delay-pools --enable-cache-digests --enable-icap-client 
</I>&gt;<i> --enable-ecap --enable-follow-x-forwarded-for --with-large-files 
</I>&gt;<i> --with-filedescriptors=65536 
</I>&gt;<i> --enable-auth-basic=DB,fake,getpwnam,LDAP,NCSA,NIS,PAM,POP3,RA
</I>DIUS,SASL,SMB 
&gt;<i> --enable-auth-digest=file,LDAP 
</I>&gt;<i> --enable-auth-negotiate=kerberos,wrapper 
</I>&gt;<i> --enable-auth-ntlm=fake --enable-linux-netfilter 
</I>&gt;<i> --with-swapdir=/var/spool/squid --enable-useragent-log --enable-htpc 
</I>&gt;<i> --infodir=/usr/share/info --mandir=/usr/share/man 
</I>&gt;<i> --includedir=/usr/include --disable-maintainer-mode 
</I>&gt;<i> --disable-dependency-tracking --disable-silent-rules --enable-inline 
</I>&gt;<i> --enable-async-io --enable-storeio=ufs,aufs,diskd,rock --enable-eui 
</I>&gt;<i> --enable-esi --enable-icmp --enable-zph-qos 
</I>&gt;<i> --enable-external-acl-helpers=file_userip,kerberos_ldap_group,
</I>time_quota,LDAP_group,session,SQL_session,unix_group,wbinfo_group 
&gt;<i> --enable-url-rewrite-helpers=fake --enable-translation --enable-epoll 
</I>&gt;<i> --enable-snmp --enable-wccpv2 --with-aio --with-pthreads
</I>&gt;<i> 
</I>&gt;<i> Compiling with&#160; 4 cores:
</I>&gt;<i> 
</I>&gt;<i> make -j 4
</I>&gt;<i> 
</I>&gt;<i> Installing:
</I>&gt;<i> 
</I>&gt;<i> sudo&#160; make install
</I>&gt;<i> 
</I>&gt;<i> create initi script:
</I>&gt;<i> 
</I>&gt;<i> sudo nano /etc/init.d/squid
</I>&gt;<i> 
</I>&gt;<i> initi content:
</I>&gt;<i> 
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> # squid4&#160;&#160;&#160;&#160; Startup script for the SQUID HTTP proxy-cache.
</I>&gt;<i> #
</I>&gt;<i> # Version:&#160;&#160; @(#)squid4 init script&#160; 1.0&#160; 20-Feb-2019 
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">leslie84 at nauta.cu</A>
</I>&gt;<i> ##############################################################
</I>&gt;<i> ##########
</I>&gt;<i> 
</I>&gt;<i> ### BEGIN INIT INFO
</I>&gt;<i> # Provides:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; squid
</I>&gt;<i> # Required-Start:&#160;&#160;&#160; $network $remote_fs $syslog
</I>&gt;<i> # Required-Stop:&#160;&#160;&#160;&#160; $network $remote_fs $syslog
</I>&gt;<i> # Should-Start:&#160;&#160;&#160;&#160;&#160; $named
</I>&gt;<i> # Should-Stop:&#160;&#160;&#160;&#160;&#160;&#160; $named
</I>&gt;<i> # Default-Start:&#160;&#160;&#160;&#160; 2 3 4 5
</I>&gt;<i> # Default-Stop:&#160;&#160;&#160;&#160;&#160; 0 1 6
</I>&gt;<i> # Short-Description: Squid HTTP Proxy version 4.x
</I>&gt;<i> ### END INIT INFO
</I>&gt;<i> 
</I>&gt;<i> NAME=squid
</I>&gt;<i> DESC=&quot;Squid HTTP Proxy 4.x&quot;
</I>&gt;<i> DAEMON=/usr/sbin/squid
</I>&gt;<i> PIDFILE=/var/run/$NAME.pid
</I>&gt;<i> CONFIG=/etc/squid/squid.conf
</I>&gt;<i> SQUID_ARGS=&quot;-YC -f $CONFIG&quot;
</I>&gt;<i> 
</I>&gt;<i> [ ! -f /etc/default/squid ] || . /etc/default/squid
</I>&gt;<i> 
</I>&gt;<i> . /lib/lsb/init-functions
</I>&gt;<i> 
</I>&gt;<i> PATH=/bin:/usr/bin:/sbin:/usr/sbin
</I>&gt;<i> 
</I>&gt;<i> [ -x $DAEMON ] || exit 0
</I>&gt;<i> 
</I>&gt;<i> ulimit -n 65535
</I>&gt;<i> 
</I>&gt;<i> find_cache_dir () {
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; w=&quot;&#160;&#160;&#160;&#160; &quot; # space tab
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; res=`sed -ne '
</I>&gt;<i> s/^'$1'['&quot;$w&quot;']\+[^'&quot;$w&quot;']\+['&quot;$w&quot;']\+\([^'&quot;$w&quot;']\+\).*$/\1/p;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; t end;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; d;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :end q' &lt; $CONFIG`
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; [ -n &quot;$res&quot; ] || res=$2
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; echo &quot;$res&quot;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> find_cache_type () {
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; w=&quot;&#160;&#160;&#160;&#160; &quot; # space tab
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; res=`sed -ne '
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; s/^'$1'['&quot;$w&quot;']\+\([^'&quot;$w&quot;']\+\).*$/\1/p;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; t end;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; d;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :end q' &lt; $CONFIG`
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; [ -n &quot;$res&quot; ] || res=$2
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; echo &quot;$res&quot;
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> start () {
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; cache_dir=`find_cache_dir cache_dir`
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; cache_type=`find_cache_type cache_dir`
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; #
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; # Create spool dirs if they don't exist.
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; #
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if [ &quot;$cache_type&quot; = &quot;coss&quot; -a -d &quot;$cache_dir&quot; -a ! -f 
</I>&gt;<i> &quot;$cache_dir/stripe&quot; ] || [ &quot;$cache_type&quot; != &quot;coss&quot; -a -d 
</I>&gt;<i> &quot;$cache_dir&quot; -a 
</I>&gt;<i> ! -d &quot;$cache_dir/00&quot; ]
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_warning_msg &quot;Creating $DESC cache structure&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $DAEMON -z -f $CONFIG
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; umask 027
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ulimit -n 65535
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; cd $cache_dir
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; start-stop-daemon --quiet --start \
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; --pidfile $PIDFILE \
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; --exec $DAEMON -- $SQUID_ARGS &lt; /dev/null
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; return $?
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> stop () {
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; PID=`cat $PIDFILE 2&gt;/dev/null`
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; start-stop-daemon --stop --quiet --pidfile $PIDFILE 
</I>&gt;<i> --exec $DAEMON
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; #
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; #&#160;&#160;&#160;&#160;&#160;&#160; Now we have to wait until squid has _really_ stopped.
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; #
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; sleep 2
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if test -n &quot;$PID&quot; &amp;&amp; kill -0 $PID 2&gt;/dev/null
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_begin_msg &quot; Waiting&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cnt=0
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while kill -0 $PID 2&gt;/dev/null
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; do
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cnt=`expr $cnt + 1`
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if [ $cnt -gt 24 ]
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_end_msg 1
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return 1
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sleep 5
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_cont_msg &quot;&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; done
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_end_msg 0
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return 0
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; else
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return 0
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> case &quot;$1&quot; in
</I>&gt;<i>  &#160;&#160;&#160; start)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; log_daemon_msg &quot;Starting $DESC&quot; &quot;$NAME&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if start ; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; else
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i>  &#160;&#160;&#160; stop)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; log_daemon_msg &quot;Stopping $DESC&quot; &quot;$NAME&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if stop ; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; else
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i>  &#160;&#160;&#160; reload|force-reload)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_msg &quot;Reloading $DESC configuration files&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; start-stop-daemon --stop --signal 1 \
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; --pidfile $PIDFILE --quiet --exec $DAEMON
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; log_action_end_msg 0
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i>  &#160;&#160;&#160; restart)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; log_daemon_msg &quot;Restarting $DESC&quot; &quot;$NAME&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; stop
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; if start ; then
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; else
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; log_end_msg $?
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; fi
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i>  &#160;&#160;&#160; status)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; status_of_proc -p $PIDFILE $DAEMON $NAME &amp;&amp; exit 0 || exit 3
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i>  &#160;&#160;&#160; *)
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; echo &quot;Usage: /etc/init.d/$NAME 
</I>&gt;<i> {start|stop|reload|force-reload|restart|status}&quot;
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; exit 3
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;
</I>&gt;<i> esac
</I>&gt;<i> 
</I>&gt;<i> exit 0
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> ##############################################################
</I>&gt;<i> ########################################
</I>&gt;<i> 
</I>&gt;<i> set permissions:
</I>&gt;<i> 
</I>&gt;<i> cambiar permisos al archivo
</I>&gt;<i>  &#160;&#160;&#160;&#160; sudo chmod +x /etc/init.d/squid
</I>&gt;<i> 
</I>&gt;<i> activar servicio de squid
</I>&gt;<i>  &#160;&#160;&#160;&#160; sudo update-rc.d squid defaults
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> After all this when i start the service this is the response 
</I>&gt;<i> from the system
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>  &#160;systemctl status squid.service
</I>&gt;<i> &#226; squid.service
</I>&gt;<i>  &#160;&#160; Loaded: loaded (/etc/init.d/squid; generated)
</I>&gt;<i>  &#160;&#160; Active: failed (Result: exit-code) since Thu 2019-02-28 15:52:15 
</I>&gt;<i> CST; 5s ago
</I>&gt;<i>  &#160;&#160;&#160;&#160; Docs: man:systemd-sysv-generator(8)
</I>&gt;<i>  &#160; Process: 18732 ExecStart=/etc/init.d/squid start (code=exited, 
</I>&gt;<i> status=203/EXEC)
</I>&gt;<i> 
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[1]: Starting squid.service...
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[18732]: squid.service: Failed to execute 
</I>&gt;<i> command: Exec format error
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[18732]: squid.service: Failed at 
</I>&gt;<i> step EXEC 
</I>&gt;<i> spawning /etc/init.d/squid: Exec format error
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[1]: squid.service: Control 
</I>&gt;<i> process exited, 
</I>&gt;<i> code=exited status=203
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[1]: squid.service: Failed with result 
</I>&gt;<i> 'exit-code'.
</I>&gt;<i> feb 28 15:52:15 sq4 systemd[1]: Failed to start squid.service.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Im using Ubuntu 18.04.2, thanks in advance.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> PD: Thanks for your answer&#160; Rafael Akchurin but unforntunately the 
</I>&gt;<i> article that you suggest won&#180;t work for me.
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Saludos Cordiales
</I>&gt;<i> 
</I>&gt;<i> Lic. Alex Guti&#233;rrez Mart&#237;nez
</I>&gt;<i> 
</I>&gt;<i> Tel. +53 7 2710327
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020295.html">[squid-users] ipv4 + ipv6
</A></li>
	<LI>Next message (by thread): <A HREF="020289.html">[squid-users] compiling squid 4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20288">[ date ]</a>
              <a href="thread.html#20288">[ thread ]</a>
              <a href="subject.html#20288">[ subject ]</a>
              <a href="author.html#20288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
