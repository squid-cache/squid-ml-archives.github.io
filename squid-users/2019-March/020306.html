<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid and url modifying
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20and%20url%20modifying&In-Reply-To=%3C5bc0a8f654f93be42c90ebbe5a99e0ec%40sarenet.es%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020300.html">
   <LINK REL="Next"  HREF="020309.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid and url modifying</H1>
    <B>Egoitz Aurrekoetxea</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20and%20url%20modifying&In-Reply-To=%3C5bc0a8f654f93be42c90ebbe5a99e0ec%40sarenet.es%3E"
       TITLE="[squid-users] Squid and url modifying">egoitz at sarenet.es
       </A><BR>
    <I>Mon Mar  4 07:53:47 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020300.html">[squid-users] Squid and url modifying
</A></li>
        <LI>Next message (by thread): <A HREF="020309.html">[squid-users] Squid and url modifying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20306">[ date ]</a>
              <a href="thread.html#20306">[ thread ]</a>
              <a href="subject.html#20306">[ subject ]</a>
              <a href="author.html#20306">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning, 

Thanks a lot mates for your reading time. Alex, Amos speciall&#253; to you
that answered too to this mail. 

My idea is simple. I wanted specific url, to be filtered through the
proxy. How can I manage this URL to be checked by the proxy?. I assumed,
I could modify the real and original content where urls appeared by
setting for instance : 

- Being the real url : <A HREF="https://oooeeee.eeee.ttt/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt/u?ii=99&amp;j=88</A> [2] 

- I would rewrite in the own content the URL so that  the new URL is now
:<i> <A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A> 
</I>
The domain thesquidserver.org [2] will be used for doing wilcards. For
instance : *.thesquidserver.org *.*.thesquidserver.org etc... will
resolve to the ip of the Squid server. But I don't want any url being
asked as whatever.thesquidserver.org to be checked... just those ones I
have wrote in some place... 

So I was trying to write some content managing script, which should
check if that URL is needed to be checked and in case it should, check
it against an icap service. If Icap service gives you all to be right,
redirect you to the real site (just removing the thesquidserver.org for
the URL for instance). If that URL contains malware for instance, give
you an error page. 

This is all what I was trying to do... Some time ago, I used Squid with
Dansguardian for this kind of purposes, but now I wanted to do something
slightly different. I wanted to pass a request (if should be passed) to
an icap service and later depeding in the result of that ICAP service
(which I don't really know how could I check with an script) redirect to
the real site or give an error page. 

For this purpose is perhaps the reason because url redirector programs
exist?. I'm trying to see the entire puzzle :) 

Any help would be very appreciatted :) 

Thank you so much,

---

EGOITZ AURREKOETXEA 
Dpto. de sistemas 
944 209 470
Parque Tecnol&#243;gico. Edificio 103
48170 Zamudio (Bizkaia) 
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">egoitz at sarenet.es</A> 
www.sarenet.es [1] 
Antes de imprimir este correo electr&#243;nico piense si es necesario
hacerlo. 

El 2019-03-02 23:21, Alex Rousskov escribi&#243;:

&gt;<i> On 3/1/19 5:59 AM, Egoitz Aurrekoetxea wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Is it possible for Squid to do something like :
</I>&gt;<i> 
</I>&gt;&gt;<i> - Receive request : <A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A>
</I>&gt;<i> 
</I>&gt;&gt;<i> and
</I>&gt;<i> 
</I>&gt;&gt;<i> to really perform a request as : <A HREF="https://oooeeee.eeee.ttt/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt/u?ii=99&amp;j=88</A>
</I>&gt;<i> 
</I>&gt;<i> How does your Squid receive the former request? Amos' answer probably
</I>&gt;<i> assumes that your Squid is _not_ oooeeee.eeee.ttt.thesquidserver.org,
</I>&gt;<i> but the name you have chosen for your example may imply that it is.
</I>&gt;<i> 
</I>&gt;<i> * If your Squid is _intercepting_ traffic destined for the real
</I>&gt;<i> oooeeee.eeee.ttt.thesquidserver.org, then see Amos' answer.
</I>&gt;<i> 
</I>&gt;<i> * If your Squid is representing oooeeee.eeee.ttt.thesquidserver.org,
</I>&gt;<i> then your Squid is a reverse proxy that ought to have the certificate
</I>&gt;<i> key for that domain, and none of the SslBump problems that Amos
</I>&gt;<i> mentioned apply.
</I>&gt;<i> 
</I>&gt;<i> Please clarify what your use case is.
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;&gt;<i> I mean not to redirect users with url redirection. Just act as a proxy
</I>&gt;&gt;<i> but having Squid the proper acknoledge internally for being able to make
</I>&gt;&gt;<i> the proper request to the destination?. Is it possible without
</I>&gt;&gt;<i> redirecting url, to return for instance a 403 error to the source web
</I>&gt;&gt;<i> browser in order to not be able to access to the site if some kind of
</I>&gt;&gt;<i> circumstances are given?.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> If the last config, was not possible... perhaps I needed to just to
</I>&gt;&gt;<i> redirect forcibly?. I have read for that purpose you can use URL
</I>&gt;&gt;<i> redirectors.... so I assume the concept is :
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> - Receive request : <A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> to really perform a request as : <A HREF="https://oooeeee.eeee.ttt/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt/u?ii=99&amp;j=88</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A>&gt;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> If all conditions for allowing to see the content are OK, return the web
</I>&gt;&gt;<i> browser a 301 redirect answer with the
</I>&gt;&gt;<i> <A HREF="https://oooeeee.eeee.ttt/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt/u?ii=99&amp;j=88</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A>&gt; URL. Else,
</I>&gt;&gt;<i> just return a 403 or redirect you to a Forbidden page... I think this
</I>&gt;&gt;<i> could be implemented with URL redirectors...but... the fact is... which
</I>&gt;&gt;<i> kind of conditions or env situations can you use for validating the
</I>&gt;&gt;<i> content inside the url redirector?.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks a lot for your time :)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers!
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> -- 
</I>&gt;&gt;<i> sarenet
</I>&gt;&gt;<i> *Egoitz Aurrekoetxea*
</I>&gt;&gt;<i> Dpto. de sistemas
</I>&gt;&gt;<i> 944 209 470
</I>&gt;&gt;<i> Parque Tecnol&#243;gico. Edificio 103
</I>&gt;&gt;<i> 48170 Zamudio (Bizkaia)
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">egoitz at sarenet.es</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">egoitz at sarenet.es</A>&gt;
</I>&gt;&gt;<i> www.sarenet.es [1] &lt;<A HREF="http://www.sarenet.es">http://www.sarenet.es</A>&gt;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Antes de imprimir este correo electr&#243;nico piense si es necesario hacerlo.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I> 

Links:
------
[1] <A HREF="http://www.sarenet.es">http://www.sarenet.es</A>
[2] <A HREF="https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;amp;j=88">https://oooeeee.eeee.ttt.thesquidserver.org/u?ii=99&amp;j=88</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190304/b64f94bb/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190304/b64f94bb/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020300.html">[squid-users] Squid and url modifying
</A></li>
	<LI>Next message (by thread): <A HREF="020309.html">[squid-users] Squid and url modifying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20306">[ date ]</a>
              <a href="thread.html#20306">[ thread ]</a>
              <a href="subject.html#20306">[ subject ]</a>
              <a href="author.html#20306">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
