<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] reply_header_access for Strict-Transport-Security doesn't work
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20reply_header_access%20for%20Strict-Transport-Security%0A%20doesn%27t%20work&In-Reply-To=%3Cb51c7887-85e8-401c-e6f8-1952f53b52be%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020360.html">
   <LINK REL="Next"  HREF="020362.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] reply_header_access for Strict-Transport-Security doesn't work</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20reply_header_access%20for%20Strict-Transport-Security%0A%20doesn%27t%20work&In-Reply-To=%3Cb51c7887-85e8-401c-e6f8-1952f53b52be%40treenet.co.nz%3E"
       TITLE="[squid-users] reply_header_access for Strict-Transport-Security doesn't work">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Mar 12 22:41:42 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020360.html">[squid-users] reply_header_access for Strict-Transport-Security	doesn't work
</A></li>
        <LI>Next message (by thread): <A HREF="020362.html">[squid-users] attempting to disable (or mute) logs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20361">[ date ]</a>
              <a href="thread.html#20361">[ thread ]</a>
              <a href="subject.html#20361">[ subject ]</a>
              <a href="author.html#20361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/03/19 8:10 am, leomessi983 wrote:
&gt;<i> Hi Amos,tank you for your reply!
</I>&gt;<i> 
</I>&gt;&gt;<i> Current Squid automatically erase that header to prevent HSTS breaking
</I>&gt;&gt;<i> web traffic. Where possible try to get clients to upgrade to Browsers
</I>&gt;&gt;<i> which have also dropped use of the feature.
</I>&gt;<i> 
</I>&gt;<i> My clients have last Firefox browser but when i use squid and bumb sites
</I>&gt;<i> for my block sites my client get HSTS error and squid doesn't
</I>&gt;<i> automatically erase that header!
</I>&gt;<i> Should i enable some feature or something else in squid configuration?
</I>

If your Squid is not removing it then add config like you had earlier.

BUT use the reply header directive instead of the request one:

 reply_header_access Strict-Transport-Security deny all



&gt;<i> How can i know that squid does that automatically?!
</I>
The header named &quot;Strict-Transport-Security&quot; should not exist in HTTP
response messages delivered by Squid to any client.

Note that HTTPS messages delivered inside CONNECT tunnels are not
touched by Squid in any way unless SSL-Bump features are being used.

Also that modern web traffic can be using any one of 5 protocols for
messaging (SPDY, HTTP/2, QUIC, HTTP/3 and WebSockets) over which Squid
has no control. If any of those are in use they act as side-channels
where the HSTS header can be delivered to the client despite anything
Squid does.


&gt;<i> Is certificate and certificate type is important?!
</I>&gt;<i> 
</I>
Not as far as I know. This HSTS is just a requirement to use secure
connections in place of plain=text HTTP connections.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020360.html">[squid-users] reply_header_access for Strict-Transport-Security	doesn't work
</A></li>
	<LI>Next message (by thread): <A HREF="020362.html">[squid-users] attempting to disable (or mute) logs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20361">[ date ]</a>
              <a href="thread.html#20361">[ thread ]</a>
              <a href="subject.html#20361">[ subject ]</a>
              <a href="author.html#20361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
