<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TAG_NONE/403 on www.mediavida.com
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TAG_NONE/403%20on%20www.mediavida.com&In-Reply-To=%3C4d5bbb1c-203d-ced7-6e8f-ce35c29ad207%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020587.html">
   <LINK REL="Next"  HREF="020594.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TAG_NONE/403 on www.mediavida.com</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TAG_NONE/403%20on%20www.mediavida.com&In-Reply-To=%3C4d5bbb1c-203d-ced7-6e8f-ce35c29ad207%40treenet.co.nz%3E"
       TITLE="[squid-users] TAG_NONE/403 on www.mediavida.com">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri May 24 15:29:03 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020587.html">[squid-users] TAG_NONE/403 on www.mediavida.com
</A></li>
        <LI>Next message (by thread): <A HREF="020594.html">[squid-users] TAG_NONE/403 on www.mediavida.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20588">[ date ]</a>
              <a href="thread.html#20588">[ thread ]</a>
              <a href="subject.html#20588">[ subject ]</a>
              <a href="author.html#20588">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/05/19 1:45 am, Enrique Calatayud wrote:
&gt;<i> Hello everyone!
</I>&gt;<i> 
</I>&gt;<i> I'm getting a TAG_NONE/403 error with the basic configuration on my
</I>&gt;<i> squid proxy server. I've been working on this since the last week but
</I>&gt;<i> still no positive results.
</I>&gt;<i> 
</I>&gt;<i> I tried several things, even a whitelist. Here is my squid.conf.
</I>
...

&gt;<i> ssl_bump allow all
</I>
&quot;allow&quot; is not a valid action for this directive.

&lt;<A HREF="https://wiki.squid-cache.org/Features/SslPeekAndSplice#Actions">https://wiki.squid-cache.org/Features/SslPeekAndSplice#Actions</A>&gt;

...
&gt;<i> http_access deny blocksitelist
</I>&gt;<i> http_access allow whitelist
</I>&gt;<i> http_access allow CONNECT whitelist
</I>
Complex access controls being done before even the most
simple/fast/basic security check to prevent DOS attacks.

Move the above http_access lines ...

&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> http_access allow localhost manager
</I>&gt;<i> http_access deny manager
</I>
... down to here where custom access controls should be.

Except for the &quot;allow CONNECT whitelist&quot; line which you can delete
completely. It is pointless behind &quot;allow whitelist&quot;.


&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> http_access allow all
</I>
This is now an &quot;open proxy&quot; - not a good idea.


&gt;<i> http_port 0.0.0.0:3128 
</I>&gt;<i> https_port 0.0.0.0:3128 ssl-bump
</I>&gt;<i> cert=/etc/squid/squid-cert/cert.pem generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=4MB
</I>
So port 3128 is simultaneously receiving TLS and non-TLS (plain-text)
traffic syntax?

That is not possible. With the above settings, Squid should log a
complaint in cache.log and only open the first (http_port) to use the
specific IP:port value.

To work at all port directives need unique IP:port settings.


...
&gt;<i> 
</I>&gt;<i> I tried not using certs, using &quot;http_access allow all&quot; on top of the
</I>&gt;<i> rules and disabling others, decrypting ssl...
</I>&gt;<i> Is not happening with other websites. I'm starting to think that this is
</I>&gt;<i> not my problem...
</I>
&quot;403 Forbidden&quot; can be sent by any HTTP agent.


&gt;<i> 
</I>&gt;<i> So, any of you have troubles with www.mediavida.com
</I>&gt;<i> &lt;<A HREF="http://www.mediavida.com">http://www.mediavida.com</A>&gt; under your squid proxy server? Or any of&#160; you
</I>&gt;<i> have any clue about what I am missing here?
</I>
You are missing the rest of the access.log line. The parts which tell
you (and us) what was being done that got forbidden, which agent was
doing it, what other agents were involved with the decision, and when
all this happened.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020587.html">[squid-users] TAG_NONE/403 on www.mediavida.com
</A></li>
	<LI>Next message (by thread): <A HREF="020594.html">[squid-users] TAG_NONE/403 on www.mediavida.com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20588">[ date ]</a>
              <a href="thread.html#20588">[ thread ]</a>
              <a href="subject.html#20588">[ subject ]</a>
              <a href="author.html#20588">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
