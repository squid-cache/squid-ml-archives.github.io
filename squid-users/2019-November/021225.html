<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Unsuccessful at using Squid v4 with intercept
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unsuccessful%20at%20using%20Squid%20v4%20with%20intercept&In-Reply-To=%3C8d65149e-3209-a043-cb31-520193854f61%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021237.html">
   <LINK REL="Next"  HREF="021229.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Unsuccessful at using Squid v4 with intercept</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unsuccessful%20at%20using%20Squid%20v4%20with%20intercept&In-Reply-To=%3C8d65149e-3209-a043-cb31-520193854f61%40treenet.co.nz%3E"
       TITLE="[squid-users] Unsuccessful at using Squid v4 with intercept">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Nov  1 06:01:58 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021237.html">[squid-users] helperHandleRead: unexpected read
</A></li>
        <LI>Next message (by thread): <A HREF="021229.html">[squid-users] Unsuccessful at using Squid v4 with intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21225">[ date ]</a>
              <a href="thread.html#21225">[ thread ]</a>
              <a href="subject.html#21225">[ subject ]</a>
              <a href="author.html#21225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/11/19 5:53 am, FOUTREL S&#233;bastien wrote:
&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> *De :* Antony Stone
</I>&gt;<i> *Envoy&#233; :* mercredi 30 octobre 2019 17:39
</I>&gt;<i> &#160;
</I>&gt;<i> On Wednesday 30 October 2019 at 17:11:29, FOUTREL S&#233;bastien wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hello, I would like to use squid as a transparent proxy for my users.
</I>&gt;<i> 
</I>&gt;&gt;<i> &quot;Clients&quot; are behind a Debian &quot;Router&quot; which MASQUERADE them (as they use
</I>&gt;&gt;<i> RFC 1918 ips).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I have a Squid 4.6 from Debian Buster packages installed on a &quot;Proxy&quot;
</I>&gt;&gt;<i> server which is outside my network.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I read a lot of tutorials and examples from squid site...
</I>&gt;<i> 
</I>&gt;<i> Did that include the links I've given below?
</I>&gt;<i> 
</I>&gt;<i> Yes I read almost all examples config&#160;from&#160;wiki.squid-cache.org
</I>&gt;<i> &lt;<A HREF="https://wiki.squid-cache.org/SquidFaq/InterceptionProxy">https://wiki.squid-cache.org/SquidFaq/InterceptionProxy</A>&gt;
</I>&gt;<i> &lt;<A HREF="https://wiki.squid-cache.org/SquidFaq/InterceptionProxy">https://wiki.squid-cache.org/SquidFaq/InterceptionProxy</A>&gt;And I was
</I>&gt;<i> mislead by the fact that there is a DNAT config and a REDIRECT config..
</I>&gt;<i> DNAT is completely useless if Squid only support to be on the router.
</I>&gt;<i> Wasn't it possible to dnat to a different server with older versions (my
</I>&gt;<i> memory is faulty) ?
</I>&gt;<i> <A HREF="http://tldp.org/HOWTO/TransparentProxy-6.html&#160;for">http://tldp.org/HOWTO/TransparentProxy-6.html&#160;for</A> example.
</I>

Squid-2 used to ignore all NAT errors and just go where the client HTTP
headers were claiming to be going. This proved to be a major security
vulnerability with a pile of nasty related issues and side effects.
CVE-2009-0801 for reference.

DNAT is a tiny amount faster and less CPU cycles on the kernel NAT side
of interception, and can be used in config tricks to get more than 64K
entries in the NAT tables. So it is kept around for extremely
high-traffic proxies.

REDIRECT is better for zero-conf installations or ones with a dynamic IP
address on the proxy machine (eg IPv6 auto-conf and privacy addressing).


&gt;<i> 
</I>&gt;<i> I read the &quot;fw mark and route policy&quot; method as an alternative not the
</I>&gt;<i> only way to go. My mistake.
</I>&gt;<i> 
</I>
Easily made if you are reading *every* example config. Policy Routing
_is_ an alternative ... to WCCP.

There are so many different types of routers with different config
requirements, and also numerous NAT systems. Our formal Intercept
examples are laid out as separate router config example and NAT config
example. Pick one from each category as appropriate to the software your
network uses for each machine.



Cheers
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021237.html">[squid-users] helperHandleRead: unexpected read
</A></li>
	<LI>Next message (by thread): <A HREF="021229.html">[squid-users] Unsuccessful at using Squid v4 with intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21225">[ date ]</a>
              <a href="thread.html#21225">[ thread ]</a>
              <a href="subject.html#21225">[ subject ]</a>
              <a href="author.html#21225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
