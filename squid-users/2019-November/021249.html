<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Another &quot;Forwarding loop detected&quot; issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Another%20%22Forwarding%20loop%20detected%22%20issue&In-Reply-To=%3C97c9d063-4a2c-70cc-1643-73cedc953ab8%40howitts.co.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021253.html">
   <LINK REL="Next"  HREF="021250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Another &quot;Forwarding loop detected&quot; issue</H1>
    <B>Nick Howitt</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Another%20%22Forwarding%20loop%20detected%22%20issue&In-Reply-To=%3C97c9d063-4a2c-70cc-1643-73cedc953ab8%40howitts.co.uk%3E"
       TITLE="[squid-users] Another &quot;Forwarding loop detected&quot; issue">nick at howitts.co.uk
       </A><BR>
    <I>Tue Nov  5 09:40:43 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021253.html">[squid-users] Cannot configure squid 4.6 to splice without bumping
</A></li>
        <LI>Next message (by thread): <A HREF="021250.html">[squid-users] Another &quot;Forwarding loop detected&quot; issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21249">[ date ]</a>
              <a href="thread.html#21249">[ thread ]</a>
              <a href="subject.html#21249">[ subject ]</a>
              <a href="author.html#21249">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am trying to help someone who is running squid-3.5.20-12 on a 
standalone server with the dansguardian content filter and suddenly 
recently has been getting a lot of messages like:

    2019/10/31 13:48:14 kid1| WARNING: Forwarding loop detected for:
    HEAD / HTTP/1.0
    Via: 1.0 HSFilterHyperos7.haftr.local (squid/3.5.20)
    Cache-Control: max-age=259200
    Connection: keep-alive
    X-Forwarded-For: 10.10.1.2
    Host: 10.10.1.2:8080


The access log looks something like:

    1572545946.383 120000 10.10.1.2 TCP_MISS_ABORTED/000 0 HEAD
    <A HREF="http://10.10.1.2:8080/">http://10.10.1.2:8080/</A> - HIER_DIRECT/10.10.1.2 -
    1572545946.477 120000 10.10.1.2 TCP_MISS_ABORTED/000 0 HEAD
    <A HREF="http://10.10.1.2:8080/">http://10.10.1.2:8080/</A> - HIER_DIRECT/10.10.1.2 -
    1572545946.493 120000 10.10.1.2 TCP_MISS_ABORTED/000 0 HEAD
    <A HREF="http://10.10.1.2:8080/">http://10.10.1.2:8080/</A> - HIER_DIRECT/10.10.1.2 -

(but these are for different transactions - they are all the same apart 
from the timestamps)

The content filter listens on port 8080 and squid on 3128. The machine 
is on 10.10.1.2

All the other posts I've seen seem to be for transparent mode or where 
there is a User Agent string. I have found nothing to cover this 
scenario. How can I troubleshoot to fix it and what information do you 
need from me to help diagnose?

The only thing I have thought of is to put in a firewall rule blocking 
traffic from 10.10.1.2 to 10.10.1.2:8080 but I fear shooting myself in 
the foot.

Any help would be greatly appreciated.

Nick


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021253.html">[squid-users] Cannot configure squid 4.6 to splice without bumping
</A></li>
	<LI>Next message (by thread): <A HREF="021250.html">[squid-users] Another &quot;Forwarding loop detected&quot; issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21249">[ date ]</a>
              <a href="thread.html#21249">[ thread ]</a>
              <a href="subject.html#21249">[ subject ]</a>
              <a href="author.html#21249">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
