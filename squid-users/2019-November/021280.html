<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid crash - 3.5.21
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20crash%20-%203.5.21&In-Reply-To=%3C1573387989765-0.post%40n4.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021282.html">
   <LINK REL="Next"  HREF="021283.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid crash - 3.5.21</H1>
    <B>hindsight1</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20crash%20-%203.5.21&In-Reply-To=%3C1573387989765-0.post%40n4.nabble.com%3E"
       TITLE="[squid-users] Squid crash - 3.5.21">suxikang1 at hisilicon.com
       </A><BR>
    <I>Sun Nov 10 12:13:09 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021282.html">[squid-users] squid with Java Problem - Idrac 6 Hp servers
</A></li>
        <LI>Next message (by thread): <A HREF="021283.html">[squid-users] Squid crash - 3.5.21
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21280">[ date ]</a>
              <a href="thread.html#21280">[ thread ]</a>
              <a href="subject.html#21280">[ subject ]</a>
              <a href="author.html#21280">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,Alex
When running Squid4.8 on the arm using SMP. And setting 4 or 7,9  worker
,the same error occurred in the log.
&gt;&gt;<i> Received Bus Error...dying, 
</I>Debugging the core file with gdb found that the address was not aligned. 

Does it consider the case where only address-aligned access is supported on
arm

The question is, why is the type of Item in the PageStack class using
uint32_t, can it be replaced with uint64_t or size_t? When I change to
uint64_t, the problem disappears.
I tried another way to ensure that the theCapacity  parameter passed in to
an even number also solves this problem.

Kind Regards,
hindsight
Alex Rousskov wrote
&gt;<i> On 10/03/2016 04:50 AM, Jasper Van Der Westhuizen wrote:
</I>&gt;&gt;<i> This morning I had some problems with some of our proxies. 2 Proxies in
</I>&gt;&gt;<i> cluster A crashed with the below errors. The shortly afterwards 4 in
</I>&gt;&gt;<i> cluster B did the same. Both clusters are configured to run their cache
</I>&gt;&gt;<i> in memory with SMP and 4 workers configured.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> FATAL: Received Bus Error...dying.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> There are at least two possible reasons:
</I>&gt;<i> 
</I>&gt;<i>   1. A bug in Squid and
</I>&gt;<i>   2. Memory overallocation by the OS kernel.
</I>&gt;<i> 
</I>&gt;<i> To fix the former, the developers will need a stack trace (at least). I
</I>&gt;<i> recommend filing a bug report after getting that trace and excluding
</I>&gt;<i> reason #2. Squid wiki and various system administration guides explain
</I>&gt;<i> how to make Squid dump core files.
</I>&gt;<i> 
</I>&gt;<i> To check for memory overallocation, you can temporary start Squid v4.0
</I>&gt;<i> with &quot;shared_memory_locking on&quot;. Unfortunately, that squid.conf
</I>&gt;<i> directive is not available in Squid v3. You may be able to emulate it
</I>&gt;<i> using some OS-specific sysctl or environment variables, but doing so may
</I>&gt;<i> be far from trivial, and I do not have instructions.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> HTH,
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>
&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at .squid-cache</A>
</I>
&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>




--
Sent from: <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021282.html">[squid-users] squid with Java Problem - Idrac 6 Hp servers
</A></li>
	<LI>Next message (by thread): <A HREF="021283.html">[squid-users] Squid crash - 3.5.21
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21280">[ date ]</a>
              <a href="thread.html#21280">[ thread ]</a>
              <a href="subject.html#21280">[ subject ]</a>
              <a href="author.html#21280">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
