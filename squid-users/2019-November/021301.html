<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] difference of settings doing the same as it seems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20difference%20of%20settings%20doing%20the%20same%20as%20it%20seems&In-Reply-To=%3C889572a2-7048-8b80-7871-3039e92febbf%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021299.html">
   <LINK REL="Next"  HREF="021303.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] difference of settings doing the same as it seems</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20difference%20of%20settings%20doing%20the%20same%20as%20it%20seems&In-Reply-To=%3C889572a2-7048-8b80-7871-3039e92febbf%40measurement-factory.com%3E"
       TITLE="[squid-users] difference of settings doing the same as it seems">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Nov 14 22:38:25 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021299.html">[squid-users] difference of settings doing the same as it seems
</A></li>
        <LI>Next message (by thread): <A HREF="021303.html">[squid-users] logformat for requests using PROXY protocol
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21301">[ date ]</a>
              <a href="thread.html#21301">[ thread ]</a>
              <a href="subject.html#21301">[ subject ]</a>
              <a href="author.html#21301">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/14/19 2:06 PM, Walter H. wrote:

&gt;<i> #ssl_bump stare step1 all
</I>&gt;<i> #ssl_bump splice nobumpsites
</I>&gt;<i> #ssl_bump bump all
</I>
&gt;<i> ssl_bump peek step1
</I>&gt;<i> ssl_bump splice nobumpsites
</I>&gt;<i> ssl_bump stare all
</I>
Both configurations peek at the TLS client Hello. Both configurations
splice nobumpsites during step2 when nobumpsites matches during that
step. Now about the differences:

The first configuration bumps bumpsites (i.e. sites that did not match
nobumpsites) during step2, before the server certificate details are
known. It never reaches step3.

The second configuration uses the implicit &quot;bump if the action during
the previous step was stare and no applicable actions matched during the
current step&quot; rule to bump bumpsites during step3, after learning the
server certificate details.


You can rewrite these two configurations to be more symmetrical but
still have the same respective outcomes:

  # bump at step2
  ssl_bump peek step1
  ssl_bump splice nobumpsites
  ssl_bump bump all

  # bump at step3
  ssl_bump peek step1
  ssl_bump splice nobumpsites
  ssl_bump stare step2
  ssl_bump bump all

As you can see, the only difference is the &quot;stare step2&quot; rule which
allows Squid to learn the server certificate details and incorporate
those details into the generated fake certificate when the connections
are bumped.


&gt;<i> can someone explain the difference between these two ways - the
</I>&gt;<i> commented ones and the other 3 settings?
</I>
If you had good reasons to think that the two configuration are the
same, consider contributing Squid documentation adjustments to better
explain why they are not.

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021299.html">[squid-users] difference of settings doing the same as it seems
</A></li>
	<LI>Next message (by thread): <A HREF="021303.html">[squid-users] logformat for requests using PROXY protocol
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21301">[ date ]</a>
              <a href="thread.html#21301">[ thread ]</a>
              <a href="subject.html#21301">[ subject ]</a>
              <a href="author.html#21301">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
