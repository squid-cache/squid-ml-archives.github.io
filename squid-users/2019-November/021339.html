<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ecap trickling (antivirus scan)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ecap%20trickling%20%28antivirus%20scan%29&In-Reply-To=%3Ce7e67f09-c488-0daf-0324-03e00e641216%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021338.html">
   <LINK REL="Next"  HREF="021361.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ecap trickling (antivirus scan)</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ecap%20trickling%20%28antivirus%20scan%29&In-Reply-To=%3Ce7e67f09-c488-0daf-0324-03e00e641216%40measurement-factory.com%3E"
       TITLE="[squid-users] ecap trickling (antivirus scan)">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Nov 25 17:57:16 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021338.html">[squid-users] ecap trickling (antivirus scan)
</A></li>
        <LI>Next message (by thread): <A HREF="021361.html">[squid-users] ecap trickling (antivirus scan)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21339">[ date ]</a>
              <a href="thread.html#21339">[ thread ]</a>
              <a href="subject.html#21339">[ subject ]</a>
              <a href="author.html#21339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/25/19 12:31 PM, zbox wrote:

&gt;<i> I already have this line before your snippet :
</I>&gt;<i> 
</I>&gt;<i> ecap_service clamav_service_resp respmod_precache uri=<A HREF="ecap://e-cap.org/ecap/services/clamav?mode=RESPMOD">ecap://e-cap.org/ecap/services/clamav?mode=RESPMOD</A> bypass=on
</I>&gt;<i> 
</I>&gt;<i> Sould I try to merge them ?
</I>
Short answer: Yes.

You should have one ecap_service directive per unique eCAP service (that
could mean one ecap_service directive per service URI, but Squid also
takes into account the vectoring point IIRC). Each ecap_service
directive tells Squid everything about the service expectations and
behavior. If you tell Squid two different sets of facts about the same
service, Squid would not know which set is the correct one.

I do not know whether modern Squids warn admins about
conflicting/duplicated ecap_service directives. If Squid does not, that
is a bug. Eventually, duplicated ecap_service directives should be
treated as fatal configuration errors.


HTH,

Alex.



&gt;<i> 19 nov. 2019 &#224; 23:41 de <A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>:
</I>&gt;<i> 
</I>&gt;&gt;<i> On 11/19/19 5:24 AM, zbox wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I've made the changes, the files are now downloaded in the temp dir
</I>&gt;&gt;&gt;<i> but the behaviour is the same on the browser...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Glad your configuration problem got resolved.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There is not enough information to figure out what else, if anything, is
</I>&gt;&gt;<i> broken (and where that breakage is). However, if the adapter was
</I>&gt;&gt;<i> configured to trickle, and you see a temporary download file growing in
</I>&gt;&gt;<i> size _while_ Squid sends _nothing_ to the client (at HTTP level) for
</I>&gt;&gt;<i> several seconds, then there is probably a bug in Squid and/or the
</I>&gt;&gt;<i> adapter. At the very least, Squid should sent the response header to the
</I>&gt;&gt;<i> client.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Without looking at low-level debugging logs (at least), I cannot tell
</I>&gt;&gt;<i> who is at fault, but perhaps others on the list can share trickling
</I>&gt;&gt;<i> success stories or help you with the triage.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021338.html">[squid-users] ecap trickling (antivirus scan)
</A></li>
	<LI>Next message (by thread): <A HREF="021361.html">[squid-users] ecap trickling (antivirus scan)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21339">[ date ]</a>
              <a href="thread.html#21339">[ thread ]</a>
              <a href="subject.html#21339">[ subject ]</a>
              <a href="author.html#21339">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
