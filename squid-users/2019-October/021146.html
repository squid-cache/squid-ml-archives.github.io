<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] re-forwarding questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20re-forwarding%20questions&In-Reply-To=%3C7062c786-4f98-47c1-fee4-f8dd3c0efaf9%40spawn.link%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021155.html">
   <LINK REL="Next"  HREF="021147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] re-forwarding questions</H1>
    <B>Antonio SJ Musumeci</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20re-forwarding%20questions&In-Reply-To=%3C7062c786-4f98-47c1-fee4-f8dd3c0efaf9%40spawn.link%3E"
       TITLE="[squid-users] re-forwarding questions">trapexit at spawn.link
       </A><BR>
    <I>Wed Oct  9 17:34:49 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021155.html">[squid-users] Working peek/splice no longer functioning on some sites
</A></li>
        <LI>Next message (by thread): <A HREF="021147.html">[squid-users] re-forwarding questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21146">[ date ]</a>
              <a href="thread.html#21146">[ thread ]</a>
              <a href="subject.html#21146">[ subject ]</a>
              <a href="author.html#21146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've a setup with N origin servers and N squid instances setup with the 
intent that each squid instance is logically associated with one of the 
origin servers and lists the other N-1 origin servers as other parents. 
Each origin has the same immutable data but spread across buildings. I 
only want them to reach out across buildings if the initial forward 
fails (or perhaps is overloaded). Initial tests seem to work but they 
always try the first origin server and when it fails (in this case with 
a 502 as the backend of a webservice is down) it tries the second. It 
doesn't appear that there is a negative cache on the failure. Is that 
configurable? Regardless, it doesn't cache the re-forward response (a 
200). Is that expected? Configurable? It caches the primary fine when 
functional. A snippet of my config is below. I've looked over the docs 
and source but I'm not finding anything. Also, is it possible from the 
logs to see the name or hostname:port of the cache_peer being forwarded to?

cache_peer HOSTNAME0 parent PORT 0 no-query originserver no-digest ignore-cc
cache_peer HOSTNAME1 parent PORT 0 no-query originserver no-digest ignore-cc
retry_on_error on
cache allow all
refresh_pattern . 1440 100% 10080 ignore-no-cache ignore-no-store 
ignore-private

Thanks


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021155.html">[squid-users] Working peek/splice no longer functioning on some sites
</A></li>
	<LI>Next message (by thread): <A HREF="021147.html">[squid-users] re-forwarding questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21146">[ date ]</a>
              <a href="thread.html#21146">[ thread ]</a>
              <a href="subject.html#21146">[ subject ]</a>
              <a href="author.html#21146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
