<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] acl for matching URLs (non-regex)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20for%20matching%20URLs%20%28non-regex%29&In-Reply-To=%3Cd41dc9f3-6868-bbac-c264-d2aaa96d97dd%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021209.html">
   <LINK REL="Next"  HREF="021218.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] acl for matching URLs (non-regex)</H1>
    <B>Felix Leimbach</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20acl%20for%20matching%20URLs%20%28non-regex%29&In-Reply-To=%3Cd41dc9f3-6868-bbac-c264-d2aaa96d97dd%40gmail.com%3E"
       TITLE="[squid-users] acl for matching URLs (non-regex)">felix.leimbach at gmail.com
       </A><BR>
    <I>Sun Oct 27 17:10:53 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021209.html">[squid-users] Call for adaptation after sni peeked
</A></li>
        <LI>Next message (by thread): <A HREF="021218.html">[squid-users] acl for matching URLs (non-regex)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21208">[ date ]</a>
              <a href="thread.html#21208">[ thread ]</a>
              <a href="subject.html#21208">[ subject ]</a>
              <a href="author.html#21208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I want to include the URLhaus blacklist [1] to protect my users from malware, since squidblacklists.org doesn't seem to be actively maintained anymore (RIP Ben Nichols).

However there does not seem to exist an acl type that can match plain URLs in this form:

<A HREF="http://tvmarket.co.kr/Order/Document.zip?natcanotti.biz[document_pdf_____+.exe%5D%2F%3F">http://tvmarket.co.kr/Order/Document.zip?natcanotti.biz[document_pdf_____+.exe%5D%2F%3F</A>

Note the URL is not regex-friendly so url_regex is not an option.

How do people block exact URLs?
Is a c-icap module needed for this?

Thanks

Felix

[1] <A HREF="https://urlhaus.abuse.ch/api/#retrieve">https://urlhaus.abuse.ch/api/#retrieve</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021209.html">[squid-users] Call for adaptation after sni peeked
</A></li>
	<LI>Next message (by thread): <A HREF="021218.html">[squid-users] acl for matching URLs (non-regex)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21208">[ date ]</a>
              <a href="thread.html#21208">[ thread ]</a>
              <a href="subject.html#21208">[ subject ]</a>
              <a href="author.html#21208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
