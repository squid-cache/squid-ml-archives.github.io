<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid proxy will forward message with 'alternating host header' but logs another?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20will%20forward%20message%20with%0A%20%27alternating%20host%20header%27%20but%20logs%20another%3F&In-Reply-To=%3C50498d63-f15f-d706-c315-dd7140820969%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021220.html">
   <LINK REL="Next"  HREF="021223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid proxy will forward message with 'alternating host header' but logs another?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20proxy%20will%20forward%20message%20with%0A%20%27alternating%20host%20header%27%20but%20logs%20another%3F&In-Reply-To=%3C50498d63-f15f-d706-c315-dd7140820969%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid proxy will forward message with 'alternating host header' but logs another?">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Oct 31 14:18:33 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021220.html">[squid-users] Squid proxy will forward message with 'alternating host header' but logs another?
</A></li>
        <LI>Next message (by thread): <A HREF="021223.html">[squid-users] optional verification of clients?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21221">[ date ]</a>
              <a href="thread.html#21221">[ thread ]</a>
              <a href="subject.html#21221">[ subject ]</a>
              <a href="author.html#21221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/31/19 7:48 AM, Mark Bergman wrote:
&gt;<i>     logformat combined2 ... %ru ... &quot;%&gt;h&quot;
</I>
&gt;<i> example log line:
</I>
&gt;<i>     ... <A HREF="http://www.google.com/">http://www.google.com/</A> ... &quot;...Orig-Host:
</I>&gt;<i>     someevilhost.appspot.com\r\nHost:
</I>&gt;<i>     www.google.com\r\n&quot;&#160;
</I>

&gt;<i> I'm looking for a&#160; way to have Squid log the original request
</I>
You are already doing the right thing. Squid promises that &quot;%&gt;h&quot; is the
received request header [before any adaptations, including the Host
header rewrites]. There is a bug in Squid that breaks that documentation
promise and makes it impossible to log what you want without changing
Squid code. Quality pull requests fixing that bug (or their sponsorship)
are welcomed.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021220.html">[squid-users] Squid proxy will forward message with 'alternating host header' but logs another?
</A></li>
	<LI>Next message (by thread): <A HREF="021223.html">[squid-users] optional verification of clients?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21221">[ date ]</a>
              <a href="thread.html#21221">[ thread ]</a>
              <a href="subject.html#21221">[ subject ]</a>
              <a href="author.html#21221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
