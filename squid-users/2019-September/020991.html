<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] intercept vs. accel vhost allow-direct
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20intercept%20vs.%20accel%20vhost%20allow-direct&In-Reply-To=%3Cae1d3991-9959-e1a2-27c5-060ebc4fad76%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020989.html">
   <LINK REL="Next"  HREF="020992.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] intercept vs. accel vhost allow-direct</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20intercept%20vs.%20accel%20vhost%20allow-direct&In-Reply-To=%3Cae1d3991-9959-e1a2-27c5-060ebc4fad76%40treenet.co.nz%3E"
       TITLE="[squid-users] intercept vs. accel vhost allow-direct">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Sep 12 09:39:52 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="020989.html">[squid-users] intercept vs. accel vhost allow-direct
</A></li>
        <LI>Next message (by thread): <A HREF="020992.html">[squid-users] intercept vs. accel vhost allow-direct
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20991">[ date ]</a>
              <a href="thread.html#20991">[ thread ]</a>
              <a href="subject.html#20991">[ subject ]</a>
              <a href="author.html#20991">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/09/19 8:43 pm, sknz wrote:
&gt;<i> I'm running a hotspot(CoovaChilli, Freeradius, etc.) server where
</I>&gt;<i> Squid-3.4.8(SSL enabled) for caching and logging. My machine is running on
</I>&gt;<i> Debian 8.1.1 with 2 NIC card. One for WAN and another for LAN to manage
</I>&gt;<i> hotspot AP(s).
</I>&gt;<i> 
</I>&gt;<i> ERROR
</I>&gt;<i> The requested URL could not be retrieved
</I>&gt;<i> 
</I>&gt;<i> Below configuration is throwing this above error page :
</I>&gt;<i> http_port 3128
</I>&gt;<i> http_port 3127 intercept
</I>&gt;<i> 
</I>&gt;<i> Instead, I have to use this :
</I>&gt;<i> http_port 3128 accel vhost allow-direct                                                                                                                                                                                                                   
</I>&gt;<i> 
</I>
(Congratulations you now have CVE-2009-0801)

&gt;<i> Now it works! Squid is not throwing any error log for both cases. Why
</I>&gt;<i> INTERCEPT is not working?
</I>
Because &quot;The requested URL could not be retrieved&quot;.

intercept means take the origin server details from the NAT system.
Squid will act as transparently as possible, sending the traffic on to
the same server IP address the client was trying to deliver that request to.

accel means Squid is providing CDN services for the domain being
fetched. It has full authority as the origin server and any source of
data is accepted as valid response to the client.

Without any further information I guess that Squid is not able to
connect to the dst-IP the client is trying to connect to. But when DNS
is consulted in Squid's role as CDN, one of the domains other IP
addresses works.
... or maybe the client was actually not going to the server its TCP
claims and you just let malware loose.


(All those firewall settings mean nothing without details about which
IPs Squid is using and which NIC is which.)


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="020989.html">[squid-users] intercept vs. accel vhost allow-direct
</A></li>
	<LI>Next message (by thread): <A HREF="020992.html">[squid-users] intercept vs. accel vhost allow-direct
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20991">[ date ]</a>
              <a href="thread.html#20991">[ thread ]</a>
              <a href="subject.html#20991">[ subject ]</a>
              <a href="author.html#20991">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
