<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] --foreground vs -N
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20--foreground%20vs%20-N&In-Reply-To=%3CCAOyb_EzfgN-ZM8hOQH%2B%3DCjkrigbsqUdH9jLj82vPCPKOvB5oNw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021048.html">
   <LINK REL="Next"  HREF="021050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] --foreground vs -N</H1>
    <B>B. Cook</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20--foreground%20vs%20-N&In-Reply-To=%3CCAOyb_EzfgN-ZM8hOQH%2B%3DCjkrigbsqUdH9jLj82vPCPKOvB5oNw%40mail.gmail.com%3E"
       TITLE="[squid-users] --foreground vs -N">bcook at poughkeepsieschools.org
       </A><BR>
    <I>Wed Sep 18 20:24:24 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021048.html">[squid-users] --foreground vs -N
</A></li>
        <LI>Next message (by thread): <A HREF="021050.html">[squid-users] --foreground vs -N
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21049">[ date ]</a>
              <a href="thread.html#21049">[ thread ]</a>
              <a href="subject.html#21049">[ subject ]</a>
              <a href="author.html#21049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Would you suggest I go back to -N?

I've not seen anything awkward or out of the ordinary in cache.log..

I downloaded and tried to build squid-5 from AUR..

 squid -v
Squid Cache: Version 5.0.0-20190909-ra70e75b76
Service Name: squid
Intercept/WCCPv2/SSL/CRTD/(A)UFS/DISKD/ROCK/eCAP/ICAP/64/GCC Production

This binary uses OpenSSL 1.1.1d  10 Sep 2019. For legal restrictions
on distribution see <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>

(had to go back a  few days for a successful build..)

root:/dev/shm # ls -al
total 5876
drwxrwxrwt  2 root  root         280 2019-09-18 15:15 .
drwxr-xr-x 19 root  root        3340 2019-09-18 06:52 ..
-rw-------  1 proxy proxy     393232 2019-09-18 15:15 squid-cache_mem_ex.shm
-rw-------  1 proxy proxy    3145840 2019-09-18 16:16
squid-cache_mem_map_anchors.shm
-rw-------  1 proxy proxy     131080 2019-09-18 15:15
squid-cache_mem_map_filenos.shm
-rw-------  1 proxy proxy     262156 2019-09-18 15:15
squid-cache_mem_map_slices.shm
-rw-------  1 proxy proxy     131112 2019-09-18 15:15 squid-cache_mem_space.shm
-rw-------  1 proxy proxy          8 2019-09-18 15:15 squid-cf__metadata.shm
-rw-------  1 proxy proxy      32852 2019-09-18 15:15 squid-cf__queues.shm
-rw-------  1 proxy proxy         52 2019-09-18 15:15 squid-cf__readers.shm
-rw-------  1 proxy proxy 1073872936 2019-09-18 15:15 squid-squid-page-pool.shm
-rw-------  1 proxy proxy    1572976 2019-09-18 15:25
squid-transients_map_anchors.shm
-rw-------  1 proxy proxy      65544 2019-09-18 15:15
squid-transients_map_filenos.shm
-rw-------  1 proxy proxy     131084 2019-09-18 15:15
squid-transients_map_slices.shm
root:/dev/shm # uname -a
Linux arch0033-0f2b4d 4.19.73-1-lts #1 SMP Mon Sep 16 17:15:25 CEST
2019 x86_64 GNU/Linux

is this 'buggy' as well?

Thank you for your interest in my question(s); greatly appreciated.

On Wed, Sep 18, 2019 at 4:14 PM Alex Rousskov
&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On 9/18/19 3:37 PM, B. Cook wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; this is /dev/shm with --foreground (no workers)
</I>&gt;<i>
</I>&gt;<i> &gt; -rw-------  1 proxy proxy    8 2019-09-18 10:30 squid-cf__metadata.shm
</I>&gt;<i> &gt; -rw-------  1 proxy proxy 8216 2019-09-18 10:30 squid-cf__queues.shm
</I>&gt;<i> &gt; -rw-------  1 proxy proxy   36 2019-09-18 10:30 squid-cf__readers.shm
</I>&gt;<i>
</I>&gt;<i> Your Squid is buggy: These collapsed forwarding shared memory segments
</I>&gt;<i> should not be created for non-SMP configurations. Using these collapsed
</I>&gt;<i> forwarding segments might slow down a non-SMP Squid instance, but I do
</I>&gt;<i> not know whether they are actually _used_. I suspect they are not.
</I>&gt;<i>
</I>&gt;<i> The latest (future v5) Squid has the same bug AFAICT.
</I>&gt;<i>
</I>&gt;<i> Unfortunately, in my future-v5 tests, the same or similar bug exists in
</I>&gt;<i> Squids started with -N, so this bug is probably not a good suspect in
</I>&gt;<i> your investigation. I have no other suspects to offer at this time.
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; On Wed, Sep 18, 2019 at 2:38 PM Alex Rousskov wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; One thing you may want to check is whether your --foreground Squid is
</I>&gt;<i> &gt;&gt; creating shared memory segments (look in /dev/shm/ or equivalent).
</I>&gt;<i> &gt;&gt; Creating shared memory segments in non-SMP configurations is a bug.
</I>&gt;<i> &gt;&gt; IIRC, we have fixed one or two of those bugs, but there may be more, and
</I>&gt;<i> &gt;&gt; using shared memory tables can decrease performance of non-SMP
</I>&gt;<i> &gt;&gt; configurations (there is no free lunch).
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>


-- 
Network Analyst
Poughkeepsie City School District
SMS &amp; Mobile: (202) 810-5827
twitter.com/bcookatpcsd

If you can't explain it simply, you don't understand it well enough.

-- 

This message may contain confidential information and is intended only for 
the individual(s) named. If you are not an intended recipient you are not 
authorized to disseminate, distribute or copy this e-mail. Please notify 
the sender immediately if you have received this e-mail by mistake and 
delete this e-mail from your system.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021048.html">[squid-users] --foreground vs -N
</A></li>
	<LI>Next message (by thread): <A HREF="021050.html">[squid-users] --foreground vs -N
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21049">[ date ]</a>
              <a href="thread.html#21049">[ thread ]</a>
              <a href="subject.html#21049">[ subject ]</a>
              <a href="author.html#21049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
