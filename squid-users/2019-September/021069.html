<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Protecting squid against ddos attacks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Protecting%20squid%20against%20ddos%20attacks&In-Reply-To=%3CCAOhxsyxkNViKYsz1PxLJmSU8Uu5%3DEsUY_EF8m_Gv1esCnbwnXg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021061.html">
   <LINK REL="Next"  HREF="021098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Protecting squid against ddos attacks</H1>
    <B>Chirayu Patel</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Protecting%20squid%20against%20ddos%20attacks&In-Reply-To=%3CCAOhxsyxkNViKYsz1PxLJmSU8Uu5%3DEsUY_EF8m_Gv1esCnbwnXg%40mail.gmail.com%3E"
       TITLE="[squid-users] Protecting squid against ddos attacks">chirayu.patel at truecomtelesoft.com
       </A><BR>
    <I>Sun Sep 22 13:59:46 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021061.html">[squid-users] Protecting squid against ddos attacks
</A></li>
        <LI>Next message (by thread): <A HREF="021098.html">[squid-users] Protecting squid against ddos attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21069">[ date ]</a>
              <a href="thread.html#21069">[ thread ]</a>
              <a href="subject.html#21069">[ subject ]</a>
              <a href="author.html#21069">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Amos,

Thanks a lot for giving some amazing insights..

So currently I am using Squid to achieve 2 things :
a) Content Filtering - by checking the url against an external db and allow
and block it accordingly. (using url_rewriter).
b) To popup captive portal

1) Regarding the use of 4 ports
Using iptables, I am redirecting the non authenticated users to ports  3132
 &amp; 3133. And then in squid i am checking the port on which I have received
the request from. If its the above ports, then I run the captive portal flow

Once the user is authenticated , then I redirect their traffic to ports 3129
and 3131, and for those ports I run the content policy flow.

I am not sure if this is the right way of choosing the flow. Please advise
if there is any other way to run two different flows with one squid.

2) Actually 3128 port is there in the config.. missed to attach that..

3) Right now I have configured firewall to only allow these 4 ports on the
INPUT chain, so I am not expecting traffic to come from any other ports. In
that case, is it okay if I have removed the default config and kept
&quot;http_access allow all&quot; ??
The only issue is that the attacker now has 4 ports to run attacks on.

4) &gt; on_unsupported_protocol tunnel all

I had added this when I faced issue with one of the Apps, Whatsapp which
send the http traffic on https port. If I replace that with *respond*, I
guess Whatsapp will become unusable.. right ?

5) ipcache_size &amp; fqdncache_size.
I was too concerned about the memory usage but I believe it does more bad
than good.  I will increase them to their defaults.

6) cache_mem 0 MB
The default cache memory is quite huge (256 MB). That is approx the total
usable memory I have on the AP. In that case, what do you think should be a
good starting point in case I keep it to a non zero value ?

7) memory_pools off
Again, I was too concerned about memory use and I got scared because of
this comment
------ ------ ------ ------ ------ ------ ------ ------ ------ ------
------ ------ ------ ------
If set, Squid will keep pools of allocated (but unused) memory available
for future use. If memory is a premium on your system and you believe your
malloc library outperforms Squid  routines, disable this.
------------- ------ ------ ------ ------ ------ ------ ------ ------
------ ------ ------
But I believe some memory in exchange of performance is OK. So I am going
to enable it.

8) The reason for keeping a single url_rewrite process has got to do with
caching of the external content policy api replies which is mainly to avoid
making external calls if the cache is available. If I have multiple
processes, the cache will get divided amongst multiple processes depending
on which one has made the call.

9) max_filedesc 5120.
I had kept this number bigger because we were getting &quot;out of file
descriptors error&quot;

10) Above all, the best thing would be a way to differentiate between a
high traffic flow of http(s) requests coming in from legitimate users vs a
high traffic flow generated by an attacker with a simple script.

--
Thank You
Chirayu Patel
Truecom Telesoft
+91 8758484287




On Sat, 21 Sep 2019 at 17:33, &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>&gt;
wrote:

&gt;<i> Send squid-users mailing list submissions to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of squid-users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: Protecting squid against ddos attacks (Amos Jeffries)
</I>&gt;<i>    2. Re: Help with HTTPS SQUID 3.1.23 https proxy not  working
</I>&gt;<i>       (KleinEdith)
</I>&gt;<i>    3. Re: Help with HTTPS SQUID 3.1.23 https proxy not working
</I>&gt;<i>       (Matus UHLAR - fantomas)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Sat, 21 Sep 2019 12:19:18 +1200
</I>&gt;<i> From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Protecting squid against ddos attacks
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">835c4d02-4246-8c65-f9ce-cf91c7dd9e92 at treenet.co.nz</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i>
</I>&gt;<i> On 21/09/19 1:03 am, Chirayu Patel wrote:
</I>&gt;<i> &gt; --&gt; I have installed squid in a wifi access point which will in many
</I>&gt;<i> &gt; cases behave as an edge gateway as well.. So basically it itself is the
</I>&gt;<i> &gt; firewall. There is nothing in front to protect it.
</I>&gt;<i> &gt; --&gt; There are 4 ports that are opened.. If someone decides to do a DDOS
</I>&gt;<i> &gt; attack on them, what options do I have to protect against them.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Pretty much the exact opposite of what you have this proxy configured to
</I>&gt;<i> be doing.
</I>&gt;<i>
</I>&gt;<i> Right now you have it setup to allow all traffic *from* anywhere *to*
</I>&gt;<i> anywhere, with no controls, no logging, and no report to any backend
</I>&gt;<i> where the traffic originated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Squid default configuration comes with some DoS protections as
</I>&gt;<i> recommended config, some are built-in and always working.
</I>&gt;<i>
</I>&gt;<i> &gt; This is my squid config file :
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------------------------------------------
</I>&gt;<i> &gt; http_port 3129 intercept
</I>&gt;<i> &gt; https_port 3131 intercept ssl-bump cert=/etc/ray/certificates/myCA.pem \
</I>&gt;<i> &gt;     generate-host-certificates=off dynamic_cert_mem_cache_size=2MB
</I>&gt;<i> &gt; ## For Captive Portal
</I>&gt;<i> &gt; http_port 3132 intercept
</I>&gt;<i> &gt; https_port 3133 intercept ssl-bump cert=/etc/ray/certificates/myCA.pem \
</I>&gt;<i> &gt;     generate-host-certificates=off dynamic_cert_mem_cache_size=1MB
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> That comment &quot;For Captive Portal&quot; is out of place. Interception *is*
</I>&gt;<i> captive portal, so all your ports above are captive portal ports.
</I>&gt;<i>
</I>&gt;<i> Usually you would only need one port of each type. Including the
</I>&gt;<i> forward-proxy port (3128 with no mode flag, which you are missing).
</I>&gt;<i>
</I>&gt;<i> For DoS and DDoS protection, having more ports receiving traffic does
</I>&gt;<i> help by allowing more TCP port numbers to be available for use. But you
</I>&gt;<i> need firewall rules to spread the traffic load across those ports. See
</I>&gt;<i> the &quot;Frontend Alternative 1&quot; section of
</I>&gt;<i>  &lt;<A HREF="https://wiki.squid-cache.org/ConfigExamples/ExtremeCarpFrontend">https://wiki.squid-cache.org/ConfigExamples/ExtremeCarpFrontend</A>&gt;
</I>&gt;<i>
</I>&gt;<i> For the best DDoS protection Squid can offer you would have a
</I>&gt;<i> multi-machine setup like that config page is part of. The particular
</I>&gt;<i> Squid you have right now though can gain from just having the port load
</I>&gt;<i> balancing part. You can extend the backend part on other machines later
</I>&gt;<i> if you want / need.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # TLS/SSL bumping definitions
</I>&gt;<i> &gt; acl tls_s1_connect at_step SslBump1
</I>&gt;<i> &gt; acl tls_s2_client_hello at_step SslBump2
</I>&gt;<i> &gt; acl tls_s3_server_hello at_step SslBump3
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Unusued ACLs still consume memory. Not much, but still thats memory.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; # TLS/SSL bumping steps
</I>&gt;<i> &gt; ssl_bump peek tls_s1_connect all # peek at TLS/SSL connect data
</I>&gt;<i>
</I>&gt;<i> The &quot;all&quot; on the above line is unnecessary and a waste of CPU cycles on
</I>&gt;<i> ever next connection. Remove it.
</I>&gt;<i>
</I>&gt;<i> &gt; ssl_bump splice all # splice: no active bumping
</I>&gt;<i> &gt; on_unsupported_protocol tunnel all
</I>&gt;<i>
</I>&gt;<i> The tunnel action causes Squid to setup a server connection. That costs
</I>&gt;<i> 2x TCP ports, 2x FDs, client I/O, server I/O, CPU cycles to perform all
</I>&gt;<i> the I/O, and memory for all the state and I/O buffers
</I>&gt;<i>
</I>&gt;<i> While this may give you good service for weird client traffic. If your
</I>&gt;<i> DDoS risk is high, it may be better to use &quot;respond&quot; instead and an ACL
</I>&gt;<i> with &quot;deny_info TCP_RESET attached&quot;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; pinger_enable off
</I>&gt;<i> &gt; digest_generation off
</I>&gt;<i> &gt; netdb_filename none
</I>&gt;<i> &gt; ipcache_size 128
</I>&gt;<i>
</I>&gt;<i> ipcache being larger will help your high-traffic periods by helping
</I>&gt;<i> reduce delays on traffic you let through the proxy.
</I>&gt;<i>
</I>&gt;<i> DDoS can reduce that benefit. But that is only a *visual* effect, there
</I>&gt;<i> is no more resource consumption than the DDoS would cause with a smaller
</I>&gt;<i> ipcache size.
</I>&gt;<i>
</I>&gt;<i> So reducing this cache size only slows your normal peak traffic at times
</I>&gt;<i> when it needs fastest service. That is a tradeoff against your AP
</I>&gt;<i> machines memory available.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; fqdncache_size 128
</I>&gt;<i>
</I>&gt;<i> Large fqdncache for intercept proxies helps retain valid Host header
</I>&gt;<i> records longer and reduce delays receiving new messages. So larger here
</I>&gt;<i> is better protection, against both normal traffic problems and DDoS.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; via off
</I>&gt;<i> &gt; forwarded_for transparent
</I>&gt;<i> &gt; httpd_suppress_version_string on
</I>&gt;<i> &gt; cache deny all
</I>&gt;<i> &gt; cache_mem 0 MB
</I>&gt;<i>
</I>&gt;<i> Using memory to store objects recently used gives 100x speed increase
</I>&gt;<i> (aka DoS handling capacity).
</I>&gt;<i>
</I>&gt;<i> This though is a tradeoff with the memory you have available. Whether
</I>&gt;<i> that speed gain is nanoseconds, milliseconds or whole seconds depends on
</I>&gt;<i> your network speeds.
</I>&gt;<i>
</I>&gt;<i> FYI: The model of a frontend LB with backend cache machine (like that
</I>&gt;<i> CARP setup earlier) is designed to reduce that speed difference so both
</I>&gt;<i> the resource consumption and speed gain cache gives is primarily
</I>&gt;<i> happening at the backends - which are very close in the network so
</I>&gt;<i> minimal extra delay for the frontend LB.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; memory_pools off
</I>&gt;<i>
</I>&gt;<i> Only if you have to. The memory usage patterns of high-traffic software
</I>&gt;<i> like Squid is quite different from what most OS malloc are optimized
</I>&gt;<i> for. The memory pools in Squid are optimized to reduce that to a number
</I>&gt;<i> of larger more consistently sized allocations.
</I>&gt;<i>
</I>&gt;<i> Without these pools memory allocation cycles add a bit of speed
</I>&gt;<i> reduction to the proxy, and worse can easily lead to memory
</I>&gt;<i> fragmentation issues. Normal traffic speeds these effects are not easily
</I>&gt;<i> noticed, but under DoS or DDoS conditions they can drag the entire
</I>&gt;<i> machine to a crawl if not a complete halt on low-memory systems (like
</I>&gt;<i> yours?).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; shutdown_lifetime 0 seconds
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; #logfile_daemon /dev/null
</I>&gt;<i> &gt; access_log none
</I>&gt;<i>
</I>&gt;<i> A bit part of DoS or DDoS protection is identifying the attack as it
</I>&gt;<i> starts. That requires the information about what traffic is happening to
</I>&gt;<i> go somewhere for processing.
</I>&gt;<i>
</I>&gt;<i> Even if you have something else doing deep packet inspection I would
</I>&gt;<i> enable logs. Use one of the network logging modules to send them to
</I>&gt;<i> another machine if necessary for processing.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; #acl good_url dstdomain .yahoo.com &lt;<A HREF="http://yahoo.com">http://yahoo.com</A>&gt;
</I>&gt;<i> &gt; http_access allow all
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> See the &quot;default config&quot; section of
</I>&gt;<i> &lt;<A HREF="https://wiki.squid-cache.org/Squid-3.5">https://wiki.squid-cache.org/Squid-3.5</A>&gt;. The default rules are
</I>&gt;<i> primarily DoS protections these days, with some other nasty attacks
</I>&gt;<i> (potentially leading to DDoS indirectly) as well.
</I>&gt;<i>
</I>&gt;<i> You need those rules, and you need a clear policy on what traffic you
</I>&gt;<i> allow through the proxy (from where, to where). Once you have that in
</I>&gt;<i> place you can reasonably consider what DoS/DDoS risk is left to deal
</I>&gt;<i> with. So long as your policy and rule is &quot;http_access allow all&quot; you can
</I>&gt;<i> be DoS'ed by a single 38 byte HTTP request message - at least the proxy
</I>&gt;<i> killed completely, possibly the whole machine.
</I>&gt;<i>  (FYI the other protection against this attack is the Via header, which
</I>&gt;<i> you have disabled).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; url_rewrite_program /tmp/squid/urlcat_server_start.sh
</I>&gt;<i> &gt; #url_rewrite_bypass on
</I>&gt;<i> &gt; url_rewrite_children 1 startup=1 idle=1 concurrency=30 queue-size=10000
</I>&gt;<i> &gt; on-persistent-overload=ERR
</I>&gt;<i>
</I>&gt;<i> Having only one helper may be a source of problems under any conditions.
</I>&gt;<i> The ERR will help, but ideally you don't want to reach that state.
</I>&gt;<i>
</I>&gt;<i> Consider whether the thing this helper is doing can be done by ACLs and
</I>&gt;<i> deny_info instead. That would avoid all the helper delays or I/O
</I>&gt;<i> resource needs, and any clients getting those ERR error pages.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; #url_rewrite_access allow all
</I>&gt;<i> &gt; #url_rewrite_extras &quot;%&gt;a/%&gt;A %un %&gt;rm bump_mode=%ssl::bump_mode
</I>&gt;<i> &gt; sni=\&quot;%ssl::&gt;sni\&quot; referer=\&quot;%{Referer}&gt;h\&quot;&quot;
</I>&gt;<i> &gt; url_rewrite_extras &quot;%&gt;a %lp %ssl::&gt;sni&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; max_filedesc 5120
</I>&gt;<i>
</I>&gt;<i> This is the most direct measure of how large a DoS has to be to kill
</I>&gt;<i> your traffic. The smaller it is the fewer connections the DoS needs to
</I>&gt;<i> open.
</I>&gt;<i>
</I>&gt;<i> There is a tradeoff though between the memory each of these needs to
</I>&gt;<i> allocate (~500 bytes just to exist, up to 256KB when in use) vs the
</I>&gt;<i> memory your machine has available.
</I>&gt;<i>
</I>&gt;<i> The reduction of that &quot;in use&quot; time also matters as one might expect.
</I>&gt;<i> Which is where the cache_mem speedup comes in, to answer repeat queries
</I>&gt;<i> (eg those seen in a classical DoS) at orders of magnitude higher speed
</I>&gt;<i> than the backend network can provide the same answer.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; coredump_dir /tmp
</I>&gt;<i> &gt; client_lifetime 30 minutes
</I>&gt;<i> &gt; read_ahead_gap 8 KB
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Additional to all the above, you can setup a &quot;deny_info TCP_RESET ...&quot;
</I>&gt;<i> for any ACLs which does a deny action in your rules. That will prevent
</I>&gt;<i> Squid generating an error page and consuming bandwidth to deliver it
</I>&gt;<i> when that ACL blocks access.
</I>&gt;<i>
</I>&gt;<i> There is a tradeoff between annoying clients who no longer know why
</I>&gt;<i> their connection ended, but under DoS or DDoS it is a huge bandwidth saver.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Amos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Sat, 21 Sep 2019 02:51:05 -0500 (CDT)
</I>&gt;<i> From: KleinEdith &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">SEO.Workwide at gmail.com</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Help with HTTPS SQUID 3.1.23 https proxy
</I>&gt;<i>         not     working
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">1569052265880-0.post at n4.nabble.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;<i>
</I>&gt;<i> Squid as the https proxy not working
</I>&gt;<i>
</I>&gt;<i> # Example rule allowing access from your local networks.
</I>&gt;<i> # Adapt to list your (internal) IP networks from where browsing
</I>&gt;<i> # should be allowed
</I>&gt;<i> acl localnet src 10.0.0.0/8 # RFC1918 possible internal network
</I>&gt;<i> acl localnet src 172.16.0.0/12  # RFC1918 possible internal network
</I>&gt;<i> acl localnet src 192.168.0.0/16 # RFC1918 possible internal network
</I>&gt;<i> #acl localnet src fc00::/7       # RFC 4193 local private network range
</I>&gt;<i> #acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
</I>&gt;<i> machines
</I>&gt;<i> acl localnet src 10.0.0.188 # David Computer
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl Safe_ports port 80      # http
</I>&gt;<i> acl Safe_ports port 21      # ftp
</I>&gt;<i> acl Safe_ports port 443     # https
</I>&gt;<i> acl Safe_ports port 70      # gopher
</I>&gt;<i> acl Safe_ports port 210     # wais
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> acl Safe_ports port 280     # http-mgmt
</I>&gt;<i> acl Safe_ports port 488     # gss-http
</I>&gt;<i> acl Safe_ports port 591     # filemaker
</I>&gt;<i> acl Safe_ports port 777     # multiling http
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i>
</I>&gt;<i> acl bad_urls dstdomain &quot;/etc/squid/blacklisted_sites.acl&quot;
</I>&gt;<i> acl good_url dstdomain &quot;/etc/squid/good_sites.acl&quot;
</I>&gt;<i> #http_access deny bad_url
</I>&gt;<i>
</I>&gt;<i> I can&#180;t connect to:
</I>&gt;<i>
</I>&gt;<i> Outlook.com &lt;<A HREF="https://outlook.live.com">https://outlook.live.com</A>&gt;
</I>&gt;<i> Yahoo.com &lt;<A HREF="https://www.yahoo.com/">https://www.yahoo.com/</A>&gt;
</I>&gt;<i> SuCarroRD.com &lt;<A HREF="https://sucarrord.com/">https://sucarrord.com/</A>&gt;
</I>&gt;<i> Gmail.com &lt;<A HREF="http://gmail.com/">http://gmail.com/</A>&gt;
</I>&gt;<i> Bing &lt;<A HREF="https://www.bing.com/">https://www.bing.com/</A>&gt;
</I>&gt;<i>
</I>&gt;<i> And more. I need help please to fix this problem
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Sent from:
</I>&gt;<i> <A HREF="http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html">http://squid-web-proxy-cache.1019090.n4.nabble.com/Squid-Users-f1019091.html</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Sat, 21 Sep 2019 10:07:31 +0200
</I>&gt;<i> From: Matus UHLAR - fantomas &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Help with HTTPS SQUID 3.1.23 https proxy
</I>&gt;<i>         not working
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">20190921080731.GB29045 at fantomas.sk</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=iso-8859-2; format=flowed
</I>&gt;<i>
</I>&gt;<i> On 21.09.19 02:51, KleinEdith wrote:
</I>&gt;<i> &gt;Squid as the https proxy not working
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;# Example rule allowing access from your local networks.
</I>&gt;<i> &gt;# Adapt to list your (internal) IP networks from where browsing
</I>&gt;<i> &gt;# should be allowed
</I>&gt;<i> &gt;acl localnet src 10.0.0.0/8 # RFC1918 possible internal network
</I>&gt;<i> &gt;acl localnet src 172.16.0.0/12  # RFC1918 possible internal network
</I>&gt;<i> &gt;acl localnet src 192.168.0.0/16 # RFC1918 possible internal network
</I>&gt;<i> &gt;#acl localnet src fc00::/7       # RFC 4193 local private network range
</I>&gt;<i> &gt;#acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
</I>&gt;<i> &gt;machines
</I>&gt;<i> &gt;acl localnet src 10.0.0.188 # David Computer
</I>&gt;<i> &gt;acl SSL_ports port 443
</I>&gt;<i> &gt;acl Safe_ports port 80      # http
</I>&gt;<i> &gt;acl Safe_ports port 21      # ftp
</I>&gt;<i> &gt;acl Safe_ports port 443     # https
</I>&gt;<i> &gt;acl Safe_ports port 70      # gopher
</I>&gt;<i> &gt;acl Safe_ports port 210     # wais
</I>&gt;<i> &gt;acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i> &gt;acl Safe_ports port 280     # http-mgmt
</I>&gt;<i> &gt;acl Safe_ports port 488     # gss-http
</I>&gt;<i> &gt;acl Safe_ports port 591     # filemaker
</I>&gt;<i> &gt;acl Safe_ports port 777     # multiling http
</I>&gt;<i> &gt;acl CONNECT method CONNECT
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;acl bad_urls dstdomain &quot;/etc/squid/blacklisted_sites.acl&quot;
</I>&gt;<i> &gt;acl good_url dstdomain &quot;/etc/squid/good_sites.acl&quot;
</I>&gt;<i> &gt;#http_access deny bad_url
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I can&#180;t connect to:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Outlook.com &lt;<A HREF="https://outlook.live.com">https://outlook.live.com</A>&gt;
</I>&gt;<i> &gt;Yahoo.com &lt;<A HREF="https://www.yahoo.com/">https://www.yahoo.com/</A>&gt;
</I>&gt;<i> &gt;SuCarroRD.com &lt;<A HREF="https://sucarrord.com/">https://sucarrord.com/</A>&gt;
</I>&gt;<i> &gt;Gmail.com &lt;<A HREF="http://gmail.com/">http://gmail.com/</A>&gt;
</I>&gt;<i> &gt;Bing &lt;<A HREF="https://www.bing.com/">https://www.bing.com/</A>&gt;
</I>&gt;<i>
</I>&gt;<i> You haven't post whole squid config, did you?
</I>&gt;<i> If you did, you definitely need to llow some access (for limited set of
</I>&gt;<i> IPs), because the default is deny.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
</I>&gt;<i> Warning: I wish NOT to receive e-mail advertising to this address.
</I>&gt;<i> Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
</I>&gt;<i> The early bird may get the worm, but the second mouse gets the cheese.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of squid-users Digest, Vol 61, Issue 28
</I>&gt;<i> *******************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20190922/3f28ceba/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20190922/3f28ceba/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021061.html">[squid-users] Protecting squid against ddos attacks
</A></li>
	<LI>Next message (by thread): <A HREF="021098.html">[squid-users] Protecting squid against ddos attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21069">[ date ]</a>
              <a href="thread.html#21069">[ thread ]</a>
              <a href="subject.html#21069">[ subject ]</a>
              <a href="author.html#21069">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
