<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Warning: ACL is used in context without an HTTP response
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Warning%3A%20ACL%20is%20used%20in%20context%20without%20an%20HTTP%0A%20response&In-Reply-To=%3C263921f2-b2cd-30ea-341b-8cb59702e11a%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021084.html">
   <LINK REL="Next"  HREF="021090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Warning: ACL is used in context without an HTTP response</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Warning%3A%20ACL%20is%20used%20in%20context%20without%20an%20HTTP%0A%20response&In-Reply-To=%3C263921f2-b2cd-30ea-341b-8cb59702e11a%40measurement-factory.com%3E"
       TITLE="[squid-users] Warning: ACL is used in context without an HTTP response">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Sep 25 13:29:17 UTC 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021084.html">[squid-users] Warning: ACL is used in context without an HTTP	response
</A></li>
        <LI>Next message (by thread): <A HREF="021090.html">[squid-users] Warning: ACL is used in context without an HTTP response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21087">[ date ]</a>
              <a href="thread.html#21087">[ thread ]</a>
              <a href="subject.html#21087">[ subject ]</a>
              <a href="author.html#21087">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/25/19 7:12 AM, Alessandro Andrei wrote:
&gt;<i> My access_log file il flooded with messages that I do not want to see
</I>&gt;<i> 
</I>&gt;<i> Specifically 
</I>&gt;<i> 1) CONNECT vortex-win.data.microsoft.com
</I>&gt;<i> 2) TCP_DENIED/407
</I>&gt;<i> 
</I>&gt;<i> So I created two ACLs to exclude them from logging and applied it to my access log
</I>&gt;<i> 
</I>&gt;<i> acl AuthRequest http_status 407
</I>&gt;<i> acl excludefromlog dstdomain .vortex-win.data.microsoft.com
</I>&gt;<i> access_log stdio:/var/log/squid/access.log logformat=squid !AuthRequest !excludefromlog
</I>
FYI: If you have two unwanted record kinds (one CONNECT and one
TCP_DENIED/407), then you should use a different rule to block _each_
record kind. The current rule only blocks logging of records that match
_both_ conditions. Look for any-of ACL.


&gt;<i> It works but now my cache.log is flooded with
</I>&gt;<i> WARNING: AuthRequest ACL is used in context without an HTTP response. Assuming mismatch.
</I>
&gt;<i> I read in the mailing list archives this is the correct behaviour,
</I>
In the context of access_log, it is most likely a Squid bug. We have
recently fixed one similar bug but there may be more:
<A HREF="https://github.com/squid-cache/squid/pull/476">https://github.com/squid-cache/squid/pull/476</A>


BTW, AuthRequest name is misleading. I know what you meant, but the
http_status ACL checks the response, not the request.


&gt;<i> but isn't there a way to avoid all this?
</I>
You can try patching your Squid or testing the fixed version. The former
may be difficult if you are not running master-based code (future v5).

You may also be able to avoid the WARNING if you adjust the rule to
check the &quot;has response&quot; condition before checking AuthRequest. Look for
the &quot;has&quot; ACL. However, you would have to decide whether to log all
records that lack responses. If any of those responses are absent due to
Squid bugs, your decision, whatever it is, may be incorrect in some cases.

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021084.html">[squid-users] Warning: ACL is used in context without an HTTP	response
</A></li>
	<LI>Next message (by thread): <A HREF="021090.html">[squid-users] Warning: ACL is used in context without an HTTP response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21087">[ date ]</a>
              <a href="thread.html#21087">[ thread ]</a>
              <a href="subject.html#21087">[ subject ]</a>
              <a href="author.html#21087">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
