<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2020:8 HTTP(S) Request Splitting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A8%20HTTP%28S%29%0A%20Request%20Splitting&In-Reply-To=%3C4678bb72-8d7c-6329-e338-b41064a3f137%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022567.html">
   <LINK REL="Next"  HREF="022569.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2020:8 HTTP(S) Request Splitting</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A8%20HTTP%28S%29%0A%20Request%20Splitting&In-Reply-To=%3C4678bb72-8d7c-6329-e338-b41064a3f137%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2020:8 HTTP(S) Request Splitting">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Aug 23 08:17:24 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022567.html">[squid-users] [squid-announce] Squid 5.0.4 beta is available
</A></li>
        <LI>Next message (by thread): <A HREF="022569.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:9 Denial of Service processing Cache Digest Response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22568">[ date ]</a>
              <a href="thread.html#22568">[ thread ]</a>
              <a href="subject.html#22568">[ subject ]</a>
              <a href="author.html#22568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2020:8
__________________________________________________________________

Advisory ID:       | SQUID-2020:8
Date:              | August 23, 2020
Summary:           | HTTP(S) Request Splitting.
Affected versions: | Squid 2.7 -&gt; 2.7.STABLE9
                   | Squid 3.x -&gt; 3.5.28
                   | Squid 4.x -&gt; 4.12
                   | Squid 5.x -&gt; 5.0.3
Fixed in version:  | Squid 4.13, 5.0.4
__________________________________________________________________

  &lt;<A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15811">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15811</A>&gt;
__________________________________________________________________

Problem Description:

 Due to incorrect data validation Squid is vulnerable to HTTP
 Request Splitting attacks against HTTP and HTTPS traffic. This
 leads to cache poisoning.

__________________________________________________________________

Severity:

 This problem is serious because it allows any client, including
 browser scripts, to bypass local security and poison the browser
 cache and any downstream caches with content from an arbitrary
 source.

CVSS Score of 9.3
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N/E:F/RL:O/RC:C/CR:H/IR:H/AR:X/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:H/MI:H/MA:N&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N/E:F/RL:O/RC:C/CR:H/IR:H/AR:X/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:H/MI:H/MA:N&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.13 and 5.0.4.

 In addition, patches addressing this problem for the stable
 releases can be found in our patch archives:

Squid 4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v4/changesets/SQUID-2020_8.patch">http://www.squid-cache.org/Versions/v4/changesets/SQUID-2020_8.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 All Squid configured with &quot;relaxed_header_parser off&quot; are not vulnerable.

 All Squid-3.x up to and including 3.5.28 with
 relaxed_header_parser configured to &quot;on&quot; or &quot;warn&quot; are
 vulnerable.

 All Squid-3.x up to and including 3.5.28 without
 relaxed_header_parser configured are vulnerable.

 All Squid-4.x up to and including 4.12 with relaxed_header_parser
 configured to &quot;on&quot; or &quot;warn&quot; are vulnerable.

 All Squid-4.x up to and including 4.12 without
 relaxed_header_parser configured are vulnerable.

 All Squid-5.x up to and including 5.0.3 with
 relaxed_header_parser configured to &quot;on&quot; or &quot;warn&quot; are
 vulnerable.

 All Squid-5.x up to and including 5.0.3 without
 relaxed_header_parser configured are vulnerable.

__________________________________________________________________

Workaround:

 Disable the relaxed HTTP parser in squid.conf:

    relaxed_header_parser off

 Note, traffic which does not correctly obey HTTP specifications
 will be rejected instead of converted to standards compliance.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is your
 primary support point. For subscription details see
 &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

 For reporting of non-security bugs in the latest STABLE release
 the squid bugzilla database should be used
 &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

 For reporting of security sensitive bugs send an email to the
 &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
 list (though anyone can post) and security related bug reports
 are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 This vulnerability was discovered by Regis Leroy (regilero
 from Makina Corpus).

 Fixed by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

 2019-07-24 11:52:51 UTC Initial Report
 2020-01-09 22:07:44 UTC Additional vectors discovered
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022567.html">[squid-users] [squid-announce] Squid 5.0.4 beta is available
</A></li>
	<LI>Next message (by thread): <A HREF="022569.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:9 Denial of Service processing Cache Digest Response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22568">[ date ]</a>
              <a href="thread.html#22568">[ thread ]</a>
              <a href="subject.html#22568">[ subject ]</a>
              <a href="author.html#22568">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
