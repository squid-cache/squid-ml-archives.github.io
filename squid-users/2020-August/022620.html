<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Compile with custom OpenSSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Compile%20with%20custom%20OpenSSL&In-Reply-To=%3CDBBPR08MB4380706F4AD67E46AFFF7914F0550%40DBBPR08MB4380.eurprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022624.html">
   <LINK REL="Next"  HREF="022621.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Compile with custom OpenSSL</H1>
    <B>Dave Lewthwaite</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Compile%20with%20custom%20OpenSSL&In-Reply-To=%3CDBBPR08MB4380706F4AD67E46AFFF7914F0550%40DBBPR08MB4380.eurprd08.prod.outlook.com%3E"
       TITLE="[squid-users] Squid Compile with custom OpenSSL">Dave.Lewthwaite at realitymine.com
       </A><BR>
    <I>Thu Aug 27 10:41:38 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022624.html">[squid-users] IPVS/LVS load balancing Squid servers, anyone did it?
</A></li>
        <LI>Next message (by thread): <A HREF="022621.html">[squid-users] Squid Compile with custom OpenSSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22620">[ date ]</a>
              <a href="thread.html#22620">[ thread ]</a>
              <a href="subject.html#22620">[ subject ]</a>
              <a href="author.html#22620">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am having some trouble compiling squid using a custom build of openssl &#8211; it seems it is unable to find the libraries during run-time.

OpenSSL 1.1.1g is compiled and installed (setting prefix and openssldir) to /home/centos/openssl &#8211; the libraries are present there as are all the headers.

Squid is built using &#8211;with-openssl=/home/centos/openssl &#8211; it builds correctly, references the correct includes, libraries etc. However when the resulting binary is run, it is unable to find the OpenSSL libs &#8211;

squid: error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory

ldd /sbin/squid shows that it is unable to find the libs &#8211;

                libssl.so.1.1 =&gt; not found
                libcrypto.so.1.1 =&gt; not found

If I install the 1.1.1g libs into  /lib64 then squid will run &#8211; have I made an assumption on my part that this isn&#8217;t required? I was under the impression that squid would run with an entirely standalone build of OpenSSL.

Any advice would be appreciated &#8211; it certainly feels as though I&#8217;m missing something simple, but I can&#8217;t figure out what it is.

Versions
CentOS 7 (standard build chain)
Squid 4.13
OpenSSL 1.1.1g

Configure commands &#8211;

Squid -

./configure \
     --prefix=/usr \
     --with-logdir=/var/log/squid \
     --enable-useragent-log \
     --with-filedescriptors=65535 \
     --enable-ssl \
     --enable-http-violations \
     --sysconfdir=/etc/squid \
     --with-default-user=&quot;squid&quot; \
     --localstatedir=/var \
     --with-logdir='/var/log/squid' \
     --with-pidfile='/var/run/squid.pid' \
     --enable-stacktraces \
     --with-openssl='/home/centos/openssl' \
     --enable-snmp \
     --disable-arch-native

Openssl &#8211;

./config --prefix=/home/centos/openssl --openssldir=/home/centos/openssl


Thanks






This email and any attachments to it may contain confidential information and are intended solely for the addressee.



If you are not the intended recipient of this email or if you believe you have received this email in error, please contact the sender and remove it from your system.Do not use, copy or disclose the information contained in this email or in any attachment.

RealityMine Limited may monitor email traffic data including the content of email for the purposes of security.

RealityMine Limited is a company registered in England and Wales. Registered number: 07920936 Registered office: Warren Bruce Court, Warren Bruce Road, Trafford Park, Manchester M17 1LB
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200827/b993210b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200827/b993210b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022624.html">[squid-users] IPVS/LVS load balancing Squid servers, anyone did it?
</A></li>
	<LI>Next message (by thread): <A HREF="022621.html">[squid-users] Squid Compile with custom OpenSSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22620">[ date ]</a>
              <a href="thread.html#22620">[ thread ]</a>
              <a href="subject.html#22620">[ subject ]</a>
              <a href="author.html#22620">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
