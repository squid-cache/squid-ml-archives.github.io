<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid with more than 128 ports?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20more%20than%20128%20ports%3F&In-Reply-To=%3C707FCD08-4459-4131-85C6-57CB92886A19%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022998.html">
   <LINK REL="Next"  HREF="023012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid with more than 128 ports?</H1>
    <B>roee klinger</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20with%20more%20than%20128%20ports%3F&In-Reply-To=%3C707FCD08-4459-4131-85C6-57CB92886A19%40gmail.com%3E"
       TITLE="[squid-users] Squid with more than 128 ports?">roeeklinger60 at gmail.com
       </A><BR>
    <I>Fri Dec 11 11:22:52 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022998.html">[squid-users] Squid with more than 128 ports?
</A></li>
        <LI>Next message (by thread): <A HREF="023012.html">[squid-users] Squid with more than 128 ports?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23002">[ date ]</a>
              <a href="thread.html#23002">[ thread ]</a>
              <a href="subject.html#23002">[ subject ]</a>
              <a href="author.html#23002">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Eliezer,

Thanks, but actually what I want to achieve is not dynamic load balancing, I want each user to always go to a predefined proxy.

For a failover solution, I will have an outside program checking for failed proxies, and then I will remove them from the list and send the user to a different proxy while I handle the failed ones.

Is Haproxy good for that it is Squid in the way I proposed OK?

Thanks

&gt;<i> 
</I>&gt;<i> On Dec 10, 2020, at 23:14, Eliezer Croitor &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &#65279;
</I>&gt;<i> You should use Haproxy in a Fail-over setup.
</I>&gt;<i> Squid is great but it&#8217;s possible that Haproxy does this much better theses days then Squid.
</I>&gt;<i> You can leave the authentication on the Squid servers and use the Haproxy as TCP Load balancer.
</I>&gt;<i> If you need the clients Original IP address you can use the PROXY protocol to send these details between the haproxy and squid.
</I>&gt;<i>  
</I>&gt;<i> Eliezer
</I>&gt;<i>  
</I>&gt;<i> ----
</I>&gt;<i> Eliezer Croitoru
</I>&gt;<i> Tech Support
</I>&gt;<i> Mobile: +972-5-28704261
</I>&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
</I>&gt;<i>  
</I>&gt;<i> From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of roee klinger
</I>&gt;<i> Sent: Thursday, December 10, 2020 8:39 PM
</I>&gt;<i> To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> Subject: Re: [squid-users] Squid with more than 128 ports?
</I>&gt;<i>  
</I>&gt;<i> Hey Anthony,
</I>&gt;<i>  
</I>&gt;<i> Giving this a second thought, I believe I didn't explain myself correctly.
</I>&gt;<i>  
</I>&gt;<i> I have 5 Squid servers, each listening on 80 ports, I would like to add another
</I>&gt;<i> Squid server in the middle of the client and these servers to authenticate users
</I>&gt;<i> before sending them to their ports. I already have ACL controls and auth control tools
</I>&gt;<i> which I wrote and are working fine.
</I>&gt;<i>  
</I>&gt;<i> My question is regarding how to configure this, I have found this configuration online 
</I>&gt;<i> but I am not sure how it will work performance-wise with 500+ proxies (could be 1000s in
</I>&gt;<i> the future):
</I>&gt;<i>  
</I>&gt;<i> http_port 3128 name=port_3128
</I>&gt;<i> http_port 3127 name=port_3127
</I>&gt;<i> nonhierarchical_direct off
</I>&gt;<i> acl port_3128_acl myportname port_3128
</I>&gt;<i> acl port_3127_acl myportname port_3127
</I>&gt;<i> always_direct deny port_3128_acl
</I>&gt;<i> always_direct deny port_3127_acl
</I>&gt;<i> never_direct allow port_3128_acl
</I>&gt;<i> never_direct allow port_3127_acl
</I>&gt;<i> # 3128
</I>&gt;<i> cache_peer proxy1 parent 3128 0 proxy-only default name=proxy3128
</I>&gt;<i> cache_peer_access proxy3128 allow port_3128_acl
</I>&gt;<i> cache_peer_access proxy3128 deny all
</I>&gt;<i> # 3127
</I>&gt;<i> cache_peer proxy2 parent 3128 0 proxy-only default name=proxy3127
</I>&gt;<i> cache_peer_access proxy3127 allow port_3127_acl
</I>&gt;<i> cache_peer_access proxy3127 deny all
</I>&gt;<i>  
</I>&gt;<i> Combine these 2000+ lines in squid.conf with 2 external ACLs and a custom authenticator,
</I>&gt;<i> can this cause a hit on performance or should it be no problem for squid to handle?
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i> On Thu, Dec 10, 2020 at 2:29 PM Antony Stone &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Antony.Stone at squid.open.source.it</A>&gt; wrote:
</I>&gt;<i> On Thursday 10 December 2020 at 13:02:19, roee klinger wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; We have a few Squid proxy servers with a total of around 400 ports
</I>&gt;<i> 
</I>&gt;<i> What do you mean by that?  What are you using 400 ports for?
</I>&gt;<i> 
</I>&gt;<i> &gt; We have decided that we want to add a cloud instance in the middle of the
</I>&gt;<i> &gt; connections, that will authenticate users and only then send them to the
</I>&gt;<i> &gt; squid instance.
</I>&gt;<i> 
</I>&gt;<i> What authentication method / protocol do you want to use?
</I>&gt;<i> 
</I>&gt;<i> &gt; Is it a smart idea to use Squid for this use case or just use a different
</I>&gt;<i> &gt; proxy software that doesn't have this limitation?
</I>&gt;<i> 
</I>&gt;<i> I think the best starting point is to ask what sort of authentication you want 
</I>&gt;<i> to perform (ie: what is the authoritative system which holds the information 
</I>&gt;<i> about who can authenticate and who cannot), then you can decide on the best 
</I>&gt;<i> software to use to do that in front of Squid.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Antony.
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Under UK law, no VAT is charged on biscuits and cakes - they are &quot;zero rated&quot;.  
</I>&gt;<i> Chocolate covered biscuits, however, are classed as &quot;luxury items&quot; and are 
</I>&gt;<i> subject to VAT.  McVitie's classed its Jaffa Cakes as cakes, but in 1991 this 
</I>&gt;<i> was challenged by Her Majesty's Customs and Excise in court.
</I>&gt;<i> 
</I>&gt;<i> The question which had to be answered was what criteria should be used to 
</I>&gt;<i> class something as a cake or a biscuit.  McVitie's defended the classification 
</I>&gt;<i> of Jaffa Cakes as a cake by arguing that cakes go hard when stale, whereas 
</I>&gt;<i> biscuits go soft.  It was demonstrated that Jaffa Cakes become hard when stale 
</I>&gt;<i> and McVitie's won the case.
</I>&gt;<i> 
</I>&gt;<i>                                                    Please reply to the list;
</I>&gt;<i>                                                          please *don't* CC me.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20201211/ef00e00a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20201211/ef00e00a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022998.html">[squid-users] Squid with more than 128 ports?
</A></li>
	<LI>Next message (by thread): <A HREF="023012.html">[squid-users] Squid with more than 128 ports?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23002">[ date ]</a>
              <a href="thread.html#23002">[ thread ]</a>
              <a href="subject.html#23002">[ subject ]</a>
              <a href="author.html#23002">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
