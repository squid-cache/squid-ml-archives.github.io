<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How do I rotate access.log?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20do%20I%20rotate%20access.log%3F&In-Reply-To=%3C32d4ef6f-583a-40b1-80a0-148f945d0788%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023075.html">
   <LINK REL="Next"  HREF="023094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How do I rotate access.log?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20do%20I%20rotate%20access.log%3F&In-Reply-To=%3C32d4ef6f-583a-40b1-80a0-148f945d0788%40measurement-factory.com%3E"
       TITLE="[squid-users] How do I rotate access.log?">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Dec 29 18:37:20 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023075.html">[squid-users] How do I rotate access.log?
</A></li>
        <LI>Next message (by thread): <A HREF="023094.html">[squid-users] How do I rotate access.log?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23076">[ date ]</a>
              <a href="thread.html#23076">[ thread ]</a>
              <a href="subject.html#23076">[ subject ]</a>
              <a href="author.html#23076">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/29/20 12:33 PM, roee klinger wrote:

&gt;<i> I am using a Raspberry Pi and the latest version&#160;of Squid which I
</I>&gt;<i> installed from apt.
</I>&gt;<i> 
</I>&gt;<i> In my cache.log, here are all my logging and rotation-related messages:
</I>&gt;<i> 
</I>&gt;<i> 2020/12/29 17:37:14 kid1| logfileRotate: daemon:/var/log/squid/access.log
</I>&gt;<i> 2020/12/29 17:37:14 kid1| logfileRotate: daemon:/var/log/squid/access.log
</I>&gt;<i> 2020/12/29 17:37:14 kid1| Logfile: opening log daemon:/var/log/squid/access.log
</I>&gt;<i> 2020/12/29 17:37:14 kid1| Logfile Daemon: opening log /var/log/squid/access.log
</I>&gt;<i> 2020/12/29 17:37:14 kid1| Store logging disabled
</I>
What is your Squid version? &quot;squid --version&quot; may answer that question.

The &quot;opening log&quot; lines in your cache.log look strange. I do not see
them in my tests, but my version of Squid is probably different from
yours. If you shut down Squid completely, then remove all cache.log
files, then start Squid, and then rotate once, what logging and rotation
messages do you see in all the resulting cache.log files (including the
rotated ones)? Do not shut down or restart Squid until you collect all
those lines. Include all lines that mention &quot;log&quot; or &quot;rotate&quot;.

Do you see transactions getting logged to access.log?

Is the logging daemon running? &quot;ps aux | grep 'logfile[-]daemon'&quot; or a
similar command may answer that question.

How do you know that your access.log was _not_ rotated?

Alex.



&gt;<i> On Tue, Dec 29, 2020 at 6:40 PM Alex Rousskov wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 12/29/20 10:36 AM, roee klinger wrote:
</I>&gt;<i> 
</I>&gt;<i>     &gt;&#160; &#160; &#160;logfile_rotate 10
</I>&gt;<i>     &gt;&#160; &#160; &#160;access_log daemon:/var/log/squid/access.log logformat=xxxx
</I>&gt;<i>     rotate=10
</I>&gt;<i> 
</I>&gt;<i>     &gt; running &quot;squid -k rotate&quot; still does nothing for the access.log file.
</I>&gt;<i> 
</I>&gt;<i>     Please note that, according to Squid documentation, your Squid is
</I>&gt;<i>     slightly misconfigured:
</I>&gt;<i> 
</I>&gt;<i>     &gt;&#160; &#160; &#160; &#160;rotate=N&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Specifies the number of log file
</I>&gt;<i>     rotations to
</I>&gt;<i>     &gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;make when you run 'squid -k rotate'.
</I>&gt;<i>     [...]
</I>&gt;<i>     &gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Only supported by the stdio module.
</I>&gt;<i> 
</I>&gt;<i>     You are not using an &quot;stdio&quot; module. You are using a &quot;daemon&quot; module.
</I>&gt;<i> 
</I>&gt;<i>     This minor misconfiguraiton, if any, does not explain the lack of
</I>&gt;<i>     rotations. The deamon module should still rotate based on your global
</I>&gt;<i>     logfile_rotate directive setting.
</I>&gt;<i> 
</I>&gt;<i>     What is your Squid version? What logging and rotation-related messages
</I>&gt;<i>     do you see in your cache.log (check both the pre-rotation and
</I>&gt;<i>     post-rotation files)?
</I>&gt;<i> 
</I>&gt;<i>     Alex.
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023075.html">[squid-users] How do I rotate access.log?
</A></li>
	<LI>Next message (by thread): <A HREF="023094.html">[squid-users] How do I rotate access.log?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23076">[ date ]</a>
              <a href="thread.html#23076">[ thread ]</a>
              <a href="subject.html#23076">[ subject ]</a>
              <a href="author.html#23076">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
