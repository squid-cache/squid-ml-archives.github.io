<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2020:3 Buffer Overflow issue in ext_lm_group_acl helper.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A3%20Buffer%0A%20Overflow%20issue%20in%20ext_lm_group_acl%20helper.&In-Reply-To=%3Ca7614004-b548-3672-eed0-73a03149532a%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021704.html">
   <LINK REL="Next"  HREF="021701.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2020:3 Buffer Overflow issue in ext_lm_group_acl helper.</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A3%20Buffer%0A%20Overflow%20issue%20in%20ext_lm_group_acl%20helper.&In-Reply-To=%3Ca7614004-b548-3672-eed0-73a03149532a%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2020:3 Buffer Overflow issue in ext_lm_group_acl helper.">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Feb  3 11:54:40 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021704.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:2 Information	Disclosure	issue in FTP Gateway.
</A></li>
        <LI>Next message (by thread): <A HREF="021701.html">[squid-users] squid4 config file doub (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21703">[ date ]</a>
              <a href="thread.html#21703">[ thread ]</a>
              <a href="subject.html#21703">[ subject ]</a>
              <a href="author.html#21703">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

    Squid Proxy Cache Security Update Advisory SQUID-2020:3
__________________________________________________________________

Advisory ID:        SQUID-2020:3
Date:               February 02, 2020
Summary:            Buffer Overflow issue
                    in ext_lm_group_acl helper.
Affected versions:  Squid 2.x -&gt; 2.7.STABLE9
                    Squid 3.x -&gt; 3.5.28
                    Squid 4.x -&gt; 4.9
Fixed in version:   Squid 4.10
__________________________________________________________________

    <A HREF="http://www.squid-cache.org/Advisories/SQUID-2019_3.txt">http://www.squid-cache.org/Advisories/SQUID-2019_3.txt</A>
    <A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8517">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8517</A>
__________________________________________________________________

Problem Description:

 Due to incorrect buffer management ext_lm_group_acl is vulnerable
 to a denial of service attack when processing NTLM Authentication
 credentials.

__________________________________________________________________

Severity:

 This problem is limited to installations using the
 ext_lm_group_acl binary.

 Due to incorrect input validation the NTLM authentication
 credentials parser in ext_lm_group_acl may write to memory
 outside the credentials buffer.

 On systems with memory access protections this can result in
 the the helper process being terminated unexpectedly. Resulting
 in Squid process also terminating and a denial of service for
 all clients using the proxy.

__________________________________________________________________

Updated Packages:

 This bug is fixed by ext_lm_group_acl from Squid version 4.10.

 In addition, patches addressing this problem for the stable
 releases can be found in our patch archives:

Squid 3.5:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-c62d2b43ad4962ea44aa0c5edb4cc99cb83a413d.patch">http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-c62d2b43ad4962ea44aa0c5edb4cc99cb83a413d.patch</A>&gt;

Squid 4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v4/changesets/squid-4-6982f1187a26557e582172965e266f544ea562a5.patch">http://www.squid-cache.org/Versions/v4/changesets/squid-4-6982f1187a26557e582172965e266f544ea562a5.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

The helper was shipped as mswin_check_lm_group with Squid-3.1 and
older. Also as a third-party helper prior to Squid-2.6.

 All Squid using the mswin_check_lm_group helper for group
 based authorization are vulnerable.


 All Squid not using the ext_lm_group_acl helper for group
 based authorization are not vulnerable.

 All Squid-3.x up to and including 3.5.28 being used for NTLM
 Authentication with ext_lm_group_acl helper are vulnerable.

 All Squid-4.x up to and including 4.9 being used for NTLM
 Authentication with ext_lm_group_acl helper are vulnerable.


To determine whether Squid-3.2 and later are configured to use
the affected helper use the commands:

 squid -k parse | grep ext_lm_group_acl

 squid -k parse | grep mswin_check_lm_group


To determine whether Squid-3.1 and older are configured to use
the affected helper use the commands:

 grep ext_lm_group_acl /etc/squid/squid.conf

 grep mswin_check_lm_group /etc/squid/squid.conf

__________________________________________________________________

Workarounds:

Either;

 Remove 'auth_param NTLM ...' configuration settings from
 squid.conf.

Or,

 Use ext_lm_group_acl binary built from Squid-4.10 or later
 versions.


__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If your install and build Squid from the original Squid sources
 then the <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> mailing list is your
 primary support point. For subscription details see
 &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

 For reporting of non-security bugs in the latest STABLE release
 the squid bugzilla database should be used
 &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

 For reporting of security sensitive bugs send an email to the
 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A> mailing list. It's a closed
 list (though anyone can post) and security related bug reports
 are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 This vulnerability was discovered and fixed by Aaron Costello
 &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">aaron.costello at ymail.com</A>&gt;.

__________________________________________________________________

Revision history:

 2019-11-11 10:25:02 UTC Initial Report
 2019-11-22 02:44:29 UTC Patches Released
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021704.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:2 Information	Disclosure	issue in FTP Gateway.
</A></li>
	<LI>Next message (by thread): <A HREF="021701.html">[squid-users] squid4 config file doub (Amos Jeffries)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21703">[ date ]</a>
              <a href="thread.html#21703">[ thread ]</a>
              <a href="subject.html#21703">[ subject ]</a>
              <a href="author.html#21703">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
