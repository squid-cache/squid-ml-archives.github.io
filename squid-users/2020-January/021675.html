<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid and netdata causes squid to drop SYN?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20and%20netdata%20causes%20squid%20to%20drop%20SYN%3F&In-Reply-To=%3C124e34d2-6c5d-6190-e6a0-21d5d2a69117%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021671.html">
   <LINK REL="Next"  HREF="021679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid and netdata causes squid to drop SYN?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20and%20netdata%20causes%20squid%20to%20drop%20SYN%3F&In-Reply-To=%3C124e34d2-6c5d-6190-e6a0-21d5d2a69117%40measurement-factory.com%3E"
       TITLE="[squid-users] squid and netdata causes squid to drop SYN?">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Jan 21 15:39:03 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021671.html">[squid-users] squid and netdata causes squid to drop SYN?
</A></li>
        <LI>Next message (by thread): <A HREF="021679.html">[squid-users] squid and netdata causes squid to drop SYN?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21675">[ date ]</a>
              <a href="thread.html#21675">[ thread ]</a>
              <a href="subject.html#21675">[ subject ]</a>
              <a href="author.html#21675">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/20/20 11:28 PM, Amish wrote:

&gt;<i> 2) Is calling squidclient so frequently a right thing to do by netdata?
</I>
The answer depends on what cache manager query (or queries) your netdata
is sending to Squid. Sending some queries every second is perfectly
fine, but there are other, &quot;heavy&quot; queries that should not be sent so
often and could, if sent with a high enough concurrency level,
effectively DoS a Squid instance. For example, queries that require
iterating all cached objects should not be sent to busy Squids.

If netdata does not document the queries it uses, you can probably use
Squid access.log to figure out what queries netdata is sending (and how
long they take).


N.B. If netdata is killing the previous query when starting a new
would-be-concurrent query, then there should be no DoS conditions -- a
single &quot;heavy&quot; query may slow Squid down a bit but should not stall the
whole Squid instance. Thus, if netdata ensures that the number of
concurrent cache manager queries is small, then there may be a Squid bug
related to terminating an aborted query. Otherwise, one could argue that
the lack of concurrency controls is a netdata bug.


As Matus UHLAR have said, SNMP is a viable alternative to cache manager
queries, but please keep in mind that the two interfaces provide access
to only partially overlapping measurement sets, and that Squid SNMP code
is neglected even more than Squid cache manager code. Pick your poison.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021671.html">[squid-users] squid and netdata causes squid to drop SYN?
</A></li>
	<LI>Next message (by thread): <A HREF="021679.html">[squid-users] squid and netdata causes squid to drop SYN?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21675">[ date ]</a>
              <a href="thread.html#21675">[ thread ]</a>
              <a href="subject.html#21675">[ subject ]</a>
              <a href="author.html#21675">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
