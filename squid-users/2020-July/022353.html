<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] rock issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20rock%20issue&In-Reply-To=%3CAM6PR09MB322116222A6AE6E87562B55E916C0%40AM6PR09MB3221.eurprd09.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022352.html">
   <LINK REL="Next"  HREF="022355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] rock issue</H1>
    <B>patrick mkhael</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20rock%20issue&In-Reply-To=%3CAM6PR09MB322116222A6AE6E87562B55E916C0%40AM6PR09MB3221.eurprd09.prod.outlook.com%3E"
       TITLE="[squid-users] rock issue">patrick.mkhael at hotmail.com
       </A><BR>
    <I>Wed Jul  1 20:45:18 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022352.html">[squid-users] rock issue
</A></li>
        <LI>Next message (by thread): <A HREF="022355.html">[squid-users] rock issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22353">[ date ]</a>
              <a href="thread.html#22353">[ thread ]</a>
              <a href="subject.html#22353">[ subject ]</a>
              <a href="author.html#22353">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
***Please note that you have 20 kids worth mapping (10 workers and 10
diskers), but you map only the first 10.&#8203;{since i did not get the point of the diskers ,as far as i understood  , it should be like  (simple example)
 &gt;workers 2
&gt;<i> cpu_affinity_map process_numbers=1,2,3,4 cores=1,2,3,4
</I>&gt;<i> cache_dir rock /mnt/sdb/1   2048 max-size=10000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/2   2048 max-size=10000 max-swap-rate=200 swap-timeout=300
</I>


***Why do you have 10 rock caches of various sizes?  [ to be honest , i saw in many websites that it should be like this from the smallest to the bigest with diff size, i tought it should serve from small size pool to high ]

*****How many independent disk spindles (or equivalent) do you have? [ i have one raid 5 ssd disks , used by the 10 rock cache dir]

***How did you select the swap rate limits and timeouts for cache_dirs? [I took it also from online forum , can i leave it empty for both]


****Do you see any ERRORs or WARNINGs in cache log? [NO error or warning found in cache]

thank u so much !

________________________________
From: Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
Sent: Wednesday, July 1, 2020 10:26 PM
To: patrick mkhael &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">patrick.mkhael at hotmail.com</A>&gt;; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
Subject: Re: [squid-users] rock issue

On 7/1/20 1:45 PM, patrick mkhael wrote:

&gt;<i> Kindly note that i have a lab, where the internet traffic is 100 Mb/s
</I>&gt;<i> of pure http targeted traffic, i m trying to achieve cache gain ratio of
</I>&gt;<i> 60% , i was able to do this using ufs cache dir  and single worker.
</I>&gt;<i> But i found that i need to work with rock cache dir since the real
</I>&gt;<i> traffic is 1000 Mb/s , so one procesor won't be able to
</I>&gt;<i> handle all the traffic , so i used the same config , i only switched
</I>&gt;<i> from ufs to rock , the gain ratio dropped from 60% to 6%.
</I>
&gt;<i> workers 10
</I>&gt;<i> cpu_affinity_map process_numbers=1,2,3,4,5,6,7,8,9,10 cores=1,2,3,4,5,6,7,8,9,10
</I>
Please note that you have 20 kids worth mapping (10 workers and 10
diskers), but you map only the first 10. This is _not_ the reason for a
drop in hit ratio though.

&gt;<i> cache_dir rock /mnt/sdb/1   2048 max-size=10000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/2   2048 max-size=10000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/3   4960 max-size=50000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/4   4960 max-size=50000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/5  10000 max-size=100000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/6  10000 max-size=100000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/7  20000 max-size=500000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/8  20000 max-size=500000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/9  40000 max-size=1000000 max-swap-rate=200 swap-timeout=300
</I>&gt;<i> cache_dir rock /mnt/sdb/10 40000 max-size=1000000 max-swap-rate=200 swap-timeout=300
</I>
Why do you have 10 rock caches of various sizes? The number of caches
itself should not affect the hit ratio directly, but a large number of
caches may complicate analysis and, if you do not have enough
independent disk &quot;spindles&quot;, it may slow down disk I/O and lead to
timeouts and rate-based rejections (that do affect hit ratio).

How many independent disk spindles (or equivalent) do you have? All
other factors being equal (they rarely are), you want to dedicate one
independent disk spindle to one rock cache_dir.

How did you select the swap rate limits and timeouts for cache_dirs?

Do you see any ERRORs or WARNINGs in cache log?


Thank you,

Alex.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200701/a216f0bc/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200701/a216f0bc/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022352.html">[squid-users] rock issue
</A></li>
	<LI>Next message (by thread): <A HREF="022355.html">[squid-users] rock issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22353">[ date ]</a>
              <a href="thread.html#22353">[ thread ]</a>
              <a href="subject.html#22353">[ subject ]</a>
              <a href="author.html#22353">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
