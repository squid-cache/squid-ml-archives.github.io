<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] rock issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20rock%20issue&In-Reply-To=%3C945439f5-b10c-63ac-795b-e865128abfab%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022357.html">
   <LINK REL="Next"  HREF="022361.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] rock issue</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20rock%20issue&In-Reply-To=%3C945439f5-b10c-63ac-795b-e865128abfab%40measurement-factory.com%3E"
       TITLE="[squid-users] rock issue">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Jul  2 13:24:03 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022357.html">[squid-users] rock issue
</A></li>
        <LI>Next message (by thread): <A HREF="022361.html">[squid-users] rock issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22359">[ date ]</a>
              <a href="thread.html#22359">[ thread ]</a>
              <a href="subject.html#22359">[ subject ]</a>
              <a href="author.html#22359">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/1/20 4:45 PM, patrick mkhael wrote:

&gt;<i> ***Please note that you have 20 kids worth mapping (10 workers and 10
</I>&gt;<i> diskers), but you map only the first 10.&#8203;{since i did not get the point
</I>&gt;<i> of the diskers ,as far as i understood&#160; , it should be like&#160; (simple
</I>&gt;<i> example)
</I>
&gt;&gt;<i> workers 2
</I>&gt;&gt;<i> cpu_affinity_map process_numbers=1,2,3,4 cores=1,2,3,4
</I>&gt;&gt;<i> cache_dir rock ...
</I>&gt;&gt;<i> cache_dir rock ...
</I>
The above looks OK. Each worker is a kid process. Each rock cache_dir is
a kid process (we call them diskers).  If you have physical CPU cores to
spare, give each kid process its own physical core. Otherwise, give each
worker process its own physical core (if you can). Diskers can share
physical cores with less harm because they usually do not consume much
CPU cycles. Squid wiki has more detailed information about that:
<A HREF="https://wiki.squid-cache.org/Features/SmpScale#How_to_configure_SMP_Squid_for_top_performance.3F">https://wiki.squid-cache.org/Features/SmpScale#How_to_configure_SMP_Squid_for_top_performance.3F</A>


&gt;<i> ***Why do you have 10 rock caches of various sizes?&#160;[ to be honest , i
</I>&gt;<i> saw in many websites that it should be like this from the smallest to
</I>&gt;<i> the bigest with diff size, i tought it should serve from small size pool
</I>&gt;<i> to high ]
</I>
IMHO, you should stop reading those web pages :-). There is no general
need to segregate objects by sizes, especially when you are using the
same slot size for all cache_dirs. Such segregation may be necessary in
some special cases, but we have not yet established that your case is
special.


&gt;<i> *****How many independent disk spindles (or equivalent) do you have? [ i
</I>&gt;<i> have one raid 5 ssd disks , used by the 10 rock cache dir]
</I>
Do not use RAID. If possible, use one rock cache_dir per SSD disk. The
only reason this may not be possible, AFAICT, is if you want to cache
more (per SSD disk) than a single Squid cache_dir can hold, but I would
not worry about overcoming that limit at the beginning. If you want to
know more about the limit, look for &quot;33554431&quot; in
<A HREF="http://www.squid-cache.org/mail-archive/squid-users/201312/0034.html">http://www.squid-cache.org/mail-archive/squid-users/201312/0034.html</A>


&gt;<i> ***How did you select the swap rate limits and timeouts for
</I>&gt;<i> cache_dirs?[I took it also from online forum , can i leave it empty for
</I>&gt;<i> both]
</I>
If you want a simple answer, then it is &quot;yes&quot;. Unfortunately, there is
no simple correct answer to that question. To understand what is going
on and how to tune things, I recommend studying the Performance Tuning
section of <A HREF="https://wiki.squid-cache.org/Features/RockStore">https://wiki.squid-cache.org/Features/RockStore</A>


&gt;<i> ****Do you see any ERRORs or WARNINGs in cache log?[NO error or warning
</I>&gt;<i> found in cache]
</I>
Good. I assume you do see some regular messages in cache.log. Keep an
eye for ERRORs and WARNINGs as you change settings.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022357.html">[squid-users] rock issue
</A></li>
	<LI>Next message (by thread): <A HREF="022361.html">[squid-users] rock issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22359">[ date ]</a>
              <a href="thread.html#22359">[ thread ]</a>
              <a href="subject.html#22359">[ subject ]</a>
              <a href="author.html#22359">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
