<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Forcing squid to fail when the whitelist doesn't exist
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Forcing%20squid%20to%20fail%20when%20the%20whitelist%20doesn%27t%0A%20exist&In-Reply-To=%3C0bcacc01-0c3a-233e-ba30-dca0735daf51%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022382.html">
   <LINK REL="Next"  HREF="022384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Forcing squid to fail when the whitelist doesn't exist</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Forcing%20squid%20to%20fail%20when%20the%20whitelist%20doesn%27t%0A%20exist&In-Reply-To=%3C0bcacc01-0c3a-233e-ba30-dca0735daf51%40measurement-factory.com%3E"
       TITLE="[squid-users] Forcing squid to fail when the whitelist doesn't exist">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Jul  7 17:52:49 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022382.html">[squid-users] Forcing squid to fail when the whitelist doesn't exist
</A></li>
        <LI>Next message (by thread): <A HREF="022384.html">[squid-users] Forcing squid to fail when the whitelist doesn't	exist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22383">[ date ]</a>
              <a href="thread.html#22383">[ thread ]</a>
              <a href="subject.html#22383">[ subject ]</a>
              <a href="author.html#22383">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/7/20 10:52 AM, Matthew Macdonald-Wallace wrote:

&gt;<i> We're re-configuring a squid proxy solution for a client and as part of
</I>&gt;<i> it we made the assumption that squid would fail if we asked it to read a
</I>&gt;<i> whitelist that wasn't present.
</I>&gt;<i> 
</I>&gt;<i> We've now discovered that Squid fails to read the file, throws an error
</I>&gt;<i> in the log ( Error: Cannot open file /etc/squid/whitelist.txt for
</I>&gt;<i> reading ), and then starts up anyway
</I>
Yes, this kind of error ignorance is an old known Squid problem. Some
developers have thought that it is better to start Squid &quot;if at all
possible&quot; than to fail on (in their view &quot;minor&quot;) error. New features
are usually more &quot;conservative&quot;, but even now that &quot;conservative&quot;
approach does not always win.

IMO, quality pull requests making missing files a fatal configuration
error should be welcomed. They may not be backported to stable versions,
of course. The solution would probably revolve around throwing an
exception in ConfigParser::strtokFile(). Making missing file treatment
configurable, especially on a per-file basis should be welcomed as well,
probably by extending the new parameters syntax mentioned below.

Meanwhile, try using the newer parameters() syntax instead of abusing
double quotes. It should work the way you expect. Here is the
corresponding quote from squid.conf.documented:

&gt;<i> Squid supports reading configuration option parameters from external
</I>&gt;<i> files using the syntax:
</I>&gt;<i>     parameters(&quot;/path/filename&quot;)
</I>&gt;<i> For example:
</I>&gt;<i>     acl whitelist dstdomain parameters(&quot;/etc/squid/whitelist.txt&quot;)
</I>

HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022382.html">[squid-users] Forcing squid to fail when the whitelist doesn't exist
</A></li>
	<LI>Next message (by thread): <A HREF="022384.html">[squid-users] Forcing squid to fail when the whitelist doesn't	exist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22383">[ date ]</a>
              <a href="thread.html#22383">[ thread ]</a>
              <a href="subject.html#22383">[ subject ]</a>
              <a href="author.html#22383">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
