<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Explicitly use direct client IP in acl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explicitly%20use%20direct%20client%20IP%20in%20acl&In-Reply-To=%3C07970bac-e012-df12-ec44-ec95dd0f06b7%40nwra.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022403.html">
   <LINK REL="Next"  HREF="022397.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Explicitly use direct client IP in acl</H1>
    <B>Orion Poplawski</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explicitly%20use%20direct%20client%20IP%20in%20acl&In-Reply-To=%3C07970bac-e012-df12-ec44-ec95dd0f06b7%40nwra.com%3E"
       TITLE="[squid-users] Explicitly use direct client IP in acl">orion at nwra.com
       </A><BR>
    <I>Thu Jul  9 21:54:24 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022403.html">[squid-users] Double method of authentication, possible?
</A></li>
        <LI>Next message (by thread): <A HREF="022397.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22395">[ date ]</a>
              <a href="thread.html#22395">[ thread ]</a>
              <a href="subject.html#22395">[ subject ]</a>
              <a href="author.html#22395">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello -

   We're using a setup like this:

client -&gt; e2guardian -&gt; squid -&gt; internet

e2guardian is providing filtering and SSL inspection.  Currently we only 
allow access to e2guardian from our internal network.  Currently we 
enforce access to squid come from localhost, except for some specific 
sites which do not work with SSL inspection.

Then we allow:

client -&gt; squid -&gt; internet

this is based on the (non-forwarded) client IP.

We would like to open up access to e2g from the internet but require 
authentication in that case.  This would require the use of forwarded 
IPs so the squid could distinguish between them (e2g does not do auth 
directly - it lets squid handle that).  But then this breaks our config 
above because we no longer can distinguish between connections from e2g 
and direct ones.

Is there any way in an acl to explicitly request the &quot;direct&quot; (i.e. 
non-indirect) IP address?  This would allow use to use one type for some 
acls and the other for other acls.  This doesn't seem possible from what 
I can see.

I'm guessing we'll need to implement a separate proxy configuration for 
external access, but I'd like to avoid it if possible.

Thanks,
   Orion

-- 
Orion Poplawski
Manager of NWRA Technical Systems          720-772-5637
NWRA, Boulder/CoRA Office             FAX: 303-415-9702
3380 Mitchell Lane                       <A HREF="https://lists.squid-cache.org/listinfo/squid-users">orion at nwra.com</A>
Boulder, CO 80301                 <A HREF="https://www.nwra.com/">https://www.nwra.com/</A>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 3799 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200709/d3ac1dd3/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200709/d3ac1dd3/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022403.html">[squid-users] Double method of authentication, possible?
</A></li>
	<LI>Next message (by thread): <A HREF="022397.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22395">[ date ]</a>
              <a href="thread.html#22395">[ thread ]</a>
              <a href="subject.html#22395">[ subject ]</a>
              <a href="author.html#22395">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
