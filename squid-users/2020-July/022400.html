<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.11%20Howto%20create%20SSL%20Bump%20certificates%0A%20with%20only%203-12%20months%20date%20of%20expiry&In-Reply-To=%3C1d89a878-4c18-32bb-ab17-b8d83c8554ce%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022406.html">
   <LINK REL="Next"  HREF="022404.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.11%20Howto%20create%20SSL%20Bump%20certificates%0A%20with%20only%203-12%20months%20date%20of%20expiry&In-Reply-To=%3C1d89a878-4c18-32bb-ab17-b8d83c8554ce%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jul 10 05:03:41 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022406.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
        <LI>Next message (by thread): <A HREF="022404.html">[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22400">[ date ]</a>
              <a href="thread.html#22400">[ thread ]</a>
              <a href="subject.html#22400">[ subject ]</a>
              <a href="author.html#22400">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/06/20 3:13 am, info wrote:
&gt;<i> 
</I>&gt;<i> Hi Squid Community,
</I>&gt;<i> 
</I>&gt;<i> how can I configure Squid to create SSL Bump Certifications with only
</I>&gt;<i> 3-12 months date of expiry?
</I>&gt;<i> 
</I>
As you know Squid uses a helper to generate the certificates. You can
write a helper of your own to generate certificates with any
customizations you like.


&gt;<i> Currently, Squid SSL bumped Certifications are valid 20 years in my
</I>&gt;<i> case, way too long, as Apple &amp; Google &amp; Mozilla will trust only &lt;1 Year
</I>&gt;<i> SSL certifications in the future.
</I>&gt;<i> 
</I>
The helper bundled with Squid is supposed to be generating certificates
that mimic the same values received from the origin server.

... except that your config below shows that you are requiring
certificates to be generated without any origin Server information.
Which IIRC means that the CA certificate you configured is used as the
information source for dates etc.


&gt;<i> Thanks for any help!
</I>&gt;<i> Schroeffu
</I>&gt;<i> 
</I>&gt;<i> my conf:
</I>&gt;<i> 
</I>&gt;<i> http_port {{ inventory_hostname }}:{{ squid_port }} ssl-bump
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
</I>&gt;<i> cert=/etc/squid/certs/(***).pem key=/etc/squid/certs/(***).pem
</I>&gt;<i> sslcrtd_program /usr/lib/squid/security_file_certgen -s /var/lib/ssl_db
</I>&gt;<i> -M 4MB
</I>&gt;<i> always_direct allow all
</I>
always_direct is *not* required for SSL-Bump. It was only ever needed
for a 2-week period many years ago for a bug workaround. Please remove
unless you explicitly have other reasons to use it.

&gt;<i> ssl_bump bump !domains_dont_sslbump
</I>
There are three solutions you might use. In order of best to worst they are:

1) Fix the ssl_bump behaviour:

 acl step1 at_step SslBump1
 ssl_bump peek step1
 ssl_bump splice domains_dont_sslbump
 ssl_bump stare all
 ssl_bump bump all


2) Fix the CA certificate you are using

Check the dates configured there give that cert a sort validity time. I
expect you have one saying 20-years right now.

You may want to do this even if you do option #1 above.


3) write your own cert generator helper


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022406.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
	<LI>Next message (by thread): <A HREF="022404.html">[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22400">[ date ]</a>
              <a href="thread.html#22400">[ thread ]</a>
              <a href="subject.html#22400">[ subject ]</a>
              <a href="author.html#22400">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
