<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Explicitly use direct client IP in acl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explicitly%20use%20direct%20client%20IP%20in%20acl&In-Reply-To=%3C3bf58304-8265-2034-9979-2f13943f89d8%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022405.html">
   <LINK REL="Next"  HREF="022400.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Explicitly use direct client IP in acl</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Explicitly%20use%20direct%20client%20IP%20in%20acl&In-Reply-To=%3C3bf58304-8265-2034-9979-2f13943f89d8%40treenet.co.nz%3E"
       TITLE="[squid-users] Explicitly use direct client IP in acl">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jul 11 04:27:11 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022405.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
        <LI>Next message (by thread): <A HREF="022400.html">[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22406">[ date ]</a>
              <a href="thread.html#22406">[ thread ]</a>
              <a href="subject.html#22406">[ subject ]</a>
              <a href="author.html#22406">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/07/20 4:44 am, Orion Poplawski wrote:
&gt;<i> 
</I>&gt;<i> IIUIC - this mainly gives me:
</I>&gt;<i> 
</I>&gt;<i> http_access deny !localnet !authenticated_users
</I>&gt;<i> http_access allow CONNECT Allowed_SSL_Hosts
</I>&gt;<i> http_access allow !localnet Allowed_HTTP_Hosts
</I>&gt;<i> http_access deny all
</I>&gt;<i> 
</I>&gt;<i> But this will only allow connections to the sites listed in Allowed_SSL_Hosts
</I>&gt;<i> or Allowed_HTTP_Hosts (from remote) and not to anything else.  This is not
</I>&gt;<i> what I want.  I want to allow access to any site from a connection that is
</I>&gt;<i> forwarded from e2g.
</I>&gt;<i> 
</I>

Yes. The earlier stated policy was:

&gt;<i> We would like to open up access to e2g from the internet but require
</I>&gt;<i> authentication in that case.
</I>
I provided the rule adjustment to add that to your existing
restrictions. As you can see the LAN is represented by localnet ACL and
the WAN clients by !localnet.


To match traffic arriving from a specific client application (aka e2g)
you have a couple of options.

a) Simplest is to use a dedicated http_port for that application. The
myportname ACL can then match all that applications traffic.
 This is quick and easy but does not prevent other applications sending
traffic to the port. Additional firewall settings are needed to prevent
that.


b) The system QoS service marking packets coming out of e2g. The
clientside_mark / clientside_tos ACLs can match this marking.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022405.html">[squid-users] Explicitly use direct client IP in acl
</A></li>
	<LI>Next message (by thread): <A HREF="022400.html">[squid-users] Squid 4.11 Howto create SSL Bump certificates with only 3-12 months date of expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22406">[ date ]</a>
              <a href="thread.html#22406">[ thread ]</a>
              <a href="subject.html#22406">[ subject ]</a>
              <a href="author.html#22406">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
