<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Adaptation error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Adaptation%20error&In-Reply-To=%3CBYAPR01MB496825E847BDC3D40D77A229F7890%40BYAPR01MB4968.prod.exchangelabs.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022206.html">
   <LINK REL="Next"  HREF="022209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Adaptation error</H1>
    <B>senor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Adaptation%20error&In-Reply-To=%3CBYAPR01MB496825E847BDC3D40D77A229F7890%40BYAPR01MB4968.prod.exchangelabs.com%3E"
       TITLE="[squid-users] Adaptation error">frio_cervesa at hotmail.com
       </A><BR>
    <I>Thu Jun  4 20:15:01 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022206.html">[squid-users] squid-4.9 TCP_MISS_ABORTED and memory leak
</A></li>
        <LI>Next message (by thread): <A HREF="022209.html">[squid-users] Adaptation error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22207">[ date ]</a>
              <a href="thread.html#22207">[ thread ]</a>
              <a href="subject.html#22207">[ subject ]</a>
              <a href="author.html#22207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,

I occasionally get an assert and core dump on a worker here:
#3  0x0000000000580d84 in ClientHttpRequest::resetRequest (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x2af0808, newRequest=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">newRequest at entry</A>=0x2b51f00)
    at client_side_request.cc:1676
#4  0x000000000058ac9e in ClientHttpRequest::handleAdaptedHeader (this=0x2af0808, msg=&lt;optimized out&gt;) at client_side_request.cc:2005
#5  0x0000000000870a39 in JobDialer&lt;Adaptation::Initiator&gt;::dial (this=0x36b6dc0, call=...) at ../../src/base/AsyncJobCalls.h:174

It has occurred with 4.8 &amp; 4.11. I don't think the config is relevant for what I'm trying to accomplish but can provide if important.

As I understand it, the request returned from adaptation is compared with pre-adapted request and it is considered a fail if they match. Since there is no requirement that adaptation make a change, I assume it should not be in that code unless adaptation indicated there was a change. But I'm not on solid ground there. We use c-icap and have had no errors. 

I'm mainly trying to get an understanding of what is occurring here. The URI being handled at this point varies and doesn't seem to be relevant. This probably only occurs when a reconfigure is processed. 

Any guidance or hints are appreciated. Thanks
Senor


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022206.html">[squid-users] squid-4.9 TCP_MISS_ABORTED and memory leak
</A></li>
	<LI>Next message (by thread): <A HREF="022209.html">[squid-users] Adaptation error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22207">[ date ]</a>
              <a href="thread.html#22207">[ thread ]</a>
              <a href="subject.html#22207">[ subject ]</a>
              <a href="author.html#22207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
