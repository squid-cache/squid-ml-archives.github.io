<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Switch cache peer Parent server for every 30	minutes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Switch%20cache%20peer%20Parent%20server%20for%20every%2030%0A%09minutes&In-Reply-To=%3CCACbtF4NWvYDRk3pwUPVn8gevVdh7aeuZACcRYKA86jJ0r-HKZA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022224.html">
   <LINK REL="Next"  HREF="022227.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Switch cache peer Parent server for every 30	minutes</H1>
    <B>Prem Chand</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Switch%20cache%20peer%20Parent%20server%20for%20every%2030%0A%09minutes&In-Reply-To=%3CCACbtF4NWvYDRk3pwUPVn8gevVdh7aeuZACcRYKA86jJ0r-HKZA%40mail.gmail.com%3E"
       TITLE="[squid-users] Switch cache peer Parent server for every 30	minutes">premchand142 at gmail.com
       </A><BR>
    <I>Wed Jun 10 16:11:03 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022224.html">[squid-users] Switch cache peer Parent server for every 30 minutes
</A></li>
        <LI>Next message (by thread): <A HREF="022227.html">[squid-users] Switch cache peer Parent server for every 30	minutes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22226">[ date ]</a>
              <a href="thread.html#22226">[ thread ]</a>
              <a href="subject.html#22226">[ subject ]</a>
              <a href="author.html#22226">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alex,

Thanks for responding to my issue  . I didn't get how the math was done(why
it's multiplied by 2) to get 16 slots if possible could you please
elaborate with an example.

Regards
Premchand

On Wed, Jun 10, 2020 at 7:12 PM Alex Rousskov &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:

&gt;<i> On 6/10/20 6:09 AM, Prem Chand wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; My squid cache peer has 3 parent IP&#8217;s configured. I need to send HTTPS
</I>&gt;<i> &gt; requests to the first parent IP for 30 minutes and after to the 2nd
</I>&gt;<i> &gt; parent IP for 30 minutes and then to 3rd IP for 30 minutes and this
</I>&gt;<i> &gt; switching needs to happen continuously .Could you please let us know how
</I>&gt;<i> I
</I>&gt;<i> &gt; can achieve this?
</I>&gt;<i>
</I>&gt;<i> If you are OK with hard-coded usage time slots for each peer, then I
</I>&gt;<i> would use two[1] &quot;time&quot; ACLs and cache_peer_access rules. Look for
</I>&gt;<i> &quot;aclname time&quot; in squid.conf.documented. You will have to generate a
</I>&gt;<i> list of (24*2/3=16) staggered time slots for each of the two ACLs, but
</I>&gt;<i> it should work. This may be the simplest solution.
</I>&gt;<i>
</I>&gt;<i> [1] You need two ACLs for three peers because the third peer should get
</I>&gt;<i> the requests that the first two peers were not allowed to get.
</I>&gt;<i>
</I>&gt;<i> ----
</I>&gt;<i>
</I>&gt;<i> With a modern Squid, you could also implement this using a more flexible
</I>&gt;<i> (and more expensive, on several layers!) architecture with two ACLs:
</I>&gt;<i>
</I>&gt;<i> 1. An external ACL that returns the right cache peer name to use via a
</I>&gt;<i> keyword=value annotation API. This always-matching ACL should be
</I>&gt;<i> attached to http_access or a similar directive that supports slow ACLs.
</I>&gt;<i> Its goal is to annotate the request. You will need to write a
</I>&gt;<i> script/program that will compute the right annotations based on time or
</I>&gt;<i> some other factors. This is where the flexibility of this solution is
</I>&gt;<i> coming from.
</I>&gt;<i>
</I>&gt;<i> 2. A &quot;note&quot; ACL attached to cache_peer_access directives, allowing
</I>&gt;<i> access to peer X if the external ACL in item 1 returned
</I>&gt;<i> use_cache_peer_=X. The &quot;note&quot; ACL is a fast ACL and, hence, can be
</I>&gt;<i> reliably used with cache_peer_access.
</I>&gt;<i>
</I>&gt;<i> If you already have another external ACL, you may be able to piggyback
</I>&gt;<i> annotations in item 1 to whatever that ACL is already doing.
</I>&gt;<i>
</I>&gt;<i> For more information, search for &quot;keyword=value&quot; and &quot;acl aclname note&quot;
</I>&gt;<i> in your squid.conf.documented and see
</I>&gt;<i> <A HREF="https://wiki.squid-cache.org/Features/AddonHelpers#Access_Control_.28ACL.29">https://wiki.squid-cache.org/Features/AddonHelpers#Access_Control_.28ACL.29</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTH,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>

-- 
prem
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200610/d812a49f/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200610/d812a49f/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022224.html">[squid-users] Switch cache peer Parent server for every 30 minutes
</A></li>
	<LI>Next message (by thread): <A HREF="022227.html">[squid-users] Switch cache peer Parent server for every 30	minutes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22226">[ date ]</a>
              <a href="thread.html#22226">[ thread ]</a>
              <a href="subject.html#22226">[ subject ]</a>
              <a href="author.html#22226">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
