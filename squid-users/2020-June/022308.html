<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache Poisoning Issue in HTTP Request processing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A7%20Cache%0A%20Poisoning%20Issue%20in%20HTTP%20Request%20processing&In-Reply-To=%3C6fddb72c-8524-699f-455f-31ad31097585%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022349.html">
   <LINK REL="Next"  HREF="022316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache Poisoning Issue in HTTP Request processing</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2020%3A7%20Cache%0A%20Poisoning%20Issue%20in%20HTTP%20Request%20processing&In-Reply-To=%3C6fddb72c-8524-699f-455f-31ad31097585%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache Poisoning Issue in HTTP Request processing">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Jun 26 15:48:20 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022349.html">[squid-users] R: squid stores multiple copies of identical ETags
</A></li>
        <LI>Next message (by thread): <A HREF="022316.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache	Poisoning Issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22308">[ date ]</a>
              <a href="thread.html#22308">[ thread ]</a>
              <a href="subject.html#22308">[ subject ]</a>
              <a href="author.html#22308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2020:7
__________________________________________________________________

 Advisory ID:       | SQUID-2020:7
 Date:              | June 26, 2020
 Summary:           | Cache Poisoning Issue
                    | in HTTP Request processing.
 Affected versions: | Squid 2.x -&gt; 2.7.STABLE9
                    | Squid 3.x -&gt; 3.5.28
                    | Squid 4.x -&gt; 4.11
                    | Squid 5.x -&gt; 5.0.2
 Fixed in version:  | Squid 4.12 and 5.0.3
__________________________________________________________________

 &lt;<A HREF="https://github.com/squid-cache/squid/security/advisories/GHSA-qf3v-rc95-96j5">https://github.com/squid-cache/squid/security/advisories/GHSA-qf3v-rc95-96j5</A>&gt;
 &lt;<A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15049">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15049</A>&gt;
__________________________________________________________________

Problem Description:

 Due to incorrect input validation Squid is vulnerable to a
 Request Smuggling and Poisoning attack against the HTTP cache.

__________________________________________________________________

Severity:

 This problem allows a trusted client to perform request smuggling
 and poison the HTTP cache contents with crafted HTTP(S) request
 messages.

 This attack requires an upstream server to participate in the
 smuggling and generate the poison response sequence. Most popular
 server software are not vulnerable to participation in this
 attack.

CVSS Score of 9.3
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:H/MI:H/MA:H&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:L/MPR:L/MUI:N/MS:C/MC:H/MI:H/MA:H&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.12 and 5.0.3.

 In addition, patches addressing this problem for the stable
 releases can be found in our patch archives:

Squid 4:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v4/changesets/squid-4-ea12a34d338b962707d5078d6d1fc7c6eb119a22.patch">http://www.squid-cache.org/Versions/v4/changesets/squid-4-ea12a34d338b962707d5078d6d1fc7c6eb119a22.patch</A>&gt;

Squid 5:
 &lt;<A HREF="http://www.squid-cache.org/Versions/v5/changesets/squid-5-485c9a7bb1bba88754e07ad0094647ea57a6eb8d.patch">http://www.squid-cache.org/Versions/v5/changesets/squid-5-485c9a7bb1bba88754e07ad0094647ea57a6eb8d.patch</A>&gt;

 If you are using a prepackaged version of Squid then please refer
 to the package vendor for availability information on updated
 packages.

__________________________________________________________________

Determining if your version is vulnerable:

 All Squid-3.x up to and including 3.5.28 are vulnerable.

 All Squid-4.x up to and including 4.11 are vulnerable.

 Squid-5.0.1 and 5.0.2 are vulnerable.

__________________________________________________________________

Workaround:

 There is no workaround for this vulnerability.

__________________________________________________________________

Contact details for the Squid project:

 For installation / upgrade support on binary packaged versions
 of Squid: Your first point of contact should be your binary
 package vendor.

 If you install and build Squid from the original Squid sources
 then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is your
 primary support point. For subscription details see
 &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

 For reporting of non-security bugs in the latest STABLE release
 the squid bugzilla database should be used
 &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

 For reporting of security sensitive bugs send an email to the
 &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
 list (though anyone can post) and security related bug reports
 are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

 This vulnerability was discovered by Alex Rousskov of The
 Measurement Factory.

 Independent discovery and replication reported by Amit Klein of
 Safebreach.

 Fixed by Alex Rousskov of The Measurement Factory.

__________________________________________________________________

Revision history:


 2016-09-06 02:45:20 UTC Initial Report
 2020-05-11 12:41:17 UTC Replication Reported
 2020-05-13 14:05:00 UTC Patch Released
 2020-06-25 11:15:10 UTC CVE Allocated
______________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022349.html">[squid-users] R: squid stores multiple copies of identical ETags
</A></li>
	<LI>Next message (by thread): <A HREF="022316.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache	Poisoning Issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22308">[ date ]</a>
              <a href="thread.html#22308">[ thread ]</a>
              <a href="subject.html#22308">[ subject ]</a>
              <a href="author.html#22308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
