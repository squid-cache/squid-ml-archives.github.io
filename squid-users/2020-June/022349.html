<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] R: squid stores multiple copies of identical ETags
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20R%3A%20squid%20stores%20multiple%20copies%20of%20identical%20ETags&In-Reply-To=%3Ce7a7380a-332e-4a5f-b14e-2771b147c1a3%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022344.html">
   <LINK REL="Next"  HREF="022308.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] R: squid stores multiple copies of identical ETags</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20R%3A%20squid%20stores%20multiple%20copies%20of%20identical%20ETags&In-Reply-To=%3Ce7a7380a-332e-4a5f-b14e-2771b147c1a3%40measurement-factory.com%3E"
       TITLE="[squid-users] R: squid stores multiple copies of identical ETags">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Jun 30 14:16:20 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022344.html">[squid-users] R:  squid stores multiple copies of identical ETags
</A></li>
        <LI>Next message (by thread): <A HREF="022308.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache Poisoning Issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22349">[ date ]</a>
              <a href="thread.html#22349">[ thread ]</a>
              <a href="subject.html#22349">[ subject ]</a>
              <a href="author.html#22349">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/30/20 5:10 AM, Tabacchiera, Stefano wrote:

&gt;<i> So I&#8217;m assuming that only one object on disk (the last one retrieved) is
</I>&gt;<i> the object referenced as &#8220;active&#8221; by squid, all the rest being trashable.
</I>&gt;<i> 
</I>&gt;<i> Since the client is forcing a &#8220;no-cache&#8221; header, squid does what the
</I>&gt;<i> client is asking for, and every time it stores the object on disk.
</I>&gt;<i> 
</I>&gt;<i> I&#8217;m also assuming that IF another client asked the same object without
</I>&gt;<i> the &#8220;no-cache&#8221; header, squid would serve the latest cached object on disk.
</I>&gt;<i> 
</I>&gt;<i> If I&#8217;m right so far, squid never &#8220;overwrites&#8221; the old copy of an object
</I>&gt;<i> on disk. Instead, it stores a new one, marking it as &#8220;active&#8221;, 
</I>
Yes, the above matches my understanding (for some definition of &quot;last
one&quot;, &quot;overwrites&quot;, and &quot;active&quot;). The actual situation is a bit more
nuanced (e.g., Squid could be storing and using multiple copies of the
same resource concurrently, even though any new request will never see
more than one copy), but those low-level details may not matter to your
investigation.


&gt;<i> and let the deletion task to (a)ufs threads.
</I>
I cannot confirm or deny this part -- I do not know whether garbage
collection is delegated to aufs thread(s) -- but it sounds plausible.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022344.html">[squid-users] R:  squid stores multiple copies of identical ETags
</A></li>
	<LI>Next message (by thread): <A HREF="022308.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2020:7 Cache Poisoning Issue in HTTP Request processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22349">[ date ]</a>
              <a href="thread.html#22349">[ thread ]</a>
              <a href="subject.html#22349">[ subject ]</a>
              <a href="author.html#22349">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
