<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP Fast open and squid4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20Fast%20open%20and%20squid4&In-Reply-To=%3C5b8f975e-9df0-22fc-d1a2-2a3255ca5dcd%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021830.html">
   <LINK REL="Next"  HREF="021832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP Fast open and squid4</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP%20Fast%20open%20and%20squid4&In-Reply-To=%3C5b8f975e-9df0-22fc-d1a2-2a3255ca5dcd%40treenet.co.nz%3E"
       TITLE="[squid-users] TCP Fast open and squid4">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Mar  6 09:08:57 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021830.html">[squid-users] external helper
</A></li>
        <LI>Next message (by thread): <A HREF="021832.html">[squid-users] TCP Fast open and squid4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21831">[ date ]</a>
              <a href="thread.html#21831">[ thread ]</a>
              <a href="subject.html#21831">[ subject ]</a>
              <a href="author.html#21831">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/02/20 1:11 am, David Touzeau wrote:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> Is Squid handle TCP Fast open on modern kernel ?
</I>&gt;<i> 
</I>
Not currently.
 AIUI the kernel may be configured with the feature on inbound
connections. But Squid does not read it until at least one I/O cycle
after the handshake completion anyway, so I would expect little
performance gain unless the connection RTT is large.


&gt;<i> Has anyone tried to implement this directive and noticed a performance
</I>&gt;<i> improvement ?
</I>&gt;<i> 
</I>
Not that I am aware of.

For inbound traffic;

 Kernels that support fast-open do not really need Squid support. They
can buffer the early data until Squid reads it in.

Adding support to Squid for this should not be too difficult. Patches or
PR's welcome.


For outbound traffic;

 Squid is designed to open connections first (possibly a very long time)
before data is sent. So fast-open would require a significant re-design
of the task scheduling systems.

IMO we would get better gains by simply re-ordering the tasks so
connection opening operated in parallel to assembly of the outbound
request. Anyone wanting to attempt that should get in touch via squid-dev.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021830.html">[squid-users] external helper
</A></li>
	<LI>Next message (by thread): <A HREF="021832.html">[squid-users] TCP Fast open and squid4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21831">[ date ]</a>
              <a href="thread.html#21831">[ thread ]</a>
              <a href="subject.html#21831">[ subject ]</a>
              <a href="author.html#21831">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
