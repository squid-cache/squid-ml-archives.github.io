<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to Configure Proxy Chaining with ssl-bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20Configure%20Proxy%20Chaining%20with%20ssl-bump&In-Reply-To=%3Cc9628d3c-cf83-338b-5586-5d85d8b3b4f4%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021860.html">
   <LINK REL="Next"  HREF="021862.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to Configure Proxy Chaining with ssl-bump</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20Configure%20Proxy%20Chaining%20with%20ssl-bump&In-Reply-To=%3Cc9628d3c-cf83-338b-5586-5d85d8b3b4f4%40treenet.co.nz%3E"
       TITLE="[squid-users] How to Configure Proxy Chaining with ssl-bump">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Mar 20 09:29:14 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="021860.html">[squid-users] How to Configure Proxy Chaining with ssl-bump
</A></li>
        <LI>Next message (by thread): <A HREF="021862.html">[squid-users] How to Configure Proxy Chaining with ssl-bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21861">[ date ]</a>
              <a href="thread.html#21861">[ thread ]</a>
              <a href="subject.html#21861">[ subject ]</a>
              <a href="author.html#21861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/03/20 8:27 pm, Michael Chen wrote:
&gt;<i> Hi Amos,
</I>&gt;<i> May I know which function Squid v3.5.28 cannot do for my scenario?
</I>&gt;<i> Because Squid v3.5 still has command of cache_peer and ssl .....
</I>&gt;<i> 
</I>
TLS is a volatile environment, with many changes going on constantly.
Squid-3 has been deprecated since 2018 and is far behind in support
needed for current TLS practices.

Especially when bumping you should always have the latest Squid version.


This first bit can be tested with Squid-3. It is just about getting a
secure connection to the peer, any Squid should be able to do that.

Ensure that the peer proxy is delivering its CA *chain* properly.
 * All the intermediates should be supplied during the server handshake.
 * cache_peer should only need the root CA for that chain. Configured in
the sslca= or tls-ca= option.

At this point your Squid should be able to pass traffic to the peer.
Test that with regular <A HREF="http://">http://</A> URL requests to your Squid. *Not* HTTPS
or bumped traffic.


You can test this following with Squid-3, but do not expect it to work
very well. Squid-4 is better in a lot of cases, but still not completely.

Your ssl_bump rules should peek at the client cert, then stare at the
server cert, then bump the crypto. Like so:

 ssl_bump peek  step1
 ssl_bump stare all
 ssl_bump bump  all


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="021860.html">[squid-users] How to Configure Proxy Chaining with ssl-bump
</A></li>
	<LI>Next message (by thread): <A HREF="021862.html">[squid-users] How to Configure Proxy Chaining with ssl-bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21861">[ date ]</a>
              <a href="thread.html#21861">[ thread ]</a>
              <a href="subject.html#21861">[ subject ]</a>
              <a href="author.html#21861">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
