<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid logging disable based on ACL &amp; kernel: Out of	memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20logging%20disable%20based%20on%20ACL%20%26%20kernel%3A%20Out%20of%0A%09memory&In-Reply-To=%3CCAH1tzCQ5m6%2BhUuPpcVnVVM%3DrWJh-nrXyscacgyXnMKhi8S82-A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="022040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid logging disable based on ACL &amp; kernel: Out of	memory</H1>
    <B>Akshay Hegde</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20logging%20disable%20based%20on%20ACL%20%26%20kernel%3A%20Out%20of%0A%09memory&In-Reply-To=%3CCAH1tzCQ5m6%2BhUuPpcVnVVM%3DrWJh-nrXyscacgyXnMKhi8S82-A%40mail.gmail.com%3E"
       TITLE="[squid-users] squid logging disable based on ACL &amp; kernel: Out of	memory">akshay.k.hegde at gmail.com
       </A><BR>
    <I>Fri May  1 05:20:25 UTC 2020</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="022040.html">[squid-users] squid logging disable based on ACL &amp; kernel: Out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22039">[ date ]</a>
              <a href="thread.html#22039">[ thread ]</a>
              <a href="subject.html#22039">[ subject ]</a>
              <a href="author.html#22039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear All,
I got 2 query which are as follows

*1. How to disable logging of few ACLs ? for example I have below ACL which
I trust and I do not enable caching *

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# cat no_cache_domain.txt
.ubuntu.com
.googlevideo.com
.googleapis.com
.googleusercontent.com
.windows.com
.windowsupdate.com
.kaspersky.com
.copernicus.eu
.praction.in
.webwerks.in

# and in squid.conf
acl no-cache-domains dstdomain &quot;/etc/squid/no_cache_domain.txt&quot;
cache deny no-cache-domains

*2. Kernel Out of Memory ( I currently have logrotate on weekly basis ),
how this issue can be fixed it runs nearly 12 hours without any error*

Log error is as follows:

May  1 08:45:20 proxy kernel: Out of memory: Kill process 24384 (squid)
score 961 or sacrifice child
May  1 08:45:20 proxy kernel: Killed process 24384, UID 0, (squid)
total-vm:23620544kB, anon-rss:15381672kB, file-rss:292kB
May  1 08:45:22 proxy squid[24382]: Squid Parent: child process 24384
exited due to signal 9 with status 0

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# cat /proc/swaps
Filename  Type Size Used Priority
/dev/sda3                               partition 8191992 38984 -1

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 6.3 (Santiago)

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# squid -v
Squid Cache: Version 3.1.10

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# ll -sh /var/log/squid/access.log
37G -rw-r----- 1 squid squid 37G May  1 10:47 /var/log/squid/access.log

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# ll -sh /var/log/squid/store.log
52G -rw-r----- 1 squid squid 52G May  1 10:47 /var/log/squid/store.log

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# du -sh /cache/
23G /cache/

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# grep '^cache_dir' /etc/squid/squid.conf
cache_dir ufs /cache 25000 16 256

[<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at proxy</A> squid]# vmstat -s
     16334568  total memory
     16165900  used memory
       916616  active memory
     14824916  inactive memory
       168668  free memory
       111912  buffer memory
     14773484  swap cache
      8191992  total swap
        38984  used swap
      8153008  free swap
    150918525 non-nice user cpu ticks
      1039325 nice user cpu ticks
     88617581 system cpu ticks
   3955184009 idle cpu ticks
      8975352 IO-wait cpu ticks
      6237581 IRQ cpu ticks
     35714514 softirq cpu ticks
            0 stolen cpu ticks
   3099830316 pages paged in
    546843845 pages paged out
      2155651 pages swapped in
     11728162 pages swapped out
     78924125 interrupts
   3426967839 CPU context switches
   1577614862 boot time
       547399 forks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200501/be0e4a6a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200501/be0e4a6a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="022040.html">[squid-users] squid logging disable based on ACL &amp; kernel: Out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22039">[ date ]</a>
              <a href="thread.html#22039">[ thread ]</a>
              <a href="subject.html#22039">[ subject ]</a>
              <a href="author.html#22039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
