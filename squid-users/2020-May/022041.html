<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Passing XML through squid proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Passing%20XML%20through%20squid%20proxy&In-Reply-To=%3CBN8PR08MB6420802EE795041C9002FD39DDAB0%40BN8PR08MB6420.namprd08.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022052.html">
   <LINK REL="Next"  HREF="022042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Passing XML through squid proxy</H1>
    <B>Cindy Yoho</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Passing%20XML%20through%20squid%20proxy&In-Reply-To=%3CBN8PR08MB6420802EE795041C9002FD39DDAB0%40BN8PR08MB6420.namprd08.prod.outlook.com%3E"
       TITLE="[squid-users] Passing XML through squid proxy">Cyoho at umpublishing.org
       </A><BR>
    <I>Fri May  1 14:56:20 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022052.html">[squid-users] squid logging disable based on ACL &amp; kernel: Out of memory
</A></li>
        <LI>Next message (by thread): <A HREF="022042.html">[squid-users] Passing XML through squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22041">[ date ]</a>
              <a href="thread.html#22041">[ thread ]</a>
              <a href="subject.html#22041">[ subject ]</a>
              <a href="author.html#22041">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Folks,

I am brand new to squid, my main work areas being storage, VMware and linux.   I was asked to setup a forward proxy server on a CentOS VMware guest.   I initially chose nginx, which seemed to work fine most of the time but about once a week would stop working and require a reboot to get going again.   When I tried to get assistance with the nginx issue, I was told it was not supported as a forward proxy, and I should use squid.

So I started over, CentOS 7, squid 7:3.5.20-15.el7_6.1, and kept more or less the default config.  In my config I commented out all the possible internal networks except the ones in use, and added

acl  GOOD dstdomain .vertexsmb.com

The use case is as follows:

Our Order Entry server will request a tax calculation from a Vertex cloud server by sending XML code (below) through the squid server.   There is a firewall between us and the Vertex cloud.

The squid server returns the expected display when I put the test url into the browser on the squid server.   So the firewall is allowing squid to vertex.  When the Order Entry server sends the XML code, however, we get an error returned to the server making the request (below also).  I have also included the error I see in wireshark on the squid server when watching the transaction.   Any help would be greatly appreciated.

TIA
Cindy

XML CODE:

&lt;soapenv:Envelope xmlns:soapenv=&quot;<A HREF="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</A>&quot;&gt;
   &lt;soapenv:Body xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>&quot; xmlns:xsd=&quot;<A HREF="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</A>&quot;&gt;
      &lt;VertexEnvelope xmlns=&quot;urn:vertexinc:o-series:tps:7:0&quot;&gt;
         &lt;Login&gt;
            &lt;TrustedId&gt;xxxxxxxxxxxxxxx&lt;/TrustedId&gt;
         &lt;/Login&gt;
         &lt;QuotationRequest transactionType=&quot;SALE&quot; returnAssistedParametersIndicator=&quot;true&quot; documentDate=&quot;2019-11-18&quot; documentNumber=&quot;TestNewTax&quot;&gt;
            &lt;Seller&gt;
               &lt;Company&gt;ABC Widgets&lt;/Company&gt;
               &lt;PhysicalOrigin&gt;
                  &lt;City&gt;NASHVILLE&lt;/City&gt;
                  &lt;MainDivision&gt;TN&lt;/MainDivision&gt;
                  &lt;PostalCode&gt;372281306&lt;/PostalCode&gt;
               &lt;/PhysicalOrigin&gt;
            &lt;/Seller&gt;
            &lt;Customer&gt;
               &lt;CustomerCode&gt;nnnnnnnnn&lt;/CustomerCode&gt;
               &lt;Destination&gt;
                  &lt;City&gt;HENDERSONVILLE&lt;/City&gt;
                  &lt;MainDivision&gt;TN&lt;/MainDivision&gt;
                  &lt;PostalCode&gt;370754525&lt;/PostalCode&gt;
               &lt;/Destination&gt;
            &lt;/Customer&gt;
            &lt;LineItem&gt;
               &lt;Product productClass=&quot;AEU&quot;&gt;9781426740565&lt;/Product&gt;
               &lt;Quantity&gt;1&lt;/Quantity&gt;
               &lt;ExtendedPrice&gt;10.00&lt;/ExtendedPrice&gt;
               &lt;FlexibleFields&gt;
                     &lt;FlexibleCodeField fieldId=&quot;1&quot;&gt;G1&lt;/FlexibleCodeField&gt;
               &lt;/FlexibleFields&gt;
            &lt;/LineItem&gt;
         &lt;/QuotationRequest&gt;
         &lt;ApplicationData&gt;
            &lt;Sender&gt;Ecometry&lt;/Sender&gt;
         &lt;/ApplicationData&gt;
      &lt;/VertexEnvelope&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;

XML ERROR:

ERROR:  The requested URL could not be retrieved.
Missing or incorrect access protocol

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;<A HREF="http://www.w3.org/TR/html4/strict.dtd">http://www.w3.org/TR/html4/strict.dtd</A>&quot;&gt;
&lt;html&gt;&lt;head&gt;
&lt;meta type=&quot;copyright&quot; content=&quot;Copyright (C) 1996-2016 The Squid Software Foundation and contributors&quot;&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
&lt;title&gt;ERROR: The requested URL could not be retrieved&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;&lt;!--
 /*
* Copyright (C) 1996-2016 The Squid Software Foundation and contributors
*
* Squid software is distributed under GPLv2+ license and includes
* contributions from numerous individuals and organizations.
* Please see the COPYING and CONTRIBUTORS files for details.
*/

WIRESHARK ERROR on Squid Server:

HTTP     3606 HTTP/1.1 400 Bad Request (text/html)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200501/c14f4fa3/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200501/c14f4fa3/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022052.html">[squid-users] squid logging disable based on ACL &amp; kernel: Out of memory
</A></li>
	<LI>Next message (by thread): <A HREF="022042.html">[squid-users] Passing XML through squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22041">[ date ]</a>
              <a href="thread.html#22041">[ thread ]</a>
              <a href="subject.html#22041">[ subject ]</a>
              <a href="author.html#22041">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
