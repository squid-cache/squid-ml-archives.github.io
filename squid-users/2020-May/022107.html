<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] &quot;intercepted port does not match 443&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22intercepted%20port%20does%20not%20match%20443%22&In-Reply-To=%3C20200511130138.GC10458%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022106.html">
   <LINK REL="Next"  HREF="022119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] &quot;intercepted port does not match 443&quot;</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%22intercepted%20port%20does%20not%20match%20443%22&In-Reply-To=%3C20200511130138.GC10458%40fantomas.sk%3E"
       TITLE="[squid-users] &quot;intercepted port does not match 443&quot;">uhlar at fantomas.sk
       </A><BR>
    <I>Mon May 11 13:01:38 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022106.html">[squid-users] SQUID PROBLEM WITH SITES THAT HAVE MORE THAN ONE	IP ADDRESSES
</A></li>
        <LI>Next message (by thread): <A HREF="022119.html">[squid-users] &quot;intercepted port does not match 443&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22107">[ date ]</a>
              <a href="thread.html#22107">[ thread ]</a>
              <a href="subject.html#22107">[ subject ]</a>
              <a href="author.html#22107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

we have intercepting squid on one router and these messages started appear
sometimes:

2020/05/11 13:41:23 kid1| SECURITY ALERT: Host header forgery detected on local=[XXX]:80 remote=192.168.1.224:1040 FD 69 flags=33 (intercepted port does not match 443)
2020/05/11 13:41:23 kid1| SECURITY ALERT: By user agent: Microsoft BITS/6.7
2020/05/11 13:41:23 kid1| SECURITY ALERT: on URL: armmf.adobe.com:443
2020/05/11 13:41:23 kid1| kick abandoning local=[XXX]:80 remote=192.168.1.224:1040 FD 69 flags=33

I am aware of possible interception issues but what exactly does this
message mean?  The original destination port is 80, why does squid complain
about it not being port 443?

the iptable rules:

Chain PREROUTING (policy ACCEPT 1759K packets, 217M bytes)
 pkts bytes target     prot opt in     out     source               destination
37068 1966K REDIRECT   tcp  --  lan0   *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 redir ports 8888

thanks.

-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Windows 2000: 640 MB ought to be enough for anybody

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022106.html">[squid-users] SQUID PROBLEM WITH SITES THAT HAVE MORE THAN ONE	IP ADDRESSES
</A></li>
	<LI>Next message (by thread): <A HREF="022119.html">[squid-users] &quot;intercepted port does not match 443&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22107">[ date ]</a>
              <a href="thread.html#22107">[ thread ]</a>
              <a href="subject.html#22107">[ subject ]</a>
              <a href="author.html#22107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
