<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sending CONNECT method requests over HTTPS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sending%20CONNECT%20method%20requests%20over%20HTTPS&In-Reply-To=%3C13e84236-14db-cf77-0dcd-a6a43d1d7401%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022143.html">
   <LINK REL="Next"  HREF="022145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sending CONNECT method requests over HTTPS</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sending%20CONNECT%20method%20requests%20over%20HTTPS&In-Reply-To=%3C13e84236-14db-cf77-0dcd-a6a43d1d7401%40measurement-factory.com%3E"
       TITLE="[squid-users] Sending CONNECT method requests over HTTPS">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed May 20 19:54:36 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022143.html">[squid-users] Sending CONNECT method requests over HTTPS
</A></li>
        <LI>Next message (by thread): <A HREF="022145.html">[squid-users] Sending CONNECT method requests over HTTPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22144">[ date ]</a>
              <a href="thread.html#22144">[ thread ]</a>
              <a href="subject.html#22144">[ subject ]</a>
              <a href="author.html#22144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/20/20 1:38 PM, Ronan Lucio wrote:
&gt;&gt;&gt;<i> My scenario is:
</I>&gt;&gt;&gt;<i> I have a serverless API that needs to connect to a couple specific
</I>&gt;&gt;&gt;<i> targets from a static IP.
</I>&gt;&gt;&gt;<i> As this serverless API doesn't have a static IP, I thought to do this
</I>&gt;&gt;&gt;<i> through a proxy server.
</I>&gt;&gt;&gt;<i> That's why I need to enforce security on the authentication layer.
</I>

&gt;&gt;<i> And, I presume, you do not trust the API to only request what it should.
</I>&gt;&gt;<i> If you trust the API, then you do not need the allowed_target check.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, if possible, consider using certificate-based authentication
</I>&gt;&gt;<i> rather than HTTP authentication to authenticate your clients to Squid.
</I>&gt;&gt;<i> Certificate-based authentication happens earlier, before Squid has to
</I>&gt;&gt;<i> deal with all the dangers of HTTP negotiations.
</I>

&gt;<i> I can't trust the source network, it's on the cloud and sure it has
</I>&gt;<i> other applications in the same public network. I also plan to send
</I>&gt;<i> these requests through NAT from a static IP, so I can accept requests
</I>&gt;<i> only from a specific IP.
</I>
That is fine, but, FWIW, the above does not justify the need for the
allowed_target check AFAICT. It only justifies the need for authentication.


&gt;<i> The idea of using Certificate-based authentication is really good.
</I>&gt;<i> Is it possible to do this between client-squid or do you mean
</I>&gt;<i> client-to-other-end?
</I>
Certificate-based authentication works between any two TLS agents that
support it. Squid supports it on the https_port.

If the client and the origin server (what you called the &quot;other&quot; end)
also support it, then the client can authenticate itself to both Squid
and the origin server. Please note that in this case, there will be two
(partially concurrent) TLS connections and two (sequential)
authentications going on -- Squid cannot &quot;forward&quot; certificate-based
authentication (and, without bumping, cannot modify the client-origin
TLS connection, including the TLS client Hello message that contains the
client certificate).


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022143.html">[squid-users] Sending CONNECT method requests over HTTPS
</A></li>
	<LI>Next message (by thread): <A HREF="022145.html">[squid-users] Sending CONNECT method requests over HTTPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22144">[ date ]</a>
              <a href="thread.html#22144">[ thread ]</a>
              <a href="subject.html#22144">[ subject ]</a>
              <a href="author.html#22144">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
