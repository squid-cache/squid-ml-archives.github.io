<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Bypass squid using iptables
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypass%20squid%20using%20iptables&In-Reply-To=%3CCADAqQfwT599AKw71B9QZuCV58EmzATqPDkzvX14NciE6XVMobA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022163.html">
   <LINK REL="Next"  HREF="022174.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Bypass squid using iptables</H1>
    <B>Ben Goz</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypass%20squid%20using%20iptables&In-Reply-To=%3CCADAqQfwT599AKw71B9QZuCV58EmzATqPDkzvX14NciE6XVMobA%40mail.gmail.com%3E"
       TITLE="[squid-users] Bypass squid using iptables">ben.goz87 at gmail.com
       </A><BR>
    <I>Mon May 25 10:09:46 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022163.html">[squid-users] Bypass squid using iptables
</A></li>
        <LI>Next message (by thread): <A HREF="022174.html">[squid-users] Bypass squid using iptables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22171">[ date ]</a>
              <a href="thread.html#22171">[ thread ]</a>
              <a href="subject.html#22171">[ subject ]</a>
              <a href="author.html#22171">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>B.H
&gt;<i>Tunneling it elsewhere,
</I>Where can I tunnel it? and how can I configure my machine to support it?

&gt;<i>You cannot have iptables suddenly divert packets to other software
</I>mid-stream.
I want to tunnel it by IP or translate a group of URLs to IPs I'm not sure
if this is the case that you mentioned,
Because I can do it before squid handles TCP session initialization.

The issue here is as I said that I want bypass WSS and other stuff that
squid can't technically support for known list of IPs (or URLS).
Do you have any recommended configuration for this requirement?

Regards,
Ben
suddenly divert packets to other software mid-stream.

&#8235;&#1489;&#1514;&#1488;&#1512;&#1497;&#1498; &#1497;&#1493;&#1501; &#1489;&#1523;, 25 &#1489;&#1502;&#1488;&#1497; 2020 &#1489;-9:56 &#1502;&#1488;&#1514; &#8234;Amos Jeffries&#8236;&#8207; &lt;&#8234;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&#8236;&#8207;&gt;:&#8236;

&gt;<i> On 21/05/20 3:49 am, Ben Goz wrote:
</I>&gt;<i> &gt; B.H.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm using squid with c-icap module for specific content filtering. I
</I>&gt;<i> &gt; configured squid with ssl bump so website with WSS won't work on it as
</I>&gt;<i> &gt; mentioned on squid documentation. So for such URLs (with WSS) I need
</I>&gt;<i> &gt; bypassing squid. I read in some posts that squid doesn't fully supports
</I>&gt;<i> &gt; bypassing URLs and best way is to bypasses it via iptables.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Eventually I redirects browser traffic to my proxy machine using local
</I>&gt;<i> &gt; machine proxy settings, and Its redirects traffic to my machine with IP
</I>&gt;<i> &gt; x.x.x.x port 3128.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If I want to use the conservative iptables bypassing how should I config
</I>&gt;<i> &gt; my machine? and how iptables rules should looks like?
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Since you are redirecting the traffic to Squid in the first place. All
</I>&gt;<i> you have to do is *not* redirect the relevant traffic. See your firewall
</I>&gt;<i> software documentation on how to configure that.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The hard part is figuring out which traffic you want the proxy to
</I>&gt;<i> service, and what to bypass given only a TCP SYN packet.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Be aware that once a TCP SYN+ACK packet is delivered to accept the
</I>&gt;<i> connection Squid *has* to service that TCP connection in its entirety.
</I>&gt;<i> Such 'service' may mean terminating it without any traffic, tunneling it
</I>&gt;<i> elsewhere, or full processing of the traffic.
</I>&gt;<i>  Either way Squid is the agent servicing it. You cannot have iptables
</I>&gt;<i> suddenly divert packets to other software mid-stream.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTH
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20200525/4c91768c/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20200525/4c91768c/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022163.html">[squid-users] Bypass squid using iptables
</A></li>
	<LI>Next message (by thread): <A HREF="022174.html">[squid-users] Bypass squid using iptables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22171">[ date ]</a>
              <a href="thread.html#22171">[ thread ]</a>
              <a href="subject.html#22171">[ subject ]</a>
              <a href="author.html#22171">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
