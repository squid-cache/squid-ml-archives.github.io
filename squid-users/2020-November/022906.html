<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] allow certian user ips to access only 2 domains and disallow everything
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20allow%20certian%20user%20ips%20to%20access%20only%202%20domains%0A%20and%20disallow%20everything&In-Reply-To=%3C000001d6b2ab%248774aa50%24965dfef0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022947.html">
   <LINK REL="Next"  HREF="022907.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] allow certian user ips to access only 2 domains and disallow everything</H1>
    <B>Eliezer Croitor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20allow%20certian%20user%20ips%20to%20access%20only%202%20domains%0A%20and%20disallow%20everything&In-Reply-To=%3C000001d6b2ab%248774aa50%24965dfef0%24%40gmail.com%3E"
       TITLE="[squid-users] allow certian user ips to access only 2 domains and disallow everything">ngtech1ltd at gmail.com
       </A><BR>
    <I>Wed Nov  4 13:08:02 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022947.html">[squid-users] websockets through Squid
</A></li>
        <LI>Next message (by thread): <A HREF="022907.html">[squid-users] squid kerberos auth, acl note group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22906">[ date ]</a>
              <a href="thread.html#22906">[ thread ]</a>
              <a href="subject.html#22906">[ subject ]</a>
              <a href="author.html#22906">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Simon,

 

I have seen these websites and it seems that some content which is used in them is from CDNs or other domains.

It&#8217;s very important to include specific domains like in the url:

<A HREF="https://code.jquery.com/jquery-3.3.1.min.js">https://code.jquery.com/jquery-3.3.1.min.js</A>

 

For these sites to work properly.

 

You can try to run a more complex config which can or might take into account the Referrer header in the Request

It will probably only work if SSL bump is configured in your setup and it&#8217;s not the most secure way to allow sites.

I am only offering this as a it can be limited to specific domains such as cdns or specific hosted services.

 

All The Bests,

 

----

Eliezer Croitoru

Tech Support

Mobile: +972-5-28704261

Email:  &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>

 

From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of simon ben
Sent: Friday, October 16, 2020 12:21 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] allow certian user ips to access only 2 domains and disallow everything

 

I have squid running perfectly fine on centos 7 64 bit with no issues

I want to allow certain user ips to access a few sites and block everything else so below is the config

the sites are 

1) paloaltonetworks.com

2) redcloak.secureworks.com

 

in squid.conf

-------------------

acl userlist src &quot;/etc/squid/userlist&quot;

acl sitelist dstdomain &quot;/etc/squid/sitelist&quot;

http_access allow userlist sitelist

 

-------------------

 

user list file has the ips

-----------

192.168.62.128

192.168.62.1

192.168.62.129

192.168.61.1

192.168.62.130

192.168.62.3

192.168.61.128

172.16.120.160

------------------------------

 

site list file has the sites

----------------------------------------

.paloaltonetworks.com

.secureworks.com

<A HREF="https://ch-baladia.traps.paloaltonetworks.com">https://ch-baladia.traps.paloaltonetworks.com</A>

baladia.xdr.eu.paloaltonetworks.com

identity.paloaltonetworks.com

login.paloaltonetworks.com

assets.adobedtm.com

www.paloaltonetworks.com &lt;<A HREF="http://www.paloaltonetworks.com">http://www.paloaltonetworks.com</A>&gt; 

redcloak.secureworks.com

 

------------------------------------------------

 

I see that the first page and some links are working but some do not . also there is a huge deny logs in squid access logs

appreciate if you can advise me on how i can have the above access list so as to have minimum denies when being accessed from the above ips

 

 

Thanks and Regards

 

 

simon  

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20201104/a2fdf620/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20201104/a2fdf620/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022947.html">[squid-users] websockets through Squid
</A></li>
	<LI>Next message (by thread): <A HREF="022907.html">[squid-users] squid kerberos auth, acl note group
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22906">[ date ]</a>
              <a href="thread.html#22906">[ thread ]</a>
              <a href="subject.html#22906">[ subject ]</a>
              <a href="author.html#22906">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
