<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Debugging a slow Squid?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20a%20slow%20Squid%3F&In-Reply-To=%3C3e594643-4a5a-b2e4-7ecf-cf30ca1d52b0%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022959.html">
   <LINK REL="Next"  HREF="022961.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Debugging a slow Squid?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Debugging%20a%20slow%20Squid%3F&In-Reply-To=%3C3e594643-4a5a-b2e4-7ecf-cf30ca1d52b0%40measurement-factory.com%3E"
       TITLE="[squid-users] Debugging a slow Squid?">rousskov at measurement-factory.com
       </A><BR>
    <I>Sat Nov 28 16:23:34 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022959.html">[squid-users] Debugging a slow Squid?
</A></li>
        <LI>Next message (by thread): <A HREF="022961.html">[squid-users] Debugging a slow Squid?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22960">[ date ]</a>
              <a href="thread.html#22960">[ thread ]</a>
              <a href="subject.html#22960">[ subject ]</a>
              <a href="author.html#22960">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/28/20 7:00 AM, roee klinger wrote:

&gt;<i> I am aware of the &lt;tr&gt; in the Squid log, but does it show the time it
</I>&gt;<i> took Squid to process the request or does it also include the time it
</I>&gt;<i> took the request to even get to Squid (for example the time from the
</I>&gt;<i> router to Squid, from the user to the router, etc)?
</I>
Overall, do not expect Squid to measure what happens before the HTTP
request header is received. Squid could (and should and eventually will)
measure more than it does now when it comes to the beginning of the
transaction, but often there is just not enough information to measure
the client-Squid propagation/communication delay for the initial TCP
packet(s) or for the initial HTTP request packet on a previously used
persistent connection.

Specifically, %tr logformat code logs the difference between master
transaction start time and master transaction logging time.

* According to %tS documentation, Squid currently considers the master
transaction started when a complete HTTP request header initiating the
transaction is received from the client.

* Currently, Squid logs the master transaction when the client-Squid
transaction that was handling the client HTTP request gets destroyed.
Usually, that destruction happens when Squid receives the entire request
from the client and sends the entire response to that client.



&gt;<i> What would be the best way to isolate, inspect, and improve&#160;Squid
</I>&gt;<i> performance, regardless of network performance?
</I>
One could write a book answering this question, but I would start by
running atop to exclude system bottlenecks (memory, CPU, disk) first.
Once system/global bottlenecks are eliminated, you may be able to detect
processing stages that slow down the transaction the most by sending
representative test requests.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022959.html">[squid-users] Debugging a slow Squid?
</A></li>
	<LI>Next message (by thread): <A HREF="022961.html">[squid-users] Debugging a slow Squid?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22960">[ date ]</a>
              <a href="thread.html#22960">[ thread ]</a>
              <a href="subject.html#22960">[ subject ]</a>
              <a href="author.html#22960">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
