<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] R:  Trouble with an app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20R%3A%20%20Trouble%20with%20an%20app&In-Reply-To=%3C005a01d6a136%24d0c7cfb0%2472576f10%24%40edu.ti.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022799.html">
   <LINK REL="Next"  HREF="022814.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] R:  Trouble with an app</H1>
    <B>Roberto Nunnari</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20R%3A%20%20Trouble%20with%20an%20app&In-Reply-To=%3C005a01d6a136%24d0c7cfb0%2472576f10%24%40edu.ti.ch%3E"
       TITLE="[squid-users] R:  Trouble with an app">roberto.nunnari at edu.ti.ch
       </A><BR>
    <I>Tue Oct 13 07:59:45 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022799.html">[squid-users] Trouble with an app
</A></li>
        <LI>Next message (by thread): <A HREF="022814.html">[squid-users] R:  Trouble with an app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22811">[ date ]</a>
              <a href="thread.html#22811">[ thread ]</a>
              <a href="subject.html#22811">[ subject ]</a>
              <a href="author.html#22811">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Amos.

Thank you for your help.

Could it be that the client received the zscaler certificate and because it's wrong for google it closed the connection?
Unfortunately, the logs on the client don't show no clue about it..

Thank you and best regards.
Roberto



-----Messaggio originale-----
Da: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; Per conto di Amos Jeffries
Inviato: domenica, 11 ottobre 2020 02:41
A: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Oggetto: Re: [squid-users] Trouble with an app

On 10/10/20 2:54 am, Roberto Nunnari wrote:
&gt;<i> Hello.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I work in secondary school and our access to internet is protected in 
</I>&gt;<i> two points:
</I>&gt;<i> 
</I>&gt;<i> 1)      Squid proxy (I manage this)
</I>&gt;<i> 
</I>&gt;<i> 2)      Internet service provider (they change *.google.com ssl 
</I>&gt;<i> certificate with zscaler)
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> We install these zscaler certificates on all our clients, but I 
</I>&gt;<i> believe this java app doesn&#8217;t care to use it.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Now, can somebody explain these logs to me, please?
</I>&gt;<i> 
</I>
Sure:

&gt;<i> 
</I>&gt;<i> Fri Oct  9 15:44:41 2020.521      1 10.20.8.212 TCP_DENIED/407 4076 
</I>&gt;<i> CONNECT google.ch:443 - HIER_NONE/- text/html
</I>&gt;<i> 
</I>
Client sent a CONNECT request to the proxy. It did not have credentials, so Squid responded with a 407 message informing it that credentials are required.


&gt;<i> Fri Oct  9 15:44:41 2020.660    122 10.20.8.212 TCP_TUNNEL/200 3552 
</I>&gt;<i> CONNECT google.ch:443 CPT\\docente.test HIER_DIRECT/216.58.215.227 -
</I>&gt;<i> 
</I>
Client sent CONNECT requests with credentials.
Squid opened a tunnel to the relevant server as requested by client.
Client spent 122ms using the tunnel for something.


&gt;<i> Fri Oct  9 15:44:52 2020.461      0 10.20.8.212 NONE/000 0 NONE 
</I>&gt;<i> error:transaction-end-before-headers - HIER_NONE/- -
</I>&gt;<i> 
</I>
Client opened TCP connection to the proxy. Then closed it.

This is fairly common side effect of &quot;Happy Eyeballs&quot; behaviour where clients open multiple connections and only use the first to succeed.

Or possibly the client had some other reason for closing. The log record is just informative so you know it is happening and useful to explain many sockets having TCP TIME_WAIT status if that becomes a problem.


HTH
Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022799.html">[squid-users] Trouble with an app
</A></li>
	<LI>Next message (by thread): <A HREF="022814.html">[squid-users] R:  Trouble with an app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22811">[ date ]</a>
              <a href="thread.html#22811">[ thread ]</a>
              <a href="subject.html#22811">[ subject ]</a>
              <a href="author.html#22811">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
