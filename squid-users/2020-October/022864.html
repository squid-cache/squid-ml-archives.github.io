<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid doesn't call helper
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20call%20helper&In-Reply-To=%3Cff4f11af6b77449b9aa8d887e5695ba0%40ads.uni-passau.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022856.html">
   <LINK REL="Next"  HREF="022855.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid doesn't call helper</H1>
    <B>Kornexl, Anton</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20doesn%27t%20call%20helper&In-Reply-To=%3Cff4f11af6b77449b9aa8d887e5695ba0%40ads.uni-passau.de%3E"
       TITLE="[squid-users] Squid doesn't call helper">Anton.Kornexl at uni-passau.de
       </A><BR>
    <I>Tue Oct 20 14:39:35 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022856.html">[squid-users] Squid doesn't call helper
</A></li>
        <LI>Next message (by thread): <A HREF="022855.html">[squid-users] active directory 2008.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22864">[ date ]</a>
              <a href="thread.html#22864">[ thread ]</a>
              <a href="subject.html#22864">[ subject ]</a>
              <a href="author.html#22864">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much

With the debug option i found the error

An external acl program  later in the config returned a number and OK in one line (5:OK or 10:ERR)
The acl handler in squid got an exception handling this returned result and all requests got DENIED

After correcting the external handler squid works OK 
AAAHHHH  

Yours 
Anton Kornexl


-----Urspr&#252;ngliche Nachricht-----
Von: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; Im Auftrag von Amos Jeffries
Gesendet: Dienstag, 20. Oktober 2020 13:38
An: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Betreff: Re: [squid-users] Squid doesn't call helper

On 20/10/20 6:18 pm, Kornexl, Anton wrote:
&gt;<i> Squid 4.10 on Ubuntu 20.04
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> The configured program is started but not called (or the result not used)
</I>&gt;<i> 
</I>
Please check cache.log to find out which of those two very different
things is happening.

One means the ACL is not being checked or credentials not provided. The
other means credentials are invalid.

You may need to set this directive:
  debug_options 11,2 29,5 28,4

&gt;<i> The authentication window does not show up in the browser
</I>
That means the auth result was not deny.


&gt;<i> 
</I>&gt;<i> All request are denied because acl proxyuser doesn&#8217;t match
</I>&gt;<i> 
</I>
There is no deny line in your shown config using auth ACLs.


&gt;<i> The same config runs on squid 3.5.27 on Ubuntu 18.04 and squid 4.13 on
</I>&gt;<i> opensuse 4.13
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>&gt;<i> 
</I>&gt;<i> How can i debug this problem
</I>&gt;<i> 
</I>
Check cache.log with this directive set:
  debug_options 11,2 29,5 28,4


&gt;<i> Other helpers are also not called/used
</I>&gt;<i> 
</I>&gt;<i> &#160;
</I>
That strongly implies you have an ordering problem in your config file.
One early ACL allowing or denying traffic before any helpers get checked.


&gt;<i> 
</I>&gt;<i> http_access allow jufi1
</I>&gt;<i> 
</I>&gt;<i> http_access allow jufi1-6
</I>&gt;<i> 
</I>&gt;<i> http_access allow jufi2
</I>&gt;<i> 
</I>&gt;<i> http_access allow jufi2-6
</I>&gt;<i> 
</I>
Since they are all the same type, and used the same way at the same time
You can combine all those ACLs into one name.

&gt;<i> 
</I>&gt;<i> http_access allow proxyusers
</I>&gt;<i> 
</I>
Please try the recommended auth config:

  http_access deny !proxyusers
  http_access allow localnet



Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022856.html">[squid-users] Squid doesn't call helper
</A></li>
	<LI>Next message (by thread): <A HREF="022855.html">[squid-users] active directory 2008.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22864">[ date ]</a>
              <a href="thread.html#22864">[ thread ]</a>
              <a href="subject.html#22864">[ subject ]</a>
              <a href="author.html#22864">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
