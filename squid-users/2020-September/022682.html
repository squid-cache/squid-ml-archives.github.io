<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Forwarded-for functionality(squid)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Forwarded-for%20functionality%28squid%29&In-Reply-To=%3C3940_1599645775_5F58A84F_3940_192_15_FB9F07820FAE75499D7A4E37F6CD7664AA82AC%40OPEXCAUBMA1.corporate.adroot.infra.ftgroup%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022681.html">
   <LINK REL="Next"  HREF="022680.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Forwarded-for functionality(squid)</H1>
    <B>piyush.gaba at orange.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Forwarded-for%20functionality%28squid%29&In-Reply-To=%3C3940_1599645775_5F58A84F_3940_192_15_FB9F07820FAE75499D7A4E37F6CD7664AA82AC%40OPEXCAUBMA1.corporate.adroot.infra.ftgroup%3E"
       TITLE="[squid-users] Forwarded-for functionality(squid)">piyush.gaba at orange.com
       </A><BR>
    <I>Wed Sep  9 10:02:55 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022681.html">[squid-users] Forwarded-for functionality(squid)
</A></li>
        <LI>Next message (by thread): <A HREF="022680.html">[squid-users] squid supprts HTTP long-polling?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22682">[ date ]</a>
              <a href="thread.html#22682">[ thread ]</a>
              <a href="subject.html#22682">[ subject ]</a>
              <a href="author.html#22682">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes Matus, I understand. It's just for temporary purpose since I am just testing the capabilities of squid v4.13.

Bien cordialement,
Piyush Gaba

-----Original Message-----
From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Matus UHLAR - fantomas
Sent: Wednesday, September 9, 2020 14:13
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Forwarded-for functionality(squid)

On 08.09.20 16:42, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">piyush.gaba at orange.com</A> wrote:
&gt;<i>By the way guys. It just worked. Thanks alot Amos and Matus.
</I>
just to make sure - are you aware that anything in the X-Forwarded-For:
header can be fake and you should only use trusted IPs?

The follow_x_forwarded_for describes how:
<A HREF="http://www.squid-cache.org/Doc/config/follow_x_forwarded_for/">http://www.squid-cache.org/Doc/config/follow_x_forwarded_for/</A>


&gt;<i>On 9/09/20 1:15 am, piyush.gaba wrote:
</I>&gt;&gt;<i> I think my whole struggle is to get the desired output as:
</I>&gt;&gt;<i> &lt;ip&gt;- - [17/Aug/2018:08:43:29 +0200] &quot;GET /index1.html HTTP/1.1&quot; 200 36 &quot;-&quot; &quot;curl/7.29.0&quot; unknown
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which has &quot;unknown&quot; at the end because forwarded_for was set to &quot;off&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But now when I am working with squid 4.13 I am not getting the desired output, I am getting the output as,
</I>&gt;&gt;<i> &lt;ip&gt; - - [08/Sep/2020:15:07:19 +0200] &quot;GET /index1.html HTTP/1.1&quot; 200 8 &quot;-&quot; &quot;curl/7.29.0&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Which does not have anything at the end, while the forwarded_for is set to &quot;off&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please let me know if you have any advice to give for this logging problem.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am using below log format in my httpd file,
</I>&gt;&gt;<i> LogFormat &quot;%{X-Forwarded-For}i %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
</I>
&gt;<i>-----Original Message-----
</I>&gt;<i>From: squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] On Behalf Of Amos Jeffries
</I>&gt;<i>Sent: Tuesday, September 8, 2020 20:42
</I>&gt;<i>To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>Subject: Re: [squid-users] Forwarded-for functionality(squid)
</I>
&gt;<i>That LogFormat tells us the first column of the log file is the contents
</I>&gt;<i>of the X-Forwarded-For header. The first column of the log lines you
</I>&gt;<i>showed is &quot;&lt;ip&gt;&quot; - the value of XFF header is supposed to be one or more
</I>&gt;<i>IPs, so that looks like it is working.
</I>&gt;<i>
</I>&gt;<i>Use the debug_options setting I gave you to *actually* see what is
</I>&gt;<i>happening. The Apache log is only showing you what values are _after_
</I>&gt;<i>the httpd process and all modules have done their modifications to the
</I>&gt;<i>HTTP input ... including replacing the transaction client-IP with any
</I>&gt;<i>value from XFF header.
</I>
-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Saving Private Ryan...
Private Ryan exists. Overwrite? (Y/N)
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022681.html">[squid-users] Forwarded-for functionality(squid)
</A></li>
	<LI>Next message (by thread): <A HREF="022680.html">[squid-users] squid supprts HTTP long-polling?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22682">[ date ]</a>
              <a href="thread.html#22682">[ thread ]</a>
              <a href="subject.html#22682">[ subject ]</a>
              <a href="author.html#22682">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
