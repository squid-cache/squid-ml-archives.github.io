<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Change of server hardware (?) resulted in massive increase of crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Change%20of%20server%20hardware%20%28%3F%29%20resulted%20in%20massive%0A%20increase%20of%20crashes&In-Reply-To=%3C20200922074737.7twi6ffghibfpqgg%40charite.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022715.html">
   <LINK REL="Next"  HREF="022718.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Change of server hardware (?) resulted in massive increase of crashes</H1>
    <B>Ralf Hildebrandt</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Change%20of%20server%20hardware%20%28%3F%29%20resulted%20in%20massive%0A%20increase%20of%20crashes&In-Reply-To=%3C20200922074737.7twi6ffghibfpqgg%40charite.de%3E"
       TITLE="[squid-users] Change of server hardware (?) resulted in massive increase of crashes">Ralf.Hildebrandt at charite.de
       </A><BR>
    <I>Tue Sep 22 07:47:37 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022715.html">[squid-users] Client &lt;--&gt; Squid &lt;--&gt; FTP usecase
</A></li>
        <LI>Next message (by thread): <A HREF="022718.html">[squid-users] Change of server hardware (?) resulted in massive increase of crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22717">[ date ]</a>
              <a href="thread.html#22717">[ thread ]</a>
              <a href="subject.html#22717">[ subject ]</a>
              <a href="author.html#22717">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been running squid-5 and squid-6 (both release and HEAD) on my
old proxy farm. Four machines, ubuntu bionic. All was well, except for
the occasional crash.

I filed bug reports, and the preliminary patches helped with the
crashes:

<A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5055">https://bugs.squid-cache.org/show_bug.cgi?id=5055</A>
<A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5056">https://bugs.squid-cache.org/show_bug.cgi?id=5056</A>

Recently, I set up a new cluster of four up to date machines with new
hardware (still ubuntu, focal though, still x64, assloads of CPUs and
memeory) and tested that cluster with the users from our department.
All went well, squid never once crashed.

Then we took the old cluster offline, and let the new cluster take over.

Now I'm getting (with the same hand-build squid versions!) a LOT
(about once every 15 Minutes) of crashes like this one:

2020/09/22 09:34:07| FATAL: check failed: opening()
    exception location: tunnel.cc(1305) noteDestinationsEnd
    current master transaction: master359979

My infrastructure generates backtraces upon crash, but in the case I'm
not getting any. Which is odd, given I start squid in gdb with
&quot;/usr/sbin/squid -sYNC&quot;

--
Ralf Hildebrandt
Charit&#233; - Universit&#228;tsmedizin Berlin
Gesch&#228;ftsbereich IT | Abteilung Netzwerk

Campus Benjamin Franklin (CBF)
Haus I | 1. OG | Raum 105
Hindenburgdamm 30 | D-12203 Berlin

Tel. +49 30 450 570 155
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ralf.hildebrandt at charite.de</A>
<A HREF="https://www.charite.de">https://www.charite.de</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022715.html">[squid-users] Client &lt;--&gt; Squid &lt;--&gt; FTP usecase
</A></li>
	<LI>Next message (by thread): <A HREF="022718.html">[squid-users] Change of server hardware (?) resulted in massive increase of crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22717">[ date ]</a>
              <a href="thread.html#22717">[ thread ]</a>
              <a href="subject.html#22717">[ subject ]</a>
              <a href="author.html#22717">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
