<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Change of server hardware (?) resulted in massive increase of crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Change%20of%20server%20hardware%20%28%3F%29%20resulted%20in%20massive%0A%20increase%20of%20crashes&In-Reply-To=%3Ce9f72fbc-29e2-1dc4-935f-c1170797ddcc%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022718.html">
   <LINK REL="Next"  HREF="022720.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Change of server hardware (?) resulted in massive increase of crashes</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Change%20of%20server%20hardware%20%28%3F%29%20resulted%20in%20massive%0A%20increase%20of%20crashes&In-Reply-To=%3Ce9f72fbc-29e2-1dc4-935f-c1170797ddcc%40measurement-factory.com%3E"
       TITLE="[squid-users] Change of server hardware (?) resulted in massive increase of crashes">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Sep 22 13:52:57 UTC 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="022718.html">[squid-users] Change of server hardware (?) resulted in massive increase of crashes
</A></li>
        <LI>Next message (by thread): <A HREF="022720.html">[squid-users] [ext] Re: Change of server hardware (?) resulted in massive increase of crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22719">[ date ]</a>
              <a href="thread.html#22719">[ thread ]</a>
              <a href="subject.html#22719">[ subject ]</a>
              <a href="author.html#22719">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/22/20 3:47 AM, Ralf Hildebrandt wrote:
&gt;<i> I'm getting (with the same hand-build squid versions!) a LOT
</I>&gt;<i> (about once every 15 Minutes) of crashes like this one:
</I>&gt;<i> 
</I>&gt;<i> 2020/09/22 09:34:07| FATAL: check failed: opening()
</I>&gt;<i>     exception location: tunnel.cc(1305) noteDestinationsEnd
</I>&gt;<i>     current master transaction: master359979
</I>
This is still bug #5055. I hope we will post an official pull request
properly addressing it soon.

In my environment, Squid v5 is hardly usable without those fixes but, as
you know, YMMV. Your OS upgrade could trigger different DNS resolution
timings, the new cluster may have different IPv6 connectivity profile,
or there can be similar minor/innocent changes that result in slightly
different Squid state and more exceptions. I would not spend time trying
to pinpoint the exact trigger.

I updated bug #5055 with a patch that covers the tunneling case:
<A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5055#c5">https://bugs.squid-cache.org/show_bug.cgi?id=5055#c5</A>


&gt;<i> My infrastructure generates backtraces upon crash, but in the case I'm
</I>&gt;<i> not getting any.
</I>
Unlike &quot;assertion failed&quot; FATAL messages, the &quot;check failed&quot; FATAL
messages are the result of an unhandled (for the lack of a better word)
exception. Today, such exceptions do not generate core dumps because the
low-level stack is pretty much lost by the time the exception is caught
by the high-level code. Unhandled exception handling (yes, I know) may
change in the future, but that is a separate issue.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="022718.html">[squid-users] Change of server hardware (?) resulted in massive increase of crashes
</A></li>
	<LI>Next message (by thread): <A HREF="022720.html">[squid-users] [ext] Re: Change of server hardware (?) resulted in massive increase of crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22719">[ date ]</a>
              <a href="thread.html#22719">[ thread ]</a>
              <a href="subject.html#22719">[ subject ]</a>
              <a href="author.html#22719">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
