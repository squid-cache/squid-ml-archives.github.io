<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid within a network namespace
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20within%20a%20network%20namespace&In-Reply-To=%3CCAMc2VtTujVm1H9pq%2BctLSw%2BmjiY8nbSESHqC52W6fNy9cBb0pQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023557.html">
   <LINK REL="Next"  HREF="023545.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid within a network namespace</H1>
    <B>Francois</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20within%20a%20network%20namespace&In-Reply-To=%3CCAMc2VtTujVm1H9pq%2BctLSw%2BmjiY8nbSESHqC52W6fNy9cBb0pQ%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid within a network namespace">rigault.francois at gmail.com
       </A><BR>
    <I>Sun Apr 11 16:46:41 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023557.html">[squid-users] Cache Peers and traffic handling
</A></li>
        <LI>Next message (by thread): <A HREF="023545.html">[squid-users] Squid within a network namespace
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23537">[ date ]</a>
              <a href="thread.html#23537">[ thread ]</a>
              <a href="subject.html#23537">[ subject ]</a>
              <a href="author.html#23537">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Squid
I am running my development tools and VMs in a dedicated network
namespace on my laptop (through Linux &quot;netns&quot;), so they are fully
isolated from the rest of my network. I would like to set-up a proxy
so that if there is a need to connect to the outside, I could set-up
some fine grained ACL to open some very specific HTTP traffic. For
this to work with Squid, there must be a socket opened within the
namespace, while Squid is still running on the default namespace.

This can be achieved without modifying the code by using socat for
example, where a socat running within the namespace sends traffic to a
Unix socket, and another socat outside the namespace, reads from the
Unix socket, and sends the traffic to Squid... it's quite some
plumbing effort, and Squid won't be able to know from which VM the
traffic originates (the X-Forwarded-For is localhost)

Seeing that HAProxy implemented something
(<A HREF="https://github.com/haproxy/haproxy/commit/b3e54fe387c7c1ea750f39d3029672d640c499f9">https://github.com/haproxy/haproxy/commit/b3e54fe387c7c1ea750f39d3029672d640c499f9</A>)
so that the process moves into the namespace just for the time of the
socket creation, I came up with a similar change for Squid
(<A HREF="https://github.com/freedge/squid/commit/a778666d8f4760448e29e4a0cc75dcd305b40d02">https://github.com/freedge/squid/commit/a778666d8f4760448e29e4a0cc75dcd305b40d02</A>).

As this is a Linux only change, and also the community lived without
it so far, I am sending this mail to see if there is any interest in
this feature, if there was ever any request for it in the past?

Cheers!

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023557.html">[squid-users] Cache Peers and traffic handling
</A></li>
	<LI>Next message (by thread): <A HREF="023545.html">[squid-users] Squid within a network namespace
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23537">[ date ]</a>
              <a href="thread.html#23537">[ thread ]</a>
              <a href="subject.html#23537">[ subject ]</a>
              <a href="author.html#23537">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
