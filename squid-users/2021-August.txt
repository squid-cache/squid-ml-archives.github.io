From pheriko.support at gmail.com  Sun Aug  1 01:48:19 2021
From: pheriko.support at gmail.com (Periko Support)
Date: Sat, 31 Jul 2021 18:48:19 -0700
Subject: [squid-users] Squid caching webpages now days?
Message-ID: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>

Hello guys.

With today's ISP's speed increasing, does squid cache (caching web
pages) now days is a good option?

I have some customers that want to setup a cache server, but I have
doubts about how much traffic will be save, with most of the web sites
running under https.

I use squid+sg acl features.

But for me, caching  is not a bandwidth saving tool anymore.

Does caching still a good option with squid?

Regards!!!


From squid3 at treenet.co.nz  Sun Aug  1 14:15:45 2021
From: squid3 at treenet.co.nz (=?UTF-8?B?4oCqQW1vcyBKZWZmcmllc+KArA==?=)
Date: Mon, 02 Aug 2021 02:15:45 +1200
Subject: [squid-users] Squid caching webpages now days?
References: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
Message-ID: <-kh6a2u-w1uhic-lahnptqt531gz47oi1-h8uvar-e658lg2odek3-m6n1h6-jdxeo7pks21ikjvgj5-kitm65-t1yaju-ltkoa2f0lr03-migj3c-6ckeoe-1w9tf5-8aln5h-bwbbtp-t413c3-7ycl2fe0wxxu.1627827345293@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210802/f3d60f9a/attachment.htm>

From ml at netfence.it  Sun Aug  1 16:05:51 2021
From: ml at netfence.it (Andrea Venturoli)
Date: Sun, 1 Aug 2021 18:05:51 +0200
Subject: [squid-users] Squid caching webpages now days?
In-Reply-To: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
References: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
Message-ID: <03650db0-81e0-68e7-c85e-45c8a056878e@netfence.it>

On 8/1/21 3:48 AM, Periko Support wrote:

> with most of the web sites running under https.

SSL Bumping might help here.
Whether it's worth the hassle, legal, etc... depends on your situation.



> Does caching still a good option with squid?

Generally speaking, I find caching is nowadays mostly irrelevant.

However it can make a huge difference in some edge cases: I had a server 
distributing packages to several groups of machines and it was behind a 
very slow line.
Downloading the package once or several times would make the difference 
betweeen minutes and hours.

So YMMV.

  bye
	av.


From leolistas at solutti.com.br  Sun Aug  1 18:50:09 2021
From: leolistas at solutti.com.br (Leonardo Rodrigues)
Date: Sun, 1 Aug 2021 15:50:09 -0300
Subject: [squid-users] Squid caching webpages now days?
In-Reply-To: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
References: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
Message-ID: <bd8c4ffd-60dc-0e9e-e026-5064d4219efe@solutti.com.br>


Em 31/07/2021 22:48, Periko Support escreveu:
> Hello guys.
>
> With today's ISP's speed increasing, does squid cache (caching web
> pages) now days is a good option?
>
> I have some customers that want to setup a cache server, but I have
> doubts about how much traffic will be save, with most of the web sites
> running under https.
>
> I use squid+sg acl features.
>
> But for me, caching  is not a bandwidth saving tool anymore.
>

 ??? Of course, my experience is just MY experience and others might be 
completly different ones :) Speaking for myself, and for some small to 
medium sized customer networks I manage, caching is disabled for more 
than a decade now. Squid is still VERY useful for applying controls and 
loggings, but not caching.

-- 


	Atenciosamente / Sincerily,
	Leonardo Rodrigues
	Solutti Tecnologia
	http://www.solutti.com.br

	Minha armadilha de SPAM, N?O mandem email
	gertrudes at solutti.com.br
	My SPAMTRAP, do not email it





From squid3 at treenet.co.nz  Mon Aug  2 00:01:01 2021
From: squid3 at treenet.co.nz (=?UTF-8?B?4oCqQW1vcyBKZWZmcmllc+KArA==?=)
Date: Mon, 02 Aug 2021 12:01:01 +1200
Subject: [squid-users] Squid caching webpages now days?
References: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
 <bd8c4ffd-60dc-0e9e-e026-5064d4219efe@solutti.com.br>
Message-ID: <10kgvy-x03zxs-202vrc-qvnrs6ij0c7uxhxk5893x1l8-ci6p2vnhfx71x026us7etw2z-d2evo9-x5a70relp5sfovrdtd-9n0w3t-g77ih1-f32fl-8373q646lfubdk7wpayx4iy8wl1rqp5d2zw6.1627862461619@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210802/3e1778cc/attachment.htm>

From sachingupta at salesforce.com  Mon Aug  2 06:12:50 2021
From: sachingupta at salesforce.com (Sachin Gupta)
Date: Mon, 2 Aug 2021 11:42:50 +0530
Subject: [squid-users] host_verify_strict is not working as expected
Message-ID: <CADyKER4KjipMNjfDEC6Qf6VwS-TFfANBHVxgjq0hjbJG7E++-A@mail.gmail.com>

Hi All

I am using squid version 4.9. I did set host_verify_strict to on. As per
documentation in link
http://www.squid-cache.org/Doc/config/host_verify_strict The request should
fail if host header is different than uri.

I used this request and squid allowed the request though as per
documentaion, it should have returned 409. Can someone help. Logs are below.

curl -vvx 127.0.0.1:8080 -H "Host: https://route53.amazonaws.com"
https://ec2.amazonaws.com

* About to connect() to proxy 127.0.0.1 port 8080 (#0)

*   Trying 127.0.0.1...

* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)

* Establish HTTP proxy tunnel to ec2.amazonaws.com:443

> CONNECT ec2.amazonaws.com:443 HTTP/1.1

> User-Agent: curl/7.29.0

> Proxy-Connection: Keep-Alive

> Host: https://route53.amazonaws.com

>

< HTTP/1.1 200 Connection established

<

* Proxy replied OK to CONNECT request

* Initializing NSS with certpath: sql:/etc/pki/nssdb

*   CAfile: /etc/pki/tls/certs/ca-bundle.crt

  CApath: none

* SSL connection using TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA

* Server certificate:

* subject: CN=ec2.us-east-1.amazonaws.com

* start date: Jan 08 00:00:00 2021 GMT

* expire date: Jan 07 23:59:59 2022 GMT

* common name: ec2.us-east-1.amazonaws.com

* issuer: CN=Amazon,OU=Server CA 1B,O=Amazon,C=US

> GET / HTTP/1.1

> User-Agent: curl/7.29.0

> Accept: */*

> Host: https://route53.amazonaws.com

>

< HTTP/1.1 400 Bad Request

< Transfer-Encoding: chunked

< Date: Mon, 02 Aug 2021 06:07:25 GMT

< Connection: close

< Server: AmazonEC2


Thanks

Sachin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210802/1cf13b7b/attachment.htm>

From squid3 at treenet.co.nz  Tue Aug  3 01:38:11 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 3 Aug 2021 13:38:11 +1200
Subject: [squid-users] host_verify_strict is not working as expected
In-Reply-To: <CADyKER4KjipMNjfDEC6Qf6VwS-TFfANBHVxgjq0hjbJG7E++-A@mail.gmail.com>
References: <CADyKER4KjipMNjfDEC6Qf6VwS-TFfANBHVxgjq0hjbJG7E++-A@mail.gmail.com>
Message-ID: <9f7f6429-2c78-78d8-9e9c-4ef4c97b2f3c@treenet.co.nz>

On 2/08/21 6:12 pm, Sachin Gupta wrote:
> Hi All
> 
> I am using squid version 4.9. I did set?host_verify_strict to on. As per 
> documentation?in link 
> http://www.squid-cache.org/Doc/config/host_verify_strict 
> <http://www.squid-cache.org/Doc/config/host_verify_strict> The request 
> should fail if host header is different than uri.
> 
> I used this request and squid allowed the request though as per 
> documentaion, it should have returned?409. Can someone help. Logs are below.
> 

The reason you are getting 400 is that "https://..." is not a valid 
syntax for Host header. Syntax checks come first, before value checks.

Amos


From sachingupta at salesforce.com  Tue Aug  3 02:08:27 2021
From: sachingupta at salesforce.com (Sachin Gupta)
Date: Tue, 3 Aug 2021 07:38:27 +0530
Subject: [squid-users] host_verify_strict is not working as expected
In-Reply-To: <9f7f6429-2c78-78d8-9e9c-4ef4c97b2f3c@treenet.co.nz>
References: <CADyKER4KjipMNjfDEC6Qf6VwS-TFfANBHVxgjq0hjbJG7E++-A@mail.gmail.com>
 <9f7f6429-2c78-78d8-9e9c-4ef4c97b2f3c@treenet.co.nz>
Message-ID: <CADyKER7-0-VLjGG_22113T5PWhaQ1xH_ChQSnNVDDZy56kPFAw@mail.gmail.com>

400 is returned by the destination server, not squid. Squid did not perform
any validation on the host header.  As per
http://www.squid-cache.org/Doc/config/host_verify_strict, it should have
done that and failure should have been returned by squid.

Regards
Sachin

On Tue, Aug 3, 2021 at 7:11 AM Amos Jeffries <squid3 at treenet.co.nz> wrote:

> On 2/08/21 6:12 pm, Sachin Gupta wrote:
> > Hi All
> >
> > I am using squid version 4.9. I did set host_verify_strict to on. As per
> > documentation in link
> >
> https://urldefense.com/v3/__http://www.squid-cache.org/Doc/config/host_verify_strict__;!!DCbAVzZNrAf4!Vapjg86Hjy8hbBI_mXJ-JQZ1thI84Svu6LIsVzY4dGeRPgG-Oqhf8suS82ytxtcdjVru$
>
> > <
> https://urldefense.com/v3/__http://www.squid-cache.org/Doc/config/host_verify_strict__;!!DCbAVzZNrAf4!Vapjg86Hjy8hbBI_mXJ-JQZ1thI84Svu6LIsVzY4dGeRPgG-Oqhf8suS82ytxtcdjVru$
> > The request
> > should fail if host header is different than uri.
> >
> > I used this request and squid allowed the request though as per
> > documentaion, it should have returned 409. Can someone help. Logs are
> below.
> >
>
> The reason you are getting 400 is that "https://..." is not a valid
> syntax for Host header. Syntax checks come first, before value checks.
>
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
>
> https://urldefense.com/v3/__http://lists.squid-cache.org/listinfo/squid-users__;!!DCbAVzZNrAf4!Vapjg86Hjy8hbBI_mXJ-JQZ1thI84Svu6LIsVzY4dGeRPgG-Oqhf8suS82ytxqPemPUE$
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210803/4d43cdc6/attachment.htm>

From leolistas at solutti.com.br  Tue Aug  3 11:11:30 2021
From: leolistas at solutti.com.br (Leonardo Rodrigues)
Date: Tue, 3 Aug 2021 08:11:30 -0300
Subject: [squid-users] Squid caching webpages now days?
In-Reply-To: <10kgvy-x03zxs-202vrc-qvnrs6ij0c7uxhxk5893x1l8-ci6p2vnhfx71x026us7etw2z-d2evo9-x5a70relp5sfovrdtd-9n0w3t-g77ih1-f32fl-8373q646lfubdk7wpayx4iy8wl1rqp5d2zw6.1627862461619@email.android.com>
References: <CAK2yrTYBvrj-b+zLOq86fxVEf9dnp+nwrxRTqm4c8-c90Q9tUw@mail.gmail.com>
 <bd8c4ffd-60dc-0e9e-e026-5064d4219efe@solutti.com.br>
 <10kgvy-x03zxs-202vrc-qvnrs6ij0c7uxhxk5893x1l8-ci6p2vnhfx71x026us7etw2z-d2evo9-x5a70relp5sfovrdtd-9n0w3t-g77ih1-f32fl-8373q646lfubdk7wpayx4iy8wl1rqp5d2zw6.1627862461619@email.android.com>
Message-ID: <27c6c094-8bbd-6094-0037-77f1cc1d5f82@solutti.com.br>

Em 01/08/2021 21:01, Amos Jeffries escreveu:
> Leonardo, it sounds like your decades ago decision was before squid 
> gained full HTTP/1.1 caching ability. 1.0-only abilities are almost 
> useless today.
>
> Are you at least still using memory cache? That is squid configured 
> without cache_dir but also without "cache deny" rule.

 ??? Hi Amos,

 ??? You're spot on, I clearly remember to have decided that (to stop 
caching) before full HTTP/1.1 support days. I have not actually tried 
memory cache for a while, but not because it wasn't working as expected 
or effective, it's mainly because i'm not managing those services on 
networks large enough for caching to bring real beneficts.

-- 


	Atenciosamente / Sincerily,
	Leonardo Rodrigues
	Solutti Tecnologia
	http://www.solutti.com.br

	Minha armadilha de SPAM, N?O mandem email
	gertrudes at solutti.com.br
	My SPAMTRAP, do not email it





From rousskov at measurement-factory.com  Tue Aug  3 20:04:33 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 3 Aug 2021 16:04:33 -0400
Subject: [squid-users] SSL handshake
In-Reply-To: <1801674111.532776.1627466080421@mail.yahoo.com>
References: <765298140.229491.1627400752633.ref@mail.yahoo.com>
 <765298140.229491.1627400752633@mail.yahoo.com>
 <8f090d6c-645a-f71f-3c2f-e72a1f33c3ed@gmail.com>
 <1801674111.532776.1627466080421@mail.yahoo.com>
Message-ID: <2553e2c6-b37a-0a9d-3514-2f59409c5ebd@measurement-factory.com>

FWIW, Factory can reproduce this (popular origin server) problem with
and without Squid. We are adding a Squid enhancement that will work
around the problem (and improve TLS support in general).

Alex.

> curl: (35) error:1423506E:SSL routines:ssl_next_proto_validate:bad extension



From Loucansky.Lukas at kjj.cz  Wed Aug  4 10:55:14 2021
From: Loucansky.Lukas at kjj.cz (=?iso-8859-2?B?TG916GFuc2v9IEx1a+G5?=)
Date: Wed, 4 Aug 2021 12:55:14 +0200
Subject: [squid-users] Compile SQUID 5.1 on Debian 10
Message-ID: <72DD5D5CF661B5459DC08A060BF26B53C45B95@kjj-server.KJJ.local>

Hello,
I was going to run ./configure and make all for a freshly downloaded Squid 5.1 on my current Squid 4.x rig, which  so far goes all right with Squid 4.x. The configure script went without errors, but make all stops on the missing tests directory in the src/icmp, src/tools and src/tools/squidclient. After creating the tests dirs in the named directories - the make all script went on.

My configure call runs like this:

./configure --build=x86_64-linux-gnu \
--prefix=/usr \
--includedir=${prefix}/include \
--mandir=${prefix}/share/man \
--infodir=${prefix}/share/info \
--sysconfdir=/etc \
--localstatedir=/var \
--libexecdir=${prefix}/lib/squid5 \
--srcdir=. \
--disable-maintainer-mode \
--disable-dependency-tracking \
--disable-silent-rules \
--datadir=/usr/share/squid5 \
--sysconfdir=/etc/squid5 \
--mandir=/usr/share/man \
--enable-inline \
--disable-arch-native \
--enable-async-io=8 \
--enable-storeio=ufs,aufs,diskd,rock \
--enable-removal-policies=lru,heap \
--enable-delay-pools \
--enable-cache-digests \
--enable-icap-client \
--enable-follow-x-forwarded-for \
--enable-auth-basic=DB,fake,getpwnam,LDAP,NCSA,NIS,PAM,POP3,RADIUS,SASL,SMB \
--enable-auth-digest=file,LDAP \
--enable-auth-negotiate=kerberos,wrapper \
--enable-auth-ntlm=fake,SMB_LM \
--enable-external-acl-helpers=file_userip,kerberos_ldap_group,LDAP_group,session,SQL_session,time_quota,unix_group,wbinfo_group \
--enable-url-rewrite-helpers=fake \
--enable-security-cert-validators=fake \
--enable-storeid-rewrite-helpers=file \
--enable-eui \
--enable-esi \
--enable-icmp \
--enable-zph-qos \
--enable-ecap \
--enable-snmp \
--disable-translation \
--with-swapdir=/var/spool/squid5 \
--with-logdir=/var/log/squid5 \
--with-pidfile=/var/run/squid5.pid \
--with-filedescriptors=65536 \
--with-large-files \
--with-default-user=proxy \
--with-openssl \
--enable-ssl-crtd \
--enable-security-cert-generators \
--enable-security-cert-validators \
--enable-linux-netfilter \
'PKG_CONFIG_PATH=:/usr/local/lib/pkgconfig:/usr/lib64/pkgconfig:/usr/share/pkgconfig' \
'CFLAGS=-g -O2 -m64 -fPIE -fstack-protector-strong -Wformat -Werror=format-security -Wall' \
'LDFLAGS=-fPIE -pie -Wl,-z,relro -Wl,-z,now' \
'CPPFLAGS=-D_FORTIFY_SOURCE=2' \
'CXXFLAGS=-g -O2 -m64 -fPIE -fstack-protector-strong -Wformat -Werror=format-security'

Could not find anything about this at http://www.squid-cache.org/Versions/v5/squid-5.1-RELEASENOTES.html#s4 - Do I need to create these dirs myself / eg. missing by source code or by make script?
LL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210804/c66d9bcc/attachment.htm>

From squid3 at treenet.co.nz  Wed Aug  4 17:44:00 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 5 Aug 2021 05:44:00 +1200
Subject: [squid-users] Compile SQUID 5.1 on Debian 10
In-Reply-To: <72DD5D5CF661B5459DC08A060BF26B53C45B95@kjj-server.KJJ.local>
References: <72DD5D5CF661B5459DC08A060BF26B53C45B95@kjj-server.KJJ.local>
Message-ID: <f17a272d-a036-3cf0-6ee8-47adc7c331c8@treenet.co.nz>

On 4/08/21 10:55 pm, Lou?ansk? Luk?? wrote:
> Hello,
> I was going to run ./configure and make all for a freshly downloaded 
> Squid 5.1 on my current Squid 4.x rig, which? so far goes all right with 
> Squid 4.x. The configure script went without errors, but make all stops 
> on the missing tests directory in the src/icmp, src/tools and 
> src/tools/squidclient. After creating the tests dirs in the named 
> directories - the make all script went on.
> 

Thank you for the ./configure inputs. I have finally been able to 
replicate it myself :)


For now, removing these build options works:

  --srcdir=. --disable-dependency-tracking


Amos


From frio_cervesa at hotmail.com  Sun Aug  8 05:48:45 2021
From: frio_cervesa at hotmail.com (senor)
Date: Sun, 8 Aug 2021 05:48:45 +0000
Subject: [squid-users] SSL handshake
In-Reply-To: <2553e2c6-b37a-0a9d-3514-2f59409c5ebd@measurement-factory.com>
References: <765298140.229491.1627400752633.ref@mail.yahoo.com>
 <765298140.229491.1627400752633@mail.yahoo.com>
 <8f090d6c-645a-f71f-3c2f-e72a1f33c3ed@gmail.com>
 <1801674111.532776.1627466080421@mail.yahoo.com>,
 <2553e2c6-b37a-0a9d-3514-2f59409c5ebd@measurement-factory.com>
Message-ID: <DM6PR01MB4969FC8B7554F914D507AC40F7F59@DM6PR01MB4969.prod.exchangelabs.com>

Wireshark flags the next protocol extension as malformed coming from (popular origin server).

Alex - Can you point to a patch under test or other changes that we can use to alleviate this pain?

The extension is included in the Server Hello due to it being included in the Client Hello. I was hoping there was a way to use tls_outgoing_options but I don't see any relevant options. I think I can comment it out in Handshake.cc but is there a run-time option?

Thanks

________________________________________
From: squid-users <squid-users-bounces at lists.squid-cache.org> on behalf of Alex Rousskov <rousskov at measurement-factory.com>
Sent: Tuesday, August 3, 2021 1:04 PM
To: squid-users at lists.squid-cache.org
Subject: Re: [squid-users] SSL handshake

FWIW, Factory can reproduce this (popular origin server) problem with
and without Squid. We are adding a Squid enhancement that will work
around the problem (and improve TLS support in general).

Alex.

> curl: (35) error:1423506E:SSL routines:ssl_next_proto_validate:bad extension

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users


From robertkwild at gmail.com  Tue Aug 10 16:56:24 2021
From: robertkwild at gmail.com (robert k Wild)
Date: Tue, 10 Aug 2021 17:56:24 +0100
Subject: [squid-users] no ssl intercept - question how it works
Message-ID: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>

hi all,

before i continue, so sorry for the stupid question but trying to learn

basically heres my squid.conf

#NO SSL Interception
acl DiscoverSNIHost at_step SslBump1
acl NoSSLIntercept ssl::server_name
"/usr/local/squid/etc/nointerceptssl.txt"
ssl_bump splice NoSSLIntercept
ssl_bump peek DiscoverSNIHost
ssl_bump bump all

#SSL Bump
http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/myCA.pem
generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s
/var/lib/ssl_db -M 4MB
acl step1 at_step SslBump1
ssl_bump peek step1
ssl_bump bump all
#
#allow special URL paths
acl special_url url_regex "/usr/local/squid/etc/urlspecial.txt"

#deny MIME types
acl mimetype rep_mime_type "/usr/local/squid/etc/mimedeny.txt"

http_reply_access allow special_url
http_reply_access deny mimetype
#
#HTTP_HTTPS whitelist websites
acl whitelist ssl::server_name "/usr/local/squid/etc/urlwhite.txt"

#HTTP_HTTPS whitelist websites regex
acl whitelistreg ssl::server_name_regex
"/usr/local/squid/etc/urlregwhite.txt"

http_access allow activation whitelist
http_access allow activation whitelistreg
http_access deny all

in my urlwhitelist is this

#apple app store
.p18-buy.itunes.apple.com
.gsas.apple.com
.se-edge.itunes.apple.com
.ocsp2.apple.com
.gsa.apple.com
.osxapps.itunes.apple.com
.xp.apple.com
.search.itunes.apple.com
.apptrailers-ssl.itunes.apple.com
.apptrailers.itunes.apple.com
.configuration.apple.com
.amp-api.apps.apple.com
.buy.itunes.apple.com
.api-edge.apps.apple.com
.play.itunes.apple.com
.s.mzstatic.com
.sf-api-token-service.itunes.apple.com
.apps.mzstatic.com
.init.itunes.apple.com
.bag.itunes.apple.com

in my nointerceptssl is this

#apple app store
.bag.itunes.apple.com
.apps.mzstatic.com
.play.itunes.apple.com
.api-edge.apps.apple.com
.amp-api.apps.apple.com
.xp.apple.com
.p18-buy.itunes.apple.com

i got all the urls etc looking at tail -f access.log and greping the ip and
tcp denied

but when i try to load the apple app store the whitelist isnt enough, i
need to add a couple of urls to the nointerceptssl

i got that list by doing the same method ie  looking at tail -f access.log
and greping the ip but as ive already whitelisted the urls they all came
back as none or ok instead of saying tcp denied

my question is why do i need to add some urls to the nointerceptssl and why
isnt it enough just to add it to urlwhite list

rob

-- 
Regards,

Robert K Wild.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210810/a7539bb9/attachment.htm>

From rousskov at measurement-factory.com  Tue Aug 10 17:44:19 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Tue, 10 Aug 2021 13:44:19 -0400
Subject: [squid-users] SSL handshake
In-Reply-To: <DM6PR01MB4969FC8B7554F914D507AC40F7F59@DM6PR01MB4969.prod.exchangelabs.com>
References: <765298140.229491.1627400752633.ref@mail.yahoo.com>
 <765298140.229491.1627400752633@mail.yahoo.com>
 <8f090d6c-645a-f71f-3c2f-e72a1f33c3ed@gmail.com>
 <1801674111.532776.1627466080421@mail.yahoo.com>
 <2553e2c6-b37a-0a9d-3514-2f59409c5ebd@measurement-factory.com>
 <DM6PR01MB4969FC8B7554F914D507AC40F7F59@DM6PR01MB4969.prod.exchangelabs.com>
Message-ID: <363354ab-b1b7-9d94-015d-127df533f5cf@measurement-factory.com>

On 8/8/21 1:48 AM, senor wrote:

> Can you point to a patch under test or other changes that we can use
> to alleviate this pain?

I will probably regret sharing this unfinished work, but our current
changes can be found at [1]. A Factory customer has reported successful
deployment, but the changes still need a lot of work; the results are
not ready for review of any kind. Also, we do not have enough free
cycles to port those in-progress changes to your current Squid version,
whatever it is.

[1] https://github.com/measurement-factory/squid/commit/16a3534

As always, we will post the fix for the official review ASAP. My current
ballpark ETA for that is ~6 weeks.


HTH,

Alex.



> From: squid-users <squid-users-bounces at lists.squid-cache.org> on behalf of Alex Rousskov <rousskov at measurement-factory.com>
> Sent: Tuesday, August 3, 2021 1:04 PM
> To: squid-users at lists.squid-cache.org
> Subject: Re: [squid-users] SSL handshake
> 
> FWIW, Factory can reproduce this (popular origin server) problem with
> and without Squid. We are adding a Squid enhancement that will work
> around the problem (and improve TLS support in general).
> 
> Alex.
> 
>> curl: (35) error:1423506E:SSL routines:ssl_next_proto_validate:bad extension
> 
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> 



From frio_cervesa at hotmail.com  Tue Aug 10 23:11:52 2021
From: frio_cervesa at hotmail.com (senor)
Date: Tue, 10 Aug 2021 23:11:52 +0000
Subject: [squid-users] SSL handshake
In-Reply-To: <363354ab-b1b7-9d94-015d-127df533f5cf@measurement-factory.com>
References: <765298140.229491.1627400752633.ref@mail.yahoo.com>
 <765298140.229491.1627400752633@mail.yahoo.com>
 <8f090d6c-645a-f71f-3c2f-e72a1f33c3ed@gmail.com>
 <1801674111.532776.1627466080421@mail.yahoo.com>
 <2553e2c6-b37a-0a9d-3514-2f59409c5ebd@measurement-factory.com>
 <DM6PR01MB4969FC8B7554F914D507AC40F7F59@DM6PR01MB4969.prod.exchangelabs.com>,
 <363354ab-b1b7-9d94-015d-127df533f5cf@measurement-factory.com>
Message-ID: <DM8PR01MB7016C8ABFF2BE01A61D13070F7F79@DM8PR01MB7016.prod.exchangelabs.com>

Alex - Thank you. I should have found that. I think the risks of using this should be clear enough to all. Appreciate the work as always.

Thanks

________________________________________
From: squid-users <squid-users-bounces at lists.squid-cache.org> on behalf of Alex Rousskov <rousskov at measurement-factory.com>
Sent: Tuesday, August 10, 2021 10:44 AM
To: squid-users at lists.squid-cache.org
Subject: Re: [squid-users] SSL handshake

On 8/8/21 1:48 AM, senor wrote:

> Can you point to a patch under test or other changes that we can use
> to alleviate this pain?

I will probably regret sharing this unfinished work, but our current
changes can be found at [1]. A Factory customer has reported successful
deployment, but the changes still need a lot of work; the results are
not ready for review of any kind. Also, we do not have enough free
cycles to port those in-progress changes to your current Squid version,
whatever it is.

[1] https://github.com/measurement-factory/squid/commit/16a3534

As always, we will post the fix for the official review ASAP. My current
ballpark ETA for that is ~6 weeks.


HTH,

Alex.



> From: squid-users <squid-users-bounces at lists.squid-cache.org> on behalf of Alex Rousskov <rousskov at measurement-factory.com>
> Sent: Tuesday, August 3, 2021 1:04 PM
> To: squid-users at lists.squid-cache.org
> Subject: Re: [squid-users] SSL handshake
>
> FWIW, Factory can reproduce this (popular origin server) problem with
> and without Squid. We are adding a Squid enhancement that will work
> around the problem (and improve TLS support in general).
>
> Alex.
>
>> curl: (35) error:1423506E:SSL routines:ssl_next_proto_validate:bad extension
>
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users


From squid3 at treenet.co.nz  Wed Aug 11 05:44:42 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Wed, 11 Aug 2021 17:44:42 +1200
Subject: [squid-users] no ssl intercept - question how it works
In-Reply-To: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>
References: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>
Message-ID: <0a66fced-02cd-b9aa-b260-235d5e501032@treenet.co.nz>

On 11/08/21 4:56 am, robert k Wild wrote:
> hi all,
> 
> before i continue, so sorry for the stupid question but trying to learn
> 
> basically heres my squid.conf
> 
> #NO SSL Interception
> acl DiscoverSNIHost at_step SslBump1
> acl NoSSLIntercept ssl::server_name 
> "/usr/local/squid/etc/nointerceptssl.txt"
> ssl_bump splice NoSSLIntercept
> ssl_bump peek DiscoverSNIHost
> ssl_bump bump all
> 
> #SSL Bump
> http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/myCA.pem 
> generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
> sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s 
> /var/lib/ssl_db -M 4MB

Note:

  You already have ssl_bump rules above which either splice or bump at 
step 1. These following ssl_bump rule either never get reached, or are 
already known impossible to perform if they do get reached.


> acl step1 at_step SslBump1
> ssl_bump peek step1
> ssl_bump bump all
> #
> #allow special URL paths
> acl special_url url_regex "/usr/local/squid/etc/urlspecial.txt"
> 
> #deny MIME types
> acl mimetype rep_mime_type "/usr/local/squid/etc/mimedeny.txt"
> 
> http_reply_access allow special_url
> http_reply_access deny mimetype
> #
> #HTTP_HTTPS whitelist websites
> acl whitelist ssl::server_name "/usr/local/squid/etc/urlwhite.txt"
> 
> #HTTP_HTTPS whitelist websites regex
> acl whitelistreg ssl::server_name_regex 
> "/usr/local/squid/etc/urlregwhite.txt"
> 
> http_access allow activation whitelist
> http_access allow activation whitelistreg
> http_access deny all
> 
> in my urlwhitelist is this
> 
...
> in my nointerceptssl is this
> 
...

> 
> i got all the urls etc looking at tail -f access.log and greping the ip 
> and tcp denied
> 
> but when i try to load the apple app store the whitelist isnt enough, i 
> need to add a couple of urls to the nointerceptssl
> 
> i got that list by doing the same method ie looking at tail -f 
> access.log and greping the ip but as ive already whitelisted the urls 
> they all came back as none or ok instead of saying tcp denied
> 
> my question is why do i need to add some urls to the nointerceptssl and 
> why isnt it enough just to add it to urlwhite list
> 

Because you are using those ACLs exclusively for very different things.

  - "whitelist" is being exclusively used to check URI domains found in 
HTTP messages (http_access). Where "server name" is the CONNECT tunnel 
authority name or IPs reverse-DNS name, or decrypted https:// URL 
domain. It has nothing to do with the TLS handshake activity.

  - "NoSSLIntercept" is being exclusively used for TLS handshake 
decisions (ssl_bump). Where "server name" is the CONNECT tunnel 
authority name or raw-IP, TLS SNI, or server certificate altSubjectName.


You could use whitelist ACL in ssl_bump checks instead of 
NoSSLIntercept. At which point the ACL is now being used for both sets 
of checks and decisions.


Amos


From Loucansky.Lukas at kjj.cz  Wed Aug 11 06:43:44 2021
From: Loucansky.Lukas at kjj.cz (=?windows-1250?B?TG916GFuc2v9IEx1a+Ga?=)
Date: Wed, 11 Aug 2021 08:43:44 +0200
Subject: [squid-users] squid 5.1 missing ENTRY_REQUIRES_COLLAPSING
Message-ID: <72DD5D5CF661B5459DC08A060BF26B53010896FB@kjj-server.KJJ.local>

Hello,
just rolled out squid 5.1 into production machine and got several of
 
2021/08/11 08:10:45 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f34ceba10*0
    current master transaction: master55
2021/08/11 08:10:48 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f34e7f030*0
    current master transaction: master55
2021/08/11 08:10:49 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f3448d400*0
    current master transaction: master55
2021/08/11 08:10:51 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f375bb810*0
    current master transaction: master55
2021/08/11 08:10:59 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr9536=V/0x556f36dace30*0
    current master transaction: master55

 
kids 1 to 4 are workers. I Was using {process_number} macro to create separate aufs cache_dirs for each worker process, recently have changed to one more rock storage. ie no aufs cache_dirs - only rock with different max-size and slot size. However I'm using {process_number} macro to run store_id_program for each worker - like this
 
#worker1
if ${process_number} = 1
store_id_program /lib/squid5/storeid_file_rewrite /etc/squid5/acl/storeid_rewrite.conf
store_id_children 4 startup=1 idle=1 concurrency=0
acl noStoreID url_regex "/etc/squid5/acl/storeid.whitelist"
store_id_access deny noStoreID
store_id_access allow all
endif

etc. for other workers.
 
 
Seems connected with downloading of MS updates from:
2021/08/11 08:05:04 kid2| ctx: enter level  0: 'http://9.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/c11c61e1-2c71-4bdc-be53-3c44d1d491f8?P1=1628662587&P2=404&P3=2&P4=AFBNnEb3I1J1i2txgqn9sgKDx6g4wu4Nk8w9MYCvYZqnQg%2fWduDXekI58E264AhA3%2fpZmM5%2b2%2fPFmER9Vr8xnw%3d%3d'
2021/08/11 08:05:04 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr15985=V/0x556f3450d800*0
    current master transaction: master55
2021/08/11 08:05:38 kid2| ctx: exit level  0
2021/08/11 08:05:38 kid2| ctx: enter level  0: 'http://2.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/696b26de-18b8-4bd4-8b77-f7f700102951?P1=1628667955&P2=404&P3=2&P4=B6QCKlBJwUdlz1WE9pHnSFs1fgTTOrjLFl%2fAsdkytWDzyqVeKXqCfdO7IocO2%2bbE1RVMyU7whVyM7iM8MSTs1g%3d%3d'
2021/08/11 08:05:38 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr12742=V/0x556f373e32d0*0
    current master transaction: master55
2021/08/11 08:09:18 kid2| ctx: exit level  0
2021/08/11 08:09:18 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f35068920*0
    current master transaction: master55

storeid_rewrite.conf entry for microsoft.com looks like
^https?:\/\/.+?\.ws\.microsoft\.com\/.+?_([0-9a-z]{40})\.(cab|exe|ms[i|u|f]|asf|wm[v|a]|dat|zip|psf|appx)       http://wupdate.squid.local/$1

Several of 2021/08/10 08:46:54 kid2| assertion failed: Controller.cc:930: "!transients || e.hasTransients()" have been logged yesterday, but none since I swapped to all-rocks.

I'm going to change my config to remove store_id configuration for each worker and instead run it without {process_number} macros. I;m not sure why I did it - I tried to conserver resources - like filedescriptors allocation, dns cache entries etc. not important for diskers - so I created these macro statements to allocate it only for workers.

THX
LL 


From moberger at metanetworks.com  Wed Aug 11 08:51:52 2021
From: moberger at metanetworks.com (Moti Berger)
Date: Wed, 11 Aug 2021 11:51:52 +0300
Subject: [squid-users] Log to statsd
Message-ID: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>

Hi

Is there a way to configure Squid to output the logs to statsd rather than
a file?
Today I have this:

> +logformat my_metrics      %icap::tt %<pt %tr
> +access_log daemon:/var/log/squid/my_metrics.log my_metrics
>

However I would like to avoid the overhead in parsing the log file by using
statsd or something similar.

Thanks,
Moti
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210811/ec8594a8/attachment.htm>

From shadowpilot34 at gmail.com  Wed Aug 11 09:45:04 2021
From: shadowpilot34 at gmail.com (His Shadow)
Date: Wed, 11 Aug 2021 12:45:04 +0300
Subject: [squid-users] Log to statsd
In-Reply-To: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
References: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
Message-ID: <CAK7W0xdDBjz8hH7j7g9ssyHto3x-ESRL3ESW8ZQPerHuZCf8EQ@mail.gmail.com>

You can write your own logger daemon that would dump stuff directly to
statsd. I've done it myself to send logs to logstash.


From david at articatech.com  Wed Aug 11 09:56:17 2021
From: david at articatech.com (David Touzeau)
Date: Wed, 11 Aug 2021 11:56:17 +0200
Subject: [squid-users] Log to statsd
In-Reply-To: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
References: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
Message-ID: <8481e955-f90f-f397-77c2-b80be39077d8@articatech.com>

Basically syslogd can do what you want : send via TCP, HTTP, UDP

So the deal is to use

logformat my_metrics ? ?? [statsd] %icap::tt %<pt %tr
icap_log: syslog:local6.info my_metrics

and add a file inside /etc/rsyslog.d/icap_metrics.conf



 ?if? ($programname =='squid') then {
 ??? ???? if ($msg contains "[statsd]") then {
 ??? ??? action(type="omfwd" Target="x.x.x.x" Port="1825" Protocol="tcp")
 ??? ??? }
 ??? ??? & stop
}



Le 11/08/2021 ? 10:51, Moti Berger a ?crit?:
> Hi
>
> Is there a way to configure Squid to output the logs to statsd rather 
> than a file?
> Today I have this:
>
>     +logformat my_metrics ?%icap::tt %<pt %tr
>     +access_log daemon:/var/log/squid/my_metrics.log my_metrics
>
>
> However I would like to avoid the overhead in parsing the log file by 
> using statsd or something similar.
>
> Thanks,
> Moti
>
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210811/f05b4ece/attachment.htm>

From squid3 at treenet.co.nz  Wed Aug 11 13:26:21 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 12 Aug 2021 01:26:21 +1200
Subject: [squid-users] Log to statsd
In-Reply-To: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
References: <CAGSk-43R8AwcQ9YUPuzt+oG=p383yghqyaHg7yAxnCon4TX19g@mail.gmail.com>
Message-ID: <d6118b17-9370-60ea-ebf5-1dee24915619@treenet.co.nz>

On 11/08/21 8:51 pm, Moti Berger wrote:
> Hi
> 
> Is there a way to configure Squid to output the logs to statsd rather 
> than a file?

Squid can send log lines to any TCP or UDP receiver which is able to 
handle line-oriented records. AFAIK statsd is one such agent.


> Today I have this:
> 
>     +logformat my_metrics ? ? ?%icap::tt %<pt %tr
>     +access_log daemon:/var/log/squid/my_metrics.log my_metrics
> 

Say you have the statsd configured to receive on localhost port 1234.

That would be configured in squid.conf as:

  access_log tcp://localhost:1234 my_metrics


Since I don't know what input your statsd is expecting I am not able to 
provide a logformat right now. But since you are already parsing and 
converting the file it should not be too hard to figure out yourself.


Amos


From rousskov at measurement-factory.com  Wed Aug 11 15:18:01 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Wed, 11 Aug 2021 11:18:01 -0400
Subject: [squid-users] squid 5.1 missing ENTRY_REQUIRES_COLLAPSING
In-Reply-To: <72DD5D5CF661B5459DC08A060BF26B53010896FB@kjj-server.KJJ.local>
References: <72DD5D5CF661B5459DC08A060BF26B53010896FB@kjj-server.KJJ.local>
Message-ID: <8afebc6e-a430-d6d7-d14c-558b777c874d@measurement-factory.com>

On 8/11/21 2:43 AM, Lou?ansk? Luk?? wrote:

> just rolled out squid 5.1 into production machine and got several of
>  
> 2021/08/11 08:10:45 kid2| BUG: missing ENTRY_REQUIRES_COLLAPSING for e:tr4315=V/0x556f34ceba10*0

I recommend filing a bug report with Squid Bugzilla. If possible, share
a compressed ALL,9 cache log reproducing the BUG with few transactions.


Thank you,

Alex.


From robertkwild at gmail.com  Wed Aug 11 16:06:00 2021
From: robertkwild at gmail.com (robert k Wild)
Date: Wed, 11 Aug 2021 17:06:00 +0100
Subject: [squid-users] no ssl intercept - question how it works
In-Reply-To: <0a66fced-02cd-b9aa-b260-235d5e501032@treenet.co.nz>
References: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>
 <0a66fced-02cd-b9aa-b260-235d5e501032@treenet.co.nz>
Message-ID: <CAGU_CiJJnMoYwYZa04z2yv1xtZhL_1GqBZ7a9-jF1ZSo=ZF3rw@mail.gmail.com>

Great thanks Amos as always

So shall I leave this ssl bump lines in

ssl_bump splice NoSSLIntercept
> ssl_bump peek DiscoverSNIHost
> ssl_bump bump all

And delete this one

acl step1 at_step SslBump1
> ssl_bump peek step1
> ssl_bump bump all

As your right there both the same, I didn't spot that

My understanding is the "no ssl intercept", squid doesn't even bother to
inspect the packets ie man in the middle and just literally passes it
straight to the client

Is that right?

Thanks,
Rob


On Wed, 11 Aug 2021, 06:48 Amos Jeffries, <squid3 at treenet.co.nz> wrote:

> On 11/08/21 4:56 am, robert k Wild wrote:
> > hi all,
> >
> > before i continue, so sorry for the stupid question but trying to learn
> >
> > basically heres my squid.conf
> >
> > #NO SSL Interception
> > acl DiscoverSNIHost at_step SslBump1
> > acl NoSSLIntercept ssl::server_name
> > "/usr/local/squid/etc/nointerceptssl.txt"
> > ssl_bump splice NoSSLIntercept
> > ssl_bump peek DiscoverSNIHost
> > ssl_bump bump all
> >
> > #SSL Bump
> > http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/myCA.pem
> > generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
> > sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s
> > /var/lib/ssl_db -M 4MB
>
> Note:
>
>   You already have ssl_bump rules above which either splice or bump at
> step 1. These following ssl_bump rule either never get reached, or are
> already known impossible to perform if they do get reached.
>
>
> > acl step1 at_step SslBump1
> > ssl_bump peek step1
> > ssl_bump bump all
> > #
> > #allow special URL paths
> > acl special_url url_regex "/usr/local/squid/etc/urlspecial.txt"
> >
> > #deny MIME types
> > acl mimetype rep_mime_type "/usr/local/squid/etc/mimedeny.txt"
> >
> > http_reply_access allow special_url
> > http_reply_access deny mimetype
> > #
> > #HTTP_HTTPS whitelist websites
> > acl whitelist ssl::server_name "/usr/local/squid/etc/urlwhite.txt"
> >
> > #HTTP_HTTPS whitelist websites regex
> > acl whitelistreg ssl::server_name_regex
> > "/usr/local/squid/etc/urlregwhite.txt"
> >
> > http_access allow activation whitelist
> > http_access allow activation whitelistreg
> > http_access deny all
> >
> > in my urlwhitelist is this
> >
> ...
> > in my nointerceptssl is this
> >
> ...
>
> >
> > i got all the urls etc looking at tail -f access.log and greping the ip
> > and tcp denied
> >
> > but when i try to load the apple app store the whitelist isnt enough, i
> > need to add a couple of urls to the nointerceptssl
> >
> > i got that list by doing the same method ie looking at tail -f
> > access.log and greping the ip but as ive already whitelisted the urls
> > they all came back as none or ok instead of saying tcp denied
> >
> > my question is why do i need to add some urls to the nointerceptssl and
> > why isnt it enough just to add it to urlwhite list
> >
>
> Because you are using those ACLs exclusively for very different things.
>
>   - "whitelist" is being exclusively used to check URI domains found in
> HTTP messages (http_access). Where "server name" is the CONNECT tunnel
> authority name or IPs reverse-DNS name, or decrypted https:// URL
> domain. It has nothing to do with the TLS handshake activity.
>
>   - "NoSSLIntercept" is being exclusively used for TLS handshake
> decisions (ssl_bump). Where "server name" is the CONNECT tunnel
> authority name or raw-IP, TLS SNI, or server certificate altSubjectName.
>
>
> You could use whitelist ACL in ssl_bump checks instead of
> NoSSLIntercept. At which point the ACL is now being used for both sets
> of checks and decisions.
>
>
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210811/a859d628/attachment.htm>

From squid3 at treenet.co.nz  Thu Aug 12 03:01:26 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Thu, 12 Aug 2021 15:01:26 +1200
Subject: [squid-users] no ssl intercept - question how it works
In-Reply-To: <CAGU_CiJJnMoYwYZa04z2yv1xtZhL_1GqBZ7a9-jF1ZSo=ZF3rw@mail.gmail.com>
References: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>
 <0a66fced-02cd-b9aa-b260-235d5e501032@treenet.co.nz>
 <CAGU_CiJJnMoYwYZa04z2yv1xtZhL_1GqBZ7a9-jF1ZSo=ZF3rw@mail.gmail.com>
Message-ID: <de66871f-f2d5-4d95-367c-cc891e04d0e9@treenet.co.nz>

On 12/08/21 4:06 am, robert k Wild wrote:
> Great thanks Amos as always
> 
> So shall I leave this ssl bump lines in
> 
> ssl_bump splice NoSSLIntercept
>> ssl_bump peek DiscoverSNIHost
>> ssl_bump bump all
> 
> And delete this one
> 
> acl step1 at_step SslBump1
>> ssl_bump peek step1
>> ssl_bump bump all
> 
> As your right there both the same, I didn't spot that
> 
> My understanding is the "no ssl intercept", squid doesn't even bother to 
> inspect the packets ie man in the middle and just literally passes it 
> straight to the client
> 
> Is that right?
> 

Not quite. Squid still has to receive and look at something to make the 
decision to splice.

The "NoSSLIntercept" is just an ACL. Being defined as a ssl:server_name 
type it looks at whatever Squid is able to find for a server name 
amongst the available data (CONNECT message URI, the client IP's 
reverse-DNS, any TLS details seen so far, etc.
  So it depends on how many of the SSL-Bump steps have taken place so 
far as to what it can match against.

In your case it happens at step1 and maybe step2 (when the peek happened 
at step1 instead). When means Squid looks at the TCP connections 
client-IP, a CONNECT URI (if any) and maybe the TLS client handshake 
plain-text details.

  Note this is specific to your *current* configuration. Small changes 
to the order of ssl_bump lines or ACLs used can change this behaviour 
dramatically.

Amos


From robertkwild at gmail.com  Thu Aug 12 08:50:17 2021
From: robertkwild at gmail.com (robert k Wild)
Date: Thu, 12 Aug 2021 09:50:17 +0100
Subject: [squid-users] no ssl intercept - question how it works
In-Reply-To: <de66871f-f2d5-4d95-367c-cc891e04d0e9@treenet.co.nz>
References: <CAGU_Ci+J-CS9Np=wYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ@mail.gmail.com>
 <0a66fced-02cd-b9aa-b260-235d5e501032@treenet.co.nz>
 <CAGU_CiJJnMoYwYZa04z2yv1xtZhL_1GqBZ7a9-jF1ZSo=ZF3rw@mail.gmail.com>
 <de66871f-f2d5-4d95-367c-cc891e04d0e9@treenet.co.nz>
Message-ID: <CAGU_Ci+GvAeB1f06DmqArxQXRg_j6y3zTDm2UL2yUcVNw=ifxg@mail.gmail.com>

Thanks Amos

On Thu, 12 Aug 2021, 04:05 Amos Jeffries, <squid3 at treenet.co.nz> wrote:

> On 12/08/21 4:06 am, robert k Wild wrote:
> > Great thanks Amos as always
> >
> > So shall I leave this ssl bump lines in
> >
> > ssl_bump splice NoSSLIntercept
> >> ssl_bump peek DiscoverSNIHost
> >> ssl_bump bump all
> >
> > And delete this one
> >
> > acl step1 at_step SslBump1
> >> ssl_bump peek step1
> >> ssl_bump bump all
> >
> > As your right there both the same, I didn't spot that
> >
> > My understanding is the "no ssl intercept", squid doesn't even bother to
> > inspect the packets ie man in the middle and just literally passes it
> > straight to the client
> >
> > Is that right?
> >
>
> Not quite. Squid still has to receive and look at something to make the
> decision to splice.
>
> The "NoSSLIntercept" is just an ACL. Being defined as a ssl:server_name
> type it looks at whatever Squid is able to find for a server name
> amongst the available data (CONNECT message URI, the client IP's
> reverse-DNS, any TLS details seen so far, etc.
>   So it depends on how many of the SSL-Bump steps have taken place so
> far as to what it can match against.
>
> In your case it happens at step1 and maybe step2 (when the peek happened
> at step1 instead). When means Squid looks at the TCP connections
> client-IP, a CONNECT URI (if any) and maybe the TLS client handshake
> plain-text details.
>
>   Note this is specific to your *current* configuration. Small changes
> to the order of ssl_bump lines or ACLs used can change this behaviour
> dramatically.
>
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210812/f5cc5ccb/attachment.htm>

From m_zouhairy at ckta.by  Thu Aug 12 11:34:43 2021
From: m_zouhairy at ckta.by (Majed Zouhairy)
Date: Thu, 12 Aug 2021 14:34:43 +0300
Subject: [squid-users] certificate issuer not known
In-Reply-To: <2697f8b6-30dd-4261-e4ef-1c6e68181e5e@ckta.by>
References: <2697f8b6-30dd-4261-e4ef-1c6e68181e5e@ckta.by>
Message-ID: <9aa2d5f9-9b6d-dd32-0109-b6428c1528c5@ckta.by>

solved the issue with this guide:

https://docs.diladele.com/faq/squid/fix_unable_to_get_issuer_cert_locally.html

but needs different commands for tumbleweed



On 6/23/21 2:56 PM, Majed Zouhairy wrote:
> 
> Health be upon you,
> when visiting
> https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit
> 
> on squid 4.15
> 
> it displays:
> 
> 
> ERROR
> The requested URL could not be retrieved
> 
> The following error was encountered while trying to retrieve the URL: 
> https://wiki.squid-cache.org/*
> 
>  ??? Failed to establish a secure connection to 104.130.201.120
> 
> The system returned:
> 
>  ??? (71) Protocol error (TLS code: 
> X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
> 
>  ??? SSL Certficate error: certificate issuer (CA) not known: 
> /C=US/O=Let's Encrypt/CN=R3
> 
> This proxy and the remote host failed to negotiate a mutually acceptable 
> security settings for handling your request. It is possible that the 
> remote host does not support secure connections, or the proxy is not 
> satisfied with the host security credentials.
> 
> Your cache administrator is webmaster.
> 
> configuration:
> 
> http_port 3128 ssl-bump? cert=/etc/squid/certs/myCA.pem 
> generate-host-certificates=on dynamic_cert_mem_cache_size=8MB
> 
> 
> 
> acl???? tls_s1_connect??????? at_step SslBump1
> acl???? tls_s2_client_hello???? at_step SslBump2
> acl???? tls_s3_server_hello???? at_step SslBump3
> 
> # define acls for sites that must not be actively bumped
> 
> acl???? tls_allowed_hsts??? ssl::server_name???????????? .akamaihd.net
> acl???? tls_allowed_hsts??? ssl::server_name???????????? .proxy.skko.by
> #acl???? tls_server_is_bank???? ssl::server_name???? .abnamro.nl
> #acl???? tls_server_is_bank???? ssl::server_name???? .abnamro.comacl
> tls_server_is_bank???????? ssl::server_name 
> "/usr/local/ufdbguard/blacklists/finance/domains.squidsplice"
> acl???? tls_to_splice???? any-of???? tls_allowed_hsts tls_server_is_bank
> 
> # TLS/SSL bumping steps
> 
> ssl_bump???? peek??? tls_s1_connect???? # peek at TLS/SSL connect data
> ssl_bump???? splice???? tls_to_splice??? # splice some: no active bump
> ssl_bump???? stare???? all??????? # stare(peek) at server
>  ??????????????????????????????????????????????????????? # properties of 
> the webserver
> ssl_bump???? bump??? # bump if we can (if the stare succeeded)
> 
> 
> 
> #ssl_bump peek all
> #ssl_bump splice all
> 
> ##ssl_bump server-first all
> 
> #sslproxy_cert_error allow all
> 
> 
> 
> cache_dir ufs /var/cache/squid 8000 16 256
> 
> # Leave coredumps in the first cache dir
> coredump_dir /var/cache/squid
> 
> cache_mem 960 MB
> 
> netdb_filename none
> 
> #
> # Add any of your own refresh_pattern entries above these.
> #
> refresh_pattern ^ftp:??????????? 1440??? 20%??? 10080
> refresh_pattern ^gopher:??????? 1440??? 0%??? 1440
> refresh_pattern -i (/cgi-bin/|\?)???? 0??? 0%??? 0
> refresh_pattern .??????????? 0??? 20%??? 4320
> 
> url_rewrite_extras "%>a/%>A %un %>rm bump_mode=%ssl::bump_mode 
> sni=\"%ssl::>sni\" referer=\"%{Referer}>h\""
> url_rewrite_program /usr/local/ufdbguard/bin/ufdbgclient -m 4 -l 
> /var/log/squid/
> url_rewrite_children 16 startup=8 idle=2 concurrency=4 queue-size=64
> #debug_options ALL,1 33,2 28,9
> 
> what needs to be done to fix?


From nbdspcl at gmail.com  Sat Aug 14 06:09:21 2021
From: nbdspcl at gmail.com (Nbd Spcl)
Date: Sat, 14 Aug 2021 09:09:21 +0300
Subject: [squid-users] How to stop writes to netdb.state?
Message-ID: <CALytF=1X=quczk-=30-DcHiXMgJs4SF2Nr5N7tK9ev-uyOh9Mw@mail.gmail.com>

Hello, every hour or so squid performs a writing operation to a file, which
is reported in the journal as follows:

Logfile:opening log stdio:/var/spool/squid/netdb.state
Logfile:closing log stdio:/var/spool/squid/netdb.state
NETDB state saved: 0 entries, 0 msec

I have enabled the following rule in the squid.conf:

pinger_enable off

This caused the last last in the log report to become

NETDB state saved: 0 entries, 0 msec

whereas before adding that rule, it was

NETDB state saved: 12 entries, 1 msec

My question is: is there a way to stop this file writing altogether so that
it doesn't show up in the journal logs?

/Al.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210814/8ced653f/attachment.htm>

From uhlar at fantomas.sk  Sat Aug 14 09:43:38 2021
From: uhlar at fantomas.sk (Matus UHLAR - fantomas)
Date: Sat, 14 Aug 2021 11:43:38 +0200
Subject: [squid-users] How to stop writes to netdb.state?
In-Reply-To: <CALytF=1X=quczk-=30-DcHiXMgJs4SF2Nr5N7tK9ev-uyOh9Mw@mail.gmail.com>
References: <CALytF=1X=quczk-=30-DcHiXMgJs4SF2Nr5N7tK9ev-uyOh9Mw@mail.gmail.com>
Message-ID: <20210814094338.GA13820@fantomas.sk>

On 14.08.21 09:09, Nbd Spcl wrote:
>Hello, every hour or so squid performs a writing operation to a file, which
>is reported in the journal as follows:
>
>Logfile:opening log stdio:/var/spool/squid/netdb.state
>Logfile:closing log stdio:/var/spool/squid/netdb.state
>NETDB state saved: 0 entries, 0 msec
>
>I have enabled the following rule in the squid.conf:
>
>pinger_enable off

btw, why?

>My question is: is there a way to stop this file writing altogether so that
>it doesn't show up in the journal logs?

http://www.squid-cache.org/Doc/config/netdb_filename/

To disable, enter "none".


-- 
Matus UHLAR - fantomas, uhlar at fantomas.sk ; http://www.fantomas.sk/
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Depression is merely anger without enthusiasm.


From nbdspcl at gmail.com  Sat Aug 14 12:04:13 2021
From: nbdspcl at gmail.com (Nbd Spcl)
Date: Sat, 14 Aug 2021 15:04:13 +0300
Subject: [squid-users] How to stop writes to netdb.state?
In-Reply-To: <20210814094338.GA13820@fantomas.sk>
References: <CALytF=1X=quczk-=30-DcHiXMgJs4SF2Nr5N7tK9ev-uyOh9Mw@mail.gmail.com>
 <20210814094338.GA13820@fantomas.sk>
Message-ID: <CALytF=3R0WLvjWUr_HghUwrGa24TNmgXmgZo_CO40EUf8BUsnA@mail.gmail.com>

On Sat, Aug 14, 2021 at 12:43 PM Matus UHLAR - fantomas
<uhlar at fantomas.sk> wrote:
>
> On 14.08.21 09:09, Nbd Spcl wrote:
> >Hello, every hour or so squid performs a writing operation to a file, which
> >is reported in the journal as follows:
> >
> >Logfile:opening log stdio:/var/spool/squid/netdb.state
> >Logfile:closing log stdio:/var/spool/squid/netdb.state
> >NETDB state saved: 0 entries, 0 msec
> >
> >I have enabled the following rule in the squid.conf:
> >
> >pinger_enable off
>
> btw, why?

That was just a "try and error" attempt, based on 10.5 section of the manual:

"To enable netdb, you must configure Squid with the ?enable-icmp
option. You must also install the pinger program"

> >My question is: is there a way to stop this file writing altogether so that
> >it doesn't show up in the journal logs?
>
> http://www.squid-cache.org/Doc/config/netdb_filename/
>
> To disable, enter "none".

Many thanks.

/Al.


From uhlar at fantomas.sk  Sat Aug 14 12:44:31 2021
From: uhlar at fantomas.sk (Matus UHLAR - fantomas)
Date: Sat, 14 Aug 2021 14:44:31 +0200
Subject: [squid-users] How to stop writes to netdb.state?
In-Reply-To: <CALytF=3R0WLvjWUr_HghUwrGa24TNmgXmgZo_CO40EUf8BUsnA@mail.gmail.com>
References: <CALytF=1X=quczk-=30-DcHiXMgJs4SF2Nr5N7tK9ev-uyOh9Mw@mail.gmail.com>
 <20210814094338.GA13820@fantomas.sk>
 <CALytF=3R0WLvjWUr_HghUwrGa24TNmgXmgZo_CO40EUf8BUsnA@mail.gmail.com>
Message-ID: <20210814124431.GB20239@fantomas.sk>

>> On 14.08.21 09:09, Nbd Spcl wrote:
>> >Hello, every hour or so squid performs a writing operation to a file, which
>> >is reported in the journal as follows:
>> >
>> >Logfile:opening log stdio:/var/spool/squid/netdb.state
>> >Logfile:closing log stdio:/var/spool/squid/netdb.state
>> >NETDB state saved: 0 entries, 0 msec
>> >
>> >I have enabled the following rule in the squid.conf:
>> >
>> >pinger_enable off

>On Sat, Aug 14, 2021 at 12:43 PM Matus UHLAR - fantomas
><uhlar at fantomas.sk> wrote:
>> btw, why?

On 14.08.21 15:04, Nbd Spcl wrote:
>That was just a "try and error" attempt, based on 10.5 section of the manual:
>
>"To enable netdb, you must configure Squid with the ?enable-icmp
>option. You must also install the pinger program"

>> >My question is: is there a way to stop this file writing altogether so that
>> >it doesn't show up in the journal logs?
>>
>> http://www.squid-cache.org/Doc/config/netdb_filename/
>>
>> To disable, enter "none".
>
>Many thanks.

btw, these options are usually described in provided default squid.conf.

-- 
Matus UHLAR - fantomas, uhlar at fantomas.sk ; http://www.fantomas.sk/
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Atheism is a non-prophet organization.


From pserrat.sq at gmail.com  Sun Aug 15 22:25:45 2021
From: pserrat.sq at gmail.com (Pavel Serrat)
Date: Sun, 15 Aug 2021 18:25:45 -0400
Subject: [squid-users] about logformat
Message-ID: <CANr9W_YEANO9P1uUX6sCWkaK=gS8PEKJ854noHTHk0Qu3vZZMw@mail.gmail.com>

Hello friends
I'm trying to customize my squid log format and I have the following question:
What is the difference between %6tr and %tr ???
What does %03>Hs mean?
Is the same %03tu as %tu?
help me please


From Antony.Stone at squid.open.source.it  Sun Aug 15 22:47:23 2021
From: Antony.Stone at squid.open.source.it (Antony Stone)
Date: Mon, 16 Aug 2021 00:47:23 +0200
Subject: [squid-users] about logformat
In-Reply-To: <CANr9W_YEANO9P1uUX6sCWkaK=gS8PEKJ854noHTHk0Qu3vZZMw@mail.gmail.com>
References: <CANr9W_YEANO9P1uUX6sCWkaK=gS8PEKJ854noHTHk0Qu3vZZMw@mail.gmail.com>
Message-ID: <202108160047.23272.Antony.Stone@squid.open.source.it>

On Monday 16 August 2021 at 00:25:45, Pavel Serrat wrote:

> I'm trying to customize my squid log format and I have the following
> question:

See http://www.squid-cache.org/Doc/config/logformat/

	% [encoding] [-] [[0]width] [{arg}] formatcode [{arg}]

width	minimum and/or maximum field width:
		[width_min][.width_max]
		When minimum starts with 0, the field is zero-padded.
		String values exceeding maximum width are truncated.

> What is the difference between %6tr and %tr ???

%tr gives you the millisecond response time.
%6tr gives you the millisecond response time padded with spaces to at least 6 
characters.

> What does %03>Hs mean?

It means the HTTP status code sent to the client, padded with zeroes to 3 
characters.

> Is the same %03tu as %tu?

No.

The former is zero-padded to at least three characters, the latter is 
unpadded.

042 is not the same as 42.


Antony.

-- 
Why is "dyslexia" so difficult to spell, and why can I never remember "aphasia" 
when I want to?

                                                   Please reply to the list;
                                                         please *don't* CC me.


From rousskov at measurement-factory.com  Sun Aug 15 22:51:56 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sun, 15 Aug 2021 18:51:56 -0400
Subject: [squid-users] about logformat
In-Reply-To: <CANr9W_YEANO9P1uUX6sCWkaK=gS8PEKJ854noHTHk0Qu3vZZMw@mail.gmail.com>
References: <CANr9W_YEANO9P1uUX6sCWkaK=gS8PEKJ854noHTHk0Qu3vZZMw@mail.gmail.com>
Message-ID: <8864ce71-cc56-bfcd-a86c-8725b1c237c9@measurement-factory.com>

On 8/15/21 6:25 PM, Pavel Serrat wrote:
> Hello friends
> I'm trying to customize my squid log format and I have the following question:
> What is the difference between %6tr and %tr ???
> What does %03>Hs mean?
> Is the same %03tu as %tu?
> help me please

In addition to what Antony Stone has said, you may find it useful to
study a better documented printf() API. Logformat borrowed most of its
ideas from that formatting specifications. You can use this Wikipedia
article as a starting point:

https://en.wikipedia.org/wiki/Printf_format_string

Alex.


From peterthesing at gmail.com  Mon Aug 16 15:03:57 2021
From: peterthesing at gmail.com (Peter Thesing)
Date: Mon, 16 Aug 2021 17:03:57 +0200
Subject: [squid-users] Squid is active but not working
Message-ID: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>

Hi,

If there is a a need for additional information please let me know?!

I am using opensuse 15.1 with 2 network interface cards and apache is 
working squid is active , but giving me the results I need.

On my second machine also fitted with opensuse 15.1 but with no internet 
would be able via a proxy e.g. squid to connect to the internet but 
despite all my efforts to no avail.

When I installed windows 10 it works but on opensuse not?

Please how can I get this to work?

This I got when using squidclient:

server:/home/peter #squidclient http://peterspretpaleis.xs4all.nl
HTTP/1.1 200 OK
Date: Mon, 16 Aug 2021 13:50:26 GMT
Server: Apache
Last-Modified: Sat, 14 Aug 2021 18:04:37 GMT
ETag: "36b9-5c988cd17ad31"
Accept-Ranges: bytes
Content-Length: 14009
Content-Type: text/html
Age: 3670
X-Cache: HIT from server
X-Cache-Lookup: HIT from server:3128
Via: 1.1 server (squid/4.13)
Connection: close

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- DW6 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Peter's PretPaleis</title>
<link rel="stylesheet" href="extra/emx_nav_left.css" type="text/css">
<script type="text/javascript">
<!--
var time = 3000;
var numofitems = 7;

//menu constructor
function menu(allitems,thisitem,startstate){
 ?callname= "gl"+thisitem;
 ?divname="subglobal"+thisitem;
 ?this.numberofmenuitems = 7;
 ?this.caller = document.getElementById(callname);
 ?this.thediv = document.getElementById(divname);
 ?this.thediv.style.visibility = startstate;
}

//menu methods
function ehandler(event,theobj){
 ?for (var i=1; i<= theobj.numberofmenuitems; i++){
 ???var shutdiv =eval( "menuitem"+i+".thediv");
 ???shutdiv.style.visibility="hidden";
 ?}
 ?theobj.thediv.style.visibility="visible";
}

function closesubnav(event){
 ?if ((event.clientY <48)||(event.clientY > 107)){
 ???for (var i=1; i<= numofitems; i++){
 ?????var shutdiv =eval('menuitem'+i+'.thediv');
 ?????shutdiv.style.visibility='hidden';
 ???}
 ?}
}
// -->
</script>
</head>
<body onmousemove="closesubnav(event);">
<div class="skipLinks">skip to: <a href="#content">page content</a> | <a 
href="pageNav">links on this page</a> | <a href="#globalNav">site 
navigation</a> | <a href="#siteInfo">footer (site information)</a> </div>
<div id="masthead">
 ?<h1 id="siteName">Peter's PretPaleis</h1>
 ?<div id="utility">
 ???<a href="#">Utility Link</a> | <a href="#">Utility Link</a> | <a 
href="#" target="_blank">Contact formulier</a>
 ?</div>
 ?<div id="globalNav">
 ???<img alt="" src="extra/gblnav_left.gif" height="32" width="4" 
id="gnl"> <img alt="" src="extra/glbnav_right.gif" height="32" width="4" 
id="gnr">
 ???<div id="globalLink">
 ?????<a href="#" id="gl1" class="glink" 
onmouseover="ehandler(event,menuitem1);">global
 ?????????link</a><a href="#" id="gl2" class="glink" 
onmouseover="ehandler(event,menuitem2);">global
 ?????link</a><a href="#" id="gl3" class="glink" 
onmouseover="ehandler(event,menuitem3);">global
 ?????link</a><a href="#" id="gl4" class="glink" 
onmouseover="ehandler(event,menuitem4);">global
 ?????link</a><a href="#" id="gl5" class="glink" 
onmouseover="ehandler(event,menuitem5);">global
 ?????link</a><a href="#" id="gl6" class="glink" 
onmouseover="ehandler(event,menuitem6);">global
 ?????link</a><a href="#" id="gl7" class="glink" 
onmouseover="ehandler(event,menuitem7);">global
 ?????link</a>
 ???</div>
 ???<!--end globalLinks-->
 ???<form id="search" action="">
 ?????<input name="searchFor" type="text" size="10">
 ?????<a href="">search</a>
 ???</form>
 ?</div>
 ?<!-- end globalNav -->
 ?<div id="subglobal1" class="subglobalNav">
 ???<a href="#">subglobal1 link</a> | <a href="#">subglobal1 link</a> | 
<a href="#">subglobal1
 ???link</a> | <a href="#">subglobal1 link</a> | <a href="#">subglobal1 
link</a> | <a href="#">subglobal1
 ???link</a> | <a href="#">subglobal1 link</a>
 ?</div>
 ?<div id="subglobal2" class="subglobalNav">
 ???<a href="#">subglobal2 link</a> | <a href="#">subglobal2 link</a> | 
<a href="#">subglobal2
 ???link</a> | <a href="#">subglobal2 link</a> | <a href="#">subglobal2 
link</a> | <a href="#">subglobal2
 ???link</a> | <a href="#">subglobal2 link</a>
 ?</div>
 ?<div id="subglobal3" class="subglobalNav">
 ???<a href="#">subglobal3 link</a> | <a href="#">subglobal3 link</a> | 
<a href="#">subglobal3
 ???link</a> | <a href="#">subglobal3 link</a> | <a href="#">subglobal3 
link</a> | <a href="#">subglobal3
 ???link</a> | <a href="#">subglobal3 link</a>
 ?</div>
 ?<div id="subglobal4" class="subglobalNav">
 ???<a href="#">subglobal4 link</a> | <a href="#">subglobal4 link</a> | 
<a href="#">subglobal4
 ???link</a> | <a href="#">subglobal4 link</a> | <a href="#">subglobal4 
link</a> | <a href="#">subglobal4
 ???link</a> | <a href="#">subglobal4 link</a>
 ?</div>
 ?<div id="subglobal5" class="subglobalNav">
 ???<a href="#">subglobal5 link</a> | <a href="#">subglobal5 link</a> | 
<a href="#">subglobal5
 ???link</a> | <a href="#">subglobal5 link</a> | <a href="#">subglobal5 
link</a> | <a href="#">subglobal5
 ???link</a> | <a href="#">subglobal5 link</a>
 ?</div>
 ?<div id="subglobal6" class="subglobalNav">
 ???<a href="#">subglobal6 link</a> | <a href="#">subglobal6 link</a> | 
<a href="#">subglobal6
 ???link</a> | <a href="#">subglobal6 link</a> | <a href="#">subglobal6 
link</a> | <a href="#">subglobal6
 ???link</a> | <a href="#">subglobal6 link</a>
 ?</div>
 ?<div id="subglobal7" class="subglobalNav">
 ???<a href="#">subglobal7 link</a> | <a href="#">subglobal7 link</a> | 
<a href="#">subglobal7
 ???link</a> | <a href="#">subglobal7 link</a> | <a href="#">subglobal7 
link</a> | <a href="#">subglobal7
 ???link</a> | <a href="#">subglobal7 link</a>
 ?</div>
 ?<div id="subglobal8" class="subglobalNav">
 ???<a href="#">subglobal8 link</a> | <a href="#">subglobal8 link</a> | 
<a href="#">subglobal8
 ???link</a> | <a href="#">subglobal8 link</a> | <a href="#">subglobal8 
link</a> | <a href="#">subglobal8
 ???link</a> | <a href="#">subglobal8 link</a>
 ?</div>
</div>
<!-- end masthead -->
<div id="pagecell1">
 ?<!--pagecell1-->
 ?<img alt="" src="extra/tl_curve_white.gif" height="6" width="6" 
id="tl"> <img alt="" src="extra/tr_curve_white.gif" height="6" width="6" 
id="tr">
 ?<div id="breadCrumb">
 ???<a href="#">Breadcrumb</a> / <a href="#">Breadcrumb</a> / <a 
href="#">Breadcrumb</a> /
 ?</div>
 ?<div id="pageName">
 ???<h2>Peter's PretPaleis</h2>
 ???<img alt="small logo" src="plaatjes/Basquete.gif" height="59" 
width="66"/>
 ?</div>
 ?<div id="pageNav">
 ???<div id="sectionLinks">
 ?????<a href="/koken/index.html" target="_blank">Recepturalia</a> <a 
href="/ontwikkelingen/index.html" target="_blank">Ontwikkelingen</a> <a 
href="spel/index.html" target="_blank">Spelletjes
 ?????</a> <a href="#">Section Link</a> <a href="#">Section Link</a> <a 
href="#">Section
 ?????Link</a>
 ???</div>
 ???<div class="relatedLinks">
 ?????<h3>Related Link Category</h3>
 ?????<a href="#">Related Link</a> <a href="#">Related Link</a> <a 
href="#">Related
 ?????Link</a> <a href="#">Related Link</a> <a href="#">Related Link</a> 
<a href="#">Related
 ?????Link</a>
 ???</div>
 ???<div class="relatedLinks">
 ?????<h3>Related Link Category</h3>
 ?????<a href="#">Related Link</a> <a href="#">Related Link</a> <a 
href="#">Related
 ?????Link</a> <a href="#">Related Link</a> <a href="#">Related Link</a> 
<a href="#">Related
 ?????Link</a>
 ???</div>
 ???<div id="advert">
 ?????<img src="" alt="" width="107" height="66" /> Advertisement copy 
goes here.
 ?????Advertisement copy goes here.
 ???</div>
 ?</div>
 ?<div id="content">
 ???<div class="feature">
<img src="plaatjes/kingfcys14-king-tux-1606.png" alt="" width="280" 
height="200">
<h3>Welkom op mijn Webhalte</h3>
 ?????<p>
 ?????Van harte gefeliciteerd dat U en de Uwen geslaagd is deze pagina 
te bereiken. Het zal niet eenvoudig geweest zijn om dit voor elkaar te 
krijgen. Sta mij toe U en de Uwen een puntje van aandacht te brengen: 
Deze halte bestaat uit ee
n mixtuur van zowel HTML4 alsmede HTML5 toepassingen. Deze zijn eerlijk 
gestolen van het WereldWijdeWeb...</p>
 ?????<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec 
molestie.
 ????????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
condimentum
 ????????facilisis nulla. In hac habitasse platea dictumst. Nulla 
nonummy. Cras
 ????????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
Nullam fringilla
 ????????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
Pellentesque
 ????????a magna a mauris vulputate lacinia. Aenean viverra. Class 
aptent taciti
 ????????sociosqu ad litora torquent per conubia nostra, per inceptos 
hymenaeos.
 ????????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum 
et, tortor. </p>
 ???</div>
 ???<div class="story">
 ?????<h3>Story Title</h3>
 ?????<p>
 ??????Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec 
molestie.
 ??????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
condimentum
 ??????facilisis nulla. In hac habitasse platea dictumst. Nulla nonummy. 
Cras
 ??????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
Nullam fringilla
 ??????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
Pellentesque
 ??????a magna a mauris vulputate lacinia. Aenean viverra. Class aptent 
taciti
 ??????sociosqu ad litora torquent per conubia nostra, per inceptos 
hymenaeos.
 ??????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum et, 
tortor.
 ?????</p>
 ?????<p>
 ??????Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec 
molestie.
 ??????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
condimentum
 ??????facilisis nulla. In hac habitasse platea dictumst. Nulla nonummy. 
Cras
 ??????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
Nullam fringilla
 ??????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
Pellentesque
 ??????a magna a mauris vulputate lacinia. Aenean viverra. Class aptent 
taciti
 ??????sociosqu ad litora torquent per conubia nostra, per inceptos 
hymenaeos.
 ??????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum et, 
tortor.
 ?????</p>
 ???</div>
 ???<div class="story">
 ?????<table width="100%" cellpadding="0" cellspacing="0" summary="">
 ???????<tr valign="top">
 ?????????<td class="storyLeft"> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ?????????<td> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ???????</tr>
 ???????<tr valign="top">
 ?????????<td class="storyLeft"> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ?????????<td> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ???????</tr>
 ???????<tr valign="top">
 ?????????<td class="storyLeft"> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ?????????<td> <p>
 ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
Vestibulum
 ???????????ante ipsum primis in faucibus orci luctus et ultrices 
posuere cubilia
 ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
quis, lobortis
 ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
neque. Cras
 ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
href="#">Donec</a> eget
 ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque lorem 
a elit.
 ???????????Sed id mauris.
 ???????????</p></td>
 ???????</tr>
 ?????</table>
 ???</div>
 ?</div>
 ??<div id="siteInfo">
 ???<img src="" width="44" height="22"> <a href="#">About Us</a> | <a 
href="#">Site
 ???Map</a> | <a href="#">Privacy Policy</a> | <a href="#">Contact 
Us</a> | &copy;2003
 ???Company Name
 ?</div>
</div>
<!--end pagecell1-->
<br>
<script type="text/javascript">
 ???<!--
 ?????var menuitem1 = new menu(7,1,"hidden");
 ???????????????????????var menuitem2 = new menu(7,2,"hidden");
 ???????????????????????var menuitem3 = new menu(7,3,"hidden");
 ???????????????????????var menuitem4 = new menu(7,4,"hidden");
 ???????????????????????var menuitem5 = new menu(7,5,"hidden");
 ???????????????????????var menuitem6 = new menu(7,6,"hidden");
 ???????????????????????var menuitem7 = new menu(7,7,"hidden");
 ???// -->
 ???</script>
</body>
</html>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210816/7eea66a2/attachment.htm>

From peterthesing at gmail.com  Mon Aug 16 15:06:39 2021
From: peterthesing at gmail.com (Peter Thesing)
Date: Mon, 16 Aug 2021 17:06:39 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
Message-ID: <ddce7ba1-11b9-2a99-e2d5-24ab21b81fe9@gmail.com>

By the way the firewall is off

Op 16-08-2021 om 17:03 schreef Peter Thesing:
>
> Hi,
>
> If there is a a need for additional information please let me know?!
>
> I am using opensuse 15.1 with 2 network interface cards and apache is 
> working squid is active , but giving me the results I need.
>
> On my second machine also fitted with opensuse 15.1 but with no 
> internet would be able via a proxy e.g. squid to connect to the 
> internet but despite all my efforts to no avail.
>
> When I installed windows 10 it works but on opensuse not?
>
> Please how can I get this to work?
>
> This I got when using squidclient:
>
> server:/home/peter #squidclient http://peterspretpaleis.xs4all.nl
> HTTP/1.1 200 OK
> Date: Mon, 16 Aug 2021 13:50:26 GMT
> Server: Apache
> Last-Modified: Sat, 14 Aug 2021 18:04:37 GMT
> ETag: "36b9-5c988cd17ad31"
> Accept-Ranges: bytes
> Content-Length: 14009
> Content-Type: text/html
> Age: 3670
> X-Cache: HIT from server
> X-Cache-Lookup: HIT from server:3128
> Via: 1.1 server (squid/4.13)
> Connection: close
>
> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
> "http://www.w3.org/TR/html4/loose.dtd">
> <html>
> <!-- DW6 -->
> <head>
> <meta http-equiv="Content-Type" content="text/html; 
> charset=windows-1252">
> <title>Peter's PretPaleis</title>
> <link rel="stylesheet" href="extra/emx_nav_left.css" type="text/css">
> <script type="text/javascript">
> <!--
> var time = 3000;
> var numofitems = 7;
>
> //menu constructor
> function menu(allitems,thisitem,startstate){
> ?callname= "gl"+thisitem;
> ?divname="subglobal"+thisitem;
> ?this.numberofmenuitems = 7;
> ?this.caller = document.getElementById(callname);
> ?this.thediv = document.getElementById(divname);
> ?this.thediv.style.visibility = startstate;
> }
>
> //menu methods
> function ehandler(event,theobj){
> ?for (var i=1; i<= theobj.numberofmenuitems; i++){
> ???var shutdiv =eval( "menuitem"+i+".thediv");
> ???shutdiv.style.visibility="hidden";
> ?}
> ?theobj.thediv.style.visibility="visible";
> }
>
> function closesubnav(event){
> ?if ((event.clientY <48)||(event.clientY > 107)){
> ???for (var i=1; i<= numofitems; i++){
> ?????var shutdiv =eval('menuitem'+i+'.thediv');
> ?????shutdiv.style.visibility='hidden';
> ???}
> ?}
> }
> // -->
> </script>
> </head>
> <body onmousemove="closesubnav(event);">
> <div class="skipLinks">skip to: <a href="#content">page content</a> | 
> <a href="pageNav">links on this page</a> | <a href="#globalNav">site 
> navigation</a> | <a href="#siteInfo">footer (site information)</a> </div>
> <div id="masthead">
> ?<h1 id="siteName">Peter's PretPaleis</h1>
> ?<div id="utility">
> ???<a href="#">Utility Link</a> | <a href="#">Utility Link</a> | <a 
> href="#" target="_blank">Contact formulier</a>
> ?</div>
> ?<div id="globalNav">
> ???<img alt="" src="extra/gblnav_left.gif" height="32" width="4" 
> id="gnl"> <img alt="" src="extra/glbnav_right.gif" height="32" 
> width="4" id="gnr">
> ???<div id="globalLink">
> ?????<a href="#" id="gl1" class="glink" 
> onmouseover="ehandler(event,menuitem1);">global
> ?????????link</a><a href="#" id="gl2" class="glink" 
> onmouseover="ehandler(event,menuitem2);">global
> ?????link</a><a href="#" id="gl3" class="glink" 
> onmouseover="ehandler(event,menuitem3);">global
> ?????link</a><a href="#" id="gl4" class="glink" 
> onmouseover="ehandler(event,menuitem4);">global
> ?????link</a><a href="#" id="gl5" class="glink" 
> onmouseover="ehandler(event,menuitem5);">global
> ?????link</a><a href="#" id="gl6" class="glink" 
> onmouseover="ehandler(event,menuitem6);">global
> ?????link</a><a href="#" id="gl7" class="glink" 
> onmouseover="ehandler(event,menuitem7);">global
> ?????link</a>
> ???</div>
> ???<!--end globalLinks-->
> ???<form id="search" action="">
> ?????<input name="searchFor" type="text" size="10">
> ?????<a href="">search</a>
> ???</form>
> ?</div>
> ?<!-- end globalNav -->
> ?<div id="subglobal1" class="subglobalNav">
> ???<a href="#">subglobal1 link</a> | <a href="#">subglobal1 link</a> | 
> <a href="#">subglobal1
> ???link</a> | <a href="#">subglobal1 link</a> | <a href="#">subglobal1 
> link</a> | <a href="#">subglobal1
> ???link</a> | <a href="#">subglobal1 link</a>
> ?</div>
> ?<div id="subglobal2" class="subglobalNav">
> ???<a href="#">subglobal2 link</a> | <a href="#">subglobal2 link</a> | 
> <a href="#">subglobal2
> ???link</a> | <a href="#">subglobal2 link</a> | <a href="#">subglobal2 
> link</a> | <a href="#">subglobal2
> ???link</a> | <a href="#">subglobal2 link</a>
> ?</div>
> ?<div id="subglobal3" class="subglobalNav">
> ???<a href="#">subglobal3 link</a> | <a href="#">subglobal3 link</a> | 
> <a href="#">subglobal3
> ???link</a> | <a href="#">subglobal3 link</a> | <a href="#">subglobal3 
> link</a> | <a href="#">subglobal3
> ???link</a> | <a href="#">subglobal3 link</a>
> ?</div>
> ?<div id="subglobal4" class="subglobalNav">
> ???<a href="#">subglobal4 link</a> | <a href="#">subglobal4 link</a> | 
> <a href="#">subglobal4
> ???link</a> | <a href="#">subglobal4 link</a> | <a href="#">subglobal4 
> link</a> | <a href="#">subglobal4
> ???link</a> | <a href="#">subglobal4 link</a>
> ?</div>
> ?<div id="subglobal5" class="subglobalNav">
> ???<a href="#">subglobal5 link</a> | <a href="#">subglobal5 link</a> | 
> <a href="#">subglobal5
> ???link</a> | <a href="#">subglobal5 link</a> | <a href="#">subglobal5 
> link</a> | <a href="#">subglobal5
> ???link</a> | <a href="#">subglobal5 link</a>
> ?</div>
> ?<div id="subglobal6" class="subglobalNav">
> ???<a href="#">subglobal6 link</a> | <a href="#">subglobal6 link</a> | 
> <a href="#">subglobal6
> ???link</a> | <a href="#">subglobal6 link</a> | <a href="#">subglobal6 
> link</a> | <a href="#">subglobal6
> ???link</a> | <a href="#">subglobal6 link</a>
> ?</div>
> ?<div id="subglobal7" class="subglobalNav">
> ???<a href="#">subglobal7 link</a> | <a href="#">subglobal7 link</a> | 
> <a href="#">subglobal7
> ???link</a> | <a href="#">subglobal7 link</a> | <a href="#">subglobal7 
> link</a> | <a href="#">subglobal7
> ???link</a> | <a href="#">subglobal7 link</a>
> ?</div>
> ?<div id="subglobal8" class="subglobalNav">
> ???<a href="#">subglobal8 link</a> | <a href="#">subglobal8 link</a> | 
> <a href="#">subglobal8
> ???link</a> | <a href="#">subglobal8 link</a> | <a href="#">subglobal8 
> link</a> | <a href="#">subglobal8
> ???link</a> | <a href="#">subglobal8 link</a>
> ?</div>
> </div>
> <!-- end masthead -->
> <div id="pagecell1">
> ?<!--pagecell1-->
> ?<img alt="" src="extra/tl_curve_white.gif" height="6" width="6" 
> id="tl"> <img alt="" src="extra/tr_curve_white.gif" height="6" 
> width="6" id="tr">
> ?<div id="breadCrumb">
> ???<a href="#">Breadcrumb</a> / <a href="#">Breadcrumb</a> / <a 
> href="#">Breadcrumb</a> /
> ?</div>
> ?<div id="pageName">
> ???<h2>Peter's PretPaleis</h2>
> ???<img alt="small logo" src="plaatjes/Basquete.gif" height="59" 
> width="66"/>
> ?</div>
> ?<div id="pageNav">
> ???<div id="sectionLinks">
> ?????<a href="/koken/index.html" target="_blank">Recepturalia</a> <a 
> href="/ontwikkelingen/index.html" target="_blank">Ontwikkelingen</a> 
> <a href="spel/index.html" target="_blank">Spelletjes
> ?????</a> <a href="#">Section Link</a> <a href="#">Section Link</a> <a 
> href="#">Section
> ?????Link</a>
> ???</div>
> ???<div class="relatedLinks">
> ?????<h3>Related Link Category</h3>
> ?????<a href="#">Related Link</a> <a href="#">Related Link</a> <a 
> href="#">Related
> ?????Link</a> <a href="#">Related Link</a> <a href="#">Related 
> Link</a> <a href="#">Related
> ?????Link</a>
> ???</div>
> ???<div class="relatedLinks">
> ?????<h3>Related Link Category</h3>
> ?????<a href="#">Related Link</a> <a href="#">Related Link</a> <a 
> href="#">Related
> ?????Link</a> <a href="#">Related Link</a> <a href="#">Related 
> Link</a> <a href="#">Related
> ?????Link</a>
> ???</div>
> ???<div id="advert">
> ?????<img src="" alt="" width="107" height="66" /> Advertisement copy 
> goes here.
> ?????Advertisement copy goes here.
> ???</div>
> ?</div>
> ?<div id="content">
> ???<div class="feature">
> <img src="plaatjes/kingfcys14-king-tux-1606.png" alt="" width="280" 
> height="200">
> <h3>Welkom op mijn Webhalte</h3>
> ?????<p>
> ?????Van harte gefeliciteerd dat U en de Uwen geslaagd is deze pagina 
> te bereiken. Het zal niet eenvoudig geweest zijn om dit voor elkaar te 
> krijgen. Sta mij toe U en de Uwen een puntje van aandacht te brengen: 
> Deze halte bestaat uit ee
> n mixtuur van zowel HTML4 alsmede HTML5 toepassingen. Deze zijn 
> eerlijk gestolen van het WereldWijdeWeb...</p>
> ?????<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. 
> Donec molestie.
> ????????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
> condimentum
> ????????facilisis nulla. In hac habitasse platea dictumst. Nulla 
> nonummy. Cras
> ????????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
> Nullam fringilla
> ????????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
> Pellentesque
> ????????a magna a mauris vulputate lacinia. Aenean viverra. Class 
> aptent taciti
> ????????sociosqu ad litora torquent per conubia nostra, per inceptos 
> hymenaeos.
> ????????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum 
> et, tortor. </p>
> ???</div>
> ???<div class="story">
> ?????<h3>Story Title</h3>
> ?????<p>
> ??????Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec 
> molestie.
> ??????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
> condimentum
> ??????facilisis nulla. In hac habitasse platea dictumst. Nulla 
> nonummy. Cras
> ??????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
> Nullam fringilla
> ??????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
> Pellentesque
> ??????a magna a mauris vulputate lacinia. Aenean viverra. Class aptent 
> taciti
> ??????sociosqu ad litora torquent per conubia nostra, per inceptos 
> hymenaeos.
> ??????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum 
> et, tortor.
> ?????</p>
> ?????<p>
> ??????Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec 
> molestie.
> ??????Sed aliquam sem ut arcu. Phasellus sollicitudin. Vestibulum 
> condimentum
> ??????facilisis nulla. In hac habitasse platea dictumst. Nulla 
> nonummy. Cras
> ??????quis libero. Cras venenatis. Aliquam posuere lobortis pede. 
> Nullam fringilla
> ??????urna id leo. Praesent aliquet pretium erat. Praesent non odio. 
> Pellentesque
> ??????a magna a mauris vulputate lacinia. Aenean viverra. Class aptent 
> taciti
> ??????sociosqu ad litora torquent per conubia nostra, per inceptos 
> hymenaeos.
> ??????Aliquam lacus. Mauris magna eros, semper a, tempor et, rutrum 
> et, tortor.
> ?????</p>
> ???</div>
> ???<div class="story">
> ?????<table width="100%" cellpadding="0" cellspacing="0" summary="">
> ???????<tr valign="top">
> ?????????<td class="storyLeft"> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ?????????<td> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ???????</tr>
> ???????<tr valign="top">
> ?????????<td class="storyLeft"> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ?????????<td> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ???????</tr>
> ???????<tr valign="top">
> ?????????<td class="storyLeft"> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ?????????<td> <p>
> ???????????<a href="#" class="capsule">Capsule Story</a> Cras enim. 
> Vestibulum
> ???????????ante ipsum primis in faucibus orci luctus et ultrices 
> posuere cubilia
> ???????????Curae; Ut eu augue. Integer risus wisi, semper eu, congue 
> quis, lobortis
> ???????????ut, massa. Vestibulum auctor vestibulum lectus. Vivamus 
> neque. Cras
> ???????????lobortis. Aenean ut turpis eu libero volutpat euismod. <a 
> href="#">Donec</a> eget
> ???????????lectus vitae ligula ornare tempor. Vivamus scelerisque 
> lorem a elit.
> ???????????Sed id mauris.
> ???????????</p></td>
> ???????</tr>
> ?????</table>
> ???</div>
> ?</div>
> ??<div id="siteInfo">
> ???<img src="" width="44" height="22"> <a href="#">About Us</a> | <a 
> href="#">Site
> ???Map</a> | <a href="#">Privacy Policy</a> | <a href="#">Contact 
> Us</a> | &copy;2003
> ???Company Name
> ?</div>
> </div>
> <!--end pagecell1-->
> <br>
> <script type="text/javascript">
> ???<!--
> ?????var menuitem1 = new menu(7,1,"hidden");
> ???????????????????????var menuitem2 = new menu(7,2,"hidden");
> ???????????????????????var menuitem3 = new menu(7,3,"hidden");
> ???????????????????????var menuitem4 = new menu(7,4,"hidden");
> ???????????????????????var menuitem5 = new menu(7,5,"hidden");
> ???????????????????????var menuitem6 = new menu(7,6,"hidden");
> ???????????????????????var menuitem7 = new menu(7,7,"hidden");
> ???// -->
> ???</script>
> </body>
> </html>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210816/a5c3222c/attachment.htm>

From Antony.Stone at squid.open.source.it  Mon Aug 16 15:23:17 2021
From: Antony.Stone at squid.open.source.it (Antony Stone)
Date: Mon, 16 Aug 2021 17:23:17 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
Message-ID: <202108161723.17450.Antony.Stone@squid.open.source.it>

On Monday 16 August 2021 at 17:03:57, Peter Thesing wrote:

> Hi,
> 
> If there is a a need for additional information please let me know?!

Some additional information would be good, and a lot less HTML would be good 
too :)  Just a comment "I got the expected content" is sufficient...

> I am using opensuse 15.1 with 2 network interface cards and apache is
> working squid is active , but giving me the results I need.

Are you using Squid to connect to Apache on that machine, or using Squid to 
connect out to the Internet in general?

In other words, what is the relevance of Apache running on this machine?

Also, I do not understand the word "but" in your sentence (but maybe this is 
just a language thing).  It makes it sound to me as though something is not 
quite right, but then you say "giving you the results you need", so it's 
working nicely?

> On my second machine also fitted with opensuse 15.1 but with no internet
> would be able via a proxy e.g. squid to connect to the internet but
> despite all my efforts to no avail.

Tell us a little about your network arrangement:

1. What's the IP address of the client machine (the one with no direct 
Internet connection)?

2. What's the internal IP address of the machine running Squid (no need to 
tell us its public IP address)?

> When I installed windows 10 it works but on opensuse not?

On the same physical server?

> This I got when using squidclient:
> 
> server:/home/peter #squidclient http://peterspretpaleis.xs4all.nl

Is "server" the machine with Squid running on it?

> HTTP/1.1 200 OK

Okay, so it works - no need to show us hundreds of lines of web page source 
code :)

What we do need to see though is:

1. How are you testing from the machine that does not work?

2. What shows up in Squid's log files when you try to access a site from the 
machine that does not work?

3. What changes have you made to the default Squid configuration file (please do 
not send us the entire file - at most please just show us the non-comment 
lines)?

On Monday 16 August 2021 at 17:06:39, Peter Thesing wrote:

> By the way the firewall is off

Which firewall?

Do you have a public IP address on your Squid server?  If so I strongly 
recommend that you turn your firewall back on again.


Regards,


Antony.

-- 
"It is easy to be blinded to the essential uselessness of them by the sense of 
achievement you get from getting them to work at all. In other words - and 
this is the rock solid principle on which the whole of the Corporation's 
Galaxy-wide success is founded - their fundamental design flaws are completely 
hidden by their superficial design flaws."

 - Douglas Noel Adams

                                                   Please reply to the list;
                                                         please *don't* CC me.


From peterthesing at gmail.com  Mon Aug 16 16:09:12 2021
From: peterthesing at gmail.com (Peter Thesing)
Date: Mon, 16 Aug 2021 18:09:12 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <202108161723.17450.Antony.Stone@squid.open.source.it>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161723.17450.Antony.Stone@squid.open.source.it>
Message-ID: <1a2ccf56-94fc-402f-4afe-e1d9268a3096@gmail.com>

Hi,

English is not my native tongue so I am sorry for any mistakes that I've 
made or will make in the future.

To answer your questions:

Both apache and suid are running of the same machine. This I like to 
call the server.

Then on another machine, lets call it the client,? there is also 
opensuse 15.1 but with another purpose. When this client is directly 
connected to the internet is cannot connect to the server.

The relevance of apache is that on some mysterious way I would be able 
to check if squid is working but I just installed it and I have to 
figure this one out.

DHCP and DNS are working. The client machine gets an IP address from the 
server.

On the second card i have designated an ip address which is 192.168.1.1 
and the range on which the client computers can connect 192.168.1.20 
through 192.168.1.50.

When using squid in firefox it should connect to http://192.168.1.1:3128

but it does not...

Question:

Where are the log files?

How do I read the log files?

What log-files are relevant to answer the mystery of not connecting?

the firewall is off and stays off. I have only the ports 21, 80 and 443 
open.

Op 16-08-2021 om 17:23 schreef Antony Stone:
> On Monday 16 August 2021 at 17:03:57, Peter Thesing wrote:
>
>> Hi,
>>
>> If there is a a need for additional information please let me know?!
> Some additional information would be good, and a lot less HTML would be good
> too :)  Just a comment "I got the expected content" is sufficient...
>
>> I am using opensuse 15.1 with 2 network interface cards and apache is
>> working squid is active , but giving me the results I need.
> Are you using Squid to connect to Apache on that machine, or using Squid to
> connect out to the Internet in general?
>
> In other words, what is the relevance of Apache running on this machine?
>
> Also, I do not understand the word "but" in your sentence (but maybe this is
> just a language thing).  It makes it sound to me as though something is not
> quite right, but then you say "giving you the results you need", so it's
> working nicely?
>
>> On my second machine also fitted with opensuse 15.1 but with no internet
>> would be able via a proxy e.g. squid to connect to the internet but
>> despite all my efforts to no avail.
> Tell us a little about your network arrangement:
>
> 1. What's the IP address of the client machine (the one with no direct
> Internet connection)?
>
> 2. What's the internal IP address of the machine running Squid (no need to
> tell us its public IP address)?
>
>> When I installed windows 10 it works but on opensuse not?
> On the same physical server?
>
>> This I got when using squidclient:
>>
>> server:/home/peter #squidclient http://peterspretpaleis.xs4all.nl
> Is "server" the machine with Squid running on it?
>
>> HTTP/1.1 200 OK
> Okay, so it works - no need to show us hundreds of lines of web page source
> code :)
>
> What we do need to see though is:
>
> 1. How are you testing from the machine that does not work?
>
> 2. What shows up in Squid's log files when you try to access a site from the
> machine that does not work?
>
> 3. What changes have you made to the default Squid configuration file (please do
> not send us the entire file - at most please just show us the non-comment
> lines)?
>
> On Monday 16 August 2021 at 17:06:39, Peter Thesing wrote:
>
>> By the way the firewall is off
> Which firewall?
>
> Do you have a public IP address on your Squid server?  If so I strongly
> recommend that you turn your firewall back on again.
>
>
> Regards,
>
>
> Antony.
>


From Antony.Stone at squid.open.source.it  Mon Aug 16 16:54:36 2021
From: Antony.Stone at squid.open.source.it (Antony Stone)
Date: Mon, 16 Aug 2021 18:54:36 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <1a2ccf56-94fc-402f-4afe-e1d9268a3096@gmail.com>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161723.17450.Antony.Stone@squid.open.source.it>
 <1a2ccf56-94fc-402f-4afe-e1d9268a3096@gmail.com>
Message-ID: <202108161854.36813.Antony.Stone@squid.open.source.it>

On Monday 16 August 2021 at 18:09:12, Peter Thesing wrote:

> Hi,
> 
> English is not my native tongue so I am sorry for any mistakes that I've
> made or will make in the future.

That's not problem - I just wanted to make sure I understood your meaning 
(which I did).

> Both apache and squid are running of the same machine. This I like to
> call the server.

Sounds good to me.

> Then on another machine, lets call it the client,  there is also
> opensuse 15.1 but with another purpose. When this client is directly
> connected to the internet is cannot connect to the server.

I do not understand that part.  Why can you not have two machines on one 
network which can both connect to the Internet and also connect to each other?

How does each machine connect to the Internet?

> The relevance of apache is that on some mysterious way I would be able
> to check if squid is working but I just installed it and I have to
> figure this one out.

I would suggest that the best way to find out whether Squid is working is 
either to use Squid itself, or to check whether it is listening on port 3128, 
or perhaps even use something like Icinga2 (although that's prbably going a 
bit far just to "find out whether Squid is working").

> DHCP and DNS are working. The client machine gets an IP address from the
> server.

So, the client machien gets an IP address from the server by DHCP, and it gets 
told to ask the server for DNS queries (which the server then performs and 
returns the results)?

> On the second card i have designated an ip address which is 192.168.1.1
> and the range on which the client computers can connect 192.168.1.20
> through 192.168.1.50.

So, it sounds as though you are using the server as a router, with a public 
address on one interface and a private address on the other.  This doesn't 
explain to me why the client cannot access the Internet through the server, 
acting as a router.

> When using squid in firefox it should connect to http://192.168.1.1:3128
> but it does not...

You mean, it does not even connect to the proxy, or it does connect and the 
proxy does not work correctly, so you get no content from Internet websites?

> Question:
> 
> Where are the log files?

Usually, /var/log/squid/*.log

> How do I read the log files?

less?  cat?  vim?  grep?

> What log-files are relevant to answer the mystery of not connecting?

I would start with access.log.

> the firewall is off and stays off. I have only the ports 21, 80 and 443
> open.

Oh, that is far from my definition of "off".  It means your firewall is active, 
and blocking connections other than FTP (why???), HTTP and HTTPS.

Is this firewall running on your "server" or on some modem/router which the 
server uses to connect to the Internet?

If these firewall rules are on your "server", is there a rule allowing the 
client machine/s to connect to Squid on port 3128?

Further questions:

1. How are you testing from the client machine?  What exactly happens when you 
try?

2. What shows up in Squid's access.log when you attempt to connect from the 
client machine?

3. What changes have you made to the default Squid configuration file?

And, while we're at it:

4. Are you trying to implement Squid purely in order to give the client 
machine access to the Internet, simply because otherwise it cannot?  If that 
is the case, why not simply route the client machine through the server so 
that the client can access the Internet directly?


Antony.

-- 
I thought of going into banking, until I lost interest.

                                                   Please reply to the list;
                                                         please *don't* CC me.


From peterthesing at gmail.com  Mon Aug 16 17:28:55 2021
From: peterthesing at gmail.com (Peter Thesing)
Date: Mon, 16 Aug 2021 19:28:55 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <202108161854.36813.Antony.Stone@squid.open.source.it>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161723.17450.Antony.Stone@squid.open.source.it>
 <1a2ccf56-94fc-402f-4afe-e1d9268a3096@gmail.com>
 <202108161854.36813.Antony.Stone@squid.open.source.it>
Message-ID: <96d7bd0a-99c5-969a-e18e-3f31b6376d59@gmail.com>

Because I have a multi port modem/router

a fritz.box 7581

My ISP does not support samba on their network

Samba can be used for remote printer support among others

It would be nice if I can http support thrown in the mix so I can use 
internet.

On your question using 1 internet and one server and multiple clients:

It is my wish to have? 1 internet access point

using one server

using multiple computers who connect to one server who connect to one 
internet access

This is as clear as I can paint this, if not please tell me how can I 
clarify this.


Op 16-08-2021 om 18:54 schreef Antony Stone:
> On Monday 16 August 2021 at 18:09:12, Peter Thesing wrote:
>
>> Hi,
>>
>> English is not my native tongue so I am sorry for any mistakes that I've
>> made or will make in the future.
> That's not problem - I just wanted to make sure I understood your meaning
> (which I did).
>
>> Both apache and squid are running of the same machine. This I like to
>> call the server.
> Sounds good to me.
>
>> Then on another machine, lets call it the client,  there is also
>> opensuse 15.1 but with another purpose. When this client is directly
>> connected to the internet is cannot connect to the server.
> I do not understand that part.  Why can you not have two machines on one
> network which can both connect to the Internet and also connect to each other?
>
> How does each machine connect to the Internet?
>
>> The relevance of apache is that on some mysterious way I would be able
>> to check if squid is working but I just installed it and I have to
>> figure this one out.
> I would suggest that the best way to find out whether Squid is working is
> either to use Squid itself, or to check whether it is listening on port 3128,
> or perhaps even use something like Icinga2 (although that's prbably going a
> bit far just to "find out whether Squid is working").
>
>> DHCP and DNS are working. The client machine gets an IP address from the
>> server.
> So, the client machien gets an IP address from the server by DHCP, and it gets
> told to ask the server for DNS queries (which the server then performs and
> returns the results)?
>
>> On the second card i have designated an ip address which is 192.168.1.1
>> and the range on which the client computers can connect 192.168.1.20
>> through 192.168.1.50.
> So, it sounds as though you are using the server as a router, with a public
> address on one interface and a private address on the other.  This doesn't
> explain to me why the client cannot access the Internet through the server,
> acting as a router.
That is why I am asking this group
>> When using squid in firefox it should connect to http://192.168.1.1:3128
>> but it does not...
> You mean, it does not even connect to the proxy, or it does connect and the
> proxy does not work correctly, so you get no content from Internet websites?
>
That is correct!
>> Question:
>>
>> Where are the log files?
> Usually, /var/log/squid/*.log
>
>> How do I read the log files?
> less?  cat?  vim?  grep?
>
>> What log-files are relevant to answer the mystery of not connecting?
> I would start with access.log.
>
>> the firewall is off and stays off. I have only the ports 21, 80 and 443
>> open.
> Oh, that is far from my definition of "off".  It means your firewall is active,
> and blocking connections other than FTP (why???), HTTP and HTTPS.
>
> Is this firewall running on your "server" or on some modem/router which the
> server uses to connect to the Internet?
>
> If these firewall rules are on your "server", is there a rule allowing the
> client machine/s to connect to Squid on port 3128?
>
> Further questions:
>
> 1. How are you testing from the client machine?  What exactly happens when you
> try?
>
> 2. What shows up in Squid's access.log when you attempt to connect from the
> client machine?
>
> 3. What changes have you made to the default Squid configuration file?
>
> And, while we're at it:
>
> 4. Are you trying to implement Squid purely in order to give the client
> machine access to the Internet, simply because otherwise it cannot?  If that
> is the case, why not simply route the client machine through the server so
> that the client can access the Internet directly?
>
>
> Antony.
>


From Antony.Stone at squid.open.source.it  Mon Aug 16 18:57:26 2021
From: Antony.Stone at squid.open.source.it (Antony Stone)
Date: Mon, 16 Aug 2021 20:57:26 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <96d7bd0a-99c5-969a-e18e-3f31b6376d59@gmail.com>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161854.36813.Antony.Stone@squid.open.source.it>
 <96d7bd0a-99c5-969a-e18e-3f31b6376d59@gmail.com>
Message-ID: <202108162057.26748.Antony.Stone@squid.open.source.it>

On Monday 16 August 2021 at 19:28:55, Peter Thesing wrote:

> Because I have a multi port modem/router
> a fritz.box 7581

I have a Fritz.Box 6360, not so different.

> My ISP does not support samba on their network
> 
> Samba can be used for remote printer support among others

Yes, I am familiar with Samba, but why would you want to run that over your 
ISP's network?

Please tell me:

a) where is the computer you want to print from?

b) where is the printer you want to print to?

> It would be nice if I can http support thrown in the mix so I can use
> internet.

So, you want your client computer to be able to access websites?

> On your question using 1 internet and one server and multiple clients:
> 
> It is my wish to have  1 internet access point
> 
> using one server
> 
> using multiple computers who connect to one server who connect to one
> internet access

Okay, I am going to question the word "connect"...

Are you *just* talking about wanting your client computer to connect to 
*websites* on the Internet, or would you like to be able to use SSH to log in 
to remote machines, maybe have streaming audio for things like Deezer or 
Spotify. or perhaps other things than simply HTTP and HTTPS?

I ask because it sounds to me as though you have a classic Network Address 
Translation router situation:

 - one machine (your "server") which has a public IP address on its external 
interface (the one connected to the Fritz.Box), and a private address 
192.168.1.1 on its internal interface

 - another machine (your "client") which gets an IP address by DHCP from your 
server, and which is also presumably given the server's IP address 192.168.1.1 
as its gateway router address

So, if you *do* want all traffci from your client machine to pass through your 
server machine, I think you should configure this server to:

1. forward network packets between the two interfaces

2. apply Network Address Translation to packets leaving the external 
interface, so that they appear to come from its own address and not that of 
the client machine.

If you need further guidance with setting up something like this, there are 
many tutorials and guides on the Internet about setting up a "NAT Router" 
using Linux.

I think this will be a far more useful and appropriate solution for you than 
using Squid.


However, I do have a further question for you.  The Fritz.Box 7581 has 4 
gigabit ethernet ports on it for internal equipment.

Why do you not simply connect your "server" to one port and your "client" to 
another port, so that they can both connect to the Internet, and also to each 
other?

That would, to me, seem to be the simplest solution to what I think you are 
trying to do.


If my suggestions so far do not seem to help with your problem, then please 
answer some of my earlier questions about how you are testing Squid from the 
client computer and what appears in Squid's log files when you do so.


Regards,


Antony.

-- 
"Good health" is merely the slowest rate at which you can die.

                                                   Please reply to the list;
                                                         please *don't* CC me.


From twgknuicfh14 at gmail.com  Tue Aug 17 06:25:34 2021
From: twgknuicfh14 at gmail.com (=?UTF-8?B?5piT6ZOt?=)
Date: Tue, 17 Aug 2021 15:25:34 +0900
Subject: [squid-users] Two questions about cache for squid authentication
Message-ID: <CAGDcAjO4dhoWE3-vATa5Q0XXyTnoN0MLnVaQk0D28uOyNYBLYw@mail.gmail.com>

Dear all,



I have two questions about cache for squid authentication.



1. Can I skip authentication for a certain period of time after I've
authenticated once?



When I do the following, the authentication screen appears.



Start browser -> access site after authentication (Kerberos authentication)
-> close browser -> start another application (LDAP authentication)



So, even using Kerberos and LDAP auth at the same time, I want to skip the
authentication process by clientIPaddress, etc.



2. About authentication data passing in NTLM authentication on website.



SingleSignOn is not working for some sites with NTLM authentication.



For example, when the authentication pop-up message appears, you can enter
the auth information to access the page, but if you visit a different URL,
you will be prompted to authenticate again.



Can someone give me some advice?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210817/260023b1/attachment.htm>

From squid3 at treenet.co.nz  Tue Aug 17 07:40:21 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 17 Aug 2021 19:40:21 +1200
Subject: [squid-users] Two questions about cache for squid authentication
In-Reply-To: <CAGDcAjO4dhoWE3-vATa5Q0XXyTnoN0MLnVaQk0D28uOyNYBLYw@mail.gmail.com>
References: <CAGDcAjO4dhoWE3-vATa5Q0XXyTnoN0MLnVaQk0D28uOyNYBLYw@mail.gmail.com>
Message-ID: <821d2746-46d4-d45a-6ada-dd16c5692d4b@treenet.co.nz>

On 17/08/21 6:25 pm, ?? wrote:
> Dear all,
> 
> I have two questions about cache for squid authentication.
> 
> 1. Can I skip authentication for a certain period of time after I've 
> authenticated once?
> 
> When I do the following, the authentication screen appears.
> 
> Start browser -> access site after authentication (Kerberos 
> authentication) -> close browser -> start another application (LDAP 
> authentication)
> 

Negotiate/Kerberos authentication authenticates the TCP connection. All 
messages on that connection require the Kerberos tokens to prove it is 
valid on that connection.


> So, even using Kerberos and LDAP auth at the same time, I want to skip 
> the authentication process by clientIPaddress, etc.
> 

This is authorization *not* authentication.


> 2. About authentication data passing in NTLM authentication on website.
> 

NTLM, just like Negotiate/Kerberos authenticates the TCP connection and 
requires all messages to have teh appropriate tokens.


> SingleSignOn is not working for some sites with NTLM authentication.
> 

That is a Browser issue. "single sign-on" is a behaviour of clients, 
where they choose to send the same credentials to all services. It has 
nothing to do with the service like Squid.


> For example, when the authentication pop-up message appears, you can 
> enter the auth information to access the page, but if you visit a 
> different URL, you will be prompted to authenticate again.
> 
> Can someone give me some advice?
> 

The client doing that is broken or confused.

Maybe the confusion happened because of your mixed up squid config 
rules. Or maybe not. You have not provided any information about your 
squid.conf, network topology, or how the clients are using the proxy - 
so we cannot tell.

Amos


From belle at bazuin.nl  Tue Aug 17 09:11:54 2021
From: belle at bazuin.nl (=?windows-1252?Q?L.P.H._van_Belle?=)
Date: Tue, 17 Aug 2021 11:11:54 +0200
Subject: [squid-users] [Samba] Two questions about cache for squid
 authentication
In-Reply-To: <vmime.611b7831.52b7.1c1b63574a16e4c1@ms249-lin-003.rotterdam.bazuin.nl>
References: <821d2746-46d4-d45a-6ada-dd16c5692d4b@treenet.co.nz>
Message-ID: <vmime.611b7d5a.7172.a46976f207ff869@ms249-lin-003.rotterdam.bazuin.nl>


> 
> Small Addon here. 
> 
> NTLM V1 and V2.. 
> Most uses still NTLMv1 but thats being disabled in windows 
> and samba these days. 
> 
> 
> To make sure you do use NTLMv2. 
> With Samba 4.2.x and up, use the following setting on the 
> Squid and/or Freeradius
> and on all the Samba AD-DC's and involved members that use ntlm_auth
> 
> Per example :
> Add to the [global] section of smb.conf 
> 
> ntlm auth = mschapv2-and-ntlmv2-only
> 
> And add in the client commands : "/path/to/ntlm_auth 
> --allow-mschapv2 "
> 
> But, personaly i would recommend to move to kerberos auth. 
> 
> Greetz, 
> 
> Louis
> 
>  
> 
> > -----Oorspronkelijk bericht-----
> > Van: squid-users 
> > [mailto:squid-users-bounces at lists.squid-cache.org] Namens 
> > Amos Jeffries
> > Verzonden: dinsdag 17 augustus 2021 9:40
> > Aan: squid-users at lists.squid-cache.org
> > Onderwerp: Re: [squid-users] Two questions about cache for 
> > squid authentication
> > 
> > On 17/08/21 6:25 pm, ?????? wrote:
> > > Dear all,
> > > 
> > > I have two questions about cache for squid authentication.
> > > 
> > > 1. Can I skip authentication for a certain period of time 
> > after I've 
> > > authenticated once?
> > > 
> > > When I do the following, the authentication screen appears.
> > > 
> > > Start browser -> access site after authentication (Kerberos 
> > > authentication) -> close browser -> start another 
> application (LDAP 
> > > authentication)
> > > 
> > 
> > Negotiate/Kerberos authentication authenticates the TCP 
> > connection. All 
> > messages on that connection require the Kerberos tokens to 
> > prove it is 
> > valid on that connection.
> > 
> > 
> > > So, even using Kerberos and LDAP auth at the same time, I 
> > want to skip 
> > > the authentication process by clientIPaddress, etc.
> > > 
> > 
> > This is authorization *not* authentication.
> > 
> > 
> > > 2. About authentication data passing in NTLM authentication 
> > on website.
> > > 
> > 
> > NTLM, just like Negotiate/Kerberos authenticates the TCP 
> > connection and 
> > requires all messages to have teh appropriate tokens.
> > 
> > 
> > > SingleSignOn is not working for some sites with NTLM 
> authentication.
> > > 
> > 
> > That is a Browser issue. "single sign-on" is a behaviour of 
> clients, 
> > where they choose to send the same credentials to all 
> > services. It has 
> > nothing to do with the service like Squid.
> > 
> > 
> > > For example, when the authentication pop-up message 
> > appears, you can 
> > > enter the auth information to access the page, but if you visit a 
> > > different URL, you will be prompted to authenticate again.
> > > 
> > > Can someone give me some advice?
> > > 
> > 
> > The client doing that is broken or confused.
> > 
> > Maybe the confusion happened because of your mixed up squid config 
> > rules. Or maybe not. You have not provided any information 
> about your 
> > squid.conf, network topology, or how the clients are using 
> > the proxy - 
> > so we cannot tell.
> > 
> > Amos
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
> > 
> 
> 
> -- 
> To unsubscribe from this list go to the following URL and read the
> instructions:  https://lists.samba.org/mailman/options/samba
> 
> 



From ngtech1ltd at gmail.com  Tue Aug 17 10:54:24 2021
From: ngtech1ltd at gmail.com (Eliezer Croitoru)
Date: Tue, 17 Aug 2021 13:54:24 +0300
Subject: [squid-users] [squid-announce] Squid 4.16 is available
In-Reply-To: <860aceb6-9cb4-049f-e683-9d288a876f79@treenet.co.nz>
References: <860aceb6-9cb4-049f-e683-9d288a876f79@treenet.co.nz>
Message-ID: <000001d79356$3f3d6e20$bdb84a60$@gmail.com>

Hey Amos,

I started testing the latest squid versions.
It will probably will take more time then usual and I hope the RPMs will be
ready tomorrow.

Eliezer 

-----Original Message-----
From: squid-announce <squid-announce-bounces at lists.squid-cache.org> On
Behalf Of Amos Jeffries
Sent: Thursday, July 22, 2021 7:24 AM
To: squid-announce at lists.squid-cache.org
Subject: [squid-announce] Squid 4.16 is available

The Squid HTTP Proxy team is very pleased to announce the availability
of the Squid-4.16 release!


This release is a bug fix release resolving several issues found in
the prior Squid releases.


The major changes to be aware of since 4.15:

  * Regression Fix: --with-valgrind-debug build

Squid-4.15 changes caused a build failure linking with valgrind
memory tracking tool. This release fixes that to allow memory
leak tracing again.


  * Bug 4528: ICAP transactions quit on async DNS lookups

Squid has never reliably been able to resolve hostnames configured
for ICAP services. They might work most of the time when added to
/etc/hosts, but not always - and would rarely work if relying on
remote DNS servers.

This release adds full support for DNS remote resolution of
service names in icap_service directive. Regardless of where the
hostname is resolved from it can now be expected to resolve and
also properly obey DNS TTL expiry for IP address changes.


  * Bug 5128: Translation: Fix '% i' typo in es/ERR_FORWARDING_DENIED

Spanish translation of the ERR_FORWARDING_DENIED template have
for some time omitted the URL which was having issues being fetched.
The template published with this release and current squid-langpack
downloads will now display the URL identically to other error pages.


   All users of Squid are encouraged to upgrade as soon as possible.


See the ChangeLog for the full list of changes in this and earlier
releases.

Please refer to the release notes at
http://www.squid-cache.org/Versions/v4/RELEASENOTES.html
when you are ready to make the switch to Squid-4

This new release can be downloaded from our HTTP or FTP servers

   http://www.squid-cache.org/Versions/v4/
   ftp://ftp.squid-cache.org/pub/squid/
   ftp://ftp.squid-cache.org/pub/archive/4/

or the mirrors. For a list of mirror sites see

   http://www.squid-cache.org/Download/http-mirrors.html
   http://www.squid-cache.org/Download/mirrors.html

If you encounter any issues with this release please file a bug report.
   http://bugs.squid-cache.org/


Amos Jeffries
_______________________________________________
squid-announce mailing list
squid-announce at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-announce



From pserrat.sq at gmail.com  Tue Aug 17 19:20:34 2021
From: pserrat.sq at gmail.com (Pavel Serrat)
Date: Tue, 17 Aug 2021 15:20:34 -0400
Subject: [squid-users] about logformat (Antony Stone)(Alex Rousskov)
Message-ID: <CANr9W_ZtMq9QGt14NjfGZMcA+WH=vyEs1j5ExurDUrjuk=Q7Ng@mail.gmail.com>

Oh thanks very much you two, You have helped me a lot, God bless you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210817/c5fa3280/attachment.htm>

From peterthesing at gmail.com  Wed Aug 18 14:50:20 2021
From: peterthesing at gmail.com (Peter Thesing)
Date: Wed, 18 Aug 2021 16:50:20 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <202108161854.36813.Antony.Stone@squid.open.source.it>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161723.17450.Antony.Stone@squid.open.source.it>
 <1a2ccf56-94fc-402f-4afe-e1d9268a3096@gmail.com>
 <202108161854.36813.Antony.Stone@squid.open.source.it>
Message-ID: <c9826147-469e-30c8-39c6-32269ace819d@gmail.com>

Because I have a multi port modem/router that connects to the internet.

p 16-08-2021 om 18:54 schreef Antony Stone:
> On Monday 16 August 2021 at 18:09:12, Peter Thesing wrote:
>
>> Hi,
>>
>> English is not my native tongue so I am sorry for any mistakes that I've
>> made or will make in the future.
> That's not problem - I just wanted to make sure I understood your meaning
> (which I did).
>
>> Both apache and squid are running of the same machine. This I like to
>> call the server.
> Sounds good to me.
>
>> Then on another machine, lets call it the client,  there is also
>> opensuse 15.1 but with another purpose. When this client is directly
>> connected to the internet is cannot connect to the server.
> I do not understand that part.  Why can you not have two machines on one
> network which can both connect to the Internet and also connect to each other?
>
> How does each machine connect to the Internet?
>
>> The relevance of apache is that on some mysterious way I would be able
>> to check if squid is working but I just installed it and I have to
>> figure this one out.
> I would suggest that the best way to find out whether Squid is working is
> either to use Squid itself, or to check whether it is listening on port 3128,
> or perhaps even use something like Icinga2 (although that's prbably going a
> bit far just to "find out whether Squid is working").
>
>> DHCP and DNS are working. The client machine gets an IP address from the
>> server.
> So, the client machien gets an IP address from the server by DHCP, and it gets
> told to ask the server for DNS queries (which the server then performs and
> returns the results)?
>
>> On the second card i have designated an ip address which is 192.168.1.1
>> and the range on which the client computers can connect 192.168.1.20
>> through 192.168.1.50.
> So, it sounds as though you are using the server as a router, with a public
> address on one interface and a private address on the other.  This doesn't
> explain to me why the client cannot access the Internet through the server,
> acting as a router.
>
>> When using squid in firefox it should connect tohttp://192.168.1.1:3128
>> but it does not...
> You mean, it does not even connect to the proxy, or it does connect and the
> proxy does not work correctly, so you get no content from Internet websites?
>
>> Question:
>>
>> Where are the log files?
> Usually, /var/log/squid/*.log
>
>> How do I read the log files?
> less?  cat?  vim?  grep?
>
>> What log-files are relevant to answer the mystery of not connecting?
> I would start with access.log.
>
>> the firewall is off and stays off. I have only the ports 21, 80 and 443
>> open.
> Oh, that is far from my definition of "off".  It means your firewall is active,
> and blocking connections other than FTP (why???), HTTP and HTTPS.
>
> Is this firewall running on your "server" or on some modem/router which the
> server uses to connect to the Internet?
>
> If these firewall rules are on your "server", is there a rule allowing the
> client machine/s to connect to Squid on port 3128?
>
> Further questions:
>
> 1. How are you testing from the client machine?  What exactly happens when you
> try?
>
> 2. What shows up in Squid's access.log when you attempt to connect from the
> client machine?
>
> 3. What changes have you made to the default Squid configuration file?
>
> And, while we're at it:
>
> 4. Are you trying to implement Squid purely in order to give the client
> machine access to the Internet, simply because otherwise it cannot?  If that
> is the case, why not simply route the client machine through the server so
> that the client can access the Internet directly?
>
>
> Antony.
>


From Antony.Stone at squid.open.source.it  Wed Aug 18 15:10:00 2021
From: Antony.Stone at squid.open.source.it (Antony Stone)
Date: Wed, 18 Aug 2021 17:10:00 +0200
Subject: [squid-users] Squid is active but not working
In-Reply-To: <c9826147-469e-30c8-39c6-32269ace819d@gmail.com>
References: <e6085350-107e-a927-a6d7-f431906fac37@gmail.com>
 <202108161854.36813.Antony.Stone@squid.open.source.it>
 <c9826147-469e-30c8-39c6-32269ace819d@gmail.com>
Message-ID: <202108181710.00819.Antony.Stone@squid.open.source.it>

On Wednesday 18 August 2021 at 16:50:20, Peter Thesing wrote:

> Because I have a multi port modem/router that connects to the internet.

Sorry, I'm not sure I follow which question that is an answer to.

But anyway, why don't you just plug your two machines (the "client" and the 
"server") each into a separate port of the router, then they can both access 
the Internet, and they can both see each other?

That would seem to me to be the simplest way of getting communication between 
everything.


Antony.

-- 
I wasn't sure about having a beard at first, but then it grew on me.

                                                   Please reply to the list;
                                                         please *don't* CC me.


From pheriko.support at gmail.com  Wed Aug 18 16:12:16 2021
From: pheriko.support at gmail.com (Periko Support)
Date: Wed, 18 Aug 2021 09:12:16 -0700
Subject: [squid-users] Squid v4.45
Message-ID: <CAK2yrTbKqjz7j0m+11Vb1qk=epAooCBH5RFA_jke+kXd9LohGw@mail.gmail.com>

Hello guys.

I have been searching the issue I have with windows 10 and the ugly
job he do to put the NIC "Internet access" and went we have squid
behind "no internet".

I have sniff logs and  I just found this sites went I turn on the computer:

.msftconnecttest.com
.windows.com

Some has win over this annoying thing with windows 10?

No-Trans[parent Proxy WPAD.

Regards!!!


From lucas.wxp at gmail.com  Thu Aug 19 13:53:49 2021
From: lucas.wxp at gmail.com (Lucas Pelegrino)
Date: Thu, 19 Aug 2021 10:53:49 -0300
Subject: [squid-users] How to make each user go to different cache_peer
Message-ID: <CAKnU09_c2MMVMK=hrgwZb+tpwDa5A_4EyMtRRhQYn37TbMj8CA@mail.gmail.com>

Hey guys.

I'm trying to loadbalance my cache_peers based on which user is
authenticated, so far this is what I came up with using the "userhash"
loadbalance method:

cache_peer localhost parent 6667 0 no-query userhash name=proxy1
cache_peer localhost parent 6668 0 no-query userhash name=proxy2

This works, the same user is always sent to the same cache_peer, but the
thing is I want specific users to go through specific peers.

For instance, user "dummy1" will always go to "proxy1" and user "dummy2"
will go to "proxy2".

Is that possible?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210819/c612cfcb/attachment.htm>

From rousskov at measurement-factory.com  Thu Aug 19 15:26:09 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Thu, 19 Aug 2021 11:26:09 -0400
Subject: [squid-users] How to make each user go to different cache_peer
In-Reply-To: <CAKnU09_c2MMVMK=hrgwZb+tpwDa5A_4EyMtRRhQYn37TbMj8CA@mail.gmail.com>
References: <CAKnU09_c2MMVMK=hrgwZb+tpwDa5A_4EyMtRRhQYn37TbMj8CA@mail.gmail.com>
Message-ID: <7f873cba-2c94-03c1-535e-16757c7c294c@measurement-factory.com>

On 8/19/21 9:53 AM, Lucas Pelegrino wrote:
> Hey guys.
> 
> I'm trying to loadbalance my cache_peers based on which user is
> authenticated, so far this is what I came up with using the "userhash"
> loadbalance method:
> 
> cache_peer localhost parent 6667 0 no-query userhash name=proxy1
> cache_peer localhost parent 6668 0 no-query userhash name=proxy2
> 
> This works, the same user is always sent to the same cache_peer, but the
> thing is I want specific users to go through specific peers.
> 
> For instance, user "dummy1" will always go to "proxy1" and user "dummy2"
> will go to "proxy2".

Sure. Remove userhash loadbalancing and use cache_peer_access to select
the right peer for each transaction.

Alex.



From squid3 at treenet.co.nz  Fri Aug 20 02:36:47 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 20 Aug 2021 14:36:47 +1200
Subject: [squid-users] Squid v4.45
In-Reply-To: <CAK2yrTbKqjz7j0m+11Vb1qk=epAooCBH5RFA_jke+kXd9LohGw@mail.gmail.com>
References: <CAK2yrTbKqjz7j0m+11Vb1qk=epAooCBH5RFA_jke+kXd9LohGw@mail.gmail.com>
Message-ID: <72e56d70-e721-bf71-f135-0a75d985f034@treenet.co.nz>


FYI, there is no such version as Squid 4.45.

What is the output when you run "squid -v" ?


On 19/08/21 4:12 am, Periko Support wrote:
> Hello guys.
> 
> I have been searching the issue I have with windows 10 and the ugly
> job he do to put the NIC "Internet access" and went we have squid
> behind "no internet".
> 

The NIC status simply says that *somehow* the Internet is available. 
that means DNS resolution, TCP connectivity, HTTP transactions and HTTPS 
transactions are all fully working and producing responses.

Break any one and you will get "no internet". Even when the rest 
continue working fine. So it can tell you when some sort of failure 
occurs, but is not reliable when it claims success.


Please be aware that using your Squid proxy properly is one way Windows 
can receive all those services and claim "Internet Access".


> I have sniff logs and  I just found this sites went I turn on the computer:
> 
> .msftconnecttest.com
> .windows.com
> 
> Some has win over this annoying thing with windows 10?
> 
> No-Trans[parent Proxy WPAD.
> 

Check that your firewall does not permit HTTP(S) connections directly 
from clients to the Internet.

When;
  * your network gateway firewall(s) block direct connections (other 
than from Squid) to HTTP(S), and
  * your proxy logs show those Win10 connection URLs happening, and
  * Win10 NIC says "Interent Access"

Then you know that the proxy usage is how "Internet Access" happens, 
that is what you want so no problem.


Amos


From pheriko.support at gmail.com  Mon Aug 23 05:54:44 2021
From: pheriko.support at gmail.com (Periko Support)
Date: Sun, 22 Aug 2021 22:54:44 -0700
Subject: [squid-users] Squid v4.45
In-Reply-To: <72e56d70-e721-bf71-f135-0a75d985f034@treenet.co.nz>
References: <CAK2yrTbKqjz7j0m+11Vb1qk=epAooCBH5RFA_jke+kXd9LohGw@mail.gmail.com>
 <72e56d70-e721-bf71-f135-0a75d985f034@treenet.co.nz>
Message-ID: <CAK2yrTahsbEM_6UkWcrFSoMEkRH_Tz-3mzbf+e5gREiEbkOY9w@mail.gmail.com>

On Thu, Aug 19, 2021 at 7:40 PM Amos Jeffries <squid3 at treenet.co.nz> wrote:
>
>
> FYI, there is no such version as Squid 4.45.

Amos sorry, is 4.15 my mistake.
>
> What is the output when you run "squid -v" ?
>
 squid -v
Squid Cache: Version 4.15
Service Name: squid

This binary uses OpenSSL 1.1.1k-freebsd  25 Mar 2021. For legal
restrictions on distribution see
https://www.openssl.org/source/license.html

configure options:  '--with-default-user=squid'
'--bindir=/usr/local/sbin' '--sbindir=/usr/local/sbin'
'--datadir=/usr/local/etc/squid'
'--libexecdir=/usr/local/libexec/squid' '--localstatedir=/var'
'--sysconfdir=/usr/local/etc/squid' '--with-logdir=/var/log/squid'
'--with-pidfile=/var/run/squid/squid.pid'
'--with-swapdir=/var/squid/cache' '--without-gnutls'
'--with-included-ltdl' '--enable-auth' '--enable-zph-qos'
'--enable-build-info' '--enable-loadable-modules'
'--enable-removal-policies=lru heap' '--disable-epoll'
'--disable-linux-netfilter' '--disable-linux-tproxy'
'--disable-translation' '--disable-arch-native'
'--disable-strict-error-checking' '--enable-eui'
'--enable-cache-digests' '--enable-delay-pools' '--disable-ecap'
'--disable-esi' '--enable-follow-x-forwarded-for'
'--with-mit-krb5=/usr/local' 'CFLAGS=-I/usr/local/include -O2 -pipe
-I/usr/local/include -I/usr/local/include -fstack-protector-strong
-DLDAP_DEPRECATED -fno-strict-aliasing ' 'LDFLAGS=-L/usr/local/lib
-L/usr/local/lib -L/usr/local/lib -pthread -L/usr/local/lib
-lpcreposix -lpcre -Wl,-rpath,/usr/local/lib:/usr/lib
-fstack-protector-strong ' 'LIBS=-lkrb5 -lgssapi_krb5 '
'KRB5CONFIG=/usr/local/bin/krb5-config'
'krb5_config=/usr/local/bin/krb5-config' '--enable-htcp'
'--enable-icap-client' '--enable-icmp' '--enable-ident-lookups'
'--enable-ipv6' '--enable-kqueue' '--with-large-files'
'--enable-http-violations' '--without-nettle' '--enable-snmp'
'--enable-ssl' '--with-openssl=/usr'
'--enable-security-cert-generators=file'
'LIBOPENSSL_CFLAGS=-I/usr/include' 'LIBOPENSSL_LIBS=-lcrypto -lssl'
'--enable-ssl-crtd' '--disable-stacktraces'
'--disable-ipf-transparent' '--disable-ipfw-transparent'
'--enable-pf-transparent' '--with-nat-devpf' '--disable-forw-via-db'
'--enable-wccp' '--enable-wccpv2' '--enable-auth-basic=LDAP SASL DB
SMB_LM NCSA PAM POP3 RADIUS fake getpwnam NIS'
'--enable-auth-digest=eDirectory LDAP file'
'--enable-external-acl-helpers=LDAP_group eDirectory_userip
file_userip unix_group delayer kerberos_ldap_group'
'--enable-auth-negotiate=kerberos wrapper' '--enable-auth-ntlm=fake
SMB_LM' '--enable-storeio=aufs diskd ufs'
'--enable-disk-io=DiskThreads DiskDaemon AIO Blocking IpcIo Mmapped'
'--enable-log-daemon-helpers=file DB'
'--enable-url-rewrite-helpers=fake LFS'
'--enable-storeid-rewrite-helpers=file'
'--enable-security-cert-validators=fake' '--prefix=/usr/local'
'--mandir=/usr/local/man' '--disable-silent-rules'
'--infodir=/usr/local/share/info/' '--build=amd64-portbld-freebsd12.2'
'build_alias=amd64-portbld-freebsd12.2' 'CC=cc'
'CPPFLAGS=-I/usr/local/include -I/usr/local/include' 'CXX=c++'
'CXXFLAGS=-O2 -pipe -I/usr/local/include -I/usr/local/include
-fstack-protector-strong -DLDAP_DEPRECATED -fno-strict-aliasing  '
'CPP=cpp' --enable-ltdl-convenience
> On 19/08/21 4:12 am, Periko Support wrote:
> > Hello guys.
> >
> > I have been searching the issue I have with windows 10 and the ugly
> > job he do to put the NIC "Internet access" and went we have squid
> > behind "no internet".
> >
>
> The NIC status simply says that *somehow* the Internet is available.
> that means DNS resolution, TCP connectivity, HTTP transactions and HTTPS
> transactions are all fully working and producing responses.

Windows 10 if for some reason cannot reach the internet will say "no internet".

I had sniff the communication and I just found thos 2 sites that looks
like windows use to check connectivity.

>
> Break any one and you will get "no internet". Even when the rest
> continue working fine. So it can tell you when some sort of failure
> occurs, but is not reliable when it claims success.
>
>
> Please be aware that using your Squid proxy properly is one way Windows
> can receive all those services and claim "Internet Access".
>
>
> > I have sniff logs and  I just found this sites went I turn on the computer:
> >
> > .msftconnecttest.com
> > .windows.com
> >
> > Some has win over this annoying thing with windows 10?
> >
> > No-Trans[parent Proxy WPAD.
> >
>
> Check that your firewall does not permit HTTP(S) connections directly
> from clients to the Internet.

I don't allow direct connection to the Internet, all 80/443 must cross
under squid.

> When;
>   * your network gateway firewall(s) block direct connections (other
> than from Squid) to HTTP(S), and
>   * your proxy logs show those Win10 connection URLs happening, and
>   * Win10 NIC says "Interent Access"
>
> Then you know that the proxy usage is how "Internet Access" happens,
> that is what you want so no problem.
>
>

I still haven't found the solution to this little issue.

Regards!!!

> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users


From belle at bazuin.nl  Mon Aug 23 06:55:23 2021
From: belle at bazuin.nl (=?windows-1252?Q?L.P.H._van_Belle?=)
Date: Mon, 23 Aug 2021 08:55:23 +0200
Subject: [squid-users] Squid v4.45
In-Reply-To: <CAK2yrTahsbEM_6UkWcrFSoMEkRH_Tz-3mzbf+e5gREiEbkOY9w@mail.gmail.com>
References: <72e56d70-e721-bf71-f135-0a75d985f034@treenet.co.nz>
Message-ID: <vmime.6123465b.2dd.78478a7d20d5148b@ms249-lin-003.rotterdam.bazuin.nl>

In your windows config. 
Remove the ip adres from the gateway and configure your proxy settings.  
Without proxy and gateway no internet.

Or setup SSL proxy 
Add something like this in your firewall and you catch all. 

# Redirect HTTP on eth0 from LAN_CIDR to locally installed Squid instance using REDIRECT for intercept mode
iptables -t mangle -A PREROUTING -i eth0 -s 192.168.0.0/24 -p tcp --dport 80 -j REDIRECT --to-port 6080 -m comment --comment "Squid-Intercept 80->6080"

# Redirect HTTPS on eth0 from CIDR to locally installed Squid instance using REDIRECT for intercept mode
-A PREROUTING -i eth0 -s 192.168.0.0/24 -p tcp --dport 443 -j REDIRECT --to-port 6433 -m comment --comment "Squid-Intercept 443->6433"

And read : 
https://wiki.squid-cache.org/KnowledgeBase/Block%20QUIC%20protocol


>The NIC status simply says that *somehow* the Internet is available.
No, windows 10 does a DNS querie to an MS server, block that and and you see "no internet" 
Even if you have internet. 

Maybe PiHole is something for you that does most of what you want. 


Greetz, 

Louis


> -----Oorspronkelijk bericht-----
> Van: squid-users 
> [mailto:squid-users-bounces at lists.squid-cache.org] Namens 
> Periko Support
> Verzonden: maandag 23 augustus 2021 7:55
> Aan: squid-users at lists.squid-cache.org
> Onderwerp: Re: [squid-users] Squid v4.45
> 
> On Thu, Aug 19, 2021 at 7:40 PM Amos Jeffries 
> <squid3 at treenet.co.nz> wrote:
> >
> >
> > FYI, there is no such version as Squid 4.45.
> 
> Amos sorry, is 4.15 my mistake.
> >
> > What is the output when you run "squid -v" ?
> >
>  squid -v
> Squid Cache: Version 4.15
> Service Name: squid
> 
> This binary uses OpenSSL 1.1.1k-freebsd  25 Mar 2021. For legal
> restrictions on distribution see
> https://www.openssl.org/source/license.html
> 
> configure options:  '--with-default-user=squid'
> '--bindir=/usr/local/sbin' '--sbindir=/usr/local/sbin'
> '--datadir=/usr/local/etc/squid'
> '--libexecdir=/usr/local/libexec/squid' '--localstatedir=/var'
> '--sysconfdir=/usr/local/etc/squid' '--with-logdir=/var/log/squid'
> '--with-pidfile=/var/run/squid/squid.pid'
> '--with-swapdir=/var/squid/cache' '--without-gnutls'
> '--with-included-ltdl' '--enable-auth' '--enable-zph-qos'
> '--enable-build-info' '--enable-loadable-modules'
> '--enable-removal-policies=lru heap' '--disable-epoll'
> '--disable-linux-netfilter' '--disable-linux-tproxy'
> '--disable-translation' '--disable-arch-native'
> '--disable-strict-error-checking' '--enable-eui'
> '--enable-cache-digests' '--enable-delay-pools' '--disable-ecap'
> '--disable-esi' '--enable-follow-x-forwarded-for'
> '--with-mit-krb5=/usr/local' 'CFLAGS=-I/usr/local/include -O2 -pipe
> -I/usr/local/include -I/usr/local/include -fstack-protector-strong
> -DLDAP_DEPRECATED -fno-strict-aliasing ' 'LDFLAGS=-L/usr/local/lib
> -L/usr/local/lib -L/usr/local/lib -pthread -L/usr/local/lib
> -lpcreposix -lpcre -Wl,-rpath,/usr/local/lib:/usr/lib
> -fstack-protector-strong ' 'LIBS=-lkrb5 -lgssapi_krb5 '
> 'KRB5CONFIG=/usr/local/bin/krb5-config'
> 'krb5_config=/usr/local/bin/krb5-config' '--enable-htcp'
> '--enable-icap-client' '--enable-icmp' '--enable-ident-lookups'
> '--enable-ipv6' '--enable-kqueue' '--with-large-files'
> '--enable-http-violations' '--without-nettle' '--enable-snmp'
> '--enable-ssl' '--with-openssl=/usr'
> '--enable-security-cert-generators=file'
> 'LIBOPENSSL_CFLAGS=-I/usr/include' 'LIBOPENSSL_LIBS=-lcrypto -lssl'
> '--enable-ssl-crtd' '--disable-stacktraces'
> '--disable-ipf-transparent' '--disable-ipfw-transparent'
> '--enable-pf-transparent' '--with-nat-devpf' '--disable-forw-via-db'
> '--enable-wccp' '--enable-wccpv2' '--enable-auth-basic=LDAP SASL DB
> SMB_LM NCSA PAM POP3 RADIUS fake getpwnam NIS'
> '--enable-auth-digest=eDirectory LDAP file'
> '--enable-external-acl-helpers=LDAP_group eDirectory_userip
> file_userip unix_group delayer kerberos_ldap_group'
> '--enable-auth-negotiate=kerberos wrapper' '--enable-auth-ntlm=fake
> SMB_LM' '--enable-storeio=aufs diskd ufs'
> '--enable-disk-io=DiskThreads DiskDaemon AIO Blocking IpcIo Mmapped'
> '--enable-log-daemon-helpers=file DB'
> '--enable-url-rewrite-helpers=fake LFS'
> '--enable-storeid-rewrite-helpers=file'
> '--enable-security-cert-validators=fake' '--prefix=/usr/local'
> '--mandir=/usr/local/man' '--disable-silent-rules'
> '--infodir=/usr/local/share/info/' '--build=amd64-portbld-freebsd12.2'
> 'build_alias=amd64-portbld-freebsd12.2' 'CC=cc'
> 'CPPFLAGS=-I/usr/local/include -I/usr/local/include' 'CXX=c++'
> 'CXXFLAGS=-O2 -pipe -I/usr/local/include -I/usr/local/include
> -fstack-protector-strong -DLDAP_DEPRECATED -fno-strict-aliasing  '
> 'CPP=cpp' --enable-ltdl-convenience
> > On 19/08/21 4:12 am, Periko Support wrote:
> > > Hello guys.
> > >
> > > I have been searching the issue I have with windows 10 
> and the ugly
> > > job he do to put the NIC "Internet access" and went we have squid
> > > behind "no internet".
> > >
> >
> > The NIC status simply says that *somehow* the Internet is available.
> > that means DNS resolution, TCP connectivity, HTTP 
> transactions and HTTPS
> > transactions are all fully working and producing responses.
> 
> Windows 10 if for some reason cannot reach the internet will 
> say "no internet".
> 
> I had sniff the communication and I just found thos 2 sites that looks
> like windows use to check connectivity.
> 
> >
> > Break any one and you will get "no internet". Even when the rest
> > continue working fine. So it can tell you when some sort of failure
> > occurs, but is not reliable when it claims success.
> >
> >
> > Please be aware that using your Squid proxy properly is one 
> way Windows
> > can receive all those services and claim "Internet Access".
> >
> >
> > > I have sniff logs and  I just found this sites went I 
> turn on the computer:
> > >
> > > .msftconnecttest.com
> > > .windows.com
> > >
> > > Some has win over this annoying thing with windows 10?
> > >
> > > No-Trans[parent Proxy WPAD.
> > >
> >
> > Check that your firewall does not permit HTTP(S) 
> connections directly
> > from clients to the Internet.
> 
> I don't allow direct connection to the Internet, all 80/443 must cross
> under squid.
> 
> > When;
> >   * your network gateway firewall(s) block direct connections (other
> > than from Squid) to HTTP(S), and
> >   * your proxy logs show those Win10 connection URLs happening, and
> >   * Win10 NIC says "Interent Access"
> >
> > Then you know that the proxy usage is how "Internet Access" happens,
> > that is what you want so no problem.
> >
> >
> 
> I still haven't found the solution to this little issue.
> 
> Regards!!!
> 
> > Amos
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> 
> 



From momir at petrovacnamlavi.rs  Sat Aug 28 00:12:57 2021
From: momir at petrovacnamlavi.rs (Momir Milekic)
Date: Sat, 28 Aug 2021 02:12:57 +0200
Subject: [squid-users] Hi, i need some help about squid for windows
Message-ID: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>

Hi,
Until recently I used squid proxy 2.72 32bit on windows xp machine. We
finally switched to 64-bit windows10. I copied the old squid proxy to
windows10 with saved settings (just for test, we were short with time for
new install). It basically works but there are some problems.
I wanted to install newer squid proxy version for windows even earlier, but
the lack of support for windowsxp prevented me.
In the meantime, i found the v4 version of the squid proxy for windows 10.
It taked my attention.

I learned to make the most important settings in the config file, but I
still don't know a lot.
I have some questions:
1) how do I configure forbidden access to sites (facebook, youtube) for
certain ip addresses from the LAN network? a couple of simple examples
would help?
2) proxy functions work nicely but sometimes the squid proxy "locks up" and
there is no data flow for 2-3 minutes. It usually helps to wait or restart
the service. How to prevent this? The internet link is good, probably a
problem with hidden bugs in the squid proxy or wrong settings (how to
increase stability)?
3) number of simultaneous connections per client and globally, How to set
up win10 64bit, specifically for squid proxy service? If i need to
configure the OS as well, ask me how.
4) how to turn off caching. The idea is to just redirect http traffic and
always ask/force latest version of site online? No need to make a local
copy/cache, just raw proxy between lan and ether/internet.

note: all of the above issues and issues are related to version 2.72. If
v4.14 64-bit version that I downloaded from diladele site yesterday works
better and not have problems, then great. In any case, a couple of examples
for squid.conf would help me, I would be very grateful.

That's all for the first mail, thank You all in advance ...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210828/48c9ef89/attachment.htm>

From squid3 at treenet.co.nz  Sat Aug 28 05:18:08 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sat, 28 Aug 2021 17:18:08 +1200
Subject: [squid-users] Hi, i need some help about squid for windows
In-Reply-To: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
References: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
Message-ID: <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>

On 28/08/21 12:12 pm, Momir Milekic wrote:
> Hi,
> Until recently I used squid proxy 2.72 32bit on windows xp machine. We 
> finally switched to 64-bit windows10. I copied the old squid proxy to 
> windows10 with saved settings (just for test, we were short with time 
> for new install). It basically works but there are some problems.
> I wanted to install newer squid proxy version for windows even earlier, 
> but the lack of support for windowsxp prevented me.
> In the meantime, i found the v4 version of the squid proxy for windows 
> 10. It taked?my attention.
> 
> I learned to make the most important settings in the config file, but I 
> still don't know a?lot.
> I have some questions:
> 1) how do I configure forbidden access to sites (facebook, youtube) for 
> certain ip addresses from the LAN network? a couple of simple examples 
> would help?


see <https://wiki.squid-cache.org/SquidFaq/SquidAcl>



> 2) proxy functions work nicely but sometimes the squid proxy "locks up" 
> and there is no data flow for 2-3 minutes. It usually helps to wait or 
> restart the service. How to prevent this? The internet link is good, 
> probably a problem with hidden bugs in the squid proxy or wrong settings 
> (how to increase stability)?


This being Squid-2 it could be quite a lot of things that have long ago 
been solved and forgotten about. First thing to do is try an upgrade.



> 3) number of simultaneous connections per client and globally, How to 
> set up win10 64bit, specifically for squid proxy service? If i need to 
> configure the OS as well, ask me how.


Windows APIs used by Squid-2 have a hard limit that cannot be changed.


> 4) how to turn off caching. The idea is to just redirect http traffic 
> and always ask/force latest?version of site online? No need to make a 
> local copy/cache, just raw proxy between lan and ether/internet.
> 


In Squid-2:

   cache deny all
   cache_mem 0
   cache_dir /dev/null parent 0


In modern Squid just remove any cache_dir you have.


> note: all of the above issues and issues are related to version 2.72. If 
> v4.14 64-bit version that I downloaded from diladele site yesterday 
> works better and not have?problems, then great. In any case, a couple of 
> examples for squid.conf would help me, I would be very grateful.
> 


Squid-2 is HTTP/1.0 software which is 5+ years obsolete now.

Go with the Diladele Squid-4, it is modern HTTP/1.1 software and most of 
the help you will be able to get relies on features only found in the 
Squid-3+ releases.


Amos


From momir at petrovacnamlavi.rs  Sat Aug 28 08:15:02 2021
From: momir at petrovacnamlavi.rs (Momir Milekic)
Date: Sat, 28 Aug 2021 10:15:02 +0200
Subject: [squid-users] Hi, i need some help about squid for windows
In-Reply-To: <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>
References: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
 <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>
Message-ID: <CADY=Ex94oGBSsV0BcNhcu8J-gdY=q5bafDqmNyDZeBtG7FuXhA@mail.gmail.com>

ok, then i will install v4.14 and try again. After that i will ask for help
again.
for now, one question more:
can i use 2.x config for 4.x  without any additional fixes?

On Sat, Aug 28, 2021 at 7:22 AM Amos Jeffries <squid3 at treenet.co.nz> wrote:

> On 28/08/21 12:12 pm, Momir Milekic wrote:
> > Hi,
> > Until recently I used squid proxy 2.72 32bit on windows xp machine. We
> > finally switched to 64-bit windows10. I copied the old squid proxy to
> > windows10 with saved settings (just for test, we were short with time
> > for new install). It basically works but there are some problems.
> > I wanted to install newer squid proxy version for windows even earlier,
> > but the lack of support for windowsxp prevented me.
> > In the meantime, i found the v4 version of the squid proxy for windows
> > 10. It taked my attention.
> >
> > I learned to make the most important settings in the config file, but I
> > still don't know a lot.
> > I have some questions:
> > 1) how do I configure forbidden access to sites (facebook, youtube) for
> > certain ip addresses from the LAN network? a couple of simple examples
> > would help?
>
>
> see <https://wiki.squid-cache.org/SquidFaq/SquidAcl>
>
>
>
> > 2) proxy functions work nicely but sometimes the squid proxy "locks up"
> > and there is no data flow for 2-3 minutes. It usually helps to wait or
> > restart the service. How to prevent this? The internet link is good,
> > probably a problem with hidden bugs in the squid proxy or wrong settings
> > (how to increase stability)?
>
>
> This being Squid-2 it could be quite a lot of things that have long ago
> been solved and forgotten about. First thing to do is try an upgrade.
>
>
>
> > 3) number of simultaneous connections per client and globally, How to
> > set up win10 64bit, specifically for squid proxy service? If i need to
> > configure the OS as well, ask me how.
>
>
> Windows APIs used by Squid-2 have a hard limit that cannot be changed.
>
>
> > 4) how to turn off caching. The idea is to just redirect http traffic
> > and always ask/force latest version of site online? No need to make a
> > local copy/cache, just raw proxy between lan and ether/internet.
> >
>
>
> In Squid-2:
>
>    cache deny all
>    cache_mem 0
>    cache_dir /dev/null parent 0
>
>
> In modern Squid just remove any cache_dir you have.
>
>
> > note: all of the above issues and issues are related to version 2.72. If
> > v4.14 64-bit version that I downloaded from diladele site yesterday
> > works better and not have problems, then great. In any case, a couple of
> > examples for squid.conf would help me, I would be very grateful.
> >
>
>
> Squid-2 is HTTP/1.0 software which is 5+ years obsolete now.
>
> Go with the Diladele Squid-4, it is modern HTTP/1.1 software and most of
> the help you will be able to get relies on features only found in the
> Squid-3+ releases.
>
>
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210828/f6c41652/attachment.htm>

From ml at netfence.it  Sat Aug 28 12:36:28 2021
From: ml at netfence.it (Andrea Venturoli)
Date: Sat, 28 Aug 2021 14:36:28 +0200
Subject: [squid-users] ftp_port and squidclamav
Message-ID: <7e98a5dc-c8fa-e46f-97ae-151f3d30c98b@netfence.it>

Hello.

I've got Squid (4.15) configured as an HTTP[s] server, with squidclamav:

> icap_enable on
> icap_send_client_ip on
> icap_preview_enable on
> icap_preview_size 1024
> icap_service service_req reqmod_precache bypass=0 icap://127.0.0.1:1344/squidclamav
> adaptation_access service_req allow all
> icap_service service_resp respmod_precache bypass=0 icap://127.0.0.1:1344/squidclamav
> adaptation_access service_resp allow all

Everything is fine on this side.



Now I'm trying to make it act as an FTP proxy, with:
 > ftp_port 2121

This works partially: I'm usually able to see remote directories, but 
uploads will fail (timing out on the client side).

If I disable ICAP at all (comment the above lines), then the FTP proxy 
works properly.



I'm failing to understand the interaction between the two: even simple 
files fail to upload and I see no signs of ClamAV taking much time to 
scan them.
Is this some known problem?
Any suggestion on how to gain a better understanding?

Or, is there any way I can tell Squid to avoid passing FTP traffic 
(coming on port 2121) to ICAP (while of course doing that for the rest)?

  bye & Thanks
	av.


From rousskov at measurement-factory.com  Sat Aug 28 15:10:23 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sat, 28 Aug 2021 11:10:23 -0400
Subject: [squid-users] ftp_port and squidclamav
In-Reply-To: <7e98a5dc-c8fa-e46f-97ae-151f3d30c98b@netfence.it>
References: <7e98a5dc-c8fa-e46f-97ae-151f3d30c98b@netfence.it>
Message-ID: <5eef8506-331d-a5cd-0204-2553b671c97b@measurement-factory.com>

On 8/28/21 8:36 AM, Andrea Venturoli wrote:

> I've got Squid (4.15) configured as an HTTP[s] server, with squidclamav:

>> icap_enable on
>> icap_send_client_ip on
>> icap_preview_enable on
>> icap_preview_size 1024
>> icap_service service_req reqmod_precache bypass=0 icap://127.0.0.1:1344/squidclamav
>> adaptation_access service_req allow all
>> icap_service service_resp respmod_precache bypass=0 icap://127.0.0.1:1344/squidclamav
>> adaptation_access service_resp allow all

> Everything is fine on this side.

> Now I'm trying to make it act as an FTP proxy, with:

>> ftp_port 2121

> This works partially: I'm usually able to see remote directories, but
> uploads will fail (timing out on the client side).

> If I disable ICAP at all (comment the above lines), then the FTP proxy
> works properly.

This can be a Squid bug or an ICAP service bug/incompatibility with fake
HTTP messages that Squid is using to represent native FTP traffic. FWIW,
the mapping between native FTP traffic (that Squid sees) and fake HTTP
messages (that your ICAP service sees) is described at
https://wiki.squid-cache.org/Features/FtpRelay


> I'm failing to understand the interaction between the two: even simple
> files fail to upload and I see no signs of ClamAV taking much time to
> scan them.
> Is this some known problem?

FWIW, I am not aware of it.


> Any suggestion on how to gain a better understanding?

Reproduce the problem using a single transaction on an otherwise idle
Squid with full debugging enabled and share the corresponding cache.log:
https://wiki.squid-cache.org/SquidFaq/BugReporting#Debugging_a_single_transaction

If the above is not feasible, collect ICAP requests and responses for
the failing transaction and share them instead (a packet capture may be
the easiest way to do that, but you can also try ALL,2 debugging if you
can reproduce with a single transaction on an otherwise idle Squid).


> Or, is there any way I can tell Squid to avoid passing FTP traffic
> (coming on port 2121) to ICAP (while of course doing that for the rest)?

Yes, the adaptation_access directive controls what traffic goes to your
ICAP services. To match ftp_port traffic, I would give the ftp_port a
name and then try using that name in a myportname ACL. Other ACLs may
also work, but I would start with myportname. If myportname does not
work for ftp_port traffic, it is a Squid bug.


HTH,

Alex.


From roeeklinger60 at gmail.com  Sat Aug 28 18:59:14 2021
From: roeeklinger60 at gmail.com (roee klinger)
Date: Sat, 28 Aug 2021 21:59:14 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
Message-ID: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>

Hello,

I have multiple Squid servers installed in different data centers across
different cloud providers, and they all need to authenticate users using
a single database (MySQL) on a separate server, which is also on a
different cloud provider on a different data center.

I have already written an external authentication script that reads from
MySQL and everything is working fine, however, I have some
performance concerns, since the DB is located externally and in a different
region of the world from the Squid server.

I made some speed tests to see how long it takes to query the DB as Squid
would:

if the database is located on the same machine as Squid: 1.067-millisecond
average query

if the database is located on the same datacenter as Squid:
2.67-millisecond average query

if the database is located on a different datacenter than Squid (different
country as well): 38.9-millisecond average query

Now I am wondering, is 36-millisecond average added query time a big deal
when dealing with HTTP/S traffic? how significant is this added time to
Squid and will performance get hurt drastically?

I know there is some caching going on the Squid side, but I had to set the
caching to really low values (around 15s), as per the requirement I was
given.

If I will have no other choice, I will simply replicate the DB table from
the DB server to the Squid server, but I prefer not to do that, as it will
require installing MySQL on all the Squid servers (or some other DB, but
then I have to do replication from different DBs).

Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210828/9c6a7cd0/attachment.htm>

From rousskov at measurement-factory.com  Sat Aug 28 19:33:21 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sat, 28 Aug 2021 15:33:21 -0400
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
Message-ID: <3f986125-b56e-f40d-eee9-9287c281d4f8@measurement-factory.com>

On 8/28/21 2:59 PM, roee klinger wrote:

> I have multiple Squid servers installed in different data centers across
> different cloud providers, and they all need to authenticate?users using
> a?single database (MySQL) on a separate server, which is also on a
> different cloud provider?on a different data center.
> 
> I have already written an external authentication?script that reads from
> MySQL and everything is working?fine, however, I have some
> performance?concerns, since the DB is located externally and in a
> different region of the world from the Squid server.
> 
> I made some speed tests to see how long it takes to query the DB as
> Squid would:
> 
> if the database is located on the same machine as Squid:
> 1.067-millisecond average query
> 
> if the database is located on the same datacenter as Squid:
> 2.67-millisecond average query
> 
> if the database is located on a different datacenter than Squid
> (different country as well): 38.9-millisecond average query
> 
> 
> Now I am wondering, is?36-millisecond average added query time a big
> deal when dealing with HTTP/S traffic? how significant is this added
> time to Squid and will performance?get hurt drastically?

* When you look at a single HTTP transaction, adding 36ms is usually not
a big deal: Humans are incapable of discerning such delays and
automatons that need true real-time performance are unlikely to go
through your Squids.

* Additional 36ms added to mean transaction response time create
significant perceived delays for sites/services that load lots of
resources _sequentially,_ especially if such a site/service has lighting
fast response times without those extra delays. For example, without
authentication caching and similar optimizations, a cumulative extra
delay of 100 sequential transactions (that would normally take, say,
300ms total) would be 3.6 seconds -- something many humans will be
annoyed with!

* Additional 36ms added to mean transaction response time can kill
performance of a Squid instance that is operating at the limit of some
resource capacity.

For example, imagine that, without authentication delays, your Squid
transactions have 10ms mean response time, and your Squid instance is
dealing with 10'000 requests per second load. That combination results
in just 100 concurrent requests (10'000r/s * 0.01s = 100r). If you add
36ms to that 10ms response time, your Squid would have to deal with 460
concurrent requests (10'000r/s * 0.046s = 460r) -- a 360% increase in
concurrency levels and associated resource consumption. Such an increase
is likely to maim any Squid that was operating without significant spare
resources.

For an opposite example, imagine that, without authentication delays,
your Squid transactions have 1 second mean response time, and your Squid
instance is dealing with 10'000 requests per second load. That
combination results in 10'000 concurrent requests. If you add 36ms to
that 1s response time, your Squid would have to deal with 10'360
concurrent requests -- a mere 3.6% increase in concurrency levels and
associated resource consumption.

Keep in mind that as Squid approaches resource limits, things usually
get _exponentially_ worse.


The impact of additional authentication delays should be fairly easy to
model/test.


HTH,

Alex.


> I know there is some caching going on the Squid side, but I had to set
> the caching to really low values (around 15s), as per the requirement I
> was given.
> 
> If I will have no other choice, I will simply replicate the DB table
> from the DB server to the Squid server, but I prefer not to do that, as
> it will require installing MySQL on all the Squid servers (or some other
> DB, but then I have to do replication from different DBs).
> 
> Thanks.
> 
> 
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> 



From roeeklinger60 at gmail.com  Sat Aug 28 20:00:22 2021
From: roeeklinger60 at gmail.com (roee klinger)
Date: Sat, 28 Aug 2021 23:00:22 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <3f986125-b56e-f40d-eee9-9287c281d4f8@measurement-factory.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <3f986125-b56e-f40d-eee9-9287c281d4f8@measurement-factory.com>
Message-ID: <CAGCa14ri=oGaZVEHuBBCUMR-rw+kemLZgSgB3de1NPhbfq3eMA@mail.gmail.com>

Thank you Alex, for the detailed response, I will keep that info in mind
while testing.

If I can convenience the team to increase the "auth_param basic
credentialsttl" to around 60
minutes, we should have absolutely no problem, please correct me if I am
wrong.

As per my understanding, even if the DB server is all the way across the
world, and we have an added
response time of 1 second that occurs only once every 60 minutes, that
would have almost 0 impact
on the performance and resources used by Squid.

My only concern is for 407s, do users that get 407 are also cached?
In case that they do get cached, that would mean that if I send one request
using some username, it gets 407, and then I add the username to the DB,
it will still not work for 60 minutes.

However, if it is not cached, that could potentially cause big resources
usage as well,
since every 407 request takes around 1 second to resolve, and we have a lot
of those.

Anyway, it seems that no matter if 407 are cached or not, it will cause
some issues
if the DB response takes around 1 second unless I am overestimating the
resource
use of these requests.

I would love to hear your thoughts on that solution,
Thanks,
Roee


On Sat, Aug 28, 2021 at 10:33 PM Alex Rousskov <
rousskov at measurement-factory.com> wrote:

> On 8/28/21 2:59 PM, roee klinger wrote:
>
> > I have multiple Squid servers installed in different data centers across
> > different cloud providers, and they all need to authenticate users using
> > a single database (MySQL) on a separate server, which is also on a
> > different cloud provider on a different data center.
> >
> > I have already written an external authentication script that reads from
> > MySQL and everything is working fine, however, I have some
> > performance concerns, since the DB is located externally and in a
> > different region of the world from the Squid server.
> >
> > I made some speed tests to see how long it takes to query the DB as
> > Squid would:
> >
> > if the database is located on the same machine as Squid:
> > 1.067-millisecond average query
> >
> > if the database is located on the same datacenter as Squid:
> > 2.67-millisecond average query
> >
> > if the database is located on a different datacenter than Squid
> > (different country as well): 38.9-millisecond average query
> >
> >
> > Now I am wondering, is 36-millisecond average added query time a big
> > deal when dealing with HTTP/S traffic? how significant is this added
> > time to Squid and will performance get hurt drastically?
>
> * When you look at a single HTTP transaction, adding 36ms is usually not
> a big deal: Humans are incapable of discerning such delays and
> automatons that need true real-time performance are unlikely to go
> through your Squids.
>
> * Additional 36ms added to mean transaction response time create
> significant perceived delays for sites/services that load lots of
> resources _sequentially,_ especially if such a site/service has lighting
> fast response times without those extra delays. For example, without
> authentication caching and similar optimizations, a cumulative extra
> delay of 100 sequential transactions (that would normally take, say,
> 300ms total) would be 3.6 seconds -- something many humans will be
> annoyed with!
>
> * Additional 36ms added to mean transaction response time can kill
> performance of a Squid instance that is operating at the limit of some
> resource capacity.
>
> For example, imagine that, without authentication delays, your Squid
> transactions have 10ms mean response time, and your Squid instance is
> dealing with 10'000 requests per second load. That combination results
> in just 100 concurrent requests (10'000r/s * 0.01s = 100r). If you add
> 36ms to that 10ms response time, your Squid would have to deal with 460
> concurrent requests (10'000r/s * 0.046s = 460r) -- a 360% increase in
> concurrency levels and associated resource consumption. Such an increase
> is likely to maim any Squid that was operating without significant spare
> resources.
>
> For an opposite example, imagine that, without authentication delays,
> your Squid transactions have 1 second mean response time, and your Squid
> instance is dealing with 10'000 requests per second load. That
> combination results in 10'000 concurrent requests. If you add 36ms to
> that 1s response time, your Squid would have to deal with 10'360
> concurrent requests -- a mere 3.6% increase in concurrency levels and
> associated resource consumption.
>
> Keep in mind that as Squid approaches resource limits, things usually
> get _exponentially_ worse.
>
>
> The impact of additional authentication delays should be fairly easy to
> model/test.
>
>
> HTH,
>
> Alex.
>
>
> > I know there is some caching going on the Squid side, but I had to set
> > the caching to really low values (around 15s), as per the requirement I
> > was given.
> >
> > If I will have no other choice, I will simply replicate the DB table
> > from the DB server to the Squid server, but I prefer not to do that, as
> > it will require installing MySQL on all the Squid servers (or some other
> > DB, but then I have to do replication from different DBs).
> >
> > Thanks.
> >
> >
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
> >
>
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210828/2b2c7d34/attachment.htm>

From rousskov at measurement-factory.com  Sat Aug 28 20:15:53 2021
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Sat, 28 Aug 2021 16:15:53 -0400
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14ri=oGaZVEHuBBCUMR-rw+kemLZgSgB3de1NPhbfq3eMA@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <3f986125-b56e-f40d-eee9-9287c281d4f8@measurement-factory.com>
 <CAGCa14ri=oGaZVEHuBBCUMR-rw+kemLZgSgB3de1NPhbfq3eMA@mail.gmail.com>
Message-ID: <f2b5a292-d32a-478a-b0fb-c3ac4e8db329@measurement-factory.com>

On 8/28/21 4:00 PM, roee klinger wrote:

> If I can convenience the team to increase the "auth_param basic
> credentialsttl" to around 60
> minutes, we should have absolutely?no problem, please correct me?if I am
> wrong.

This is not my area of expertise, so I hope that others on the list will
respond, but I suspect that the correct answer depends on what exactly
is being authenticated in your environment. For example:

* If a single user computer requires at most one 1s authentication
during any 60 minute period, then you are probably right.

* However, if 100 transactions from that single user computer require 1s
authentication every hour (e.g., because they all arrived within 1
second from each other using 100 independent concurrent connections, and
each connection has to be authenticated from scratch, incurring that 1s
delay), then you might get some complaints from users (and their
automatons) that the internet "feels a bit sluggish" "right after I
resume working"...

Alex.


> As per my understanding, even if the DB server is all the way across the
> world, and we have an added
> response time of 1 second that occurs only once?every 60 minutes, that
> would have almost 0 impact
> on the performance?and resources used by Squid.
> 
> My only concern is for 407s, do users that get 407 are also cached?
> In case that they do get cached, that would mean that if I send one request
> using some username, it gets 407, and then I add the username to the DB,
> it will still not work for 60 minutes.
> 
> However, if it is not cached, that could potentially?cause big resources
> usage as well,
> since every 407 request takes around 1 second to resolve, and we have a
> lot of those.
> 
> Anyway, it seems that no matter if 407 are cached or not, it will cause
> some issues
> if the DB response takes around 1 second unless I am overestimating the
> resource?
> use of these requests.
> 
> I would love to hear your thoughts on that solution,
> Thanks,
> Roee
> 
> 
> On Sat, Aug 28, 2021 at 10:33 PM Alex Rousskov
> <rousskov at measurement-factory.com
> <mailto:rousskov at measurement-factory.com>> wrote:
> 
>     On 8/28/21 2:59 PM, roee klinger wrote:
> 
>     > I have multiple Squid servers installed in different data centers
>     across
>     > different cloud providers, and they all need to authenticate?users
>     using
>     > a?single database (MySQL) on a separate server, which is also on a
>     > different cloud provider?on a different data center.
>     >
>     > I have already written an external authentication?script that
>     reads from
>     > MySQL and everything is working?fine, however, I have some
>     > performance?concerns, since the DB is located externally and in a
>     > different region of the world from the Squid server.
>     >
>     > I made some speed tests to see how long it takes to query the DB as
>     > Squid would:
>     >
>     > if the database is located on the same machine as Squid:
>     > 1.067-millisecond average query
>     >
>     > if the database is located on the same datacenter as Squid:
>     > 2.67-millisecond average query
>     >
>     > if the database is located on a different datacenter than Squid
>     > (different country as well): 38.9-millisecond average query
>     >
>     >
>     > Now I am wondering, is?36-millisecond average added query time a big
>     > deal when dealing with HTTP/S traffic? how significant is this added
>     > time to Squid and will performance?get hurt drastically?
> 
>     * When you look at a single HTTP transaction, adding 36ms is usually not
>     a big deal: Humans are incapable of discerning such delays and
>     automatons that need true real-time performance are unlikely to go
>     through your Squids.
> 
>     * Additional 36ms added to mean transaction response time create
>     significant perceived delays for sites/services that load lots of
>     resources _sequentially,_ especially if such a site/service has lighting
>     fast response times without those extra delays. For example, without
>     authentication caching and similar optimizations, a cumulative extra
>     delay of 100 sequential transactions (that would normally take, say,
>     300ms total) would be 3.6 seconds -- something many humans will be
>     annoyed with!
> 
>     * Additional 36ms added to mean transaction response time can kill
>     performance of a Squid instance that is operating at the limit of some
>     resource capacity.
> 
>     For example, imagine that, without authentication delays, your Squid
>     transactions have 10ms mean response time, and your Squid instance is
>     dealing with 10'000 requests per second load. That combination results
>     in just 100 concurrent requests (10'000r/s * 0.01s = 100r). If you add
>     36ms to that 10ms response time, your Squid would have to deal with 460
>     concurrent requests (10'000r/s * 0.046s = 460r) -- a 360% increase in
>     concurrency levels and associated resource consumption. Such an increase
>     is likely to maim any Squid that was operating without significant spare
>     resources.
> 
>     For an opposite example, imagine that, without authentication delays,
>     your Squid transactions have 1 second mean response time, and your Squid
>     instance is dealing with 10'000 requests per second load. That
>     combination results in 10'000 concurrent requests. If you add 36ms to
>     that 1s response time, your Squid would have to deal with 10'360
>     concurrent requests -- a mere 3.6% increase in concurrency levels and
>     associated resource consumption.
> 
>     Keep in mind that as Squid approaches resource limits, things usually
>     get _exponentially_ worse.
> 
> 
>     The impact of additional authentication delays should be fairly easy to
>     model/test.
> 
> 
>     HTH,
> 
>     Alex.
> 
> 
>     > I know there is some caching going on the Squid side, but I had to set
>     > the caching to really low values (around 15s), as per the
>     requirement I
>     > was given.
>     >
>     > If I will have no other choice, I will simply replicate the DB table
>     > from the DB server to the Squid server, but I prefer not to do
>     that, as
>     > it will require installing MySQL on all the Squid servers (or some
>     other
>     > DB, but then I have to do replication from different DBs).
>     >
>     > Thanks.
>     >
>     >
>     > _______________________________________________
>     > squid-users mailing list
>     > squid-users at lists.squid-cache.org
>     <mailto:squid-users at lists.squid-cache.org>
>     > http://lists.squid-cache.org/listinfo/squid-users
>     <http://lists.squid-cache.org/listinfo/squid-users>
>     >
> 
>     _______________________________________________
>     squid-users mailing list
>     squid-users at lists.squid-cache.org
>     <mailto:squid-users at lists.squid-cache.org>
>     http://lists.squid-cache.org/listinfo/squid-users
>     <http://lists.squid-cache.org/listinfo/squid-users>
> 



From shadowpilot34 at gmail.com  Sun Aug 29 01:01:37 2021
From: shadowpilot34 at gmail.com (His Shadow)
Date: Sun, 29 Aug 2021 04:01:37 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
Message-ID: <CAK7W0xcQAu9xQyh2cmHveEtXf4wPj-KcbR32WBbgj2_rgwgg6A@mail.gmail.com>

You could write a service that occasionally dumps user credentials
into some format, like json and have your external helpers download
it, parse it and use it as local cache. There will be delay, when
adding new users, but authentication would be very fast. Unless the
database is huge of course.

??, 28 ???. 2021 ?. ? 21:59, roee klinger <roeeklinger60 at gmail.com>:
>
> Hello,
>
> I have multiple Squid servers installed in different data centers across different cloud providers, and they all need to authenticate users using a single database (MySQL) on a separate server, which is also on a different cloud provider on a different data center.
>
> I have already written an external authentication script that reads from MySQL and everything is working fine, however, I have some performance concerns, since the DB is located externally and in a different region of the world from the Squid server.
>
> I made some speed tests to see how long it takes to query the DB as Squid would:
>
> if the database is located on the same machine as Squid: 1.067-millisecond average query
>
> if the database is located on the same datacenter as Squid: 2.67-millisecond average query
>
> if the database is located on a different datacenter than Squid (different country as well): 38.9-millisecond average query
>
>
> Now I am wondering, is 36-millisecond average added query time a big deal when dealing with HTTP/S traffic? how significant is this added time to Squid and will performance get hurt drastically?
>
> I know there is some caching going on the Squid side, but I had to set the caching to really low values (around 15s), as per the requirement I was given.
>
> If I will have no other choice, I will simply replicate the DB table from the DB server to the Squid server, but I prefer not to do that, as it will require installing MySQL on all the Squid servers (or some other DB, but then I have to do replication from different DBs).
>
> Thanks.
>
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users



-- 
HisShadow


From roeeklinger60 at gmail.com  Sun Aug 29 10:15:02 2021
From: roeeklinger60 at gmail.com (roee klinger)
Date: Sun, 29 Aug 2021 13:15:02 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAK7W0xcQAu9xQyh2cmHveEtXf4wPj-KcbR32WBbgj2_rgwgg6A@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <CAK7W0xcQAu9xQyh2cmHveEtXf4wPj-KcbR32WBbgj2_rgwgg6A@mail.gmail.com>
Message-ID: <CAGCa14qkwi5JoeE=bcV_No-qjH9Q9xOyTdj_QFjbwFWcTQEe+g@mail.gmail.com>

Yes, this is what I am doing now. I am creating a local install of MySQL
and than I am replicating the table into the local install, but I would
prefer to get around that.

On Sun, Aug 29, 2021 at 4:01 AM His Shadow <shadowpilot34 at gmail.com> wrote:

> You could write a service that occasionally dumps user credentials
> into some format, like json and have your external helpers download
> it, parse it and use it as local cache. There will be delay, when
> adding new users, but authentication would be very fast. Unless the
> database is huge of course.
>
> ??, 28 ???. 2021 ?. ? 21:59, roee klinger <roeeklinger60 at gmail.com>:
> >
> > Hello,
> >
> > I have multiple Squid servers installed in different data centers across
> different cloud providers, and they all need to authenticate users using a
> single database (MySQL) on a separate server, which is also on a different
> cloud provider on a different data center.
> >
> > I have already written an external authentication script that reads from
> MySQL and everything is working fine, however, I have some performance
> concerns, since the DB is located externally and in a different region of
> the world from the Squid server.
> >
> > I made some speed tests to see how long it takes to query the DB as
> Squid would:
> >
> > if the database is located on the same machine as Squid:
> 1.067-millisecond average query
> >
> > if the database is located on the same datacenter as Squid:
> 2.67-millisecond average query
> >
> > if the database is located on a different datacenter than Squid
> (different country as well): 38.9-millisecond average query
> >
> >
> > Now I am wondering, is 36-millisecond average added query time a big
> deal when dealing with HTTP/S traffic? how significant is this added time
> to Squid and will performance get hurt drastically?
> >
> > I know there is some caching going on the Squid side, but I had to set
> the caching to really low values (around 15s), as per the requirement I was
> given.
> >
> > If I will have no other choice, I will simply replicate the DB table
> from the DB server to the Squid server, but I prefer not to do that, as it
> will require installing MySQL on all the Squid servers (or some other DB,
> but then I have to do replication from different DBs).
> >
> > Thanks.
> >
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
>
>
>
> --
> HisShadow
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210829/e26943cd/attachment.htm>

From uhlar at fantomas.sk  Sun Aug 29 11:57:21 2021
From: uhlar at fantomas.sk (Matus UHLAR - fantomas)
Date: Sun, 29 Aug 2021 13:57:21 +0200
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
Message-ID: <20210829115721.GA27028@fantomas.sk>

On 28.08.21 21:59, roee klinger wrote:
>I have multiple Squid servers installed in different data centers across
>different cloud providers, and they all need to authenticate users using
>a single database (MySQL) on a separate server, which is also on a
>different cloud provider on a different data center.

>I have already written an external authentication script that reads from
>MySQL and everything is working fine, however, I have some
>performance concerns, since the DB is located externally and in a different
>region of the world from the Squid server.

if you only use the auth db read-only, mysql replication and querying local
servers could help that.


-- 
Matus UHLAR - fantomas, uhlar at fantomas.sk ; http://www.fantomas.sk/
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
I just got lost in thought. It was unfamiliar territory.


From roeeklinger60 at gmail.com  Sun Aug 29 13:25:32 2021
From: roeeklinger60 at gmail.com (roee klinger)
Date: Sun, 29 Aug 2021 16:25:32 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <20210829115721.GA27028@fantomas.sk>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <20210829115721.GA27028@fantomas.sk>
Message-ID: <CAGCa14p_oxsj0B=AiqcN=i5y6rnxWPa530R-sor=e2UF9oE-2w@mail.gmail.com>

Thanks, I know, I have already set that up, I am asking about the
possibility
of not using replication, and just setting up high ttl times for
credentials, to simplify things.

On Sun, Aug 29, 2021 at 2:57 PM Matus UHLAR - fantomas <uhlar at fantomas.sk>
wrote:

> On 28.08.21 21:59, roee klinger wrote:
> >I have multiple Squid servers installed in different data centers across
> >different cloud providers, and they all need to authenticate users using
> >a single database (MySQL) on a separate server, which is also on a
> >different cloud provider on a different data center.
>
> >I have already written an external authentication script that reads from
> >MySQL and everything is working fine, however, I have some
> >performance concerns, since the DB is located externally and in a
> different
> >region of the world from the Squid server.
>
> if you only use the auth db read-only, mysql replication and querying local
> servers could help that.
>
>
> --
> Matus UHLAR - fantomas, uhlar at fantomas.sk ; http://www.fantomas.sk/
> Warning: I wish NOT to receive e-mail advertising to this address.
> Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
> I just got lost in thought. It was unfamiliar territory.
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210829/c5d3eaad/attachment.htm>

From squid3 at treenet.co.nz  Sun Aug 29 13:53:34 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 30 Aug 2021 01:53:34 +1200
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14p_oxsj0B=AiqcN=i5y6rnxWPa530R-sor=e2UF9oE-2w@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <20210829115721.GA27028@fantomas.sk>
 <CAGCa14p_oxsj0B=AiqcN=i5y6rnxWPa530R-sor=e2UF9oE-2w@mail.gmail.com>
Message-ID: <ab7b27ee-bf26-e6c9-127f-e6f69d7627bd@treenet.co.nz>

On 30/08/21 1:25 am, roee klinger wrote:
> Thanks, I know, I have already set that up, I am asking about the 
> possibility
> of not using replication, and just setting up high ttl times for 
> credentials, to simplify things.
> 

You told us you had a requirement to set TTL at 15sec.

What you have been talking about is the slow ms delays *across Internet* 
between your helper and the database. Squid has nothing to do with that.


Amos


From shadowpilot34 at gmail.com  Sun Aug 29 14:22:42 2021
From: shadowpilot34 at gmail.com (His Shadow)
Date: Sun, 29 Aug 2021 17:22:42 +0300
Subject: [squid-users] Setting Squid to work with a remote DB?
In-Reply-To: <CAGCa14qkwi5JoeE=bcV_No-qjH9Q9xOyTdj_QFjbwFWcTQEe+g@mail.gmail.com>
References: <CAGCa14pR=ak7xrmnutHcHni6nM5PoyHD0OWD=wVUratXjNhiKw@mail.gmail.com>
 <CAK7W0xcQAu9xQyh2cmHveEtXf4wPj-KcbR32WBbgj2_rgwgg6A@mail.gmail.com>
 <CAGCa14qkwi5JoeE=bcV_No-qjH9Q9xOyTdj_QFjbwFWcTQEe+g@mail.gmail.com>
Message-ID: <CAK7W0xfJ9a5EiWubmD3s4MV1nGk2j9V9ghGxn0tNZ+YwwBgrOg@mail.gmail.com>

I meant without replication. Service on the server with mysql
generates data for external helpers and hashes it with sha1 for
example. External helpers check if the hash has changed from time to
time, download new data, parse it, use it for authentication. Who
knows what could go wrong, while replicating, especially if the
network is under load. That's what I've been doing for years, I had
the same problem as you, I first used external API for auth, which
resulted in time spikes, even with result caching.

??, 29 ???. 2021 ?. ? 13:15, roee klinger <roeeklinger60 at gmail.com>:
>
> Yes, this is what I am doing now. I am creating a local install of MySQL
> and than I am replicating the table into the local install, but I would
> prefer to get around that.
>
> On Sun, Aug 29, 2021 at 4:01 AM His Shadow <shadowpilot34 at gmail.com> wrote:
>>
>> You could write a service that occasionally dumps user credentials
>> into some format, like json and have your external helpers download
>> it, parse it and use it as local cache. There will be delay, when
>> adding new users, but authentication would be very fast. Unless the
>> database is huge of course.
>>
>> ??, 28 ???. 2021 ?. ? 21:59, roee klinger <roeeklinger60 at gmail.com>:
>> >
>> > Hello,
>> >
>> > I have multiple Squid servers installed in different data centers across different cloud providers, and they all need to authenticate users using a single database (MySQL) on a separate server, which is also on a different cloud provider on a different data center.
>> >
>> > I have already written an external authentication script that reads from MySQL and everything is working fine, however, I have some performance concerns, since the DB is located externally and in a different region of the world from the Squid server.
>> >
>> > I made some speed tests to see how long it takes to query the DB as Squid would:
>> >
>> > if the database is located on the same machine as Squid: 1.067-millisecond average query
>> >
>> > if the database is located on the same datacenter as Squid: 2.67-millisecond average query
>> >
>> > if the database is located on a different datacenter than Squid (different country as well): 38.9-millisecond average query
>> >
>> >
>> > Now I am wondering, is 36-millisecond average added query time a big deal when dealing with HTTP/S traffic? how significant is this added time to Squid and will performance get hurt drastically?
>> >
>> > I know there is some caching going on the Squid side, but I had to set the caching to really low values (around 15s), as per the requirement I was given.
>> >
>> > If I will have no other choice, I will simply replicate the DB table from the DB server to the Squid server, but I prefer not to do that, as it will require installing MySQL on all the Squid servers (or some other DB, but then I have to do replication from different DBs).
>> >
>> > Thanks.
>> >
>> > _______________________________________________
>> > squid-users mailing list
>> > squid-users at lists.squid-cache.org
>> > http://lists.squid-cache.org/listinfo/squid-users
>>
>>
>>
>> --
>> HisShadow



-- 
HisShadow


From pheriko.support at gmail.com  Sun Aug 29 19:37:46 2021
From: pheriko.support at gmail.com (Periko Support)
Date: Sun, 29 Aug 2021 12:37:46 -0700
Subject: [squid-users] Squid v4.45
In-Reply-To: <vmime.6123465b.2dd.78478a7d20d5148b@ms249-lin-003.rotterdam.bazuin.nl>
References: <72e56d70-e721-bf71-f135-0a75d985f034@treenet.co.nz>
 <CAK2yrTahsbEM_6UkWcrFSoMEkRH_Tz-3mzbf+e5gREiEbkOY9w@mail.gmail.com>
 <vmime.6123465b.2dd.78478a7d20d5148b@ms249-lin-003.rotterdam.bazuin.nl>
Message-ID: <CAK2yrTZTfwTtCWP07An44A1bJHMXP6FB8CgG8B_c79gdrUQWXg@mail.gmail.com>

Hello guys.

I'm worrying with all the info u give me guys, tracking the sites
win10 use to query and confirm it has connection.

Is a little annoying when users call u and complain about that, even
if they have internet access.

Part of IT life.

Thanks all for your input!!!

On Sun, Aug 22, 2021 at 11:55 PM L.P.H. van Belle <belle at bazuin.nl> wrote:
>
> In your windows config.
> Remove the ip adres from the gateway and configure your proxy settings.
> Without proxy and gateway no internet.
>
> Or setup SSL proxy
> Add something like this in your firewall and you catch all.
>
> # Redirect HTTP on eth0 from LAN_CIDR to locally installed Squid instance using REDIRECT for intercept mode
> iptables -t mangle -A PREROUTING -i eth0 -s 192.168.0.0/24 -p tcp --dport 80 -j REDIRECT --to-port 6080 -m comment --comment "Squid-Intercept 80->6080"
>
> # Redirect HTTPS on eth0 from CIDR to locally installed Squid instance using REDIRECT for intercept mode
> -A PREROUTING -i eth0 -s 192.168.0.0/24 -p tcp --dport 443 -j REDIRECT --to-port 6433 -m comment --comment "Squid-Intercept 443->6433"
>
> And read :
> https://wiki.squid-cache.org/KnowledgeBase/Block%20QUIC%20protocol
>
>
> >The NIC status simply says that *somehow* the Internet is available.
> No, windows 10 does a DNS querie to an MS server, block that and and you see "no internet"
> Even if you have internet.
>
> Maybe PiHole is something for you that does most of what you want.
>
>
> Greetz,
>
> Louis
>
>
> > -----Oorspronkelijk bericht-----
> > Van: squid-users
> > [mailto:squid-users-bounces at lists.squid-cache.org] Namens
> > Periko Support
> > Verzonden: maandag 23 augustus 2021 7:55
> > Aan: squid-users at lists.squid-cache.org
> > Onderwerp: Re: [squid-users] Squid v4.45
> >
> > On Thu, Aug 19, 2021 at 7:40 PM Amos Jeffries
> > <squid3 at treenet.co.nz> wrote:
> > >
> > >
> > > FYI, there is no such version as Squid 4.45.
> >
> > Amos sorry, is 4.15 my mistake.
> > >
> > > What is the output when you run "squid -v" ?
> > >
> >  squid -v
> > Squid Cache: Version 4.15
> > Service Name: squid
> >
> > This binary uses OpenSSL 1.1.1k-freebsd  25 Mar 2021. For legal
> > restrictions on distribution see
> > https://www.openssl.org/source/license.html
> >
> > configure options:  '--with-default-user=squid'
> > '--bindir=/usr/local/sbin' '--sbindir=/usr/local/sbin'
> > '--datadir=/usr/local/etc/squid'
> > '--libexecdir=/usr/local/libexec/squid' '--localstatedir=/var'
> > '--sysconfdir=/usr/local/etc/squid' '--with-logdir=/var/log/squid'
> > '--with-pidfile=/var/run/squid/squid.pid'
> > '--with-swapdir=/var/squid/cache' '--without-gnutls'
> > '--with-included-ltdl' '--enable-auth' '--enable-zph-qos'
> > '--enable-build-info' '--enable-loadable-modules'
> > '--enable-removal-policies=lru heap' '--disable-epoll'
> > '--disable-linux-netfilter' '--disable-linux-tproxy'
> > '--disable-translation' '--disable-arch-native'
> > '--disable-strict-error-checking' '--enable-eui'
> > '--enable-cache-digests' '--enable-delay-pools' '--disable-ecap'
> > '--disable-esi' '--enable-follow-x-forwarded-for'
> > '--with-mit-krb5=/usr/local' 'CFLAGS=-I/usr/local/include -O2 -pipe
> > -I/usr/local/include -I/usr/local/include -fstack-protector-strong
> > -DLDAP_DEPRECATED -fno-strict-aliasing ' 'LDFLAGS=-L/usr/local/lib
> > -L/usr/local/lib -L/usr/local/lib -pthread -L/usr/local/lib
> > -lpcreposix -lpcre -Wl,-rpath,/usr/local/lib:/usr/lib
> > -fstack-protector-strong ' 'LIBS=-lkrb5 -lgssapi_krb5 '
> > 'KRB5CONFIG=/usr/local/bin/krb5-config'
> > 'krb5_config=/usr/local/bin/krb5-config' '--enable-htcp'
> > '--enable-icap-client' '--enable-icmp' '--enable-ident-lookups'
> > '--enable-ipv6' '--enable-kqueue' '--with-large-files'
> > '--enable-http-violations' '--without-nettle' '--enable-snmp'
> > '--enable-ssl' '--with-openssl=/usr'
> > '--enable-security-cert-generators=file'
> > 'LIBOPENSSL_CFLAGS=-I/usr/include' 'LIBOPENSSL_LIBS=-lcrypto -lssl'
> > '--enable-ssl-crtd' '--disable-stacktraces'
> > '--disable-ipf-transparent' '--disable-ipfw-transparent'
> > '--enable-pf-transparent' '--with-nat-devpf' '--disable-forw-via-db'
> > '--enable-wccp' '--enable-wccpv2' '--enable-auth-basic=LDAP SASL DB
> > SMB_LM NCSA PAM POP3 RADIUS fake getpwnam NIS'
> > '--enable-auth-digest=eDirectory LDAP file'
> > '--enable-external-acl-helpers=LDAP_group eDirectory_userip
> > file_userip unix_group delayer kerberos_ldap_group'
> > '--enable-auth-negotiate=kerberos wrapper' '--enable-auth-ntlm=fake
> > SMB_LM' '--enable-storeio=aufs diskd ufs'
> > '--enable-disk-io=DiskThreads DiskDaemon AIO Blocking IpcIo Mmapped'
> > '--enable-log-daemon-helpers=file DB'
> > '--enable-url-rewrite-helpers=fake LFS'
> > '--enable-storeid-rewrite-helpers=file'
> > '--enable-security-cert-validators=fake' '--prefix=/usr/local'
> > '--mandir=/usr/local/man' '--disable-silent-rules'
> > '--infodir=/usr/local/share/info/' '--build=amd64-portbld-freebsd12.2'
> > 'build_alias=amd64-portbld-freebsd12.2' 'CC=cc'
> > 'CPPFLAGS=-I/usr/local/include -I/usr/local/include' 'CXX=c++'
> > 'CXXFLAGS=-O2 -pipe -I/usr/local/include -I/usr/local/include
> > -fstack-protector-strong -DLDAP_DEPRECATED -fno-strict-aliasing  '
> > 'CPP=cpp' --enable-ltdl-convenience
> > > On 19/08/21 4:12 am, Periko Support wrote:
> > > > Hello guys.
> > > >
> > > > I have been searching the issue I have with windows 10
> > and the ugly
> > > > job he do to put the NIC "Internet access" and went we have squid
> > > > behind "no internet".
> > > >
> > >
> > > The NIC status simply says that *somehow* the Internet is available.
> > > that means DNS resolution, TCP connectivity, HTTP
> > transactions and HTTPS
> > > transactions are all fully working and producing responses.
> >
> > Windows 10 if for some reason cannot reach the internet will
> > say "no internet".
> >
> > I had sniff the communication and I just found thos 2 sites that looks
> > like windows use to check connectivity.
> >
> > >
> > > Break any one and you will get "no internet". Even when the rest
> > > continue working fine. So it can tell you when some sort of failure
> > > occurs, but is not reliable when it claims success.
> > >
> > >
> > > Please be aware that using your Squid proxy properly is one
> > way Windows
> > > can receive all those services and claim "Internet Access".
> > >
> > >
> > > > I have sniff logs and  I just found this sites went I
> > turn on the computer:
> > > >
> > > > .msftconnecttest.com
> > > > .windows.com
> > > >
> > > > Some has win over this annoying thing with windows 10?
> > > >
> > > > No-Trans[parent Proxy WPAD.
> > > >
> > >
> > > Check that your firewall does not permit HTTP(S)
> > connections directly
> > > from clients to the Internet.
> >
> > I don't allow direct connection to the Internet, all 80/443 must cross
> > under squid.
> >
> > > When;
> > >   * your network gateway firewall(s) block direct connections (other
> > > than from Squid) to HTTP(S), and
> > >   * your proxy logs show those Win10 connection URLs happening, and
> > >   * Win10 NIC says "Interent Access"
> > >
> > > Then you know that the proxy usage is how "Internet Access" happens,
> > > that is what you want so no problem.
> > >
> > >
> >
> > I still haven't found the solution to this little issue.
> >
> > Regards!!!
> >
> > > Amos
> > > _______________________________________________
> > > squid-users mailing list
> > > squid-users at lists.squid-cache.org
> > > http://lists.squid-cache.org/listinfo/squid-users
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
> >
> >
>
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users


From uzee001 at yahoo.com  Mon Aug 30 06:35:03 2021
From: uzee001 at yahoo.com (U Zee)
Date: Mon, 30 Aug 2021 06:35:03 +0000 (UTC)
Subject: [squid-users] Getting a squid clients list
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
Message-ID: <28129445.847427.1630305303013@mail.yahoo.com>

I've inherited an old machine running squid 2.6 and planning to refresh it. There are many clients in our environment and I'd like to put together a list of those so that they can be updated if the IP/hostname changes.Looking at the docs, I see cache.log and store.log but access.log is empty? From store.log, I can pipe it to [perl -p -e 's/^([0-9]*)/"[".localtime($1)."]"/e'] but that just replaces the timestamp, I can't seem to get our clients that are connecting to our squid proxy.
I've run a netstat for a few days and captured anything that was connecting to port 3128, but I'm not sure if that gets me all our clients.Is there a better way to generate a list of all clients that use it?Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/00bf7e3a/attachment.htm>

From momir at petrovacnamlavi.rs  Mon Aug 30 09:31:54 2021
From: momir at petrovacnamlavi.rs (Momir Milekic)
Date: Mon, 30 Aug 2021 11:31:54 +0200
Subject: [squid-users] Hi, i need some help about squid for windows
In-Reply-To: <CADY=Ex94oGBSsV0BcNhcu8J-gdY=q5bafDqmNyDZeBtG7FuXhA@mail.gmail.com>
References: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
 <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>
 <CADY=Ex94oGBSsV0BcNhcu8J-gdY=q5bafDqmNyDZeBtG7FuXhA@mail.gmail.com>
Message-ID: <CADY=Ex_DsqGGcBxD5cOybN3hE5mMPb6DLASQKEjytDy32n-nRw@mail.gmail.com>

We finally uninstall squid for windows 2.7 and install 4.14..
we have no time to reedit squid.conf and i tried just to overwrite 4.14
squid.conf with 2.7  (it worked with those settings. It had minor bugs,
mentioned in my first message here but it worked. squid 4.14 will not work
with this squid.config file. all clients receive the message "refused to
connect")
my question is how to fix that without reedit whole 4.14 squid.conf?

Has the syntax of the basic commands changed, perhaps the order of the
commands that initialize the proxy?
Basically I need a setting that no one can connect to the proxy except the
local network inside (192.168.0.1 - 192.168.0.255) and proxy is their
gateway. Then the internet bandwidth per client and the number of
connections per client to be limited, the dns servers to be configured and
the listening ports (3128 as default and 808 as aditional one).

any idea or help?
thanks in advance

On Sat, Aug 28, 2021 at 10:15 AM Momir Milekic <momir at petrovacnamlavi.rs>
wrote:

> ok, then i will install v4.14 and try again. After that i will ask for
> help again.
> for now, one question more:
> can i use 2.x config for 4.x  without any additional fixes?
>
> On Sat, Aug 28, 2021 at 7:22 AM Amos Jeffries <squid3 at treenet.co.nz>
> wrote:
>
>> On 28/08/21 12:12 pm, Momir Milekic wrote:
>> > Hi,
>> > Until recently I used squid proxy 2.72 32bit on windows xp machine. We
>> > finally switched to 64-bit windows10. I copied the old squid proxy to
>> > windows10 with saved settings (just for test, we were short with time
>> > for new install). It basically works but there are some problems.
>> > I wanted to install newer squid proxy version for windows even earlier,
>> > but the lack of support for windowsxp prevented me.
>> > In the meantime, i found the v4 version of the squid proxy for windows
>> > 10. It taked my attention.
>> >
>> > I learned to make the most important settings in the config file, but I
>> > still don't know a lot.
>> > I have some questions:
>> > 1) how do I configure forbidden access to sites (facebook, youtube) for
>> > certain ip addresses from the LAN network? a couple of simple examples
>> > would help?
>>
>>
>> see <https://wiki.squid-cache.org/SquidFaq/SquidAcl>
>>
>>
>>
>> > 2) proxy functions work nicely but sometimes the squid proxy "locks up"
>> > and there is no data flow for 2-3 minutes. It usually helps to wait or
>> > restart the service. How to prevent this? The internet link is good,
>> > probably a problem with hidden bugs in the squid proxy or wrong
>> settings
>> > (how to increase stability)?
>>
>>
>> This being Squid-2 it could be quite a lot of things that have long ago
>> been solved and forgotten about. First thing to do is try an upgrade.
>>
>>
>>
>> > 3) number of simultaneous connections per client and globally, How to
>> > set up win10 64bit, specifically for squid proxy service? If i need to
>> > configure the OS as well, ask me how.
>>
>>
>> Windows APIs used by Squid-2 have a hard limit that cannot be changed.
>>
>>
>> > 4) how to turn off caching. The idea is to just redirect http traffic
>> > and always ask/force latest version of site online? No need to make a
>> > local copy/cache, just raw proxy between lan and ether/internet.
>> >
>>
>>
>> In Squid-2:
>>
>>    cache deny all
>>    cache_mem 0
>>    cache_dir /dev/null parent 0
>>
>>
>> In modern Squid just remove any cache_dir you have.
>>
>>
>> > note: all of the above issues and issues are related to version 2.72.
>> If
>> > v4.14 64-bit version that I downloaded from diladele site yesterday
>> > works better and not have problems, then great. In any case, a couple
>> of
>> > examples for squid.conf would help me, I would be very grateful.
>> >
>>
>>
>> Squid-2 is HTTP/1.0 software which is 5+ years obsolete now.
>>
>> Go with the Diladele Squid-4, it is modern HTTP/1.1 software and most of
>> the help you will be able to get relies on features only found in the
>> Squid-3+ releases.
>>
>>
>> Amos
>> _______________________________________________
>> squid-users mailing list
>> squid-users at lists.squid-cache.org
>> http://lists.squid-cache.org/listinfo/squid-users
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/005d9ebc/attachment.htm>

From squid3 at treenet.co.nz  Mon Aug 30 09:44:34 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 30 Aug 2021 21:44:34 +1200
Subject: [squid-users] Getting a squid clients list
In-Reply-To: <28129445.847427.1630305303013@mail.yahoo.com>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
Message-ID: <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>

On 30/08/21 6:35 pm, U Zee wrote:
> I've inherited an old machine running squid 2.6 and planning to refresh 
> it. There are many clients in our environment and I'd like to put 
> together a list of those so that they can be updated if the IP/hostname 
> changes.
> Looking at the docs, I see cache.log and store.log but access.log is 
> empty?

That is a bit worrying. Find out why access.log is empty.


> Is there a better way to generate a list of all clients that use it?


If your proxy has clientdb features enabled you can use the cache 
manager "client_list" to fetch a list of all the clients that have been 
using the proxy.

Try command:
   squidclient mgr:client_list | grep "Address"



Amos


From uzee001 at yahoo.com  Mon Aug 30 10:18:07 2021
From: uzee001 at yahoo.com (U Zee)
Date: Mon, 30 Aug 2021 10:18:07 +0000 (UTC)
Subject: [squid-users] Getting a squid clients list
In-Reply-To: <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
 <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
Message-ID: <412730933.885899.1630318687240@mail.yahoo.com>

 Thanks Amos. I don't think the clientdb features you mentioned are enabled, I'm getting a command not found.Also I don't see anything configured for logging in squid.conf (I don't know if there is any other place for it)
bash-3.00# ps -ef|grep squidroot? ? ? 2467? ? ?1? 0? 2020 ?? ? ? ? 00:00:00 /usr/squid/sbin/squidnobody? ? 2471? 2467? 0? 2020 ?? ? ? ? 07:49:45 (squid)root? ? ?28018 20110? 0 13:12 pts/0? ? 00:00:00 grep squid
bash-3.00# /usr/squid/sbin/squid -vSquid Cache: Version 2.6.STABLE13configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
bash-3.00# squidclient mgr:client_list | grep "Address"bash: squidclient: command not foundbash-3.00#
bash-3.00# grep -i log squid.confbash-3.00#

The machine has been up since last July and I'm a bit concerned to bounce squid to see if it will start writing to access.log or not as its used by several prod systems.
Thanks muchuzee
    On Monday, August 30, 2021, 12:48:59 PM GMT+3, Amos Jeffries <squid3 at treenet.co.nz> wrote:  
 
 On 30/08/21 6:35 pm, U Zee wrote:
> I've inherited an old machine running squid 2.6 and planning to refresh 
> it. There are many clients in our environment and I'd like to put 
> together a list of those so that they can be updated if the IP/hostname 
> changes.
> Looking at the docs, I see cache.log and store.log but access.log is 
> empty?

That is a bit worrying. Find out why access.log is empty.


> Is there a better way to generate a list of all clients that use it?


If your proxy has clientdb features enabled you can use the cache 
manager "client_list" to fetch a list of all the clients that have been 
using the proxy.

Try command:
? squidclient mgr:client_list | grep "Address"



Amos
_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/ccadd17f/attachment.htm>

From squid3 at treenet.co.nz  Mon Aug 30 10:15:02 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 30 Aug 2021 22:15:02 +1200
Subject: [squid-users] Hi, i need some help about squid for windows
In-Reply-To: <CADY=Ex_DsqGGcBxD5cOybN3hE5mMPb6DLASQKEjytDy32n-nRw@mail.gmail.com>
References: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
 <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>
 <CADY=Ex94oGBSsV0BcNhcu8J-gdY=q5bafDqmNyDZeBtG7FuXhA@mail.gmail.com>
 <CADY=Ex_DsqGGcBxD5cOybN3hE5mMPb6DLASQKEjytDy32n-nRw@mail.gmail.com>
Message-ID: <b7df5a7e-e52a-d09e-1a34-7b7d5ef3b660@treenet.co.nz>

On 30/08/21 9:31 pm, Momir Milekic wrote:
> We finally uninstall squid for windows 2.7 and install 4.14..
> we have no time to reedit squid.conf and i tried just to overwrite 4.14 
> squid.conf with 2.7 ?(it worked with those settings. It had minor bugs, 
> mentioned in my first message here but it worked. squid 4.14 will not 
> work with this squid.config file. all clients receive the message 
> "refused to connect")

What refused - Squid or the client Browser?


> my question is how to fix that without reedit?whole 4.14 squid.conf?
> 

Do you still have a copy of the old Squid-2 config file?
  You will at very least need to copy some of the details across.


> Has the syntax of the basic commands changed, perhaps the order of the 
> commands that initialize the proxy?
> Basically I need a setting that no one can connect to the proxy except 
> the local network inside (192.168.0.1 - 192.168.0.255)

Edit the "acl localnet" lines in squid.conf to only contain that IP range.


> and proxy is 
> their gateway.

That is a network and/or client setting. Same as was done when you used 
Squid-2. It depends on your network topology/design and software used 
how that is done.


> Then the internet bandwidth per client and the number of 
> connections per client to be limited,

Copy the delay_* lines from your Squid-2 config file.


> the dns servers to be configured 
> and the listening ports (3128 as default and 808 as aditional one).

Look for the http_port lines in squid.conf. You should find 3128 already 
present. Add a line "http_port 808" there.

NP: If the 3128 line is commented out (some distributors do) that may be 
the connect problem, remove the '#'.


Amos


From squid3 at treenet.co.nz  Mon Aug 30 10:25:25 2021
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 30 Aug 2021 22:25:25 +1200
Subject: [squid-users] Getting a squid clients list
In-Reply-To: <412730933.885899.1630318687240@mail.yahoo.com>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
 <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
 <412730933.885899.1630318687240@mail.yahoo.com>
Message-ID: <fa799223-0259-e839-4d17-17099db7fc93@treenet.co.nz>

On 30/08/21 10:18 pm, U Zee wrote:
> Thanks Amos. I don't think the clientdb features you mentioned are 
> enabled, I'm getting a command not found.
> Also I don't see anything configured for logging in squid.conf (I don't 
> know if there is any other place for it)
> 
> bash-3.00# ps -ef|grep squid
> root? ? ? 2467? ? ?1? 0? 2020 ?? ? ? ? 00:00:00 /usr/squid/sbin/squid
> nobody? ? 2471? 2467? 0? 2020 ?? ? ? ? 07:49:45 (squid)
> root? ? ?28018 20110? 0 13:12 pts/0? ? 00:00:00 grep squid
> 
> bash-3.00# /usr/squid/sbin/squid -v
> Squid Cache: Version 2.6.STABLE13
> configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
> 
> bash-3.00# squidclient mgr:client_list | grep "Address"
> bash: squidclient: command not found

That is the squidclient tool missing on your machine.

Amos


From momir at petrovacnamlavi.rs  Mon Aug 30 11:25:31 2021
From: momir at petrovacnamlavi.rs (Momir Milekic)
Date: Mon, 30 Aug 2021 13:25:31 +0200
Subject: [squid-users] Hi, i need some help about squid for windows
In-Reply-To: <b7df5a7e-e52a-d09e-1a34-7b7d5ef3b660@treenet.co.nz>
References: <CADY=Ex_uPUBLyNA83QHBKDU32TjqLwHq0Xad8f2EK63Pd1me2Q@mail.gmail.com>
 <aa29c74a-f601-ad89-74a1-5e034e550439@treenet.co.nz>
 <CADY=Ex94oGBSsV0BcNhcu8J-gdY=q5bafDqmNyDZeBtG7FuXhA@mail.gmail.com>
 <CADY=Ex_DsqGGcBxD5cOybN3hE5mMPb6DLASQKEjytDy32n-nRw@mail.gmail.com>
 <b7df5a7e-e52a-d09e-1a34-7b7d5ef3b660@treenet.co.nz>
Message-ID: <CADY=Ex83nAHkp4RLsSgpHs7ajiVRDTQ50bQW=WO8hum0Yo5-+Q@mail.gmail.com>

>
> What refused - Squid or the client Browser?
>
>
browser respond with  "proxy refused connection(s)" something like that


>
> > Then the internet bandwidth per client and the number of
> > connections per client to be limited,
>
> Copy the delay_* lines from your Squid-2 config file.
>
>
there is command for number of connections too?

I still have to investigate this whole issue ..
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/7f534242/attachment.htm>

From uzee001 at yahoo.com  Mon Aug 30 11:44:22 2021
From: uzee001 at yahoo.com (U Zee)
Date: Mon, 30 Aug 2021 11:44:22 +0000 (UTC)
Subject: [squid-users] Getting a squid clients list
In-Reply-To: <fa799223-0259-e839-4d17-17099db7fc93@treenet.co.nz>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
 <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
 <412730933.885899.1630318687240@mail.yahoo.com>
 <fa799223-0259-e839-4d17-17099db7fc93@treenet.co.nz>
Message-ID: <2137930776.899158.1630323862982@mail.yahoo.com>

 <sigh> I know and sadly installing it is not possible either. Without going into the details too much, its a machine with a legacy environment where yum and some other tools are broken and people who knew about the configs are long gone.
    On Monday, August 30, 2021, 01:29:47 PM GMT+3, Amos Jeffries <squid3 at treenet.co.nz> wrote:  
 
 On 30/08/21 10:18 pm, U Zee wrote:
> Thanks Amos. I don't think the clientdb features you mentioned are 
> enabled, I'm getting a command not found.
> Also I don't see anything configured for logging in squid.conf (I don't 
> know if there is any other place for it)
> 
> bash-3.00# ps -ef|grep squid
> root? ? ? 2467? ? ?1? 0? 2020 ?? ? ? ? 00:00:00 /usr/squid/sbin/squid
> nobody? ? 2471? 2467? 0? 2020 ?? ? ? ? 07:49:45 (squid)
> root? ? ?28018 20110? 0 13:12 pts/0? ? 00:00:00 grep squid
> 
> bash-3.00# /usr/squid/sbin/squid -v
> Squid Cache: Version 2.6.STABLE13
> configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
> 
> bash-3.00# squidclient mgr:client_list | grep "Address"
> bash: squidclient: command not found

That is the squidclient tool missing on your machine.

Amos
_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/a45360fa/attachment.htm>

From ngtech1ltd at gmail.com  Mon Aug 30 11:56:06 2021
From: ngtech1ltd at gmail.com (NgTech LTD)
Date: Mon, 30 Aug 2021 14:56:06 +0300
Subject: [squid-users] Fwd:  Getting a squid clients list
In-Reply-To: <CABA8h=R2xJ38_8am92tDb-E6SiJ4pJm6Sn5-DqcxUA7HaJC+tQ@mail.gmail.com>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
 <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
 <412730933.885899.1630318687240@mail.yahoo.com>
 <fa799223-0259-e839-4d17-17099db7fc93@treenet.co.nz>
 <2137930776.899158.1630323862982@mail.yahoo.com>
 <CABA8h=R2xJ38_8am92tDb-E6SiJ4pJm6Sn5-DqcxUA7HaJC+tQ@mail.gmail.com>
Message-ID: <CABA8h=ROTEtUg=Kw_RV1uEXqfKYUpQh=AN9iqj00Cn0-Nhc5QQ@mail.gmail.com>

Hey Uzee,

You can use squidclient from another machine to access this machine.
I do not remember how by heart but Amos might know if I am guessing right.

Eliezer

?????? ??? ??, 30 ????? 2021, 14:44, ??? U Zee ?<uzee001 at yahoo.com>:

> <sigh> I know and sadly installing it is not possible either. Without
> going into the details too much, its a machine with a legacy environment
> where yum and some other tools are broken and people who knew about the
> configs are long gone.
>
> On Monday, August 30, 2021, 01:29:47 PM GMT+3, Amos Jeffries <
> squid3 at treenet.co.nz> wrote:
>
>
> On 30/08/21 10:18 pm, U Zee wrote:
> > Thanks Amos. I don't think the clientdb features you mentioned are
> > enabled, I'm getting a command not found.
> > Also I don't see anything configured for logging in squid.conf (I don't
> > know if there is any other place for it)
> >
> > bash-3.00# ps -ef|grep squid
> > root      2467     1  0  2020 ?        00:00:00 /usr/squid/sbin/squid
> > nobody    2471  2467  0  2020 ?        07:49:45 (squid)
> > root     28018 20110  0 13:12 pts/0    00:00:00 grep squid
> >
> > bash-3.00# /usr/squid/sbin/squid -v
> > Squid Cache: Version 2.6.STABLE13
> > configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
> >
> > bash-3.00# squidclient mgr:client_list | grep "Address"
> > bash: squidclient: command not found
>
> That is the squidclient tool missing on your machine.
>
>
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210830/002693c7/attachment.htm>

From uzee001 at yahoo.com  Tue Aug 31 14:50:12 2021
From: uzee001 at yahoo.com (U Zee)
Date: Tue, 31 Aug 2021 14:50:12 +0000 (UTC)
Subject: [squid-users] Fwd:  Getting a squid clients list
In-Reply-To: <CABA8h=ROTEtUg=Kw_RV1uEXqfKYUpQh=AN9iqj00Cn0-Nhc5QQ@mail.gmail.com>
References: <28129445.847427.1630305303013.ref@mail.yahoo.com>
 <28129445.847427.1630305303013@mail.yahoo.com>
 <f30ef21e-9d2a-d48d-7e8a-e61bd200bf03@treenet.co.nz>
 <412730933.885899.1630318687240@mail.yahoo.com>
 <fa799223-0259-e839-4d17-17099db7fc93@treenet.co.nz>
 <2137930776.899158.1630323862982@mail.yahoo.com>
 <CABA8h=R2xJ38_8am92tDb-E6SiJ4pJm6Sn5-DqcxUA7HaJC+tQ@mail.gmail.com>
 <CABA8h=ROTEtUg=Kw_RV1uEXqfKYUpQh=AN9iqj00Cn0-Nhc5QQ@mail.gmail.com>
Message-ID: <960522696.1390939.1630421412728@mail.yahoo.com>

 Thanks for the pointer?Eliezer. I installed it on an Ubuntu 20 machine and tried but it didn't seem to work:
 root at ub20-srv1:~# squidclient -h squid.mydomain.com mgr:client_listHTTP/1.0 403 ForbiddenServer: squid/2.6.STABLE13Date: Tue, 31 Aug 2021 14:45:09 GMTContent-Type: text/htmlContent-Length: 1115Expires: Tue, 31 Aug 2021 14:45:09 GMTX-Squid-Error: ERR_ACCESS_DENIED 0X-Cache: MISS from squid.mydomain.com?Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)Proxy-Connection: close
root at ub20-srv1:~# squidclient -h squid.mydomain.com? mgr:infoHTTP/1.0 403 ForbiddenServer: squid/2.6.STABLE13Date: Tue, 31 Aug 2021 14:46:33 GMTContent-Type: text/htmlContent-Length: 1101Expires: Tue, 31 Aug 2021 14:46:33 GMTX-Squid-Error: ERR_ACCESS_DENIED 0X-Cache: MISS from squid.mydomain.com?Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)Proxy-Connection: close
Although the proxy function seems to be working, but I cannot get the "mgr" function to work:
root at ub20-srv1:~# squidclient -h squid.mydomain.com?-v http://vmware.comRequest:GET http://vmware.com HTTP/1.0Host: vmware.comUser-Agent: squidclient/4.10Accept: */*Connection: close.
HTTP/1.0 301 Moved PermanentlyLocation: https://www.vmware.com/Content-Length: 0X-Cache: MISS from squid.mydomain.com?Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)Proxy-Connection: close




    On Monday, August 30, 2021, 02:56:29 PM GMT+3, NgTech LTD <ngtech1ltd at gmail.com> wrote:  
 
 
Hey Uzee,
You can use squidclient from another machine to access this machine.I do not remember how by heart but Amos might know if I am guessing right.
Eliezer
?????? ??? ??, 30 ????? 2021, 14:44, ??? U Zee ?<uzee001 at yahoo.com>:

 <sigh> I know and sadly installing it is not possible either. Without going into the details too much, its a machine with a legacy environment where yum and some other tools are broken and people who knew about the configs are long gone.
    On Monday, August 30, 2021, 01:29:47 PM GMT+3, Amos Jeffries <squid3 at treenet.co.nz> wrote:  
 
 On 30/08/21 10:18 pm, U Zee wrote:
> Thanks Amos. I don't think the clientdb features you mentioned are 
> enabled, I'm getting a command not found.
> Also I don't see anything configured for logging in squid.conf (I don't 
> know if there is any other place for it)
> 
> bash-3.00# ps -ef|grep squid
> root? ? ? 2467? ? ?1? 0? 2020 ?? ? ? ? 00:00:00 /usr/squid/sbin/squid
> nobody? ? 2471? 2467? 0? 2020 ?? ? ? ? 07:49:45 (squid)
> root? ? ?28018 20110? 0 13:12 pts/0? ? 00:00:00 grep squid
> 
> bash-3.00# /usr/squid/sbin/squid -v
> Squid Cache: Version 2.6.STABLE13
> configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
> 
> bash-3.00# squidclient mgr:client_list | grep "Address"
> bash: squidclient: command not found

That is the squidclient tool missing on your machine.

Amos
_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users
  _______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210831/cae7de48/attachment.htm>

From marciobacci at gmail.com  Tue Aug 31 15:05:23 2021
From: marciobacci at gmail.com (Marcio B.)
Date: Tue, 31 Aug 2021 12:05:23 -0300
Subject: [squid-users] Squid performance issues
Message-ID: <CA+0TdyrUS++kCdzN9imPDbj_22NXo3gtkH6qZYFWsc3B1RvJLQ@mail.gmail.com>

Hi,

I implemented a Squid server in version 4.6 on Debian and tested it for
about 40 days. However I put it into production today and Internet browsing
was extremely slow.

In /var/log/syslog I'm getting the following messages:

Aug 31 11:29:19 srvproxy squid[4041]: WARNING! Your cache is running out of
filedescriptors

Aug 31 11:29:35 srvproxy squid[4041]: WARNING! Your cache is running out of
filedescriptors

Aug 31 11:29:51 srvproxy squid[4041]: WARNING! Your cache is running out of
filedescriptors


I searched the Internet, but I only found very old information and
referring files that don't exist on my Squid Server.

The only thing I did was add the following value to the
/etc/security/limits.conf file:

*-nofile 65535

however this did not solve.

Does anyone have any idea how I could solve this problem?

Regards,

M?rcio Bacci
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210831/9094cd45/attachment.htm>

From ngtech1ltd at gmail.com  Tue Aug 31 15:10:59 2021
From: ngtech1ltd at gmail.com (NgTech LTD)
Date: Tue, 31 Aug 2021 18:10:59 +0300
Subject: [squid-users] Squid performance issues
In-Reply-To: <CA+0TdyrUS++kCdzN9imPDbj_22NXo3gtkH6qZYFWsc3B1RvJLQ@mail.gmail.com>
References: <CA+0TdyrUS++kCdzN9imPDbj_22NXo3gtkH6qZYFWsc3B1RvJLQ@mail.gmail.com>
Message-ID: <CABA8h=RLvnL_N=Y=-ytk64HQX_+=hbmw8bH90F4TJDk70FqtnA@mail.gmail.com>

Hey Marcio,

You will need to add a systemd service file that extends the current one
with more FileDescriptors.

I cannot guide now I do hope to be able to write later.

If anyone is able to help faster go ahead.

Eliezer


?????? ??? ??, 31 ????? 2021, 18:05, ??? Marcio B. ?<marciobacci at gmail.com>:

> Hi,
>
> I implemented a Squid server in version 4.6 on Debian and tested it for
> about 40 days. However I put it into production today and Internet browsing
> was extremely slow.
>
> In /var/log/syslog I'm getting the following messages:
>
> Aug 31 11:29:19 srvproxy squid[4041]: WARNING! Your cache is running out
> of filedescriptors
>
> Aug 31 11:29:35 srvproxy squid[4041]: WARNING! Your cache is running out
> of filedescriptors
>
> Aug 31 11:29:51 srvproxy squid[4041]: WARNING! Your cache is running out
> of filedescriptors
>
>
> I searched the Internet, but I only found very old information and
> referring files that don't exist on my Squid Server.
>
> The only thing I did was add the following value to the
> /etc/security/limits.conf file:
>
> *-nofile 65535
>
> however this did not solve.
>
> Does anyone have any idea how I could solve this problem?
>
> Regards,
>
> M?rcio Bacci
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210831/91605f1a/attachment.htm>

From belle at bazuin.nl  Tue Aug 31 15:18:28 2021
From: belle at bazuin.nl (=?windows-1252?Q?L.P.H._van_Belle?=)
Date: Tue, 31 Aug 2021 17:18:28 +0200
Subject: [squid-users] Squid performance issues
In-Reply-To: <CABA8h=RLvnL_N=Y=-ytk64HQX_+=hbmw8bH90F4TJDk70FqtnA@mail.gmail.com>
References: <CA+0TdyrUS++kCdzN9imPDbj_22NXo3gtkH6qZYFWsc3B1RvJLQ@mail.gmail.com>
Message-ID: <vmime.612e4844.6f87.12361dc39edb284@ms249-lin-003.rotterdam.bazuin.nl>

He Marco, 

You better upgrade to debian bullseye and see if it happens there also. 
If you dont want that, try this. 

systemctl edit squid.service 
Add : 

[Service]
LimitNOFILE=65535
?
?
Save and run : systemctl restart squid

But i would recommend to use Debian Bullseye. 


Greetz, 

Louis
?
?

Van: squid-users [mailto:squid-users-bounces at lists.squid-cache.org] Namens NgTech LTD
Verzonden: dinsdag 31 augustus 2021 17:11
Aan: Marcio B.
CC: Squid Users
Onderwerp: Re: [squid-users] Squid performance issues



Hey Marcio, 

You will need to add a systemd service file that extends the current one with more FileDescriptors.


I cannot guide now I do hope to be able to write later.


If anyone is able to help faster go ahead.


Eliezer




, 31 2021, 18:05, Marcio B. <marciobacci at gmail.com>:

Hi,

I implemented a Squid server in version 4.6 on Debian and tested it for about 40 days. However I put it into production today and Internet browsing was extremely slow.

In /var/log/syslog I'm getting the following messages:

Aug 31 11:29:19 srvproxy squid[4041]: WARNING! Your cache is running out of filedescriptors

Aug 31 11:29:35 srvproxy squid[4041]: WARNING! Your cache is running out of filedescriptors

Aug 31 11:29:51 srvproxy squid[4041]: WARNING! Your cache is running out of filedescriptors


I searched the Internet, but I only found very old information and referring files that don't exist on my Squid Server.

The only thing I did was add the following value to the /etc/security/limits.conf file:

*-nofile 65535

however this did not solve.

Does anyone have any idea how I could solve this problem?


Regards,


M?rcio Bacci

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
http://lists.squid-cache.org/listinfo/squid-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20210831/565013dc/attachment.htm>

From klaus_brandl at genua.de  Tue Aug 31 15:18:26 2021
From: klaus_brandl at genua.de (Klaus Brandl)
Date: Tue, 31 Aug 2021 15:18:26 +0000
Subject: [squid-users] Squid performance issues
In-Reply-To: <CABA8h=RLvnL_N=Y=-ytk64HQX_+=hbmw8bH90F4TJDk70FqtnA@mail.gmail.com>
References: <CA+0TdyrUS++kCdzN9imPDbj_22NXo3gtkH6qZYFWsc3B1RvJLQ@mail.gmail.com>
 <CABA8h=RLvnL_N=Y=-ytk64HQX_+=hbmw8bH90F4TJDk70FqtnA@mail.gmail.com>
Message-ID: <cc4b0ea3b6e9816bae929368f7a895773735c0ef.camel@genua.de>

look at your cache.log, after squid is starting, there you can see, how
much filedescriptors are available:

2021/08/31 17:14:36.870 kid1| With 1024 file descriptors available

Maybe there is a file like /etc/default/squid:

SQUID_MAXFD=1024

Regards

Klaus

Am Dienstag, dem 31.08.2021 um 18:10 +0300 schrieb NgTech LTD:
> Hey Marcio,
> 
> You will need to add a systemd service file that extends the current
> one with more FileDescriptors.
> 
> I cannot guide now I do hope to be able to write later.
> 
> If anyone is able to help faster go ahead.
> 
> Eliezer
> 
> 
> ?????? ??? ??, 31 ????? 2021, 18:05, ??? Marcio B.
> ?<marciobacci at gmail.com>:
> > Hi,
> > 
> > I implemented a Squid server in version 4.6 on Debian and tested it
> > for about 40 days. However I put it into production today and
> > Internet browsing was extremely slow.
> > 
> > In /var/log/syslog I'm getting the following messages:
> > 
> > Aug 31 11:29:19 srvproxy squid[4041]: WARNING! Your cache is
> > running out of filedescriptors
> > 
> > Aug 31 11:29:35 srvproxy squid[4041]: WARNING! Your cache is
> > running out of filedescriptors
> > 
> > Aug 31 11:29:51 srvproxy squid[4041]: WARNING! Your cache is
> > running out of filedescriptors
> > 
> > 
> > I searched the Internet, but I only found very old information and
> > referring files that don't exist on my Squid Server.
> > 
> > The only thing I did was add the following value to the
> > /etc/security/limits.conf file:
> > 
> > *-nofile 65535
> > 
> > however this did not solve.
> > 
> > Does anyone have any idea how I could solve this problem?
> > 
> > Regards,
> > 
> > M?rcio Bacci
> > _______________________________________________
> > squid-users mailing list
> > squid-users at lists.squid-cache.org
> > http://lists.squid-cache.org/listinfo/squid-users
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> http://lists.squid-cache.org/listinfo/squid-users


