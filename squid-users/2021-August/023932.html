<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] no ssl intercept - question how it works
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20no%20ssl%20intercept%20-%20question%20how%20it%20works&In-Reply-To=%3CCAGU_Ci%2BJ-CS9Np%3DwYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023930.html">
   <LINK REL="Next"  HREF="023935.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] no ssl intercept - question how it works</H1>
    <B>robert k Wild</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20no%20ssl%20intercept%20-%20question%20how%20it%20works&In-Reply-To=%3CCAGU_Ci%2BJ-CS9Np%3DwYjro9r7wzH7xRBeCZvQDBwpkywutFnPLnQ%40mail.gmail.com%3E"
       TITLE="[squid-users] no ssl intercept - question how it works">robertkwild at gmail.com
       </A><BR>
    <I>Tue Aug 10 16:56:24 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023930.html">[squid-users] Compile SQUID 5.1 on Debian 10
</A></li>
        <LI>Next message (by thread): <A HREF="023935.html">[squid-users] no ssl intercept - question how it works
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23932">[ date ]</a>
              <a href="thread.html#23932">[ thread ]</a>
              <a href="subject.html#23932">[ subject ]</a>
              <a href="author.html#23932">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi all,

before i continue, so sorry for the stupid question but trying to learn

basically heres my squid.conf

#NO SSL Interception
acl DiscoverSNIHost at_step SslBump1
acl NoSSLIntercept ssl::server_name
&quot;/usr/local/squid/etc/nointerceptssl.txt&quot;
ssl_bump splice NoSSLIntercept
ssl_bump peek DiscoverSNIHost
ssl_bump bump all

#SSL Bump
http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/myCA.pem
generate-host-certificates=on dynamic_cert_mem_cache_size=4MB
sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s
/var/lib/ssl_db -M 4MB
acl step1 at_step SslBump1
ssl_bump peek step1
ssl_bump bump all
#
#allow special URL paths
acl special_url url_regex &quot;/usr/local/squid/etc/urlspecial.txt&quot;

#deny MIME types
acl mimetype rep_mime_type &quot;/usr/local/squid/etc/mimedeny.txt&quot;

http_reply_access allow special_url
http_reply_access deny mimetype
#
#HTTP_HTTPS whitelist websites
acl whitelist ssl::server_name &quot;/usr/local/squid/etc/urlwhite.txt&quot;

#HTTP_HTTPS whitelist websites regex
acl whitelistreg ssl::server_name_regex
&quot;/usr/local/squid/etc/urlregwhite.txt&quot;

http_access allow activation whitelist
http_access allow activation whitelistreg
http_access deny all

in my urlwhitelist is this

#apple app store
.p18-buy.itunes.apple.com
.gsas.apple.com
.se-edge.itunes.apple.com
.ocsp2.apple.com
.gsa.apple.com
.osxapps.itunes.apple.com
.xp.apple.com
.search.itunes.apple.com
.apptrailers-ssl.itunes.apple.com
.apptrailers.itunes.apple.com
.configuration.apple.com
.amp-api.apps.apple.com
.buy.itunes.apple.com
.api-edge.apps.apple.com
.play.itunes.apple.com
.s.mzstatic.com
.sf-api-token-service.itunes.apple.com
.apps.mzstatic.com
.init.itunes.apple.com
.bag.itunes.apple.com

in my nointerceptssl is this

#apple app store
.bag.itunes.apple.com
.apps.mzstatic.com
.play.itunes.apple.com
.api-edge.apps.apple.com
.amp-api.apps.apple.com
.xp.apple.com
.p18-buy.itunes.apple.com

i got all the urls etc looking at tail -f access.log and greping the ip and
tcp denied

but when i try to load the apple app store the whitelist isnt enough, i
need to add a couple of urls to the nointerceptssl

i got that list by doing the same method ie  looking at tail -f access.log
and greping the ip but as ive already whitelisted the urls they all came
back as none or ok instead of saying tcp denied

my question is why do i need to add some urls to the nointerceptssl and why
isnt it enough just to add it to urlwhite list

rob

-- 
Regards,

Robert K Wild.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210810/a7539bb9/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210810/a7539bb9/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023930.html">[squid-users] Compile SQUID 5.1 on Debian 10
</A></li>
	<LI>Next message (by thread): <A HREF="023935.html">[squid-users] no ssl intercept - question how it works
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23932">[ date ]</a>
              <a href="thread.html#23932">[ thread ]</a>
              <a href="subject.html#23932">[ subject ]</a>
              <a href="author.html#23932">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
