<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] no ssl intercept - question how it works
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20no%20ssl%20intercept%20-%20question%20how%20it%20works&In-Reply-To=%3Cde66871f-f2d5-4d95-367c-cc891e04d0e9%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023942.html">
   <LINK REL="Next"  HREF="023944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] no ssl intercept - question how it works</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20no%20ssl%20intercept%20-%20question%20how%20it%20works&In-Reply-To=%3Cde66871f-f2d5-4d95-367c-cc891e04d0e9%40treenet.co.nz%3E"
       TITLE="[squid-users] no ssl intercept - question how it works">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Aug 12 03:01:26 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023942.html">[squid-users] no ssl intercept - question how it works
</A></li>
        <LI>Next message (by thread): <A HREF="023944.html">[squid-users] no ssl intercept - question how it works
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23943">[ date ]</a>
              <a href="thread.html#23943">[ thread ]</a>
              <a href="subject.html#23943">[ subject ]</a>
              <a href="author.html#23943">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/08/21 4:06 am, robert k Wild wrote:
&gt;<i> Great thanks Amos as always
</I>&gt;<i> 
</I>&gt;<i> So shall I leave this ssl bump lines in
</I>&gt;<i> 
</I>&gt;<i> ssl_bump splice NoSSLIntercept
</I>&gt;&gt;<i> ssl_bump peek DiscoverSNIHost
</I>&gt;&gt;<i> ssl_bump bump all
</I>&gt;<i> 
</I>&gt;<i> And delete this one
</I>&gt;<i> 
</I>&gt;<i> acl step1 at_step SslBump1
</I>&gt;&gt;<i> ssl_bump peek step1
</I>&gt;&gt;<i> ssl_bump bump all
</I>&gt;<i> 
</I>&gt;<i> As your right there both the same, I didn't spot that
</I>&gt;<i> 
</I>&gt;<i> My understanding is the &quot;no ssl intercept&quot;, squid doesn't even bother to 
</I>&gt;<i> inspect the packets ie man in the middle and just literally passes it 
</I>&gt;<i> straight to the client
</I>&gt;<i> 
</I>&gt;<i> Is that right?
</I>&gt;<i> 
</I>
Not quite. Squid still has to receive and look at something to make the 
decision to splice.

The &quot;NoSSLIntercept&quot; is just an ACL. Being defined as a ssl:server_name 
type it looks at whatever Squid is able to find for a server name 
amongst the available data (CONNECT message URI, the client IP's 
reverse-DNS, any TLS details seen so far, etc.
  So it depends on how many of the SSL-Bump steps have taken place so 
far as to what it can match against.

In your case it happens at step1 and maybe step2 (when the peek happened 
at step1 instead). When means Squid looks at the TCP connections 
client-IP, a CONNECT URI (if any) and maybe the TLS client handshake 
plain-text details.

  Note this is specific to your *current* configuration. Small changes 
to the order of ssl_bump lines or ACLs used can change this behaviour 
dramatically.

Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023942.html">[squid-users] no ssl intercept - question how it works
</A></li>
	<LI>Next message (by thread): <A HREF="023944.html">[squid-users] no ssl intercept - question how it works
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23943">[ date ]</a>
              <a href="thread.html#23943">[ thread ]</a>
              <a href="subject.html#23943">[ subject ]</a>
              <a href="author.html#23943">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
