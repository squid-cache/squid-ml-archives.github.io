<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] certificate issuer not known
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20certificate%20issuer%20not%20known&In-Reply-To=%3C9aa2d5f9-9b6d-dd32-0109-b6428c1528c5%40ckta.by%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023940.html">
   <LINK REL="Next"  HREF="023946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] certificate issuer not known</H1>
    <B>Majed Zouhairy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20certificate%20issuer%20not%20known&In-Reply-To=%3C9aa2d5f9-9b6d-dd32-0109-b6428c1528c5%40ckta.by%3E"
       TITLE="[squid-users] certificate issuer not known">m_zouhairy at ckta.by
       </A><BR>
    <I>Thu Aug 12 11:34:43 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023940.html">[squid-users] Log to statsd
</A></li>
        <LI>Next message (by thread): <A HREF="023946.html">[squid-users] How to stop writes to netdb.state?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23945">[ date ]</a>
              <a href="thread.html#23945">[ thread ]</a>
              <a href="subject.html#23945">[ subject ]</a>
              <a href="author.html#23945">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>solved the issue with this guide:

<A HREF="https://docs.diladele.com/faq/squid/fix_unable_to_get_issuer_cert_locally.html">https://docs.diladele.com/faq/squid/fix_unable_to_get_issuer_cert_locally.html</A>

but needs different commands for tumbleweed



On 6/23/21 2:56 PM, Majed Zouhairy wrote:
&gt;<i> 
</I>&gt;<i> Health be upon you,
</I>&gt;<i> when visiting
</I>&gt;<i> <A HREF="https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit">https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit</A>
</I>&gt;<i> 
</I>&gt;<i> on squid 4.15
</I>&gt;<i> 
</I>&gt;<i> it displays:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ERROR
</I>&gt;<i> The requested URL could not be retrieved
</I>&gt;<i> 
</I>&gt;<i> The following error was encountered while trying to retrieve the URL: 
</I>&gt;<i> <A HREF="https://wiki.squid-cache.org/*">https://wiki.squid-cache.org/*</A>
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160; Failed to establish a secure connection to 104.130.201.120
</I>&gt;<i> 
</I>&gt;<i> The system returned:
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160; (71) Protocol error (TLS code: 
</I>&gt;<i> X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)
</I>&gt;<i> 
</I>&gt;<i>  &#160;&#160;&#160; SSL Certficate error: certificate issuer (CA) not known: 
</I>&gt;<i> /C=US/O=Let's Encrypt/CN=R3
</I>&gt;<i> 
</I>&gt;<i> This proxy and the remote host failed to negotiate a mutually acceptable 
</I>&gt;<i> security settings for handling your request. It is possible that the 
</I>&gt;<i> remote host does not support secure connections, or the proxy is not 
</I>&gt;<i> satisfied with the host security credentials.
</I>&gt;<i> 
</I>&gt;<i> Your cache administrator is webmaster.
</I>&gt;<i> 
</I>&gt;<i> configuration:
</I>&gt;<i> 
</I>&gt;<i> http_port 3128 ssl-bump&#160; cert=/etc/squid/certs/myCA.pem 
</I>&gt;<i> generate-host-certificates=on dynamic_cert_mem_cache_size=8MB
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_s1_connect&#160;&#160;&#160;&#160;&#160;&#160;&#160; at_step SslBump1
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_s2_client_hello&#160;&#160;&#160;&#160; at_step SslBump2
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_s3_server_hello&#160;&#160;&#160;&#160; at_step SslBump3
</I>&gt;<i> 
</I>&gt;<i> # define acls for sites that must not be actively bumped
</I>&gt;<i> 
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_allowed_hsts&#160;&#160;&#160; ssl::server_name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .akamaihd.net
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_allowed_hsts&#160;&#160;&#160; ssl::server_name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .proxy.skko.by
</I>&gt;<i> #acl&#160;&#160;&#160;&#160; tls_server_is_bank&#160;&#160;&#160;&#160; ssl::server_name&#160;&#160;&#160;&#160; .abnamro.nl
</I>&gt;<i> #acl&#160;&#160;&#160;&#160; tls_server_is_bank&#160;&#160;&#160;&#160; ssl::server_name&#160;&#160;&#160;&#160; .abnamro.comacl
</I>&gt;<i> tls_server_is_bank&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ssl::server_name 
</I>&gt;<i> &quot;/usr/local/ufdbguard/blacklists/finance/domains.squidsplice&quot;
</I>&gt;<i> acl&#160;&#160;&#160;&#160; tls_to_splice&#160;&#160;&#160;&#160; any-of&#160;&#160;&#160;&#160; tls_allowed_hsts tls_server_is_bank
</I>&gt;<i> 
</I>&gt;<i> # TLS/SSL bumping steps
</I>&gt;<i> 
</I>&gt;<i> ssl_bump&#160;&#160;&#160;&#160; peek&#160;&#160;&#160; tls_s1_connect&#160;&#160;&#160;&#160; # peek at TLS/SSL connect data
</I>&gt;<i> ssl_bump&#160;&#160;&#160;&#160; splice&#160;&#160;&#160;&#160; tls_to_splice&#160;&#160;&#160; # splice some: no active bump
</I>&gt;<i> ssl_bump&#160;&#160;&#160;&#160; stare&#160;&#160;&#160;&#160; all&#160;&#160;&#160;&#160;&#160;&#160;&#160; # stare(peek) at server
</I>&gt;<i>  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # properties of 
</I>&gt;<i> the webserver
</I>&gt;<i> ssl_bump&#160;&#160;&#160;&#160; bump&#160;&#160;&#160; # bump if we can (if the stare succeeded)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> #ssl_bump peek all
</I>&gt;<i> #ssl_bump splice all
</I>&gt;<i> 
</I>&gt;<i> ##ssl_bump server-first all
</I>&gt;<i> 
</I>&gt;<i> #sslproxy_cert_error allow all
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> cache_dir ufs /var/cache/squid 8000 16 256
</I>&gt;<i> 
</I>&gt;<i> # Leave coredumps in the first cache dir
</I>&gt;<i> coredump_dir /var/cache/squid
</I>&gt;<i> 
</I>&gt;<i> cache_mem 960 MB
</I>&gt;<i> 
</I>&gt;<i> netdb_filename none
</I>&gt;<i> 
</I>&gt;<i> #
</I>&gt;<i> # Add any of your own refresh_pattern entries above these.
</I>&gt;<i> #
</I>&gt;<i> refresh_pattern ^ftp:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1440&#160;&#160;&#160; 20%&#160;&#160;&#160; 10080
</I>&gt;<i> refresh_pattern ^gopher:&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1440&#160;&#160;&#160; 0%&#160;&#160;&#160; 1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?)&#160;&#160;&#160;&#160; 0&#160;&#160;&#160; 0%&#160;&#160;&#160; 0
</I>&gt;<i> refresh_pattern .&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160; 20%&#160;&#160;&#160; 4320
</I>&gt;<i> 
</I>&gt;<i> url_rewrite_extras &quot;%&gt;a/%&gt;A %un %&gt;rm bump_mode=%ssl::bump_mode 
</I>&gt;<i> sni=\&quot;%ssl::&gt;sni\&quot; referer=\&quot;%{Referer}&gt;h\&quot;&quot;
</I>&gt;<i> url_rewrite_program /usr/local/ufdbguard/bin/ufdbgclient -m 4 -l 
</I>&gt;<i> /var/log/squid/
</I>&gt;<i> url_rewrite_children 16 startup=8 idle=2 concurrency=4 queue-size=64
</I>&gt;<i> #debug_options ALL,1 33,2 28,9
</I>&gt;<i> 
</I>&gt;<i> what needs to be done to fix?
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023940.html">[squid-users] Log to statsd
</A></li>
	<LI>Next message (by thread): <A HREF="023946.html">[squid-users] How to stop writes to netdb.state?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23945">[ date ]</a>
              <a href="thread.html#23945">[ thread ]</a>
              <a href="subject.html#23945">[ subject ]</a>
              <a href="author.html#23945">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
