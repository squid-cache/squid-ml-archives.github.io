<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Many new ERROR lines in cache.log after upgrade
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Many%20new%20ERROR%20lines%20in%20cache.log%20after%20upgrade&In-Reply-To=%3Cbbcf5bbd-8c62-095f-8ffb-7601c151d58e%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024334.html">
   <LINK REL="Next"  HREF="024336.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Many new ERROR lines in cache.log after upgrade</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Many%20new%20ERROR%20lines%20in%20cache.log%20after%20upgrade&In-Reply-To=%3Cbbcf5bbd-8c62-095f-8ffb-7601c151d58e%40treenet.co.nz%3E"
       TITLE="[squid-users] Many new ERROR lines in cache.log after upgrade">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Dec 21 13:00:54 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024334.html">[squid-users] Many new ERROR lines in cache.log after upgrade
</A></li>
        <LI>Next message (by thread): <A HREF="024336.html">[squid-users] Many new ERROR lines in cache.log after upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24335">[ date ]</a>
              <a href="thread.html#24335">[ thread ]</a>
              <a href="subject.html#24335">[ subject ]</a>
              <a href="author.html#24335">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/12/21 00:42, Truniger Othmar wrote:
&gt;<i> Hi
</I>&gt;<i> we have been successfully running Squid for authentication and authorization for almost two decades. We don't cache and no SSL-bumping, just many access rules.
</I>&gt;<i> 
</I>&gt;<i> Last weekend I migrated from self-compiled 3.5.x on RHEL7 to RHEL8 with official RPM squid-4.11-4 using the same configuration file. We want to get advantage from official RPMs.
</I>&gt;<i> 
</I>&gt;<i> Now we get many log entries in cache.log like this (a few hundred pairs a day):
</I>&gt;<i> 2021/12/21 11:52:24 kid3| ERROR: helper: {result=BH, notes={message: Success; }}, attempt #1 of 2
</I>&gt;<i> 2021/12/21 11:52:24 kid3| ERROR: helper: {result=BH, notes={message: Success; message: Success; }}, attempt #2 of 2
</I>&gt;<i> 
</I>&gt;<i> Because nothing in the environment changed I must assume that it's only a matter of more intensive logging. But I'm not sure if I have to worry about.
</I>&gt;<i> 
</I>
Or an old helper that has been producing garbage output that v3.5 
ignored and v4 rejects.


&gt;<i> I understand it's related to basic helpers. Since ever we use the original basic_ldap_auth and ext_ldap_group_acl and never experienced any problems with them. Also cachemgr now reports 100% successful requests/replies for the helpers and I see not any indication for any problem.
</I>&gt;<i> It just looks a little awkward to see ERROR in these lines but Success for everything at the same time.
</I>&gt;<i> I have set &quot;debug_options ALL,1 rotate=2&quot;
</I>&gt;<i> The helpers don't use persistent connections.
</I>&gt;<i> 
</I>
The lines shown do not indicate which type of helper is involved.

Squid is receiving one of the following lines from the helper:

   BH message=&quot;Success;&quot;
   BH Success;


You will have to track down which helper is actually producing the BH 
output. Each helper API has its own debug section, so you need to know 
which one to enable debugging for first.

Once you know that debug_options will show you the Squid side of the API 
communication. Most helpers support &quot;-d&quot; parameter to debug their 
internal operations for the other side of the picture.


&gt;<i> Maybe this point could be significant: I used &quot;--disable-ipv6&quot; when self-compiling while the RHEL8 RPM probably has full IPv6 support included. Our servers have all IPv6 support disabled though.
</I>&gt;<i> 
</I>
AFAIK only the external ACL helper is affected by that issue. You can 
use the 'ipv4' option on the external_acl_type directive to fix it.



&gt;<i> I could not find much about this topic. It was once said that one should check for strange behaviour of the basic helpers if these messages occur.
</I>&gt;<i> 
</I>&gt;<i> Should I worry about it?
</I>
Maybe, a little bit anyway. It will be affecting some transactions at 
least and should be fixed.


&gt;<i> Is it just an artefact for logging in this redhat RPM version?
</I>&gt;<i> Could it be related with the way squid helpers deals with IPv6 on systems without IPv6?
</I>&gt;<i> How could I specifically debug the helpers without flooding the cache.log (what section)?
</I>
The &quot;ERROR&quot; logs you see are from section 84 which is the logic shared 
used by all helper APIs. That covers the I/O channel and splitting the 
helper response line into concurrency-id, code and kv-pairs. You also 
need the section for whichever helper is actually producing that output 
to see how those details are being treated.


Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024334.html">[squid-users] Many new ERROR lines in cache.log after upgrade
</A></li>
	<LI>Next message (by thread): <A HREF="024336.html">[squid-users] Many new ERROR lines in cache.log after upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24335">[ date ]</a>
              <a href="thread.html#24335">[ thread ]</a>
              <a href="subject.html#24335">[ subject ]</a>
              <a href="author.html#24335">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
