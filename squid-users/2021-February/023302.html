<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] SSL Squid 5 Cipher suite ordering issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20Squid%205%20Cipher%20suite%20ordering%20issue&In-Reply-To=%3C7151e716-55d4-1156-2cca-7cbee93f2841%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023301.html">
   <LINK REL="Next"  HREF="023304.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] SSL Squid 5 Cipher suite ordering issue</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20SSL%20Squid%205%20Cipher%20suite%20ordering%20issue&In-Reply-To=%3C7151e716-55d4-1156-2cca-7cbee93f2841%40measurement-factory.com%3E"
       TITLE="[squid-users] SSL Squid 5 Cipher suite ordering issue">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Feb  4 16:39:11 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023301.html">[squid-users] SSL Squid 5 Cipher suite ordering issue
</A></li>
        <LI>Next message (by thread): <A HREF="023304.html">[squid-users] problen whith authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23302">[ date ]</a>
              <a href="thread.html#23302">[ thread ]</a>
              <a href="subject.html#23302">[ subject ]</a>
              <a href="author.html#23302">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/4/21 10:32 AM, Prem Chand wrote:

&gt;<i> I'm running SSL squid 5 on Centos 8 and I could see Cipher Suites order
</I>&gt;<i> changes when I access the below website through Squid and without using
</I>&gt;<i> squid I'm getting correct order.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://clienttest.ssllabs.com:8443/ssltest/viewMyClient.html">https://clienttest.ssllabs.com:8443/ssltest/viewMyClient.html</A>
</I>&gt;<i> 
</I>&gt;<i> I want to know why and how Squid is changing the cipher suite order and
</I>&gt;<i> how to stop squid from doing it. Please advise.
</I>
There are several different use cases related to cipher order in
Squid-server connections, including these TLS v1.2 (and earlier) cases:

1. You are specifying &quot;tls_outgoing_options cihper&quot;, and you are either
not using SslBump or bumping the TLS client during SslBump step1. In
this case, Squid should pass your tls_outgoing_options cipher
configuration to OpenSSL. What happens next is up to OpenSSL.

2. You are not specifying &quot;tls_outgoing_options cihper&quot;, and you are
either not using SslBump or bumping the TLS client during SslBump step1.
In this case, Squid does not tell what ciphers to use. What happens next
is up to OpenSSL.

3. You are bumping the TLS client during SslBump step2. In this case,
Squid should give TLS client ciphers to OpenSSL. What happens next is up
to OpenSSL.

4. You are bumping the TLS client during SslBump step3. I am not sure
what should happen here, but perhaps Squid should, during step2, forward
TLS client ciphers that Squid supports, in TLS client order. I do not
know whether Squid actually does that.

To understand why ciphers are reordered, you need to figure out which
use case applies to your test and, if applicable, investigate whether
OpenSSL honors the cipher order specified in SSL_set_cipher_list() and
SSL_CTX_set_cipher_list() calls.

If you confirm that Squid should give the cipher list to OpenSSL in your
use case, and OpenSSL should honor the cipher order, then you can look
for Squid bugs, but that will probably require debugging log analysis
and developer-level expertise.


See also:
<A HREF="http://lists.squid-cache.org/pipermail/squid-users/2021-January/023155.html">http://lists.squid-cache.org/pipermail/squid-users/2021-January/023155.html</A>


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023301.html">[squid-users] SSL Squid 5 Cipher suite ordering issue
</A></li>
	<LI>Next message (by thread): <A HREF="023304.html">[squid-users] problen whith authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23302">[ date ]</a>
              <a href="thread.html#23302">[ thread ]</a>
              <a href="subject.html#23302">[ subject ]</a>
              <a href="author.html#23302">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
