<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to serve custom error pages with images in Squid?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20serve%20custom%20error%20pages%20with%20images%20in%0A%20Squid%3F&In-Reply-To=%3C9faa6028-259c-02b8-513d-b6c8837a2bb4%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023325.html">
   <LINK REL="Next"  HREF="023328.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to serve custom error pages with images in Squid?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20serve%20custom%20error%20pages%20with%20images%20in%0A%20Squid%3F&In-Reply-To=%3C9faa6028-259c-02b8-513d-b6c8837a2bb4%40measurement-factory.com%3E"
       TITLE="[squid-users] How to serve custom error pages with images in Squid?">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Feb 12 15:37:23 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023325.html">[squid-users] How to serve custom error pages with images in Squid?
</A></li>
        <LI>Next message (by thread): <A HREF="023328.html">[squid-users] The user/password pair is correct, yet squid keeps sending me TCP_DENIED/407
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23327">[ date ]</a>
              <a href="thread.html#23327">[ thread ]</a>
              <a href="subject.html#23327">[ subject ]</a>
              <a href="author.html#23327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/12/21 5:44 AM, roee klinger wrote:

&gt;<i> I am trying to serve custom error pages in Squid 4.10, this is my
</I>&gt;<i> squid.comf:
</I>&gt;<i> 
</I>&gt;<i>     error_directory /etc/squid/pages/
</I>&gt;<i>     icon_directory /etc/squid/pages/images/
</I>
&gt;<i> The custom error page loads, but the images are missing. In my HTML file
</I>&gt;<i> I simply put:
</I>&gt;<i> 
</I>&gt;<i>     &lt;img src=&quot;image.png&quot; alt=&quot;...&quot; class=&quot;img-fluid&quot;&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> but if I inspect the image in the browser, I can see it is adding the
</I>&gt;<i> website URL before the image path, like so:
</I>&gt;<i> 
</I>&gt;<i>     <A HREF="http://ipinfo.io/image.png">http://ipinfo.io/image.png</A>
</I>
The browser thinks the error page was generated by the origin server.
Popular browsers essentially do not recognize forward proxies as
legitimate content sources so there is no way for Squid to tell the
browser that the error page is coming from Squid itself.

If images in your error pages use a relative image path (including an
empty path like in your example above) and do not define their own base
URL using HTML, then the browser will use the _request_ URL path as the
base URL, as if the error page came from the origin server that
experienced the error.


&gt;<i> I tried to revert back the default error pages, however, I noticed that
</I>&gt;<i> apparently even there, the images never loaded, it had the exact same issue.
</I>
Squid-generated content, including error pages, may use a
/squid-internal-static/ path that Squid can then recognize in image
requests and recognize that the user wants Squid-generated content. See
global_internal_static and short_icon_urls directives.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023325.html">[squid-users] How to serve custom error pages with images in Squid?
</A></li>
	<LI>Next message (by thread): <A HREF="023328.html">[squid-users] The user/password pair is correct, yet squid keeps sending me TCP_DENIED/407
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23327">[ date ]</a>
              <a href="thread.html#23327">[ thread ]</a>
              <a href="subject.html#23327">[ subject ]</a>
              <a href="author.html#23327">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
