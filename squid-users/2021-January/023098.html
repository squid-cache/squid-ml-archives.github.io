<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Anyone has experience with Windows clients DNS timeout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Anyone%20has%20experience%20with%20Windows%20clients%20DNS%0A%20timeout&In-Reply-To=%3C316601d6e123%249f46f1a0%24ddd4d4e0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023117.html">
   <LINK REL="Next"  HREF="023099.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Anyone has experience with Windows clients DNS timeout</H1>
    <B>ngtech1ltd at gmail.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Anyone%20has%20experience%20with%20Windows%20clients%20DNS%0A%20timeout&In-Reply-To=%3C316601d6e123%249f46f1a0%24ddd4d4e0%24%40gmail.com%3E"
       TITLE="[squid-users] Anyone has experience with Windows clients DNS timeout">ngtech1ltd at gmail.com
       </A><BR>
    <I>Sat Jan  2 16:23:35 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023117.html">[squid-users] Setting up a transparent http and https proxy server using squid 4.6
</A></li>
        <LI>Next message (by thread): <A HREF="023099.html">[squid-users] SSL-BUMP 5.0.4 not working as expected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23098">[ date ]</a>
              <a href="thread.html#23098">[ thread ]</a>
              <a href="subject.html#23098">[ subject ]</a>
              <a href="author.html#23098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Amos,

For an INTERCEPT setup we still need to resolve before squid is touching the packets.
There are registry keys for this purpose however we first need to identify this issue.
The basic way to verify this is using the &quot;set debug&quot; on nslookup and use a fully &quot;cold&quot; DNS recurser.

I was thinking about writing some PowerShell script that will do that but for now it's not really important.
More important then that is a good sysadmin.

Eliezer

----
Eliezer Croitoru
Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
Zoom: Coming soon




-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of Amos Jeffries
Sent: Wednesday, December 30, 2020 6:15 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Anyone has experience with Windows clients DNS timeout

On 30/12/20 9:02 am, NgTech LTD wrote:
&gt;<i> I have seen this issue on Windows clients over the past.
</I>&gt;<i> Windows nslookup shows that the query has timed out after 2 seconds.
</I>&gt;<i> On Linux and xBSD I have researched this issue and have seen that:
</I>&gt;<i> the DNS server is doing a recursive lookup and it takes from 7 to 10++
</I>&gt;<i> seconds sometimes.
</I>&gt;<i> When I pre-warn the DNS cache and the results are cached it takes
</I>&gt;<i> lower then 500 ms for a response to be on the client side and then
</I>&gt;<i> everything works fine.
</I>&gt;<i> 
</I>&gt;<i> I understand that Windows DNS client times out..
</I>&gt;<i> When using froward proxy with squid or any other it works as expected
</I>&gt;<i> since the DNS resolution is done on the proxy server.
</I>&gt;<i> However for this issue I believe that this timeout should be increased
</I>&gt;<i> instead of moving to DNS over HTTPS.
</I>

The DNS timeout in Squid is 30sec for exactly this type of reason. 2 
seconds is far too short to *guarantee* a recursive resolver is able to 
perform all the work and many round-trip lookups that are needed.

Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023117.html">[squid-users] Setting up a transparent http and https proxy server using squid 4.6
</A></li>
	<LI>Next message (by thread): <A HREF="023099.html">[squid-users] SSL-BUMP 5.0.4 not working as expected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23098">[ date ]</a>
              <a href="thread.html#23098">[ thread ]</a>
              <a href="subject.html#23098">[ subject ]</a>
              <a href="author.html#23098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
