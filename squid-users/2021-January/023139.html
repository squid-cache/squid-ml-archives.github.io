<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cache_peer selection based on username
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache_peer%20selection%20based%20on%20username&In-Reply-To=%3CCAGCa14oeRjjkr1O_-NTHJ_ioG%3Dq_cJHhHcoF8LenWXNTESQHfA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023171.html">
   <LINK REL="Next"  HREF="023141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cache_peer selection based on username</H1>
    <B>roee klinger</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cache_peer%20selection%20based%20on%20username&In-Reply-To=%3CCAGCa14oeRjjkr1O_-NTHJ_ioG%3Dq_cJHhHcoF8LenWXNTESQHfA%40mail.gmail.com%3E"
       TITLE="[squid-users] cache_peer selection based on username">roeeklinger60 at gmail.com
       </A><BR>
    <I>Sun Jan 10 15:32:54 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023171.html">[squid-users] How do I rotate access.log?
</A></li>
        <LI>Next message (by thread): <A HREF="023141.html">[squid-users] cache_peer selection based on username
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23139">[ date ]</a>
              <a href="thread.html#23139">[ thread ]</a>
              <a href="subject.html#23139">[ subject ]</a>
              <a href="author.html#23139">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

I am trying to figure out the best way to select cache peers based on the
client username, I have read extensively but I cannot figure out the best
way to do it.

so far I have:

external_acl_type user_whitelist_external children-max=20 ttl=300 %&gt;lp %&gt;a
script.sh
acl whitelisted_users external user_whitelist_external
http_access allow whitelisted_users


and:

nonhierarchical_direct off
never_direct allow all
cache_peer 192.168.8.1 parent 101 0 proxy-only default name=proxy1
cache_peer_access proxy1 allow whitelisted_users
cache_peer_access proxy0.2 deny all
cache_peer 192.168.8.2 parent 102 0 proxy-only default name=proxy2
cache_peer_access proxy2 allow whitelisted_users
cache_peer_access proxy0.3 deny all

ideally, script.sh checks if the request is authinticated and if it is, it
selects the cache peer to use, is there some kind of way to achieve this
with &quot;Defined keywords&quot; to select which cache peer to use or am I looking
at this the wrong way?

What would be the best way to accomplish this?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210110/7a5fc519/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210110/7a5fc519/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023171.html">[squid-users] How do I rotate access.log?
</A></li>
	<LI>Next message (by thread): <A HREF="023141.html">[squid-users] cache_peer selection based on username
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23139">[ date ]</a>
              <a href="thread.html#23139">[ thread ]</a>
              <a href="subject.html#23139">[ subject ]</a>
              <a href="author.html#23139">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
