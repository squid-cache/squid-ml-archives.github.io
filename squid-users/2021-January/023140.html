<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How do I rotate access.log?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20do%20I%20rotate%20access.log%3F&In-Reply-To=%3C001901d6e766%243e502ad0%24baf08070%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023138.html">
   <LINK REL="Next"  HREF="023144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How do I rotate access.log?</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20do%20I%20rotate%20access.log%3F&In-Reply-To=%3C001901d6e766%243e502ad0%24baf08070%24%40gmail.com%3E"
       TITLE="[squid-users] How do I rotate access.log?">ngtech1ltd at gmail.com
       </A><BR>
    <I>Sun Jan 10 15:35:36 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023138.html">[squid-users] How do I rotate access.log?
</A></li>
        <LI>Next message (by thread): <A HREF="023144.html">[squid-users] How do I rotate access.log?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23140">[ date ]</a>
              <a href="thread.html#23140">[ thread ]</a>
              <a href="subject.html#23140">[ subject ]</a>
              <a href="author.html#23140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Have you tried to use the OS logrotate?

 

----

Eliezer Croitoru

Tech Support

Mobile: +972-5-28704261

Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 

Zoom: Coming soon

 

 

From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of roee klinger
Sent: Sunday, January 10, 2021 5:25 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] How do I rotate access.log?

 

Hey,

 

I just wanted to give an update in case anyone is interested, I was not able to find a solution, 

Instead, I set &quot;logfile_rotate 0&quot; and wrote my own custom script to rotate the logs and I am running it as a cron, works just fine.

 

Thanks for trying to help.

 

 

 

On Fri, Jan 1, 2021 at 1:38 AM Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; &gt; wrote:

On 12/31/20 1:39 PM, roee klinger wrote:

&gt;<i>     2020/12/31 20:33:49 kid1| Logfile: opening log daemon:/var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:49 kid1| Logfile Daemon: opening log /var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:49 kid1| Store logging disabled
</I>&gt;<i>     2020/12/31 20:33:57 kid1| logfileRotate: daemon:/var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:57 kid1| logfileRotate: daemon:/var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:57 kid1| Logfile: opening log daemon:/var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:57 kid1| Logfile Daemon: opening log /var/log/squid/access.log
</I>&gt;<i>     2020/12/31 20:33:57 kid1| Store logging disabled
</I>
The second set of the &quot;opening log&quot; lines at 20:33:57 concern me -- why
would somebody start opening those files when you are asking Squid to
rotate the logs. However, this could be a red herring. Do you get the
same kind of output when you send USR1 signal to the process identifier
in the PID file (instead of running &quot;squid -k rotate&quot;)?


&gt;<i> Any tips?
</I>
I have not looked at v4.6 code, but I do not see anything in the more
recent code that would make the visible effects of access.log rotation
conditional except setting logfile_rotate to zero. I also do not see any
obviously relevant changes in v4 change.log (although there was one
access-logging bug fixed).

A few thing could go wrong. If you do not get better advice, I can
suggest the following:

* If you are a developer, I would recommend attaching a debugger to the
logging daemon process to (a) make sure it gets the rotation command
from Squid and (b) to understand why it ignores that command.

* If you are a sysadmin, you may be able to attach strace to the logging
daemon process and share its output. This is best done without user
traffic going through Squid to avoid accidentally sharing user info.
Here are rough steps:

1. Attach strace to the running daemon process (-p). Configure strace to
log at least 100 bytes of system call data (-s 100). Tell strace to
write the output into a file.

2. Rotate.

3. Wait a few seconds.

4. Stop strace. Compress and share a link to its output file.


Cheers,

Alex.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210110/1828deb5/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210110/1828deb5/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023138.html">[squid-users] How do I rotate access.log?
</A></li>
	<LI>Next message (by thread): <A HREF="023144.html">[squid-users] How do I rotate access.log?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23140">[ date ]</a>
              <a href="thread.html#23140">[ thread ]</a>
              <a href="subject.html#23140">[ subject ]</a>
              <a href="author.html#23140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
