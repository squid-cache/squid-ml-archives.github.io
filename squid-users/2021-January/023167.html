<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Microsoft store issues with ssl-bump
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Microsoft%20store%20issues%20with%20ssl-bump&In-Reply-To=%3Cf1395415-7be1-b93e-1d69-140ad8938a52%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023166.html">
   <LINK REL="Next"  HREF="023170.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Microsoft store issues with ssl-bump</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Microsoft%20store%20issues%20with%20ssl-bump&In-Reply-To=%3Cf1395415-7be1-b93e-1d69-140ad8938a52%40treenet.co.nz%3E"
       TITLE="[squid-users] Microsoft store issues with ssl-bump">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Jan 12 12:42:16 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023166.html">[squid-users] Microsoft store issues with ssl-bump
</A></li>
        <LI>Next message (by thread): <A HREF="023170.html">[squid-users] Microsoft store issues with ssl-bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23167">[ date ]</a>
              <a href="thread.html#23167">[ thread ]</a>
              <a href="subject.html#23167">[ subject ]</a>
              <a href="author.html#23167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/01/21 11:32 pm, NgTech LTD wrote:
&gt;<i> Im saying that my config might be wrong and I will send you a full 
</I>&gt;<i> config save which can show you the whole setup like most vendors has.
</I>&gt;<i> I have upgraded squid in production.
</I>&gt;<i> 
</I>&gt;<i> Let me verify first before shouting &quot;bug&quot;.
</I>&gt;<i> 
</I>&gt;<i> Eliezer
</I>&gt;<i> 
</I>
Okay. I see a few things to follow up on.


The other proxy logs show SNI as being 
&quot;<A HREF="https://storeedgefd.dsx.mp.microsoft.com:443">https://storeedgefd.dsx.mp.microsoft.com:443</A>&quot;. SNI should be only a 
name, not a full URL. So if we assume that log is correct the client is 
producing invalid SNI. This may be an issue for Squid, causing it to 
ignore the SNI value entirely.

The openssl tool connecting to the same IP address the other proxy 
claims to be going to gets &quot;sfdataservice.microsoft.com&quot; as the server 
name. In absence of valid SNI to work with that is the name your Squid 
will be trying to match against to decide splice vs bump.


The server prefers to use TLS/1.3 unless explicitly connected to with 
TLS/1.2 immediately. IIRC latest Squid force the client to TLS/1.2 when 
preparing to bump, but may not for spliceand stare. So YMMV.


Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023166.html">[squid-users] Microsoft store issues with ssl-bump
</A></li>
	<LI>Next message (by thread): <A HREF="023170.html">[squid-users] Microsoft store issues with ssl-bump
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23167">[ date ]</a>
              <a href="thread.html#23167">[ thread ]</a>
              <a href="subject.html#23167">[ subject ]</a>
              <a href="author.html#23167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
