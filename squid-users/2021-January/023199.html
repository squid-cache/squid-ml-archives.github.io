<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Mutual TLS for the upstream example
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Mutual%20TLS%20for%20the%20upstream%20example&In-Reply-To=%3C001001d6eb13%24e17670b0%24a4635210%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023198.html">
   <LINK REL="Next"  HREF="023196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Mutual TLS for the upstream example</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Mutual%20TLS%20for%20the%20upstream%20example&In-Reply-To=%3C001001d6eb13%24e17670b0%24a4635210%24%40gmail.com%3E"
       TITLE="[squid-users] Mutual TLS for the upstream example">ngtech1ltd at gmail.com
       </A><BR>
    <I>Fri Jan 15 07:56:06 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023198.html">[squid-users] Mutual TLS for the upstream example
</A></li>
        <LI>Next message (by thread): <A HREF="023196.html">[squid-users] Mutual TLS for the upstream example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23199">[ date ]</a>
              <a href="thread.html#23199">[ thread ]</a>
              <a href="subject.html#23199">[ subject ]</a>
              <a href="author.html#23199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Can we try to understand the issue again?

 

In this setup, should squid know about the client certificate and pass it to the service  backend 

Or maybe just terminate the clients certificate?

 

I am not sure I understood what you need/want to do with squid.

 

Eliezer

 

----

Eliezer Croitoru

Tech Support

Mobile: +972-5-28704261

Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 

Zoom: Coming soon

 

 

From: Sergey Maslyakov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">evolvah at gmail.com</A>&gt; 
Sent: Friday, January 15, 2021 1:38 AM
To: Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Mutual TLS for the upstream example

 

Thank you, Eliezer! I will look into it but it appears that the underlying problem is not solvable by design of the mTLS handshake... There are corner cases that can be solved but not the original issue.

 

 

On Thu, Jan 14, 2021 at 2:39 PM Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; &gt; wrote:

I don&#8217;t know about Squid but I assume varnish has this feature:

<A HREF="https://docs.varnish-software.com/varnish-cache-plus/features/backend-ssl/">https://docs.varnish-software.com/varnish-cache-plus/features/backend-ssl/</A>

 

If you just need a GW without caching it should work as expected.

 

Eliezer

 

----

Eliezer Croitoru

Tech Support

Mobile: +972-5-28704261

Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 

Zoom: Coming soon

 

 

From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; &gt; On Behalf Of Sergey Maslyakov
Sent: Thursday, January 14, 2021 9:41 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 
Subject: [squid-users] Mutual TLS for the upstream example

 

Folks,

 

Is the CONNECT tunnel designed in a way that enables it to &quot;enrich&quot; the outgoing connection with mTLS authentication? &quot;tls_outgoing_options&quot; does not seem to work the way I was hoping it does.

 

My destination server requires mTLS authentication of the client. I have a valid key-cert pair and I can successfully execute a &quot;curl&quot; command to fetch a document from that server using the key-cert pair at hand.

 

I want to put Squid between my clients (Maven, Gradle, Docker Engine, etc) and the server so that clients would be configured to use the instance of Squid as an HTTPS proxy but would not have to be configured with the mTLS key-cert pair.

 

Here is how I see it:

 

Maven --- (HTTPS/CONNECT) ---&gt; Squid (stores my mTLS key-cert pair) --- (mTLS/SSL) ---&gt; Server

 

Is this doable within Squid architecture?

 

I got it working using NGINX with some minor hiccups and I was hoping I can do it more elegantly with Squid.

 

 

Thank you,

/Sergey

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210115/d9317920/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210115/d9317920/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023198.html">[squid-users] Mutual TLS for the upstream example
</A></li>
	<LI>Next message (by thread): <A HREF="023196.html">[squid-users] Mutual TLS for the upstream example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23199">[ date ]</a>
              <a href="thread.html#23199">[ thread ]</a>
              <a href="subject.html#23199">[ subject ]</a>
              <a href="author.html#23199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
