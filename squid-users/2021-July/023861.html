<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%2020.04%20%22apt%20update%22%20issues%20behind%20a%20VPN%20and%0A%20Squid%20proxy&In-Reply-To=%3CCAF28NibkN%2BCrDDM%2B2APUKA1rba_6BjZvoDAF11wXCSaFmHSh9Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023857.html">
   <LINK REL="Next"  HREF="023862.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy</H1>
    <B>David Mills</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%2020.04%20%22apt%20update%22%20issues%20behind%20a%20VPN%20and%0A%20Squid%20proxy&In-Reply-To=%3CCAF28NibkN%2BCrDDM%2B2APUKA1rba_6BjZvoDAF11wXCSaFmHSh9Q%40mail.gmail.com%3E"
       TITLE="[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy">david.mills at acusensus.com
       </A><BR>
    <I>Tue Jul  6 23:25:31 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023857.html">[squid-users] How to use request headers in external_acl_type
</A></li>
        <LI>Next message (by thread): <A HREF="023862.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23861">[ date ]</a>
              <a href="thread.html#23861">[ thread ]</a>
              <a href="subject.html#23861">[ subject ]</a>
              <a href="author.html#23861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We've got a collection of Ubuntu 18.04 boxes out in the field. They connect
to an AWS OpenVPN VPN and use a Squid 3.5 AWS hosted Proxy. They work fine.

We have tried upgrading one to 20.04. Same setup. From the command line
curl or wget can happily download an Ubuntu package from the Ubuntu Mirror
site we use. But &quot;apt update&quot; gets lots of &quot;IGN:&quot; timeouts and errors.

The package we test curl with is
<A HREF="https://mirror.aarnet.edu.au/ubuntu/pool/main/c/curl/curl_7.68.0-1ubuntu2.5_amd64.deb">https://mirror.aarnet.edu.au/ubuntu/pool/main/c/curl/curl_7.68.0-1ubuntu2.5_amd64.deb</A>

The Squid log shows a line the doesn't occur for the successful 18.04 &quot;apt
updates&quot;:
1625190959.233 81 10.0.11.191 TAG_NONE/200 0 CONNECT
mirror.aarnet.edu.au:443 - HIER_DIRECT/2001:388:30bc:cafe::beef -

The full output of an attempt to update is:

&gt;<i> Ign:1 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal InRelease
</I>&gt;<i>
</I>&gt;<i> Ign:2 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates InRelease
</I>&gt;<i>
</I>&gt;<i> Ign:3 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports InRelease
</I>&gt;<i>
</I>&gt;<i> Ign:4 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security InRelease
</I>&gt;<i>
</I>&gt;<i> Err:5 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal Release
</I>&gt;<i>
</I>&gt;<i>   Could not wait for server fd - select (11: Resource temporarily
</I>&gt;<i> unavailable) [IP: 10.0.11.82 3128]
</I>&gt;<i> Err:6 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates Release
</I>&gt;<i>
</I>&gt;<i>   Could not wait for server fd - select (11: Resource temporarily
</I>&gt;<i> unavailable) [IP: 10.0.11.82 3128]
</I>&gt;<i> Err:7 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports Release
</I>&gt;<i>
</I>&gt;<i>   Could not wait for server fd - select (11: Resource temporarily
</I>&gt;<i> unavailable) [IP: 10.0.11.82 3128]
</I>&gt;<i> Err:8 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security Release
</I>&gt;<i>
</I>&gt;<i>   Could not wait for server fd - select (11: Resource temporarily
</I>&gt;<i> unavailable) [IP: 10.0.1.26 3128]
</I>&gt;<i> Reading package lists... Done
</I>&gt;<i>
</I>&gt;<i> N: Ignoring file 'microsoft-prod.list-keep' in directory
</I>&gt;<i> '/etc/apt/sources.list.d/' as it has an invalid filename extension
</I>&gt;<i> E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal Release'
</I>&gt;<i> does not have a Release file.
</I>&gt;<i> N: Updating from such a repository can't be done securely, and is
</I>&gt;<i> therefore disabled by default.
</I>&gt;<i> N: See apt-secure(8) manpage for repository creation and user
</I>&gt;<i> configuration details.
</I>&gt;<i> E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates
</I>&gt;<i> Release' does not have a Release file.
</I>&gt;<i> N: Updating from such a repository can't be done securely, and is
</I>&gt;<i> therefore disabled by default.
</I>&gt;<i> N: See apt-secure(8) manpage for repository creation and user
</I>&gt;<i> configuration details.
</I>&gt;<i> E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports
</I>&gt;<i> Release' does not have a Release file.
</I>&gt;<i> N: Updating from such a repository can't be done securely, and is
</I>&gt;<i> therefore disabled by default.
</I>&gt;<i> N: See apt-secure(8) manpage for repository creation and user
</I>&gt;<i> configuration details.
</I>&gt;<i> E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security
</I>&gt;<i> Release' does not have a Release file.
</I>&gt;<i> N: Updating from such a repository can't be done securely, and is
</I>&gt;<i> therefore disabled by default.
</I>&gt;<i> N: See apt-secure(8) manpage for repository creation and user
</I>&gt;<i> configuration details.
</I>&gt;<i>
</I>
While running, the line

&gt;<i> 0% [Connecting to HTTP proxy (
</I>&gt;<i> <A HREF="http://vpn-proxy-d68aca8a8f7f81d6.elb.ap-southeast-2.amazonaws.com:3128">http://vpn-proxy-d68aca8a8f7f81d6.elb.ap-southeast-2.amazonaws.com:3128</A>)]
</I>&gt;<i>
</I>appears often and hang for a while.

I've tried upping the squid logging and allowing all, but they didn't offer
any additional information about the issue.

Any advice would be greatly appreciated.

Regards,

David Mills

Senior DevOps Engineer

 E: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">david.mills at acusensus.com</A>

 M: +61 411 513 404

 W: acusensus.com

-- 
DISCLAIMER: Acusensus puts the privacy and security of its clients, its 
data and information at the core of everything we do. The information 
contained in this email (including attachments) is intended only for the 
use of the person(s) to whom it is addressed to, as it may be confidential 
and contain legally privileged information. If you have received this email 
in error, please delete all copies and notify the sender immediately. Any 
views or opinions presented are
solely those of the author and do not 
necessarily represent the views of Acusensus
Pty Ltd. Please consider the 
environment
before printing this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210707/a0516069/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210707/a0516069/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023857.html">[squid-users] How to use request headers in external_acl_type
</A></li>
	<LI>Next message (by thread): <A HREF="023862.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23861">[ date ]</a>
              <a href="thread.html#23861">[ thread ]</a>
              <a href="subject.html#23861">[ subject ]</a>
              <a href="author.html#23861">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
