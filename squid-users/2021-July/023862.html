<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%2020.04%20%22apt%20update%22%20issues%20behind%20a%20VPN%20and%0A%20Squid%20proxy&In-Reply-To=%3C%21%26%21AAAAAAAAAAAYAAAAAAAAAG15AYh8TcJOh7jZfP/beGvCgAAAEAAAAKGjfS9pLRpMrWAgDPs7Rm4BAAAAAA%3D%3D%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023861.html">
   <LINK REL="Next"  HREF="023866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy</H1>
    <B>Eliezer Croitoru</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Ubuntu%2020.04%20%22apt%20update%22%20issues%20behind%20a%20VPN%20and%0A%20Squid%20proxy&In-Reply-To=%3C%21%26%21AAAAAAAAAAAYAAAAAAAAAG15AYh8TcJOh7jZfP/beGvCgAAAEAAAAKGjfS9pLRpMrWAgDPs7Rm4BAAAAAA%3D%3D%40gmail.com%3E"
       TITLE="[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy">ngtech1ltd at gmail.com
       </A><BR>
    <I>Wed Jul  7 10:53:37 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023861.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
        <LI>Next message (by thread): <A HREF="023866.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23862">[ date ]</a>
              <a href="thread.html#23862">[ thread ]</a>
              <a href="subject.html#23862">[ subject ]</a>
              <a href="author.html#23862">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey David,

Just wondering if you have seen the apt related docs at:
<A HREF="https://help.ubuntu.com/community/AptGet/Howto/#Setting_up_apt-get_to_use_a_http-proxy">https://help.ubuntu.com/community/AptGet/Howto/#Setting_up_apt-get_to_use_a_http-proxy</A>

Eliezer

From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of David Mills
Sent: Wednesday, July 7, 2021 2:26 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy

Hi,

We've got a collection of Ubuntu 18.04 boxes out in the field. They connect to an AWS OpenVPN VPN and use a Squid 3.5 AWS hosted Proxy. They work fine.

We have tried upgrading one to 20.04. Same setup. From the command line curl or wget can happily download an Ubuntu package from the Ubuntu Mirror site we use. But &quot;apt update&quot; gets lots of &quot;IGN:&quot; timeouts and errors.

The package we test curl with is <A HREF="https://mirror.aarnet.edu.au/ubuntu/pool/main/c/curl/curl_7.68.0-1ubuntu2.5_amd64.deb">https://mirror.aarnet.edu.au/ubuntu/pool/main/c/curl/curl_7.68.0-1ubuntu2.5_amd64.deb</A>

The Squid log shows a line the doesn't occur for the successful 18.04 &quot;apt updates&quot;:
1625190959.233     81 10.0.11.191 TAG_NONE/200 0 CONNECT <A HREF="http://mirror.aarnet.edu.au:443">http://mirror.aarnet.edu.au:443</A> - HIER_DIRECT/2001:388:30bc:cafe::beef -

The full output of an attempt to update is:
Ign:1 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal InRelease                                              
Ign:2 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates InRelease                                      
Ign:3 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports InRelease                                    
Ign:4 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security InRelease                                     
Err:5 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal Release                                                
  Could not wait for server fd - select (11: Resource temporarily unavailable) [IP: 10.0.11.82 3128]
Err:6 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates Release                                        
  Could not wait for server fd - select (11: Resource temporarily unavailable) [IP: 10.0.11.82 3128]
Err:7 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports Release                                      
  Could not wait for server fd - select (11: Resource temporarily unavailable) [IP: 10.0.11.82 3128]
Err:8 <A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security Release                                       
  Could not wait for server fd - select (11: Resource temporarily unavailable) [IP: 10.0.1.26 3128]
Reading package lists... Done                                                                          
N: Ignoring file 'microsoft-prod.list-keep' in directory '/etc/apt/sources.list.d/' as it has an invalid filename extension
E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal Release' does not have a Release file.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-updates Release' does not have a Release file.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-backports Release' does not have a Release file.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository '<A HREF="https://mirror.aarnet.edu.au/ubuntu">https://mirror.aarnet.edu.au/ubuntu</A> focal-security Release' does not have a Release file.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.

While running, the line
0% [Connecting to HTTP proxy (<A HREF="http://vpn-proxy-d68aca8a8f7f81d6.elb.ap-southeast-2.amazonaws.com:3128">http://vpn-proxy-d68aca8a8f7f81d6.elb.ap-southeast-2.amazonaws.com:3128</A>)]
appears often and hang for a while.

I've tried upping the squid logging and allowing all, but they didn't offer any additional information about the issue.

Any advice would be greatly appreciated.

Regards,


David Mills
Senior DevOps Engineer

 E: mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">david.mills at acusensus.com</A>
 M: +61 411 513 404
 W:<A HREF="http://acusensus.com/">http://acusensus.com/</A>



DISCLAIMER: Acusensus puts the privacy and security of its clients, its data and information at the core of everything we do. The information contained in this email (including attachments) is intended only for the use of the person(s) to whom it is addressed to, as it may be confidential and contain legally privileged information. If you have received this email in error, please delete all copies and notify the sender immediately. Any views or opinions presented are solely those of the author and do not necessarily represent the views of Acusensus Pty Ltd. Please consider the environment before printing this email.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023861.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
	<LI>Next message (by thread): <A HREF="023866.html">[squid-users] Ubuntu 20.04 &quot;apt update&quot; issues behind a VPN and Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23862">[ date ]</a>
              <a href="thread.html#23862">[ thread ]</a>
              <a href="subject.html#23862">[ subject ]</a>
              <a href="author.html#23862">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
