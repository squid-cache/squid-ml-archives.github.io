<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid modification to only read client SNI without bumping.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20modification%20to%20only%20read%20client%20SNI%20without%0A%20bumping.&In-Reply-To=%3CCAK7W0xennW%2BuGE11s7sMN5wZo13J9CcW4hXy%2BEdd1%3DXeHwMxXw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023736.html">
   <LINK REL="Next"  HREF="023739.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid modification to only read client SNI without bumping.</H1>
    <B>His Shadow</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20modification%20to%20only%20read%20client%20SNI%20without%0A%20bumping.&In-Reply-To=%3CCAK7W0xennW%2BuGE11s7sMN5wZo13J9CcW4hXy%2BEdd1%3DXeHwMxXw%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid modification to only read client SNI without bumping.">shadowpilot34 at gmail.com
       </A><BR>
    <I>Tue Jun  8 10:51:20 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023736.html">[squid-users] about Kerberos Auth and LDAP Auth
</A></li>
        <LI>Next message (by thread): <A HREF="023739.html">[squid-users] Squid modification to only read client SNI without bumping.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23737">[ date ]</a>
              <a href="thread.html#23737">[ thread ]</a>
              <a href="subject.html#23737">[ subject ]</a>
              <a href="author.html#23737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings. I've been trying to make a patch for squid, so that it
could read client hello on connect requests and set the SNI without
using ssl_bump, as that requires generating certificates and is too
complicated for my needs. Here's the patch I've come up with. It seems
to be working, but I'm getting a bunch of connections in CLOSE_WAIT
state after using it under load. I can't seem to reproduce it locally,
but I bet I don't know something, or did something wrong. Can anyone
code check this patch, please? Also, not sure if it's the correct
place to post this. The patch is applicable to the latest release in
4.x series - 4.15.

-- 
HisShadow
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sni.patch
Type: text/x-patch
Size: 14123 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210608/7fb3851d/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210608/7fb3851d/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023736.html">[squid-users] about Kerberos Auth and LDAP Auth
</A></li>
	<LI>Next message (by thread): <A HREF="023739.html">[squid-users] Squid modification to only read client SNI without bumping.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23737">[ date ]</a>
              <a href="thread.html#23737">[ thread ]</a>
              <a href="subject.html#23737">[ subject ]</a>
              <a href="author.html#23737">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
