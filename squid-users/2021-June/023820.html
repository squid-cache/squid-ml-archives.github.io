<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] certificate issuer not known
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20certificate%20issuer%20not%20known&In-Reply-To=%3C2697f8b6-30dd-4261-e4ef-1c6e68181e5e%40ckta.by%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023818.html">
   <LINK REL="Next"  HREF="023822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] certificate issuer not known</H1>
    <B>Majed Zouhairy</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20certificate%20issuer%20not%20known&In-Reply-To=%3C2697f8b6-30dd-4261-e4ef-1c6e68181e5e%40ckta.by%3E"
       TITLE="[squid-users] certificate issuer not known">m_zouhairy at ckta.by
       </A><BR>
    <I>Wed Jun 23 11:56:40 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023818.html">[squid-users] UDP support for squid
</A></li>
        <LI>Next message (by thread): <A HREF="023822.html">[squid-users] certificate issuer not known
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23820">[ date ]</a>
              <a href="thread.html#23820">[ thread ]</a>
              <a href="subject.html#23820">[ subject ]</a>
              <a href="author.html#23820">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Health be upon you,
when visiting
<A HREF="https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit">https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit</A>

on squid 4.15

it displays:


ERROR
The requested URL could not be retrieved

The following error was encountered while trying to retrieve the URL: 
<A HREF="https://wiki.squid-cache.org/*">https://wiki.squid-cache.org/*</A>

     Failed to establish a secure connection to 104.130.201.120

The system returned:

     (71) Protocol error (TLS code: 
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY)

     SSL Certficate error: certificate issuer (CA) not known: 
/C=US/O=Let's Encrypt/CN=R3

This proxy and the remote host failed to negotiate a mutually acceptable 
security settings for handling your request. It is possible that the 
remote host does not support secure connections, or the proxy is not 
satisfied with the host security credentials.

Your cache administrator is webmaster.

configuration:

http_port 3128 ssl-bump  cert=/etc/squid/certs/myCA.pem 
generate-host-certificates=on dynamic_cert_mem_cache_size=8MB



acl 	tls_s1_connect		at_step SslBump1
acl 	tls_s2_client_hello 	at_step SslBump2
acl 	tls_s3_server_hello 	at_step SslBump3

# define acls for sites that must not be actively bumped

acl 	tls_allowed_hsts	ssl::server_name 			.akamaihd.net
acl 	tls_allowed_hsts	ssl::server_name 			.proxy.skko.by
#acl 	tls_server_is_bank 	ssl::server_name 	.abnamro.nl
#acl 	tls_server_is_bank 	ssl::server_name 	.abnamro.comacl
tls_server_is_bank 		ssl::server_name 
&quot;/usr/local/ufdbguard/blacklists/finance/domains.squidsplice&quot;
acl 	tls_to_splice 	any-of 	tls_allowed_hsts tls_server_is_bank

# TLS/SSL bumping steps

ssl_bump 	peek	tls_s1_connect 	# peek at TLS/SSL connect data
ssl_bump 	splice 	tls_to_splice	# splice some: no active bump
ssl_bump 	stare 	all		# stare(peek) at server
														# properties of the webserver
ssl_bump	 bump	# bump if we can (if the stare succeeded)



#ssl_bump peek all
#ssl_bump splice all

##ssl_bump server-first all

#sslproxy_cert_error allow all



cache_dir ufs /var/cache/squid 8000 16 256

# Leave coredumps in the first cache dir
coredump_dir /var/cache/squid

cache_mem 960 MB

netdb_filename none

#
# Add any of your own refresh_pattern entries above these.
#
refresh_pattern ^ftp:			1440	20%	10080
refresh_pattern ^gopher:		1440	0%	1440
refresh_pattern -i (/cgi-bin/|\?) 	0	0%	0
refresh_pattern .			0	20%	4320

url_rewrite_extras &quot;%&gt;a/%&gt;A %un %&gt;rm bump_mode=%ssl::bump_mode 
sni=\&quot;%ssl::&gt;sni\&quot; referer=\&quot;%{Referer}&gt;h\&quot;&quot;
url_rewrite_program /usr/local/ufdbguard/bin/ufdbgclient -m 4 -l 
/var/log/squid/
url_rewrite_children 16 startup=8 idle=2 concurrency=4 queue-size=64
#debug_options ALL,1 33,2 28,9

what needs to be done to fix?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023818.html">[squid-users] UDP support for squid
</A></li>
	<LI>Next message (by thread): <A HREF="023822.html">[squid-users] certificate issuer not known
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23820">[ date ]</a>
              <a href="thread.html#23820">[ thread ]</a>
              <a href="subject.html#23820">[ subject ]</a>
              <a href="author.html#23820">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
