<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to use request headers in external_acl_type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20use%20request%20headers%20in%20external_acl_type&In-Reply-To=%3CF8D8224A429A46F1BD90923F85A56C66%40OhrSomayach%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023826.html">
   <LINK REL="Next"  HREF="023829.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to use request headers in external_acl_type</H1>
    <B>Yosi Greenfield</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20use%20request%20headers%20in%20external_acl_type&In-Reply-To=%3CF8D8224A429A46F1BD90923F85A56C66%40OhrSomayach%3E"
       TITLE="[squid-users] How to use request headers in external_acl_type">ygreenfield at kewsystems.com
       </A><BR>
    <I>Fri Jun 25 19:18:40 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023826.html">[squid-users] maxconn acl equivalents
</A></li>
        <LI>Next message (by thread): <A HREF="023829.html">[squid-users] How to use request headers in external_acl_type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23828">[ date ]</a>
              <a href="thread.html#23828">[ thread ]</a>
              <a href="subject.html#23828">[ subject ]</a>
              <a href="author.html#23828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,
 
I'm trying to use request headers in an external acl, and I'm probably doing
it incorrectly, and it's not working.
 
Here's my acl definiton:
 
external_acl_type ext_acl_program  %SRC %&gt;{Connection} %&gt;{Accept}
%&gt;{Custom_header} %&gt;{Host} /etc/squid/ext_acl_program.pl
 
 
The program ext_acl_program.pl simply prints out the input
 
   chomp ($line);
   @fields          = split(' ', $line);
   my $ip           = $fields[0];
   my $connection   = $fields[1];
   my $accept       = $fields[2];
   my $custom       = $fields[3];
   my $host         = $fields[4];
 
   print LOGFILE  &quot;IP: $ip\n Conn: $connection\n Accept: $accept\n Custom:
$custom\n Host: $host&quot;;
 
     
The output looks like this:
 
IP: 10.200.10.2
Conn: keep-alive
Accept: -
Custom: -
Host:  &lt;<A HREF="http://www.wsws.com:443">http://www.wsws.com:443</A>&gt; www.wsws.com:443

 
As you see, it has values for %SRC, %&gt;{Connection} and %&gt;{Host}.  It does
not have values for %&gt;{Accept} and %&gt;{Custom_header}
 
 
So the question is, are these %&gt;{} substitutions coming from request_headers
(as I thought)?
 
If yes, why does it only have Connection and Host, and not Accept or my
custom header?
 
If they are not coming from request headers, where are they coming from?
 
And mostly, how can I pass my custom header into the program?
 
Thanks so much for your responses,
Yosi
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210625/af5e0b21/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210625/af5e0b21/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023826.html">[squid-users] maxconn acl equivalents
</A></li>
	<LI>Next message (by thread): <A HREF="023829.html">[squid-users] How to use request headers in external_acl_type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23828">[ date ]</a>
              <a href="thread.html#23828">[ thread ]</a>
              <a href="subject.html#23828">[ subject ]</a>
              <a href="author.html#23828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
