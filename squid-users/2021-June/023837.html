<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TPROXY Error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TPROXY%20Error&In-Reply-To=%3CCADAqQfwR4w-cFidq%2B8ea7zns%3DOUwyan6W1wXuLcrge4jSE4B9Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023845.html">
   <LINK REL="Next"  HREF="023838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TPROXY Error</H1>
    <B>Ben Goz</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TPROXY%20Error&In-Reply-To=%3CCADAqQfwR4w-cFidq%2B8ea7zns%3DOUwyan6W1wXuLcrge4jSE4B9Q%40mail.gmail.com%3E"
       TITLE="[squid-users] TPROXY Error">ben.goz87 at gmail.com
       </A><BR>
    <I>Wed Jun 30 12:16:09 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023845.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
        <LI>Next message (by thread): <A HREF="023838.html">[squid-users] TPROXY Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23837">[ date ]</a>
              <a href="thread.html#23837">[ thread ]</a>
              <a href="subject.html#23837">[ subject ]</a>
              <a href="author.html#23837">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> By the help of God.

Hi All,
I'm trying to configure squid as a transparent proxy using TPROXY.
The machine I'm using has 2 NICs, one for input and the other one for
output traffic.
The TPROXY iptables rules are configured on the input NIC.
It looks like iptables TPROXY redirect works but squid prints out the
following error:

ERROR: NAT/TPROXY lookup failed to locate original IPs on
local=xxx:443 remote=xxx:49471 FD 14 flags=17

I think I loaded all TPROXY required kernel modules.

The ip forwarding works fine without the iptables rules. and I don't
see any squid ERROR on getsockopt

Please let me know what I'm missing?

Thanks,
Ben

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023845.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
	<LI>Next message (by thread): <A HREF="023838.html">[squid-users] TPROXY Error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23837">[ date ]</a>
              <a href="thread.html#23837">[ thread ]</a>
              <a href="subject.html#23837">[ subject ]</a>
              <a href="author.html#23837">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
