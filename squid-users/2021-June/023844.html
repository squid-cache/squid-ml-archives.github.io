<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Error negotiating SSL connection on FD 366 - cache.log
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20negotiating%20SSL%20connection%20on%20FD%20366%20-%0A%20cache.log&In-Reply-To=%3Ce500e061-6477-8c4a-7891-e1245897c803%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023843.html">
   <LINK REL="Next"  HREF="023845.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Error negotiating SSL connection on FD 366 - cache.log</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20negotiating%20SSL%20connection%20on%20FD%20366%20-%0A%20cache.log&In-Reply-To=%3Ce500e061-6477-8c4a-7891-e1245897c803%40measurement-factory.com%3E"
       TITLE="[squid-users] Error negotiating SSL connection on FD 366 - cache.log">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Jun 30 16:09:10 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023843.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
        <LI>Next message (by thread): <A HREF="023845.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23844">[ date ]</a>
              <a href="thread.html#23844">[ thread ]</a>
              <a href="subject.html#23844">[ subject ]</a>
              <a href="author.html#23844">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/30/21 11:48 AM, robert k Wild wrote:

&gt;<i> How do I enable all 9 debugging to find out what client ip it is thats
</I>&gt;<i> sending all these tls errors.
</I>
0. Start Squid if necessary.

1. Locate your Squid log file or equivalent. In this example, we will
call it cache.log.

2. Run &quot;tail -f cache.log &gt; partial-cache.log&quot; in background or another
terminal. This will start appending new debugging to the
partial-cache.log file.

3. Run &quot;squid -k debug&quot; to enable ALL,9 debugging.

4. Wait a few seconds.

5. Run &quot;squid -k debug&quot; to disable ALL,9 debugging.

6. Kill the &quot;tail&quot; command in step 2.

7. Check that partial-cache.log contains at least one &quot;Error negotiating
SSL connection&quot; entry. If not, go to step 2 and repeat. Perhaps give
Squid a few extra seconds this time.

8. Analyze the resulting partial-cache.log (or share it with those who
are willing to analyze it for you, compressing it if needed). Please
note that this debugging log may contain sensitive information such as
user names and passwords.


HTH,

Alex.


&gt;<i> On Wed, 30 Jun 2021, 16:16 Alex Rousskov wrote:
</I>&gt;<i> 
</I>&gt;<i>     On 6/30/21 6:41 AM, robert k Wild wrote:
</I>&gt;<i> 
</I>&gt;<i>     &gt; never really noticed this as i rarely &quot;tail -f&quot; the cache log but im
</I>&gt;<i>     &gt; noticing these lines like every second
</I>&gt;<i> 
</I>&gt;<i>     &gt; 2021/06/30 11:39:13 kid1| Error negotiating SSL connection on FD 266:
</I>&gt;<i>     &gt; error:00000001:lib(0):func(0):reason(1) (1/-1)
</I>&gt;<i>     &gt; 2021/06/30 11:39:13 kid1| Error negotiating SSL connection on FD 270:
</I>&gt;<i>     &gt; error:00000001:lib(0):func(0):reason(1) (1/-1)
</I>&gt;<i>     &gt; 2021/06/30 11:39:13 kid1| Error negotiating SSL connection on FD 285:
</I>&gt;<i>     &gt; error:00000001:lib(0):func(0):reason(1) (1/0)
</I>&gt;<i> 
</I>&gt;<i>     &gt; is this something to be worried about
</I>&gt;<i> 
</I>&gt;<i>     IMHO, you should worry about two things, at least:
</I>&gt;<i> 
</I>&gt;<i>     1) The fact that you did not know about Squid complaints, especially
</I>&gt;<i>     frequent ones. I do not think that constantly watching &quot;tail -f&quot; is the
</I>&gt;<i>     answer here, but something in your Squid administration approach should
</I>&gt;<i>     change to prevent similar lack of problem awareness in the future.
</I>&gt;<i> 
</I>&gt;<i>     2) The fact that your Squid is complaining about something every second.
</I>&gt;<i>     If the actual problem behind these errors does not deserve your
</I>&gt;<i>     attention, then Squid should not be logging it at level 1 (and you
</I>&gt;<i>     should complain that it does). Otherwise, the problem itself should be
</I>&gt;<i>     addressed.
</I>&gt;<i> 
</I>&gt;<i>     As for the error itself, it looks like your Squid cannot negotiate TLS
</I>&gt;<i>     with some client(s). I do not know whether it is Squid's fault or the
</I>&gt;<i>     client's. Enabling &quot;ALL,9&quot; debugging for a few seconds should be
</I>&gt;<i>     sufficient to identify the client (at least by its IP address), which
</I>&gt;<i>     may be enough to understand why the negotiation fails (or to give you
</I>&gt;<i>     enough information to collect more details for triage).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     HTH,
</I>&gt;<i> 
</I>&gt;<i>     Alex.
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     squid-users mailing list
</I>&gt;<i>     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>     <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>     &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023843.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
	<LI>Next message (by thread): <A HREF="023845.html">[squid-users] Error negotiating SSL connection on FD 366 - cache.log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23844">[ date ]</a>
              <a href="thread.html#23844">[ thread ]</a>
              <a href="subject.html#23844">[ subject ]</a>
              <a href="author.html#23844">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
