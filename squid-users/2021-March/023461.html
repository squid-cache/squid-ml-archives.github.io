<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Protecting squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Protecting%20squid&In-Reply-To=%3C4dedac61-60ff-d2cf-3d12-cc7de62b8590%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023460.html">
   <LINK REL="Next"  HREF="023466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Protecting squid</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Protecting%20squid&In-Reply-To=%3C4dedac61-60ff-d2cf-3d12-cc7de62b8590%40treenet.co.nz%3E"
       TITLE="[squid-users] Protecting squid">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Mar 15 13:27:46 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023460.html">[squid-users] Protecting squid
</A></li>
        <LI>Next message (by thread): <A HREF="023466.html">[squid-users] Protecting squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23461">[ date ]</a>
              <a href="thread.html#23461">[ thread ]</a>
              <a href="subject.html#23461">[ subject ]</a>
              <a href="author.html#23461">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/03/21 2:26 am, Ben Goz wrote:
&gt;<i> 
</I>&gt;<i> Can I configure squid authentication TTL per only source IP and ignores 
</I>&gt;<i> other parameters so authentication will be requested only once in TTL 
</I>&gt;<i> for all the sessions?
</I>&gt;<i> 
</I>
Not with just authentication. You will need to use a slightly more 
complicated system involving an external_acl_type helper as well and 
switch to an SQL database auth system.


The idea for that is that you have a database of authenticated users 
with their last-known IP address.

  Your auth_param helper is changed to one which takes client IP address 
in the auth_param key_extras setting, and adds records to the SQL 
database before telling Squid the login is OK.

  Use an ext_sql_session_acl helper which takes IP address and checks 
the database to find the username who last authenticated from there. 
This needs to be checked and permit existing sessions before the auth 
helper.

The config looks something like this:


   external_acl_type ipuser negative_ttl=0 ttl=7200 %&lt;a \
     /usr/bin/squid/ext_sql_session_acl \
     --dsn &quot;...&quot; --user dbUsername --password dbPassword --persist \
     --usercol username --uidcol ipaddress

   acl user_known external ipuser
   http_access allow user_known


   auth_param basic program /path/to/helper
   auth_param basic key_extras %&lt;a
   auth_param basic credentialsttl 2 hours

   acl authenticated proxy_auth REQUIRED

   http_access allow authenticated



Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023460.html">[squid-users] Protecting squid
</A></li>
	<LI>Next message (by thread): <A HREF="023466.html">[squid-users] Protecting squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23461">[ date ]</a>
              <a href="thread.html#23461">[ thread ]</a>
              <a href="subject.html#23461">[ subject ]</a>
              <a href="author.html#23461">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
