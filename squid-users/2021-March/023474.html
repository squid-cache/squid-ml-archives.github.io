<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] HTTPS caching is not working in squid with ssl-bump enabled
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20caching%20is%20not%20working%20in%20squid%20with%0A%20ssl-bump%20enabled&In-Reply-To=%3C84d0cdd9-1871-898e-a32f-e65637beaa13%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023473.html">
   <LINK REL="Next"  HREF="023475.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] HTTPS caching is not working in squid with ssl-bump enabled</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20HTTPS%20caching%20is%20not%20working%20in%20squid%20with%0A%20ssl-bump%20enabled&In-Reply-To=%3C84d0cdd9-1871-898e-a32f-e65637beaa13%40measurement-factory.com%3E"
       TITLE="[squid-users] HTTPS caching is not working in squid with ssl-bump enabled">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue Mar 23 14:14:17 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023473.html">[squid-users] HTTPS caching is not working in squid with ssl-bump enabled
</A></li>
        <LI>Next message (by thread): <A HREF="023475.html">[squid-users] HTTPS caching is not working in squid with ssl-bump enabled
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23474">[ date ]</a>
              <a href="thread.html#23474">[ thread ]</a>
              <a href="subject.html#23474">[ subject ]</a>
              <a href="author.html#23474">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/23/21 2:10 AM, Vignesh Ramessh wrote:

&gt;<i> Currently am running squid version 4.14 on RPi3.
</I>&gt;<i> Trying to cache https responses with cache-control:max-age headers
</I>&gt;<i> available,
</I>&gt;<i> using ssl bump - peek n splice feature with examples available in this
</I>&gt;<i> link :-&#160;<A HREF="https://elatov.github.io/2019/01/using-squid-to-proxy-ssl-sites/">https://elatov.github.io/2019/01/using-squid-to-proxy-ssl-sites/</A>
</I>

   ssl_bump peek step1
   ssl_bump bump all
   ssl_bump splice all

AFAICT, the above &quot;bump all during step2&quot; configuration (the last line
does not do anything and should be removed) should bump all traffic. Is
that your configuration?


&gt;<i> But the https caching doesnt seem to work, https connections are getting
</I>&gt;<i> established as TCP_TUNNEL/200 in squid access logs.
</I>
Do you see non-CONNECT HTTP traffic (e.g. GET, POST, etc.) in access
log? If not, then Squid is not bumping traffic OR the client does not
like what Squid is doing. Please post your http*_port and ssl_bump
configuration with access.log lines corresponding to a single test
transaction that you think should be bumped.

Also, does the client (e.g. curl, wget, or browser) get an error from
Squid? Does the client display any kind of warning or error at all? What
certificate does the client show for the test connection?


&gt;<i> I wasnt able to find any proper documentation on https caching using squid.
</I>
What you call &quot;HTTPS caching&quot; consists of two virtually independent
actions: Bumping HTTPS connections and caching. Documentation exists for
each action. Currently, it sounds like the first action (bumping) is not
working in your setup. Until that is addressed, you can ignore the
caching part.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023473.html">[squid-users] HTTPS caching is not working in squid with ssl-bump enabled
</A></li>
	<LI>Next message (by thread): <A HREF="023475.html">[squid-users] HTTPS caching is not working in squid with ssl-bump enabled
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23474">[ date ]</a>
              <a href="thread.html#23474">[ thread ]</a>
              <a href="subject.html#23474">[ subject ]</a>
              <a href="author.html#23474">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
