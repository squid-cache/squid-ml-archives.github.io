<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Can I configure squid5 with Boring SSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Can%20I%20configure%20squid5%20with%20Boring%20SSL&In-Reply-To=%3Cdccdf35b-acb1-6da3-6f71-18fbc61899d8%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023589.html">
   <LINK REL="Next"  HREF="023586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Can I configure squid5 with Boring SSL</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Can%20I%20configure%20squid5%20with%20Boring%20SSL&In-Reply-To=%3Cdccdf35b-acb1-6da3-6f71-18fbc61899d8%40measurement-factory.com%3E"
       TITLE="[squid-users] Can I configure squid5 with Boring SSL">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue May  4 13:45:15 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023589.html">[squid-users] Can I configure squid5 with Boring SSL
</A></li>
        <LI>Next message (by thread): <A HREF="023586.html">[squid-users] HTTPS request times out going through Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23590">[ date ]</a>
              <a href="thread.html#23590">[ thread ]</a>
              <a href="subject.html#23590">[ subject ]</a>
              <a href="author.html#23590">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/4/21 5:33 AM, vinod mg wrote:

&gt;<i> 1) Current squid build with OpenSSL is not showing transactional ciphers
</I>&gt;<i> while browsing via chrome eg: (TLS_GREASE_DA),
</I>&gt;<i> (TLS_GREASE_IS_THE_WORD_BA)&#160; --&gt; is there any way to add these?
</I>
&gt;<i> 2) I am unable to supress&#160;Named group 'secp521r1' while going via this
</I>&gt;<i> squid build on chrome browser. --&gt; Is there any way to supress&#160;this?
</I>
I do not know the answers to your questions, but they sound like OpenSSL
questions (rather than Squid questions) to me. AFAIK, Squid code is
unaware of the concepts you are talking about -- it just passes your
configuration to OpenSSL. If OpenSSL can be configured to do what you
want, then, in most cases, you can configure Squid+OpenSSL to do that.

Alex.


&gt;<i> I am using -&#160;<A HREF="https://browserleaks.com/ssl">https://browserleaks.com/ssl</A> &lt;<A HREF="https://browserleaks.com/ssl">https://browserleaks.com/ssl</A>&gt;
</I>&gt;<i> and&#160;<A HREF="https://www.howsmyssl.com">https://www.howsmyssl.com</A> &lt;<A HREF="https://www.howsmyssl.com">https://www.howsmyssl.com</A>&gt; to check above
</I>&gt;<i> parameters.
</I>&gt;<i> 
</I>&gt;<i> I am using below configs with OpenSSL and it works fine except for above
</I>&gt;<i> mentioned issues.
</I>&gt;<i> 
</I>&gt;<i> acl manager proto cache_object
</I>&gt;<i> acl localnet src 10.0.0.0/8 &lt;<A HREF="http://10.0.0.0/8">http://10.0.0.0/8</A>&gt;	# RFC1918 possible
</I>&gt;<i> internal network
</I>&gt;<i> acl localnet src 172.16.0.0/12 &lt;<A HREF="http://172.16.0.0/12">http://172.16.0.0/12</A>&gt;	# RFC1918 possible
</I>&gt;<i> internal network
</I>&gt;<i> acl localnet src 192.168.0.0/16 &lt;<A HREF="http://192.168.0.0/16">http://192.168.0.0/16</A>&gt;	# RFC1918
</I>&gt;<i> possible internal network
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i> acl SSL_ports port 8443
</I>&gt;<i> acl Safe_ports port 80 # http
</I>&gt;<i> acl Safe_ports port 21 # ftp
</I>&gt;<i> acl Safe_ports port 443 # https
</I>&gt;<i> acl Safe_ports port 70 # gopher
</I>&gt;<i> acl Safe_ports port 210 # wais
</I>&gt;<i> acl Safe_ports port 1025-65535 # unregistered ports
</I>&gt;<i> acl Safe_ports port 280 # http-mgmt
</I>&gt;<i> acl Safe_ports port 488 # gss-http
</I>&gt;<i> acl Safe_ports port 591 # filemaker
</I>&gt;<i> acl Safe_ports port 777 # multiling http
</I>&gt;<i> acl Safe_ports port 8443 # multiling http
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i> acl intermediate_fetching transaction_initiator certificate-fetching
</I>&gt;<i> http_access allow intermediate_fetching
</I>&gt;<i> http_access allow manager localhost
</I>&gt;<i> http_access deny manager
</I>&gt;<i> http_access deny !Safe_ports
</I>&gt;<i> http_access deny CONNECT !SSL_ports
</I>&gt;<i> acl blocked_sites ssl::server_name .apple.com &lt;<A HREF="http://apple.com">http://apple.com</A>&gt;
</I>&gt;<i> acl amazon_deny dstdomain &quot;/opt/squid/squid5/etc/blockdomains&quot;
</I>&gt;<i> http_access allow localnet
</I>&gt;<i> http_access allow localhost
</I>&gt;<i> http_access deny blocked_sites
</I>&gt;<i> http_access deny amazon_deny
</I>&gt;<i> http_access allow all
</I>&gt;<i> http_port 443 ssl-bump generate-host-certificates=on
</I>&gt;<i> dynamic_cert_mem_cache_size=512MB
</I>&gt;<i> tls-cert=/opt/squid/squid5/etc/certs/ProxyBump.crt
</I>&gt;<i> tls-key=/opt/squid/squid5/etc/certs/ProxyBump.key
</I>&gt;<i> tls-dh=prime256v1:/opt/squid/squid5/etc/certs/ProxyBump.pem
</I>&gt;<i> sslcrtd_program /opt/squid/squid5/libexec/security_file_certgen -s
</I>&gt;<i> /var/lib/squid/ssl_db -M 512MB
</I>&gt;<i> sslproxy_cert_error allow all
</I>&gt;<i> acl step1 at_step SslBump1
</I>&gt;<i> ssl_bump peek step1
</I>&gt;<i> ssl_bump bump all
</I>&gt;<i> ssl_bump splice all
</I>&gt;<i> tls_outgoing_options
</I>&gt;<i> cipher=HIGH:!MEDIUM:!RC4:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS
</I>&gt;<i> options=NO_SSLv3,SINGLE_DH_USE,SINGLE_ECDH_USE
</I>&gt;<i> cache_mem 1024 MB
</I>&gt;<i> cache deny all
</I>&gt;<i> cache_dir aufs /opt/squid/squid5/var/cache/squid 1024 16 256
</I>&gt;<i> shutdown_lifetime 2 seconds
</I>&gt;<i> coredump_dir /opt/squid/squid5/var/cache/squid
</I>&gt;<i> refresh_pattern ^ftp: 1440 20% 10080
</I>&gt;<i> refresh_pattern ^gopher: 1440 0% 1440
</I>&gt;<i> refresh_pattern -i (/cgi-bin/|\?) 0 0% 0
</I>&gt;<i> refresh_pattern . 0 20% 4320
</I>&gt;<i> cache_peer 10.12.11.2 parent 8080 0 no-query default login=abc:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">abc at 123</A>
</I>&gt;<i> never_direct allow all
</I>&gt;<i> server_persistent_connections off
</I>&gt;<i> logfile_rotate 30
</I>&gt;<i> via off
</I>&gt;<i> forwarded_for delete
</I>&gt;<i> visible_hostname localhost
</I>&gt;<i> logformat squid &#160;%ts.%03tu %6tr %&gt;a %Ss/%03&gt;Hs %&lt;st %rm %ru %[un %Sh/%&lt;A
</I>&gt;<i> %mt %&gt;h %Se %&gt;sh
</I>&gt;<i> logformat extended &#160;%tl %6tr %&gt;a %Ss/%03Hs %&lt;st %rm %ru %un %Sh/%&lt;A %mt
</I>&gt;<i> %Hs %&lt;st &quot;%{Referer}&gt;h&quot; &quot;%{User-agent}&gt;h&quot;
</I>&gt;<i> cache_log /opt/squid/squid5/var/logs/cache.log
</I>&gt;<i> acl hasRequest has request
</I>&gt;<i> access_log none !hasRequest
</I>&gt;<i> access_log stdio:/opt/squid/squid5/var/logs/access.log
</I>&gt;<i> access_log stdio:/opt/squid/squid5/var/logs/access.log.mitm extended
</I>&gt;<i> pid_filename /opt/squid/squid5/var/run/squid.pid
</I>&gt;<i> max_filedescriptors 5000
</I>&gt;<i> 
</I>&gt;<i> Any help is appreciated. Thanks in advance!
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Vinod
</I>&gt;<i> 
</I>&gt;<i> On Tue, May 4, 2021 at 2:12 AM Alex Rousskov
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Hello Vinod,
</I>&gt;<i> 
</I>&gt;<i>     &#160; &#160; Squid does not support BoringSSL, and we will not add such support
</I>&gt;<i>     in the foreseeable future. We have more than enough troubles with GnuTLS
</I>&gt;<i>     support and not enough resources to support a yet another TLS library,
</I>&gt;<i>     especially the one that is not meant for general use[1]!
</I>&gt;<i> 
</I>&gt;<i>     [1] <A HREF="https://boringssl.googlesource.com/boringssl/">https://boringssl.googlesource.com/boringssl/</A>
</I>&gt;<i>     &lt;<A HREF="https://boringssl.googlesource.com/boringssl/">https://boringssl.googlesource.com/boringssl/</A>&gt;
</I>&gt;<i>     Although BoringSSL is an open source project, it is not intended for
</I>&gt;<i>     general use, as OpenSSL is. We don't recommend that third parties depend
</I>&gt;<i>     upon it. Doing so is likely to be frustrating because there are no
</I>&gt;<i>     guarantees of API or ABI stability.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     HTH,
</I>&gt;<i> 
</I>&gt;<i>     Alex.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     On 5/3/21 4:10 PM, vinod mg wrote:
</I>&gt;<i>     &gt; Hi Team,
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; I have followed
</I>&gt;<i>     &gt;
</I>&gt;<i>     -&#160;<A HREF="https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/">https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/</A>
</I>&gt;<i>     &lt;<A HREF="https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/">https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/</A>&gt;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &lt;<A HREF="https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/">https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/</A>
</I>&gt;<i>     &lt;<A HREF="https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/">https://www.interserver.net/tips/kb/openssl-vs-boringssl-boringssl-install-boringssl/</A>&gt;&gt;
</I>&gt;<i>     &gt; and was able to install in server's /home/src/boringssl
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; while configuring squid I am using below options -&#160;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ./configure '--prefix=/opt/boring/squid5'
</I>&gt;<i>     &gt; '--with-openssl=/home/src/boringssl' '--enable-ssl-crtd'
</I>&gt;<i>     &gt; '--with-filedescriptors=3276800' '--enable-storeio=diskd,aufs,ufs'
</I>&gt;<i>     &gt; '--with-large-files' '--enable-useragent-log'
</I>&gt;<i>     &gt; '--enable-ltdl-convenience' '--with-tls' '--enable-http-violations'
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; while running 'make' I am getting below error, and I am not able
</I>&gt;<i>     to find
</I>&gt;<i>     &gt; solution for this.
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; In file included from ../../src/ssl/support.h:21,
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; from ../../src/SquidConfig.h:29,
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; from old_api.cc:24:
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:25: error: &#8216;TXT_DB&#8217; was not declared in
</I>&gt;<i>     this
</I>&gt;<i>     &gt; scope
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;typedef std::unique_ptr&lt;TXT_DB, HardFun&lt;void, TXT_DB*, &amp;TXT_DB_free&gt;&gt;
</I>&gt;<i>     &gt; TXT_DB_Pointer;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:47: error: &#8216;TXT_DB&#8217; was not declared in
</I>&gt;<i>     this
</I>&gt;<i>     &gt; scope
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;typedef std::unique_ptr&lt;TXT_DB, HardFun&lt;void, TXT_DB*, &amp;TXT_DB_free&gt;&gt;
</I>&gt;<i>     &gt; TXT_DB_Pointer;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:68: error: template argument 2 is invalid
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;typedef std::unique_ptr&lt;TXT_DB, HardFun&lt;void, TXT_DB*, &amp;TXT_DB_free&gt;&gt;
</I>&gt;<i>     &gt; TXT_DB_Pointer;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:68: error: template argument 3 is invalid
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:71: error: template argument 1 is invalid
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;typedef std::unique_ptr&lt;TXT_DB, HardFun&lt;void, TXT_DB*, &amp;TXT_DB_free&gt;&gt;
</I>&gt;<i>     &gt; TXT_DB_Pointer;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:71: error: template argument 2 is invalid
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; ../../src/ssl/gadgets.h:56:1: error: &#8216;typedef&#8217; was ignored in this
</I>&gt;<i>     &gt; declaration [-Werror]
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; &#160;typedef std::unique_ptr&lt;TXT_DB, HardFun&lt;void, TXT_DB*, &amp;TXT_DB_free&gt;&gt;
</I>&gt;<i>     &gt; TXT_DB_Pointer;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; cc1plus: all warnings being treated as errors
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[3]: *** [Makefile:840: old_api.lo] Error 1
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[3]: Leaving directory '/tmp/squid-5.0.5/src/mem'
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[2]: *** [Makefile:6851: all-recursive] Error 1
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[2]: Leaving directory '/tmp/squid-5.0.5/src'
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[1]: *** [Makefile:5840: all] Error 2
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make[1]: Leaving directory '/tmp/squid-5.0.5/src'
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; make: *** [Makefile:593: all-recursive] Error 1
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; My node is running on -&#160;CentOS Linux release 8.3.2011
</I>&gt;<i>     &gt; Squid version -&#160;5.0.4
</I>&gt;<i>     &gt; Installed Openssl version -&#160;OpenSSL 1.1.1g FIPS&#160; 21 Apr 2020
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; Thanks,
</I>&gt;<i>     &gt; Vinod
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; _______________________________________________
</I>&gt;<i>     &gt; squid-users mailing list
</I>&gt;<i>     &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>     &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>     &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i>     &gt;
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023589.html">[squid-users] Can I configure squid5 with Boring SSL
</A></li>
	<LI>Next message (by thread): <A HREF="023586.html">[squid-users] HTTPS request times out going through Squid proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23590">[ date ]</a>
              <a href="thread.html#23590">[ thread ]</a>
              <a href="subject.html#23590">[ subject ]</a>
              <a href="author.html#23590">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
