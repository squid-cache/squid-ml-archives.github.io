<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2021:1 Denial of Service in URN processing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2021%3A1%20Denial%20of%0A%20Service%20in%20URN%20processing&In-Reply-To=%3Cd77e50649a1d49c4cfc716b5abbb61d2%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023615.html">
   <LINK REL="Next"  HREF="023617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2021:1 Denial of Service in URN processing</H1>
    <B>squid3 at treenet.co.nz</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2021%3A1%20Denial%20of%0A%20Service%20in%20URN%20processing&In-Reply-To=%3Cd77e50649a1d49c4cfc716b5abbb61d2%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2021:1 Denial of Service in URN processing">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon May 10 12:39:55 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023615.html">[squid-users] [squid-announce] Squid 5.0.6 beta is available
</A></li>
        <LI>Next message (by thread): <A HREF="023617.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2021:2 Denial of Service in HTTP Response Processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23616">[ date ]</a>
              <a href="thread.html#23616">[ thread ]</a>
              <a href="subject.html#23616">[ subject ]</a>
              <a href="author.html#23616">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

     Squid Proxy Cache Security Update Advisory SQUID-2021:1
__________________________________________________________________

Advisory ID:       | SQUID-2021:1
Date:              | May 10, 2021
Summary:           | Denial of Service in URN processing
Affected versions: | Squid 2.0 -&gt; 4.14
                    | Squid 5.x -&gt; 5.0.5
Fixed in version:  | Squid 4.15 and 5.0.6
__________________________________________________________________

   &lt;<A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28651">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28651</A>&gt;
__________________________________________________________________

Problem Description:

  Due to a buffer management bug Squid is vulnerable to a
  Denial of service attack against the server it is operating on.

  This attack is limited to proxies which attempt to resolve a
  &quot;urn:&quot; resource identifier. Support for this resolving is enabled
  by default in all Squid.

__________________________________________________________________

Severity:

  This problem allows a malicious server in collaboration with a
  trusted client to consume arbitrarily large amounts of memory
  on the server running Squid.

  Lack of available memory resources impacts all services on the
  machine running Squid. Once initiated the DoS situation will
  persist until Squid is shutdown.

CVSS Score of 8.5
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:N/MUI:R/MS:C/MC:X/MI:X/MA:H&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C/CR:X/IR:X/AR:H/MAV:N/MAC:L/MPR:N/MUI:R/MS:C/MC:X/MI:X/MA:H&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid versions 4.15 and 5.0.6.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 4:
  
&lt;<A HREF="http://www.squid-cache.org/Versions/v4/changesets/squid-4-a975fd5aedc866629214aaaccb38376855351899.patch">http://www.squid-cache.org/Versions/v4/changesets/squid-4-a975fd5aedc866629214aaaccb38376855351899.patch</A>&gt;

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 3.5.28 have not been tested and should be
  assumed to be vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.0.5 are vulnerable.

__________________________________________________________________

Workaround:

  Disable URN processing by the proxy. Add these lines to
  squid.conf:

    acl URN proto URN
    http_access deny URN

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is your
  primary support point. For subscription details see
  &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  &lt;<A HREF="http://bugs.squid-cache.org/">http://bugs.squid-cache.org/</A>&gt;.

  For reporting of security sensitive bugs send an email to the
  &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by Amos Jeffries of Treehouse Networks Ltd.

__________________________________________________________________

Revision history:

  2021-02-22 06:55:38 UTC Initial Report
  2021-02-24 00:53:21 UTC Patch Released
  2021-03-17 06:19:09 UTC CVE Assignment
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023615.html">[squid-users] [squid-announce] Squid 5.0.6 beta is available
</A></li>
	<LI>Next message (by thread): <A HREF="023617.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2021:2 Denial of Service in HTTP Response Processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23616">[ date ]</a>
              <a href="thread.html#23616">[ thread ]</a>
              <a href="subject.html#23616">[ subject ]</a>
              <a href="author.html#23616">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
