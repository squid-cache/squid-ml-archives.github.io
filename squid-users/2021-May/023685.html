<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%28possibly%20dynamic%3F%29%20multiple%20port%20forwarding%20in%0A%20the%20same%20internal%20Network%20...&In-Reply-To=%3C202105251456.02376.Antony.Stone%40squid.open.source.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023684.html">
   <LINK REL="Next"  HREF="023686.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...</H1>
    <B>Antony Stone</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%28possibly%20dynamic%3F%29%20multiple%20port%20forwarding%20in%0A%20the%20same%20internal%20Network%20...&In-Reply-To=%3C202105251456.02376.Antony.Stone%40squid.open.source.it%3E"
       TITLE="[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...">Antony.Stone at squid.open.source.it
       </A><BR>
    <I>Tue May 25 12:56:02 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="023684.html">[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...
</A></li>
        <LI>Next message (by thread): <A HREF="023686.html">[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23685">[ date ]</a>
              <a href="thread.html#23685">[ thread ]</a>
              <a href="subject.html#23685">[ subject ]</a>
              <a href="author.html#23685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tuesday 25 May 2021 at 14:36:09, Albretch Mueller wrote:

&gt;<i> On 5/25/21, Antony Stone &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Antony.Stone at squid.open.source.it</A>&gt; wrote:
</I>&gt;<i> &gt; On Tuesday 25 May 2021 at 07:51:21, Albretch Mueller wrote:
</I>&gt;<i> &gt;&gt;  As part of a teaching and learning (TaL)/school software, I need squid:
</I>&gt;<i> &gt;&gt;  
</I>&gt;<i> &gt;&gt;  a) to detect one of the connected computers in an internal network
</I>&gt;<i> &gt;&gt; comprising wirelessly connected and wired computers as the &quot;master&quot;
</I>&gt;<i> &gt;&gt; (operated by the teacher);
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; What information is available to Squid in order to &quot;detect&quot; that this is
</I>&gt;<i> &gt; the &quot;master&quot; machine?
</I>&gt;<i> 
</I>&gt;<i> I think a combination of cookies,
</I>
What system generates / checks the cookies?

What URL are the cookies associated with in the browser?

&gt;<i> its mac address and, when both fail, authentication.
</I>
Ah, some form of authentication, where the master user has to log in to 
something, would certainly be effective.  It was just the way you used the word 
&quot;detect&quot; that made me think this should be some action on the part of Squid 
independently of what the master machine user was doing.

&gt;<i> Wouldn't that be enough?, perhaps with an extra proxy server?
</I>
Perhaps with an extra *web* server (for authentication), yes, but where would 
an extra proxy server point to?

&gt;<i> My main problem is that I don't want for students boxes to be prompted for
</I>&gt;<i> or trying to initiate an authentication and I don't know of a fool proof way
</I>&gt;<i> of achieving that.
</I>
How about the teacher accesses a URL that the students don't know, or at least 
are not supposed to access, and it is that URL which prompts the teacher to 
authenticate?

If the students go to that URL then they will also be prompted to 
authenticate, but in general they will not.

&gt;<i> If possible, all students' business should let go through with squid serving
</I>&gt;<i> as transparent proxy.
</I>
That's just down to your networking configuration.

&gt;<i> Probably squid could cache that request as local files to the extent
</I>&gt;<i> that it can and just redirect the requests of students' clients as
</I>&gt;<i> references to that file using an ICAP server somehow?
</I>
So, the student asks for the Wikipedia article on Amethyst and finds that their 
browser shows them the web page the teacher is looking at instead?

I think there's no way you're going to achieve this sort of thing with the 
current popularity of SSL/TLS.

&gt;<i> &gt;&gt;  b) when that master reach out to an outside URL, the response should
</I>&gt;<i> &gt;&gt; be replicated in that master's and all other internal computers; but
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; What do you mean by &quot;the response should be replicated in ... all other
</I>&gt;<i> &gt; internal computers&quot;?
</I>&gt;<i> 
</I>&gt;<i>  that the initial request by the teacher should be received as
</I>&gt;<i> response by all students
</I>
Response to what?

&gt;<i> &gt; Are you assuming that these computers are already running a browser,
</I>&gt;<i> 
</I>&gt;<i> Well, technically, I think we could assume that, why would that be
</I>&gt;<i> problematic? How bad would if be if they are not running a browser,
</I>&gt;<i> you could interrupt an initiated request, you could even shot down
</I>&gt;<i> your computer in the middle of a download or transaction without a
</I>&gt;<i> problem. Why would that be that difficult? or, was is it exactly I am
</I>&gt;<i> not getting right?
</I>
I'm asking &quot;what application is going to receive this &quot;response&quot; sent by 
Squid, and be expecting it so that it can process it and display it to the 
user?&quot;

You can't just send a chunk of HTML to a computer over the network and expect 
a browser window to suddenly appear and display it.

Aside from anything else, you have to get a TCP session going in the first 
place.

&gt;<i> &gt; that they should suddenly get some (apparently) web server response via
</I>&gt;<i> &gt; Squid and display it, even though they did not make any request?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If so, I would say this is impossible - you can't get a computer to show
</I>&gt;<i> &gt; a response to a request it did not make.
</I>&gt;<i> 
</I>&gt;<i> Yes, this is what I meant, why is that so hard?
</I>
a) the client (user's computer) did not open a TCP session to anything (either 
Squid, or a web server), so it's not going to accept TCP &quot;replies&quot;

b) the client did not send an HTTP request to anything, so it's not going to 
accept some HTML which simply turns up on its network port

&gt;<i> Again, my forte is not networking, but I could see how the requested file
</I>&gt;<i> could be cached and forwarded to all student boxes. Perhaps using an ICAP
</I>&gt;<i> server.
</I>
You can modify a request sent from the client, or you can modify a response 
sent back from a sever, but you cannot simply send a response to a machine 
which did not make a request.

&gt;<i> &gt;&gt;  c) responses to requests originating in the non master (&quot;slave&quot;?)
</I>&gt;<i> &gt;&gt; ends, return to their corresponding ends;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So, any computer other than the &quot;master&quot; simply makes requests and gets
</I>&gt;<i> &gt; standard responses as usual.  Fine.
</I>&gt;<i> 
</I>&gt;<i> Yes, once you know the request originated in the non master machine,
</I>&gt;<i> it would go back to the initiating client. Again, why would that be
</I>&gt;<i> that problematic?
</I>
That is not problematic - it's fine.

&gt;<i> &gt;&gt;  d) at times the master should be able to switch off that replicating
</I>&gt;<i> &gt;&gt; feature;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; What times?
</I>&gt;<i> 
</I>&gt;<i> Teacher may decide to &quot;privately&quot; check out some information by
</I>&gt;<i> herself without it being displayed on all students' ends or even
</I>&gt;<i> concurrently open another &quot;private&quot; browser window.
</I>
So, the Squid proxy needs somehow to be able to identify which session or 
window the teacher is using, and react differently.  I suspect this is probably 
doable, but far from simple.

&gt;<i> &gt; How?
</I>&gt;<i> 
</I>&gt;<i> This is what I don't know but I think (probably somewhat naively) it
</I>&gt;<i> shouldn't be that hard. Again, session tracking via cookies or URL
</I>&gt;<i> rewriting, maybe?
</I>
I think you are completely overlooking modern security practices here.

a) many websites use SSL/TLS - you can't just intercept the requests or 
responses and replace them with whatever you want

b) most browsers and related applications will either not support, or 
definitely warn about, cross-site scripting and foreign cookies

&gt;<i> &gt; I really think you need to explain this &quot;replicating feature&quot; in more
</I>&gt;<i> &gt; detail (and preferably in network terms, from the point of view of the
</I>&gt;<i> &gt; software running on the master, and the software running on a non-master.
</I>&gt;<i> 
</I>&gt;<i> I am not a networking guy but probably you could point out to me some
</I>&gt;<i> related documents explaining specifically the kinds of problematics
</I>&gt;<i> around these kinds of issues.
</I>
Just look up &quot;TCP 3-way handshake&quot; and read any basic introduction to &quot;client-
server connectivity&quot; for an understanding of how an HTTP request gets made and 
the response received.

Without a request, the response will be ignored.

&gt;<i> &gt; I think this request is (a) a *lot* more complicated than this, and
</I>&gt;<i> &gt; probably a lot more complicated than you think it is, and (b) in parts,
</I>&gt;<i> &gt; impossible.
</I>&gt;<i> 
</I>&gt;<i> I am squarely OK with &quot;lots of complication&quot; and as I said, you might
</I>&gt;<i> not be able to completely and directly implement all aspects using
</I>&gt;<i> squid, but what aspects of that integrated whole do you think are
</I>&gt;<i> impossible?
</I>
Basic networking protocols, from what I understand of how you expect this to 
work.


Antony.

-- 
Most people are aware that the Universe is big.

 - Paul Davies, Professor of Theoretical Physics

                                                   Please reply to the list;
                                                         please *don't* CC me.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="023684.html">[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...
</A></li>
	<LI>Next message (by thread): <A HREF="023686.html">[squid-users] (possibly dynamic?) multiple port forwarding in the same internal Network ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23685">[ date ]</a>
              <a href="thread.html#23685">[ thread ]</a>
              <a href="subject.html#23685">[ subject ]</a>
              <a href="author.html#23685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
