<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2021:6 Improper Certificate Validation in TLS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2021%3A6%20Improper%0A%20Certificate%20Validation%20in%20TLS&In-Reply-To=%3Cd8adde24-ec6e-af45-c7cc-4ca2f2807b64%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024135.html">
   <LINK REL="Next"  HREF="024132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2021:6 Improper Certificate Validation in TLS</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2021%3A6%20Improper%0A%20Certificate%20Validation%20in%20TLS&In-Reply-To=%3Cd8adde24-ec6e-af45-c7cc-4ca2f2807b64%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2021:6 Improper Certificate Validation in TLS">squid3 at treenet.co.nz
       </A><BR>
    <I>Mon Oct  4 01:59:26 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024135.html">[squid-users] [squid-announce] Squid 5.2 is available
</A></li>
        <LI>Next message (by thread): <A HREF="024132.html">[squid-users] [squid-announce] Squid 5.1 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24136">[ date ]</a>
              <a href="thread.html#24136">[ thread ]</a>
              <a href="subject.html#24136">[ subject ]</a>
              <a href="author.html#24136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
__________________________________________________________________

Squid Proxy Cache Security Update Advisory SQUID-2021:1
__________________________________________________________________

Advisory ID:       | SQUID-2021:6
Date:              | October 3, 2021
Summary:           | Improper Certificate Validation in TLS
Affected versions: | Squid 5.0.6 -&gt; 5.1
Fixed in version:  | Squid 5.2
__________________________________________________________________

   &lt;<A HREF="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41611">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41611</A>&gt;
__________________________________________________________________

Problem Description:

  When validating an origin server or peer certificate, Squid may
  incorrectly classify certain certificates as trusted.

__________________________________________________________________

Severity:

  This problem allows a remote server to obtain security trust
  when the trust is not valid. This indication of trust may be
  passed along to clients allowing access to unsafe or hijacked
  services.

  This problem is guaranteed to occur when multiple CA have
  signed the TLS server certificate. It may also occur in cases
  of broken server certificate chains.

CVSS Score of 8.4
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C/CR:H/IR:H/AR:X/MAV:X/MAC:X/MPR:X/MUI:R/MS:X/MC:H/MI:H/MA:X&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C/CR:H/IR:H/AR:X/MAV:X/MAC:X/MPR:X/MUI:R/MS:X/MC:H/MI:H/MA:X&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid version 5.2.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 5:

&lt;<A HREF="http://www.squid-cache.org/Versions/v5/changesets/squid-5-533b4359f16cf9ed15a6d709a57a4b06e4222cfe.patch">http://www.squid-cache.org/Versions/v5/changesets/squid-5-533b4359f16cf9ed15a6d709a57a4b06e4222cfe.patch</A>&gt;

  If you are using a prepackaged version of Squid then please
  refer to the package vendor for availability information on
  updated packages.

__________________________________________________________________

Determining if your version is vulnerable:

  All Squid-4 and older are not vulnerable.

  All Squid-5.0.1 up to and including 5.0.5 are not vulnerable.

  All Squid-5.0.6 up to and including 5.1 are vulnerable.

__________________________________________________________________

Workaround:

  The only workaround is complete denial to TLS and HTTPS servers
  publishing affected certificate chains. The set of affected
  servers varies over time and is left out of this document.

   acl vulnerableDomains dstdomain .example.net
   http_access deny vulnerableDomains

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is
  your primary support point. For subscription details see
  &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  &lt;<A HREF="https://bugs.squid-cache.org/">https://bugs.squid-cache.org/</A>&gt;.

  For reporting of security sensitive bugs send an email to the
  &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Jean-Paul Larocque of
  RodeoTV, LLC.

  Fixed by The Measurement Factory.

__________________________________________________________________

Revision history:

  2021-09-07 02:54:48 UTC Initial Report
  2021-09-24 20:10:37 UTC Patches Released
  2021-10-03 00:00:00 UTC Packages Released

__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-announce">http://lists.squid-cache.org/listinfo/squid-announce</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024135.html">[squid-users] [squid-announce] Squid 5.2 is available
</A></li>
	<LI>Next message (by thread): <A HREF="024132.html">[squid-users] [squid-announce] Squid 5.1 is available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24136">[ date ]</a>
              <a href="thread.html#24136">[ thread ]</a>
              <a href="subject.html#24136">[ subject ]</a>
              <a href="author.html#24136">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
