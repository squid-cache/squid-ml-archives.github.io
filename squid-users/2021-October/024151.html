<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 5.1 memory usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.1%20memory%20usage&In-Reply-To=%3Cbefcb522-3c6f-a1fc-cec6-5cf04e328a42%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024154.html">
   <LINK REL="Next"  HREF="024153.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 5.1 memory usage</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.1%20memory%20usage&In-Reply-To=%3Cbefcb522-3c6f-a1fc-cec6-5cf04e328a42%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid 5.1 memory usage">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Oct  8 14:50:41 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024154.html">[squid-users] [SPAM] [ext] Squid 5.1 memory usage
</A></li>
        <LI>Next message (by thread): <A HREF="024153.html">[squid-users] Squid 5.1 memory usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24151">[ date ]</a>
              <a href="thread.html#24151">[ thread ]</a>
              <a href="subject.html#24151">[ subject ]</a>
              <a href="author.html#24151">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/8/21 4:56 AM, Steve Hill wrote:
&gt;<i> 
</I>&gt;<i> I'm seeing high memory usage on Squid 5.1.&#160; Caching is disabled, so I'd
</I>&gt;<i> expect memory usage to be fairly low (and it was under Squid 3.5), but
</I>&gt;<i> some workers are growing pretty large.&#160; I'm using ICAP and SSL bump.
</I>
As Ralf Hildebrandt mentioned, this is a known problem that we are
tracking as Bug 5132: <A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5132">https://bugs.squid-cache.org/show_bug.cgi?id=5132</A>

We have fixed a few related bugs and will submit polished fixes for the
official inclusion soon, but those fixes do not seem to solve the
primary problem. We do not know what causes the primary leak, but still
have some suspects to go through, and continue to work on this issue.


&gt;<i> I've got a worker using 5 GB which I've collected memory stats from -
</I>&gt;<i> the things which stand out are:
</I>&gt;<i> &#160;- Long Strings: 220 MB
</I>&gt;<i> &#160;- Short Strings: 2.1 GB
</I>&gt;<i> &#160;- Comm::Connection: 217 MB
</I>&gt;<i> &#160;- HttpHeaderEntry: 777 MB
</I>&gt;<i> &#160;- MemBlob: 773 MB
</I>&gt;<i> &#160;- Entry: 226 MB
</I>
&gt;<i> What's the best way of debugging this?
</I>
I cannot recommend anything specific at sysadmin level right now because
the tricks I knew about (that would often work at that level) did not
help in this particular use case.


&gt;<i> It there a way to list all of the Comm::Connection objects?
</I>
The exact answer is &quot;no&quot;, but you can use mgr:filedescriptors as an
approximation.


Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024154.html">[squid-users] [SPAM] [ext] Squid 5.1 memory usage
</A></li>
	<LI>Next message (by thread): <A HREF="024153.html">[squid-users] Squid 5.1 memory usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24151">[ date ]</a>
              <a href="thread.html#24151">[ thread ]</a>
              <a href="subject.html#24151">[ subject ]</a>
              <a href="author.html#24151">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
