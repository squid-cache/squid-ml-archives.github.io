<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Error 503 accessing Instagram/facebook via IPv6
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20503%20accessing%20Instagram/facebook%20via%20IPv6&In-Reply-To=%3C2f60006d-300b-0b2f-e488-55a545153250%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024209.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Error 503 accessing Instagram/facebook via IPv6</H1>
    <B>Nishant Sharma</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Error%20503%20accessing%20Instagram/facebook%20via%20IPv6&In-Reply-To=%3C2f60006d-300b-0b2f-e488-55a545153250%40gmail.com%3E"
       TITLE="[squid-users] Error 503 accessing Instagram/facebook via IPv6">codemarauder at gmail.com
       </A><BR>
    <I>Sat Oct 30 06:26:10 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024209.html">[squid-users] Error 503 accessing Instagram/facebook via IPv6
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24210">[ date ]</a>
              <a href="thread.html#24210">[ thread ]</a>
              <a href="subject.html#24210">[ subject ]</a>
              <a href="author.html#24210">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

On 30/10/21 11:40 am, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">marcelorodrigo at graminsta.com.br</A> wrote:
&gt;<i> Since last 3-4 days my customers haven't been able to access
</I>&gt;<i> www.instagram.com and Facebook throug IPv6s that were already working as
</I>&gt;<i> proxies for years.
</I>&gt;<i> 
</I>&gt;<i> I only get 503 error after a time out.
</I>&gt;<i> The strangest thing is that I can connect 20-30% of the attempts.
</I>
This seems to be the issue with DNS returning the IP addresses of
certain servers in the CDN which might have routing issues with your
ISPs ASN. Or that particular CDN server might be at fault.


Try this:

1. nslookup/dig for destinations giving 503 errors in squid logs
2. step (1) should return multiple IP addresses. One or two of the IPs
would be the one throwing 503 errors in squid logs.
3. `curl <A HREF="https://&lt;IP">https://&lt;IP</A>&gt;` multiple times from the squid machine and see if
you get reply from each of the IPs reliably. You will identify the
problematic IP addresses and they should be the ones in squid logs
throwing 503 errors.
4. override DNS resolution for your destination domain with one of the
IPs responding every time when you did curl.

If things start working, then you might want to change your DNS from
what it is now to some other DNS.

I have faced similar problem with pinterest in the past and I had to use
DNS server of a different geographical region to receive DNS response
with CDN IPs that worked from my network's ASN.

Regards,
Nishant


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024209.html">[squid-users] Error 503 accessing Instagram/facebook via IPv6
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24210">[ date ]</a>
              <a href="thread.html#24210">[ thread ]</a>
              <a href="subject.html#24210">[ subject ]</a>
              <a href="author.html#24210">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
