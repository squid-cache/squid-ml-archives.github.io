<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Fwd: Getting a squid clients list
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fwd%3A%20Getting%20a%20squid%20clients%20list&In-Reply-To=%3C515648037.3037994.1630832383170%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024009.html">
   <LINK REL="Next"  HREF="024011.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Fwd: Getting a squid clients list</H1>
    <B>U Zee</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fwd%3A%20Getting%20a%20squid%20clients%20list&In-Reply-To=%3C515648037.3037994.1630832383170%40mail.yahoo.com%3E"
       TITLE="[squid-users] Fwd: Getting a squid clients list">uzee001 at yahoo.com
       </A><BR>
    <I>Sun Sep  5 08:59:43 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024009.html">[squid-users] Fwd: Getting a squid clients list
</A></li>
        <LI>Next message (by thread): <A HREF="024011.html">[squid-users] Configuring SSL Bump on CONNECT, but no SSL Bump on Transparent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24015">[ date ]</a>
              <a href="thread.html#24015">[ thread ]</a>
              <a href="subject.html#24015">[ subject ]</a>
              <a href="author.html#24015">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> Thanks so much Amos, really appreciate it. It also turns out that I did have the squidclient tool on my squid server, it just wasn't in the path :)&#160;I ran:&#160;squidclient mgr:client_list | grep &quot;Address&quot; and it gave me 28 IPs, then I also ran mgr:info and that too showed &quot;Number of clients accessing cache:&#160; 28&quot; which confirmed it as well.However, if you have a couple of minutes, I wanted to clarify one thing regarding the total squid clients that I'm trying to find.Before I was able to run squidclient, I had run a 'netstat -an' and grep'ed for 3128 and ran this in a loop for 4-5 days to get all connections to the proxy. The list of clients resulting from that shows 62. My understanding of squidclient is that it captures all the information since squid was started, which in my case is July 2020, so the client_list from squidclient tool should have had everything that I found from my 4-5 days of netstat, no? What am I missing or not understanding correctly? And more importantly, which source (squidclient or netstat) should be trusted?
Thanks once again-uzee
    On Thursday, September 2, 2021, 04:57:05 PM GMT+3, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:  
 
 On 3/09/21 1:28 am, U Zee wrote:
&gt;<i> Can anyone help with running squidclient remotely and getting the list 
</I>&gt;<i> of clients, or any other way to get the list of clients?
</I>&gt;<i> 
</I>

You just need to adjust the squid.conf of the running Squid to allow 
management access to the machine you are fetching from.


Be aware:
&#160; Make sure that you only use reconfigure and avoid a restart of the 
proxy after making these changes. A restart will erase some or all of 
the info you are looking to find.


With the CLIENT_IP being address of the machine you are going to do the 
fetch from these commands go at the top of squid.conf:

&#160; acl mgr_client src CLIENT_IP
&#160; http_access allow mgr_client
&#160; cachemgr_passwd none client_list


... *reconfigure* (not restart) the proxy.

... run the squidclient fetch you want

.. undo or at least comment out the above settings and reconfigure.



Amos


&gt;<i> Thanks very much
</I>&gt;<i> 
</I>&gt;<i> On Tuesday, August 31, 2021, 05:50:12 PM GMT+3, U Zee 
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">uzee001 at yahoo.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Thanks for the pointer Eliezer. I installed it on an Ubuntu 20 machine 
</I>&gt;<i> and tried but it didn't seem to work:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at ub20-srv1</A>:~# squidclient -h squid.mydomain.com mgr:client_list
</I>&gt;<i> HTTP/1.0 403 Forbidden
</I>&gt;<i> Server: squid/2.6.STABLE13
</I>&gt;<i> Date: Tue, 31 Aug 2021 14:45:09 GMT
</I>&gt;<i> Content-Type: text/html
</I>&gt;<i> Content-Length: 1115
</I>&gt;<i> Expires: Tue, 31 Aug 2021 14:45:09 GMT
</I>&gt;<i> X-Squid-Error: ERR_ACCESS_DENIED 0
</I>&gt;<i> X-Cache: MISS from squid.mydomain.com
</I>&gt;<i> Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)
</I>&gt;<i> Proxy-Connection: close
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at ub20-srv1</A>:~# squidclient -h squid.mydomain.com&#160; mgr:info
</I>&gt;<i> HTTP/1.0 403 Forbidden
</I>&gt;<i> Server: squid/2.6.STABLE13
</I>&gt;<i> Date: Tue, 31 Aug 2021 14:46:33 GMT
</I>&gt;<i> Content-Type: text/html
</I>&gt;<i> Content-Length: 1101
</I>&gt;<i> Expires: Tue, 31 Aug 2021 14:46:33 GMT
</I>&gt;<i> X-Squid-Error: ERR_ACCESS_DENIED 0
</I>&gt;<i> X-Cache: MISS from squid.mydomain.com
</I>&gt;<i> Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)
</I>&gt;<i> Proxy-Connection: close
</I>&gt;<i> 
</I>&gt;<i> Although the proxy function seems to be working, but I cannot get the 
</I>&gt;<i> &quot;mgr&quot; function to work:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at ub20-srv1</A>:~# squidclient -h squid.mydomain.com&#160;-v <A HREF="http://vmware.com">http://vmware.com</A>
</I>&gt;<i> Request:
</I>&gt;<i> GET <A HREF="http://vmware.com">http://vmware.com</A> HTTP/1.0
</I>&gt;<i> Host: vmware.com
</I>&gt;<i> User-Agent: squidclient/4.10
</I>&gt;<i> Accept: */*
</I>&gt;<i> Connection: close
</I>&gt;<i> .
</I>&gt;<i> HTTP/1.0 301 Moved Permanently
</I>&gt;<i> Location: <A HREF="https://www.vmware.com/">https://www.vmware.com/</A>
</I>&gt;<i> Content-Length: 0
</I>&gt;<i> X-Cache: MISS from squid.mydomain.com
</I>&gt;<i> Via: 1.0 squid.mydomain.com:3128 (squid/2.6.STABLE13)
</I>&gt;<i> Proxy-Connection: close
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Monday, August 30, 2021, 02:56:29 PM GMT+3, NgTech LTD 
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hey Uzee,
</I>&gt;<i> 
</I>&gt;<i> You can use squidclient from another machine to access this machine.
</I>&gt;<i> I do not remember how by heart but Amos might know if I am guessing right.
</I>&gt;<i> 
</I>&gt;<i> Eliezer
</I>&gt;<i> 
</I>&gt;<i> &#1489;&#1514;&#1488;&#1512;&#1497;&#1498; &#1497;&#1493;&#1501; &#1489;&#1523;, 30 &#1489;&#1488;&#1493;&#1490;&#1523; 2021, 14:44, &#1502;&#1488;&#1514; U Zee &#8207;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">uzee001 at yahoo.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">uzee001 at yahoo.com</A>&gt;&gt;:
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; &lt;sigh&gt; I know and sadly installing it is not possible either.
</I>&gt;<i>&#160; &#160; Without going into the details too much, its a machine with a legacy
</I>&gt;<i>&#160; &#160; environment where yum and some other tools are broken and people who
</I>&gt;<i>&#160; &#160; knew about the configs are long gone.
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; On Monday, August 30, 2021, 01:29:47 PM GMT+3, Amos Jeffries
</I>&gt;<i>&#160; &#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; On 30/08/21 10:18 pm, U Zee wrote:
</I>&gt;<i>&#160; &#160; &#160; &gt; Thanks Amos. I don't think the clientdb features you mentioned are
</I>&gt;<i>&#160; &#160; &#160; &gt; enabled, I'm getting a command not found.
</I>&gt;<i>&#160; &#160; &#160; &gt; Also I don't see anything configured for logging in squid.conf (I
</I>&gt;<i>&#160; &#160; don't
</I>&gt;<i>&#160; &#160; &#160; &gt; know if there is any other place for it)
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; bash-3.00# ps -ef|grep squid
</I>&gt;<i>&#160; &#160; &#160; &gt; root&#160; &#160; &#160; 2467&#160; &#160; &#160;1&#160; 0&#160; 2020 ?&#160; &#160; &#160; &#160; 00:00:00 /usr/squid/sbin/squid
</I>&gt;<i>&#160; &#160; &#160; &gt; nobody&#160; &#160; 2471&#160; 2467&#160; 0&#160; 2020 ?&#160; &#160; &#160; &#160; 07:49:45 (squid)
</I>&gt;<i>&#160; &#160; &#160; &gt; root&#160; &#160; &#160;28018 20110&#160; 0 13:12 pts/0&#160; &#160; 00:00:00 grep squid
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; bash-3.00# /usr/squid/sbin/squid -v
</I>&gt;<i>&#160; &#160; &#160; &gt; Squid Cache: Version 2.6.STABLE13
</I>&gt;<i>&#160; &#160; &#160; &gt; configure options: '--prefix=/usr/squid' 'CC=gcc' 'CFLAGS=-O3 -g'
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; bash-3.00# squidclient mgr:client_list | grep &quot;Address&quot;
</I>&gt;<i>&#160; &#160; &#160; &gt; bash: squidclient: command not found
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; That is the squidclient tool missing on your machine.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; Amos
</I>&gt;<i>&#160; &#160; _______________________________________________
</I>&gt;<i>&#160; &#160; squid-users mailing list
</I>&gt;<i>&#160; &#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>&#160; &#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>&#160; &#160; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>&#160; &#160; &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i>&#160; &#160; _______________________________________________
</I>&gt;<i>&#160; &#160; squid-users mailing list
</I>&gt;<i>&#160; &#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>&#160; &#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i>&#160; &#160; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>&#160; &#160; &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A> 
</I>&gt;<i> &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> 
</I>_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210905/082c6ff2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210905/082c6ff2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024009.html">[squid-users] Fwd: Getting a squid clients list
</A></li>
	<LI>Next message (by thread): <A HREF="024011.html">[squid-users] Configuring SSL Bump on CONNECT, but no SSL Bump on Transparent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24015">[ date ]</a>
              <a href="thread.html#24015">[ thread ]</a>
              <a href="subject.html#24015">[ subject ]</a>
              <a href="author.html#24015">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
