<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] hostHeaderVerify with SNI in interception environments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20hostHeaderVerify%20with%20SNI%20in%20interception%0A%20environments&In-Reply-To=%3C46207bc8-a7d2-1730-38a6-2a1ffede80f3%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024069.html">
   <LINK REL="Next"  HREF="024071.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] hostHeaderVerify with SNI in interception environments</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20hostHeaderVerify%20with%20SNI%20in%20interception%0A%20environments&In-Reply-To=%3C46207bc8-a7d2-1730-38a6-2a1ffede80f3%40measurement-factory.com%3E"
       TITLE="[squid-users] hostHeaderVerify with SNI in interception environments">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Sep 17 20:14:51 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024069.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
        <LI>Next message (by thread): <A HREF="024071.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24070">[ date ]</a>
              <a href="thread.html#24070">[ thread ]</a>
              <a href="subject.html#24070">[ subject ]</a>
              <a href="author.html#24070">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/17/21 3:29 PM, Andreas Weigel wrote:

&gt;<i> If splicing at step3, however, hostHeaderVerify is not called again with
</I>&gt;<i> the SNI
</I>
I assume that the above statement would still be true if I remove the
word &quot;again&quot; from it. This is how I interpreted it (i.e.
hostHeaderVerify() is called once with the IP address and never with SNI).

There are other ways to interpret that statement (e.g., hostHeaderVerify
was called with SNI once, but you expected it to be called with SNI twice).


&gt;<i> I was wondering if this could be considered a bug or if there is a
</I>&gt;<i> rationale to change the behavior in the &quot;peek at step2, splice at step3&quot;
</I>&gt;<i> scenario.
</I>
If my interpretation above is correct, then this sounds like a bug to
me: Squid/hostHeaderVerify() must validate every request target value
Squid intends to use for cache lookups and/or connecting. If the request
target changes from IP to SNI, then Squid must validate exactly twice.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024069.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
	<LI>Next message (by thread): <A HREF="024071.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24070">[ date ]</a>
              <a href="thread.html#24070">[ thread ]</a>
              <a href="subject.html#24070">[ subject ]</a>
              <a href="author.html#24070">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
