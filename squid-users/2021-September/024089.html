<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] hostHeaderVerify with SNI in interception environments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20hostHeaderVerify%20with%20SNI%20in%20interception%0A%20environments&In-Reply-To=%3C20210921141400.Horde.mjpKn3EZKoY1AM4vj3NGsT3%40webmail.intern.securepoint.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024073.html">
   <LINK REL="Next"  HREF="024091.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] hostHeaderVerify with SNI in interception environments</H1>
    <B>Andreas Weigel</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20hostHeaderVerify%20with%20SNI%20in%20interception%0A%20environments&In-Reply-To=%3C20210921141400.Horde.mjpKn3EZKoY1AM4vj3NGsT3%40webmail.intern.securepoint.de%3E"
       TITLE="[squid-users] hostHeaderVerify with SNI in interception environments">andreas.weigel at securepoint.de
       </A><BR>
    <I>Tue Sep 21 14:14:00 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024073.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
        <LI>Next message (by thread): <A HREF="024091.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24089">[ date ]</a>
              <a href="thread.html#24089">[ thread ]</a>
              <a href="subject.html#24089">[ subject ]</a>
              <a href="author.html#24089">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

sorry for the late response and the ambiguity in the initial post.

&gt;<i> That fact is unrelated to the concern being raised in this thread
</I>&gt;<i> AFAICT: The concern is _not_ whether Squid verifies the target of the
</I>&gt;<i> SNI-based CONNECT during step3. The concern is whether Squid verifies
</I>&gt;<i> the target of the SNI-based CONNECT at all.
</I>
Exactly. If splicing in step2, the SNI is validated (DNS lookup,  
comparing results with IP from client request). In that configuration,  
hostHeaderVerify is called twice, once at step1 (without any hosts,  
always passes) and once at step2 (with SNI, if present).

If peeking in step2 and splicing in step3, the SNI is *not* validated  
in step2 -- hostHeaderVerify is only called once without any hostname  
at step1 in that case and that always passes.

Andreas


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024073.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
	<LI>Next message (by thread): <A HREF="024091.html">[squid-users] hostHeaderVerify with SNI in interception environments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24089">[ date ]</a>
              <a href="thread.html#24089">[ thread ]</a>
              <a href="subject.html#24089">[ subject ]</a>
              <a href="author.html#24089">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
