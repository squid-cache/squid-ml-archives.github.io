<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Sorry if this has been asked but I can't find an answer anywhere ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sorry%20if%20this%20has%20been%20asked%20but%20I%20can%27t%20find%20an%0A%20answer%20anywhere%20...&In-Reply-To=%3CCAPqnvdk0aXr98aEpbZxmOnhND%3DDMfHOQ47zP2rJ8H_sA2nvNQA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024106.html">
   <LINK REL="Next"  HREF="024112.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...</H1>
    <B>Mike Yates</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Sorry%20if%20this%20has%20been%20asked%20but%20I%20can%27t%20find%20an%0A%20answer%20anywhere%20...&In-Reply-To=%3CCAPqnvdk0aXr98aEpbZxmOnhND%3DDMfHOQ47zP2rJ8H_sA2nvNQA%40mail.gmail.com%3E"
       TITLE="[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...">myates61 at gmail.com
       </A><BR>
    <I>Mon Sep 27 12:44:16 UTC 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024106.html">[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...
</A></li>
        <LI>Next message (by thread): <A HREF="024112.html">[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24110">[ date ]</a>
              <a href="thread.html#24110">[ thread ]</a>
              <a href="subject.html#24110">[ subject ]</a>
              <a href="author.html#24110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry Alex but if using postman I just post to the internal URL with no
certificates and everything works fine. All I'm trying to do is post to the
squid server that will then redirect the post to the external url.  Its
that simple ..

On Sat, Sep 25, 2021 at 11:55 AM Alex Rousskov &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:

&gt;<i> On 9/25/21 5:23 AM, Mike Yates wrote:
</I>&gt;<i> &gt; There are no certificates to worry about, the api is expecting a token
</I>&gt;<i> &gt; to be included in the payload of the call.   So all squid needs to do is
</I>&gt;<i> &gt; accept the post from the internal server and pass that post to the
</I>&gt;<i> &gt; external servers url including the payload.
</I>&gt;<i>
</I>&gt;<i> &gt; I hope that helps.
</I>&gt;<i>
</I>&gt;<i> Not yet. Forget about payload for a second. Our problems are still at a
</I>&gt;<i> much higher level: In your examples, you used <A HREF="https://...">https://...</A> URLs. Do
</I>&gt;<i> internal servers make HTTPS requests (i.e. HTTP requests over SSL/TLS
</I>&gt;<i> connections)? If yes, then why are you saying that there are no
</I>&gt;<i> certificates to worry about? TLS connections normally involve
</I>&gt;<i> certificate validation!..
</I>&gt;<i>
</I>&gt;<i> Perhaps those internal servers make plain HTTP requests, and you used
</I>&gt;<i> &quot;<A HREF="https://...">https://...</A>&quot; URLs in your examples by accident?
</I>&gt;<i>
</I>&gt;<i> BTW, if you do not know the answers to some of the questions, please
</I>&gt;<i> just say so -- there is nothing wrong with that. If you can share a
</I>&gt;<i> small packet capture of a single request/response (in libpcap format),
</I>&gt;<i> that may reduce the number of questions we have to ask.
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; On Fri, Sep 24, 2021, 18:01 Alex Rousskov wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     On 9/24/21 5:26 PM, Mike Yates wrote:
</I>&gt;<i> &gt;     &gt; Ok so let's say the new server outside the dmz has a different
</I>&gt;<i> name. I
</I>&gt;<i> &gt;     &gt; need a squid server configuration that will just forward the api
</I>&gt;<i> calls
</I>&gt;<i> &gt;     &gt; to an external address.  So my internal servers will still point
</I>&gt;<i> &gt;     to Fred
</I>&gt;<i> &gt;     &gt; ( which is now a squid server and has access to the outside world)
</I>&gt;<i> and
</I>&gt;<i> &gt;     &gt; will then forward the requests to the new server I have in the
</I>&gt;<i> cloud.
</I>&gt;<i> &gt;     &gt; Long story short I just need a pass through squid server.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Will those internal servers trust the certificate you configure Squid
</I>&gt;<i> &gt;     with? In your example, you used &quot;<A HREF="https://...">https://...</A>&quot;. That usually means
</I>&gt;<i> the
</I>&gt;<i> &gt;     internal servers are going to validate the server certificate. Can
</I>&gt;<i> you
</I>&gt;<i> &gt;     make them trust the Squid certificate? Or does the API communication
</I>&gt;<i> &gt;     have to be signed by a fred.mydomain.com &lt;<A HREF="http://fred.mydomain.com">http://fred.mydomain.com</A>&gt;
</I>&gt;<i> &gt;     certificate that you do not
</I>&gt;<i> &gt;     control?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     The other pending question is whether those internal servers are
</I>&gt;<i> &gt;     configured to use a proxy (see the previous email on this thread) or
</I>&gt;<i> &gt;     always talk directly to (what they think is) the API service?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Alex.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     &gt; On Fri, Sep 24, 2021, 17:18 Alex Rousskov wrote:
</I>&gt;<i> &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     On 9/24/21 5:09 PM, Mike Yates wrote:
</I>&gt;<i> &gt;     &gt;     &gt; I have a bunch of internal machines that do not have internet
</I>&gt;<i> &gt;     &gt;     access and
</I>&gt;<i> &gt;     &gt;     &gt; any one of them is sending api post requests to another
</I>&gt;<i> &gt;     system on prem
</I>&gt;<i> &gt;     &gt;     &gt; and having no issues &#8230;.
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt; Example would be <A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>
</I>&gt;<i> &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>&gt;
</I>&gt;<i> &gt;     &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>
</I>&gt;<i> &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>&gt;&gt;
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     &gt; Now the problem becomes the fred server is being moved to
</I>&gt;<i> &gt;     the cloud so
</I>&gt;<i> &gt;     &gt;     &gt; the same <A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>
</I>&gt;<i> &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>&gt;
</I>&gt;<i> &gt;     &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>
</I>&gt;<i> &gt;     &lt;<A HREF="https://fred.mydomain.com/api/event">https://fred.mydomain.com/api/event</A>&gt;&gt; is still valid but none of my
</I>&gt;<i> &gt;     &gt;     &gt; internal server can see fred and I don&#8217;t have access to the
</I>&gt;<i> &gt;     backend
</I>&gt;<i> &gt;     &gt;     &gt; servers to change their api calls.
</I>&gt;<i> &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     AFAICT from your summary, &quot;moved to cloud&quot; here means that the
</I>&gt;<i> API
</I>&gt;<i> &gt;     &gt;     protocol stays the same, the API server domain name stays the
</I>&gt;<i> &gt;     same, the
</I>&gt;<i> &gt;     &gt;     API URL path stays the same, but the IP address of that domain
</I>&gt;<i> &gt;     name will
</I>&gt;<i> &gt;     &gt;     change. Please clarify if that conclusion is wrong.
</I>&gt;<i> &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     If it is correct, then it is not clear how the change of an IP
</I>&gt;<i> &gt;     address
</I>&gt;<i> &gt;     &gt;     would affect those making API requests using the domain name,
</I>&gt;<i> &gt;     and what
</I>&gt;<i> &gt;     &gt;     role Squid is playing here.
</I>&gt;<i> &gt;     &gt;
</I>&gt;<i> &gt;     &gt;     Alex.
</I>&gt;<i> &gt;     &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20210927/23d79f7a/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20210927/23d79f7a/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024106.html">[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...
</A></li>
	<LI>Next message (by thread): <A HREF="024112.html">[squid-users] Sorry if this has been asked but I can't find an answer anywhere ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24110">[ date ]</a>
              <a href="thread.html#24110">[ thread ]</a>
              <a href="subject.html#24110">[ subject ]</a>
              <a href="author.html#24110">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
