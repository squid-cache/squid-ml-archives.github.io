<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Fine tuning of Squid and OS configuration for handling more loads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fine%20tuning%20of%20Squid%20and%20OS%20configuration%20for%0A%20handling%20more%20loads&In-Reply-To=%3C74d4a17d-22d1-7cf4-1e6a-5f20b8d685b0%40cdot.in%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024710.html">
   <LINK REL="Next"  HREF="024712.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Fine tuning of Squid and OS configuration for handling more loads</H1>
    <B>pvs</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Fine%20tuning%20of%20Squid%20and%20OS%20configuration%20for%0A%20handling%20more%20loads&In-Reply-To=%3C74d4a17d-22d1-7cf4-1e6a-5f20b8d685b0%40cdot.in%3E"
       TITLE="[squid-users] Fine tuning of Squid and OS configuration for handling more loads">pvs at cdot.in
       </A><BR>
    <I>Mon Apr 11 11:26:18 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024710.html">[squid-users] Fine tuning of Squid and OS configuration for handling more loads
</A></li>
        <LI>Next message (by thread): <A HREF="024712.html">[squid-users] Fine tuning of Squid and OS configuration for handling more loads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24711">[ date ]</a>
              <a href="thread.html#24711">[ thread ]</a>
              <a href="subject.html#24711">[ subject ]</a>
              <a href="author.html#24711">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alex,

cache.log file is attached with contents narrowed down to the time just 
before squid process oscillating (going up and down), ultimately dying.


Regards,

Vishnu


On 08-04-2022 19:09, Alex Rousskov wrote:
&gt;<i> On 4/8/22 05:56, pvs wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; sudo /usr/squid/5.2/sbin/squid -f /etc/squid/squid.conf
</I>&gt;<i>
</I>&gt;<i> Next time, try starting Squid from the console/terminal using the 
</I>&gt;<i> following command:
</I>&gt;<i>
</I>&gt;<i> &#160;&#160;&#160; sudo /usr/squid/5.2/sbin/squid -Nd1 -f /etc/squid/squid.conf
</I>&gt;<i>
</I>&gt;<i> This is _not_ the right way to start Squid in production, but it is a 
</I>&gt;<i> good way to test whether you can get some error messages on the 
</I>&gt;<i> console after Squid dies during this _test_ run.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I wanted to share cache.log file, but the size is too big.
</I>&gt;<i>
</I>&gt;<i> You can always share a link to a (compressed) log file or at least 
</I>&gt;<i> copy-paste the last ~100 lines written just _before Squid exited_. The 
</I>&gt;<i> exiting lines, if any, would be printed above the Squid startup lines 
</I>&gt;<i> similar to these:
</I>&gt;<i>
</I>&gt;<i> &gt; 2022/04/07 18:43:38.457| Created PID file (.../squid.pid)
</I>&gt;<i> &gt; 2022/04/07 18:43:38.459| Set Current Directory to /usr/local/squid/var
</I>&gt;<i> &gt; 2022/04/07 18:43:38.459| Starting Squid Cache version ...
</I>&gt;<i>
</I>&gt;<i> The other information you have provided was useful but not sufficient.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Please keep this conversation on the squid-users list instead of 
</I>&gt;<i> responding to me personally.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thank you,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; On 07-04-2022 19:09, Alex Rousskov wrote:
</I>&gt;<i> &gt;&gt; On 4/7/22 00:15, pvs wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On the 3rd day morning all of a sudden squid process stopped, after
</I>&gt;<i> &gt;&gt;&gt; restarting it worked 10 minutes and again stopped, this process
</I>&gt;<i> &gt;&gt;&gt; repeated and finally we removed this squid from production network.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; We tried to analyze the syslog file, squid access/cache log files,
</I>&gt;<i> &gt;&gt;&gt; not got any concrete clues.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Any clues/ideas where i can look for additional info for the squid
</I>&gt;<i> &gt;&gt;&gt; process all of a sudden dying.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; How do you start Squid?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; How many &quot;sbin/squid&quot; or equivalent processes are running when
</I>&gt;<i> &gt;&gt; everything is working OK?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; You may want to share &quot;ps aux | fgrep squid&quot; or similar output after
</I>&gt;<i> &gt;&gt; starting Squid the usual way.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If Squid knows that it is dying, then cache.log usually has a record
</I>&gt;<i> &gt;&gt; of the cause of death. Squid will often known that it is dying, but
</I>&gt;<i> &gt;&gt; there are exceptions. Squid will know less if you start it with a -C
</I>&gt;<i> &gt;&gt; command line option.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If Squid does not know that it is dying, then whatever scripts/system
</I>&gt;<i> &gt;&gt; you used to start Squid may have a record of it. Usually, those
</I>&gt;<i> &gt;&gt; messages go into syslog.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I know you said you looked in cache.log and syslog, but perhaps there
</I>&gt;<i> &gt;&gt; are some clues there that you consider unimportant. If anything is
</I>&gt;<i> &gt;&gt; logged at the time of death, consider sharing those records.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If there are really no traces anywhere, then you are doing something
</I>&gt;<i> &gt;&gt; very unusual, but you should still be able to triage the issue if you
</I>&gt;<i> &gt;&gt; start Squid by hand from the terminal (add &quot;-d1&quot; if you are not using
</I>&gt;<i> &gt;&gt; that option already) and watch the console output at the time of
</I>&gt;<i> &gt;&gt; death. You will also be able to collect the exit code of the top-level
</I>&gt;<i> &gt;&gt; squid process this way -- another potential clue.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; HTH,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Alex.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &#2346;&#2306;. &#2357;&#2367;&#2359;&#2381;&#2339;&#2369; &#2358;&#2306;&#2325;&#2352;&#160;&#160;&#160;&#160;&#160;&#160;&#160; P. Vishnu Sankar
</I>&gt;<i> &gt; &#2335;&#2368;&#2350; &#2354;&#2368;&#2337;&#2352;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Team Leader-Network Operations
</I>&gt;<i> &gt; &#2360;&#2368;-&#2337;&#2377;&#2335;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; C-DOT
</I>&gt;<i> &gt; &#2311;&#2354;&#2376;&#2325;&#2381;&#2335;&#2381;&#2352;&#2377;&#2344;&#2367;&#2325;&#2381;&#2360; &#2360;&#2367;&#2335;&#2368; &#2347;&#2375;&#2332;&#2364; I&#160;&#160;&#160; Electronics City Phase I
</I>&gt;<i> &gt; &#2361;&#2379;&#2360;&#2370;&#2352; &#2352;&#2379;&#2337; &#2348;&#2375;&#2306;&#2327;&#2354;&#2370;&#2352;&#2369;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Hosur Road Bengaluru &#8211; 560100
</I>&gt;<i> &gt; &#2347;&#2379;&#2344;&#160; Ph&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 91 80 25119466
</I>&gt;<i> &gt; ------------------------------------------------------
</I>
-- 
Regards,

&#2346;&#2306;. &#2357;&#2367;&#2359;&#2381;&#2339;&#2369; &#2358;&#2306;&#2325;&#2352;		P. Vishnu Sankar
&#2335;&#2368;&#2350; &#2354;&#2368;&#2337;&#2352;                Team Leader-Network Operations
&#2360;&#2368;-&#2337;&#2377;&#2335;                  C-DOT
&#2311;&#2354;&#2376;&#2325;&#2381;&#2335;&#2381;&#2352;&#2377;&#2344;&#2367;&#2325;&#2381;&#2360; &#2360;&#2367;&#2335;&#2368; &#2347;&#2375;&#2332;&#2364; I    Electronics City Phase I
&#2361;&#2379;&#2360;&#2370;&#2352; &#2352;&#2379;&#2337; &#2348;&#2375;&#2306;&#2327;&#2354;&#2370;&#2352;&#2369;          Hosur Road Bengaluru &#8211; 560100
&#2347;&#2379;&#2344;  Ph                91 80 25119466
------------------------------------------------------
Disclaimer :
This email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed.
If you are not the intended recipient you are notified that disclosing, copying, distributing or taking any action in reliance on the contents of this information is strictly prohibited.
The sender does not accept liability for any errors or omissions in the contents of this message, which arise as a result.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cache-log.rar
Type: application/octet-stream
Size: 37345 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220411/15732cc8/attachment.obj">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220411/15732cc8/attachment.obj</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024710.html">[squid-users] Fine tuning of Squid and OS configuration for handling more loads
</A></li>
	<LI>Next message (by thread): <A HREF="024712.html">[squid-users] Fine tuning of Squid and OS configuration for handling more loads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24711">[ date ]</a>
              <a href="thread.html#24711">[ thread ]</a>
              <a href="subject.html#24711">[ subject ]</a>
              <a href="author.html#24711">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
