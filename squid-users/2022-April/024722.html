<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid compilation error in Docker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20compilation%20error%20in%20Docker&In-Reply-To=%3CCAHvB88w2GABY0qKRCAvUa4Xg3%2BWS3kVDxBU-hsPuS_z50%2Bxeag%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024721.html">
   <LINK REL="Next"  HREF="024724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid compilation error in Docker</H1>
    <B>Ivan Larionov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20compilation%20error%20in%20Docker&In-Reply-To=%3CCAHvB88w2GABY0qKRCAvUa4Xg3%2BWS3kVDxBU-hsPuS_z50%2Bxeag%40mail.gmail.com%3E"
       TITLE="[squid-users] squid compilation error in Docker">xeron.oskom at gmail.com
       </A><BR>
    <I>Thu Apr 14 02:59:40 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024721.html">[squid-users] squid compilation error in Docker
</A></li>
        <LI>Next message (by thread): <A HREF="024724.html">[squid-users] squid compilation error in Docker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24722">[ date ]</a>
              <a href="thread.html#24722">[ thread ]</a>
              <a href="subject.html#24722">[ subject ]</a>
              <a href="author.html#24722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There were no errors earlier.

Seems like installing openldap-devel fixes the issue.

There were other dependencies installed together with it, not sure if they
also affected the build or not. I assume the ldap one is the main reason:

cracklib
cracklib-dicts
libpwquality
pam
cpio
dbus-libs
libudev
libblkid
libmount
libnih
upstart
libuser
sysvinit
xz
libutempter
util-linux
net-tools
procps
ethtool
mingetty
psmisc
iptables
iproute
kmod-libs
kmod
hwdata
udev
findutils
iputils
initscripts
cyrus-sasl
cyrus-sasl-devel
openldap-devel

Basically this was enough for the build to succeed:

yum install -y gcc gcc-c++ libtool libtool-ltdl-devel make pkgconfig
automake autoconf wget diffutils file openldap-devel

but just removing openldap-devel from that line results in errors I posted.

On Wed, Apr 13, 2022 at 7:19 PM Alex Rousskov &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:

&gt;<i> On 4/13/22 20:07, Ivan Larionov wrote:
</I>&gt;<i> &gt; Yes this worked. Thanks Eliezer.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This means some of these dependencies are required but not caught by the
</I>&gt;<i> &gt; configure script.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'll try to figure out which specific one was the culprit.
</I>&gt;<i>
</I>&gt;<i> And maybe find the earlier error in the make log? The errors you shared
</I>&gt;<i> did not look like a direct effect of some missing package, more like a
</I>&gt;<i> side effect of something that went wrong earlier...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thank you both,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; On Wed, Apr 13, 2022 at 4:36 PM Eliezer Croitoru wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     For CentOS 7 use the next:____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     RUN yum install -y epel-release \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum clean all \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum update -y \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum install -y gcc gcc-c++ libtool libtool-ltdl make cmake
</I>&gt;<i> \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     git pkgconfig sudo automake autoconf yum-utils
</I>&gt;<i> &gt;     rpm-build \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum install -y libxml2 expat-devel openssl-devel libcap
</I>&gt;<i> &gt;     ccache \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libtool-ltdl-devel cppunit cppunit-devel bzr git
</I>&gt;<i> &gt;     autoconf \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     automake libtool gcc-c++ perl-Pod-MinimumVersion
</I>&gt;<i> &gt;     bzip2 ed \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                      make openldap-devel pam-devel db4-devel
</I>&gt;<i> &gt;     libxml2-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libcap-devel screen vim nettle-devel redhat-lsb-core
</I>&gt;<i> &gt;     \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     autoconf-archive libtdb-devel libtdb
</I>&gt;<i> &gt;     redhat-rpm-config rpm-build rpm-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum install -y perl-libwww-perl ruby ruby-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum clean all____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     RUN yum update -y \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum install -y systemd-units openldap-devel pam-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     openssl-devel krb5-devel db4-devel expat-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libxml2-devel libcap-devel libtool
</I>&gt;<i> &gt;     libtool-ltdl-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     redhat-rpm-config libdb-devel
</I>&gt;<i> &gt;     libnetfilter_conntrack-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     gnutls-devel rpmdevtools wget \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  yum clean all____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     For CentOS 8 Stream:____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     RUN dnf install -y epel-release dnf-plugins-core \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf config-manager --set-enabled powertools \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf clean all \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf update -y \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf install -y gcc gcc-c++ libtool libtool-ltdl make cmake
</I>&gt;<i> \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     git pkgconfig sudo automake autoconf yum-utils
</I>&gt;<i> rpm-build \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf install -y libxml2 expat-devel openssl-devel libcap
</I>&gt;<i> ccache \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libtool-ltdl-devel git autoconf \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     automake libtool gcc-c++ bzip2 ed \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     make openldap-devel pam-devel libxml2-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libcap-devel screen vim nettle-devel redhat-lsb-core
</I>&gt;<i> \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libtdb-devel libtdb redhat-rpm-config rpm-build
</I>&gt;<i> rpm-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libnetfilter_conntrack-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf install -y perl-libwww-perl ruby ruby-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf clean all____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __  __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     RUN dnf update -y \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf install -y systemd-units openldap-devel pam-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     openssl-devel krb5-devel expat-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     libxml2-devel libcap-devel libtool
</I>&gt;<i> libtool-ltdl-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     redhat-rpm-config libdb-devel \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;                     gnutls-devel rpmdevtools wget \____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;         &amp;&amp;  dnf clean all____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     ----____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Eliezer Croitoru____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     NgTech, Tech Support____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Mobile: +972-5-28704261____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     *From:* squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>
</I>&gt;<i> &gt;     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;&gt; *On Behalf Of
</I>&gt;<i> &gt;     *Ivan Larionov
</I>&gt;<i> &gt;     *Sent:* Thursday, April 14, 2022 01:34
</I>&gt;<i> &gt;     *To:* <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt;     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> &gt;     *Subject:* [squid-users] squid compilation error in Docker____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Hi.____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     I have no issues building squid normally, but when I try to do
</I>&gt;<i> &gt;     exactly the same steps in docker I'm getting the following
</I>&gt;<i> errors:____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     <A HREF="https://gist.github.com/xeron/5530fe9aa1f5bdcb6a72c6edd6476467">https://gist.github.com/xeron/5530fe9aa1f5bdcb6a72c6edd6476467</A>
</I>&gt;<i> &gt;     &lt;<A HREF="https://gist.github.com/xeron/5530fe9aa1f5bdcb6a72c6edd6476467">https://gist.github.com/xeron/5530fe9aa1f5bdcb6a72c6edd6476467</A>&gt;____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Example from that log:____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     cache_cf.o: In function `configFreeMemory()':____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     /root/build/src/cache_cf.cc:2982: undefined reference to
</I>&gt;<i> &gt;     `Adaptation::Icap::TheConfig'____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     I can't figure out what exactly is wrong. Doesn't look like any
</I>&gt;<i> &gt;     dependencies are missing.
</I>&gt;<i> &gt;     ____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Here's my build script:____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;            yum install -y autoconf automake file gcc72 gcc72-c++ libtool
</I>&gt;<i> &gt;     libtool-ltdl-devel pkgconfig diffutils \
</I>&gt;<i> &gt;              libxml2-devel libcap-devel openssl-devel
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;            autoreconf -ivf
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;            ./configure --program-prefix= --prefix=/usr
</I>&gt;<i> --exec-prefix=/usr \
</I>&gt;<i> &gt;              --bindir=/usr/sbin --sbindir=/usr/sbin
</I>&gt;<i> &gt;     --sysconfdir=/etc/squid \
</I>&gt;<i> &gt;              --libdir=/usr/lib --libexecdir=/usr/lib/squid \
</I>&gt;<i> &gt;              --includedir=/usr/include --datadir=/usr/share/squid \
</I>&gt;<i> &gt;              --sharedstatedir=/usr/com --localstatedir=/var \
</I>&gt;<i> &gt;              --mandir=/usr/share/man --infodir=/usr/share/info \
</I>&gt;<i> &gt;              --enable-epoll --enable-removal-policies=heap,lru \
</I>&gt;<i> &gt;              --enable-storeio=aufs,rock \
</I>&gt;<i> &gt;              --enable-delay-pools --with-pthreads --enable-cache-digests
</I>&gt;<i> \
</I>&gt;<i> &gt;              --with-large-files --with-filedescriptors=65536 \
</I>&gt;<i> &gt;              --enable-htcp
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;            make -j$(nproc) install DESTDIR=$PWD/_destroot____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     Any ideas?____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     __ __
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     -- ____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     With best regards, Ivan Larionov.____
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     _______________________________________________
</I>&gt;<i> &gt;     squid-users mailing list
</I>&gt;<i> &gt;     <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt;     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;<i> &gt;     <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> &gt;     &lt;<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; With best regards, Ivan Larionov.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt; <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

-- 
With best regards, Ivan Larionov.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220413/5d0aa11b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220413/5d0aa11b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024721.html">[squid-users] squid compilation error in Docker
</A></li>
	<LI>Next message (by thread): <A HREF="024724.html">[squid-users] squid compilation error in Docker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24722">[ date ]</a>
              <a href="thread.html#24722">[ thread ]</a>
              <a href="subject.html#24722">[ subject ]</a>
              <a href="author.html#24722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
