<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.8+ intercept
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3C2d361a2d-21b6-fe07-c742-fc7ae2f86f1a%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025102.html">
   <LINK REL="Next"  HREF="025096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.8+ intercept</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3C2d361a2d-21b6-fe07-c742-fc7ae2f86f1a%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] Squid 4.8+ intercept">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Thu Aug 11 21:21:47 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025102.html">[squid-users] Squid 4.8+ intercept
</A></li>
        <LI>Next message (by thread): <A HREF="025096.html">[squid-users] Problem caching range requests with range_offset_limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25105">[ date ]</a>
              <a href="thread.html#25105">[ thread ]</a>
              <a href="subject.html#25105">[ subject ]</a>
              <a href="author.html#25105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/11/22 2:19 PM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> wrote:
&gt;<i> Hey Grant,
</I>
Hi Eliezer,

&gt;<i> The issue is very simple, if squid and the clients sits on the same 
</I>&gt;<i> subnet( not the same network segment) then squid will send the traffic 
</I>&gt;<i> back directly to the client.
</I>
So you're talking about -- what I call -- the TCP triangle problem, 
which can be worked around a number of different ways.

&gt;<i> WCCP is not related to the network level of things and will not 
</I>&gt;<i> resolve this exact same issue in most similar use cases.
</I>
I question the veracity of that statement.

Not the least of which is that WCCP uses GRE as an L2 transport between 
the router and Squid and that Squid sees the packets as the router saw 
them.  What's more is that replies are sent back from Squid via the 
router through said GRE tunnel.  --  This very much seems like network 
level, both layers 2 and 3, to me.

&gt;<i> You should never SNAT traffic from local network to the proxy since 
</I>&gt;<i> you will cause some issue with this.
</I>
Please elaborate on what issues will be caused.

The only issue that I'm aware of is the fact that traffic will appear to 
be from the router, not the original client.  But, depending on how 
things are being used, the lack of real source IP may be perfectly fine. 
  The only thing that I'm aware of where the lack of a real source IP is 
when you are doing things specific to source IP.

Said another way, I'm not aware of any problems with SNATing if none of 
your configuration is dependent on the source IP.

&gt;<i> What you might want to do is to give the proxy a special subnet 
</I>&gt;<i> against the mikrotik and to use policy based routing to forward the 
</I>&gt;<i> clients traffic to the proxy.
</I>&gt;<i> 
</I>&gt;<i> If you can plug the proxy to another port on the Mikrotik device and 
</I>&gt;<i> give it a special subnet it much more preferable.
</I>
Preference does not equate to viability.

&gt;<i> I believe that WCCP is not an option for Mikrotik so unless you have 
</I>&gt;<i> a specific device that supports WCCP, don't bother thinking about it.
</I>
ACK

&gt;<i> Also, in the same breath I can tell you that most commercial services 
</I>&gt;<i> that implement MITM have not been using and are not using WCCP.
</I>
In my opinion, what someone else is doing or not doing has extremely 
little influence on what I do or don't do.

&gt;<i> There are much smarter ways these days then basic WCCP to make sure 
</I>&gt;<i> that the traffic will be passed to the right proxy.
</I>
Please elaborate on such ways, other than PBR.

&gt;<i> Also just take a minute and think: what WCCP gives exactly that a 
</I>&gt;<i> Mikrotik admin cannot do?
</I>
For starters, my understanding is that WCCP can get the traffic to the 
proxy, in any subnet local or remote, without altering the source / 
destination IP address.

&gt;<i> A Mikrotik can be automated in such a way that WCCP would be inferior 
</I>&gt;<i> to what Mikrotik can offer.  (To my knowledge)
</I>
Please elaborate.

I don't see what automation has to do with this discussion.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220811/152edc2d/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220811/152edc2d/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025102.html">[squid-users] Squid 4.8+ intercept
</A></li>
	<LI>Next message (by thread): <A HREF="025096.html">[squid-users] Problem caching range requests with range_offset_limit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25105">[ date ]</a>
              <a href="thread.html#25105">[ thread ]</a>
              <a href="subject.html#25105">[ subject ]</a>
              <a href="author.html#25105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
