<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.8+ intercept
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3CCAFMSmTt71mFhpanDVtKG0Gg6UA74ZAgpnBx5B__01K1Tmu5QLg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025091.html">
   <LINK REL="Next"  HREF="025113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.8+ intercept</H1>
    <B>M K</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3CCAFMSmTt71mFhpanDVtKG0Gg6UA74ZAgpnBx5B__01K1Tmu5QLg%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid 4.8+ intercept">mohammed.khallaf at gmail.com
       </A><BR>
    <I>Sat Aug 13 07:58:46 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025091.html">[squid-users] Squid 4.8+ intercept
</A></li>
        <LI>Next message (by thread): <A HREF="025113.html">[squid-users] Squid 4.8+ intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25112">[ date ]</a>
              <a href="thread.html#25112">[ thread ]</a>
              <a href="subject.html#25112">[ subject ]</a>
              <a href="author.html#25112">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank  you for your quick reply. The text-drawing actually changed with
different font; the squid server is effectively connected to MikroTik
router, not the same physical link as the client.

The MikroTik router sits between the client and squid server.

That said, I can confirm that the MikroTik router is effectively able to
route/DNat client packets going to ports 80 and 443 to squid server.
Depending on router rules be it route or dnat, the client browser
effectively displays the error page of squid, or goes into a very long
delay then failure.

I will retry and let you know.

K

On Wed, Aug 10, 2022, 10:08 &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; wrote:

&gt;<i> Hey K,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I am not sure about the network topology.
</I>&gt;<i>
</I>&gt;<i> Preferably the Squid should reside on another network then the clients if
</I>&gt;<i> it&#8217;s intercepting the traffic.
</I>&gt;<i>
</I>&gt;<i> Also, I assume it&#8217;s not a TPROXY setup so it should be pretty simple and
</I>&gt;<i> straight forward.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I understand why are you asking this question.
</I>&gt;<i>
</I>&gt;<i> Also take into account that Mikrotik is now on 7.4 firmware and it&#8217;s
</I>&gt;<i> recommended to use this one.
</I>&gt;<i>
</I>&gt;<i> If you are using any other version let me know so I can try to make sense
</I>&gt;<i> on the differences.
</I>&gt;<i>
</I>&gt;<i> I will try to give a DEMO for such a setup and how to make it work.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Eliezer
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----
</I>&gt;<i>
</I>&gt;<i> Eliezer Croitoru
</I>&gt;<i>
</I>&gt;<i> NgTech, Tech Support
</I>&gt;<i>
</I>&gt;<i> Mobile: +972-5-28704261
</I>&gt;<i>
</I>&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
</I>&gt;<i>
</I>&gt;<i> Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
</I>&gt;<i>
</I>&gt;<i> My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; *On
</I>&gt;<i> Behalf Of *M K
</I>&gt;<i> *Sent:* Tuesday, 9 August 2022 22:29
</I>&gt;<i> *To:* <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> *Subject:* [squid-users] Squid 4.8+ intercept
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have a setup like this one:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> | Client | =====&gt; | Router | =====&gt; Internet
</I>&gt;<i>                      ||
</I>&gt;<i>                      \/
</I>&gt;<i>                   | Squid |
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ...the router is a Mikrotik router capable of all things NAT/Redirect and
</I>&gt;<i> whatnot. Squid server has only one network interface.
</I>&gt;<i>
</I>&gt;<i> Using the router:
</I>&gt;<i>
</I>&gt;<i> - I tried routing traffic to squid server IP.
</I>&gt;<i>
</I>&gt;<i> - I tried destination-NATing from client to server IP, with origin server
</I>&gt;<i> IP-and-port natted to squid IP-and-port, and with origin server IP-only
</I>&gt;<i> natted to squid-IP.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have been struggling for 2 days to setup a working Squid 4.8 or higher
</I>&gt;<i> interception.
</I>&gt;<i>
</I>&gt;<i> Test server is running Ubuntu 18.4.3 and Squid 4.8.
</I>&gt;<i>
</I>&gt;<i> Documentation is either too much trim or extremely outdated.
</I>&gt;<i>
</I>&gt;<i> Any help would be very much appreciated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All best,
</I>&gt;<i>
</I>&gt;<i> K
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220813/931a94d2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220813/931a94d2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025091.html">[squid-users] Squid 4.8+ intercept
</A></li>
	<LI>Next message (by thread): <A HREF="025113.html">[squid-users] Squid 4.8+ intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25112">[ date ]</a>
              <a href="thread.html#25112">[ thread ]</a>
              <a href="subject.html#25112">[ subject ]</a>
              <a href="author.html#25112">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
