<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 4.8+ intercept
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3C001401d8af3e%24392663c0%24ab732b40%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025112.html">
   <LINK REL="Next"  HREF="025123.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 4.8+ intercept</H1>
    <B>ngtech1ltd at gmail.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%204.8%2B%20intercept&In-Reply-To=%3C001401d8af3e%24392663c0%24ab732b40%24%40gmail.com%3E"
       TITLE="[squid-users] Squid 4.8+ intercept">ngtech1ltd at gmail.com
       </A><BR>
    <I>Sat Aug 13 17:57:57 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025112.html">[squid-users] Squid 4.8+ intercept
</A></li>
        <LI>Next message (by thread): <A HREF="025123.html">[squid-users] Squid 4.8+ intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25113">[ date ]</a>
              <a href="thread.html#25113">[ thread ]</a>
              <a href="subject.html#25113">[ subject ]</a>
              <a href="author.html#25113">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey K,
 
What RouterOS version are you using?
Also, what rules have you applied?
If there is a very long delay and then a failure you should verify that the rules you wrote are proper to your environment.
You should route packets based on connection marks and mark only new connections from LAN IP addresses and only on the LAN interface.
As I showed in the demo video it&#8217;s very simple to implement.
 
Let me know if you are still having issues.
 
Eliezer
 
----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 
Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>
 
From: M K &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">mohammed.khallaf at gmail.com</A>&gt; 
Sent: Saturday, 13 August 2022 10:59
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid 4.8+ intercept
 
Thank  you for your quick reply. The text-drawing actually changed with different font; the squid server is effectively connected to MikroTik router, not the same physical link as the client.
 
The MikroTik router sits between the client and squid server.
 
That said, I can confirm that the MikroTik router is effectively able to route/DNat client packets going to ports 80 and 443 to squid server. Depending on router rules be it route or dnat, the client browser effectively displays the error page of squid, or goes into a very long delay then failure.
 
I will retry and let you know.
 
K
On Wed, Aug 10, 2022, 10:08 &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; &gt; wrote:
Hey K,
 
I am not sure about the network topology.
Preferably the Squid should reside on another network then the clients if it&#8217;s intercepting the traffic.
Also, I assume it&#8217;s not a TPROXY setup so it should be pretty simple and straight forward.
 
I understand why are you asking this question.
Also take into account that Mikrotik is now on 7.4 firmware and it&#8217;s recommended to use this one.
If you are using any other version let me know so I can try to make sense on the differences.
I will try to give a DEMO for such a setup and how to make it work.
 
Eliezer
 
----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 
Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>
 
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; &gt; On Behalf Of M K
Sent: Tuesday, 9 August 2022 22:29
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; 
Subject: [squid-users] Squid 4.8+ intercept
 
Hello,
 
I have a setup like this one:

|<i> Client | =====&gt; | Router | =====&gt; Internet
</I>                     ||
                     \/
                  | Squid |
 
...the router is a Mikrotik router capable of all things NAT/Redirect and whatnot. Squid server has only one network interface.
Using the router:
- I tried routing traffic to squid server IP.
- I tried destination-NATing from client to server IP, with origin server IP-and-port natted to squid IP-and-port, and with origin server IP-only natted to squid-IP.
 
I have been struggling for 2 days to setup a working Squid 4.8 or higher interception.
Test server is running Ubuntu 18.4.3 and Squid 4.8.
Documentation is either too much trim or extremely outdated.
Any help would be very much appreciated.
 
All best,
K
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220813/54a6cf99/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220813/54a6cf99/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025112.html">[squid-users] Squid 4.8+ intercept
</A></li>
	<LI>Next message (by thread): <A HREF="025123.html">[squid-users] Squid 4.8+ intercept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25113">[ date ]</a>
              <a href="thread.html#25113">[ thread ]</a>
              <a href="subject.html#25113">[ subject ]</a>
              <a href="author.html#25113">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
