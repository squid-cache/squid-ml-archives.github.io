<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to enable squid to use more server resources when using 500+ http_ports?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20enable%20squid%20to%20use%20more%20server%20resources%0A%20when%20using%20500%2B%20http_ports%3F&In-Reply-To=%3C91d50e0c-360c-c235-7202-41810c20ace2%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025145.html">
   <LINK REL="Next"  HREF="025153.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to enable squid to use more server resources when using 500+ http_ports?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20enable%20squid%20to%20use%20more%20server%20resources%0A%20when%20using%20500%2B%20http_ports%3F&In-Reply-To=%3C91d50e0c-360c-c235-7202-41810c20ace2%40measurement-factory.com%3E"
       TITLE="[squid-users] How to enable squid to use more server resources when using 500+ http_ports?">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Aug 29 13:05:06 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025145.html">[squid-users] How to enable squid to use more server resources when using 500+ http_ports?
</A></li>
        <LI>Next message (by thread): <A HREF="025153.html">[squid-users] How to enable squid to use more server resources when using 500+ http_ports?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25146">[ date ]</a>
              <a href="thread.html#25146">[ thread ]</a>
              <a href="subject.html#25146">[ subject ]</a>
              <a href="author.html#25146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/29/22 02:06, Marcelo wrote:

&gt;<i> I have a server with large resources ( RAM, CPU, etc) running Ubuntu 20.04.
</I>&gt;<i> 
</I>&gt;<i> When I put squid 4.13 to manage more than 500 http_ports, it performs 
</I>&gt;<i> very slowly.
</I>&gt;<i> 
</I>&gt;<i> Question is, how can I setup Squid or Ubuntu to use more hw resources in 
</I>&gt;<i> order to perform better?
</I>
To make Squid perform better you need to identify and address the 
current bottleneck. You are implying that the current bottleneck is tied 
to the number of http_ports. If that is true, it is probably possible to 
optimize Squid to handle the large number of listening ports better. 
What makes you think that the number of http_ports is the culprit?

What CPU usage do you see for each Squid kid process during high load? 
What percentage of RAM is used during those times?

FWIW, as you already know from past squid-users emails, I am not aware 
of any linear scans of http_ports in modern Squids that could 
significantly affect runtime performance. That does not mean such linear 
scans do not exist, of course. However, I bet the real problem is elsewhere.


HTH,

Alex.


&gt;<i> Or does it a matter of software architecture limitation?
</I>&gt;<i> 
</I>&gt;<i> Perform well with at least 500 http_ports would be very nice so we can 
</I>&gt;<i> use smaller numbers of VPSs.
</I>&gt;<i> 
</I>&gt;<i> Its hard to manage so many of it.
</I>&gt;<i> It would be a dream to have like 10k http_ports in a single server.
</I>&gt;<i> 
</I>&gt;<i> If it is not possible, is there any planning about do it in a future?
</I>&gt;<i> 
</I>&gt;<i> Tks
</I>&gt;<i> Marcelo.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025145.html">[squid-users] How to enable squid to use more server resources when using 500+ http_ports?
</A></li>
	<LI>Next message (by thread): <A HREF="025153.html">[squid-users] How to enable squid to use more server resources when using 500+ http_ports?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25146">[ date ]</a>
              <a href="thread.html#25146">[ thread ]</a>
              <a href="subject.html#25146">[ subject ]</a>
              <a href="author.html#25146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
