<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.2%20TCP_MISS_ABORTED/100%20erros%20when%0A%20uploading&In-Reply-To=%3CCAEJ1g5KbMxwiT-XQxR-8cQuPMQH4kMYJn8uZKZ9M7by3j3eKdw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025143.html">
   <LINK REL="Next"  HREF="025148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading</H1>
    <B>David Ferreira</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.2%20TCP_MISS_ABORTED/100%20erros%20when%0A%20uploading&In-Reply-To=%3CCAEJ1g5KbMxwiT-XQxR-8cQuPMQH4kMYJn8uZKZ9M7by3j3eKdw%40mail.gmail.com%3E"
       TITLE="[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading">davidtiagoff at gmail.com
       </A><BR>
    <I>Mon Aug 29 13:31:03 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025143.html">[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading
</A></li>
        <LI>Next message (by thread): <A HREF="025148.html">[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25147">[ date ]</a>
              <a href="thread.html#25147">[ thread ]</a>
              <a href="subject.html#25147">[ subject ]</a>
              <a href="author.html#25147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Amos,

Thank you for the reply,

here's my squid.conf, by default our client's(localnet) do not have
internet access and only match windows services acl's unless they are in
authorizednet.conf, in this case that's the only match acl for the clients
using this application, i also removed some of the includes i have, it's
mostly random src to random dstdomain, the clients in question do not match
this acl's at all.

---
squid 4.15 squid.conf:
---

logformat timereadable %tl %6tr %&gt;a %Ss/%03Hs %&lt;st %rm %ru %un %Sh/%&lt;A %mt
access_log daemon:/var/log/squid/access.log timereadable

acl localnet src 10.0.0.0/8     # RFC1918 possible internal network
acl localnet src 172.16.0.0/12  # RFC1918 possible internal network
acl localnet src 192.168.0.0/16 # RFC1918 possible internal network
acl localnet src fc00::/7       # RFC 4193 local private network range
acl localnet src fe80::/10      # RFC 4291 link-local (directly plugged)
machines

include /etc/squid/acls/authorizednet.conf

acl SSL_ports port 443
acl SSL_ports port 8080
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl FTP_ports port 21 1025-65535
acl CONNECT method CONNECT

###BlockLists
include /etc/squid/acls/blocklists-remotes.conf
###Microsoft ATP
include /etc/squid/acls/atp.conf
###Windows Activation
include /etc/squid/acls/wactivate.conf
###No Windows Update
include /etc/squid/acls/nowupdate.conf
###Windows Update
include /etc/squid/acls/wupdate.conf

http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

http_access allow localhost manager
http_access deny manager

http_access allow authorizednet
http_access allow localhost

http_access deny all

http_port 3128

cache_dir ufs /var/spool/squid 50000 16 256

coredump_dir /var/spool/squid

refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320
max_filedesc 65535

maximum_object_size 10000 MB
range_offset_limit 10000 MB windowsupdate
quick_abort_min -1

refresh_pattern -i
microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200
reload-into-ims
refresh_pattern -i
windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80%
43200 reload-into-ims
refresh_pattern -i
windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200
reload-into-ims

---
And here's squid 5.2 squid.conf, it's pretty much the same:
---

logformat timereadable %tl %6tr %&gt;a %Ss/%03Hs %&lt;st %rm %ru %un %Sh/%&lt;A %mt
access_log daemon:/var/log/squid/access.log timereadable
debug_options ALL,1 33,2 28,9

acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 &quot;this&quot; network (LAN)
acl localnet src 10.0.0.0/8             # RFC 1918 local private network
(LAN)
acl localnet src 100.64.0.0/10          # RFC 6598 shared address space
(CGN)
acl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly
plugged) machines
acl localnet src 172.16.0.0/12          # RFC 1918 local private network
(LAN)
acl localnet src 192.168.0.0/16         # RFC 1918 local private network
(LAN)
acl localnet src fc00::/7               # RFC 4193 local private network
range
acl localnet src fe80::/10              # RFC 4291 link-local (directly
plugged) machines

include /etc/squid/acls/authorizednet.conf

acl SSL_ports port 443
acl SSL_ports port 8080
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl FTP_ports port 21 1025-65535

###BlockLists
include /etc/squid/acls/blocklists-remotes.conf
###Microsoft ATP
include /etc/squid/acls/atp.conf
###Windows Activation
include /etc/squid/acls/wactivate.conf
###No Windows Update
include /etc/squid/acls/nowupdate.conf
###Windows Update
include /etc/squid/acls/wupdate.conf

http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

http_access allow localhost manager
http_access deny manager

http_access allow authorizednet
http_access allow localhost

http_access deny all

http_port 3128

cache_dir ufs /var/spool/squid 50000 16 256

coredump_dir /var/spool/squid

refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320

maximum_object_size 10000 MB
range_offset_limit 10000 MB windowsupdate
quick_abort_min -1

refresh_pattern -i
microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200
reload-into-ims
refresh_pattern -i
windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80%
43200 reload-into-ims
refresh_pattern -i
windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 4320 80% 43200
reload-into-ims


As for squid rocky linux packages information, here is the links:
Rocky 8 :
<A HREF="https://almalinux.pkgs.org/8/almalinux-appstream-x86_64/squid-4.15-3.module_el8.6.0+3010+383bc947.1.x86_64.rpm.html">https://almalinux.pkgs.org/8/almalinux-appstream-x86_64/squid-4.15-3.module_el8.6.0+3010+383bc947.1.x86_64.rpm.html</A>
Rocky 9 :
<A HREF="https://almalinux.pkgs.org/9/almalinux-appstream-x86_64/squid-5.2-1.el9_0.1.x86_64.rpm.html">https://almalinux.pkgs.org/9/almalinux-appstream-x86_64/squid-5.2-1.el9_0.1.x86_64.rpm.html</A>

Thank you!


On Mon, 29 Aug 2022 at 13:36, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt; wrote:

&gt;<i> On 29/08/22 22:17, David Ferreira wrote:
</I>&gt;<i> &gt; hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; First time using mailing lists, sorry about anything.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Welcome, and thanks for using Squid.
</I>&gt;<i>
</I>&gt;<i> Do not worry about mistakes. Helping with that type of thing is what
</I>&gt;<i> this list is here for whether expert or beginner.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Squid 4.15:
</I>&gt;<i> &gt; 26/Aug/2022:15:36:08 +0100    273 172.19.222.132TCP_MISS/200 745 POST
</I>&gt;<i> &gt; <A HREF="http://websiteurl/index.php">http://websiteurl/index.php</A> &lt;<A HREF="http://websiteurl/index.php">http://websiteurl/index.php</A>&gt; -
</I>&gt;<i> &gt; HIER_DIRECT/websitedomain text/xml
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Squid 5.2:
</I>&gt;<i> &gt; 25/Aug/2022:15:10:00 +0100    139 172.19.222.132 TCP_MISS_ABORTED/100 0
</I>&gt;<i> &gt; POST <A HREF="http://websiteurl">http://websiteurl</A> &lt;<A HREF="http://websiteurl">http://websiteurl</A>&gt;/index.php -
</I>&gt;<i> &gt; HIER_DIRECT/websitedomain -
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; anyone has an ideia of what may be happening here?, been searching about
</I>&gt;<i> &gt; http errors 100 and so far i did not find anything that points me to the
</I>&gt;<i> &gt; problem.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On the application side the error it shows when it tries to upload is:
</I>&gt;<i> &gt; &quot;
</I>&gt;<i> &gt; Error storing the document on the server
</I>&gt;<i> &gt; Detail HTTP error 100
</I>&gt;<i> &gt; Send failure: Connection was aborted (55)
</I>&gt;<i> &gt; &quot;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> This is very odd.
</I>&gt;<i>
</I>&gt;<i>   * The &quot;ABORTED&quot; tag hints strongly that the client closed the
</I>&gt;<i> connection here.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>   * Status code &quot;100 Continue&quot; is a normal part of HTTP/1.1.
</I>&gt;<i>
</I>&gt;<i> There is something wrong with the client application to be reporting
</I>&gt;<i> that as an error code at all. Likely that bug is what triggered the abort.
</I>&gt;<i>
</I>&gt;<i>   * The difference in result between Squid v4 and v5 is also extremely
</I>&gt;<i> odd. I do not think handling of status 100 had any significant changes
</I>&gt;<i> since the Squid-3 days.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Can you show us your config for both versions?
</I>&gt;<i>   Omit lines that are commented out to reduce the sizes.
</I>&gt;<i>   Take care to obscure private details while keeping it clear that
</I>&gt;<i> detail A and B are different (eg don't use same symbol X for replacing
</I>&gt;<i> both).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Also FME, where can I/we find details of the Rocky Squid packages?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>

-- 
Com os melhores cumprimentos,

David Ferreira
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220829/c844365c/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220829/c844365c/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025143.html">[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading
</A></li>
	<LI>Next message (by thread): <A HREF="025148.html">[squid-users] Squid 5.2 TCP_MISS_ABORTED/100 erros when uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25147">[ date ]</a>
              <a href="thread.html#25147">[ thread ]</a>
              <a href="subject.html#25147">[ subject ]</a>
              <a href="author.html#25147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
