<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] MITM the MITM
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20MITM%20the%20MITM&In-Reply-To=%3C730f0320-8ec5-db56-13a2-35ebd405f09b%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024372.html">
   <LINK REL="Next"  HREF="024384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] MITM the MITM</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20MITM%20the%20MITM&In-Reply-To=%3C730f0320-8ec5-db56-13a2-35ebd405f09b%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] MITM the MITM">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Thu Jan  6 17:33:17 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024372.html">[squid-users] MITM the MITM
</A></li>
        <LI>Next message (by thread): <A HREF="024384.html">[squid-users] MITM the MITM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24381">[ date ]</a>
              <a href="thread.html#24381">[ thread ]</a>
              <a href="subject.html#24381">[ subject ]</a>
              <a href="author.html#24381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/4/22 2:35 AM, Will BMD wrote:
&gt;<i> HTTP proxy limitation
</I>&gt;<i> 
</I>&gt;<i> The system cannot decrypt traffic if an HTTP proxy is positioned 
</I>&gt;<i> between a client and your managed device, and the client and server 
</I>&gt;<i> establish a tunneled TLS/SSL connection using the CONNECT HTTP 
</I>&gt;<i> method. The Handshake Errors undecryptable action determines how the 
</I>&gt;<i> system handles this traffic.
</I>
I ... don't know what to make of this.  I would have some questions for 
the vendor (Cisco).

This sort of hints at a technical limitation that the Cisco FTDv /might/ 
have.  It sounds to me like the firewall might be able to pretend to be 
a web server via interception of some sort, but that it can't handle 
HTTP's CONNECT verb which is common to sue on proxies particularly for 
HTTPS connections.

I'm fairly certain that Squid /does/ support bumping such CONNECT requests.

This also hints at /needing/ ~&gt; /requiring/ the downstream client 
devices to /not/ be configured to use the firewall as a proxy.  Because 
if the clients are configured to use the firewall as a proxy, they will 
inherently issue CONNECT requests.

More questions.  This itches like a limitation.

It also /really/ seems to me like Squid /should/ be able to work behind 
this as long as it has the proper public root certificate that is used 
to support the (re)signing.

&gt;<i> Okay, what if we removed the firewall and replaced it with another 
</I>&gt;<i> squid proxy server, where that is also doing ssl_bump. I assume this 
</I>&gt;<i> would work but are there negative implications of doing so?
</I>
I would /expect/ that two Squid servers could work in this type of 
configuration.  It's my understanding that Squid has support for parent 
/ child proxy hierarchies that would apply to this.  Even if it did not, 
I think that two simple ssl_bump Squid servers /should/ work with each 
other.  Proper certificate trust configuration not withstanding.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220106/3bdf1d6b/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220106/3bdf1d6b/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024372.html">[squid-users] MITM the MITM
</A></li>
	<LI>Next message (by thread): <A HREF="024384.html">[squid-users] MITM the MITM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24381">[ date ]</a>
              <a href="thread.html#24381">[ thread ]</a>
              <a href="subject.html#24381">[ subject ]</a>
              <a href="author.html#24381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
