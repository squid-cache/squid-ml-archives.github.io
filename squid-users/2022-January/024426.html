<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%204.17%20and%205.3%20SSL%20BUMP%20issue%3A%0A%20SSL_ERROR_RX_RECORD_TOO_LONG&In-Reply-To=%3C1ad648ca-ccbf-a1c5-e209-02f520d4c1cd%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024425.html">
   <LINK REL="Next"  HREF="024427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%204.17%20and%205.3%20SSL%20BUMP%20issue%3A%0A%20SSL_ERROR_RX_RECORD_TOO_LONG&In-Reply-To=%3C1ad648ca-ccbf-a1c5-e209-02f520d4c1cd%40measurement-factory.com%3E"
       TITLE="[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Jan 24 14:54:13 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024425.html">[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG
</A></li>
        <LI>Next message (by thread): <A HREF="024427.html">[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24426">[ date ]</a>
              <a href="thread.html#24426">[ thread ]</a>
              <a href="subject.html#24426">[ subject ]</a>
              <a href="author.html#24426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/24/22 2:42 AM, Eliezer Croitoru wrote:
&gt;<i> 2022/01/24 09:11:20 kid1| SECURITY ALERT: Host header forgery detected on
</I>&gt;<i> local=142.250.179.228:443 remote=10.200.191.171:51831 FD 16 flags=33 (local
</I>&gt;<i> IP does not match any domain IP)
</I>
As you know, Squid improvements related to these messages have been
discussed many times. I bet the ideas summarized in the following old
email remain valid today:

<A HREF="http://lists.squid-cache.org/pipermail/squid-users/2019-July/020764.html">http://lists.squid-cache.org/pipermail/squid-users/2019-July/020764.html</A>


If you would like to address browser's SSL_ERROR_RX_RECORD_TOO_LONG
specifically (the error in your email Subject line), then that is a
somewhat different matter: According to your packet capture, Squid sends
a plain text HTTP 409 response to a TLS client. That is not going to
work with popular browsers (for various technical and policy reasons).

Depending on the SslBump stage where the Host header forgery was
detected, Squid could bump the client connection to deliver that error
response; in that case, the browser may still refuse to show the
response to the user because the browser will not trust the certificate
that Squid would have to fake without sufficient origin server info.
However, the browser error will be different and arguably less confusing
to admins and even users.

<A HREF="https://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F">https://wiki.squid-cache.org/SquidFaq/AboutSquid#How_to_add_a_new_Squid_feature.2C_enhance.2C_of_fix_something.3F</A>


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024425.html">[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG
</A></li>
	<LI>Next message (by thread): <A HREF="024427.html">[squid-users] 4.17 and 5.3 SSL BUMP issue: SSL_ERROR_RX_RECORD_TOO_LONG
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24426">[ date ]</a>
              <a href="thread.html#24426">[ thread ]</a>
              <a href="subject.html#24426">[ subject ]</a>
              <a href="author.html#24426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
