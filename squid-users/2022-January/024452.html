<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid url_rewrite_program how to return a kind of TCP reset
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20url_rewrite_program%20how%20to%20return%20a%20kind%20of%0A%20TCP%20reset&In-Reply-To=%3CCABA8h%3DTwEZihPG13TUyOevE0YVHCHU9Ufx%2BPtwac1nX6yMaCeA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024459.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid url_rewrite_program how to return a kind of TCP reset</H1>
    <B>NgTech LTD</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%20url_rewrite_program%20how%20to%20return%20a%20kind%20of%0A%20TCP%20reset&In-Reply-To=%3CCABA8h%3DTwEZihPG13TUyOevE0YVHCHU9Ufx%2BPtwac1nX6yMaCeA%40mail.gmail.com%3E"
       TITLE="[squid-users] squid url_rewrite_program how to return a kind of TCP reset">ngtech1ltd at gmail.com
       </A><BR>
    <I>Mon Jan 31 04:27:34 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024459.html">[squid-users] squid url_rewrite_program how to return a kind of TCP reset
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24452">[ date ]</a>
              <a href="thread.html#24452">[ thread ]</a>
              <a href="subject.html#24452">[ subject ]</a>
              <a href="author.html#24452">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You can try to use deny_info with a customized error page template or an
icap service that will respond with a different page.
I think that redirecting to an external website is a good choice.
Many commercial products use this technique.
If you want the traffic of this website to be bypassed from squid you can
also do that with couple iptables lines.

All The Bests,
Eliezer

&#1489;&#1514;&#1488;&#1512;&#1497;&#1498; &#1497;&#1493;&#1501; &#1489;&#1523;, 31 &#1489;&#1497;&#1504;&#1493;&#1523; 2022, 2:21, &#1502;&#1488;&#1514; David Touzeau &#8207;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">david at articatech.com</A>
&gt;:<i>
</I>
&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> I have built my own squid url_rewrite_program
</I>&gt;<i>
</I>&gt;<i> protocol requires answering with
</I>&gt;<i>
</I>&gt;<i> # OK status=301|302 url=
</I>&gt;<i> Or
</I>&gt;<i> # OK rewrite-url=&quot;<A HREF="http://blablaba">http://blablaba</A>&quot; &lt;<A HREF="http://blablaba">http://blablaba</A>&gt;
</I>&gt;<i>
</I>&gt;<i> In my case, especially for trackers/ads i would like to say to browsers:
</I>&gt;<i> &quot;Go away !&quot; without need them to redirect.
</I>&gt;<i>
</I>&gt;<i> Sure i can use these methods but...
</I>&gt;<i>
</I>&gt;<i> 1) 127.0.0.1 - browser is in charge of getting out
</I>&gt;<i> ----------------------------------------------------------------
</I>&gt;<i> OK status=302 url=&quot;<A HREF="http://127.0.0.1">http://127.0.0.1</A>&quot; &lt;<A HREF="http://127.0.0.1">http://127.0.0.1</A>&gt; But this ain't
</I>&gt;<i> clean or polished.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2) 127.0.0.1 - Squid is in charge of getting out
</I>&gt;<i> ----------------------------------------------------------------
</I>&gt;<i> OK rewrite-url=&quot;<A HREF="http://127.0.0.1">http://127.0.0.1</A>&quot; &lt;<A HREF="http://127.0.0.1">http://127.0.0.1</A>&gt; But this very very
</I>&gt;<i> ain't clean or polished.
</I>&gt;<i> Squid claim in logs for an unreachable URL and pollute events
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 3) Redirect to a dummy page with a deny acl
</I>&gt;<i> ----------------------------------------------------------------
</I>&gt;<i> OK status=302 url=&quot;<A HREF="http://dummy.com">http://dummy.com</A>&quot; &lt;<A HREF="http://dummy.com">http://dummy.com</A>&gt;
</I>&gt;<i> acl dummy dstdomain dummy.com
</I>&gt;<i> http_access deny dummy
</I>&gt;<i> deny_info TCP_RESET dummy
</I>&gt;<i>
</I>&gt;<i> But it makes 2 connections to the squid for just stopping queries.
</I>&gt;<i> It seems not really optimized.
</I>&gt;<i>
</I>&gt;<i> I notice that for several reasons i cannot switch to an external_acl
</I>&gt;<i>
</I>&gt;<i> Is there a way / idea ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220131/5c7a6c41/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220131/5c7a6c41/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024459.html">[squid-users] squid url_rewrite_program how to return a kind of TCP reset
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24452">[ date ]</a>
              <a href="thread.html#24452">[ thread ]</a>
              <a href="subject.html#24452">[ subject ]</a>
              <a href="author.html#24452">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
