<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] How to &quot;active&quot; update NetDB informations ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20%22active%22%20update%20NetDB%20informations%20%3F&In-Reply-To=%3Ce1fb81b3-554f-0061-8c98-62876dad26d5%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024936.html">
   <LINK REL="Next"  HREF="024939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] How to &quot;active&quot; update NetDB informations ?</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20How%20to%20%22active%22%20update%20NetDB%20informations%20%3F&In-Reply-To=%3Ce1fb81b3-554f-0061-8c98-62876dad26d5%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] How to &quot;active&quot; update NetDB informations ?">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Fri Jul  1 20:38:48 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024936.html">[squid-users] How to &quot;active&quot; update NetDB informations ?
</A></li>
        <LI>Next message (by thread): <A HREF="024939.html">[squid-users] Reverse Proxy for Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24937">[ date ]</a>
              <a href="thread.html#24937">[ thread ]</a>
              <a href="subject.html#24937">[ subject ]</a>
              <a href="author.html#24937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/1/22 8:22 AM, Th&#233;o BARRAGUE wrote:
&gt;<i> If *link a*&#160;slows down, the RTT will increase and *squid*&#160;will send all 
</I>&gt;<i> requests to *squid b*&#160;because his RTT is low.
</I>&gt;<i> But, if *link a*&#160;come back and with a lower RTT than *squid b*, *squid 
</I>&gt;<i> a*&#160;will never know because no requests are made to him until RTT on 
</I>&gt;<i> *squid b*&#160;goes up ( upper than the &quot;uppest&quot; / &quot;oldest&quot; RTT of *squid a*&#160;).
</I>&gt;<i> 
</I>&gt;<i> How to deal with this scenario ?
</I>
I have no idea if this will help you or not but this problem seems 
reminiscent of DNS servers (e.g. BIND/named) deal with multiple 
potential servers.

My loose understanding is that BIND/named will /artificially/ alter the 
cached RTT /explicitly/ to make sure that abnormally high / low values 
don't negatively impact things.  I think there are a couple of ways to 
do this:

1)  Artificially decrease the RTT incrementally or based on it's age 
(last seen) so that an originally high RTT value lowers enough that it 
becomes a candidate to be used again.  --  If it turns out that the RTT 
still really is high then the RTT will get updated back to it's high 
value and thus depreffed.

2)  Artificially increase the RTT incrementally, perhaps one point per 
test, so that the originally low RTT value raises enough that is higher 
than the other candidate, thus deprefed.

This turns into a balancing game, artificially adjust the RTT so that a 
system is (not) chosen thereby choosing the other system, which updates 
the values.

I think which method is used is probably based on what works best in the 
code.

But one of these should cause some small portion of traffic to go to the 
deprefed server explicitly to keep it's RTT up to date.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220701/2c6ad551/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220701/2c6ad551/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024936.html">[squid-users] How to &quot;active&quot; update NetDB informations ?
</A></li>
	<LI>Next message (by thread): <A HREF="024939.html">[squid-users] Reverse Proxy for Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24937">[ date ]</a>
              <a href="thread.html#24937">[ thread ]</a>
              <a href="subject.html#24937">[ subject ]</a>
              <a href="author.html#24937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
