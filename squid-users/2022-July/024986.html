<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] how to put the destination ip to an external acl helper ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20how%20to%20put%20the%20destination%20ip%20to%20an%20external%20acl%0A%20helper%20%3F&In-Reply-To=%3C592cb5e3-6c14-c3db-e6da-ced6d56f4260%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024985.html">
   <LINK REL="Next"  HREF="024987.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] how to put the destination ip to an external acl helper ?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20how%20to%20put%20the%20destination%20ip%20to%20an%20external%20acl%0A%20helper%20%3F&In-Reply-To=%3C592cb5e3-6c14-c3db-e6da-ced6d56f4260%40measurement-factory.com%3E"
       TITLE="[squid-users] how to put the destination ip to an external acl helper ?">rousskov at measurement-factory.com
       </A><BR>
    <I>Wed Jul 20 13:10:56 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024985.html">[squid-users] how to put the destination ip to an external acl helper ?
</A></li>
        <LI>Next message (by thread): <A HREF="024987.html">[squid-users] fool windows into thinking it has internet access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24986">[ date ]</a>
              <a href="thread.html#24986">[ thread ]</a>
              <a href="subject.html#24986">[ subject ]</a>
              <a href="author.html#24986">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/19/22 08:05, Dieter Bloms wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I wrote a little external acl helper and want squid to put the
</I>&gt;<i> destination fqdn _and_ the destination ip to it.
</I>&gt;<i> 
</I>&gt;<i> I found the parameter %DST and this is filled with the destination fqdn.
</I>&gt;<i> 
</I>&gt;<i> Is there also a parameter for the destination ip squid want's to connect to ?
</I>
To answer your exact question, no, there is not. Until Squid actually 
starts connecting to a cache_peer or origin server, it does not know the 
destination IP(s). Those addresses become known only in the process of 
finding the right destination(s), resolving their names, determining 
whether to use IPv4 or IPv6, and establishing (or reusing) a TCP 
connection to the chosen IP address. Until then, %&lt;a is not available.

I am not sure what the first squid.conf directive (with slow ACLs 
support) &quot;guaranteed&quot; to have filled %&lt;a is. There is probably one 
before http_reply_access, but the exact directive depends on your 
configuration/environment.

Most likely, we should add configuration directive(s) (with slow ACLs 
support) that are applied soon after the IP address becomes known. One 
of them could be used, for example, to reject chosen destination IP 
addresses before Squid starts using them.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024985.html">[squid-users] how to put the destination ip to an external acl helper ?
</A></li>
	<LI>Next message (by thread): <A HREF="024987.html">[squid-users] fool windows into thinking it has internet access
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24986">[ date ]</a>
              <a href="thread.html#24986">[ thread ]</a>
              <a href="subject.html#24986">[ subject ]</a>
              <a href="author.html#24986">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
