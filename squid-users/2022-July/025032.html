<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] adding cache_control = nocache to http request using squid transparent proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20adding%20cache_control%20%3D%20nocache%20to%20http%20request%0A%20using%20squid%20transparent%20proxy&In-Reply-To=%3C000301d8a33f%24dbee14f0%2493ca3ed0%24%40plciq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025031.html">
   <LINK REL="Next"  HREF="025035.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] adding cache_control = nocache to http request using squid transparent proxy</H1>
    <B>muhanad at plciq.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20adding%20cache_control%20%3D%20nocache%20to%20http%20request%0A%20using%20squid%20transparent%20proxy&In-Reply-To=%3C000301d8a33f%24dbee14f0%2493ca3ed0%24%40plciq.com%3E"
       TITLE="[squid-users] adding cache_control = nocache to http request using squid transparent proxy">muhanad at plciq.com
       </A><BR>
    <I>Fri Jul 29 11:39:20 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025031.html">[squid-users] adding cache_control = nocache to http request using squid transparent proxy
</A></li>
        <LI>Next message (by thread): <A HREF="025035.html">[squid-users] adding cache_control = nocache to http request using squid transparent proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25032">[ date ]</a>
              <a href="thread.html#25032">[ thread ]</a>
              <a href="subject.html#25032">[ subject ]</a>
              <a href="author.html#25032">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I apologize for my late reply. I guess I wasn't fully clear about my reason
for why I need to stop the contents from being cached. 
First, here in Iraq the internet service is extremely expensive for ISP to
provide services for home users. 
The ISP usually pay 25$ per 1Mbit/sec of bandwidth to the government on the
other hand the end users expect to pay 2$ per 1Mbit/sec. so the ISPs need to
rely heavily on caching and CDNs. Most of CDN companies hesitate heavily
before operating their services in Iraq and most of ISPs can't provide the
infrastructure for CDN operations ( namely high bandwidth required by CDN
vendors such us Akamai, CDN77, etc. ) this led us to make our company
specialized in providing caching and CDN traffic for ISPs. 
The issue we are facing here is some of the CDNs we have provide cacheable
HTTP content, the ISPs that use our services just cache these contents on
their local cache engines thus their traffic consumption from our CDNs will
drop significantly causing us huge revenue losses because the CDN is still
consuming bandwidth and minimal bandwidth. For this I am asking is there a
way by using transparent Squid proxy to turn this cacheable content to
non-cacheable one?.

Thanks in Advance 

Regards
Muhanad Abdullah

-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>
Sent: Thursday, July 28, 2022 3:00 PM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: squid-users Digest, Vol 95, Issue 41

Send squid-users mailing list submissions to
	<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
or, via email, send a message with subject or body 'help' to
	<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-request at lists.squid-cache.org</A>

You can reach the person managing the list at
	<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-owner at lists.squid-cache.org</A>

When replying, please edit your Subject line so it is more specific than
&quot;Re: Contents of squid-users digest...&quot;


Today's Topics:

   1. Re: adding cache_control = nocache to http request using
      squid transparent proxy (<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>)
   2. Re: adding cache_control = nocache to http request using
      squid transparent proxy (Amos Jeffries)


----------------------------------------------------------------------

Message: 1
Date: Thu, 28 Jul 2022 10:41:42 +0300
From: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
To: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
Subject: Re: [squid-users] adding cache_control = nocache to http
	request using squid transparent proxy
Message-ID: &lt;008b01d8a255$7bdfbd10$739f3730$@gmail.com&gt;
Content-Type: text/plain;	charset=&quot;utf-8&quot;

Hey Amos,

I support what you wrote and I do not know why the service provider wants
this but there are some cases which there is a need to lower the cache ratio
of the clients.
Usually fast service is what ISPs want but there are couple use cases that I
have seen which makes sense to somehow try to disable cache in the client
side.
In these specific cases the relationship of the ISP and the client should be
fully understood by both side and the ISP should OVER COMMIT their services
to the client to compensate for the client limitations.
I would assume it should be some 50-100% of the package over commit.
In the last years I have seen that 1080HD videos uses usually 3Mbps VBR in
cases of real time transcoding of the video ( both in server and client side
) while 6Mbps in CBR for the exact same pre-transcoded videos.
(which reduces the client side CPU and device requirements).

So, in case I would have couple CDNs pushing data to my network while the
one is overloading my clients current hardware There is a right to push back
this CDN performance since he somehow in-directly forces my clients to
upgrade their hardware.

To my understanding many ISPs and CDNs won't see their actions to give
better service coverage as bad but what's next? We won't be able to snoop in
our noses between commercials that are popping into our screen or eyes or
head?

I just put this really faint conversation in my head:
Son: ohh my head hurts dad!
Dad: Who hit you?
Son: I don't know, I was sitting Infront of the **device** and the video was
4k fps.
Dad: You should use a lower image fps rendering, in my days we used to watch
matrix in 15-30 fps and it was fun.

Hope It Helps to give someone a smile.

Eliezer

----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>

-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of
Amos Jeffries
Sent: Wednesday, 27 July 2022 3:46
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] adding cache_control = nocache to http request
using squid transparent proxy

On 27/07/22 07:52, muhanad wrote:
&gt;<i> Hello
</I>&gt;<i> 
</I>&gt;<i> I am trying to edit the header of http headers to set the 
</I>&gt;<i> cache_control option to &quot; no-cache&quot; to prevent users from being able 
</I>&gt;<i> to cache the contents
</I>
This will not do what you think it does.

The &quot;no-cache&quot; control actually *enables* caching by recipients. It just
requires a quick revalidation check before the cached content is used.


&gt;<i> even if they are using any type of caching engines. the squid 
</I>&gt;<i> proxy will work in a transparent mode. The traffic is originated from 
</I>&gt;<i> one of our CDNs,
</I>
This does not make sense. Just publish the Squid machine IP in DNS 
instead of the CDN server IP. No need for interception.


&gt;<i> also the connection is direct between the clients and 
</I>&gt;<i> the CDN servers, thus the proxy will work in transparent mode with IP 
</I>&gt;<i> spoofing so the in the header the IP address is stays the IP address of 
</I>&gt;<i> the client and  not the proxy server.
</I>
This may not do what you think it does. When traffic is arriving *from* 
Internet the source-IP indicates which route to deliver the response 
packets. You do not want the origin server(s) bypassing Squid on the TCP 
SYNACK packets - that will break all traffic.


&gt;<i> PS: We are an ISP company based in Iraq, Baghdad and we are trying to 
</I>&gt;<i> prevent the clients from caching all HTTP data.
</I>&gt;<i> 
</I>
Why? This is typically a very bad idea.

All it does is:
  * lower the amount of bandwidth available to your clients
    - given them a bad service/experience.
  * increase the traffic delays across your network
    - even worse service/experience.
  * encourage other ISP to erase the cache limitations on traffic from 
your servers even on traffic where it is correct
    - even worse service/experience.


Even if you are charging clients for bandwidth used. You want to be able 
to service *more* clients as quickly as possible, not scare them away 
with a bad service.


HTH
Amos
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>



------------------------------

Message: 2
Date: Thu, 28 Jul 2022 20:39:26 +1200
From: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] adding cache_control = nocache to http
	request using squid transparent proxy
Message-ID: &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">d6575308-739f-629e-c7be-f8b07cf4a574 at treenet.co.nz</A>&gt;
Content-Type: text/plain; charset=UTF-8; format=flowed

On 28/07/22 19:41, ngtech1ltd wrote:
&gt;<i> Hey Amos,
</I>&gt;<i> 
</I>&gt;<i> I support what you wrote and I do not know why the service provider wants
</I>this but there are some cases
&gt;<i> which there is a need to lower the cache ratio of the clients.
</I>
Yes I know. This is a query where we could make things worse by jumping 
to assumptions and providing immediate answers to the question as-asked.

Thus I'm pointing out the potential issues with the concept and waiting 
on clarification from OP to the &quot;Why?&quot; question before providing a 
solution to their actual need.


Cheers
Amos


------------------------------

Subject: Digest Footer

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


------------------------------

End of squid-users Digest, Vol 95, Issue 41
*******************************************


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025031.html">[squid-users] adding cache_control = nocache to http request using squid transparent proxy
</A></li>
	<LI>Next message (by thread): <A HREF="025035.html">[squid-users] adding cache_control = nocache to http request using squid transparent proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25032">[ date ]</a>
              <a href="thread.html#25032">[ thread ]</a>
              <a href="subject.html#25032">[ subject ]</a>
              <a href="author.html#25032">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
