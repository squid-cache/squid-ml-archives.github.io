<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid3/4 compilation error with  Centos8/RH8
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid3/4%20compilation%20error%20with%20%20Centos8/RH8&In-Reply-To=%3CDBBPR09MB4523D1F69057A95715FB765DF7C19%40DBBPR09MB4523.eurprd09.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024761.html">
   <LINK REL="Next"  HREF="024763.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid3/4 compilation error with  Centos8/RH8</H1>
    <B>Ahmad Alzaeem</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid3/4%20compilation%20error%20with%20%20Centos8/RH8&In-Reply-To=%3CDBBPR09MB4523D1F69057A95715FB765DF7C19%40DBBPR09MB4523.eurprd09.prod.outlook.com%3E"
       TITLE="[squid-users] squid3/4 compilation error with  Centos8/RH8">0xff1f at gmail.com
       </A><BR>
    <I>Mon May  2 19:05:29 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024761.html">[squid-users] squid3/4 compilation error with  Centos8/RH8
</A></li>
        <LI>Next message (by thread): <A HREF="024763.html">[squid-users] squid3/4 compilation error with Centos8/RH8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24762">[ date ]</a>
              <a href="thread.html#24762">[ thread ]</a>
              <a href="subject.html#24762">[ subject ]</a>
              <a href="author.html#24762">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Eliezer Croitoru ,
Thank you for your reply ,

Indeed I need to build it from source with custom compile flags .

Is there anyway to overcome the error I sent earlier ?


Thanks


From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; on behalf of Eliezer Croitoru &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
Date: Monday, May 2, 2022 at 11:59 AM
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
Subject: Re: [squid-users] squid3/4 compilation error with Centos8/RH8
Try to use the next SRPM:
<A HREF="https://www.ngtech.co.il/repo/centos/8/SRPMS/squid-4.17-8.el8.src.rpm">https://www.ngtech.co.il/repo/centos/8/SRPMS/squid-4.17-8.el8.src.rpm</A>

Good Luck,

----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;

From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of Ahmad Alzaeem
Sent: Monday, May 2, 2022 21:25
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] squid3/4 compilation error with Centos8/RH8




Hello Team ,
I found I only was able to build squid 5.x on Centos8/RH8 &#8211;  (Not able to build 3.x or 4.x )
I was able to build  squid 3.x and 4.x on RH7/Centos7 .

It seems Its libssl error or so based on compilation error below (not sure if need to upgrade or downgrade GCC)

//////
cache_cf.o: In function `parseOneConfigFile(char const*, unsigned int)':
cache_cf.cc:(.text+0x805): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.cc:(.text+0xc2b): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.cc:(.text+0xd78): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.cc:(.text+0x10a4): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o: In function `parseConfigFileOrThrow(char const*)':
cache_cf.cc:(.text+0x1295): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o:cache_cf.cc:(.text+0x142e): more undefined references to `Debug::Start[abi:cxx11](int, int)' follow
cache_cf.o: In function `dump_acl(StoreEntry*, char const*, ACL*)':
cache_cf.cc:(.text+0x3bc5): undefined reference to `ACL::dumpOptions[abi:cxx11]()'
cache_cf.o: In function `parse_address(Ip::Address*)':
cache_cf.cc:(.text+0x3f7a): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o: In function `parse_acl_tos(acl_tos**)':
cache_cf.cc:(.text+0x432e): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o: In function `parse_http_header_access(HeaderManglers**)':
cache_cf.cc:(.text+0x49d7): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.cc:(.text+0x4a6d): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o: In function `parse_http_header_replace(HeaderManglers**)':
cache_cf.cc:(.text+0x4cc5): undefined reference to `Debug::Start[abi:cxx11](int, int)'
cache_cf.o:cache_cf.cc:(.text+0x4d5b): more undefined references to `Debug::Start[abi:cxx11](int, int)' follow
client_side.o: In function `EVP_PKEY_up_ref':
client_side.cc:(.text.EVP_PKEY_up_ref[EVP_PKEY_up_ref]+0x34): undefined reference to `CRYPTO_add_lock'
client_side.o: In function `X509_up_ref':
client_side.cc:(.text.X509_up_ref[X509_up_ref]+0x34): undefined reference to `CRYPTO_add_lock'
anyp/.libs/libanyp.a(PortCfg.o): In function `Security::ServerOptions::sk_X509_NAME_free_wrapper::operator()(stack_st_X509_NAME*)':
PortCfg.cc:(.text._ZN8Security13ServerOptions25sk_X509_NAME_free_wrapperclEP18stack_st_X509_NAME[_ZN8Security13ServerOptions25sk_X509_NAME_free_wrapperclEP18stack_st_X509_NAME]+0x22): undefined reference to `sk_pop_free'
security/.libs/libsecurity.a(PeerOptions.o): In function `Security::PeerOptions::createBlankContext() const':
PeerOptions.cc:(.text+0x1896): undefined reference to `SSLv23_client_method'
security/.libs/libsecurity.a(ServerOptions.o): In function `Security::ServerOptions::createBlankContext() const':
ServerOptions.cc:(.text+0xb4a): undefined reference to `SSLv23_server_method'
security/.libs/libsecurity.a(ServerOptions.o): In function `X509_CRL_up_ref':
ServerOptions.cc:(.text.X509_CRL_up_ref[X509_CRL_up_ref]+0x36): undefined reference to `CRYPTO_add_lock'
security/.libs/libsecurity.a(Session.o): In function `tls_write_method(int, char const*, int)':
Session.cc:(.text+0x677): undefined reference to `SSL_state'
ssl/.libs/libsslsquid.a(support.o): In function `Ssl::MaybeSetupRsaCallback(std::shared_ptr&lt;ssl_ctx_st&gt;&amp;)':
support.cc:(.text+0x6c9): undefined reference to `SSL_CTX_set_tmp_rsa_callback'
ssl/.libs/libsslsquid.a(support.o): In function `Ssl::matchX509CommonNames(x509_st*, void*, int (*)(void*, asn1_string_st*))':
support.cc:(.text+0x855): undefined reference to `sk_num'
support.cc:(.text+0x872): undefined reference to `sk_value'
support.cc:(.text+0x8c2): undefined reference to `sk_pop_free'
support.cc:(.text+0x8eb): undefined reference to `sk_pop_free'
ssl/.libs/libsslsquid.a(support.o): In function `ssl_verify_cb(int, x509_store_ctx_st*)':
support.cc:(.text+0x19be): undefined reference to `sk_pop_free'
ssl/.libs/libsslsquid.a(support.o): In function `ssl_free_CertChain(void*, void*, crypto_ex_data_st*, int, long, void*)':
support.cc:(.text+0x1ead): undefined reference to `sk_pop_free'
ssl/.libs/libsslsquid.a(support.o): In function `Ssl::Initialize()':
support.cc:(.text+0x2084): undefined reference to `SSL_get_ex_new_index'
support.cc:(.text+0x20b0): undefined reference to `SSL_CTX_get_ex_new_index'
support.cc:(.text+0x20df): undefined reference to `SSL_get_ex_new_index'
support.cc:(.text+0x210c): undefined reference to `SSL_get_ex_new_index'
support.cc:(.text+0x2139): undefined reference to `SSL_get_ex_new_index'
support.cc:(.text+0x2166): undefined reference to `SSL_get_ex_new_index'
support.cc:(.text+0x2193): undefined reference to `SSL_get_ex_new_index'
ssl/.libs/libsslsquid.a(support.o):support.cc:(.text+0x21c0): more undefined references to `SSL_get_ex_new_index' follow
ssl/.libs/libsslsquid.a(support.o): In function `sslGetUserCertificateChainPEM(ssl_st*)':
support.cc:(.text+0x2e23): undefined reference to `sk_value'
support.cc:(.text+0x2e4a): undefined reference to `sk_num'
ssl/.libs/libsslsquid.a(support.o): In function `hasAuthorityInfoAccessCaIssuers(x509_st*)':
support.cc:(.text+0x3aed): undefined reference to `sk_value'
support.cc:(.text+0x3b55): undefined reference to `sk_num'
ssl/.libs/libsslsquid.a(support.o): In function `Ssl::SSL_add_untrusted_cert(ssl_st*, x509_st*)':
support.cc:(.text+0x43cc): undefined reference to `sk_new_null'
support.cc:(.text+0x440a): undefined reference to `sk_pop_free'
support.cc:(.text+0x447b): undefined reference to `sk_push'
ssl/.libs/libsslsquid.a(support.o): In function `sk_x509_findIssuer(stack_st_X509*, x509_st*)':
support.cc:(.text+0x44c6): undefined reference to `sk_num'
support.cc:(.text+0x44e3): undefined reference to `sk_value'
ssl/.libs/libsslsquid.a(support.o): In function `completeIssuers(x509_store_ctx_st*, stack_st_X509*)':
support.cc:(.text+0x4604): undefined reference to `sk_num'
support.cc:(.text+0x4713): undefined reference to `sk_push'
ssl/.libs/libsslsquid.a(support.o): In function `untrustedToStoreCtx_cb(x509_store_ctx_st*, void*)':
support.cc:(.text+0x4949): undefined reference to `sk_dup'
support.cc:(.text+0x4967): undefined reference to `sk_value'
support.cc:(.text+0x497e): undefined reference to `sk_push'
support.cc:(.text+0x498e): undefined reference to `sk_num'
support.cc:(.text+0x49d4): undefined reference to `X509_STORE_CTX_set_chain'
support.cc:(.text+0x49f6): undefined reference to `X509_STORE_CTX_set_chain'
support.cc:(.text+0x4a02): undefined reference to `sk_free'
ssl/.libs/libsslsquid.a(support.o): In function `squid_OPENSSL_init_ssl()':
support.cc:(.text._Z24squid_OPENSSL_init_sslv[_Z24squid_OPENSSL_init_sslv]+0x5): undefined reference to `SSL_load_error_strings'
support.cc:(.text._Z24squid_OPENSSL_init_sslv[_Z24squid_OPENSSL_init_sslv]+0xa): undefined reference to `SSL_library_init'
ssl/.libs/libsslsquid.a(cert_validate_message.o): In function `Ssl::CertValidationMsg::composeRequest(Ssl::CertValidationRequest const&amp;)':
cert_validate_message.cc:(.text+0x36a): undefined reference to `sk_value'
cert_validate_message.cc:(.text+0x51d): undefined reference to `sk_num'
cert_validate_message.cc:(.text+0x6e8): undefined reference to `sk_find'
ssl/.libs/libsslsquid.a(cert_validate_message.o): In function `Ssl::CertValidationMsg::parseResponse(Ssl::CertValidationResponse&amp;, std::string&amp;)':
cert_validate_message.cc:(.text+0x1440): undefined reference to `sk_value'
ssl/.libs/libsslutil.a(gadgets.o): In function `mimicAuthorityKeyId(Security::LockingPointer&lt;x509_st, &amp;Security::X509_free_cpp, HardFun&lt;int, x509_st*, &amp;X509_up_ref&gt; &gt;&amp;, Security::LockingPointer&lt;x509_st, &amp;Security::X509_free_cpp, HardFun&lt;int, x509_st*, &amp;X509_up_ref&gt; &gt; const&amp;, Security::LockingPointer&lt;x509_st, &amp;Security::X509_free_cpp, HardFun&lt;int, x509_st*, &amp;X509_up_ref&gt; &gt; const&amp;)':
gadgets.cc:(.text+0x1276): undefined reference to `sk_new_null'
gadgets.cc:(.text+0x12da): undefined reference to `sk_push'
ssl/.libs/libsslutil.a(gadgets.o): In function `buildCertificate(Security::LockingPointer&lt;x509_st, &amp;Security::X509_free_cpp, HardFun&lt;int, x509_st*, &amp;X509_up_ref&gt; &gt;&amp;, Ssl::CertificateProperties const&amp;)':
gadgets.cc:(.text+0x1b24): undefined reference to `X509_set_notBefore'
gadgets.cc:(.text+0x1c30): undefined reference to `X509_set_notAfter'
ssl/.libs/libsslutil.a(gadgets.o): In function `Ssl::certificateMatchesProperties(x509_st*, Ssl::CertificateProperties const&amp;)':
gadgets.cc:(.text+0x2db5): undefined reference to `sk_num'
gadgets.cc:(.text+0x2dd2): undefined reference to `sk_value'
gadgets.cc:(.text+0x2de9): undefined reference to `sk_find'
gadgets.cc:(.text+0x2e26): undefined reference to `sk_pop_free'
gadgets.cc:(.text+0x2e3c): undefined reference to `sk_pop_free'
ssl/.libs/libsslutil.a(gadgets.o): In function `Ssl::sk_GENERAL_NAME_free_wrapper::operator()(stack_st_GENERAL_NAME*)':
gadgets.cc:(.text._ZN3Ssl28sk_GENERAL_NAME_free_wrapperclEP21stack_st_GENERAL_NAME[_ZN3Ssl28sk_GENERAL_NAME_free_wrapperclEP21stack_st_GENERAL_NAME]+0x22): undefined reference to `sk_pop_free'
collect2: error: ld returned 1 exit status
libtool: link: rm -f &quot;.libs/squidS.o&quot;
make[3]: *** [Makefile:6356: squid] Error 1
make[3]: Leaving directory '/root/KrazyNetworks.com/squid-4.8/src'
make[2]: *** [Makefile:7126: all-recursive] Error 1
make[2]: Leaving directory '/root/KrazyNetworks.com/squid-4.8/src'
make[1]: *** [Makefile:6136: all] Error 2
make[1]: Leaving directory '/root/KrazyNetworks.com





gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/8/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-redhat-linux
Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=<A HREF="http://bugzilla.redhat.com/bugzilla">http://bugzilla.redhat.com/bugzilla</A> --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --with-isl --disable-libmpx --enable-offload-targets=nvptx-none --without-cuda-driver --enable-gnu-indirect-function --enable-cet --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux
Thread model: posix
gcc version 8.5.0 20210514 (Red Hat 8.5.0-4) (GCC)








Is there any flag I need to pass for RH8/Centos8 so it compile older version of squid like 3.x and 4.5 ?


Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220502/95b0639f/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220502/95b0639f/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024761.html">[squid-users] squid3/4 compilation error with  Centos8/RH8
</A></li>
	<LI>Next message (by thread): <A HREF="024763.html">[squid-users] squid3/4 compilation error with Centos8/RH8
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24762">[ date ]</a>
              <a href="thread.html#24762">[ thread ]</a>
              <a href="subject.html#24762">[ subject ]</a>
              <a href="author.html#24762">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
