<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid Reconfigure Downtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Reconfigure%20Downtime&In-Reply-To=%3C86dc5d95-0718-ac21-22a6-e2f80cb6ac50%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024777.html">
   <LINK REL="Next"  HREF="024776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid Reconfigure Downtime</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20Reconfigure%20Downtime&In-Reply-To=%3C86dc5d95-0718-ac21-22a6-e2f80cb6ac50%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid Reconfigure Downtime">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri May  6 13:23:02 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024777.html">[squid-users] Squid Reconfigure Downtime
</A></li>
        <LI>Next message (by thread): <A HREF="024776.html">[squid-users] How can I rewrite urls?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24778">[ date ]</a>
              <a href="thread.html#24778">[ thread ]</a>
              <a href="subject.html#24778">[ subject ]</a>
              <a href="author.html#24778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/5/22 21:33, Manikandan Swaminathan wrote:

&gt;<i> We're currently running Squid 4.8, and I want to know, what is the 
</I>&gt;<i> expected downtime when running &quot;squid -k reconfigure&quot;? 
</I>
The actual delay depends on many variables, including the definition of 
&quot;downtime&quot;. Very roughly speaking, reconfiguration today can be almost 
as heavy/slow (or as light/fast) as starting Squid from scratch. Certain 
startup actions (e.g., building an in-memory index of cache_dirs) are 
skipped during reconfigurations, and some optimizations (e.g., various 
internal caches) continue to work through reconfigurations, but a lot of 
heavy startup actions are performed during reconfigurations as well.


&gt;<i> How does this affect existing and incoming connections?
</I>
Most existing connections, especially short-lived ones, are usually 
unaffected when the configuration does not change much. IIRC, new 
incoming connections may be rejected during reconfiguration (in some 
cases). The code is not written to guarantee much: Squid does _not_ 
maintain a consistent configuration state during (re)configuration. YMMV.


&gt;<i> I ran a simple test in my machine where I reconfigure squid, while 
</I>&gt;<i> separately running multiple proxy requests. As far as I could tell, 
</I>&gt;<i> there wasn't any disruption, but I'd like to get some input from more 
</I>&gt;<i> experienced folks.
</I>
Your test did not expose existing problems. I do not know how much those 
problems are going to affect your deployment environment.


FWIW, we have an ongoing &quot;smooth reconfiguration&quot; project that makes 
Squid reconfigure just the changed configuration directives, without 
disrupting traffic. It will take a while to cover all configuration 
directives, but I hope to see the first pull requests that cover some 
directives soon.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024777.html">[squid-users] Squid Reconfigure Downtime
</A></li>
	<LI>Next message (by thread): <A HREF="024776.html">[squid-users] How can I rewrite urls?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24778">[ date ]</a>
              <a href="thread.html#24778">[ thread ]</a>
              <a href="subject.html#24778">[ subject ]</a>
              <a href="author.html#24778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
