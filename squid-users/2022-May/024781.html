<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] WARNING: All 32/32 ssl_crtd processes are busy - where next?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20WARNING%3A%20All%2032/32%20ssl_crtd%20processes%20are%20busy%20-%0A%20where%20next%3F&In-Reply-To=%3CCADNp1BZryxiEfs1UvQbjEWed3RyLvx1KJZfKwebepRhXO30NdQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024780.html">
   <LINK REL="Next"  HREF="024782.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] WARNING: All 32/32 ssl_crtd processes are busy - where next?</H1>
    <B>Max Allan</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20WARNING%3A%20All%2032/32%20ssl_crtd%20processes%20are%20busy%20-%0A%20where%20next%3F&In-Reply-To=%3CCADNp1BZryxiEfs1UvQbjEWed3RyLvx1KJZfKwebepRhXO30NdQ%40mail.gmail.com%3E"
       TITLE="[squid-users] WARNING: All 32/32 ssl_crtd processes are busy - where next?">max.allan at surevine.com
       </A><BR>
    <I>Thu May 12 10:46:48 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="024780.html">[squid-users] Thinking out loud about &quot;applications&quot; definition for squid
</A></li>
        <LI>Next message (by thread): <A HREF="024782.html">[squid-users] is there a way to tell squid to write external ip even that external ip not attached into the machine ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24781">[ date ]</a>
              <a href="thread.html#24781">[ thread ]</a>
              <a href="subject.html#24781">[ subject ]</a>
              <a href="author.html#24781">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I have squid setup to log all requests for security reasons.
When doing an npm install, npm sometimes gets a connection reset error
and fails.
In the cache log, I can see many messages like :

2022/05/12 09:20:00 kid1| helperOpenServers: Starting 1/32 'ssl_crtd' processes
2022/05/12 09:20:00 kid1| WARNING: All 32/32 ssl_crtd processes are busy.
2022/05/12 09:20:00 kid1| WARNING: 32 pending requests queued
2022/05/12 09:20:00 kid1| WARNING: Consider increasing the number of
ssl_crtd processes in your config file.
2022/05/12 09:20:00 kid1| Queue overload, rejecting
2022/05/12 09:20:00 kid1| Queue overload, rejecting
(with 100s of queue overloads)

BUT <A HREF="http://www.squid-cache.org/Versions/v3/3.5/cfgman/sslcrtd_children.html">http://www.squid-cache.org/Versions/v3/3.5/cfgman/sslcrtd_children.html</A>
says the maximum safe value is 32. Later versions don't allow values over 32.
(I'm on 3.5)

So, where do I go from here??

What is the &quot;unsafe&quot; worst case? Packet loss, high server load, squid
crashing out, etc..?

I did increase it to 64 and the idle to 5 so far haven't seen one of
the failures from npm, but my cache log still shows :

2022/05/12 10:14:30 kid1| helperOpenServers: Starting 5/64 'ssl_crtd' processes
2022/05/12 10:14:30 kid1| Starting new ssl_crtd helpers...
2022/05/12 10:14:30 kid1| helperOpenServers: Starting 4/64 'ssl_crtd' processes
2022/05/12 10:14:44 kid1| WARNING: All 64/64 ssl_crtd processes are busy.
2022/05/12 10:14:44 kid1| WARNING: 64 pending requests queued
2022/05/12 10:14:44 kid1| WARNING: Consider increasing the number of
ssl_crtd processes in your config file.
2022/05/12 10:14:44 kid1| Queue overload, rejecting
2022/05/12 10:14:44 kid1| Queue overload, rejecting

Which queue do I increase to prevent the overload? Squid is configured
without any auth, mostly ACL and ssl setup.


Thanks

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="024780.html">[squid-users] Thinking out loud about &quot;applications&quot; definition for squid
</A></li>
	<LI>Next message (by thread): <A HREF="024782.html">[squid-users] is there a way to tell squid to write external ip even that external ip not attached into the machine ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24781">[ date ]</a>
              <a href="thread.html#24781">[ thread ]</a>
              <a href="subject.html#24781">[ subject ]</a>
              <a href="author.html#24781">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
