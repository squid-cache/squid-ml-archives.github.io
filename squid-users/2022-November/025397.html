<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Does Squid support client ssl termination?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20Squid%20support%20client%20ssl%20termination%3F&In-Reply-To=%3C35d26595-2d5d-a353-28c4-36d422d74a42%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025395.html">
   <LINK REL="Next"  HREF="025369.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Does Squid support client ssl termination?</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20Squid%20support%20client%20ssl%20termination%3F&In-Reply-To=%3C35d26595-2d5d-a353-28c4-36d422d74a42%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] Does Squid support client ssl termination?">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Sat Nov  5 05:59:08 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025395.html">[squid-users] Does Squid support client ssl termination?
</A></li>
        <LI>Next message (by thread): <A HREF="025369.html">[squid-users] Does Squid support client ssl termination?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25397">[ date ]</a>
              <a href="thread.html#25397">[ thread ]</a>
              <a href="subject.html#25397">[ subject ]</a>
              <a href="author.html#25397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/4/22 7:05 AM, Amos Jeffries wrote:
&gt;<i> Aye, that is the terminology definitions of them. Which does not clearly 
</I>&gt;<i> convey the recursive layer/nesting properties. They way I suggested to 
</I>&gt;<i> think of TLS and HTTP as transfer layers helps clarify that property.
</I>
I will concede &quot;differentiate&quot;, but I don't agree that it &quot;clarifies&quot;.

&gt;<i> The best I have found is the rule-of-thumb to avoid abbreviations that 
</I>&gt;<i> have multiple meanings and use simple nouns that the reader understands 
</I>&gt;<i> already to build a compound noun that they can comprehend. As such you 
</I>&gt;<i> will find my wording varies between discussions, and can adjust as I 
</I>&gt;<i> learn what terms the others understand already.
</I>
Okay....

How would you describe the following in a green field discussion to 
someone without any prior context to suggest nomenclature?

Client uses an explicit proxy connection with TLS encryption to ask the 
proxy to request a TLS encrypted web page on the client's behalf.

&gt;<i> To Squid the transport is (almost) always TCP. Whether TLS is treated as 
</I>&gt;<i> transport layer or application layer depends on the Squid features (eg 
</I>&gt;<i> SSL-Bump).
</I>
Eh....  This isn't a photon, it's can't be both a wave and a particle. 
I feel like it's really one thing and what Squid does with it may be 
different based on if Squid is SSL-Bumping or not.  After all, it's both 
are exactly the same thing to the client, independent of if Squid is 
SSL-Bumping or not.

&gt;<i> So for your purpose of understanding the possibilities it is best to 
</I>&gt;<i> think of it as just another transfer protocol that Squid can receive 
</I>&gt;<i> like HTTP. Which can either transfer opaque client information, or 
</I>&gt;<i> another type of transfer protocols &quot;nested&quot; inside it.
</I>
Hum.  So if I understand you correctly, this could be HTTP application 
layer protocol on top of an unencrypted TCP transport /or/ on top of an 
encrypted TCP+TLS transport?

&gt;<i> Oh, I see (I think). I use nesting or layering (from OSI model 
</I>&gt;<i> terminology) because &quot;chain&quot; is used by HTTP in the definition of how 
</I>&gt;<i> traffic is routed between multiple agents. For example; 
</I>&gt;<i> client-&gt;squid-&gt;server is a chain.
</I>
I don't consider client -&gt; squid -&gt; origin to be a chain of proxies.

I do consider client -&gt; squid -&gt; $SOME_OTHER_PROXY -&gt; origin to be a 
chain of proxies.

To me for it to be a chain of proxies, there must be multiple proxies 
involved.

N.B. maybe this is somewhat a problem of nomenclature.  Hence why I have 
explicitly typed out &quot;chain /of/ /proxies/&quot; here.

By the very nature of how proxies work, even for the simplest method of 
an unencrypted TCP transport from client to proxy and then an 
unencrypted TCP transport from the proxy to the origin server, there are 
three parties involved; client, proxy, and origin server.

What's more is that this three party system is baked into many 
contemporary clients.  Conversely, almost everything needs an extremely 
special configuration to add, or chain, an additional intermediate proxy 
in the middle.  Hence why I think that &quot;proxy chaining&quot; is very special. 
  --  After I type that, the nomenclature &quot;/proxy/ chaining&quot; even 
supports that there are multiple proxies.

N.B. &quot;origin server&quot; may be a misnomer as from the client's and Squid's 
point of view, it may not be an origin server and may in fact be an 
additional layer of reverse proxying unbeknownst to the client nor Squid.

&gt;<i> Browsers are origin-client software. They deal with these layers:
</I>&gt;<i>  &#160;* HTTP (<A HREF="http://">http://</A> to origin, or <A HREF="http://">http://</A> to traditional plain-text 
</I>&gt;<i> forward-proxy), or
</I>
I believe that's really two different things in an explicitly configured 
proxy use case, because what the client will do is subtly, but 
distinctly different and that difference is important.

&gt;<i>  &#160;* HTTP-over-TLS (<A HREF="https://">https://</A> to origin), or
</I>&gt;<i>  &#160;* HTTP-over-TLS-over-HTTP (traditional <A HREF="https://">https://</A> to plain-text 
</I>&gt;<i> forward-proxy).
</I>&gt;<i> 
</I>&gt;<i> Recently some started handling HTTP-over-TLS-over-HTTP-over-TLS - which 
</I>&gt;<i> is traditional <A HREF="https://">https://</A> to an secure/encrypted forward-proxy.
</I>
Maybe it's just me, but I don't know that I could extract what is 
happening, without a lot of thought, from these descriptions.

  - HTTP-over-TCP
  - HTTP-over-TLS
  - HTTP-over-TCP-over-HTTP-over-TCP
  - HTTP-over-TLS-over-HTTP-over-TCP
  - HTTP-over-TCP-over-HTTP-over-TLS
  - HTTP-over-TLS-over-HTTP-over-TLS

I don't see a good clean / uniform cut / divide for determining what is 
what, client to origin, client to proxy, or proxy to origin.

&gt;<i> There you are running into the ambiguity of &quot;chain&quot;. Using both its 
</I>&gt;<i> meanings in one sentence.
</I>
I don't think so.  See above.

I'm fairly certain of what I think to be a proxy chain.  It seems as if 
you are also fairly certain of what you think to be a proxy chain.  But 
it seems like we may be using different definitions of what is a proxy 
chain.

&gt;<i> The three dimensions in play are:
</I>&gt;<i>  &#160;1) protocol X being spoken between client and Squid
</I>&gt;<i>  &#160;2) protocol Y the client is requesting to use with the origin server
</I>&gt;<i>  &#160;3) protocol Z actually being spoken between Squid and next-hop 
</I>&gt;<i> peer/server
</I>
Ah.  You're introducing -- what I consider to be -- proxy chaining into 
the mix.

I thought you were instead going to introduce implicit vs explicit 
client configuration.

As indicated elsewhere, I consider proxy chaining to be largely out of 
scope as the (1st) proxy server can't really differentiate between the 
the target of it's traffic being an origin server vs another (2nd) proxy 
server.  This is especially true when TLS encryption is in use and 
SSL-Bump is not in play.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20221104/186df1cf/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20221104/186df1cf/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025395.html">[squid-users] Does Squid support client ssl termination?
</A></li>
	<LI>Next message (by thread): <A HREF="025369.html">[squid-users] Does Squid support client ssl termination?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25397">[ date ]</a>
              <a href="thread.html#25397">[ thread ]</a>
              <a href="subject.html#25397">[ subject ]</a>
              <a href="author.html#25397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
