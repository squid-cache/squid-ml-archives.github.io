<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 5: server_cert_fingerprint not working fine...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205%3A%20server_cert_fingerprint%20not%20working%0A%20fine...&In-Reply-To=%3C001001d8fc3a%24c5d198a0%245174c9e0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025441.html">
   <LINK REL="Next"  HREF="025453.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 5: server_cert_fingerprint not working fine...</H1>
    <B>ngtech1ltd at gmail.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205%3A%20server_cert_fingerprint%20not%20working%0A%20fine...&In-Reply-To=%3C001001d8fc3a%24c5d198a0%245174c9e0%24%40gmail.com%3E"
       TITLE="[squid-users] Squid 5: server_cert_fingerprint not working fine...">ngtech1ltd at gmail.com
       </A><BR>
    <I>Sat Nov 19 17:17:15 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025441.html">[squid-users] Squid 5: server_cert_fingerprint not working fine...
</A></li>
        <LI>Next message (by thread): <A HREF="025453.html">[squid-users] Squid 5: server_cert_fingerprint not working fine...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25442">[ date ]</a>
              <a href="thread.html#25442">[ thread ]</a>
              <a href="subject.html#25442">[ subject ]</a>
              <a href="author.html#25442">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Fred,

Just a tiny question, can you share this php script so we can make sense of what is this script doing compared to what squid is doing?

Thanks,
Eliezer

----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>

-----Original Message-----
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of UnveilTech - Support
Sent: Saturday, 19 November 2022 15:44
To: Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] Squid 5: server_cert_fingerprint not working fine...

Hi Amos,

Quick update...
A 10 lines PHP helper is able to catch the SHA1 key with a basis &quot;openssl_x509_fingerprint&quot; function when Squid, a 1 million lines product, could not be able ?

Samples from the helper:
apple.com tls1.3, SHA1: &quot;7B:B1:94:4F:56:5D:7D:64:A1:45:5C:91:E5:BA:0C:EA:D9:FB:91:50&quot;
xforce-cracks.com tls1.3, SHA1: &quot;31:3E:E1:3D:FD:B1:0A:C0:CA:AF:30:47:0A:BA:A1:49:D4:08:42:2A&quot;

I'm sure the Squid team can do better than a PHP function &#128522;

Bye Fred

-----Message d'origine-----
De : UnveilTech - Support 
Envoy&#233; : vendredi 18 novembre 2022 14:56
&#192; : 'Amos Jeffries' &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Objet : RE: [squid-users] Squid 5: server_cert_fingerprint not working fine...

Hi Amos,

We have tested with a &quot;ssl_bump bump&quot; (&quot;ssl_bump all&quot; and &quot;ssl_bump bump sslstep1&quot;), it does not solve the problem.
According to Alex, we can also confirm it's a bug with Squid 5.x and TLS 1.3.
It seems Squid is only compatible with TLS 1.2, it's not good for the future...

Bye Fred

-----Message d'origine-----
De : squid-users [mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>] De la part de Amos Jeffries Envoy&#233; : vendredi 18 novembre 2022 06:34 &#192; : <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> Objet : Re: [squid-users] Squid 5: server_cert_fingerprint not working fine...

On 18/11/2022 5:02 am, UnveilTech - Support wrote:
&gt;<i>
</I>&gt;<i> Hello Squid Team,
</I>&gt;<i>
</I>&gt;<i> Can you have a look to this bugzilla case :
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5245">https://bugs.squid-cache.org/show_bug.cgi?id=5245</A>
</I>&gt;<i>
</I>&gt;<i> it&#8217;s about a bug with Squid 5.7 and TLS 1.3.
</I>&gt;<i>
</I>&gt;<i> Critical case created the 2022-10-27 09:59 UTC, it would be nice to 
</I>&gt;<i> have a fix/patch&#8230;
</I>&gt;<i>
</I>&gt;<i>   occur)
</I>&gt;<i>
</I>
As one can see in the bug report Alex has looked at it in some detail.
The solution may be complex or large change, and thus unlikely to occur in Squid-5 if so.

There are three things that come to mind immediately as related problems we cannot do anything about:
  1) Squid cannot know in advance what server cert will be provided (after step2) when it decided to splice (or not) at step2.
  2) SHA1 is not the only type of cert fingerprint. The non-working certs may be providing newer SHA2/3 etc fingerprints
  3) In TLS/1.3 a lot of data can be hidden inside the encryption. Squid may simply not be given access to the [real] fingerprint unless bump
(decrypt) happens.

HTH
Amos

_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
_______________________________________________
squid-users mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
<A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025441.html">[squid-users] Squid 5: server_cert_fingerprint not working fine...
</A></li>
	<LI>Next message (by thread): <A HREF="025453.html">[squid-users] Squid 5: server_cert_fingerprint not working fine...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25442">[ date ]</a>
              <a href="thread.html#25442">[ thread ]</a>
              <a href="subject.html#25442">[ subject ]</a>
              <a href="author.html#25442">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
