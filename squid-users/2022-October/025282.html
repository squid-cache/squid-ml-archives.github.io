<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] dns_nameservers directive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dns_nameservers%20directive&In-Reply-To=%3CYz1vG1ALsUUwbguJ%40charite.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025281.html">
   <LINK REL="Next"  HREF="025285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] dns_nameservers directive</H1>
    <B>Ralf Hildebrandt</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20dns_nameservers%20directive&In-Reply-To=%3CYz1vG1ALsUUwbguJ%40charite.de%3E"
       TITLE="[squid-users] dns_nameservers directive">Ralf.Hildebrandt at charite.de
       </A><BR>
    <I>Wed Oct  5 11:48:43 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025281.html">[squid-users] Missing security announcements
</A></li>
        <LI>Next message (by thread): <A HREF="025285.html">[squid-users] dns_nameservers directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25282">[ date ]</a>
              <a href="thread.html#25282">[ thread ]</a>
              <a href="subject.html#25282">[ subject ]</a>
              <a href="author.html#25282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Using squid-6.0.0-20220905-r9358e99f9:
======================================

On sunday, one of our DNS server froze and was not answering any
queries. Shit happens, that's why we have another DNS server.

Our Squid config says:

dns_nameservers 141.42.5.157 141.42.5.156

So, 141.42.5.157 was not answering any queries, and 141.42.5.156 took
over. 

But... monitoring reported dns_query_time rose to about 8000ms,
meaning all http requests took ages, since (I guess) the first dns
server was queried, and (after 8s?) the second server was used.

But according to the docs, &quot;dns_timeout&quot; defaults to 30s.

Is there any way of making squid mark the first server as &quot;dead&quot; (for
e.g. 5 minutes) and use the next server instead?

-- 
Ralf Hildebrandt
Charit&#233; - Universit&#228;tsmedizin Berlin
Gesch&#228;ftsbereich IT | Abteilung Netzwerk

Campus Benjamin Franklin (CBF)
Haus I | 1. OG | Raum 105
Hindenburgdamm 30 | D-12203 Berlin

Tel. +49 30 450 570 155
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ralf.hildebrandt at charite.de</A>
<A HREF="https://www.charite.de">https://www.charite.de</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025281.html">[squid-users] Missing security announcements
</A></li>
	<LI>Next message (by thread): <A HREF="025285.html">[squid-users] dns_nameservers directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25282">[ date ]</a>
              <a href="thread.html#25282">[ thread ]</a>
              <a href="subject.html#25282">[ subject ]</a>
              <a href="author.html#25282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
