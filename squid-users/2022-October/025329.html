<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FW: Encrypted browser-Squid connection errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3C2f52e708-b1d8-ad6d-c9ea-62c3c5cf2965%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025327.html">
   <LINK REL="Next"  HREF="025359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FW: Encrypted browser-Squid connection errors</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3C2f52e708-b1d8-ad6d-c9ea-62c3c5cf2965%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] FW: Encrypted browser-Squid connection errors">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Sat Oct 22 17:10:58 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025327.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
        <LI>Next message (by thread): <A HREF="025359.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25329">[ date ]</a>
              <a href="thread.html#25329">[ thread ]</a>
              <a href="subject.html#25329">[ subject ]</a>
              <a href="author.html#25329">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/21/22 11:30 PM, Amos Jeffries wrote:
&gt;<i> Not just convention. AFAICT was formally registered with W3C, before 
</I>&gt;<i> everyone went to using IETF for registrations.
</I>
Please elaborate on what was formally registered.  I've only seen 3128 / 
3129 be the default for Squid (and a few things emulating squid).  Other 
proxies of the time, namely Netscape's and Microsoft's counterparts, 
tended to use 8080.

I'd genuinely like to learn more about and understand the history / 
etymology / genesis of the 3128 / 3129.

&gt;<i> FYI, discussion started ~30 years ago.
</I>
ACK

&gt;<i> The problem:
</I>&gt;<i> 
</I>&gt;<i> For bandwidth savings HTTP/1.0 defined different URL syntax for origin 
</I>&gt;<i> and relay/proxy requests. The form sent to an origin server lacks any 
</I>&gt;<i> information about the authority. That was expected to be known 
</I>&gt;<i> out-of-band by the origin itself.
</I>&gt;<i> 
</I>&gt;<i> HTTP/1.1 has attempted several different mechanisms to fix this over the 
</I>&gt;<i> years. None of them has been universally accepted, so the problem 
</I>&gt;<i> remains. The best we have is mandatory Host header which most (but sadly 
</I>&gt;<i> not all) clients and servers use.
</I>&gt;<i> 
</I>&gt;<i> HTTP/2 cements that design with mandatory &quot;:authority&quot; pseudo-header 
</I>&gt;<i> field. So the problem is &quot;fixed&quot;for native HTTP/2+ traffic. But until 
</I>&gt;<i> HTTP/1.0 and broken HTTP/1.1 clients are all gone the issue will still 
</I>&gt;<i> crop up.
</I>
I'm not entirely sure what you mean by &quot;the authority&quot;.  I'm taking it 
to mean the identity of the service that you are wanting content from. 
The Host: header comment with HTTP/1.1 is what makes me think this.

My understanding is that neither HTTP/0.9 nor HTTP/1.0 had a Host: 
header and that it was assumed that the IP address you were connecting 
to conveyed the server that you were wanting to connect to.

I have very little technical understanding of HTTP/2 as I've not needed 
to delve into it and it has largely just worked for me.

&gt;<i> And ... Squid still only supports HTTP/1.1 and older.
</I>
Okay.  That sort of surprises me.  But I have zero knowledge to disagree.

&gt;<i> More importantly the proxy hostname:port the client is opening TCP 
</I>&gt;<i> connections to may be different from the authority-info specified in the 
</I>&gt;<i> HTTP request message (or lack thereof).
</I>
My working understanding of what the authority is seems to still work 
with this.

&gt;<i> This crosses security boundaries and involves out-of-band information 
</I>&gt;<i> sources at all three endpoints involved in the transaction for the 
</I>&gt;<i> message semantics and protocol negotiations to work properly.
</I>
I feel like the nature of web traffic tends to frequently, but not 
always, cross security / administrative boundaries.  As such, I don't 
think that existence of proxies in the communications path alters things 
much.

Please elaborate on what out-of-band information you are describing. 
The most predominant thing that comes to mind, particularly with 
HTTP/1.1 and HTTP/2 is name resolution -- ostensibly DNS -- to identify 
the IP address to connect to.

&gt;<i> What that text does not say is that when they are omitted by the 
</I>&gt;<i> **user** they are taken from configuration settings in the OS:
</I>&gt;<i> 
</I>&gt;<i>  &#160;* the environment variable name provides:
</I>&gt;<i>  &#160;&#160;&#160; - the protocol name (&quot;http&quot; or &quot;HTTPS&quot;, aka plain-text or encrypted)
</I>&gt;<i>  &#160;&#160;&#160; - the expected protocol syntax/semantics (&quot;proxy&quot; aka forward-proxy)
</I>&gt;<i> 
</I>&gt;<i>  &#160;* the machine /etc/services configuration provides the default port 
</I>&gt;<i> for the named protocol.
</I>
Ergo the use of /default/ values when values are not specified.

I feel like this in a round about way supports my stance that the 
default ports are perfectly fine to use.

&gt;<i> Attempting to use a reverse-proxy or origin server such a configuration 
</I>&gt;<i> may work for some messages, but **will** fail due to syntax or semantic 
</I>&gt;<i> errors on others.
</I>
I question the veracity of that statement.

Sure, trying to speak contemporary protocols (HTTP/1.1 or HTTP/2) to an 
ancient HTTP server is not going to work.

But I believe that Squid and Apache HTTPD can be configured to perform 
all three roles; origin server, reverse proxy, and forward proxy.

Aside:  Squid might not be a typical origin server in that you can't 
have it /directly/ serve /typical/ origin content.  However I believe it 
does function as an origin server for things like Squid error pages.

&gt;<i> Likewise NAT'ing inbound port 443 or port 80 traffic to a 
</I>&gt;<i> forward-proxy will encounter the same types of issues - while it is 
</I>&gt;<i> perfectly fine to do so towards a reverse-proxy or origin server.
</I>
I believe that is entirely dependent on the capability and configuration 
of the forward proxy.  --  I've done exactly this with Apache HTTPD. 
Though I've not had the (dis)pleasure of doing so with Squid.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20221022/8e0e1170/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20221022/8e0e1170/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025327.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
	<LI>Next message (by thread): <A HREF="025359.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25329">[ date ]</a>
              <a href="thread.html#25329">[ thread ]</a>
              <a href="subject.html#25329">[ subject ]</a>
              <a href="author.html#25329">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
