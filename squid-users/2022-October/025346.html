<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FW: Encrypted browser-Squid connection errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3CY1gxt7xXve7L5YEy%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025344.html">
   <LINK REL="Next"  HREF="025348.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FW: Encrypted browser-Squid connection errors</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3CY1gxt7xXve7L5YEy%40fantomas.sk%3E"
       TITLE="[squid-users] FW: Encrypted browser-Squid connection errors">uhlar at fantomas.sk
       </A><BR>
    <I>Tue Oct 25 18:57:59 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025344.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
        <LI>Next message (by thread): <A HREF="025348.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25346">[ date ]</a>
              <a href="thread.html#25346">[ thread ]</a>
              <a href="subject.html#25346">[ subject ]</a>
              <a href="author.html#25346">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>On 10/25/22 11:03 AM, Matus UHLAR - fantomas wrote:
</I>&gt;&gt;<i>I think intercepting is better, more precise.
</I>
On 25.10.22 12:14, Grant Taylor wrote:
&gt;<i>I think that Squid can be an interception proxy as it can filter / 
</I>&gt;<i>alter content.
</I>&gt;<i>
</I>&gt;<i>I also think that Squid (as an interception proxy) can be used 
</I>&gt;<i>transparently.
</I>
intercepting connections and modifying content are two separate 
functionalities, and &quot;transparent proxy&quot; is in RFC2616 defined as &quot;not doing 
the latter&quot; while many people understand it as &quot;doing the former&quot;.

That is why I prefer using &quot;intercepting proxy&quot; for case where connections 
between clients and servers intercepted by proxy, without it being 
configured in browsers.

&gt;&gt;<i>those two are completely separate,
</I>&gt;<i>
</I>&gt;<i>I'm not yet convinced.
</I>
both functionalities described above are independent on each other, squid 
also supports both separately, which gives us four combinations.

&gt;&gt;<i>proxy may be intercepting and modify content (e.g. filter), 
</I>&gt;&gt;<i>including squid.
</I>&gt;<i>
</I>&gt;<i>I guess it could be said that the transparency, or modification of 
</I>&gt;<i>content, is one aspect and that how the client connects to the proxy, 
</I>&gt;<i>explicit or implicit (network magic), could be another aspect.
</I>&gt;<i>
</I>&gt;<i>           +-------------+--------+
</I>&gt;<i>           | transparent | opaque |
</I>&gt;<i>+----------+-------------+--------+
</I>&gt;|<i> explicit |      2      |   1    |
</I>&gt;<i>+----------+-------------+--------+
</I>&gt;|<i> implicit |      3      |   4    |
</I>&gt;<i>+----------+-------------+--------+
</I>&gt;<i>
</I>&gt;<i>I believe that Squid can be either transparent and / or opaque 
</I>&gt;<i>depending on it's configuration.
</I>
precisely, so what exactly aren't you convinced about? :-)

&gt;<i>I also believe that Squid can be either explicit and / or implicit via 
</I>&gt;<i>networking magic.
</I>
&gt;<i>When I said that intercepting was a superset of transparent, I was 
</I>&gt;<i>including all four quadrants.
</I>
I guess intercepting is what you have in second row, while transparent is 
the first column, that doesn't seem as superset to me.

&gt;&gt;<i>I guess PORT connections have to be allowed on the SOCKS server 
</I>&gt;&gt;<i>which is I'd say not common (can be dangerous)
</I>&gt;<i>
</I>&gt;<i>Yes, the PORT connection must be allowed.  But the problem that I 
</I>&gt;<i>found was that the PORT declaration has a timeout / finite time that 
</I>&gt;<i>they would wait for connections.  E.g. ten minutes in the example I 
</I>&gt;<i>was looking at.
</I>
Have you noticed this with SOCKS server?

I guess this applies for firewalls that will disable connections to the port 
later.  But the same applies for PASV connections and the reply when 
firewall at serer side is used.

&gt;<i>What's more is that the PORT connections must be declared /per/ 
</I>&gt;<i>/expected/ /connection/.  They aren't a generic forward traffic from 
</I>&gt;<i>any Internet connected system into the SOCKS client.
</I>&gt;<i>
</I>&gt;&gt;<i>passive connections are safe in case of ftp/ssl, where it's 
</I>&gt;&gt;<i>impossible to know for the proxy/firewall who connects where.
</I>&gt;<i>
</I>&gt;<i>I don't think that it's impossible.  Rather it's just improbable.  
</I>
When ssl/tls is used between client and server, intermediate gateways and 
firewalls don't know what ports do endpoints agree on using PORT/PASV.

Unless they intercept SSL conneciton (which kinf od makes them FTP 
endpoints) or the client supports and issues FTP command &quot;CCC&quot; which is 
designed for this case.  I'm afraid not many FTP clients do that.

&gt;<i>It's technically possible to do TLS bump in the wire or other things 
</I>&gt;<i>like known keys (non-ephemeral / non-PFS) or sharing ephemeral / PFS 
</I>&gt;<i>keys from internal server with TLS monkey in the middle proxy.  Such 
</I>&gt;<i>is technically possible, just highly improbable.
</I>
agree.

the workaround is to use static list of ports at server side and configure 
server firewall to statically allow connection to these ports (optionally 
NAT them).

however this is already not a SQUID issue.

-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
I intend to live forever - so far so good.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025344.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
	<LI>Next message (by thread): <A HREF="025348.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25346">[ date ]</a>
              <a href="thread.html#25346">[ thread ]</a>
              <a href="subject.html#25346">[ subject ]</a>
              <a href="author.html#25346">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
