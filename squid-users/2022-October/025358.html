<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Does Squid support client ssl termination?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20Squid%20support%20client%20ssl%20termination%3F&In-Reply-To=%3Cf1a6b704-38c0-321b-486c-1dfa01ed5c3c%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025357.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Does Squid support client ssl termination?</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Does%20Squid%20support%20client%20ssl%20termination%3F&In-Reply-To=%3Cf1a6b704-38c0-321b-486c-1dfa01ed5c3c%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] Does Squid support client ssl termination?">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Wed Oct 26 17:38:01 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025357.html">[squid-users] Does Squid support client ssl termination?
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25358">[ date ]</a>
              <a href="thread.html#25358">[ thread ]</a>
              <a href="subject.html#25358">[ subject ]</a>
              <a href="author.html#25358">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/26/22 10:43 AM, mingheng wang wrote:
&gt;<i> Hello all,
</I>
Hi,

&gt;<i>  &#160; Since ssl_bump can generate self signed certificates on the fly, I 
</I>&gt;<i> wonder if this setup is possible, or even just in theory:
</I>&gt;<i> clients with necessary root CA installed connect to a local Squid. With 
</I>&gt;<i> ssl_bump and self signed certs,
</I>
I'm with you so far.  I've got such a Monkey in the Middle here at the 
house.

&gt;<i> it always talks with the clients over HTTPS,
</I>
Please clarify / confirm if you're talking about HTTPS protection of the 
client to squid connection.  --  I ask because not all clients natively 
/ easily support HTTPS connection to Squid.

N.B. the connection between the client and Squid is completely 
independent of the connection between Squid and the next upstream server.

&gt;<i> making clients believe their connections are secure;
</I>
This is the biggest hang up for me.  --  I don't think that the HTTPS 
communications with Squid in and of itself will cause clients to think 
that an insecure site is actually secure.

My client doesn't show that it has a secure connection to neverssl.com 
which doesn't support HTTPS (by design) despite communicating with Squid 
via HTTPS.

&gt;<i> the local Squid then forwards the connections to a parent Squid server, 
</I>&gt;<i> which however, will only send data back in plain HTTP, i.e. in clear 
</I>&gt;<i> text, akin to a reverse proxy with ssl termination to its proxied site.
</I>
Okay.  I'm not sure why you would not have encryption on the downstream 
child Squid to the upstream parent Squid, but that's your choice.

&gt;<i>  &#160; my goals are to cache data/modify requests even when connecting to 
</I>&gt;<i> https only sites,
</I>
Squid's TLS Monkey in the Middle should cache things without any 
problem.  So I don't see the need to do anything extra for this.

&gt;<i> while avoiding using self signed certs to encrypt connections over the 
</I>&gt;<i> Internet,
</I>
I have no idea where the downstream child Squid is that's doing TLS 
MitM.  Nor do I have any idea where the upstream parent Squid is.  So I 
can't really comment about locality / Internet.

&gt;<i> because this way, I can chain an https proxy with trusted certs 
</I>&gt;<i> in between.
</I>
&quot;Trusted certs&quot; is sort of ambiguous in this case as your TLS MitM 
/clients/ *trust* the root cert that the downstream child Squid is using.

I see no reason why you can't use similar methodology to protect the 
communications between the downstream child Squid to the upstream parent 
Squid.  --  Independent of who the cert used by the upstream parent 
Squid is from.

If the downstream child Squid has the root CA that signed the upstream 
parent Squid's TLS certificate in the downstream child Squid root CA 
store, then the connection between the two Squids is trusted.  Even if 
there are no public CAs involved.  }:-)



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20221026/e0d0181d/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20221026/e0d0181d/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025357.html">[squid-users] Does Squid support client ssl termination?
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25358">[ date ]</a>
              <a href="thread.html#25358">[ thread ]</a>
              <a href="subject.html#25358">[ subject ]</a>
              <a href="author.html#25358">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
