<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FW: Encrypted browser-Squid connection errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3C753b5a29-f2ac-1128-da8b-5c3b7ae7a043%40spamtrap.tnetconsulting.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025359.html">
   <LINK REL="Next"  HREF="025320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FW: Encrypted browser-Squid connection errors</H1>
    <B>Grant Taylor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FW%3A%20Encrypted%20browser-Squid%20connection%20errors&In-Reply-To=%3C753b5a29-f2ac-1128-da8b-5c3b7ae7a043%40spamtrap.tnetconsulting.net%3E"
       TITLE="[squid-users] FW: Encrypted browser-Squid connection errors">gtaylor at tnetconsulting.net
       </A><BR>
    <I>Mon Oct 31 22:38:09 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025359.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
        <LI>Next message (by thread): <A HREF="025320.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25362">[ date ]</a>
              <a href="thread.html#25362">[ thread ]</a>
              <a href="subject.html#25362">[ subject ]</a>
              <a href="author.html#25362">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/30/22 6:59 AM, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A> wrote:
&gt;<i> Duane W. would be the best one to ask about the details.
</I>&gt;<i> 
</I>&gt;<i> What I know is that some 10-12 years ago I discovered an message by 
</I>&gt;<i> Duane mentioning that W3C had (given or accepted) port 3128 for Squid 
</I>&gt;<i> use. I've checked the squid-cache archives and not seeing the message.
</I>&gt;<i> 
</I>&gt;<i> Right now it looks like the W3C changed their systems and only track the 
</I>&gt;<i> standards documents. So I cannot reference their (outdated?) protocol 
</I>&gt;<i> registry :-{ . Also checked the squid-cache archives and not finding it 
</I>&gt;<i> email history. Sorry.
</I>
Did you by chance mean IANA?

I looked and 3128 is registered to something other than Squid.

Nor did their search bring anything up for Squid.

&gt;<i> I mean &quot;authority&quot; as used by HTTP specification, which refers to 
</I>&gt;<i> <A HREF="https://www.rfc-editor.org/rfc/rfc3986#section-3.2">https://www.rfc-editor.org/rfc/rfc3986#section-3.2</A>
</I>&gt;<i> 
</I>&gt;<i> Yes exactly. That is the source of the problem, perpetuated by the need 
</I>&gt;<i> to retain on-wire byte/octet backward compatibility until HTTP/2 changed 
</I>&gt;<i> to binary format.
</I>&gt;<i> 
</I>&gt;<i> Consider what the proxy has to do when (not if) the IP:port being 
</I>&gt;<i> connected to are that proxy's (eg localhost:80) and the URL is only a 
</I>&gt;<i> path (&quot;/&quot;) on an origin server somewhere else. Does the &quot;GET / HTTP/1.0&quot; 
</I>&gt;<i> mean &quot;<A HREF="http://example.com/">http://example.com/</A>&quot; or &quot;<A HREF="http://example.net/">http://example.net/</A>&quot; ?
</I>
I would hope that it would return an error page, much like Squid does 
when it can't resolve a domain name or the connection times out.

&gt;<i> The key point is that the proxy host:port and the origin host:port are 
</I>&gt;<i> two different authority and only the origin may be passed along in the 
</I>&gt;<i> URL (or URL+Host header).
</I>
Agreed.

&gt;<i> When the client uses port 80 and 443 thinking 
</I>&gt;<i> they are origin services it is *required* (per 
</I>&gt;<i> <A HREF="https://www.rfc-editor.org/rfc/rfc9112.html#name-origin-form">https://www.rfc-editor.org/rfc/rfc9112.html#name-origin-form</A>) to omit 
</I>&gt;<i> the real origins info. Enter problems.
</I>
Why would a client (worth it's disk space) ever conflate the value of 
it's configured proxy as the origin server?

I can see a potential for confusion when using (network) transparent / 
intercepting proxies.

&gt;<i> I refer to all the many ways the clients may be explicitly or implicitly 
</I>&gt;<i> configured to be aware that it is talking to a proxy - such that it 
</I>&gt;<i> explicitly avoids sending the problematic origin-form URLs.
</I>
ACK

&gt;<i> The defaults though are tuned for origin server (or reverse-proxy) 
</I>&gt;<i> direct contact.
</I>
I don't see how that precludes their use for (forward) proxy servers.

&gt;<i> No Browser I know supports 
</I>&gt;<i> &quot;http-<A HREF="alt://proxy.example.com?http://origin.example.net/index.html">alt://proxy.example.com?http://origin.example.net/index.html</A>&quot; URLs.
</I>
But I bet that many browsers would support:

    <A HREF="http://proxy.example.com:8080/?http://origin.example.net/index.html">http://proxy.example.com:8080/?http://origin.example.net/index.html</A>

Also, I'm talking about &quot;<A HREF="http://">http://</A>&quot; and &quot;<A HREF="https://">https://</A>&quot; using their default 
ports of 80 &amp; 443.

&gt;<i> ... &quot;at your own risk&quot; they technically might be. So long as you only 
</I>&gt;<i> receive one of the three types of syntax there - port 80/443 being 
</I>&gt;<i> officially registered for origin / reverse-proxy syntax.
</I>
I've been using them without any known problem for multiple years across 
multiple platforms, clients, and versions thereof.  So I'll keep using 
it at my own risk.

&gt;<i> It is based on experience. Squid used to be a lot more lenient and tried 
</I>&gt;<i> for decades to do the syntax auto-detection. The path from that to 
</I>&gt;<i> separate ports is littered with CVEs. Most notably the curse that keeps 
</I>&gt;<i> on giving: CVE-2009-0801, which is just the trigger issue for a whole 
</I>&gt;<i> nest of bad side effects.
</I>
I wonder how much of that problematic history was related to HTTP/0.9 vs 
HTTP/1.0 vs HTTP/1.1 clients.

I similarly wonder how much HTTP/1.0, or even HTTP/0.9, protocol is used 
these days.

Also, there is the elephant in the room of we're talking about a proxy 
server which is frequently, but not always, on a dedicated system or IP. 
  As such, I have no problem predicating the use of the HTTP(80) and 
HTTPS(443) ports when there is no possible chance of confusion between 
forward proxy roles and origin server / reverse proxy roles.



-- 
Grant. . . .
unix || die

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4017 bytes
Desc: S/MIME Cryptographic Signature
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20221031/84078341/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20221031/84078341/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025359.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
	<LI>Next message (by thread): <A HREF="025320.html">[squid-users] FW: Encrypted browser-Squid connection errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25362">[ date ]</a>
              <a href="thread.html#25362">[ thread ]</a>
              <a href="subject.html#25362">[ subject ]</a>
              <a href="author.html#25362">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
