<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] logfileHandleWrite: daemon:/var/log/squid/access.log: error writing ((32) Broken pipe)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/log/squid/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3CCAGCa14q9QeX_fqH0bFPW5C8%3DCpssbx8zgw0CWE-MLAEivkTSyw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025171.html">
   <LINK REL="Next"  HREF="025173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] logfileHandleWrite: daemon:/var/log/squid/access.log: error writing ((32) Broken pipe)</H1>
    <B>roee klinger</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20logfileHandleWrite%3A%20daemon%3A/var/log/squid/access.log%3A%0A%20error%20writing%20%28%2832%29%20Broken%20pipe%29&In-Reply-To=%3CCAGCa14q9QeX_fqH0bFPW5C8%3DCpssbx8zgw0CWE-MLAEivkTSyw%40mail.gmail.com%3E"
       TITLE="[squid-users] logfileHandleWrite: daemon:/var/log/squid/access.log: error writing ((32) Broken pipe)">roeeklinger60 at gmail.com
       </A><BR>
    <I>Tue Sep  6 11:41:21 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025171.html">[squid-users] squid-users Digest, Vol 97, Issue 4
</A></li>
        <LI>Next message (by thread): <A HREF="025173.html">[squid-users] logfileHandleWrite: daemon:/var/log/squid/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25172">[ date ]</a>
              <a href="thread.html#25172">[ thread ]</a>
              <a href="subject.html#25172">[ subject ]</a>
              <a href="author.html#25172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I know this is a common issue, and I found many instances of people
complaining about it online, but I have not found a working fix yet.

It is also important to know that I am running multiple Squid instances on
the same machine, they are all getting the error at the same time, and I
have plenty of RAM and CPU available, some more info below.

Is a possible workaround that might be just replacing the line with this?
or will this cause a problem?

access_log /var/log/squid/access2.log




INFO -
Versions:

Squid Cache: Version 4.10
Ubuntu 20.04.4 LTS


Example squid.conf:

visible_hostname squid2

access_log daemon:/var/log/squid/access2.log squid

cache_log /var/log/squid/cache2.log

pid_filename /var/run/squid2.pid


acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 &quot;this&quot; network (LAN)

acl localnet src 10.0.0.0/8             # RFC 1918 local private network
(LAN)

acl localnet src 100.64.0.0/10          # RFC 6598 shared address space
(CGN)

acl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly
plugged) machines

acl localnet src 172.16.0.0/12          # RFC 1918 local private network
(LAN)

acl localnet src 192.168.0.0/16         # RFC 1918 local private network
(LAN)

acl localnet src fc00::/7               # RFC 4193 local private network
range

acl localnet src fe80::/10              # RFC 4291 link-local (directly
plugged) machines

acl SSL_ports port 443

acl Safe_ports port 80          # http

acl Safe_ports port 21          # ftp

acl Safe_ports port 443         # https

acl Safe_ports port 70          # gopher

acl Safe_ports port 210         # wais

acl Safe_ports port 1025-65535  # unregistered ports

acl Safe_ports port 280         # http-mgmt

acl Safe_ports port 488         # gss-http

acl Safe_ports port 591         # filemaker

acl Safe_ports port 777         # multiling http

acl CONNECT method CONNECT

http_access deny !Safe_ports

http_access deny CONNECT !SSL_ports

http_access allow localhost manager

http_access deny manager

# include /etc/squid/conf.d/*

http_access allow localhost

acl aws src *censored*

http_access allow aws

# http_access deny all

tcp_outgoing_address *censored*

http_port 10002

coredump_dir /var/spool/squid

refresh_pattern ^ftp:           1440    20%     10080

refresh_pattern ^gopher:        1440    0%      1440

refresh_pattern -i (/cgi-bin/|\?) 0     0%      0

refresh_pattern \/(Packages|Sources)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims

refresh_pattern \/Release(|\.gpg)$ 0 0% 0 refresh-ims

refresh_pattern \/InRelease$ 0 0% 0 refresh-ims

refresh_pattern \/(Translation-.*)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims

refresh_pattern .               0       20%     4320


shutdown_lifetime 1 seconds

logfile_rotate 0

max_filedescriptors 16384

dns_nameservers 8.8.8.8 8.8.4.4 1.1.1.1

cache deny all

cache_dir null /tmp

via off

forwarded_for off

request_header_access From deny all

request_header_access Server deny all

request_header_access WWW-Authenticate deny all

request_header_access Link deny all

request_header_access Cache-Control deny all

request_header_access Proxy-Connection deny all

request_header_access X-Cache deny all

request_header_access X-Cache-Lookup deny all

request_header_access Via deny all

request_header_access X-Forwarded-For deny all

request_header_access Pragma deny all

request_header_access Keep-Alive deny all

dns_v4_first on


Example service file:

## Copyright (C) 1996-2020 The Squid Software Foundation and contributors

##

## Squid software is distributed under GPLv2+ license and includes

## contributions from numerous individuals and organizations.

## Please see the COPYING and CONTRIBUTORS files for details.

##


[Unit]

Description=Squid Web Proxy Server

Documentation=man:squid(8)

After=network.target network-online.target nss-lookup.target


[Service]

Type=forking

PIDFile=/var/run/squid2.pid

ExecStartPre=/usr/sbin/squid --foreground -z -f /etc/squid/squid2.conf

ExecStart=/usr/sbin/squid -sYC -f /etc/squid/squid2.conf

ExecReload=/bin/kill -HUP $MAINPID

KillMode=mixed


[Install]

WantedBy=multi-user.target



Permissions:

&#10140;  ls -alt /etc/squid/
total 128
drwxr-xr-x   2 root root 4096 Sep  6 11:33 .
-rw-r--r--   1 root root 2831 Sep  6 11:33 squid7.conf
drwxr-xr-x 116 root root 4096 Sep  6 11:33 ..
-rw-r--r--   1 root root 2830 Sep  6 11:33 squid2.conf
-rw-r--r--   1 root root 2836 Sep  6 11:33 squid13.conf
-rw-r--r--   1 root root 2836 Sep  6 11:32 squid23.conf
-rw-r--r--   1 root root 2836 Sep  6 11:32 squid19.conf
-rw-r--r--   1 root root 2832 Sep  6 11:32 squid1.conf
-rw-r--r--   1 root root 2836 Sep  6 11:32 squid17.conf
-rw-r--r--   1 root root 2832 Sep  6 11:31 squid4.conf
-rw-r--r--   1 root root 2834 Sep  6 11:31 squid21.conf
-rw-r--r--   1 root root 2833 Sep  6 11:31 squid25.conf
-rw-r--r--   1 root root 2834 Sep  6 11:31 squid12.conf
-rw-r--r--   1 root root 2832 Sep  6 11:31 squid3.conf
-rw-r--r--   1 root root 2836 Sep  6 11:30 squid10.conf
-rw-r--r--   1 root root 2835 Sep  6 11:30 squid11.conf
-rw-r--r--   1 root root 2833 Sep  6 11:30 squid18.conf
-rw-r--r--   1 root root 2830 Sep  6 11:30 squid8.conf
-rw-r--r--   1 root root 2830 Sep  6 11:30 squid6.conf
-rw-r--r--   1 root root 2833 Sep  6 11:30 squid28.conf
-rw-r--r--   1 root root 2830 Sep  6 11:25 squid9.conf
-rw-r--r--   1 root root 2836 Sep  6 11:25 squid24.conf
-rw-r--r--   1 root root 2835 Sep  6 11:25 squid22.conf
-rw-r--r--   1 root root 2837 Sep  6 11:25 squid20.conf
-rw-r--r--   1 root root 2836 Sep  6 11:25 squid16.conf
-rw-r--r--   1 root root 2835 Sep  6 11:25 squid15.conf
-rw-r--r--   1 root root 2836 Sep  6 11:25 squid14.conf
-rw-r--r--   1 root root 2831 Sep  6 11:25 squid5.conf
-rw-r--r--   1 root root 2833 Sep  6 11:25 squid27.conf
-rw-r--r--   1 root root 2835 Sep  6 11:25 squid26.conf
-rw-r--r--   1 root root 2835 Sep  6 11:25 squid30.conf
-rw-r--r--   1 root root 2835 Sep  6 11:25 squid29.conf
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220906/8bbbc7af/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220906/8bbbc7af/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025171.html">[squid-users] squid-users Digest, Vol 97, Issue 4
</A></li>
	<LI>Next message (by thread): <A HREF="025173.html">[squid-users] logfileHandleWrite: daemon:/var/log/squid/access.log: error writing ((32) Broken pipe)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25172">[ date ]</a>
              <a href="thread.html#25172">[ thread ]</a>
              <a href="subject.html#25172">[ subject ]</a>
              <a href="author.html#25172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
