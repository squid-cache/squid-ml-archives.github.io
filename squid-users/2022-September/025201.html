<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Do squid logs performence affect general request performece?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Do%20squid%20logs%20performence%20affect%20general%20request%0A%20performece%3F&In-Reply-To=%3C9e76568b-a203-fe03-3025-8ff0a47fc2c5%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025199.html">
   <LINK REL="Next"  HREF="025210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Do squid logs performence affect general request performece?</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Do%20squid%20logs%20performence%20affect%20general%20request%0A%20performece%3F&In-Reply-To=%3C9e76568b-a203-fe03-3025-8ff0a47fc2c5%40measurement-factory.com%3E"
       TITLE="[squid-users] Do squid logs performence affect general request performece?">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Sep  9 16:56:48 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025199.html">[squid-users] Do squid logs performence affect general request performece?
</A></li>
        <LI>Next message (by thread): <A HREF="025210.html">[squid-users] Do squid logs performence affect general request performece?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25201">[ date ]</a>
              <a href="thread.html#25201">[ thread ]</a>
              <a href="subject.html#25201">[ subject ]</a>
              <a href="author.html#25201">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/9/22 08:49, roee klinger wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I have just recently started exploring ingesting logs from Squid via 
</I>&gt;<i> Logstash (TCP log ingestion)
</I>&gt;<i> 
</I>&gt;<i> I now have to make the decision of how to deploy Logstash, it seems to 
</I>&gt;<i> me that I have two options:
</I>&gt;<i> 
</I>&gt;<i>  1. Deploy a Logstash instance for every region where I have a Squid
</I>&gt;<i>     instance running, resulting in the lowest latency possible between
</I>&gt;<i>     Squid and Logstash.
</I>&gt;<i>  2. Deploy a central Logstash instance for all Squid instance worldwide,
</I>&gt;<i>     which is the cheapest and easiest option, but will have high latency
</I>&gt;<i>     for some of the Squid instance which are located far away
</I>&gt;<i>     geographically from the Logstash instance.
</I>&gt;<i> 
</I>&gt;<i> I already know that if the log server crashes in Squid, then Squid will 
</I>&gt;<i> crash with a fatal error,
</I>
FYI: Logging error handling is configurable via &quot;access_log on-error&quot;.


&gt;<i> so Squid takes logging very seriously, so my 
</I>&gt;<i> question is: does TCP logging performance in Squid effect the total 
</I>&gt;<i> request performance, or are they independent from each other?
</I>
TCP logger uses asynchronous non-blocking I/O. Individual HTTP 
transactions do not wait for individual log records to be sent. Needless 
to say, logging does consume resources and, hence, may affect overall 
HTTP transaction performance. And if the log record recipient is too 
slow, then Squid will die and/or log records will be dropped.


&gt;<i> What would be you recommendations, if request performance is crucial 
</I>&gt;<i> (and log performance is not)?
</I>
I would not be surprised if you would not be able to measure meaningful 
performance difference among these modules. From general performance 
point of view, and module-specific bugs and limitations notwithstanding, 
I would expect &quot;daemon&quot; and &quot;udp&quot; modules to have smaller performance 
overhead/cost for Squid workers than the &quot;tcp&quot; module because I expect 
that TCP has to &quot;do more&quot; than stdout I/O and UDP. However, I would not 
base this decision on such high-level speculations and test various 
options instead.


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025199.html">[squid-users] Do squid logs performence affect general request performece?
</A></li>
	<LI>Next message (by thread): <A HREF="025210.html">[squid-users] Do squid logs performence affect general request performece?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25201">[ date ]</a>
              <a href="thread.html#25201">[ thread ]</a>
              <a href="subject.html#25201">[ subject ]</a>
              <a href="author.html#25201">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
