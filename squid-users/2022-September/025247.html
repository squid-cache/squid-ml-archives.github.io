<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid performance recommendation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20performance%20recommendation&In-Reply-To=%3C004a01d8cddb%24622c6c40%24268544c0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025246.html">
   <LINK REL="Next"  HREF="025253.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid performance recommendation</H1>
    <B>ngtech1ltd at gmail.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20performance%20recommendation&In-Reply-To=%3C004a01d8cddb%24622c6c40%24268544c0%24%40gmail.com%3E"
       TITLE="[squid-users] Squid performance recommendation">ngtech1ltd at gmail.com
       </A><BR>
    <I>Wed Sep 21 16:58:31 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025246.html">[squid-users] Squid performance recommendation
</A></li>
        <LI>Next message (by thread): <A HREF="025253.html">[squid-users] Squid performance recommendation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25247">[ date ]</a>
              <a href="thread.html#25247">[ thread ]</a>
              <a href="subject.html#25247">[ subject ]</a>
              <a href="author.html#25247">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Szabolcs,
 
Since Amos answered your question regarding a simple VM I would like to refer to the k8s part.
 
A huge Kubernetes cluster is good for very specific use cases.
It&#8217;s not &#8220;easy&#8221; to scale and or change the config and update out of the box,
you will need to work on that since there aren&#8217;t any ready to use solutions for these on k8s.
&#8216;kubectl apply -f x.yaml&#8217; is not really a good solution for every scaling problem.
Also take into account that you will probably will have issues with cache HITS if the distribution
algorithm is unable to inflict the same requests to the same proxy.
 
With k8s since the *big* clusters usually is on BareMetal it&#8217;s possible to get up to 30 percent more
performance then a VMs. Also, the network latency is not so high in a k8s cluster for the same reason.
Basically, in most k8s clusters the traffic is almost like inside a shared memory.
 
It&#8217;s possible to define the specs of the project and to asses from there.
HAproxy will be able to handle 40k clients without any issues and to allow full HA you might need 2 HAproxy machines.
The real issue with such a setup is how the config is applied.
For example, a big list of black and whitelist domains might be better stored outside of squid.
Depends on your requirements you might be able to use either ufdbGuard or another solution.
 
There aren&#8217;t many differences between containerized squid to VM&#8217;s is not a lot. Actually, in the case of a simple forward proxy
it might be pretty simple to run a containerized squid on-top of a VM (which how k8s is most runs like these days).
 
As for autoscaling squid containers on-top of k8s, you will probably need to invest a lot more then a VM to make this fit your needs.
 
Since you mentioned more Administration time on a VM, it&#8217;s not true (to my opinion and experience).
There isn&#8217;t much of a difference between a VM and a container for a simple forward squid setup.
(it will be different if you need interception of connections)
 
If you do have more details on the required setup itself it would be pretty simple to find the right way for a good solution.
 
I really recommend you to read the next article:
<A HREF="https://ably.com/blog/no-we-dont-use-kubernetes">https://ably.com/blog/no-we-dont-use-kubernetes</A>
 
which touch many aspects of k8s vs VM&#8217;s.
 
I can try to give you an idea for implementation on VM&#8217;s but I am still missing couple pieces to understand the best.
 
Yours,
Eliezer
 
----
Eliezer Croitoru
NgTech, Tech Support
Mobile: +972-5-28704261
Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt; 
Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>
 
From: squid-users &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt; On Behalf Of Pint&#233;r Szabolcs
Sent: Tuesday, 20 September 2022 22:52
To: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: [squid-users] Squid performance recommendation
 
Hi squid community,
I need to find most best and sustainable way to build a stable High Availability squid cluster/solution for abou 40k user.
Parameters: I need HA, caching(little objects only not like big windows updates), scaling(It is just secondly), and I want to use and modify(in production,in working hours) complex black- and whitelists
I have some idea:

1. A huge kubernetes cluster 
pro: Easy to scale, change the config and update.
contra: I'm afraid of the network latency.(because of the most plus layers e.g. vm network stack, kubernetes network stack ith vxlan and etc.).
2. Simple VM-s with a HAProxy in tcp mode
pro: less network latency(I think)
contra: More time to Administration 


Has anybody any experience with squid in kubernetes(or similar technology) with a large number of useres?

What do you think which is the most perfect solution or do you have other idea for the implementation?

Thanks!

Best, Szabolcs
-- 
Pint&#233;r Szabolcs P&#233;ter
H-1117 Budapest, Neumann J&#225;nos u. 1. A &#233;p&#252;let 2. emelet
+36 1 489-4600 
+36 30 471-3827 
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">spinter at npsh.hu</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">spinter at npsh.hu</A>&gt; 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220921/e7daa420/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220921/e7daa420/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 3869 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20220921/e7daa420/attachment.png">http://lists.squid-cache.org/pipermail/squid-users/attachments/20220921/e7daa420/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025246.html">[squid-users] Squid performance recommendation
</A></li>
	<LI>Next message (by thread): <A HREF="025253.html">[squid-users] Squid performance recommendation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25247">[ date ]</a>
              <a href="thread.html#25247">[ thread ]</a>
              <a href="subject.html#25247">[ subject ]</a>
              <a href="author.html#25247">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
