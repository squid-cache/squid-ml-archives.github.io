<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Frequent disruption of Microsoft Teams and other online VC applications through Squid Proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Frequent%20disruption%20of%20Microsoft%20Teams%20and%20other%0A%20online%20VC%20applications%20through%20Squid%20Proxy&In-Reply-To=%3Cf46c93c7-b2d7-cd64-4a06-9f2116c7e7df%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025263.html">
   <LINK REL="Next"  HREF="025269.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Frequent disruption of Microsoft Teams and other online VC applications through Squid Proxy</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Frequent%20disruption%20of%20Microsoft%20Teams%20and%20other%0A%20online%20VC%20applications%20through%20Squid%20Proxy&In-Reply-To=%3Cf46c93c7-b2d7-cd64-4a06-9f2116c7e7df%40treenet.co.nz%3E"
       TITLE="[squid-users] Frequent disruption of Microsoft Teams and other online VC applications through Squid Proxy">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Sep 29 12:32:48 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025263.html">[squid-users] Frequent disruption of Microsoft Teams and other online VC applications through Squid Proxy
</A></li>
        <LI>Next message (by thread): <A HREF="025269.html">[squid-users] sarg error in squid 5.7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25265">[ date ]</a>
              <a href="thread.html#25265">[ thread ]</a>
              <a href="subject.html#25265">[ subject ]</a>
              <a href="author.html#25265">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/09/22 23:11, Punyasloka Arya wrote:
&gt;<i> We have our squid 3.5 proxy running on centos 6 for 500 users
</I>&gt;<i> Desktop video conference application Microsoft Team Meetings sessions and
</I>&gt;<i> other VC apps often get disconnected. Audio goes off and reconnects
</I>&gt;<i> automatically.
</I>&gt;<i> At the same time browsing and other applications  work fine.
</I>&gt;<i> At the same time SQUID load is normal. we are clueless where to look into the
</I>&gt;<i> system
</I>&gt;<i> 
</I>&gt;<i> Any clues to fine tune the underlying parameters like File desriptors, cahce
</I>&gt;<i> parameters etc.
</I>&gt;<i> 
</I>
Please first check whether Squid is actually involved with those 
software transactions. Typically those type of communications should be 
using RTSP/RTMP or VoIP protocols which Squid-3 does not support.


When Squid-3 does handle CONNECT for non-HTTP protocols (including 
encrypted HTTPS) its involvement is purely that of shuffling bytes 
between client and server. So the things to look for there are TCP level 
network issues (eg TCP, NAT, or router cache timeouts) closing 
connections unexpectedly.

If you have Squid Delay Pools configured that may also be interfering 
with connections that need high traffic flow rates.


Check how much traffic Squid is handling at the time(s) these issues 
occur. Squid-3.5 has upper limits of around 19K requests/second and ~63K 
concurrent client connections (on Linux/BSD, much lower on Windows). If 
either of these limits are encountered traffic speeds *will* drastically 
reduce speed until the clients adjust to a lower level.
  - The fix for these if you actually hit the upper limits is to use 
more Squid instances (on different hardware, not VMs on same HW) to 
share the traffic load.
  - If the speed drop occurs before hitting the limits you can try 
optimizing squid.conf settings (ACL sequence in particular), TCP stack 
settings (ie. ephemeral ports use and/or TCP flow controls) for performance.


Also check cache.log to see if Squid, workers, or helpers are 
halting/crashing at all. These are not very consistent in Squid-3 but 
should show up as one or more &quot;FATAL&quot;, &quot;ERROR&quot;, &quot;assertion failed&quot;, or 
&quot;unhandled exception&quot;, or &quot;halted&quot; messages.
  - The fix here is obviously to figure out and prevent the crashes 
occuring. Each log message and ones above it should provide some hints 
to help with troubleshooting.



FWIW, Squid-3.5 is long out of support and AFAIK CentOS 6 is also.


HTH
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025263.html">[squid-users] Frequent disruption of Microsoft Teams and other online VC applications through Squid Proxy
</A></li>
	<LI>Next message (by thread): <A HREF="025269.html">[squid-users] sarg error in squid 5.7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25265">[ date ]</a>
              <a href="thread.html#25265">[ thread ]</a>
              <a href="subject.html#25265">[ subject ]</a>
              <a href="author.html#25265">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
