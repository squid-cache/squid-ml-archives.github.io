<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Use ICP RTT with HTTPS request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Use%20ICP%20RTT%20with%20HTTPS%20request&In-Reply-To=%3C9bc3a5d5-df50-9e99-38a7-7462db449f29%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025260.html">
   <LINK REL="Next"  HREF="025256.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Use ICP RTT with HTTPS request</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Use%20ICP%20RTT%20with%20HTTPS%20request&In-Reply-To=%3C9bc3a5d5-df50-9e99-38a7-7462db449f29%40treenet.co.nz%3E"
       TITLE="[squid-users] Use ICP RTT with HTTPS request">squid3 at treenet.co.nz
       </A><BR>
    <I>Thu Sep 29 12:58:17 UTC 2022</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025260.html">[squid-users] Use ICP RTT with HTTPS request
</A></li>
        <LI>Next message (by thread): <A HREF="025256.html">[squid-users] TCP_MISS only
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25266">[ date ]</a>
              <a href="thread.html#25266">[ thread ]</a>
              <a href="subject.html#25266">[ subject ]</a>
              <a href="author.html#25266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/09/22 02:25, Alex Rousskov wrote:
&gt;<i> On 9/26/22 05:51, Th&#233;o BARRAGUE wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> &#160;entry is null so peerGetSomeNeighbor is never called
</I>&gt;<i> 
</I>&gt;<i> I did not check all the details, but it looks like Squid ICMP code 
</I>&gt;<i> (ab)uses StoreEntry-linked metadata. Basic CONNECT tunnels lack 
</I>&gt;<i> StoreEntry because they are not reading/writing data from/to Store. The 
</I>&gt;<i> combination is essentially a Squid bug -- basic CONNECT tunnels cannot 
</I>&gt;<i> use ICMP features.
</I>&gt;<i> 
</I>
CONNECT tunnel should be able to use data from ICMP like other code 
doing peer selection.


I see several bugs here:

  1) ICMP relying on StoreEntry as a data source. The server (if not a 
cache_peer) being ping'ed should come from the CONNECT request object URI.

  2) peer selection initiating ICMP directly. It should be retrieving 
RTT values from NetDB, which indirectly uses ICMP to get updates.


Cheers
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025260.html">[squid-users] Use ICP RTT with HTTPS request
</A></li>
	<LI>Next message (by thread): <A HREF="025256.html">[squid-users] TCP_MISS only
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25266">[ date ]</a>
              <a href="thread.html#25266">[ thread ]</a>
              <a href="subject.html#25266">[ subject ]</a>
              <a href="author.html#25266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
