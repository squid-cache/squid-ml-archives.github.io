<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] idnsSendQuery: Can't send query, no DNS socket!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20idnsSendQuery%3A%20Can%27t%20send%20query%2C%20no%20DNS%20socket%21&In-Reply-To=%3C%21%26%21AAAAAAAAAAAuAAAAAAAAAIVNjRjcTGZElYgADq7oyvYBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAADmlE4679IMTIhoBT3ictBTAQAAAAA%3D%40articatech.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025774.html">
   <LINK REL="Next"  HREF="025746.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] idnsSendQuery: Can't send query, no DNS socket!</H1>
    <B>andre.bolinhas at articatech.com</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20idnsSendQuery%3A%20Can%27t%20send%20query%2C%20no%20DNS%20socket%21&In-Reply-To=%3C%21%26%21AAAAAAAAAAAuAAAAAAAAAIVNjRjcTGZElYgADq7oyvYBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAADmlE4679IMTIhoBT3ictBTAQAAAAA%3D%40articatech.com%3E"
       TITLE="[squid-users] idnsSendQuery: Can't send query, no DNS socket!">andre.bolinhas at articatech.com
       </A><BR>
    <I>Mon Apr 10 21:14:42 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025774.html">[squid-users] Is there any squid 4.x tested with Delay pools to work and limit well ?
</A></li>
        <LI>Next message (by thread): <A HREF="025746.html">[squid-users] idnsSendQuery: Can't send query, no DNS socket!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25744">[ date ]</a>
              <a href="thread.html#25744">[ thread ]</a>
              <a href="subject.html#25744">[ subject ]</a>
              <a href="author.html#25744">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all

We have experienced some issue on our squid servers, time to times the
listen port fails and users are unable to connected to the proxy.
We already try use squid 4.17 and squid 5.8 but had the same issue on both
version, you can find I GDrive the extract of the cache.log on the time of
the failure.

<A HREF="https://drive.google.com/file/d/1gZ-ITgH4PUOr7FuKaEr3qKRn-_4duspK/view?usp=s">https://drive.google.com/file/d/1gZ-ITgH4PUOr7FuKaEr3qKRn-_4duspK/view?usp=s</A>
haring

On the cache log I see to many
idnsSendQuery: Can't send query, no DNS socket!
And
2023/04/10 16:25:59 kid4| Waiting 10 seconds for active connections to
finish
2023/04/10 16:25:59 kid4| Preparing for shutdown after 763 requests

This is the dns configuration squid/dns.conf
# Return DNS used by the system (means resolv.conf)
client_dst_passthru off
host_verify_strict off
ignore_unknown_nameservers off
dns_retransmit_interval 3 seconds
dns_v4_first on
ipcache_size 16384
ipcache_low 90
ipcache_high 95
fqdncache_size 1024
positive_dns_ttl 6 hours
negative_dns_ttl 300 seconds

Resolv.conf
domain xyz.my
search xyz.my
options attempts:2 timeout:2
nameserver 127.0.0.1
nameserver 8.8.8.8
nameserver 1.1.1.1

127.0.0.1 is the unbound internal DNS.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025774.html">[squid-users] Is there any squid 4.x tested with Delay pools to work and limit well ?
</A></li>
	<LI>Next message (by thread): <A HREF="025746.html">[squid-users] idnsSendQuery: Can't send query, no DNS socket!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25744">[ date ]</a>
              <a href="thread.html#25744">[ thread ]</a>
              <a href="subject.html#25744">[ subject ]</a>
              <a href="author.html#25744">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
