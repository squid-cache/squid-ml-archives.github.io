<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] IP based user identification/authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IP%20based%20user%20identification/authentication&In-Reply-To=%3CCADJd0Y2mxxd3OMUEeHbKa25PhrE2DtsdjgeVBjOdyk3MXczEkA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026321.html">
   <LINK REL="Next"  HREF="026323.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] IP based user identification/authentication</H1>
    <B>Andrey K</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20IP%20based%20user%20identification/authentication&In-Reply-To=%3CCADJd0Y2mxxd3OMUEeHbKa25PhrE2DtsdjgeVBjOdyk3MXczEkA%40mail.gmail.com%3E"
       TITLE="[squid-users] IP based user identification/authentication">ankor2023 at gmail.com
       </A><BR>
    <I>Thu Dec  7 15:40:54 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026321.html">[squid-users] IP based user identification/authentication
</A></li>
        <LI>Next message (by thread): <A HREF="026323.html">[squid-users] IP based user identification/authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26322">[ date ]</a>
              <a href="thread.html#26322">[ thread ]</a>
              <a href="subject.html#26322">[ subject ]</a>
              <a href="author.html#26322">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, Amos,

Thank you for your comments.
I must have described the scenario incorrectly, I'll try again in more
detail.


Let's say we have a system that collects information that a user logged in
to a computer (it can, for example, read security logs from Active
Directory). Thus, it has a match of the user's login and the host's IP
address. Let's call it Awareness system.

When a request comes to SQUID, and the policy reaches the rules where user
information is required (for example &quot;*http_access allow auth&quot;*), an
external helper must be called, and the src IP address would be passed to
it.
The helper accesses the  Awareness system and asks if it has information
about the user registered on the host with this source IP address.

If the user is found, the helper must return his username to the SQUID.
SQUID should assign this username to the *%LOGIN* variable. And then this
session should be considered authenticated (for example, it should match
the &quot;*acl aclname proxy_auth username*&quot; acls). Next, authorization helpers
may be launched for it (for example, *ext_wbinfo_group_acl*) if necessary
according to the policy.

If there is no information about the user in the external system and
additional authentication helpers are registered in the proxy configuration
(for example, auth_param negotiate program negotiate_wrapper_auth), then
SQUID should return a 407 response and use basic/ntlm/negotiate
authentication methods as usual.

The described process is definitely not authorization, it is rather user
identification.

I hope I've cleared things up a bit.

Kind regards,
      Ankor.



&#1095;&#1090;, 7 &#1076;&#1077;&#1082;. 2023&#8239;&#1075;. &#1074; 13:39, Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;:

&gt;<i> On 7/12/23 15:34, Andrey K wrote:
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was interested if I can configure some custom external helper that
</I>&gt;<i> &gt; will be called before any authentication helpers and can perform user
</I>&gt;<i> &gt; identification/authentication based on the client src-IP address.
</I>&gt;<i>
</I>&gt;<i> Well, yes and no.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The order of authentication and authorization helpers is determined by
</I>&gt;<i> what order you configure http_access tests.
</I>&gt;<i>
</I>&gt;<i> So &quot;yes&quot; in that you can call it before authentication, and have it tell
</I>&gt;<i> you what &quot;user&quot; it *thinks* is using that IP.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However, ...
</I>&gt;<i>
</I>&gt;<i> &gt; It can look up in the external system information about the user logged
</I>&gt;<i> &gt; in to the IP address and return the username and some annotation
</I>&gt;<i> &gt; information on success.
</I>&gt;<i>
</I>&gt;<i> Users do not &quot;log into IP address&quot; and ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; If the user has been identified, no subsequent authentications are
</I>&gt;<i> required.
</I>&gt;<i> &gt; Identified users can be authorized later using standard squid mechanisms
</I>&gt;<i> &gt; (for example, ldap user groups membership).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This feature can be especially useful in &quot;transparent&quot; proxy
</I>&gt;<i> &gt; configurations where 407-&quot;Proxy Authentication Required&quot; response code
</I>&gt;<i> &gt; is not applicable.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ... with interception the user agent is not aware of the proxy
</I>&gt;<i> existence. So it *will not* provide the credentials necessary for
</I>&gt;<i> authentication. Not to the proxy, nor a helper.
</I>&gt;<i>
</I>&gt;<i> So &quot;no&quot;.
</I>&gt;<i>
</I>&gt;<i> This is not a way to authenticate. It is a way to **authorize**. The
</I>&gt;<i> difference is very important.
</I>&gt;<i>
</I>&gt;<i> For more info lookup &quot;captive portal&quot; on how this type of configuration
</I>&gt;<i> is done and used.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i> Amos
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20231207/1787e313/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20231207/1787e313/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026321.html">[squid-users] IP based user identification/authentication
</A></li>
	<LI>Next message (by thread): <A HREF="026323.html">[squid-users] IP based user identification/authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26322">[ date ]</a>
              <a href="thread.html#26322">[ thread ]</a>
              <a href="subject.html#26322">[ subject ]</a>
              <a href="author.html#26322">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
