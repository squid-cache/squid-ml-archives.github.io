<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%0A%20why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok&In-Reply-To=%3Ce4d6cef4-ec65-974a-097c-3274e163986c%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025606.html">
   <LINK REL="Next"  HREF="025608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%0A%20why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok&In-Reply-To=%3Ce4d6cef4-ec65-974a-097c-3274e163986c%40measurement-factory.com%3E"
       TITLE="[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Feb  3 18:15:34 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025606.html">[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok
</A></li>
        <LI>Next message (by thread): <A HREF="025608.html">[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25607">[ date ]</a>
              <a href="thread.html#25607">[ thread ]</a>
              <a href="subject.html#25607">[ subject ]</a>
              <a href="author.html#25607">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/3/23 10:08, Tom JABBER wrote:

&gt;<i> As said in subject, if parent proxy returns a non 200 OK code along with 
</I>&gt;<i> some HTML body, &quot;child&quot; proxy reuses parent headers, which is already a 
</I>&gt;<i> matter of discussion, and among other headers, a content-length &gt; 0 
</I>&gt;<i> while not forwarding the HTML received from parent.
</I>&gt;<i> 
</I>&gt;<i> cf. 
</I>&gt;<i> <A HREF="https://superuser.com/questions/1765082/why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok">https://superuser.com/questions/1765082/why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok</A>
</I>&gt;<i> 
</I>&gt;<i> Would there be anyone here willing to help ?
</I>
It is a known Squid bug. AFAIK, the bug does not have a simple 
general-purpose fix, and there is probably relatively little demand for 
fixing it because popular browsers pretty much ignore CONNECT response 
headers (except for proxy authentication) and body (always?).

It is possible to modify Squid to stop promising to send the cache_peer 
response body (at an HTTP framing level), but it is probably better (and 
easier!) to modify Squid to just generate a short error response from 
scratch (instead of forwarding cache_peer response headers without a 
body). Doing so will probably break some use cases, so such a change may 
be officially rejected, but, even if it is, it may still work/help in 
some other specific use cases.

<A HREF="https://wiki.squid-cache.org/SquidFaq/AboutSquid#how-to-add-a-new-squid-feature-enhance-of-fix-something">https://wiki.squid-cache.org/SquidFaq/AboutSquid#how-to-add-a-new-squid-feature-enhance-of-fix-something</A>


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025606.html">[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok
</A></li>
	<LI>Next message (by thread): <A HREF="025608.html">[squid-users] why-squid-reuse-headers-from-parent-but-not-the-html-body-when-not-200-ok
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25607">[ date ]</a>
              <a href="thread.html#25607">[ thread ]</a>
              <a href="subject.html#25607">[ subject ]</a>
              <a href="author.html#25607">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
