<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Update from Squid 4 to Squid 5 :
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Update%20from%20Squid%204%20to%20Squid%205%20%3A&In-Reply-To=%3Cacdc53c1-6b2f-402e-5b71-a2c913699a54%40stemarie-aizenay.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025622.html">
   <LINK REL="Next"  HREF="025627.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Update from Squid 4 to Squid 5 :</H1>
    <B>Bertrand Friconneau</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Update%20from%20Squid%204%20to%20Squid%205%20%3A&In-Reply-To=%3Cacdc53c1-6b2f-402e-5b71-a2c913699a54%40stemarie-aizenay.fr%3E"
       TITLE="[squid-users] Update from Squid 4 to Squid 5 :">bfriconneau at stemarie-aizenay.fr
       </A><BR>
    <I>Mon Feb 13 08:40:53 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025622.html">[squid-users] [EXTERNAL] Access to internal domains using Squid
</A></li>
        <LI>Next message (by thread): <A HREF="025627.html">[squid-users] HTTPS Request Header acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25626">[ date ]</a>
              <a href="thread.html#25626">[ thread ]</a>
              <a href="subject.html#25626">[ subject ]</a>
              <a href="author.html#25626">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone,

My problem is fixed.

And my Squid server up to date (Ubuntu 22.04 LTS).

Finaly my problem was not about squid but about DNS.

Ubuntu could'nt find any more my AD server.

Solution :
Modify 2 files :
/etc/resolvconf/resolv.conf.d/head
/etc/resolv.conf

And put in it this line :
nameserver &lt;ip of my AD/DNS server&gt;

After serveral reboot/restart, the configuration is always in use.

Thanks for the help

Regards

Bertrand Friconneau





Le 15/12/2022 &#224; 11:06, Bertrand Friconneau a &#233;crit&#160;:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Here is the content of my actual /etc/resolv.conf (ubuntu 20.04) :
</I>&gt;<i> ------------------------------------------------------------------------------------------------ 
</I>&gt;<i>
</I>&gt;<i> # Dynamic resolv.conf(5) file for glibc resolver(3) generated by 
</I>&gt;<i> resolvconf(8)
</I>&gt;<i> #&#160;&#160;&#160;&#160; DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
</I>&gt;<i> # 127.0.0.53 is the systemd-resolved stub resolver.
</I>&gt;<i> # run &quot;systemd-resolve --status&quot; to see details about the actual 
</I>&gt;<i> nameservers.
</I>&gt;<i>
</I>&gt;<i> nameserver 172.20.0.1
</I>&gt;<i> nameserver 127.0.0.53
</I>&gt;<i> search stemarie-aizenay.local
</I>&gt;<i> ------------------------------------------------------------------------------------------------ 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Bruno, thanks for the suggestions.
</I>&gt;<i>
</I>&gt;<i> I will try after Christmas Hollidays.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i>
</I>&gt;<i> Bertrand Friconneau
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Le 14/12/2022 &#224; 13:26, Bruno de Paula Larini a &#233;crit&#160;:
</I>&gt;&gt;<i> Em 13/12/2022 19:46, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> escreveu:
</I>&gt;&gt;&gt;<i> Hey,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> What is the content of:
</I>&gt;&gt;&gt;<i> /etc/resolv.conf
</I>&gt;&gt;&gt;<i> ?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It could be something related to default systemd dns services.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Eliezer
</I>&gt;&gt;&gt;<i> ----
</I>&gt;&gt;&gt;<i> Eliezer Croitoru
</I>&gt;&gt;&gt;<i> NgTech, Tech Support
</I>&gt;&gt;&gt;<i> Mobile: +972-5-28704261
</I>&gt;&gt;&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>
</I>&gt;&gt;&gt;<i> Web: <A HREF="https://ngtech.co.il/">https://ngtech.co.il/</A>
</I>&gt;&gt;&gt;<i> My-Tube: <A HREF="https://tube.ngtech.co.il/">https://tube.ngtech.co.il/</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> Yep, I had the same issues when I upgraded from 4 to 5, because I 
</I>&gt;&gt;<i> also upgraded the distro version along with it, and systemd-resolved 
</I>&gt;&gt;<i> is enabled by default in some, such as Fedora and Ubuntu. It stopped 
</I>&gt;&gt;<i> resolving local domain names for some reason.
</I>&gt;&gt;<i> Instead of struggling to make it work on the new model, I simply 
</I>&gt;&gt;<i> disabled systemd-resolved and went back to old resolv.conf style.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'll quote the solution I followed here: 
</I>&gt;&gt;<i> <A HREF="https://askubuntu.com/questions/907246/how-to-disable-systemd-resolved-in-ubuntu">https://askubuntu.com/questions/907246/how-to-disable-systemd-resolved-in-ubuntu</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ====
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This method works on the Ubuntu releases 17.04 (Zesty), 17.10 
</I>&gt;&gt;<i> (Artful), 18.04 (Bionic), 18.10 (Cosmic), 19.04 (Disco) and 20.04 
</I>&gt;&gt;<i> (Focal):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Disable and stop the systemd-resolved service:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sudo systemctl disable systemd-resolved
</I>&gt;&gt;<i> sudo systemctl stop systemd-resolved
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Then put the following line in the [main] section of your 
</I>&gt;&gt;<i> /etc/NetworkManager/NetworkManager.conf:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> dns=default
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Delete the symlink /etc/resolv.conf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> rm /etc/resolv.conf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Restart NetworkManager
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sudo systemctl restart NetworkManager
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also be aware that disabling systemd-resolvd might break name 
</I>&gt;&gt;<i> resolution in VPN for some users. See this bug on launchpad (Thanks, 
</I>&gt;&gt;<i> Vincent).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ===
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025622.html">[squid-users] [EXTERNAL] Access to internal domains using Squid
</A></li>
	<LI>Next message (by thread): <A HREF="025627.html">[squid-users] HTTPS Request Header acl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25626">[ date ]</a>
              <a href="thread.html#25626">[ thread ]</a>
              <a href="subject.html#25626">[ subject ]</a>
              <a href="author.html#25626">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
