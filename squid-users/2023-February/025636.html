<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Portal%20Splash%20Page%204.7%20-%3E%205.7%20FATAL%3A%0A%20%28ext_session_acl%29%3A%20Failed%20to%20open%20session%20db&In-Reply-To=%3Ce9176547-ae57-1a7b-99bf-093d280fecaf%40dsi-as.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025634.html">
   <LINK REL="Next"  HREF="025638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db</H1>
    <B>MATYAS, Tibor</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Portal%20Splash%20Page%204.7%20-%3E%205.7%20FATAL%3A%0A%20%28ext_session_acl%29%3A%20Failed%20to%20open%20session%20db&In-Reply-To=%3Ce9176547-ae57-1a7b-99bf-093d280fecaf%40dsi-as.de%3E"
       TITLE="[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db">tibor.matyas at dsi-as.de
       </A><BR>
    <I>Fri Feb 17 14:20:50 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025634.html">[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db
</A></li>
        <LI>Next message (by thread): <A HREF="025638.html">[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25636">[ date ]</a>
              <a href="thread.html#25636">[ thread ]</a>
              <a href="subject.html#25636">[ subject ]</a>
              <a href="author.html#25636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here are my further experiments:
#1 Created an empty tdb database with tdbtool,
the errors are gone, although no sessions are stored, the file remains 
untouched.

#2 recompiled squid without tdb -&gt; fallback to berkeleydb ? like in 4.x:
same errors in the log:

FATAL: (ext_session_acl): Failed to open session db '/tmp/session/session'
2023/02/17 15:09:15 kid1| WARNING: external_acl_type #Hlpr112520 exited
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| Too few external_acl_type processes are 
running (need 1/5)
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| Starting new helpers
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| helperOpenServers: Starting 1/5 
'ext_session_acl' processes
 &#160;&#160;&#160; current master transaction: master3
FATAL: (ext_session_acl): Failed to open session db '/tmp/session/session'
2023/02/17 15:09:15 kid1| WARNING: external_acl_type #Hlpr112521 exited
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| Too few external_acl_type processes are 
running (need 1/5)
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| Starting new helpers
 &#160;&#160;&#160; current master transaction: master3
2023/02/17 15:09:15 kid1| helperOpenServers: Starting 1/5 
'ext_session_acl' processes
 &#160;&#160;&#160; current master transaction: master3

An empty session file with zero byte is always created (with or without 
tdb), and then the error flow.

Searched on the internet without result. Hopefully someone is still 
using splash with version 5

br, Tibor

Am 17.02.2023 um 10:09 schrieb MATYAS, Tibor:
&gt;<i> Hello List,
</I>&gt;<i>
</I>&gt;<i> trying to move from 4.7 to 5.7 (on gentoo Linux).
</I>&gt;<i> Splash portal is in use 
</I>&gt;<i> <A HREF="https://wiki.squid-cache.org/ConfigExamples/Portal/Splash">https://wiki.squid-cache.org/ConfigExamples/Portal/Splash</A>
</I>&gt;<i>
</I>&gt;<i> squid -k parse -&gt; OK
</I>&gt;<i> /var/lib/squid/session/ is clean, old berkeleyDB session files deleted.
</I>&gt;<i> Owner of the folder is the squid user.
</I>&gt;<i>
</I>&gt;<i> Squid compiled with tdb:
</I>&gt;<i>
</I>&gt;<i> Squid Cache: Version 5.7
</I>&gt;<i> Service Name: squid
</I>&gt;<i> Gentoo squid-5.7-r1 (r: NONE)
</I>&gt;<i> This binary uses OpenSSL 1.1.1t&#160; 7 Feb 2023. For legal restrictions on 
</I>&gt;<i> distribution see <A HREF="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</A>
</I>&gt;<i> configure options:&#160; '--prefix=/usr' '--build=x86_64-pc-linux-gnu' 
</I>&gt;<i> '--host=x86_64-pc-linux-gnu' '--mandir=/usr/share/man' 
</I>&gt;<i> '--infodir=/usr/share/info' '--datadir=/usr/share' '--sysconfdir=/etc' 
</I>&gt;<i> '--localstatedir=/var/lib' '--datarootdir=/usr/share' 
</I>&gt;<i> '--disable-dependency-tracking' '--disable-silent-rules' 
</I>&gt;<i> '--disable-static' '--docdir=/usr/share/doc/squid-5.7-r1' 
</I>&gt;<i> '--htmldir=/usr/share/doc/squid-5.7-r1/html' '--with-sysroot=/' 
</I>&gt;<i> '--libdir=/usr/lib64' '--datadir=/usr/share/squid' 
</I>&gt;<i> '--libexecdir=/usr/libexec/squid' '--localstatedir=/var' 
</I>&gt;<i> '--sysconfdir=/etc/squid' '--with-default-user=squid' 
</I>&gt;<i> '--with-logdir=/var/log/squid' '--with-pidfile=/run/squid.pid' 
</I>&gt;<i> '--enable-build-info=Gentoo squid-5.7-r1 (r: NONE)' 
</I>&gt;<i> '--enable-log-daemon-helpers' '--enable-url-rewrite-helpers' 
</I>&gt;<i> '--enable-cache-digests' '--enable-delay-pools' '--enable-disk-io' 
</I>&gt;<i> '--enable-eui' '--enable-icmp' '--enable-ipv6' 
</I>&gt;<i> '--enable-follow-x-forwarded-for' '--enable-removal-policies=lru,heap' 
</I>&gt;<i> '--disable-strict-error-checking' '--disable-arch-native' 
</I>&gt;<i> '--with-large-files' '--with-build-environment=default' '--with-tdb' 
</I>&gt;<i> '--without-included-ltdl' '--with-ltdl-include=/usr/include' 
</I>&gt;<i> '--with-ltdl-lib=/usr/lib64' '--with-libcap' '--enable-snmp' 
</I>&gt;<i> '--with-openssl' '--with-nettle' '--with-gnutls' '--enable-ssl-crtd' 
</I>&gt;<i> '--without-systemd' '--without-cppunit' '--disable-ecap' 
</I>&gt;<i> '--disable-esi' '--disable-expat' '--disable-libxml2' '--enable-htcp' 
</I>&gt;<i> '--enable-wccp' '--enable-wccpv2' '--without-mit-krb5' 
</I>&gt;<i> '--without-heimdal-krb5' '--enable-linux-netfilter' 
</I>&gt;<i> '--enable-storeio=aufs,diskd,rock,ufs' 
</I>&gt;<i> '--enable-auth-basic=NCSA,POP3,getpwnam,PAM' 
</I>&gt;<i> '--enable-auth-digest=file' '--enable-auth-ntlm=none' 
</I>&gt;<i> '--enable-auth-negotiate=none' 
</I>&gt;<i> '--enable-external-acl-helpers=file_userip,session,unix_group,delayer,time_quota' 
</I>&gt;<i> 'build_alias=x86_64-pc-linux-gnu' 'host_alias=x86_64-pc-linux-gnu' 
</I>&gt;<i> 'CC=x86_64-pc-linux-gnu-gcc' 'CFLAGS=-march=nocona -O2 -pipe 
</I>&gt;<i> -fomit-frame-pointer' 'LDFLAGS=-Wl,-O1 -Wl,--as-needed' 
</I>&gt;<i> 'CXXFLAGS=-march=nocona -O2 -pipe -fomit-frame-pointer' 
</I>&gt;<i> 'BUILDCXX=x86_64-pc-linux-gnu-g++' 'BUILDCXXFLAGS=-march=nocona -O2 
</I>&gt;<i> -pipe -fomit-frame-pointer'
</I>&gt;<i>
</I>&gt;<i> starting squid results in:
</I>&gt;<i>
</I>&gt;<i> FATAL: (ext_session_acl): Failed to open session db 
</I>&gt;<i> '/var/lib/squid/session/session'
</I>&gt;<i> 2023/02/17 09:21:11 kid1| WARNING: external_acl_type #Hlpr27652 exited
</I>&gt;<i> &#160;&#160;&#160; current master transaction: master3
</I>&gt;<i> 2023/02/17 09:21:11 kid1| Too few external_acl_type processes are 
</I>&gt;<i> running (need 1/1)
</I>&gt;<i> &#160;&#160;&#160; current master transaction: master3
</I>&gt;<i> 2023/02/17 09:21:11 kid1| Starting new helpers
</I>&gt;<i> &#160;&#160;&#160; current master transaction: master3
</I>&gt;<i> 2023/02/17 09:21:11 kid1| helperOpenServers: Starting 1/1 
</I>&gt;<i> 'ext_session_acl' processes
</I>&gt;<i> &#160;&#160;&#160; current master transaction: master3
</I>&gt;<i>
</I>&gt;<i> What am I missing?
</I>&gt;<i>
</I>&gt;<i> Thanks a lot and br
</I>&gt;<i> Tibor
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>


--------------------------------------------------
DSI Aerospace Technologie GmbH

Sitz der Gesellschaft: Otto-Lilienthal-Str. 1, D-28199 Bremen, Germany
Web: <A HREF="http://www.dsi-as.de">http://www.dsi-as.de</A>

Geschaeftsfuehrer: Dr.-Ing. Christian Dierker
                   M. Sc. Elias Hashem

HRB 17726, Amtsgericht Bremen
USt-IdNr.: DE 192 681 774
--------------------------------------------------




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025634.html">[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db
</A></li>
	<LI>Next message (by thread): <A HREF="025638.html">[squid-users] Portal Splash Page 4.7 -&gt; 5.7 FATAL: (ext_session_acl): Failed to open session db
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25636">[ date ]</a>
              <a href="thread.html#25636">[ thread ]</a>
              <a href="subject.html#25636">[ subject ]</a>
              <a href="author.html#25636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
