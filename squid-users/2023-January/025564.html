<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Bypass ssl-bump urls that using web sockets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypass%20ssl-bump%20urls%20that%20using%20web%20sockets&In-Reply-To=%3Cb48c8948-ff8f-1ec4-a6d6-7b2be98c0fd5%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025563.html">
   <LINK REL="Next"  HREF="025565.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Bypass ssl-bump urls that using web sockets</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Bypass%20ssl-bump%20urls%20that%20using%20web%20sockets&In-Reply-To=%3Cb48c8948-ff8f-1ec4-a6d6-7b2be98c0fd5%40treenet.co.nz%3E"
       TITLE="[squid-users] Bypass ssl-bump urls that using web sockets">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun Jan 15 15:36:11 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025563.html">[squid-users] Bypass ssl-bump urls that using web sockets
</A></li>
        <LI>Next message (by thread): <A HREF="025565.html">[squid-users] Bypass ssl-bump urls that using web sockets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25564">[ date ]</a>
              <a href="thread.html#25564">[ thread ]</a>
              <a href="subject.html#25564">[ subject ]</a>
              <a href="author.html#25564">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/01/2023 2:17 am, Ben Goz wrote:
&gt;<i> By the help of God.
</I>&gt;<i>
</I>&gt;<i> I'm using the latest squid version built from github sources and the 
</I>&gt;<i> squid server configured with ssl-bump.
</I>
That could mean a lot of things depending on which hour you built it.
Please use the output of &quot;squid -v&quot; to provide details of custom built 
squid.

&gt;<i> The problem starts when the same URL serves as regular&#160;web page and 
</I>&gt;<i> also for certain web socket communication.
</I>&gt;<i>
</I>&gt;<i> If I bypass this URL it bypasses the whole web site, Is it possible to 
</I>&gt;<i> configure squid that it'll bypass ssl-bump only when the URL is used 
</I>&gt;<i> for unsupported protocols (like web sockets)?
</I>
The issue you are facing is that TLS is used to wrap entire 
communication sequences to a server. There is no way to decrypt/bump 
only selective parts of it.
If the initial WebSockets uses HTTP(S) protocol then Squid sees it as 
HTTP and treats it as such (eg. reject unsupported URI scheme) until 
something invalid in HTTP causes the connection to terminate.
If the WebSockets starts using native WebSocket format from the first 
decrypted bytes then Squid on_unsupported_protocol directive behaviour 
should occur (I have not tested that, so YMMV).

To resolve this situation Squid will need to grow support for WebSockets 
(none working on it) and ability to support more than just a TCP vs TLS 
transport layer (under QA discussion, no ETA).

HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025563.html">[squid-users] Bypass ssl-bump urls that using web sockets
</A></li>
	<LI>Next message (by thread): <A HREF="025565.html">[squid-users] Bypass ssl-bump urls that using web sockets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25564">[ date ]</a>
              <a href="thread.html#25564">[ thread ]</a>
              <a href="subject.html#25564">[ subject ]</a>
              <a href="author.html#25564">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
