<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squid 6.1 - auth scheme 'ntlm' is not recognized
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%206.1%20-%20auth%20scheme%20%27ntlm%27%20is%20not%20recognized&In-Reply-To=%3CAM8PR04MB774547AEE394CC2C8D29527D8F37A%40AM8PR04MB7745.eurprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025972.html">
   <LINK REL="Next"  HREF="025960.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squid 6.1 - auth scheme 'ntlm' is not recognized</H1>
    <B>Rafael Akchurin</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squid%206.1%20-%20auth%20scheme%20%27ntlm%27%20is%20not%20recognized&In-Reply-To=%3CAM8PR04MB774547AEE394CC2C8D29527D8F37A%40AM8PR04MB7745.eurprd04.prod.outlook.com%3E"
       TITLE="[squid-users] squid 6.1 - auth scheme 'ntlm' is not recognized">rafael.akchurin at diladele.com
       </A><BR>
    <I>Thu Jul 13 11:38:39 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025972.html">[squid-users] Bypass sslbump using ACL's regex
</A></li>
        <LI>Next message (by thread): <A HREF="025960.html">[squid-users] squid 6.1 - auth scheme 'ntlm' is not recognized
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25959">[ date ]</a>
              <a href="thread.html#25959">[ thread ]</a>
              <a href="subject.html#25959">[ subject ]</a>
              <a href="author.html#25959">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good day everyone,

We are now trying to move the configuration with was valid and working in Squid 5.7 to Squid 6.1 and hitting the following error:
Unknown authentication scheme 'ntlm'

The problem seem to be with the following configuration we use (output from squid -k parse).

023/07/13 13:34:04| Processing: auth_param ntlm program /opt/websafety/bin/wsauth --dc1addr=dc1.diladele.lan --dc1port=389
2023/07/13 13:34:04| ERROR: Failure while parsing Config File: Unknown authentication scheme 'ntlm'.
2023/07/13 13:34:04| FATAL: Bungled /opt/websafety/etc/squid/authentication.conf line 231: auth_param ntlm program /opt/websafety/bin/wsauth --dc1addr=dc1.diladele.lan --dc1port=389
2023/07/13 13:34:04| Squid Cache (Version 6.1): Terminated abnormally.

Comparing the contents of squid-5.9/src/AuthReg.cc and squid-6.1/src/AuthReg.cc it seems the support for NTLM authentication was indeed removed from the codebase (see below).

May I ask if the NTLM scheme is not needed at all now and we should continue using only Negotiate scheme (letting it handle the NTLM as usual)?

Best regards,
Rafael Akchurin
Diladele B.V.


In 5.0 the AuthReg.cc was

/**
* Initialize the authentication modules (if any)
* This is required once, before any configuration actions are taken.
*/
void
Auth::Init()
{
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initializing Authentication Schemes ...&quot;);
#if HAVE_AUTH_MODULE_BASIC
    static const char *basic_type = Auth::Basic::Scheme::GetInstance()-&gt;type();
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initialized Authentication Scheme '&quot; &lt;&lt; basic_type &lt;&lt; &quot;'&quot;);
#endif
#if HAVE_AUTH_MODULE_DIGEST
    static const char *digest_type = Auth::Digest::Scheme::GetInstance()-&gt;type();
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initialized Authentication Scheme '&quot; &lt;&lt; digest_type &lt;&lt; &quot;'&quot;);
#endif
#if HAVE_AUTH_MODULE_NEGOTIATE
    static const char *negotiate_type = Auth::Negotiate::Scheme::GetInstance()-&gt;type();
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initialized Authentication Scheme '&quot; &lt;&lt; negotiate_type &lt;&lt; &quot;'&quot;);
#endif
#if HAVE_AUTH_MODULE_NTLM
    static const char *ntlm_type = Auth::Ntlm::Scheme::GetInstance()-&gt;type();
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initialized Authentication Scheme '&quot; &lt;&lt; ntlm_type &lt;&lt; &quot;'&quot;);
#endif
    debugs(29,DBG_IMPORTANT,&quot;Startup: Initialized Authentication.&quot;);
}


In 6.1 it is now



/**
* Initialize the authentication modules (if any)
* This is required once, before any configuration actions are taken.
*/
void
Auth::Init()
{
    debugs(29, 2, &quot;Initializing Authentication Schemes ...&quot;);
#if HAVE_AUTH_MODULE_BASIC
    static const char *basic_type = Auth::Basic::Scheme::GetInstance()-&gt;type();
    debugs(29, 2, &quot;Initialized Authentication Scheme '&quot; &lt;&lt; basic_type &lt;&lt; &quot;'&quot;);
#endif
#if HAVE_AUTH_MODULE_DIGEST
    static const char *digest_type = Auth::Digest::Scheme::GetInstance()-&gt;type();
    debugs(29, 2, &quot;Initialized Authentication Scheme '&quot; &lt;&lt; digest_type &lt;&lt; &quot;'&quot;);
#endif
#if HAVE_AUTH_MODULE_NEGOTIATE
    static const char *negotiate_type = Auth::Negotiate::Scheme::GetInstance()-&gt;type();
    debugs(29, 2, &quot;Initialized Authentication Scheme '&quot; &lt;&lt; negotiate_type &lt;&lt; &quot;'&quot;);
#endif
}
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winmail.dat
Type: application/ms-tnef
Size: 20765 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20230713/bee8e520/attachment.bin">http://lists.squid-cache.org/pipermail/squid-users/attachments/20230713/bee8e520/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025972.html">[squid-users] Bypass sslbump using ACL's regex
</A></li>
	<LI>Next message (by thread): <A HREF="025960.html">[squid-users] squid 6.1 - auth scheme 'ntlm' is not recognized
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25959">[ date ]</a>
              <a href="thread.html#25959">[ thread ]</a>
              <a href="subject.html#25959">[ subject ]</a>
              <a href="author.html#25959">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
