<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Dstdomain from external ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Dstdomain%20from%20external%20ACL&In-Reply-To=%3C569cccbd-c391-5929-3de4-39e806cb0b5e%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025985.html">
   <LINK REL="Next"  HREF="025990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Dstdomain from external ACL</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Dstdomain%20from%20external%20ACL&In-Reply-To=%3C569cccbd-c391-5929-3de4-39e806cb0b5e%40treenet.co.nz%3E"
       TITLE="[squid-users] Dstdomain from external ACL">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Jul 22 07:12:23 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025985.html">[squid-users] Dstdomain from external ACL
</A></li>
        <LI>Next message (by thread): <A HREF="025990.html">[squid-users] Dstdomain from external ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25986">[ date ]</a>
              <a href="thread.html#25986">[ thread ]</a>
              <a href="subject.html#25986">[ subject ]</a>
              <a href="author.html#25986">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/07/23 17:20, Alexey&#1103;&#1088; Gruzdov wrote:
&gt;<i> Wow&#8230;
</I>&gt;<i> Thank you&#160;so much !
</I>&gt;<i> 
</I>&gt;<i> For now I used a simple .py script that checks if url is in table and 
</I>&gt;<i> send reply OK or ERR, depends from result.
</I>&gt;<i> 
</I>&gt;<i> But allow ask you - how squid parse the url???
</I>&gt;<i> I think it uses the regexp, is that true???
</I>
All parsers in the 'squid' binary perform full parse with validation.


&gt;<i> 
</I>&gt;<i> Because for example if I add the url to DB like example.com 
</I>&gt;<i> ( base url name)
</I>&gt;<i> And if the proxy request will be even like to example.com/page1/ 
</I>&gt;<i>  - this will be matched. That&#8217;s great.
</I>&gt;<i> 
</I>
Oh, there are many moving parts involved there.

First is the HTTP request URL that Squid received, it could be any of 
origin-form, authority-form, or relative-url.

(... probably you configured Squid to only send the URL domain name to 
the helper.)

Second is what details you configured the external_acl_type directive to 
pass on.

Third is how the helper receives its input. The helper I suggested uses 
Perl string split to separate the concurrency channel-ID from the UID 
portion and pack(&quot;H*&quot;,...) for binary safety.

Fourth is how the helper is using its input to lookup the database.
  The helper I suggested uses SQL &quot;=&quot; operator, whose matching is 
string-wise exact equality.

As far as I know only the Perl string split is potentially using regex, 
but not in any way which would case the behaviour you describe.

If you are still using your own custom helper, look into how it is doing 
those third and fourth things.


HTH
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025985.html">[squid-users] Dstdomain from external ACL
</A></li>
	<LI>Next message (by thread): <A HREF="025990.html">[squid-users] Dstdomain from external ACL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25986">[ date ]</a>
              <a href="thread.html#25986">[ thread ]</a>
              <a href="subject.html#25986">[ subject ]</a>
              <a href="author.html#25986">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
