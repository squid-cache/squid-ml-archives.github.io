<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cachemgr.cgi%20%26%20Internal%20Error%3A%20Missing%20Template%0A%20MGR_INDEX&In-Reply-To=%3C97b6e8fc-5760-c1b2-4c8e-590a764f5d0b%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026007.html">
   <LINK REL="Next"  HREF="026009.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cachemgr.cgi%20%26%20Internal%20Error%3A%20Missing%20Template%0A%20MGR_INDEX&In-Reply-To=%3C97b6e8fc-5760-c1b2-4c8e-590a764f5d0b%40measurement-factory.com%3E"
       TITLE="[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX">rousskov at measurement-factory.com
       </A><BR>
    <I>Sat Jul 29 20:01:46 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026007.html">[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX
</A></li>
        <LI>Next message (by thread): <A HREF="026009.html">[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26008">[ date ]</a>
              <a href="thread.html#26008">[ thread ]</a>
              <a href="subject.html#26008">[ subject ]</a>
              <a href="author.html#26008">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 7/29/23 12:31, Brendan Kearney wrote:
&gt;<i> i am not following.
</I>
Sorry, I was just gathering evidence and explaining what you saw. I have 
not confirmed a bug and have not been offering a solution (yet?).


&gt;<i> squid 4.14 on fedora 32 does not have the file, nor does it exhibit the 
</I>&gt;<i> issue.
</I>
&gt;<i> squid 6.1 on fedora 38 does not have the file, but does exhibit the issue.
</I>
... and you do not have a MGR_INDEX file and, presumably, did not have 
that file before. That piece of information was missing. Now we have it. 
Let's call that progress, even though it may not look like one :-).

One additional checkbox to tick is to make sure that the cachemgr.cgi 
script you are using comes from the Squid version you are testing.


&gt;<i> what am i missing, and is there a way to provide this functionality in 
</I>&gt;<i> 6.1?&#160; if an external tool, or different package, is needed what is that?
</I>
cachemgr.cgi is not my area of expertise, but I believe that, bugs 
notwithstanding, the functionality you want should be available without 
an external tool.

The next step, AFAICT, is for you to detail:

* what HTTP response cachemgr.cgi script gets from Squid and
* what HTTP response your browser gets from cachemgr.cgi

According to [2], Squid should send a 404 response to cachemgr.cgi. You 
may be able to find some Squid response details (e.g., status code) in 
Squid access.log. If your cachemgr.cgi is sending plain text requests to 
Squid, you can also capture HTTP traffic to and from cachemgr.cgi using 
tcpdump, wireshark, or similar tools.

[2] <A HREF="https://github.com/squid-cache/squid/pull/1176#discussion_r1010645870">https://github.com/squid-cache/squid/pull/1176#discussion_r1010645870</A>


Thank you,

Alex.


&gt;<i> On 7/29/23 12:22 PM, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 7/29/23 11:07, Brendan Kearney wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> the package installed does not have any file named MGR_INDEX. running 
</I>&gt;&gt;&gt;<i> &quot;rpm -ql squid |grep -i index&quot; does not return anything. searching in 
</I>&gt;&gt;&gt;<i> /usr/share/squid for the file does not find it, either.&#160; funny that 
</I>&gt;&gt;&gt;<i> neither the old version of squid, nor the new version of squid have 
</I>&gt;&gt;&gt;<i> that file at all.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, the lack of MGR_INDEX file in Squid sources is &quot;by design&quot; of 
</I>&gt;&gt;<i> that MGR_INDEX feature -- an &quot;external tool&quot; is supposed to provide 
</I>&gt;&gt;<i> that file in certain cases[1]. Please do not misinterpret my statement 
</I>&gt;&gt;<i> as defense of the corresponding design decisions or their side 
</I>&gt;&gt;<i> effects; I am just stating the facts rather than trying to justify bad 
</I>&gt;&gt;<i> user experience.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [1] <A HREF="https://github.com/squid-cache/squid/pull/1176#discussion_r1010534845">https://github.com/squid-cache/squid/pull/1176#discussion_r1010534845</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> @amos,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> i ran firefox with developer tools open, and browsed to the cachemgr 
</I>&gt;&gt;&gt;<i> URL, and reproduced the issue.&#160; the traffic is not being proxied 
</I>&gt;&gt;&gt;<i> through squid, and is making the requests directly.&#160; i am not sure if 
</I>&gt;&gt;&gt;<i> that is what you mean.&#160; i saved the session as a HAR file, if that 
</I>&gt;&gt;&gt;<i> helps.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> thank you,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> brendan
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 7/29/23 1:26 AM, Amos Jeffries wrote:
</I>&gt;&gt;&gt;&gt;<i> On 29/07/23 14:42, Alex Rousskov wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> On 7/28/23 20:08, Brendan Kearney wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> i am running squid 6.1 on fedora 38, and cannot get the 
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> cachemgr.cgi working on this box.&#160; I am getting the error:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Internal Error: Missing Template MGR_INDEX
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> when i try to connect using the cache manager interface.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> That is the expected output when you are trying to access the 
</I>&gt;&gt;&gt;&gt;<i> manager interface directly from Squid. **Instead** of via the 
</I>&gt;&gt;&gt;&gt;<i> cachemgr.cgi.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If you want to try the new manager interface I have a prototype 
</I>&gt;&gt;&gt;&gt;<i> javascript tool available at &lt;<A HREF="https://github.com/yadij/cachemgr.js/">https://github.com/yadij/cachemgr.js/</A>&gt;.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Amos
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="http://lists.squid-cache.org/listinfo/squid-users">http://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026007.html">[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX
</A></li>
	<LI>Next message (by thread): <A HREF="026009.html">[squid-users] cachemgr.cgi &amp; Internal Error: Missing Template MGR_INDEX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26008">[ date ]</a>
              <a href="thread.html#26008">[ thread ]</a>
              <a href="subject.html#26008">[ subject ]</a>
              <a href="author.html#26008">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
