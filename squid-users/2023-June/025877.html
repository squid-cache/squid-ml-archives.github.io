<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ftp related crash in squid-6.0.0-20220905-r9358e99f9
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ftp%20related%20crash%20in%0A%20squid-6.0.0-20220905-r9358e99f9&In-Reply-To=%3Cdeadd1c1-d705-eea9-0325-ce1b313716f8%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025876.html">
   <LINK REL="Next"  HREF="025878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ftp related crash in squid-6.0.0-20220905-r9358e99f9</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ftp%20related%20crash%20in%0A%20squid-6.0.0-20220905-r9358e99f9&In-Reply-To=%3Cdeadd1c1-d705-eea9-0325-ce1b313716f8%40measurement-factory.com%3E"
       TITLE="[squid-users] ftp related crash in squid-6.0.0-20220905-r9358e99f9">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Jun 19 18:21:40 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025876.html">[squid-users] ftp related crash in squid-6.0.0-20220905-r9358e99f9
</A></li>
        <LI>Next message (by thread): <A HREF="025878.html">[squid-users] [ext] Re: ftp related crash in squid-6.0.0-20220905-r9358e99f9
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25877">[ date ]</a>
              <a href="thread.html#25877">[ thread ]</a>
              <a href="subject.html#25877">[ subject ]</a>
              <a href="author.html#25877">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/19/23 11:43, Ralf Hildebrandt wrote:

&gt;<i> It seems I'm encountering an FTP related crash here; core.1678595 is
</I>&gt;<i> available for further debugging.
</I>
Please post the (sanitized, if needed) output of the following gdb 
commands interrogating that Squid core file:


     set print pretty
     set print static-members off

     frame 3
     print this
     print *this
     print *entry
     print *entry-&gt;mem_obj

     frame 10
     print this
     print *this


Thank you,

Alex.


&gt;<i> I'm running squid-6.0.0-20220905-r9358e99f9 (since that's so far the
</I>&gt;<i> most stable version for me).
</I>&gt;<i> 
</I>&gt;<i> cache.log says:
</I>&gt;<i> ===============
</I>&gt;<i> 
</I>&gt;<i> 2023/06/19 17:31:10| conn3580032407 local=141.42.5.215:8080 remote=141.42.64.96:52710 FD 39958 flags=1: read/write failure: (110) Connection timed out
</I>&gt;<i>      current master transaction: master1645377270
</I>&gt;<i> 2023/06/19 17:31:12| conn3572687242 local=141.42.5.215:8080 remote=172.29.144.96:51701 FD 41826 flags=1: read/write failure: (110) Connection timed out
</I>&gt;<i>      current master transaction: master1642214323
</I>&gt;<i> 2023/06/19 17:31:17| FATAL: assertion failed: FwdState.cc:299: &quot;!storedWholeReply_&quot;
</I>&gt;<i>      current master transaction: master1650383954
</I>&gt;<i>      
</I>&gt;<i> This is the backtrace:
</I>&gt;<i> ======================
</I>&gt;<i> 
</I>&gt;<i> Reading symbols from /usr/sbin/squid...
</I>&gt;<i> [Thread debugging using libthread_db enabled]
</I>&gt;<i> Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.
</I>&gt;<i> 
</I>&gt;<i> Program received signal SIGABRT, Aborted.
</I>&gt;<i> __GI_raise (sig=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sig at entry</A>=6) at ../sysdeps/unix/sysv/linux/raise.c:50
</I>&gt;<i> #0  __GI_raise (sig=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">sig at entry</A>=6) at ../sysdeps/unix/sysv/linux/raise.c:50
</I>&gt;<i>          set = {
</I>&gt;<i>            __val = {0, 115, 60684401525984, 11384875684165056000, 1,
</I>&gt;<i>              140737488347504, 93825000028288, 11384875684165056000,
</I>&gt;<i>              93824999874096, 140737488347504, 93825000028376, 140737488347536,
</I>&gt;<i>              93824997547807, 93825140894448, 93826629547024, 140737344746339}
</I>&gt;<i>          }
</I>&gt;<i>          pid = &lt;optimized out&gt;
</I>&gt;<i>          tid = &lt;optimized out&gt;
</I>&gt;<i>          ret = &lt;optimized out&gt;
</I>&gt;<i> #1  0x00007ffff7615859 in __GI_abort () at abort.c:79
</I>&gt;<i>          save_stage = 1
</I>&gt;<i>          act = {
</I>&gt;<i>            __sigaction_handler = {
</I>&gt;<i>              sa_handler = 0x555555a65f1f,
</I>&gt;<i>              sa_sigaction = 0x555555a65f1f
</I>&gt;<i>            },
</I>&gt;<i>            sa_mask = {
</I>&gt;<i>              __val = {93825140894448, 93826629547024, 93824996975023, 155185,
</I>&gt;<i>                1687188677, 0, 93826629547008, 93825491415392,
</I>&gt;<i>                11384875684165056000, 111, 93825000028288, 93825000094136,
</I>&gt;<i>                93824996978668, 93825000094136, 93824996974080, 93825000094136}
</I>&gt;<i>            },
</I>&gt;<i>            sa_flags = 1990456832,
</I>&gt;<i>            sa_restorer = 0x555555a6617d
</I>&gt;<i>          }
</I>&gt;<i>          sigs = {
</I>&gt;<i>            __val = {32, 0 &lt;repeats 15 times&gt;}
</I>&gt;<i>          }
</I>&gt;<i> #2  0x00005555559d9e8b in xassert (
</I>&gt;<i>      msg=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">msg at entry</A>=0x555555a6617d &quot;!storedWholeReply_&quot;,
</I>&gt;<i>      file=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">file at entry</A>=0x555555a65f1f &quot;FwdState.cc&quot;, line=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">line at entry</A>=299)
</I>&gt;<i>      at debug.cc:1266
</I>&gt;<i>          __FUNCTION__ = &lt;optimized out&gt;
</I>&gt;<i> #3  0x000055555570e9c2 in FwdState::completed (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x55556c0a4748)
</I>&gt;<i>      at FwdState.cc:299
</I>&gt;<i>          __FUNCTION__ = &quot;completed&quot;
</I>&gt;<i> #4  0x00005555557128af in FwdState::complete (this=0x55556c0a4748)
</I>&gt;<i>      at FwdState.cc:589
</I>&gt;<i>          replyStatus = Http::scNone
</I>&gt;<i>          __FUNCTION__ = &quot;complete&quot;
</I>&gt;<i> #5  0x000055555587c796 in Client::completeForwarding (this=0x5555662702c8)
</I>&gt;<i>      at ../../src/base/RefCount.h:73
</I>&gt;<i>          __FUNCTION__ = &quot;completeForwarding&quot;
</I>&gt;<i> #6  0x0000555555882619 in Ftp::Gateway::completeForwarding (
</I>&gt;<i>      this=0x5555662702c8) at FtpGateway.cc:2651
</I>&gt;<i>          __FUNCTION__ = &quot;completeForwarding&quot;
</I>&gt;<i> #7  0x000055555587974b in Client::serverComplete2 (
</I>&gt;<i>      this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x5555662702c8) at Client.cc:214
</I>&gt;<i>          __FUNCTION__ = &quot;serverComplete2&quot;
</I>&gt;<i> #8  0x000055555587c3d4 in Client::serverComplete (this=0x5555662702c8)
</I>&gt;<i>      at Client.cc:198
</I>&gt;<i>          __FUNCTION__ = &quot;serverComplete&quot;
</I>&gt;<i> #9  0x000055555588154a in ftpReadQuit (ftpState=&lt;optimized out&gt;)
</I>&gt;<i>      at FtpGateway.cc:2288
</I>&gt;<i> No locals.
</I>&gt;<i> #10 0x00005555558816f6 in Ftp::Gateway::handleControlReply (
</I>&gt;<i>      this=0x5555662702c8) at FtpGateway.cc:1176
</I>&gt;<i> No locals.
</I>&gt;<i> #11 0x00005555558a15a5 in Ftp::Client::readControlReply (this=0x5555662702c8,
</I>&gt;<i>      io=...) at FtpClient.cc:415
</I>&gt;<i>          __FUNCTION__ = &quot;readControlReply&quot;
</I>&gt;<i>          len = &lt;optimized out&gt;
</I>&gt;<i> #12 0x00005555558a7172 in CommCbMemFunT&lt;Ftp::Client, CommIoCbParams&gt;::doDial (
</I>&gt;<i>      this=0x5555ff888638) at ../../src/CommCalls.h:205
</I>&gt;<i> No locals.
</I>&gt;<i> #13 0x00005555558a6ee3 in JobDialer&lt;Ftp::Client&gt;::dial (this=0x5555ff888638,
</I>&gt;<i>      call=...) at ../../src/base/AsyncJobCalls.h:170
</I>&gt;<i>          __FUNCTION__ = &quot;dial&quot;
</I>&gt;<i> #14 0x00005555558a7092 in AsyncCallT&lt;CommCbMemFunT&lt;Ftp::Client, CommIoCbParams&gt; &gt;::fire (this=&lt;optimized out&gt;) at ../../src/base/AsyncCall.h:143
</I>&gt;<i> No locals.
</I>&gt;<i> #15 0x00005555558d5952 in AsyncCall::make (this=0x5555ff888600)
</I>&gt;<i>      at AsyncCall.cc:44
</I>&gt;<i>          __FUNCTION__ = &quot;make&quot;
</I>&gt;<i> #16 0x00005555558d73d0 in AsyncCallQueue::fire (this=0x555555daff70)
</I>&gt;<i>      at ../../src/base/RefCount.h:73
</I>&gt;<i>          call = {
</I>&gt;<i>            p_ = 0x5555ff888600
</I>&gt;<i>          }
</I>&gt;<i>          made = true
</I>&gt;<i>          __FUNCTION__ = &quot;fire&quot;
</I>&gt;<i> #17 0x00005555557098cf in EventLoop::dispatchCalls (
</I>&gt;<i>      this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x7fffffffe940) at EventLoop.cc:144
</I>&gt;<i>          dispatchedSome = &lt;optimized out&gt;
</I>&gt;<i> #18 0x00005555557099c2 in EventLoop::runOnce (this=<A HREF="https://lists.squid-cache.org/listinfo/squid-users">this at entry</A>=0x7fffffffe940)
</I>&gt;<i>      at EventLoop.cc:121
</I>&gt;<i>          sawActivity = &lt;optimized out&gt;
</I>&gt;<i>          waitingEngine = 0x7fffffffe860
</I>&gt;<i>          __FUNCTION__ = &lt;optimized out&gt;
</I>&gt;<i> #19 0x0000555555709a2d in EventLoop::run (this=0x7fffffffe940)
</I>&gt;<i>      at EventLoop.cc:83
</I>&gt;<i> No locals.
</I>&gt;<i> #20 0x00005555557f9ad7 in SquidMain (argc=&lt;optimized out&gt;,
</I>&gt;<i>      argv=&lt;optimized out&gt;) at main.cc:1691
</I>&gt;<i>          cmdLine = {
</I>&gt;<i>            argv_ = std::vector of length 3, capacity 3 = {
</I>&gt;<i>              0x555555cc3760 &quot;/usr/sbin/squid&quot;, 0x555555cc3780 &quot;-NsYC&quot;, 0x0},
</I>&gt;<i>            shortOptions_ = 0x555555cc3710 &quot;CDFNRSYXa:d:f:hk:m::n:sl:u:vz?&quot;,
</I>&gt;<i>            longOptions_ = std::vector of length 5, capacity 8 = {{
</I>&gt;<i>                &lt;option&gt; = {
</I>&gt;<i>                  name = 0x555555cc3860 &quot;foreground&quot;,
</I>&gt;<i>                  has_arg = 0,
</I>&gt;<i>                  flag = 0x0,
</I>&gt;<i>                  val = 2
</I>&gt;<i>                }, &lt;No data fields&gt;}, {
</I>&gt;<i>                &lt;option&gt; = {
</I>&gt;<i>                  name = 0x555555cc3a60 &quot;kid&quot;,
</I>&gt;<i>                  has_arg = 1,
</I>&gt;<i>                  flag = 0x0,
</I>&gt;<i>                  val = 3
</I>&gt;<i>                }, &lt;No data fields&gt;}, {
</I>&gt;<i>                &lt;option&gt; = {
</I>&gt;<i>                  name = 0x555555cc3a80 &quot;help&quot;,
</I>&gt;<i>                  has_arg = 0,
</I>&gt;<i>                  flag = 0x0,
</I>&gt;<i>                  val = 104
</I>&gt;<i>                }, &lt;No data fields&gt;}, {
</I>&gt;<i>                &lt;option&gt; = {
</I>&gt;<i>                  name = 0x555555cc3aa0 &quot;version&quot;,
</I>&gt;<i>                  has_arg = 0,
</I>&gt;<i>                  flag = 0x0,
</I>&gt;<i>                  val = 118
</I>&gt;<i>                }, &lt;No data fields&gt;}, {
</I>&gt;<i>                &lt;option&gt; = {
</I>&gt;<i>                  name = 0x0,
</I>&gt;<i>                  has_arg = 0,
</I>&gt;<i>                  flag = 0x0,
</I>&gt;<i>                  val = 0
</I>&gt;<i>                }, &lt;No data fields&gt;}}
</I>&gt;<i>          }
</I>&gt;<i>          WIN32_init_err = 0
</I>&gt;<i>          __FUNCTION__ = &quot;SquidMain&quot;
</I>&gt;<i>          mainLoop = {
</I>&gt;<i>            errcount = 0,
</I>&gt;<i>            static Running = 0x7fffffffe940,
</I>&gt;<i>            last_loop = false,
</I>&gt;<i>            engines = std::vector of length 4, capacity 4 = {0x7fffffffe820,
</I>&gt;<i>              0x555555c0dc80 &lt;EventScheduler::_instance&gt;, 0x7fffffffe840,
</I>&gt;<i>              0x7fffffffe860},
</I>&gt;<i>            timeService = 0x7fffffffe880,
</I>&gt;<i>            primaryEngine = 0x7fffffffe860,
</I>&gt;<i>            loop_delay = 0,
</I>&gt;<i>            error = false,
</I>&gt;<i>            runOnceResult = false
</I>&gt;<i>          }
</I>&gt;<i>          signalEngine = {
</I>&gt;<i>            &lt;AsyncEngine&gt; = {
</I>&gt;<i>              _vptr.AsyncEngine = 0x555555b6ea38 &lt;vtable for SignalEngine+16&gt;
</I>&gt;<i>            }, &lt;No data fields&gt;}
</I>&gt;<i>          store_engine = {
</I>&gt;<i>            &lt;AsyncEngine&gt; = {
</I>&gt;<i>              _vptr.AsyncEngine = 0x555555b6ea10 &lt;vtable for StoreRootEngine+16&gt;
</I>&gt;<i>            }, &lt;No data fields&gt;}
</I>&gt;<i>          comm_engine = {
</I>&gt;<i>            &lt;AsyncEngine&gt; = {
</I>&gt;<i>              _vptr.AsyncEngine = 0x555555b7e138 &lt;vtable for CommSelectEngine+16&gt;
</I>&gt;<i>            }, &lt;No data fields&gt;}
</I>&gt;<i>          time_engine = {
</I>&gt;<i>            _vptr.Engine = 0x555555b8dad0 &lt;vtable for Time::Engine+16&gt;
</I>&gt;<i>          }
</I>&gt;<i> #21 0x00005555557fa0fa in SquidMainSafe (argv=0x7fffffffed48, argc=2)
</I>&gt;<i>      at main.cc:1381
</I>&gt;<i>          __FUNCTION__ = &lt;optimized out&gt;
</I>&gt;<i>          _dbg_level = &lt;optimized out&gt;
</I>&gt;<i>          _dbo = &lt;optimized out&gt;
</I>&gt;<i> #22 main (argc=2, argv=0x7fffffffed48) at main.cc:1369
</I>&gt;<i> No locals.
</I>&gt;<i> Saved corefile core.1678595
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025876.html">[squid-users] ftp related crash in squid-6.0.0-20220905-r9358e99f9
</A></li>
	<LI>Next message (by thread): <A HREF="025878.html">[squid-users] [ext] Re: ftp related crash in squid-6.0.0-20220905-r9358e99f9
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25877">[ date ]</a>
              <a href="thread.html#25877">[ thread ]</a>
              <a href="subject.html#25877">[ subject ]</a>
              <a href="author.html#25877">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
