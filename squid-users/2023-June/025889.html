<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] About Squid settings How can I restrict Docker container access with Squid and refer to the host name written in /etc/hosts instead of the external DNS?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20Squid%20settings%20How%20can%20I%20restrict%20Docker%0A%20container%20access%20with%20Squid%20and%20refer%20to%20the%20host%20name%20written%20in%0A%20/etc/hosts%20instead%20of%20the%20external%20DNS%3F&In-Reply-To=%3CCAPua2S_%3DBZuNf9DFcvyhZJ1%2BX_skdu9_BWJ1U2H9qOq%3D8gophQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025896.html">
   <LINK REL="Next"  HREF="025891.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] About Squid settings How can I restrict Docker container access with Squid and refer to the host name written in /etc/hosts instead of the external DNS?</H1>
    <B>kaga optim</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20About%20Squid%20settings%20How%20can%20I%20restrict%20Docker%0A%20container%20access%20with%20Squid%20and%20refer%20to%20the%20host%20name%20written%20in%0A%20/etc/hosts%20instead%20of%20the%20external%20DNS%3F&In-Reply-To=%3CCAPua2S_%3DBZuNf9DFcvyhZJ1%2BX_skdu9_BWJ1U2H9qOq%3D8gophQ%40mail.gmail.com%3E"
       TITLE="[squid-users] About Squid settings How can I restrict Docker container access with Squid and refer to the host name written in /etc/hosts instead of the external DNS?">optimkaga at gmail.com
       </A><BR>
    <I>Fri Jun 23 07:45:55 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025896.html">[squid-users] Enable caching
</A></li>
        <LI>Next message (by thread): <A HREF="025891.html">[squid-users] About Squid settings How can I restrict Docker container access with Squid and refer to the host name written in /etc/hosts instead of the external DNS?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25889">[ date ]</a>
              <a href="thread.html#25889">[ thread ]</a>
              <a href="subject.html#25889">[ subject ]</a>
              <a href="author.html#25889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,We become indebted to.

If anyone is familiar with setting up squid in a linux environment, please
let me know.

I want to access the URL of the actual site in the test environment that I
do not want to connect to the production environment.
Specifically, I want to be able to control it with a file like /etc/hosts.

I am building a docker container and
For access on the docker container server
I want it to be a successful move.

----
Example: AAA.optim.co.jp is actually registered in DNS, so
The IP address of the production AAA.optim.co.jp site is referenced.
Therefore, I am trying to rewrite the hosts file on the docker container
server.

### For AAA.optim.co.jp, set to refer to your own server
$ docker exec -it ci_app_1 bash
# vi /etc/hosts
172.17.0.1 AAA.optim.co.jp


However, when I actually hit the URL, I get a 503.
$ docker exec -it ci_app_1 bash
# curl -G -I &quot;<A HREF="https://AAA.optim.co.jp/~">https://AAA.optim.co.jp/~</A>&quot;

HTTP/1.1 200 Connection established

HTTP/1.1 503 Service Unavailable
Server: nginx
Date: Tue, 23 May 2023 08:04:30 GMT
Content-Type: application/json; charset=utf-8
Status: 503 Service Unavailable
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Cache-Control: no-cache
X-Request-Id: c690bd75-750b-4985-937f-2ac566d3b09f
X-Runtime: 0.004765
X-Cache: MISS from ip-10-0-3-217.ap-northeast-1.compute.internal
X-Cache-Lookup: MISS from ip-10-0-3-217.ap-northeast-1.compute.internal:3128
Via: 1.1 ip-10-0-3-217.ap-northeast-1.compute.internal (squid/3.5.20)
Connection: keep-alive

If you look at the Squid logs, it goes to see the production site address
registered in DNS.
1684829160.806 135 172.17.0.2 TAG_NONE/200 0 CONNECT AAA.optim.co.jp:443 -
HIER_DIRECT/AAA.AAA.AAA.AAA -
1684829160.838 28 172.17.0.2 TCP_MISS/503 600 HEAD <A HREF="https://AAA.optim.co.jp/&#65374;">https://AAA.optim.co.jp/&#65374;</A>
&lt;<A HREF="https://aaa.optim.co.jp/%EF%BD%9E">https://aaa.optim.co.jp/%EF%BD%9E</A>&gt; -
HIER_DIRECT/AAA.AAA.AAA.AAAapplication/json

----

what i want to do

&#12539;If you want to access the <A HREF="https://AAA.optim.co.jp/">https://AAA.optim.co.jp/</A> site via Squid, you
want to refer to /etc/hosts of your own host instead of DNS.
In short, in case of access to a specific domain, can't it be separated so
that it refers to the hosts file without using DNS?
Is it possible to divide the reference destination of name resolution for
each domain in Squid? about it.

We apologize for the inconvenience, but thank you in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20230623/63cc074b/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20230623/63cc074b/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025896.html">[squid-users] Enable caching
</A></li>
	<LI>Next message (by thread): <A HREF="025891.html">[squid-users] About Squid settings How can I restrict Docker container access with Squid and refer to the host name written in /etc/hosts instead of the external DNS?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25889">[ date ]</a>
              <a href="thread.html#25889">[ thread ]</a>
              <a href="subject.html#25889">[ subject ]</a>
              <a href="author.html#25889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
