<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] host_verify_check behaviour in intercept mode for domain behind Loadbalancer ( multiple IPs )
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20host_verify_check%20behaviour%20in%20intercept%20mode%20for%0A%20domain%20behind%20Loadbalancer%20%28%20multiple%20IPs%20%29&In-Reply-To=%3CCALpWAcoujkPumOsVHfQhKYbPtMzfVttVycS-n7DFMxPXfWoOAQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025836.html">
   <LINK REL="Next"  HREF="025839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] host_verify_check behaviour in intercept mode for domain behind Loadbalancer ( multiple IPs )</H1>
    <B>sachin gupta</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20host_verify_check%20behaviour%20in%20intercept%20mode%20for%0A%20domain%20behind%20Loadbalancer%20%28%20multiple%20IPs%20%29&In-Reply-To=%3CCALpWAcoujkPumOsVHfQhKYbPtMzfVttVycS-n7DFMxPXfWoOAQ%40mail.gmail.com%3E"
       TITLE="[squid-users] host_verify_check behaviour in intercept mode for domain behind Loadbalancer ( multiple IPs )">sachin1.g at gmail.com
       </A><BR>
    <I>Tue May 16 06:52:40 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="025836.html">[squid-users] cache_peer selection
</A></li>
        <LI>Next message (by thread): <A HREF="025839.html">[squid-users] host_verify_check behaviour in intercept mode for domain behind Loadbalancer ( multiple IPs )
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25838">[ date ]</a>
              <a href="thread.html#25838">[ thread ]</a>
              <a href="subject.html#25838">[ subject ]</a>
              <a href="author.html#25838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

We recently shifted to squid 5.9 and started seeing errors in Transparent mode

SECURITY ALERT: Host header forgery detected on conn3615903
local=44.242.184.237:443 remote=10.109.176.240:8990 FD 28029 flags=17
(local IP does not match any domain IP)

Previously we were using
<A HREF="https://github.com/NethServer/dev/issues/5348.">https://github.com/NethServer/dev/issues/5348.</A> In addition we are
using client_dst_passthru off. When building 5.9, the patch was not
applied cleanly and we wanted to check if things worked without this
patch. They did not work.

I did check the forum responses
<A HREF="https://wiki.squid-cache.org/KnowledgeBase/HostHeaderForgery.">https://wiki.squid-cache.org/KnowledgeBase/HostHeaderForgery.</A> and
<A HREF="https://docs.diladele.com/faq/squid/host_header_forgery.html.">https://docs.diladele.com/faq/squid/host_header_forgery.html.</A> We
already support explicit proxy but that is not always an option. We
can create another patch to circumvent issues like  in
<A HREF="https://github.com/NethServer/dev/issues/5348.">https://github.com/NethServer/dev/issues/5348.</A> But I wanted to know if
there is a plan to make this check optional or there is some way we
can workaround this problem without changing the code. Without this
support, how can intercept mode work for any website which is behind a
loadbalancer with multiple IPs.

Regards
Sachin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20230516/504013a2/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20230516/504013a2/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="025836.html">[squid-users] cache_peer selection
</A></li>
	<LI>Next message (by thread): <A HREF="025839.html">[squid-users] host_verify_check behaviour in intercept mode for domain behind Loadbalancer ( multiple IPs )
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25838">[ date ]</a>
              <a href="thread.html#25838">[ thread ]</a>
              <a href="subject.html#25838">[ subject ]</a>
              <a href="author.html#25838">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
