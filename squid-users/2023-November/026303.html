<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] reconfigure drops in memory caches for external_acl_type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20reconfigure%20drops%20in%20memory%20caches%20for%0A%20external_acl_type&In-Reply-To=%3CCADJd0Y17-4Cr_Cg1N7684Gwx3C6S1BdMtqi3t8DT0ySqOmu_8g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026302.html">
   <LINK REL="Next"  HREF="026304.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] reconfigure drops in memory caches for external_acl_type</H1>
    <B>Andrey K</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20reconfigure%20drops%20in%20memory%20caches%20for%0A%20external_acl_type&In-Reply-To=%3CCADJd0Y17-4Cr_Cg1N7684Gwx3C6S1BdMtqi3t8DT0ySqOmu_8g%40mail.gmail.com%3E"
       TITLE="[squid-users] reconfigure drops in memory caches for external_acl_type">ankor2023 at gmail.com
       </A><BR>
    <I>Thu Nov 30 03:29:51 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026302.html">[squid-users] reconfigure drops in memory caches for external_acl_type
</A></li>
        <LI>Next message (by thread): <A HREF="026304.html">[squid-users] Module c-icap help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26303">[ date ]</a>
              <a href="thread.html#26303">[ thread ]</a>
              <a href="subject.html#26303">[ subject ]</a>
              <a href="author.html#26303">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, Norman,

I faced the problem too.
For myself, I modified the authorisation script (ext_wbinfo_group_acl - it
is a simple Perl code) and cache some user groups membership in a Memcache.
The script tries first of all to get the information from the cache, and if
it is not there, then get it from winbind.
Squid reconfigurations do not affect the information in the memcache.

Kind regards,
       Ankor


&#1089;&#1088;, 29 &#1085;&#1086;&#1103;&#1073;. 2023&#8239;&#1075;. &#1074; 18:33, Alex Rousskov &lt;
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;:

&gt;<i> On 2023-11-29 09:38, Ziert, Norman wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; in the very recent past I stumbled over that a &quot;squid -k reconfigure&quot;
</I>&gt;<i> &gt; drops in memory caches for external_acl_type helpers, wich in my case
</I>&gt;<i> &gt; leads to a massive query burst against local winbind
</I>&gt;<i> &gt; (ext_wbinfo_group_acl) and infact the active directory
</I>&gt;<i> &gt; domaincontrollers. This also leads to an massive impact in servicetime
</I>&gt;<i> &gt; to endusers, where after a reconfigure the time needed to fullfill takes
</I>&gt;<i> &gt; a recent time by group membership authorization within squid until the
</I>&gt;<i> &gt; external_acl cache is &quot;rewarmed&quot;.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have veriefied that behavior back to v5.2.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I want to ask if this is a wanted behavior to squid or should I file a
</I>&gt;<i> &gt; bug-report on this?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This behavior is usually unwanted, but there is no particular need for a
</I>&gt;<i> bug report IMHO: We know that this and similar reconfiguration side
</I>&gt;<i> effects are usually unwanted. We are actively working on avoiding
</I>&gt;<i> various unwanted reconfiguration side effects -- the &quot;smooth
</I>&gt;<i> reconfiguration&quot; project has merged about 25 pull requests in recent
</I>&gt;<i> months (some of them were very complex/substantial -- we need to payoff
</I>&gt;<i> a lot of very old technical debt first!), and more are coming. We will
</I>&gt;<i> solve this problem in the foreseeable future.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Maybe I discovered a topic wich is connected to this discussion:
</I>&gt;<i> &gt; <A HREF="https://wiki.squid-cache.org/Features/HotConf">https://wiki.squid-cache.org/Features/HotConf</A>
</I>&gt;<i>
</I>&gt;<i> Yes, that old wiki page has some relevant pieces, but we have moved far
</I>&gt;<i> ahead of those old discussions since then and have solved complex
</I>&gt;<i> architectural problems with functional, deployment-tested code that
</I>&gt;<i> supports smooth reconfiguration in some typical cases. We are actively
</I>&gt;<i> working on polishing, merging, and enhancing those improvements.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTH,
</I>&gt;<i>
</I>&gt;<i> Alex.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20231130/74ee2a02/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20231130/74ee2a02/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026302.html">[squid-users] reconfigure drops in memory caches for external_acl_type
</A></li>
	<LI>Next message (by thread): <A HREF="026304.html">[squid-users] Module c-icap help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26303">[ date ]</a>
              <a href="thread.html#26303">[ thread ]</a>
              <a href="subject.html#26303">[ subject ]</a>
              <a href="author.html#26303">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
