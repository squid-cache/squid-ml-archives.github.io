<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Get IP of denied request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Get%20IP%20of%20denied%20request&In-Reply-To=%3Cc5115934-5936-49b0-8a3e-d4231689dcbc%40web.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026228.html">
   <LINK REL="Next"  HREF="026232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Get IP of denied request</H1>
    <B>magri at web.de</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Get%20IP%20of%20denied%20request&In-Reply-To=%3Cc5115934-5936-49b0-8a3e-d4231689dcbc%40web.de%3E"
       TITLE="[squid-users] Get IP of denied request">magri at web.de
       </A><BR>
    <I>Thu Oct 26 12:37:43 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026228.html">[squid-users] [ext] Re: Squid 6.4 assertion errors: FATAL: assertion failed: stmem.cc:98: &quot;lowestOffset () &lt;= target_offset&quot; current master transaction: master655 (backtrace)]
</A></li>
        <LI>Next message (by thread): <A HREF="026232.html">[squid-users] Get IP of denied request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26230">[ date ]</a>
              <a href="thread.html#26230">[ thread ]</a>
              <a href="subject.html#26230">[ subject ]</a>
              <a href="author.html#26230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi list,

TL;DR: is there a way to get/log the resolved ip of a denied request?


We have a rather large ip based malware blacklist (dst acl) and
sometimes a destination is blocked inadvertantly because of a false
positive entry in this list.
This happens most often with CDNs where the ips of a destination change
often and even move between different sites.

Because of this rapid change it's difficult to determine the blocked ip
in hindsight when analyzing access problems and makes it impossible to
correct the blacklist.

For normal requests the resolved and accessed ip is be logged with %&lt;a,
but that doesn't happen when the request is denied.

Is there any way to get the ip logged that was used in the dst-acl aside
from debug logging? Maybe through some annotation mechanism?

Squid version is 6.2, as 6.4 crashes with assertion errors here, too.

thanks,
Martin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026228.html">[squid-users] [ext] Re: Squid 6.4 assertion errors: FATAL: assertion failed: stmem.cc:98: &quot;lowestOffset () &lt;= target_offset&quot; current master transaction: master655 (backtrace)]
</A></li>
	<LI>Next message (by thread): <A HREF="026232.html">[squid-users] Get IP of denied request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26230">[ date ]</a>
              <a href="thread.html#26230">[ thread ]</a>
              <a href="subject.html#26230">[ subject ]</a>
              <a href="author.html#26230">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
