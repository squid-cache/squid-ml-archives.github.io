<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] [ADVISORY] SQUID-2023:5 Denial of Service in FTP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2023%3A5%20Denial%20of%0A%20Service%20in%20FTP&In-Reply-To=%3C304e9d98-394d-47b6-8955-63aab32c2fe3%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026310.html">
   <LINK REL="Next"  HREF="026217.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] [ADVISORY] SQUID-2023:5 Denial of Service in FTP</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20%5BADVISORY%5D%20SQUID-2023%3A5%20Denial%20of%0A%20Service%20in%20FTP&In-Reply-To=%3C304e9d98-394d-47b6-8955-63aab32c2fe3%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] [ADVISORY] SQUID-2023:5 Denial of Service in FTP">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Oct 21 21:57:43 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026310.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2023:1 Request/Response smuggling in HTTP(S) and ICAP
</A></li>
        <LI>Next message (by thread): <A HREF="026217.html">[squid-users] Security advisories pointing to Squid 6.4, but no download (yer)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26311">[ date ]</a>
              <a href="thread.html#26311">[ thread ]</a>
              <a href="subject.html#26311">[ subject ]</a>
              <a href="author.html#26311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

   Squid Proxy Cache Security Update Advisory SQUID-2023:5
__________________________________________________________________

Advisory ID:       | SQUID-2023:5
Date:              | October 22, 2023
Summary:           | Denial of Service in FTP
Affected versions: | Squid 5.0.3 -&gt; 5.9
                    | Squid 6.x -&gt; 6.3
Fixed in version:  | Squid 6.4
__________________________________________________________________

Problem Description:

  Due to an Incorrect Conversion between Numeric Types
  bug Squid is vulnerable to a Denial of Service
  attack against FTP Native Relay input validation.

  Due to an Incorrect Conversion between Numeric Types
  bug Squid is vulnerable to a Denial of Service
  attack against <A HREF="ftp://">ftp://</A> URL validation and access control.

__________________________________________________________________

Severity:

  This problem allows a remote client to perform Denial of Service
  when sending <A HREF="ftp://">ftp://</A> URLs in HTTP Request messages or constructing
  <A HREF="ftp://">ftp://</A> URLs from FTP Native input.

  This issue is triggered during access control security checks,
  meaning clients may not have been permitted to use the proxy yet.

  FTP support is always enabled and cannot be disabled completely.

CVSS Score of 8.6
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

This bug is fixed by Squid version 6.4.

  In addition, patches addressing this problem for the stable
  releases can be found in our patch archives:

Squid 6:
  &lt;<A HREF="http://www.squid-cache.org/Versions/v6/SQUID-2023_5.patch">http://www.squid-cache.org/Versions/v6/SQUID-2023_5.patch</A>&gt;

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  Squid older than 5.0.3 are not vulnerable.

  All Squid-5.0.4 up to and including 5.6 are vulnerable.

  All Squid-6.x up to and including 6.3 are vulnerable.

__________________________________________________________________

Workaround:

  * The FTP Native Relay input validation vector can be secured by
    removing all ftp_port directives from squid.conf.

  * There are no workarounds to avoid the <A HREF="ftp://">ftp://</A> URL validation and
    access control vector.

__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is your
  primary support point. For subscription details see
  &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  &lt;<A HREF="https://bugs.squid-cache.org/">https://bugs.squid-cache.org/</A>&gt;.

  For reporting of security sensitive bugs send an email to the
  &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Joshua Rogers of Opera
  Software.

  Fixed by The Measurement Factory.

__________________________________________________________________

Revision history:

  2023-10-12 11:53:02 UTC Initial Report
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="https://lists.squid-cache.org/listinfo/squid-announce">https://lists.squid-cache.org/listinfo/squid-announce</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026310.html">[squid-users] [squid-announce] [ADVISORY] SQUID-2023:1 Request/Response smuggling in HTTP(S) and ICAP
</A></li>
	<LI>Next message (by thread): <A HREF="026217.html">[squid-users] Security advisories pointing to Squid 6.4, but no download (yer)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26311">[ date ]</a>
              <a href="thread.html#26311">[ thread ]</a>
              <a href="subject.html#26311">[ subject ]</a>
              <a href="author.html#26311">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
