<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid-cache authentication is not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-cache%20authentication%20is%20not%20working&In-Reply-To=%3C859124378.3984982.1694325260684%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026071.html">
   <LINK REL="Next"  HREF="026074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid-cache authentication is not working</H1>
    <B>Jason Long</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-cache%20authentication%20is%20not%20working&In-Reply-To=%3C859124378.3984982.1694325260684%40mail.yahoo.com%3E"
       TITLE="[squid-users] Squid-cache authentication is not working">hack3rcon at yahoo.com
       </A><BR>
    <I>Sun Sep 10 05:54:20 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026071.html">[squid-users] Squid-cache authentication is not working
</A></li>
        <LI>Next message (by thread): <A HREF="026074.html">[squid-users] Does Squid-cache support SOCKS5 protocol?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26073">[ date ]</a>
              <a href="thread.html#26073">[ thread ]</a>
              <a href="subject.html#26073">[ subject ]</a>
              <a href="author.html#26073">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
Thanks again.
You right, I must move the following lines after the authentication lines:

http_access allow localnet
http_access allow localhost
http_access deny all

It worked.



On Sunday, September 10, 2023 at 01:57:32 AM GMT+3:30, Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote: 



On 2023-09-09 15:09, Jason Long wrote:

&gt;<i> My Squid-cache server IP is &quot;192.168.1.2&quot;.
</I>&gt;<i> I use Mozilla Firefox and set the proxy to &quot;192.168.1.2:3128&quot;.
</I>&gt;<i> What information do you need to tell you?
</I>
Do you see Firefox requests/transactions reflected in Squid access.log?

Anything in Squid cache.log?

Sorry, I do not know where those logs are on your machine. Typical 
locations include /var/log/ and /usr/local/squid/var/logs

Another thing to check is whether the http_access rules you have added 
are in the right place. If you simply appended those rules to the 
default Squid configuration file, then they will not work (because 
http_access rules above them will be used instead). Default squid.conf 
marks the place where you should insert custom http_access rules: Look 
for an &quot;INSERT YOUR OWN RULE(S) HERE&quot; comment.

You can check this second theory by removing &quot;http_access allow 
auth_users&quot; and leaving just the &quot;http_access deny all&quot; rule that you 
have added earlier. If everything still works, then either Squid does 
not receive these requests at all (i.e. the first theory) or your access 
rules are too low (i.e. this second theory).


HTH,

Alex.


&gt;<i>&#160; &#160; On Sat, Sep 9, 2023 at 5:56 PM, Alex Rousskov
</I>&gt;<i>&#160; &#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;<i>&#160; &#160; On 2023-09-09 09:09, Jason Long wrote:
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; &#160; &gt; Hello,
</I>&gt;<i>&#160; &#160; &#160; &gt; I installed the Squid-cache on Debian 12, then I installed the
</I>&gt;<i>&#160; &#160; Apache utils:
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; $ sudo apt install apache2-utils
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; After it, I did the following steps:
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; $ sudo touch /etc/squid/passwd
</I>&gt;<i>&#160; &#160; &#160; &gt; $ sudo chown proxy /etc/squid/passwd
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; Then:
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; $ sudo htpasswd /etc/squid/passwd jason
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; After it, I opened the &quot;/etc/squid/squid.conf&quot; file and add the
</I>&gt;<i>&#160; &#160; following lines to it:
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; auth_param basic program /usr/lib/squid/basic_ncsa_auth
</I>&gt;<i>&#160; &#160; /etc/squid/passwd
</I>&gt;<i>&#160; &#160; &#160; &gt; auth_param basic children 5
</I>&gt;<i>&#160; &#160; &#160; &gt; auth_param basic realm Squid Basic Authentication
</I>&gt;<i>&#160; &#160; &#160; &gt; auth_param basic credentialsttl 2 hours
</I>&gt;<i>&#160; &#160; &#160; &gt; acl auth_users proxy_auth REQUIRED
</I>&gt;<i>&#160; &#160; &#160; &gt; http_access allow auth_users
</I>&gt;<i>&#160; &#160; &#160; &gt; http_access deny all
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; Finally:
</I>&gt;<i>&#160; &#160; &#160; &gt; $ sudo systemctl restart squid
</I>&gt;<i>&#160; &#160; &#160; &gt;
</I>&gt;<i>&#160; &#160; &#160; &gt; But, on the client machine, I can visit any website without the
</I>&gt;<i>&#160; &#160; username and password.
</I>&gt;<i>&#160; &#160; &#160; &gt; Which part of the configuration is wrong?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; Many things could go wrong, but I would start from the beginning:
</I>&gt;<i>&#160; &#160; Perhaps the client (browser) is not configured to use the proxy? Do you
</I>&gt;<i>&#160; &#160; see client transactions reflected in Squid access.log? Anything in
</I>&gt;<i>&#160; &#160; Squid
</I>&gt;<i>&#160; &#160; cache.log?
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; HTH,
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; Alex.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>&#160; &#160; _______________________________________________
</I>&gt;<i>&#160; &#160; squid-users mailing list
</I>&gt;<i>&#160; &#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>&#160; &#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>
&gt;<i>&#160; &#160; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>&#160; &#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026071.html">[squid-users] Squid-cache authentication is not working
</A></li>
	<LI>Next message (by thread): <A HREF="026074.html">[squid-users] Does Squid-cache support SOCKS5 protocol?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26073">[ date ]</a>
              <a href="thread.html#26073">[ thread ]</a>
              <a href="subject.html#26073">[ subject ]</a>
              <a href="author.html#26073">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
