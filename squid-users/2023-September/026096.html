<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.6%20and%205.9%20keep%20crashing%20due%20to%20signal%206%0A%20with%20status%200&In-Reply-To=%3C72c1fbc2-f4a0-4e14-b8ea-430e4bc16ea9%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026095.html">
   <LINK REL="Next"  HREF="026103.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%205.6%20and%205.9%20keep%20crashing%20due%20to%20signal%206%0A%20with%20status%200&In-Reply-To=%3C72c1fbc2-f4a0-4e14-b8ea-430e4bc16ea9%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Sep 14 14:11:52 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026095.html">[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0
</A></li>
        <LI>Next message (by thread): <A HREF="026103.html">[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26096">[ date ]</a>
              <a href="thread.html#26096">[ thread ]</a>
              <a href="subject.html#26096">[ subject ]</a>
              <a href="author.html#26096">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2023-09-14 07:02, Flashdown wrote:

&gt;<i> Sep 14 08:55:06 vm-myproxy squid[79100]: Squid Parent: squid-2 process 
</I>&gt;<i> 80675 exited due to signal 6 with status 0
</I>
&gt;<i> 1694674498.411&#160;&#160;&#160;&#160;&#160; 9 **CENSORED_internal_client_IP** TCP_DENIED/407 
</I>&gt;<i> 4129 CONNECT [ff00::]:443 - HIER_NONE/- text/html
</I>
&gt;<i> IPv6 is disabled via sysctl config &quot;net.ipv6.conf.all.disable_ipv6=1&quot;
</I>

Your Squid is most likely suffering (among other v5 bugs) from Squid Bug 
5154: <A HREF="https://bugs.squid-cache.org/show_bug.cgi?id=5154">https://bugs.squid-cache.org/show_bug.cgi?id=5154</A>

To confirm, enable core dumps and look for a gdb backtrace sequence 
similar to the one posted in the above bug report:

* in __assert_fail
* in Ip::Address::getAddrInfo(addrinfo*&amp;, int) const
* in comm_openex(int, int, Ip::Address&amp;, int, char const*)

The best known way to prevent bug 5154 is to enable IPv6 support. If 
that is not feasible in your environment, then please keep reading.


Squid bug 5154 has an unofficial but, IMO, correct fix at PR 1421:
<A HREF="https://github.com/squid-cache/squid/pull/1421">https://github.com/squid-cache/squid/pull/1421</A>

The above fix is not trivial and has side effects: For Squids that 
cannot handle IPv6 (e.g., because IPv6 support was disabled at 
./configure time or is unavailable in the deployment environment), the 
fix will, in part, reject requests with IPv6 addresses in URLs. This 
rejection may negatively affect Squids that were &quot;worked OK&quot; by 
forwarding such traffic to IPv4 ICAP servers and cache_peers (at least).

PR 1421 changes cannot be applied to Squid v5 &quot;as is&quot;; they have to be 
backported. I do not have a backporting patch for virgin Squid v5.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026095.html">[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0
</A></li>
	<LI>Next message (by thread): <A HREF="026103.html">[squid-users] Squid 5.6 and 5.9 keep crashing due to signal 6 with status 0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26096">[ date ]</a>
              <a href="thread.html#26096">[ thread ]</a>
              <a href="subject.html#26096">[ subject ]</a>
              <a href="author.html#26096">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
