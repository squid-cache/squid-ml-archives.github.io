<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Seeking Help with SSL Bump Configuration for ECDSA Ciphers in Squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Seeking%20Help%20with%20SSL%20Bump%20Configuration%20for%0A%20ECDSA%20Ciphers%20in%20Squid&In-Reply-To=%3C26ab01c2-39b5-430a-a199-3186008024d4%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026117.html">
   <LINK REL="Next"  HREF="026118.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Seeking Help with SSL Bump Configuration for ECDSA Ciphers in Squid</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Seeking%20Help%20with%20SSL%20Bump%20Configuration%20for%0A%20ECDSA%20Ciphers%20in%20Squid&In-Reply-To=%3C26ab01c2-39b5-430a-a199-3186008024d4%40measurement-factory.com%3E"
       TITLE="[squid-users] Seeking Help with SSL Bump Configuration for ECDSA Ciphers in Squid">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Sep 25 18:30:01 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026117.html">[squid-users] Seeking Help with SSL Bump Configuration for ECDSA Ciphers in Squid
</A></li>
        <LI>Next message (by thread): <A HREF="026118.html">[squid-users] Transparent deployment VS web services behind DNS load balancing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26119">[ date ]</a>
              <a href="thread.html#26119">[ thread ]</a>
              <a href="subject.html#26119">[ subject ]</a>
              <a href="author.html#26119">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2023-09-25 05:31, nikhil deshpande wrote:

&gt;<i> Any update on this?
</I>
This is not really an &quot;update&quot; because this mailing list has not 
received or has not posted the original email quoted below:
<A HREF="https://lists.squid-cache.org/pipermail/squid-users/2023-September/thread.html">https://lists.squid-cache.org/pipermail/squid-users/2023-September/thread.html</A>


&gt;<i> On Thu, Sep 14, 2023 at 6:05&#8239;PM Shyam varun &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">shyam3898 at gmail.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">shyam3898 at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Dear Squid Mailing List Community,
</I>&gt;<i> 
</I>&gt;<i>     I hope this email finds you well. I am currently working on
</I>&gt;<i>     configuring SSL bump in Squid proxy server to support ECDSA ciphers,
</I>&gt;<i>     and I am seeking assistance with a particular issue I've encountered.
</I>&gt;<i> 
</I>&gt;<i>     To provide some context:
</I>&gt;<i> 
</I>&gt;<i>     - *Squid Version:* Squid 5.2
</I>
Please note that Squid v5 is not officially supported by the Squid 
Project. Please consider upgrading to Squid v6.


&gt;<i>     - *OpenSSL Version*: OpenSSL 1.1.1l
</I>&gt;<i>     - *OS:* Alpine Linux v3.16
</I>&gt;<i>     - *_Squid Configuration: _
</I>&gt;<i>     *
</I>&gt;<i> 
</I>&gt;<i>             */sslproxy_cert_error allow all/*
</I>&gt;<i> 
</I>&gt;<i>             */sslcrtd_program /usr/lib/squid/security_file_certgen -s
</I>&gt;<i>             /var/lib/ssl_db -M 4MB/*
</I>&gt;<i> 
</I>&gt;<i>     */
</I>&gt;<i>     /*
</I>&gt;<i> 
</I>&gt;<i>             */http_port 3129 ssl-bump generate-host-certificates=on
</I>&gt;<i>             dynamic_cert_mem_cache_size=4MB
</I>&gt;<i>             cert=/opt/ssl/intermediate_certificate.pem
</I>&gt;<i>             key=/opt/ssl/intermediate_key.pem
</I>&gt;<i>             options=SINGLE_DH_USE,SINGLE_ECDH_USE tls-dh=/opt/dhparam.pem/*
</I>&gt;<i> 
</I>&gt;<i>     */
</I>&gt;<i>     /*
</I>&gt;<i> 
</I>&gt;<i>             */tls_outgoing_options min-version=1.1 &#160;options=NO_SSLv3/*
</I>&gt;<i> 
</I>&gt;<i>     */
</I>&gt;<i>     /*
</I>&gt;<i> 
</I>&gt;<i>             */acl step1 at_step SslBump1/*
</I>&gt;<i> 
</I>&gt;<i>             */ssl_bump peek step1/*
</I>&gt;<i> 
</I>&gt;<i>             */ssl_bump bump all/*
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     The goal of my configuration is to enable SSL bump for ECDSA
</I>&gt;<i>     ciphers, specifically the &quot;ECDHE-ECDSA-AES256-GCM-SHA384&quot; and
</I>&gt;<i>     &quot;ECDHE-ECDSA-AES128-GCM-SHA256&quot; cipher suites. However, I've run
</I>&gt;<i>     into challenges and issues while trying to achieve this.
</I>
Are you trying to bump TLS client connections when and only when the TLS 
client is offering to use one of those ciphers in its ClientHello 
message? Or do you want Squid to use one of those ciphers when bumping 
all TLS client connections? Or something else? Please clarify.

If Squid logs ERRORs or WARNINGs to cache.log at startup, especially 
messages that are seemingly related to TLS and http_port configuration, 
please share them.


FWIW, to restrict Squid use of ciphers on accepted TLS client 
connections, use the http_port (or https_port) &quot;cipher&quot; option. For 
example,

     https_port 3129 ssl-bump ... \
         cipher=DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384

If you tried that, and it did not work, please detail what did not work. 
Providing a pointer to raw TLS ClientHello/ServerHello messages (in 
libpcap format that Wireshark can grok) exchanged by the TLS client and 
Squid may be helpful. These packets should show ciphers offered by TLS 
client and ciphers offered by Squid.

Providing a pointer to compressed Squid cache.log with debug_options set 
to ALL,9 collected while reproducing the issue using a dedicated 
transaction may also help: 
<A HREF="https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction">https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction</A>


Thank you,

Alex.



&gt;<i>     *Things I tried:*
</I>&gt;<i> 
</I>&gt;<i>      1. I created an ECDSA-based certificate chain using OpenSSL.
</I>&gt;<i>      2. I configured the ECDSA-based certificate certs in squid as shown
</I>&gt;<i>         in above snippet but still not able to make it work.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     I've thoroughly reviewed the Squid documentation and online
</I>&gt;<i>     resources, but I haven't been able to resolve these issues on my own.
</I>&gt;<i> 
</I>&gt;<i>     I would greatly appreciate any guidance, insights, or assistance
</I>&gt;<i>     from the Squid community regarding the proper configuration for SSL
</I>&gt;<i>     bump with ECDSA ciphers. If you have successfully configured Squid
</I>&gt;<i>     to support ECDSA ciphers or if you have expertise in this area, your
</I>&gt;<i>     input would be invaluable.
</I>&gt;<i> 
</I>&gt;<i>     Thank you in advance for your time and support. I look forward to
</I>&gt;<i>     your responses and insights.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026117.html">[squid-users] Seeking Help with SSL Bump Configuration for ECDSA Ciphers in Squid
</A></li>
	<LI>Next message (by thread): <A HREF="026118.html">[squid-users] Transparent deployment VS web services behind DNS load balancing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26119">[ date ]</a>
              <a href="thread.html#26119">[ thread ]</a>
              <a href="subject.html#26119">[ subject ]</a>
              <a href="author.html#26119">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
