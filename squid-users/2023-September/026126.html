<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [squid-announce] SQUID-2020:13 Denial of Service in gopher gateway
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20SQUID-2020%3A13%20Denial%20of%20Service%20in%0A%20gopher%20gateway&In-Reply-To=%3C007ce345-d427-4244-bb34-42f8623f5b87%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026127.html">
   <LINK REL="Next"  HREF="026128.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [squid-announce] SQUID-2020:13 Denial of Service in gopher gateway</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5Bsquid-announce%5D%20SQUID-2020%3A13%20Denial%20of%20Service%20in%0A%20gopher%20gateway&In-Reply-To=%3C007ce345-d427-4244-bb34-42f8623f5b87%40treenet.co.nz%3E"
       TITLE="[squid-users] [squid-announce] SQUID-2020:13 Denial of Service in gopher gateway">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Sep 27 06:40:53 UTC 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026127.html">[squid-users] [squid-announce] SQUID-2021:8 Denial of Service in Gopher gateway
</A></li>
        <LI>Next message (by thread): <A HREF="026128.html">[squid-users] squid-users Digest, Vol 109, Issue 19
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26126">[ date ]</a>
              <a href="thread.html#26126">[ thread ]</a>
              <a href="subject.html#26126">[ subject ]</a>
              <a href="author.html#26126">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>__________________________________________________________________

   Squid Proxy Cache Security Update Advisory SQUID-2020:13
__________________________________________________________________

Advisory ID:       | SQUID-2020:13
Date:              | September 06, 2023
Summary:           | Denial of Service in gopher gateway
Affected versions: | Squid 2.x -&gt; 2.7.STABLE9
                    | Squid 3.x -&gt; 3.5.28
                    | Squid 4.x -&gt; 4.14
                    | Squid 5.x -&gt; 5.6
Fixed in version:  | Squid 6.0.1
__________________________________________________________________

Problem Description:

  Due to a buffer overflow bug Squid is vulnerable to a Denial of Service
  attack against Squid's gopher gateway.

__________________________________________________________________

Severity:

  This problem allows a remote gopher: server to trigger a buffer
  overflow by delivering large gopher protocol responses.
  On most operating systems with memory protection this will
  halt Squid service immediately, causing a denial of service to
  all Squid clients.

  The gopher protocol is always available and enabled in Squid
  prior to Squid 6.0.1

  Responses triggering this bug are possible to be received from
  any gopher server, even those without malicious intent.


CVSS Score of 7.5
&lt;<A HREF="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&amp;version=3.1">https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&amp;version=3.1</A>&gt;

__________________________________________________________________

Updated Packages:

  The gopher support has been removed in Squid version 6.0.1

  If you are using a prepackaged version of Squid then please refer
  to the package vendor for availability information on updated
  packages.

__________________________________________________________________

Determining if your version is vulnerable:

  All Squid-2.x up to and including 2.7.STABLE9 are vulnerable.

  All Squid-3.x up to and including 3.5.28 are vulnerable.

  All Squid-4.x up to and including 4.14 are vulnerable.

  All Squid-5.x up to and including 5.6 are vulnerable.

__________________________________________________________________

Workaround:

  * Reject all gopher URL requests

   acl gopher proto gopher
   http_access deny gopher

  Note: removing the gopher port 70 from the Safe_ports ACL
        is not sufficient to avoid this vulnerability.
__________________________________________________________________

Contact details for the Squid project:

  For installation / upgrade support on binary packaged versions
  of Squid: Your first point of contact should be your binary
  package vendor.

  If you install and build Squid from the original Squid sources
  then the &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt; mailing list is your
  primary support point. For subscription details see
  &lt;<A HREF="http://www.squid-cache.org/Support/mailing-lists.html">http://www.squid-cache.org/Support/mailing-lists.html</A>&gt;.

  For reporting of non-security bugs in the latest STABLE release
  the squid bugzilla database should be used
  &lt;<A HREF="https://bugs.squid-cache.org/">https://bugs.squid-cache.org/</A>&gt;.

  For reporting of security sensitive bugs send an email to the
  &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-bugs at lists.squid-cache.org</A>&gt; mailing list. It's a closed
  list (though anyone can post) and security related bug reports
  are treated in confidence until the impact has been established.

__________________________________________________________________

Credits:

  This vulnerability was discovered by Marco Grassi.

__________________________________________________________________

Revision history:

  2019-06-15 13:32:50 UTC Initial Report
__________________________________________________________________
END
_______________________________________________
squid-announce mailing list
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-announce at lists.squid-cache.org</A>
<A HREF="https://lists.squid-cache.org/listinfo/squid-announce">https://lists.squid-cache.org/listinfo/squid-announce</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026127.html">[squid-users] [squid-announce] SQUID-2021:8 Denial of Service in Gopher gateway
</A></li>
	<LI>Next message (by thread): <A HREF="026128.html">[squid-users] squid-users Digest, Vol 109, Issue 19
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26126">[ date ]</a>
              <a href="thread.html#26126">[ thread ]</a>
              <a href="subject.html#26126">[ subject ]</a>
              <a href="author.html#26126">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
