<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%206.10%20on%20Fedora%2040%20cannot%20intercept%20and%20bump%0A%20SSL%20Traffic&In-Reply-To=%3Caf9608b6-5388-4d78-8e96-eea3267b6bc7%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027047.html">
   <LINK REL="Next"  HREF="027051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%206.10%20on%20Fedora%2040%20cannot%20intercept%20and%20bump%0A%20SSL%20Traffic&In-Reply-To=%3Caf9608b6-5388-4d78-8e96-eea3267b6bc7%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Aug 19 19:59:13 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027047.html">[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
</A></li>
        <LI>Next message (by thread): <A HREF="027051.html">[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27048">[ date ]</a>
              <a href="thread.html#27048">[ thread ]</a>
              <a href="subject.html#27048">[ subject ]</a>
              <a href="author.html#27048">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-08-19 15:27, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> wrote:

&gt;<i> I see that there is a SNI so I am not sure how to look at the issue.
</I>
FWIW, as the next step, I still recommend answering the remaining open 
questions. Everything else makes a facinating read but is less likely to 
help us make progress (and may obscure/hide actual answers and test 
results). I will restate those remaining questions for your convenience:

* Do all those 12 access.log records correspond to a single curl 
request? If not, please only share access.log record(s) that do correspond.

2. Does everything work for non-intercept ports? Use the same curl test 
you have shared below, but specify proxy address for curl to use.

4. Does everything work when you remove &quot;ssl-bump&quot; and related options 
from intercepting http_port 33128 (and use that intercepted port in the 
same curl test)?

5. Does everything work when you use &quot;ssl_bump splice all&quot; instead of 
your current ssl_bump rule? Same curl parameters as in Q4.

6. Does everything work when you use &quot;ssl_bump peek all&quot; instead of your 
current ssl_bump rule? Same curl parameters as in Q4.


While going through the above list, top to bottom, if you find a test 
that does _not_ work, pause: There is no need to proceed with other, 
more complicated tests if an earlier simpler/basic test fails.


HTH,

Alex.


&gt;<i> I was thinking that maybe it's something with the OpenSSL version (3.x.x) on Fedora but then I installed both 5.9 and 6.10 on Almalinux 8 and the result is the same.
</I>&gt;<i> 
</I>&gt;<i> I will describe my setup which might give some background.
</I>&gt;<i> I have a very big lab...
</I>&gt;<i> In the front of the Internet connection there are couple NGFW devices and RouterOS.
</I>&gt;<i> Mikrotik RouterOS is the edge and all the others are used with PBR accordingly.
</I>&gt;<i> The proxy sits in a deferent segment on the network and I have tried couple methods to intercept the traffic with squid.
</I>&gt;<i> The only one which works with Squid and the existing equipment and do not cause some weird loop is ethernet level tunnel ie not:
</I>&gt;<i> * GRE
</I>&gt;<i> * IPIP
</I>&gt;<i> And couple others.
</I>&gt;<i> 
</I>&gt;<i> The only ones which works fine are:
</I>&gt;<i> * EoIP (Mikrotik which is based on GRE0
</I>&gt;<i> * VxLAN
</I>&gt;<i> 
</I>&gt;<i> There are two methods to intercept the traffic:
</I>&gt;<i> * PBR+DNAT on the squid box
</I>&gt;<i> * PBR+TPROXY on the squid box
</I>&gt;<i> 
</I>&gt;<i> Since the intercept method terminates the connection and creates a new one with the ip of the proxy it's very simple to even use gre and ipip.
</I>&gt;<i> But, with tproxy to allow the traffic being identified currently as a packet which is not still in the routing stack we the linux OS need to tag it somehow.
</I>&gt;<i> To do that the default &quot;Salt&quot; for the packet hash in the routing stack is the source and destination mac address.
</I>&gt;<i> Due to this the only methods which are allowing to use tproxy are the above mentioned tunnels. (Maybe I will post a video on it later on with a demo)
</I>&gt;<i> 
</I>&gt;<i> The Mikrotik RouterOS device re-routes the traffic from the LAN interface into the VxLAN interface directly to the proxy machine which has a
</I>&gt;<i> static or dynamic route to the LAN subnet via the other side of the VxLAN tunnel which is the edge RouterOS device.
</I>&gt;<i> I want to gather a set of configurations and tests for this configurations to verify what might cause this issue and if possible to resolve it.
</I>&gt;<i> For me it seems that if my FortiGate and CheckPoint devices are able to intercept the traffic and &quot;Bump&quot; it, there is no reason why squid should
</I>&gt;<i> be able to do that the same way.
</I>&gt;<i> 
</I>&gt;<i> I will later on send you a private link to the pcaps in a zip file so you would be able to inspect this issue in the network level and to see if there is
</I>&gt;<i> some details which can help us understand what cause this specific issue.
</I>&gt;<i> 
</I>&gt;<i> I want to say that bumping works fine on non-intercepted connections and that I have tested the interception with the two available methods ie:
</I>&gt;<i> * DNAT Redirect
</I>&gt;<i> * Tproxy
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Eliezer Croitoru
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i> Sent: Monday, August 19, 2024 7:18 PM
</I>&gt;<i> To: NgTech LTD &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
</I>&gt;<i> Subject: Re: [squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
</I>&gt;<i> 
</I>&gt;<i> Eliezer, please move this thread back to squid-users mailing list
</I>&gt;<i> instead of emailing me personally. When you do so, please clarify
</I>&gt;<i> whether all 12 access.log records correspond to this single curl request
</I>&gt;<i> (if not, please only share access.log record(s) that do correspond). --Alex.
</I>&gt;<i> 
</I>&gt;<i> On 2024-08-19 12:03, NgTech LTD wrote:
</I>&gt;&gt;<i> This is the output of curl on windows 11 desktop:
</I>&gt;&gt;<i> C:\Users\USER&gt;curl <A HREF="https://www.youtube.com/">https://www.youtube.com/</A> -k -v -o 1.txt
</I>&gt;&gt;<i>     % Total    % Received % Xferd  Average Speed   Time    Time     Time
</I>&gt;&gt;<i>    Current
</I>&gt;&gt;<i>                                    Dload  Upload   Total   Spent    Left
</I>&gt;&gt;<i>    Speed
</I>&gt;&gt;<i>     0     0    0     0    0     0      0      0 --:--:-- --:--:--
</I>&gt;&gt;<i> --:--:--     0* Host www.youtube.com:443 &lt;<A HREF="http://www.youtube.com:443">http://www.youtube.com:443</A>&gt;
</I>&gt;&gt;<i> was resolved.
</I>&gt;&gt;<i> * IPv6: 2a00:1450:4001:800::200e, 2a00:1450:4001:80e::200e,
</I>&gt;&gt;<i> 2a00:1450:4001:81c::200e, 2a00:1450:4001:809::200e
</I>&gt;&gt;<i> * IPv4: 142.250.185.78, 142.250.185.110, 142.250.185.142,
</I>&gt;&gt;<i> 142.250.186.174, 142.250.185.174, 142.250.184.238, 142.250.185.238,
</I>&gt;&gt;<i> 142.250.185.206, 142.250.181.238, 142.250.186.46, 142.250.186.78,
</I>&gt;&gt;<i> 172.217.16.142, 216.58.212.174, 216.58.206.46, 172.217.23.110,
</I>&gt;&gt;<i> 216.58.212.142
</I>&gt;&gt;<i> *   Trying 142.250.185.78:443...
</I>&gt;&gt;<i> * Connected to www.youtube.com &lt;<A HREF="http://www.youtube.com">http://www.youtube.com</A>&gt; (142.250.185.78)
</I>&gt;&gt;<i> port 443
</I>&gt;&gt;<i> * schannel: disabled automatic use of client certificate
</I>&gt;&gt;<i> * ALPN: curl offers http/1.1
</I>&gt;&gt;<i> * ALPN: server accepted http/1.1
</I>&gt;&gt;<i> * using HTTP/1.x
</I>&gt;&gt;<i>   &gt; GET / HTTP/1.1
</I>&gt;&gt;<i>   &gt; Host: www.youtube.com &lt;<A HREF="http://www.youtube.com">http://www.youtube.com</A>&gt;
</I>&gt;&gt;<i>   &gt; User-Agent: curl/8.8.0
</I>&gt;&gt;<i>   &gt; Accept: */*
</I>&gt;&gt;<i>   &gt;
</I>&gt;&gt;<i> * Request completely sent off
</I>&gt;&gt;<i> * schannel: remote party requests renegotiation
</I>&gt;&gt;<i> * schannel: renegotiating SSL/TLS connection
</I>&gt;&gt;<i> * schannel: SSL/TLS connection renegotiated
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> &lt; HTTP/1.1 200 OK
</I>&gt;&gt;<i> &lt; Content-Type: text/html; charset=utf-8
</I>&gt;&gt;<i> &lt; X-Content-Type-Options: nosniff
</I>&gt;&gt;<i> &lt; Cache-Control: no-cache, no-store, max-age=0, must-revalidate
</I>&gt;&gt;<i> &lt; Pragma: no-cache
</I>&gt;&gt;<i> &lt; Expires: Mon, 01 Jan 1990 00:00:00 GMT
</I>&gt;&gt;<i> &lt; Date: Mon, 19 Aug 2024 16:02:23 GMT
</I>&gt;&gt;<i> &lt; X-Frame-Options: SAMEORIGIN
</I>&gt;&gt;<i> &lt; Strict-Transport-Security: max-age=31536000
</I>&gt;&gt;<i> &lt; Origin-Trial:
</I>&gt;&gt;<i> AmhMBR6zCLzDDxpW+HfpP67BqwIknWnyMOXOQGfzYswFmJe+fgaI6XZgAzcxOrzNtP7hEDsOo1jdjFnVr2IdxQ4AAAB4eyJvcmlnaW4iOiJodHRwczovL3lvdXR1YmUuY29tOjQ0MyIsImZlYXR1cmUiOiJXZWJWaWV3WFJlcXVlc3RlZFdpdGhEZXByZWNhdGlvbiIsImV4cGlyeSI6MTc1ODA2NzE5OSwiaXNTdWJkb21haW4iOnRydWV9
</I>&gt;&gt;<i> &lt; Cross-Origin-Opener-Policy: same-origin-allow-popups;
</I>&gt;&gt;<i> report-to=&quot;youtube_main&quot;
</I>&gt;&gt;<i> &lt; Report-To:
</I>&gt;&gt;<i> {&quot;group&quot;:&quot;youtube_main&quot;,&quot;max_age&quot;:2592000,&quot;endpoints&quot;:[{&quot;url&quot;:&quot;<A HREF="https://csp.withgoogle.com/csp/report-to/youtube_main">https://csp.withgoogle.com/csp/report-to/youtube_main</A> &lt;<A HREF="https://csp.withgoogle.com/csp/report-to/youtube_main">https://csp.withgoogle.com/csp/report-to/youtube_main</A>&gt;&quot;}]}
</I>&gt;&gt;<i> &lt; Content-Security-Policy: require-trusted-types-for 'script'
</I>&gt;&gt;<i> &lt; Permissions-Policy: ch-ua-arch=*, ch-ua-bitness=*,
</I>&gt;&gt;<i> ch-ua-full-version=*, ch-ua-full-version-list=*, ch-ua-model=*,
</I>&gt;&gt;<i> ch-ua-wow64=*, ch-ua-form-factors=*, ch-ua-platform=*,
</I>&gt;&gt;<i> ch-ua-platform-version=*
</I>&gt;&gt;<i> &lt; P3P: CP=&quot;This is not a P3P policy! See
</I>&gt;&gt;<i> <A HREF="http://support.google.com/accounts/answer/151657?hl=en">http://support.google.com/accounts/answer/151657?hl=en</A>
</I>&gt;&gt;<i> &lt;<A HREF="http://support.google.com/accounts/answer/151657?hl=en">http://support.google.com/accounts/answer/151657?hl=en</A>&gt; for more info.&quot;
</I>&gt;&gt;<i> &lt; Server: ESF
</I>&gt;&gt;<i> &lt; X-XSS-Protection: 0
</I>&gt;&gt;<i> &lt; Set-Cookie: GPS=1; Domain=.youtube.com &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;;
</I>&gt;&gt;<i> Expires=Mon, 19-Aug-2024 16:32:23 GMT; Path=/; Secure; HttpOnly
</I>&gt;&gt;<i> &lt; Set-Cookie: YSC=XYs_jViLkFw; Domain=.youtube.com &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;;
</I>&gt;&gt;<i> Path=/; Secure; HttpOnly; SameSite=none
</I>&gt;&gt;<i> &lt; Set-Cookie: VISITOR_INFO1_LIVE=csMabhlNyrI; Domain=.youtube.com
</I>&gt;&gt;<i> &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;; Expires=Sat, 15-Feb-2025 16:02:23 GMT; Path=/;
</I>&gt;&gt;<i> Secure; HttpOnly; SameSite=none
</I>&gt;&gt;<i> &lt; Set-Cookie: VISITOR_PRIVACY_METADATA=CgJJTBIEGgAgVw%3D%3D;
</I>&gt;&gt;<i> Domain=.youtube.com &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;; Expires=Sat, 15-Feb-2025
</I>&gt;&gt;<i> 16:02:23 GMT; Path=/; Secure; HttpOnly; SameSite=none
</I>&gt;&gt;<i> &lt; Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000
</I>&gt;&gt;<i> &lt; Accept-Ranges: none
</I>&gt;&gt;<i> &lt; Vary: Accept-Encoding
</I>&gt;&gt;<i> &lt; Transfer-Encoding: chunked
</I>&gt;&gt;<i> &lt;
</I>&gt;&gt;<i> { [3674 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [8008 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2462 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [4128 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [4128 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [4128 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5242 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6922 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [20378 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [3839 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [9632 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [2752 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [7994 bytes data]
</I>&gt;&gt;<i> 100  193k    0  193k    0     0   293k      0 --:--:-- --:--:-- --:--:--
</I>&gt;&gt;<i>    294k* schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [28937 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [8414 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [9632 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [7852 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [5504 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [17888 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [19016 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [15136 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [10760 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [6880 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [34152 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [28648 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [33026 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [14888 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [24768 bytes data]
</I>&gt;&gt;<i> * schannel: failed to decrypt data, need more data
</I>&gt;&gt;<i> { [12136 bytes data]
</I>&gt;&gt;<i> 100  498k    0  498k    0     0   665k      0 --:--:-- --:--:-- --:--:--
</I>&gt;&gt;<i>    669k
</I>&gt;&gt;<i> * Connection #0 to host www.youtube.com &lt;<A HREF="http://www.youtube.com">http://www.youtube.com</A>&gt; left intact
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> And the access.log:
</I>&gt;&gt;<i> 1724083303.298      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083303.888    589 192.168.78.15 TCP_TUNNEL/200 529157 CONNECT
</I>&gt;&gt;<i> 142.250.185.78:443 &lt;<A HREF="http://142.250.185.78:443">http://142.250.185.78:443</A>&gt; -
</I>&gt;&gt;<i> ORIGINAL_DST/142.250.185.78 &lt;<A HREF="http://142.250.185.78">http://142.250.185.78</A>&gt; - -
</I>&gt;&gt;<i> 1724083307.305      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083307.908    603 192.168.78.15 TCP_TUNNEL/200 530241 CONNECT
</I>&gt;&gt;<i> 142.250.185.78:443 &lt;<A HREF="http://142.250.185.78:443">http://142.250.185.78:443</A>&gt; -
</I>&gt;&gt;<i> ORIGINAL_DST/142.250.185.78 &lt;<A HREF="http://142.250.185.78">http://142.250.185.78</A>&gt; - -
</I>&gt;&gt;<i> 1724083311.615      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083312.255    640 192.168.78.15 TCP_TUNNEL/200 528465 CONNECT
</I>&gt;&gt;<i> 142.250.185.78:443 &lt;<A HREF="http://142.250.185.78:443">http://142.250.185.78:443</A>&gt; -
</I>&gt;&gt;<i> ORIGINAL_DST/142.250.185.78 &lt;<A HREF="http://142.250.185.78">http://142.250.185.78</A>&gt; - -
</I>&gt;&gt;<i> 1724083316.666      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083317.315    649 192.168.78.15 TCP_TUNNEL/200 529617 CONNECT
</I>&gt;&gt;<i> 142.250.185.78:443 &lt;<A HREF="http://142.250.185.78:443">http://142.250.185.78:443</A>&gt; -
</I>&gt;&gt;<i> ORIGINAL_DST/142.250.185.78 &lt;<A HREF="http://142.250.185.78">http://142.250.185.78</A>&gt; - -
</I>&gt;&gt;<i> 1724083342.731      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083343.377    645 192.168.78.15 TCP_TUNNEL/200 528377 CONNECT
</I>&gt;&gt;<i> 142.250.185.78:443 &lt;<A HREF="http://142.250.185.78:443">http://142.250.185.78:443</A>&gt; -
</I>&gt;&gt;<i> ORIGINAL_DST/142.250.185.78 &lt;<A HREF="http://142.250.185.78">http://142.250.185.78</A>&gt; - -
</I>&gt;&gt;<i> 1724083378.565      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i> 1724083378.801      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i> error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----
</I>&gt;&gt;<i> Eliezer Croitoru
</I>&gt;&gt;<i> Tech Support
</I>&gt;&gt;<i> Mobile: +972-5-28704261
</I>&gt;&gt;<i> Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Mon, Aug 19, 2024 at 3:21&#8239;PM Alex Rousskov
</I>&gt;&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      On 2024-08-19 03:47, NgTech LTD wrote:
</I>&gt;&gt;<i>       &gt; I am testing Squid 6.10 on Fedora 40 (their package).
</I>&gt;&gt;<i>       &gt; And it seems that Squid is unable to bump clients (ESNI/ECH)?
</I>&gt;&gt;<i>       &gt;
</I>&gt;&gt;<i>       &gt; I had couple iterations of pek stare and bump and I am not sure
</I>&gt;&gt;<i>      what is
</I>&gt;&gt;<i>       &gt; the reason for that:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      What do you use as a client? Judging by the number of
</I>&gt;&gt;<i>      error:invalid-request entries in your access.log, that client may
</I>&gt;&gt;<i>      not be
</I>&gt;&gt;<i>      speaking HTTP/1 inside those CONNECT tunnels.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Does everything work for non-intercept ports?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Does everything work in a basic curl or wget test?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Does everything work when you remove &quot;ssl-bump&quot; and related options
</I>&gt;&gt;<i>      from
</I>&gt;&gt;<i>      intercepting http_port 33128?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Does everything work when you use &quot;ssl_bump splice all&quot; instead of your
</I>&gt;&gt;<i>      current ssl_bump rule?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Does everything work when you use &quot;ssl_bump peek all&quot; instead of your
</I>&gt;&gt;<i>      current ssl_bump rule?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       &gt; shutdown_lifetime 3 seconds
</I>&gt;&gt;<i>       &gt; external_acl_type whitelist-lookup-helper ipv4 ttl=10
</I>&gt;&gt;<i>      children-max=10
</I>&gt;&gt;<i>       &gt; children-startup=2 \
</I>&gt;&gt;<i>       &gt;          children-idle=2 concurrency=10 %URI %SRC
</I>&gt;&gt;<i>       &gt; /usr/local/bin/squid-conf-url-lookup.rb
</I>&gt;&gt;<i>       &gt; acl whitelist-lookup external  whitelist-lookup-helper
</I>&gt;&gt;<i>       &gt; acl ytmethods method POST GET
</I>&gt;&gt;<i>       &gt; acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 &quot;this&quot; network
</I>&gt;&gt;<i>      (LAN)
</I>&gt;&gt;<i>       &gt; acl localnet src 10.0.0.0/8 &lt;<A HREF="http://10.0.0.0/8">http://10.0.0.0/8</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://10.0.0.0/8">http://10.0.0.0/8</A> &lt;<A HREF="http://10.0.0.0/8">http://10.0.0.0/8</A>&gt;&gt;             # RFC 1918
</I>&gt;&gt;<i>       &gt; local private network (LAN)
</I>&gt;&gt;<i>       &gt; acl localnet src 100.64.0.0/10 &lt;<A HREF="http://100.64.0.0/10">http://100.64.0.0/10</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://100.64.0.0/10">http://100.64.0.0/10</A> &lt;<A HREF="http://100.64.0.0/10">http://100.64.0.0/10</A>&gt;&gt;          # RFC
</I>&gt;&gt;<i>       &gt; 6598 shared address space (CGN)
</I>&gt;&gt;<i>       &gt; acl localnet src 169.254.0.0/16 &lt;<A HREF="http://169.254.0.0/16">http://169.254.0.0/16</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://169.254.0.0/16">http://169.254.0.0/16</A> &lt;<A HREF="http://169.254.0.0/16">http://169.254.0.0/16</A>&gt;&gt;         # RFC
</I>&gt;&gt;<i>       &gt; 3927 link-local (directly plugged) machines
</I>&gt;&gt;<i>       &gt; acl localnet src 172.16.0.0/12 &lt;<A HREF="http://172.16.0.0/12">http://172.16.0.0/12</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://172.16.0.0/12">http://172.16.0.0/12</A> &lt;<A HREF="http://172.16.0.0/12">http://172.16.0.0/12</A>&gt;&gt;          # RFC
</I>&gt;&gt;<i>       &gt; 1918 local private network (LAN)
</I>&gt;&gt;<i>       &gt; acl localnet src 192.168.0.0/16 &lt;<A HREF="http://192.168.0.0/16">http://192.168.0.0/16</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://192.168.0.0/16">http://192.168.0.0/16</A> &lt;<A HREF="http://192.168.0.0/16">http://192.168.0.0/16</A>&gt;&gt;         # RFC
</I>&gt;&gt;<i>       &gt; 1918 local private network (LAN)
</I>&gt;&gt;<i>       &gt; acl localnet src fc00::/7               # RFC 4193 local private
</I>&gt;&gt;<i>      network
</I>&gt;&gt;<i>       &gt; range
</I>&gt;&gt;<i>       &gt; acl localnet src fe80::/10              # RFC 4291 link-local
</I>&gt;&gt;<i>      (directly
</I>&gt;&gt;<i>       &gt; plugged) machines
</I>&gt;&gt;<i>       &gt; acl SSL_ports port 443
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 80          # http
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 21          # ftp
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 443         # https
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 70          # gopher
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 210         # wais
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 280         # http-mgmt
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 488         # gss-http
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 591         # filemaker
</I>&gt;&gt;<i>       &gt; acl Safe_ports port 777         # multiling http
</I>&gt;&gt;<i>       &gt; http_access deny !Safe_ports
</I>&gt;&gt;<i>       &gt; http_access deny CONNECT !SSL_ports
</I>&gt;&gt;<i>       &gt; http_access allow localhost manager
</I>&gt;&gt;<i>       &gt; http_access deny manager
</I>&gt;&gt;<i>       &gt; http_access allow localhost
</I>&gt;&gt;<i>       &gt; http_access deny to_localhost
</I>&gt;&gt;<i>       &gt; http_access deny to_linklocal
</I>&gt;&gt;<i>       &gt; acl tubedoms dstdomain .ytimg.com &lt;<A HREF="http://ytimg.com">http://ytimg.com</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://ytimg.com">http://ytimg.com</A> &lt;<A HREF="http://ytimg.com">http://ytimg.com</A>&gt;&gt; .youtube.com &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://youtube.com">http://youtube.com</A> &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;&gt; .youtu.be
</I>&gt;&gt;<i>      &lt;<A HREF="http://youtu.be">http://youtu.be</A>&gt; &lt;<A HREF="http://youtu.be">http://youtu.be</A> &lt;<A HREF="http://youtu.be">http://youtu.be</A>&gt;&gt;
</I>&gt;&gt;<i>       &gt; http_access allow ytmethods localnet tubedoms whitelist-lookup
</I>&gt;&gt;<i>       &gt; http_access allow localnet
</I>&gt;&gt;<i>       &gt; http_access deny all
</I>&gt;&gt;<i>       &gt; http_port 3128
</I>&gt;&gt;<i>       &gt; http_port 13128 ssl-bump tls-cert=/etc/squid/ssl/cert.pem
</I>&gt;&gt;<i>       &gt; tls-key=/etc/squid/ssl/key.pem \
</I>&gt;&gt;<i>       &gt;          generate-host-certificates=on
</I>&gt;&gt;<i>      dynamic_cert_mem_cache_size=4MB
</I>&gt;&gt;<i>       &gt; http_port 23128 tproxy ssl-bump tls-cert=/etc/squid/ssl/cert.pem
</I>&gt;&gt;<i>       &gt; tls-key=/etc/squid/ssl/key.pem \
</I>&gt;&gt;<i>       &gt;          generate-host-certificates=on
</I>&gt;&gt;<i>      dynamic_cert_mem_cache_size=4MB
</I>&gt;&gt;<i>       &gt; http_port 33128 intercept ssl-bump tls-cert=/etc/squid/ssl/cert.pem
</I>&gt;&gt;<i>       &gt; tls-key=/etc/squid/ssl/key.pem \
</I>&gt;&gt;<i>       &gt;          generate-host-certificates=on
</I>&gt;&gt;<i>      dynamic_cert_mem_cache_size=4MB
</I>&gt;&gt;<i>       &gt; sslcrtd_program /usr/lib64/squid/security_file_certgen -s
</I>&gt;&gt;<i>       &gt; /var/spool/squid/ssl_db -M 4MB
</I>&gt;&gt;<i>       &gt; sslcrtd_children 5
</I>&gt;&gt;<i>       &gt; acl foreignProtocol squid_error ERR_PROTOCOL_UNKNOWN ERR_TOO_BIG
</I>&gt;&gt;<i>       &gt; acl serverTalksFirstProtocol squid_error ERR_REQUEST_START_TIMEOUT
</I>&gt;&gt;<i>       &gt; on_unsupported_protocol tunnel foreignProtocol
</I>&gt;&gt;<i>       &gt; on_unsupported_protocol tunnel serverTalksFirstProtocol
</I>&gt;&gt;<i>       &gt; on_unsupported_protocol respond all
</I>&gt;&gt;<i>       &gt; acl monitoredSites ssl::server_name .youtube.com
</I>&gt;&gt;<i>      &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt; &lt;<A HREF="http://youtube.com">http://youtube.com</A> &lt;<A HREF="http://youtube.com">http://youtube.com</A>&gt;&gt;
</I>&gt;&gt;<i>       &gt; .ytimg.com &lt;<A HREF="http://ytimg.com">http://ytimg.com</A>&gt; &lt;<A HREF="http://ytimg.com">http://ytimg.com</A> &lt;<A HREF="http://ytimg.com">http://ytimg.com</A>&gt;&gt;
</I>&gt;&gt;<i>       &gt; acl monitoredSitesRegex ssl::server_name_regex \.youtube\.com
</I>&gt;&gt;<i>      \.ytimg\.com
</I>&gt;&gt;<i>       &gt; acl serverIsBank ssl::server_name .visa.com &lt;<A HREF="http://visa.com">http://visa.com</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://visa.com">http://visa.com</A> &lt;<A HREF="http://visa.com">http://visa.com</A>&gt;&gt;
</I>&gt;&gt;<i>       &gt; acl step1 at_step SslBump1
</I>&gt;&gt;<i>       &gt; acl step2 at_step SslBump2
</I>&gt;&gt;<i>       &gt; acl step3 at_step SslBump3
</I>&gt;&gt;<i>       &gt; ssl_bump bump all
</I>&gt;&gt;<i>       &gt; strip_query_terms off
</I>&gt;&gt;<i>       &gt; coredump_dir /var/spool/squid
</I>&gt;&gt;<i>       &gt; refresh_pattern ^ftp:           1440    20%     10080
</I>&gt;&gt;<i>       &gt; refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
</I>&gt;&gt;<i>       &gt; refresh_pattern .               0       20%     4320
</I>&gt;&gt;<i>       &gt; logformat ssl_custom_format %ts.%03tu %6tr %&gt;a %Ss/%03&gt;Hs %&lt;st
</I>&gt;&gt;<i>      %rm %ru
</I>&gt;&gt;<i>       &gt; %[un %Sh/%&lt;a %mt %ssl::&gt;sni
</I>&gt;&gt;<i>       &gt; access_log daemon:/var/log/squid/access.log ssl_custom_format
</I>&gt;&gt;<i>       &gt; ##EOF
</I>&gt;&gt;<i>       &gt;
</I>&gt;&gt;<i>       &gt; access.log from before:
</I>&gt;&gt;<i>       &gt; 1724028804.797    486 192.168.78.15 TCP_TUNNEL/200 17764 CONNECT
</I>&gt;&gt;<i>       &gt; 40.126.31.73:443 &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A> &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/40.126.31.73 &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A> &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028805.413      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.028      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.028      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.029      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.030      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.085     57 192.168.78.15 TCP_TUNNEL/200 4513 CONNECT
</I>&gt;&gt;<i>       &gt; 104.18.72.113:443 &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A> &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.18.72.113 &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A> &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028806.086     56 192.168.78.15 TCP_TUNNEL/200 4513 CONNECT
</I>&gt;&gt;<i>       &gt; 104.18.72.113:443 &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A> &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.18.72.113 &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A> &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028806.086     56 192.168.78.15 TCP_TUNNEL/200 4512 CONNECT
</I>&gt;&gt;<i>       &gt; 104.18.72.113:443 &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A> &lt;<A HREF="http://104.18.72.113:443">http://104.18.72.113:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.18.72.113 &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A> &lt;<A HREF="http://104.18.72.113">http://104.18.72.113</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028806.208      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.213      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.338      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.469      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028806.596      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028807.006      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028807.262      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028808.922   5037 192.168.78.15 TCP_TUNNEL/200 6096 CONNECT
</I>&gt;&gt;<i>       &gt; 13.107.246.60:443 &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A> &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/13.107.246.60 &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A> &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028812.906   8336 192.168.78.15 TCP_TUNNEL/200 1071500 CONNECT
</I>&gt;&gt;<i>       &gt; 104.126.37.171:443 &lt;<A HREF="http://104.126.37.171:443">http://104.126.37.171:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.171:443">http://104.126.37.171:443</A> &lt;<A HREF="http://104.126.37.171:443">http://104.126.37.171:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.126.37.171 &lt;<A HREF="http://104.126.37.171">http://104.126.37.171</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.171">http://104.126.37.171</A> &lt;<A HREF="http://104.126.37.171">http://104.126.37.171</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028819.209 247893 192.168.78.15 TCP_TUNNEL/200 4023 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.186.34:443 &lt;<A HREF="http://142.250.186.34:443">http://142.250.186.34:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.34:443">http://142.250.186.34:443</A> &lt;<A HREF="http://142.250.186.34:443">http://142.250.186.34:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.186.34 &lt;<A HREF="http://142.250.186.34">http://142.250.186.34</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.34">http://142.250.186.34</A> &lt;<A HREF="http://142.250.186.34">http://142.250.186.34</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028820.097 250033 192.168.78.15 TCP_TUNNEL/200 549611 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.184.246:443 &lt;<A HREF="http://142.250.184.246:443">http://142.250.184.246:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.184.246:443">http://142.250.184.246:443</A> &lt;<A HREF="http://142.250.184.246:443">http://142.250.184.246:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.184.246 &lt;<A HREF="http://142.250.184.246">http://142.250.184.246</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.184.246">http://142.250.184.246</A> &lt;<A HREF="http://142.250.184.246">http://142.250.184.246</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028820.154 246850 192.168.78.15 TCP_TUNNEL/200 15119 CONNECT
</I>&gt;&gt;<i>       &gt; 216.58.206.65:443 &lt;<A HREF="http://216.58.206.65:443">http://216.58.206.65:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://216.58.206.65:443">http://216.58.206.65:443</A> &lt;<A HREF="http://216.58.206.65:443">http://216.58.206.65:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/216.58.206.65 &lt;<A HREF="http://216.58.206.65">http://216.58.206.65</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://216.58.206.65">http://216.58.206.65</A> &lt;<A HREF="http://216.58.206.65">http://216.58.206.65</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028820.164 246856 192.168.78.15 TCP_TUNNEL/200 3037 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.181.227:443 &lt;<A HREF="http://142.250.181.227:443">http://142.250.181.227:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.181.227:443">http://142.250.181.227:443</A> &lt;<A HREF="http://142.250.181.227:443">http://142.250.181.227:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.181.227 &lt;<A HREF="http://142.250.181.227">http://142.250.181.227</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.181.227">http://142.250.181.227</A> &lt;<A HREF="http://142.250.181.227">http://142.250.181.227</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028820.203 246893 192.168.78.15 TCP_TUNNEL/200 3031 CONNECT
</I>&gt;&gt;<i>       &gt; 172.217.16.196:443 &lt;<A HREF="http://172.217.16.196:443">http://172.217.16.196:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://172.217.16.196:443">http://172.217.16.196:443</A> &lt;<A HREF="http://172.217.16.196:443">http://172.217.16.196:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/172.217.16.196 &lt;<A HREF="http://172.217.16.196">http://172.217.16.196</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://172.217.16.196">http://172.217.16.196</A> &lt;<A HREF="http://172.217.16.196">http://172.217.16.196</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028822.656 271833 192.168.78.15 TCP_TUNNEL/200 387583 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.185.238:443 &lt;<A HREF="http://142.250.185.238:443">http://142.250.185.238:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.238:443">http://142.250.185.238:443</A> &lt;<A HREF="http://142.250.185.238:443">http://142.250.185.238:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.185.238 &lt;<A HREF="http://142.250.185.238">http://142.250.185.238</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.238">http://142.250.185.238</A> &lt;<A HREF="http://142.250.185.238">http://142.250.185.238</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028830.336      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028830.781    444 192.168.78.15 TCP_TUNNEL/200 18505 CONNECT
</I>&gt;&gt;<i>       &gt; 40.126.31.73:443 &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A> &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/40.126.31.73 &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A> &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028841.781 155018 192.168.78.15 TCP_TUNNEL/200 15960 CONNECT
</I>&gt;&gt;<i>       &gt; 13.107.6.158:443 &lt;<A HREF="http://13.107.6.158:443">http://13.107.6.158:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://13.107.6.158:443">http://13.107.6.158:443</A> &lt;<A HREF="http://13.107.6.158:443">http://13.107.6.158:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/13.107.6.158 &lt;<A HREF="http://13.107.6.158">http://13.107.6.158</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://13.107.6.158">http://13.107.6.158</A> &lt;<A HREF="http://13.107.6.158">http://13.107.6.158</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028849.443      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028849.698      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028865.261      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028865.779    517 192.168.78.15 TCP_TUNNEL/200 18557 CONNECT
</I>&gt;&gt;<i>       &gt; 40.126.31.73:443 &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A> &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/40.126.31.73 &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A> &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028870.718 109994 192.168.78.15 TCP_TUNNEL/200 6972 CONNECT
</I>&gt;&gt;<i>       &gt; 20.42.65.94:443 &lt;<A HREF="http://20.42.65.94:443">http://20.42.65.94:443</A>&gt; &lt;<A HREF="http://20.42.65.94:443">http://20.42.65.94:443</A>
</I>&gt;&gt;<i>      &lt;<A HREF="http://20.42.65.94:443">http://20.42.65.94:443</A>&gt;&gt; - ORIGINAL_DST/20.42.65.94
</I>&gt;&gt;<i>      &lt;<A HREF="http://20.42.65.94">http://20.42.65.94</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://20.42.65.94">http://20.42.65.94</A> &lt;<A HREF="http://20.42.65.94">http://20.42.65.94</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028871.179  64583 192.168.78.15 TCP_TUNNEL/200 1903 CONNECT
</I>&gt;&gt;<i>       &gt; 104.18.10.207:443 &lt;<A HREF="http://104.18.10.207:443">http://104.18.10.207:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.10.207:443">http://104.18.10.207:443</A> &lt;<A HREF="http://104.18.10.207:443">http://104.18.10.207:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.18.10.207 &lt;<A HREF="http://104.18.10.207">http://104.18.10.207</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.18.10.207">http://104.18.10.207</A> &lt;<A HREF="http://104.18.10.207">http://104.18.10.207</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028871.179  63917 192.168.78.15 TCP_TUNNEL/200 2430 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.186.99:443 &lt;<A HREF="http://142.250.186.99:443">http://142.250.186.99:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.99:443">http://142.250.186.99:443</A> &lt;<A HREF="http://142.250.186.99:443">http://142.250.186.99:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.186.99 &lt;<A HREF="http://142.250.186.99">http://142.250.186.99</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.99">http://142.250.186.99</A> &lt;<A HREF="http://142.250.186.99">http://142.250.186.99</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028871.179  64709 192.168.78.15 TCP_TUNNEL/200 2439 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.185.170:443 &lt;<A HREF="http://142.250.185.170:443">http://142.250.185.170:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.170:443">http://142.250.185.170:443</A> &lt;<A HREF="http://142.250.185.170:443">http://142.250.185.170:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.185.170 &lt;<A HREF="http://142.250.185.170">http://142.250.185.170</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.170">http://142.250.185.170</A> &lt;<A HREF="http://142.250.185.170">http://142.250.185.170</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028871.308      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028871.731    422 192.168.78.15 TCP_TUNNEL/200 17789 CONNECT
</I>&gt;&gt;<i>       &gt; 40.126.31.73:443 &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A> &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/40.126.31.73 &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A> &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028872.486      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028873.477      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028873.745      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028873.902    424 192.168.78.15 TCP_TUNNEL/200 18520 CONNECT
</I>&gt;&gt;<i>       &gt; 40.126.31.73:443 &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A> &lt;<A HREF="http://40.126.31.73:443">http://40.126.31.73:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/40.126.31.73 &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A> &lt;<A HREF="http://40.126.31.73">http://40.126.31.73</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028877.056      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028877.060      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028877.060      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028877.060      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028877.430 312389 192.168.78.15 TCP_TUNNEL/200 7884 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.186.78:443 &lt;<A HREF="http://142.250.186.78:443">http://142.250.186.78:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.78:443">http://142.250.186.78:443</A> &lt;<A HREF="http://142.250.186.78:443">http://142.250.186.78:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.186.78 &lt;<A HREF="http://142.250.186.78">http://142.250.186.78</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.186.78">http://142.250.186.78</A> &lt;<A HREF="http://142.250.186.78">http://142.250.186.78</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028878.800      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028878.920      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028879.072      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028880.808   7062 192.168.78.15 TCP_TUNNEL/200 836391 CONNECT
</I>&gt;&gt;<i>       &gt; 104.126.37.145:443 &lt;<A HREF="http://104.126.37.145:443">http://104.126.37.145:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.145:443">http://104.126.37.145:443</A> &lt;<A HREF="http://104.126.37.145:443">http://104.126.37.145:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.126.37.145 &lt;<A HREF="http://104.126.37.145">http://104.126.37.145</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.145">http://104.126.37.145</A> &lt;<A HREF="http://104.126.37.145">http://104.126.37.145</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028882.468  33024 192.168.78.15 TCP_TUNNEL/200 1488697 CONNECT
</I>&gt;&gt;<i>       &gt; 49.12.59.2:443 &lt;<A HREF="http://49.12.59.2:443">http://49.12.59.2:443</A>&gt; &lt;<A HREF="http://49.12.59.2:443">http://49.12.59.2:443</A>
</I>&gt;&gt;<i>      &lt;<A HREF="http://49.12.59.2:443">http://49.12.59.2:443</A>&gt;&gt; - ORIGINAL_DST/49.12.59.2 &lt;<A HREF="http://49.12.59.2">http://49.12.59.2</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://49.12.59.2">http://49.12.59.2</A> &lt;<A HREF="http://49.12.59.2">http://49.12.59.2</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028883.728   6671 192.168.78.15 TCP_TUNNEL/200 69351 CONNECT
</I>&gt;&gt;<i>       &gt; 52.216.185.251:443 &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A> &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/52.216.185.251 &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A> &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028883.789   6728 192.168.78.15 TCP_TUNNEL/200 69216 CONNECT
</I>&gt;&gt;<i>       &gt; 52.216.185.251:443 &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A> &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/52.216.185.251 &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A> &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028883.797   6736 192.168.78.15 TCP_TUNNEL/200 104657 CONNECT
</I>&gt;&gt;<i>       &gt; 52.216.185.251:443 &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A> &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/52.216.185.251 &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A> &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028883.845   6784 192.168.78.15 TCP_TUNNEL/200 80277 CONNECT
</I>&gt;&gt;<i>       &gt; 52.216.185.251:443 &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A> &lt;<A HREF="http://52.216.185.251:443">http://52.216.185.251:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/52.216.185.251 &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A> &lt;<A HREF="http://52.216.185.251">http://52.216.185.251</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028884.460 170355 192.168.78.15 TCP_TUNNEL/200 44690 CONNECT
</I>&gt;&gt;<i>       &gt; 185.199.108.153:443 &lt;<A HREF="http://185.199.108.153:443">http://185.199.108.153:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://185.199.108.153:443">http://185.199.108.153:443</A> &lt;<A HREF="http://185.199.108.153:443">http://185.199.108.153:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/185.199.108.153 &lt;<A HREF="http://185.199.108.153">http://185.199.108.153</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://185.199.108.153">http://185.199.108.153</A> &lt;<A HREF="http://185.199.108.153">http://185.199.108.153</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028889.845 120370 192.168.78.15 TCP_TUNNEL/200 5868 CONNECT
</I>&gt;&gt;<i>       &gt; 104.126.37.161:443 &lt;<A HREF="http://104.126.37.161:443">http://104.126.37.161:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.161:443">http://104.126.37.161:443</A> &lt;<A HREF="http://104.126.37.161:443">http://104.126.37.161:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/104.126.37.161 &lt;<A HREF="http://104.126.37.161">http://104.126.37.161</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://104.126.37.161">http://104.126.37.161</A> &lt;<A HREF="http://104.126.37.161">http://104.126.37.161</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028890.011 122862 192.168.78.15 TCP_TUNNEL/200 136726 CONNECT
</I>&gt;&gt;<i>       &gt; 23.37.37.211:443 &lt;<A HREF="http://23.37.37.211:443">http://23.37.37.211:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://23.37.37.211:443">http://23.37.37.211:443</A> &lt;<A HREF="http://23.37.37.211:443">http://23.37.37.211:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/23.37.37.211 &lt;<A HREF="http://23.37.37.211">http://23.37.37.211</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://23.37.37.211">http://23.37.37.211</A> &lt;<A HREF="http://23.37.37.211">http://23.37.37.211</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028890.297 120381 192.168.78.15 TCP_TUNNEL/200 9176 CONNECT
</I>&gt;&gt;<i>       &gt; 2.18.140.238:443 &lt;<A HREF="http://2.18.140.238:443">http://2.18.140.238:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://2.18.140.238:443">http://2.18.140.238:443</A> &lt;<A HREF="http://2.18.140.238:443">http://2.18.140.238:443</A>&gt;&gt; -
</I>&gt;&gt;<i>      ORIGINAL_DST/2.18.140.238 &lt;<A HREF="http://2.18.140.238">http://2.18.140.238</A>&gt;
</I>&gt;&gt;<i>       &gt; &lt;<A HREF="http://2.18.140.238">http://2.18.140.238</A> &lt;<A HREF="http://2.18.140.238">http://2.18.140.238</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028891.212      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028891.365    152 192.168.78.15 TCP_TUNNEL/200 2359 CONNECT
</I>&gt;&gt;<i>       &gt; 142.250.185.138:443 &lt;<A HREF="http://142.250.185.138:443">http://142.250.185.138:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.138:443">http://142.250.185.138:443</A> &lt;<A HREF="http://142.250.185.138:443">http://142.250.185.138:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/142.250.185.138 &lt;<A HREF="http://142.250.185.138">http://142.250.185.138</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://142.250.185.138">http://142.250.185.138</A> &lt;<A HREF="http://142.250.185.138">http://142.250.185.138</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028893.885  90253 192.168.78.15 TCP_TUNNEL/200 6374 CONNECT
</I>&gt;&gt;<i>       &gt; 13.107.246.60:443 &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A> &lt;<A HREF="http://13.107.246.60:443">http://13.107.246.60:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/13.107.246.60 &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A> &lt;<A HREF="http://13.107.246.60">http://13.107.246.60</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028900.169      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:invalid-request - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt; 1724028934.465 900262 192.168.78.15 TCP_TUNNEL/200 5530 CONNECT
</I>&gt;&gt;<i>       &gt; 52.123.243.197:443 &lt;<A HREF="http://52.123.243.197:443">http://52.123.243.197:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.123.243.197:443">http://52.123.243.197:443</A> &lt;<A HREF="http://52.123.243.197:443">http://52.123.243.197:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/52.123.243.197 &lt;<A HREF="http://52.123.243.197">http://52.123.243.197</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://52.123.243.197">http://52.123.243.197</A> &lt;<A HREF="http://52.123.243.197">http://52.123.243.197</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028960.494  60324 192.168.78.15 TCP_TUNNEL/503 0 CONNECT
</I>&gt;&gt;<i>       &gt; 172.217.16.206:443 &lt;<A HREF="http://172.217.16.206:443">http://172.217.16.206:443</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://172.217.16.206:443">http://172.217.16.206:443</A> &lt;<A HREF="http://172.217.16.206:443">http://172.217.16.206:443</A>&gt;&gt; -
</I>&gt;&gt;<i>       &gt; ORIGINAL_DST/172.217.16.206 &lt;<A HREF="http://172.217.16.206">http://172.217.16.206</A>&gt;
</I>&gt;&gt;<i>      &lt;<A HREF="http://172.217.16.206">http://172.217.16.206</A> &lt;<A HREF="http://172.217.16.206">http://172.217.16.206</A>&gt;&gt; - -
</I>&gt;&gt;<i>       &gt; 1724028960.494      0 192.168.78.15 NONE_NONE/000 0 -
</I>&gt;&gt;<i>       &gt; error:transaction-end-before-headers - HIER_NONE/- - -
</I>&gt;&gt;<i>       &gt;
</I>&gt;&gt;<i>       &gt; Thanks for any help,
</I>&gt;&gt;<i>       &gt;
</I>&gt;&gt;<i>       &gt;
</I>&gt;&gt;<i>       &gt; ----
</I>&gt;&gt;<i>       &gt; Eliezer Croitoru
</I>&gt;&gt;<i>       &gt; Tech Support
</I>&gt;&gt;<i>       &gt; Mobile: +972-5-28704261
</I>&gt;&gt;<i>       &gt; Email: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;
</I>&gt;&gt;<i>      &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ngtech1ltd at gmail.com</A>&gt;&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027047.html">[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
</A></li>
	<LI>Next message (by thread): <A HREF="027051.html">[squid-users] Squid 6.10 on Fedora 40 cannot intercept and bump SSL Traffic
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27048">[ date ]</a>
              <a href="thread.html#27048">[ thread ]</a>
              <a href="subject.html#27048">[ subject ]</a>
              <a href="author.html#27048">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
