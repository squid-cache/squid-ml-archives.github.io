<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Unable to access internal resources via hostname
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20access%20internal%20resources%20via%20hostname&In-Reply-To=%3CZs98Fg6uCgOH3c0r%40fantomas.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027091.html">
   <LINK REL="Next"  HREF="027088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Unable to access internal resources via hostname</H1>
    <B>Matus UHLAR - fantomas</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Unable%20to%20access%20internal%20resources%20via%20hostname&In-Reply-To=%3CZs98Fg6uCgOH3c0r%40fantomas.sk%3E"
       TITLE="[squid-users] Unable to access internal resources via hostname">uhlar at fantomas.sk
       </A><BR>
    <I>Wed Aug 28 19:35:50 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027091.html">[squid-users] Unable to access internal resources via hostname
</A></li>
        <LI>Next message (by thread): <A HREF="027088.html">[squid-users] negotiate_kerberos_auth not working anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27081">[ date ]</a>
              <a href="thread.html#27081">[ thread ]</a>
              <a href="subject.html#27081">[ subject ]</a>
              <a href="author.html#27081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> We are unable to get to internal resources via hostname but using the
</I>&gt;&gt;<i> IP address works fine.  Immediately, I thought this was DNS but when I
</I>&gt;&gt;<i> checked the /etc/resolv.conf/ file it was pointing correctly to our
</I>&gt;&gt;<i> Windows DNS server and we can ping all devices using their hostname,
</I>&gt;&gt;<i> just not when browsing to it.  This leads me to believe something may
</I>&gt;&gt;<i> be wrong with our squid config.
</I>&gt;<i>
</I>&gt;<i>hard to guess without seeing logs or ACL's.
</I>
On 28.08.24 15:24, Piana, Josh wrote:
&gt;<i>Here's the log and (I think) relevant ACL's?
</I>&gt;<i>-----------------------------------------------------------------------------------------------------------
</I>&gt;<i># /var/log/squid/access.log results for internal conflicts
</I>&gt;<i>
</I>&gt;<i>28/Aug/2024:10:57:17 -0400.234 10.46.49.190 TCP_DENIED/407 4132 CONNECT hexcelssp:443 - HIER_NONE/- text/html
</I>&gt;<i>28/Aug/2024:10:57:17 -0400.253 10.46.49.190 NONE_NONE/500 0 CONNECT hexcelssp:443 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">JPIANA at AD.</A>&lt;DOMAIN&gt;.COM HIER_NONE/- -
</I>&gt;<i>28/Aug/2024:10:57:17 -0400.380 10.46.49.190 TCP_DENIED/407 4132 CONNECT hexcelssp:443 - HIER_NONE/- text/html
</I>&gt;<i>28/Aug/2024:10:57:17 -0400.399 10.46.49.190 NONE_NONE/500 0 CONNECT hexcelssp:443 <A HREF="https://lists.squid-cache.org/listinfo/squid-users">JPIANA at AD.</A>&lt;DOMAIN&gt;.COM HIER_NONE/- -
</I>&gt;<i>-----------------------------------------------------------------------------------------------------------
</I>
[...]
&gt;<i>acl from_arc src 10.46.0.0/15
</I>[...]
&gt;<i>acl local_dst_addr dst bldg3.&lt;domain&gt;.com
</I>&gt;<i>acl local_dst_addr dst bldg5.&lt;domain&gt;.com
</I>
Are you aware that these get translated to IP addresses? 
If you want to use domain names as provided by client, use &quot;dstdomain&quot;.

&gt;<i># these keep URLs of popular local servers from being forwarded
</I>&gt;<i>acl local_dst_dom dstdomain arcgate
</I>
...just like this.

&gt;<i># allow connects to local destinations without authentication
</I>&gt;<i># by domain name from URL
</I>&gt;<i>http_access       allow local_dst_dom
</I>&gt;<i>http_reply_access allow local_dst_dom
</I>
http_reply_access is usually not needed, unless you want control what 
clients get only after the content is known to squid, which generally 
applies to e.g.  mime types.

If you don't do that, better comment out &quot;http_reply_access&quot; lines.

&gt;<i># allow trusted hosts without authentication
</I>&gt;<i># these are just ip's on the 10.46.11.x network
</I>&gt;<i>acl authless_src src &quot;/etc/squid/authless_src&quot;
</I>&gt;<i>http_access       allow authless_src
</I>&gt;<i>http_reply_access allow authless_src
</I>
I don't see any http_access &quot;deny&quot; line.
Also, I don't see any &quot;http_access allow from_arc&quot;
or any other line that should allow CONNECT from 10.46.49.190  to &quot;hexcelssp&quot;


-- 
Matus UHLAR - fantomas, <A HREF="https://lists.squid-cache.org/listinfo/squid-users">uhlar at fantomas.sk</A> ; <A HREF="http://www.fantomas.sk/">http://www.fantomas.sk/</A>
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
LSD will make your ECS screen display 16.7 million colors

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027091.html">[squid-users] Unable to access internal resources via hostname
</A></li>
	<LI>Next message (by thread): <A HREF="027088.html">[squid-users] negotiate_kerberos_auth not working anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27081">[ date ]</a>
              <a href="thread.html#27081">[ thread ]</a>
              <a href="subject.html#27081">[ subject ]</a>
              <a href="author.html#27081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
