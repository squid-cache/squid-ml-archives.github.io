<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid-internal-mgr/forward help
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-internal-mgr/forward%20help&In-Reply-To=%3C29c2134a-df68-414d-a570-6251aa2f24a5%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027331.html">
   <LINK REL="Next"  HREF="027336.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid-internal-mgr/forward help</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid-internal-mgr/forward%20help&In-Reply-To=%3C29c2134a-df68-414d-a570-6251aa2f24a5%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid-internal-mgr/forward help">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Dec 23 14:57:29 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027331.html">[squid-users] Squid-internal-mgr/forward help
</A></li>
        <LI>Next message (by thread): <A HREF="027336.html">[squid-users] Optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27333">[ date ]</a>
              <a href="thread.html#27333">[ thread ]</a>
              <a href="subject.html#27333">[ subject ]</a>
              <a href="author.html#27333">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-12-23 00:27, Eternal Dreamer wrote:

&gt;<i> I need some help with my squid-6.7 installation. I need to see 
</I>&gt;<i> forwarding status codes for my monitoring system, but squidclient -h 
</I>&gt;<i> 3128 mgr:forward is empty. Another stats from mgr:* works fine.
</I>
You are suffering from a Squid bug: In many cases, Squid incorrectly 
concludes that there are no mgr:forward stats available. Long time ago, 
the same code happened to work, but we accidentally violated its hidden 
invariant while fixing other problems related to counting forwarding 
attempts (e.g., Bug #4788).

There are also bugs related to how the number of forwarding attempts are 
currently shown in &quot;tryN&quot; columns of mgr:forward output: At least one 
&quot;tryN&quot; column _heading_ is missing, and &quot;try#1&quot; column corresponds to 
the rare case where no forwarding attempts had been made (rather than 
the implied common case where one forwarding attempt has happened).

Finally, due to poor code duplication, some forwarding attempts related 
to tunneling traffic (e.g., when handling CONNECT requests) may not be 
reflected in mgr:forward stats.


&gt;<i> How can I fix it?
</I>
Properly fixing mgr:forward report requires non-trivial development. 
Until somebody facilitates that[1], you can try an unofficial workaround 
patch[2] that alleviates _some_ of mgr:forward pains. The patch is 
against current master/v7, but it applies cleanly to Squid v6.7 AFAICT.


[1]: 
<A HREF="https://wiki.squid-cache.org/SquidFaq/AboutSquid#how-to-add-a-new-squid-feature-enhance-of-fix-something">https://wiki.squid-cache.org/SquidFaq/AboutSquid#how-to-add-a-new-squid-feature-enhance-of-fix-something</A>

[2]: 
<A HREF="https://github.com/measurement-factory/squid/commit/ec91885e04aeab5597c8792a14854ef653cb5cbf.patch">https://github.com/measurement-factory/squid/commit/ec91885e04aeab5597c8792a14854ef653cb5cbf.patch</A>


HTH,

Alex.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027331.html">[squid-users] Squid-internal-mgr/forward help
</A></li>
	<LI>Next message (by thread): <A HREF="027336.html">[squid-users] Optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27333">[ date ]</a>
              <a href="thread.html#27333">[ thread ]</a>
              <a href="subject.html#27333">[ subject ]</a>
              <a href="author.html#27333">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
