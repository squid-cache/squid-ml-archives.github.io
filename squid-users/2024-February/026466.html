<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Google recaptcha use
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Google%20recaptcha%20use&In-Reply-To=%3Cae7064d8-5531-4a03-811a-ff6a00ede05f%40borrill.org.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026464.html">
   <LINK REL="Next"  HREF="026467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Google recaptcha use</H1>
    <B>Stephen Borrill</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Google%20recaptcha%20use&In-Reply-To=%3Cae7064d8-5531-4a03-811a-ff6a00ede05f%40borrill.org.uk%3E"
       TITLE="[squid-users] Google recaptcha use">squid at borrill.org.uk
       </A><BR>
    <I>Tue Feb 20 08:40:57 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026464.html">[squid-users] Google recaptcha use
</A></li>
        <LI>Next message (by thread): <A HREF="026467.html">[squid-users] Google recaptcha use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26466">[ date ]</a>
              <a href="thread.html#26466">[ thread ]</a>
              <a href="subject.html#26466">[ subject ]</a>
              <a href="author.html#26466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/02/2024 08:06, Dsant wrote:
&gt;<i> Hello, I set up a squid proxy, I want to allow some sites, Google 
</I>&gt;<i> recaptcha and block everything else.
</I>&gt;<i> 
</I>&gt;<i> acl mydest dstdomain .projet-voltaire.fr
</I>&gt;<i> http_access allow mydest
</I>&gt;<i> acl&#160; google_recaptcha url_regex ^www.google.com/recaptcha/$
</I>&gt;<i> http_access allow google_recaptcha
</I>&gt;<i> http_access deny all
</I>&gt;<i> 
</I>&gt;<i> The captcha is not showing. A syntax error ?
</I>
www.google.com is an HTTPS site. This means that from the point of view 
of the proxy, only the hostname is visible (i.e. www.google.com) and so 
your regex can never match. Look in your logs, you will see:

CONNECT www.google.com

and not:

GET <A HREF="http://www.google.com/recaptcha/">http://www.google.com/recaptcha/</A>

The only way round this is to use ssl_bump to intercept and decrypt the 
traffic so that the HTTP request is visible. This is, however, not for 
the faint-hearted and will require a CA certificate to be installed on 
each client machine.

-- 
Stephen



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026464.html">[squid-users] Google recaptcha use
</A></li>
	<LI>Next message (by thread): <A HREF="026467.html">[squid-users] Google recaptcha use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26466">[ date ]</a>
              <a href="thread.html#26466">[ thread ]</a>
              <a href="subject.html#26466">[ subject ]</a>
              <a href="author.html#26466">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
