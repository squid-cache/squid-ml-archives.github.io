<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Rewriting HTTP to HTTPS for generic package proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Rewriting%20HTTP%20to%20HTTPS%20for%20generic%20package%20proxy&In-Reply-To=%3C075ae288-b3af-49ef-a4ca-f47bfd30a2fc%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026846.html">
   <LINK REL="Next"  HREF="026851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Rewriting HTTP to HTTPS for generic package proxy</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Rewriting%20HTTP%20to%20HTTPS%20for%20generic%20package%20proxy&In-Reply-To=%3C075ae288-b3af-49ef-a4ca-f47bfd30a2fc%40treenet.co.nz%3E"
       TITLE="[squid-users] Rewriting HTTP to HTTPS for generic package proxy">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jul 10 09:41:37 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026846.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
        <LI>Next message (by thread): <A HREF="026851.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26849">[ date ]</a>
              <a href="thread.html#26849">[ thread ]</a>
              <a href="subject.html#26849">[ subject ]</a>
              <a href="author.html#26849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/07/24 10:25, Fiehe, Christoph wrote:
&gt;<i> Hallo,
</I>&gt;<i> 
</I>&gt;<i> I hope that somebody has an idea, what I am doing wrong. I try to build a generic package proxy with Squid and need the feature to rewrite (not redirect) a HTTP request to a package repository transparently to a HTTPS-based package source.
</I>
The &quot;Wrong&quot; starts with the very idea you have that re-writing a URL 
scheme is even useful.


While it mas *seem* like an okay idea, what you are actually doing is 
exposing the HTTPS secured Response message to transmission over 
insecure connections from Squid to client. That is prohibited by HTTPS 
which assumes/requires encryption negotiated between the origin client 
and the origin server.


The best you can do for a regular proxy. Is *redirect* the <A HREF="http://">http://</A> 
requests with a 302 message telling the client to use <A HREF="https://">https://</A> instead.


   ...
   http_access deny !to_archive_mirrors

   acl HTTP proto HTTP
   deny_info 302:<A HREF="https://%">https://%</A>&gt;rd%rp HTTP
   http_access deny HTTP

   http_access allow src_networks
   ...



HTH
Amos


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026846.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
	<LI>Next message (by thread): <A HREF="026851.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26849">[ date ]</a>
              <a href="thread.html#26849">[ thread ]</a>
              <a href="subject.html#26849">[ subject ]</a>
              <a href="author.html#26849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
