<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Rewriting HTTP to HTTPS for generic package proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Rewriting%20HTTP%20to%20HTTPS%20for%20generic%20package%20proxy&In-Reply-To=%3C6bb89d7c58e34320b1eb15c1447e99d7%40eurodata.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026854.html">
   <LINK REL="Next"  HREF="026860.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Rewriting HTTP to HTTPS for generic package proxy</H1>
    <B>Fiehe, Christoph</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Rewriting%20HTTP%20to%20HTTPS%20for%20generic%20package%20proxy&In-Reply-To=%3C6bb89d7c58e34320b1eb15c1447e99d7%40eurodata.de%3E"
       TITLE="[squid-users] Rewriting HTTP to HTTPS for generic package proxy">c.fiehe at eurodata.de
       </A><BR>
    <I>Wed Jul 10 16:42:09 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026854.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
        <LI>Next message (by thread): <A HREF="026860.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26859">[ date ]</a>
              <a href="thread.html#26859">[ thread ]</a>
              <a href="subject.html#26859">[ subject ]</a>
              <a href="author.html#26859">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks a lot. That was a good advice. For test purposes, I have deconfigured the upstream proxy and used an internal server. I changed the scheme from HTTP to HTTPS via a Jesred rule. The translation is working as expected without any issues and the client receives the requested packages.

In the next test case, I used a more modern upstream proxy server based von Squid 6.8 and enabled debugging.

The log shows the error SQUID_TLS_ERR_CONNECT+GNUTLS_E_FATAL_ALERT_RECEIVED. I am not sure, what I can do to prevent it from occurring:

2024/07/10 18:24:44.031 kid1| 5,2| TcpAcceptor.cc(214) doAccept: New connection on FD 12
2024/07/10 18:24:44.031 kid1| 5,2| TcpAcceptor.cc(316) acceptNext: connection on conn482169 local=[::]:3128 remote=[::] FD 12 flags=9
2024/07/10 18:24:44.031 kid1| 51,3| fd.cc(168) fd_open: fd_open() FD 16 HTTP Request
2024/07/10 18:24:44.031 kid1| 28,3| Eui48.cc(511) lookup: id=0x5651b3e6d558 10.2.59.181 NOT found
2024/07/10 18:24:44.031 kid1| 17,2| QosConfig.cc(162) getNfConnmark: QOS: Failed to retrieve connection mark: (-1) (2) No such file or directory (Destination 212.89.134.12:3128, source 10.2.59.181:59100)
2024/07/10 18:24:44.031 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1 timeout 300
2024/07/10 18:24:44.031 kid1| 5,3| IoCallback.cc(112) finish: called for conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1 (0, 0)
2024/07/10 18:24:44.031 kid1| 5,3| Read.cc(93) ReadNow: conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1, size 4096, retval 293, errno 0
2024/07/10 18:24:44.031 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1 timeout 300
2024/07/10 18:24:44.031 kid1| 33,3| Pipeline.cc(43) back: Pipeline 0x5651b328cb80 empty
2024/07/10 18:24:44.031 kid1| 11,2| client_side.cc(1332) parseHttpRequest: HTTP Client conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1
2024/07/10 18:24:44.031 kid1| 11,2| client_side.cc(1333) parseHttpRequest: HTTP Client REQUEST:
---------
GET <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A> HTTP/1.1
Host: download.docker.com
Accept: text/*
User-Agent: Debian APT-HTTP/1.3 (2.4.12) non-interactive
Via: 1.1 pkg-proxy (squid/6.10)
X-Forwarded-For: 10.2.59.102
Cache-Control: max-age=0
Connection: keep-alive


----------
2024/07/10 18:24:44.031 kid1| 33,3| client_side.cc(1364) parseHttpRequest: complete request received. prefix_sz = 293, request-line-size=77, mime-header-size=216, mime header block:
Host: download.docker.com
Accept: text/*
User-Agent: Debian APT-HTTP/1.3 (2.4.12) non-interactive
Via: 1.1 pkg-proxy (squid/6.10)
X-Forwarded-For: 10.2.59.102
Cache-Control: max-age=0
Connection: keep-alive


----------
2024/07/10 18:24:44.031 kid1| 87,3| clientStream.cc(139) clientStreamInsertHead: clientStreamInsertHead: Inserted node 0x5651b6c14538 with data 0x5651b379ecb0 after head
2024/07/10 18:24:44.031 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1 timeout 86400
2024/07/10 18:24:44.031 kid1| 33,3| client_side.cc(1767) add: 0x5651b379dc40*3 to 0/0
2024/07/10 18:24:44.031 kid1| 33,3| Pipeline.cc(24) add: Pipeline 0x5651b328cb80 add request 1 0x5651b379dc40*4
2024/07/10 18:24:44.031 kid1| 23,3| Uri.cc(446) parse: Split URL '<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>' into proto='https', host='download.docker.com', port='443', path='/linux/ubuntu/dists/jammy/InRelease'
2024/07/10 18:24:44.031 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP 'download.docker.com': Name or service not known
2024/07/10 18:24:44.031 kid1| 33,3| client_side.cc(702) clientSetKeepaliveFlag: http_ver = HTTP/1.1
2024/07/10 18:24:44.031 kid1| 33,3| client_side.cc(703) clientSetKeepaliveFlag: method = GET
2024/07/10 18:24:44.031 kid1| 85,3| client_side_request.cc(123) ClientRequestContext: ClientRequestContext constructed, this=0x5651b667b8b8
2024/07/10 18:24:44.031 kid1| 83,3| client_side_request.cc(1709) doCallouts: Doing calloutContext-&gt;hostHeaderVerify()
2024/07/10 18:24:44.031 kid1| 85,3| client_side_request.cc(607) hostHeaderVerify: validate host=download.docker.com, port=0, portStr=NULL
2024/07/10 18:24:44.031 kid1| 85,3| client_side_request.cc(621) hostHeaderVerify: validate skipped.
2024/07/10 18:24:44.031 kid1| 83,3| client_side_request.cc(1716) doCallouts: Doing calloutContext-&gt;clientAccessCheck()
2024/07/10 18:24:44.031 kid1| 28,3| Checklist.cc(69) preCheck: 0x5651b56d0d38 checking slow rules
2024/07/10 18:24:44.032 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' found
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: follow_x_forwarded_for#1 = 1
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: follow_x_forwarded_for = 1
2024/07/10 18:24:44.032 kid1| 28,3| Checklist.cc(62) markFinished: 0x5651b56d0d38 answer DENIED for match
2024/07/10 18:24:44.032 kid1| 28,3| Checklist.cc(162) checkCallback: ACLChecklist::checkCallback: 0x5651b56d0d38 answer=DENIED
2024/07/10 18:24:44.032 kid1| 28,3| Checklist.cc(69) preCheck: 0x5651b5f334e8 checking slow rules
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: Safe_ports = 1
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: !Safe_ports = 0
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access#1 = 0
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: CONNECT = 0
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access#2 = 0
2024/07/10 18:24:44.032 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: localhost = 0
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access#3 = 0
2024/07/10 18:24:44.032 kid1| 28,3| RegexData.cc(50) match: checking '<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: manager = 0
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access#4 = 0
2024/07/10 18:24:44.032 kid1| 14,3| ipcache.cc(733) ipcache_gethostbyname: 'download.docker.com', flags=1
2024/07/10 18:24:44.032 kid1| 14,3| ipcache.cc(314) ipcacheRelease: ipcacheRelease: Releasing entry for 'download.docker.com'
2024/07/10 18:24:44.032 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP 'download.docker.com': Name or service not known
2024/07/10 18:24:44.032 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP 'download.docker.com': Name or service not known
2024/07/10 18:24:44.032 kid1| 78,3| dns_internal.cc(1793) idnsALookup: idnsALookup: buf is 37 bytes for download.docker.com, id = 0xc228
2024/07/10 18:24:44.032 kid1| 50,3| comm.cc(927) comm_udp_sendto: comm_udp_sendto: Attempt to send UDP packet to X.X.X.X:53 using FD 10 using Port 52871
2024/07/10 18:24:44.032 kid1| 78,3| dns_internal.cc(1729) idnsSendSlaveAAAAQuery: buf is 48 bytes for download.docker.com, id = 0x798c
2024/07/10 18:24:44.032 kid1| 50,3| comm.cc(927) comm_udp_sendto: comm_udp_sendto: Attempt to send UDP packet to X.X.X.X:53 using FD 10 using Port 52871
2024/07/10 18:24:44.032 kid1| 28,3| DestinationIp.cc(78) match: can't yet compare 'to_localhost' ACL for download.docker.com
2024/07/10 18:24:44.032 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP 'download.docker.com': Name or service not known
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: to_localhost = -1 async
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access#5 = -1 async
2024/07/10 18:24:44.032 kid1| 28,3| Acl.cc(175) matches: checked: http_access = -1 async
2024/07/10 18:24:44.048 kid1| 78,3| dns_internal.cc(1320) idnsRead: idnsRead: starting with FD 10
2024/07/10 18:24:44.049 kid1| 78,3| dns_internal.cc(1366) idnsRead: idnsRead: FD 10: received 144 bytes from X.X.X.X:53
2024/07/10 18:24:44.049 kid1| 78,3| dns_internal.cc(1173) idnsGrokReply: idnsGrokReply: QID 0xc228, 5 answers
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(481) ipcacheParse: 5 answers for download.docker.com
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #1 108.138.7.18
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #2 108.138.7.33
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #3 108.138.7.48
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #4 108.138.7.88
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(481) ipcacheParse: 5 answers for download.docker.com
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #1 108.138.7.18
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #2 108.138.7.33
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #3 108.138.7.48
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #4 108.138.7.88
2024/07/10 18:24:44.049 kid1| 78,3| dns_internal.cc(1320) idnsRead: idnsRead: starting with FD 10
2024/07/10 18:24:44.049 kid1| 78,3| dns_internal.cc(1366) idnsRead: idnsRead: FD 10: received 315 bytes from X.X.X.X:53
2024/07/10 18:24:44.049 kid1| 78,3| dns_internal.cc(1173) idnsGrokReply: idnsGrokReply: QID 0x798c, 9 answers
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(481) ipcacheParse: 9 answers for download.docker.com
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #5 [2600:9000:2490:2200:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #6 [2600:9000:2490:3600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #7 [2600:9000:2490:7000:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #8 [2600:9000:2490:d600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #9 [2600:9000:2490:5a00:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #10 [2600:9000:2490:6600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #11 [2600:9000:2490:b600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #12 [2600:9000:2490:aa00:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(587) ipcacheHandleReply: done with download.docker.com: 108.138.7.18 #1/12-0
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(481) ipcacheParse: 9 answers for download.docker.com
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #5 [2600:9000:2490:2200:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #6 [2600:9000:2490:3600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #7 [2600:9000:2490:7000:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #8 [2600:9000:2490:d600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #9 [2600:9000:2490:5a00:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #10 [2600:9000:2490:6600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #11 [2600:9000:2490:b600:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(536) addGood: download.docker.com #12 [2600:9000:2490:aa00:3:db06:4200:93a1]
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(587) ipcacheHandleReply: done with download.docker.com: 108.138.7.18 #1/12-0
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(314) ipcacheRelease: ipcacheRelease: Releasing entry for 'download.docker.com'
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(733) ipcache_gethostbyname: 'download.docker.com', flags=1
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.18' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.33' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.48' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.88' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:2200:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:3600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:7000:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:d600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:5a00:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:6600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:b600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:aa00:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: to_localhost = 0
2024/07/10 18:24:44.049 kid1| 28,3| InnerNode.cc(100) resumeMatchingAt: checked: http_access#5 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: PURGE = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#6 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: PURGE = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#7 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: localhost = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#8 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: nocnet = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#9 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: EXTERNAL_DEV_CLIENTS = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#10 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: CONNECT = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#11 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: CONNECT = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#12 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#13 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#14 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#15 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#16 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#17 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: Safe_ports = 1
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: !Safe_ports = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#18 = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: CONNECT = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#19 = 0
2024/07/10 18:24:44.049 kid1| 28,3| RegexData.cc(50) match: checking '/linux/ubuntu/dists/jammy/InRelease'
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: worm = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#20 = 0
2024/07/10 18:24:44.049 kid1| 14,3| ipcache.cc(733) ipcache_gethostbyname: 'download.docker.com', flags=1
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.18' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.33' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.48' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '108.138.7.88' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:2200:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:3600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:7000:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:d600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:5a00:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:6600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:b600:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '[2600:9000:2490:aa00:3:db06:4200:93a1]' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: SEUCHEN_IPS = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#21 = 0
2024/07/10 18:24:44.049 kid1| 28,3| DomainData.cc(110) match: aclMatchDomainList: checking 'download.docker.com'
2024/07/10 18:24:44.049 kid1| 28,3| DomainData.cc(115) match: aclMatchDomainList: 'download.docker.com' NOT found
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: SEUCHEN_DOMAINS = 0
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: http_access#22 = 0
2024/07/10 18:24:44.049 kid1| 28,3| RegexData.cc(50) match: checking 'download.docker.com'
2024/07/10 18:24:44.049 kid1| 28,3| Acl.cc(175) matches: checked: SEUCHEN_DOMAINS_REGEX = 0
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: http_access#23 = 0
2024/07/10 18:24:44.050 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' NOT found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: GERMANIA_PROXY = 0
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: http_access#24 = 0
2024/07/10 18:24:44.050 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: REPOSITORY-CLIENTS = 1
2024/07/10 18:24:44.050 kid1| 28,3| DomainData.cc(110) match: aclMatchDomainList: checking 'download.docker.com'
2024/07/10 18:24:44.050 kid1| 28,3| DomainData.cc(115) match: aclMatchDomainList: 'download.docker.com' found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: REPOSITORY-ZIELE = 1
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: http_access#25 = 1
2024/07/10 18:24:44.050 kid1| 28,3| InnerNode.cc(100) resumeMatchingAt: checked: http_access = 1
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(62) markFinished: 0x5651b5f334e8 answer ALLOWED for match
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(162) checkCallback: ACLChecklist::checkCallback: 0x5651b5f334e8 answer=ALLOWED
2024/07/10 18:24:44.050 kid1| 85,2| client_side_request.cc(715) clientAccessCheckDone: The request GET <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A> is ALLOWED; last ACL checked: REPOSITORY-ZIELE
2024/07/10 18:24:44.050 kid1| 83,3| AccessCheck.cc(42) Start: adaptation off, skipping
2024/07/10 18:24:44.050 kid1| 83,3| client_side_request.cc(1744) doCallouts: Doing calloutContext-&gt;clientAccessCheck2()
2024/07/10 18:24:44.050 kid1| 85,2| client_side_request.cc(693) clientAccessCheck2: No adapted_http_access configuration. default: ALLOW
2024/07/10 18:24:44.050 kid1| 85,2| client_side_request.cc(715) clientAccessCheckDone: The request GET <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A> is ALLOWED; last ACL checked: REPOSITORY-ZIELE
2024/07/10 18:24:44.050 kid1| 83,3| client_side_request.cc(1762) doCallouts: Doing clientInterpretRequestHeaders()
2024/07/10 18:24:44.050 kid1| 85,3| client_side_request.cc(117) ~ClientRequestContext: ClientRequestContext destructed, this=0x5651b667b8b8
2024/07/10 18:24:44.050 kid1| 83,3| client_side_request.cc(1856) doCallouts: calling processRequest()
2024/07/10 18:24:44.050 kid1| 87,3| clientStream.cc(178) clientStreamRead: clientStreamRead: Calling 1 with cbdata 0x5651b379fd80 from node 0x5651b6c14538
2024/07/10 18:24:44.050 kid1| 73,3| HttpRequest.cc(742) storeId: sent back effectiveRequestUrl: <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 20,3| Controller.cc(429) peek: D3522EE27FB0ED7004DD594AF7674667
2024/07/10 18:24:44.050 kid1| 85,3| client_side_reply.cc(1523) identifyFoundObject: StoreEntry is NULL -  MISS
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(731) storeCreatePureEntry: storeCreateEntry: '<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'
2024/07/10 18:24:44.050 kid1| 20,3| MemObject.cc(99) MemObject: MemObject constructed, this=0x5651b3ae4fc0
2024/07/10 18:24:44.050 kid1| 88,3| MemObject.cc(82) setUris: 0x5651b3ae4fc0 storeId: <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(435) lock: storeCreateEntry locked key [null_store_key] e:=V/0x5651b365e210*1
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(537) setPrivateKey: 00 e:=V/0x5651b365e210*1
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(413) hashInsert: StoreEntry::hashInsert: Inserting Entry e:=IV/0x5651b365e210*1 key '8349000000000000D107000001000000'
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(435) lock: store_client locked key 8349000000000000D107000001000000 e:=IV/0x5651b365e210*2
2024/07/10 18:24:44.050 kid1| 90,3| store_client.cc(243) copy: store_client::copy: 8349000000000000D107000001000000, from 0, for length 4096, cb 1, cbdata 0x5651b379ece8
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(435) lock: store_client::copy locked key 8349000000000000D107000001000000 e:=IV/0x5651b365e210*3
2024/07/10 18:24:44.050 kid1| 90,3| store_client.cc(343) storeClientCopy2: storeClientCopy2: 8349000000000000D107000001000000
2024/07/10 18:24:44.050 kid1| 90,3| store_client.cc(390) doCopy: store_client::doCopy: Waiting for more
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(458) unlock: store_client::copy unlocking key 8349000000000000D107000001000000 e:=IV/0x5651b365e210*3
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(69) preCheck: 0x7ffef6c09e30 checking fast rules
2024/07/10 18:24:44.050 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181:59100' found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: miss_access#1 = 1
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: miss_access = 1
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(62) markFinished: 0x7ffef6c09e30 answer ALLOWED for match
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(373) Start: '<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'
2024/07/10 18:24:44.050 kid1| 17,2| FwdState.cc(133) FwdState: Forwarding client request conn482175 local=212.89.134.12:3128 remote=10.2.59.181:59100 FD 16 flags=1, url=<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(435) lock: FwdState locked key 8349000000000000D107000001000000 e:=IV/0x5651b365e210*3
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(140) FwdState: FwdState constructed, this=0x5651b695faf8
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(309) peerSelect: e:=IV/0x5651b365e210*3 <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(435) lock: peerSelect locked key 8349000000000000D107000001000000 e:=IV/0x5651b365e210*4
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(612) selectMore: GET download.docker.com
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(617) selectMore: direct = DIRECT_UNKNOWN (always_direct to be checked)
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(69) preCheck: 0x5651b56d0d38 checking slow rules
2024/07/10 18:24:44.050 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.181' found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: always_direct#1 = 1
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: always_direct = 1
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(62) markFinished: 0x5651b56d0d38 answer ALLOWED for match
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(162) checkCallback: ACLChecklist::checkCallback: 0x5651b56d0d38 answer=ALLOWED
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(373) checkAlwaysDirectDone: ALLOWED
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(379) checkAlwaysDirectDone: direct = DIRECT_YES (always_direct allow)
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(612) selectMore: GET download.docker.com
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(1102) addSelection: adding HIER_DIRECT#download.docker.com
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(460) resolveSelected: Find IP destination for: <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>' via download.docker.com
2024/07/10 18:24:44.050 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP 'download.docker.com': Name or service not known
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482176 local=0.0.0.0 remote=108.138.7.18:443 HIER_DIRECT flags=1, destination #1 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482176 local=0.0.0.0 remote=108.138.7.18:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(1124) connectStart: 1+ paths to <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482177 local=0.0.0.0 remote=108.138.7.33:443 HIER_DIRECT flags=1, destination #2 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482177 local=0.0.0.0 remote=108.138.7.33:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482178 local=0.0.0.0 remote=108.138.7.48:443 HIER_DIRECT flags=1, destination #3 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482178 local=0.0.0.0 remote=108.138.7.48:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482179 local=0.0.0.0 remote=108.138.7.88:443 HIER_DIRECT flags=1, destination #4 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482179 local=0.0.0.0 remote=108.138.7.88:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482180 local=[::] remote=[2600:9000:2490:2200:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #5 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482180 local=[::] remote=[2600:9000:2490:2200:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482181 local=[::] remote=[2600:9000:2490:3600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #6 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482181 local=[::] remote=[2600:9000:2490:3600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482182 local=[::] remote=[2600:9000:2490:7000:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #7 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482182 local=[::] remote=[2600:9000:2490:7000:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482183 local=[::] remote=[2600:9000:2490:d600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #8 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482183 local=[::] remote=[2600:9000:2490:d600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482184 local=[::] remote=[2600:9000:2490:5a00:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #9 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482184 local=[::] remote=[2600:9000:2490:5a00:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482185 local=[::] remote=[2600:9000:2490:6600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #10 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482185 local=[::] remote=[2600:9000:2490:6600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482186 local=[::] remote=[2600:9000:2490:b600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #11 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482186 local=[::] remote=[2600:9000:2490:b600:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector64364 found conn482187 local=[::] remote=[2600:9000:2490:aa00:3:db06:4200:93a1]:443 HIER_DIRECT flags=1, destination #12 for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1180) handlePath:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1181) handlePath:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(1182) handlePath:        timedout = 0
2024/07/10 18:24:44.050 kid1| 17,3| FwdState.cc(610) noteDestination: conn482187 local=[::] remote=[2600:9000:2490:aa00:3:db06:4200:93a1]:443 HIER_DIRECT flags=1
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(479) resolveSelected: PeerSelector64364 found all 12 destinations for <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(480) resolveSelected:   always_direct = ALLOWED
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(481) resolveSelected:    never_direct = DUNNO
2024/07/10 18:24:44.050 kid1| 44,2| peer_select.cc(482) resolveSelected:        timedout = 0
2024/07/10 18:24:44.050 kid1| 44,3| peer_select.cc(241) ~PeerSelector: <A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.050 kid1| 20,3| store.cc(458) unlock: peerSelect unlocking key 8349000000000000D107000001000000 e:=p2IV/0x5651b365e210*4
2024/07/10 18:24:44.050 kid1| 48,3| pconn.cc(474) popStored: lookup for key {108.138.7.18:443/download.docker.com} failed.
2024/07/10 18:24:44.050 kid1| 28,3| Checklist.cc(69) preCheck: 0x7ffef6c0a460 checking fast ACLs
2024/07/10 18:24:44.050 kid1| 28,3| DomainData.cc(110) match: aclMatchDomainList: checking 'download.docker.com'
2024/07/10 18:24:44.050 kid1| 28,3| DomainData.cc(115) match: aclMatchDomainList: 'download.docker.com' NOT found
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: SKIP_PALO_DOMAINS_FAST = 0
2024/07/10 18:24:44.050 kid1| 28,3| Acl.cc(175) matches: checked: !SKIP_PALO_DOMAINS_FAST = 1
2024/07/10 18:24:44.051 kid1| 28,3| Acl.cc(175) matches: checked: (tcp_outgoing_mark 0x14 line) = 1
2024/07/10 18:24:44.051 kid1| 28,3| Acl.cc(175) matches: checked: tcp_outgoing_mark 0x14 = 1
2024/07/10 18:24:44.051 kid1| 28,3| Checklist.cc(62) markFinished: 0x7ffef6c0a460 answer ALLOWED for match
2024/07/10 18:24:44.051 kid1| 17,3| FwdState.cc(1568) GetMarkingsToServer: from 0.0.0.0 tos 0 netfilter mark 20
2024/07/10 18:24:44.051 kid1| 5,3| ConnOpener.cc(42) ConnOpener: will connect to conn482189 local=0.0.0.0 remote=108.138.7.18:443 HIER_DIRECT flags=1 with 60 timeout
2024/07/10 18:24:44.051 kid1| 50,3| comm.cc(378) comm_openex: comm_openex: Attempt open socket for: 0.0.0.0
2024/07/10 18:24:44.051 kid1| 50,3| comm.cc(420) comm_openex: comm_openex: Opened socket conn482190 local=0.0.0.0 remote=[::] FD 19 flags=1 : family=2, type=1, protocol=6
2024/07/10 18:24:44.051 kid1| 51,3| fd.cc(168) fd_open: fd_open() FD 19 download.docker.com
2024/07/10 18:24:44.051 kid1| 50,3| QosConfig.cc(581) setSockNfmark: for FD 19 to 20
2024/07/10 18:24:44.051 kid1| 5,3| ConnOpener.cc(312) createFd: conn482189 local=0.0.0.0 remote=108.138.7.18:443 HIER_DIRECT flags=1 will timeout in 60
2024/07/10 18:24:44.058 kid1| 83,2| Io.cc(161) Handshake: handshake IN: Unknown Handshake packet
2024/07/10 18:24:44.058 kid1| 83,2| Io.cc(163) Handshake: handshake OUT: CLIENT HELLO
2024/07/10 18:24:44.058 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn482189 local=X.X.X.X:36718 remote=108.138.7.18:443 HIER_DIRECT FD 19 flags=1 timeout 60
2024/07/10 18:24:44.064 kid1| 83,2| Io.cc(161) Handshake: handshake IN: Unknown Handshake packet
2024/07/10 18:24:44.064 kid1| 83,2| Io.cc(163) Handshake: handshake OUT: CLIENT HELLO
2024/07/10 18:24:44.064 kid1| 83,2| PeerConnector.cc(279) handleNegotiationResult: ERROR: Cannot establish a TLS connection to conn482189 local=X.X.X.X:36718 remote=108.138.7.18:443 HIER_DIRECT FD 19 flags=1:
    problem: failure
    detail: SQUID_TLS_ERR_CONNECT+GNUTLS_E_FATAL_ALERT_RECEIVED
2024/07/10 18:24:44.064 kid1| 5,3| comm.cc(625) commUnsetConnTimeout: Remove timeout for conn482189 local=X.X.X.X:36718 remote=108.138.7.18:443 HIER_DIRECT FD 19 flags=1
2024/07/10 18:24:44.064 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn482189 local=X.X.X.X:36718 remote=108.138.7.18:443 HIER_DIRECT FD 19 flags=1 timeout -1
2024/07/10 18:24:44.064 kid1| 5,3| comm.cc(850) _comm_close: start closing FD 19 by Connection.cc:108
2024/07/10 18:24:44.064 kid1| 5,3| comm.cc(586) commUnsetFdTimeout: Remove timeout for FD 19
2024/07/10 18:24:44.064 kid1| 83,3| Session.cc(36) tls_read_method: started for session=0x5651b404d2c0
2024/07/10 18:24:44.064 kid1| 51,3| fd.cc(93) fd_close: fd_close FD 19 server https start
2024/07/10 18:24:44.064 kid1| 17,3| FwdState.cc(471) fail: ERR_SECURE_CONNECT_FAIL &quot;Service Unavailable&quot;
	<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>
2024/07/10 18:24:44.064 kid1| 17,3| FwdState.cc(781) retryOrBail: re-forwarding (1 tries, 0 secs)


&gt;<i>-----Urspr&#252;ngliche Nachricht-----
</I>&gt;<i>Von: Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i>Gesendet: Mittwoch, 10. Juli 2024 14:50
</I>&gt;<i>An: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i>Cc: Fiehe, Christoph &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">c.fiehe at eurodata.de</A>&gt;
</I>&gt;<i>Betreff: Re: [squid-users] Rewriting HTTP to HTTPS for generic package proxy
</I>&gt;<i>
</I>&gt;<i>On 2024-07-09 18:25, Fiehe, Christoph wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I hope that somebody has an idea, what I am doing wrong.
</I>&gt;<i>
</I>&gt;<i>AFAICT from the debugging log, it is your parent proxy that returns an
</I>&gt;<i>ERR_SECURE_CONNECT_FAIL error page in response to a seemingly valid
</I>&gt;<i>&quot;HEAD <A HREF="https://...">https://...</A>&quot; request. Can you ask their admin to investigate? You
</I>&gt;<i>may also recommend that they upgrade from Squid v4 that has many known
</I>&gt;<i>security vulnerabiities.
</I>&gt;<i>
</I>&gt;<i>If parent is uncooperative, you can try to reproduce the problem by
</I>&gt;<i>temporary installing your own parent Squid instance and configuring your
</I>&gt;<i>child Squid to use that instead.
</I>&gt;<i>
</I>&gt;<i>HTH,
</I>&gt;<i>
</I>&gt;<i>Alex.
</I>&gt;<i>P.S. Unlike Amos, I do not see serious conceptual problems with
</I>&gt;<i>rewriting request target scheme (as a temporary compatibility measure).
</I>&gt;<i>It may not always work, for various reasons, but it does not necessarily
</I>&gt;<i>make things worse (and may make things better).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I try to build a generic package proxy with Squid and need the feature
</I>&gt;<i>to rewrite (not redirect) a HTTP request to a package repository
</I>&gt;<i>transparently to a HTTPS-based package source. I was able to get Jesred
</I>&gt;<i>working and defined the following rewrite rule:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> regex ^http:\/\/download\.docker\.com(.*)$ <A HREF="https://download.docker.com\1">https://download.docker.com\1</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I had to use a parent upstream proxy. In my test case the rule gets applied
</I>&gt;<i>successfully:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1720558404.106 10.2.59.102/molecule-ubuntu-jammy.lx.mycompany.de
</I>&gt;<i><A HREF="http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l">http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l</A>
</I>&gt;<i>inux/ubuntu/dists/jammy/InRelease]
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A> 2
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have validated that the returned URL is correct and that the resource is accessible
</I>&gt;<i>via my upstream proxy.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But at the very end, the client receives a 503 error code. I have set &quot;debug_options
</I>&gt;<i>ALL,3&quot; and this gives the log:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [...]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 11,2| client_side.cc(1333) parseHttpRequest: HTTP Client
</I>&gt;<i>REQUEST:
</I>&gt;&gt;<i> ---------
</I>&gt;&gt;<i> HEAD
</I>&gt;<i><A HREF="http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l">http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l</A>
</I>&gt;<i>inux/ubuntu/dists/jammy/InRelease] HTTP/1.1
</I>&gt;&gt;<i> Host: download.docker.com
</I>&gt;&gt;<i> User-Agent: curl/7.81.0
</I>&gt;&gt;<i> Accept: */*
</I>&gt;&gt;<i> Proxy-Connection: Keep-Alive
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 33,3| client_side.cc(1364) parseHttpRequest: complete
</I>&gt;<i>request received. prefix_sz = 174, request-line-size=77, mime-header-size=97, mime header
</I>&gt;<i>block:
</I>&gt;&gt;<i> Host: download.docker.com
</I>&gt;&gt;<i> User-Agent: curl/7.81.0
</I>&gt;&gt;<i> Accept: */*
</I>&gt;&gt;<i> Proxy-Connection: Keep-Alive
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 87,3| clientStream.cc(139) clientStreamInsertHead:
</I>&gt;<i>clientStreamInsertHead: Inserted node 0x5c3ba4154308 with data 0x5c3ba4152950 after head
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn9
</I>&gt;<i>local=10.2.59.103:8000 remote=10.2.59.102:56466 FD 15 flags=1 timeout 86400
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 33,3| client_side.cc(1767) add: 0x5c3ba41518e0*3 to 0/0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 33,3| Pipeline.cc(24) add: Pipeline 0x5c3ba41501f0 add
</I>&gt;<i>request 1 0x5c3ba41518e0*4
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 23,3| Uri.cc(446) parse: Split URL
</I>&gt;<i>'<A HREF="http://download.docker.com/linux/ubuntu/dists/jammy/InRelease">http://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="http://download.docker.com">http://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease'] into proto='http', host='download.docker.com',
</I>&gt;<i>port='80', path='/linux/ubuntu/dists/jammy/InRelease'
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP
</I>&gt;<i>'download.docker.com': Name or service not known
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 33,3| client_side.cc(702) clientSetKeepaliveFlag: http_ver
</I>&gt;<i>= HTTP/1.1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 33,3| client_side.cc(703) clientSetKeepaliveFlag: method =
</I>&gt;<i>HEAD
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 85,3| client_side_request.cc(122) ClientRequestContext:
</I>&gt;<i>ClientRequestContext constructed, this=0x5c3ba4154e78
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 83,3| client_side_request.cc(1708) doCallouts: Doing
</I>&gt;<i>calloutContext-&gt;hostHeaderVerify()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 85,3| client_side_request.cc(606) hostHeaderVerify:
</I>&gt;<i>validate host=download.docker.com, port=0, portStr=NULL
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 85,3| client_side_request.cc(620) hostHeaderVerify:
</I>&gt;<i>validate skipped.
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 83,3| client_side_request.cc(1715) doCallouts: Doing
</I>&gt;<i>calloutContext-&gt;clientAccessCheck()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Checklist.cc(69) preCheck: 0x5c3ba41552d8 checking
</I>&gt;<i>slow rules
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.102:56466'
</I>&gt;<i>found
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Acl.cc(175) matches: checked: http_access#1 = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Acl.cc(175) matches: checked: http_access = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Checklist.cc(62) markFinished: 0x5c3ba41552d8 answer
</I>&gt;<i>ALLOWED for match
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 28,3| Checklist.cc(162) checkCallback:
</I>&gt;<i>ACLChecklist::checkCallback: 0x5c3ba41552d8 answer=ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 85,2| client_side_request.cc(714) clientAccessCheckDone:
</I>&gt;<i>The request HEAD
</I>&gt;<i><A HREF="http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l">http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l</A>
</I>&gt;<i>inux/ubuntu/dists/jammy/InRelease] is ALLOWED; last ACL checked: all
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 83,3| AccessCheck.cc(42) Start: adaptation off, skipping
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 83,3| client_side_request.cc(1735) doCallouts: Doing
</I>&gt;<i>calloutContext-&gt;clientRedirectStart()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 78,3| dns_internal.cc(1836) idnsPTRLookup: idnsPTRLookup:
</I>&gt;<i>buf is 42 bytes for 10.2.59.102, id = 0x8d95
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 50,3| comm.cc(927) comm_udp_sendto: comm_udp_sendto:
</I>&gt;<i>Attempt to send UDP packet to 127.0.0.53:53 using FD 11 using Port 54280
</I>&gt;&gt;<i> 2024/07/09 23:35:40 kid1| Starting new redirector helpers...
</I>&gt;&gt;<i> current master transaction: master54
</I>&gt;&gt;<i> 2024/07/09 23:35:40 kid1| helperOpenServers: Starting 1/3 'jesred' processes
</I>&gt;&gt;<i> current master transaction: master54
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 51,3| fd.cc(168) fd_open: fd_open() FD 17 IPC UNIX STREAM
</I>&gt;<i>Parent
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 51,3| fd.cc(168) fd_open: fd_open() FD 19 IPC UNIX STREAM
</I>&gt;<i>Parent
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 54,3| ipc.cc(212) ipcCreate: ipcCreate: prfd FD 17
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 54,3| ipc.cc(213) ipcCreate: ipcCreate: pwfd FD 17
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 54,3| ipc.cc(214) ipcCreate: ipcCreate: crfd FD 19
</I>&gt;&gt;<i> 2024/07/09 23:35:40.115 kid1| 54,3| ipc.cc(215) ipcCreate: ipcCreate: cwfd FD 19
</I>&gt;&gt;<i> 2024/07/09 23:35:40.116 kid1| 5,3| comm.cc(850) _comm_close: start closing FD 19 by
</I>&gt;<i>ipc.cc:271
</I>&gt;&gt;<i> 2024/07/09 23:35:40.116 kid1| 5,3| comm.cc(586) commUnsetFdTimeout: Remove timeout for
</I>&gt;<i>FD 19
</I>&gt;&gt;<i> 2024/07/09 23:35:40.116 kid1| 21,3| tools.cc(561) leave_suid: leave_suid: PID 503746
</I>&gt;<i>called
</I>&gt;&gt;<i> 2024/07/09 23:35:40.116 kid1| 21,3| tools.cc(651) no_suid: no_suid: PID 503746 giving up
</I>&gt;<i>root privileges forever
</I>&gt;&gt;<i> 2024/07/09 23:35:40.116 kid1| 5,3| comm.cc(586) commUnsetFdTimeout: Remove timeout for
</I>&gt;<i>FD 17
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 84,3| helper.cc(1310) GetFirstAvailable:
</I>&gt;<i>GetFirstAvailable: Least-loaded helper is fully loaded!
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 51,3| fd.cc(93) fd_close: fd_close FD 19 IPC UNIX STREAM
</I>&gt;<i>Parent
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 78,3| dns_internal.cc(1319) idnsRead: idnsRead: starting
</I>&gt;<i>with FD 11
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 78,3| dns_internal.cc(1365) idnsRead: idnsRead: FD 11:
</I>&gt;<i>received 92 bytes from 127.0.0.53:53
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 78,3| dns_internal.cc(1172) idnsGrokReply: idnsGrokReply:
</I>&gt;<i>QID 0x8d95, 1 answers
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 35,3| fqdncache.cc(336) fqdncacheParse: fqdncacheParse: 1
</I>&gt;<i>answers for '10.2.59.102'
</I>&gt;&gt;<i> 2024/07/09 23:35:40.117 kid1| 5,3| IoCallback.cc(112) finish: called for conn11
</I>&gt;<i>local=[::] remote=[::] FD 17 flags=1 (0, 0)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 5,3| Read.cc(148) HandleRead: FD 17, size 32767, retval
</I>&gt;<i>80, errno 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 5,3| IoCallback.cc(112) finish: called for conn10
</I>&gt;<i>local=[::] remote=[::] FD 17 flags=1 (0, 0)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 84,3| helper.cc(1022) helperHandleRead: helperHandleRead:
</I>&gt;<i>end of reply found
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 84,3| Reply.cc(41) finalize: Parsing helper buffer
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 84,3| Reply.cc(59) finalize: Buff length is larger than 2
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 84,3| Reply.cc(63) finalize: helper Result = OK
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 23,3| Uri.cc(446) parse: Split URL
</I>&gt;<i>'<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.c">https://download.docker.c</A>
</I>&gt;<i>om/linux/ubuntu/dists/jammy/InRelease'] into proto='https', host='download.docker.com',
</I>&gt;<i>port='443', path='/linux/ubuntu/dists/jammy/InRelease'
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP
</I>&gt;<i>'download.docker.com': Name or service not known
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 61,2| client_side_request.cc(1235) clientRedirectDone:
</I>&gt;<i>URL-rewriter diverts URL from
</I>&gt;<i><A HREF="http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l">http://download.docker.com/linux/ubuntu/dists/jammy/InRelease[http://download.docker.com/l</A>
</I>&gt;<i>inux/ubuntu/dists/jammy/InRelease] to
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 83,3| client_side_request.cc(1743) doCallouts: Doing
</I>&gt;<i>calloutContext-&gt;clientAccessCheck2()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 85,2| client_side_request.cc(692) clientAccessCheck2: No
</I>&gt;<i>adapted_http_access configuration. default: ALLOW
</I>&gt;&gt;<i> 2024/07/09 23:35:40.125 kid1| 85,2| client_side_request.cc(714) clientAccessCheckDone:
</I>&gt;<i>The request HEAD
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease] is ALLOWED; last ACL checked: all
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 83,3| client_side_request.cc(1761) doCallouts: Doing
</I>&gt;<i>clientInterpretRequestHeaders()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 83,3| client_side_request.cc(1770) doCallouts: Doing
</I>&gt;<i>calloutContext-&gt;checkNoCache()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(69) preCheck: 0x5c3ba41552d8 checking
</I>&gt;<i>slow rules
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| RegexData.cc(50) match: checking
</I>&gt;<i>'<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.c">https://download.docker.c</A>
</I>&gt;<i>om/linux/ubuntu/dists/jammy/InRelease']
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: no_cache = 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: cache#1 = 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.102:56466'
</I>&gt;<i>found
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: cache#2 = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: cache = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(62) markFinished: 0x5c3ba41552d8 answer
</I>&gt;<i>ALLOWED for match
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(162) checkCallback:
</I>&gt;<i>ACLChecklist::checkCallback: 0x5c3ba41552d8 answer=ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 85,3| client_side_request.cc(116) ~ClientRequestContext:
</I>&gt;<i>ClientRequestContext destructed, this=0x5c3ba4154e78
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 83,3| client_side_request.cc(1855) doCallouts: calling
</I>&gt;<i>processRequest()
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 87,3| clientStream.cc(178) clientStreamRead:
</I>&gt;<i>clientStreamRead: Calling 1 with cbdata 0x5c3ba4153e70 from node 0x5c3ba4154308
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 73,3| HttpRequest.cc(742) storeId: sent back
</I>&gt;<i>effectiveRequestUrl:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| Controller.cc(429) peek:
</I>&gt;<i>DE850794EBC405A27A7718F51795E32A
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 73,3| HttpRequest.cc(742) storeId: sent back
</I>&gt;<i>effectiveRequestUrl:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| Controller.cc(429) peek:
</I>&gt;<i>D3522EE27FB0ED7004DD594AF7674667
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 85,3| client_side_reply.cc(1523) identifyFoundObject:
</I>&gt;<i>StoreEntry is NULL - MISS
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(730) storeCreatePureEntry:
</I>&gt;<i>storeCreateEntry:
</I>&gt;<i>'<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.c">https://download.docker.c</A>
</I>&gt;<i>om/linux/ubuntu/dists/jammy/InRelease']
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| MemObject.cc(99) MemObject: MemObject constructed,
</I>&gt;<i>this=0x5c3ba416ef10
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 88,3| MemObject.cc(82) setUris: 0x5c3ba416ef10 storeId:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(434) lock: storeCreateEntry locked key
</I>&gt;<i>[null_store_key] e:=V/0x5c3ba416ee90*1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(536) setPrivateKey: 00
</I>&gt;<i>e:=V/0x5c3ba416ee90*1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(412) hashInsert: StoreEntry::hashInsert:
</I>&gt;<i>Inserting Entry e:=IV/0x5c3ba416ee90*1 key '020000000000000061AF070001000000'
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(434) lock: store_client locked key
</I>&gt;<i>020000000000000061AF070001000000 e:=IV/0x5c3ba416ee90*2
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 90,3| store_client.cc(243) copy: store_client::copy:
</I>&gt;<i>020000000000000061AF070001000000, from 0, for length 4096, cb 1, cbdata 0x5c3ba4152dd8
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(434) lock: store_client::copy locked key
</I>&gt;<i>020000000000000061AF070001000000 e:=IV/0x5c3ba416ee90*3
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 90,3| store_client.cc(343) storeClientCopy2:
</I>&gt;<i>storeClientCopy2: 020000000000000061AF070001000000
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 90,3| store_client.cc(390) doCopy: store_client::doCopy:
</I>&gt;<i>Waiting for more
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(457) unlock: store_client::copy unlocking
</I>&gt;<i>key 020000000000000061AF070001000000 e:=IV/0x5c3ba416ee90*3
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,3| FwdState.cc(373) Start:
</I>&gt;<i>'<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.c">https://download.docker.c</A>
</I>&gt;<i>om/linux/ubuntu/dists/jammy/InRelease']
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,2| FwdState.cc(133) FwdState: Forwarding client request
</I>&gt;<i>conn9 local=10.2.59.103:8000 remote=10.2.59.102:56466 FD 15 flags=1,
</I>&gt;<i>url=<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker</A>
</I>&gt;<i>.com/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(434) lock: FwdState locked key
</I>&gt;<i>020000000000000061AF070001000000 e:=IV/0x5c3ba416ee90*3
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,3| FwdState.cc(140) FwdState: FwdState constructed,
</I>&gt;<i>this=0x5c3ba416fa18
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(309) peerSelect:
</I>&gt;<i>e:=IV/0x5c3ba416ee90*3
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(434) lock: peerSelect locked key
</I>&gt;<i>020000000000000061AF070001000000 e:=IV/0x5c3ba416ee90*4
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(612) selectMore: HEAD
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(626) selectMore: direct =
</I>&gt;<i>DIRECT_UNKNOWN (never_direct to be checked)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(69) preCheck: 0x5c3ba4170638 checking
</I>&gt;<i>slow rules
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Ip.cc(538) match: aclIpMatchIp: '10.2.59.102:56466'
</I>&gt;<i>found
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: all = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: never_direct#1 = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Acl.cc(175) matches: checked: never_direct = 1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(62) markFinished: 0x5c3ba4170638 answer
</I>&gt;<i>ALLOWED for match
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 28,3| Checklist.cc(162) checkCallback:
</I>&gt;<i>ACLChecklist::checkCallback: 0x5c3ba4170638 answer=ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(345) checkNeverDirectDone: ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(351) checkNeverDirectDone: direct =
</I>&gt;<i>DIRECT_NO (never_direct allow)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(612) selectMore: HEAD
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 14,3| ipcache.cc(732) ipcache_gethostbyname:
</I>&gt;<i>ipcache_gethostbyname: 'download.docker.com', flags=0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP
</I>&gt;<i>'download.docker.com': Name or service not known
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(286) peerSelectIcpPing:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 15,3| neighbors.cc(283) neighborsCount: neighborsCount: 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(297) peerSelectIcpPing: counted 0
</I>&gt;<i>neighbors
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(833) selectSomeParent: HEAD
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 15,3| neighbors.cc(350) getRoundRobinParent: returning
</I>&gt;<i>[nil]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 15,3| neighbors.cc(403) getWeightedRoundRobinParent:
</I>&gt;<i>returning [nil]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 15,3| neighbors.cc(309) getFirstUpParent: returning
</I>&gt;<i>212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(1102) addSelection: adding
</I>&gt;<i>FIRSTUP_PARENT/212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(1095) addSelection: skipping
</I>&gt;<i>ANY_OLD_PARENT/212.89.128.96; have FIRSTUP_PARENT/212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 15,3| neighbors.cc(493) getDefaultParent: returning
</I>&gt;<i>212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(1095) addSelection: skipping
</I>&gt;<i>DEFAULT_PARENT/212.89.128.96; have FIRSTUP_PARENT/212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(460) resolveSelected: Find IP
</I>&gt;<i>destination for:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.co">https://download.docker.co</A>
</I>&gt;<i>m/linux/ubuntu/dists/jammy/InRelease'] via 212.89.128.96
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(1174) handlePath: PeerSelector1 found
</I>&gt;<i>conn12 local=0.0.0.0 remote=212.89.128.96:3128 FIRSTUP_PARENT flags=1, destination #1 for
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(1180) handlePath: always_direct =
</I>&gt;<i>DENIED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(1181) handlePath: never_direct =
</I>&gt;<i>ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(1182) handlePath: timedout = 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,3| FwdState.cc(610) noteDestination: conn12
</I>&gt;<i>local=0.0.0.0 remote=212.89.128.96:3128 FIRSTUP_PARENT flags=1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,3| FwdState.cc(1124) connectStart: 1+ paths to
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(479) resolveSelected: PeerSelector1
</I>&gt;<i>found all 1 destinations for
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(480) resolveSelected: always_direct =
</I>&gt;<i>DENIED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(481) resolveSelected: never_direct =
</I>&gt;<i>ALLOWED
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,2| peer_select.cc(482) resolveSelected: timedout = 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 44,3| peer_select.cc(241) ~PeerSelector:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 20,3| store.cc(457) unlock: peerSelect unlocking key
</I>&gt;<i>020000000000000061AF070001000000 e:=p2IV/0x5c3ba416ee90*4
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 48,3| pconn.cc(474) popStored: lookup for key
</I>&gt;<i>{212.89.128.96:3128} failed.
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 17,3| FwdState.cc(1568) GetMarkingsToServer: from 0.0.0.0
</I>&gt;<i>tos 0 netfilter mark 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 5,3| ConnOpener.cc(42) ConnOpener: will connect to conn14
</I>&gt;<i>local=0.0.0.0 remote=212.89.128.96:3128 FIRSTUP_PARENT flags=1 with 30 timeout
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 50,3| comm.cc(378) comm_openex: comm_openex: Attempt open
</I>&gt;<i>socket for: 0.0.0.0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 50,3| comm.cc(420) comm_openex: comm_openex: Opened socket
</I>&gt;<i>conn15 local=0.0.0.0 remote=[::] FD 19 flags=1 : family=2, type=1, protocol=6
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 51,3| fd.cc(168) fd_open: fd_open() FD 19
</I>&gt;&gt;<i> 2024/07/09 23:35:40.126 kid1| 5,3| ConnOpener.cc(312) createFd: conn14 local=0.0.0.0
</I>&gt;<i>remote=212.89.128.96:3128 FIRSTUP_PARENT flags=1 will timeout in 30
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 17,3| FwdState.cc(1197) dispatch: conn9
</I>&gt;<i>local=10.2.59.103:8000 remote=10.2.59.102:56466 FD 15 flags=1: Fetching HEAD
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 14,3| Address.cc(389) lookupHostIP: Given Non-IP
</I>&gt;<i>'download.docker.com': Name or service not known
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 78,3| dns_internal.cc(1793) idnsALookup: idnsALookup: buf
</I>&gt;<i>is 37 bytes for download.docker.com, id = 0xe779
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 50,3| comm.cc(927) comm_udp_sendto: comm_udp_sendto:
</I>&gt;<i>Attempt to send UDP packet to 127.0.0.53:53 using FD 11 using Port 54280
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 78,3| dns_internal.cc(1729) idnsSendSlaveAAAAQuery: buf is
</I>&gt;<i>37 bytes for download.docker.com, id = 0x8aee
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 50,3| comm.cc(927) comm_udp_sendto: comm_udp_sendto:
</I>&gt;<i>Attempt to send UDP packet to 127.0.0.53:53 using FD 11 using Port 54280
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 11,3| http.cc(2516) httpStart: HEAD
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 20,3| store.cc(434) lock: Client locked key
</I>&gt;<i>020000000000000061AF070001000000 e:=p2IV/0x5c3ba416ee90*4
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1 timeout
</I>&gt;<i>86400
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 22,3| refresh.cc(636) getMaxAge: getMaxAge:
</I>&gt;<i>'<A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease</A>'[<A HREF="https://download.docker.c">https://download.docker.c</A>
</I>&gt;<i>om/linux/ubuntu/dists/jammy/InRelease']
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 11,2| http.cc(2472) sendRequest: HTTP Server conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 11,2| http.cc(2473) sendRequest: HTTP Server REQUEST:
</I>&gt;&gt;<i> ---------
</I>&gt;&gt;<i> HEAD
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease] HTTP/1.1
</I>&gt;&gt;<i> Host: download.docker.com
</I>&gt;&gt;<i> User-Agent: curl/7.81.0
</I>&gt;&gt;<i> Accept: */*
</I>&gt;&gt;<i> Via: 1.1 pkg-proxy (squid/6.6)
</I>&gt;&gt;<i> X-Forwarded-For: 10.2.59.102
</I>&gt;&gt;<i> Cache-Control: max-age=0
</I>&gt;&gt;<i> Connection: keep-alive
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 5,3| IoCallback.cc(112) finish: called for conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1 (0, 0)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.127 kid1| 5,3| comm.cc(599) commSetConnTimeout: conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1 timeout 900
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1319) idnsRead: idnsRead: starting
</I>&gt;<i>with FD 11
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1365) idnsRead: idnsRead: FD 11:
</I>&gt;<i>received 304 bytes from 127.0.0.53:53
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1172) idnsGrokReply: idnsGrokReply:
</I>&gt;<i>QID 0x8aee, 9 answers
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(480) ipcacheParse: 9 answers for
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #1
</I>&gt;<i>[2600:9000:2490:6c00:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #2
</I>&gt;<i>[2600:9000:2490:a600:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #3
</I>&gt;<i>[2600:9000:2490:9c00:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #4
</I>&gt;<i>[2600:9000:2490:6000:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #5
</I>&gt;<i>[2600:9000:2490:c00:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #6
</I>&gt;<i>[2600:9000:2490:5200:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #7
</I>&gt;<i>[2600:9000:2490:9a00:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #8
</I>&gt;<i>[2600:9000:2490:2c00:3:db06:4200:93a1]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1319) idnsRead: idnsRead: starting
</I>&gt;<i>with FD 11
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1365) idnsRead: idnsRead: FD 11:
</I>&gt;<i>received 144 bytes from 127.0.0.53:53
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 78,3| dns_internal.cc(1172) idnsGrokReply: idnsGrokReply:
</I>&gt;<i>QID 0xe779, 5 answers
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(480) ipcacheParse: 5 answers for
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #9
</I>&gt;<i>108.138.7.33
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #10
</I>&gt;<i>108.138.7.18
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #11
</I>&gt;<i>108.138.7.88
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(535) addGood: download.docker.com #12
</I>&gt;<i>108.138.7.48
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 14,3| ipcache.cc(586) ipcacheHandleReply: done with
</I>&gt;<i>download.docker.com: [2600:9000:2490:6c00:3:db06:4200:93a1] #1/12-0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 38,3| net_db.cc(337) netdbSendPing: netdbSendPing: pinging
</I>&gt;<i>download.docker.com
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 kid1| 37,2| IcmpSquid.cc(88) SendEcho: to
</I>&gt;<i>[2600:9000:2490:6c00:3:db06:4200:93a1], opcode 3, len 19
</I>&gt;&gt;<i> 2024/07/09 23:35:40.137 pinger| 42,2| IcmpPinger.cc(198) Recv: Pass
</I>&gt;<i>[2600:9000:2490:6c00:3:db06:4200:93a1] off to ICMPv6 module.
</I>&gt;&gt;<i> 2024/07/09 23:35:40 pinger| SendEcho ERROR: sending to ICMPv6 packet to
</I>&gt;<i>[2600:9000:2490:6c00:3:db06:4200:93a1]: (101) Network is unreachable
</I>&gt;&gt;<i> 2024/07/09 23:35:40.138 pinger| 42,2| Icmp.cc(90) Log: pingerLog: 1720560940.138021
</I>&gt;<i>[2600:9000:2490:6c00:3:db06:4200:93a1] 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.323 kid1| 5,3| IoCallback.cc(112) finish: called for conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1 (0, 0)
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 5,3| Read.cc(93) ReadNow: conn14 local=10.2.59.103:39370
</I>&gt;<i>remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1, size 65536, retval 348, errno 0
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 11,3| http.cc(649) processReplyHeader: processReplyHeader:
</I>&gt;<i>key '020000000000000061AF070001000000'
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 11,2| http.cc(696) processReplyHeader: HTTP Server conn14
</I>&gt;<i>local=10.2.59.103:39370 remote=212.89.128.96:3128 FIRSTUP_PARENT FD 19 flags=1
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 11,2| http.cc(697) processReplyHeader: HTTP Server
</I>&gt;<i>RESPONSE:
</I>&gt;&gt;<i> ---------
</I>&gt;&gt;<i> HTTP/1.1 503 Service Unavailable
</I>&gt;&gt;<i> Server: squid/4.10
</I>&gt;&gt;<i> Mime-Version: 1.0
</I>&gt;&gt;<i> Date: Tue, 09 Jul 2024 21:35:40 GMT
</I>&gt;&gt;<i> Content-Type: text/html;charset=utf-8
</I>&gt;&gt;<i> Content-Length: 3879
</I>&gt;&gt;<i> X-Squid-Error: ERR_SECURE_CONNECT_FAIL 71
</I>&gt;&gt;<i> X-Cache: MISS from proxy-srv2
</I>&gt;&gt;<i> X-Cache-Lookup: MISS from proxy-srv2:3128
</I>&gt;&gt;<i> Via: 1.1 proxy-srv2 (squid/4.10)
</I>&gt;&gt;<i> Connection: keep-alive
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 83,3| AccessCheck.cc(42) Start: adaptation off, skipping
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 20,3| store.cc(1693) replaceHttpReply:
</I>&gt;<i>StoreEntry::replaceHttpReply:
</I>&gt;<i><A HREF="https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com">https://download.docker.com/linux/ubuntu/dists/jammy/InRelease[https://download.docker.com</A>
</I>&gt;<i>/linux/ubuntu/dists/jammy/InRelease]
</I>&gt;&gt;<i> 2024/07/09 23:35:40.324 kid1| 11,3| http.cc(949) haveParsedReplyHeaders: HTTP CODE: 503
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Has anybody an idea what I can do to solve the issue?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is my configuration borrowed from squid-deb-proxy:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # this file contains private networks (10.0.0.0/8, 172.16.0.0/12,
</I>&gt;&gt;<i> # 192.168.0.0/16) by default, you can add/remove additional allowed
</I>&gt;&gt;<i> # source networks in it to customize it for your setup
</I>&gt;&gt;<i> acl src_networks src &quot;/etc/squid/acl/src-networks.acl&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # this file contains the archive mirrors by default,
</I>&gt;&gt;<i> # if you use a different mirror, add it there
</I>&gt;&gt;<i> acl to_archive_mirrors dstdomain &quot;/etc/squid/acl/archive-mirrors.acl&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Disable Cache for defined domains
</I>&gt;&gt;<i> acl no_cache url_regex &quot;/etc/squid/acl/no-cache.acl&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # this contains the package blacklist
</I>&gt;&gt;<i> acl blockedpkgs urlpath_regex &quot;/etc/squid/pkg-blacklist-regexp.acl&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # default to a different port than stock squid
</I>&gt;&gt;<i> http_port 8000
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # -------------------------------------------------
</I>&gt;&gt;<i> # settings below probably do not need customization
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # user visible name
</I>&gt;&gt;<i> visible_hostname pkg-proxy
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # we need a big cache, some debs are huge
</I>&gt;&gt;<i> maximum_object_size 512 MB
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # use a different dir than stock squid and default to 40G
</I>&gt;&gt;<i> cache_dir aufs /var/cache/squid 40000 16 256
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cache_peer 212.89.128.96 parent 3128 0 no-query default
</I>&gt;&gt;<i> never_direct allow all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # use different logs
</I>&gt;&gt;<i> cache_access_log /var/log/squid/access.log
</I>&gt;&gt;<i> cache_log /var/log/squid/cache.log
</I>&gt;&gt;<i> cache_store_log /var/log/squid/store.log
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # tweaks to speed things up
</I>&gt;&gt;<i> cache_mem 200 MB
</I>&gt;&gt;<i> maximum_object_size_in_memory 10240 KB
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # pid
</I>&gt;&gt;<i> pid_filename /var/run/squid.pid
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # refresh pattern for debs and udebs
</I>&gt;&gt;<i> refresh_pattern deb$ 129600 100% 129600
</I>&gt;&gt;<i> refresh_pattern udeb$ 129600 100% 129600
</I>&gt;&gt;<i> refresh_pattern tar.gz$ 129600 100% 129600
</I>&gt;&gt;<i> refresh_pattern tar.xz$ 129600 100% 129600
</I>&gt;&gt;<i> refresh_pattern tar.bz2$ 129600 100% 129600
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # always refresh Packages and Release files
</I>&gt;&gt;<i> refresh_pattern \/(Packages|Sources)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims
</I>&gt;&gt;<i> refresh_pattern \/Release(|\.gpg)$ 0 0% 0 refresh-ims
</I>&gt;&gt;<i> refresh_pattern \/InRelease$ 0 0% 0 refresh-ims
</I>&gt;&gt;<i> refresh_pattern \/(Translation-.*)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # handle meta-release and changelogs.ubuntu.com special
</I>&gt;&gt;<i> # (fine to have this on debian too)
</I>&gt;&gt;<i> refresh_pattern changelogs.ubuntu.com\/.* 0 1% 1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # only allow connects to ports for http, https
</I>&gt;&gt;<i> acl SSL_ports port 443 563
</I>&gt;&gt;<i> acl Safe_ports port 80
</I>&gt;&gt;<i> acl Safe_ports port 443 563
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # only allow ports we trust
</I>&gt;&gt;<i> http_access deny !Safe_ports
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # do not allow to download from the pkg blacklist
</I>&gt;&gt;<i> http_access deny blockedpkgs
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # allow access only to official archive mirrors
</I>&gt;&gt;<i> # uncomment the third and fouth line to permit any unlisted domain
</I>&gt;&gt;<i> http_access deny !to_archive_mirrors
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # allow access from our network and localhost
</I>&gt;&gt;<i> http_access allow src_networks
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # And finally deny all other access to this proxy
</I>&gt;&gt;<i> http_access deny all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # don't cache domains not listed in the mirrors file
</I>&gt;&gt;<i> # uncomment the third and fourth line to cache any unlisted domains
</I>&gt;&gt;<i> cache deny no_cache
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # And finally cache everything else
</I>&gt;&gt;<i> cache allow all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> url_rewrite_children 3 startup=0 idle=1 concurrency=1
</I>&gt;&gt;<i> url_rewrite_program /usr/lib/squid/jesred
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> debug_options ALL,3
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks a lot.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i> Christoph
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026854.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
	<LI>Next message (by thread): <A HREF="026860.html">[squid-users] Rewriting HTTP to HTTPS for generic package proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26859">[ date ]</a>
              <a href="thread.html#26859">[ thread ]</a>
              <a href="subject.html#26859">[ subject ]</a>
              <a href="author.html#26859">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
