<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] TCP_MISS_ABORTED/502
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS_ABORTED/502&In-Reply-To=%3C3790aa46-a25c-4030-a5b7-0732824bee3f%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026931.html">
   <LINK REL="Next"  HREF="026940.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] TCP_MISS_ABORTED/502</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20TCP_MISS_ABORTED/502&In-Reply-To=%3C3790aa46-a25c-4030-a5b7-0732824bee3f%40measurement-factory.com%3E"
       TITLE="[squid-users] TCP_MISS_ABORTED/502">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Jul 15 18:38:41 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026931.html">[squid-users] TCP_MISS_ABORTED/502
</A></li>
        <LI>Next message (by thread): <A HREF="026940.html">[squid-users] TCP_MISS_ABORTED/502
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26937">[ date ]</a>
              <a href="thread.html#26937">[ thread ]</a>
              <a href="subject.html#26937">[ subject ]</a>
              <a href="author.html#26937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-07-13 16:02, Ben Toms wrote:

&gt;<i> with debug_options ALL,4 set.. the cache.log shows:
</I>
&gt;<i> 2024/07/13 18:55:03.595 kid1| 5,3| Read.cc(93) ReadNow: conn17 
</I>&gt;<i> local=squid.cache.ip:37046 remote=origin.server.ip:443 FIRSTUP_PARENT FD 
</I>&gt;<i> 14 flags=1, size 65536, retval -28, errno 0
</I>
&gt;<i> 2024/07/13 18:55:03.595 kid1| 17,3| FwdState.cc(471) fail: 
</I>&gt;<i> ERR_READ_ERROR &quot;Bad Gateway&quot;
</I>

&gt;<i> Still need to dig in more.. but the true error seems to be: 
</I>&gt;<i> ERR_READ_ERROR &quot;Bad Gateway&quot;
</I>
AFAICT, the underlying error happens a bit earlier (probably at TLS 
layer), just before the &quot;retval -28&quot; line above. Official high-level 
Squid code that produced the above log lines does not detail those TLS 
errors. I do not know what went wrong between Squid and Apache.

Going forward, I see four options:

A) Examine origin logs. It is likely that Apache logs what is going 
wrong with that TLS session from httpd point of view.

B) (Privately) examine Squid ALL,9 logs. Squid OpenSSL integration code 
might log something relevant to this context.

C) Examine Squid-origin packet capture. If you supply TLS master keys to 
Wireshark or a similar tool, you may be able to see a relevant TLS alert 
in that TLS stream.

D) Find somebody to patch Squid source code to add more debugging info 
if (B) did not produce enough new/usable hints.


HTH,

Alex.

&gt;<i> *From: *Ben Toms &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;
</I>&gt;<i> *Date: *Saturday, 13 July 2024 at 13:04
</I>&gt;<i> *To: *Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i> *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;<i> 
</I>&gt;<i> Well.. tried with cache-control headers added to the apache servers 
</I>&gt;<i> responses.. and still no luck (header response below).
</I>&gt;<i> 
</I>&gt;<i> Date: Sat, 13 Jul 2024 12:00:02 GMT
</I>&gt;<i> 
</I>&gt;<i> Server: Apache
</I>&gt;<i> 
</I>&gt;<i> Last-Modified: Thu, 20 Jun 2024 13:57:21 GMT
</I>&gt;<i> 
</I>&gt;<i> ETag: &quot;152c-61b52b19bbd2a&quot;
</I>&gt;<i> 
</I>&gt;<i> Accept-Ranges: bytes
</I>&gt;<i> 
</I>&gt;<i> Content-Length: 5420
</I>&gt;<i> 
</I>&gt;<i> Cache-Control: max-age=84600, public
</I>&gt;<i> 
</I>&gt;<i> Connection: close
</I>&gt;<i> 
</I>&gt;<i> I&#8217;ve tried a few other sites and the issue seems to be when attempting 
</I>&gt;<i> to cache an item which requires authentication. Which is bizarre, as the 
</I>&gt;<i> apache server is showing files are being downloaded.. yet squid-cache is 
</I>&gt;<i> still erroring with TCP_MISS_ABORTED/502.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Ben.
</I>&gt;<i> 
</I>&gt;<i> *From: *Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;
</I>&gt;<i> *Date: *Friday, 12 July 2024 at 22:54
</I>&gt;<i> *To: *Ben Toms &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;
</I>&gt;<i> *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;<i> 
</I>&gt;<i> On 2024-07-12 14:31, Ben Toms wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> So this squid cache is the parent (which might speak to me 
</I>&gt;&gt;<i> misconfiguring squid).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It&#8217;s setup as an accelerator for the public server.
</I>&gt;<i> 
</I>&gt;<i> Ah, I see. Sorry I forgot or misinterpreted that part. Too many balls in
</I>&gt;<i> the air.
</I>&gt;<i> 
</I>&gt;<i> Right now, it sounds like origin sent 200 OK, but Squid could not even
</I>&gt;<i> parse that response header, which is rather unusual/rare. However, that
</I>&gt;<i> theory is based on your interpretation of ALL,2 logs, so there may be
</I>&gt;<i> more to the story here.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> When I curl the public server direct, there are no cache control headers.
</I>&gt;<i> 
</I>&gt;<i> Understood. I suspect Squid will not cache such authenticated responses
</I>&gt;<i> by default (even after Squid starts to receive them), but I have not
</I>&gt;<i> checked all the relevant details.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> 
</I>&gt;<i> Alex.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> On Fri, 12 Jul 2024 at 19:15, Alex Rousskov&#160; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; On 2024-07-12 13:38, Ben Toms wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt; Where would I find those headers?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; If you have access to the parent Squid proxy, they will be in its
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; debugging cache.log. You can also get them by capturing network packets
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; between the parent Squid and origin, but for HTTPS traffic that
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; requires
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; giving Wireshark the associated master keys, which may be possible with
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; Squid v6, but not trivial (see tls_key_log in Squid; Apache may have
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; better support for this). Finally, one can configure Apache to log them
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; (sorry, I do not remember the details).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; Again, the child Squid does not see these headers yet (AFAICT), so they
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; are not the reason things do not currently &quot;work&quot; in your tests.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt; Looking at the origin servers apache logs.. it&#8217;s sending a 200
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; response.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; I am aware. We need the headers that go with that 200 OK response. For
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; example, if it has Cache-Control:public, then Squid may be able to
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; cache
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; it despite authentication.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; HTH,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; Alex.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt; On Fri, 12 Jul 2024 at 18:26, Alex Rousskov wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;On 2024-07-12 13:03, Ben Toms wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; So the issue seems to be caching content that requires
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; authentication
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;The client is getting an error response from Squid. That error is
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;probably not related to caching decisions. I do not recommend
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; focusing
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;on caching at this stage of triage. I recommend addressing that
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;error first.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; The question here is, can squid cache items that require
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;authentication
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; to access?
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;Yes, in some cases. To know whether your case qualifies, I
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; asked for
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;the
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;response headers. That led to the discovery that there are
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; none (from
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;child Squid point of view). If you really want to investigate the
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;caching angle in parallel with solving
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; ERR_READ_ERROR/WITH_SERVER, then
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;try to obtain HTTP response headers that the origin server
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; responds (to
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;the parent cache) with.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;HTH,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;Alex.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *From: *Ben Toms &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *Date: *Friday, 12 July 2024 at 17:56
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *To: *Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;&gt;&gt;,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; So, with the below config:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; https_port 443 accel protocol=HTTPS
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;tls-cert=/usr/local/squid/client.pem
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; tls-key=/usr/local/squid/client.key
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache_peer public.server.fqdn parent 443 0 no-query
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; originserver
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; no-digest no-netdb-exchange tls login=PASSTHRU name=myAccel
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; forceddomain=public.server.fqdn
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; acl our_sites dstdomain local.server.fqdn
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; http_access allow our_sites
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache_peer_access myAccel allow our_sites
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache_peer_access myAccel deny all
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache_dir ufs /usr/local/squid/var/cache 100000 16 256
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache_mem 500 MB
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; maximum_object_size_in_memory 50000 KB
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; refresh_pattern .&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160; 20%&#160;&#160;&#160;&#160; 4320
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; debug_options 11,2
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; I can see the below in /var/log/squid/cache.log
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; ----------
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; 2024/07/12 16:49:57.056 kid1| 11,2| http.cc(1263)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; readReply: conn12
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; local=client.ip:56670 remote=public.ip.of.public.server:443
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; FIRSTUP_PARENT FD 14 flags=1: read failure: (0) No error.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; 2024/07/12 16:49:57.056 kid1| 11,2| Stream.cc(273)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;sendStartOfMessage:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; HTTP Client conn9 local=client.ip:443
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;remote=local.server.ip:59158 FD 13
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; flags=1
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; 2024/07/12 16:49:57.056 kid1| 11,2| Stream.cc(274)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;sendStartOfMessage:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; HTTP Client REPLY:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; ---------
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; HTTP/1.1 502 Bad Gateway
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Server: squid/6.6
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Mime-Version: 1.0
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Date: Fri, 12 Jul 2024 16:49:57 GMT
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Content-Type: text/html;charset=utf-8
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Content-Length: 3629
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; X-Squid-Error: ERR_READ_ERROR 0
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Vary: Accept-Language
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Content-Language: en
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Cache-Status: local.server;detail=mismatch
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Via: 1.1 local.server (squid/6.6)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Connection: keep-alive
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; ----------
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; The apache server still shows a 200 for the request:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; [12/Jul/2024:17:49:57 +0100] &quot;GET /path/to/file HTTP/1.1&quot; 200
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;10465 &quot;-&quot;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; &quot;curl/8.7.1&quot;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; And this is when testing via:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; curl -D - <A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;&gt; -H &quot;Authorization: Basic
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; base64auth&quot; -o /dev/null
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Regards,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Ben.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *From: *Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *Date: *Friday, 12 July 2024 at 17:36
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *To: *Ben Toms &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ben at macmule.com</A>&gt;&gt;&gt;&gt;,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; On 2024-07-12 12:14, Ben Toms wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; Which log should those be found?
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; cache.log (if they are present)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; Can&#8217;t see &#8220;HTTP Server RESPONSE&#8221; in the access.log or
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; cache.log.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Sigh. This is one of the reasons I avoid asking folks to
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; study logs
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; themselves, even ALL,2 logs...
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; If that line is not in cache.log, then child Squid
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; probably did not
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; receive a response from parent Squid, or could not parse that
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;response.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; A full debugging log should give us more information.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; Alex.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; *From: *squid-users
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;&gt;&gt;&gt; on
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; behalf of Alex Rousskov &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; *Date: *Friday, 12 July 2024 at 17:11
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; *To: *<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; On 2024-07-12 11:38, Ben Toms wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Think I made the changes Alex requested:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; 12/Jul/2024:15:36:31 +0000.640 local.server.ip
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;TCP_MISS_ABORTED/502 3974
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; GET <A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A> 
</I>&gt;<i> &lt;<A HREF="https://local.server.fqdn/path/to/file">https://local.server.fqdn/path/to/file</A>&gt;&gt;&gt;&gt;&gt; -
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; FIRSTUP_PARENT/public.ip.of.public.server text/html
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; ERR_READ_ERROR/WITH_SERVER
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; Thank you for using Squid v6 for this test.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; Unfortunately, due to Squid logging bugs,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; ERR_READ_ERROR/WITH_SERVER
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; does not always mean what it says. For example, parent Squid
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;could have
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; closed the child-parent connection prematurely, but there
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; could
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;be other
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; reasons. A full debugging log should give us more
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; information.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; 2024/07/12 14:57:08.678 kid1| 11,2| Stream.cc(274)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;sendStartOfMessage:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; HTTP Client REPLY:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; This is a child proxy response to the client. We need parent
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;response to
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; the child proxy. Look for &quot;HTTP Server RESPONSE&quot; lines
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; instead.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; HTH,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt; Alex.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; ---------
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; HTTP/1.1 502 Bad Gateway
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Server: squid/6.6
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Mime-Version: 1.0
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Date: Fri, 12 Jul 2024 14:57:08 GMT
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Content-Type: text/html;charset=utf-8
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Content-Length: 3629
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; X-Squid-Error: ERR_READ_ERROR 0
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Vary: Accept-Language
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Content-Language: en
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Cache-Status: squid.host;detail=mismatch
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Via: 1.1 squid.host (squid/6.6)
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Connection: keep-alive
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; ----------
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Regards,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Ben.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; *From: *squid-users
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users-bounces at lists.squid-cache.org</A>&gt;&gt;&gt;&gt; on
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; behalf of Amos Jeffries &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid3 at treenet.co.nz</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; *Date: *Friday, 12 July 2024 at 15:22
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; *To: *<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;&lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; *Subject: *Re: [squid-users] TCP_MISS_ABORTED/502
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; On 13/07/24 01:52, Alex Rousskov wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; On 2024-07-12 08:06, Ben Toms wrote:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;&gt; Seems that my issue is similar to -
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>     <A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt; &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A> &lt;<A HREF="https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication">https://serverfault.com/questions/1104330/squid-cache-items-behind-basic-authentication</A>&gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; You are facing up to two problems:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; 1. Some authenticated responses are not cachable by Squid.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;Please share
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; HTTP headers of the response in question.
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; FYI, those can be obtained by configuring squid.conf with
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&#160; &#160;&#160; debug_options 11,2
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Cheers
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt; Amos
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; 2. TCP_MISS_ABORTED/502 errors may delete a being-cached
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;response. These
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; can be bogus errors (essentially Squid logging bugs) or
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; real
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;ones (e.g.,
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; due to communication bugs, misconfiguration, or
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; compatibility
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;problems).
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; I recommend adding %err_code/%err_detail to your
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160; logformat and
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;sharing
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; the corresponding access.log lines (obfuscated as needed).
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; Sharing (privately if needed) a pointer to compressed ALL,9
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;cache.log
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; while reproducing the issue using a single transaction may
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160;help us
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt; resolve all the unknowns:
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;&#160; &#160; &#160; &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>&#160;&#160;&#160;&#160;&#160; &gt;
</I>&gt;&gt;<i>     <A HREF="https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction">https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026931.html">[squid-users] TCP_MISS_ABORTED/502
</A></li>
	<LI>Next message (by thread): <A HREF="026940.html">[squid-users] TCP_MISS_ABORTED/502
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26937">[ date ]</a>
              <a href="thread.html#26937">[ thread ]</a>
              <a href="subject.html#26937">[ subject ]</a>
              <a href="author.html#26937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
