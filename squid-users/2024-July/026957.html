<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squidclient%20-h%20127.0.0.1%20-p%203128%20mgr%3Ainfo%20shows%0A%20access%20denined&In-Reply-To=%3Cd18f0034-1f3b-4b51-9927-06aa5e7f01ca%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026953.html">
   <LINK REL="Next"  HREF="026967.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20squidclient%20-h%20127.0.0.1%20-p%203128%20mgr%3Ainfo%20shows%0A%20access%20denined&In-Reply-To=%3Cd18f0034-1f3b-4b51-9927-06aa5e7f01ca%40measurement-factory.com%3E"
       TITLE="[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined">rousskov at measurement-factory.com
       </A><BR>
    <I>Thu Jul 18 13:58:01 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026953.html">[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined
</A></li>
        <LI>Next message (by thread): <A HREF="026967.html">[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26957">[ date ]</a>
              <a href="thread.html#26957">[ thread ]</a>
              <a href="subject.html#26957">[ subject ]</a>
              <a href="author.html#26957">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-07-18 00:55, Jonathan Lee wrote:

&gt;<i> curl <A HREF="http://localhost:3128/squid-internal-mgr/info">http://localhost:3128/squid-internal-mgr/info</A> 
</I>&gt;<i> 
</I>&gt;<i> Where would I place the password?
</I>
See &quot;man curl&quot; or online manual pages for curl. They will point you to 
two relevant options: --user and --proxy-user. AFAICT, your particular 
cache manager requests are sent _to_ the proxy (as if it were an origin 
server) rather than _through_ the proxy. Thus, you should use --user.

As I keep saying on this thread, due to Squid complications related to 
Bug 5283, specifying seemingly correct client parameters may not be 
enough to convince Squid to accept the cache manager request. I 
recommend the following procedure:

1. List the corresponding http_port directive first, before any other 
http_port, https_port, and ftp_port directives. Do not use interception 
of any kind for this cache manager port.

2. Use curl with absolute squid-internal-mgr URLs with http scheme (like 
you show above). Do _not_ use &quot;curl --proxy&quot; or similar. Do not use 
https scheme.

3. In that absolute mgr URL, use the host name that matches 
visible_hostname in squid.conf. If you do not have visible_hostname in 
squid.conf, add it. This is not required, but, due to Squid bugs, it is 
often much easier to get this to work with visible_hostname than without it.

4. Make (passwordless) mgr:info use case working first, before trying to 
get password-protected pages working.

5. When you do specify a username and a password, remember that you are 
sending this request to an (equivalent of) a service running on an 
origin server, _not_ a proxy (hence --user rather than --proxy-user).


If you cannot figure it out despite carefully going through the above 
steps, share (privately if needed) a pointer to compressed ALL,9 
cache.log while reproducing the problem with throw-away credentials on 
an idle Squid with a single curl request. Mention which step you got 
stuck on.


HTH,

Alex.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026953.html">[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined
</A></li>
	<LI>Next message (by thread): <A HREF="026967.html">[squid-users] squidclient -h 127.0.0.1 -p 3128 mgr:info shows access denined
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26957">[ date ]</a>
              <a href="thread.html#26957">[ thread ]</a>
              <a href="subject.html#26957">[ subject ]</a>
              <a href="author.html#26957">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
