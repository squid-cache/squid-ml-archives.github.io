<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] DNS Issue samba_dnsupdate: dns.resolver.NoAnswer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20DNS%20Issue%20samba_dnsupdate%3A%20dns.resolver.NoAnswer&In-Reply-To=%3CCABMAtPL1tc6mKHPVKr6kAR9v3zFy2Ctw5CU1z73SgjN6YJhGmg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026723.html">
   <LINK REL="Next"  HREF="026726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] DNS Issue samba_dnsupdate: dns.resolver.NoAnswer</H1>
    <B>Ronny Preiss</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20DNS%20Issue%20samba_dnsupdate%3A%20dns.resolver.NoAnswer&In-Reply-To=%3CCABMAtPL1tc6mKHPVKr6kAR9v3zFy2Ctw5CU1z73SgjN6YJhGmg%40mail.gmail.com%3E"
       TITLE="[squid-users] DNS Issue samba_dnsupdate: dns.resolver.NoAnswer">ronny.preiss at gmail.com
       </A><BR>
    <I>Sat Jun  8 10:08:22 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026723.html">[squid-users] can't explain 403 denied for authenticated
</A></li>
        <LI>Next message (by thread): <A HREF="026726.html">[squid-users] Samba DNS Invalid zone operation IsSigned
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26725">[ date ]</a>
              <a href="thread.html#26725">[ thread ]</a>
              <a href="subject.html#26725">[ subject ]</a>
              <a href="author.html#26725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

By doing my weekly task log checking, I saw the following error in syslog.
I've changed nothing the last couple of months.

My Environment:

2x Server Ubuntu 22.04.4 LTS with:
- Samba Version 4.19.0 AC-DC (Selfcompiled default values)

Samba version: 4.19.0
Build environment:
Paths:
   BINDIR: /usr/local/samba/bin
   SBINDIR: /usr/local/samba/sbin
   CONFIGFILE: /usr/local/samba/etc/smb.conf
   NCALRPCDIR: /usr/local/samba/var/run/ncalrpc
   LOGFILEBASE: /usr/local/samba/var
   LMHOSTSFILE: /usr/local/samba/etc/lmhosts
   DATADIR: /usr/local/samba/share
   MODULESDIR: /usr/local/samba/lib
   LOCKDIR: /usr/local/samba/var/lock
   STATEDIR: /usr/local/samba/var/locks
   CACHEDIR: /usr/local/samba/var/cache
   PIDDIR: /usr/local/samba/var/run
   PRIVATE_DIR: /usr/local/samba/private
   CODEPAGEDIR: /usr/local/samba/share/codepages
   SETUPDIR: /usr/local/samba/share/setup
   WINBINDD_SOCKET_DIR: /usr/local/samba/var/run/winbindd
   NTP_SIGND_SOCKET_DIR: /usr/local/samba/var/lib/ntp_signd


- DNS Backend Bind (BIND 9.18.18-0ubuntu0.22.04.2-Ubuntu)
- SysVol is  in sync with rsync

### /var/log/syslog
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.351034,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate: Traceback (most recent call last):
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352082,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/local/samba/sbin/samba_dnsupdate&quot;, line 883, in &lt;module&gt;
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352119,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     creds = get_credentials(lp)
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352132,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/local/samba/sbin/samba_dnsupdate&quot;, line 184, in get_credentials
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352144,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     get_krb5_rw_dns_server(creds,
sub_vars['DNSDOMAIN'] + '.')
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352158,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/local/samba/sbin/samba_dnsupdate&quot;, line 143, in get_krb5_rw_dns_server
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352203,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     rw_dns_servers =
get_possible_rw_dns_server(creds, domain)
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352239,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/local/samba/sbin/samba_dnsupdate&quot;, line 122, in
get_possible_rw_dns_server
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352253,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     ans_soa =
check_one_dns_name(domain, 'SOA')
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352267,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/local/samba/sbin/samba_dnsupdate&quot;, line 274, in check_one_dns_name
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352287,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     return resolver.resolve(name,
name_type)
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352302,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/lib/python3/dist-packages/dns/resolver.py&quot;, line 1202, in resolve
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352510,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     (answer, done) =
resolution.query_result(response, None)
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352551,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:   File
&quot;/usr/lib/python3/dist-packages/dns/resolver.py&quot;, line 674, in query_result
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352693,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate:     raise
NoAnswer(response=answer.response)
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.352783,  0]
../../lib/util/util_runcmd.c:355(samba_runcmd_io_handler)
Jun  8 11:54:11 01-dc01 samba[931]:
 /usr/local/samba/sbin/samba_dnsupdate: dns.resolver.NoAnswer: The DNS
response does not contain an answer to the question: intern.preiss.network.
IN SOA
Jun  8 11:54:11 01-dc01 samba[931]: [2024/06/08 11:54:11.383823,  0]
../../source4/dsdb/dns/dns_update.c:85(dnsupdate_nameupdate_done)
Jun  8 11:54:11 01-dc01 samba[931]:   dnsupdate_nameupdate_done: Failed DNS
update with exit code 1
###

Manual nslookup for the SOA entry works:

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">root at 01-dc01</A>:~# nslookup -q=SOA intern.preiss.network 10.10.10.11
Server:         10.10.10.11
Address:        10.10.10.11#53

intern.preiss.network
        origin = 01-dc01.intern.preiss.network
        mail addr = hostmaster.intern.preiss.network
        serial = 1159
        refresh = 900
        retry = 600
        expire = 86400
        minimum = 3600

Does someone know how to solve this or can give me some advice?

Greetings,
Ronny
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20240608/4dcac74f/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20240608/4dcac74f/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026723.html">[squid-users] can't explain 403 denied for authenticated
</A></li>
	<LI>Next message (by thread): <A HREF="026726.html">[squid-users] Samba DNS Invalid zone operation IsSigned
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26725">[ date ]</a>
              <a href="thread.html#26725">[ thread ]</a>
              <a href="subject.html#26725">[ subject ]</a>
              <a href="author.html#26725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
