<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Requesting Help to debug my squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Requesting%20Help%20to%20debug%20my%20squid&In-Reply-To=%3Cdeb6c6da4bce4dcdbef9c7ef6a0ce040%40tu-braunschweig.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026773.html">
   <LINK REL="Next"  HREF="026777.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Requesting Help to debug my squid</H1>
    <B>Ohms, Jannis</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Requesting%20Help%20to%20debug%20my%20squid&In-Reply-To=%3Cdeb6c6da4bce4dcdbef9c7ef6a0ce040%40tu-braunschweig.de%3E"
       TITLE="[squid-users] Requesting Help to debug my squid">j.ohms at tu-braunschweig.de
       </A><BR>
    <I>Tue Jun 25 06:34:39 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026773.html">[squid-users] url_rewrite (with rewrite-url): PinnedConnection failure results in total failure
</A></li>
        <LI>Next message (by thread): <A HREF="026777.html">[squid-users] Requesting Help to debug my squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26776">[ date ]</a>
              <a href="thread.html#26776">[ thread ]</a>
              <a href="subject.html#26776">[ subject ]</a>
              <a href="author.html#26776">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I run Squid 6.6  my  squid crashes  periodically I recive logs similar to this  one

2024-06-25T08:14:04.539274+02:00 surfer-proxy squid[585630]: Starting Squid Cache version 6.6 for x86_64-pc-linux-gnu...
2024-06-25T08:14:04.539391+02:00 surfer-proxy squid[585630]: Service Name: squid
2024-06-25T08:14:04.539457+02:00 surfer-proxy squid[585630]: Process ID 585630
2024-06-25T08:14:04.539525+02:00 surfer-proxy squid[585630]: Process Roles: worker
2024-06-25T08:14:04.539587+02:00 surfer-proxy squid[585630]: With 16348 file descriptors available
2024-06-25T08:14:04.539647+02:00 surfer-proxy squid[585630]: Initializing IP Cache...
2024-06-25T08:14:04.539821+02:00 surfer-proxy squid[585630]: DNS IPv6 socket created at [::], FD 8
2024-06-25T08:14:04.539893+02:00 surfer-proxy squid[585630]: DNS IPv4 socket created at 0.0.0.0, FD 9
2024-06-25T08:14:04.539955+02:00 surfer-proxy squid[585630]: Adding nameserver 127.0.0.1 from /etc/resolv.conf
2024-06-25T08:14:04.540026+02:00 surfer-proxy squid[585630]: Adding domain biblio.etc.tu-bs.de from /etc/resolv.conf
2024-06-25T08:14:04.540091+02:00 surfer-proxy squid[585630]: Adding domain surfer.unibib.local from /etc/resolv.conf
2024-06-25T08:14:04.552194+02:00 surfer-proxy squid[585630]: Logfile: opening log stdio:/var/log/squid/access.log
2024-06-25T08:14:04.804840+02:00 surfer-proxy squid[585630]: Unlinkd pipe opened on FD 14
2024-06-25T08:14:04.809285+02:00 surfer-proxy squid[585630]: Local cache digest enabled; rebuild/rewrite every 3600/3600 sec
2024-06-25T08:14:04.809435+02:00 surfer-proxy squid[585630]: Store logging disabled
2024-06-25T08:14:04.809513+02:00 surfer-proxy squid[585630]: Swap maxSize 102400 + 98304 KB, estimated 15438 objects
2024-06-25T08:14:04.809577+02:00 surfer-proxy squid[585630]: Target number of buckets: 771
2024-06-25T08:14:04.809647+02:00 surfer-proxy squid[585630]: Using 8192 Store buckets
2024-06-25T08:14:04.809715+02:00 surfer-proxy squid[585630]: Max Mem  size: 98304 KB
2024-06-25T08:14:04.809775+02:00 surfer-proxy squid[585630]: Max Swap size: 102400 KB
2024-06-25T08:14:04.810390+02:00 surfer-proxy squid[585630]: Rebuilding storage in /var/squid/cache (dirty log)
2024-06-25T08:14:04.810535+02:00 surfer-proxy squid[585630]: Using Least Load store dir selection
2024-06-25T08:14:04.810635+02:00 surfer-proxy squid[585630]: Current Directory is /
2024-06-25T08:14:04.860606+02:00 surfer-proxy squid[585630]: Finished loading MIME types and icons.
2024-06-25T08:14:04.861090+02:00 surfer-proxy squid[585630]: HTCP Disabled.
2024-06-25T08:14:04.862578+02:00 surfer-proxy squid[585630]: Pinger socket opened on FD 19
2024-06-25T08:14:04.862850+02:00 surfer-proxy squid[585630]: Squid plugin modules loaded: 0
2024-06-25T08:14:04.862931+02:00 surfer-proxy squid[585630]: Adaptation support is off.
2024-06-25T08:14:04.862999+02:00 surfer-proxy squid[585630]: Accepting HTTP Socket connections at conn3 local=[::]:8080 remote=[::] FD 17 flags=9#012    listening port: 8080
2024-06-25T08:14:04.882088+02:00 surfer-proxy squid[585630]: Done reading /var/squid/cache swaplog (540 entries)
2024-06-25T08:14:04.882254+02:00 surfer-proxy squid[585630]: Finished rebuilding storage from disk.#012        540 Entries scanned#012          0 Invalid entries#012          0 With invalid flags#012        540 Objects loaded#012          0 Objects expired#012          0 Objects canceled#012          0 Duplicate URLs purged#012          0 Swapfile clashes avoided#012    Took 0.07 seconds (7526.24 objects/sec).
2024-06-25T08:14:04.882339+02:00 surfer-proxy squid[585630]: Beginning Validation Procedure
2024-06-25T08:14:04.882619+02:00 surfer-proxy squid[585630]: Completed Validation Procedure#012    Validated 540 Entries#012    store_swap_size = 18780.00 KB
2024-06-25T08:14:05.044043+02:00 surfer-proxy squid[585630]: FATAL: assertion failed: FilledChecklist.cc:263: &quot;!rfc931[0]&quot;#012    current master transaction: master57
2024-06-25T08:14:05.181283+02:00 surfer-proxy squid[585262]: Squid Parent: squid-1 process 585630 exited due to signal 6 with status 0
2024-06-25T08:14:05.181485+02:00 surfer-proxy squid[585262]: Squid Parent: squid-1 process 585630 will not be restarted for 3600 seconds due to repeated, frequent failures
2024-06-25T08:14:05.182410+02:00 surfer-proxy squid[585262]: Exiting due to repeated, frequent failures
2024-06-25T08:14:05.182520+02:00 surfer-proxy squid[585262]: Removing PID file (/run/squid.pid)
2024-06-25T08:14:05.191194+02:00 surfer-proxy systemd[1]: squid.service: Main process exited, code=exited, status=1/FAILURE
2024-06-25T08:14:05.191417+02:00 surfer-proxy systemd[1]: squid.service: Killing process 585610 (pinger) with signal SIGKILL.
2024-06-25T08:14:05.191477+02:00 surfer-proxy systemd[1]: squid.service: Killing process 585615 (pinger) with signal SIGKILL.
2024-06-25T08:14:05.191515+02:00 surfer-proxy systemd[1]: squid.service: Killing process 585622 (pinger) with signal SIGKILL.
2024-06-25T08:14:05.191554+02:00 surfer-proxy systemd[1]: squid.service: Killing process 585627 (pinger) with signal SIGKILL.
2024-06-25T08:14:05.191593+02:00 surfer-proxy systemd[1]: squid.service: Killing process 585632 (pinger) with signal SIGKILL.
2024-06-25T08:14:05.193169+02:00 surfer-proxy systemd[1]: squid.service: Failed with result 'exit-code'.
2024-06-25T08:14:05.193809+02:00 surfer-proxy systemd[1]: squid.service: Consumed 2.090s CPU time, 32.9M memory peak, 0B memory swap peak.

The log seems to indicate that some assertion is failing.
Is this an assertion on the swaplog or my config ?
would it help to purge the swap log
is it possible to restive the  element which violates the assertion

Feel free to ask for additional information

Any Hints are welcome. I am new to squid and inherited this project

Thanks

Jannis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20240625/f9d315a9/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20240625/f9d315a9/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026773.html">[squid-users] url_rewrite (with rewrite-url): PinnedConnection failure results in total failure
</A></li>
	<LI>Next message (by thread): <A HREF="026777.html">[squid-users] Requesting Help to debug my squid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26776">[ date ]</a>
              <a href="thread.html#26776">[ thread ]</a>
              <a href="subject.html#26776">[ subject ]</a>
              <a href="author.html#26776">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
