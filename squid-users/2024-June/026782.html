<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FATAL%3A%20assertion%20failed%3A%20mem/PageStack.cc%3A159%3A%0A%20%22StoredNode%28%29.is_lock_free%28%29%22&In-Reply-To=%3C91526e3e-39cf-4ba5-9aac-a90729170993%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026781.html">
   <LINK REL="Next"  HREF="026783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;</H1>
    <B>Nishant Sharma</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20FATAL%3A%20assertion%20failed%3A%20mem/PageStack.cc%3A159%3A%0A%20%22StoredNode%28%29.is_lock_free%28%29%22&In-Reply-To=%3C91526e3e-39cf-4ba5-9aac-a90729170993%40gmail.com%3E"
       TITLE="[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;">codemarauder at gmail.com
       </A><BR>
    <I>Fri Jun 28 05:38:46 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026781.html">[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="026783.html">[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26782">[ date ]</a>
              <a href="thread.html#26782">[ thread ]</a>
              <a href="subject.html#26782">[ subject ]</a>
              <a href="author.html#26782">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for your reply Alex.

On 27/06/24 23:06, Alex Rousskov wrote:
&gt;<i> and how your traffic tickles them, SMP Squid without atomic locks might 
</I>&gt;<i> become very slow! We do not (and, IMO, should not) optimize performance 
</I>&gt;<i> for environments without lock-free atomics!
</I>&gt;<i> 
</I>&gt;<i> I see the following options for going forward:
</I>&gt;<i> 
</I>&gt;<i> * Comment out the assertion, void your warranty, and hope for the best.
</I>&gt;<i> * Audit relevant code to confirm that the assertion is safe to remove.
</I>&gt;<i> * Find a usable OS/environment that has lock-free 64-bit atomics.
</I>
I am not a developer, so it will take me some help to get the code and 
repercussions of it's modification understood.

In our use case, we do not use caching at all except a small in-memory 
cache of say 64MB.

Squid is used for access control with external acl helper and SSL Bump 
where SMP used to help with version 4.x.

Would it be catastrophic to comment out the assertion and then remove 
relevant code for such a use case where there is no disk cache available 
for probable corruption?

Regards,
Nishant

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026781.html">[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="026783.html">[squid-users] FATAL: assertion failed: mem/PageStack.cc:159: &quot;StoredNode().is_lock_free()&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26782">[ date ]</a>
              <a href="thread.html#26782">[ thread ]</a>
              <a href="subject.html#26782">[ subject ]</a>
              <a href="author.html#26782">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
