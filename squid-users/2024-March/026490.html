<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Missing IPv6 sockets in Squid 6.7 in some servers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Missing%20IPv6%20sockets%20in%20Squid%206.7%20in%20some%20servers&In-Reply-To=%3C7c07f1f6-dda2-4278-8e74-ab2ee5ded45a%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026489.html">
   <LINK REL="Next"  HREF="026496.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Missing%20IPv6%20sockets%20in%20Squid%206.7%20in%20some%20servers&In-Reply-To=%3C7c07f1f6-dda2-4278-8e74-ab2ee5ded45a%40treenet.co.nz%3E"
       TITLE="[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers">squid3 at treenet.co.nz
       </A><BR>
    <I>Tue Mar  5 03:40:50 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026489.html">[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers
</A></li>
        <LI>Next message (by thread): <A HREF="026496.html">[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26490">[ date ]</a>
              <a href="thread.html#26490">[ thread ]</a>
              <a href="subject.html#26490">[ subject ]</a>
              <a href="author.html#26490">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/03/24 08:03, Dragos Pacher wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am a Squid beginner and we would like to use Squid inside our 
</I>&gt;<i> organization only as a HTTPS traffic inspection/logging tool for some 
</I>&gt;<i> 3rd party apps that we bought,
</I>&gt;<i> something close to what a &quot;MITM proxy&quot; is called but we will not do 
</I>&gt;<i> that, instead we use a self signed certificate and the 3rd party app 
</I>&gt;<i> owners know this. Everything is
</I>&gt;<i> 100% completely legal. (Ps: I am the IT lead).
</I>&gt;<i> 
</I>
FYI: &quot;MITM proxy&quot; is a ridiculous term. &quot;MITM&quot; means &quot;intermediary&quot; in 
security terminology, &quot;proxy&quot; means &quot;intermediary&quot; in networking 
terminology.
  So that term just means &quot;intermediary intermediary&quot;, yeah.



Any serious HTTPS inspection/logging by Squid needs some form of 
SSL-Bump configuration and those 3rd-party Apps MUST be configured with 
trust for the self-signed root CA you are using.


Without that nothing Squid (or any other proxy) does will allow traffic 
inspection beyond the initial TLS handshake.



Assuming that you have checked that detail, on to your issue ...


&gt;<i> We will be using Squid only internally, no outside access. Here is my 
</I>&gt;<i> issue with the current knowledge of Squid: POC running well on 3 servers 
</I>&gt;<i> but on the 4th I get no IPv6
</I>&gt;<i> sockets:
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ubuntu at A2-3</A>:/$ sudo netstat -patun | grep squid | grep tcp
</I>&gt;<i> tcp &#160; &#160; &#160; &#160;0 &#160; &#160; &#160;0 10.10.0.16:3128 &#160; &#160; &#160; &#160; 0.0.0.0:*               
</I>&gt;<i> LISTEN &#160; &#160; &#160;2891391/(squid-1)
</I>

Your problem is the https(s)_port &quot;port&quot; configuration parameter.


This Squid is configured to listen like:

   http_port 10.10.0.16:3128

or

   http_port example.com:3128

(when example.com has only address 10.10.0.16)


The &quot;http_port&quot; receives port 80 syntax traffic, it may also be
&quot;https_port&quot; which receives port 443 syntax traffic.


&gt;<i> 
</I>&gt;<i> and on the other 3 I have IPv6:
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">ubuntu at A2-2</A>:/$ sudo netstat -patun | grep squid | grep tcp
</I>&gt;<i> tcp &#160; &#160; &#160; &#160;0 &#160; &#160; &#160;0 x.x.x.x:52386 &#160;&#160; x.x.x.x:443 &#160; &#160; ESTABLISHED 
</I>&gt;<i> 997651/(squid-1)
</I>&gt;<i> tcp6 &#160; &#160; &#160; 0 &#160; &#160; &#160;0 :::3128 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; :::*                   
</I>&gt;<i>  &#160;LISTEN &#160; &#160; &#160;997651/(squid-1)
</I>

These Squid are configured to listen like:

  http_port 3128


Ensure that the machine/server the 4th Squid is running on has its 
http(s)_port line matching the other three machines port value.

At this point do not care about the &quot;mode&quot; or options later in the line. 
Your issue is solely the &quot;port&quot; parameter.


Cheers
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026489.html">[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers
</A></li>
	<LI>Next message (by thread): <A HREF="026496.html">[squid-users] Missing IPv6 sockets in Squid 6.7 in some servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26490">[ date ]</a>
              <a href="thread.html#26490">[ thread ]</a>
              <a href="subject.html#26490">[ subject ]</a>
              <a href="author.html#26490">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
