<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] After upgrade from squid6.6 to 6.8 we have a lot of ICAP_ERR_OTHER and ICAP_ERR_GONE messages in icap logfiles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20After%20upgrade%20from%20squid6.6%20to%206.8%20we%20have%20a%20lot%20of%0A%20ICAP_ERR_OTHER%20and%20ICAP_ERR_GONE%20messages%20in%20icap%20logfiles&In-Reply-To=%3C20240311153142.gfanwq4toaqpcrrq%40bloms.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026518.html">
   <LINK REL="Next"  HREF="026520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] After upgrade from squid6.6 to 6.8 we have a lot of ICAP_ERR_OTHER and ICAP_ERR_GONE messages in icap logfiles</H1>
    <B>Dieter Bloms</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20After%20upgrade%20from%20squid6.6%20to%206.8%20we%20have%20a%20lot%20of%0A%20ICAP_ERR_OTHER%20and%20ICAP_ERR_GONE%20messages%20in%20icap%20logfiles&In-Reply-To=%3C20240311153142.gfanwq4toaqpcrrq%40bloms.de%3E"
       TITLE="[squid-users] After upgrade from squid6.6 to 6.8 we have a lot of ICAP_ERR_OTHER and ICAP_ERR_GONE messages in icap logfiles">squid.org at bloms.de
       </A><BR>
    <I>Mon Mar 11 15:31:42 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026518.html">[squid-users] Manipulating request headers
</A></li>
        <LI>Next message (by thread): <A HREF="026520.html">[squid-users] After upgrade from squid6.6 to 6.8 we have a lot of ICAP_ERR_OTHER and ICAP_ERR_GONE messages in icap logfiles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26513">[ date ]</a>
              <a href="thread.html#26513">[ thread ]</a>
              <a href="subject.html#26513">[ subject ]</a>
              <a href="author.html#26513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

after an upgrade from squid6.6 to squid6.8 on a debian bookworm we have a lot
of messages from type:

ICAP_ERR_GONE/000
ICAP_ERR_OTHER/200
ICAP_ERR_OTHER/408
ICAP_ERR_OTHER/204

and some of our users claim about bad performance and some get &quot;empty
pages&quot;. 
Unfortunately it is not deterministic, the page will appear the next
time it is called up. I can't see anything conspicuous in the cache.log.

There was no change to the virus scanner nor any change to the squid
config during the upgrade.

Here the icap spefific config lines from squid:

--snip--
acl CONNECT method CONNECT
acl withoutvirusscanner.dstnames dstdomain &quot;/etc/squid/withoutvirusscanner.dstnames&quot;
acl audio rep_mime_type ^audio/
acl audio rep_mime_type ^video/

icap_enable on
icap_preview_enable on
icap_preview_size 128
icap_persistent_connections on
icap_send_client_ip on
icap_send_client_username on
icap_service_failure_limit -1
icap_service_revival_delay 30
logformat icap_debug %ts.%03tu %6icap::tr %&gt;a %icap::to/%03icap::Hs %icap::&lt;st %icap::rm %ru %icap::&lt;A -
icap_log daemon:/var/log/squid/icap.log icap_debug
icap_service service_reqmod reqmod_precache bypass=0 max-conn=4096 <A HREF="icap://xx.xx.xx.xx:1344/service_scanner">icap://xx.xx.xx.xx:1344/service_scanner</A>
icap_service service_respmod respmod_precache bypass=0 max-conn=4096 <A HREF="icap://xx.xx.xx.xx:1344/service_scanner">icap://xx.xx.xx.xx:1344/service_scanner</A>
adaptation_service_chain icap_request_scanners service_reqmod
adaptation_service_chain icap_respond_scanners service_respmod
adaptation_access icap_request_scanners allow all !to_localhost !manager !CONNECT !withoutvirusscanner.dstnames
adaptation_access icap_respond_scanners allow all !to_localhost !manager !CONNECT !audio !withoutvirusscanner.dstnames
--snip--

I don't see any changes in the ICAP server area between 6.6 and 6.8


-- 
Regards

  Dieter

--
I do not get viruses because I do not use MS software.
If you use Outlook then please do not put my email address in your
address-book so that WHEN you get a virus it won't use my address in the
&gt;<i>From field.
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026518.html">[squid-users] Manipulating request headers
</A></li>
	<LI>Next message (by thread): <A HREF="026520.html">[squid-users] After upgrade from squid6.6 to 6.8 we have a lot of ICAP_ERR_OTHER and ICAP_ERR_GONE messages in icap logfiles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26513">[ date ]</a>
              <a href="thread.html#26513">[ thread ]</a>
              <a href="subject.html#26513">[ subject ]</a>
              <a href="author.html#26513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
