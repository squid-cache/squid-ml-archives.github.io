<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid TCP_TUNNEL_ABORTED/200
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20TCP_TUNNEL_ABORTED/200&In-Reply-To=%3Ccab56356-a3f4-4b26-b8fd-5d53a8ba3716%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026647.html">
   <LINK REL="Next"  HREF="026645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid TCP_TUNNEL_ABORTED/200</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20TCP_TUNNEL_ABORTED/200&In-Reply-To=%3Ccab56356-a3f4-4b26-b8fd-5d53a8ba3716%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid TCP_TUNNEL_ABORTED/200">squid3 at treenet.co.nz
       </A><BR>
    <I>Sun May  5 07:03:31 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026647.html">[squid-users] Squid TCP_TUNNEL_ABORTED/200
</A></li>
        <LI>Next message (by thread): <A HREF="026645.html">[squid-users] Squid TCP_TUNNEL_ABORTED/200
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26648">[ date ]</a>
              <a href="thread.html#26648">[ thread ]</a>
              <a href="subject.html#26648">[ subject ]</a>
              <a href="author.html#26648">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/05/24 11:17, Emre Oksum wrote:
&gt;<i>  &gt;In this case, all your tcp_outgoing_addr lines being tested. Most of
</I>&gt;<i>  &gt;them will not match.
</I>&gt;<i> Sorry I'm not really a Squid guy I was working on it due to a job that I 
</I>&gt;<i> took but I cannot figure this out. What do you mean most of them do not 
</I>&gt;<i> match? Does it mean Squid checks every ACL one by one that is defined in 
</I>&gt;<i> config to find the correct IPv6 address?
</I>
Yes, exactly so.

Each tcp_outgoing_address line of squid.conf is checked top-to-bottom, 
the ACLs on that line tested left-to-right against the Squid local-IP 
the client connected to.
  Most will non-match (as seen in the trace snippet you showed).
  One should match, at which point Squid uses the IP address on that 
tcp_outgoing_address line.


As mentioned earlier, this is all on *outgoing* Squid-to-server 
connections. tcp_outgoing_* directives have no effect on the client 
connection.


&gt;<i> If that's the case I still 
</I>&gt;<i> didn't understand why Squid randomly sends Connection Reset flag to 
</I>&gt;<i> client.
</I>
That is what we are trying to figure out, yes.

I asked for the cache.log trace so I could look through and see when one 
of the problematic connections was identified by Squid as closed, and 
whether that was caused by something else Squid was doing - or whether 
the signal came to Squid from the OS.
  Which would tell us whether Squid had sent it, or if the OS had sent 
it to both Squid and client.

I/we will need a full cache.log trace from before a problematic 
connection was opened, to after it fails. At least several seconds 
before and after.

Cheers
Amos

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026647.html">[squid-users] Squid TCP_TUNNEL_ABORTED/200
</A></li>
	<LI>Next message (by thread): <A HREF="026645.html">[squid-users] Squid TCP_TUNNEL_ABORTED/200
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26648">[ date ]</a>
              <a href="thread.html#26648">[ thread ]</a>
              <a href="subject.html#26648">[ subject ]</a>
              <a href="author.html#26648">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
