<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] log_referrer question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20log_referrer%20question&In-Reply-To=%3C79954c57-40a3-4e99-b5d3-b75d0bd6b92f%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026685.html">
   <LINK REL="Next"  HREF="026686.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] log_referrer question</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20log_referrer%20question&In-Reply-To=%3C79954c57-40a3-4e99-b5d3-b75d0bd6b92f%40measurement-factory.com%3E"
       TITLE="[squid-users] log_referrer question">rousskov at measurement-factory.com
       </A><BR>
    <I>Tue May 21 19:57:59 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026685.html">[squid-users] log_referrer question
</A></li>
        <LI>Next message (by thread): <A HREF="026686.html">[squid-users] log_referrer question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26687">[ date ]</a>
              <a href="thread.html#26687">[ thread ]</a>
              <a href="subject.html#26687">[ subject ]</a>
              <a href="author.html#26687">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-05-21 14:47, Bobby Matznick wrote:
&gt;<i> To add and maybe clarify what my confusion is, the log entries below 
</I>&gt;<i> (hidden internal/external IP&#8217;s, domain and username) don&#8217;t seem to show 
</I>&gt;<i> what I expected, a line marked &#8220;referrer&#8221;. Am I misunderstanding how 
</I>&gt;<i> that should show up in the log?
</I>
Kind of: HTTP CONNECT requests normally do not have Referer headers. 
These requests establish a TCP tunnel to an origin server through Squid. 
The &quot;real&quot; requests to origin server are inside that tunnel.

In some cases, it is possible to configure the client and Squid in such 
a way that Squid can look inside that tunnel and find &quot;real&quot; requests, 
but doing so well requires a lot of effort, including becoming a 
Certificate Authority and configuring client to trust certificates 
produced by that Certificate Authority. You can search for SslBump to 
get more information, but the area is full of insurmountable 
difficulties and misleading advice. Avoid it if at all possible.


HTH,

Alex.


&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Tue, 21 May 2024 17:50:49 +0000
</I>&gt;<i> From: Bobby Matznick &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">bmatznick at pbandt.bank</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">bmatznick at pbandt.bank</A>&gt;&gt;
</I>&gt;<i> To: &quot;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&quot;
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;<i> Subject: [squid-users] log_referrer question
</I>&gt;<i> Message-ID:
</I>&gt;<i> &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">MW5PR14MB52897188C2ED83596B406151B0EA2 at MW5PR14MB5289.namprd14.prod.outlook.com</A> &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">MW5PR14MB52897188C2ED83596B406151B0EA2 at MW5PR14MB5289.namprd14.prod.outlook.com</A>&gt;&gt;
</I>&gt;<i> 
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i> 
</I>&gt;<i> I have been trying to use a combined log format for squid. The below 
</I>&gt;<i> line in the squid config is my current attempt.
</I>&gt;<i> 
</I>&gt;<i> logformat combined %&gt;a %[ui %[un [%tl &quot;%rm %ru HTTP/%rv&quot; %&gt;Hs %&lt;st 
</I>&gt;<i> &quot;%{Referer}&gt;h&quot; &quot;%{User-Agent}&gt;h&quot; %Ss:%Sh
</I>&gt;<i> 
</I>&gt;<i> It is working, as far as logging the normal stuff I would see before 
</I>&gt;<i> having tried to implement referrer. I noticed somewhere that you need to 
</I>&gt;<i> build squid with -enable-referrer-log, it was an older version, looked 
</I>&gt;<i> like 3.1 and lower, I am using 4.13. So, checked with squid -v and do 
</I>&gt;<i> not see &quot;-enable-referrer_log&quot; as one of the configure options used 
</I>&gt;<i> during install. Would I need to reinstall, or is that no longer 
</I>&gt;<i> necessary in version 4.13? Thanks!!
</I>&gt;<i> 
</I>&gt;<i> Bobby
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026685.html">[squid-users] log_referrer question
</A></li>
	<LI>Next message (by thread): <A HREF="026686.html">[squid-users] log_referrer question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26687">[ date ]</a>
              <a href="thread.html#26687">[ thread ]</a>
              <a href="subject.html#26687">[ subject ]</a>
              <a href="author.html#26687">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
