<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Adding an extra header to TLS connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Adding%20an%20extra%20header%20to%20TLS%20connection&In-Reply-To=%3CCALmccy4dboZq61cRF0gv8VUgs-JRaYJdsn-cFpW7tHqYYGr1VA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026691.html">
   <LINK REL="Next"  HREF="026693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Adding an extra header to TLS connection</H1>
    <B>Robin Wood</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Adding%20an%20extra%20header%20to%20TLS%20connection&In-Reply-To=%3CCALmccy4dboZq61cRF0gv8VUgs-JRaYJdsn-cFpW7tHqYYGr1VA%40mail.gmail.com%3E"
       TITLE="[squid-users] Adding an extra header to TLS connection">squid at digi.ninja
       </A><BR>
    <I>Thu May 23 17:06:01 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="026691.html">[squid-users] Adding an extra header to TLS connection
</A></li>
        <LI>Next message (by thread): <A HREF="026693.html">[squid-users] Adding an extra header to TLS connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26692">[ date ]</a>
              <a href="thread.html#26692">[ thread ]</a>
              <a href="subject.html#26692">[ subject ]</a>
              <a href="author.html#26692">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 23 May 2024 at 18:00, Jonathan Lee &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">jonathanlee571 at gmail.com</A>&gt; wrote:

&gt;<i> I do use ssl bump again it requires certificates installed on the devices,
</I>&gt;<i> and or some and a splice for the others. You must also add a url list for
</I>&gt;<i> items that must never be intercepted like banks etc. I agree it is not an
</I>&gt;<i> easy task, it took me years to get it to work correctly for what I needed.
</I>&gt;<i> When it does work it works beautifully, you can cache updates and reuse
</I>&gt;<i> them, you can use clam AV on https traffic. It&#8217;s not for everyone it will
</I>&gt;<i> make you a wizard level 1000 if you can get it going.
</I>&gt;<i>
</I>
Jonathan, can you give me an example of it working?

Oddly, you are replying to a message from Alex that I never received.

Alex, in answer to your questions...

I'm doing some testing against a client's site, they require a custom
header to allow my connections through their WAF. I could try to do this
manually with all my tools, but it would be easier to just have Squid do it
for me and then have the tools use Squid as their proxy. I can tell them to
not do cert checking or I can use my own CA and import it into the system
store, that is not a problem.

I've tried searching for Squid and sslbump and not found anything useful
that works with the current version, that is why I'm asking here, I was
hoping someone could point me at an example that would definitely work with
the current version of Squid.

Robin


&gt;<i> Sent from my iPhone
</I>&gt;<i>
</I>&gt;<i> &gt; On May 23, 2024, at 08:49, Alex Rousskov &lt;
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &#65279;On 2024-05-22 03:49, Robin Wood wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; I'm trying to work out how to add an extra header to a TLS connection.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I assume that you want to add a header field to an HTTP request or
</I>&gt;<i> response that is being transmitted inside a TLS connection between a TLS
</I>&gt;<i> client (e.g., a user browser) and an HTTPS origin server.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Do you control the client that originates that TLS connection (or its
</I>&gt;<i> OS/environment) or the origin server? If you do not, then what you want is
</I>&gt;<i> impossible -- TLS encryption exists, in part, to prevent such traffic
</I>&gt;<i> modifications.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If you control the client that originates that TLS connection (or its
</I>&gt;<i> OS/environment), then you may be able to, in _some_ cases, add that header
</I>&gt;<i> by configuring the client (or its OS/environment) to trust you as a
</I>&gt;<i> Certificate Authority, minting your own X509 certificates, and configuring
</I>&gt;<i> Squid to perform a &quot;man in the middle&quot; attack on client-server traffic,
</I>&gt;<i> using your minted certificates. You can search for Squid SslBump to get
</I>&gt;<i> more information about this feature, but the area is full of insurmountable
</I>&gt;<i> difficulties and misleading advice. Avoid it if at all possible!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; HTH,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Alex.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; I've found information on how to do it on what I think is the pre-3.5
</I>&gt;<i> release, but I can't find any useful information on doing it on the current
</I>&gt;<i> version.
</I>&gt;<i> &gt;&gt; Could someone give me an example or point me at some documentation on
</I>&gt;<i> how to do it.
</I>&gt;<i> &gt;&gt; Thanks
</I>&gt;<i> &gt;&gt; Robin
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; squid-users mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; squid-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20240523/b1c26534/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20240523/b1c26534/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="026691.html">[squid-users] Adding an extra header to TLS connection
</A></li>
	<LI>Next message (by thread): <A HREF="026693.html">[squid-users] Adding an extra header to TLS connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26692">[ date ]</a>
              <a href="thread.html#26692">[ thread ]</a>
              <a href="subject.html#26692">[ subject ]</a>
              <a href="author.html#26692">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
