<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] v6.12 build error from release tarball
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20v6.12%20build%20error%20from%20release%20tarball&In-Reply-To=%3Ce6822e6b-6fe7-4941-a42d-c4a56e575b3b%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027244.html">
   <LINK REL="Next"  HREF="027246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] v6.12 build error from release tarball</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20v6.12%20build%20error%20from%20release%20tarball&In-Reply-To=%3Ce6822e6b-6fe7-4941-a42d-c4a56e575b3b%40measurement-factory.com%3E"
       TITLE="[squid-users] v6.12 build error from release tarball">rousskov at measurement-factory.com
       </A><BR>
    <I>Fri Nov  8 04:27:25 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027244.html">[squid-users] v6.12 build error from release tarball
</A></li>
        <LI>Next message (by thread): <A HREF="027246.html">[squid-users] v6.12 build error from release tarball
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27245">[ date ]</a>
              <a href="thread.html#27245">[ thread ]</a>
              <a href="subject.html#27245">[ subject ]</a>
              <a href="author.html#27245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-11-07 16:48, Marko, Peter wrote:

&gt;<i> Commit [1] removed directory libltdl/m4 from release tarball by merging
</I>&gt;<i> all those files into libltdl/aclocal.m4,
</I>
Clarification: While commit b4addc22 itself did not remove any 
directories or merged any files, bootstrapping Squid after that commit 
may have such an effect. The exact bootstrapping outcome depends, in 
part, on bootstrapping environment (e.g., installed libtool version)...


&gt;<i> however makefiles still
</I>&gt;<i> reference it causing following error (in Yocto project):
</I>
libltdl/Makefile.am that references m4 directory comes from Libtool. 
That particular Makefile.am does not exist in primary Squid sources 
(i.e. what gets committed to the official git repository). It gets 
created (by libtoolize IIRC) during bootstrapping of Squid sources.



&gt;<i> | autoreconf: Entering directory 'libltdl'
</I>
To bootstrap Squid, one has to run ./bootstrap.sh instead of autoreconf. 
AFAIK, Squid does not fully support bootstrapping with autoreconf; 
autoreconf fails to do the right thing in some environments. If 
autoreconf had worked for you, it was just temporary luck.

However, _why_ run autoreconf (i.e. bootstrapping Squid) after 
downloading _bootstrapped_ sources?! Clarifying this contradiction may 
help identify and address the underlying problem.


Thank you,

Alex.






&gt;<i> | autoreconf: configure.ac: not using Gettext
</I>&gt;<i> | autoreconf: running: aclocal --system-acdir=WORKDIR/recipe-sysroot/usr/share/aclocal/ -I WORKDIR/squid-6.12/acinclude/ -I WORKDIR/recipe-sysroot-native/usr/share/aclocal/ --force -I m4
</I>&gt;<i> | aclocal: error: couldn't open directory 'm4': No such file or directory
</I>&gt;<i> | autoreconf: error: aclocal failed with exit status: 1
</I>&gt;<i> 
</I>&gt;<i> Following change of release tarball will make the build pass:
</I>&gt;<i> diff squid-6.12-orig/libltdl/Makefile.am squid-6.12/libltdl/Makefile.am
</I>&gt;<i> --- squid-6.12-orig/libltdl/Makefile.am
</I>&gt;<i> +++ squid-6.12/libltdl/Makefile.am
</I>&gt;<i> @@ -29,7 +29,7 @@
</I>&gt;<i>   ## 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
</I>&gt;<i>   #####
</I>&gt;<i>   
</I>&gt;<i> -ACLOCAL_AMFLAGS = -I m4
</I>&gt;<i> +ACLOCAL_AMFLAGS =
</I>&gt;<i>   AUTOMAKE_OPTIONS = foreign
</I>&gt;<i>   AM_CPPFLAGS =
</I>&gt;<i>   AM_LDFLAGS =
</I>&gt;<i> diff squid-6.12-orig/libltdl/Makefile.in squid-6.12/libltdl/Makefile.in
</I>&gt;<i> --- squid-6.12-orig/libltdl/Makefile.in
</I>&gt;<i> +++ squid-6.12/libltdl/Makefile.in
</I>&gt;<i> @@ -448,7 +448,7 @@ target_alias = @target_alias@
</I>&gt;<i>   top_build_prefix = @top_build_prefix@
</I>&gt;<i>   top_builddir = @top_builddir@
</I>&gt;<i>   top_srcdir = @top_srcdir@
</I>&gt;<i> -ACLOCAL_AMFLAGS = -I m4
</I>&gt;<i> +ACLOCAL_AMFLAGS =
</I>&gt;<i>   AUTOMAKE_OPTIONS = foreign
</I>&gt;<i>   
</I>&gt;<i>   # -I$(srcdir) is needed for user that built libltdl with a sub-Automake
</I>&gt;<i> 
</I>&gt;<i> I don't know how to fix it in source repository.
</I>&gt;<i> Help would be appreciated.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i>    Peter
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="https://github.com/squid-cache/squid/commit/b4addc2262e5bee37543f8d1ab9dd98337bafba3">https://github.com/squid-cache/squid/commit/b4addc2262e5bee37543f8d1ab9dd98337bafba3</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027244.html">[squid-users] v6.12 build error from release tarball
</A></li>
	<LI>Next message (by thread): <A HREF="027246.html">[squid-users] v6.12 build error from release tarball
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27245">[ date ]</a>
              <a href="thread.html#27245">[ thread ]</a>
              <a href="subject.html#27245">[ subject ]</a>
              <a href="author.html#27245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
