<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] krb5.conf Example
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20krb5.conf%20Example&In-Reply-To=%3C22955e2edd8b4490ab270c9ef7464123%40hexcel.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027283.html">
   <LINK REL="Next"  HREF="027284.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] krb5.conf Example</H1>
    <B>Piana, Josh</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20krb5.conf%20Example&In-Reply-To=%3C22955e2edd8b4490ab270c9ef7464123%40hexcel.com%3E"
       TITLE="[squid-users] krb5.conf Example">Josh.Piana at hexcel.com
       </A><BR>
    <I>Wed Nov 27 14:45:40 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027283.html">[squid-users] krb5.conf Example
</A></li>
        <LI>Next message (by thread): <A HREF="027284.html">[squid-users] ACL dstdomain and use of -n
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27288">[ date ]</a>
              <a href="thread.html#27288">[ thread ]</a>
              <a href="subject.html#27288">[ subject ]</a>
              <a href="author.html#27288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marko, 

Thank you for the response. 

I've found there's an issue with the Kerberos setup even besides Squid, so that's probably why Squid cannot utilize the auth_param negotiate parameters I put in place, there's an issue with the back end. 

Thank you for taking the time to respond, I'm working with RedHat support to figure out the Kerberos issues now. PITA. 

Thanks,
Josh

-----Original Message-----
From: Marko Cupa&#263; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">marko.cupac at mimar.rs</A>&gt; 
Sent: Monday, November 25, 2024 11:36 AM
To: Piana, Josh &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Josh.Piana at hexcel.com</A>&gt;
Cc: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
Subject: Re: [squid-users] krb5.conf Example

Caution: This email originated from outside of Hexcel. Do not click links or open attachments unless you recognize the sender and know the content is safe.


On Thu, 21 Nov 2024 15:54:44 +0000
&quot;Piana, Josh&quot; &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Josh.Piana at hexcel.com</A>&gt; wrote:

&gt;<i> Hey  Squid Users,
</I>&gt;<i>
</I>&gt;<i> Wanted to reach out and see if there was an updated version of the 
</I>&gt;<i> /etc/krb5.conf example file anywhere.
</I>
Mine is as simple as:

[libdefaults]
  default_realm = EXAMPLE.ORG
  dns_lookup_realm = false
  dns_lookup_kdc = true

[domain_realm]
  .example.org = EXAMPLE.ORG

My FreeBSD 14.1 successfully obtains kerberos tickets from WS2019 AD with above config.


&gt;<i> As of right now, my krb5.conf file looks like this:
</I>&gt;<i>
</I>&gt;<i> includedir /etc/krb5.conf.d/
</I>&gt;<i> [logging]
</I>&gt;<i>     default = FILE:/var/log/krb5libs.log
</I>&gt;<i>     kdc = FILE:/var/log/krb5kdc.log
</I>&gt;<i>     admin_server = FILE:/var/log/kadmind.log
</I>&gt;<i>
</I>&gt;<i> [libdefaults]
</I>&gt;<i>     dns_lookup_realm = true
</I>&gt;<i>     ticket_lifetime = 24h
</I>&gt;<i>     renew_lifetime = 7d
</I>&gt;<i>     forwardable = true
</I>&gt;<i>     rdns = true
</I>&gt;<i>     pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt
</I>&gt;<i>     spake_preauth_groups = edwards25519
</I>&gt;<i>     dns_canonicalize_hostname = true
</I>&gt;<i>     qualify_shortname = &quot;&quot;
</I>&gt;<i>     default_realm = AD.ARC-TECH.COM
</I>&gt;<i>     default_ccache_name = KEYRING:persistent:%{uid}
</I>&gt;<i>     udp_preference_limit = 0
</I>&gt;<i>
</I>&gt;<i> [realms]
</I>&gt;<i> # EXAMPLE.COM = {
</I>&gt;<i> #     kdc = kerberos.example.com
</I>&gt;<i> #     admin_server = kerberos.example.com
</I>&gt;<i> # }
</I>&gt;<i>
</I>&gt;<i> [domain_realm]
</I>&gt;<i> # .example.com = EXAMPLE.COM
</I>&gt;<i> # example.com = EXAMPLE.COM
</I>&gt;<i>
</I>&gt;<i> This config file was done automatically when I joined the Linux Proxy 
</I>&gt;<i> Server to Windows AD using realmD. But I couldn't help but think 
</I>&gt;<i> there's a few things missing.
</I>
I would say you are missing at least commented records under [domain_realm]. Can't say if there's something under [libdefaults] which shouldn't be there (I never used most of the records you have there).


&gt;<i> I've been going through our whole Kerberos setup to figure out why 
</I>&gt;<i> Squid isn't using it when directed to in the squid.conf file.
</I>
Have you tested pure kerberos without squid first? Are you successfully getting tickets with kinit?

```
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">someuser at somesquid</A>:~ $ kinit domainuser
<A HREF="https://lists.squid-cache.org/listinfo/squid-users">domainuser at EXAMPLE.ORG</A>'s Password:

<A HREF="https://lists.squid-cache.org/listinfo/squid-users">someuser at somesquid</A>:~ $ klist
Credentials cache: FILE:/tmp/krb5cc_1001
        Principal: <A HREF="https://lists.squid-cache.org/listinfo/squid-users">domainuser at EXAMPLE.ORG</A>

  Issued                Expires               Principal
Nov 25 17:25:47 2024  Nov 26 03:25:47 2024  krbtgt/<A HREF="https://lists.squid-cache.org/listinfo/squid-users">EXAMPLE.ORG at EXAMPLE.ORG</A> ```

Best regards,
--
Before enlightenment - chop wood, draw water.
After  enlightenment - chop wood, draw water.

Marko Cupa&#263;
<A HREF="https://www.mimar.rs/">https://www.mimar.rs/</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027283.html">[squid-users] krb5.conf Example
</A></li>
	<LI>Next message (by thread): <A HREF="027284.html">[squid-users] ACL dstdomain and use of -n
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27288">[ date ]</a>
              <a href="thread.html#27288">[ thread ]</a>
              <a href="subject.html#27288">[ subject ]</a>
              <a href="author.html#27288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
