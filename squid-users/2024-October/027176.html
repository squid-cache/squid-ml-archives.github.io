<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid + c-icap + SquidClamav + ClamAV
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20c-icap%20%2B%20SquidClamav%20%2B%20ClamAV&In-Reply-To=%3C13f99390-2bfb-4d86-a319-684700b900b8%40netfence.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027175.html">
   <LINK REL="Next"  HREF="027177.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid + c-icap + SquidClamav + ClamAV</H1>
    <B>Andrea Venturoli</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20%2B%20c-icap%20%2B%20SquidClamav%20%2B%20ClamAV&In-Reply-To=%3C13f99390-2bfb-4d86-a319-684700b900b8%40netfence.it%3E"
       TITLE="[squid-users] Squid + c-icap + SquidClamav + ClamAV">ml at netfence.it
       </A><BR>
    <I>Thu Oct  3 15:10:52 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027175.html">[squid-users] Squid + ecap + clamav
</A></li>
        <LI>Next message (by thread): <A HREF="027177.html">[squid-users] Squid + c-icap + SquidClamav + ClamAV
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27176">[ date ]</a>
              <a href="thread.html#27176">[ thread ]</a>
              <a href="subject.html#27176">[ subject ]</a>
              <a href="author.html#27176">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello.

I've got several machines with the following software:
FreeBSD 13.3, 13.4 or 14.1
Squid 6.10
c-icap 0.5.12
SquidClamav 7.3
ClamA: 1.3.2

This combination usually works pretty well, but it occasionally chokes, 
with the client seeing:
&gt;<i> ICAP protocol error
</I>&gt;<i> The system returned: [No Error]
</I>
Out of 10 installations, 7 works perfecly (at least that I know), a 
couple very seldom have shown this error, but on one it's very frequent.



I checked the logs:
_ i think Squid's access log shows a NONE_NONE/500 code at the time of 
the error: I personally can't get anything useful from this, but maybe 
someone with better insight can tell?
_ cache.log does not seem to show anything related;
_ neither c-icap's, nor ClamAV's logs show anything useful.



I already applied the following patch:
<A HREF="https://github.com/measurement-factory/squid/commit/6567eac.patch">https://github.com/measurement-factory/squid/commit/6567eac.patch</A>

On one host that had always worked perfeclty, but suddenly had started 
giving this trouble several time per hours, it almost solved (i.e. I 
think the error was seen once in the latest few months).
However, it didn't help on the most problematic host.



Any idea on what to check or try? Any other known bug? Any way to get 
better logs?


  bye &amp; Thanks
	av.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027175.html">[squid-users] Squid + ecap + clamav
</A></li>
	<LI>Next message (by thread): <A HREF="027177.html">[squid-users] Squid + c-icap + SquidClamav + ClamAV
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27176">[ date ]</a>
              <a href="thread.html#27176">[ thread ]</a>
              <a href="subject.html#27176">[ subject ]</a>
              <a href="author.html#27176">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
