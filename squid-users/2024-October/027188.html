<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid 6.10 SSL-Bump Woes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%206.10%20SSL-Bump%20Woes&In-Reply-To=%3Cf994f59a-3a1a-4cb6-9e98-fb186109f879%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027191.html">
   <LINK REL="Next"  HREF="027192.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid 6.10 SSL-Bump Woes</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%206.10%20SSL-Bump%20Woes&In-Reply-To=%3Cf994f59a-3a1a-4cb6-9e98-fb186109f879%40treenet.co.nz%3E"
       TITLE="[squid-users] Squid 6.10 SSL-Bump Woes">squid3 at treenet.co.nz
       </A><BR>
    <I>Fri Oct 11 01:09:03 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027191.html">[squid-users] Squid 6.10 SSL-Bump Woes
</A></li>
        <LI>Next message (by thread): <A HREF="027192.html">[squid-users] Squid 6.10 SSL-Bump Woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27188">[ date ]</a>
              <a href="thread.html#27188">[ thread ]</a>
              <a href="subject.html#27188">[ subject ]</a>
              <a href="author.html#27188">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/10/24 11:08, Bryan Seitz wrote:
&gt;<i> I removed the header mods and changed the refresh pattern to:
</I>&gt;<i> 
</I>&gt;<i> refresh_pattern . &#160; &#160; &#160; &#160; &#160; &#160; &#160; 15 &#160; &#160; &#160;20% &#160; &#160; 1800 &#160; &#160;override-expire 
</I>&gt;<i> ignore-no-cache ignore-no-store ignore-private
</I>&gt;<i> 
</I>&gt;<i> And I always get TCP_MISS.&#160; Any other thoughts?
</I>
Ah, I believe it would be best to get a baseline of what Squid default 
behaviour is like in your environment. So we can identify what/how you 
need to improve it.


Firstly, FYI; this is what those controls **actually** do in current 
Squid ..

  * override-expires ... forces Squid to handle all responses to act as 
if they received &quot;Cache-Control: max-age=900&quot; (15 min) ... store, but 
revalidate 180+ seconds (20% of 15min) later.
   Result: Anything that could cache longer than 15min becomes a 
REFRESH_MISS or MISS, instead of HIT.
   Squid default: **do** cache. Revalidate
     * after(&quot;Date&quot;+&quot;CC: max-age=N&quot;) timestamp, otherwise
     * after &quot;Expires&quot; timestamp, otherwise
     * after (&quot;Date&quot; +1800 minutes) timestamp.

  * ignore-no-cache ... the standardized &quot;CC: no-cache&quot; is badly named, 
it tells Squid what **can** be cached.
   Result: Squid will discard many stored objects and perform a MISS 
instead.
   Squid default: **do** cache &quot;CC:private&quot; responses, revalidate on 
HIT. Log as REFRESH.

  * ignore-no-store ... force everything marked &quot;CC: no-store&quot; to be stored.
  Result: cache fills with non-reusable objects. Leaving not much room 
for actual HIT objects.
   Squid default: store only objects with can result in more HITs.

  * ignore-private ... force everything with &quot;CC: private&quot; to be discarded.
   Result: same as &quot;ignore-no-store&quot;.
   Squid default: **do** cache &quot;CC:private&quot; responses, revalidate on HIT.

Note that both HIT and REFRESH mean the object **was** cached.


You said that the access.log now contains MISS. Would that be just 
&quot;MISS&quot; or &quot;REFRESH&quot; + &quot;MISS&quot; (actually a HIT, but a new object was given 
by the server and replaced the pre-stored object).


Can you show a pair of request headers from the client, with matching 
response from the server?  You can use &quot;debug_options 11,2&quot; in recent 
Squid versions to get a cache.log trace of the HTTP transactions.

That might help us spot something more specific. The config change makes 
the earlier given ones obsolete.


HTH
Amos



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027191.html">[squid-users] Squid 6.10 SSL-Bump Woes
</A></li>
	<LI>Next message (by thread): <A HREF="027192.html">[squid-users] Squid 6.10 SSL-Bump Woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27188">[ date ]</a>
              <a href="thread.html#27188">[ thread ]</a>
              <a href="subject.html#27188">[ subject ]</a>
              <a href="author.html#27188">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
