<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid traffic paths
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20traffic%20paths&In-Reply-To=%3Ca610a320-a0fe-4123-9821-11c6782a5c0d%40measurement-factory.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027141.html">
   <LINK REL="Next"  HREF="027097.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid traffic paths</H1>
    <B>Alex Rousskov</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20traffic%20paths&In-Reply-To=%3Ca610a320-a0fe-4123-9821-11c6782a5c0d%40measurement-factory.com%3E"
       TITLE="[squid-users] Squid traffic paths">rousskov at measurement-factory.com
       </A><BR>
    <I>Mon Sep  2 21:57:03 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027141.html">[squid-users] Looking for a solution to identify &quot;unauthenticated&quot; squid proxy users.
</A></li>
        <LI>Next message (by thread): <A HREF="027097.html">[squid-users] negotiate_kerberos_auth not working anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27096">[ date ]</a>
              <a href="thread.html#27096">[ thread ]</a>
              <a href="subject.html#27096">[ subject ]</a>
              <a href="author.html#27096">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2024-08-31 15:00, Scott Bates wrote:
&gt;<i> The squid logs show traffic going to the expected destinations.
</I>
I assume that the above statement does _not_ talk about problematic 
traffic. In other words, Squid does handle some transactions, but not 
the problematic transactions you are asking about. I believe the above 
observation confirms part (a) of my working theory.


&gt;<i> If I look at wireshark on one of the client systems I do see some http 
</I>&gt;<i> entries&#160;going to those destinations&#160;through the squid server.
</I>
OK, for the purpose of this email thread, ignore traffic going through 
the Squid server.


&gt;<i> However 
</I>&gt;<i> most of the traffic (UDP / TCP) doesn't seem to be going through the 
</I>&gt;<i> squid server.
</I>
UDP: Squid does not proxy UDP-based protocols. If you want to proxy UDP, 
Squid is not the solution.

TCP: Squid can proxy HTTP/1 and FTP transactions (over TCP). Does that 
problematic TCP traffic in question contain HTTP or FTP transactions 
(i.e. originates from HTTP or FTP clients running on test VMs)? If not, 
then your existing &quot;HTTP proxy configuration&quot; on test VMs is probably 
not applicable -- the clients on those VMs probably ignore that HTTP 
proxy setting because they do not talk HTTP...


&gt;<i> I'm not sure how to force all traffic to use squid on the client system.
</I>
I do not know enough about Windows to help you with this Squid-unrelated 
configuration, but please note that since Squid cannot proxy traffic 
other than HTTP and FTP, you probably do not want to force traffic other 
than HTTP and FTP through Squid. In other words, Squid is not a 
&quot;universal&quot; proxy that can proxy everything.


HTH,

Alex.


&gt;<i> On 2024-08-28 09:14, Alex Rousskov wrote:
</I>&gt;&gt;<i> On 2024-08-28 08:52, Scott Bates wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Alex: What protocol do those external services use in problematic use 
</I>&gt;&gt;&gt;&gt;<i> cases?&gt;&gt; Does Squid see the corresponding requests from VMs?
</I>&gt;&gt;&gt;&gt;<i> Squid can only proxy HTTP and FTP...
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> http and https only
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Does Squid log the corresponding problematic transactions to its 
</I>&gt;&gt;<i> access.log?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> The weird thing is I have an android test phone that also goes through 
</I>&gt;&gt;&gt;<i> squid and that device shows the correct IP on the online services.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> My working theory is that (a) android test phone goes through Squid 
</I>&gt;&gt;<i> (i.e. uses Squid as an HTTP proxy) while (b) the problematic test 
</I>&gt;&gt;<i> traffic does not (i.e. goes directly to the external service).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The first guess can be confirmed using access.log (should be trivial in 
</I>&gt;&gt;<i> an isolated test environment). The second guess can be confirmed by 
</I>&gt;&gt;<i> packet capture analysis (may not be trivial in a virtualized environment 
</I>&gt;&gt;<i> and on Windows).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027141.html">[squid-users] Looking for a solution to identify &quot;unauthenticated&quot; squid proxy users.
</A></li>
	<LI>Next message (by thread): <A HREF="027097.html">[squid-users] negotiate_kerberos_auth not working anymore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27096">[ date ]</a>
              <a href="thread.html#27096">[ thread ]</a>
              <a href="subject.html#27096">[ subject ]</a>
              <a href="author.html#27096">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
