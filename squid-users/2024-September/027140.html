<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Squid appears to be ignoring url_rewrite_program
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20appears%20to%20be%20ignoring%20url_rewrite_program&In-Reply-To=%3Cc4059e461afcfa4d43796d144cc0601e%40hinterlands.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027143.html">
   <LINK REL="Next"  HREF="027142.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Squid appears to be ignoring url_rewrite_program</H1>
    <B>Martin A. Brooks</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Squid%20appears%20to%20be%20ignoring%20url_rewrite_program&In-Reply-To=%3Cc4059e461afcfa4d43796d144cc0601e%40hinterlands.org%3E"
       TITLE="[squid-users] Squid appears to be ignoring url_rewrite_program">martin at hinterlands.org
       </A><BR>
    <I>Tue Sep 17 12:39:42 UTC 2024</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027143.html">[squid-users] GET /squid-internal-dynamic/netdb requests to the parent proxy
</A></li>
        <LI>Next message (by thread): <A HREF="027142.html">[squid-users] Squid appears to be ignoring url_rewrite_program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27140">[ date ]</a>
              <a href="thread.html#27140">[ thread ]</a>
              <a href="subject.html#27140">[ subject ]</a>
              <a href="author.html#27140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello folks,

I am trying to use a URL rewriter program to redirect client requests 
for certain URLs elsewhere.  I found this on github which seems to do 
what I need:

<A HREF="https://github.com/rchunping/squid-urlrewrite">https://github.com/rchunping/squid-urlrewrite</A>

Running this on the command line as shown in the instructions appears to 
show it doing as I ask.

Although squid starts and spawns the rewrite program children as 
requested, it does appear to be sending requests to them.  A request for 
a URL which should be redirected is simply proxied as normal, rather 
than a redirect being returned.  It's as though squid is simply not 
using the rewriter program at all.

I'm using squid 5.7 as packaged by Debian, and my entire squid.conf is 
as follows:

------------------------
url_rewrite_program /etc/squid/squid-urlrewrite
url_rewrite_children 20 startup=10 idle=10 concurrency=10000
pinger_enable off

acl alb_subnets src 10.248.4.0/24
acl alb_subnets src 10.248.5.0/24
acl alb_subnets src 10.248.6.0/24

acl ssl_ports port 443
acl safe_ports port 80
acl safe_ports port 443

http_access deny !safe_ports
http_access deny CONNECT !ssl_ports

http_access allow localhost manager
http_access deny manager
http_access allow localhost
http_access allow alb_subnets

http_access deny all

http_port 3128

coredump_dir /var/spool/squid
-------------------------

Have I missed something to enable use of the rewriter?  Are there 
specific debug options I can use that will show me what squid is doing, 
if anything?


Regards

Martin.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027143.html">[squid-users] GET /squid-internal-dynamic/netdb requests to the parent proxy
</A></li>
	<LI>Next message (by thread): <A HREF="027142.html">[squid-users] Squid appears to be ignoring url_rewrite_program
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27140">[ date ]</a>
              <a href="thread.html#27140">[ thread ]</a>
              <a href="subject.html#27140">[ subject ]</a>
              <a href="author.html#27140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
