<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] cacheNumbObject unreasonably small with rock cache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cacheNumbObject%20unreasonably%20small%20with%20rock%20cache&In-Reply-To=%3CZ-1NcpbVJSlFyiYT%40cern.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027526.html">
   <LINK REL="Next"  HREF="027528.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] cacheNumbObject unreasonably small with rock cache</H1>
    <B>Dave Dykstra</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20cacheNumbObject%20unreasonably%20small%20with%20rock%20cache&In-Reply-To=%3CZ-1NcpbVJSlFyiYT%40cern.ch%3E"
       TITLE="[squid-users] cacheNumbObject unreasonably small with rock cache">dwd at cern.ch
       </A><BR>
    <I>Wed Apr  2 14:45:06 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027526.html">[squid-users] ssl_engine
</A></li>
        <LI>Next message (by thread): <A HREF="027528.html">[squid-users] cacheNumbObject unreasonably small with rock cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27527">[ date ]</a>
              <a href="thread.html#27527">[ thread ]</a>
              <a href="subject.html#27527">[ subject ]</a>
              <a href="author.html#27527">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We're trying rock cache for the first time, on squid 6.13.  The machine is quite large and heavily used, with 10 workers configured, 140G of shared memory cache, and 500G of rock cache configured.  However, the cacheNumObject SNMP counter is staying quite steadily at around only 570 even as the cache grows.  Currently du shows the rock file taking 40G, and the mgr:storedir statistics show 448k entries.

Does anyone have any ideas about this for us?

squid.conf is attached.

Dave
-------------- next part --------------
workers 10
acl NET_LOCAL src 0.0.0.0/32
acl CMS_FRONTIER dstdom_regex &lt;redacted&gt;
acl MAJOR_CVMFS dstdom_regex &lt;redacted&gt;
acl HOST_MONITOR src 127.0.0.1/32 &lt;redacted&gt;
acl snmppublic snmp_community public
acl localnet src 0.0.0.1-0.255.255.255	# RFC 1122 &quot;this&quot; network (LAN)
acl localnet src 10.0.0.0/8		# RFC 1918 local private network (LAN)
acl localnet src 100.64.0.0/10		# RFC 6598 shared address space (CGN)
acl localnet src 169.254.0.0/16 	# RFC 3927 link-local (directly plugged) machines
acl localnet src 172.16.0.0/12		# RFC 1918 local private network (LAN)
acl localnet src 192.168.0.0/16		# RFC 1918 local private network (LAN)
acl localnet src fc00::/7       	# RFC 4193 local private network range
acl localnet src fe80::/10      	# RFC 4291 link-local (directly plugged) machines
acl SSL_ports port 443
acl Safe_ports port 80		# http
acl Safe_ports port 21		# ftp
acl Safe_ports port 443		# https
acl Safe_ports port 70		# gopher
acl Safe_ports port 210		# wais
acl Safe_ports port 1025-65535	# unregistered ports
acl Safe_ports port 280		# http-mgmt
acl Safe_ports port 488		# gss-http
acl Safe_ports port 591		# filemaker
acl Safe_ports port 777		# multiling http
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access deny to_linklocal
acl URNPROTO proto URN
http_access deny URNPROTO
acl TEST_NODE dstdomain frontier1.cern.ch
http_access allow TEST_NODE
http_access allow CMS_FRONTIER
http_access allow MAJOR_CVMFS
acl TRACE method TRACE
http_access deny TRACE
http_access allow localhost
http_access deny all
http_port 3128
cache_mem 140 GB
maximum_object_size_in_memory 1 GB
memory_cache_shared on
maximum_object_size 1 GB
cache_dir rock /var/cache/squid 500000
logformat awstats %&gt;a %ui %un [%{%d/%b/%Y:%H:%M:%S}tl.%03tu %{%z}tl] &quot;%rm %ru HTTP/%rv&quot; %&gt;Hs %&lt;st %Ss:%Sh %tr &quot;%{X-Frontier-Id}&gt;h %{cvmfs-info}&gt;h&quot; &quot;%{Referer}&gt;h&quot; &quot;%{User-Agent}&gt;h&quot;
access_log daemon:/var/log/squid/access.log awstats
logfile_rotate 30
	logfile_rotate 0
mime_table /etc/squid/mime.conf
pid_filename /run/squid/${service_name}.pid
strip_query_terms off
cache_log /var/log/squid/cache.log
coredump_dir /var/cache/squid
url_rewrite_extras XXX
store_id_extras XXX
acl PragmaNoCache req_header Pragma no-cache
send_hit deny PragmaNoCache
refresh_pattern ^ftp:		1440	20%	10080
refresh_pattern -i (/cgi-bin/|\?) 0	0%	0
refresh_pattern .		0	20%	4320
quick_abort_min 0 KB
quick_abort_max 0 KB
negative_ttl 1 minute
minimum_expiry_time 0
request_header_access If-Modified-Since deny all
collapsed_forwarding on
cache_mgr squid
cache_effective_user dbfrontier
cache_effective_group users
umask 022
if ${process_number} = 1
snmp_port 3401
endif
snmp_access allow snmppublic HOST_MONITOR
snmp_access deny all
icon_directory /usr/share/squid/icons
cache_miss_revalidate off
uri_whitespace deny
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027526.html">[squid-users] ssl_engine
</A></li>
	<LI>Next message (by thread): <A HREF="027528.html">[squid-users] cacheNumbObject unreasonably small with rock cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27527">[ date ]</a>
              <a href="thread.html#27527">[ thread ]</a>
              <a href="subject.html#27527">[ subject ]</a>
              <a href="author.html#27527">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
