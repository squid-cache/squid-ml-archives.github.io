<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Thoughts on caching aspx jsp asp cgi-bin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Thoughts%20on%20caching%20aspx%20jsp%20asp%20cgi-bin&In-Reply-To=%3C6a5af98c-b4e7-4fba-adc5-6351aa7996bd%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027345.html">
   <LINK REL="Next"  HREF="027346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Thoughts on caching aspx jsp asp cgi-bin</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Thoughts%20on%20caching%20aspx%20jsp%20asp%20cgi-bin&In-Reply-To=%3C6a5af98c-b4e7-4fba-adc5-6351aa7996bd%40treenet.co.nz%3E"
       TITLE="[squid-users] Thoughts on caching aspx jsp asp cgi-bin">squid3 at treenet.co.nz
       </A><BR>
    <I>Wed Jan  1 16:06:27 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027345.html">[squid-users] Thoughts on caching aspx jsp asp cgi-bin
</A></li>
        <LI>Next message (by thread): <A HREF="027346.html">[squid-users] StoreID Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27348">[ date ]</a>
              <a href="thread.html#27348">[ thread ]</a>
              <a href="subject.html#27348">[ subject ]</a>
              <a href="author.html#27348">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/01/25 21:21, Robin Wood wrote:
&gt;<i> I'm going to massively over simplify things here, but you can think of 
</I>&gt;<i> it like this.
</I>&gt;<i> 
</I>&gt;<i> Files with html extensions are static web pages, you write them, put 
</I>&gt;<i> them on the server, and they are served as they are, no changes.
</I>&gt;<i> 
</I>&gt;<i> Asp and the others are dynamic files, they are processed by an app on 
</I>&gt;<i> the server before they are sent to the client. This app may do nothing, 
</I>&gt;<i> so the page comes as it was, but usually it will add content. This 
</I>&gt;<i> content could be to create a CMS page by pulling the page content from a 
</I>&gt;<i> database, it could be your shopping orders pulled from your account, or 
</I>&gt;<i> it could be your current bank statement.
</I>&gt;<i> 
</I>&gt;<i> Caching should never be done on anything that is specific to a single 
</I>&gt;<i> user, so it's fine to cache public CMS content with an asp extension, 
</I>&gt;<i> but not your bank statement.
</I>&gt;<i> 
</I>&gt;<i> There is more to it than that, but hopefully that gives you a general idea.
</I>&gt;<i> 
</I>

That is mostly correct for simple HTTP/1.0-like behaviour.

With HTTP/1.1 and later things are a little different. The biggest 
change is that URL no longer matters. The Content-Typereplaces &quot;fiel 
extension&quot; entirely, and Cache-Control headers take over the job of 
defining how and when something can be cached.

For Squid, the refresh_pattern directive is what provides compatibility 
with HTTP 1.0 behaviour. It provides values for any Cache-Control 
settings the server omitted (eg for servers acting like HTTP/1.0 still).

The default &quot;refresh_pattern -i (/cgi-bin/|\?) 0 0% 0&quot; configuration 
line tells Squid the values which will perform HTTP/1.0 caching 
behaviour for any of the dynamic content coming out of broken or old 
cgi-bin services or anythign with query-string ('?...') URL.


Jonathan: if you have not changed the refresh_pattern's you do not have 
to care specifically about dynamic-vs-static content caching. Whether it 
is plain-text HTTP(S) or SSL-Bump'ed HTTPS, it **should** all cache 
properly for its server-claimed needs.

Your &quot;cache deny&quot; policy in squid.conf is telling Squid **never** to 
cache any URL containing the ACL-matching strings. Even if they could be 
cached safely.


HTH
Amos



&gt;<i> Robin
</I>&gt;<i> 
</I>&gt;<i> On Tue, 31 Dec 2024, 23:07 Jonathan Lee wrote:
</I>&gt;<i> 
</I>&gt;<i>     Thanks I have to admit I am a student currently,
</I>&gt;<i> 
</I>&gt;<i>     I guess my last question is what do cgi-bin asp aspx asp files do
</I>&gt;<i>     inside of websites? The reason I ask this is the rule below I have
</I>&gt;<i>     seen the same rule on different websites so it must be the main ones
</I>&gt;<i>     that cause issues. Is it just for dynamic content?
</I>&gt;<i> 
</I>
...

&gt;&gt;&gt;<i>         acl QUERY urlpath_regex cgi-bin \? asp aspx jsp
</I>&gt;&gt;&gt;<i>
</I>
This rule applies based on a string-match of the URL. It does not matter 
whether the content is &quot;dynamic&quot; or not. Nor does it matter what the 
server indicates about caching of the response for any matched URL.


&gt;&gt;&gt;<i>         ## Prevent caching jsp, cgi-bin etc
</I>&gt;&gt;&gt;<i>         cache deny QUERY
</I>&gt;&gt;&gt;<i>
</I>


&gt;&gt;&gt;<i>         Ref:
</I>&gt;&gt;&gt;<i>         Setting up Explicit Squid Proxy &lt;<A HREF="https://">https://</A>
</I>&gt;&gt;&gt;<i>         wiki.alpinelinux.org/wiki/Setting_up_Explicit_Squid_Proxy&gt;
</I>&gt;&gt;&gt;<i>         wiki.alpinelinux.org&gt;
</I>&gt;&gt;&gt;<i>         	
</I>

Looking at that tutorial I see some major issues.

  1) the &quot;basic configuration&quot; is very different from the official 
squid.conf (see 
&lt;<A HREF="https://wiki.squid-cache.org/Releases/Squid-5#squid-5-default-config">https://wiki.squid-cache.org/Releases/Squid-5#squid-5-default-config</A>&gt;, 
same applies for v6)

  2) the SSL-Bump example configuration disables **all** security 
features of TLS and makes it extremely difficult to even detect 
hijacking of the proxy.
   Basically this is a tutorial of how to setup an open-proxy that 
allows malware to abuse your network as a base of operations.

While the official Squid wiki page on SSL-Bump peek and splice has not 
been updated in a while it is still **much** better to follow than this 
one. At least for that particular section of details.
  see &lt;<A HREF="https://wiki.squid-cache.org/Features/SslPeekAndSplice">https://wiki.squid-cache.org/Features/SslPeekAndSplice</A>&gt;

(I hope someone in the Alpine community can fix the above issues ASAP.)


Amos



&gt;&gt;&gt;<i>         &lt;favicon.png&gt;
</I>&gt;&gt;&gt;<i>          &lt;<A HREF="https://wiki.alpinelinux.org/wiki/">https://wiki.alpinelinux.org/wiki/</A>
</I>&gt;&gt;&gt;<i>         Setting_up_Explicit_Squid_Proxy&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>         &lt;<A HREF="https://wiki.alpinelinux.org/wiki/">https://wiki.alpinelinux.org/wiki/</A>
</I>&gt;&gt;&gt;<i>         Setting_up_Explicit_Squid_Proxy&gt;
</I>&gt;&gt;<i>         _______________________________________________
</I>&gt;&gt;<i>         squid-users mailing list
</I>&gt;&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A> &lt;mailto:squid-
</I>&gt;&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">users at lists.squid-cache.org</A>&gt;
</I>&gt;&gt;<i>         <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A> &lt;<A HREF="https://">https://</A>
</I>&gt;&gt;<i>         lists.squid-cache.org/listinfo/squid-users&gt;
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> squid-users mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027345.html">[squid-users] Thoughts on caching aspx jsp asp cgi-bin
</A></li>
	<LI>Next message (by thread): <A HREF="027346.html">[squid-users] StoreID Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27348">[ date ]</a>
              <a href="thread.html#27348">[ thread ]</a>
              <a href="subject.html#27348">[ subject ]</a>
              <a href="author.html#27348">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
