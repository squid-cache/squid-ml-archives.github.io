<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Assistance with Kerberos Authentication and AD Group-Based ACLs in Squid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Assistance%20with%20Kerberos%20Authentication%20and%20AD%0A%20Group-Based%20ACLs%20in%20Squid&In-Reply-To=%3CPAWPR03MB90100328A3D366D242D6CFEEF4142%40PAWPR03MB9010.eurprd03.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027350.html">
   <LINK REL="Next"  HREF="027353.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Assistance with Kerberos Authentication and AD Group-Based ACLs in Squid</H1>
    <B>Enfal Gok</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Assistance%20with%20Kerberos%20Authentication%20and%20AD%0A%20Group-Based%20ACLs%20in%20Squid&In-Reply-To=%3CPAWPR03MB90100328A3D366D242D6CFEEF4142%40PAWPR03MB9010.eurprd03.prod.outlook.com%3E"
       TITLE="[squid-users] Assistance with Kerberos Authentication and AD Group-Based ACLs in Squid">enfal.gok2004 at gmail.com
       </A><BR>
    <I>Thu Jan  2 11:35:58 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027350.html">[squid-users] Assistance Needed for Kerberos Authentication with AD Group-Based ACLs in Squid
</A></li>
        <LI>Next message (by thread): <A HREF="027353.html">[squid-users] pipeline_prefetch directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27351">[ date ]</a>
              <a href="thread.html#27351">[ thread ]</a>
              <a href="subject.html#27351">[ subject ]</a>
              <a href="author.html#27351">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Squid Support Team,
I am currently configuring Squid with Kerberos authentication and would like to integrate Active Directory (AD) group-based access control. My Kerberos authentication is working, and I can access AD successfully from my Ubuntu server. Below is my current Squid configuration:

# Kerberos authentication
auth_param negotiate program /usr/lib/squid/negotiate_kerberos_auth
auth_param negotiate children 10
auth_param negotiate keep_alive on

# ACL's
acl kerberos-auth proxy_auth REQUIRED
http_access allow kerberos-auth

# General access
http_access allow localhost
http_access deny all

# Proxy settings
http_port 3128
cache_dir ufs /var/spool/squid 100 16 256
coredump_dir /var/spool/squid


What Works:

  1.  Kerberos authentication is successfully validating users, and authenticated requests are being allowed through the proxy.
  2.  My Ubuntu server is connected to AD, and I can query AD successfully using ldapsearch.

What I Need Assistance With:
I want to integrate AD group-based ACLs to control user access based on their group membership in Active Directory. Specifically:

  1.  Restrict access for users in certain groups (e.g., Blocked group).
  2.  Allow limited or filtered access for users in other groups (e.g., Restricted or Filtered groups).
  3.  Provide full internet access for users in a FullAccess group.

Questions:

  1.  What is the best way to combine Kerberos authentication with AD group-based access control in Squid?
  2.  Should I use the external_acl_type helper with LDAP queries, or is there a better way, such as leveraging note ACLs and group annotations from the Kerberos helper?
  3.  Are there specific configuration examples or optimizations you recommend to achieve this setup?

Additional Information:

  *   I am new to configuring Squid and AD integration and have very little experience with these systems. If possible, I would greatly appreciate clear and beginner-friendly guidance.
  *   I have tested ldapsearch and confirmed that I can retrieve user attributes, including memberof, from AD.
  *   Despite extensive searching online, I couldn&#8217;t find a complete configuration example for integrating Kerberos authentication and AD group-based ACLs. If such an example exists, could you share it or guide me in creating one?

Thank you in advance for your assistance. Please let me know if additional details or logs are needed.
Best regards,

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20250102/8f5a4b50/attachment.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20250102/8f5a4b50/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027350.html">[squid-users] Assistance Needed for Kerberos Authentication with AD Group-Based ACLs in Squid
</A></li>
	<LI>Next message (by thread): <A HREF="027353.html">[squid-users] pipeline_prefetch directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27351">[ date ]</a>
              <a href="thread.html#27351">[ thread ]</a>
              <a href="subject.html#27351">[ subject ]</a>
              <a href="author.html#27351">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
