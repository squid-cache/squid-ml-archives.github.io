<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] Using and trusting remote client IP address via upstream proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20and%20trusting%20remote%20client%20IP%20address%20via%0A%20upstream%20proxy&In-Reply-To=%3C92790744-2cce-4015-b965-3983d33e94a4%40borrill.org.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027371.html">
   <LINK REL="Next"  HREF="027373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] Using and trusting remote client IP address via upstream proxy</H1>
    <B>Stephen Borrill</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20Using%20and%20trusting%20remote%20client%20IP%20address%20via%0A%20upstream%20proxy&In-Reply-To=%3C92790744-2cce-4015-b965-3983d33e94a4%40borrill.org.uk%3E"
       TITLE="[squid-users] Using and trusting remote client IP address via upstream proxy">squid at borrill.org.uk
       </A><BR>
    <I>Thu Jan  9 09:03:18 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027371.html">[squid-users] Using and trusting remote client IP address via upstream proxy
</A></li>
        <LI>Next message (by thread): <A HREF="027373.html">[squid-users] Using and trusting remote client IP address via upstream proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27372">[ date ]</a>
              <a href="thread.html#27372">[ thread ]</a>
              <a href="subject.html#27372">[ subject ]</a>
              <a href="author.html#27372">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08/01/2025 23:33, Orion Poplawski wrote:
&gt;<i> We use e2guardian and squid in a combined method were requests can either go
</I>&gt;<i> to e2guardian first and get forwarded to squid, or go directly to squid.
</I>&gt;<i> 
</I>&gt;<i> I would like to be able to have squid allow connections for certain remote
</I>&gt;<i> client IPs without requiring authentication.  However, the connections that
</I>&gt;<i> come in through e2guardian appear to squid as coming from localhost.  Is there
</I>&gt;<i> a way that e2guardian could pass the IP address of the client on to squid?
</I>
You don't say how you select between e2guardian and direct to squid.
You could use e2guardian in ICAP mode, so that all clients go to squid 
first and then use acls to choose which requests go via e2guardian.

You could also try adding forwardedfor = yes in e2guardian.conf along 
with follow_x_forwarded_for in your squid configuration.

-- 
Stephen

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027371.html">[squid-users] Using and trusting remote client IP address via upstream proxy
</A></li>
	<LI>Next message (by thread): <A HREF="027373.html">[squid-users] Using and trusting remote client IP address via upstream proxy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27372">[ date ]</a>
              <a href="thread.html#27372">[ thread ]</a>
              <a href="subject.html#27372">[ subject ]</a>
              <a href="author.html#27372">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
