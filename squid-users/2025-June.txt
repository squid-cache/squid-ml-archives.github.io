From clement.paulet at universite-paris-saclay.fr  Thu Jun  5 16:37:27 2025
From: clement.paulet at universite-paris-saclay.fr (=?iso-8859-1?Q?Cl=E9ment_Paulet?=)
Date: Thu, 5 Jun 2025 16:37:27 +0000
Subject: [squid-users] [SQUID] Last version for RHEL ?
Message-ID: <MR1P264MB4099B7A112861BF2331201A4EB6FA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>

Hi,

Has anyone successfully compiled the latest stable version of Squid on RHEL 9 without any issues?
If so, do you have any documentation?

We're stuck with this OS due to compatibility issues with other tools..

Thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250605/e26b6e3b/attachment.htm>

From lister at rac.unix-admins.com  Thu Jun  5 19:35:19 2025
From: lister at rac.unix-admins.com (Goetz T. Fischer)
Date: Thu, 5 Jun 2025 21:35:19 +0200
Subject: [squid-users] [SQUID] Last version for RHEL ?
In-Reply-To: <MR1P264MB4099B7A112861BF2331201A4EB6FA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
References: <MR1P264MB4099B7A112861BF2331201A4EB6FA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
Message-ID: <20250605213519278682.6757f5ad@rac.unix-admins.com>

On Thu, 5 Jun 2025 16:37:27 +0000, Cl?ment Paulet wrote:
> Has anyone successfully compiled the latest stable version of Squid on RHEL 9 without any issues?

what errors did you get?

From clement.paulet at universite-paris-saclay.fr  Fri Jun  6 09:36:38 2025
From: clement.paulet at universite-paris-saclay.fr (=?iso-8859-1?Q?Cl=E9ment_Paulet?=)
Date: Fri, 6 Jun 2025 09:36:38 +0000
Subject: [squid-users] [SQUID] Last version for RHEL ?
In-Reply-To: <20250605213519278682.6757f5ad@rac.unix-admins.com>
References: <MR1P264MB4099B7A112861BF2331201A4EB6FA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
 <20250605213519278682.6757f5ad@rac.unix-admins.com>
Message-ID: <MR1P264MB4099E8F78CB3FB55BA46FEC5EB6EA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>

Hi,

Install went fine now sorry.
6.13 is installed, but it seems the vulnerability https://joshua.hu/squid-security-audit-35-0days-45-exploits are still present in this version.

How have you addressed this issue?

Ty

________________________________
De : squid-users <squid-users-bounces at lists.squid-cache.org> de la part de Goetz T. Fischer <lister at rac.unix-admins.com>
Envoy? : jeudi 5 juin 2025 21:35
? : squid-users at lists.squid-cache.org <squid-users at lists.squid-cache.org>
Objet : Re: [squid-users] [SQUID] Last version for RHEL ?

[Vous ne recevez pas souvent de courriers de lister at rac.unix-admins.com. D?couvrez pourquoi ceci est important ? https://aka.ms/LearnAboutSenderIdentification ]

On Thu, 5 Jun 2025 16:37:27 +0000, Cl?ment Paulet wrote:
> Has anyone successfully compiled the latest stable version of Squid on RHEL 9 without any issues?

what errors did you get?
_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
https://lists.squid-cache.org/listinfo/squid-users
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250606/8e5ac6dd/attachment-0001.htm>

From squid3 at treenet.co.nz  Sun Jun  8 07:15:44 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Sun, 8 Jun 2025 19:15:44 +1200
Subject: [squid-users] [SQUID] Last version for RHEL ?
In-Reply-To: <MR1P264MB4099E8F78CB3FB55BA46FEC5EB6EA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
References: <MR1P264MB4099B7A112861BF2331201A4EB6FA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
 <20250605213519278682.6757f5ad@rac.unix-admins.com>
 <MR1P264MB4099E8F78CB3FB55BA46FEC5EB6EA@MR1P264MB4099.FRAP264.PROD.OUTLOOK.COM>
Message-ID: <5d662a00-f0d2-43ee-92c8-7fd22755fee8@treenet.co.nz>

On 6/06/25 21:36, Cl?ment Paulet wrote:
> Hi,
> 
> Install went fine now sorry.
> 6.13 is installed, but it seems the vulnerability https://joshua.hu/ 
> squid-security-audit-35-0days-45-exploits are still present in this version.
> 
> How have you addressed this issue?

FYI, the above is **not** a single issue. The document covers over 50 
different CVEs in a range of Squid features.
* Many are fixed in Squid release prior to v6.13.
* Some are fixed in Squid v7.
* Some still awaiting formal fixes.

It depends on which of the issues still open in v6 series affect you 
particularly as to what you, the builder of Squid, need to do to avoid 
them. see the particular CVE documents for details.


Cheers
Amos


From wong237ma at yahoo.com  Fri Jun 13 08:08:12 2025
From: wong237ma at yahoo.com (wong237ma at yahoo.com)
Date: Fri, 13 Jun 2025 08:08:12 +0000 (UTC)
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
Message-ID: <2072256482.50777.1749802092237@mail.yahoo.com>

Hi,

I had successfully setup squid-openssl (6.10) in Ubuntu 24.04.02 LTS, staging and production. I refer to this squid wiki: https://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory. I had setup Squid-cache authenticate against Activi Directory via kerberos. For proxy user access to staging, windows users (joined AD) no issue on authentication. I test users authenticate seemlessly without any prompt.

Our office user around 600. when I turn on production proxy. At morning 9am, when user number hit around 100, no issue raise. when user number hit around 250++, windows users, the browser start to prompt user login, even domain credential are correct, but seem not work, after that user cannot surf any website.

How to troubleshoot this issue?

I use squidclient to monitor external_acl, negotiateauthenticator, ntlmauthenticator, basicauthenticator, so far no requests timedout.

I also monitor cache.log with filtering "FATAL:|WARNING:|squidaio_queue_request:|SECURITY ALERT:" didn't find any specifc error.

Can help to identify, wonder user still got domain login prompt from, e.g. internet browser, like chrome, edge or firefox, outlook and microsoft teams, etc.

Appciate any help.

Thanks.

attach my squid.conf:
=======================================
## negotiate kerberos and ntlm authentication
auth_param negotiate program /usr/lib/squid/negotiate_wrapper_auth -d --ntlm /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5-ntlmssp --domain=MYCOMPANY --kerberos /usr/lib/squid/negotiate_kerberos_auth -d -s GSS_C_NO_NAME
auth_param negotiate children 3000 startup=500 idle=200
auth_param negotiate keep_alive on
authenticate_ttl 15 minutes

## pure ntlm authentication
auth_param ntlm program /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5-ntlmssp --domain=MYCOMPANY
auth_param ntlm children 500 startup=50 idle=10
auth_param ntlm keep_alive off

### provide basic authentication via ldap for clients not authenticated via kerberos/ntlm
auth_param basic program /usr/lib/squid/basic_ldap_auth -R -b "dc=mycompany,dc=com" -D squidproxyuser at mycompany.com -W /etc/squid/ldappass.txt -f sAMAccountName=%s -h mycompanydc.mycompany.com
auth_param basic children 500 startup=50 idle=10
auth_param basic realm Internet Proxy
auth_param basic credentialsttl 1 minute

#external_acl_type hebadgroup %LOGIN /usr/lib/squid/ext_wbinfo_group_acl
external_acl_type hebadgroup children-max=1000? children-startup=50 children-idle=10 ttl=900 negative_ttl=900 %LOGIN /usr/lib/squid/ext_wbinfo_group_acl

http_port 3128 ssl-bump generate-host-certificates=on dynamic_cert_mem_cache_size=20MB tls-cert=/etc/squid/cert/squid.crt tls-key=/etc/squid/cert/ca.key
sslcrtd_program /usr/lib/squid/security_file_certgen -s /var/lib/squid/ssl_db -M 20MB
sslcrtd_children 50

acl localnet src 0.0.0.1-0.255.255.255? # RFC 1122 "this" network (LAN)
acl localnet src 10.0.0.0/8? ? ? ? ? ? ?# RFC 1918 local private network (LAN)
acl localnet src 100.64.0.0/10? ? ? ? ? # RFC 6598 shared address space (CGN)
acl localnet src 169.254.0.0/16? ? ? ? ?# RFC 3927 link-local (directly plugged) machines
acl localnet src 172.16.0.0/12? ? ? ? ? # RFC 1918 local private network (LAN)
acl localnet src 192.168.0.0/16? ? ? ? ?# RFC 1918 local private network (LAN)
acl localnet src fc00::/7? ? ? ? ? ? ? ?# RFC 4193 local private network range
acl localnet src fe80::/10? ? ? ? ? ? ? # RFC 4291 link-local (directly plugged) machines

acl SSL_ports port 443
acl Safe_ports port 80? ? ? ? ? # http
acl Safe_ports port 21? ? ? ? ? # ftp
acl Safe_ports port 443? ? ? ? ?# https
acl Safe_ports port 70? ? ? ? ? # gopher
acl Safe_ports port 210? ? ? ? ?# wais
acl Safe_ports port 1025-65535? # unregistered ports
acl Safe_ports port 280? ? ? ? ?# http-mgmt
acl Safe_ports port 488? ? ? ? ?# gss-http
acl Safe_ports port 591? ? ? ? ?# filemaker
acl Safe_ports port 777? ? ? ? ?# multiling http

acl direct_access dstdomain openshiftapps.com
cache deny direct_access

acl urlwhatsapp dstdomain .whatsapp.com
acl grpwhatsapp external adgroup sq_whatsapp
acl grpgithub external adgroup SSLVPN-GitHub-CoPilot


# Enable Proxy Authentication
acl aduser proxy_auth REQUIRED

# Domains for SSL Bump
acl url_sslbump dstdomain .github.com

# Define SSL Bump steps
acl step1 at_step SslBump1
acl step2 at_step SslBump2
acl step3 at_step SslBump3

# SSL Bump rules for specific traffic
ssl_bump peek step1 all
ssl_bump bump step2 url_sslbump
ssl_bump splice all? ? ? ? ? ? ? ? ? ? ?# Splice (do not bump) all other traffic
sslproxy_cert_error allow url_sslbump


#http_access deny !Safe_ports
#http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access allow localhost
http_access deny to_localhost
http_access deny to_linklocal
include /etc/squid/conf.d/*.conf

# Access control for GitHub Copilot Group
include /etc/squid/github.conf

http_access allow urlwhatsapp grpwhatsapp
http_access deny urlwhatsapp

http_access allow aduser
http_access deny all

coredump_dir /var/spool/squid
# AV updates
refresh_pattern -i \.symantecliveupdate\.com\/.*\.(zip|7z|irn|[m|x][0-9][0-9])? ?360? 50%? ?360? reload-into-ims
refresh_pattern ^ftp:? ? ? ? ? ?1440? ? 20%? ? ?10080
refresh_pattern -i (/cgi-bin/|\?) 0? ? ?0%? ? ? 0
refresh_pattern \/(Packages|Sources)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims
refresh_pattern \/Release(|\.gpg)$ 0 0% 0 refresh-ims
refresh_pattern \/InRelease$ 0 0% 0 refresh-ims
refresh_pattern \/(Translation-.*)(|\.bz2|\.gz|\.xz)$ 0 0% 0 refresh-ims
refresh_pattern .? ? ? ? ? ? ? ?0? ? ? ?20%? ? ?4320

max_filedescriptors 65535
cache_mem 4096 MB
=======================================
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250613/9a241428/attachment.htm>

From squid3 at treenet.co.nz  Fri Jun 13 10:09:35 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 13 Jun 2025 22:09:35 +1200
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
In-Reply-To: <2072256482.50777.1749802092237@mail.yahoo.com>
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
 <2072256482.50777.1749802092237@mail.yahoo.com>
Message-ID: <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>

On 13/06/25 20:08, wong237ma wrote:
> Hi,
> 
> I had successfully setup squid-openssl (6.10) in Ubuntu 24.04.02 LTS, 
> staging and production. I refer to this squid wiki: https://wiki.squid- 
> cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory. I had 
> setup Squid-cache authenticate against Activi Directory via kerberos. 
> For proxy user access to staging, windows users (joined AD) no issue on 
> authentication. I test users authenticate seemlessly without any prompt.
> 
> Our office user around 600. when I turn on production proxy. At morning 
> 9am, when user number hit around 100, no issue raise. when user number 
> hit around 250++, windows users, the browser start to prompt user login,

FTR; the login prompt is not coming from Squid. The client Browser 
decides where to get credentials from - the popup is one source, current 
machine login another, there may be sources as well.

Most often in situations like this, the ActiveDirectory or network 
cannot cope with the number of concurrent credential verification Squid 
is needing to perform.

Alternatively it may just be the clients Browser(s) deciding that login 
has failed and giving up before authentication completes - when the high 
load makes verification slow.


> even domain credential are correct, but seem not work, after that user 
> cannot surf any website.

There will be a timeouts controlling this.

Since you are SSL-Bump'ing traffic - whatever result the initial CONNECT 
request credentials were given when the TLS began will be used until 
that TLS connection closes.

Secondly the auth helper "negative-ttl=900" (from config below) value 
will make Squid only check for different results on new connections 
started 900+ seconds after the first one was rejected.



> 
> How to troubleshoot this issue?
> 
> I use squidclient to monitor external_acl, negotiateauthenticator, 
> ntlmauthenticator, basicauthenticator, so far no requests timedout.
> 
> I also monitor cache.log with filtering "FATAL:|WARNING:| 
> squidaio_queue_request:|SECURITY ALERT:" didn't find any specifc error.
> 

You are unlikely to find anything in the Squid logs. Unless one of the 
auth helpers is having issues with its access to your ActiveDirectory 
server.


> Can help to identify, wonder user still got domain login prompt from, 
> e.g. internet browser, like chrome, edge or firefox, outlook and 
> microsoft teams, etc.
> 
> Appciate any help.
> 
> Thanks.
> 
> attach my squid.conf:
> =======================================
> ## negotiate kerberos and ntlm authentication
> auth_param negotiate program /usr/lib/squid/negotiate_wrapper_auth -d -- 
> ntlm /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5- 
> ntlmssp --domain=MYCOMPANY --kerberos /usr/lib/squid/ 
> negotiate_kerberos_auth -d -s GSS_C_NO_NAME
> auth_param negotiate children 3000 startup=500 idle=200
> auth_param negotiate keep_alive on
> authenticate_ttl 15 minutes
> 
> ## pure ntlm authentication
> auth_param ntlm program /usr/bin/ntlm_auth --diagnostics --helper- 
> protocol=squid-2.5-ntlmssp --domain=MYCOMPANY
> auth_param ntlm children 500 startup=50 idle=10
> auth_param ntlm keep_alive off
> 

Do you still actually **need** NTLM ?
It has been deprecated for 19 years already, and Windows software has 
progressively been removing the ability to use it.

You may be able to get some metrics out of ActiveDirectory, or the 
server it runs on to measure how many logins are NTLM vs Kerberos.



> ### provide basic authentication via ldap for clients not authenticated 
> via kerberos/ntlm
> auth_param basic program /usr/lib/squid/basic_ldap_auth -R -b 
> "dc=mycompany,dc=com" -D squidproxyuser at mycompany.com -W /etc/squid/ 
> ldappass.txt -f sAMAccountName=%s -h mycompanydc.mycompany.com
> auth_param basic children 500 startup=50 idle=10
> auth_param basic realm Internet Proxy
> auth_param basic credentialsttl 1 minute
> 
> #external_acl_type hebadgroup %LOGIN /usr/lib/squid/ext_wbinfo_group_acl
> external_acl_type hebadgroup children-max=1000? children-startup=50 
> children-idle=10 ttl=900 negative_ttl=900 %LOGIN /usr/lib/squid/ 
> ext_wbinfo_group_acl
> 

The Kerberos auth helper bundled with Squid delivers "group=" 
annotations back to Squid that can be quickly checked instead of using 
extra helper lookups.

Find the SSID in ActiveDirectory for the group (eg "sq_whatsapp") and 
replace your:

  acl grpwhatsapp external ...

with this (where "SSID" is the string from ActiveDirectory):
   acl grpwhatsapp note group SSID

same for the other groups this helper is used for.


> http_port 3128 ssl-bump generate-host-certificates=on 
> dynamic_cert_mem_cache_size=20MB tls-cert=/etc/squid/cert/squid.crt tls- 
> key=/etc/squid/cert/ca.key
> sslcrtd_program /usr/lib/squid/security_file_certgen -s /var/lib/squid/ 
> ssl_db -M 20MB
> sslcrtd_children 50
> 
> acl localnet src 0.0.0.1-0.255.255.255? # RFC 1122 "this" network (LAN)
> acl localnet src 10.0.0.0/8? ? ? ? ? ? ?# RFC 1918 local private network 
> (LAN)
> acl localnet src 100.64.0.0/10? ? ? ? ? # RFC 6598 shared address space 
> (CGN)
> acl localnet src 169.254.0.0/16? ? ? ? ?# RFC 3927 link-local (directly 
> plugged) machines
> acl localnet src 172.16.0.0/12? ? ? ? ? # RFC 1918 local private network 
> (LAN)
> acl localnet src 192.168.0.0/16? ? ? ? ?# RFC 1918 local private network 
> (LAN)
> acl localnet src fc00::/7? ? ? ? ? ? ? ?# RFC 4193 local private network 
> range
> acl localnet src fe80::/10? ? ? ? ? ? ? # RFC 4291 link-local (directly 
> plugged) machines
> 
> acl SSL_ports port 443
> acl Safe_ports port 80? ? ? ? ? # http
> acl Safe_ports port 21? ? ? ? ? # ftp
> acl Safe_ports port 443? ? ? ? ?# https
> acl Safe_ports port 70? ? ? ? ? # gopher
> acl Safe_ports port 210? ? ? ? ?# wais
> acl Safe_ports port 1025-65535? # unregistered ports
> acl Safe_ports port 280? ? ? ? ?# http-mgmt
> acl Safe_ports port 488? ? ? ? ?# gss-http
> acl Safe_ports port 591? ? ? ? ?# filemaker
> acl Safe_ports port 777? ? ? ? ?# multiling http
> 
> acl direct_access dstdomain openshiftapps.com
> cache deny direct_access

Hmm. calling that ACL "direct_access" implies that whoever designed it 
thinks the "cache" directive has something to do with accessing things.
It does not.

The above two config lines prevent Squid from _storing_ any traffic when 
the domain is exactly the string "openshiftapps.com" (emphasis on the 
exact part, "www.openshiftapps.com" and similar will **not** match that 
ACL definition). So nothing from there should be able to produce HIT or 
REFRESH type responses.



> 
> acl urlwhatsapp dstdomain .whatsapp.com
> acl grpwhatsapp external adgroup sq_whatsapp
> acl grpgithub external adgroup SSLVPN-GitHub-CoPilot
> 
> 
> # Enable Proxy Authentication
> acl aduser proxy_auth REQUIRED
> 
> # Domains for SSL Bump
> acl url_sslbump dstdomain .github.com
> 
> # Define SSL Bump steps
> acl step1 at_step SslBump1
> acl step2 at_step SslBump2
> acl step3 at_step SslBump3
> 
> # SSL Bump rules for specific traffic
> ssl_bump peek step1 all
> ssl_bump bump step2 url_sslbump
> ssl_bump splice all? ? ? ? ? ? ? ? ? ? ?# Splice (do not bump) all other 
> traffic
> sslproxy_cert_error allow url_sslbump
> 
> 
> #http_access deny !Safe_ports
> #http_access deny CONNECT !SSL_ports
> http_access allow localhost manager
> http_access deny manager
> http_access allow localhost
> http_access deny to_localhost
> http_access deny to_linklocal
> include /etc/squid/conf.d/*.conf
> 
> # Access control for GitHub Copilot Group
> include /etc/squid/github.conf
> 

FYI, notice that Squid is automatically including all the config files 
in the directory /etc/squid/conf.d/

You should only need to drop the file github.conf into that directory 
and not include it here.


> http_access allow urlwhatsapp grpwhatsapp
> http_access deny urlwhatsapp
> 
> http_access allow aduser
 > http_access deny all
 >

Login should happen before any of the ACLs that check group memberships 
or other auth related things.

When done that way it should look something like this:

   # require credentials to both exist and be valid
   acl login proxy_auth REQUIRED
   http_access deny !login

   # ACLs that use login credentials or login related details
   http_access allow group_A somewhere
   http_access deny group_B
   ...

   # maybe allow any LAN clients not denied above.
   http_access allow localnet

   http_access deny all


HTH
Amos


From wong237ma at yahoo.com  Mon Jun 16 04:25:35 2025
From: wong237ma at yahoo.com (wong237ma at yahoo.com)
Date: Mon, 16 Jun 2025 04:25:35 +0000 (UTC)
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
In-Reply-To: <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
 <2072256482.50777.1749802092237@mail.yahoo.com>
 <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>
Message-ID: <1512835743.441693.1750047935683@mail.yahoo.com>

 Hi Amos,

Thank for your replied.?

> FTR; the login prompt is not coming from Squid. The client Browser
> decides where to get credentials from - the popup is one source, current
> machine login another, there may be sources as well.

Our laptop is joined domain. I thought browser will use AD ticket TGT, (which I can view by klist)? not like this?

> Since you are SSL-Bump'ing traffic - whatever result the initial CONNECT
> request credentials were given when the TLS began will be used until
> that TLS connection closes.

I configure Bumping github website only, the rest of the traffic not decrypt.

> Secondly the auth helper "negative-ttl=900" (from config below) value
> will make Squid only check for different results on new connections
> started 900+ seconds after the first one was rejected.

squid-cache by default is one hour, so I think I configure 15 mins, which less compare to one hour, not sure whether correct or not.

> Do you still actually **need** NTLM ?
> It has been deprecated for 19 years already, and Windows software has
> progressively been removing the ability to use it.

Yes, we are using Kerberos, NTLM and basic are for those legacy application, I think.

> The Kerberos auth helper bundled with Squid delivers "group="
> annotations back to Squid that can be quickly checked instead of using
> extra helper lookups.

you mean i can use this helper: ext_kerberos_ldap_group_acl, am I right? I will try out, since ChatGPT also mention auth faster compare to ext_wbinfo_group_acl.

Question: Is this main problem?

> FYI, notice that Squid is automatically including all the config files
> in the directory /etc/squid/conf.d/

yes, it is just a easier manage for me.

I have go through your replied several times and I try to digest.?
My main problem here is that when user hit around 200++, user will prompt out proxy login dialog box ask user to login.

Is there anyway to find out issues??

Thanks.

    On Friday, June 13, 2025 at 06:09:49 PM GMT+8, Amos Jeffries <squid3 at treenet.co.nz> wrote:  
 
 On 13/06/25 20:08, wong237ma wrote:
> Hi,
> 
> I had successfully setup squid-openssl (6.10) in Ubuntu 24.04.02 LTS, 
> staging and production. I refer to this squid wiki: https://wiki.squid- 
> cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory. I had 
> setup Squid-cache authenticate against Activi Directory via kerberos. 
> For proxy user access to staging, windows users (joined AD) no issue on 
> authentication. I test users authenticate seemlessly without any prompt.
> 
> Our office user around 600. when I turn on production proxy. At morning 
> 9am, when user number hit around 100, no issue raise. when user number 
> hit around 250++, windows users, the browser start to prompt user login,

FTR; the login prompt is not coming from Squid. The client Browser 
decides where to get credentials from - the popup is one source, current 
machine login another, there may be sources as well.

Most often in situations like this, the ActiveDirectory or network 
cannot cope with the number of concurrent credential verification Squid 
is needing to perform.

Alternatively it may just be the clients Browser(s) deciding that login 
has failed and giving up before authentication completes - when the high 
load makes verification slow.


> even domain credential are correct, but seem not work, after that user 
> cannot surf any website.

There will be a timeouts controlling this.

Since you are SSL-Bump'ing traffic - whatever result the initial CONNECT 
request credentials were given when the TLS began will be used until 
that TLS connection closes.

Secondly the auth helper "negative-ttl=900" (from config below) value 
will make Squid only check for different results on new connections 
started 900+ seconds after the first one was rejected.



> 
> How to troubleshoot this issue?
> 
> I use squidclient to monitor external_acl, negotiateauthenticator, 
> ntlmauthenticator, basicauthenticator, so far no requests timedout.
> 
> I also monitor cache.log with filtering "FATAL:|WARNING:| 
> squidaio_queue_request:|SECURITY ALERT:" didn't find any specifc error.
> 

You are unlikely to find anything in the Squid logs. Unless one of the 
auth helpers is having issues with its access to your ActiveDirectory 
server.


> Can help to identify, wonder user still got domain login prompt from, 
> e.g. internet browser, like chrome, edge or firefox, outlook and 
> microsoft teams, etc.
> 
> Appciate any help.
> 
> Thanks.
> 
> attach my squid.conf:
> =======================================
> ## negotiate kerberos and ntlm authentication
> auth_param negotiate program /usr/lib/squid/negotiate_wrapper_auth -d -- 
> ntlm /usr/bin/ntlm_auth --diagnostics --helper-protocol=squid-2.5- 
> ntlmssp --domain=MYCOMPANY --kerberos /usr/lib/squid/ 
> negotiate_kerberos_auth -d -s GSS_C_NO_NAME
> auth_param negotiate children 3000 startup=500 idle=200
> auth_param negotiate keep_alive on
> authenticate_ttl 15 minutes
> 
> ## pure ntlm authentication
> auth_param ntlm program /usr/bin/ntlm_auth --diagnostics --helper- 
> protocol=squid-2.5-ntlmssp --domain=MYCOMPANY
> auth_param ntlm children 500 startup=50 idle=10
> auth_param ntlm keep_alive off
> 

Do you still actually **need** NTLM ?
It has been deprecated for 19 years already, and Windows software has 
progressively been removing the ability to use it.

You may be able to get some metrics out of ActiveDirectory, or the 
server it runs on to measure how many logins are NTLM vs Kerberos.



> ### provide basic authentication via ldap for clients not authenticated 
> via kerberos/ntlm
> auth_param basic program /usr/lib/squid/basic_ldap_auth -R -b 
> "dc=mycompany,dc=com" -D squidproxyuser at mycompany.com -W /etc/squid/ 
> ldappass.txt -f sAMAccountName=%s -h mycompanydc.mycompany.com
> auth_param basic children 500 startup=50 idle=10
> auth_param basic realm Internet Proxy
> auth_param basic credentialsttl 1 minute
> 
> #external_acl_type hebadgroup %LOGIN /usr/lib/squid/ext_wbinfo_group_acl
> external_acl_type hebadgroup children-max=1000? children-startup=50 
> children-idle=10 ttl=900 negative_ttl=900 %LOGIN /usr/lib/squid/ 
> ext_wbinfo_group_acl
> 

The Kerberos auth helper bundled with Squid delivers "group=" 
annotations back to Squid that can be quickly checked instead of using 
extra helper lookups.

Find the SSID in ActiveDirectory for the group (eg "sq_whatsapp") and 
replace your:

? acl grpwhatsapp external ...

with this (where "SSID" is the string from ActiveDirectory):
? acl grpwhatsapp note group SSID

same for the other groups this helper is used for.


> http_port 3128 ssl-bump generate-host-certificates=on 
> dynamic_cert_mem_cache_size=20MB tls-cert=/etc/squid/cert/squid.crt tls- 
> key=/etc/squid/cert/ca.key
> sslcrtd_program /usr/lib/squid/security_file_certgen -s /var/lib/squid/ 
> ssl_db -M 20MB
> sslcrtd_children 50
> 
> acl localnet src 0.0.0.1-0.255.255.255? # RFC 1122 "this" network (LAN)
> acl localnet src 10.0.0.0/8? ? ? ? ? ? ?# RFC 1918 local private network 
> (LAN)
> acl localnet src 100.64.0.0/10? ? ? ? ? # RFC 6598 shared address space 
> (CGN)
> acl localnet src 169.254.0.0/16? ? ? ? ?# RFC 3927 link-local (directly 
> plugged) machines
> acl localnet src 172.16.0.0/12? ? ? ? ? # RFC 1918 local private network 
> (LAN)
> acl localnet src 192.168.0.0/16? ? ? ? ?# RFC 1918 local private network 
> (LAN)
> acl localnet src fc00::/7? ? ? ? ? ? ? ?# RFC 4193 local private network 
> range
> acl localnet src fe80::/10? ? ? ? ? ? ? # RFC 4291 link-local (directly 
> plugged) machines
> 
> acl SSL_ports port 443
> acl Safe_ports port 80? ? ? ? ? # http
> acl Safe_ports port 21? ? ? ? ? # ftp
> acl Safe_ports port 443? ? ? ? ?# https
> acl Safe_ports port 70? ? ? ? ? # gopher
> acl Safe_ports port 210? ? ? ? ?# wais
> acl Safe_ports port 1025-65535? # unregistered ports
> acl Safe_ports port 280? ? ? ? ?# http-mgmt
> acl Safe_ports port 488? ? ? ? ?# gss-http
> acl Safe_ports port 591? ? ? ? ?# filemaker
> acl Safe_ports port 777? ? ? ? ?# multiling http
> 
> acl direct_access dstdomain openshiftapps.com
> cache deny direct_access

Hmm. calling that ACL "direct_access" implies that whoever designed it 
thinks the "cache" directive has something to do with accessing things.
It does not.

The above two config lines prevent Squid from _storing_ any traffic when 
the domain is exactly the string "openshiftapps.com" (emphasis on the 
exact part, "www.openshiftapps.com" and similar will **not** match that 
ACL definition). So nothing from there should be able to produce HIT or 
REFRESH type responses.



> 
> acl urlwhatsapp dstdomain .whatsapp.com
> acl grpwhatsapp external adgroup sq_whatsapp
> acl grpgithub external adgroup SSLVPN-GitHub-CoPilot
> 
> 
> # Enable Proxy Authentication
> acl aduser proxy_auth REQUIRED
> 
> # Domains for SSL Bump
> acl url_sslbump dstdomain .github.com
> 
> # Define SSL Bump steps
> acl step1 at_step SslBump1
> acl step2 at_step SslBump2
> acl step3 at_step SslBump3
> 
> # SSL Bump rules for specific traffic
> ssl_bump peek step1 all
> ssl_bump bump step2 url_sslbump
> ssl_bump splice all? ? ? ? ? ? ? ? ? ? ?# Splice (do not bump) all other 
> traffic
> sslproxy_cert_error allow url_sslbump
> 
> 
> #http_access deny !Safe_ports
> #http_access deny CONNECT !SSL_ports
> http_access allow localhost manager
> http_access deny manager
> http_access allow localhost
> http_access deny to_localhost
> http_access deny to_linklocal
> include /etc/squid/conf.d/*.conf
> 
> # Access control for GitHub Copilot Group
> include /etc/squid/github.conf
> 

FYI, notice that Squid is automatically including all the config files 
in the directory /etc/squid/conf.d/

You should only need to drop the file github.conf into that directory 
and not include it here.


> http_access allow urlwhatsapp grpwhatsapp
> http_access deny urlwhatsapp
> 
> http_access allow aduser
 > http_access deny all
 >

Login should happen before any of the ACLs that check group memberships 
or other auth related things.

When done that way it should look something like this:

? # require credentials to both exist and be valid
? acl login proxy_auth REQUIRED
? http_access deny !login

? # ACLs that use login credentials or login related details
? http_access allow group_A somewhere
? http_access deny group_B
? ...

? # maybe allow any LAN clients not denied above.
? http_access allow localnet

? http_access deny all


HTH
Amos

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
https://lists.squid-cache.org/listinfo/squid-users
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250616/8acb5df5/attachment-0001.htm>

From squid3 at treenet.co.nz  Mon Jun 16 19:41:46 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Tue, 17 Jun 2025 07:41:46 +1200
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
In-Reply-To: <1512835743.441693.1750047935683@mail.yahoo.com>
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
 <2072256482.50777.1749802092237@mail.yahoo.com>
 <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>
 <1512835743.441693.1750047935683@mail.yahoo.com>
Message-ID: <a1076844-1c2e-4479-80ad-2a13d997f6a2@treenet.co.nz>

On 16/06/25 16:25, wong237ma wrote:
> Hi Amos,
> 
> Thank for your replied.
> 
>  > FTR; the login prompt is not coming from Squid. The client Browser
>  > decides where to get credentials from - the popup is one source, current
>  > machine login another, there may be sources as well.
> 
> Our laptop is joined domain. I thought browser will use AD ticket TGT, 
> (which I can view by klist)? not like this?
> 
>  > Since you are SSL-Bump'ing traffic - whatever result the initial CONNECT
>  > request credentials were given when the TLS began will be used until
>  > that TLS connection closes.
> 
> I configure Bumping github website only, the rest of the traffic not 
> decrypt.
> 
>  > Secondly the auth helper "negative-ttl=900" (from config below) value
>  > will make Squid only check for different results on new connections
>  > started 900+ seconds after the first one was rejected.
> 
> squid-cache by default is one hour, so I think I configure 15 mins, 
> which less compare to one hour, not sure whether correct or not.
> 
>  > Do you still actually **need** NTLM ?
>  > It has been deprecated for 19 years already, and Windows software has
>  > progressively been removing the ability to use it.
> 
> Yes, we are using Kerberos, NTLM and basic are for those legacy 
> application, I think.

Nod. Just pointing out that its something to check if actually needed. 
Removal will help avoid problems - if possible.


> 
>  > The Kerberos auth helper bundled with Squid delivers "group="
>  > annotations back to Squid that can be quickly checked instead of using
>  > extra helper lookups.
> 
> you mean i can use this helper: ext_kerberos_ldap_group_acl, am I right? 

No, I literally mean the auth_param helper (negotiate_kerberos_auth) is 
producing "group=" values that can be checked with 'note' type ACL 
instead of 'external' type ACL .

That will halve the amount of helpers running, reduce Squid memory needs 
by whatever those helpers were using, halve the load on ActiveDirectory, 
and halve the transaction time for access to the proxy.
IF any of those things were contributing to your problem (likely) then 
you should see the problem move from 200-ish up to something higher.


> I will try out, since ChatGPT also mention auth faster compare to 
> ext_wbinfo_group_acl.
> 
> Question: Is this main problem?
> 
>  > FYI, notice that Squid is automatically including all the config files
>  > in the directory /etc/squid/conf.d/
> 
> yes, it is just a easier manage for me.
> 
> I have go through your replied several times and I try to digest.
> My main problem here is that when user hit around 200++, user will 
> prompt out proxy login dialog box ask user to login.
> 
> Is there anyway to find out issues?


You mentioned nothing occuring in the Squid logs. So that easy way is 
closed.

The alternative is to watch;

  a) how much memory is being used by Squid and helpers to see if the 
problem is running out of resources,

  b) traffic to find out what types of credentials are being sent to 
Squid and not being accepted (rejection may be the trigger for dialog 
boxes),

  c) check logs on your ActiveDirectory for similar things and also to 
see if there is a limit being reached there.


HTH
Amos


From wong237ma at yahoo.com  Tue Jun 17 10:21:17 2025
From: wong237ma at yahoo.com (wong237ma at yahoo.com)
Date: Tue, 17 Jun 2025 10:21:17 +0000 (UTC)
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
In-Reply-To: <a1076844-1c2e-4479-80ad-2a13d997f6a2@treenet.co.nz>
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
 <2072256482.50777.1749802092237@mail.yahoo.com>
 <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>
 <1512835743.441693.1750047935683@mail.yahoo.com>
 <a1076844-1c2e-4479-80ad-2a13d997f6a2@treenet.co.nz>
Message-ID: <1683469084.717849.1750155677332@mail.yahoo.com>

 Hi Amos,
can help to give configure example for external helper?ext_kerberos_ldap_group_acl, since this help is faster compare to?ext_wbinfo_group_acl.
Thank you.
    On Tuesday, June 17, 2025 at 03:41:58 AM GMT+8, Amos Jeffries <squid3 at treenet.co.nz> wrote:  
 
 On 16/06/25 16:25, wong237ma wrote:
> Hi Amos,
> 
> Thank for your replied.
> 
>? > FTR; the login prompt is not coming from Squid. The client Browser
>? > decides where to get credentials from - the popup is one source, current
>? > machine login another, there may be sources as well.
> 
> Our laptop is joined domain. I thought browser will use AD ticket TGT, 
> (which I can view by klist)? not like this?
> 
>? > Since you are SSL-Bump'ing traffic - whatever result the initial CONNECT
>? > request credentials were given when the TLS began will be used until
>? > that TLS connection closes.
> 
> I configure Bumping github website only, the rest of the traffic not 
> decrypt.
> 
>? > Secondly the auth helper "negative-ttl=900" (from config below) value
>? > will make Squid only check for different results on new connections
>? > started 900+ seconds after the first one was rejected.
> 
> squid-cache by default is one hour, so I think I configure 15 mins, 
> which less compare to one hour, not sure whether correct or not.
> 
>? > Do you still actually **need** NTLM ?
>? > It has been deprecated for 19 years already, and Windows software has
>? > progressively been removing the ability to use it.
> 
> Yes, we are using Kerberos, NTLM and basic are for those legacy 
> application, I think.

Nod. Just pointing out that its something to check if actually needed. 
Removal will help avoid problems - if possible.


> 
>? > The Kerberos auth helper bundled with Squid delivers "group="
>? > annotations back to Squid that can be quickly checked instead of using
>? > extra helper lookups.
> 
> you mean i can use this helper: ext_kerberos_ldap_group_acl, am I right? 

No, I literally mean the auth_param helper (negotiate_kerberos_auth) is 
producing "group=" values that can be checked with 'note' type ACL 
instead of 'external' type ACL .

That will halve the amount of helpers running, reduce Squid memory needs 
by whatever those helpers were using, halve the load on ActiveDirectory, 
and halve the transaction time for access to the proxy.
IF any of those things were contributing to your problem (likely) then 
you should see the problem move from 200-ish up to something higher.


> I will try out, since ChatGPT also mention auth faster compare to 
> ext_wbinfo_group_acl.
> 
> Question: Is this main problem?
> 
>? > FYI, notice that Squid is automatically including all the config files
>? > in the directory /etc/squid/conf.d/
> 
> yes, it is just a easier manage for me.
> 
> I have go through your replied several times and I try to digest.
> My main problem here is that when user hit around 200++, user will 
> prompt out proxy login dialog box ask user to login.
> 
> Is there anyway to find out issues?


You mentioned nothing occuring in the Squid logs. So that easy way is 
closed.

The alternative is to watch;

? a) how much memory is being used by Squid and helpers to see if the 
problem is running out of resources,

? b) traffic to find out what types of credentials are being sent to 
Squid and not being accepted (rejection may be the trigger for dialog 
boxes),

? c) check logs on your ActiveDirectory for similar things and also to 
see if there is a limit being reached there.


HTH
Amos

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
https://lists.squid-cache.org/listinfo/squid-users
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250617/3f803789/attachment.htm>

From Mark.Cairney at ed.ac.uk  Wed Jun 18 08:49:49 2025
From: Mark.Cairney at ed.ac.uk (Mark Cairney)
Date: Wed, 18 Jun 2025 09:49:49 +0100
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
 CNAMEs/Round-robin DNS
Message-ID: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>

Hi,

I?ve been trying to get Kerberos Authentication against AD working but 
have been seeing inconsistent results/behaviour across multiple Oses and 
I?m not sure if the issue lies with the DNS configuration, Kerberos 
itself or with the Squid config:

THE DNS setup is as follows:

test.squid.cluster. 3600 IN?????????? CNAME??????????????? 
test-squid-cluster.dyn-zone.

test-squid-cluster.dyn-zone. 60 IN A 1.2.3.4

Where 1.2.3.4 is the IP of one of the servers in the cluster. The 
intention is to have multiple Squid servers behind a single DNS name for 
high-availability.

This is what I?m seeing in the cache log with my current setup:

Windows:

negotiate_kerberos_auth.cc(182): pid=668789 :2025/06/16 16:03:01| 
negotiate_kerb

eros_auth: ERROR: gss_accept_sec_context() failed: Unspecified GSS 
failure.? Min

or code may provide more information. Cannot find key for HTTP/ 
test-squid-cluster.dyn-zone at REALM kvno 2 in keytab (request ticket 
server HTTP/test.squid.cluster at REALM

Rocky Linux:

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x "test.squid.cluster:3128" https://www.bbc.co.uk

negotiate_kerberos_auth.cc(182): pid=668789 :2025/06/17 08:51:52| 
negotiate_kerb

eros_auth: ERROR: gss_accept_sec_context() failed: Unspecified GSS 
failure.? Min

2025/06/17 08:51:52| negotiate_kerberos_auth: INFO: User not authenticated

2025/06/17 08:51:52.964 kid1| ERROR: Negotiate Authentication validating 
user. R

esult: {result=BH, notes={message: gss_accept_sec_context() failed: 
Unspecified

er HTTP/server1@ <mailto:HTTP/marmalade.cache.ed.ac.uk at ED.AC.UK>REALM); }}

klist -e

Ticket cache: FILE:/tmp/krb5cc_138460_vF4BWcMsZu

Default principal: ext6033 at ED.AC.UK

17/06/25 08:51:44? 17/06/25 18:51:24 krbtgt/REALM at REALM

 ??????? Etype (skey, tkt): aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96

17/06/25 08:51:52? 17/06/25 18:51:24 HTTP/server@

 ??????? Etype (skey, tkt): aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96

 ??????? Ticket server: server/REALM at REALM

With the same behaviour if I use the Dynamic Zone record in the curl 
command i.e.

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x " test-squid-cluster.dyn-zone:3128" https://www.bbc.co.uk

Ubuntu 24.04

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x "test.squid.cluster:3128" "https://www.bbc.co.uk" works


negotiate_kerberos_auth.cc(815): pid=668789 :2025/06/18 09:11:17| 
negotiate_kerberos_auth: DEBUG: OK 
token=oYG3MIG0oAMKAQChCwYJKoZIhvcSAQICooGfBIGcYIGZBgkqhkiG9xIBAgICAG+BiTCBhqADAgEFoQMCAQ+iejB4oAMCARKicQRvJ1BxA5rnZjKbfBVE0YqUlnYx7oLguj09HLH4SJRumUjWWXh99B/4X72vpFqCXeOKmvzSDlWG0Io1ZjQxNOxqni4sFx8exojIzg4aIWKAcYB21OHr9m0T9dfymDVoV61Cofyq38fUaN5Loen9YX0h 
user=account
2025/06/18 09:11:17| negotiate_kerberos_auth: INFO: User account 
authenticated


klist -e
Ticket cache: FILE:/tmp/krb5cc_1001_7KsHEg
Default principal: account at REALM

Valid starting???? Expires??????????? Service principal
06/18/25 09:10:09? 06/18/25 19:10:09? krbtgt/REALM at REALM
 ??? renew until 06/19/25 09:09:36, Etype (skey, tkt): 
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96
06/18/25 09:11:17? 06/18/25 19:10:09 HTTP/test-squid-cluster.dyn-zone@
 ??? renew until 06/19/25 09:09:36, Etype (skey, tkt): 
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96


curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x "test-squid-cluster.dyn-zone:3128" 
"https://www.bbc.co.uk"


Works as well

klist -e
Ticket cache: FILE:/tmp/krb5cc_1001_7KsHEg
Default principal: account at REALM

Valid starting???? Expires??????????? Service principal
06/18/25 09:17:11? 06/18/25 19:17:11? krbtgt/REAM at REALM
 ??? renew until 06/19/25 09:16:55, Etype (skey, tkt): 
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96
06/18/25 09:17:38? 06/18/25 19:17:11 HTTP/test-squid-cluster.dyn-zone@
 ??? renew until 06/19/25 09:16:55, Etype (skey, tkt): 
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96
 ??? Ticket server: HTTP/test-exams-cache.www-dyn.ed.ac.uk at ED.AC.UK


Mac (Sequoia 15.5)

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x "test.squid.cluster.dyn-zone:3128" https://www.bbc.co.uk

2025/06/17 09:32:26| negotiate_kerberos_auth: INFO: User not authenticated

2025/06/17 09:32:26.600 kid1| ERROR: Negotiate Authentication validating 
user. R

esult: {result=BH, notes={message: gss_accept_sec_context() failed: 
Unspecified

GSS failure.? Minor code may provide more information. Cannot find key 
for HTTP/

test-squid-cluster.dyn-zone at REALM kvno 2 in keytab (request ticket serv

er HTTP/test.squid.cluster at REALM); }}

klist -v

Server: HTTP/test.squid.cluster at REALM

Client: account at REALM

Ticket etype: aes256-cts-hmac-sha1-96, kvno 2

Ticket length: 1690

Auth time:? Jun 17 09:32:17 2025

Start time: Jun 17 09:32:26 2025

End time:?? Jun 17 19:31:56 2025

Ticket flags: enc-pa-rep, pre-authent, forwardable

Addresses: addressless

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c 
~/cookiejar.txt -x "test-squid-cluster.dyn.zone:3128" https://www.bbc.co.uk

Successful:

2025/06/17 09:36:38| negotiate_kerberos_auth: INFO: User account 
authenticated

2025/06/17 09:36:38.165 kid1| 82,2| external_acl.cc(700) 
aclMatchExternal: ldap_group = ALLOWED

Klist -v

Server: krbtgt/REALM@ <mailto:krbtgt/ED.AC.UK at ED.AC.UK>REALM

Client: account at REALM

Ticket etype: aes256-cts-hmac-sha1-96, kvno 11

Ticket length: 1683

Auth time:? Jun 17 09:36:31 2025

End time:?? Jun 17 19:36:23 2025

Ticket flags: enc-pa-rep, pre-authent, initial, forwardable

Addresses: addressless

Server: HTTP/test-squid-cluster.dyn.zone at REALM

Client: account@ <mailto:ext6033 at ED.AC.UK>REALM

Ticket etype: aes256-cts-hmac-sha1-96, kvno 1

Ticket length: 1698

Auth time:? Jun 17 09:36:31 2025

Start time: Jun 17 09:36:38 2025

End time:?? Jun 17 19:36:23 2025

Ticket flags: enc-pa-rep, pre-authent, forwardable

Addresses: addressless

The relevant parts of the squid.conf are:

http_port 3128

cache_mem 256 mb

maximum_object_size_in_memory 512 KB

maximum_object_size 2048 mb

cache_dir ufs /var/spool/squid 51200 16 256

debug_options ALL,2

visible_hostname test-squid-cluster.dyn.zone

unique_hostname server1

refresh_pattern .???????????? 0?????? 20% 4320 ignore-reload

auth_param basic children 10

auth_param negotiate program /usr/lib64/squid/negotiate_kerberos_auth -k 
/etc/squid/HTTP.keytab -s HTTP/test-squid-cluster.dyn.zone at REALM -d -i -r

(We also have LDAP basic auth configured as a fallback which works as 
expected but modern Windows clients no longer support basic auth for 
proxy servers).

klist -k /etc/squid/HTTP.keytab

Keytab name: FILE:/etc/squid/HTTP.keytab

KVNO Principal

---- 
--------------------------------------------------------------------------

 ?? 1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK>REALM

 ?? 1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK>REALM

 ?? 1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK>REALM

 ?? 1 HTTP/test-squid-cache.dyn.zone at REALM

 ?? 1 HTTP/test-squid-cache.dyn.zone at REALM

 ?? 1 HTTP/test-squid-cache.dyn.zone at REALM

/etc/hosts

1.2.3.4 server1.cache server1 test-squid-cache.dyn.zone test.squid.cluster

Finally the keytab was generated using msktutil e.g.

msktutil -c -h test-squid-cache.dyn.zone -b 
'OU=Managed-Linux,OU=Infrastructure' --computer-name TESTSQUIDCACHE -s 
HTTP/test-squid-cache.dyn.zone -k /etc/squid/HTTP.keytab --server 
domain.controller --realm REALM --use-service-account 
--dont-expire-password --upn HTTP/test-squid-cache.dyn.zone at REALM

This works fairly well/reliably if we use a keytab containing the 
HTTP/fqdn of the server itself i.e. HTTP/server1 AND connect using curl 
using the FQDN of server1 but we need resiliency and high-availability 
so having a single-host service would be a last resort.

Any ideas on where I?m going wrong or what I need to add in terms of 
DNS/keytab entries? Also some of the clients attempt to use key versions 
which have never been issued e.g. kvno 4?

Kind regards,

Mark

--
/****************************

Mark Cairney
ITI Enterprise Services
Information Services
University of Edinburgh

Tel: 0131 650 6565
Email: _Mark.Cairney at ed.ac.uk_

*******************************/

The University of Edinburgh is a charitable body, registered in 
Scotland, with registration number SC005336.signature_2526785256
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250618/52049dec/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 263 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250618/52049dec/attachment-0001.png>

From yves.martin at elca.ch  Wed Jun 18 09:46:50 2025
From: yves.martin at elca.ch (Yves MARTIN)
Date: Wed, 18 Jun 2025 09:46:50 +0000
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
 CNAMEs/Round-robin DNS
In-Reply-To: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
References: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
Message-ID: <GVAP278MB00058CCFF1BD9BFF63A33047EE72A@GVAP278MB0005.CHEP278.PROD.OUTLOOK.COM>

Hello,

 

Kerberos is complex and is also sensitive to clock shift between systems.

 

Here according to error message, it sounds like the KVNO number is no longer
aligned between your keys in keytab and your AD service account holding the
SPN - probably because of a password change or any other attribute change on
account which have increased KVNO number.

 

I would recommend to generate again the keytab for this Service Principal
Name with ktpass and try again.

Or if it happens "often" without obvious explanation, to generate ktpass
with option "-kvno 0" even if considered as less secure, or else only for
non-productive environments.

 

Best regards,

Yves

 

From: squid-users <squid-users-bounces at lists.squid-cache.org> On Behalf Of
Mark Cairney
Sent: Wednesday, June 18, 2025 10:50 AM
To: squid-users at lists.squid-cache.org
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
CNAMEs/Round-robin DNS

 

	
You don't often get email from mark.cairney at ed.ac.uk
<mailto:mark.cairney at ed.ac.uk> . Learn why this is important
<https://aka.ms/LearnAboutSenderIdentification>  

	

Hi,

I've been trying to get Kerberos Authentication against AD working but have
been seeing inconsistent results/behaviour across multiple Oses and I'm not
sure if the issue lies with the DNS configuration, Kerberos itself or with
the Squid config:

 

THE DNS setup is as follows:

 

test.squid.cluster. 3600              IN           CNAME
test-squid-cluster.dyn-zone.

test-squid-cluster.dyn-zone. 60 IN A     1.2.3.4

 

Where 1.2.3.4 is the IP of one of the servers in the cluster. The intention
is to have multiple Squid servers behind a single DNS name for
high-availability.

 

This is what I'm seeing in the cache log with my current setup:

 

Windows:

negotiate_kerberos_auth.cc(182): pid=668789 :2025/06/16 16:03:01|
negotiate_kerb

eros_auth: ERROR: gss_accept_sec_context() failed: Unspecified GSS failure.
Min

or code may provide more information. Cannot find key for HTTP/
test-squid-cluster.dyn-zone at REALM <mailto:test-squid-cluster.dyn-zone at REALM>
kvno 2 in keytab (request ticket server HTTP/test.squid.cluster at REALM
<mailto:HTTP/test.squid.cluster at REALM> 

 

Rocky Linux:

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest.squid
.cluster%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa8
9908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583372651545
78%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiO
iJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=8t7J%2Fli
BDzhFu%2BkhZP2tDQc9iLXyV5bj63APcwUI0Lw%3D&reserved=0>
"test.squid.cluster:3128" https://www.bbc.co.uk
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265198150%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=VupN2iP6EHWQDoTuoOw4
v9JEA7L4YT86xCRaSa3x%2FeY%3D&reserved=0> 

 

negotiate_kerberos_auth.cc(182): pid=668789 :2025/06/17 08:51:52|
negotiate_kerb

eros_auth: ERROR: gss_accept_sec_context() failed: Unspecified GSS failure.
Min

2025/06/17 08:51:52| negotiate_kerberos_auth: INFO: User not authenticated

2025/06/17 08:51:52.964 kid1| ERROR: Negotiate Authentication validating
user. R

esult: {result=BH, notes={message: gss_accept_sec_context() failed:
Unspecified

er HTTP/server1@ <mailto:HTTP/marmalade.cache.ed.ac.uk at ED.AC.UK> REALM); }}

 

klist -e

Ticket cache: FILE:/tmp/krb5cc_138460_vF4BWcMsZu
<FILE://tmp/krb5cc_138460_vF4BWcMsZu> 

Default principal: ext6033 at ED.AC.UK <mailto:ext6033 at ED.AC.UK> 

17/06/25 08:51:44  17/06/25 18:51:24  krbtgt/REALM at REALM

        Etype (skey, tkt): aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96

17/06/25 08:51:52  17/06/25 18:51:24  HTTP/server@

        Etype (skey, tkt): aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96

        Ticket server: server/REALM at REALM

 

With the same behaviour if I use the Dynamic Zone record in the curl command
i.e.

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest-squid
-cluster.dyn-zone%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac
5354d8fa89908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583
37265226269%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAw
MCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=
etUDUnCBFgx7PkYmz458VECv0SM7k%2FmIUMTdsiwLmAQ%3D&reserved=0> "
test-squid-cluster.dyn-zone:3128" https://www.bbc.co.uk
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265245027%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=Jgbdey0AavIx9HWJt2lv
tMJMxy9ecnYNzFlHH3SXPAY%3D&reserved=0> 

 

Ubuntu 24.04

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest.squid
.cluster%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa8
9908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583372652615
73%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiO
iJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=4QUQnouTb
GtClgVAFVq2oLuxnXQnyPGS6wk0BLe0MWU%3D&reserved=0> "test.squid.cluster:3128"
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265279188%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=Du%2BSPdi0fT7Bd0Fnh4
roqultifdzqZ4u8QFskPJAGI8%3D&reserved=0> "https://www.bbc.co.uk" works





negotiate_kerberos_auth.cc(815): pid=668789 :2025/06/18 09:11:17|
negotiate_kerberos_auth: DEBUG: OK
token=oYG3MIG0oAMKAQChCwYJKoZIhvcSAQICooGfBIGcYIGZBgkqhkiG9xIBAgICAG+BiTCBhq
ADAgEFoQMCAQ+iejB4oAMCARKicQRvJ1BxA5rnZjKbfBVE0YqUlnYx7oLguj09HLH4SJRumUjWWX
h99B/4X72vpFqCXeOKmvzSDlWG0Io1ZjQxNOxqni4sFx8exojIzg4aIWKAcYB21OHr9m0T9dfymD
VoV61Cofyq38fUaN5Loen9YX0h user=account
2025/06/18 09:11:17| negotiate_kerberos_auth: INFO: User account
authenticated







klist -e
Ticket cache: FILE:/tmp/krb5cc_1001_7KsHEg <FILE://tmp/krb5cc_1001_7KsHEg> 
Default principal: account at REALM

Valid starting     Expires            Service principal
06/18/25 09:10:09  06/18/25 19:10:09  krbtgt/REALM at REALM
    renew until 06/19/25 09:09:36, Etype (skey, tkt):
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96 
06/18/25 09:11:17  06/18/25 19:10:09  HTTP/test-squid-cluster.dyn-zone@
<mailto:HTTP/test-squid-cluster.dyn-zone@> 
    renew until 06/19/25 09:09:36, Etype (skey, tkt):
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96 







curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest-squid
-cluster.dyn-zone%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac
5354d8fa89908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583
37265295759%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAw
MCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=
NK1qTf5sVX8CRq2iuPZFDlirTfakmjAMhGPtz1Xc69I%3D&reserved=0>
"test-squid-cluster.dyn-zone:3128"
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265311272%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=PInDElH8PbSbyPfHI5qb
Y%2Ft7VqP7kySjxaVYkEV%2BIWI%3D&reserved=0> "https://www.bbc.co.uk"





Works as well



klist -e
Ticket cache: FILE:/tmp/krb5cc_1001_7KsHEg <FILE://tmp/krb5cc_1001_7KsHEg> 
Default principal: account at REALM

Valid starting     Expires            Service principal
06/18/25 09:17:11  06/18/25 19:17:11  krbtgt/REAM at REALM
    renew until 06/19/25 09:16:55, Etype (skey, tkt):
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96 
06/18/25 09:17:38  06/18/25 19:17:11  HTTP/test-squid-cluster.dyn-zone@
<mailto:HTTP/test-squid-cluster.dyn-zone@> 
    renew until 06/19/25 09:16:55, Etype (skey, tkt):
aes256-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96 
    Ticket server: HTTP/test-exams-cache.www-dyn.ed.ac.uk at ED.AC.UK
<mailto:HTTP/test-exams-cache.www-dyn.ed.ac.uk at ED.AC.UK> 







Mac (Sequoia 15.5)

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest.squid
.cluster.dyn-zone%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac
5354d8fa89908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583
37265327061%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAw
MCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=
uh3wcKqcET7lvGDixjYIPV7sMQpu5DQWPCU3MwlIEaU%3D&reserved=0>
"test.squid.cluster.dyn-zone:3128" https://www.bbc.co.uk
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265343080%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=Jgq5ZaanXE18ZnTJfh%2
B5uWc92NAj3vB570vi0GwVgbY%3D&reserved=0> 

 

2025/06/17 09:32:26| negotiate_kerberos_auth: INFO: User not authenticated

2025/06/17 09:32:26.600 kid1| ERROR: Negotiate Authentication validating
user. R

esult: {result=BH, notes={message: gss_accept_sec_context() failed:
Unspecified

GSS failure.  Minor code may provide more information. Cannot find key for
HTTP/

test-squid-cluster.dyn-zone at REALM <mailto:test-squid-cluster.dyn-zone at REALM>
kvno 2 in keytab (request ticket serv

er HTTP/test.squid.cluster@ <mailto:HTTP/test.squid.cluster@> REALM); }}

 

klist -v

Server: HTTP/test.squid.cluster@ <mailto:HTTP/test.squid.cluster@> REALM

Client: account at REALM

Ticket etype: aes256-cts-hmac-sha1-96, kvno 2

Ticket length: 1690

Auth time:  Jun 17 09:32:17 2025

Start time: Jun 17 09:32:26 2025

End time:   Jun 17 19:31:56 2025

Ticket flags: enc-pa-rep, pre-authent, forwardable

Addresses: addressless

 

curl -ik -vvv -L --proxy-negotiate -U : -b ~/cookiejar.txt -c
~/cookiejar.txt -x
<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Ftest-squid
-cluster.dyn.zone%3A3128%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac
5354d8fa89908ddae453ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C6388583
37265363670%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAw
MCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=
h4Eewb9G%2FmCru9yqhs%2FNPiQNaS8ub040wxJ1CuEphOI%3D&reserved=0>
"test-squid-cluster.dyn.zone:3128" https://www.bbc.co.uk
<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bbc.c
o.uk%2F&data=05%7C02%7Cyves.martin%40elca.ch%7C112b1e1ac5354d8fa89908ddae453
ba2%7C01c791614c7f481e8511d45615e6f78d%7C0%7C0%7C638858337265385086%7CUnknow
n%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIs
IkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C40000%7C%7C%7C&sdata=CyYbqCck5UzUubUvn6KQ
9WbMaUwJ9Ab4ZXNtQdtpeFI%3D&reserved=0> 

 

Successful:

2025/06/17 09:36:38| negotiate_kerberos_auth: INFO: User account
authenticated

2025/06/17 09:36:38.165 kid1| 82,2| external_acl.cc(700) aclMatchExternal:
ldap_group = ALLOWED

 

Klist -v

Server: krbtgt/REALM@ <mailto:krbtgt/ED.AC.UK at ED.AC.UK> REALM

Client: account at REALM 

Ticket etype: aes256-cts-hmac-sha1-96, kvno 11

Ticket length: 1683

Auth time:  Jun 17 09:36:31 2025

End time:   Jun 17 19:36:23 2025

Ticket flags: enc-pa-rep, pre-authent, initial, forwardable

Addresses: addressless

 

Server: HTTP/test-squid-cluster.dyn.zone@
<mailto:HTTP/test-squid-cluster.dyn.zone@> REALM

Client: account@ <mailto:ext6033 at ED.AC.UK> REALM

Ticket etype: aes256-cts-hmac-sha1-96, kvno 1

Ticket length: 1698

Auth time:  Jun 17 09:36:31 2025

Start time: Jun 17 09:36:38 2025

End time:   Jun 17 19:36:23 2025

Ticket flags: enc-pa-rep, pre-authent, forwardable

Addresses: addressless

 

The relevant parts of the squid.conf are:

 

http_port 3128

cache_mem 256 mb

maximum_object_size_in_memory 512 KB

maximum_object_size 2048 mb

cache_dir ufs /var/spool/squid 51200 16 256

debug_options ALL,2

visible_hostname test-squid-cluster.dyn.zone

unique_hostname server1

 

refresh_pattern .             0       20%     4320 ignore-reload

auth_param basic children 10

auth_param negotiate program /usr/lib64/squid/negotiate_kerberos_auth -k
/etc/squid/HTTP.keytab -s HTTP/test-squid-cluster.dyn.zone@
<mailto:HTTP/test-squid-cluster.dyn.zone@> REALM -d -i -r

 

(We also have LDAP basic auth configured as a fallback which works as
expected but modern Windows clients no longer support basic auth for proxy
servers).

 

klist -k /etc/squid/HTTP.keytab

Keytab name: FILE:/etc/squid/HTTP.keytab <FILE://etc/squid/HTTP.keytab> 

KVNO Principal

----
--------------------------------------------------------------------------

   1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK> REALM

   1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK> REALM

   1 TESTSQUIDCACHE@ <mailto:TESTEXAMSCACHE at ED.AC.UK> REALM

   1 HTTP/test-squid-cache.dyn.zone@
<mailto:HTTP/test-squid-cache.dyn.zone@> REALM

   1 HTTP/test-squid-cache.dyn.zone@
<mailto:HTTP/test-squid-cache.dyn.zone@> REALM

   1 HTTP/test-squid-cache.dyn.zone@
<mailto:HTTP/test-squid-cache.dyn.zone@> REALM

 

/etc/hosts

1.2.3.4 server1.cache server1 test-squid-cache.dyn.zone test.squid.cluster

 

Finally the keytab was generated using msktutil e.g.

msktutil -c -h test-squid-cache.dyn.zone -b
'OU=Managed-Linux,OU=Infrastructure' --computer-name TESTSQUIDCACHE -s
HTTP/test-squid-cache.dyn.zone -k /etc/squid/HTTP.keytab --server
domain.controller --realm REALM --use-service-account --dont-expire-password
--upn HTTP/test-squid-cache.dyn.zone at REALM
<mailto:HTTP/test-squid-cache.dyn.zone at REALM> 

 

This works fairly well/reliably if we use a keytab containing the HTTP/fqdn
of the server itself i.e. HTTP/server1 AND connect using curl using the FQDN
of server1 but we need resiliency and high-availability so having a
single-host service would be a last resort.

 

Any ideas on where I'm going wrong or what I need to add in terms of
DNS/keytab entries? Also some of the clients attempt to use key versions
which have never been issued e.g. kvno 4? 

 

Kind regards,

Mark

--
/****************************

Mark Cairney
ITI Enterprise Services
Information Services
University of Edinburgh

Tel: 0131 650 6565
Email: Mark.Cairney at ed.ac.uk <mailto:Mark.Cairney at ed.ac.uk> 

*******************************/

The University of Edinburgh is a charitable body, registered in Scotland,
with registration number SC005336. 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250618/71c92602/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 263 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250618/71c92602/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 6737 bytes
Desc: not available
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250618/71c92602/attachment-0001.bin>

From squid3 at treenet.co.nz  Thu Jun 19 14:21:39 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 20 Jun 2025 02:21:39 +1200
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
 CNAMEs/Round-robin DNS
In-Reply-To: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
References: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
Message-ID: <de255701-dd15-42a7-98c3-f365d36234cd@treenet.co.nz>

On 18/06/25 20:49, Mark Cairney wrote:
> Hi,
> 
> I?ve been trying to get Kerberos Authentication against AD working but 
> have been seeing inconsistent results/behaviour across multiple Oses and 
> I?m not sure if the issue lies with the DNS configuration, Kerberos 
> itself or with the Squid config:
> 
> THE DNS setup is as follows:
> 
> test.squid.cluster. 3600 IN?????????? CNAME??????????????? test-squid- 
> cluster.dyn-zone.
> 
> test-squid-cluster.dyn-zone. 60 IN A 1.2.3.4
> 
> Where 1.2.3.4 is the IP of one of the servers in the cluster. The 
> intention is to have multiple Squid servers behind a single DNS name for 
> high-availability.
> 

FYI, you cannot have multiple CNAME for test.squid.cluster pointing at 
different Squid server names. So this should not be a problem.


In Kerberos:
* Setup your keytab entry for HTTP/test-squid-cluster.dyn-zone at REALM.
* export the HTTP/test-squid-cluster.dyn-zone at REALM keytab to each proxy

In DNS:
* Add as many proxy as you want to test-squid-cluster.dyn-zone with A or 
AAAA records in DNS.
* point any domains you want those proxy to be acting as a CDN to 
test-squid-cluster.dyn-zone using CNAME in DNS.



Cheers
Amos

From squid3 at treenet.co.nz  Thu Jun 19 14:22:40 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Fri, 20 Jun 2025 02:22:40 +1200
Subject: [squid-users] User got domain login dialog box prompt,
 when number of user more than 250++
In-Reply-To: <1683469084.717849.1750155677332@mail.yahoo.com>
References: <2072256482.50777.1749802092237.ref@mail.yahoo.com>
 <2072256482.50777.1749802092237@mail.yahoo.com>
 <730d4b29-07cf-4957-a48b-d50b5e4c3216@treenet.co.nz>
 <1512835743.441693.1750047935683@mail.yahoo.com>
 <a1076844-1c2e-4479-80ad-2a13d997f6a2@treenet.co.nz>
 <1683469084.717849.1750155677332@mail.yahoo.com>
Message-ID: <c79872ea-d664-4669-8636-75be3fc6b6c0@treenet.co.nz>

On 17/06/25 22:21, wong237ma wrote:
> Hi Amos,
> 
> can help to give configure example for external helper 
> ext_kerberos_ldap_group_acl, since this help is faster compare to 
> ext_wbinfo_group_acl.
> 

Sorry I'm not that familiar with those particular helpers.
Others here may be able to help, or online manuals for them.

Cheers
Amos


From bpk678 at gmail.com  Thu Jun 19 19:29:16 2025
From: bpk678 at gmail.com (Brendan Kearney)
Date: Thu, 19 Jun 2025 15:29:16 -0400
Subject: [squid-users] transparent or intercept proxy with iptables and
 haproxy
Message-ID: <329c21e9-2d24-4db7-9c1e-c47929ef2cb2@gmail.com>

list members,

i am trying to setup a transparent or intercept proxy, where a client 
does not know or is not configured to use a proxy, but winds up going 
through squid instances.? i have an iptables firewall, and can perform 
DNAT, to point the traffic at a haproxy VIP.? the haproxy VIP will use 
least-conn load balancing to pick which of my 3 squid instances to send 
the traffic to.? i would like to configure the squid instances to handle 
the traffic coming in this way.

i am unclear as to the differences between intercept and tproxy, so some 
clarity there would be helpful.? i believe transparent requires that the 
NAT'ing be done "on-box" as opposed to across the network by my router.? 
is this accurate?? are there any other differences?? which is the 
appropriate mechanism for my use case?

the connection chain would look something like this:

client -> router (DNAT to VIP) -> haproxy VIP (port 3129, SNAT to VIP 
IP) -> squid (port 3129) -> internet

is this kind of config viable, and if so, what pieces do i have wrong?? 
in this scenario is transparent or intercept the proper means within squid?

thank you,

brendan kearney


From kinkie at squid-cache.org  Sat Jun 21 09:54:27 2025
From: kinkie at squid-cache.org (Francesco Chemolli)
Date: Sat, 21 Jun 2025 11:54:27 +0200
Subject: [squid-users] Squid 7.0.2 BETA is available
Message-ID: <CA+Y8hcPtYcx16kXnYUJiR1T7j=rZ5AJqotR+_a7tXGeYM8bZGg@mail.gmail.com>

The Squid Web Cache team is very pleased to announce the
availability of the Squid 7.0.2 beta release!

This new 7.x series of Squid brings useful new features, changes
and bug fixes over earlier release series

More detailed descriptions of the major new features, downloadable
files, and release signatures are are available at:
<https://github.com/squid-cache/squid/releases/tag/SQUID_7_0_2>

Detailed lists of the ./configure build and squid.conf changes can also
be found in the release notes.

This code is released as beta for wider testing purposes and potential
use. There are no more planned alterations to the existing features,
./configure options or squid.conf options for release 7.

We routinely test Squid for compatibility with major Operating Systems
and hardware platforms, including most current Linux distributions,
FreeBSD, OpenBSD, and MacOS/Homebrew

Since version 7.0.1, a few bugs have been squashed, and portability
has been improved

A detailed list of changes is at
<https://github.com/squid-cache/squid/releases/tag/SQUID_7_0_2>

-- 
    Francesco Chemolli

From uhlar at fantomas.sk  Sun Jun 22 17:49:09 2025
From: uhlar at fantomas.sk (Matus UHLAR - fantomas)
Date: Sun, 22 Jun 2025 19:49:09 +0200
Subject: [squid-users] transparent or intercept proxy with iptables and
 haproxy
In-Reply-To: <329c21e9-2d24-4db7-9c1e-c47929ef2cb2@gmail.com>
References: <329c21e9-2d24-4db7-9c1e-c47929ef2cb2@gmail.com>
Message-ID: <aFhCFTckdzR2gIPH@fantomas.sk>

On 19.06.25 15:29, Brendan Kearney wrote:
>i am trying to setup a transparent or intercept proxy, where a client 
>does not know or is not configured to use a proxy, but winds up going 
>through squid instances.? i have an iptables firewall, and can perform 
>DNAT,

DNAT is dangerous, because the proxy on remote machine loses the real IP the 
connection was directed to.
You need to use policy routing, where you forward packets on other host 
which will intercept the connections itself.

> to point the traffic at a haproxy VIP.? the haproxy VIP will use 
>least-conn load balancing to pick which of my 3 squid instances to 
>send the traffic to.? i would like to configure the squid instances to 
>handle the traffic coming in this way.
>
>i am unclear as to the differences between intercept and tproxy, so 
>some clarity there would be helpful.

"intercept" intercepts connection to remote hosts and handles it (and 
replies) locally.  
The proxy fakes being the destination server to the client.

"tproxy" does the same, but even changes the client's IP, as if the 
connection came from client
The proxy fakes being the client to the server (in addition to the above).

You don't need tproxy if your clients and proxy are behind NAT, translating 
to the same IP.

> i believe transparent requires 
>that the NAT'ing be done "on-box" as opposed to across the network by 
>my router.? is this accurate?? are there any other differences?? which 
>is the appropriate mechanism for my use case?

Again, don't to DNAT.

If you redirect HTTP connections on your router to the proxy, use policy 
routing and do intercept on the proxy.

>the connection chain would look something like this:
>
>client -> router (DNAT to VIP) -> haproxy VIP (port 3129, SNAT to VIP 
>IP) -> squid (port 3129) -> internet
>
>is this kind of config viable, and if so, what pieces do i have 
>wrong?? in this scenario is transparent or intercept the proper means 
>within squid?

You need to find out how HAPROXY handles intercepted connections.
-- 
Matus UHLAR - fantomas, uhlar at fantomas.sk ; http://www.fantomas.sk/
Warning: I wish NOT to receive e-mail advertising to this address.
Varovanie: na tuto adresu chcem NEDOSTAVAT akukolvek reklamnu postu.
Nothing is fool-proof to a talented fool.

From squid3 at treenet.co.nz  Sun Jun 22 17:53:24 2025
From: squid3 at treenet.co.nz (Amos Jeffries)
Date: Mon, 23 Jun 2025 05:53:24 +1200
Subject: [squid-users] transparent or intercept proxy with iptables and
 haproxy
In-Reply-To: <329c21e9-2d24-4db7-9c1e-c47929ef2cb2@gmail.com>
References: <329c21e9-2d24-4db7-9c1e-c47929ef2cb2@gmail.com>
Message-ID: <bc095791-5a1a-4996-b767-938d00724978@treenet.co.nz>

On 20/06/25 07:29, Brendan Kearney wrote:
> list members,
> 
> i am trying to setup a transparent or intercept proxy, where a client 
> does not know or is not configured to use a proxy, but winds up going 
> through squid instances.? i have an iptables firewall, and can perform 
> DNAT, to point the traffic at a haproxy VIP.? the haproxy VIP will use 
> least-conn load balancing to pick which of my 3 squid instances to send 
> the traffic to.? i would like to configure the squid instances to handle 
> the traffic coming in this way.
> 
> i am unclear as to the differences between intercept and tproxy, so some 
> clarity there would be helpful.

"intercept" (NAT Interception) uses NAT systems to change the 
destination IP:port on TCP packets sent by the client, such that they 
are delivered to a listening IP:port of some process on the local machine.

"tproxy" (Transparent Proxy) uses the Linux iptables feature called 
"TPROXY" (on BSD the PF feature is called "divert") to deliver TCP 
packets sent by the client to some process no the local machine.


>? i believe transparent requires that the 
> NAT'ing be done "on-box" as opposed to across the network by my router.

They both do.


> is this accurate?? are there any other differences?

NAT erases the original IP:port details the client sent to. Squid using 
NAT intercept will use the Squid machine IP as sender/source-IP on 
traffic to upstream servers.

Squid using TPROXY will preserve the client source-IP on traffic to 
upstream servers. This requires special care with routing for the 
intercepted traffic handling not to loose/drop packets.


>? which is the 
> appropriate mechanism for my use case?
> 

  * TPROXY is "The Right Way" - but complex.

  * NAT is more popular due to admin already being familiar with 
configuring those systems.

Your choice.



> the connection chain would look something like this:
> 
> client -> router (DNAT to VIP) -> haproxy VIP (port 3129, SNAT to VIP 
> IP) -> squid (port 3129) -> internet
> 

No. Interception is the mechanism by which client->server traffic is 
converted into client->proxy.

Only the **first** proxy on your hierarchy received the intercepted TCP 
connections. That would be your HAProxy.

client -> router -> haproxy -> squid -> router -> Internet

On router:
  route src-IP=clients + dst-port=80 to gateway VIP1
  route src-IP=VIP2 + dst-port=80 to gateway Internet

On haproxy machine (VIP1):
  iptables DNAT port 80 to port 3129

On Squid machine (VIP2):
  regular forward proxy configuration. Nothing special needed.


HTH
Amos


From Mark.Cairney at ed.ac.uk  Mon Jun 23 10:15:43 2025
From: Mark.Cairney at ed.ac.uk (Mark Cairney)
Date: Mon, 23 Jun 2025 11:15:43 +0100
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
 CNAMEs/Round-robin DNS
In-Reply-To: <de255701-dd15-42a7-98c3-f365d36234cd@treenet.co.nz>
References: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
 <de255701-dd15-42a7-98c3-f365d36234cd@treenet.co.nz>
Message-ID: <ff89be51-4159-480c-a108-c725c1abbe44@ed.ac.uk>

Hi,

Thanks- that make sense and as a result I've set the reverse DNS on the 
2 hosts to the round-robin DNS name.

RE: the KVNO drift issue, one suggestion was to delete the existing 
machine account(s) from AD and use ktpass and set the kvno to 0.

I'd previously used msktutil (as suggested on 
https://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory) 
with the 'dont-expire-password' flag i.e:

msktutil -c -h test-squid-cluster.dyn.zone -b 'OU=Managed-Linux-Servers' 
--computer-name TESTSQUID -s HTTP/test-squid-cluster.dyn.zone -k 
/etc/squid/HTTP.keytab --server domain.controller --realm REALM 
--use-service-account --dont-expire-password --upn 
HTTP/test-squid-cluster.dyn.zone at REALM

Which is more likely to be reliable (unfortunately I have to use MS AD 
as the whole purpose of this proxy is to allow Windows clients to use an 
authenticated proxy).

Kind regards,

Mark

On 19/06/2025 15:21, Amos Jeffries wrote:
> [You don't often get email from squid3 at treenet.co.nz. Learn why this 
> is important at https://aka.ms/LearnAboutSenderIdentification ]
>
> On 18/06/25 20:49, Mark Cairney wrote:
>> Hi,
>>
>> I?ve been trying to get Kerberos Authentication against AD working but
>> have been seeing inconsistent results/behaviour across multiple Oses and
>> I?m not sure if the issue lies with the DNS configuration, Kerberos
>> itself or with the Squid config:
>>
>> THE DNS setup is as follows:
>>
>> test.squid.cluster. 3600 IN?????????? CNAME test-squid-
>> cluster.dyn-zone.
>>
>> test-squid-cluster.dyn-zone. 60 IN A 1.2.3.4
>>
>> Where 1.2.3.4 is the IP of one of the servers in the cluster. The
>> intention is to have multiple Squid servers behind a single DNS name for
>> high-availability.
>>
>
> FYI, you cannot have multiple CNAME for test.squid.cluster pointing at
> different Squid server names. So this should not be a problem.
>
>
> In Kerberos:
> * Setup your keytab entry for HTTP/test-squid-cluster.dyn-zone at REALM.
> * export the HTTP/test-squid-cluster.dyn-zone at REALM keytab to each proxy
>
> In DNS:
> * Add as many proxy as you want to test-squid-cluster.dyn-zone with A or
> AAAA records in DNS.
> * point any domains you want those proxy to be acting as a CDN to
> test-squid-cluster.dyn-zone using CNAME in DNS.
>
>
>
> Cheers
> Amos
> _______________________________________________
> squid-users mailing list
> squid-users at lists.squid-cache.org
> https://lists.squid-cache.org/listinfo/squid-users 
>

-- 
/****************************

Mark Cairney
ITI Enterprise Services
Information Services
University of Edinburgh

Tel: 0131 650 6565
Email: Mark.Cairney at ed.ac.uk

*******************************/

The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336.


From rafael.akchurin at diladele.com  Mon Jun 23 10:27:05 2025
From: rafael.akchurin at diladele.com (Rafael Akchurin)
Date: Mon, 23 Jun 2025 10:27:05 +0000
Subject: [squid-users] Kerberos Auth weirdness/inconsistency when using
 CNAMEs/Round-robin DNS
In-Reply-To: <ff89be51-4159-480c-a108-c725c1abbe44@ed.ac.uk>
References: <6a32534a-d605-474f-9cca-79d3735385b4@ed.ac.uk>
 <de255701-dd15-42a7-98c3-f365d36234cd@treenet.co.nz>
 <ff89be51-4159-480c-a108-c725c1abbe44@ed.ac.uk>
Message-ID: <2D00F07A-1DC2-4369-9803-D2FE1BF1FB2A@diladele.com>

Hello Mark,

You can just export the keytab generated on windows and use it on your proxy - then there is no need to mess with proxy?s account in AD - overall this is much easier I believe - see https://www.diladele.com/websafety/docs/authentication/active_directory/kerberos/

And it also works pretty nice with several boxes at once - we use it all the time when testing AD integration, see  https://www.diladele.com/websafety/docs/redundancy/haproxy_proxy_protocol/

Hope it helps.

Best regards,
Rafael Akchurin

On 23 Jun 2025, at 12:16, Mark Cairney <Mark.Cairney at ed.ac.uk> wrote:

?Hi,

Thanks- that make sense and as a result I've set the reverse DNS on the 2 hosts to the round-robin DNS name.

RE: the KVNO drift issue, one suggestion was to delete the existing machine account(s) from AD and use ktpass and set the kvno to 0.

I'd previously used msktutil (as suggested on https://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory) with the 'dont-expire-password' flag i.e:

msktutil -c -h test-squid-cluster.dyn.zone -b 'OU=Managed-Linux-Servers' --computer-name TESTSQUID -s HTTP/test-squid-cluster.dyn.zone -k /etc/squid/HTTP.keytab --server domain.controller --realm REALM --use-service-account --dont-expire-password --upn HTTP/test-squid-cluster.dyn.zone at REALM

Which is more likely to be reliable (unfortunately I have to use MS AD as the whole purpose of this proxy is to allow Windows clients to use an authenticated proxy).

Kind regards,

Mark

On 19/06/2025 15:21, Amos Jeffries wrote:
[You don't often get email from squid3 at treenet.co.nz. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

On 18/06/25 20:49, Mark Cairney wrote:
Hi,

I?ve been trying to get Kerberos Authentication against AD working but
have been seeing inconsistent results/behaviour across multiple Oses and
I?m not sure if the issue lies with the DNS configuration, Kerberos
itself or with the Squid config:

THE DNS setup is as follows:

test.squid.cluster. 3600 IN           CNAME test-squid-
cluster.dyn-zone.

test-squid-cluster.dyn-zone. 60 IN A 1.2.3.4

Where 1.2.3.4 is the IP of one of the servers in the cluster. The
intention is to have multiple Squid servers behind a single DNS name for
high-availability.


FYI, you cannot have multiple CNAME for test.squid.cluster pointing at
different Squid server names. So this should not be a problem.


In Kerberos:
* Setup your keytab entry for HTTP/test-squid-cluster.dyn-zone at REALM.
* export the HTTP/test-squid-cluster.dyn-zone at REALM keytab to each proxy

In DNS:
* Add as many proxy as you want to test-squid-cluster.dyn-zone with A or
AAAA records in DNS.
* point any domains you want those proxy to be acting as a CDN to
test-squid-cluster.dyn-zone using CNAME in DNS.



Cheers
Amos
_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
https://lists.squid-cache.org/listinfo/squid-users

--
/****************************

Mark Cairney
ITI Enterprise Services
Information Services
University of Edinburgh

Tel: 0131 650 6565
Email: Mark.Cairney at ed.ac.uk

*******************************/

The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336.

_______________________________________________
squid-users mailing list
squid-users at lists.squid-cache.org
https://lists.squid-cache.org/listinfo/squid-users
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250623/17dd8bd4/attachment-0001.htm>

From kinkie at squid-cache.org  Tue Jun 24 15:27:01 2025
From: kinkie at squid-cache.org (Francesco Chemolli)
Date: Tue, 24 Jun 2025 17:27:01 +0200
Subject: [squid-users] Squid 6.14 is available
Message-ID: <CA+Y8hcMnw6Xe5pahG=vwpCCFWo9htBgzemxrciHBc=fG7kYt4g@mail.gmail.com>

The Squid HTTP Proxy team is very pleased to announce the availability
of the Squid-6.14 release

This release is, we believe, stable enough for general production use.
We encourage all users of Squid-6 to upgrade to this version.
It contains a few bug fixes, portability and build improvements.

Further details, release notes, and source archives can be found at
https://github.com/squid-cache/squid/releases/tag/SQUID_6_14
(look for the "Bootstrapped sources" links there).

As a reminder, we no longer directly distribute our releases
over FTP, rsync, or through mirrors.

Please remember to run "squid -k parse" when upgrading to a new
version of Squid. It will audit your configuration files and report
any identifiable issues the new release will have in your installation
before you "press go".


-- 
    Francesco Chemolli

From Angela.Yu at alliedtelesis.co.nz  Thu Jun 26 00:10:23 2025
From: Angela.Yu at alliedtelesis.co.nz (Angela Yu)
Date: Thu, 26 Jun 2025 00:10:23 +0000
Subject: [squid-users] HTTP support
Message-ID: <fd8d7db8bde84cdeaa8503983f84d2a8@alliedtelesis.co.nz>

Hello,


I was wondering if Squid support or intend to support HTTP3?


Kind regards,

Angela

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.squid-cache.org/pipermail/squid-users/attachments/20250626/29469edf/attachment.htm>

From rousskov at measurement-factory.com  Thu Jun 26 13:52:24 2025
From: rousskov at measurement-factory.com (Alex Rousskov)
Date: Thu, 26 Jun 2025 09:52:24 -0400
Subject: [squid-users] HTTP support
In-Reply-To: <fd8d7db8bde84cdeaa8503983f84d2a8@alliedtelesis.co.nz>
References: <fd8d7db8bde84cdeaa8503983f84d2a8@alliedtelesis.co.nz>
Message-ID: <7d06285f-c36a-40aa-8e23-50ff87bf462e@measurement-factory.com>

On 2025-06-26 20:10, Angela Yu wrote:

> I was wondering if Squid?support or intend to support HTTP3?

Squid does not support HTTP/3 today. We are working on adding HTTP/2 
support and intend to support HTTP/3 after that work is completed.

Cheers,

Alex.


