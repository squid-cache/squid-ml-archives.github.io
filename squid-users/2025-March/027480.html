<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] ACL block_user List
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20block_user%20List&In-Reply-To=%3C9625900c-019c-412e-b8e3-7d3d2cb91e9c%40treenet.co.nz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="027485.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] ACL block_user List</H1>
    <B>Amos Jeffries</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20ACL%20block_user%20List&In-Reply-To=%3C9625900c-019c-412e-b8e3-7d3d2cb91e9c%40treenet.co.nz%3E"
       TITLE="[squid-users] ACL block_user List">squid3 at treenet.co.nz
       </A><BR>
    <I>Sat Mar  1 08:31:13 UTC 2025</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="027485.html">[squid-users] ACL block_user List
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27480">[ date ]</a>
              <a href="thread.html#27480">[ thread ]</a>
              <a href="subject.html#27480">[ subject ]</a>
              <a href="author.html#27480">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/03/25 03:54, Piana, Josh wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am attempting to setup an ACL block list based on usernames from a 
</I>&gt;<i> windows AD environment.
</I>&gt;<i> 
</I>&gt;<i> When I have this added to my squid.conf file, all outbound connections 
</I>&gt;<i> stop working:
</I>&gt;<i> 
</I>&gt;<i> acl block_user proxy_auth_regex -i &quot;/etc/squid/block_user&quot;
</I>&gt;<i> 
</I>&gt;<i> http_access deny block_user
</I>&gt;<i> 
</I>&gt;<i> I have also tried &#8220;!block_user&#8221;.
</I>
Was that &quot;NOT MATCHING block_user&quot; condition used with allow or deny action?

What prior or followup http_access lines are processed when that ACL 
check results in &quot;need login&quot; due to lack of username value?

&gt;<i> 
</I>&gt;<i> As you can see, I have it set so if a Windows username is on the 
</I>&gt;<i> &#8220;block_user&#8221; list, Squid will deny internet access to that user. 
</I>&gt;<i> Unfortunately, this doesn&#8217;t work in practice. I have a working Kerberos 
</I>&gt;<i> back-end setup, handling authentication. What am I doing wrong with this 
</I>&gt;<i> setup?
</I>&gt;<i> 
</I>
1) The block_user ACL you have defined is a Regular Expression test 
against the username, not a check of the exact username. So you need to 
be very careful of the specific regex patterns you are using.

(If you want me to check validity, you can post to be directly here, do 
not post actual value to this public list).

2) The block_user ACL implicitly requires authentication to have been 
performed before it can perform its check. Check your auth_param 
settings, and prior proxy_auth type ACL that perform the login.


HTH
Amos
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="027485.html">[squid-users] ACL block_user List
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27480">[ date ]</a>
              <a href="thread.html#27480">[ thread ]</a>
              <a href="subject.html#27480">[ subject ]</a>
              <a href="author.html#27480">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
