<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20Queue.cc%3A388%3A%20%22EX%22&In-Reply-To=%3CCADJd0Y0ruLFdMJ49u-MtF3mviwhjNaXMpPXQJTgb_NQwaUQcZQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027500.html">
   <LINK REL="Next"  HREF="027503.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;</H1>
    <B>Andrey K</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20assertion%20failed%3A%20Queue.cc%3A388%3A%20%22EX%22&In-Reply-To=%3CCADJd0Y0ruLFdMJ49u-MtF3mviwhjNaXMpPXQJTgb_NQwaUQcZQ%40mail.gmail.com%3E"
       TITLE="[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;">ankor2023 at gmail.com
       </A><BR>
    <I>Thu Mar 13 11:49:11 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027500.html">[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="027503.html">[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27502">[ date ]</a>
              <a href="thread.html#27502">[ thread ]</a>
              <a href="subject.html#27502">[ subject ]</a>
              <a href="author.html#27502">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

&gt;<i> Quality pull requests welcome.
</I>
I implemented the A-example functionality and made PR:
<A HREF="https://github.com/squid-cache/squid/pull/2023">https://github.com/squid-cache/squid/pull/2023</A>

But the modified Squid project is not being built on github, although there
are no problems during the local builds.
Alex, Amos and Francesco, could you see what the problem is?
Kind regards,
Ankor.



&#1074;&#1090;, 11 &#1084;&#1072;&#1088;. 2025&#8239;&#1075;. &#1074; 17:40, Andrey K &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ankor2023 at gmail.com</A>&gt;:

&gt;<i> Hello Alex,
</I>&gt;<i>
</I>&gt;<i> Thank you for sharing your thoughts.
</I>&gt;<i> The A-example looks easier to implement and more reliable.
</I>&gt;<i>
</I>&gt;<i> Kind regards,
</I>&gt;<i>       Ankor.
</I>&gt;<i>
</I>&gt;<i> &#1074;&#1090;, 11 &#1084;&#1072;&#1088;. 2025&#8239;&#1075;. &#1074; 17:12, Alex Rousskov &lt;
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;:
</I>&gt;<i>
</I>&gt;&gt;<i> On 2025-03-10 23:56, Andrey K wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt;  &gt; Alex: FWIW, related future Squid improvements may include:
</I>&gt;&gt;<i> &gt;  &gt;  * Detecting such shared memory segments clashes; refusing to start.
</I>&gt;&gt;<i> &gt;  &gt;  * Disabling shared memory use when caching is completely disabled.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; But ... segments may remain from the previous
</I>&gt;&gt;<i> &gt; Squid crash. Thus, in my opinion, it is impractical to refuse to launch
</I>&gt;&gt;<i> &gt; the program.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;Squid should overwrite segments left by a crashed Squid&quot; does not imply
</I>&gt;&gt;<i> that &quot;detecting segment clashes among independent Squid instances is
</I>&gt;&gt;<i> impractical&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The following rough examples are _not_ implementation blueprints, but
</I>&gt;&gt;<i> they illustrate the lack of the above implication:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A. If Squid were to incorporate PID filename[^1] into segment names,
</I>&gt;&gt;<i> then segments from different Squid instances will not clash.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> B. If Squid were to write its PID filename[^1] into a shared memory
</I>&gt;&gt;<i> segment, then Squid would be able to detect that another running
</I>&gt;&gt;<i> instance is using the same shared memory segment (while still
</I>&gt;&gt;<i> overwriting segments left by an earlier crash).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [^1]: Full Squid PID filename are already guaranteed to be unique across
</I>&gt;&gt;<i> Squid instances that may overwrite each other segments because Squid
</I>&gt;&gt;<i> refuses to start if another Squid instance is using its PID file. The
</I>&gt;&gt;<i> only red flag I can think of here is esoteric chrooted instances, but I
</I>&gt;&gt;<i> would not be surprised if those instances cannot share segments.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; I think it's enough to put a warning in the code when detecting old
</I>&gt;&gt;<i> &gt; segments.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I disagree that a level-0 warning during regular/uneventful startups is
</I>&gt;&gt;<i> a good idea, especially if there will be one warning for every segment.
</I>&gt;&gt;<i> We should try to address the actual problem (i.e. refuse to start a
</I>&gt;&gt;<i> segment-clashing concurrent instance) rather than allowing clashes but
</I>&gt;&gt;<i> adding a yet another warning about a usually benign event.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alex.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Something like that:
</I>&gt;&gt;<i> &gt; void
</I>&gt;&gt;<i> &gt; Ipc::Mem::Segment::create(const off_t aSize)
</I>&gt;&gt;<i> &gt; {
</I>&gt;&gt;<i> &gt;      assert(aSize &gt; 0);
</I>&gt;&gt;<i> &gt;      assert(theFD &lt; 0);
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;      int xerrno = 0;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;      // Why a brand new segment? A Squid crash may leave a reusable
</I>&gt;&gt;<i> &gt; segment, but
</I>&gt;&gt;<i> &gt;      // our placement-new code requires an all-0s segment. We could
</I>&gt;&gt;<i> &gt; truncate and
</I>&gt;&gt;<i> &gt;      // resize the old segment, but OS X does not allow using O_TRUNC
</I>&gt;&gt;<i> with
</I>&gt;&gt;<i> &gt;      // shm_open() and does not support ftruncate() for old segments.
</I>&gt;&gt;<i> &gt;      if (!createFresh(xerrno) &amp;&amp; xerrno == EEXIST) {
</I>&gt;&gt;<i> &gt; *debugs(54, DBG_CRITICAL, &quot;WARNING: there is an old shared memory
</I>&gt;&gt;<i> &gt; segment: '&quot; &lt;&lt; theName &lt;&lt; &quot;'. Perhaps it was left after the previous
</I>&gt;&gt;<i> &gt; crash of the Squid. We will remove it. Or it may be a sign that another
</I>&gt;&gt;<i> &gt; instance of the Squid is running.  In this case, you must launch the
</I>&gt;&gt;<i> &gt; program with the -n option and specify the unique name of the
</I>&gt;&gt;<i> service.&quot;);*
</I>&gt;&gt;<i> &gt;          unlink();
</I>&gt;&gt;<i> &gt;          createFresh(xerrno);
</I>&gt;&gt;<i> &gt;      }
</I>&gt;&gt;<i> &gt; Kind regards,
</I>&gt;&gt;<i> &gt; Ankor.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; &#1089;&#1073;, 8 &#1084;&#1072;&#1088;. 2025&#8239;&#1075;. &#1074; 08:14, Andrey K &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ankor2023 at gmail.com</A>
</I>&gt;&gt;<i> &gt; &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">ankor2023 at gmail.com</A>&gt;&gt;:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     Hello Alex,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     Thanks for the analysis.
</I>&gt;&gt;<i> &gt;     Squidonlyallowsalphanumericcharactersinthe servicename,
</I>&gt;&gt;<i> &gt;     soitrefusesto usethe originalservice namein the -n option (-n
</I>&gt;&gt;<i> &gt;     squid.user.service).
</I>&gt;&gt;<i> &gt;     I added-n squiduser option to the ExecStart string of the second
</I>&gt;&gt;<i> &gt;     instance.
</I>&gt;&gt;<i> &gt;     Now it looks good:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     # the first instance
</I>&gt;&gt;<i> &gt;     lsof -p 3746105 | grep shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root  mem    REG               0,23   525572
</I>&gt;&gt;<i> &gt;     1213614834 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root  mem    REG               0,23      136
</I>&gt;&gt;<i> &gt;     1213614835 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root  mem    REG               0,23        8
</I>&gt;&gt;<i> &gt;     1213614833 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root    7u   REG               0,23        8
</I>&gt;&gt;<i> &gt;     1213614833 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root    8u   REG               0,23   525572
</I>&gt;&gt;<i> &gt;     1213614834 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;     squid   3746105 root    9u   REG               0,23      136
</I>&gt;&gt;<i> &gt;     1213614835 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     # the second instance
</I>&gt;&gt;<i> &gt;     lsof -p 3685356 | grep shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root  mem    REG               0,23   2093368
</I>&gt;&gt;<i> &gt;     1212704041 /dev/shm/squiduser-tls_session_cache.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root  mem    REG               0,23    525572
</I>&gt;&gt;<i> &gt;     1212704039 /dev/shm/squiduser-cf__queues.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root  mem    REG               0,23       136
</I>&gt;&gt;<i> &gt;     1212704040 /dev/shm/squiduser-cf__readers.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root  mem    REG               0,23         8
</I>&gt;&gt;<i> &gt;     1212704038 /dev/shm/squiduser-cf__metadata.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root    6u   REG               0,23         8
</I>&gt;&gt;<i> &gt;     1212704038 /dev/shm/squiduser-cf__metadata.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root    7u   REG               0,23    525572
</I>&gt;&gt;<i> &gt;     1212704039 /dev/shm/squiduser-cf__queues.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root    8u   REG               0,23       136
</I>&gt;&gt;<i> &gt;     1212704040 /dev/shm/squiduser-cf__readers.shm
</I>&gt;&gt;<i> &gt;     squid.use 3685356 root    9u   REG               0,23   2093368
</I>&gt;&gt;<i> &gt;     1212704041 /dev/shm/squiduser-tls_session_cache.shm
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     Kind regards,
</I>&gt;&gt;<i> &gt;           Ankor.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;     &#1087;&#1090;, 7 &#1084;&#1072;&#1088;. 2025&#8239;&#1075;. &#1074; 17:48, Alex Rousskov
</I>&gt;&gt;<i> &gt;     &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>
</I>&gt;&gt;<i> &gt;     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">rousskov at measurement-factory.com</A>&gt;&gt;:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         On 2025-03-07 06:50, Andrey K wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;          &gt; Squid Cache: Version 6.13
</I>&gt;&gt;<i> &gt;          &gt; Service Name: squid
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;          &gt; Squid Cache: Version 6.10
</I>&gt;&gt;<i> &gt;          &gt; Service Name: squid
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;          &gt; # the first instance
</I>&gt;&gt;<i> &gt;          &gt; 1318 DEL  ...          30205 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;          &gt; 1318 DEL  ...          30206 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;          &gt; 1318 DEL  ...          30204 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;          &gt; 1318   8u ...      8   30204 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;         (deleted)
</I>&gt;&gt;<i> &gt;          &gt; 1318   9u ... 525572   30205 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;         (deleted)
</I>&gt;&gt;<i> &gt;          &gt; 1318  10u ...    136   30206 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;         (deleted)
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt; # the second instance
</I>&gt;&gt;<i> &gt;          &gt; 1514 mem  ... 2093368   31497
</I>&gt;&gt;<i> &gt;         /dev/shm/squid-tls_session_cache.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514 mem  ...  525572   31495 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514 mem  ...     136   31496 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514 mem  ...       8   31494 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514   6u ...       8   31494 /dev/shm/squid-cf__metadata.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514   7u ...  525572   31495 /dev/shm/squid-cf__queues.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514   8u ...     136   31496 /dev/shm/squid-cf__readers.shm
</I>&gt;&gt;<i> &gt;          &gt; 1514   9u ... 2093368   31497
</I>&gt;&gt;<i> &gt;         /dev/shm/squid-tls_session_cache.shm
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         As suspected, these two Squid instances use the same shared
</I>&gt;&gt;<i> memory
</I>&gt;&gt;<i> &gt;         segments (e.g., /dev/shm/squid-cf*). Such shared use violates
</I>&gt;&gt;<i> &gt;         critical
</I>&gt;&gt;<i> &gt;         code assumptions and results in undefined behavior.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;          &gt; Maybe I'm not experiencing any difficulties because I have
</I>&gt;&gt;<i> &gt;         caching turned off on
</I>&gt;&gt;<i> &gt;          &gt; both instances?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         Well, you _are_ experiencing at least one difficulty -- the
</I>&gt;&gt;<i> &gt;         assertion
</I>&gt;&gt;<i> &gt;         that started this email thread. If you have fully disabled
</I>&gt;&gt;<i> &gt;         caching, the
</I>&gt;&gt;<i> &gt;         difficulties you experience should not include cache corruption.
</I>&gt;&gt;<i> &gt;         However, it looks like at least one of the two instances does
</I>&gt;&gt;<i> &gt;         cache TLS
</I>&gt;&gt;<i> &gt;         sessions (in /dev/shm/squid-tls_session_cache.shm). If both
</I>&gt;&gt;<i> &gt;         instances do
</I>&gt;&gt;<i> &gt;         that, then all bets are off!
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         FWIW, related future Squid improvements may include:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         * Detecting such shared memory segments clashes; refusing to
</I>&gt;&gt;<i> start.
</I>&gt;&gt;<i> &gt;         * Disabling shared memory use when caching is completely
</I>&gt;&gt;<i> disabled.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         Quality pull requests welcome.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         Cheers,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;         Alex.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;          &gt; &#1095;&#1090;, 6 &#1084;&#1072;&#1088;. 2025&#8239;&#1075;. &#1074; 17:11, Alex Rousskov:
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     On 2025-03-06 08:59, Amos Jeffries wrote:
</I>&gt;&gt;<i> &gt;          &gt;      &gt; On 6/03/25 19:17, Andrey K wrote:
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; Hello,
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; I have a similar configuration: two SMP squids
</I>&gt;&gt;<i> &gt;         running on the
</I>&gt;&gt;<i> &gt;          &gt;     same OEL
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; host.
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; They were built with different configurations: with
</I>&gt;&gt;<i> &gt;         different
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; installation path prefixes and different names of
</I>&gt;&gt;<i> &gt;         binary files:
</I>&gt;&gt;<i> &gt;          &gt;     squid
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; and squid.user and they listen to different ports.
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; They are launched from two different
</I>&gt;&gt;<i> &gt;         services:squid.service and
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; squid.user.service with the service Type=forking:
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;     ExecStart=/usr/sbin/squid -sYC
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;     ExecStart=/sbin/squid.user -f
</I>&gt;&gt;<i> &gt;         /etc/squid.user/squid.conf
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; I have not experienced any troubles with this
</I>&gt;&gt;<i> &gt;         configuration yet.
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; /&gt; Please be aware that &quot;squid -n ...&quot; is a
</I>&gt;&gt;<i> &gt;         REQUIREMENT for running/
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; /multiple Squid instances on the same machine
</I>&gt;&gt;<i> &gt;         regardless of what
</I>&gt;&gt;<i> &gt;          &gt;     features
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; are used./
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; Could you please tell me if I should use the -n
</I>&gt;&gt;<i> &gt;         option in the
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; ExecStart strings?
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt; The arguments of the options should be the service
</I>&gt;&gt;<i> names?
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;     ExecStart=/usr/sbin/squid -sYC -n squid.service
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;     ExecStart=/sbin/squid.user -f
</I>&gt;&gt;<i> &gt;         /etc/squid.user/squid.conf -n
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;     squid.user.service
</I>&gt;&gt;<i> &gt;          &gt;      &gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;      &gt; Yes you should. The different ./configure options has
</I>&gt;&gt;<i> &gt;         helped you
</I>&gt;&gt;<i> &gt;          &gt;     avoid
</I>&gt;&gt;<i> &gt;          &gt;      &gt; major issues, but some may still appear.
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     I agree. Moreover, I do not understand how your two SMP
</I>&gt;&gt;<i> &gt;         Squids could
</I>&gt;&gt;<i> &gt;          &gt;     work correctly without distinct service names because (on
</I>&gt;&gt;<i> &gt;         OEL) I would
</I>&gt;&gt;<i> &gt;          &gt;     expect them to share the same shared memory segments
</I>&gt;&gt;<i> &gt;         (which they must
</I>&gt;&gt;<i> &gt;          &gt;     not do to remain distinct instances).
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     What is your Squid version? Can you tell how your Squids
</I>&gt;&gt;<i> &gt;         name their
</I>&gt;&gt;<i> &gt;          &gt;     shared memory segment &quot;files&quot;? For example, on some Linux
</I>&gt;&gt;<i> &gt;         OSes, those
</I>&gt;&gt;<i> &gt;          &gt;     segments could be in /var/run/shm/ with names like
</I>&gt;&gt;<i> &gt;          &gt;     squid-tr_map_anchors.shm  and squid-tr_spaces.shm.
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     Thank you,
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     Alex.
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;          &gt;     _______________________________________________
</I>&gt;&gt;<i> &gt;          &gt;     squid-users mailing list
</I>&gt;&gt;<i> &gt;          &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> &gt;         &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;
</I>&gt;&gt;<i> &gt;          &gt;     &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> &gt;         &lt;mailto:<A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>&gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt; <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i> &gt;         &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>&gt;
</I>&gt;&gt;<i> &gt;          &gt;     &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i> &gt;         &lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>&gt;&gt;
</I>&gt;&gt;<i> &gt;          &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> squid-users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">squid-users at lists.squid-cache.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">https://lists.squid-cache.org/listinfo/squid-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.squid-cache.org/pipermail/squid-users/attachments/20250313/73b460b0/attachment-0001.htm">http://lists.squid-cache.org/pipermail/squid-users/attachments/20250313/73b460b0/attachment-0001.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027500.html">[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="027503.html">[squid-users] assertion failed: Queue.cc:388: &quot;EX&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27502">[ date ]</a>
              <a href="thread.html#27502">[ thread ]</a>
              <a href="subject.html#27502">[ subject ]</a>
              <a href="author.html#27502">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
