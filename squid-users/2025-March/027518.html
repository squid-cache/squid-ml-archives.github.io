<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] sslcrtvalidator_program input not separated by &quot;\1&quot;?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslcrtvalidator_program%20input%20not%20separated%20by%20%22%5C1%22%3F&In-Reply-To=%3C20250325113747.49b5a01d%40Dagon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027514.html">
   <LINK REL="Next"  HREF="027519.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] sslcrtvalidator_program input not separated by &quot;\1&quot;?</H1>
    <B>Robert 'Bobby' Zenz</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20sslcrtvalidator_program%20input%20not%20separated%20by%20%22%5C1%22%3F&In-Reply-To=%3C20250325113747.49b5a01d%40Dagon%3E"
       TITLE="[squid-users] sslcrtvalidator_program input not separated by &quot;\1&quot;?">Robert.Zenz at bonsaimind.org
       </A><BR>
    <I>Tue Mar 25 10:37:47 UTC 2025</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="027514.html">[squid-users] squid 6.13 debian package
</A></li>
        <LI>Next message (by thread): <A HREF="027519.html">[squid-users] sslcrtvalidator_program input not separated by &quot;\1&quot;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27518">[ date ]</a>
              <a href="thread.html#27518">[ thread ]</a>
              <a href="subject.html#27518">[ subject ]</a>
              <a href="author.html#27518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm currently implementing an extended certificate verification script
for usage with &quot;sslcrtvalidator_program&quot;, but I've encountered a hiccup
during that.

The documentation at
<A HREF="https://wiki.squid-cache.org/Features/SslServerCertValidator#helper-communication-protocol">https://wiki.squid-cache.org/Features/SslServerCertValidator#helper-communication-protocol</A>
is suggesting that the script will receive &quot;lines&quot; which are separated
by a 0x01 byte.

 &gt; Input line received from Squid:
 &gt; 
 &gt;     request size [kv-pairs]
 &gt; 
 &gt;  &gt; :warning: line refers to a logical input. body may contain \n
 &gt;  &gt; characters so each line in this format is delimited by a 0x01 byte
 &gt;  &gt; instead of the standard \n byte.

However, as far as I can tell that's not the case, the
input &quot;lines&quot; are not separated by 0x01. The example script at
<A HREF="https://github.com/squid-cache/squid/blob/master/src/security/cert_validators/fake/security_fake_certverify.pl.in">https://github.com/squid-cache/squid/blob/master/src/security/cert_validators/fake/security_fake_certverify.pl.in</A>
seems to be aware of that, as it reads the input line based on the body
length provided.

My script is written in AWK, basically it can be summed up as:

    BEGIN {
        RS = &quot;\1&quot;
    }
    
    {
        print(&quot;&lt;&quot; $1 &quot;&gt;&quot;)&gt;&quot;/dev/stderr&quot;
        printf(&quot;BH message=\&quot;TEST\&quot;\1&quot;)
    }

And it never starts processing any input from Squid because 0x01 doesn't
seem to be sent at all. I did have a quick look at the helper.cc, and it
doesn't seem to use the &quot;eom&quot; during sending the message at all.

Am I misunderstanding the documentation here? Is my script/approach
broken somehow and do I need to adjust that to read lines based on
provided length?
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="027514.html">[squid-users] squid 6.13 debian package
</A></li>
	<LI>Next message (by thread): <A HREF="027519.html">[squid-users] sslcrtvalidator_program input not separated by &quot;\1&quot;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27518">[ date ]</a>
              <a href="thread.html#27518">[ thread ]</a>
              <a href="subject.html#27518">[ subject ]</a>
              <a href="author.html#27518">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
