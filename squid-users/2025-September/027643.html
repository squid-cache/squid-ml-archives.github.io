<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [squid-users] [NOC] Squid configuration for application running in a docker container
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BNOC%5D%20Squid%20configuration%20for%20application%20running%0A%20in%20a%20docker%20container&In-Reply-To=%3CCA%2BY8hcNHNk9puBt%3DkT-LzV4Bfx_TztKJ6UHVb2c7rbmqY3ap9A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="027644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[squid-users] [NOC] Squid configuration for application running in a docker container</H1>
    <B>Francesco Chemolli</B> 
    <A HREF="mailto:squid-users%40lists.squid-cache.org?Subject=Re%3A%20%5Bsquid-users%5D%20%5BNOC%5D%20Squid%20configuration%20for%20application%20running%0A%20in%20a%20docker%20container&In-Reply-To=%3CCA%2BY8hcNHNk9puBt%3DkT-LzV4Bfx_TztKJ6UHVb2c7rbmqY3ap9A%40mail.gmail.com%3E"
       TITLE="[squid-users] [NOC] Squid configuration for application running in a docker container">gkinkie at gmail.com
       </A><BR>
    <I>Tue Sep  9 20:38:42 UTC 2025</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="027644.html">[squid-users] Error during build of version 7.1 from sources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27643">[ date ]</a>
              <a href="thread.html#27643">[ thread ]</a>
              <a href="subject.html#27643">[ subject ]</a>
              <a href="author.html#27643">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
  is Squid running in the same docker container as the application?
Have you tried using a non-loopback address to connect to squid?

On Sun, Sep 7, 2025 at 10:49&#8239;PM <A HREF="https://lists.squid-cache.org/listinfo/squid-users">Somdatta.Nath at gd-ms.com</A>
&lt;<A HREF="https://lists.squid-cache.org/listinfo/squid-users">Somdatta.Nath at gd-ms.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have downloaded squid proxy application to test java spring webclient proxy setting.  When I am running the application as a java application, I am able to modify squid.conf and pass the netty reactor http request via proxy tunnel.  But when I am running the application in a docker container, the connection to proxy (http:127.0.0.1:3128) is getting refused.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I tried to allow all the traffic as well as allow docker subnet. I have used the following rules.
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # Recommended minimum configuration:
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # Prefer IPv4 addresses first
</I>&gt;<i>
</I>&gt;<i> dns_v4_first on
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> # Example rule allowing access from your local networks.
</I>&gt;<i>
</I>&gt;<i> # Adapt to list your (internal) IP networks from where browsing
</I>&gt;<i>
</I>&gt;<i> # should be allowed
</I>&gt;<i>
</I>&gt;<i> acl localnet src 10.89.0.0/24           # podman kube subnet
</I>&gt;<i>
</I>&gt;<i> acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 &quot;this&quot; network (LAN)
</I>&gt;<i>
</I>&gt;<i> acl localnet src 10.0.0.0/8             # RFC 1918 local private network (LAN)
</I>&gt;<i>
</I>&gt;<i> acl localnet src 100.64.0.0/10          # RFC 6598 shared address space (CGN)
</I>&gt;<i>
</I>&gt;<i> acl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly plugged) machines
</I>&gt;<i>
</I>&gt;<i> #acl localnet src 172.16.0.0/12         # RFC 1918 local private network (LAN)
</I>&gt;<i>
</I>&gt;<i> #acl localnet src 192.168.0.0/16                # RFC 1918 local private network (LAN)
</I>&gt;<i>
</I>&gt;<i> #acl localnet src fc00::/7              # RFC 4193 local private network range
</I>&gt;<i>
</I>&gt;<i> #acl localnet src fe80::/10             # RFC 4291 link-local (directly plugged) machines
</I>&gt;<i>
</I>&gt;<i> acl localhost src 127.0.0.1/32
</I>&gt;<i>
</I>&gt;<i> acl all src all
</I>&gt;<i>
</I>&gt;<i> #acl all src 0.0.0.0/0
</I>&gt;<i>
</I>&gt;<i> #acl to_localhost  dst 127.0.0.1/32
</I>&gt;<i>
</I>&gt;<i> #acl udlsimulator dst 127.0.0.1/32
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> acl SSL_ports port 443
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 80          # http
</I>&gt;<i>
</I>&gt;<i> acl safe_ports port 8080
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 21          # ftp
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 443         # https
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 210         # wais
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 1025-65535  # unregistered ports
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 280         # http-mgmt
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 488         # gss-http
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 591         # filemaker
</I>&gt;<i>
</I>&gt;<i> acl Safe_ports port 777         # multiling http
</I>&gt;<i>
</I>&gt;<i> acl CONNECT method CONNECT
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #Specify hosts file
</I>&gt;<i>
</I>&gt;<i> hosts_file /etc/hosts
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> http_access allow all
</I>&gt;<i>
</I>&gt;<i> http_access allow localnet
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However, the squid proxy is refusing connection to the docker application
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thank you,
</I>&gt;<i>
</I>&gt;<i> Somdatta
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> SW Engineer,
</I>&gt;<i>
</I>&gt;<i> 8201 E McDowell Road,
</I>&gt;<i>
</I>&gt;<i> Scottsdale AZ 85257
</I>&gt;<i>
</I>&gt;<i> Ph:480.441.3703
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This message and/or attachments may include information subject to GDC4S O.M. 1.8.6 and GD Corporate Policy 07-105 and are intended to be accessed only by authorized recipients.  Use, storage and transmission are governed by General Dynamics and its policies. Contractual restrictions apply to third parties.  Recipients should refer to the policies or contract to determine proper handling.  Unauthorized review, use, disclosure or distribution is prohibited.  If you are not an intended recipient, please contact the sender and destroy all copies of the original message.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> NOC mailing list
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/squid-users">NOC at lists.squid-cache.org</A>
</I>&gt;<i> <A HREF="https://lists.squid-cache.org/listinfo/noc">https://lists.squid-cache.org/listinfo/noc</A>
</I>


-- 
    Francesco
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="027644.html">[squid-users] Error during build of version 7.1 from sources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27643">[ date ]</a>
              <a href="thread.html#27643">[ thread ]</a>
              <a href="subject.html#27643">[ subject ]</a>
              <a href="author.html#27643">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.squid-cache.org/listinfo/squid-users">More information about the squid-users
mailing list</a><br>
</body></html>
