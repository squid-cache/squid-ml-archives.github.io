<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Il&nbsp;29/10/2014&nbsp;12:01,&nbsp;Amos&nbsp;Jeffries&nbsp;ha&nbsp;scritto:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;On&nbsp;29/10/2014&nbsp;11:09&nbsp;p.m.,&nbsp;Claudio&nbsp;ML&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Hello&nbsp;all,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;strange&nbsp;problem&nbsp;with&nbsp;a&nbsp;SQUID&nbsp;proxy&nbsp;with&nbsp;the&nbsp;NTLM&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;word&nbsp;is&nbsp;&quot;Squid&quot;,&nbsp;it&nbsp;is&nbsp;a&nbsp;name&nbsp;not&nbsp;an&nbsp;acronym.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;authentication.&nbsp;It&nbsp;randomly&nbsp;restarts&nbsp;the&nbsp;authenticator<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processes&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;(restart&nbsp;maybe&nbsp;not&nbsp;the&nbsp;right&nbsp;term),&nbsp;as&nbsp;follows:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Randomly?&nbsp;no,&nbsp;when&nbsp;an&nbsp;authenticator&nbsp;dies/aborts&nbsp;Squid&nbsp;starts&nbsp;a&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replacement&nbsp;one.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Question&nbsp;is&nbsp;why&nbsp;they&nbsp;are&nbsp;dying.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Perhapse&nbsp;you&nbsp;could&nbsp;start&nbsp;by&nbsp;indicating&nbsp;what&nbsp;version&nbsp;of&nbsp;Squid&nbsp;you<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;are&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;My&nbsp;Squid&nbsp;version&nbsp;is&nbsp;3.2.11&nbsp;(OpenSuSE&nbsp;12.3)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;snip&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2014-10-29T10:45:02.649164+01:00&nbsp;yel1swa208&nbsp;squid[29306]:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starting&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;new&nbsp;ntlmauthenticator&nbsp;helpers...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2014-10-29T10:45:02.650165+01:00&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;yel1swa208&nbsp;squid[29306]:&nbsp;helperOpenServers:&nbsp;Starting&nbsp;1/800&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;'ntlm_auth'&nbsp;processes&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Not&nbsp;sure&nbsp;if&nbsp;is&nbsp;a&nbsp;result&nbsp;of&nbsp;this,&nbsp;but&nbsp;after&nbsp;10-20&nbsp;mins&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;authentication&nbsp;process&nbsp;with&nbsp;ntlm&nbsp;slows&nbsp;down&nbsp;terribly&nbsp;(tested<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;wbinfo&nbsp;-t),&nbsp;and&nbsp;the&nbsp;users&nbsp;have&nbsp;some&nbsp;serious&nbsp;problem&nbsp;with&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;navigation.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Follows&nbsp;the&nbsp;relevant&nbsp;part&nbsp;of&nbsp;squid.conf:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#&nbsp;Ntlm&nbsp;Auth&nbsp;auth_param&nbsp;ntlm&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--helper-protocol=squid-2.5-ntlmssp&nbsp;--debuglevel=0&nbsp;auth_param<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntlm&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;children&nbsp;800&nbsp;#auth&nbsp;param&nbsp;ntlm&nbsp;keep_alive&nbsp;off&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is&nbsp;the&nbsp;Samba&nbsp;helper,&nbsp;so&nbsp;any&nbsp;bugs&nbsp;inside&nbsp;it&nbsp;are&nbsp;Samba<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;problems.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Squid&nbsp;for&nbsp;NTLM&nbsp;is&nbsp;just&nbsp;a&nbsp;&quot;dumb&nbsp;relay&quot;&nbsp;passing&nbsp;the&nbsp;HTTP&nbsp;request<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;to&nbsp;the&nbsp;helper(s)&nbsp;and&nbsp;relaying&nbsp;their&nbsp;responses&nbsp;back&nbsp;to&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;in&nbsp;HTTP&nbsp;reply&nbsp;headers.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;might&nbsp;still&nbsp;be&nbsp;bugs&nbsp;in&nbsp;the&nbsp;relaying&nbsp;logic&nbsp;though.&nbsp;But&nbsp;to&nbsp;me<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sounds&nbsp;like&nbsp;the&nbsp;helpers&nbsp;having&nbsp;issues.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Where&nbsp;into&nbsp;log&nbsp;files&nbsp;i&nbsp;can&nbsp;look&nbsp;if&nbsp;helpers&nbsp;have&nbsp;issues?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&gt;&nbsp;authenticate_ttl&nbsp;3&nbsp;hour<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authenticate_ip_ttl&nbsp;3&nbsp;hour&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#&nbsp;Base&nbsp;Auth&nbsp;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--helper-protocol=squid-2.5-basic&nbsp;auth_param&nbsp;basic&nbsp;children<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;200&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;auth_param&nbsp;basic&nbsp;realm&nbsp;Squid&nbsp;proxy-caching&nbsp;web&nbsp;server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auth_param&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;And&nbsp;the&nbsp;relevant&nbsp;part&nbsp;of&nbsp;smb.conf:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;allow&nbsp;trusted&nbsp;domains&nbsp;=&nbsp;Yes&nbsp;winbind&nbsp;nested&nbsp;groups&nbsp;=&nbsp;Yes&nbsp;wins<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;=&nbsp;x.x.x.x&nbsp;winbind&nbsp;uid&nbsp;=&nbsp;40000-90000000000000&nbsp;winbind&nbsp;gid&nbsp;=&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;4000-100000000000000&nbsp;winbind&nbsp;use&nbsp;default&nbsp;domain&nbsp;=&nbsp;yes&nbsp;winbind<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enum&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;users&nbsp;=&nbsp;yes&nbsp;winbind&nbsp;enum&nbsp;groups&nbsp;=&nbsp;yes&nbsp;winbind&nbsp;cache&nbsp;time&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;winbind&nbsp;max&nbsp;clients&nbsp;=&nbsp;600&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;is&nbsp;a&nbsp;big&nbsp;hint.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â max&nbsp;clients&nbsp;600&nbsp;vs.&nbsp;800&nbsp;configured&nbsp;Squid&nbsp;helpers&nbsp;...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;are&nbsp;right,&nbsp;now&nbsp;my&nbsp;config&nbsp;is&nbsp;800&nbsp;as&nbsp;max&nbsp;clients&nbsp;on&nbsp;samba,&nbsp;and&nbsp;800<br>
&nbsp;&nbsp;&nbsp;&nbsp;Squid&nbsp;helpers.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thank&nbsp;you,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Claudio.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Amos&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
