<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;23&nbsp;January&nbsp;2015&nbsp;at&nbsp;16:40,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&lt;br&gt;<br>
Hash:&nbsp;SHA1&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;24/01/2015&nbsp;2:20&nbsp;a.m.,&nbsp;Odhiambo&nbsp;Washington&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;23&nbsp;January&nbsp;2015&nbsp;at&nbsp;16:07,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;Hash:&nbsp;SHA1&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;On&nbsp;24/01/2015&nbsp;1:47&nbsp;a.m.,&nbsp;Yuri&nbsp;Voinov&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Once&nbsp;more.&nbsp;You&nbsp;CANNOT&nbsp;have&nbsp;neither&nbsp;web-server&nbsp;nor&nbsp;other&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;service&nbsp;with&nbsp;listening&nbsp;port&nbsp;80&nbsp;on&nbsp;the&nbsp;same&nbsp;host&nbsp;as&nbsp;transparent&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Squid&nbsp;proxy.&nbsp;This&nbsp;is&nbsp;one&nbsp;and&nbsp;only&nbsp;reason&nbsp;you&nbsp;have&nbsp;looping.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;That&nbsp;is&nbsp;not&nbsp;correct.&nbsp;It&nbsp;can&nbsp;be&nbsp;done,&nbsp;but&nbsp;depends&nbsp;on&nbsp;how&nbsp;the&lt;br&gt;<br>
&gt;&gt;&nbsp;firewall&nbsp;operates&nbsp;and&nbsp;what&nbsp;ruleset&nbsp;is&nbsp;used.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;One&nbsp;has&nbsp;to&nbsp;intercept&nbsp;traffic&nbsp;transiting&nbsp;the&nbsp;machine,&nbsp;but&nbsp;ignore&lt;br&gt;<br>
&gt;&gt;&nbsp;traffic&nbsp;destined&nbsp;*to*&nbsp;or&nbsp;*from*&nbsp;the&nbsp;local&nbsp;machines&nbsp;running&lt;br&gt;<br>
&gt;&gt;&nbsp;processes.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Look.&nbsp;On&nbsp;my&nbsp;transparent&nbsp;3.4.11&nbsp;(which&nbsp;was&nbsp;early&nbsp;2.7)&nbsp;IPFilter&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;redirects&nbsp;80&nbsp;port&nbsp;to&nbsp;proxy.&nbsp;My&nbsp;web&nbsp;server&nbsp;on&nbsp;the&nbsp;same&nbsp;host&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;listens&nbsp;only&nbsp;8080,&nbsp;8088&nbsp;and&nbsp;8888&nbsp;ports.&nbsp;No&nbsp;one&nbsp;service&nbsp;except&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;NAT&nbsp;is&nbsp;using&nbsp;80&nbsp;port.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;And&nbsp;finally&nbsp;I&nbsp;have&nbsp;no&nbsp;looping&nbsp;4&nbsp;years.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Obvious,&nbsp;is&nbsp;it?&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Maybe&nbsp;there&nbsp;was,&nbsp;maybe&nbsp;there&nbsp;wasn&#39;t.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Squid-2.7&nbsp;ignored&nbsp;a&nbsp;lot&nbsp;of&nbsp;NAT&nbsp;related&nbsp;errors&nbsp;and&nbsp;even&nbsp;silently&lt;br&gt;<br>
&gt;&gt;&nbsp;did&nbsp;some&nbsp;Very&nbsp;Bad&nbsp;Things(tm)&nbsp;-&nbsp;none&nbsp;of&nbsp;which&nbsp;Squid-3.2+&nbsp;will&lt;br&gt;<br>
&gt;&gt;&nbsp;allow&nbsp;to&nbsp;happen&nbsp;anymore.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Odhiambo:&nbsp;I&nbsp;suspect&nbsp;it&nbsp;might&nbsp;be&nbsp;related&nbsp;to&nbsp;your&nbsp;use&nbsp;of&nbsp;&quot;rdr&quot;&lt;br&gt;<br>
&gt;&gt;&nbsp;firewall&nbsp;rules.&nbsp;In&nbsp;OpenBSD&nbsp;PF&nbsp;at&nbsp;least&nbsp;rdr&nbsp;rules&nbsp;do&nbsp;not&nbsp;work&lt;br&gt;<br>
&gt;&gt;&nbsp;properly&nbsp;and&nbsp;divert-to&nbsp;rules&nbsp;needs&nbsp;to&nbsp;be&nbsp;used&nbsp;instead&nbsp;(divert-to&lt;br&gt;<br>
&gt;&gt;&nbsp;can&nbsp;be&nbsp;used&nbsp;for&nbsp;either&nbsp;TPROXY&nbsp;or&nbsp;NAT&nbsp;Squid&nbsp;listening&nbsp;ports&nbsp;on&lt;br&gt;<br>
&gt;&gt;&nbsp;BSD).&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;thinking&nbsp;Squid-3.2+&nbsp;is&nbsp;evil&nbsp;:-)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Anyway,&nbsp;my&nbsp;PF&nbsp;rules&nbsp;are&nbsp;here&nbsp;:&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/pKv1jN2v&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/pKv1jN2v&lt;/a&gt;&nbsp;And&nbsp;my&lt;br&gt;<br>
&gt;&nbsp;IPFilter&nbsp;rules&nbsp;are&nbsp;here:&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/JQ77X01H&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/JQ77X01H&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;need&nbsp;to&nbsp;figure&nbsp;out&nbsp;why&nbsp;squid&nbsp;is&nbsp;DENYing&nbsp;all&nbsp;access&nbsp;..&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;Can&nbsp;you&nbsp;update&nbsp;me&nbsp;on&nbsp;what&nbsp;the&nbsp;squid&nbsp;-v&nbsp;output&nbsp;is&nbsp;from&nbsp;the&nbsp;Squid&nbsp;build&lt;br&gt;<br>
you&nbsp;are&nbsp;having&nbsp;issues&nbsp;with&nbsp;pleae?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
Amos&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@mail:/usr/src&nbsp;#&nbsp;/opt/squid35/sbin/squid&nbsp;-v&lt;/div&gt;&lt;div&gt;Squid&nbsp;Cache:&nbsp;Version&nbsp;3.5.1-20150120-r13736&lt;/div&gt;&lt;div&gt;Service&nbsp;Name:&nbsp;squid&lt;/div&gt;&lt;div&gt;configure&nbsp;options:&nbsp; &#39;--prefix=/opt/squid35&#39;&nbsp;&#39;--enable-removal-policies=lru&nbsp;heap&#39;&nbsp;&#39;--disable-epoll&#39;&nbsp;&#39;--enable-auth&#39;&nbsp;&#39;--enable-auth-basic=DB&nbsp;NCSA&nbsp;PAM&nbsp;PAM&nbsp;POP3&nbsp;SSPI&#39;&nbsp;&#39;--enable-external-acl-helpers=session&nbsp;unix_group&nbsp;file_userip&#39;&nbsp;&#39;--enable-auth-negotiate=kerberos&#39;&nbsp;&#39;--with-pthreads&#39;&nbsp;&#39;--enable-storeio=ufs&nbsp;diskd&nbsp;rock&nbsp;aufs&#39;&nbsp;&#39;--enable-delay-pools&#39;&nbsp;&#39;--enable-snmp&#39;&nbsp;&#39;--with-openssl=/usr&#39;&nbsp;&#39;--enable-forw-via-db&#39;&nbsp;&#39;--enable-cache-digests&#39;&nbsp;&#39;--enable-wccpv2&#39;&nbsp;&#39;--enable-follow-x-forwarded-for&#39;&nbsp;&#39;--with-large-files&#39;&nbsp;&#39;--enable-large-cache-files&#39;&nbsp;&#39;--enable-esi&#39;&nbsp;&#39;--enable-kqueue&#39;&nbsp;&#39;--enable-icap-client&#39;&nbsp;&#39;--enable-kill-parent-hack&#39;&nbsp;&#39;--enable-ssl&#39;&nbsp;&#39;--enable-leakfinder&#39;&nbsp;&#39;--enable-ssl-crtd&#39;&nbsp;&#39;--enable-url-rewrite-helpers&#39;&nbsp;&#39;--enable-xmalloc-statistics&#39;&nbsp;&#39;--enable-stacktraces&#39;&nbsp;&#39;--enable-zph-qos&#39;&nbsp;&#39;--enable-eui&#39;&nbsp;&#39;--enable-pf-transparent&#39;&nbsp;&#39;CC=clang&#39;&nbsp;&#39;CXX=clang++&#39;&nbsp;--enable-ltdl-convenience&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;Best&nbsp;regards,&lt;br&gt;Odhiambo&nbsp;WASHINGTON,&lt;br&gt;Nairobi,KE&lt;br&gt;+254733744121/+254722743223&lt;br&gt;&quot;I&nbsp;can&#39;t&nbsp;hear&nbsp;you&nbsp;--&nbsp;I&#39;m&nbsp;using&nbsp;the&nbsp;scrambler.&quot;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
