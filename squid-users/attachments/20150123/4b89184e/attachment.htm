<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;So&nbsp;for&nbsp;the&nbsp;past&nbsp;few&nbsp;days&nbsp;I&nbsp;have&nbsp;been&nbsp;struggling&nbsp;with&nbsp;Squid&nbsp;in&nbsp;intercept&nbsp;mode&nbsp;on&nbsp;FreeBSD-10.1.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Using&nbsp;the&nbsp;same&nbsp;squid.conf&nbsp;for&nbsp;Squid-3.4.10&nbsp;and&nbsp;Squid-3.5.1&nbsp;and&nbsp;the&nbsp;same&nbsp;Firewall&nbsp;rules&nbsp;(I&nbsp;have&nbsp;tested&nbsp;with&nbsp;IPFilter&nbsp;and&nbsp;PF&nbsp;and&nbsp;these&nbsp;rules&nbsp;work&nbsp;with&nbsp;Squid-2.7.9&nbsp;on&nbsp;several&nbsp;FreeBSD&nbsp;boxes&nbsp;that&nbsp;I&nbsp;have):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;Squid-3.5.1&nbsp;has&nbsp;completely&nbsp;refused&nbsp;to&nbsp;play&nbsp;along&nbsp;-&nbsp;always&nbsp;complaining&nbsp;about&nbsp;&quot;loop&nbsp;detected&quot;&nbsp;and&nbsp;hence&nbsp;denying&nbsp;all&nbsp;requests&lt;/div&gt;&lt;div&gt;2.&nbsp;Squid-3.4.10&nbsp;plays&nbsp;along,&nbsp;BUT&nbsp;has&nbsp;so&nbsp;much&nbsp;complaints&nbsp;in&nbsp;cache.log&nbsp;as&nbsp;below:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Set&nbsp;Current&nbsp;Directory&nbsp;to&nbsp;/usr/local/squid/logs&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Set&nbsp;Current&nbsp;Directory&nbsp;to&nbsp;/usr/local/squid/logs&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Starting&nbsp;Squid&nbsp;Cache&nbsp;version&nbsp;3.4.10&nbsp;for&nbsp;amd64-portbld-freebsd10.1...&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Process&nbsp;ID&nbsp;15770&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Process&nbsp;Roles:&nbsp;master&nbsp;worker&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;With&nbsp;114417&nbsp;file&nbsp;descriptors&nbsp;available&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Initializing&nbsp;IP&nbsp;Cache...&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;DNS&nbsp;Socket&nbsp;created&nbsp;at&nbsp;[::],&nbsp;FD&nbsp;5&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;DNS&nbsp;Socket&nbsp;created&nbsp;at&nbsp;0.0.0.0,&nbsp;FD&nbsp;6&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Adding&nbsp;domain&nbsp;&lt;a&nbsp;href=&quot;http://ili.or.ug&quot;&gt;ili.or.ug&lt;/a&gt;&nbsp;from&nbsp;/etc/resolv.conf&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Adding&nbsp;nameserver&nbsp;127.0.0.1&nbsp;from&nbsp;/etc/resolv.conf&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;helperOpenServers:&nbsp;Starting&nbsp;5/15&nbsp;&#39;ssl_crtd&#39;&nbsp;processes&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;helperOpenServers:&nbsp;Starting&nbsp;10/15&nbsp;&#39;ut-squidbooster&#39;&nbsp;processes&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Logfile:&nbsp;opening&nbsp;log&nbsp;stdio:/usr/local/squid/logs/access.log&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Local&nbsp;cache&nbsp;digest&nbsp;enabled;&nbsp;rebuild/rewrite&nbsp;every&nbsp;3600/3600&nbsp;sec&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Store&nbsp;logging&nbsp;disabled&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Swap&nbsp;maxSize&nbsp;104857600&nbsp;+&nbsp;131072&nbsp;KB,&nbsp;estimated&nbsp;8076051&nbsp;objects&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Target&nbsp;number&nbsp;of&nbsp;buckets:&nbsp;403802&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Using&nbsp;524288&nbsp;Store&nbsp;buckets&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Max&nbsp;Mem&nbsp; size:&nbsp;131072&nbsp;KB&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Max&nbsp;Swap&nbsp;size:&nbsp;104857600&nbsp;KB&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Rebuilding&nbsp;storage&nbsp;in&nbsp;/usr/local/squid/cache&nbsp;(dirty&nbsp;log)&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Using&nbsp;Least&nbsp;Load&nbsp;store&nbsp;dir&nbsp;selection&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Set&nbsp;Current&nbsp;Directory&nbsp;to&nbsp;/usr/local/squid/logs&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Finished&nbsp;loading&nbsp;MIME&nbsp;types&nbsp;and&nbsp;icons.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;HTCP&nbsp;Disabled.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Pinger&nbsp;socket&nbsp;opened&nbsp;on&nbsp;FD&nbsp;45&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Squid&nbsp;plugin&nbsp;modules&nbsp;loaded:&nbsp;0&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Adaptation&nbsp;support&nbsp;is&nbsp;off.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Accepting&nbsp;NAT&nbsp;intercepted&nbsp;HTTP&nbsp;Socket&nbsp;connections&nbsp;at&nbsp;local=[::]:13128&nbsp;remote=[::]&nbsp;FD&nbsp;40&nbsp;flags=41&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Accepting&nbsp;HTTP&nbsp;Socket&nbsp;connections&nbsp;at&nbsp;local=[::]:13127&nbsp;remote=[::]&nbsp;FD&nbsp;41&nbsp;flags=9&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Accepting&nbsp;NAT&nbsp;intercepted&nbsp;SSL&nbsp;bumped&nbsp;HTTPS&nbsp;Socket&nbsp;connections&nbsp;at&nbsp;local=[::]:13129&nbsp;remote=[::]&nbsp;FD&nbsp;42&nbsp;flags=41&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Accepting&nbsp;ICP&nbsp;messages&nbsp;on&nbsp;[::]:3130&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Sending&nbsp;ICP&nbsp;messages&nbsp;from&nbsp;[::]:3130&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;pinger:&nbsp;Initialising&nbsp;ICMP&nbsp;pinger&nbsp;...&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;pinger:&nbsp;ICMP&nbsp;socket&nbsp;opened.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;pinger:&nbsp;ICMPv6&nbsp;socket&nbsp;opened&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Store&nbsp;rebuilding&nbsp;is&nbsp;50.88%&nbsp;complete&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Done&nbsp;reading&nbsp;/usr/local/squid/cache&nbsp;swaplog&nbsp;(7861&nbsp;entries)&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Finished&nbsp;rebuilding&nbsp;storage&nbsp;from&nbsp;disk.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; 7845&nbsp;Entries&nbsp;scanned&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp;Invalid&nbsp;entries.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp;With&nbsp;invalid&nbsp;flags.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; 7829&nbsp;Objects&nbsp;loaded.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp;Objects&nbsp;expired.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; 16&nbsp;Objects&nbsp;cancelled.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp;Duplicate&nbsp;URLs&nbsp;purged.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp;Swapfile&nbsp;clashes&nbsp;avoided.&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp;Took&nbsp;0.05&nbsp;seconds&nbsp;(168735.72&nbsp;objects/sec).&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp;Beginning&nbsp;Validation&nbsp;Procedure&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp;Completed&nbsp;Validation&nbsp;Procedure&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp;Validated&nbsp;7829&nbsp;Entries&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:43|&nbsp; &nbsp;store_swap_size&nbsp;=&nbsp;457188.00&nbsp;KB&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:44|&nbsp;storeLateRelease:&nbsp;released&nbsp;0&nbsp;objects&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804ce9b78&nbsp;dns_internal.cc:1131&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804b1d7d8&nbsp;ipcache.cc:353&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8048b2698&nbsp;Checklist.cc:45&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804b1d7d8&nbsp;Checklist.cc:160&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804b1b618&nbsp;helper.cc:856&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804b1d7d8&nbsp;redirect.cc:176&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:47|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8049e9498&nbsp;store_client.cc:337&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804ce9b78&nbsp;ipcache.cc:353&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8048b27d8&nbsp;Checklist.cc:45&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8094c8058&nbsp;store_client.cc:154&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8049e9498&nbsp;store_client.cc:337&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8049e9498&nbsp;store_client.cc:337&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8094c6058&nbsp;CommCalls.cc:21&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8094c8058&nbsp;store_client.cc:154&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8049e9498&nbsp;store_client.cc:337&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804ab8458&nbsp;CommCalls.cc:21&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8094c8058&nbsp;store_client.cc:154&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8049e9498&nbsp;store_client.cc:337&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x804b1d718&nbsp;clientStream.cc:235&lt;/div&gt;&lt;div&gt;2015/01/23&nbsp;13:26:48|&nbsp;CBDATA&nbsp;memory&nbsp;leak.&nbsp;cbdata=0x8048b2558&nbsp;Checklist.cc:320&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;running&nbsp;squid&nbsp;like:&lt;/div&gt;&lt;div&gt;/usr/local/sbin/squid&nbsp;-f&nbsp;/usr/local/etc/squid/squid.conf&nbsp;-N&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;do&nbsp;not&nbsp;see&nbsp;any&nbsp;coredumps&nbsp;with&nbsp;this&nbsp;scenario&nbsp;even&nbsp;when&nbsp;I&nbsp;run&nbsp;with&nbsp;-NCd1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;the&nbsp;time&nbsp;being&nbsp;I&nbsp;have&nbsp;opted&nbsp;to&nbsp;run&nbsp;squid&nbsp;with&nbsp;cache_log&nbsp;set&nbsp;to&nbsp;/dev/null.&nbsp;Not&nbsp;elegant&nbsp;at&nbsp;all.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;my&nbsp;questions:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;anyone&nbsp;else&nbsp;here&nbsp;successfully&nbsp;running&nbsp;squid&nbsp;(3.4.10&nbsp;or&nbsp;3.5.x)&nbsp;in&nbsp;intercept&nbsp;mode&nbsp;on&nbsp;FreeBSD&nbsp;10.x&nbsp;using&nbsp;either&nbsp;PF&nbsp;or&nbsp;IPFilter?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;d&nbsp;really&nbsp;love&nbsp;to&nbsp;compare&nbsp;notes.&nbsp;Maybe&nbsp;that&nbsp;will&nbsp;help&nbsp;clear&nbsp;my&nbsp;current&nbsp;brain-lock!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Technically,&nbsp;I&nbsp;have&nbsp;reached&nbsp;my&nbsp;/etc&nbsp;on&nbsp;this&nbsp;one.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;squid.conf&nbsp;is&nbsp;available&nbsp;at &lt;a&nbsp;href=&quot;http://pastebin.com/L16cDmRp&quot;&gt;http://pastebin.com/L16cDmRp&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;Best&nbsp;regards,&lt;br&gt;Odhiambo&nbsp;WASHINGTON,&lt;br&gt;Nairobi,KE&lt;br&gt;+254733744121/+254722743223&lt;br&gt;&quot;I&nbsp;can&#39;t&nbsp;hear&nbsp;you&nbsp;--&nbsp;I&#39;m&nbsp;using&nbsp;the&nbsp;scrambler.&quot;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
