<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hash:&nbsp;SHA1&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;First.&nbsp;Where&nbsp;is&nbsp;you&nbsp;cache&nbsp;can&nbsp;found&nbsp;openssl&nbsp;public&nbsp;CA&nbsp;certs?&nbsp;To<br>
&nbsp;&nbsp;&nbsp;&nbsp;validate&nbsp;connection&nbsp;from&nbsp;cache&nbsp;to&nbsp;server&nbsp;Squid&nbsp;must&nbsp;see&nbsp;root<br>
&nbsp;&nbsp;&nbsp;&nbsp;authority&nbsp;CA's.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I.e&nbsp;(from&nbsp;my&nbsp;configuration.&nbsp;Note:&nbsp;all&nbsp;google&nbsp;services&nbsp;bumped&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;works&nbsp;perfectly):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;https_port&nbsp;3129&nbsp;intercept&nbsp;ssl-bump&nbsp;generate-host-certificates=on<br>
&nbsp;&nbsp;&nbsp;&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/usr/local/squid/etc/rootCA.crt<br>
&nbsp;&nbsp;&nbsp;&nbsp;key=/usr/local/squid/etc/rootCA.key&nbsp;capath=/etc/opt/csw/ssl/certs&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Second.&nbsp;OpenSSL&nbsp;CA's&nbsp;bundle&nbsp;is&nbsp;not&nbsp;complete.&nbsp;You&nbsp;must&nbsp;add&nbsp;ALL<br>
&nbsp;&nbsp;&nbsp;&nbsp;intermediate&nbsp;and&nbsp;absent&nbsp;root&nbsp;CA's&nbsp;and&nbsp;make&nbsp;c_rehash.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Third.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Where&nbsp;is&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sslproxy_cert_error&nbsp;allow&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sslproxy_flags&nbsp;DONT_VERIFY_PEER&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;your&nbsp;configuration?&nbsp;Yes,&nbsp;this&nbsp;is&nbsp;dangerous,&nbsp;but&nbsp;permit&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;suppress&nbsp;errors&nbsp;on&nbsp;some&nbsp;sites.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;finally&nbsp;-&nbsp;you&nbsp;can't&nbsp;bypass&nbsp;ssl&nbsp;bump&nbsp;on&nbsp;3.4.x&nbsp;using&nbsp;dstdomain<br>
&nbsp;&nbsp;&nbsp;&nbsp;ACL's.&nbsp;Only&nbsp;IP-based&nbsp;DST&nbsp;acl's&nbsp;usable.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Regards,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Yuri.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;06.02.2015&nbsp;11:10,&nbsp;Luis&nbsp;Miguel&nbsp;Silva&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&nbsp;Dear&nbsp;all,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;I&nbsp;recently&nbsp;compiled&nbsp;squid-3.4.9&nbsp;with&nbsp;ssl-bump&nbsp;support&nbsp;and,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;although&nbsp;it&nbsp;is&nbsp;working&nbsp;for&nbsp;the&nbsp;most&nbsp;part,&nbsp;I'm&nbsp;having&nbsp;some&nbsp;issues<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accessing&nbsp;some&nbsp;websites.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;The&nbsp;behavior&nbsp;is&nbsp;REALLY&nbsp;weird&nbsp;so&nbsp;I'm&nbsp;going&nbsp;to&nbsp;try&nbsp;and&nbsp;describe<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;the&nbsp;best&nbsp;I&nbsp;can:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;If&nbsp;i&nbsp;access&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com/&lt;/a&gt;&nbsp;in&nbsp;Chrome,&nbsp;I&nbsp;could&nbsp;see<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;it&nbsp;was&nbsp;processing&nbsp;my&nbsp;certificate&nbsp;MOST&nbsp;of&nbsp;the&nbsp;times...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;*screenshot&nbsp;here*:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg&quot;&gt;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;some&nbsp;other&nbsp;times,&nbsp;it&nbsp;seemed&nbsp;to&nbsp;bypass&nbsp;my&nbsp;proxy&nbsp;altogether<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;I&nbsp;finally&nbsp;figured&nbsp;out&nbsp;it&nbsp;was&nbsp;because&nbsp;Chrome&nbsp;will&nbsp;try&nbsp;to&nbsp;access<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUIC&nbsp;enabled&nbsp;websites&nbsp;using&nbsp;that&nbsp;protocol,&nbsp;so&nbsp;it&nbsp;would&nbsp;bypass&nbsp;my<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firewall&nbsp;redirect&nbsp;rules!&nbsp;I&nbsp;believe&nbsp;I&nbsp;now&nbsp;have&nbsp;solved&nbsp;this&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocking&nbsp;FORWARDING&nbsp;traffic&nbsp;on&nbsp;port&nbsp;443&nbsp;udp...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;the&nbsp;weird&nbsp;thing&nbsp;is&nbsp;that,&nbsp;if&nbsp;I&nbsp;then&nbsp;try&nbsp;and&nbsp;access<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://gmail.com&quot;&gt;https://gmail.com&lt;/a&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;https://gmail.com/&quot;&gt;&lt;https://gmail.com/&gt;&lt;/a&gt;,&nbsp;I&nbsp;get&nbsp;a&nbsp;certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;*screenshot&nbsp;here*:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg#1&quot;&gt;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg#1&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;...though,&nbsp;sometimes,&nbsp;I&nbsp;can&nbsp;access&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://mail.gmail.com/&quot;&gt;https://mail.gmail.com/&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just&nbsp;fine&nbsp;(without&nbsp;any&nbsp;certificate&nbsp;errors),&nbsp;but&nbsp;stop&nbsp;being&nbsp;able&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&nbsp;try&nbsp;to&nbsp;access&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://gmail.com/&quot;&gt;https://gmail.com/&lt;/a&gt;&nbsp;and&nbsp;the&nbsp;browser<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complains&nbsp;about&nbsp;the&nbsp;certificate.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--&nbsp;and,&nbsp;according&nbsp;to&nbsp;my&nbsp;tests,&nbsp;I&nbsp;can&nbsp;access&nbsp;it&nbsp;from&nbsp;firefox<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just&nbsp;fine&nbsp;MOST&nbsp;of&nbsp;the&nbsp;times:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;*screenshot&nbsp;here*:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg#2&quot;&gt;http://imgur.com/JsNiqDL,Ned5zAU,nJjRPtg#2&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--&nbsp;though&nbsp;I&nbsp;have&nbsp;also&nbsp;seen&nbsp;situations&nbsp;where&nbsp;Firefox&nbsp;also<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complains&nbsp;about&nbsp;a&nbsp;certificate&nbsp;error&nbsp;when&nbsp;connecting&nbsp;to&nbsp;gmail.com<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;http://gmail.com/&quot;&gt;&lt;http://gmail.com/&gt;&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;and,&nbsp;although&nbsp;I&nbsp;cannot&nbsp;reproduce&nbsp;it&nbsp;100%&nbsp;of&nbsp;the&nbsp;times,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sometimes,&nbsp;even&nbsp;though&nbsp;I&nbsp;have&nbsp;my&nbsp;iptables&nbsp;redirect&nbsp;rules&nbsp;ON,&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;browser&nbsp;still&nbsp;seems&nbsp;to&nbsp;&quot;connect&nbsp;direct&quot;&nbsp;(or,&nbsp;at&nbsp;least,&nbsp;it&nbsp;shows&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has&nbsp;the&nbsp;original&nbsp;certificate)!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--&nbsp;like&nbsp;I&nbsp;said,&nbsp;at&nbsp;first,&nbsp;I&nbsp;was&nbsp;able&nbsp;to&nbsp;trace&nbsp;this&nbsp;back&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUIC&nbsp;in&nbsp;Chrome&nbsp;but...I'm&nbsp;currently&nbsp;blocking&nbsp;traffic&nbsp;on&nbsp;port&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;udp&nbsp;so&nbsp;I&nbsp;don't&nbsp;know&nbsp;what's&nbsp;happening&nbsp;here&nbsp;(does&nbsp;it&nbsp;use&nbsp;different<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports?!)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt; &nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;So,&nbsp;here&nbsp;are&nbsp;*my&nbsp;questions*:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;why&nbsp;am&nbsp;I&nbsp;able&nbsp;to&nbsp;successfully&nbsp;ssl-bump<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.google.com&quot;&gt;https://www.google.com&lt;/a&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;https://www.google.com/&quot;&gt;&lt;https://www.google.com/&gt;&lt;/a&gt;&nbsp;but&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://gmail.com/&quot;&gt;https://gmail.com/&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;why&nbsp;does&nbsp;the&nbsp;Chrome&nbsp;freakout&nbsp;about&nbsp;gmail&nbsp;but&nbsp;not&nbsp;Firefox?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;fix&nbsp;it&nbsp;OR,&nbsp;at&nbsp;least,&nbsp;to&nbsp;bypass&nbsp;it?&nbsp;(I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tried&nbsp;creating&nbsp;an&nbsp;ACL&nbsp;for&nbsp;this&nbsp;and&nbsp;allowing&nbsp;direct&nbsp;traffic&nbsp;but&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;didn't&nbsp;seem&nbsp;to&nbsp;work...)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;--&nbsp;can&nbsp;we&nbsp;make&nbsp;the&nbsp;connection&nbsp;go&nbsp;direct&nbsp;when&nbsp;ssl&nbsp;certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors&nbsp;are&nbsp;detected?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;-&nbsp;and&nbsp;has&nbsp;anyone&nbsp;else&nbsp;seen&nbsp;this&nbsp;problem&nbsp;where&nbsp;the&nbsp;browser<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seems&nbsp;to&nbsp;use&nbsp;the&nbsp;original&nbsp;certificate,&nbsp;even&nbsp;though&nbsp;I'm&nbsp;redirecting<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traffic&nbsp;to&nbsp;Squid?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;relevant,&nbsp;but&nbsp;here&nbsp;are&nbsp;some&nbsp;ssl&nbsp;errors&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;caught&nbsp;on&nbsp;my&nbsp;cache.log&nbsp;file:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;root@server:/var/log/squid3#&nbsp;tail&nbsp;cache.log&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:47:52&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;30:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:48:23&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;30:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:48:36&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;96:&nbsp;error:14094418:SSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routines:SSL3_READ_BYTES:tlsv1&nbsp;alert&nbsp;unknown&nbsp;ca&nbsp;(1/0)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:48:54&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;105:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:49:15&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;79:&nbsp;Broken&nbsp;pipe&nbsp;(32)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:49:15&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;54:&nbsp;Broken&nbsp;pipe&nbsp;(32)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:49:24&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;79:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:49:55&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;26:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:50:26&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;45:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015/02/05&nbsp;21:50:56&nbsp;kid1|&nbsp;clientNegotiateSSL:&nbsp;Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;68:&nbsp;Closed&nbsp;by&nbsp;client&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;root@server:/var/log/squid3#&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;By&nbsp;the&nbsp;way,&nbsp;here's&nbsp;how&nbsp;I&nbsp;generated&nbsp;my&nbsp;certificate:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;openssl&nbsp;req&nbsp;-new&nbsp;-newkey&nbsp;rsa:1024&nbsp;-days&nbsp;365&nbsp;-nodes&nbsp;-x509<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-keyout&nbsp;myCA.pem&nbsp;-out&nbsp;myCA.pem&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;openssl&nbsp;x509&nbsp;-in&nbsp;myCA.pem&nbsp;-outform&nbsp;DER&nbsp;-out&nbsp;certificate.der&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;(note:&nbsp;myCA.pem&nbsp;is&nbsp;the&nbsp;certificate&nbsp;that&nbsp;squid&nbsp;is&nbsp;using&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;certificate.der&nbsp;is&nbsp;the&nbsp;one&nbsp;I've&nbsp;been&nbsp;installing&nbsp;on&nbsp;the&nbsp;client<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computers)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;And&nbsp;here's&nbsp;what&nbsp;my&nbsp;current&nbsp;squid.conf&nbsp;looks&nbsp;like:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;root@server:/etc/squid3/ssl_cert#&nbsp;cat&nbsp;/etc/squid3/squid.conf&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#Access&nbsp;Lists&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;home_network&nbsp;src&nbsp;192.168.200.0/24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;http://192.168.200.0/24&quot;&gt;&lt;http://192.168.200.0/24&gt;&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#Ports&nbsp;allowed&nbsp;through&nbsp;Squid&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;#http&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;#https&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;SSL&nbsp;method&nbsp;CONNECT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#allow/deny&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_access&nbsp;allow&nbsp;home_network&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_access&nbsp;deny&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_port&nbsp;3128&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;http_port&nbsp;3129&nbsp;intercept&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;https_port&nbsp;3130&nbsp;intercept&nbsp;ssl-bump<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cert=/etc/squid3/ssl_cert/myCA.pem&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;acl&nbsp;broken_sites&nbsp;dstdomain&nbsp;.gmail.com<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;http://gmail.com/&quot;&gt;&lt;http://gmail.com/&gt;&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;ssl_bump&nbsp;none&nbsp;localhost&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;ssl_bump&nbsp;none&nbsp;broken_sites&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;ssl_bump&nbsp;server-first&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;sslcrtd_program&nbsp;/usr/lib/squid3/ssl_crtd&nbsp;-s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/usr/share/squid3/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;sslcrtd_children&nbsp;5&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#caching&nbsp;directory&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;cache_dir&nbsp;ufs&nbsp;/var/spool/squid3&nbsp;1024&nbsp;16&nbsp;128&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;cache_mem&nbsp;1024&nbsp;MB&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#refresh&nbsp;patterns&nbsp;for&nbsp;caching&nbsp;static&nbsp;files&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;^ftp:&nbsp;1440&nbsp;20%&nbsp;10080&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;0%&nbsp;1440&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;\.(gif|png|jpg|jpeg|ico)$&nbsp;10080&nbsp;90%&nbsp;43200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;override-expire&nbsp;ignore-no-cache&nbsp;ignore-no-store&nbsp;ignore-private&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;-i<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\.(iso|avi|wav|mp3|mp4|mpeg|swf|flv|x-flv)$&nbsp;43200&nbsp;90%&nbsp;432000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;override-expire&nbsp;ignore-no-cache&nbsp;ignore-no-store&nbsp;ignore-private&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;-i<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\.(deb|rpm|exe|zip|tar|tgz|ram|rar|bin|ppt|doc|tiff)$&nbsp;10080&nbsp;90%<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;43200&nbsp;override-expire&nbsp;ignore-no-cache&nbsp;ignore-no-store<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore-private&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;\.index.(html|htm)$&nbsp;0&nbsp;40%&nbsp;10080&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;\.(html|htm|css|js)$&nbsp;1440&nbsp;40%&nbsp;40320&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;refresh_pattern&nbsp;.&nbsp;0&nbsp;40%&nbsp;40320&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;dns_nameservers&nbsp;8.8.8.8&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;#rewrite&nbsp;program&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;redirect_program&nbsp;/etc/squid3/filter.php&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;root@server:/etc/squid3/ssl_cert#&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Thanks&nbsp;in&nbsp;advance,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Luis&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;GnuPG&nbsp;v2<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;iQEcBAEBAgAGBQJU1HWtAAoJENNXIZxhPexGiRcH/A2QfRyPsmM9LhKR6ZuqTfhR<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;AWyg8omvGOeKwo5W0Czb/Qqo4XhtIe+jcXxFqmrvL+zxmrl66tRXp0mBDmp1FMPW<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;kC93hIYn72NZiThPmchqOZ/4IuUNOyJT1ll/Uef7Kr/saIF0zXMh2lkoNR5HCvhN<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;0nb3dW0QSSivASYB3/0Mm0szCQqLSx/zgIbdCvmlX9H3VwWM/uE88Nfp+CAHygIO<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;t5vioJbCTPjyFqV2QkX//fuU1ePZC1VrTw5//nMjXfCbpXjLZtgz15ubDcCH3vZ1<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;beMYpGYbvHUk+hxrwjW394Q+pSAso79x5hwUO3PlZAsKUx/RdhzI91VVRRO9mfE=<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;=N+mL<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
