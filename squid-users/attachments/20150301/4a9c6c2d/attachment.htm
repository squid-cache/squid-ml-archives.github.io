<tt>
&lt;html&gt;&lt;body&gt;<br>
&lt;p&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Normally&nbsp;my&nbsp;infrastructure&nbsp;looks&nbsp;like:&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;client&nbsp;&nbsp;--&nbsp;HTTP&nbsp;CONNECT&nbsp;(not&nbsp;encrypted)&nbsp;&nbsp;---&gt;&nbsp;proxy&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;client&nbsp;------&nbsp;TCP&nbsp;tunnel&nbsp;---&gt;&nbsp;proxy&nbsp;---&nbsp;TCP&nbsp;tunnel&nbsp;---&gt;&nbsp;reverse&nbsp;proxy&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;client&nbsp;---&nbsp;HTTPS&nbsp;application&nbsp;payload&nbsp;---------------&gt;&nbsp;reverse&nbsp;proxy&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Now&nbsp;I&nbsp;need&nbsp;it&nbsp;to&nbsp;look&nbsp;like:&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;client&nbsp;--------&nbsp;HTTPS&nbsp;application&nbsp;payload&nbsp;----&gt;&nbsp;proxy&nbsp;&nbsp;----&nbsp;HTTPS&nbsp;application&nbsp;payload&nbsp;&nbsp;----&gt;&nbsp;reverse&nbsp;proxy&lt;br&gt;<br>
&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;img&nbsp;width=&quot;16&quot;&nbsp;height=&quot;16&quot;&nbsp;src=&quot;cid:1__=08BBF768DFF287338f9e8a93df938@us.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;Inactive&nbsp;hide&nbsp;details&nbsp;for&nbsp;Yuri&nbsp;Voinov&nbsp;---03/01/2015&nbsp;12:26:32&nbsp;PM--------BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;Hash:&nbsp;SHA1&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;color=&quot;#424282&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Yuri&nbsp;Voinov&nbsp;---03/01/2015&nbsp;12:26:32&nbsp;PM--------BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;Hash:&nbsp;SHA1&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;From:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Yuri&nbsp;Voinov&nbsp;&lt;yvoinov@gmail.com&gt;&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;squid-users@lists.squid-cache.org&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;03/01/2015&nbsp;12:26&nbsp;PM&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Subject:&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Re:&nbsp;[squid-users]&nbsp;question&nbsp;about&nbsp;encrypted&nbsp;connection&nbsp;between&nbsp;https&nbsp;client&nbsp;and&nbsp;Squid&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Sent&nbsp;by:&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;&quot;squid-users&quot;&nbsp;&lt;squid-users-bounces@lists.squid-cache.org&gt;&lt;/font&gt;&lt;br&gt;<br>
&lt;hr&nbsp;width=&quot;100%&quot;&nbsp;size=&quot;2&quot;&nbsp;align=&quot;left&quot;&nbsp;noshade&nbsp;style=&quot;color:#8091A5;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&lt;br&gt;<br>
Hash:&nbsp;SHA1&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
01.03.15&nbsp;23:18,&nbsp;Julianne&nbsp;Bielski&nbsp;пишет:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;an&nbsp;https&nbsp;client&nbsp;(not&nbsp;a&nbsp;browser)&nbsp;that&nbsp;normally&nbsp;connects&nbsp;to&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;reverse&nbsp;proxy.&nbsp;When&nbsp;it&nbsp;needs&nbsp;to&nbsp;go&nbsp;through&nbsp;a&nbsp;forward&nbsp;proxy,&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;requests&nbsp;a&nbsp;CONNECT&nbsp;tunnel.&nbsp;I&nbsp;now&nbsp;have&nbsp;a&nbsp;requirement&nbsp;to&nbsp;also&nbsp;be&nbsp;able&lt;br&gt;<br>
&gt;&nbsp;to&nbsp;encrypt&nbsp;the&nbsp;connection&nbsp;between&nbsp;my&nbsp;client&nbsp;and&nbsp;the&nbsp;forward&nbsp;proxy,&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;I&nbsp;think&nbsp;this&nbsp;is&nbsp;possible&nbsp;using&nbsp;Squid&nbsp;and&nbsp;the&nbsp;https_port&lt;br&gt;<br>
&gt;&nbsp;directive&nbsp;(??)&lt;br&gt;<br>
Yep.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;My&nbsp;question&nbsp;is,&nbsp;will&nbsp;my&nbsp;https&nbsp;client&nbsp;now&nbsp;have&nbsp;to&nbsp;decrypt&nbsp;twice?&lt;br&gt;<br>
&gt;&nbsp;Once&nbsp;for&nbsp;the&nbsp;connection&nbsp;with&nbsp;the&nbsp;forward&nbsp;proxy&nbsp;and&nbsp;once&nbsp;for&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;connection&nbsp;with&nbsp;the&nbsp;reverse&nbsp;proxy?&lt;br&gt;<br>
&lt;br&gt;<br>
Re-encryption&nbsp;will&nbsp;performs&nbsp;only&nbsp;in&nbsp;case&nbsp;SSL-bumped&nbsp;connections.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;now&nbsp;I&nbsp;still&nbsp;can't&nbsp;imagine&nbsp;your&nbsp;infrastructure&nbsp;and&nbsp;how&nbsp;it&nbsp;must&nbsp;work.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Also,&nbsp;must&nbsp;my&nbsp;https&nbsp;client&nbsp;still&nbsp;send&nbsp;a&nbsp;CONNECT&nbsp;message&nbsp;to&nbsp;Squid,&lt;br&gt;<br>
&gt;&nbsp;or&nbsp;does&nbsp;it&nbsp;just&nbsp;connect&nbsp;to&nbsp;Squid's&nbsp;https_port&nbsp;at&nbsp;the&nbsp;TCP&nbsp;level,&lt;br&gt;<br>
&gt;&nbsp;perform&nbsp;the&nbsp;SSL&nbsp;handshake,&nbsp;and&nbsp;then&nbsp;open&nbsp;a&nbsp;TCP&nbsp;connection&nbsp;to&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;reverse&nbsp;proxy?&lt;br&gt;<br>
&lt;br&gt;<br>
Still&nbsp;want&nbsp;to&nbsp;take&nbsp;a&nbsp;look&nbsp;on&nbsp;your&nbsp;infrastructure&nbsp;scheme.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Thanks,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;J.&nbsp;Bielski&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&nbsp;squid-users&nbsp;mailing&lt;br&gt;<br>
&gt;&nbsp;list&nbsp;squid-users@lists.squid-cache.org&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----&lt;br&gt;<br>
Version:&nbsp;GnuPG&nbsp;v2&lt;br&gt;<br>
&lt;br&gt;<br>
iQEcBAEBAgAGBQJU80tgAAoJENNXIZxhPexGVOwH/3Q9L9IfDrP02Lj+q5pvuC2B&lt;br&gt;<br>
+oyD8xTbTGkDsitgl7KUMArhQmWVjSQAgtKEia6xTk69HlODAvVvVYuKdKYWxi8p&lt;br&gt;<br>
PW49iThLwV0GTUzpu1VGIT625ENKxf1l08PoZU+MLi+O6ijClcOfsvb09qc/OPFZ&lt;br&gt;<br>
zqNvYv1h8e7d2fL1blo9NkGgYC3B42FPer/HKqgw1KskoOuwd9OrzaQRxK+ErXAK&lt;br&gt;<br>
/SvFpRJXJcDYsz0Iw3PHFLA34rs2pyAysGllkmH8n8QJzhnOhIdy/g3Hkk2sjqjz&lt;br&gt;<br>
JsVCuj0qf3VoWHx+lIN12Zet2eFF59ELpTM52IOohTlzhWcDEVEI+z0dQyGrUpg=&lt;br&gt;<br>
=j/gg&lt;br&gt;<br>
-----END&nbsp;PGP&nbsp;SIGNATURE-----&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;/body&gt;&lt;/html&gt;
</tt>
