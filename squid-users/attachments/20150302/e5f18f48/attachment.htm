<tt>
&lt;html&gt;&lt;body&gt;<br>
&lt;p&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Amos,&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Per:&lt;/font&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;There&nbsp;*is*&nbsp;a&nbsp;Right&nbsp;Way.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;using&nbsp;this&nbsp;in&nbsp;squid.conf:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https_port&nbsp;3129&nbsp;cert=/path/to/proxy.pem&lt;br&gt;<br>
&lt;br&gt;<br>
2)&nbsp;client&nbsp;connects&nbsp;to&nbsp;3129&nbsp;using&nbsp;TCP,&nbsp;then&nbsp;performs&nbsp;TLS&nbsp;handshake.&lt;br&gt;<br>
&lt;br&gt;<br>
3)&nbsp;client&nbsp;sends&nbsp;requests&nbsp;inside&nbsp;the&nbsp;encrypted&nbsp;connection&nbsp;as&nbsp;if&nbsp;they&nbsp;were&lt;br&gt;<br>
HTTP&nbsp;to&nbsp;a&nbsp;proxy&nbsp;but&nbsp;using&nbsp;https://&nbsp;URL&nbsp;scheme.&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
If&nbsp;my&nbsp;client&nbsp;(it's&nbsp;not&nbsp;a&nbsp;browser)&nbsp;is&nbsp;an&nbsp;https&nbsp;client&nbsp;ultimately&nbsp;attempting&nbsp;to&nbsp;send&nbsp;its&nbsp;payload&nbsp;to&nbsp;a&nbsp;reverse&nbsp;proxy&nbsp;listening&nbsp;on&nbsp;443,&nbsp;does&nbsp;this&nbsp;mean&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;that&nbsp;I&nbsp;will&nbsp;have&nbsp;an&nbsp;encrypted&nbsp;payload&nbsp;inside&nbsp;of&nbsp;another&nbsp;encrypted&nbsp;payload?&nbsp;Also,&nbsp;if&nbsp;I&nbsp;configure&nbsp;my&nbsp;client&nbsp;to&nbsp;send&nbsp;traffic&nbsp;to&nbsp;Squid&nbsp;at&nbsp;port&nbsp;3129,&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;sans-serif&quot;&gt;then&nbsp;doesn't&nbsp;this&nbsp;mean&nbsp;I'm&nbsp;using&nbsp;Squid&nbsp;explicitly&nbsp;and&nbsp;not&nbsp;transparently?&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;img&nbsp;width=&quot;16&quot;&nbsp;height=&quot;16&quot;&nbsp;src=&quot;cid:1__=08BBF76FDFD097CD8f9e8a93df938@us.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;Inactive&nbsp;hide&nbsp;details&nbsp;for&nbsp;Amos&nbsp;Jeffries&nbsp;---03/01/2015&nbsp;08:39:01&nbsp;PM---On&nbsp;2/03/2015&nbsp;9:55&nbsp;a.m.,&nbsp;Eliezer&nbsp;Croitoru&nbsp;wrote:&nbsp;&gt;&nbsp;Hey&nbsp;Yuri,&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;color=&quot;#424282&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Amos&nbsp;Jeffries&nbsp;---03/01/2015&nbsp;08:39:01&nbsp;PM---On&nbsp;2/03/2015&nbsp;9:55&nbsp;a.m.,&nbsp;Eliezer&nbsp;Croitoru&nbsp;wrote:&nbsp;&gt;&nbsp;Hey&nbsp;Yuri,&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;From:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;squid-users@lists.squid-cache.org&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;03/01/2015&nbsp;08:39&nbsp;PM&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Subject:&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Re:&nbsp;[squid-users]&nbsp;question&nbsp;about&nbsp;encrypted&nbsp;connection&nbsp;between&nbsp;https&nbsp;client&nbsp;and&nbsp;Squid&lt;/font&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;1&quot;&nbsp;color=&quot;#5F5F5F&quot;&nbsp;face=&quot;sans-serif&quot;&gt;Sent&nbsp;by:&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=&quot;1&quot;&nbsp;face=&quot;sans-serif&quot;&gt;&quot;squid-users&quot;&nbsp;&lt;squid-users-bounces@lists.squid-cache.org&gt;&lt;/font&gt;&lt;br&gt;<br>
&lt;hr&nbsp;width=&quot;100%&quot;&nbsp;size=&quot;2&quot;&nbsp;align=&quot;left&quot;&nbsp;noshade&nbsp;style=&quot;color:#8091A5;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;On&nbsp;2/03/2015&nbsp;9:55&nbsp;a.m.,&nbsp;Eliezer&nbsp;Croitoru&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hey&nbsp;Yuri,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;01/03/2015&nbsp;20:17,&nbsp;Yuri&nbsp;Voinov&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&nbsp;Normally&nbsp;you&nbsp;never&nbsp;use&nbsp;CONNECT&nbsp;method&nbsp;over&nbsp;HTTP&nbsp;ports.&nbsp;This&nbsp;is&lt;br&gt;<br>
&gt;&gt;&nbsp;prohibited&nbsp;by&nbsp;squid&nbsp;basic&nbsp;security&nbsp;requirements.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;above&nbsp;statement&nbsp;is&nbsp;true&nbsp;only&nbsp;if&nbsp;the&nbsp;proxy&nbsp;admin&nbsp;prohibit&nbsp;this.&lt;br&gt;<br>
&gt;&nbsp;A&nbsp;CONNECT&nbsp;method&nbsp;can&nbsp;be&nbsp;allowed&nbsp;and&nbsp;can&nbsp;be&nbsp;used&nbsp;for&nbsp;any&nbsp;purpose&nbsp;what&nbsp;so&lt;br&gt;<br>
&gt;&nbsp;ever&nbsp;the&nbsp;admin&nbsp;of&nbsp;the&nbsp;server&nbsp;sees&nbsp;right.&lt;br&gt;<br>
&gt;&nbsp;There&nbsp;are&nbsp;basic&nbsp;default&nbsp;settings&nbsp;which&nbsp;allows&nbsp;the&nbsp;usage&nbsp;of&nbsp;a&nbsp;CONNECT&lt;br&gt;<br>
&gt;&nbsp;method&nbsp;only&nbsp;to&nbsp;access&nbsp;specific&nbsp;&quot;ssl&nbsp;safe&nbsp;ports&quot;.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;&quot;right&quot;&nbsp;way&nbsp;(if&nbsp;these&nbsp;one)&nbsp;to&nbsp;access&nbsp;squid&nbsp;using&nbsp;an&nbsp;encrypted&lt;br&gt;<br>
&gt;&nbsp;channel&nbsp;would&nbsp;be&nbsp;throw&nbsp;either&nbsp;a&nbsp;tunnel&nbsp;or&nbsp;another&nbsp;proxy&nbsp;which&nbsp;can&lt;br&gt;<br>
&gt;&nbsp;forward&nbsp;the&nbsp;request&nbsp;into&nbsp;squid.&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;*is*&nbsp;a&nbsp;Right&nbsp;Way.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;using&nbsp;this&nbsp;in&nbsp;squid.conf:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https_port&nbsp;3129&nbsp;cert=/path/to/proxy.pem&lt;br&gt;<br>
&lt;br&gt;<br>
2)&nbsp;client&nbsp;connects&nbsp;to&nbsp;3129&nbsp;using&nbsp;TCP,&nbsp;then&nbsp;performs&nbsp;TLS&nbsp;handshake.&lt;br&gt;<br>
&lt;br&gt;<br>
3)&nbsp;client&nbsp;sends&nbsp;requests&nbsp;inside&nbsp;the&nbsp;encrypted&nbsp;connection&nbsp;as&nbsp;if&nbsp;they&nbsp;were&lt;br&gt;<br>
HTTP&nbsp;to&nbsp;a&nbsp;proxy&nbsp;but&nbsp;using&nbsp;https://&nbsp;URL&nbsp;scheme.&lt;br&gt;<br>
&lt;br&gt;<br>
Thats&nbsp;is&nbsp;*all*.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;very&nbsp;simple.&nbsp;It&nbsp;works&nbsp;well&nbsp;with&nbsp;SSL-enabled&nbsp;Squid.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;avoids&nbsp;both&nbsp;the&nbsp;page-long&nbsp;list&nbsp;of&nbsp;NAT/TPROXY&nbsp;interception&nbsp;problems&lt;br&gt;<br>
and&nbsp;the&nbsp;other&nbsp;half-page&nbsp;list&nbsp;of&nbsp;SSL-bump&nbsp;hijacking&nbsp;related&nbsp;prblems.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/font&gt;&lt;/tt&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;/body&gt;&lt;/html&gt;<br>

</tt>
