<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hello&nbsp;All,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;2&nbsp;squid&nbsp;servers&nbsp;that&nbsp;authenticate&nbsp;correctly&nbsp;when&nbsp;you&nbsp;point&nbsp;your&nbsp;browser&nbsp;to&nbsp;either&nbsp;of&nbsp;them.&nbsp;I&#39;m&nbsp;using&nbsp;a&nbsp;negotiate_wrapper.&nbsp;I&nbsp;set&nbsp;it&nbsp;up&nbsp;following&nbsp;this&nbsp;(&lt;a&nbsp;href=&quot;http://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory&quot;&gt;http://wiki.squid-cache.org/ConfigExamples/Authenticate/WindowsActiveDirectory&lt;/a&gt;) &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;would&nbsp;like&nbsp;to&nbsp;set&nbsp;both&nbsp;servers&nbsp;behind&nbsp;a&nbsp;haproxy&nbsp;load&nbsp;balancer,&nbsp;however&nbsp;when&nbsp;you&nbsp;try&nbsp;to&nbsp;utilize&nbsp;the&nbsp;haproxy&nbsp;load&nbsp;balancer,&nbsp;it&nbsp;will&nbsp;not&nbsp;authenticate&nbsp;anymore.&nbsp;It&nbsp;just&nbsp;gives&nbsp;an&nbsp;error&nbsp;asking&nbsp;to&nbsp;authenticate.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;ideas?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;in&nbsp;advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;##HAPROXY.CFG##&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;global&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;log&nbsp;/dev/log&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;local0&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;log&nbsp;/dev/log&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;local1&nbsp;notice&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;chroot&nbsp;/var/lib/haproxy&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;user&nbsp;haproxy&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;group&nbsp;haproxy&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;daemon&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;defaults&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;log&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;global&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;mode&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;http&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;option&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;httplog&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;option&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;dontlognull&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;contimeout&nbsp;5000&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;clitimeout&nbsp;50000&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;srvtimeout&nbsp;50000&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;reverse&nbsp;proxy-squid&lt;/div&gt;&lt;div&gt;listen&nbsp; proxy&nbsp;&lt;a&nbsp;href=&quot;http://10.10.0.254:3128&quot;&gt;10.10.0.254:3128&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;mode&nbsp;http&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;cookie&nbsp; SERVERID&nbsp;insert&nbsp;indirect&nbsp;nocache&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;balance&nbsp;roundrobin&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;option&nbsp;httpclose&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;option&nbsp;forwardfor&nbsp;header&nbsp;X-Client&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;server&nbsp; squid1&nbsp;&lt;a&nbsp;href=&quot;http://10.10.0.253:3128&quot;&gt;10.10.0.253:3128&lt;/a&gt;&nbsp;check&nbsp;inter&nbsp;2000&nbsp;rise&nbsp;2&nbsp;fall&nbsp;5&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;server&nbsp; squid2&nbsp;&lt;a&nbsp;href=&quot;http://10.10.0.252:3128&quot;&gt;10.10.0.252:3128&lt;/a&gt;&nbsp;check&nbsp;inter&nbsp;2000&nbsp;rise&nbsp;2&nbsp;fall&nbsp;5&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;##SQUID.CONF##&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#Kerberos&nbsp;and&nbsp;NTLM&nbsp;authentication&lt;/div&gt;&lt;div&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;/usr/local/bin/negotiate_wrapper&nbsp;--ntlm&nbsp;/usr/bin/ntlm_auth&nbsp;--diagnostics&nbsp;--helper-protocol=squid-2.5-ntlmssp&nbsp;--domain=****.LOCAL&nbsp;--kerberos&nbsp;/usr/lib/squid3/negotiate_kerberos_auth&nbsp;-d&nbsp;-s&nbsp;GSS_C_NO_NAME&lt;/div&gt;&lt;div&gt;auth_param&nbsp;negotiate&nbsp;children&nbsp;30&lt;/div&gt;&lt;div&gt;auth_param&nbsp;negotiate&nbsp;keep_alive&nbsp;off&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;LDAP&nbsp;authentication&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid3/basic_ldap_auth&nbsp;-R&nbsp;-b&nbsp;&quot;DC=****,DC=local&quot;&nbsp;-D&nbsp;&quot;CN=SQUID,OU=Service&nbsp;Accounts,DC=****,DC=local&quot;&nbsp;-w&nbsp;&quot;****&quot;&nbsp;-f&nbsp;sAMAccountName=%s&nbsp;-h&nbsp;10.0.0.200,10.0.0.199,10.0.0.194,10.0.0.193&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;children&nbsp;150&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;realm&nbsp;Please&nbsp;enter&nbsp;your&nbsp;Domain&nbsp;credentials&nbsp;to&nbsp;continue&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;1&nbsp;hour&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;AD&nbsp;group&nbsp;membership&nbsp;commands&lt;/div&gt;&lt;div&gt;external_acl_type&nbsp;ldap_group&nbsp;ttl=60&nbsp;children-startup=10&nbsp;children-max=50&nbsp;children-idle=2&nbsp;%LOGIN&nbsp;/usr/lib/squid3/ext_ldap_group_acl&nbsp;-R&nbsp;-K&nbsp;-S&nbsp;-b&nbsp;&quot;DC=****,DC=local&quot;&nbsp;-D&nbsp;&quot;CN=SQUID,OU=Service&nbsp;Accounts,DC=****,DC=local&quot;&nbsp;-w&nbsp;&quot;****&quot;&nbsp;-f&nbsp;&quot;(&amp;(objectclass=person)&nbsp;(sAMAccountname=%v)(memberof=CN=%a,OU=PROXY,ou=ALL&nbsp; Groups,DC=****,DC=local))&quot;&nbsp;-h&nbsp;dc1.****.local,dc2.****.local,dc3.****.local,dc4.****.local&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;auth&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;REQGROUPS&nbsp;external&nbsp;ldap_group&nbsp;PROXY-HIGHLY-RESTRICTIVE&nbsp;PROXY-MEDIUM-RESTRICTIVE&nbsp;PROXY-MINIMAL-RESTRICTIVE&nbsp;PROXY-UNRESTRICTED&nbsp;PROXY-DEV&nbsp;PROXY-SALES&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!auth&nbsp;all&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!REQGROUPS&nbsp;all&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;Samuel&nbsp;Anderson&nbsp; |&nbsp; Information Technology Administrator&nbsp; |&nbsp; International&nbsp;Document&nbsp;Services&lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;IDS&nbsp; |&nbsp; 11629&nbsp;South&nbsp;700&nbsp;East,&nbsp;Suite&nbsp;200&nbsp; |&nbsp; Draper,&nbsp;UT&nbsp;84020-4607&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;text-align:right&quot;&gt;&lt;img&nbsp;src=&quot;http://nationalmortgageprofessional.com/sites/default/files/images/IDS_Logo_03_12.topstoryimage.jpg&quot;&nbsp;width=&quot;96&quot;&nbsp;height=&quot;88&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;br&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&nbsp;size=&quot;4&quot;&gt;CONFIDENTIALITY&nbsp;NOTICE:&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;&lt;font&nbsp;size=&quot;4&quot;&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;This&nbsp;e-mail&nbsp;and&nbsp;any&nbsp;attachments&nbsp;are&nbsp;confidential.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;an&nbsp;intended&nbsp;recipient,&nbsp;please&nbsp;contact&nbsp;the&nbsp;sender&nbsp;to&nbsp;report&nbsp;the&nbsp;error&nbsp;and&nbsp;delete&nbsp;all&nbsp;copies&nbsp;of&nbsp;this&nbsp;message&nbsp;from&nbsp;your&nbsp;system.&nbsp; &lt;/font&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;Any&nbsp;unauthorized&nbsp;review,&nbsp;use,&nbsp;disclosure&nbsp;or&nbsp;distribution&nbsp;is&nbsp;prohibited&lt;/font&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;
</tt>
