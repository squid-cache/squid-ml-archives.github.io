<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&gt;Which&nbsp;OS&nbsp;and&nbsp;Kerberos&nbsp;version&nbsp;do&nbsp;you&nbsp;have&nbsp;?&nbsp;&nbsp;There&nbsp;might&nbsp;be&nbsp;some&nbsp;issue&nbsp;<br>
with&nbsp;the&nbsp;cache&nbsp;used&nbsp;KEYRING:persistent:0:0&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;Markus&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-SIZE:&nbsp;small;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;DISPLAY:&nbsp;inline&quot;&gt;<br>
&lt;DIV&gt;&quot;Olivier&nbsp;CALVANO&quot;&nbsp;&lt;o.calvano@gmail.com&gt;&nbsp;wrote&nbsp;in&nbsp;message&nbsp;<br>
news:CAJajPefo3t8b1=_v5PFj3H0gq4Jk3OosuTW8gNHY7Z-Gs21qLg@mail.gmail.com...&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-SIZE:&nbsp;small;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;DISPLAY:&nbsp;inline&quot;&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;Hi&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;I&nbsp;request&nbsp;your&nbsp;help&nbsp;because&nbsp;i&nbsp;want&nbsp;use&nbsp;NTLM/Kerberos&nbsp;for&nbsp;<br>
authenticate&nbsp;my&nbsp;user.&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;For&nbsp;NTLM,&nbsp;i&nbsp;use&nbsp;Winbind,&nbsp;no&nbsp;problems,&nbsp;<br>
&lt;BR&gt;&lt;BR&gt;[root@gw]#&nbsp;wbinfo&nbsp;-t&lt;BR&gt;checking&nbsp;the&nbsp;trust&nbsp;secret&nbsp;for&nbsp;domain&nbsp;MYADDOMAIN&nbsp;<br>
via&nbsp;RPC&nbsp;calls&nbsp;succeeded&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;but&nbsp;for&nbsp;Kerberos,&nbsp;i&nbsp;can't&nbsp;create&nbsp;the&nbsp;<br>
.keytab&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;[root@gw]#&nbsp;kinit&nbsp;MYUSERNAME&lt;BR&gt;Password&nbsp;for&nbsp;&lt;A&nbsp;<br>
href=&quot;mailto:MYUSERNAME@MYADDOMAIN.FR&quot;&gt;MYUSERNAME@MYADDOMAIN.FR&lt;/A&gt;:&lt;BR&gt;&lt;BR&gt;[root@gw]#&nbsp;<br>
klist&lt;BR&gt;Ticket&nbsp;cache:&nbsp;KEYRING:persistent:0:0&lt;BR&gt;Default&nbsp;principal:&nbsp;&lt;A&nbsp;<br>
href=&quot;mailto:MYUSERNAME@MYADDOMAIN.FR&quot;&gt;MYUSERNAME@MYADDOMAIN.FR&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;Valid&nbsp;<br>
starting&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Expires&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Service&nbsp;principal&lt;BR&gt;02/05/2015&nbsp;04:51:25&nbsp;&nbsp;02/05/2015&nbsp;14:51:25&nbsp;&nbsp;<br>
krbtgt/&lt;A&nbsp;<br>
href=&quot;mailto:MYADDOMAIN.FR@MYADDOMAIN.FR&quot;&gt;MYADDOMAIN.FR@MYADDOMAIN.FR&lt;/A&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
renew&nbsp;until&nbsp;09/05/2015&nbsp;04:51:07&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;MYUSERNAME&nbsp;is&nbsp;the&nbsp;same&nbsp;account&nbsp;that&nbsp;<br>
i&nbsp;join&nbsp;the&nbsp;domain&nbsp;(net&nbsp;join)&nbsp;with&nbsp;winbind&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;after,&nbsp;i&nbsp;<br>
put:&lt;BR&gt;&lt;BR&gt;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=COMPUTERS&quot;&nbsp;-s&nbsp;HTTP/&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
-k&nbsp;/etc/squid/PROXY.keytab&nbsp;--computer-name&nbsp;OPHTCYSRV1V4-K&nbsp;--upn&nbsp;HTTP/&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
--server&nbsp;adserver1&nbsp;--verbose&lt;BR&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;and&nbsp;i&nbsp;have&nbsp;a&nbsp;error:&lt;BR&gt;&lt;BR&gt;[root@gw&nbsp;etc]#&nbsp;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=COMPUTERS&quot;&nbsp;-s&nbsp;<br>
HTTP/&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
-k&nbsp;/etc/squid/PROXY.keytab&nbsp;--computer-name&nbsp;OPHTCYSRV1V4-K&nbsp;--upn&nbsp;HTTP/&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
--server&nbsp;adserver1&nbsp;--verbose&lt;BR&gt;--&nbsp;init_password:&nbsp;Wiping&nbsp;the&nbsp;computer&nbsp;password&nbsp;<br>
structure&lt;BR&gt;--&nbsp;generate_new_password:&nbsp;Generating&nbsp;a&nbsp;new,&nbsp;random&nbsp;password&nbsp;for&nbsp;the&nbsp;<br>
computer&nbsp;account&lt;BR&gt;--&nbsp;generate_new_password:&nbsp;&nbsp;Characters&nbsp;read&nbsp;from&nbsp;<br>
/dev/udandom&nbsp;=&nbsp;84&lt;BR&gt;--&nbsp;create_fake_krb5_conf:&nbsp;Created&nbsp;a&nbsp;fake&nbsp;krb5.conf&nbsp;file:&nbsp;<br>
/tmp/.msktkrb5.conf-jnxTuG&lt;BR&gt;--&nbsp;reload:&nbsp;Reloading&nbsp;Kerberos&nbsp;Context&lt;BR&gt;--&nbsp;<br>
finalize_exec:&nbsp;SAM&nbsp;Account&nbsp;Name&nbsp;is:&nbsp;OPHTCYSRV1V4-K$&lt;BR&gt;--&nbsp;<br>
try_machine_keytab_princ:&nbsp;Trying&nbsp;to&nbsp;authenticate&nbsp;for&nbsp;OPHTCYSRV1V4-K$&nbsp;from&nbsp;local&nbsp;<br>
keytab...&lt;BR&gt;--&nbsp;try_machine_keytab_princ:&nbsp;Error:&nbsp;krb5_get_init_creds_keytab&nbsp;<br>
failed&nbsp;(Client&nbsp;not&nbsp;found&nbsp;in&nbsp;Kerberos&nbsp;database)&lt;BR&gt;--&nbsp;try_machine_keytab_princ:&nbsp;<br>
Authentication&nbsp;with&nbsp;keytab&nbsp;failed&lt;BR&gt;--&nbsp;try_machine_keytab_princ:&nbsp;Trying&nbsp;to&nbsp;<br>
authenticate&nbsp;for&nbsp;host/&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
from&nbsp;local&nbsp;keytab...&lt;BR&gt;--&nbsp;try_machine_keytab_princ:&nbsp;Error:&nbsp;<br>
krb5_get_init_creds_keytab&nbsp;failed&nbsp;(Client&nbsp;not&nbsp;found&nbsp;in&nbsp;Kerberos&nbsp;database)&lt;BR&gt;--&nbsp;<br>
try_machine_keytab_princ:&nbsp;Authentication&nbsp;with&nbsp;keytab&nbsp;failed&lt;BR&gt;--&nbsp;<br>
try_machine_password:&nbsp;Trying&nbsp;to&nbsp;authenticate&nbsp;for&nbsp;OPHTCYSRV1V4-K$&nbsp;with&nbsp;<br>
password.&lt;BR&gt;--&nbsp;create_default_machine_password:&nbsp;Default&nbsp;machine&nbsp;password&nbsp;for&nbsp;<br>
OPHTCYSRV1V4-K$&nbsp;is&nbsp;ophtcysrv1v4-k&lt;BR&gt;--&nbsp;try_machine_password:&nbsp;Error:&nbsp;<br>
krb5_get_init_creds_keytab&nbsp;failed&nbsp;(Client&nbsp;not&nbsp;found&nbsp;in&nbsp;Kerberos&nbsp;database)&lt;BR&gt;--&nbsp;<br>
try_machine_password:&nbsp;Authentication&nbsp;with&nbsp;password&nbsp;failed&lt;BR&gt;--&nbsp;try_user_creds:&nbsp;<br>
Checking&nbsp;if&nbsp;default&nbsp;ticket&nbsp;cache&nbsp;has&nbsp;tickets...&lt;BR&gt;--&nbsp;try_user_creds:&nbsp;Error:&nbsp;<br>
krb5_cc_get_principal&nbsp;failed&nbsp;(No&nbsp;credentials&nbsp;cache&nbsp;found)&lt;BR&gt;--&nbsp;try_user_creds:&nbsp;<br>
User&nbsp;ticket&nbsp;cache&nbsp;was&nbsp;not&nbsp;valid.&lt;BR&gt;Error:&nbsp;could&nbsp;not&nbsp;find&nbsp;any&nbsp;credentials&nbsp;to&nbsp;<br>
authenticate&nbsp;with.&nbsp;Neither&nbsp;keytab,&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;machine&nbsp;<br>
password,&nbsp;nor&nbsp;calling&nbsp;user's&nbsp;tickets&nbsp;worked.&nbsp;Try&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&quot;kinit&quot;ing&nbsp;yourself&nbsp;some&nbsp;tickets&nbsp;with&nbsp;permission&nbsp;to&nbsp;create&nbsp;<br>
computer&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects,&nbsp;or&nbsp;pre-creating&nbsp;the&nbsp;computer&nbsp;<br>
object&nbsp;in&nbsp;AD&nbsp;and&nbsp;selecting&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'reset&nbsp;account'.&lt;BR&gt;--&nbsp;<br>
~KRB5Context:&nbsp;Destroying&nbsp;Kerberos&nbsp;Context&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;same&nbsp;error&nbsp;if&nbsp;i&nbsp;change&nbsp;&lt;A&nbsp;<br>
href=&quot;http://gw.srv1-v4.tcy.myinternetdomain.org&quot;&gt;gw.srv1-v4.tcy.myinternetdomain.org&lt;/A&gt;&nbsp;<br>
to&nbsp;&lt;A&nbsp;<br>
href=&quot;http://ophtcysrv1v4.myaddomain.fr&quot;&gt;ophtcysrv1v4.myaddomain.fr&lt;/A&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;anyone&nbsp;know&nbsp;the&nbsp;origin&nbsp;of&nbsp;this&nbsp;error&nbsp;?&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;thanks&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;Olivier&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;P&gt;<br>
&lt;HR&gt;<br>
_______________________________________________&lt;BR&gt;squid-users&nbsp;mailing&nbsp;<br>
list&lt;BR&gt;squid-users@lists.squid-cache.org&lt;BR&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
