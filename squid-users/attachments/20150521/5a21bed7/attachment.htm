<tt>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;think&nbsp;I&#39;m&nbsp;having&nbsp;a&nbsp;problem&nbsp;with&nbsp;the url_rewrite_extras&nbsp;function. &nbsp;I&#39;m&nbsp;using&nbsp;version&nbsp;3.5.3.&nbsp;I&#39;ve&nbsp;been&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;%ue&nbsp;macro&nbsp;to&nbsp;send&nbsp;the&nbsp;user=&nbsp;returned&nbsp;by&nbsp;my external_acl_type&nbsp;program. &nbsp;But&nbsp;when&nbsp;I&nbsp;look&nbsp;at&nbsp;the url_rewrite_program&nbsp;output&nbsp;I&nbsp;just&nbsp;get&nbsp;a&nbsp;&quot;-&quot;&nbsp;value&nbsp;for&nbsp;this&nbsp;macro.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Example:&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Summarized&nbsp;config:&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;external_acl_type&nbsp;idbf_user&nbsp;ttl=30&nbsp;%SRC&nbsp;/opt/idbf-dev/idbf_squid_ext_acl.py&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;acl&nbsp;idbf_allowed&nbsp;external&nbsp;idbf_user&nbsp;#&nbsp;authenticated&nbsp;users&nbsp;from&nbsp;external&nbsp;acl&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;http_access&nbsp;allow&nbsp;idbf_allowed&lt;br&gt;<br>
http_access&nbsp;deny&nbsp;all&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;url_rewrite_access&nbsp; idbf_allowed&lt;br&gt;<br>
url_rewrite_extras&nbsp;&quot;un:&nbsp;%un&nbsp;ue:&nbsp;%ue&nbsp;ul:&nbsp;%ul&nbsp;ui:&nbsp;%ui&quot;&lt;br&gt;<br>
url_rewrite_program&nbsp;/usr/bin/tee&nbsp;-a&nbsp;/var/log/squid3/redir_tmp.log&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;redir_tmp.log:&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;http://&lt;/a&gt;&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;www.ipchicken.com&lt;/a&gt;&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;/&lt;/a&gt;&nbsp;un:&nbsp;-&nbsp;ue:&nbsp;-&nbsp;ul:&nbsp;-&nbsp;ui:&nbsp;-&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;But&nbsp;I&nbsp;do&nbsp;see&nbsp;my&nbsp;external&nbsp;acl&nbsp;user&nbsp;as&nbsp;excepted&nbsp;in&nbsp;access.log:&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;1432219189.592&nbsp; &nbsp; &nbsp;40&nbsp;172.20.15.235&nbsp;TCP_MISS/404&nbsp;509&nbsp;GET&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;&nbsp;http://&lt;/a&gt;&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;www.ipchicken.com&lt;/a&gt;&lt;a&nbsp;href=&quot;http://www.ipchicken.com/&quot;&gt;/&lt;/a&gt;&lt;a&nbsp;href=&quot;mailto:user@example.com&quot;&gt;&nbsp;user@&lt;/a&gt;&lt;a&nbsp;href=&quot;mailto:user@example.com&quot;&gt;example.com&lt;/a&gt;&nbsp;HIER_DIRECT/&lt;a&nbsp;href=&quot;http://209.68.27.16&quot;&gt;209.68.27.16&lt;/a&gt;&nbsp;text/html&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Does&nbsp;anyone&nbsp;see&nbsp;anything&nbsp;I&nbsp;might&nbsp;have&nbsp;mis-configured&nbsp;or&nbsp;am&nbsp;I&nbsp;just&nbsp;not&nbsp;understanding&nbsp;how&nbsp;this&nbsp;should&nbsp;work?&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Thanks!&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Patrick&lt;/p&gt;<br>

</tt>
