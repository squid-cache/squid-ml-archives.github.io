<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;I&nbsp;just&nbsp;thought&nbsp;of&nbsp;something&nbsp;else.&nbsp;First&nbsp;of&nbsp;all&nbsp;I&#39;m&nbsp;new&nbsp;to&nbsp;squid&nbsp;and&nbsp;I&nbsp;am&nbsp;not&nbsp;aware&nbsp;of&nbsp;10%&nbsp;of&nbsp;the&nbsp;things&nbsp;its&nbsp;capable&nbsp;of&nbsp;yet&nbsp;so&nbsp;I&nbsp;will&nbsp;ask.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Is&nbsp;squid&nbsp;capable&nbsp;of&nbsp;adding&nbsp;custom&nbsp;SNIs?&nbsp;Like&nbsp;could&nbsp;I&nbsp;have&nbsp;it&nbsp;so&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;certificate&nbsp;as&nbsp;a&nbsp;subject&nbsp;alternate&nbsp;name&nbsp;EVEN&nbsp;though&nbsp;the&nbsp;original&nbsp;certificate&nbsp;doesn&#39;t&nbsp;contain&nbsp;it?&nbsp;If&nbsp;such&nbsp;a&nbsp;thing&nbsp;is&nbsp;possible&nbsp;I&nbsp;would&nbsp;love&nbsp;to&nbsp;know&nbsp;the&nbsp;term&nbsp;for&nbsp;it&nbsp;so&nbsp;I&nbsp;can&nbsp;do&nbsp;some&nbsp;searches.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Appreciate&nbsp;it!&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;May&nbsp;27,&nbsp;2015&nbsp;12:15:37&nbsp;PM&nbsp;EDT,&nbsp;Michael&nbsp;Monette&nbsp;&lt;mmonette@2keys.ca&gt;&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;pre&nbsp;class=&quot;k9mail&quot;&gt;Has&nbsp;anyone&nbsp;been&nbsp;able&nbsp;to&nbsp;configure&nbsp;Squid&nbsp;in&nbsp;a&nbsp;way&nbsp;so&nbsp;that&nbsp;if&nbsp;you&nbsp;type&nbsp;&lt;a&nbsp;href=&quot;https://gmail.com&quot;&gt;https://gmail.com&lt;/a&gt;&nbsp;in&nbsp;your&nbsp;browser,&nbsp;you&nbsp;are&nbsp;NOT&nbsp;presented&nbsp;with&nbsp;the&nbsp;&quot;OMG&nbsp;HSTS&nbsp;I&nbsp;refuse&nbsp;to&nbsp;load&nbsp;anything&quot;&nbsp;page?&nbsp;When&nbsp;I&nbsp;go&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;https://gmail.com&quot;&gt;https://gmail.com&lt;/a&gt;,&nbsp;I&nbsp;get&nbsp;an&nbsp;invalid&nbsp;certificate&nbsp;because&nbsp;the&nbsp;cert&nbsp;is&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://mail.google.com&quot;&gt;mail.google.com&lt;/a&gt;,&nbsp;issued&nbsp;by&nbsp;my&nbsp;CA.&nbsp;If&nbsp;I&nbsp;go&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;https://mail.google.com&quot;&gt;https://mail.google.com&lt;/a&gt;,&nbsp;the&nbsp;cert&nbsp;is&nbsp;beautifully&nbsp;green.&nbsp;Why&nbsp;can't&nbsp;squid&nbsp;detect&nbsp;that&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&nbsp;is&nbsp;redirecting&nbsp;my&nbsp;browser&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://mail.google.com&quot;&gt;mail.google.com&lt;/a&gt;&nbsp;and&nbsp;generate&nbsp;the&nbsp;cert&nbsp;accordingly?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Even&nbsp;configuring&nbsp;an&nbsp;acl&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&nbsp;doesn't&nbsp;work.&nbsp;It&nbsp;seems&nbsp;like&nbsp;even&nbsp;though&nbsp;I&nbsp;am&nbsp;punching&nbsp;&lt;a&nbsp;href=&quot;https://gmail.com&quot;&gt;https://gmail.com&lt;/a&gt;&nbsp;in&nbsp;my&nbsp;browser,&nbsp;Squid&nbsp;detects&nbsp;it&nbsp;as&nbsp;though&nbsp;I&nbsp;am&nbsp;typing&nbsp;&quot;&lt;a<br>
href=&quot;https://mail.google.com&quot;&gt;https://mail.google.com&lt;/a&gt;&quot;&nbsp;in&nbsp;my&nbsp;browser&nbsp;and&nbsp;is&nbsp;ignoring&nbsp;any&nbsp;ACLs&nbsp;I&nbsp;have&nbsp;setup&nbsp;specifically&nbsp;for&nbsp;&quot;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&quot;.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;I&nbsp;can't&nbsp;be&nbsp;the&nbsp;only&nbsp;one&nbsp;with&nbsp;this&nbsp;issue?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;I've&nbsp;also&nbsp;attempted&nbsp;to&nbsp;do:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;acl&nbsp;bl1&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://moz.com&quot;&gt;moz.com&lt;/a&gt;&lt;br&nbsp;/&gt;always_direct&nbsp;allow&nbsp;bl1&nbsp;&lt;-&nbsp;from&nbsp;what&nbsp;I&nbsp;understand&nbsp;this&nbsp;bypasses&nbsp;squid&nbsp;and&nbsp;tells&nbsp;my&nbsp;browser&nbsp;to&nbsp;get&nbsp;the&nbsp;cert&nbsp;right&nbsp;from&nbsp;the&nbsp;site.&nbsp;Maybe&nbsp;I&nbsp;am&nbsp;wrong.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;But&nbsp;certificates&nbsp;still&nbsp;come&nbsp;from&nbsp;Squid,&nbsp;so&nbsp;I&nbsp;don't&nbsp;see&nbsp;any&nbsp;effect&nbsp;from&nbsp;that&nbsp;line.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Here's&nbsp;my&nbsp;config,&nbsp;lots&nbsp;of&nbsp;garbage&nbsp;in&nbsp;there&nbsp;since&nbsp;I&nbsp;have&nbsp;been&nbsp;trying&nbsp;everything&nbsp;i&nbsp;can&nbsp;think&nbsp;of&nbsp;to&nbsp;get&nbsp;this&nbsp;working.&nbsp;I&nbsp;want&nbsp;to&nbsp;add&nbsp;that&nbsp;for&nbsp;my&nbsp;acl&nbsp;called&nbsp;BL1,&nbsp;the&nbsp;only&nbsp;one&nbsp;that&nbsp;works&nbsp;is&nbsp;&lt;a&nbsp;href=&quot;http://moz.com&quot;&gt;moz.com&lt;/a&gt;&nbsp;.&nbsp;They&nbsp;are&nbsp;part&nbsp;of&nbsp;the&nbsp;same&nbsp;ACL&nbsp;line,&nbsp;so&nbsp;if&nbsp;one&nbsp;works,&nbsp;they&nbsp;should&nbsp;all&nbsp;work.&nbsp;Except&nbsp;they&nbsp;do&nbsp;not.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Thanks&nbsp;in&nbsp;advance.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;cat<br>
/etc/squid/squid.conf&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;~~&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;debug_options&nbsp;ALL,9&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&nbsp;/&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&nbsp;/&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&nbsp;/&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;br&nbsp;/&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;#&nbsp;http&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;#&nbsp;ftp&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;#&nbsp;https&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;#&nbsp;gopher&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;#&nbsp;wais&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;#&nbsp;gss-http&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;#&nbsp;filemaker&lt;br&nbsp;/&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;#&nbsp;multiling<br>
http&lt;br&nbsp;/&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&nbsp;/&gt;http_access&nbsp;deny&nbsp;manager&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&nbsp;/&gt;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;br&nbsp;/&gt;acl&nbsp;step3&nbsp;at_step&nbsp;SslBump3&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;ssl_bump&nbsp;peek&nbsp;step1&nbsp;all&lt;br&nbsp;/&gt;ssl_bump&nbsp;bump&nbsp;step2&nbsp;all&lt;br&nbsp;/&gt;ssl_bump&nbsp;bump&nbsp;step3&nbsp;all&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;acl&nbsp;bl1&nbsp;dstdomain&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://mail.google.com&quot;&gt;mail.google.com&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://accounts.google.com&quot;&gt;accounts.google.com&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://moz.com&quot;&gt;moz.com&lt;/a&gt;&lt;br&nbsp;/&gt;#acl&nbsp;bl1&nbsp;url_regex&nbsp;-i&nbsp;^http(s)?://&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;&lt;br&nbsp;/&gt;#acl&nbsp;bl2&nbsp;url_regex&nbsp;-i&nbsp;^http(s)?://([a-zA-Z]+).&lt;a&nbsp;href=&quot;http://gmail.com&quot;&gt;gmail.com&lt;/a&gt;.*&lt;br&nbsp;/&gt;#acl&nbsp;bl3&nbsp;url_regex&nbsp;-i&nbsp;^http(s)?://&lt;a&nbsp;href=&quot;http://moz.com&quot;&gt;moz.com&lt;/a&gt;.*&lt;br&nbsp;/&gt;#acl&nbsp;bl4&nbsp;url_regex&nbsp;-i&nbsp;&lt;a&nbsp;href=&quot;http://moz.com&quot;&gt;moz.com&lt;/a&gt;&lt;br&nbsp;/&gt;deny_info&nbsp;&lt;a&nbsp;href=&quot;http://ask.com&quot;&gt;http://ask.com&lt;/a&gt;<br>
bl1&nbsp;#&nbsp;I&nbsp;was&nbsp;testing&nbsp;redirecting&nbsp;stuff,&nbsp;but&nbsp;since&nbsp;the&nbsp;acl&nbsp;is&nbsp;not&nbsp;even&nbsp;picked&nbsp;up,&nbsp;this&nbsp;stuff&nbsp;is&nbsp;useless.&lt;br&nbsp;/&gt;http_reply_access&nbsp;deny&nbsp;bl1&nbsp;#&nbsp;useless&lt;br&nbsp;/&gt;#http_access&nbsp;deny&nbsp;bl1&nbsp;&lt;br&nbsp;/&gt;#http_access&nbsp;deny&nbsp;bl1&nbsp;CONNECT&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_access&nbsp;allow&nbsp;localnet&lt;br&nbsp;/&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_access&nbsp;allow&nbsp;all&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;http_port&nbsp;3128&nbsp;accel&nbsp;vhost&nbsp;allow-direct&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#https_port&nbsp;3129&nbsp;transparent&nbsp;ssl-bump&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/etc/squid/ssl_cert/myca.pem&nbsp;key=/etc/squid/ssl_cert/myca.pem&nbsp;options=NO_SSLv3&lt;br&nbsp;/&gt;https_port&nbsp;3129&nbsp;intercept&nbsp;ssl-bump&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/etc/squid/ssl_cert/myca.pem&nbsp;key=/etc/squid/ssl_cert/myca.pem&nbsp;options=NO_SSLv3&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;sslproxy_cert_error&nbsp;allow&nbsp;all&lt;br&nbsp;/&gt;sslproxy_flags&nbsp;DONT_VERIFY_PEER&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;sslproxy_options&nbsp;NO_SSLv2&lt;br&nbsp;/&gt;sslproxy_options&nbsp;NO_SSLv3&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;sslcrtd_program&nbsp;/usr/lib/squid/ssl_crtd&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&nbsp;/&gt;sslcrtd_children&nbsp;8<br>
startup=1&nbsp;idle=1&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#cache_dir&nbsp;ufs&nbsp;/var/spool/squid&nbsp;100&nbsp;16&nbsp;256&lt;br&nbsp;/&gt;coredump_dir&nbsp;/var/spool/squid&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;1440&nbsp;20%&nbsp;10080&lt;br&nbsp;/&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;0%&nbsp;1440&lt;br&nbsp;/&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;0%&nbsp;0&lt;br&nbsp;/&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;0&nbsp;20%&nbsp;4320&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Mike&lt;br&nbsp;/&gt;&lt;hr&nbsp;/&gt;&lt;br&nbsp;/&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&nbsp;/&gt;squid-users@lists.squid-cache.org&lt;br&nbsp;/&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&nbsp;/&gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Sent&nbsp;from&nbsp;my&nbsp;Android&nbsp;device&nbsp;with&nbsp;K-9&nbsp;Mail.&nbsp;Please&nbsp;excuse&nbsp;my&nbsp;brevity.&lt;/body&gt;&lt;/html&gt;
</tt>
