<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/4.6.6&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Config&nbsp;first:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;####################################################&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;localnet&nbsp;src&nbsp;192.168.1.0/24&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;peek&nbsp;step1&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;#https_server_names.txt&nbsp;has&nbsp;\.google\.com,&nbsp;\.yahoo\.com,&nbsp;\.msn\.com&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name_regex&nbsp;&quot;/opt/etc/squid/https_server_names.txt&quot;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;allow&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;bump&nbsp;allowed_https_sites&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;terminate&nbsp;!allowed_https_sites&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_cert_error&nbsp;allow&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_capath&nbsp;/etc/ssl/certs&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_flags&nbsp;DONT_VERIFY_PEER&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_options&nbsp;ALL&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;sslcrtd_program&nbsp;/opt/libexec/ssl_crtd&nbsp;-s&nbsp;/opt/var/ssl_db&nbsp;-M&nbsp;4MB&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslcrtd_children&nbsp;5&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;http_port&nbsp;3128&nbsp;intercept&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;https_port&nbsp;3129&nbsp;intercept&nbsp;ssl-bump&nbsp;cert=/opt/etc/squid/certs/sslsplit_ca_cert.pem&nbsp;cafile=/opt/etc/squid/certs/sslsplit_ca_cert.pem&nbsp;key=/opt/etc/squid/certs/sslsplit_ca_key.pem&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;sslflags=NO_SESSION_REUSE&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;logformat&nbsp;mine&nbsp;%&gt;a&nbsp;%[ui&nbsp;%[un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%ssl::&gt;sni&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;%Ss:%Sh&nbsp;%ssl::bump_mode&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;access_log&nbsp;syslog:daemon.info&nbsp;mine&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;refresh_pattern&nbsp;-i&nbsp;(cgi-bin|\?)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;coredump_dir&nbsp;/opt/var&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;####################################################&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
so&nbsp;the&nbsp;above&nbsp;works&nbsp;to&nbsp;bump&nbsp;and&nbsp;filter&nbsp;out&nbsp;(the&nbsp;order&nbsp;of&nbsp;these&nbsp;lines&nbsp;absolutely&nbsp;seemed&nbsp;to&nbsp;matter)&nbsp;if&nbsp;the&nbsp;site&nbsp;you&nbsp;go&nbsp;to&nbsp;isn't&nbsp;in&nbsp;the&nbsp;allowed_https_sites&nbsp;acl.&nbsp;&nbsp;The&nbsp;sticking&nbsp;point&nbsp;is&nbsp;the&nbsp;http_access....the&nbsp;above&nbsp;will&nbsp;filter&nbsp;https&nbsp;based&nbsp;on&nbsp;the&nbsp;allowed_https_server_names.txt,&nbsp;but&nbsp;completely&nbsp;allows&nbsp;ALL&nbsp;http,&nbsp;so&nbsp;&lt;B&gt;this&nbsp;isn't&nbsp;complete&nbsp;yet.&lt;/B&gt;&nbsp;&nbsp;Below&nbsp;is&nbsp;going&nbsp;to&nbsp;a&nbsp;site&nbsp;in&nbsp;the&nbsp;allowed_https_sites&nbsp;acl:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[08:59:44&nbsp;jlay@powerbook:~/test$&nbsp;wget&nbsp;--ca-certificate=/etc/ssl/certs/sslsplit_ca_cert.pem&nbsp;-d&nbsp;&lt;A&nbsp;HREF=&quot;https://www.msn.com&quot;&gt;https://www.msn.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;DEBUG&nbsp;output&nbsp;created&nbsp;by&nbsp;Wget&nbsp;1.16&nbsp;on&nbsp;linux-gnu.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;URI&nbsp;encoding&nbsp;=&nbsp;&#8216;UTF-8&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;08:59:57--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;https://www.msn.com/&quot;&gt;https://www.msn.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Certificates&nbsp;loaded:&nbsp;173&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Resolving&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;)...&nbsp;204.79.197.203&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Caching&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;=&gt;&nbsp;204.79.197.203&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;)|204.79.197.203|:443...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Created&nbsp;socket&nbsp;4.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Releasing&nbsp;0x10503f98&nbsp;(new&nbsp;refcount&nbsp;1).&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;---request&nbsp;begin---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;GET&nbsp;/&nbsp;HTTP/1.1&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;User-Agent:&nbsp;Wget/1.16&nbsp;(linux-gnu)&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Accept:&nbsp;*/*&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Host:&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connection:&nbsp;Keep-Alive&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;---request&nbsp;end---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;HTTP&nbsp;request&nbsp;sent,&nbsp;awaiting&nbsp;response...&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;---response&nbsp;begin---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;HTTP/1.1&nbsp;200&nbsp;OK&lt;/TT&gt;&lt;BR&gt;<br>
&lt;snip&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:59:57&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:59:57&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;204.79.197.203:443&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;200&nbsp;0&nbsp;TAG_NONE:ORIGINAL_DST&nbsp;peek&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:59:58&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:59:58&nbsp;-0600]&nbsp;&quot;GET&nbsp;&lt;A&nbsp;HREF=&quot;https://www.msn.com/&quot;&gt;https://www.msn.com/&lt;/A&gt;&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;200&nbsp;38288&nbsp;TCP_MISS:ORIGINAL_DST&nbsp;bump&lt;BR&gt;<br>
&lt;BR&gt;<br>
Going&nbsp;to&nbsp;a&nbsp;site&nbsp;not&nbsp;in&nbsp;the&nbsp;allowed_https_sites&nbsp;acl:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[09:02:12&nbsp;jlay@powerbook:~/test$&nbsp;wget&nbsp;--ca-certificate=/etc/ssl/certs/sslsplit_ca_cert.pem&nbsp;-d&nbsp;&lt;A&nbsp;HREF=&quot;https://www.weather.com&quot;&gt;https://www.weather.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;DEBUG&nbsp;output&nbsp;created&nbsp;by&nbsp;Wget&nbsp;1.16&nbsp;on&nbsp;linux-gnu.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;URI&nbsp;encoding&nbsp;=&nbsp;&#8216;UTF-8&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;09:04:57--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;https://www.weather.com/&quot;&gt;https://www.weather.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Certificates&nbsp;loaded:&nbsp;173&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Resolving&nbsp;&lt;A&nbsp;HREF=&quot;http://www.weather.com&quot;&gt;www.weather.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.weather.com&quot;&gt;www.weather.com&lt;/A&gt;)...&nbsp;96.17.8.161,&nbsp;96.17.8.138,&nbsp;96.17.8.178,&nbsp;...&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Caching&nbsp;&lt;A&nbsp;HREF=&quot;http://www.weather.com&quot;&gt;www.weather.com&lt;/A&gt;&nbsp;=&gt;&nbsp;96.17.8.161&nbsp;96.17.8.138&nbsp;96.17.8.178&nbsp;96.17.8.171&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.weather.com&quot;&gt;www.weather.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.weather.com&quot;&gt;www.weather.com&lt;/A&gt;)|96.17.8.161|:443...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Created&nbsp;socket&nbsp;4.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Releasing&nbsp;0x1098c108&nbsp;(new&nbsp;refcount&nbsp;1).&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;GnuTLS:&nbsp;The&nbsp;TLS&nbsp;connection&nbsp;was&nbsp;non-properly&nbsp;terminated.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Closed&nbsp;fd&nbsp;4&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Unable&nbsp;to&nbsp;establish&nbsp;SSL&nbsp;connection.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
May&nbsp;30&nbsp;09:04:57&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:09:04:57&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;96.17.8.161:443&nbsp;HTTP/1.1&quot;&nbsp;www.weather.com&nbsp;200&nbsp;0&nbsp;TAG_NONE:HIER_NONE&nbsp;peek&lt;BR&gt;<br>
&lt;BR&gt;<br>
However,&nbsp;changing&nbsp;http_access&nbsp;to&nbsp;http_access&nbsp;allow&nbsp;allowed_https_sites&nbsp;I&nbsp;get:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[08:59:58&nbsp;jlay@powerbook:~/test$&nbsp;wget&nbsp;--ca-certificate=/etc/ssl/certs/sslsplit_ca_cert.pem&nbsp;-d&nbsp;&lt;A&nbsp;HREF=&quot;https://www.msn.com&quot;&gt;https://www.msn.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;DEBUG&nbsp;output&nbsp;created&nbsp;by&nbsp;Wget&nbsp;1.16&nbsp;on&nbsp;linux-gnu.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;URI&nbsp;encoding&nbsp;=&nbsp;&#8216;UTF-8&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;09:02:12--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;https://www.msn.com/&quot;&gt;https://www.msn.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Certificates&nbsp;loaded:&nbsp;173&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Resolving&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;)...&nbsp;204.79.197.203&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Caching&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;=&gt;&nbsp;204.79.197.203&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;)|204.79.197.203|:443...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Created&nbsp;socket&nbsp;4.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Releasing&nbsp;0x10515f98&nbsp;(new&nbsp;refcount&nbsp;1).&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;The&nbsp;certificate's&nbsp;owner&nbsp;does&nbsp;not&nbsp;match&nbsp;hostname&nbsp;&#8216;&lt;A&nbsp;HREF=&quot;http://www.msn.com&quot;&gt;www.msn.com&lt;/A&gt;&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
May&nbsp;30&nbsp;09:02:12&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:09:02:12&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;204.79.197.203:443&nbsp;HTTP/1.1&quot;&nbsp;-&nbsp;200&nbsp;0&nbsp;TCP_DENIED:HIER_NONE&nbsp;peek&lt;BR&gt;<br>
&lt;BR&gt;<br>
Notice&nbsp;that&nbsp;peek&nbsp;did&nbsp;not&nbsp;get&nbsp;the&nbsp;SNI&nbsp;name&nbsp;per&nbsp;my&nbsp;%ssl::&gt;sni&nbsp;in&nbsp;my&nbsp;logging&nbsp;statement.&nbsp;&nbsp;So&nbsp;as&nbsp;of&nbsp;now&nbsp;I&nbsp;have&nbsp;been&nbsp;unable&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;use&nbsp;access&nbsp;control&nbsp;with&nbsp;both&nbsp;http&nbsp;and&nbsp;https.&nbsp;&nbsp;I&nbsp;can&nbsp;do&nbsp;one&nbsp;or&nbsp;the&nbsp;other,&nbsp;but&nbsp;not&nbsp;both&nbsp;so&nbsp;far.&nbsp;&nbsp;Of&nbsp;interest,&nbsp;redirects&nbsp;from&nbsp;http&nbsp;to&nbsp;https&nbsp;do&nbsp;not&nbsp;appear&nbsp;to&nbsp;work&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[08:37:39&nbsp;jlay@powerbook:~/test$&nbsp;wget&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;08:37:44--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com/&quot;&gt;http://www.yahoo.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Resolving&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;)...&nbsp;206.190.36.45,&nbsp;206.190.36.105,&nbsp;2001:4998:c:a06::2:4008&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;)|206.190.36.45|:80...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;HTTP&nbsp;request&nbsp;sent,&nbsp;awaiting&nbsp;response...&nbsp;301&nbsp;Moved&nbsp;Permanently&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Location:&nbsp;&lt;A&nbsp;HREF=&quot;https://www.yahoo.com/&quot;&gt;https://www.yahoo.com/&lt;/A&gt;&nbsp;[following]&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;08:37:44--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;https://www.yahoo.com/&quot;&gt;https://www.yahoo.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;)|206.190.36.45|:443...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ERROR:&nbsp;The&nbsp;certificate&nbsp;of&nbsp;&#8216;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&#8217;&nbsp;is&nbsp;not&nbsp;trusted.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ERROR:&nbsp;The&nbsp;certificate&nbsp;of&nbsp;&#8216;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&#8217;&nbsp;hasn't&nbsp;got&nbsp;a&nbsp;known&nbsp;issuer.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:37:44&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:37:44&nbsp;-0600]&nbsp;&quot;GET&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com/&quot;&gt;http://www.yahoo.com/&lt;/A&gt;&nbsp;HTTP/1.1&quot;&nbsp;-&nbsp;301&nbsp;1812&nbsp;TCP_MISS:ORIGINAL_DST&nbsp;-&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:37:45&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:37:45&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;206.190.36.45:443&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;200&nbsp;0&nbsp;TAG_NONE:ORIGINAL_DST&nbsp;peek&lt;BR&gt;<br>
&lt;BR&gt;<br>
Whereas&nbsp;direct&nbsp;does:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[08:37:45&nbsp;jlay@powerbook:~/test$&nbsp;wget&nbsp;--ca-certificate=/etc/ssl/certs/sslsplit_ca_cert.pem&nbsp;-d&nbsp;&lt;A&nbsp;HREF=&quot;https://www.yahoo.com&quot;&gt;https://www.yahoo.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;DEBUG&nbsp;output&nbsp;created&nbsp;by&nbsp;Wget&nbsp;1.16&nbsp;on&nbsp;linux-gnu.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;URI&nbsp;encoding&nbsp;=&nbsp;&#8216;UTF-8&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;--2015-05-30&nbsp;08:38:27--&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;https://www.yahoo.com/&quot;&gt;https://www.yahoo.com/&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Certificates&nbsp;loaded:&nbsp;173&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Resolving&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;)...&nbsp;206.190.36.105,&nbsp;206.190.36.45,&nbsp;2001:4998:c:a06::2:4008&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Caching&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;=&gt;&nbsp;206.190.36.105&nbsp;206.190.36.45&nbsp;2001:4998:c:a06::2:4008&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connecting&nbsp;to&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;(&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;)|206.190.36.105|:443...&nbsp;connected.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Created&nbsp;socket&nbsp;4.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Releasing&nbsp;0x107800d8&nbsp;(new&nbsp;refcount&nbsp;1).&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;---request&nbsp;begin---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;GET&nbsp;/&nbsp;HTTP/1.1&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;User-Agent:&nbsp;Wget/1.16&nbsp;(linux-gnu)&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Accept:&nbsp;*/*&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Host:&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connection:&nbsp;Keep-Alive&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;snip&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;---response&nbsp;end---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;200&nbsp;OK&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;cdm:&nbsp;1cdm:&nbsp;1cdm:&nbsp;1Registered&nbsp;socket&nbsp;4&nbsp;for&nbsp;persistent&nbsp;reuse.&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;URI&nbsp;content&nbsp;encoding&nbsp;=&nbsp;&#8216;utf-8&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Length:&nbsp;unspecified&nbsp;[text/html]&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Saving&nbsp;to:&nbsp;&#8216;index.html&#8217;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:38:27&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:38:27&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;206.190.36.105:443&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;200&nbsp;0&nbsp;TAG_NONE:ORIGINAL_DST&nbsp;peek&lt;BR&gt;<br>
May&nbsp;30&nbsp;08:38:28&nbsp;analysis&nbsp;squid:&nbsp;192.168.1.73&nbsp;-&nbsp;-&nbsp;[30/May/2015:08:38:28&nbsp;-0600]&nbsp;&quot;GET&nbsp;&lt;A&nbsp;HREF=&quot;https://www.yahoo.com/&quot;&gt;https://www.yahoo.com/&lt;/A&gt;&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.yahoo.com&quot;&gt;www.yahoo.com&lt;/A&gt;&nbsp;200&nbsp;325776&nbsp;TCP_MISS:ORIGINAL_DST&nbsp;bump&lt;BR&gt;<br>
&lt;BR&gt;<br>
I'm&nbsp;getting&nbsp;close...Amos&nbsp;if&nbsp;you're&nbsp;out&nbsp;there&nbsp;maybe&nbsp;you&nbsp;can&nbsp;shed&nbsp;some&nbsp;light&nbsp;on&nbsp;the&nbsp;above.&nbsp;&nbsp;Been&nbsp;at&nbsp;this&nbsp;for&nbsp;5&nbsp;hours&nbsp;now..happy&nbsp;Saturday!&lt;BR&gt;<br>
&lt;BR&gt;<br>
James<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
