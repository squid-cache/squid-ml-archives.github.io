<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/4.6.6&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
On&nbsp;Tue,&nbsp;2015-06-09&nbsp;at&nbsp;21:39&nbsp;+0200,&nbsp;Klavs&nbsp;Klavsen&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
Amos&nbsp;Jeffries&nbsp;wrote&nbsp;on&nbsp;2015-06-09&nbsp;17:10:<br>
[CUT]<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;You&nbsp;have&nbsp;to&nbsp;first&nbsp;configure&nbsp;ssl_bump&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;lets&nbsp;Squid&nbsp;receive&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;the&nbsp;clientHello&nbsp;message&nbsp;(step1&nbsp;-&gt;&nbsp;peek)&nbsp;AND&nbsp;the&nbsp;serverHello&nbsp;message&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;(step2&nbsp;-&gt;&nbsp;peek).&nbsp;Then&nbsp;you&nbsp;can&nbsp;use&nbsp;those&nbsp;cert&nbsp;details&nbsp;to&nbsp;bump&nbsp;(step3&nbsp;-&gt;&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;bump).&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;The&nbsp;config&nbsp;is&nbsp;quite&nbsp;simple:&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&nbsp;&nbsp;ssl_bump&nbsp;peek&nbsp;all&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&nbsp;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
I&nbsp;have&nbsp;this:<br>
ssl_bump&nbsp;peek&nbsp;step1&nbsp;broken<br>
ssl_bump&nbsp;peek&nbsp;step2&nbsp;broken<br>
ssl_bump&nbsp;splice&nbsp;broken<br>
ssl_bump&nbsp;peek&nbsp;step1&nbsp;all<br>
ssl_bump&nbsp;peek&nbsp;step2&nbsp;all<br>
ssl_bump&nbsp;bump&nbsp;all<br>
<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;But&nbsp;there&nbsp;are&nbsp;cases&nbsp;like&nbsp;the&nbsp;client&nbsp;is&nbsp;resuming&nbsp;a&nbsp;previous&nbsp;TLS&nbsp;session&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;where&nbsp;there&nbsp;is&nbsp;no&nbsp;certificates&nbsp;involved.&nbsp;Squid&nbsp;cannot&nbsp;do&nbsp;anything,&nbsp;so&nbsp;it&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;automatically&nbsp;splices&nbsp;(3.5.4+&nbsp;at&nbsp;least&nbsp;do).&nbsp;Or&nbsp;if&nbsp;you&nbsp;have&nbsp;configured&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;your&nbsp;Squid&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;there&nbsp;are&nbsp;no&nbsp;mutually&nbsp;supported&nbsp;ciphers.&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
<br>
My&nbsp;client&nbsp;is&nbsp;curl..&nbsp;I&nbsp;don't&nbsp;think&nbsp;that&nbsp;its&nbsp;caching&nbsp;any&nbsp;TLS&nbsp;sessions.<br>
<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;It&nbsp;may&nbsp;just&nbsp;be&nbsp;your&nbsp;ssl_bump&nbsp;rules.&nbsp;But&nbsp;given&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;google&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;domain&nbsp;there&nbsp;is&nbsp;a&nbsp;strong&nbsp;chance&nbsp;that&nbsp;you&nbsp;are&nbsp;encountering&nbsp;one&nbsp;of&nbsp;those&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&nbsp;special&nbsp;case.&lt;/FONT&gt;<br>
&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&gt;&lt;/FONT&gt;<br>
I'd&nbsp;like&nbsp;squid&nbsp;to&nbsp;disallow&nbsp;queries&nbsp;where&nbsp;it&nbsp;cannot&nbsp;see&nbsp;what&nbsp;domain&nbsp;name<br>
/&nbsp;url&nbsp;is&nbsp;going&nbsp;to&nbsp;be&nbsp;accessed.<br>
<br>
I'd&nbsp;like&nbsp;all&nbsp;GET/POST&nbsp;etc.&nbsp;requests&nbsp;to&nbsp;go&nbsp;through&nbsp;squid&nbsp;-&nbsp;so&nbsp;they&nbsp;are<br>
controlled&nbsp;by&nbsp;the&nbsp;normal&nbsp;http_access&nbsp;rules&nbsp;as&nbsp;http&nbsp;(intercepted)&nbsp;is<br>
currently.<br>
<br>
This&nbsp;worked&nbsp;with&nbsp;3.4.12&nbsp;:(&nbsp;(but&nbsp;only&nbsp;for&nbsp;30&nbsp;minutes&nbsp;or&nbsp;less)<br>
<br>
You&nbsp;saw&nbsp;my&nbsp;full&nbsp;config..&nbsp;how&nbsp;is&nbsp;it&nbsp;supposed&nbsp;to&nbsp;look&nbsp;with&nbsp;3.5.5,&nbsp;for&nbsp;this<br>
to&nbsp;work&nbsp;as&nbsp;it&nbsp;did&nbsp;with&nbsp;3.4.12&nbsp;?<br>
<br>
sorry&nbsp;I'm&nbsp;a&nbsp;bit&nbsp;frustrated..&nbsp;I&nbsp;can't&nbsp;seem&nbsp;to&nbsp;grasp&nbsp;what&nbsp;changed&nbsp;from<br>
3.4.12&nbsp;to&nbsp;3.5.5,&nbsp;which&nbsp;means&nbsp;I&nbsp;suddenly&nbsp;can't&nbsp;filter&nbsp;https&nbsp;traffic<br>
anymore&nbsp;:(<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;BR&gt;<br>
Gents,&lt;BR&gt;<br>
&lt;BR&gt;<br>
I'm&nbsp;going&nbsp;to&nbsp;spin&nbsp;this&nbsp;off&nbsp;into&nbsp;a&nbsp;new&nbsp;thread...&quot;Filtering&nbsp;http&nbsp;and&nbsp;https&nbsp;traffic&quot;&nbsp;sometime&nbsp;later&nbsp;today.&nbsp;&nbsp;I&nbsp;have&nbsp;some&nbsp;questions,&nbsp;and&nbsp;maybe&nbsp;solutions.&lt;BR&gt;<br>
&lt;BR&gt;<br>
James<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
