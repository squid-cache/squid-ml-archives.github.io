<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/4.6.6&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Hey&nbsp;All,&lt;BR&gt;<br>
&lt;BR&gt;<br>
So....here's&nbsp;what&nbsp;I&nbsp;have&nbsp;for&nbsp;filtering&nbsp;http&nbsp;and&nbsp;https&nbsp;in&nbsp;the&nbsp;same&nbsp;instance.&nbsp;&nbsp;This&nbsp;is&nbsp;using&nbsp;iptables&nbsp;with&nbsp;-j&nbsp;REDIRECT&nbsp;lines.&nbsp;&nbsp;Below&nbsp;is&nbsp;my&nbsp;entire&nbsp;squid.conf,&nbsp;documented&nbsp;as&nbsp;well&nbsp;as&nbsp;I&nbsp;can:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#allow&nbsp;local&nbsp;network&nbsp;to&nbsp;connect&nbsp;to&nbsp;squid&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;localnet&nbsp;src&nbsp;192.168.1.0/24&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#safe&nbsp;ports&nbsp;are&nbsp;80&nbsp;and&nbsp;443&nbsp;in&nbsp;one&nbsp;acl,&nbsp;port&nbsp;443&nbsp;is&nbsp;another&nbsp;acl&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#allow&nbsp;the&nbsp;http&nbsp;CONNECT&nbsp;method&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#our&nbsp;regex&nbsp;list&nbsp;of&nbsp;sites&nbsp;and&nbsp;domains&nbsp;that&nbsp;we&nbsp;allow&nbsp;ie,&nbsp;www\.apple\.com&nbsp;and&nbsp;\.google\.com&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;allowed_http_sites&nbsp;url_regex&nbsp;&quot;/opt/etc/squid/http_url.txt&quot;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#we&nbsp;don't&nbsp;want&nbsp;to&nbsp;allow&nbsp;anything&nbsp;besides&nbsp;port&nbsp;80&nbsp;and&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#we&nbsp;don't&nbsp;want&nbsp;CONNECT&nbsp;if&nbsp;we're&nbsp;not&nbsp;going&nbsp;to&nbsp;port&nbsp;443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_Ports&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#since&nbsp;we&nbsp;may&nbsp;not&nbsp;know&nbsp;the&nbsp;https&nbsp;site&nbsp;we're&nbsp;going&nbsp;to&nbsp;(ie&nbsp;connect&nbsp;direct&nbsp;by&nbsp;IP),&nbsp;we&nbsp;must&nbsp;initially&nbsp;allow&nbsp;all&nbsp;https&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;allow&nbsp;SSL_ports&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#we&nbsp;allow&nbsp;http,&nbsp;but&nbsp;only&nbsp;sites&nbsp;and&nbsp;domains&nbsp;in&nbsp;our&nbsp;regex&nbsp;http_url.txt&nbsp;list&nbsp;above&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;allow&nbsp;allowed_http_sites&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#drop&nbsp;any&nbsp;other&nbsp;http&nbsp;requests&nbsp;that&nbsp;are&nbsp;not&nbsp;in&nbsp;our&nbsp;regex&nbsp;http_url.txt&nbsp;list&nbsp;above&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_access&nbsp;deny&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#break&nbsp;out&nbsp;the&nbsp;ssl_bump&nbsp;process&nbsp;by&nbsp;steps&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;step3&nbsp;at_step&nbsp;SslBump3&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#look&nbsp;for&nbsp;site&nbsp;or&nbsp;domain&nbsp;name&nbsp;either&nbsp;by&nbsp;SNI&nbsp;in&nbsp;request&nbsp;(step1),&nbsp;or&nbsp;server&nbsp;subject&nbsp;in&nbsp;certificate&nbsp;in&nbsp;response&nbsp;(step2)&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;peek&nbsp;step1&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;peek&nbsp;step2&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#see&nbsp;if&nbsp;the&nbsp;server&nbsp;name&nbsp;we&nbsp;obtained&nbsp;from&nbsp;the&nbsp;previous&nbsp;peek's&nbsp;above&nbsp;are&nbsp;in&nbsp;our&nbsp;http_url.txt&nbsp;list&nbsp;above&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name_regex&nbsp;&quot;/opt/etc/squid/http_url.txt&quot;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#if&nbsp;the&nbsp;server&nbsp;name&nbsp;is&nbsp;in&nbsp;our&nbsp;http_url.txt,&nbsp;allow&nbsp;it&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;splice&nbsp;step3&nbsp;allowed_https_sites&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#if&nbsp;the&nbsp;server&nbsp;name&nbsp;is&nbsp;not&nbsp;in&nbsp;our&nbsp;http_url.txt&nbsp;terminate&nbsp;the&nbsp;handshake&nbsp;it&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;ssl_bump&nbsp;terminate&nbsp;all&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#cert&nbsp;path&nbsp;and&nbsp;allow&nbsp;all&nbsp;the&nbsp;ssl&nbsp;options&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_capath&nbsp;/etc/ssl/certs&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslproxy_options&nbsp;ALL&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#standard&nbsp;crtdaemon&nbsp;options&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslcrtd_program&nbsp;/opt/libexec/ssl_crtd&nbsp;-s&nbsp;/opt/var/ssl_db&nbsp;-M&nbsp;4MB&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;sslcrtd_children&nbsp;5&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#intercept&nbsp;3128&nbsp;for&nbsp;port&nbsp;80,&nbsp;and&nbsp;3129&nbsp;for&nbsp;port&nbsp;443.&nbsp;&nbsp;Cert,&nbsp;cacert&nbsp;(these&nbsp;are&nbsp;the&nbsp;same,&nbsp;read&nbsp;on&nbsp;the&nbsp;list&nbsp;this&nbsp;fixed&nbsp;an&nbsp;issue),&nbsp;and&nbsp;key,&nbsp;generate&nbsp;ssl&nbsp;certs&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;http_port&nbsp;3128&nbsp;intercept&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;https_port&nbsp;3129&nbsp;intercept&nbsp;ssl-bump&nbsp;cert=/opt/etc/squid/certs/sslsplit_ca_cert.pem&nbsp;cafile=/opt/etc/squid/certs/sslsplit_ca_cert.pem&nbsp;key=/opt/etc/squid/certs/sslsplit_ca_key.pem&nbsp;&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;sslflags=NO_SESSION_REUSE&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#normal-ish&nbsp;log&nbsp;format,&nbsp;but&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;the&nbsp;SNI,&nbsp;server&nbsp;cert&nbsp;subject,&nbsp;and&nbsp;how&nbsp;we&nbsp;are&nbsp;bumping&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;logformat&nbsp;mine&nbsp;%&gt;a&nbsp;%[ui&nbsp;%[un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%ssl::&gt;sni&nbsp;%ssl::&gt;cert_subject&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;%Ss:%Sh&nbsp;%ssl::bump_mode&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;#log&nbsp;the&nbsp;above&nbsp;format&nbsp;name&nbsp;(mine)&nbsp;to&nbsp;syslog&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;access_log&nbsp;syslog:daemon.info&nbsp;mine&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;refresh_pattern&nbsp;-i&nbsp;(cgi-bin|\?)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;coredump_dir&nbsp;/opt/var&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
One&nbsp;caveat&nbsp;I've&nbsp;seen&nbsp;so&nbsp;far&nbsp;is&nbsp;that&nbsp;I&nbsp;have&nbsp;only&nbsp;seen&nbsp;is&nbsp;I&nbsp;only&nbsp;ever&nbsp;see&nbsp;peek&nbsp;in&nbsp;the&nbsp;logs,&nbsp;though&nbsp;I&nbsp;know&nbsp;it's&nbsp;been&nbsp;spliced&nbsp;as&nbsp;shown&nbsp;below:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[09:35:19&nbsp;&lt;A&nbsp;HREF=&quot;mailto:jlay@gateway&quot;&gt;jlay@gateway&lt;/A&gt;:/opt/etc/squid$]&nbsp;grep&nbsp;textnow&nbsp;http_url.txt&nbsp;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;api\.textnow\.me&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;[09:34:57&nbsp;&lt;A&nbsp;HREF=&quot;mailto:jlay@gateway&quot;&gt;jlay@gateway&lt;/A&gt;:~$]&nbsp;dig&nbsp;api.textnow.me&lt;/TT&gt;&lt;BR&gt;<br>
&lt;snip&gt;&lt;BR&gt;<br>
&lt;TT&gt;;;&nbsp;ANSWER&nbsp;SECTION:&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;api.textnow.me.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;209.59.180.48&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;From&nbsp;the&nbsp;client:&lt;BR&gt;<br>
&lt;TT&gt;[09:34:27&nbsp;&lt;A&nbsp;HREF=&quot;mailto:jlay@analysis&quot;&gt;jlay@analysis&lt;/A&gt;:~/dev/squid$]&nbsp;openssl&nbsp;s_client&nbsp;-connect&nbsp;209.59.180.48:443&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;CONNECTED(00000003)&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;depth=1&nbsp;C&nbsp;=&nbsp;US,&nbsp;ST&nbsp;=&nbsp;Arizona,&nbsp;L&nbsp;=&nbsp;Scottsdale,&nbsp;O&nbsp;=&nbsp;&quot;GoDaddy.com,&nbsp;Inc.&quot;,&nbsp;OU&nbsp;=&nbsp;&lt;A&nbsp;HREF=&quot;http://certificates.godaddy.com/repository,&quot;&gt;http://certificates.godaddy.com/repository,&lt;/A&gt;&nbsp;CN&nbsp;=&nbsp;Go&nbsp;Daddy&nbsp;Secure&nbsp;Certification&nbsp;Authority,&nbsp;serialNumber&nbsp;=&nbsp;07969287&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;verify&nbsp;error:num=20:unable&nbsp;to&nbsp;get&nbsp;local&nbsp;issuer&nbsp;certificate&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;verify&nbsp;return:0&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;---&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Certificate&nbsp;chain&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&nbsp;0&nbsp;s:/OU=Domain&nbsp;Control&nbsp;Validated/CN=*.textnow.me&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;snip&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;GET&nbsp;/&nbsp;HTTP/1.1&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;HTTP/1.1&nbsp;200&nbsp;OK&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Server:&nbsp;nginx&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Date:&nbsp;Thu,&nbsp;11&nbsp;Jun&nbsp;2015&nbsp;15:36:54&nbsp;GMT&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Content-Type:&nbsp;text/plain&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Transfer-Encoding:&nbsp;chunked&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Connection:&nbsp;keep-alive&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;X-Powered-By:&nbsp;PHP/5.5.16&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Expires:&nbsp;Thu,&nbsp;01&nbsp;Jan&nbsp;1970&nbsp;00:00:00&nbsp;GMT&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;Cache-Control:&nbsp;no-cache,&nbsp;no-store,&nbsp;must-revalidate,&nbsp;max-age=0&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
Server&nbsp;Squid&nbsp;log&nbsp;entry:&lt;BR&gt;<br>
&lt;TT&gt;Jun&nbsp;11&nbsp;09:36:55&nbsp;gateway&nbsp;(squid-1):&nbsp;192.168.1.6&nbsp;-&nbsp;-&nbsp;[11/Jun/2015:09:36:55&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;209.59.180.48:443&nbsp;HTTP/1.1&quot;&nbsp;-&nbsp;-&nbsp;200&nbsp;364&nbsp;TCP_TUNNEL:ORIGINAL_DST&nbsp;peek&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;also&nbsp;notice&nbsp;that&nbsp;the&nbsp;CN&nbsp;does&nbsp;not&nbsp;show&nbsp;up&nbsp;in&nbsp;the&nbsp;logs...it&nbsp;WAS&nbsp;spliced&nbsp;however&nbsp;because&nbsp;it&nbsp;matches&nbsp;our&nbsp;http_url.txt.&nbsp;&nbsp;From&nbsp;the&nbsp;above,&nbsp;it&nbsp;appears&nbsp;that&nbsp;only&nbsp;the&nbsp;step1&nbsp;is&nbsp;getting&nbsp;logged.&nbsp;&nbsp;&nbsp;The&nbsp;below&nbsp;log&nbsp;entry&nbsp;was&nbsp;used&nbsp;with&nbsp;wget&nbsp;(sends&nbsp;SNI&nbsp;by&nbsp;default):&lt;BR&gt;<br>
&lt;TT&gt;Jun&nbsp;11&nbsp;08:51:05&nbsp;gateway&nbsp;squid:&nbsp;192.168.1.6&nbsp;-&nbsp;-&nbsp;[11/Jun/2015:08:51:05&nbsp;-0600]&nbsp;&quot;CONNECT&nbsp;23.211.252.28:443&nbsp;HTTP/1.1&quot;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.apple.com&quot;&gt;www.apple.com&lt;/A&gt;&nbsp;-&nbsp;200&nbsp;14388&nbsp;TCP_TUNNEL:ORIGINAL_DST&nbsp;peek&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;above&nbsp;shows&nbsp;that&nbsp;I&nbsp;logged&nbsp;and&nbsp;retrieved&nbsp;my&nbsp;SNI&nbsp;at&nbsp;step1....the&nbsp;subsequent&nbsp;splice&nbsp;was&nbsp;not&nbsp;logged.&nbsp;&nbsp;I&nbsp;still&nbsp;note&nbsp;that&nbsp;terminates&nbsp;do&nbsp;not&nbsp;get&nbsp;logged&nbsp;(&nbsp;I&nbsp;have&nbsp;a&nbsp;bug&nbsp;open&nbsp;for&nbsp;that&nbsp;but&nbsp;I&nbsp;think&nbsp;the&nbsp;core&nbsp;bug&nbsp;may&nbsp;be&nbsp;that&nbsp;when&nbsp;using&nbsp;atStep&nbsp;you&nbsp;only&nbsp;see&nbsp;step1&nbsp;regardless,&nbsp;but&nbsp;I&nbsp;could&nbsp;be&nbsp;wrong).&nbsp;&nbsp;I'm&nbsp;enclosing&nbsp;an&nbsp;image&nbsp;of&nbsp;what&nbsp;a&nbsp;https&nbsp;terminate&nbsp;looks&nbsp;like&nbsp;from&nbsp;the&nbsp;server&nbsp;and&nbsp;the&nbsp;client&nbsp;(msn.com&nbsp;isn't&nbsp;in&nbsp;the&nbsp;http_url.txt),&nbsp;and&nbsp;also&nbsp;what&nbsp;an&nbsp;https&nbsp;allow&nbsp;looks&nbsp;like&nbsp;(apple.com&nbsp;is&nbsp;in&nbsp;the&nbsp;list).&lt;BR&gt;<br>
&lt;BR&gt;<br>
That's&nbsp;it.&nbsp;&nbsp;I&nbsp;can&nbsp;verify&nbsp;that&nbsp;the&nbsp;above&nbsp;works&nbsp;for&nbsp;a&nbsp;single&nbsp;list&nbsp;of&nbsp;allowed&nbsp;hosts(&lt;A&nbsp;HREF=&quot;http://www.apple.com&quot;&gt;www.apple.com&lt;/A&gt;)&nbsp;and&nbsp;domains&nbsp;(google.com).&nbsp;&nbsp;If&nbsp;there's&nbsp;something&nbsp;I&nbsp;missed...something&nbsp;wrong...ways&nbsp;to&nbsp;improve...ANYTHING&nbsp;for&nbsp;the&nbsp;betterment&nbsp;of&nbsp;Squid&nbsp;users&nbsp;please&nbsp;don't&nbsp;hesitate&nbsp;to&nbsp;jump&nbsp;in&nbsp;here.&nbsp;&nbsp;Thank&nbsp;you.&nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
James&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
