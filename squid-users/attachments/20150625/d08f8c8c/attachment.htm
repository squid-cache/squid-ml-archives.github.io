<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Amos,&nbsp;thanks&nbsp;for&nbsp;info.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;primary&nbsp;settings&nbsp;being&nbsp;used&nbsp;in&nbsp;squid.conf:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;margin-bottom:&nbsp;0in;&nbsp;line-height:&nbsp;100%&quot;&gt;http_port&nbsp;8080&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;port&nbsp;is&nbsp;what<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;SSL&nbsp;Proxy&nbsp;on&nbsp;client&nbsp;browser&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_port&nbsp;8081<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intercept&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;margin-bottom:&nbsp;0in;&nbsp;line-height:&nbsp;100%&quot;&gt;https_port&nbsp;8082<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intercept&nbsp;ssl-bump&nbsp;connection-auth=off<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate-host-certificates=on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamic_cert_mem_cache_size=16MB&nbsp;cert=/etc/squid/ssl/squid.pem<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key=/etc/squid/ssl/squid.key<br>
cipher=ECDHE-RSA-RC4-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:DHE-RSA-CAMELLIA128-SHA:AES128-SHA:RC4-SHA:HIGH:!aNULL:!MD5:!ADH&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;margin-bottom:&nbsp;0in;&nbsp;line-height:&nbsp;100%&quot;&gt;sslcrtd_program<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/usr/lib64/squid/ssl_crtd&nbsp;-s&nbsp;/var/lib/squid_ssl_db&nbsp;-M&nbsp;16MB&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sslcrtd_children&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startup=5&nbsp;idle=1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_bump<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server-first&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_bump&nbsp;none<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localhost&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Then&nbsp;e2guardian&nbsp;uses&nbsp;10101&nbsp;for&nbsp;the&nbsp;browsers,&nbsp;and&nbsp;uses&nbsp;8080&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connecting&nbsp;to&nbsp;squid&nbsp;on&nbsp;the&nbsp;same&nbsp;server.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;generator&quot;&nbsp;content=&quot;LibreOffice&nbsp;4.4.3.2&nbsp;(Windows)&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&nbsp;type=&quot;text/css&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@page&nbsp;{&nbsp;margin:&nbsp;0.79in&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;{&nbsp;margin-bottom:&nbsp;0.1in;&nbsp;line-height:&nbsp;120%&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a:link&nbsp;{&nbsp;so-language:&nbsp;zxx&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;Yet&nbsp;what&nbsp;is&nbsp;happening&nbsp;is&nbsp;there&nbsp;is&nbsp;the&nbsp;GET,&nbsp;then&nbsp;CONNECT&nbsp;and&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tunnel&nbsp;is&nbsp;created,&nbsp;never&nbsp;allowing&nbsp;squid&nbsp;to&nbsp;decrypt&nbsp;and&nbsp;pass&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;along&nbsp;to&nbsp;e2guardian,&nbsp;I&nbsp;suspect&nbsp;Google&nbsp;has&nbsp;changed&nbsp;their<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;settings&nbsp;denying&nbsp;any&nbsp;proxy&nbsp;from&nbsp;intercepting,&nbsp;because&nbsp;we&nbsp;can&nbsp;type<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;most&nbsp;foul&nbsp;terms&nbsp;which&nbsp;are&nbsp;in&nbsp;the&nbsp;&quot;bannedssllist&quot;&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e2guardian&nbsp;and&nbsp;literally&nbsp;nothing&nbsp;is&nbsp;filtered&nbsp;at&nbsp;all&nbsp;on&nbsp;google,&nbsp;nor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;youtube.&nbsp;Yet&nbsp;other&nbsp;secure&nbsp;sites&nbsp;like&nbsp;wordpress,&nbsp;yahoo,&nbsp;and&nbsp;others<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;caught&nbsp;and&nbsp;blocked,&nbsp;so&nbsp;it&nbsp;is&nbsp;just&nbsp;google&nbsp;owned&nbsp;sites&nbsp;that&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More&nbsp;below...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;6/24/2015&nbsp;6:36&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:558A964C.9070208@treenet.co.nz&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;24/06/2015&nbsp;11:03&nbsp;a.m.,&nbsp;Mike&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;We&nbsp;have&nbsp;a&nbsp;server&nbsp;setup&nbsp;using&nbsp;squid&nbsp;3.5&nbsp;and&nbsp;e2guardian&nbsp;(newer&nbsp;branch&nbsp;of<br>
dansguardian),&nbsp;the&nbsp;issue&nbsp;is&nbsp;now&nbsp;google&nbsp;has&nbsp;changed&nbsp;a&nbsp;few&nbsp;things&nbsp;around<br>
and&nbsp;google&nbsp;is&nbsp;no&nbsp;longer&nbsp;filtered&nbsp;which&nbsp;is&nbsp;not&nbsp;acceptable.&nbsp;We&nbsp;already<br>
have&nbsp;the&nbsp;browser&nbsp;settings&nbsp;for&nbsp;SSL&nbsp;Proxy&nbsp;set&nbsp;to&nbsp;our&nbsp;server,&nbsp;and&nbsp;squid&nbsp;has<br>
ssl-bump&nbsp;enabled&nbsp;and&nbsp;working.&nbsp;Previously&nbsp;there&nbsp;was&nbsp;enough&nbsp;unsecure<br>
content&nbsp;on&nbsp;Google&nbsp;that&nbsp;the&nbsp;filtering&nbsp;was&nbsp;still&nbsp;working,&nbsp;but&nbsp;now&nbsp;google<br>
has&nbsp;gone&nbsp;100%&nbsp;encrypted&nbsp;meaning&nbsp;it&nbsp;is&nbsp;100%&nbsp;unfiltered.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Maybe,&nbsp;maybe&nbsp;not.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;What&nbsp;is&nbsp;happening<br>
is&nbsp;it&nbsp;is&nbsp;creating&nbsp;an&nbsp;ssl&nbsp;tunnel&nbsp;(for&nbsp;lack&nbsp;of&nbsp;a&nbsp;better&nbsp;term)&nbsp;between<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
No.&nbsp;That&nbsp;is&nbsp;the&nbsp;correct&nbsp;and&nbsp;official&nbsp;term&nbsp;for&nbsp;what&nbsp;they&nbsp;are&nbsp;doing.&nbsp;And<br>
&quot;CONNECT&nbsp;tunnel&quot;&nbsp;is&nbsp;the&nbsp;full&nbsp;phrase&nbsp;/&nbsp;name&nbsp;for&nbsp;the&nbsp;particular&nbsp;method&nbsp;of<br>
tunnel&nbsp;creation.<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;their&nbsp;server&nbsp;and&nbsp;the&nbsp;browser,&nbsp;so&nbsp;all&nbsp;squid&nbsp;sees&nbsp;is&nbsp;the&nbsp;connection&nbsp;to<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;http://www.google.com&quot;&gt;www.google.com&lt;/a&gt;,&nbsp;and&nbsp;after&nbsp;that&nbsp;it&nbsp;is&nbsp;tunneled&nbsp;and&nbsp;not&nbsp;recognized&nbsp;by<br>
squid&nbsp;or&nbsp;e2guardian&nbsp;at&nbsp;all.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
BUT&nbsp;...&nbsp;you&nbsp;said&nbsp;you&nbsp;were&nbsp;SSL-Bump'ing.&nbsp;Which&nbsp;means&nbsp;you&nbsp;are&nbsp;decrypting<br>
such&nbsp;tunnels&nbsp;to&nbsp;filter&nbsp;the&nbsp;content&nbsp;inside&nbsp;them.<br>
<br>
So&nbsp;what&nbsp;is&nbsp;the&nbsp;problem?&nbsp;is&nbsp;your&nbsp;method&nbsp;of&nbsp;bumping&nbsp;not&nbsp;decrypting&nbsp;the<br>
Google&nbsp;traffic&nbsp;for&nbsp;Squid&nbsp;access&nbsp;controls&nbsp;and&nbsp;helpers&nbsp;to&nbsp;filter?<br>
<br>
Note&nbsp;that&nbsp;DansGuardian&nbsp;and&nbsp;e2guardian&nbsp;being&nbsp;independent&nbsp;HTTP&nbsp;proxies&nbsp;are<br>
not&nbsp;party&nbsp;to&nbsp;that&nbsp;SSL-Bump&nbsp;decrypted&nbsp;content&nbsp;inside&nbsp;Squid.&nbsp;ONly&nbsp;Squid<br>
internals&nbsp;and&nbsp;ICAP/eCAP&nbsp;services&nbsp;have&nbsp;access&nbsp;to&nbsp;it.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:558A964C.9070208@treenet.co.nz&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
I&nbsp;found&nbsp;a&nbsp;few&nbsp;options&nbsp;online&nbsp;that&nbsp;was&nbsp;used&nbsp;with&nbsp;older&nbsp;squid&nbsp;versions&nbsp;but<br>
nothing&nbsp;is&nbsp;working&nbsp;with&nbsp;squid&nbsp;3.5...&nbsp;Looking&nbsp;for&nbsp;something&nbsp;like&nbsp;this:<br>
<br>
acl&nbsp;google&nbsp;dstdomain&nbsp;.google.com<br>
deny_info&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.google.com/webhp?nord=1&quot;&gt;http://www.google.com/webhp?nord=1&lt;/a&gt;&nbsp;google<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
As&nbsp;you&nbsp;said&nbsp;Google&nbsp;have&nbsp;gone&nbsp;100%&nbsp;HTTPS.&nbsp;URLs&nbsp;beginning&nbsp;with&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://&quot;&gt;http://&lt;/a&gt;&nbsp;are<br>
not&nbsp;HTTPS&nbsp;nor&nbsp;accepted&nbsp;there&nbsp;anymore.&nbsp;If&nbsp;used&nbsp;they&nbsp;just&nbsp;get&nbsp;a&nbsp;30x<br>
redirect&nbsp;to&nbsp;an&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://&quot;&gt;https://&lt;/a&gt;&nbsp;URL.<br>
<br>
Amos<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;why&nbsp;we&nbsp;are&nbsp;thinking&nbsp;we&nbsp;can&nbsp;force&nbsp;the&nbsp;redirect,&nbsp;if&nbsp;you&nbsp;have<br>
&nbsp;&nbsp;&nbsp;&nbsp;ides&nbsp;on&nbsp;how&nbsp;to&nbsp;do&nbsp;that.&nbsp;All&nbsp;google&nbsp;pages&nbsp;use&nbsp;the&nbsp;secure&nbsp;aspect,<br>
&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;when&nbsp;that&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.google.com/webhp?nord=1&quot;&gt;http://www.google.com/webhp?nord=1&lt;/a&gt;&nbsp;is&nbsp;used,&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;forces&nbsp;use&nbsp;of&nbsp;the&nbsp;insecure&nbsp;pages,&nbsp;and&nbsp;allows&nbsp;e2guardian&nbsp;filtering&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;work&nbsp;properly.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thank&nbsp;you,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mike&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:558A964C.9070208@treenet.co.nz&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
