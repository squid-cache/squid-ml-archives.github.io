<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;/*&lt;br&gt;You&nbsp;could&nbsp;assign&nbsp;two&nbsp;workers,&nbsp;each&nbsp;with&nbsp;a&nbsp;different&nbsp;http_port&nbsp;and&lt;br&gt;&lt;pre&gt;ssl_crtd&nbsp;helper&nbsp;using&nbsp;different&nbsp;cert&nbsp;databases.&lt;br&gt;&lt;br&gt;*/&lt;br&gt;&lt;br&gt;How&nbsp;to&nbsp;do&nbsp;this?&nbsp;It&nbsp;sounds&nbsp;it&nbsp;might&nbsp;meet&nbsp;our&nbsp;need.&nbsp;&lt;br&gt;&lt;br&gt;The&nbsp;reason&nbsp;is&nbsp;that&nbsp;we&nbsp;assign&nbsp;a&nbsp;port&nbsp;for&nbsp;internal,&nbsp;&lt;br&gt;so&nbsp;we&nbsp;can&nbsp;use&nbsp;cheap&nbsp;CA&nbsp;(self-generated&nbsp;CA),&nbsp;for&nbsp;the&nbsp;collaboration,&nbsp;we&nbsp;use&nbsp;a&nbsp;diffrent&nbsp;port,&nbsp;&lt;br&gt;may&nbsp;need&nbsp;to&nbsp;set&nbsp;up&nbsp;a&nbsp;different&nbsp;CA.&lt;br&gt;&lt;br&gt;THX&lt;br&gt;&lt;br&gt;Alex&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;div&gt;&gt;&nbsp;Date&#58;&nbsp;Tue,&nbsp;30&nbsp;Jun&nbsp;2015&nbsp;16&#58;51&#58;51&nbsp;&#43;1200&lt;br&gt;&gt;&nbsp;From&#58;&nbsp;squid3&#64;treenet.co.nz&lt;br&gt;&gt;&nbsp;To&#58;&nbsp;squid-users&#64;lists.squid-cache.org&lt;br&gt;&gt;&nbsp;Subject&#58;&nbsp;Re&#58;&nbsp;&#91;squid-users&#93;&nbsp;sslbump&nbsp;and&nbsp;caching&nbsp;of&nbsp;generated&nbsp;cert&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;On&nbsp;30/06/2015&nbsp;5&#58;35&nbsp;a.m.,&nbsp;Alex&nbsp;Wu&nbsp;wrote&#58;&lt;br&gt;&gt;&nbsp;&#62;&nbsp;So&nbsp;far&nbsp;as&nbsp;I&nbsp;know,&nbsp;hen&nbsp;sslbump&nbsp;is&nbsp;enabled&nbsp;for&nbsp;a&nbsp;port,&nbsp;for&nbsp;each&nbsp;dns&lt;br&gt;&gt;&nbsp;&#62;&nbsp;name,&nbsp;squid&nbsp;save&nbsp;a&nbsp;cert&nbsp;generated&nbsp;according&nbsp;to&nbsp;dns&nbsp;name&nbsp;and&nbsp;signing&lt;br&gt;&gt;&nbsp;&#62;&nbsp;key&nbsp;&#40;from&nbsp;http_port&nbsp;configuration&#41;.&nbsp;So&nbsp;the&nbsp;next&nbsp;time,&nbsp;the&nbsp;generated&lt;br&gt;&gt;&nbsp;&#62;&nbsp;cert&nbsp;can&nbsp;be&nbsp;fetched&nbsp;if&nbsp;the&nbsp;same&nbsp;dns&nbsp;host&nbsp;and&nbsp;configured&nbsp;signing&nbsp;key.&nbsp;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Signing&nbsp;key&nbsp;is&nbsp;just&nbsp;a&nbsp;validation&nbsp;check&nbsp;on&nbsp;the&nbsp;cert.&nbsp;It&nbsp;has&nbsp;nothing&nbsp;else&lt;br&gt;&gt;&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;actual&nbsp;cert.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;AFAIK&nbsp;generated&nbsp;certs&nbsp;are&nbsp;stored&nbsp;by&nbsp;DN,&nbsp;serial&nbsp;number&nbsp;or&nbsp;hash&nbsp;of&nbsp;the&nbsp;two.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&#62;&nbsp;Now&nbsp;&nbsp;have&nbsp;a&nbsp;question&nbsp;on&nbsp;this&#58;&lt;br&gt;&gt;&nbsp;&#62;&nbsp;&lt;br&gt;&gt;&nbsp;&#62;&nbsp;http_port&nbsp;10045&nbsp;ssl-bump&nbsp;generate-host-certificates&#61;on&lt;br&gt;&gt;&nbsp;&#62;&nbsp;dynamic_cert_mem_cache_size&#61;4MB&lt;br&gt;&gt;&nbsp;&#62;&nbsp;key&#61;/opt/bg/deploy/squid/etc/mydlp/ssl/key_10045.pem&lt;br&gt;&gt;&nbsp;&#62;&nbsp;cert&#61;/opt/bg/deploy/squid/etc/mydlp/ssl/cert_10045.pem&nbsp;http_port&lt;br&gt;&gt;&nbsp;&#62;&nbsp;10046&nbsp;ssl-bump&nbsp;generate-host-certificates&#61;on&lt;br&gt;&gt;&nbsp;&#62;&nbsp;dynamic_cert_mem_cache_size&#61;4MB&lt;br&gt;&gt;&nbsp;&#62;&nbsp;key&#61;/opt/bg/deploy/squid/etc/mydlp/ssl/key_10046.pem&lt;br&gt;&gt;&nbsp;&#62;&nbsp;cert&#61;/opt/bg/deploy/squid/etc/mydlp/ssl/cert_10046.pem&nbsp;I&nbsp;have&nbsp;two&lt;br&gt;&gt;&nbsp;&#62;&nbsp;ports&nbsp;configured&nbsp;with&nbsp;SSLBUMP.&nbsp;Each&nbsp;port&nbsp;has&nbsp;its&nbsp;own&nbsp;CA&nbsp;signing&nbsp;key.&lt;br&gt;&gt;&nbsp;&#62;&nbsp;The&nbsp;desired&nbsp;behavior&nbsp;is&nbsp;that,&nbsp;for&nbsp;the&nbsp;hostname&nbsp;www.foo.com,&nbsp;the&lt;br&gt;&gt;&nbsp;&#62;&nbsp;certificate&nbsp;generated&nbsp;for&nbsp;the&nbsp;port&nbsp;should&nbsp;use&nbsp;key_10045,&nbsp;and&nbsp;the&lt;br&gt;&gt;&nbsp;&#62;&nbsp;certificate&nbsp;generated&nbsp;for&nbsp;the&nbsp;port&nbsp;should&nbsp;use&nbsp;key_10046.&nbsp;It&nbsp;seems&nbsp;OK.&lt;br&gt;&gt;&nbsp;&#62;&nbsp;&nbsp;But,&nbsp;if&nbsp;we&nbsp;look&nbsp;at&nbsp;the&nbsp;ssl_db,&nbsp;only&nbsp;the&nbsp;last&nbsp;generated&nbsp;certificate&lt;br&gt;&gt;&nbsp;&#62;&nbsp;is&nbsp;cached&nbsp;for&nbsp;www.foo.com.&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;cache&nbsp;the&nbsp;generated&lt;br&gt;&gt;&nbsp;&#62;&nbsp;certificates&nbsp;by&nbsp;the&nbsp;host&nbsp;and&nbsp;signing&nbsp;key&#63;&nbsp;Alex&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Not&nbsp;in&nbsp;the&nbsp;current&nbsp;design.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;You&nbsp;could&nbsp;assign&nbsp;two&nbsp;workers,&nbsp;each&nbsp;with&nbsp;a&nbsp;different&nbsp;http_port&nbsp;and&lt;br&gt;&gt;&nbsp;ssl_crtd&nbsp;helper&nbsp;using&nbsp;different&nbsp;cert&nbsp;databases.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;What&nbsp;is&nbsp;the&nbsp;point&nbsp;of&nbsp;this&nbsp;anyway&#63;&nbsp;Why&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;make&nbsp;your&nbsp;users&lt;br&gt;&gt;&nbsp;face&nbsp;a&nbsp;constant&nbsp;stream&nbsp;of&nbsp;nasty&nbsp;certificate-changed&nbsp;errors&#63;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Amos&lt;br&gt;&gt;&nbsp;_______________________________________________&lt;br&gt;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;&gt;&nbsp;squid-users&#64;lists.squid-cache.org&lt;br&gt;&gt;&nbsp;http&#58;//lists.squid-cache.org/listinfo/squid-users&lt;br&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
