<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=utf-8&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;Wow&nbsp;thank&nbsp;you&nbsp;Amos&nbsp;for&nbsp;that&nbsp;information.&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;I&nbsp;must&nbsp;read,&nbsp;research,&nbsp;digest,&nbsp;read&nbsp;and&nbsp;then&nbsp;attempt&nbsp;to&nbsp;figure&nbsp;out&nbsp;what&nbsp;the&nbsp;problem&nbsp;is.&nbsp;:-)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Will&nbsp;be&nbsp;in&nbsp;touch&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;further&nbsp;issues.&nbsp;&nbsp;Thank&nbsp;you.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;apple-content-edited=&quot;true&quot;&nbsp;class=&quot;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;~&nbsp;Laz&nbsp;Peterson&lt;/span&gt;&lt;br&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;Paravis,&nbsp;LLC&lt;/span&gt;&lt;br&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;orphans:&nbsp;2;&nbsp;widows:&nbsp;2;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Jul&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;9:03&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;class=&quot;&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;18/07/2015&nbsp;1:42&nbsp;a.m.,&nbsp;Laz&nbsp;C.&nbsp;Peterson&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;Hello&nbsp;all,&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Very&nbsp;weird&nbsp;issue&nbsp;here.&nbsp;&nbsp;This&nbsp;happens&nbsp;to&nbsp;only&nbsp;select&nbsp;Citrix&nbsp;support&nbsp;articles.&nbsp;&nbsp;(For&nbsp;example,&nbsp;&lt;a&nbsp;href=&quot;http://support.citrix.com/article/CTX122972&quot;&nbsp;class=&quot;&quot;&gt;http://support.citrix.com/article/CTX122972&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://support.citrix.com/article/CTX122972&quot;&nbsp;class=&quot;&quot;&gt;http://support.citrix.com/article/CTX122972&lt;/a&gt;&gt;&nbsp;when&nbsp;searching&nbsp;Google&nbsp;for&nbsp;“citrix&nbsp;netscaler&nbsp;expired&nbsp;password”&nbsp;which&nbsp;is&nbsp;the&nbsp;top&nbsp;link&nbsp;in&nbsp;my&nbsp;results,&nbsp;or&nbsp;also&nbsp;searching&nbsp;for&nbsp;the&nbsp;same&nbsp;article&nbsp;directly&nbsp;on&nbsp;Citrix&nbsp;support&nbsp;site.)&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;This&nbsp;is&nbsp;a&nbsp;new&nbsp;install&nbsp;of&nbsp;Squid&nbsp;3&nbsp;on&nbsp;Ubuntu&nbsp;14.04.2&nbsp;(from&nbsp;Ubuntu&nbsp;repository).&nbsp;&nbsp;When&nbsp;clicking&nbsp;the&nbsp;Google&nbsp;link,&nbsp;I&nbsp;get&nbsp;“too&nbsp;many&nbsp;redirects”&nbsp;error,&nbsp;saying&nbsp;that&nbsp;possibly&nbsp;the&nbsp;page&nbsp;refers&nbsp;to&nbsp;another&nbsp;page&nbsp;that&nbsp;is&nbsp;then&nbsp;redirected&nbsp;back&nbsp;to&nbsp;the&nbsp;original&nbsp;page.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I&nbsp;tried&nbsp;debugging&nbsp;but&nbsp;did&nbsp;not&nbsp;find&nbsp;much&nbsp;useful&nbsp;information.&nbsp;&nbsp;Has&nbsp;anyone&nbsp;else&nbsp;seen&nbsp;behavior&nbsp;like&nbsp;this?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;The&nbsp;problem&nbsp;is&nbsp;the&nbsp;client&nbsp;fething&nbsp;URL&nbsp;X,&nbsp;gets&nbsp;a&nbsp;30x&nbsp;redirect&nbsp;message&lt;br&nbsp;class=&quot;&quot;&gt;instructing&nbsp;it&nbsp;to&nbsp;contacts&nbsp;URL&nbsp;X&nbsp;instead&nbsp;(X&nbsp;being&nbsp;same&nbsp;URL&nbsp;X&nbsp;it&nbsp;*was*&lt;br&nbsp;class=&quot;&quot;&gt;fetching).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Usually&nbsp;that&nbsp;is&nbsp;a&nbsp;miconfiguration&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;itself.&nbsp;Fixable&lt;br&nbsp;class=&quot;&quot;&gt;only&nbsp;by&nbsp;the&nbsp;origin&nbsp;site&nbsp;authors.&nbsp;But&nbsp;there&nbsp;are&nbsp;also&nbsp;a&nbsp;few&nbsp;ways&nbsp;Squid&nbsp;can&lt;br&nbsp;class=&quot;&quot;&gt;play&nbsp;a&nbsp;part:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;1)&nbsp;The&nbsp;30x&nbsp;response&nbsp;pointing&nbsp;to&nbsp;itself&nbsp;(wrongly)&nbsp;really&nbsp;was&nbsp;generated&nbsp;by&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;server&nbsp;and&nbsp;also&nbsp;explicitly&nbsp;stated&nbsp;that&nbsp;it&nbsp;should&nbsp;be&nbsp;cached&nbsp;[or&nbsp;you&lt;br&nbsp;class=&quot;&quot;&gt;configured&nbsp;Squid&nbsp;to&nbsp;force-cache].&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Squid&nbsp;obeyed,&nbsp;and&nbsp;now&nbsp;you&nbsp;keep&nbsp;getting&nbsp;these&nbsp;loops.&nbsp;That&nbsp;will&nbsp;continue&lt;br&nbsp;class=&quot;&quot;&gt;until&nbsp;the&nbsp;cached&nbsp;content&nbsp;expires&nbsp;or&nbsp;is&nbsp;purged.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;2)&nbsp;You&nbsp;are&nbsp;using&nbsp;Store-ID/Store-URL&nbsp;feature&nbsp;of&nbsp;Squid&nbsp;and&nbsp;did&nbsp;not&nbsp;check&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;the&nbsp;URLs&nbsp;being&nbsp;merged&nbsp;were&nbsp;identical&nbsp;output.&nbsp;One&nbsp;of&nbsp;them&nbsp;produces&nbsp;a&lt;br&nbsp;class=&quot;&quot;&gt;302&nbsp;redirect&nbsp;to&nbsp;X,&nbsp;which&nbsp;got&nbsp;cached.&nbsp;So&nbsp;now&nbsp;fetches&nbsp;for&nbsp;any&nbsp;URL&nbsp;in&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;merged&nbsp;set&nbsp;(including&nbsp;the&nbsp;X&nbsp;itself)&nbsp;gets&nbsp;the&nbsp;cached&nbsp;302&nbsp;redirect&nbsp;back&nbsp;to&nbsp;X.&lt;br&nbsp;class=&quot;&quot;&gt;Again,&nbsp;that&nbsp;will&nbsp;continue&nbsp;until&nbsp;the&nbsp;cached&nbsp;content&nbsp;expires&nbsp;or&nbsp;is&nbsp;purged.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;3)&nbsp;You&nbsp;are&nbsp;using&nbsp;a&nbsp;URL&nbsp;redirector&nbsp;that&nbsp;is&nbsp;generating&nbsp;the&nbsp;302&nbsp;response&lt;br&nbsp;class=&quot;&quot;&gt;loop.&nbsp;Usually&nbsp;redirectors&nbsp;with&nbsp;badly&nbsp;written&nbsp;(overly&nbsp;inclusive)&nbsp;regex&lt;br&nbsp;class=&quot;&quot;&gt;patterns&nbsp;causing&nbsp;similar&nbsp;behaviour&nbsp;to&nbsp;(2).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;4)&nbsp;You&nbsp;are&nbsp;using&nbsp;a&nbsp;URL&nbsp;re-writer&nbsp;that&nbsp;is&nbsp;taking&nbsp;client&nbsp;request&nbsp;URL&nbsp;Y&nbsp;and&lt;br&nbsp;class=&quot;&quot;&gt;(wrongly)&nbsp;re-writing&nbsp;it&nbsp;to&nbsp;X.&nbsp;Squid&nbsp;fetches&nbsp;X&nbsp;from&nbsp;the&nbsp;backend&nbsp;server,&lt;br&nbsp;class=&quot;&quot;&gt;which&nbsp;replies&nbsp;with&nbsp;a&nbsp;redirect&nbsp;to&nbsp;Y&nbsp;(because&nbsp;Y&nbsp;!=&nbsp;X).&nbsp;...&nbsp;and&nbsp;loop.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;5)&nbsp;You&nbsp;could&nbsp;be&nbsp;directing&nbsp;traffic&nbsp;using&nbsp;a&nbsp;cache_peer&nbsp;on&nbsp;port&nbsp;80&lt;br&nbsp;class=&quot;&quot;&gt;regardless&nbsp;of&nbsp;http://&nbsp;or&nbsp;https://&nbsp;scheme&nbsp;received&nbsp;from&nbsp;the&nbsp;clients.&nbsp;If&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;receiving&nbsp;peer/server&nbsp;emits&nbsp;a&nbsp;302&nbsp;for&nbsp;all&nbsp;traffic&nbsp;arriving&nbsp;on&nbsp;its&lt;br&nbsp;class=&quot;&quot;&gt;port&nbsp;80&nbsp;to&nbsp;a&nbsp;https://&nbsp;URL&nbsp;this&nbsp;sort&nbsp;of&nbsp;loop&nbsp;happens.&nbsp;Its&nbsp;a&nbsp;slightly&nbsp;more&lt;br&nbsp;class=&quot;&quot;&gt;complicated&nbsp;form&nbsp;of&nbsp;(4),&nbsp;using&nbsp;a&nbsp;cache_peer&nbsp;equivalent&nbsp;of&nbsp;URL&nbsp;re-writer.&lt;br&nbsp;class=&quot;&quot;&gt;&nbsp;The&nbsp;best&nbsp;fix&nbsp;for&nbsp;that&nbsp;is&nbsp;at&nbsp;the&nbsp;server.&nbsp;RFC&nbsp;7230&nbsp;section&nbsp;5.5&nbsp;has&nbsp;an&lt;br&nbsp;class=&quot;&quot;&gt;algorithm&nbsp;for&nbsp;what&nbsp;compliant&nbsp;servers&nbsp;should&nbsp;be&nbsp;doing.&nbsp;Squids&nbsp;job&nbsp;is&nbsp;to&lt;br&nbsp;class=&quot;&quot;&gt;relay&nbsp;the&nbsp;request&nbsp;and&nbsp;URL&nbsp;unchanged.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Amos&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;_______________________________________________&lt;br&nbsp;class=&quot;&quot;&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;class=&quot;&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
