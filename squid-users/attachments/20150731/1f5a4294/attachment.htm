<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Marcus,&nbsp;tnx&nbsp;for&nbsp;your&nbsp;info.&lt;br&gt;&lt;/div&gt;OS&nbsp;is&nbsp;centos&nbsp;6&nbsp;w&nbsp;kernel &nbsp;2.6.32-504.30.3.el6.x86_64&lt;br&gt;&lt;/div&gt;Yes,&nbsp;cpu_affinity_map&nbsp;is&nbsp;good&nbsp;and&nbsp;with&nbsp;6&nbsp;instances&nbsp;there&nbsp;is&nbsp;load&nbsp;only&nbsp;on&nbsp;first&nbsp;6&nbsp;cores&nbsp;and&nbsp;the&nbsp;server&nbsp;is&nbsp;12&nbsp;core,&nbsp;24&nbsp;HT&lt;br&gt;&lt;/div&gt;each&nbsp;instance&nbsp;is&nbsp;bound&nbsp;to&nbsp;1&nbsp;core.&nbsp;Instance&nbsp;1&nbsp;=&nbsp;core1,&nbsp;instance&nbsp;2&nbsp;=&nbsp;core&nbsp;2&nbsp;and&nbsp;so&nbsp;on&nbsp;so&nbsp;that&nbsp;should&nbsp;not&nbsp;be&nbsp;the&nbsp;problem.&lt;br&gt;&lt;/div&gt;I&#39;ve&nbsp;tried&nbsp;with&nbsp;12&nbsp;workers&nbsp;but&nbsp;that&#39;s&nbsp;even&nbsp;worse.&nbsp;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Let&nbsp;me&nbsp;try&nbsp;to&nbsp;explain:&lt;br&gt;&lt;/div&gt;&lt;div&gt;on&nbsp;non-smp&nbsp;with&nbsp;traffic&nbsp;at&nbsp;~300mbits&nbsp;we&nbsp;have&nbsp;load&nbsp;of&nbsp;~4&nbsp;(on&nbsp;6&nbsp;workers).&lt;br&gt;&lt;/div&gt;&lt;div&gt;in&nbsp;that&nbsp;case,&nbsp;actual&nbsp;user&nbsp;time&nbsp;is&nbsp;about&nbsp;10-20%&nbsp;and&nbsp;70-80%&nbsp;is&nbsp;sys&nbsp;time&nbsp;(osq_lock)&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;connection&nbsp;timeouts.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;switch&nbsp;to&nbsp;SMP&nbsp;6&nbsp;workers&nbsp;user&nbsp;time&nbsp;goes&nbsp;up&nbsp;but&nbsp;sys&nbsp;time&nbsp;goes&nbsp;up&nbsp;too&nbsp;and&nbsp;there&nbsp;are&nbsp;connection&nbsp;timeouts&nbsp;and&nbsp;the&nbsp;load&nbsp;jumps&nbsp;to&nbsp;~12.&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;give&nbsp;it&nbsp;more&nbsp;workers&nbsp;only&nbsp;load&nbsp;jumps&nbsp;and&nbsp;more&nbsp;connections&nbsp;are&nbsp;being&nbsp;dropped&nbsp;to&nbsp;the&nbsp;point&nbsp;that&nbsp;load&nbsp;goes&nbsp;to&nbsp;23/24&nbsp;and&nbsp;the&nbsp;entire&nbsp;server&nbsp;is&nbsp;slow&nbsp;as&nbsp;hell.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;best&nbsp;performance&nbsp;so&nbsp;far&nbsp;are&nbsp;with&nbsp;6&nbsp;non-smp&nbsp;workers.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;now&nbsp;I&nbsp;have&nbsp;2&nbsp;options:&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;Install&nbsp;older&nbsp;squid&nbsp;(3.1.10&nbsp;centos&nbsp;repo)&nbsp;and&nbsp;try&nbsp;it&nbsp;then&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.&nbsp;build&nbsp;custom&nbsp;64bit&nbsp;kernel&nbsp;with&nbsp;RCU&nbsp;and&nbsp;specific&nbsp;cpu&nbsp;family&nbsp;support&nbsp;(in&nbsp;progress).&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;The&nbsp;end&nbsp;idea&nbsp;is&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;sustain&nbsp;1gig&nbsp;of&nbsp;traffic&nbsp;on&nbsp;this&nbsp;server&nbsp;:)&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Any&nbsp;advice&nbsp;is&nbsp;welcome&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;J.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2015-07-31&nbsp;14:53&nbsp;GMT+02:00&nbsp;Marcus&nbsp;Kool&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:marcus.kool@urlfilterdb.com&quot;&nbsp;target=&quot;_blank&quot;&gt;marcus.kool@urlfilterdb.com&lt;/a&gt;&gt;&lt;/span&gt;:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;osq_lock&nbsp;is&nbsp;used&nbsp;in&nbsp;the&nbsp;kenel&nbsp;for&nbsp;the&nbsp;implementation&nbsp;of&nbsp;a&nbsp;mutex.&lt;br&gt;<br>
It&nbsp;is&nbsp;not&nbsp;clear&nbsp;which&nbsp;mutex&nbsp;so&nbsp;we&nbsp;can&nbsp;only&nbsp;guess.&lt;br&gt;<br>
&lt;br&gt;<br>
Which&nbsp;version&nbsp;of&nbsp;the&nbsp;kernel&nbsp;and&nbsp;distro&nbsp;do&nbsp;you&nbsp;use?&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;mutexes&nbsp;are&nbsp;used&nbsp;by&nbsp;Squid&nbsp;SMP,&nbsp;I&nbsp;suggest&nbsp;to&nbsp;switch&nbsp;for&nbsp;now&nbsp;to&nbsp;Squid&nbsp;non-SMP.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;cpu_affinity_map&nbsp;in&nbsp;all&nbsp;config&nbsp;files?&lt;br&gt;<br>
You&nbsp;say&nbsp;they&nbsp;are&nbsp;static.&nbsp;But&nbsp;do&nbsp;you&nbsp;allocate&nbsp;each&nbsp;instance&nbsp;on&nbsp;a&nbsp;different&nbsp;core?&lt;br&gt;<br>
Does&nbsp;&#39;top&#39;&nbsp;show&nbsp;that&nbsp;all&nbsp;CPUs&nbsp;are&nbsp;used?&lt;br&gt;<br>
&lt;br&gt;<br>
Do&nbsp;you&nbsp;have&nbsp;24&nbsp;cores&nbsp;or&nbsp;12&nbsp;hyperthreaded&nbsp;cores?&lt;br&gt;<br>
In&nbsp;case&nbsp;you&nbsp;have&nbsp;12&nbsp;real&nbsp;cores,&nbsp;you&nbsp;might&nbsp;want&nbsp;to&nbsp;experiment&nbsp;with&nbsp;12&nbsp;instances&nbsp;of&nbsp;Squid&nbsp;and&nbsp;then&nbsp;try&nbsp;to&nbsp;upscale.&lt;br&gt;<br>
&lt;br&gt;<br>
Make&nbsp;maximum_object_size&nbsp;large,&nbsp;a&nbsp;max&nbsp;size&nbsp;of&nbsp;16K&nbsp;will&nbsp;prohibit&nbsp;the&nbsp;retrieval&nbsp;of&nbsp;objects&nbsp;larger&nbsp;than&nbsp;16K.&lt;br&gt;<br>
I&nbsp;am&nbsp;not&nbsp;sure&nbsp;about&nbsp;&#39;maximum_object_size_in_memory&nbsp;16&nbsp;KB&#39;&nbsp;but&nbsp;let&nbsp;it&nbsp;be&nbsp;infinite&nbsp;and&nbsp;do&nbsp;not&nbsp;worry&nbsp;since&lt;br&gt;<br>
cache_mem&nbsp;is&nbsp;zero.&lt;br&gt;<br>
&lt;br&gt;<br>
Marcus&lt;div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;07/31/2015&nbsp;03:52&nbsp;AM,&nbsp;Josip&nbsp;Makarevic&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&gt;&lt;div&gt;<br>
Hi&nbsp;Amos,&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;cache_mem&nbsp;0&lt;br&gt;<br>
 &nbsp;cache&nbsp;deny&nbsp;all&lt;br&gt;<br>
&lt;br&gt;<br>
already&nbsp;there.&lt;br&gt;<br>
Regarding&nbsp;number&nbsp;of&nbsp;nic&nbsp;ports&nbsp;we&nbsp;have&nbsp;4&nbsp;10G&nbsp;eth&nbsp;cards&nbsp;2&nbsp;in&nbsp;each&nbsp;bonding&nbsp;interface.&lt;br&gt;<br>
&lt;br&gt;<br>
Well,&nbsp;entire&nbsp;config&nbsp;would&nbsp;be&nbsp;way&nbsp;too&nbsp;long&nbsp;but&nbsp;here&nbsp;is&nbsp;the&nbsp;static&nbsp;part:&lt;br&gt;<br>
via&nbsp;off&lt;br&gt;<br>
cpu_affinity_map&nbsp;process_numbers=1&nbsp;cores=2&lt;br&gt;<br>
forwarded_for&nbsp;delete&lt;br&gt;<br>
visible_hostname&nbsp;squid1&lt;br&gt;<br>
pid_filename&nbsp;/var/run/squid1.pid&lt;br&gt;<br>
icp_port&nbsp;0&lt;br&gt;<br>
htcp_port&nbsp;0&lt;br&gt;<br>
icp_access&nbsp;deny&nbsp;all&lt;br&gt;<br>
htcp_access&nbsp;deny&nbsp;all&lt;br&gt;<br>
snmp_port&nbsp;0&lt;br&gt;<br>
snmp_access&nbsp;deny&nbsp;all&lt;br&gt;<br>
dns_nameservers&nbsp;x.x.x.x&lt;br&gt;<br>
cache_mem&nbsp;0&lt;br&gt;<br>
cache&nbsp;deny&nbsp;all&lt;br&gt;<br>
pipeline_prefetch&nbsp;on&lt;br&gt;<br>
memory_pools&nbsp;off&lt;br&gt;<br>
maximum_object_size&nbsp;16&nbsp;KB&lt;br&gt;<br>
maximum_object_size_in_memory&nbsp;16&nbsp;KB&lt;br&gt;<br>
ipcache_size&nbsp;0&lt;br&gt;<br>
cache_store_log&nbsp;none&lt;br&gt;<br>
half_closed_clients&nbsp;off&lt;br&gt;<br>
include&nbsp;/etc/squid/rules&lt;br&gt;<br>
access_log&nbsp;/var/log/squid/squid1-access.log&lt;br&gt;<br>
cache_log&nbsp;/var/log/squid/squid1-cache.log&lt;br&gt;<br>
coredump_dir&nbsp;/var/spool/squid/squid1&lt;br&gt;<br>
refresh_pattern&nbsp;^ftp: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1440 &nbsp; &nbsp;20% &nbsp; &nbsp; 10080&lt;br&gt;<br>
refresh_pattern&nbsp;^gopher: &nbsp; &nbsp; &nbsp; &nbsp;1440 &nbsp; &nbsp;0% &nbsp; &nbsp; &nbsp;1440&lt;br&gt;<br>
refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0 &nbsp; &nbsp; 0% &nbsp; &nbsp; &nbsp;0&lt;br&gt;<br>
refresh_pattern&nbsp;. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 20% &nbsp; &nbsp; 4320&lt;br&gt;<br>
&lt;br&gt;<br>
acl&nbsp;port0&nbsp;myport&nbsp;30000&lt;br&gt;<br>
http_access&nbsp;allow&nbsp;testhost&lt;br&gt;<br>
tcp_outgoing_address&nbsp;x.x.x.x&nbsp;port0&lt;br&gt;<br>
&lt;br&gt;<br>
include&nbsp;is&nbsp;there&nbsp;for&nbsp;basic&nbsp;ACL&nbsp;-&nbsp;safe&nbsp;ports&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;to&nbsp;minimize&nbsp;config&nbsp;file&nbsp;footprint&nbsp;since&nbsp;it&#39;s&nbsp;static&nbsp;and&nbsp;same&nbsp;for&nbsp;every&nbsp;worker.&lt;br&gt;<br>
&lt;br&gt;<br>
and&nbsp;so&nbsp;on&nbsp;44&nbsp;more&nbsp;times&nbsp;in&nbsp;this&nbsp;config&nbsp;file&lt;br&gt;<br>
&lt;br&gt;<br>
Do&nbsp;you&nbsp;know&nbsp;of&nbsp;any&nbsp;good&nbsp;article&nbsp;hot&nbsp;to&nbsp;tune&nbsp;kernel&nbsp;locking&nbsp;or&nbsp;have&nbsp;any&nbsp;idea&nbsp;why&nbsp;is&nbsp;it&nbsp;happening?&lt;br&gt;<br>
I&nbsp;cannot&nbsp;find&nbsp;any&nbsp;good&nbsp;info&nbsp;on&nbsp;it&nbsp;and&nbsp;all&nbsp;I&#39;ve&nbsp;found&nbsp;are&nbsp;bits&nbsp;and&nbsp;peaces&nbsp;of&nbsp;kernel&nbsp;source&nbsp;code.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Tnx.&lt;br&gt;<br>
J.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
2015-07-31&nbsp;0:42&nbsp;GMT+02:00&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&gt;:&lt;div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;On&nbsp;31/07/2015&nbsp;8:05&nbsp;a.m.,&nbsp;Josip&nbsp;Makarevic&nbsp;wrote:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;Hi,&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;problem&nbsp;with&nbsp;squid&nbsp;setup&nbsp;(squid&nbsp;version&nbsp;3.5.6,&nbsp;built&nbsp;from&nbsp;source,&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;centos&nbsp;6.6)&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;I&#39;ve&nbsp;tried&nbsp;2&nbsp;options:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;1.&nbsp;SMP&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;2.&nbsp;NON-SMP&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;I&#39;ve&nbsp;decided&nbsp;to&nbsp;stick&nbsp;with&nbsp;custom&nbsp;build&nbsp;non-smp&nbsp;version&nbsp;and&nbsp;the&nbsp;thing&nbsp;is:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;-&nbsp;i&nbsp;don&#39;t&nbsp;need&nbsp;cache&nbsp;-&nbsp;any&nbsp;kind&nbsp;of&nbsp;it&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;cache_mem&nbsp;0&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp;cache&nbsp;deny&nbsp;all&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;That&nbsp;is&nbsp;it.&nbsp;All&nbsp;other&nbsp;caches&nbsp;used&nbsp;by&nbsp;Squid&nbsp;*are*&nbsp;mandatory&nbsp;for&nbsp;good&lt;br&gt;<br>
 &nbsp; &nbsp;performance.&nbsp;And&nbsp;are&nbsp;only&nbsp;used&nbsp;anyway&nbsp;when&nbsp;the&nbsp;component&nbsp;that&nbsp;needs&nbsp;them&lt;br&gt;<br>
 &nbsp; &nbsp;is&nbsp;actively&nbsp;used.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;-&nbsp;I&nbsp;have&nbsp;DNS&nbsp;cache&nbsp;just&nbsp;for&nbsp;that&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;-&nbsp;squid&nbsp;has&nbsp;to&nbsp;listen&nbsp;on&nbsp;1024&nbsp;ports&nbsp;on&nbsp;23&nbsp;instances.&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;each&nbsp;instance&nbsp;listens&nbsp;on&nbsp;set&nbsp;of&nbsp;ports&nbsp;and&nbsp;each&nbsp;port&nbsp;has&nbsp;different&nbsp;outgoing&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;ip&nbsp;address.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;And&nbsp;how&nbsp;many&nbsp;NIC&nbsp;do&nbsp;you&nbsp;have&nbsp;that&nbsp;spread&nbsp;over?&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;The&nbsp;thing&nbsp;is&nbsp;this:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;It&#39;s&nbsp;alll&nbsp;good&nbsp;until&nbsp;we&nbsp;hit&nbsp;it&nbsp;with&nbsp;more&nbsp;than&nbsp;150mbits&nbsp;then...&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;(output&nbsp;from&nbsp;perf&nbsp;top)&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp;84.57% &nbsp;[kernel] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[k]&nbsp;osq_lock&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp; 4.62% &nbsp;[kernel] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[k]&nbsp;mutex_spin_on_owner&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp; 1.41% &nbsp;[kernel] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[k]&nbsp;memcpy&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp; 0.79% &nbsp;[kernel] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[k]&nbsp;inet_dump_ifaddr&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp; 0.62% &nbsp;[kernel] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[k]&nbsp;memset&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt; &nbsp;21:53:39&nbsp;up&nbsp;7&nbsp;days,&nbsp;10:38, &nbsp;1&nbsp;user, &nbsp;load&nbsp;average:&nbsp;24.01,&nbsp;23.84,&nbsp;23.33&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;(yes,&nbsp;we&nbsp;have&nbsp;24&nbsp;cores)&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;Same&nbsp;behavior&nbsp;is&nbsp;with&nbsp;SMP&nbsp;and&nbsp;NON-SMP&nbsp;setup&nbsp;(SMP&nbsp;setup&nbsp;is&nbsp;all&nbsp;in&nbsp;one&nbsp;file&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;with&nbsp;workers&nbsp;23&nbsp;option&nbsp;but&nbsp;then&nbsp;I&nbsp;have&nbsp;to&nbsp;use&nbsp;rock&nbsp;cache)&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;so,&nbsp;my&nbsp;question&nbsp;is....what...how&nbsp;to&nbsp;optimize&nbsp;this.....whatever....I&#39;m&nbsp;stuck&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;for&nbsp;days,&nbsp;I&#39;ve&nbsp;tried&nbsp;many&nbsp;sysctl&nbsp;options&nbsp;but&nbsp;none&nbsp;of&nbsp;them&nbsp;works.&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;Any&nbsp;help,&nbsp;info,&nbsp;something&nbsp;else?&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;None&nbsp;of&nbsp;those&nbsp;are&nbsp;Squid&nbsp;functionality.&nbsp;If&nbsp;you&nbsp;want&nbsp;help&nbsp;optimizing&nbsp;your&lt;br&gt;<br>
 &nbsp; &nbsp;config&nbsp;and&nbsp;are&nbsp;willing&nbsp;to&nbsp;post&nbsp;it&nbsp;to&nbsp;the&nbsp;list&nbsp;I&nbsp;am&nbsp;happy&nbsp;to&nbsp;do&nbsp;a&nbsp;quick&lt;br&gt;<br>
 &nbsp; &nbsp;audit&nbsp;and&nbsp;point&nbsp;out&nbsp;any&nbsp;problem&nbsp;areas&nbsp;for&nbsp;you.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;But&nbsp;tuning&nbsp;the&nbsp;internal&nbsp;locking&nbsp;code&nbsp;of&nbsp;the&nbsp;kernel&nbsp;is&nbsp;way&nbsp;off&nbsp;topic.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Amos&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;_______________________________________________&lt;br&gt;<br>
 &nbsp; &nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
 &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;/blockquote&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
