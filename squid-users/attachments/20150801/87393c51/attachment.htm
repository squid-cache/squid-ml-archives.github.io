<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;Hi,&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;authenticate&nbsp;the&nbsp;squid3&nbsp;in&nbsp;Samba4.&nbsp;The&nbsp;part&nbsp;of&nbsp;Samba&nbsp;4&nbsp;authentication&nbsp;is&nbsp;OK,&nbsp;because&nbsp;with&nbsp;the&nbsp;commands&nbsp;wbinfo&nbsp;-i,&nbsp;getent&nbsp;passwd,&nbsp;klist,&nbsp;kinit&nbsp;is&nbsp;all&nbsp;right&nbsp;and&nbsp;I&nbsp;can&nbsp; get&nbsp; the&nbsp;expected&nbsp;results.&nbsp;Also&nbsp;on&nbsp;the&nbsp;command&nbsp;line&nbsp;can&nbsp;authenticate&nbsp;users&nbsp;(/usr&nbsp;/bin/ntlm_auth&nbsp;--username&nbsp;=&nbsp;DomainUser),&nbsp;however,&nbsp;when&nbsp;using&nbsp;the&nbsp;squid&nbsp;does&nbsp;not.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;I&nbsp;have&nbsp;already&nbsp;followed&nbsp;several&nbsp;tutorials,&nbsp;including&nbsp;to&nbsp;authenticate&nbsp;to&nbsp;AD,&nbsp;as&nbsp;the&nbsp;Samba&nbsp;4&nbsp; is&nbsp;fully&nbsp;compatible&nbsp;with&nbsp;AD.&nbsp;Nothing&nbsp;works.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;Follow&nbsp;my&nbsp;configuration&nbsp;file&nbsp;(squid.conf):&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_port&nbsp;3128&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;visible_hostname &lt;a&nbsp;href=&quot;http://proxy-server.meudominio.com.br/&quot;&nbsp;target=&quot;_blank&quot;&gt;proxy-server.meudominio.com.br&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;error_directory&nbsp;/usr/share/squid3/errors/Portuguese&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;error_default_language&nbsp;pt-br&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;coredump_dir&nbsp;/var/spool/squid3&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;cache_mem&nbsp;756&nbsp;MB&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;maximum_object_size_in_memory&nbsp;128&nbsp;kB&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;maximum_object_size&nbsp;512&nbsp;MB&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;minimum_object_size&nbsp;0&nbsp;KB&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;cache_swap_low&nbsp;90&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;cache_swap_high&nbsp;95&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;cache_dir&nbsp;ufs&nbsp;/var/spool/squid3&nbsp;2048&nbsp;16&nbsp;256&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;cache_access_log&nbsp;/var/log/squid3/access.log&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;refresh_pattern&nbsp;^ftp:&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;1440&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;20%&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;10080&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;refresh_pattern&nbsp;^gopher:&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;1440&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;0%&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;1440&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;refresh_pattern&nbsp;.&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;0&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;20%&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;4320&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;###########################################################################&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#########&nbsp;user&nbsp;authentication&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;#########&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;###########################################################################&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;ntlm&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=squid-2.5-ntlmssp &lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;ntlm&nbsp;children&nbsp;30 &lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=squid-2.5-basic &lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;ntlm&nbsp;children&nbsp;5&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;basic&nbsp;realm&nbsp;Squid-proxy-caching&nbsp;web&nbsp;server&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours &lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;autenticados&nbsp;proxy_auth&nbsp;REQUIRED&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;ACLS&nbsp;# &lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;localhost&nbsp;src &lt;a&nbsp;href=&quot;http://127.0.0.1/32&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1/32&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&nbsp;563&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;21&nbsp;443&nbsp;70&nbsp;563&nbsp;70&nbsp;210&nbsp;280&nbsp;488&nbsp;59&nbsp;591&nbsp;777&nbsp;901&nbsp;1025-65535&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;purge&nbsp;method&nbsp;PURGE&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;allow&nbsp;manager&nbsp;localhost&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;allow&nbsp;purge&nbsp;localhost&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;purge&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;!autenticados&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;allow&nbsp;autenticados&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;acl&nbsp;redelocal&nbsp;src &lt;a&nbsp;href=&quot;http://192.168.0.0/22&quot;&nbsp;target=&quot;_blank&quot;&gt;192.168.0.0/22&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;allow&nbsp;redelocal&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;###########################################################################&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;My&nbsp;/etc/hosts&nbsp;following&nbsp;below:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;127.0.0.1&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;localhost&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;192.168.0.35&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;a&nbsp;href=&quot;http://squid-server.mydomain.com.br/&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-server.mydomain.com.br&lt;/a&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;squid-server&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;The&nbsp; /etc/resolv.conf&nbsp;is:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;domain &lt;a&nbsp;href=&quot;http://mydomain.com.br/&quot;&nbsp;target=&quot;_blank&quot;&gt;mydomain.com.br&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;search &lt;a&nbsp;href=&quot;http://mydomain.com.br/&quot;&nbsp;target=&quot;_blank&quot;&gt;mydomain.com.br&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;nameserver&nbsp;192.168.0.5&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;I&nbsp;found&nbsp;that&nbsp;the&nbsp;Squid&nbsp;folder&nbsp;there&nbsp;is&nbsp;this&nbsp;file&nbsp;that&nbsp;does&nbsp;not&nbsp;know:&nbsp;msntauth.conf,&nbsp;with&nbsp;the&nbsp;following&nbsp;contents:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;Sample&nbsp;MSNT&nbsp;authenticator&nbsp;configuration&nbsp;file&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;Antonino&nbsp;Iannella,&nbsp;Stellar-X&nbsp;Pty&nbsp;Ltd&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;Sun&nbsp;Sep&nbsp;2&nbsp;15:52:31&nbsp;CST&nbsp;2001&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;NT&nbsp;hosts&nbsp;to&nbsp;use.&nbsp;Best&nbsp;to&nbsp;put&nbsp;their&nbsp;IP&nbsp;addresses&nbsp;in&nbsp;/etc/hosts.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;server&nbsp;my_PDC&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;my_BDC&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;my_NTdomain&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;server&nbsp;other_PDC&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;other_BDC&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;otherdomain&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#&nbsp;Denied&nbsp;and&nbsp;allowed&nbsp;users.&nbsp;Comment&nbsp;these&nbsp;if&nbsp;not&nbsp;needed.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#denyusers&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;/usr/local/squid/etc/msntauth.denyusers&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;#allowusers&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;/usr/local/squid/etc/msntauth.allowusers&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;I&#39;m&nbsp;using&nbsp;Debian&nbsp;8&nbsp;and&nbsp;Samba&nbsp;4.1.17.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;Do&nbsp;anybody&nbsp;have&nbsp;an&nbsp;idea?&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;Regards,&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8000001907349px&quot;&gt;Márcio&lt;/div&gt;&lt;/div&gt;<br>

</tt>
