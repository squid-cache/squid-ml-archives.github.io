<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;could&nbsp;finally&nbsp;isolate&nbsp;the&nbsp;problem,&nbsp;it&nbsp;only&nbsp;happens&nbsp;if&nbsp;you&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;collapsed_forwarding.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;want,&nbsp;you&nbsp;can&nbsp;use&nbsp;this&nbsp;script&nbsp;to&nbsp;replicate&nbsp;it:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#!/bin/bash&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;H='--header'&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;With&nbsp;Firefox&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wget&nbsp;-d &nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept:<br>
&nbsp;&nbsp;&nbsp;&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept-Encoding:&nbsp;gzip,&nbsp;deflate'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept-Language:&nbsp;en-us,en;q=0.5'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Cache-Control:&nbsp;max-age=0'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Connection:&nbsp;keep-alive'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-U&nbsp;'Mozilla/5.0&nbsp;(Windows&nbsp;NT&nbsp;5.1;&nbsp;rv:10.0.2)&nbsp;Gecko/20100101<br>
&nbsp;&nbsp;&nbsp;&nbsp;Firefox/10.0.2'&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-O&nbsp;/dev/null&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; $1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;With&nbsp;Chrome&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;wget&nbsp;-d &nbsp;\&lt;br&gt;<br>
$H='Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept-Encoding:gzip,deflate,sdch'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Accept-Language:es-ES,es;q=0.8'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Cache-Control:no-cache'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Connection:keep-alive'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$H='Pragma:no-cache'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-U&nbsp;'User-Agent:Mozilla/5.0&nbsp;(X11;&nbsp;Linux&nbsp;x86_64)&nbsp;AppleWebKit/537.32<br>
&nbsp;&nbsp;&nbsp;&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/27.0.1425.0&nbsp;Safari/537.32<br>
&nbsp;&nbsp;&nbsp;&nbsp;SUSE/27.0.1425.0'\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-O&nbsp;/dev/null&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; $1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;End&nbsp;of&nbsp;script&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;script&nbsp;usage:&nbsp;./wgets.sh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;acess.log&nbsp;output:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;1442250327.403    &nbsp;22&nbsp;192.168.2.222&nbsp;TCP_MISS/200&nbsp;3057&nbsp;GET&nbsp;&lt;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&lt;/a&gt;&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;HIER_DIRECT/200.42.136.212&nbsp;image/jpeg&nbsp;[User-Agent:&nbsp;Mozilla/5.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;(Windows&nbsp;NT&nbsp;5.1;&nbsp;rv:10.0.2)&nbsp;Gecko/20100101&nbsp;Firefox/10.0.2\r\nAccept:<br>
&nbsp;&nbsp;&nbsp;&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nHost:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href=&quot;http://www.clarin.com%5Cr%5CnConnection&quot;&gt;www.clarin.com\r\nConnection&lt;/a&gt;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;keep-alive\r\nAccept-Encoding:&nbsp;gzip,&nbsp;deflate\r\nAccept-Language:<br>
&nbsp;&nbsp;&nbsp;&nbsp;en-us,en;q=0.5\r\nCache-Control:&nbsp;max-age=0\r\n]&nbsp;[HTTP/1.1&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;OK\r\nDate:&nbsp;Mon,&nbsp;14&nbsp;Sep&nbsp;2015&nbsp;16:45:34&nbsp;GMT\r\nPragma:<br>
&nbsp;&nbsp;&nbsp;&nbsp;no-cache\r\nVary:&nbsp;Accept-Encoding,User-Agent\r\nContent-Type:<br>
&nbsp;&nbsp;&nbsp;&nbsp;image/jpeg\r\nCache-Control:&nbsp;max-age=86400\r\nTransfer-Encoding:<br>
&nbsp;&nbsp;&nbsp;&nbsp;chunked\r\nConnection:&nbsp;keep-alive\r\nAccept-Ranges:&nbsp;bytes\r\n\r]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;1442250327.431    &nbsp;13&nbsp;192.168.2.222&nbsp;TCP_MISS/200&nbsp;3057&nbsp;GET&nbsp;&lt;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&lt;/a&gt;&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;HIER_DIRECT/200.42.136.212&nbsp;image/jpeg&nbsp;[User-Agent:&nbsp;Wget/1.12<br>
&nbsp;&nbsp;&nbsp;&nbsp;(linux-gnu)\r\nAccept:<br>
&nbsp;&nbsp;&nbsp;&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8--header=Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3--header=Accept-Encoding:gzip,deflate,sdch--header=Accept-Language:es-ES,es;q=0.8--header=Cache-Control:no-cache--header=Connection:keep-alive--header=Pragma:no-cache-U\r\nHost:<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href=&quot;http://www.clarin.com%5Cr%5CnConnection&quot;&gt;www.clarin.com\r\nConnection&lt;/a&gt;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Keep-Alive\r\n]&nbsp;[HTTP/1.1&nbsp;200&nbsp;OK\r\nDate:&nbsp;Mon,&nbsp;14&nbsp;Sep&nbsp;2015&nbsp;16:49:59<br>
&nbsp;&nbsp;&nbsp;&nbsp;GMT\r\nPragma:&nbsp;no-cache\r\nVary:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Accept-Encoding,User-Agent\r\nContent-Type:<br>
&nbsp;&nbsp;&nbsp;&nbsp;image/jpeg\r\nCache-Control:&nbsp;max-age=86400\r\nTransfer-Encoding:<br>
&nbsp;&nbsp;&nbsp;&nbsp;chunked\r\nConnection:&nbsp;keep-alive\r\nAccept-Ranges:&nbsp;bytes\r\n\r]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;cache.log&nbsp;output:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2015/09/14&nbsp;14:05:01&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2015/09/14&nbsp;14:05:27&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match<br>
&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;second&nbsp;attempt,&nbsp;'&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&lt;/a&gt;'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'accept-encoding=&quot;gzip,%20deflate&quot;,<br>
user-agent=&quot;Mozilla%2F5.0%20(Windows%20NT%205.1%3B%20rv%3A10.0.2)%20Gecko%2F20100101%20Firefox%2F10.0.2&quot;'&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2015/09/14&nbsp;14:05:27&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2015/09/14&nbsp;14:05:27&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match<br>
&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;second&nbsp;attempt,&nbsp;'&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&lt;/a&gt;'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'accept-encoding,&nbsp;user-agent=&quot;Wget%2F1.12%20(linux-gnu)&quot;'&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2015/09/14&nbsp;14:05:27&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://www.clarin.com/external-images/GranDTUnificada_5729dd7a1487678526c23516a5083661.jpg&quot;&gt;&lt;/a&gt;squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;-v&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Squid&nbsp;Cache:&nbsp;Version&nbsp;3.5.4&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Service&nbsp;Name:&nbsp;squid&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;configure&nbsp;options: &nbsp;'--prefix=/usr/local'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--datadir=/usr/local/share'&nbsp;'--bindir=/usr/local/sbin'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--libexecdir=/usr/local/lib/squid'&nbsp;'--localstatedir=/var'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--sysconfdir=/etc/squid3'&nbsp;'--enable-delay-pools'&nbsp;'--enable-ssl'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--enable-ssl-crtd'&nbsp;'--enable-linux-netfilter'&nbsp;'--enable-eui'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--enable-snmp'&nbsp;'--enable-gnuregex'&nbsp;'--enable-ltdl-convenience'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--enable-removal-policies=lru&nbsp;heap'&nbsp;'--enable-http-violations'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--with-openssl'&nbsp;'--with-filedescriptors=24321'&nbsp;'--enable-poll'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--enable-epoll'&nbsp;'--enable-storeio=ufs,aufs,diskd,rock'<br>
&nbsp;&nbsp;&nbsp;&nbsp;'--disable-ipv6'&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;do&nbsp;you&nbsp;think?&nbsp;Is&nbsp;this&nbsp;the&nbsp;expected&nbsp;behaviour?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thanks,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Sebastian&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;El&nbsp;04/09/15&nbsp;a&nbsp;las&nbsp;14:27,&nbsp;Sebastián<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Goicochea&nbsp;escribió:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;&nbsp;cite&quot;&nbsp;id=&quot;mid_55E9D497_10201_vianetcon_com_ar&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:55E9D497.10201@vianetcon.com.ar&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kinkie:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GET&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
href=&quot;http://s.ytimg.com/yts/cssbin/www-pageframedelayloaded-vflYYEH8q.css&quot;&gt;http://s.ytimg.com/yts/cssbin/www-pageframedelayloaded-vflYYEH8q.css&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP/1.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User-Agent:&nbsp;Opera/9.80&nbsp;(X11;&nbsp;Linux&nbsp;x86_64)&nbsp;Presto/2.12.388<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Version/12.16&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Host:&nbsp;s.ytimg.com&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accept:&nbsp;text/html,&nbsp;application/xml;q=0.9,&nbsp;application/xhtml+xml,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image/png,&nbsp;image/webp,&nbsp;image/jpeg,&nbsp;image/gif,&nbsp;image/x-xbitmap,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/*;q=0.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accept-Language:&nbsp;es-ES,es;q=0.9,en;q=0.8&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accept-Encoding:&nbsp;gzip,&nbsp;deflate&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pragma:&nbsp;no-cache&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache-Control:&nbsp;no-cache&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proxy-Connection:&nbsp;Keep-Alive&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Answer:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP/1.0&nbsp;200&nbsp;OK&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vary:&nbsp;Accept-Encoding&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Content-Encoding:&nbsp;gzip&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Content-Type:&nbsp;text/css&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Last-Modified:&nbsp;Tue,&nbsp;25&nbsp;Aug&nbsp;2015&nbsp;08:34:05&nbsp;GMT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:&nbsp;Tue,&nbsp;25&nbsp;Aug&nbsp;2015&nbsp;20:25:51&nbsp;GMT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expires:&nbsp;Wed,&nbsp;24&nbsp;Aug&nbsp;2016&nbsp;20:25:51&nbsp;GMT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Timing-Allow-Origin:&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.youtube.com&quot;&gt;https://www.youtube.com&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-Content-Type-Options:&nbsp;nosniff&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server:&nbsp;sffe&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Content-Length:&nbsp;2974&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-XSS-Protection:&nbsp;1;&nbsp;mode=block&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache-Control:&nbsp;public,&nbsp;max-age=31536000&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age:&nbsp;853068&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-Cache:&nbsp;MISS&nbsp;from&nbsp;localhost&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-Cache:&nbsp;MISS&nbsp;from&nbsp;ns2&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-Cache-Lookup:&nbsp;MISS&nbsp;from&nbsp;ns2:3138&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Via:&nbsp;1.0&nbsp;ns2:3138&nbsp;(squid/2.6.STABLE21)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thanks,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sebastian&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;El&nbsp;03/09/15&nbsp;a&nbsp;las&nbsp;13:37,&nbsp;Kinkie<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escribió:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;&nbsp;cite&quot;<br>
id=&quot;mid_CA_Y8hcP4QpYWa71WDZeKJChxvEMEct3fVf1SZvUgHvg5qcud_A_mail_gmail_com&quot;<br>
cite=&quot;mid:CA+Y8hcP4QpYWa71WDZeKJChxvEMEct3fVf1SZvUgHvg5qcud-A@mail.gmail.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi,<br>
&nbsp;&nbsp;&nbsp;do&nbsp;you&nbsp;think&nbsp;you&nbsp;could&nbsp;manage&nbsp;to&nbsp;capture&nbsp;the&nbsp;headers&nbsp;of&nbsp;the<br>
response&nbsp;triggering&nbsp;that&nbsp;error?<br>
I've&nbsp;been&nbsp;looking&nbsp;that&nbsp;up,&nbsp;but&nbsp;couldn't&nbsp;reprduce&nbsp;it.<br>
<br>
The&nbsp;good&nbsp;news&nbsp;is,&nbsp;it's&nbsp;mostly&nbsp;harmless:&nbsp;worst&nbsp;case&nbsp;scenario&nbsp;it&nbsp;will<br>
cause&nbsp;a&nbsp;slow&nbsp;cache&nbsp;miss.<br>
<br>
Thanks<br>
<br>
On&nbsp;Thu,&nbsp;Sep&nbsp;3,&nbsp;2015&nbsp;at&nbsp;5:20&nbsp;PM,&nbsp;Sebastián&nbsp;Goicochea<br>
&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:sebag@vianetcon.com.ar&quot;&gt;&lt;sebag@vianetcon.com.ar&gt;&lt;/a&gt;&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;&nbsp;cite&quot;&nbsp;id=&quot;Cite_6536430&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Amos,&nbsp;I&nbsp;spent&nbsp;a&nbsp;couple&nbsp;of&nbsp;days&nbsp;doing&nbsp;some&nbsp;test&nbsp;with&nbsp;the&nbsp;info&nbsp;you&nbsp;gave&nbsp;me:<br>
<br>
Retested&nbsp;emptying&nbsp;the&nbsp;cache&nbsp;several&nbsp;times,&nbsp;disabled&nbsp;the&nbsp;rewriter,&nbsp;different<br>
config&nbsp;files&nbsp;..&nbsp;all&nbsp;I&nbsp;could&nbsp;think&nbsp;of<br>
<br>
<br>
Downloaded&nbsp;fresh&nbsp;3.5.8&nbsp;tar.gz&nbsp;(just&nbsp;in&nbsp;case&nbsp;it&nbsp;was&nbsp;some&nbsp;3.5.4&nbsp;thing)&nbsp;and<br>
compiled&nbsp;it&nbsp;using&nbsp;this&nbsp;configure&nbsp;options:<br>
<br>
Squid&nbsp;Cache:&nbsp;Version&nbsp;3.5.8<br>
Service&nbsp;Name:&nbsp;squid<br>
configure&nbsp;options:&nbsp;&nbsp;'--prefix=/usr/local'&nbsp;'--datadir=/usr/local/share'<br>
'--bindir=/usr/local/sbin'&nbsp;'--libexecdir=/usr/local/lib/squid'<br>
'--localstatedir=/var'&nbsp;'--sysconfdir=/etc/squid3'&nbsp;'--enable-delay-pools'<br>
'--enable-ssl'&nbsp;'--enable-ssl-crtd'&nbsp;'--enable-linux-netfilter'&nbsp;'--enable-eui'<br>
'--enable-snmp'&nbsp;'--enable-gnuregex'&nbsp;'--enable-ltdl-convenience'<br>
'--enable-removal-policies=lru&nbsp;heap'&nbsp;'--enable-http-violations'<br>
'--with-openssl'&nbsp;'--with-filedescriptors=24321'&nbsp;'--enable-poll'<br>
'--enable-epoll'&nbsp;'--enable-storeio=ufs,aufs,diskd,rock'&nbsp;'--disable-ipv6'<br>
<br>
<br>
<br>
And&nbsp;the&nbsp;problem&nbsp;appeared&nbsp;again,&nbsp;I&nbsp;am&nbsp;suspicious&nbsp;that&nbsp;the&nbsp;problem&nbsp;is&nbsp;in&nbsp;the<br>
configuration,&nbsp;I&nbsp;even&nbsp;removed&nbsp;all&nbsp;my&nbsp;refresh&nbsp;patterns,&nbsp;but:<br>
<br>
2015/09/02&nbsp;15:03:42&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match&nbsp;on<br>
second&nbsp;attempt,&nbsp;'&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://assets.pinterest.com/js/pinit.js&quot;&gt;http://assets.pinterest.com/js/pinit.js&lt;/a&gt;'<br>
'accept-encoding=&quot;gzip,%20deflate&quot;'<br>
2015/09/02&nbsp;15:03:42&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!<br>
2015/09/02&nbsp;15:03:43&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match&nbsp;on<br>
second&nbsp;attempt,&nbsp;'&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://static.cmptch.com/v/lib/str.html&quot;&gt;http://static.cmptch.com/v/lib/str.html&lt;/a&gt;'<br>
'accept-encoding=&quot;gzip,%20deflate,%20sdch&quot;'<br>
2015/09/02&nbsp;15:03:43&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!<br>
2015/09/02&nbsp;15:03:43&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match&nbsp;on<br>
second&nbsp;attempt,<br>
'&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://pstatic.bestpriceninja.com/nwp/v0_0_773/release/Shared/Extra/IFrameStoreReciever.js&quot;&gt;http://pstatic.bestpriceninja.com/nwp/v0_0_773/release/Shared/Extra/IFrameStoreReciever.js&lt;/a&gt;'<br>
'accept-encoding=&quot;gzip,%20deflate,%20sdch&quot;'<br>
2015/09/02&nbsp;15:03:43&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!<br>
2015/09/02&nbsp;15:03:59&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match&nbsp;on<br>
second&nbsp;attempt,&nbsp;'&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://static.xvideos.com/v2/css/xv-video-styles.css?v=7&quot;&gt;http://static.xvideos.com/v2/css/xv-video-styles.css?v=7&lt;/a&gt;'<br>
'accept-encoding=&quot;gzip,deflate&quot;'<br>
2015/09/02&nbsp;15:03:59&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!<br>
2015/09/02&nbsp;15:03:59&nbsp;kid1|&nbsp;varyEvaluateMatch:&nbsp;Oops.&nbsp;Not&nbsp;a&nbsp;Vary&nbsp;match&nbsp;on<br>
second&nbsp;attempt,&nbsp;'&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://s7.addthis.com/js/250/addthis_widget.js&quot;&gt;http://s7.addthis.com/js/250/addthis_widget.js&lt;/a&gt;'<br>
'accept-encoding=&quot;gzip,deflate&quot;'<br>
2015/09/02&nbsp;15:03:59&nbsp;kid1|&nbsp;clientProcessHit:&nbsp;Vary&nbsp;object&nbsp;loop!<br>
<br>
<br>
<br>
Later&nbsp;on&nbsp;I&nbsp;tested&nbsp;it&nbsp;with&nbsp;this&nbsp;short&nbsp;config&nbsp;file&nbsp;and&nbsp;the&nbsp;problem&nbsp;persisted:<br>
<br>
http_access&nbsp;allow&nbsp;localhost&nbsp;manager<br>
http_access&nbsp;deny&nbsp;manager<br>
acl&nbsp;purge&nbsp;method&nbsp;PURGE<br>
http_access&nbsp;allow&nbsp;purge&nbsp;localhost<br>
http_access&nbsp;deny&nbsp;purge<br>
acl&nbsp;all&nbsp;src&nbsp;all<br>
acl&nbsp;localhost&nbsp;src&nbsp;127.0.0.1/32<br>
acl&nbsp;localnet&nbsp;src&nbsp;127.0.0.0/8<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;80<br>
acl&nbsp;snmppublic&nbsp;snmp_community&nbsp;public<br>
http_access&nbsp;deny&nbsp;!Safe_ports<br>
http_access&nbsp;allow&nbsp;all<br>
dns_v4_first&nbsp;on<br>
cache_mem&nbsp;1024&nbsp;MB<br>
maximum_object_size_in_memory&nbsp;64&nbsp;KB<br>
memory_cache_mode&nbsp;always<br>
maximum_object_size&nbsp;150000&nbsp;KB<br>
minimum_object_size&nbsp;100&nbsp;bytes<br>
collapsed_forwarding&nbsp;on<br>
logfile_rotate&nbsp;5<br>
mime_table&nbsp;/etc/squid3/mime.conf<br>
debug_options&nbsp;ALL,1<br>
store_id_access&nbsp;deny&nbsp;all<br>
store_id_bypass&nbsp;on<br>
refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;10080<br>
refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;1440<br>
refresh_pattern&nbsp;^&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http:%5C/%5C/movies%5C.apple%5C.com&quot;&gt;http:\/\/movies\.apple\.com&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86400&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86400<br>
override-expire&nbsp;override-lastmod&nbsp;ignore-no-cache&nbsp;ignore-private<br>
ignore-reload<br>
refresh_pattern&nbsp;-i&nbsp;\.flv$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&nbsp;&nbsp;&nbsp;90%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;999999<br>
ignore-no-cache&nbsp;override-expire&nbsp;ignore-private<br>
refresh_pattern&nbsp;-i&nbsp;\.mov$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&nbsp;&nbsp;&nbsp;90%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;999999<br>
ignore-no-cache&nbsp;override-expire&nbsp;ignore-private<br>
refresh_pattern&nbsp;windowsupdate.com/.*\.(cab|exe)&nbsp;4320&nbsp;100%&nbsp;43200<br>
reload-into-ims<br>
refresh_pattern&nbsp;download.microsoft.com/.*\.(cab|exe)&nbsp;4320&nbsp;100%&nbsp;43200<br>
reload-into-ims<br>
refresh_pattern&nbsp;-i&nbsp;\.(deb|rpm|exe|zip|tar|tgz|ram|rar|bin|ppt|doc|pdf|tiff)$<br>
10080&nbsp;90%&nbsp;43200&nbsp;override-expire&nbsp;ignore-no-cache&nbsp;ignore-private<br>
refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;0<br>
refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;4320<br>
quick_abort_min&nbsp;0&nbsp;KB<br>
quick_abort_max&nbsp;0&nbsp;KB<br>
quick_abort_pct&nbsp;100<br>
range_offset_limit&nbsp;0<br>
negative_ttl&nbsp;1&nbsp;minute<br>
negative_dns_ttl&nbsp;1&nbsp;minute<br>
read_ahead_gap&nbsp;128&nbsp;KB<br>
request_header_max_size&nbsp;100&nbsp;KB<br>
reply_header_max_size&nbsp;100&nbsp;KB<br>
via&nbsp;off<br>
acl&nbsp;apache&nbsp;rep_header&nbsp;Server&nbsp;^Apache<br>
half_closed_clients&nbsp;off<br>
cache_mgr&nbsp;webmaster<br>
cache_effective_user&nbsp;squid<br>
cache_effective_group&nbsp;squid<br>
httpd_suppress_version_string&nbsp;on<br>
snmp_access&nbsp;allow&nbsp;snmppublic&nbsp;localhost<br>
snmp_access&nbsp;deny&nbsp;all<br>
snmp_incoming_address&nbsp;127.0.0.1<br>
error_directory&nbsp;/etc/squid3/errors/English<br>
max_filedescriptors&nbsp;65535<br>
ipcache_size&nbsp;1024<br>
forwarded_for&nbsp;off<br>
log_icp_queries&nbsp;off<br>
icp_access&nbsp;allow&nbsp;localnet<br>
icp_access&nbsp;deny&nbsp;all<br>
htcp_access&nbsp;allow&nbsp;localnet<br>
htcp_access&nbsp;deny&nbsp;all<br>
digest_rebuild_period&nbsp;15&nbsp;minutes<br>
digest_rewrite_period&nbsp;15&nbsp;minutes<br>
strip_query_terms&nbsp;off<br>
max_open_disk_fds&nbsp;150<br>
cache_replacement_policy&nbsp;heap&nbsp;LFUDA<br>
memory_pools&nbsp;off<br>
http_port&nbsp;9001<br>
http_port&nbsp;901&nbsp;tproxy<br>
if&nbsp;${process_number}&nbsp;=&nbsp;1<br>
access_log&nbsp;stdio:/var/log/squid/1/access.log&nbsp;squid<br>
cache_log&nbsp;/var/log/squid/1/cache.log<br>
cache_store_log&nbsp;none<br>
cache_swap_state&nbsp;/var/log/squid/1/%s.swap.state<br>
else<br>
&nbsp;access_log&nbsp;none<br>
&nbsp;cache_log&nbsp;/dev/null<br>
endif<br>
pid_filename&nbsp;/var/run/squid1.pid<br>
visible_hostname&nbsp;localhost<br>
snmp_port&nbsp;1611<br>
icp_port&nbsp;3131<br>
htcp_port&nbsp;4828<br>
cachemgr_passwd&nbsp;admin&nbsp;thisisnotmyrealpassword<br>
memory_cache_shared&nbsp;&nbsp;off<br>
cache_dir&nbsp;rock&nbsp;&nbsp;/cache1/rock1&nbsp;256&nbsp;&nbsp;min-size=100&nbsp;max-size=3000<br>
cache_dir&nbsp;rock&nbsp;&nbsp;/cache1/rock2&nbsp;2000&nbsp;&nbsp;min-size=3000&nbsp;max-size=20000<br>
cache_dir&nbsp;diskd&nbsp;/cache1/diskd2&nbsp;60000&nbsp;16&nbsp;256&nbsp;min-size=20000&nbsp;&nbsp;max-size=200000<br>
cache_dir&nbsp;diskd&nbsp;/cache2/2&nbsp;100000&nbsp;16&nbsp;256&nbsp;min-size=200000&nbsp;&nbsp;max-size=1048576<br>
cache_dir&nbsp;diskd&nbsp;/cache2/1&nbsp;680000&nbsp;16&nbsp;256&nbsp;min-size=1048576<br>
<br>
<br>
<br>
Any&nbsp;ideas&nbsp;what&nbsp;could&nbsp;be&nbsp;wrong?<br>
<br>
<br>
<br>
Thanks,<br>
Sebastian<br>
<br>
<br>
<br>
<br>
<br>
<br>
El&nbsp;26/08/15&nbsp;a&nbsp;las&nbsp;17:15,&nbsp;Amos&nbsp;Jeffries&nbsp;escribió:<br>
<br>
On&nbsp;27/08/2015&nbsp;7:53&nbsp;a.m.,&nbsp;Sebastián&nbsp;Goicochea&nbsp;wrote:<br>
<br>
After&nbsp;I&nbsp;sent&nbsp;you&nbsp;my&nbsp;previous&nbsp;email,&nbsp;I&nbsp;continued&nbsp;investigating&nbsp;the<br>
subject&nbsp;..&nbsp;I&nbsp;made&nbsp;a&nbsp;change&nbsp;in&nbsp;the&nbsp;source&nbsp;code&nbsp;as&nbsp;follows:<br>
<br>
File:&nbsp;/src/http.cc<br>
<br>
HttpStateData::haveParsedReplyHeaders()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
#####&nbsp;THIS&nbsp;IS&nbsp;NEW&nbsp;STUFF&nbsp;###########<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rep-&gt;header.has(HDR_VARY))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;rep-&gt;header.delById(HDR_VARY);<br>
&nbsp;&nbsp;&nbsp;&nbsp;debugs(11,3,&nbsp;&quot;Vary&nbsp;detected.&nbsp;Hack&nbsp;Cleaning&nbsp;it&nbsp;up&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
#####&nbsp;END&nbsp;OF&nbsp;NEW&nbsp;STUFF&nbsp;###########<br>
<br>
#if&nbsp;X_ACCELERATOR_VARY<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rep-&gt;header.has(HDR_X_ACCELERATOR_VARY))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;rep-&gt;header.delById(HDR_X_ACCELERATOR_VARY);<br>
&nbsp;&nbsp;&nbsp;&nbsp;debugs(11,3,&nbsp;&quot;HDR_X_ACCELERATOR_VARY&nbsp;Vary&nbsp;detected.&nbsp;Hack&nbsp;Cleaning&nbsp;it<br>
up&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
#endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
<br>
<br>
Deleting&nbsp;Vary&nbsp;from&nbsp;the&nbsp;header&nbsp;at&nbsp;this&nbsp;point&nbsp;gives&nbsp;me&nbsp;hits&nbsp;in&nbsp;every<br>
object&nbsp;I&nbsp;test&nbsp;(that&nbsp;previously&nbsp;didn't&nbsp;hit)&nbsp;..&nbsp;web&nbsp;browser&nbsp;never&nbsp;receives<br>
the&nbsp;Vary&nbsp;in&nbsp;the&nbsp;response&nbsp;header.<br>
Now&nbsp;I&nbsp;read&nbsp;your&nbsp;answer&nbsp;and&nbsp;you&nbsp;say&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;critical&nbsp;validity<br>
check&nbsp;and&nbsp;that&nbsp;worries&nbsp;me.&nbsp;Taking&nbsp;away&nbsp;the&nbsp;vary&nbsp;altogether&nbsp;at&nbsp;this&nbsp;point<br>
could&nbsp;lead&nbsp;to&nbsp;the&nbsp;problems&nbsp;that&nbsp;you&nbsp;described?&nbsp;If&nbsp;that&nbsp;is&nbsp;the&nbsp;case&nbsp;..&nbsp;I<br>
have&nbsp;to&nbsp;investigate&nbsp;other&nbsp;alternatives.<br>
<br>
I'll&nbsp;have&nbsp;to&nbsp;look&nbsp;into&nbsp;that&nbsp;function&nbsp;when&nbsp;I'm&nbsp;back&nbsp;at&nbsp;the&nbsp;code&nbsp;later&nbsp;to<br>
confirm&nbsp;this.&nbsp;But&nbsp;IIRC&nbsp;that&nbsp;function&nbsp;is&nbsp;acting&nbsp;directly&nbsp;on&nbsp;a&nbsp;freshly<br>
received&nbsp;reply&nbsp;message.&nbsp;You&nbsp;are&nbsp;not&nbsp;removing&nbsp;the&nbsp;validity&nbsp;check,&nbsp;you&nbsp;are<br>
removing&nbsp;Squids&nbsp;ability&nbsp;to&nbsp;see&nbsp;that&nbsp;it&nbsp;is&nbsp;a&nbsp;Vary&nbsp;object&nbsp;at&nbsp;all.&nbsp;So&nbsp;it&nbsp;is<br>
never&nbsp;even&nbsp;cached&nbsp;as&nbsp;one.<br>
<br>
The&nbsp;side&nbsp;effect&nbsp;of&nbsp;that&nbsp;is&nbsp;that&nbsp;clients&nbsp;asking&nbsp;for&nbsp;non-gzip&nbsp;can&nbsp;get&nbsp;the<br>
cached&nbsp;gzip&nbsp;copy,&nbsp;etc.&nbsp;but&nbsp;at&nbsp;least&nbsp;its&nbsp;the&nbsp;same&nbsp;URL.&nbsp;So&nbsp;the&nbsp;security<br>
risks&nbsp;are&nbsp;gone.&nbsp;But&nbsp;the&nbsp;user&nbsp;experience&nbsp;is&nbsp;not&nbsp;always&nbsp;good&nbsp;either&nbsp;way.<br>
<br>
Amos<br>
<br>
_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
<br>
<br>
<br>
<br>
_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
