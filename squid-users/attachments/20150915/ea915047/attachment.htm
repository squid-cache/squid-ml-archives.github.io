<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;In&nbsp;our&nbsp;network&nbsp;we&nbsp;are&nbsp;behind&nbsp;a&nbsp;proxy&nbsp;that&nbsp;I&nbsp;don&#39;t&nbsp;have&nbsp;access&nbsp;to.&nbsp;In&nbsp;order&nbsp;to&nbsp;speed&nbsp;up&nbsp;deployments&nbsp;and&nbsp;development&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;set&nbsp;up&nbsp;a&nbsp;caching&nbsp;squid&nbsp;proxy&nbsp;for&nbsp;yum&nbsp;and&nbsp;maven&nbsp;repositories.&lt;br&gt;Naturally,&nbsp;this&nbsp;proxy&nbsp;needs&nbsp;to&nbsp;be&nbsp;configured&nbsp;to&nbsp;use&nbsp;our&nbsp;company&#39;s&nbsp;global&nbsp;proxy&nbsp;as&nbsp;parent.&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;successfully&nbsp;set&nbsp;it&nbsp;up&nbsp;to&nbsp;the&nbsp;point&nbsp;where&nbsp;it&nbsp;works&nbsp;when&nbsp;e.g.&nbsp;downloading&nbsp;files&nbsp;using&nbsp;wget.&nbsp;However&nbsp;when&nbsp;using&nbsp;it&nbsp;with&nbsp;an&nbsp;actual&nbsp;maven&nbsp;build,&nbsp;the&nbsp;build&nbsp;hangs&nbsp;when&nbsp;trying&nbsp;to&nbsp;download&nbsp;pom&nbsp;or&nbsp;jar&nbsp;files.&lt;div&gt;&lt;br&gt;After&nbsp;having&nbsp;increased&nbsp;the&nbsp;log&nbsp;level&nbsp;I&nbsp;found&nbsp;out&nbsp;that&nbsp;my&nbsp;squid&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;parent&nbsp;proxy&nbsp;in&nbsp;such&nbsp;cases,&nbsp;and&nbsp;tries&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;internet&nbsp;which&nbsp;is&nbsp;not&nbsp;possible&nbsp;since&nbsp;we&nbsp;can&nbsp;only&nbsp;connect&nbsp;through&nbsp;the&nbsp;global&nbsp;proxy.&lt;/div&gt;&lt;div&gt;A&nbsp;closer&nbsp;look&nbsp;at&nbsp;the&nbsp;logs&nbsp;revealed&nbsp;that&nbsp;maven&nbsp;issued&nbsp;HEAD&nbsp;instead&nbsp;of&nbsp;GET&nbsp;requests&nbsp;in&nbsp;my&nbsp;case.&nbsp;I&nbsp;could&nbsp;hence&nbsp;reproduce&nbsp;the&nbsp;problem&nbsp;without&nbsp;maven&nbsp;using&nbsp;this&nbsp;command&nbsp;line:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;curl&nbsp;-I&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;/blockquote&gt;&lt;br&gt;In&nbsp;this&nbsp;example&nbsp;we&nbsp;would&nbsp;normally&nbsp;get&nbsp;a&nbsp;404&nbsp;(maven&nbsp;tries&nbsp;out&nbsp;a&nbsp;configured&nbsp;list&nbsp;of&nbsp;servers&nbsp;to&nbsp;find&nbsp;a&nbsp;particular&nbsp;resource),&nbsp;however&nbsp;the&nbsp;same&nbsp;problem&nbsp;applies&nbsp;with&nbsp;existing&nbsp;resources.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;me&nbsp;it&nbsp;seems&nbsp;like&nbsp;my&nbsp;squid&nbsp;does&nbsp;not&nbsp;understand&nbsp;it&nbsp;needs&nbsp;to&nbsp;use&nbsp;the&nbsp;global&nbsp;proxy&nbsp;for&nbsp;HEAD&nbsp;requests&nbsp;as&nbsp;well&nbsp;as&nbsp;for&nbsp;GET.&nbsp;But&nbsp;I&nbsp;could&nbsp;not&nbsp;find&nbsp;any&nbsp;reference&nbsp;to&nbsp;this&nbsp;particular&nbsp;problem&nbsp;anywhere&nbsp;in&nbsp;the&nbsp;web.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;appended&nbsp;all&nbsp;information&nbsp;that&nbsp;seems&nbsp;relevant&nbsp;below.&nbsp;Now&nbsp;I&nbsp;would&nbsp;really&nbsp;like&nbsp;to&nbsp;know:&nbsp;what&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong? &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Martin&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;u&gt;&lt;b&gt;Appendix:&nbsp;system&nbsp;information,&nbsp;log&nbsp;messages&nbsp;and&nbsp;configuration.&lt;/b&gt;&lt;/u&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;using&nbsp;squid&nbsp;3.1.23&nbsp;on&nbsp;an&nbsp;Oracle&nbsp;Linux&nbsp;6.7&nbsp;system&nbsp;(an&nbsp;RHEL6&nbsp;variant).&nbsp;I&nbsp;have&nbsp;reproduced&nbsp;the&nbsp;same&nbsp;problem&nbsp;on&nbsp;an&nbsp;Oracle&nbsp;Linux&nbsp;7.1&nbsp;system&nbsp;with&nbsp;squid&nbsp;3.5.3&nbsp;with&nbsp;basically&nbsp;the&nbsp;same&nbsp;configuration.&lt;/div&gt;&lt;div&gt;&lt;br&gt;Here&#39;s&nbsp;a&nbsp;snippet&nbsp;of&nbsp;what&nbsp;I&nbsp;find&nbsp;in&nbsp;the&nbsp;log&nbsp;after&nbsp;such&nbsp;an&nbsp;unsuccessful&nbsp;request:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;peerSelectFoo:&nbsp;&#39;HEAD&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org&quot;&gt;repo.springsource.org&lt;/a&gt;&#39;&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;peerSelectFoo:&nbsp;direct&nbsp;=&nbsp;DIRECT_MAYBE&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;peerSelectIcpPing:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;peerAddFwdServer:&nbsp;adding&nbsp;DIRECT&nbsp;DIRECT&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;peerSelectCallback:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;cbdataReferenceValid:&nbsp;0x7fa2dbf5f3c8&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;cbdataUnlock:&nbsp;0x7fa2dbf5f3c8=1&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;fwdStartComplete:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;fwdConnectStart:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:29:06.364|&nbsp;PconnPool::key(&lt;a&nbsp;href=&quot;http://repo.springsource.org&quot;&gt;repo.springsource.org&lt;/a&gt;,80,(no&nbsp;domain),[::]is&nbsp;{&lt;a&nbsp;href=&quot;http://repo.springsource.org:80&quot;&gt;repo.springsource.org:80&lt;/a&gt;}&lt;/blockquote&gt;&lt;br&gt;In&nbsp;contrast,&nbsp;when&nbsp;I&nbsp;issue&nbsp;the&nbsp;above&nbsp;command&nbsp;without&nbsp;&#39;-I&#39;,&nbsp;I&nbsp;get&nbsp;a&nbsp;different&nbsp;log&nbsp;output:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelectFoo:&nbsp;&#39;GET&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org&quot;&gt;repo.springsource.org&lt;/a&gt;&#39;&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelectFoo:&nbsp;direct&nbsp;=&nbsp;DIRECT_MAYBE&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerDigestLookup:&nbsp;peer&nbsp;proxy.local.lan&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerDigestLookup:&nbsp;gone!&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;neighborsDigestSelect:&nbsp;choices:&nbsp;0&nbsp;(0)&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerNoteDigestLookup:&nbsp;peer&nbsp;&lt;none&gt;,&nbsp;lookup:&nbsp;LOOKUP_NONE&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelectIcpPing:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;neighborsCount:&nbsp;0&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelectIcpPing:&nbsp;counted&nbsp;0&nbsp;neighbors&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerGetSomeParent:&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org&quot;&gt;repo.springsource.org&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;neighbors.cc(339)&nbsp;getRoundRobinParent:&nbsp;returning&nbsp;NULL&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;getWeightedRoundRobinParent:&nbsp;returning&nbsp;NULL&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;neighborUp:&nbsp;UP&nbsp;(no-query):&nbsp;proxy.local.lan (&lt;a&nbsp;href=&quot;http://172.16.8.250:3130&quot;&gt;172.16.8.250:3130&lt;/a&gt;)&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;neighborUp:&nbsp;UP&nbsp;(no-query):&nbsp;proxy.local.lan (&lt;a&nbsp;href=&quot;http://172.16.8.250:3130&quot;&gt;172.16.8.250:3130&lt;/a&gt;)&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;getFirstUpParent:&nbsp;returning&nbsp;proxy.local.lan&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelect:&nbsp;FIRST_UP_PARENT/proxy.local.lan&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerAddFwdServer:&nbsp;adding&nbsp;proxy.local.lan FIRST_UP_PARENT&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;cbdataLock:&nbsp;0x7fa2dbca0d58=1&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerAddFwdServer:&nbsp;adding&nbsp;DIRECT&nbsp;DIRECT&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;peerSelectCallback:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;cbdataReferenceValid:&nbsp;0x7fa2dbf5f3c8&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;cbdataUnlock:&nbsp;0x7fa2dbf5f3c8=1&lt;br&gt;2015/09/15&nbsp;12:32:54.348|&nbsp;fwdStartComplete:&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&quot;&gt;http://repo.springsource.org/snapshot/org/springframework/boot/spring-boot-starter-parent/1.2.2.RELEASE/spring-boot-starter-parent-1.2.2.RELEASE.pom&lt;/a&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;we&nbsp;see,&nbsp;in&nbsp;the&nbsp;second&nbsp;example&nbsp;the&nbsp;parent&nbsp;proxy&nbsp;is&nbsp;used,&nbsp;while&nbsp;in&nbsp;the&nbsp;first&nbsp;it&nbsp;is&nbsp;not&nbsp;(and&nbsp;hence&nbsp;trying&nbsp;to&nbsp;connect&nbsp;&lt;a&nbsp;href=&quot;http://repo.springsource.org&quot;&gt;repo.springsource.org&lt;/a&gt;&nbsp;fails).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;what&nbsp;I&nbsp;changed&nbsp;to&nbsp;the&nbsp;default&nbsp;configuration:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;#acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&gt;#acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&gt;[...] &lt;/font&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;cache_dir&nbsp;ufs&nbsp;/var/cache/squid&nbsp;1000&nbsp;16&nbsp;256 &lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;[...] &lt;/font&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;cache_mem&nbsp;64&nbsp;MB&lt;br&gt;cache_log&nbsp;/var/log/squid/cache.log&lt;br&gt;cache_store_log&nbsp;/var/log/squid/store.log&lt;br&gt;cache_effective_user&nbsp;squid&lt;br&gt;cache_effective_group&nbsp;squid&lt;br&gt;emulate_httpd_log&nbsp;on&lt;br&gt;debug_options&nbsp;ALL,10&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1440&nbsp; &nbsp; 20%&nbsp; &nbsp; &nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp; &nbsp; &nbsp; &nbsp; 1440&nbsp; &nbsp; 0%&nbsp; &nbsp; &nbsp; 1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp; &nbsp; &nbsp;0%&nbsp; &nbsp; &nbsp; 0&lt;br&gt;refresh_pattern&nbsp;.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;20%&nbsp; &nbsp; &nbsp;4320&lt;br&gt;cache_peer&nbsp;proxy.dermalog.hh&nbsp;parent&nbsp;3128&nbsp;3130&nbsp;no-query&nbsp;no-digest&nbsp;no-netdb-exchange&lt;br&gt;prefer_direct&nbsp;off&lt;/font&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;----------&nbsp;&lt;a&nbsp;href=&quot;mailto:MDietze@gmail.com&quot;&gt;MDietze@gmail.com&lt;/a&gt;&nbsp;--/--&nbsp;&lt;a&nbsp;href=&quot;mailto:martin@the-little-red-haired-girl.org&quot;&gt;martin@the-little-red-haired-girl.org&lt;/a&gt;&nbsp;----&lt;br&gt;-------------&nbsp;/&nbsp;&lt;a&nbsp;href=&quot;http://herbert.the-little-red-haired-girl.org&quot;&gt;http://herbert.the-little-red-haired-girl.org&lt;/a&gt;&nbsp;/&nbsp;-------------&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
