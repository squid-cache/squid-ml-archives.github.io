<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello!&lt;div&gt;It&#39;s&nbsp;looks&nbsp;like&nbsp;I&nbsp;have&nbsp;memory&nbsp;leak&nbsp;on&nbsp;squid&nbsp;with&nbsp;peek&nbsp;and&nbsp;splice&nbsp;https&nbsp;traffic.&lt;/div&gt;&lt;div&gt;I&nbsp;use&nbsp;squid&nbsp;3.5.9&nbsp;(try&nbsp;3.5.8&nbsp;and&nbsp;3.5.7&nbsp;also).&nbsp;Openssl&nbsp;and&nbsp;libresll&nbsp;both&nbsp;tried.&lt;/div&gt;&lt;div&gt;CentOs&nbsp;7.&nbsp;Traffic&nbsp;redirecting&nbsp;transparently&nbsp;by&nbsp;wccp.&lt;/div&gt;&lt;div&gt;Server:&nbsp;8&nbsp;cores,&nbsp;64GB&nbsp;RAM.&nbsp;Approx&nbsp;600&nbsp;clients&nbsp;with&nbsp;150&nbsp;requests&nbsp;per&nbsp;second.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Squid&nbsp;consume&nbsp;RAM&nbsp;without&nbsp;limits.&nbsp;Around&nbsp;10MB&nbsp;in&nbsp;a&nbsp;second.&nbsp;(Screenshot&nbsp;from&nbsp;zabbix:&nbsp;&lt;a&nbsp;href=&quot;http://snag.gy/HQmJI.jpg&quot;&gt;http://snag.gy/HQmJI.jpg&lt;/a&gt;)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Configruration:&lt;/div&gt;&lt;div&gt;&lt;div&gt;#Disable&nbsp;cache&lt;/div&gt;&lt;div&gt;cache&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;cache_mem&nbsp;0&nbsp;GB&lt;/div&gt;&lt;div&gt;memory_pools&nbsp;on&lt;/div&gt;&lt;div&gt;memory_pools_limit&nbsp;0&nbsp;MB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Multi&nbsp;core&lt;/div&gt;&lt;div&gt;workers&nbsp;6&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;https_port&nbsp;squid_ip:3129&nbsp;intercept&nbsp;ssl-bump&nbsp;\&lt;/div&gt;&lt;div&gt;key=/etc/squid/certs/squid.pem&nbsp;\&lt;/div&gt;&lt;div&gt;cert=/etc/squid/certs/squid.pem&nbsp;\&lt;/div&gt;&lt;div&gt;generate-host-certificates=off&nbsp;\&lt;/div&gt;&lt;div&gt;dynamic_cert_mem_cache_size=0MB&nbsp;\&lt;/div&gt;&lt;div&gt;sslflags=NO_DEFAULT_CA&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;http_port&nbsp;squid_ip:3128&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;block_url&nbsp;ssl::server_name&nbsp;&quot;/etc/squid/https_block.txt&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Step&nbsp;settings&lt;/div&gt;&lt;div&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;/div&gt;&lt;div&gt;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;/div&gt;&lt;div&gt;acl&nbsp;step3&nbsp;at_step&nbsp;SslBump3&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;peek&nbsp;step1&nbsp;all&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;peek&nbsp;step2&nbsp;all&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;terminate&nbsp;step3&nbsp;block_url&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;splice&nbsp;step3&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;all&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Somebody&nbsp;else&nbsp;had&nbsp;the&nbsp;same&nbsp;problem?&lt;/div&gt;&lt;/div&gt;<br>

</tt>
