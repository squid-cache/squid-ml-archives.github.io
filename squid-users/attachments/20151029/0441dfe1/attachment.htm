<tt>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Eliezer,&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;for&nbsp;your&nbsp;response.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;have&nbsp;set&nbsp;up&nbsp;a&nbsp;VM&nbsp;to&nbsp;test&nbsp;out&nbsp;configurations&nbsp;in&nbsp;the&nbsp;same&nbsp;data&nbsp;center&nbsp;and&nbsp;address&nbsp;space&nbsp;as&nbsp;the&nbsp;problematic&nbsp;one.&nbsp;&lt;br&gt;<br>
What&nbsp;I&nbsp;haven&#39;t&nbsp;done&nbsp;is&nbsp;test&nbsp;it&nbsp;by&nbsp;rebuilding&nbsp;the&nbsp;squid&nbsp;configuration&nbsp;from&nbsp;the&nbsp;defaults&nbsp;up&nbsp;and&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;same&nbsp;IP,&nbsp;that&nbsp;will&nbsp;probably&nbsp;be&nbsp;what&nbsp;I&#39;ll&nbsp;try&nbsp;tomorrow.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Also,&nbsp;thanks&nbsp;for&nbsp;the&nbsp;tip&nbsp;on&nbsp;the&nbsp;CARP&nbsp;example.&nbsp;I&nbsp;was&nbsp;trying&nbsp;to&nbsp;find&nbsp;a&nbsp;configuration&nbsp;that&nbsp;took&nbsp;advantage&nbsp;of&nbsp;SMP,&nbsp;but&nbsp;I&nbsp;see&nbsp;how&nbsp;that&nbsp;complicates&nbsp;things&nbsp;further.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;so&nbsp;much&nbsp;for&nbsp;the&nbsp;suggestions!&nbsp;I&#39;ll&nbsp;update&nbsp;this&nbsp;thread&nbsp;further&nbsp;if&nbsp;things&nbsp;start&nbsp;working&nbsp;a&nbsp;bit&nbsp;better.&nbsp;&lt;br&gt;<br>
And&nbsp;thank&nbsp;you&nbsp;again&nbsp;for&nbsp;packaging&nbsp;newer&nbsp;squid&nbsp;versions&nbsp;for&nbsp;CentOS!&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Pat&nbsp;Blair&lt;br&gt;<br>
Sr.&nbsp;Unix&nbsp;Administrator&lt;br&gt;<br>
Peapod,&nbsp;LLC&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:pblair@peapod.com&quot;&gt;pblair@peapod.com&lt;/a&gt;&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Oct&nbsp;29,&nbsp;2015&nbsp;21:09,&nbsp;&quot;Eliezer&nbsp;Croitoru&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:eliezer@ngtech.co.il&quot;&gt;eliezer@ngtech.co.il&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hey&nbsp;Patrick,&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;clearing&nbsp;the&nbsp;picture&nbsp;out.&lt;br&gt;<br>
Since&nbsp;it&#39;s&nbsp;HTTPS&nbsp;traffic&nbsp;it&nbsp;will&nbsp;might&nbsp;be&nbsp;a&nbsp;bit&nbsp;difficult&nbsp;to&nbsp;debug.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;wanted&nbsp;to&nbsp;notify&nbsp;you&nbsp;that&nbsp;squid&nbsp;3.5.10&nbsp;is&nbsp;suffering&nbsp;from&nbsp;some&nbsp;bugs&nbsp;but&nbsp;it&nbsp;is&nbsp;very&nbsp;hard&nbsp;for&nbsp;me&nbsp;to&nbsp;actually&nbsp;find&nbsp;this&nbsp;specific&nbsp;issue&nbsp;meet&nbsp;any&nbsp;of&nbsp;the&nbsp;know&nbsp;bugs&nbsp;else&nbsp;then&nbsp;one&nbsp;bug(something&nbsp;with&nbsp;ssl-bump).&lt;br&gt;<br>
&lt;br&gt;<br>
One&nbsp;thing&nbsp;I&nbsp;can&nbsp;think&nbsp;of&nbsp;in&nbsp;this&nbsp;scenario&nbsp;in&nbsp;order&nbsp;to&nbsp;maybe&nbsp;somehow&nbsp;change&nbsp;how&nbsp;things&nbsp;are&nbsp;would&nbsp;be&nbsp;to&nbsp;use&nbsp;a&nbsp;second&nbsp;proxy&nbsp;just&nbsp;for&nbsp;the&nbsp;test.&lt;br&gt;<br>
If&nbsp;you&nbsp;can&nbsp;run&nbsp;another&nbsp;proxy&nbsp;on&nbsp;a&nbsp;tiny&nbsp;VM&nbsp;with&nbsp;another&nbsp;IP&nbsp;on&nbsp;the&nbsp;same&nbsp;DC&nbsp;as&nbsp;the&nbsp;existing&nbsp;one&nbsp;it&nbsp;would&nbsp;narrow&nbsp;down&nbsp;couple&nbsp;things.&lt;br&gt;<br>
If&nbsp;it&nbsp;works&nbsp;OK&nbsp;with&nbsp;squid&nbsp;default&nbsp;conf&nbsp;file&nbsp;then&nbsp;try&nbsp;to&nbsp;assign&nbsp;the&nbsp;IP&nbsp;of&nbsp;the&nbsp;problematic&nbsp;proxy&nbsp;to&nbsp;the&nbsp;new&nbsp;one.&lt;br&gt;<br>
If&nbsp;it&nbsp;works&nbsp;with&nbsp;the&nbsp;same&nbsp;IP&nbsp;it&#39;s&nbsp;an&nbsp;issue&nbsp;with&nbsp;something&nbsp;in&nbsp;the&nbsp;proxy&nbsp;setup&nbsp;or&nbsp;the&nbsp;conf.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Another&nbsp;approach&nbsp;would&nbsp;be&nbsp;to&nbsp;use&nbsp;the&nbsp;secondary&nbsp;DC&nbsp;proxy&nbsp;as&nbsp;a&nbsp;cache_peer&nbsp;of&nbsp;the&nbsp;primary&nbsp;DC&nbsp;proxy&nbsp;to&nbsp;verify&nbsp;if&nbsp;it&nbsp;affects&nbsp;the&nbsp;traffic&nbsp;in&nbsp;a&nbsp;similar&nbsp;way.&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
In&nbsp;the&nbsp;first&nbsp;post&nbsp;you&nbsp;have&nbsp;mentioned&nbsp;this&nbsp;link:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://wiki.squid-cache.org/ConfigExamples/SmpCarpCluster&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;specific&nbsp;example&nbsp;was&nbsp;intended&nbsp;for&nbsp;caching&nbsp;optimization&nbsp;or&nbsp;something&nbsp;similar.&lt;br&gt;<br>
Since&nbsp;your&nbsp;case&nbsp;involves&nbsp;CONNECT&nbsp;requests&nbsp;which&nbsp;cannot&nbsp;be&nbsp;cached&nbsp;anyway&nbsp;and&nbsp;also&nbsp;this&nbsp;CARP&nbsp;has&nbsp;certain&nbsp;limitations&nbsp;I&nbsp;would&nbsp;first&nbsp;try&nbsp;to&nbsp;simplify&nbsp;the&nbsp;setup&nbsp;into&nbsp;a&nbsp;no-disk&nbsp;RAM&nbsp;only&nbsp;cache&nbsp;with&nbsp;couple&nbsp;workers&nbsp;rather&nbsp;then&nbsp;multi&nbsp;workers&nbsp;peering.&lt;br&gt;<br>
The&nbsp;CARP&nbsp;example&nbsp;actually&nbsp;limits&nbsp;the&nbsp;whole&nbsp;service&nbsp;to&nbsp;the&nbsp;frontend&nbsp;capabilities&nbsp;and&nbsp;there&nbsp;for&nbsp;it&#39;s&nbsp;recommended&nbsp;to&nbsp;not&nbsp;use&nbsp;it&nbsp;if&nbsp;possible.&lt;br&gt;<br>
Try&nbsp;a&nbsp;default&nbsp;squid.conf&nbsp;if&nbsp;possible.&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;the&nbsp;issue&nbsp;can&nbsp;be&nbsp;reproduced&nbsp;very&nbsp;easily&nbsp;testing&nbsp;the&nbsp;different&nbsp;options&nbsp;will&nbsp;take&nbsp;couple&nbsp;minutes&nbsp;and&nbsp;can&nbsp;be&nbsp;done&nbsp;after&nbsp;work&nbsp;hours.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;above&nbsp;options&nbsp;is&nbsp;what&nbsp;I&nbsp;would&nbsp;have&nbsp;tried&nbsp;with&nbsp;my&nbsp;own&nbsp;servers.&lt;br&gt;<br>
&lt;br&gt;<br>
Eliezer&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;30/10/2015&nbsp;01:17,&nbsp;Patrick&nbsp;Blair&nbsp;-&nbsp;Peapod&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
It&nbsp;is&nbsp;very&nbsp;unclear,&nbsp;our&nbsp;network&nbsp;team&nbsp;is&nbsp;trying&nbsp;to&nbsp;determine&nbsp;if&nbsp;a&lt;br&gt;<br>
network&nbsp;issue&nbsp;may&nbsp;be&nbsp;in&nbsp;play,&nbsp;but&nbsp;we&nbsp;believe&nbsp;that&nbsp;is&nbsp;unlikely...&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;couldn&#39;t&nbsp;understand&nbsp;how&nbsp;you&nbsp;ran&nbsp;the&nbsp;tests.&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&gt;I&nbsp;do&nbsp;understand&nbsp;that&nbsp;you&nbsp;have&nbsp;two&nbsp;proxies&nbsp;and&nbsp;one&nbsp;is&nbsp;peering&nbsp;to&nbsp;the&lt;br&gt;<br>
&gt;other,&nbsp;right?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
Apologies&nbsp;if&nbsp;that&nbsp;wasn&#39;t&nbsp;clear,&nbsp;I&#39;ll&nbsp;try&nbsp;to&nbsp;give&nbsp;a&nbsp;better&nbsp;explanation:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;-&nbsp;There&nbsp;is&nbsp;always&nbsp;one&nbsp;proxy&nbsp;in&nbsp;this&nbsp;situation.&lt;br&gt;<br>
 &nbsp; &nbsp;-&nbsp;The&nbsp;difference&nbsp;is&nbsp;that&nbsp;we&nbsp;run&nbsp;the&nbsp;proxy&nbsp;out&nbsp;of&nbsp;our&nbsp;secondary&lt;br&gt;<br>
 &nbsp; &nbsp;datacenter&nbsp;and&nbsp;route&nbsp;all&nbsp;user&nbsp;internet&nbsp;traffic&nbsp;through&nbsp;that&nbsp;location&nbsp;so&nbsp;it&lt;br&gt;<br>
 &nbsp; &nbsp;doesn&#39;t&nbsp;cause&nbsp;any&nbsp;issues&nbsp;with&nbsp;the&nbsp;traffic&nbsp;to&nbsp;our&nbsp;website&nbsp;flowing&nbsp;in&nbsp;and&nbsp;out&lt;br&gt;<br>
 &nbsp; &nbsp;of&nbsp;our&nbsp;primary&nbsp;datacenter.&lt;br&gt;<br>
 &nbsp; &nbsp;-&nbsp;A&nbsp;test&nbsp;instance&nbsp;I&nbsp;used&nbsp;to&nbsp;recreate&nbsp;the&nbsp;squid&nbsp;instance&nbsp;that&nbsp;is&nbsp;having&lt;br&gt;<br>
 &nbsp; &nbsp;the&nbsp;issues&nbsp;with,&nbsp;works&nbsp;as&nbsp;expected&nbsp;in&nbsp;our&nbsp;primary&nbsp;datacenter,&nbsp;however,&nbsp;the&lt;br&gt;<br>
 &nbsp; &nbsp;older&nbsp;version&nbsp;of&nbsp;squid&nbsp;we&nbsp;were&nbsp;using&nbsp;is&nbsp;located&nbsp;in&nbsp;the&nbsp;secondary&nbsp;datacenter&lt;br&gt;<br>
 &nbsp; &nbsp;and&nbsp;also&nbsp;works&nbsp;as&nbsp;expected,&nbsp;only&nbsp;the&nbsp;newer&nbsp;version&nbsp;doesn&#39;t&nbsp;work.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;your&nbsp;help!&lt;br&gt;<br>
&lt;br&gt;<br>
Pat&nbsp;Blair&lt;br&gt;<br>
Sr.&nbsp;Unix&nbsp;Administrator&lt;br&gt;<br>
Peapod,&nbsp;LLC&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:pblair@peapod.com&quot;&nbsp;target=&quot;_blank&quot;&gt;pblair@peapod.com&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
<br>
&lt;br&gt;<br>
&lt;div&gt;This&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;proprietary,&lt;/div&gt;&lt;div&gt;confidential&nbsp;and/or&nbsp;privileged&nbsp;and&nbsp;for&nbsp;the&nbsp;sole&nbsp;use&nbsp;of&nbsp;the&nbsp;intended&nbsp;recipients(s)&lt;/div&gt;&lt;div&gt;only.&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;please&nbsp;notify&nbsp;the&nbsp;sender&nbsp;by&nbsp;return&lt;/div&gt;&lt;div&gt;email&nbsp;and&nbsp;delete&nbsp;all&nbsp;copies&nbsp;of&nbsp;this&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments.&nbsp;Ahold&nbsp;and/or&nbsp;its&lt;/div&gt;&lt;div&gt;subsidiaries&nbsp;shall&nbsp;neither&nbsp;be&nbsp;liable&nbsp;for&nbsp;the&nbsp;inaccurate&nbsp;or&nbsp;incomplete&nbsp;transmission&lt;/div&gt;&lt;div&gt;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;email&nbsp;or&nbsp;any&nbsp;attachments,&nbsp;nor&nbsp;for&nbsp;any&nbsp;delay&lt;/div&gt;&lt;div&gt;in&nbsp;its&nbsp;receipt.&nbsp;To&nbsp;the&nbsp;extent&nbsp;this&nbsp;email&nbsp;is&nbsp;intended&nbsp;to&nbsp;create&nbsp;any&nbsp;legal&nbsp;obligation,&lt;/div&gt;&lt;div&gt;the&nbsp;obligation&nbsp;shall&nbsp;bind&nbsp;only&nbsp;the&nbsp;contracting&nbsp;entity&nbsp;and&nbsp;not&nbsp;any&nbsp;other&nbsp;entity&nbsp;within&lt;/div&gt;&lt;div&gt;the&nbsp;Ahold&nbsp;Group.&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;div&gt;This&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;proprietary,&lt;/div&gt;&lt;div&gt;confidential&nbsp;and/or&nbsp;privileged&nbsp;and&nbsp;for&nbsp;the&nbsp;sole&nbsp;use&nbsp;of&nbsp;the&nbsp;intended&nbsp;recipients(s)&lt;/div&gt;&lt;div&gt;only.&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;please&nbsp;notify&nbsp;the&nbsp;sender&nbsp;by&nbsp;return&lt;/div&gt;&lt;div&gt;email&nbsp;and&nbsp;delete&nbsp;all&nbsp;copies&nbsp;of&nbsp;this&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments.&nbsp;Ahold&nbsp;and/or&nbsp;its&lt;/div&gt;&lt;div&gt;subsidiaries&nbsp;shall&nbsp;neither&nbsp;be&nbsp;liable&nbsp;for&nbsp;the&nbsp;inaccurate&nbsp;or&nbsp;incomplete&nbsp;transmission&lt;/div&gt;&lt;div&gt;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;email&nbsp;or&nbsp;any&nbsp;attachments,&nbsp;nor&nbsp;for&nbsp;any&nbsp;delay&lt;/div&gt;&lt;div&gt;in&nbsp;its&nbsp;receipt.&nbsp;To&nbsp;the&nbsp;extent&nbsp;this&nbsp;email&nbsp;is&nbsp;intended&nbsp;to&nbsp;create&nbsp;any&nbsp;legal&nbsp;obligation,&lt;/div&gt;&lt;div&gt;the&nbsp;obligation&nbsp;shall&nbsp;bind&nbsp;only&nbsp;the&nbsp;contracting&nbsp;entity&nbsp;and&nbsp;not&nbsp;any&nbsp;other&nbsp;entity&nbsp;within&lt;/div&gt;&lt;div&gt;the&nbsp;Ahold&nbsp;Group.&lt;/div&gt;
</tt>
