<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Amos,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;knew&nbsp;something&nbsp;wasn&#39;t&nbsp;right. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ok&nbsp;then&nbsp;I&#39;m&nbsp;going&nbsp;to&nbsp;start&nbsp;there. &nbsp;I&nbsp;had&nbsp;a&nbsp;heck&nbsp;of&nbsp;a&nbsp;time&nbsp;getting&nbsp;squidguard&nbsp;to&nbsp;even&nbsp;work&nbsp;due&nbsp;to&nbsp;its&nbsp;reliance&nbsp;on&nbsp;old&nbsp;berkely&nbsp;db&nbsp;packages,&nbsp;I&#39;d&nbsp;be&nbsp;happy&nbsp;to&nbsp;see&nbsp;it&nbsp;go.&nbsp;  &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;that&nbsp;being&nbsp;said.&nbsp;I&#39;m&nbsp;going&nbsp;to&nbsp;lose&nbsp;squidguard. &nbsp;Upgrade&nbsp;squid&nbsp;to&nbsp;3.5.&nbsp; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;haven&#39;t&nbsp;even&nbsp;looked&nbsp;at&nbsp;the&nbsp;3.5&nbsp;stuff. &nbsp;How&nbsp;big&nbsp;of&nbsp;a&nbsp;config&nbsp;change&nbsp;am&nbsp;I&nbsp;looking&nbsp;at? &nbsp;That&nbsp;being&nbsp;said,&nbsp;upgrade&nbsp;or&nbsp;start&nbsp;fresh? &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;again.&nbsp;This&nbsp;is&nbsp;the&nbsp;first&nbsp;definitive&nbsp;answer&nbsp;I&#39;ve&nbsp;gotten!. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Nov&nbsp;17,&nbsp;2015&nbsp;at&nbsp;2:53&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;18/11/2015&nbsp;7:46&nbsp;a.m.,&nbsp;Bruce&nbsp;Markey&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;So&nbsp;I&nbsp;&quot;think&quot;&nbsp;I&nbsp;have&nbsp;squid&nbsp;working&nbsp;with&nbsp;https,&nbsp;but&nbsp;to&nbsp;be&nbsp;honest&nbsp;I&#39;m&nbsp;not&lt;br&gt;<br>
&gt;&nbsp;really&nbsp;sure. &nbsp;Hopefully&nbsp;someone&nbsp;can&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;We&#39;re&nbsp;using&nbsp;squid&nbsp;as&nbsp;a&nbsp;transparent&nbsp;NON&nbsp;caching&nbsp;proxy. &nbsp;It&#39;s&nbsp;basically&nbsp;only&lt;br&gt;<br>
&gt;&nbsp;there&nbsp;to&nbsp;give&nbsp;us&nbsp;insight&nbsp;into&nbsp;what&nbsp;everyone&nbsp;is&nbsp;using&nbsp;the&nbsp;web&nbsp;for. &nbsp;From&lt;br&gt;<br>
&gt;&nbsp;there&nbsp;we&#39;ll&nbsp;do&nbsp;some&nbsp;blacklisting&nbsp;via&nbsp;squidguard.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;running&nbsp;centos&nbsp;7,&nbsp;squid&nbsp;installed&nbsp;via&nbsp;yum. &nbsp;Squid&nbsp;version&nbsp;3.3.8.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;SSL-Bump&nbsp;is&nbsp;a&nbsp;feature&nbsp;participating&nbsp;in&nbsp;an&nbsp;&quot;arms&nbsp;race&quot;.&nbsp;The&nbsp;situation&nbsp;is&lt;br&gt;<br>
very&nbsp;volatile&nbsp;and&nbsp;things&nbsp;continue&nbsp;to&nbsp;change&nbsp;fast&nbsp;as&nbsp;the&nbsp;worlds&nbsp;use&nbsp;of&lt;br&gt;<br>
TLS&nbsp;improves,&nbsp;and&nbsp;the&nbsp;functionality&nbsp;in&nbsp;Squid&nbsp;changes&nbsp;to&nbsp;match&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;basically&nbsp;need&nbsp;to&nbsp;use&nbsp;the&nbsp;very&nbsp;latest&nbsp;Squid&nbsp;Squid&nbsp;release&nbsp;for&nbsp;it&nbsp;to&lt;br&gt;<br>
work&nbsp;properly.&nbsp;Today&nbsp;that&nbsp;means&nbsp;3.5.10&nbsp;or&nbsp;later.&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;find&nbsp;more&nbsp;recent&nbsp;packages&nbsp;for&nbsp;CentOS&nbsp;at&nbsp;the&nbsp;repositories&nbsp;listed&lt;br&gt;<br>
in&nbsp;&lt;&lt;a&nbsp;href=&quot;http://wiki.squid-cache.org/KnowledgeBase/CentOS&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://wiki.squid-cache.org/KnowledgeBase/CentOS&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Here&nbsp;are&nbsp;my&nbsp;questions.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;1.&nbsp;If&nbsp;ssl_bump&nbsp;is&nbsp;working&nbsp;correctly&nbsp;what&nbsp;should&nbsp;I&nbsp;be&nbsp;seeing&nbsp;in&nbsp;my&lt;br&gt;<br>
&gt;&nbsp;access.log? &nbsp;Something&nbsp;like&nbsp;this?&lt;br&gt;<br>
&gt;&nbsp;1447785601.904&nbsp;240239&nbsp;192.168.203.100&nbsp;TCP_MISS/200&nbsp;4876&nbsp;CONNECT&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://173.194.207.113:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;173.194.207.113:443&lt;/a&gt;&nbsp;-&nbsp;HIER_DIRECT/&lt;a&nbsp;href=&quot;http://173.194.207.113&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;173.194.207.113&lt;/a&gt;&nbsp;-&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;2.&nbsp;What&nbsp;should&nbsp;ssl_bump&nbsp;be&nbsp;set&nbsp;to? &nbsp;Right&nbsp;now&nbsp;it&#39;s&nbsp;set&nbsp;to&nbsp;ssl_bump&nbsp;none&lt;br&gt;<br>
&gt;&nbsp;all. &nbsp; I&nbsp;don&#39;t&nbsp;think&nbsp;I&#39;m&nbsp;seeing&nbsp;the&nbsp;traffic&nbsp;in&nbsp;the&nbsp;logs. &nbsp;I&nbsp;changed&nbsp;this&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;instantly&nbsp;started&nbsp;seeing&nbsp;https&nbsp;in&nbsp;the&nbsp;log&nbsp;BUT&nbsp;could&nbsp;not&nbsp;connect.&lt;br&gt;<br>
&gt;&nbsp;Browser&nbsp;errors. &nbsp;Yes&nbsp;I&nbsp;understand&nbsp;how&nbsp;MITM&nbsp;works&nbsp;but&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;what&lt;br&gt;<br>
&gt;&nbsp;exactly&nbsp;I&#39;m&nbsp;supposed&nbsp;to&nbsp;be&nbsp;seeing&nbsp;here. &nbsp; I&nbsp;assume&nbsp;if&nbsp;this&nbsp;was&nbsp;working&lt;br&gt;<br>
&gt;&nbsp;correctly&nbsp;i&#39;d&nbsp;have&nbsp;push&nbsp;out&nbsp;the&nbsp;self&nbsp;signed&nbsp;cert&nbsp;I&nbsp;used&nbsp;for&nbsp;squid&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;everyone.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Depends&nbsp;on&nbsp;what&nbsp;you&nbsp;are&nbsp;connecting&nbsp;to.&nbsp;But&nbsp;3.3&nbsp;series&nbsp;are&nbsp;not&nbsp;capable&nbsp;of&lt;br&gt;<br>
working&nbsp;around&nbsp;the&nbsp;&quot;certifiate&nbsp;pinning&quot;&nbsp;features&nbsp;that&nbsp;are&nbsp;becomming&lt;br&gt;<br>
popular&nbsp;in&nbsp;browsers.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;3. &nbsp;I&#39;m&nbsp;not&nbsp;able&nbsp;to&nbsp;block&nbsp;https&nbsp;sites&nbsp;with&nbsp;squidguard. &nbsp;I&nbsp;think&nbsp;this&nbsp;is&nbsp;due&lt;br&gt;<br>
&gt;&nbsp;to&nbsp;my&nbsp;https&nbsp;proxying&nbsp;not&nbsp;being&nbsp;correct. &nbsp;I&#39;m&nbsp;just&nbsp;not&nbsp;sure&nbsp;what&nbsp;exactly&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;look&nbsp;for&nbsp;to&nbsp;troubleshoot.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;SG&nbsp;is&nbsp;not&nbsp;capable&nbsp;of&nbsp;HTTPS.&nbsp;It&nbsp;&quot;blocks&quot;&nbsp;traffic&nbsp;by&nbsp;causing&nbsp;the&nbsp;client&nbsp;to&lt;br&gt;<br>
be&nbsp;sent&nbsp;to&nbsp;a&nbsp;HTTP&nbsp;URL.&nbsp;Browsers&nbsp;do&nbsp;not&nbsp;like&nbsp;doing&nbsp;this&nbsp;and&nbsp;some&nbsp;will&lt;br&gt;<br>
error.&nbsp;Older&nbsp;versions&nbsp;of&nbsp;Squid&nbsp;would&nbsp;not&nbsp;correctly&nbsp;perform&nbsp;the&nbsp;outgoing&lt;br&gt;<br>
connection&nbsp;when&nbsp;intercepted&nbsp;traffic&nbsp;was&nbsp;sent&nbsp;over&nbsp;plain-text&nbsp;even&nbsp;if&nbsp;the&lt;br&gt;<br>
URL&nbsp;was&nbsp;http://.&lt;br&gt;<br>
&lt;br&gt;<br>
Also,&nbsp;SG&nbsp;is&nbsp;a&nbsp;dead&nbsp;software&nbsp;and&nbsp;no&nbsp;longer&nbsp;maintained.&nbsp;Everything&nbsp;it&nbsp;does&lt;br&gt;<br>
is&nbsp;able&nbsp;to&nbsp;be&nbsp;written&nbsp;as&nbsp;squid.conf&nbsp;ACLs&nbsp;instead.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;day&nbsp;all&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;do&nbsp;is&nbsp;quantify&nbsp;where&lt;br&gt;<br>
&gt;&nbsp;people&nbsp;are&nbsp;going,&nbsp;both&nbsp;http&nbsp;and&nbsp;https&nbsp;and&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;blacklist&nbsp;certain&lt;br&gt;<br>
&gt;&nbsp;sites.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;That&nbsp;is&nbsp;best&nbsp;done&nbsp;with&nbsp;the&nbsp;peek-and-splice&nbsp;functionality&nbsp;of&nbsp;Squid-3.5.&lt;br&gt;<br>
Where&nbsp;you&nbsp;can&nbsp;peek&nbsp;to&nbsp;see&nbsp;from&nbsp;SNI&nbsp;where&nbsp;the&nbsp;client&nbsp;was&nbsp;going,&nbsp;then&lt;br&gt;<br>
terminate&nbsp;or&nbsp;splice&nbsp;based&nbsp;on&nbsp;that.&nbsp;No&nbsp;need&nbsp;for&nbsp;decryption&nbsp;to&nbsp;complicate&lt;br&gt;<br>
things&nbsp;most&nbsp;of&nbsp;the&nbsp;time,&nbsp;but&nbsp;you&nbsp;will&nbsp;still&nbsp;need&nbsp;to&nbsp;setup&nbsp;certs&nbsp;for&nbsp;the&lt;br&gt;<br>
(declining)&nbsp;edge&nbsp;cases&nbsp;where&nbsp;it&nbsp;is&nbsp;still&nbsp;necessary.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
