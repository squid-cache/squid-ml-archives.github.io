<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;So&nbsp;I&nbsp;&quot;think&quot;&nbsp;I&nbsp;have&nbsp;squid&nbsp;working&nbsp;with&nbsp;https,&nbsp;but&nbsp;to&nbsp;be&nbsp;honest&nbsp;I&#39;m&nbsp;not&nbsp;really&nbsp;sure. &nbsp;Hopefully&nbsp;someone&nbsp;can&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&#39;re&nbsp;using&nbsp;squid&nbsp;as&nbsp;a&nbsp;transparent&nbsp;NON&nbsp;caching&nbsp;proxy. &nbsp;It&#39;s&nbsp;basically&nbsp;only&nbsp;there&nbsp;to&nbsp;give&nbsp;us&nbsp;insight&nbsp;into&nbsp;what&nbsp;everyone&nbsp;is&nbsp;using&nbsp;the&nbsp;web&nbsp;for. &nbsp;From&nbsp;there&nbsp;we&#39;ll&nbsp;do&nbsp;some&nbsp;blacklisting&nbsp;via&nbsp;squidguard. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;running&nbsp;centos&nbsp;7,&nbsp;squid&nbsp;installed&nbsp;via&nbsp;yum. &nbsp;Squid&nbsp;version&nbsp;3.3.8.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;are&nbsp;my&nbsp;questions. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;If&nbsp;ssl_bump&nbsp;is&nbsp;working&nbsp;correctly&nbsp;what&nbsp;should&nbsp;I&nbsp;be&nbsp;seeing&nbsp;in&nbsp;my&nbsp;access.log? &nbsp;Something&nbsp;like&nbsp;this?&lt;/div&gt;&lt;div&gt;1447785601.904&nbsp;240239&nbsp;192.168.203.100&nbsp;TCP_MISS/200&nbsp;4876&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://173.194.207.113:443&quot;&gt;173.194.207.113:443&lt;/a&gt;&nbsp;-&nbsp;HIER_DIRECT/&lt;a&nbsp;href=&quot;http://173.194.207.113&quot;&gt;173.194.207.113&lt;/a&gt;&nbsp;-&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.&nbsp;What&nbsp;should&nbsp;ssl_bump&nbsp;be&nbsp;set&nbsp;to? &nbsp;Right&nbsp;now&nbsp;it&#39;s&nbsp;set&nbsp;to&nbsp;ssl_bump&nbsp;none&nbsp;all.&nbsp; &nbsp;I&nbsp;don&#39;t&nbsp;think&nbsp;I&#39;m&nbsp;seeing&nbsp;the&nbsp;traffic&nbsp;in&nbsp;the&nbsp;logs. &nbsp;I&nbsp;changed&nbsp;this&nbsp;and&nbsp;instantly&nbsp;started&nbsp;seeing&nbsp;https&nbsp;in&nbsp;the&nbsp;log&nbsp;BUT&nbsp;could&nbsp;not&nbsp;connect. &nbsp;Browser&nbsp;errors. &nbsp;Yes&nbsp;I&nbsp;understand&nbsp;how&nbsp;MITM&nbsp;works&nbsp;but&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;what&nbsp;exactly&nbsp;I&#39;m&nbsp;supposed&nbsp;to&nbsp;be&nbsp;seeing&nbsp;here.&nbsp; &nbsp;I&nbsp;assume&nbsp;if&nbsp;this&nbsp;was&nbsp;working&nbsp;correctly&nbsp;i&#39;d&nbsp;have&nbsp;push&nbsp;out&nbsp;the&nbsp;self&nbsp;signed&nbsp;cert&nbsp;I&nbsp;used&nbsp;for&nbsp;squid&nbsp;to&nbsp;everyone. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3. &nbsp;I&#39;m&nbsp;not&nbsp;able&nbsp;to&nbsp;block&nbsp;https&nbsp;sites&nbsp;with&nbsp;squidguard. &nbsp;I&nbsp;think&nbsp;this&nbsp;is&nbsp;due&nbsp;to&nbsp;my&nbsp;https&nbsp;proxying&nbsp;not&nbsp;being&nbsp;correct. &nbsp;I&#39;m&nbsp;just&nbsp;not&nbsp;sure&nbsp;what&nbsp;exactly&nbsp;to&nbsp;look&nbsp;for&nbsp;to&nbsp;troubleshoot. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;day&nbsp;all&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;do&nbsp;is&nbsp;quantify&nbsp;where&nbsp;people&nbsp;are&nbsp;going,&nbsp;both&nbsp;http&nbsp;and&nbsp;https&nbsp;and&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;blacklist&nbsp;certain&nbsp;sites. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Bruce&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;http_port&nbsp;3128&nbsp;intercept&lt;/div&gt;&lt;div&gt;https_port&nbsp;3129&nbsp;intercept&nbsp;ssl-bump&nbsp;cert=/opt/squid_certs/proxyCA.pem&lt;/div&gt;&lt;div&gt;http_port&nbsp;9999&lt;/div&gt;&lt;div&gt;wccp_version&nbsp;4&lt;/div&gt;&lt;div&gt;wccp2_router&nbsp;192.168.200.73&lt;/div&gt;&lt;div&gt;wccp2_forwarding_method&nbsp;gre&lt;/div&gt;&lt;div&gt;wccp2_return_method&nbsp;gre&lt;/div&gt;&lt;div&gt;wccp2_service&nbsp;standard&nbsp;0&lt;/div&gt;&lt;div&gt;wccp2_service&nbsp;dynamic&nbsp;70&lt;/div&gt;&lt;div&gt;wccp2_service_info&nbsp;70&nbsp;protocol=tcp&nbsp;flags=src_ip_hash,src_port_alt_hash&nbsp;priority=240&nbsp;ports=443&lt;/div&gt;&lt;div&gt;debug_options&nbsp;ALL,&nbsp;1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#ssl-bump&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;none&nbsp;all&lt;/div&gt;&lt;div&gt;sslcrtd_program&nbsp;/usr/lib64/squid/ssl_crtd&nbsp;-s&nbsp;/opt/squid_ssldb/ssl_db&nbsp;-M&nbsp;40&nbsp;MB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sslcrtd_children&nbsp;5&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;/div&gt;&lt;div&gt;acl&nbsp;localhost&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://127.0.0.1/32&quot;&gt;127.0.0.1/32&lt;/a&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;home_network&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.200.0/21&quot;&gt;192.168.200.0/21&lt;/a&gt;&lt;/div&gt;&lt;div&gt;#acl&nbsp;guest_network&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.0/24&quot;&gt;192.168.1.0/24&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Ports&nbsp;allowed&nbsp;through&nbsp;Squid&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;#http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;#https&lt;/div&gt;&lt;div&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;&lt;div&gt;acl&nbsp;SSL&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#allow/deny&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;home_network&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#rewrite&nbsp;program&nbsp;squidGuard&lt;/div&gt;&lt;div&gt;url_rewrite_program&nbsp;/usr/bin/squidGuard&nbsp;-c&nbsp;/etc/squid/squidGuard.conf&lt;/div&gt;&lt;div&gt;url_rewrite_children&nbsp;20&lt;/div&gt;&lt;div&gt;#url_rewrite_concurrency&nbsp;0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#caching&nbsp;directory&lt;/div&gt;&lt;div&gt;cache&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#nameservers&lt;/div&gt;&lt;div&gt;dns_nameservers&nbsp;192.168.201.1&nbsp; &lt;/div&gt;&lt;/div&gt;<br>

</tt>
