<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;2&nbsp;icap&nbsp;response&nbsp;modification&nbsp;services.&nbsp;I&nbsp;have&nbsp;integrated&nbsp;them&nbsp;to&nbsp;squid&nbsp;as&nbsp;in&nbsp;the&nbsp;below&nbsp;config.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;update&nbsp;the&nbsp;adaptation&nbsp;plan&nbsp;dynamically&nbsp;in&nbsp;the&nbsp;first&nbsp;service&nbsp;(&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;service_a_resp)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Basically,&nbsp;if&nbsp;a&nbsp;certain&nbsp;condition&nbsp;is&nbsp;met,&nbsp;then&nbsp;I&nbsp;don't&nbsp;want&nbsp;the&nbsp;second&nbsp;service&nbsp;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;service_b_resp)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&nbsp;to&nbsp;be&nbsp;called&nbsp;by&nbsp;Squid.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;icap_enable&nbsp;on&lt;/div&gt;&lt;div&gt;icap_send_client_ip&nbsp;on&lt;/div&gt;&lt;div&gt;icap_send_client_username&nbsp;on&lt;/div&gt;&lt;div&gt;icap_client_username_header&nbsp;X-Client-Username&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;icap_service&nbsp;service_a_resp&nbsp;respmod_precache&nbsp;bypass=on&nbsp;routing=on&nbsp;icap://127.0.0.1:1344/virus_scan&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;icap_service&nbsp;service_b_resp&nbsp;respmod_precache&nbsp;bypass=on&nbsp;routing=on&nbsp;icap://127.0.0.1:1344/content_filter&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;adaptation_service_chain&nbsp;response_chain&nbsp;service_a_resp&nbsp;service_b_resp&lt;/div&gt;&lt;div&gt;adaptation_access&nbsp;response_chain&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;After&nbsp;reading&nbsp;the&nbsp;documentation&nbsp;about&nbsp;the&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(30,&nbsp;30,&nbsp;30);&nbsp;font-family:&nbsp;courier;&nbsp;font-size:&nbsp;12px;&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&quot;&gt;icap_service&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;option&nbsp;and&nbsp;its&nbsp;routing&nbsp;parameter,&nbsp;I&nbsp;got&nbsp;the&nbsp;impression&nbsp;that&nbsp;I&nbsp;can&nbsp;achieve&nbsp;this&nbsp;by&nbsp;setting&nbsp;&lt;/span&gt;X-Next-Services&nbsp;header&nbsp;to&nbsp;empty&nbsp;string&nbsp;in&nbsp;my&nbsp;first&nbsp;service&nbsp;(&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;service_a_resp&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;)&nbsp;in&nbsp;the&nbsp;adaptation&nbsp;chain&nbsp;as&nbsp;below:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;ci_headers_add(req-&gt;response_header,&nbsp;&quot;X-Next-Services:&nbsp;&quot;);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;However,&nbsp;when&nbsp;I&nbsp;test&nbsp;this&nbsp;I&nbsp;see&nbsp;that&nbsp;the&nbsp;second&nbsp;service&nbsp;is&nbsp;still&nbsp;getting&nbsp;called&nbsp;by&nbsp;Squid.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;How&nbsp;can&nbsp;I&nbsp;dynamically&nbsp;prevent&nbsp;the&nbsp;second&nbsp;service&nbsp;in&nbsp;the&nbsp;adaptation&nbsp;chain&nbsp;from&nbsp;getting&nbsp;called?&nbsp;Any&nbsp;ideas&nbsp;what&nbsp;I&nbsp;am&nbsp;missing?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Thanks,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Giray&lt;/span&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
