<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hash:&nbsp;SHA256&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;looks&nbsp;like.&nbsp;Root&nbsp;CA&nbsp;doesn't&nbsp;send.&nbsp;Subordinate&nbsp;CA&nbsp;uses&nbsp;as&nbsp;signer<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mimicked.&nbsp;All&nbsp;and&nbsp;any&nbsp;clients&nbsp;got&nbsp;security&nbsp;alert.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;16.12.15&nbsp;1:38,&nbsp;Alex&nbsp;Rousskov&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&nbsp;On&nbsp;12/14/2015&nbsp;04:48&nbsp;PM,&nbsp;Marcus<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kool&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;On&nbsp;12/14/2015&nbsp;09:16&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;Squid&nbsp;may&nbsp;be&nbsp;horribly&nbsp;sending&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;all-but-one&nbsp;of&nbsp;the&nbsp;certs&nbsp;needed,&nbsp;on&nbsp;the&nbsp;assumption<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;the&nbsp;signing&nbsp;cert&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;is&nbsp;itself&nbsp;installed&nbsp;on&nbsp;the&nbsp;client.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;The&nbsp;RFC&nbsp;says&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;necessary&nbsp;to&nbsp;send&nbsp;the&nbsp;signing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CA&nbsp;certificate.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Sending&nbsp;the&nbsp;CA&nbsp;certificate&nbsp;is&nbsp;usually&nbsp;both&nbsp;unnecessary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(because&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;clients&nbsp;must&nbsp;have&nbsp;it)&nbsp;and&nbsp;borderline&nbsp;dangerous&nbsp;(because&nbsp;some<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clients&nbsp;do&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;not&nbsp;expect&nbsp;this&nbsp;extra&nbsp;information).&nbsp;This&nbsp;is&nbsp;why,&nbsp;I&nbsp;bet,&nbsp;Squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;does&nbsp;not&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;send&nbsp;the&nbsp;signing&nbsp;certificate&nbsp;in&nbsp;some&nbsp;cases.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;sending&nbsp;the&nbsp;signing&nbsp;certificate&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;necessary&nbsp;if&nbsp;that&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;signing&nbsp;certificate&nbsp;is&nbsp;not&nbsp;the&nbsp;CA&nbsp;certificate&nbsp;expected&nbsp;to&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stored&nbsp;by&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;clients.&nbsp;IIRC,&nbsp;we&nbsp;have&nbsp;fixed&nbsp;at&nbsp;least&nbsp;one&nbsp;Squid&nbsp;bug&nbsp;in&nbsp;this<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area&nbsp;in&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;2015,&nbsp;but&nbsp;I&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;reference&nbsp;handy.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;And&nbsp;there&nbsp;are&nbsp;actually&nbsp;situations&nbsp;in-between&nbsp;the&nbsp;two&nbsp;extremes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;above&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;because&nbsp;a&nbsp;CA&nbsp;(well-known&nbsp;and&nbsp;not)&nbsp;often&nbsp;has&nbsp;its&nbsp;own&nbsp;CA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;certificate&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;hierarchy,&nbsp;and&nbsp;some&nbsp;clients&nbsp;may&nbsp;trust&nbsp;intermediate&nbsp;CA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;certificates&nbsp;[with&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;or&nbsp;without&nbsp;storing&nbsp;the&nbsp;root&nbsp;CA&nbsp;certificate].&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;The&nbsp;above&nbsp;does&nbsp;not&nbsp;answer&nbsp;the&nbsp;OP&nbsp;question.&nbsp;The&nbsp;answer&nbsp;may&nbsp;go<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;like&nbsp;this:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;If&nbsp;you&nbsp;expect&nbsp;your&nbsp;clients&nbsp;to&nbsp;store&nbsp;your&nbsp;signing&nbsp;certificate,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;you&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;can&nbsp;configure&nbsp;Squid&nbsp;to&nbsp;sign&nbsp;with&nbsp;that&nbsp;certificate&nbsp;and&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;worry&nbsp;about&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;any&nbsp;higher-level&nbsp;(closer&nbsp;to&nbsp;root)&nbsp;certificate&nbsp;that&nbsp;may&nbsp;or&nbsp;may<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;exist.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;if&nbsp;your&nbsp;clients&nbsp;are&nbsp;storing&nbsp;a&nbsp;higher-level&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;certificate,&nbsp;then&nbsp;you&nbsp;need&nbsp;to&nbsp;test&nbsp;whether&nbsp;Squid&nbsp;does&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right&nbsp;thing&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;(i.e.,&nbsp;sends&nbsp;the&nbsp;intermediate&nbsp;certificate&nbsp;which&nbsp;also&nbsp;happens<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;be&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;signing&nbsp;certificate).&nbsp;If&nbsp;Squid&nbsp;does&nbsp;not&nbsp;do&nbsp;the&nbsp;right&nbsp;thing,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;a&nbsp;bug&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;report.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;HTH,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Alex.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;GnuPG&nbsp;v2<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;iQEcBAEBCAAGBQJWcoqdAAoJENNXIZxhPexGykoIAJsF/fkG0HvtMH6ACAYyc9WN<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;4+1z/UpVrNID4tSJapFPaCBFJ6pGcSQrAXzSzT+94nQZJMMStverO94x+YJ8a4bp<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hpVzewc0jVu4PCW0+V8YyvCvx0O4/sbEhWywc/dNz22KdAt6JhyWmaJTn22/JYMb<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xlvEYQ0wZ0r/u2+WMTbcMq1cyAESCYouZSxsmhQubM60d3ZUs25I3AUULEHguzXp<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;JO29tZcy1ZUzQZ9bCmVIwJTHfAjK3jTFRw66LpB2sooMb1O/Xfm+HGbndnpi1+ab<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;98/1Lhz4hTNJRFu4fxMbt1+VqXxp1q3OQA8OOOrbBu8vluFdB3WqwwqV/ACGsPo=<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;=zzWl<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
