<tt>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;Hi&lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;Thanks&nbsp;Marcus&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;I&nbsp;have&nbsp;been&nbsp;hacking&nbsp;my&nbsp;own&nbsp;branch&nbsp;of&nbsp;Squidguard&nbsp;so&nbsp;I&nbsp;can&nbsp;add&nbsp;support&nbsp;for&nbsp;the&nbsp;SNI&nbsp;(I&nbsp;hope)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;How&nbsp;would&nbsp;I&nbsp;get&nbsp;the&nbsp;peek&nbsp;SNI&nbsp;output&nbsp;to&nbsp;the&nbsp;url_rewriter?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;I&nbsp;am&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;peek&nbsp;new&nbsp;comer.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;Sounds&nbsp;like&nbsp;there&nbsp;is&nbsp;some&nbsp;hope&nbsp;and&nbsp;a&nbsp;possible&nbsp;way&nbsp;forward.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;regards&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;Darren&nbsp;B.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;mb_sig&quot;&gt;Sent&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird&quot;&nbsp;target=&quot;_blank&quot;&gt;Mailbird&lt;/a&gt;&lt;/div&gt;&lt;/font&gt;&lt;blockquote&nbsp;class=&quot;history_container&quot;&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;&nbsp;margin-top:20px;&nbsp;margin-left:0px;padding-left:10px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;color:&nbsp;#AAAAAA;&nbsp;margin-top:&nbsp;10px;&quot;&gt;On&nbsp;9/01/2016&nbsp;5:46:36&nbsp;PM,&nbsp;Marcus&nbsp;Kool&nbsp;&lt;marcus.kool@urlfilterdb.com&gt;&nbsp;wrote:&lt;/p&gt;&lt;br&gt;&lt;br&gt;On&nbsp;01/09/2016&nbsp;05:07&nbsp;AM,&nbsp;Darren&nbsp;wrote:&lt;br&gt;&gt;&nbsp;Hi&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;hack&nbsp;squidguard&nbsp;to&nbsp;allow&nbsp;me&nbsp;to&nbsp;redirect&nbsp;users&nbsp;attempts&nbsp;to&nbsp;connect&nbsp;to&nbsp;blocked&nbsp;https&nbsp;enabled&nbsp;sites.&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;Some&nbsp;sites&nbsp;are&nbsp;allowed&nbsp;and&nbsp;the&nbsp;bulk&nbsp;are&nbsp;not.&nbsp;Currently&nbsp;I&nbsp;can&nbsp;see&nbsp;the&nbsp;Connect&nbsp;details&nbsp;being&nbsp;handed&nbsp;to&nbsp;SG&nbsp;for&nbsp;processing&nbsp;and&nbsp;if&nbsp;I&nbsp;change&nbsp;this&nbsp;to&nbsp;return&nbsp;a&nbsp;redirect&nbsp;to&nbsp;make&nbsp;it&nbsp;point&nbsp;to&nbsp;a&nbsp;different&nbsp;server&lt;br&gt;&gt;&nbsp;it&nbsp;breaks&nbsp;and&nbsp;gives&nbsp;me&nbsp;an&nbsp;SSL&nbsp;error&nbsp;(as&nbsp;would&nbsp;be&nbsp;expected)&lt;br&gt;&lt;br&gt;indeed,&nbsp;&quot;as&nbsp;expected&quot;...&lt;br&gt;The&nbsp;HTTP&nbsp;protocol&nbsp;supportly&nbsp;support&nbsp;redirection&nbsp;of&nbsp;URL&nbsp;by&nbsp;sending&nbsp;a&nbsp;30x&nbsp;status&nbsp;code&nbsp;back&nbsp;to&nbsp;he&nbsp;browser.&lt;br&gt;HTTPS,&nbsp;which&nbsp;is&nbsp;SSL+HTTP&nbsp;is&nbsp;&quot;safe&quot;&nbsp;encrypted&nbsp;channel&nbsp;where&nbsp;HTTP&nbsp;is&nbsp;inside&nbsp;the&nbsp;channel&nbsp;and&lt;br&gt;explicitly&nbsp;is&nbsp;designed&nbsp;not&nbsp;to&nbsp;be&nbsp;tampered&nbsp;with.&nbsp;&nbsp;So&nbsp;redirecting&nbsp;a&nbsp;channel&nbsp;to&nbsp;an&nbsp;other&nbsp;website&lt;br&gt;always&nbsp;will&nbsp;cause&nbsp;a&nbsp;certificate&nbsp;error,&nbsp;unless&nbsp;...&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;one&nbsp;uses&nbsp;ssl-bump&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;installs&nbsp;the&nbsp;Squid&nbsp;fake&nbsp;CA&nbsp;certificate&nbsp;in&nbsp;all&nbsp;browsers&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;one&nbsp;has&nbsp;a&nbsp;policy&nbsp;for&nbsp;the&nbsp;other&nbsp;protocols&nbsp;(e.g.&nbsp;Skype)&nbsp;that&nbsp;use&nbsp;CONNECT&lt;br&gt;&lt;br&gt;&gt;&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;I&nbsp;can&nbsp;get&nbsp;this&nbsp;redirection&nbsp;call&nbsp;to&nbsp;squidguard&nbsp;happened&nbsp;earlier&nbsp;in&nbsp;squid&nbsp;before&nbsp;it&nbsp;gets&nbsp;this&nbsp;far&nbsp;down&nbsp;the&nbsp;CONNECT&nbsp;process?&nbsp;Or&nbsp;is&nbsp;there&nbsp;something&nbsp;that&nbsp;I&nbsp;can&nbsp;return&nbsp;from&nbsp;Squidguard&nbsp;that&lt;br&gt;&gt;&nbsp;would&nbsp;make&nbsp;this&nbsp;work?&nbsp;I&nbsp;notice&nbsp;that&nbsp;the&nbsp;connect&nbsp;attempts&nbsp;are&nbsp;always&nbsp;just&nbsp;the&nbsp;IP&nbsp;address,&nbsp;so&nbsp;something&nbsp;earlier&nbsp;in&nbsp;the&nbsp;processing&nbsp;is&nbsp;doing&nbsp;a&nbsp;reverse&nbsp;DNS&nbsp;lookup,&nbsp;is&nbsp;this&nbsp;the&nbsp;Browser&nbsp;of&nbsp;Squid&nbsp;and&nbsp;if&nbsp;so&lt;br&gt;&gt;&nbsp;can&nbsp;I&nbsp;get&nbsp;in&nbsp;earlier&nbsp;during&nbsp;the&nbsp;process?&lt;br&gt;&lt;br&gt;The&nbsp;above&nbsp;implies&nbsp;that&nbsp;you&nbsp;use&nbsp;Squid&nbsp;in&nbsp;interception&nbsp;mode&nbsp;where&nbsp;it&nbsp;initially&nbsp;can&nbsp;only&nbsp;see&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;server.&lt;br&gt;In&nbsp;ssl-bump&nbsp;mode,&nbsp;Squid&nbsp;can&nbsp;peek&nbsp;in&nbsp;step1&nbsp;and&nbsp;find&nbsp;the&nbsp;SNI&nbsp;of&nbsp;the&nbsp;server&nbsp;(a.k.a&nbsp;the&nbsp;FQDN)&nbsp;and&nbsp;then&nbsp;the&nbsp;SNI/FQDN&nbsp;can&nbsp;be&nbsp;used&nbsp;in&nbsp;ACLs&nbsp;inside&nbsp;Squid&nbsp;and&nbsp;any&nbsp;URL&nbsp;redirector&nbsp;that&nbsp;can&nbsp;cope&nbsp;with&nbsp;the&nbsp;SNI&nbsp;&lt;br&gt;parameter.&nbsp;&nbsp;Squidguard&nbsp;cannot,&nbsp;the&nbsp;latest&nbsp;ufdbGuard&nbsp;1.31&nbsp;cannot,&nbsp;but&nbsp;ufdbGuard&nbsp;1.32&nbsp;_can_&nbsp;and&nbsp;will&nbsp;be&nbsp;released&nbsp;in&nbsp;February.&lt;br&gt;&lt;br&gt;Marcus&lt;br&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;I&nbsp;want&nbsp;to&nbsp;maintain&nbsp;the&nbsp;various&nbsp;lists&nbsp;in&nbsp;just&nbsp;squidguard&nbsp;and&nbsp;not&nbsp;put&nbsp;in&nbsp;ACLs&nbsp;in&nbsp;squid.conf&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;thanks&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;Darren&nbsp;B.&lt;br&gt;_______________________________________________&lt;br&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;squid-users@lists.squid-cache.org&lt;br&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;
</tt>
