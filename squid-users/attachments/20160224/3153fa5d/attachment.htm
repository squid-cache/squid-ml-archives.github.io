<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hash:&nbsp;SHA256&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;24.02.16&nbsp;1:11,&nbsp;Heiler&nbsp;Bemerguy&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Thanks&nbsp;Alex.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;We&nbsp;have&nbsp;a&nbsp;simple&nbsp;cache_dir&nbsp;config&nbsp;like&nbsp;this,&nbsp;with&nbsp;no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;workers&quot;&nbsp;defined:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;cache_dir&nbsp;rock&nbsp;/cache2&nbsp;80000&nbsp;min-size=0&nbsp;max-size=32767&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;cache_dir&nbsp;aufs&nbsp;/cache&nbsp;320000&nbsp;96&nbsp;256&nbsp;min-size=32768&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;And&nbsp;we&nbsp;are&nbsp;suffering&nbsp;from&nbsp;a&nbsp;100%&nbsp;CPU&nbsp;use&nbsp;by&nbsp;a&nbsp;single&nbsp;squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thread.&nbsp;We&nbsp;have&nbsp;lots&nbsp;of&nbsp;ram,&nbsp;cores&nbsp;and&nbsp;disk&nbsp;space..&nbsp;but&nbsp;also&nbsp;too<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;many&nbsp;users:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Number&nbsp;of&nbsp;clients&nbsp;accessing&nbsp;cache:     &nbsp;1634&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Number&nbsp;of&nbsp;HTTP&nbsp;requests&nbsp;received:      &nbsp;3276691&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Average&nbsp;HTTP&nbsp;requests&nbsp;per&nbsp;minute&nbsp;since&nbsp;start:  &nbsp;12807.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Select&nbsp;loop&nbsp;called:&nbsp;60353401&nbsp;times,&nbsp;22.017&nbsp;ms&nbsp;avg&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Getting&nbsp;rid&nbsp;of&nbsp;this&nbsp;big&nbsp;aufs&nbsp;and&nbsp;spreading&nbsp;to&nbsp;many&nbsp;rock<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stores&nbsp;will&nbsp;improve&nbsp;things&nbsp;here?&nbsp;I've&nbsp;already&nbsp;shrunk&nbsp;the&nbsp;acls&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patterns/regexes&nbsp;etc&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;obvious&nbsp;improvements.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;have&nbsp;only&nbsp;one-two&nbsp;HDD&nbsp;controllers,&nbsp;you&nbsp;have&nbsp;bottleneck&nbsp;in&nbsp;IO.<br>
&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;much&nbsp;cores&nbsp;waits&nbsp;HDD&nbsp;access&nbsp;alltogether.........&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;First&nbsp;of&nbsp;all&nbsp;you&nbsp;need:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;-&nbsp;Either&nbsp;many&nbsp;HDD&nbsp;controllers/IO&nbsp;channels;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;-&nbsp;Or&nbsp;Disk&nbsp;array(s)&nbsp;with&nbsp;high-speed&nbsp;controllers&nbsp;and&nbsp;with&nbsp;huge&nbsp;own<br>
&nbsp;&nbsp;&nbsp;&nbsp;cache;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;-&nbsp;Fast&nbsp;HDD&nbsp;array&nbsp;must&nbsp;have&nbsp;fast&nbsp;IO&nbsp;subsystem.&nbsp;For&nbsp;example,&nbsp;FC&nbsp;SAN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;something.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Best&nbsp;Regards,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;GnuPG&nbsp;v2<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;iQEcBAEBCAAGBQJWzLT2AAoJENNXIZxhPexGXuYIALrQi1MHQNYhCTSc27DSiyod<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;tw08m9f3k6cneuWMepcPo41ZqL9Z/pQALK937Nyktfv20gZuJpExRlHJYm+72DZC<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;9uMSrcLQjHANmP8WXC4y5uR/EUH43lSQ1m7OzuG8Aghsm9KfLOkaNEjmeAcZtfVp<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;BqQySo5Jx/rizq4lb9l96NUAeVGZ1pv4xWj2ZrMz3RmcKwyOpY4w+aAVB3xE8Y/p<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;PkWRgwxf6ud8TUcHzq/ZNc5yzBEVOyXDlqshCSXgwOTCzW48DEQOK9KJxvhGQZTl<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;kdLvTkbZywgxczjvG5SGXb7jpiSasrX6oa741FpS47H7O6rQ0o4U4UPRmB/9+OI=<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;=FWMr<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
