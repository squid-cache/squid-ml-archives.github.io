<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Not&nbsp;to&nbsp;mention&nbsp;only&nbsp;10GB&nbsp;of&nbsp;cache&nbsp;is&nbsp;almost&nbsp;useless&nbsp;for&nbsp;us...&nbsp;lol&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;But&nbsp;I&nbsp;still&nbsp;think&nbsp;cpu&nbsp;is&nbsp;cpu&nbsp;and&nbsp;i/o&nbsp;is&nbsp;i/o.&nbsp;&quot;WAIT&quot;&nbsp;fields&nbsp;on&nbsp;both<br>
&nbsp;&nbsp;&nbsp;&nbsp;TOP&nbsp;and&nbsp;VMSTAT&nbsp;shows&nbsp;almost&nbsp;always&nbsp;a&nbsp;ZERO&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Why&nbsp;would&nbsp;it&nbsp;show&nbsp;a&nbsp;process&nbsp;using&nbsp;cpu&nbsp;while&nbsp;actually&nbsp;it's&nbsp;waiting<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;a&nbsp;I/O..&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Best&nbsp;Regards&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
Heiler&nbsp;Bemerguy&nbsp;-&nbsp;(91)&nbsp;98151-4894<br>
Assessor&nbsp;Técnico&nbsp;-&nbsp;CINBESA&nbsp;(91)&nbsp;3184-1751&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Em&nbsp;24/02/2016&nbsp;17:13,&nbsp;Yuri&nbsp;Voinov<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escreveu:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:56CE0EDB.1000501@gmail.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----<br>
Hash:&nbsp;SHA256<br>
&nbsp;<br>
AFAIK,&nbsp;if&nbsp;you&nbsp;solve&nbsp;issue&nbsp;with&nbsp;cache_mem&nbsp;10&nbsp;GB&nbsp;and&nbsp;completely&nbsp;disabled<br>
disk&nbsp;cache,&nbsp;then&nbsp;you&nbsp;had&nbsp;disk&nbsp;IO&nbsp;bottleneck&nbsp;exactly.&nbsp;You&nbsp;completely<br>
disable&nbsp;disk&nbsp;caches.&nbsp;So,&nbsp;all&nbsp;obvious&nbsp;now.<br>
<br>
But&nbsp;-&nbsp;what&nbsp;you&nbsp;will&nbsp;do&nbsp;after&nbsp;squid&nbsp;restart?&nbsp;:)))))))))))))&nbsp;A&nbsp;deadly&nbsp;cold<br>
memory&nbsp;cache,&nbsp;hehehe<br>
<br>
25.02.16&nbsp;1:44,&nbsp;Heiler&nbsp;Bemerguy&nbsp;пишет:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Hi&nbsp;Eliezer,&nbsp;thanks&nbsp;for&nbsp;your&nbsp;reply.<br>
<br>
As&nbsp;you've&nbsp;suggested,&nbsp;I&nbsp;removed&nbsp;all&nbsp;cache_dirs&nbsp;to&nbsp;verify&nbsp;if&nbsp;the&nbsp;rest<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;was&nbsp;stable/fast&nbsp;and&nbsp;raised&nbsp;cache_mem&nbsp;to&nbsp;10GB.&nbsp;I&nbsp;didn't&nbsp;disable&nbsp;access<br>
logs&nbsp;because&nbsp;we&nbsp;really&nbsp;need&nbsp;it..<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
And&nbsp;it&nbsp;is&nbsp;super&nbsp;fast,&nbsp;I&nbsp;can't&nbsp;even&nbsp;notice&nbsp;it&nbsp;using&nbsp;only&nbsp;ONE&nbsp;core..<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;(and&nbsp;it&nbsp;isn't&nbsp;running&nbsp;as&nbsp;smp)<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
%Cpu0&nbsp;&nbsp;:&nbsp;&nbsp;0,7&nbsp;us,&nbsp;&nbsp;1,0&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;98,3&nbsp;id,&nbsp;&nbsp;0,0&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;0,0<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;%Cpu1&nbsp;&nbsp;:&nbsp;&nbsp;8,8&nbsp;us,&nbsp;&nbsp;5,6&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;76,1&nbsp;id,&nbsp;&nbsp;0,0&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;9,5<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;%Cpu2&nbsp;&nbsp;:&nbsp;&nbsp;8,7&nbsp;us,&nbsp;&nbsp;4,0&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;83,3&nbsp;id,&nbsp;&nbsp;0,0&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;4,0<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;%Cpu3&nbsp;&nbsp;:&nbsp;&nbsp;5,4&nbsp;us,&nbsp;&nbsp;3,4&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;86,2&nbsp;id,&nbsp;&nbsp;0,0&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;5,0<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;%Cpu4&nbsp;&nbsp;:&nbsp;&nbsp;7,8&nbsp;us,&nbsp;&nbsp;5,1&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;73,5&nbsp;id,&nbsp;&nbsp;6,8&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;6,8<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;%Cpu5&nbsp;&nbsp;:&nbsp;&nbsp;1,0&nbsp;us,&nbsp;&nbsp;1,0&nbsp;sy,&nbsp;&nbsp;0,0&nbsp;ni,&nbsp;98,0&nbsp;id,&nbsp;&nbsp;0,0&nbsp;wa,&nbsp;&nbsp;0,0&nbsp;hi,&nbsp;&nbsp;0,0<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;si,&nbsp;&nbsp;0,0&nbsp;st<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
&nbsp;&nbsp;PID&nbsp;USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR&nbsp;&nbsp;NI&nbsp;&nbsp;VIRT&nbsp;&nbsp;RES&nbsp;&nbsp;SHR&nbsp;S&nbsp;&nbsp;%CPU&nbsp;%MEM&nbsp;&nbsp;&nbsp;&nbsp;TIME+&nbsp;COMMAND<br>
11604&nbsp;proxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;0&nbsp;11,6g&nbsp;&nbsp;11g&nbsp;5232&nbsp;S&nbsp;&nbsp;48,4&nbsp;72,2&nbsp;&nbsp;72:31.24&nbsp;squid<br>
<br>
Start&nbsp;Time:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wed,&nbsp;24&nbsp;Feb&nbsp;2016&nbsp;15:38:59&nbsp;GMT<br>
Current&nbsp;Time:&nbsp;&nbsp;&nbsp;Wed,&nbsp;24&nbsp;Feb&nbsp;2016&nbsp;19:18:30&nbsp;GMT<br>
Connection&nbsp;information&nbsp;for&nbsp;squid:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;clients&nbsp;accessing&nbsp;cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1433<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;HTTP&nbsp;requests&nbsp;received:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2532800<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Average&nbsp;HTTP&nbsp;requests&nbsp;per&nbsp;minute&nbsp;since&nbsp;start:&nbsp;&nbsp;&nbsp;11538.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;loop&nbsp;called:&nbsp;68763019&nbsp;times,&nbsp;0.192&nbsp;ms&nbsp;avg<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Storage&nbsp;Mem&nbsp;size:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9874500&nbsp;KB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Storage&nbsp;Mem&nbsp;capacity:&nbsp;&nbsp;&nbsp;94.2%&nbsp;used,&nbsp;&nbsp;5.8%&nbsp;free<br>
<br>
I&nbsp;don't&nbsp;think&nbsp;I&nbsp;had&nbsp;a&nbsp;bottleneck&nbsp;on&nbsp;I/O&nbsp;itself,&nbsp;maybe&nbsp;the&nbsp;hash/search<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;of&nbsp;cache&nbsp;indexes&nbsp;was&nbsp;too&nbsp;much&nbsp;for&nbsp;a&nbsp;single&nbsp;thread?<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Best&nbsp;Regards,<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
Version:&nbsp;GnuPG&nbsp;v2<br>
&nbsp;<br>
iQEcBAEBCAAGBQJWzg7aAAoJENNXIZxhPexG/1MIAJnQdPpdH3OvlkNrHhdEf+bm<br>
CrjM6BCvsADHW9udmeH4jS/U3ko4iLI/oayQELIP3WoH+hQ5pszyp8u0zfDfUkn6<br>
s4vFOOvgSUmPxn70FQhFX93z6IhySFkKHiSvUMuN/2prH86pFz3J6+byxUMySKoU<br>
lXkImzeFVBHJLMaaVOlAZ1SwJUVb2LhUgoY7GesK7gT2mW09phFGG9I/3Sz+0Jmx<br>
fYkZBZLPMoIPNknJqlebsv/s8CaQ3Vb4bpstLZgVNxlBX0UmW7Ohu7cNOrTFXovb<br>
ooojx4nsDl8esDfrfJ/NSBVuxi7vO7jAP82gqkoJB3qQkHtAi6O66Qvr5gSBt7s=<br>
=/h/N<br>
-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
