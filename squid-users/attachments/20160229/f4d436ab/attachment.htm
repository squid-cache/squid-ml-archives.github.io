<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hash:&nbsp;SHA256&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;29.02.16&nbsp;23:22,&nbsp;Marcus&nbsp;Kool&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;*&nbsp;Choices.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;Overall,&nbsp;there&nbsp;are&nbsp;three&nbsp;options&nbsp;for&nbsp;handling&nbsp;an<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;impossible&nbsp;situation:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;1.&nbsp;Quit&nbsp;Squid&nbsp;process.&nbsp;This&nbsp;is&nbsp;what&nbsp;Squid&nbsp;does&nbsp;today&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;most&nbsp;cases.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;When&nbsp;the&nbsp;impossible&nbsp;happens,&nbsp;you&nbsp;get&nbsp;a&nbsp;crash.&nbsp;Very<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;predictable.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;No&nbsp;malformed/corrupted/misleading&nbsp;HTTP&nbsp;messages&nbsp;(some<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;truncated).&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;No&nbsp;memory&nbsp;leaks.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;2.&nbsp;Quit&nbsp;the&nbsp;current&nbsp;processing&nbsp;sequence&nbsp;but&nbsp;keep&nbsp;Squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;process&nbsp;running,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;assuming&nbsp;that&nbsp;[most]&nbsp;other&nbsp;processing&nbsp;sequences&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;affected.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;[If&nbsp;you&nbsp;are&nbsp;familiar&nbsp;with&nbsp;programming,&nbsp;this&nbsp;is&nbsp;done<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;throwing&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;exceptions&nbsp;instead&nbsp;of&nbsp;asserting&nbsp;and&nbsp;catching&nbsp;those<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions&nbsp;at&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;&quot;processing&nbsp;sequence&quot;&nbsp;boundaries].&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;3.&nbsp;Keep&nbsp;executing&nbsp;the&nbsp;current&nbsp;processing&nbsp;sequence,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assuming&nbsp;that&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;assertion&nbsp;was&nbsp;wrong&nbsp;or&nbsp;unimportant.&nbsp;This&nbsp;is&nbsp;what&nbsp;you<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;might&nbsp;be&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;suggesting&nbsp;above.&nbsp;When&nbsp;the&nbsp;impossible&nbsp;happens,&nbsp;you<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;get&nbsp;a&nbsp;crash,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;memory&nbsp;leaks,&nbsp;malformed/corrupted/misleading&nbsp;HTTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages,&nbsp;or&nbsp;normal&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;    &nbsp;behavior,&nbsp;depending&nbsp;on&nbsp;the&nbsp;assertion&nbsp;and&nbsp;traffic.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;IMO,&nbsp;we&nbsp;should&nbsp;make&nbsp;#2&nbsp;the&nbsp;default,&nbsp;but&nbsp;make&nbsp;the&nbsp;choice<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;three&nbsp;options&nbsp;configurable&nbsp;by&nbsp;the&nbsp;admin&nbsp;(without<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recompiling&nbsp;Squid).&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Let&nbsp;me&nbsp;suggest&nbsp;#4&nbsp;:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;immediately&nbsp;execute&nbsp;an&nbsp;external&nbsp;program&nbsp;that&nbsp;calls&nbsp;gdb&nbsp;or&nbsp;any<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;debugger&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;which&nbsp;produces&nbsp;a&nbsp;stack&nbsp;trace&nbsp;of&nbsp;all&nbsp;squid&nbsp;processes&nbsp;and&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;#1&nbsp;or&nbsp;#2.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;The&nbsp;stack&nbsp;dumps&nbsp;will&nbsp;be&nbsp;save&nbsp;in&nbsp;an&nbsp;assertion&nbsp;failure&nbsp;log&nbsp;file<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;admins&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;can&nbsp;send&nbsp;to&nbsp;Squid&nbsp;developers.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;This&nbsp;will&nbsp;speedup&nbsp;the&nbsp;debugging&nbsp;and&nbsp;fixing&nbsp;procedure.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Finally,&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;mechanism&nbsp;that&nbsp;warns&nbsp;admins&nbsp;that&nbsp;an<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertion&nbsp;failure&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;happened. &nbsp;This&nbsp;is&nbsp;not&nbsp;trivial&nbsp;since&nbsp;an&nbsp;admin&nbsp;does&nbsp;not&nbsp;look<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;every&nbsp;day&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;in&nbsp;the&nbsp;squid&nbsp;log&nbsp;file.&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hmmmmmmm......&nbsp;some&nbsp;shell&nbsp;scripting+cron+sendmail&nbsp;can't&nbsp;save&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;giants&nbsp;of&nbsp;thought?&nbsp;;)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Marcus&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;GnuPG&nbsp;v2<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;iQEcBAEBCAAGBQJW1H/HAAoJENNXIZxhPexGBFoIAJ18PCwyDrYsR0UPuVGSP5xA<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;4rNBiZfjA0WFU2Ug7FFDBkL2XkuLjktt7ftPPLuTIVhCQujk0e99ZaWX2FBGTMts<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hNtIGIS0rysU0oWvXGl5f9w7WJqKYpiRmEThRGGIinsoqouOmKgv9q7AoFnKsSUi<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;dKD2ISdtX+Gm13m3dZz+MANltChnN37ZXONbO3Vf/YG1l/9g4S6S1xfyiMJiLLTU<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;NOvXFYGCbTTRIH13D9QATVeGpP9fSSLDAUtTd+z5yEDsGpfcXdi+6+1tCvheiLtA<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;0hqCmWqU0sKKLHumD70bGkMTLMx+F6CPSaXGxOONPAjZaLwCXk4PyHxUp/m+ofo=<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;=OlJi<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
