<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;Amos!&nbsp;It&nbsp;works.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;New&nbsp;problem: &lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;checking&nbsp;whether&nbsp;a&nbsp;url&nbsp;(object)&nbsp;is&nbsp;cached&nbsp;or&nbsp;not&nbsp;by&nbsp;using:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;squidclient&nbsp;-p&nbsp;3129&nbsp;$url&nbsp;|&nbsp;fgrep&nbsp;X-Cache&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;getting&nbsp;a&nbsp;lot&nbsp;of&nbsp;messy&nbsp;code&nbsp;and&nbsp;when&nbsp;I&nbsp;quit&nbsp;(CRTL-C),&nbsp;squid&nbsp;logs&nbsp;are&nbsp;showing&nbsp;TCP_HIT_ABORTED.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How&nbsp;can&nbsp;I&nbsp;not&nbsp;get&nbsp;the&nbsp;messy&nbsp;code&nbsp;and&nbsp;just&nbsp;get&nbsp;the&nbsp;result&nbsp;of&nbsp;fgrep.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Mar&nbsp;2,&nbsp;2016&nbsp;at&nbsp;1:22&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;2/03/2016&nbsp;6:05&nbsp;p.m.,&nbsp;John&nbsp;Pearson&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;squid&nbsp;installed&nbsp;on&nbsp;a&nbsp;machine&nbsp;with&nbsp;two&nbsp;NICs.&lt;br&gt;<br>
&gt;&nbsp;eth0&nbsp;-&nbsp;wan&lt;br&gt;<br>
&gt;&nbsp;eth1&nbsp;-&nbsp;lan&nbsp;-&nbsp;10.0.1.1&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Squid&nbsp;server&nbsp;is&nbsp;running&nbsp;on&nbsp;eth1.&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;squidclient&nbsp;to&nbsp;fetch&nbsp;a&nbsp;url&nbsp;so&nbsp;that&nbsp;squid&nbsp;will&nbsp;cache&lt;br&gt;<br>
&gt;&nbsp;it.&nbsp;Like&nbsp;prefetching.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Example:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;squidclient&nbsp;-v&nbsp;-h&nbsp;10.0.1.1&nbsp;-p&nbsp;3128&nbsp;-m&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.apple.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.apple.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Problem&nbsp;#1;&lt;br&gt;<br>
 you&nbsp;are&nbsp;missing&nbsp;a&nbsp;&#39;/&#39;&nbsp;on&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;URL.&nbsp;That&nbsp;type&nbsp;of&nbsp;URL&nbsp;is&nbsp;not&lt;br&gt;<br>
valid&nbsp;in&nbsp;HTTP/1.0.&nbsp;It&nbsp;has&nbsp;only&nbsp;recently&nbsp;become&nbsp;acceptible&nbsp;in&nbsp;HTTP/1.1,&lt;br&gt;<br>
so&nbsp;not&nbsp;all&nbsp;services&nbsp;support&nbsp;it.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Result&lt;br&gt;<br>
&gt;&nbsp;-----------&lt;br&gt;<br>
&gt;&nbsp;Request:&lt;br&gt;<br>
&gt;&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.apple.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.apple.com&lt;/a&gt;&nbsp;HTTP/1.0&lt;br&gt;<br>
&gt;&nbsp;Host:&nbsp;&lt;a&nbsp;href=&quot;http://www.apple.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.apple.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;squidclient/3.5.9&lt;br&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;br&gt;<br>
&gt;&nbsp;Connection:&nbsp;close&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;--------------------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;cursor&nbsp;just&nbsp;blinks&nbsp;below&nbsp;the&nbsp;dot&nbsp;(after&nbsp;&quot;Connection:close&quot;.&nbsp;Hard&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;see)&nbsp;and&nbsp;nothing&nbsp;happens.&nbsp;I&nbsp;have&nbsp;to&nbsp;manually&nbsp;exit.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;When&nbsp;I&nbsp;exit,&nbsp;squid&nbsp;log&nbsp;shows&nbsp;A&nbsp;LOT&nbsp;of&nbsp;these&nbsp;lines:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;10.0.1.1&nbsp;TCP_MISS_ABORTED/000&nbsp;0&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.apple.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.apple.com&lt;/a&gt;&nbsp;-&nbsp;ORIGINAL_DST/&lt;br&gt;<br>
&gt;&nbsp;10.0.1.1&nbsp;-&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Problem&nbsp;#2;&lt;br&gt;<br>
 &nbsp;you&nbsp;are&nbsp;sending&nbsp;the&nbsp;request&nbsp;to&nbsp;an&nbsp;intercept&nbsp;port&nbsp;without&nbsp;having&nbsp;gone&lt;br&gt;<br>
through&nbsp;the&nbsp;NAT&nbsp;system.&lt;br&gt;<br>
 If&nbsp;you&nbsp;left&nbsp;it&nbsp;to&nbsp;run,&nbsp;your&nbsp;machine&nbsp;would&nbsp;eventually&nbsp;crash&nbsp;as&nbsp;all&lt;br&gt;<br>
networking&nbsp;sockets&nbsp;and&nbsp;resources&nbsp;were&nbsp;consumed&nbsp;by&nbsp;the&nbsp;forwarding&nbsp;loop.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
squidclient&nbsp;needs&nbsp;to&nbsp;use&nbsp;a&nbsp;forward-proxy&nbsp;port&nbsp;to&nbsp;connect&nbsp;to&nbsp;Squid.&lt;br&gt;<br>
Usually&nbsp;that&nbsp;is&nbsp;3128,&nbsp;which&nbsp;is&nbsp;the&nbsp;port&nbsp;registered&nbsp;for&nbsp;Squid&lt;br&gt;<br>
forward-proxy&nbsp;ctraffic.&lt;br&gt;<br>
&lt;br&gt;<br>
Recommended&nbsp;practice&nbsp;is&nbsp;to&nbsp;leave&nbsp;port&nbsp;3128&nbsp;for&nbsp;proxy&nbsp;administrative&lt;br&gt;<br>
access&nbsp;and&nbsp;tools&nbsp;like&nbsp;squidclient.&nbsp;Movine&nbsp;the&nbsp;intercept&nbsp;port&nbsp;to&nbsp;another&lt;br&gt;<br>
random&nbsp;number&nbsp;and&nbsp;firewall&nbsp;it&nbsp;(in&nbsp;iptables&nbsp;with&nbsp;mangle&nbsp;tables&nbsp;rule)&nbsp;to&lt;br&gt;<br>
prevent&nbsp;anything&nbsp;except&nbsp;NAT&#39;d&nbsp;traffic&nbsp;reaching&nbsp;that&nbsp;random&nbsp;port.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
