<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;for&nbsp;your&nbsp;input&nbsp;Eliezer.Â &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;tested&nbsp;against&nbsp;various&nbsp;public&nbsp;DNS&nbsp;servers&nbsp;at&nbsp;this&nbsp;point&nbsp;so&nbsp;I&#39;m&nbsp;ruling&nbsp;out&nbsp;any&nbsp;DNS-server-side&nbsp;problems.&nbsp;The&nbsp;only&nbsp;time&nbsp;there&#39;s&nbsp;any&nbsp;timeouts&nbsp;or&nbsp;slowness&nbsp;is&nbsp;when&nbsp;the&nbsp;request&nbsp;is&nbsp;going&nbsp;through&nbsp;squid.&nbsp;Doesn&#39;t&nbsp;seem&nbsp;to&nbsp;matter&nbsp;which&nbsp;HTTP&nbsp;server&nbsp;I&#39;m&nbsp;requesting,&nbsp;whether&nbsp;it&nbsp;returns&nbsp;multiple&nbsp;IPs&nbsp;or&nbsp;not.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Also&nbsp;worth&nbsp;noting&nbsp;that&nbsp;this&nbsp;company&nbsp;has&nbsp;about&nbsp;30&nbsp;other&nbsp;sites&nbsp;with&nbsp;mostly&nbsp;identical&nbsp;network&nbsp;topologies&nbsp;and&nbsp;equipment&nbsp;where&nbsp;it&#39;s&nbsp;completely&nbsp;fine.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;3&nbsp;March&nbsp;2016&nbsp;at&nbsp;18:44,&nbsp;Eliezer&nbsp;Croitoru&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:eliezer@ngtech.co.il&quot;&nbsp;target=&quot;_blank&quot;&gt;eliezer@ngtech.co.il&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Well&nbsp;what&nbsp;I&nbsp;can&nbsp;see&nbsp;is&nbsp;that&nbsp;there&nbsp;are&nbsp;couple&nbsp;queries&nbsp;ID&nbsp;and&nbsp;the&nbsp;issues&nbsp;are:&lt;br&gt;<br>
0x8528:&nbsp;timeout&lt;br&gt;<br>
0x69c2&nbsp;-&nbsp;timeout&lt;br&gt;<br>
&lt;br&gt;<br>
but&nbsp;I&nbsp;am&nbsp;pretty&nbsp;sure&nbsp;that&nbsp;the&nbsp;DNS&nbsp;server&nbsp;that&nbsp;the&nbsp;query&nbsp;is&nbsp;against&nbsp;is:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://192.231.203.132:53&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;192.231.203.132:53&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;the&nbsp;first&nbsp;thing&nbsp;is&nbsp;to&nbsp;findout&nbsp;what&nbsp;dns&nbsp;servers&nbsp;are&nbsp;defined&nbsp;inside&nbsp;squid.conf&lt;br&gt;<br>
if&nbsp;you&nbsp;don&#39;t&nbsp;have&nbsp;any&nbsp;then&nbsp;look&nbsp;at&nbsp;/etc/resolv.conf&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;should&nbsp;have&nbsp;there&nbsp;a&nbsp;list&nbsp;of&nbsp;server&nbsp;that&nbsp;you&nbsp;should&nbsp;run&nbsp;the&nbsp;dig&nbsp;-x&nbsp;command&nbsp;against&nbsp;and&nbsp;see&nbsp;how&nbsp;every&nbsp;one&nbsp;of&nbsp;them&nbsp;responses.&lt;br&gt;<br>
&gt;From&nbsp;squid&nbsp;point&nbsp;of&nbsp;view&nbsp;the&nbsp;issues&nbsp;are&nbsp;probably:&lt;br&gt;<br>
-&nbsp;network&nbsp;routing&nbsp;or&nbsp;firewall&nbsp;level&nbsp;issues(another&nbsp;middle&nbsp;machine&nbsp;or&nbsp;local&nbsp;settings)&lt;br&gt;<br>
-&nbsp;buggy&nbsp;or&nbsp;faulty&nbsp;or&nbsp;wrongly-configured&nbsp;dns&nbsp;server&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;main&nbsp;reason&nbsp;that&nbsp;squid&nbsp;does&nbsp;the&nbsp;PTR&nbsp;lookup&nbsp;and&nbsp;other&nbsp;queries&nbsp;is&nbsp;since&nbsp;these&nbsp;are&nbsp;required.&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;want&nbsp;to&nbsp;start&nbsp;from&nbsp;the&nbsp;bottom&nbsp;and&nbsp;up&nbsp;you&nbsp;can&nbsp;try&nbsp;another&nbsp;thing:&lt;br&gt;<br>
use&nbsp;the&nbsp;dns_nameserver&nbsp;squid.conf&nbsp;option&nbsp;[&nbsp;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/Doc/config/dns_nameservers/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.squid-cache.org/Doc/config/dns_nameservers/&lt;/a&gt;&nbsp;]&nbsp;with&nbsp;the&nbsp;local&nbsp;dns&nbsp;that&nbsp;worked&nbsp;fast&nbsp;for&nbsp;dig&nbsp;and&nbsp;nslookup(192.231.203.3)&nbsp;and&nbsp;only&nbsp;this&nbsp;use.&lt;br&gt;<br>
It&nbsp;should&nbsp;be:&lt;br&gt;<br>
dns_nameservers&nbsp;192.231.203.3&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;run&nbsp;couple&nbsp;trials&nbsp;against&nbsp;public&nbsp;dns&nbsp;services&nbsp;like&nbsp;opendns\google&nbsp;or&nbsp;any&nbsp;other&nbsp;that&nbsp;is&nbsp;mentioned&nbsp;at:&nbsp;&lt;a&nbsp;href=&quot;http://pcsupport.about.com/od/tipstricks/a/free-public-dns-servers.htm&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pcsupport.about.com/od/tipstricks/a/free-public-dns-servers.htm&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Also&nbsp;try&nbsp;to&nbsp;contact&nbsp;a&nbsp;http&nbsp;service&nbsp;with&nbsp;an&nbsp;ip&nbsp;such&nbsp;as&nbsp;&lt;a&nbsp;href=&quot;http://ngtech.co.il&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;ngtech.co.il&lt;/a&gt;|&lt;a&nbsp;href=&quot;tel:84.95.212.160&quot;&nbsp;value=&quot;+18495212160&quot;&nbsp;target=&quot;_blank&quot;&gt;84.95.212.160&lt;/a&gt;&nbsp;(which&nbsp;will&nbsp;be&nbsp;a&nbsp;good&nbsp;test&nbsp;against&nbsp;a&nbsp;server&nbsp;that&nbsp;has&nbsp;only&nbsp;ipv4&nbsp;address).&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;after&nbsp;all&nbsp;the&nbsp;above&nbsp;something&nbsp;is&nbsp;weird&nbsp;I&nbsp;would&nbsp;suggest&nbsp;you&nbsp;for&nbsp;a&nbsp;second&nbsp;to&nbsp;run&nbsp;the&nbsp;squid&nbsp;with&nbsp;default&nbsp;squid.conf(if&nbsp;you&nbsp;are&nbsp;using&nbsp;debian&nbsp;then&nbsp;you&nbsp;will&nbsp;need&nbsp;to&nbsp;remove&nbsp;couple&nbsp;&quot;#&quot;&nbsp;for&nbsp;the&nbsp;localnet&nbsp;acls).&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;should&nbsp;know&nbsp;that&nbsp;there&nbsp;are&nbsp;cases&nbsp;which&nbsp;couple&nbsp;dns&nbsp;services&nbsp;just&nbsp;stops&nbsp;responding&nbsp;to&nbsp;dns&nbsp;queries&nbsp;which&nbsp;looks&nbsp;like&nbsp;what&nbsp;you&nbsp;see&nbsp;if&nbsp;it&nbsp;worked&nbsp;before.&lt;br&gt;<br>
&lt;br&gt;<br>
Eliezer&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;03/03/2016&nbsp;09:08,&nbsp;Dan&nbsp;Charlesworth&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
On&nbsp;03/03/2016&nbsp;07:39,&nbsp;Dan&nbsp;Charlesworth&nbsp;wrote:&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/blockquote&gt;<br>
&gt;&gt;&gt;&gt;Right&nbsp;now&nbsp;we&nbsp;have&nbsp;1&nbsp;squid&nbsp;box&nbsp;(out&nbsp;of&nbsp;a&nbsp;lot),&nbsp;running&nbsp;3.5.13,&nbsp;which&nbsp;does&nbsp;something&nbsp;like&nbsp;this&nbsp;for&nbsp;every&nbsp;request,&nbsp;taking&nbsp;about&nbsp;10&nbsp;seconds:&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.883&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1794)&nbsp;idnsPTRLookup:&nbsp;idnsPTRLookup:&nbsp;buf&nbsp;is&nbsp;43&nbsp;bytes&nbsp;for&nbsp;10.100.128.1,&nbsp;id&nbsp;=&nbsp;0x733a&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.883&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1745)&nbsp;idnsALookup:&nbsp;idnsALookup:&nbsp;buf&nbsp;is&nbsp;29&nbsp;bytes&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://httpbin.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;httpbin.org&lt;/a&gt;,&nbsp;id&nbsp;=&nbsp;0x8528&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.883&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1683)&nbsp;idnsSendSlaveAAAAQuery:&nbsp;buf&nbsp;is&nbsp;29&nbsp;bytes&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://httpbin.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;httpbin.org&lt;/a&gt;,&nbsp;id&nbsp;=&nbsp;0x69c2&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1277)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;starting&nbsp;with&nbsp;FD&nbsp;7&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1323)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;FD&nbsp;7:&nbsp;received&nbsp;93&nbsp;bytes&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://192.231.203.132:53&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;192.231.203.132:53&lt;/a&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1130)&nbsp;idnsGrokReply:&nbsp;idnsGrokReply:&nbsp;QID&nbsp;0x733a,&nbsp;-3&nbsp;answers&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:48.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1195)&nbsp;idnsGrokReply:&nbsp;idnsGrokReply:&nbsp;error&nbsp;Name&nbsp;Error:&nbsp;The&nbsp;domain&nbsp;name&nbsp;does&nbsp;not&nbsp;exist.&nbsp;(3)&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:53.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1384)&nbsp;idnsCheckQueue:&nbsp;idnsCheckQueue:&nbsp;ID&nbsp;dns8&nbsp;QID&nbsp;0x8528:&nbsp;timeout&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:53.884&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1384)&nbsp;idnsCheckQueue:&nbsp;idnsCheckQueue:&nbsp;ID&nbsp;dns0&nbsp;QID&nbsp;0x69c2:&nbsp;timeout&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:53.885&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1277)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;starting&nbsp;with&nbsp;FD&nbsp;7&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:53.885&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1323)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;FD&nbsp;7:&nbsp;received&nbsp;110&nbsp;bytes&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://172.16.100.4:53&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.16.100.4:53&lt;/a&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:53.885&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1130)&nbsp;idnsGrokReply:&nbsp;idnsGrokReply:&nbsp;QID&nbsp;0x69c2,&nbsp;0&nbsp;answers&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:58.885&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1384)&nbsp;idnsCheckQueue:&nbsp;idnsCheckQueue:&nbsp;ID&nbsp;dns8&nbsp;QID&nbsp;0x8528:&nbsp;timeout&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:58.886&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1277)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;starting&nbsp;with&nbsp;FD&nbsp;7&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:58.886&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1323)&nbsp;idnsRead:&nbsp;idnsRead:&nbsp;FD&nbsp;7:&nbsp;received&nbsp;246&nbsp;bytes&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://172.16.100.5:53&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.16.100.5:53&lt;/a&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;2016/03/03&nbsp;16:30:58.886&nbsp;kid1|&nbsp;78,3|&nbsp;dns_internal.cc(1130)&nbsp;idnsGrokReply:&nbsp;idnsGrokReply:&nbsp;QID&nbsp;0x8528,&nbsp;1&nbsp;answers&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
