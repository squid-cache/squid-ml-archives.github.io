<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi&nbsp;Amos,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;seems&nbsp;the&nbsp;&quot;quick_abort_min&nbsp;-1&nbsp;KB&quot;&nbsp;did&nbsp;the&nbsp;trick.&nbsp;But&nbsp;I&nbsp;remember<br>
&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;&quot;range_offset_limit&quot;&nbsp;should&nbsp;overrule&nbsp;that..&nbsp;isn't&nbsp;it?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Also,&nbsp;I&nbsp;saw&nbsp;people&nbsp;using&nbsp;-1&nbsp;instead&nbsp;of&nbsp;&quot;none&quot;&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;range_offset_limit..&nbsp;is&nbsp;it&nbsp;the&nbsp;same?&nbsp;:P&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;quick_abort_min&nbsp;-1&nbsp;KB&lt;/i&gt;&lt;i&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/i&gt;&lt;i&gt;acl&nbsp;wupdatecachable&nbsp;url_regex&nbsp;-i<br>
(microsoft|windowsupdate)\.com.*\.(cab|exe|ms[i|u|f]|dat|zip|psf|appx|appxbundle|esd)&lt;/i&gt;&lt;i&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/i&gt;&lt;i&gt;range_offset_limit&nbsp;none&nbsp;wupdatecachable&lt;/i&gt;&lt;i&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/i&gt;&lt;i&gt;refresh_pattern&nbsp;-i<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(microsoft|windowsupdate)\.com.*\.(cab|exe|ms[i|u|f]|dat|zip|psf|appx|appxbundle|esd)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;483840&nbsp;80%&nbsp;483840&nbsp;override-expire&nbsp;ignore-private&nbsp;ignore-no-store&lt;/i&gt;&lt;i&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/i&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Best&nbsp;Regards,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
Heiler&nbsp;Bemerguy&nbsp;-&nbsp;(91)&nbsp;98151-4894<br>
Assessor&nbsp;TÃ©cnico&nbsp;-&nbsp;CINBESA&nbsp;(91)&nbsp;3184-1751&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Em&nbsp;04/03/2016&nbsp;01:01,&nbsp;Amos&nbsp;Jeffries<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escreveu:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:56D9089E.4050509@treenet.co.nz&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;4/03/2016&nbsp;4:49&nbsp;a.m.,&nbsp;Heiler&nbsp;Bemerguy&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Hi&nbsp;Amos,<br>
<br>
You&nbsp;didn't&nbsp;notice&nbsp;it&nbsp;was&nbsp;always&nbsp;the&nbsp;same&nbsp;client&nbsp;?&nbsp;The&nbsp;same&nbsp;IP&nbsp;address<br>
redownloading&nbsp;ad&nbsp;eternum..<br>
<br>
I&nbsp;managed&nbsp;to&nbsp;fix&nbsp;it&nbsp;by&nbsp;not&nbsp;caching&nbsp;stuff&nbsp;with&nbsp;&quot;?&quot;&nbsp;in&nbsp;it:<br>
<br>
*refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;0%&nbsp;0*<br>
<br>
But&nbsp;I&nbsp;don't&nbsp;know&nbsp;if&nbsp;it's&nbsp;the&nbsp;best&nbsp;approach..<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Provided&nbsp;you&nbsp;only&nbsp;added&nbsp;that&nbsp;refresh_pattern&nbsp;and&nbsp;not&nbsp;&quot;cache&nbsp;deny&quot;&nbsp;rules,<br>
yes&nbsp;it&nbsp;is&nbsp;the&nbsp;best&nbsp;solution.<br>
The&nbsp;refresh_pattern&nbsp;only&nbsp;applies&nbsp;to&nbsp;responses&nbsp;where&nbsp;there&nbsp;are&nbsp;missing<br>
cacheability&nbsp;headers.&nbsp;So&nbsp;dynamic&nbsp;content&nbsp;which&nbsp;provides&nbsp;headers&nbsp;will<br>
still&nbsp;be&nbsp;cached&nbsp;and&nbsp;served&nbsp;nicely.<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
The&nbsp;URL&nbsp;was&nbsp;like&nbsp;that:<br>
/10.101.1.50&nbsp;TCP_HIT/206&nbsp;402&nbsp;GET<br>
//&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle//&quot;&gt;http://bg.v4.a.dl.ws.microsoft.com/dl/content/d/updt/2015/07/096c4bbc-4bc2-4ba1-8fd7-2e8cf3fb1937_132a7d6799d3bd625b0e5b375aa13552593bf0ed.appxbundle//&lt;/a&gt;?<br>
-&nbsp;HIER_NONE/-&nbsp;application/octet-stream/<br>
<br>
(After&nbsp;the&nbsp;&quot;?&quot;&nbsp;there&nbsp;were&nbsp;some&nbsp;variables)<br>
<br>
Anyways,&nbsp;this&nbsp;isn't&nbsp;the&nbsp;cause&nbsp;of&nbsp;the&nbsp;ultra-high&nbsp;bandwidth&nbsp;load..&nbsp;(*our<br>
DL&nbsp;link&nbsp;is&nbsp;100%&nbsp;used&nbsp;by&nbsp;squid&nbsp;right&nbsp;now!*).&nbsp;Most&nbsp;traffic&nbsp;comes&nbsp;from<br>
windows&nbsp;updates...<br>
<br>
/1457015568.658&nbsp;&nbsp;&nbsp;9400&nbsp;10.12.0.197&nbsp;*TCP_SWAPFAIL_MISS/206*&nbsp;1067290&nbsp;GET<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/02/publisher-x-none_08ccd79ac8a6bb475040360b6c9d8c9e1f258c9d.*cab&quot;&gt;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/02/publisher-x-none_08ccd79ac8a6bb475040360b6c9d8c9e1f258c9d.*cab&lt;/a&gt;<br>
*-&nbsp;HIER_DIRECT/201.30.251.40&nbsp;application/octet-stream//<br>
//1457015624.067&nbsp;&nbsp;36878&nbsp;10.12.0.234&nbsp;*TCP_MISS/206*&nbsp;77842&nbsp;GET<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://au.v4.download.*windowsupdate*.com/d/msdownload/update/software/crup/2014/02/windows8.1-kb2919355-x64_66955196a82751d1c8d9806d321487562b159f41.*psf&quot;&gt;http://au.v4.download.*windowsupdate*.com/d/msdownload/update/software/crup/2014/02/windows8.1-kb2919355-x64_66955196a82751d1c8d9806d321487562b159f41.*psf&lt;/a&gt;<br>
*-&nbsp;HIER_DIRECT/201.30.251.40&nbsp;application/octet-stream//<br>
//1457015750.556&nbsp;126469&nbsp;10.12.0.234&nbsp;*TCP_MISS/206*&nbsp;151183&nbsp;GET<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://au.v4.download.*windowsupdate*.com/d/msdownload/update/software/crup/2014/02/windows8.1-kb2919355-x64_66955196a82751d1c8d9806d321487562b159f41.*psf&quot;&gt;http://au.v4.download.*windowsupdate*.com/d/msdownload/update/software/crup/2014/02/windows8.1-kb2919355-x64_66955196a82751d1c8d9806d321487562b159f41.*psf&lt;/a&gt;<br>
*-&nbsp;HIER_DIRECT/201.30.251.40&nbsp;application/octet-stream//<br>
//1457015753.263&nbsp;&nbsp;11011&nbsp;10.12.0.197&nbsp;*TCP_MISS/206*&nbsp;1616920&nbsp;GET<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/03/onenote-x-none_dd4f2bc75fc38be514c4009ce4d289e41f6b75d0.*cab&quot;&gt;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/03/onenote-x-none_dd4f2bc75fc38be514c4009ce4d289e41f6b75d0.*cab&lt;/a&gt;<br>
*-&nbsp;HIER_DIRECT/201.30.251.40&nbsp;application/octet-stream//<br>
//1457015780.978&nbsp;&nbsp;13451&nbsp;10.12.0.197&nbsp;*TCP_SWAPFAIL_MISS/206*&nbsp;2225824&nbsp;GET<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/03/onenote-x-none_dd4f2bc75fc38be514c4009ce4d289e41f6b75d0.*cab&quot;&gt;http://au.v4.download.*windowsupdate*.com/c/msdownload/update/software/crup/2015/03/onenote-x-none_dd4f2bc75fc38be514c4009ce4d289e41f6b75d0.*cab&lt;/a&gt;<br>
*-&nbsp;HIER_DIRECT/201.30.251.40&nbsp;application/octet-stream/<br>
<br>
Do&nbsp;you&nbsp;see&nbsp;anything&nbsp;that&nbsp;could&nbsp;make&nbsp;it&nbsp;re-download&nbsp;over&nbsp;and&nbsp;over&nbsp;again<br>
in&nbsp;this&nbsp;config?<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
The&nbsp;206.&nbsp;If&nbsp;that&nbsp;is&nbsp;206&nbsp;from&nbsp;server&nbsp;Squid&nbsp;is&nbsp;unable&nbsp;to&nbsp;cache&nbsp;it&nbsp;for<br>
future&nbsp;HITs.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
/acl&nbsp;windowsupdate&nbsp;dstdomain&nbsp;.ws.microsoft.com<br>
.windowsupdate.microsoft.com&nbsp;.update.microsoft.com&nbsp;.windowsupdate.com<br>
.armdl.adobe.com//<br>
//http_access&nbsp;allow&nbsp;windowsupdate//<br>
//range_offset_limit&nbsp;none&nbsp;windowsupdate//<br>
//<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Can&nbsp;you&nbsp;try&nbsp;adding&nbsp;this:<br>
&nbsp;&nbsp;quick_abort_min&nbsp;-1&nbsp;KB<br>
<br>
<br>
Amos<br>
<br>
_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
