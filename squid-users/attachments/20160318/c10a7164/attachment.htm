<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;10pt;&nbsp;FONT-FAMILY:&nbsp;'Arial';&nbsp;COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&gt;Hi,&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;Is&nbsp;you&nbsp;client&nbsp;a&nbsp;member&nbsp;of&nbsp;FATHER.COM&nbsp;or&nbsp;KID1.FATHER.COM&nbsp;<br>
/&nbsp;KID2.FATHER.COM&nbsp;?&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Can&nbsp;you&nbsp;get&nbsp;a&nbsp;wireshark&nbsp;capture&nbsp;on&nbsp;your&nbsp;client&nbsp;on&nbsp;<br>
port&nbsp;88&nbsp;&nbsp;?&nbsp;&nbsp;You&nbsp;should&nbsp;see&nbsp;some&nbsp;TGS&nbsp;â€“REQs&nbsp;in&nbsp;the&nbsp;capture&nbsp;and&nbsp;I&nbsp;assume&nbsp;<br>
also&nbsp;TGS-REPs&nbsp;&nbsp;with&nbsp;error&nbsp;messages.&nbsp;&nbsp;Can&nbsp;you&nbsp;share&nbsp;these&nbsp;error&nbsp;<br>
messages&nbsp;?&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Regards&lt;/DIV&gt;<br>
&lt;DIV&gt;Markus&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&gt;&quot;akn&nbsp;ab&quot;&nbsp;&lt;drcimino@mail.com&gt;&nbsp;wrote&nbsp;in&nbsp;message&nbsp;<br>
news:trinity-1aed7413-4936-4022-90fa-eac7e2d892ed-1458301713239@3capp-mailcom-lxa01...&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12px;&nbsp;FONT-FAMILY:&nbsp;verdana&quot;&gt;<br>
&lt;DIV&gt;Dear&nbsp;all,&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;i'm&nbsp;having&nbsp;a&nbsp;problem&nbsp;in&nbsp;configuring&nbsp;my&nbsp;squid&nbsp;3.5.15&nbsp;with&nbsp;negotiated&nbsp;<br>
kerberos&nbsp;authentication&nbsp;in&nbsp;my&nbsp;Mono&nbsp;Forest&nbsp;Multi&nbsp;Domains.&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;My&nbsp;FATHER.COM&nbsp;is&nbsp;a&nbsp;forest&nbsp;with&nbsp;2&nbsp;children:&nbsp;KID1&nbsp;and&nbsp;KID2.&lt;/DIV&gt;<br>
&lt;DIV&gt;Like&nbsp;this:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;-&gt;&nbsp;KID1.FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
-&gt;&nbsp;KID2.FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;With&nbsp;actual&nbsp;configurazion,&nbsp;squid&nbsp;negotiated&nbsp;kerberos&nbsp;auth&nbsp;works&nbsp;with&nbsp;only&nbsp;<br>
FATHER.COM&nbsp;but&nbsp;not&nbsp;when&nbsp;my&nbsp;users&nbsp;belongs&nbsp;to&nbsp;KID1&nbsp;and&nbsp;KID2.&lt;/DIV&gt;<br>
&lt;DIV&gt;I&nbsp;readed&nbsp;some&nbsp;discussions&nbsp;on&nbsp;mailing&nbsp;list&nbsp;about&nbsp;forest,&nbsp;but&nbsp;cannot&nbsp;find&nbsp;a&nbsp;<br>
definitive&nbsp;advice&nbsp;and&nbsp;procedure&nbsp;to&nbsp;authenticate&nbsp;childern&nbsp;domains&nbsp;users.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;My&nbsp;krb5.conf:&lt;/DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;[logging]&lt;BR&gt;default&nbsp;=&nbsp;FILE:/var/log/krb5libs.log&lt;BR&gt;kdc&nbsp;=&nbsp;<br>
FILE:/var/log/krb5kdc.log&lt;BR&gt;admin_server&nbsp;=&nbsp;FILE:/var/log/kadmind.log&lt;/DIV&gt;<br>
&lt;DIV&gt;[libdefaults]&lt;BR&gt;default_realm&nbsp;=&nbsp;FATHER.COM&lt;BR&gt;dns_lookup_realm&nbsp;=&nbsp;<br>
false&lt;BR&gt;dns_lookup_kdc&nbsp;=&nbsp;false&lt;BR&gt;ticket_lifetime&nbsp;=&nbsp;24h&lt;BR&gt;renew_lifetime&nbsp;=&nbsp;<br>
7d&lt;BR&gt;forwardable&nbsp;=&nbsp;true&lt;BR&gt;default_keytab_name&nbsp;=&nbsp;<br>
/usr/local/squid/etc/HTTP.keytab&lt;BR&gt;default_tgs_enctypes&nbsp;=&nbsp;<br>
aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;BR&gt;default_tkt_enctypes&nbsp;<br>
=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;BR&gt;permitted_enctypes&nbsp;<br>
=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;/DIV&gt;<br>
&lt;DIV&gt;[realms]&lt;BR&gt;FATHER.COM&nbsp;=&nbsp;{&lt;BR&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc1.father.com:88&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc2.father.com:88&lt;BR&gt;&nbsp;&nbsp;default_domain&nbsp;=&nbsp;<br>
father.com&lt;BR&gt;}&lt;BR&gt;KID1.FATHER.COM&nbsp;=&nbsp;{&lt;BR&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;<br>
dc1.kid1.father.com:88&lt;BR&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc2.kid1.father.com:88&lt;BR&gt;&nbsp;&nbsp;<br>
default_domain&nbsp;=&nbsp;kid1.father.com&lt;BR&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;KID2.FATHER.COM&nbsp;=&nbsp;{&lt;BR&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc1.kid2.father.com:88&lt;BR&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;<br>
dc2.kid2.father.com:88&lt;BR&gt;&nbsp;&nbsp;default_domain&nbsp;=&nbsp;kid2.father.com&lt;BR&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;[domain_realm]&lt;BR&gt;.father.com&nbsp;=&nbsp;FATHER.COM&lt;BR&gt;father.com&nbsp;=&nbsp;<br>
FATHER.COM&lt;BR&gt;.kid1.father.com&nbsp;=&nbsp;KID1.FATHER.COM&lt;BR&gt;kid1.father.com&nbsp;=&nbsp;<br>
KID1.FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;.kid2.father.com&nbsp;=&nbsp;KID2.FATHER.COM&lt;BR&gt;kid2.father.com&nbsp;=&nbsp;<br>
KID2.FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;[capaths]&lt;BR&gt;KID1.FATHER.COM&nbsp;=&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;=&nbsp;.&lt;BR&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;KID2.FATHER.COM&nbsp;=&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;=&nbsp;.&lt;BR&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;To&nbsp;join&nbsp;kerberous&nbsp;auth&nbsp;with&nbsp;FATHER.COM&nbsp;i&nbsp;did:&lt;/DIV&gt;<br>
&lt;DIV&gt;#&nbsp;kinit&nbsp;user@FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;#&nbsp;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=Computers&quot;&nbsp;-s&nbsp;HTTP/proxy1.father.com&nbsp;-h&nbsp;<br>
proxy1.father.com&nbsp;-k&nbsp;/usr/local/squid/etc/HTTP.keytab&nbsp;--computer-name&nbsp;proxy1krb&nbsp;<br>
--upn&nbsp;HTTP/proxy1.father.com&nbsp;--server&nbsp;dc1.father.com&nbsp;--enctypes&nbsp;28&nbsp;--verbose&nbsp;<br>
-N&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;On&nbsp;squid&nbsp;config&nbsp;i&nbsp;have:&lt;/DIV&gt;<br>
&lt;DIV&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;<br>
/usr/local/squid/libexec/negotiate_kerberos_auth&nbsp;-r&nbsp;-k&nbsp;<br>
/usr/local/sq&lt;BR&gt;uid/etc/HTTP.keytab&nbsp;-s&nbsp;HTTP/proxy1.father.com&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Doing&nbsp;so,&nbsp;all&nbsp;my&nbsp;users&nbsp;belonging&nbsp;to&nbsp;FATHER.COM&nbsp;can&nbsp;negotiate&nbsp;kerberos&nbsp;using&nbsp;<br>
proxy1.father.com:8080&nbsp;(this&nbsp;exact&nbsp;name.&nbsp;If&nbsp;i&nbsp;use&nbsp;an&nbsp;alias&nbsp;dns&nbsp;name,&nbsp;does&nbsp;not&nbsp;<br>
work).&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Now&nbsp;i'm&nbsp;trying&nbsp;to&nbsp;add&nbsp;KID1&nbsp;and&nbsp;KID2&nbsp;users&nbsp;to&nbsp;krb&nbsp;auth.&lt;/DIV&gt;<br>
&lt;DIV&gt;As&nbsp;i&nbsp;sayed&nbsp;previously,&nbsp;i&nbsp;readed&nbsp;some&nbsp;posts&nbsp;but&nbsp;i&nbsp;cannot&nbsp;find&nbsp;correct&nbsp;<br>
configuration&nbsp;to&nbsp;support&nbsp;my&nbsp;forest.&lt;/DIV&gt;<br>
&lt;DIV&gt;1)&nbsp;Someone&nbsp;say&nbsp;to&nbsp;add&nbsp;to&nbsp;HTTP.keytab&nbsp;KID1&nbsp;and&nbsp;KID2.&nbsp;To&nbsp;do&nbsp;so&nbsp;i&nbsp;did:&lt;/DIV&gt;<br>
&lt;DIV&gt;-&nbsp;kinit&nbsp;user@FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;-&nbsp;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=Computers&quot;&nbsp;-s&nbsp;HTTP/proxy1.father.com&nbsp;-h&nbsp;<br>
proxy1.father.com&nbsp;-k&nbsp;/usr/local/squid/etc/HTTP.keytab&nbsp;--computer-name&nbsp;<br>
proxy1krb-kid1&nbsp;--upn&nbsp;HTTP/proxy1.father.com&nbsp;--server&nbsp;dc1.kid1.father.com&nbsp;<br>
--enctypes&nbsp;28&nbsp;--verbose&nbsp;-N&lt;/DIV&gt;<br>
&lt;DIV&gt;but&nbsp;this&nbsp;configuration&nbsp;give&nbsp;my&nbsp;an&nbsp;error&nbsp;authentication&nbsp;of&nbsp;my&nbsp;keytab&nbsp;or&nbsp;<br>
ticketing&nbsp;problem.&nbsp;So&nbsp;i&nbsp;tryed:&lt;/DIV&gt;<br>
&lt;DIV&gt;-&nbsp;kinit&nbsp;user@KID1.FATHER.COM&lt;/DIV&gt;<br>
&lt;DIV&gt;but&nbsp;my&nbsp;user&nbsp;is&nbsp;an&nbsp;Enterprise&nbsp;Admin&nbsp;form&nbsp;FATHER.COM,&nbsp;so&nbsp;i&nbsp;cannot&nbsp;get&nbsp;the&nbsp;<br>
ticket.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;After&nbsp;many,&nbsp;many&nbsp;and&nbsp;many&nbsp;hours,&nbsp;i&nbsp;need&nbsp;some&nbsp;advices&nbsp;to&nbsp;complete&nbsp;my&nbsp;<br>
configuration.&lt;/DIV&gt;<br>
&lt;DIV&gt;Is&nbsp;there&nbsp;anyone&nbsp;that&nbsp;could&nbsp;help&nbsp;me?&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Many&nbsp;thanks&nbsp;in&nbsp;advance.&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;FONT&nbsp;face=Verdana&gt;&lt;/FONT&gt;<br>
&lt;HR&gt;<br>
_______________________________________________&lt;BR&gt;squid-users&nbsp;mailing&nbsp;<br>
list&lt;BR&gt;squid-users@lists.squid-cache.org&lt;BR&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
