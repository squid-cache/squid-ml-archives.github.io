<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;Verdana;font-size:&nbsp;12.0px;&quot;&gt;&lt;div&gt;Dear&nbsp;all,&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;i&#39;m&nbsp;having&nbsp;a&nbsp;problem&nbsp;in&nbsp;configuring&nbsp;my&nbsp;squid&nbsp;3.5.15&nbsp;with&nbsp;negotiated&nbsp;kerberos&nbsp;authentication&nbsp;in&nbsp;my&nbsp;Mono&nbsp;Forest&nbsp;Multi&nbsp;Domains.&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;My&nbsp;FATHER.COM&nbsp;is&nbsp;a&nbsp;forest&nbsp;with&nbsp;2&nbsp;children:&nbsp;KID1&nbsp;and&nbsp;KID2.&lt;/div&gt;<br>
<br>
&lt;div&gt;Like&nbsp;this:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;-&gt;&nbsp;KID1.FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;KID2.FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;With&nbsp;actual&nbsp;configurazion,&nbsp;squid&nbsp;negotiated&nbsp;kerberos&nbsp;auth&nbsp;works&nbsp;with&nbsp;only&nbsp;FATHER.COM&nbsp;but&nbsp;not&nbsp;when&nbsp;my&nbsp;users&nbsp;belongs&nbsp;to&nbsp;KID1&nbsp;and&nbsp;KID2.&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;readed&nbsp;some&nbsp;discussions&nbsp;on&nbsp;mailing&nbsp;list&nbsp;about&nbsp;forest,&nbsp;but&nbsp;cannot&nbsp;find&nbsp;a&nbsp;definitive&nbsp;advice&nbsp;and&nbsp;procedure&nbsp;to&nbsp;authenticate&nbsp;childern&nbsp;domains&nbsp;users.&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;My&nbsp;krb5.conf:&lt;/div&gt;<br>
<br>
&lt;div&gt;<br>
&lt;div&gt;[logging]&lt;br/&gt;<br>
&nbsp;default&nbsp;=&nbsp;FILE:/var/log/krb5libs.log&lt;br/&gt;<br>
&nbsp;kdc&nbsp;=&nbsp;FILE:/var/log/krb5kdc.log&lt;br/&gt;<br>
&nbsp;admin_server&nbsp;=&nbsp;FILE:/var/log/kadmind.log&lt;/div&gt;<br>
<br>
&lt;div&gt;[libdefaults]&lt;br/&gt;<br>
&nbsp;default_realm&nbsp;=&nbsp;FATHER.COM&lt;br/&gt;<br>
&nbsp;dns_lookup_realm&nbsp;=&nbsp;false&lt;br/&gt;<br>
&nbsp;dns_lookup_kdc&nbsp;=&nbsp;false&lt;br/&gt;<br>
&nbsp;ticket_lifetime&nbsp;=&nbsp;24h&lt;br/&gt;<br>
&nbsp;renew_lifetime&nbsp;=&nbsp;7d&lt;br/&gt;<br>
&nbsp;forwardable&nbsp;=&nbsp;true&lt;br/&gt;<br>
&nbsp;default_keytab_name&nbsp;=&nbsp;/usr/local/squid/etc/HTTP.keytab&lt;br/&gt;<br>
&nbsp;default_tgs_enctypes&nbsp;=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;br/&gt;<br>
&nbsp;default_tkt_enctypes&nbsp;=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;br/&gt;<br>
&nbsp;permitted_enctypes&nbsp;=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;/div&gt;<br>
<br>
&lt;div&gt;[realms]&lt;br/&gt;<br>
FATHER.COM&nbsp;=&nbsp;{&lt;br/&gt;<br>
&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc1.father.com:88&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc2.father.com:88&lt;br/&gt;<br>
&nbsp;&nbsp;default_domain&nbsp;=&nbsp;father.com&lt;br/&gt;<br>
&nbsp;}&lt;br/&gt;<br>
&nbsp;KID1.FATHER.COM&nbsp;=&nbsp;{&lt;br/&gt;<br>
&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc1.kid1.father.com:88&lt;br/&gt;<br>
&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc2.kid1.father.com:88&lt;br/&gt;<br>
&nbsp;&nbsp;default_domain&nbsp;=&nbsp;kid1.father.com&lt;br/&gt;<br>
&nbsp;}&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;KID2.FATHER.COM&nbsp;=&nbsp;{&lt;br/&gt;<br>
&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc1.kid2.father.com:88&lt;br/&gt;<br>
&nbsp;&nbsp;kdc&nbsp;=&nbsp;dc2.kid2.father.com:88&lt;br/&gt;<br>
&nbsp;&nbsp;default_domain&nbsp;=&nbsp;kid2.father.com&lt;br/&gt;<br>
&nbsp;}&lt;/div&gt;<br>
<br>
&lt;div&gt;[domain_realm]&lt;br/&gt;<br>
&nbsp;.father.com&nbsp;=&nbsp;FATHER.COM&lt;br/&gt;<br>
&nbsp;father.com&nbsp;=&nbsp;FATHER.COM&lt;br/&gt;<br>
&nbsp;.kid1.father.com&nbsp;=&nbsp;KID1.FATHER.COM&lt;br/&gt;<br>
&nbsp;kid1.father.com&nbsp;=&nbsp;KID1.FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;.kid2.father.com&nbsp;=&nbsp;KID2.FATHER.COM&lt;br/&gt;<br>
&nbsp;kid2.father.com&nbsp;=&nbsp;KID2.FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;[capaths]&lt;br/&gt;<br>
KID1.FATHER.COM&nbsp;=&nbsp;{&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;=&nbsp;.&lt;br/&gt;<br>
}&lt;/div&gt;<br>
<br>
&lt;div&gt;KID2.FATHER.COM&nbsp;=&nbsp;{&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;FATHER.COM&nbsp;=&nbsp;.&lt;br/&gt;<br>
}&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;To&nbsp;join&nbsp;kerberous&nbsp;auth&nbsp;with&nbsp;FATHER.COM&nbsp;i&nbsp;did:&lt;/div&gt;<br>
<br>
&lt;div&gt;#&nbsp;kinit&nbsp;user@FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;#&nbsp;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=Computers&quot;&nbsp;-s&nbsp;HTTP/proxy1.father.com&nbsp;-h&nbsp;proxy1.father.com&nbsp;-k&nbsp;/usr/local/squid/etc/HTTP.keytab&nbsp;--computer-name&nbsp;proxy1krb&nbsp;--upn&nbsp;HTTP/proxy1.father.com&nbsp;--server&nbsp;dc1.father.com&nbsp;--enctypes&nbsp;28&nbsp;--verbose&nbsp;-N&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;On&nbsp;squid&nbsp;config&nbsp;i&nbsp;have:&lt;/div&gt;<br>
<br>
&lt;div&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;/usr/local/squid/libexec/negotiate_kerberos_auth&nbsp;-r&nbsp;-k&nbsp;/usr/local/sq&lt;br/&gt;<br>
uid/etc/HTTP.keytab&nbsp;-s&nbsp;HTTP/proxy1.father.com&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Doing&nbsp;so,&nbsp;all&nbsp;my&nbsp;users&nbsp;belonging&nbsp;to&nbsp;FATHER.COM&nbsp;can&nbsp;negotiate&nbsp;kerberos&nbsp;using&nbsp;proxy1.father.com:8080&nbsp;(this&nbsp;exact&nbsp;name.&nbsp;If&nbsp;i&nbsp;use&nbsp;an&nbsp;alias&nbsp;dns&nbsp;name,&nbsp;does&nbsp;not&nbsp;work).&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Now&nbsp;i&#39;m&nbsp;trying&nbsp;to&nbsp;add&nbsp;KID1&nbsp;and&nbsp;KID2&nbsp;users&nbsp;to&nbsp;krb&nbsp;auth.&lt;/div&gt;<br>
<br>
&lt;div&gt;As&nbsp;i&nbsp;sayed&nbsp;previously,&nbsp;i&nbsp;readed&nbsp;some&nbsp;posts&nbsp;but&nbsp;i&nbsp;cannot&nbsp;find&nbsp;correct&nbsp;configuration&nbsp;to&nbsp;support&nbsp;my&nbsp;forest.&lt;/div&gt;<br>
<br>
&lt;div&gt;1)&nbsp;Someone&nbsp;say&nbsp;to&nbsp;add&nbsp;to&nbsp;HTTP.keytab&nbsp;KID1&nbsp;and&nbsp;KID2.&nbsp;To&nbsp;do&nbsp;so&nbsp;i&nbsp;did:&lt;/div&gt;<br>
<br>
&lt;div&gt;-&nbsp;kinit&nbsp;user@FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;-&nbsp;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;CN=Computers&quot;&nbsp;-s&nbsp;HTTP/proxy1.father.com&nbsp;-h&nbsp;proxy1.father.com&nbsp;-k&nbsp;/usr/local/squid/etc/HTTP.keytab&nbsp;--computer-name&nbsp;proxy1krb-kid1&nbsp;--upn&nbsp;HTTP/proxy1.father.com&nbsp;--server&nbsp;dc1.kid1.father.com&nbsp;--enctypes&nbsp;28&nbsp;--verbose&nbsp;-N&lt;/div&gt;<br>
<br>
&lt;div&gt;but&nbsp;this&nbsp;configuration&nbsp;give&nbsp;my&nbsp;an&nbsp;error&nbsp;authentication&nbsp;of&nbsp;my&nbsp;keytab&nbsp;or&nbsp;ticketing&nbsp;problem.&nbsp;So&nbsp;i&nbsp;tryed:&lt;/div&gt;<br>
<br>
&lt;div&gt;-&nbsp;kinit&nbsp;user@KID1.FATHER.COM&lt;/div&gt;<br>
<br>
&lt;div&gt;but&nbsp;my&nbsp;user&nbsp;is&nbsp;an&nbsp;Enterprise&nbsp;Admin&nbsp;form&nbsp;FATHER.COM,&nbsp;so&nbsp;i&nbsp;cannot&nbsp;get&nbsp;the&nbsp;ticket.&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;After&nbsp;many,&nbsp;many&nbsp;and&nbsp;many&nbsp;hours,&nbsp;i&nbsp;need&nbsp;some&nbsp;advices&nbsp;to&nbsp;complete&nbsp;my&nbsp;configuration.&lt;/div&gt;<br>
<br>
&lt;div&gt;Is&nbsp;there&nbsp;anyone&nbsp;that&nbsp;could&nbsp;help&nbsp;me?&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Many&nbsp;thanks&nbsp;in&nbsp;advance.&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>
<br>

</tt>
