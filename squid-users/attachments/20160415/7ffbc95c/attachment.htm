<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;Amos,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;All&nbsp;noted.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Lemme&nbsp;consult&nbsp;with&nbsp;some&nbsp;FreeBSD&nbsp;guys&nbsp;on&nbsp;these&nbsp;.&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;15&nbsp;April&nbsp;2016&nbsp;at&nbsp;18:13,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;16/04/2016&nbsp;1:29&nbsp;a.m.,&nbsp;Odhiambo&nbsp;Washington&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;With&nbsp;luck,&nbsp;I&nbsp;have&nbsp;managed&nbsp;to&nbsp;get&nbsp;squid&nbsp;to&nbsp;compile&nbsp;successfully&nbsp;(after&lt;br&gt;<br>
&gt;&nbsp;upgrading&nbsp;a&nbsp;few&nbsp;components&nbsp;here&nbsp;and&nbsp;there).&nbsp;I&nbsp;used:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Yay!&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;it&nbsp;running&nbsp;now&nbsp;(redirecting&nbsp;using&nbsp;IPFilter/IPNAT),&nbsp;but&nbsp;once&nbsp;in&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;while&nbsp;I&nbsp;see&nbsp;this&nbsp;error&nbsp;about&nbsp;NAT:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;snip&gt;&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2016/04/15&nbsp;16:17:23|&nbsp;ERROR:&nbsp;NAT/TPROXY&nbsp;lookup&nbsp;failed&nbsp;to&nbsp;locate&nbsp;original&nbsp;IPs&lt;br&gt;<br>
&gt;&nbsp;on&nbsp;local=&lt;a&nbsp;href=&quot;http://192.168.55.254:13128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;192.168.55.254:13128&lt;/a&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://192.168.55.62:57724&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;192.168.55.62:57724&lt;/a&gt;&nbsp;FD&nbsp;29&nbsp;flags=33&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;These&nbsp;are&nbsp;the&nbsp;kernel&nbsp;NAT&nbsp;system&nbsp;telling&nbsp;Squid&nbsp;the&nbsp;connection&nbsp;being&lt;br&gt;<br>
looked&nbsp;up&nbsp;has&nbsp;not&nbsp;record&nbsp;there.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;could&nbsp;be&nbsp;TCP&nbsp;connections&nbsp;being&nbsp;made&nbsp;straight&nbsp;to&nbsp;the&nbsp;intercept&nbsp;port.&lt;br&gt;<br>
If&nbsp;so&nbsp;you&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;firewall&nbsp;config&nbsp;to&nbsp;prevent&nbsp;them,&nbsp;even&nbsp;from&lt;br&gt;<br>
localhost.&lt;br&gt;<br>
Â In&nbsp;Linux&nbsp;we&nbsp;use&nbsp;a&nbsp;mangle&nbsp;table&nbsp;rule,&nbsp;since&nbsp;that&nbsp;is&nbsp;the&nbsp;filter&nbsp;pre-NAT&lt;br&gt;<br>
that&nbsp;can&nbsp;do&nbsp;it.&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;how&nbsp;FreeBSD&nbsp;would&nbsp;do&nbsp;that.&nbsp;It&nbsp;has&nbsp;to&nbsp;be&lt;br&gt;<br>
done&nbsp;on&nbsp;packets&nbsp;first&nbsp;arrival&nbsp;pre-NAT.&nbsp;Any&nbsp;filter&nbsp;that&nbsp;is&nbsp;applied&nbsp;after&lt;br&gt;<br>
the&nbsp;NAT&nbsp;action&nbsp;will&nbsp;get&nbsp;it&nbsp;wrong&nbsp;due&nbsp;to&nbsp;the&nbsp;NAT&nbsp;changes.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;could&nbsp;be&nbsp;the&nbsp;NAT&nbsp;systems&nbsp;table&nbsp;of&nbsp;connections&nbsp;filling&nbsp;up&nbsp;and&lt;br&gt;<br>
overflowing.&nbsp;If&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;a&nbsp;kernel&nbsp;sysctl&nbsp;somewhere&nbsp;to&nbsp;increase&lt;br&gt;<br>
that&nbsp;table&nbsp;size.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;In&nbsp;any&nbsp;case,&nbsp;I&nbsp;am&nbsp;planning&nbsp;to&nbsp;rewrite&nbsp;the&nbsp;IPNAT&nbsp;rules&nbsp;into&nbsp;PF&nbsp;and&nbsp;use&nbsp;PF.&lt;br&gt;<br>
&gt;&nbsp;It&#39;s&nbsp;the&nbsp;inception&nbsp;stage&nbsp;so&nbsp;I&nbsp;haven&#39;t&nbsp;delved&nbsp;deep&nbsp;into&nbsp;ssl-bump&lt;br&gt;<br>
&gt;&nbsp;configurations...&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;HTH&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;Amos&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Best&nbsp;regards,&lt;br&gt;Odhiambo&nbsp;WASHINGTON,&lt;br&gt;Nairobi,KE&lt;br&gt;+254&nbsp;7&nbsp;3200&nbsp;0004/+254&nbsp;7&nbsp;2274&nbsp;3223&lt;br&gt;&quot;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Oh,&nbsp;the&nbsp;cruft.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
