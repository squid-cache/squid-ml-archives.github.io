<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Hi&nbsp;Pete,&nbsp;thanks&nbsp;for&nbsp;replying...&nbsp;let&nbsp;me&nbsp;see&nbsp;if&nbsp;I&nbsp;got&nbsp;it&nbsp;right..&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Will&nbsp;I&nbsp;need&nbsp;to&nbsp;specify&nbsp;every&nbsp;url/domain&nbsp;I&nbsp;want&nbsp;it&nbsp;to&nbsp;act&nbsp;on&nbsp;?&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;want&nbsp;squid&nbsp;to&nbsp;do&nbsp;it&nbsp;for&nbsp;every&nbsp;range-request&nbsp;downloads&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should/would&nbsp;be&nbsp;cached&nbsp;(based&nbsp;on&nbsp;other&nbsp;rules,&nbsp;pattern_refreshs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc)&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;It&nbsp;doesn't&nbsp;need&nbsp;to&nbsp;delay&nbsp;any&nbsp;downloads&nbsp;as&nbsp;long&nbsp;as&nbsp;it&nbsp;isn't&nbsp;a&nbsp;dupe<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;what's&nbsp;already&nbsp;being&nbsp;downloaded.....&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Best&nbsp;Regards,&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
Heiler&nbsp;Bemerguy&nbsp;-&nbsp;(91)&nbsp;98151-4894<br>
Assessor&nbsp;TÃ©cnico&nbsp;-&nbsp;CINBESA&nbsp;(91)&nbsp;3184-1751&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Em&nbsp;12/05/2016&nbsp;11:06,&nbsp;Hans-Peter&nbsp;Jansen<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escreveu:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:2575073.4c7f0552JP@xrated&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;Mittwoch,&nbsp;11.&nbsp;Mai&nbsp;2016&nbsp;21:37:17&nbsp;Heiler&nbsp;Bemerguy&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hey&nbsp;guys,<br>
<br>
First&nbsp;take&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;log:<br>
<br>
root@proxy:/var/log/squid#&nbsp;tail&nbsp;-f&nbsp;access.log&nbsp;|grep<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://download.cdn.mozilla.net/pub/firefox/releases/45.0.1/update/win32/pt&quot;&gt;http://download.cdn.mozilla.net/pub/firefox/releases/45.0.1/update/win32/pt&lt;/a&gt;-&gt;&nbsp;BR/firefox-45.0.1.complete.mar&nbsp;1463011781.572&nbsp;&nbsp;&nbsp;8776&nbsp;10.1.3.236&nbsp;TCP_MISS/206<br>
300520&nbsp;GET<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;[...]&nbsp;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Now&nbsp;think:&nbsp;An&nbsp;user&nbsp;is&nbsp;just&nbsp;doing&nbsp;a&nbsp;segmented/ranged&nbsp;download,&nbsp;right?<br>
Squid&nbsp;won't&nbsp;cache&nbsp;the&nbsp;file&nbsp;because&nbsp;it&nbsp;is&nbsp;a&nbsp;range-download,&nbsp;not&nbsp;a&nbsp;full<br>
file&nbsp;download.<br>
But&nbsp;I&nbsp;WANT&nbsp;squid&nbsp;to&nbsp;cache&nbsp;it.&nbsp;So&nbsp;I&nbsp;decide&nbsp;to&nbsp;use&nbsp;&quot;range_offset_limit<br>
-1&quot;,&nbsp;but&nbsp;then&nbsp;on&nbsp;every&nbsp;GET&nbsp;squid&nbsp;will&nbsp;re-download&nbsp;the&nbsp;file&nbsp;from&nbsp;the<br>
beginning,&nbsp;opening&nbsp;LOTs&nbsp;of&nbsp;simultaneous&nbsp;connections&nbsp;and&nbsp;using&nbsp;too&nbsp;much<br>
bandwidth,&nbsp;doing&nbsp;just&nbsp;the&nbsp;OPPOSITE&nbsp;it's&nbsp;meant&nbsp;to!<br>
<br>
Is&nbsp;there&nbsp;a&nbsp;smart&nbsp;way&nbsp;to&nbsp;allow&nbsp;squid&nbsp;to&nbsp;download&nbsp;it&nbsp;from&nbsp;the&nbsp;beginning&nbsp;to<br>
the&nbsp;end&nbsp;(to&nbsp;actually&nbsp;cache&nbsp;it),&nbsp;but&nbsp;only&nbsp;on&nbsp;the&nbsp;FIRST&nbsp;request/get?&nbsp;Even<br>
if&nbsp;it&nbsp;makes&nbsp;the&nbsp;user&nbsp;wait&nbsp;for&nbsp;the&nbsp;full&nbsp;download,&nbsp;or&nbsp;cancel&nbsp;it<br>
temporarily,&nbsp;or..&nbsp;whatever!!&nbsp;Anything!!<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Well,&nbsp;this&nbsp;is&nbsp;exactly,&nbsp;what&nbsp;my&nbsp;squid_dedup&nbsp;helper&nbsp;was&nbsp;created&nbsp;for!<br>
<br>
See&nbsp;my&nbsp;announcement:&nbsp;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject:&nbsp;[squid-users]&nbsp;New&nbsp;StoreID&nbsp;helper:&nbsp;squid_dedup<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date:&nbsp;Mon,&nbsp;09&nbsp;May&nbsp;2016&nbsp;23:56:45&nbsp;+0200<br>
<br>
My&nbsp;openSUSE&nbsp;environment&nbsp;is&nbsp;fetching&nbsp;_all_&nbsp;updates&nbsp;with&nbsp;byte-ranges&nbsp;from&nbsp;many&nbsp;<br>
servers.&nbsp;Therefor,&nbsp;I&nbsp;created&nbsp;squid_dedup.<br>
<br>
Your&nbsp;specific&nbsp;config&nbsp;could&nbsp;look&nbsp;like&nbsp;this:<br>
<br>
/etc/squid/dedup/mozilla.conf:<br>
[mozilla]<br>
match:&nbsp;http\:\/\/download\.cdn\.mozilla\.net/(.*)<br>
replace:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://download.cdn.mozilla.net.%(intdomain)s/\1&quot;&gt;http://download.cdn.mozilla.net.%(intdomain)s/\1&lt;/a&gt;<br>
fetch:&nbsp;true<br>
<br>
The&nbsp;fetch&nbsp;parameter&nbsp;is&nbsp;unique&nbsp;among&nbsp;the&nbsp;other&nbsp;StoreID&nbsp;helper&nbsp;(AFAIK):&nbsp;it&nbsp;is&nbsp;<br>
fetching&nbsp;the&nbsp;object&nbsp;after&nbsp;a&nbsp;certain&nbsp;delay&nbsp;with&nbsp;a&nbsp;pool&nbsp;of&nbsp;fetcher&nbsp;threads.<br>
<br>
The&nbsp;idea&nbsp;is:&nbsp;after&nbsp;the&nbsp;first&nbsp;access&nbsp;for&nbsp;an&nbsp;object,&nbsp;wait&nbsp;a&nbsp;bit&nbsp;(global&nbsp;setting,&nbsp;<br>
default:&nbsp;15&nbsp;secs),&nbsp;and&nbsp;then&nbsp;fetch&nbsp;the&nbsp;whole&nbsp;thing&nbsp;once.&nbsp;It&nbsp;won't&nbsp;solve&nbsp;<br>
anything&nbsp;for&nbsp;the&nbsp;first&nbsp;client,&nbsp;but&nbsp;for&nbsp;all&nbsp;subsequent&nbsp;accesses.&nbsp;<br>
<br>
The&nbsp;fetcher&nbsp;avoids&nbsp;fetching&nbsp;anything&nbsp;more&nbsp;than&nbsp;once&nbsp;by&nbsp;checking&nbsp;the&nbsp;http&nbsp;<br>
headers.<br>
<br>
This&nbsp;is&nbsp;a&nbsp;pretty&nbsp;new&nbsp;project,&nbsp;but&nbsp;be&nbsp;assured,&nbsp;that&nbsp;the&nbsp;basic&nbsp;functions&nbsp;are&nbsp;<br>
working&nbsp;fine,&nbsp;and&nbsp;I&nbsp;will&nbsp;do&nbsp;my&nbsp;best&nbsp;to&nbsp;solve&nbsp;any&nbsp;upcoming&nbsp;issues.&nbsp;It&nbsp;is&nbsp;<br>
implemented&nbsp;with&nbsp;Python3&nbsp;and&nbsp;prepared&nbsp;for&nbsp;supporting&nbsp;additional&nbsp;features&nbsp;<br>
easily,&nbsp;while&nbsp;keeping&nbsp;a&nbsp;good&nbsp;part&nbsp;of&nbsp;an&nbsp;eye&nbsp;on&nbsp;efficiency.<br>
<br>
Let&nbsp;me&nbsp;know,&nbsp;if&nbsp;you're&nbsp;going&nbsp;to&nbsp;try&nbsp;it.<br>
<br>
Pete<br>
_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
