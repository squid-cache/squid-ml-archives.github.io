<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;having&nbsp;Â a&nbsp;problem&nbsp;talking&nbsp;ICAP&nbsp;with&nbsp;McAfee&nbsp;Web&nbsp;Gateway&nbsp;(MWG).&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;certain&nbsp;circumstances,&nbsp;MWG&nbsp;will&nbsp;start&nbsp;streaming&nbsp;the&nbsp;RESPMOD&nbsp;response&nbsp;before&nbsp;Squid&nbsp;has&nbsp;finished&nbsp;sending&nbsp;all&nbsp;the&nbsp;chunks&nbsp;in&nbsp;the&nbsp;RESPMOD&nbsp;request.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Squid&nbsp;does&nbsp;not&nbsp;like&nbsp;this.&nbsp;It&nbsp;seems&nbsp;to&nbsp;interpret&nbsp;the&nbsp;arrival&nbsp;of&nbsp;response&nbsp;traffic&nbsp;as&nbsp;a&nbsp;signal&nbsp;that&nbsp;the&nbsp;request&nbsp;should&nbsp;have&nbsp;finished.&nbsp;So&nbsp;it&nbsp;stops&nbsp;reading&nbsp;from&nbsp;the&nbsp;origin&nbsp;resource,&nbsp;and&nbsp;consequently&nbsp;stops&nbsp;writing&nbsp;to&nbsp;MWG.&nbsp;The&nbsp;result&nbsp;is&nbsp;that&nbsp;the&nbsp;HTTP&nbsp;client&nbsp;sees&nbsp;only&nbsp;a&nbsp;fraction&nbsp;of&nbsp;the&nbsp;file&nbsp;it&#39;s&nbsp;requested.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell,&nbsp;ICAP&nbsp;is&nbsp;no&nbsp;different&nbsp;from&nbsp;HTTP&nbsp;in&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;response&nbsp;to&nbsp;follow&nbsp;a&nbsp;request,&nbsp;not&nbsp;the&nbsp;request&nbsp;and&nbsp;response&nbsp;to&nbsp;be&nbsp;transmitted&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;in&nbsp;a&nbsp;full-duplex&nbsp;style.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Are&nbsp;my&nbsp;assumptions&nbsp;correct,&nbsp;and&nbsp;is&nbsp;this&nbsp;Squid&nbsp;behavior&nbsp;by&nbsp;design?&nbsp;If&nbsp;so&nbsp;I&#39;m&nbsp;going&nbsp;to&nbsp;have&nbsp;take&nbsp;it&nbsp;up&nbsp;with&nbsp;the&nbsp;McAfee&nbsp;people.&lt;/div&gt;&lt;/div&gt;<br>

</tt>
