<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;color:rgb(0,0,0)&quot;&gt;&gt;&nbsp;So,&nbsp;does&nbsp;the&nbsp;problem&nbsp;exist&nbsp;if&nbsp;you:<br>
<br>
&gt;&nbsp;1.&nbsp;Stop&nbsp;Squid<br>
&gt;&nbsp;2.&nbsp;Type&nbsp;&quot;host&nbsp;&lt;a&nbsp;href=&quot;http://short.domain.name&quot;&gt;short.domain.name&lt;/a&gt;&quot;&nbsp;to&nbsp;resolve&nbsp;the&nbsp;ICAP&nbsp;server&nbsp;manually<br>
&gt;&nbsp;3.&nbsp;Start&nbsp;Squid<br>
<br>
&gt;&nbsp;(The&nbsp;last&nbsp;two&nbsp;commands&nbsp;in&nbsp;as&nbsp;quick&nbsp;succession&nbsp;as&nbsp;possible&nbsp;-&nbsp;preferably&nbsp;on&nbsp;a&nbsp;<br>
&gt;&nbsp;single&nbsp;line&nbsp;separated&nbsp;by&nbsp;a&nbsp;semi-colon)<br>
&lt;/pre&gt;&lt;div&gt;yes&nbsp;the&nbsp;problem&nbsp;still&nbsp;exists&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;color:rgb(0,0,0)&quot;&gt;&gt;&gt;&lt;i&gt;&nbsp;I&nbsp;see&nbsp;in&nbsp;cache.log&nbsp;that&nbsp;its&nbsp;adding&nbsp;nameservers&nbsp;from&nbsp;/etc/resolv.conf<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;2016/05/27&nbsp;10:32:52&nbsp;kid1|&nbsp;Adding&nbsp;nameserver&nbsp;10.32.1.1&nbsp;from&nbsp;/etc/resolv.conf<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;2016/05/27&nbsp;10:32:52&nbsp;kid1|&nbsp;Adding&nbsp;nameserver&nbsp;10.32.1.1&nbsp;from&nbsp;/etc/resolv.conf<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;2016/05/27&nbsp;10:32:52&nbsp;kid1|&nbsp;Adding&nbsp;nameserver&nbsp;8.8.8.8&nbsp;from&nbsp;/etc/resolv.conf<br>
&lt;/i&gt;<br>
&gt;&nbsp;Why&nbsp;have&nbsp;you&nbsp;added&nbsp;10.32.1.1&nbsp;twice?&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;color:rgb(0,0,0)&quot;&gt;That&nbsp;was&nbsp;by&nbsp;chance.&nbsp;Its&nbsp;10.32.1.2.&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&quot;&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;&gt;&lt;i&gt;&nbsp;&gt;&nbsp;Is&nbsp;that&nbsp;DNS&nbsp;server&nbsp;running&nbsp;and&nbsp;answering&nbsp;queries&nbsp;before&nbsp;the&nbsp;Squid<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;&gt;&nbsp;server/service&nbsp;starts&nbsp;up?<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;I&nbsp;do&nbsp;curl/ping/nslookup&nbsp;for&nbsp;icap&nbsp;server&nbsp;from&nbsp;squid&nbsp;machine,&nbsp;it&nbsp;is&nbsp;able&nbsp;to<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;resolve&nbsp;that&nbsp;particular&nbsp;ip.<br>
&lt;/i&gt;<br>
&gt;&nbsp;You&nbsp;do&nbsp;this&nbsp;before&nbsp;starting&nbsp;Squid,&nbsp;and&nbsp;it&nbsp;works,&nbsp;and&nbsp;then&nbsp;when&nbsp;you&nbsp;start&nbsp;<br>
Squid,&nbsp;it&nbsp;fails&nbsp;for&nbsp;3&nbsp;minutes??&lt;/pre&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;Yes,&nbsp;after&nbsp;3&nbsp;minutes&nbsp;it&#39;s&nbsp;able&nbsp;to&nbsp;resolve&nbsp;DNS&nbsp;and&nbsp;brings&nbsp;up&nbsp;the&nbsp;service.&lt;/pre&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;on&nbsp;additional&nbsp;debugging&nbsp;by&nbsp;switching&nbsp;on&nbsp;tcpflow,&nbsp;I&nbsp;see&nbsp;squid&nbsp;sends&nbsp;OPTIONS&nbsp;request&nbsp;to&nbsp;icap&nbsp;server&nbsp;and&nbsp;that&nbsp;is&nbsp;when&nbsp;it&nbsp;is&nbsp;able&nbsp;to&nbsp;resolve&nbsp;DNS&nbsp;and&nbsp;which&nbsp;brings&nbsp;the&nbsp;service&nbsp;up&nbsp;in&nbsp;3&nbsp;minutes.&lt;/pre&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;###Request&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;OPTIONS&nbsp;icap://&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://short.domain.name&quot;&gt;short.domain.name&lt;/a&gt;&lt;/span&gt;:1344&nbsp;ICAP/1.0&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Host:&nbsp;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://short.domain.name&quot;&gt;short.domain.name&lt;/a&gt;&lt;/span&gt;:1344&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Allow:&nbsp;206&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;###Response&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;ICAP/1.0&nbsp;200&nbsp;OK&lt;/span&gt;<br>
&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Methods:&nbsp;REQMOD,&nbsp;RESPMOD&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Options-TTL:&nbsp;3600&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Encapsulated:&nbsp;null-body=0&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Max-Connections:&nbsp;400&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Preview:&nbsp;30&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Service:&nbsp;Gateway&nbsp;7.5.2&nbsp;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;ISTag:&nbsp;&quot;00005042-2.94.230-00008178&quot;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Allow:&nbsp;204&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&nbsp;--------<br>
&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Additionally,&nbsp;i&nbsp;increased&nbsp;debug&nbsp;level&nbsp;and&nbsp;saw&nbsp;this&nbsp;in&nbsp;cache&nbsp;logs<br>
&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&quot;&gt;&lt;p&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Â Address.cc(389)&nbsp;lookupHostIP:&nbsp;Given&nbsp;Non-IP&nbsp;&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://short.domain.name&quot;&gt;short.domain.name&lt;/a&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&#39;:&nbsp;Name&nbsp;or&nbsp;service&nbsp;not&nbsp;known&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;Thanks&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;<br>
<br>
&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
