<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;May&nbsp;26,&nbsp;2016&nbsp;at&nbsp;8:04&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;24/05/2016&nbsp;7:52&nbsp;p.m.,&nbsp;Tomas&nbsp;Mozes&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello,&lt;br&gt;<br>
&gt;&nbsp;on&nbsp;two&nbsp;different&nbsp;squid&nbsp;servers&nbsp;I&#39;ve&nbsp;observed&nbsp;a&nbsp;crash&nbsp;of&nbsp;pinger.&nbsp;First&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;appeared&nbsp;on&nbsp;version&nbsp;3.5.15&nbsp;and&nbsp;later&nbsp;on&nbsp;version&nbsp;3.5.17.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Cache.log&nbsp;contains&nbsp;these&nbsp;lines:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;(pinger):&nbsp;Address.cc:671:&nbsp;void&nbsp;Ip::Address::getAddrInfo(addrinfo*&amp;,&nbsp;int)&lt;br&gt;<br>
&gt;&nbsp;const:&nbsp;Assertion&nbsp;`false&#39;&nbsp;failed.&lt;br&gt;<br>
&gt;&nbsp;2016/05/14&nbsp;21:55:25&nbsp;kid1|&nbsp;Bad&nbsp;opcode:&nbsp;112&nbsp;from&lt;br&gt;<br>
&gt;&nbsp;[6661:6c73:6522:2061:7420:6c69:6e65:2036]&lt;br&gt;<br>
&gt;&nbsp;2016/05/14&nbsp;21:59:13&nbsp;kid1|&nbsp;recv:&nbsp;(111)&nbsp;Connection&nbsp;refused&lt;br&gt;<br>
&gt;&nbsp;2016/05/14&nbsp;21:59:13&nbsp;kid1|&nbsp;Closing&nbsp;Pinger&nbsp;socket&nbsp;on&nbsp;FD&nbsp;17&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;both&nbsp;servers,&nbsp;that&nbsp;IPv6&nbsp;address&nbsp;was&nbsp;the&nbsp;same&nbsp;-&lt;br&gt;<br>
&gt;&nbsp;6661:6c73:6522:2061:7420:6c69:6e65:2036&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;That&nbsp;is&nbsp;the&nbsp;hexadecimal&nbsp;representation&nbsp;of&nbsp;the&nbsp;error:&lt;br&gt;<br>
 false&quot;&nbsp;at&nbsp;line&nbsp;6&lt;br&gt;<br>
&lt;br&gt;<br>
Which&nbsp;means&nbsp;that&nbsp;your&nbsp;kernel&nbsp;is&nbsp;producing&nbsp;garbage&nbsp;when&nbsp;asked&nbsp;to&nbsp;resolve&lt;br&gt;<br>
an&nbsp;IPv6&nbsp;address&nbsp;or&nbsp;respond&nbsp;to&nbsp;an&nbsp;ICMPv6&nbsp;packet.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Cannot&nbsp;we&nbsp;prevent&nbsp;Squid&nbsp;from&nbsp;crashing&nbsp;in&nbsp;these&nbsp;cases?&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;A&nbsp;quick&nbsp;google&nbsp;search&nbsp;for&nbsp;that&nbsp;showed&nbsp;problems&nbsp;with&nbsp;Squid&nbsp;from&nbsp;the&nbsp;past:&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/mail-archive/squid-users/201301/0251.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.squid-cache.org/mail-archive/squid-users/201301/0251.html&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;strange&nbsp;thing&nbsp;is&nbsp;that&nbsp;I&nbsp;have&nbsp;IPv6&nbsp;disabled&nbsp;in&nbsp;the&nbsp;system&nbsp;(not&nbsp;even&nbsp;as&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;module&nbsp;in&nbsp;the&nbsp;Linux&nbsp;kernel)&nbsp;and&nbsp;Squid&nbsp;was&nbsp;compiled&nbsp;without&nbsp;ipv6&nbsp;support.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Support&nbsp;for&nbsp;IPv6&nbsp;has&nbsp;been&nbsp;mandatory&nbsp;for&nbsp;all&nbsp;IP&nbsp;network&nbsp;connected&nbsp;devices&lt;br&gt;<br>
since&nbsp;2012.&lt;br&gt;<br>
&lt;br&gt;<br>
&quot;Disabling&quot;&nbsp;IPv6&nbsp;in&nbsp;Squid&nbsp;simply&nbsp;means&nbsp;it&nbsp;will&nbsp;not&nbsp;attempt&nbsp;to&nbsp;use&nbsp;IPv6&lt;br&gt;<br>
for&nbsp;HTTP&nbsp;connections.&nbsp;It&nbsp;must&nbsp;still&nbsp;be&nbsp;able&nbsp;to&nbsp;identify&nbsp;IPv6&nbsp;addresses.&lt;br&gt;<br>
Which&nbsp;requires&nbsp;kernel&nbsp;support&nbsp;for&nbsp;IPv6.&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;don&#39;t&nbsp;want&nbsp;IPv6&nbsp;to&nbsp;take&nbsp;place&nbsp;&quot;the&nbsp;right&nbsp;way&quot;&nbsp;to&nbsp;do&nbsp;it&nbsp;is&nbsp;to&lt;br&gt;<br>
configure&nbsp;your&nbsp;network&nbsp;interfaces&nbsp;not&nbsp;to&nbsp;have&nbsp;IPv6&nbsp;address&nbsp;assignments&lt;br&gt;<br>
and&nbsp;your&nbsp;machines&nbsp;firewall&nbsp;to&nbsp;block&nbsp;IPv6&nbsp;traffic.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
