<tt>
&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Hello&nbsp;Antony;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;I&nbsp;have&nbsp;setup&nbsp;like&nbsp;below&nbsp;:-&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;end&nbsp;user&nbsp;&gt;&gt;&nbsp;LinuxProxy(3.1.10)<br>
&gt;&gt;&nbsp;External&nbsp;Proxy(3.4)&gt;&gt;&nbsp;Internet&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;when&nbsp;we&nbsp;configure&nbsp;external&nbsp;proxy&nbsp;ip<br>
in&nbsp;end&nbsp;user's&nbsp;IE,&nbsp;all&nbsp;HTTP&nbsp;&amp;&nbsp;HTTPS&nbsp;site&nbsp;work&nbsp;properly.&lt;/font&gt;<br>
&lt;li&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;when&nbsp;we&nbsp;configure&nbsp;Linux&nbsp;proxy&nbsp;ip&nbsp;in<br>
end&nbsp;user's&nbsp;IE,&nbsp;HTTP&nbsp;works&nbsp;fine&nbsp;but&nbsp;none&nbsp;of&nbsp;the&nbsp;HTTPS&nbsp;site&nbsp;open.&lt;/font&gt;<br>
&lt;li&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;when&nbsp;we&nbsp;access&nbsp;https&nbsp;site&nbsp;from&nbsp;LinuxProxy,<br>
below&nbsp;logs&nbsp;are&nbsp;appearing&nbsp;in&nbsp;access.log&nbsp;&lt;/font&gt;&lt;/ul&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP_DENIED/407&nbsp;CONNECT&nbsp;sitename:443&nbsp;-&nbsp;&nbsp;NONE/<br>
text/html&nbsp;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP_MISS/503<br>
0&nbsp;CONNECT&nbsp;sitename:443&nbsp;username@MYDOMAIN.COM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
DIRECT&nbsp;/&nbsp;-&nbsp;-&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP_MISS/200<br>
23456&nbsp;GET&nbsp;&lt;/font&gt;&lt;a&nbsp;href=http://www.anysite.com/&gt;&lt;font&nbsp;size=2&nbsp;color=blue&nbsp;face=&quot;sans-serif&quot;&gt;http://www.anysite.com&lt;/font&gt;&lt;/a&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;<br>
username@MYDOMAIN.COM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_PARENT/10.10.x.x<br>
text/html&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;what&nbsp;I&nbsp;making&nbsp;out&nbsp;from&nbsp;log&nbsp;is&nbsp;(&nbsp;I&nbsp;might<br>
be&nbsp;wrong)&nbsp;-&nbsp;HTTPS&nbsp;request&nbsp;are&nbsp;going&nbsp;directly&nbsp;instead&nbsp;.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;attached&nbsp;is&nbsp;my&nbsp;Linux&nbsp;Proxy&nbsp;config-&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;=================&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;configuration:&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#auth_param&nbsp;negotiate&nbsp;program&nbsp;/usr/lib64/squid/squid_kerb_auth<br>
-d&nbsp;-s&nbsp;GSS_C_NO_NAME&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;/usr/lib64/squid/squid_kerb_auth<br>
-s&nbsp;HTTP/proxy02.abcd.com@ABCD.COM&nbsp;-d&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;auth_param&nbsp;negotiate&nbsp;children&nbsp;10&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;auth_param&nbsp;negotiate&nbsp;keep_alive&nbsp;on&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;ad_auth&nbsp;proxy_auth&nbsp;REQUIRED&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localhost&nbsp;src&nbsp;127.0.0.1/32&nbsp;::1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;to_localhost&nbsp;dst&nbsp;127.0.0.0/8&nbsp;0.0.0.0/32<br>
::1&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from<br>
your&nbsp;local&nbsp;networks.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Adapt&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP<br>
networks&nbsp;from&nbsp;where&nbsp;browsing&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;should&nbsp;be&nbsp;allowed&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;10.0.0.0/8&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;172.16.0.0/12&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;192.168.0.0/16&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission<br>
configuration:&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;allow&nbsp;manager&nbsp;localhost&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;deny&nbsp;manager&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure<br>
SSL&nbsp;ports&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following<br>
be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy<br>
server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;<br>
is&nbsp;a&nbsp;local&nbsp;user&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW<br>
ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from<br>
your&nbsp;local&nbsp;networks.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section<br>
to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#http_access&nbsp;allow&nbsp;localnet&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#http_access&nbsp;allow&nbsp;localhost&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;deny&nbsp;!ad_auth&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;allow&nbsp;ad_auth&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;And&nbsp;finally&nbsp;deny&nbsp;all&nbsp;other&nbsp;access<br>
to&nbsp;this&nbsp;proxy&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_access&nbsp;deny&nbsp;all&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Squid&nbsp;normally&nbsp;listens&nbsp;to&nbsp;port&nbsp;3128&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;http_port&nbsp;8080&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;cache_peer&nbsp;xx.xx.2.108&nbsp;parent&nbsp;8080<br>
0&nbsp;default&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#dns_nameservers&nbsp;ABCDNS.ABCD.COM&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;dns_nameservers&nbsp;xx.xx.2.108&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;We&nbsp;recommend&nbsp;you&nbsp;to&nbsp;use&nbsp;at&nbsp;least<br>
the&nbsp;following&nbsp;line.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#hierarchy_stoplist&nbsp;cgi-bin&nbsp;?&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Uncomment&nbsp;and&nbsp;adjust&nbsp;the&nbsp;following<br>
to&nbsp;add&nbsp;a&nbsp;disk&nbsp;cache&nbsp;directory.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;cache_dir&nbsp;ufs&nbsp;/var/spool/squid&nbsp;2048<br>
16&nbsp;256&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache<br>
dir&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;coredump_dir&nbsp;/var/spool/squid&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Log&nbsp;forwarding&nbsp;to&nbsp;SysLog&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;access_log&nbsp;syslog:local1.info&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern<br>
entries&nbsp;above&nbsp;these.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;-======================================&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Thanks&nbsp;&amp;&nbsp;Regards&lt;br&gt;<br>
Nilesh&nbsp;Suresh&nbsp;Gavali&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;From:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;squid-users@lists.squid-cache.org&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;14/06/2016&nbsp;13:00&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Subject:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;squid-users<br>
Digest,&nbsp;Vol&nbsp;22,&nbsp;Issue&nbsp;62&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Sent&nbsp;by:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;&quot;squid-users&quot;<br>
&lt;squid-users-bounces@lists.squid-cache.org&gt;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;hr&nbsp;noshade&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;Send&nbsp;squid-users&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;'help'&nbsp;to&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
squid-users-request@lists.squid-cache.org&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
squid-users-owner@lists.squid-cache.org&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;squid-users&nbsp;digest...&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Today's&nbsp;Topics:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;1.&nbsp;Re:&nbsp;Excessive&nbsp;TCP&nbsp;memory&nbsp;usage&nbsp;(Eliezer&nbsp;Croitoru)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;2.&nbsp;Re:&nbsp;Squid&nbsp;not&nbsp;allowing&nbsp;HTTPS&nbsp;access&nbsp;(Nilesh&nbsp;Gavali)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;3.&nbsp;Re:&nbsp;Squid&nbsp;not&nbsp;allowing&nbsp;HTTPS&nbsp;access&nbsp;(Antony&nbsp;Stone)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
----------------------------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;1&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;14&nbsp;Jun&nbsp;2016&nbsp;13:21:32&nbsp;+0300&lt;br&gt;<br>
From:&nbsp;&quot;Eliezer&nbsp;Croitoru&quot;&nbsp;&lt;eliezer@ngtech.co.il&gt;&lt;br&gt;<br>
To:&nbsp;&quot;'Deniz&nbsp;Eren'&quot;&nbsp;&lt;denizlist@denizeren.net&gt;,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;squid-users@lists.squid-cache.org&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Excessive&nbsp;TCP&nbsp;memory&nbsp;usage&lt;br&gt;<br>
Message-ID:&nbsp;&lt;05c801d1c626$85a97ff0$90fc7fd0$@ngtech.co.il&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
Hey,&lt;br&gt;<br>
&lt;br&gt;<br>
Steps&nbsp;to&nbsp;reproduce&nbsp;are&nbsp;not&nbsp;exactly&nbsp;everything&nbsp;since&nbsp;squid&nbsp;works&nbsp;fine&nbsp;in<br>
many&nbsp;other&nbsp;scenarios.&lt;br&gt;<br>
I&nbsp;do&nbsp;not&nbsp;know&nbsp;this&nbsp;specific&nbsp;system&nbsp;but&nbsp;if&nbsp;you&nbsp;are&nbsp;talking&nbsp;about&nbsp;1-4k&nbsp;open<br>
connections&nbsp;it&nbsp;should&nbsp;not&nbsp;be&nbsp;a&nbsp;big&nbsp;problem&nbsp;for&nbsp;many&nbsp;servers.&lt;br&gt;<br>
The&nbsp;issue&nbsp;in&nbsp;hands&nbsp;is&nbsp;a&nbsp;bit&nbsp;different.&lt;br&gt;<br>
Have&nbsp;you&nbsp;tried&nbsp;tuning&nbsp;the&nbsp;ipv4\net&nbsp;using&nbsp;sysctl&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;affects&nbsp;anything?&lt;br&gt;<br>
What&nbsp;I&nbsp;can&nbsp;offer&nbsp;is&nbsp;to&nbsp;build&nbsp;a&nbsp;tiny&nbsp;ICAP&nbsp;service&nbsp;that&nbsp;will&nbsp;use&nbsp;a&nbsp;204&nbsp;on<br>
every&nbsp;request&nbsp;and&nbsp;then&nbsp;moves&nbsp;on.&lt;br&gt;<br>
If&nbsp;the&nbsp;same&nbsp;happens&nbsp;with&nbsp;the&nbsp;dummy&nbsp;service&nbsp;it's&nbsp;probably&nbsp;a&nbsp;very&nbsp;bad&nbsp;scenario<br>
and&nbsp;if&nbsp;not&nbsp;then&nbsp;we&nbsp;can&nbsp;try&nbsp;to&nbsp;think&lt;br&gt;<br>
if&nbsp;there&nbsp;is&nbsp;something&nbsp;unique&nbsp;about&nbsp;your&nbsp;setup.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;not&nbsp;seen&nbsp;this&nbsp;issue&nbsp;in&nbsp;my&nbsp;current&nbsp;testing&nbsp;setup&nbsp;which&nbsp;includes&nbsp;3.5.19<br>
+&nbsp;ICAP&nbsp;url&nbsp;filtering&nbsp;service.&lt;br&gt;<br>
&lt;br&gt;<br>
Eliezer&lt;br&gt;<br>
&lt;br&gt;<br>
----&lt;br&gt;<br>
Eliezer&nbsp;Croitoru&lt;br&gt;<br>
Linux&nbsp;System&nbsp;Administrator&lt;br&gt;<br>
Mobile:&nbsp;+972-5-28704261&lt;br&gt;<br>
Email:&nbsp;eliezer@ngtech.co.il&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;squid-users&nbsp;[&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;mailto:squid-users-bounces@lists.squid-cache.org&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;mailto:squid-users-bounces@lists.squid-cache.org&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;]<br>
On&nbsp;Behalf&nbsp;Of&nbsp;Deniz&nbsp;Eren&lt;br&gt;<br>
Sent:&nbsp;Tuesday,&nbsp;June&nbsp;14,&nbsp;2016&nbsp;11:07&nbsp;AM&lt;br&gt;<br>
To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Excessive&nbsp;TCP&nbsp;memory&nbsp;usage&lt;br&gt;<br>
&lt;br&gt;<br>
Little&nbsp;bump&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;posted&nbsp;bug&nbsp;report&nbsp;with&nbsp;steps&nbsp;to&nbsp;reproduce.&nbsp;The&nbsp;problem&nbsp;still&nbsp;exists<br>
and&nbsp;I&nbsp;am&nbsp;curious&nbsp;whether&nbsp;anyone&nbsp;else&nbsp;is&nbsp;having&nbsp;the&nbsp;same&nbsp;problem,&nbsp;too.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://bugs.squid-cache.org/show_bug.cgi?id=4526&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://bugs.squid-cache.org/show_bug.cgi?id=4526&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Wed,&nbsp;May&nbsp;25,&nbsp;2016&nbsp;at&nbsp;1:18&nbsp;PM,&nbsp;Deniz&nbsp;Eren&nbsp;&lt;denizlist@denizeren.net&gt;<br>
wrote:&lt;br&gt;<br>
&gt;&nbsp;When&nbsp;I&nbsp;listen&nbsp;to&nbsp;connections&nbsp;between&nbsp;squid&nbsp;and&nbsp;icap&nbsp;using&nbsp;tcpdump<br>
I&nbsp;&lt;br&gt;<br>
&gt;&nbsp;saw&nbsp;that&nbsp;after&nbsp;a&nbsp;while&nbsp;icap&nbsp;closes&nbsp;the&nbsp;connection&nbsp;but&nbsp;squid&nbsp;does&nbsp;not<br>
&lt;br&gt;<br>
&gt;&nbsp;close,&nbsp;so&nbsp;connection&nbsp;stays&nbsp;in&nbsp;CLOSE_WAIT&nbsp;state:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;[root@test&nbsp;~]#&nbsp;tcpdump&nbsp;-i&nbsp;any&nbsp;-n&nbsp;port&nbsp;34693&lt;br&gt;<br>
&gt;&nbsp;tcpdump:&nbsp;WARNING:&nbsp;Promiscuous&nbsp;mode&nbsp;not&nbsp;supported&nbsp;on&nbsp;the&nbsp;&quot;any&quot;<br>
device&lt;br&gt;<br>
&gt;&nbsp;tcpdump:&nbsp;verbose&nbsp;output&nbsp;suppressed,&nbsp;use&nbsp;-v&nbsp;or&nbsp;-vv&nbsp;for&nbsp;full&nbsp;protocol<br>
&lt;br&gt;<br>
&gt;&nbsp;decode&nbsp;listening&nbsp;on&nbsp;any,&nbsp;link-type&nbsp;LINUX_SLL&nbsp;(Linux&nbsp;cooked),&nbsp;capture<br>
&lt;br&gt;<br>
&gt;&nbsp;size&nbsp;96&nbsp;bytes&lt;br&gt;<br>
&gt;&nbsp;13:07:31.802238&nbsp;IP&nbsp;127.0.0.1.icap&nbsp;&gt;&nbsp;127.0.0.1.34693:&nbsp;F&lt;br&gt;<br>
&gt;&nbsp;2207817997:2207817997(0)&nbsp;ack&nbsp;710772005&nbsp;win&nbsp;395&nbsp;&lt;nop,nop,timestamp&lt;br&gt;<br>
&gt;&nbsp;104616992&nbsp;104016968&gt;&lt;br&gt;<br>
&gt;&nbsp;13:07:31.842186&nbsp;IP&nbsp;127.0.0.1.34693&nbsp;&gt;&nbsp;127.0.0.1.icap:&nbsp;.&nbsp;ack&nbsp;1&nbsp;win<br>
3186&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;nop,nop,timestamp&nbsp;104617032&nbsp;104616992&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;[root@test&nbsp;~]#&nbsp;netstat&nbsp;-tulnap|grep&nbsp;34693&lt;br&gt;<br>
&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;215688&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;127.0.0.1:34693&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;127.0.0.1:1344&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;19740/(squid-1)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;These&nbsp;CLOSE_WAIT&nbsp;connections&nbsp;do&nbsp;not&nbsp;timeout&nbsp;and&nbsp;stay&nbsp;until&nbsp;squid&nbsp;&lt;br&gt;<br>
&gt;&nbsp;process&nbsp;is&nbsp;killed.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;2016-05-25&nbsp;10:37&nbsp;GMT+03:00&nbsp;Deniz&nbsp;Eren&nbsp;&lt;denizlist@denizeren.net&gt;:&lt;br&gt;<br>
&gt;&gt;&nbsp;2016-05-24&nbsp;21:47&nbsp;GMT+03:00&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;:&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;On&nbsp;25/05/2016&nbsp;5:50&nbsp;a.m.,&nbsp;Deniz&nbsp;Eren&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;After&nbsp;upgrading&nbsp;to&nbsp;squid&nbsp;3.5.16&nbsp;I&nbsp;realized&nbsp;that&nbsp;squid<br>
started&nbsp;using&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;much&nbsp;of&nbsp;kernel's&nbsp;TCP&nbsp;memory.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Upgrade&nbsp;from&nbsp;which&nbsp;version?&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Upgrading&nbsp;from&nbsp;squid&nbsp;3.1.14.&nbsp;I&nbsp;started&nbsp;using&nbsp;c-icap&nbsp;and&nbsp;ssl-bump.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;When&nbsp;squid&nbsp;was&nbsp;running&nbsp;for&nbsp;a&nbsp;long&nbsp;time&nbsp;TCP&nbsp;memory&nbsp;usage<br>
is&nbsp;like&nbsp;below:&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;test@test:~$&nbsp;cat&nbsp;/proc/net/sockstat&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;sockets:&nbsp;used&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;TCP:&nbsp;inuse&nbsp;*&nbsp;orphan&nbsp;*&nbsp;tw&nbsp;*&nbsp;alloc&nbsp;*&nbsp;mem&nbsp;200000&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;UDP:&nbsp;inuse&nbsp;*&nbsp;mem&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;UDPLITE:&nbsp;inuse&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;RAW:&nbsp;inuse&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;FRAG:&nbsp;inuse&nbsp;*&nbsp;memory&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;When&nbsp;I&nbsp;restart&nbsp;squid&nbsp;the&nbsp;memory&nbsp;usage&nbsp;drops&nbsp;dramatically:&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Of&nbsp;course&nbsp;it&nbsp;does.&nbsp;By&nbsp;restarting&nbsp;you&nbsp;just&nbsp;erased&nbsp;all&nbsp;of&nbsp;the<br>
&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;operational&nbsp;state&nbsp;for&nbsp;an&nbsp;unknown&nbsp;but&nbsp;large&nbsp;number&nbsp;of&nbsp;active<br>
network&nbsp;connections.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;That's&nbsp;true&nbsp;but&nbsp;what&nbsp;I&nbsp;mean&nbsp;was&nbsp;squid's&nbsp;CLOSE_WAIT&nbsp;connections<br>
are&nbsp;&lt;br&gt;<br>
&gt;&gt;&nbsp;using&nbsp;too&nbsp;much&nbsp;memory&nbsp;and&nbsp;they&nbsp;are&nbsp;not&nbsp;timing&nbsp;out.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Whether&nbsp;many&nbsp;of&nbsp;those&nbsp;should&nbsp;have&nbsp;been&nbsp;still&nbsp;active&nbsp;or&nbsp;not<br>
is&nbsp;a&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;different&nbsp;question.&nbsp;the&nbsp;answer&nbsp;to&nbsp;which&nbsp;depends&nbsp;on&nbsp;how&nbsp;you<br>
have&nbsp;your&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Squid&nbsp;configured,&nbsp;and&nbsp;what&nbsp;the&nbsp;traffic&nbsp;through&nbsp;it&nbsp;has&nbsp;been<br>
doing.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;test@test:~$&nbsp;cat&nbsp;/proc/net/sockstat&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;sockets:&nbsp;used&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;TCP:&nbsp;inuse&nbsp;*&nbsp;orphan&nbsp;*&nbsp;tw&nbsp;*&nbsp;alloc&nbsp;*&nbsp;mem&nbsp;10&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;UDP:&nbsp;inuse&nbsp;*&nbsp;mem&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;UDPLITE:&nbsp;inuse&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;RAW:&nbsp;inuse&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;FRAG:&nbsp;inuse&nbsp;*&nbsp;memory&nbsp;*&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;The&nbsp;numbers&nbsp;you&nbsp;replaced&nbsp;with&nbsp;&quot;*&quot;&nbsp;are&nbsp;rather&nbsp;important<br>
for&nbsp;context.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Today&nbsp;again&nbsp;I&nbsp;saw&nbsp;the&nbsp;problem:&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;test@test:~$&nbsp;cat&nbsp;/proc/net/sockstat&lt;br&gt;<br>
&gt;&gt;&nbsp;sockets:&nbsp;used&nbsp;1304&lt;br&gt;<br>
&gt;&gt;&nbsp;TCP:&nbsp;inuse&nbsp;876&nbsp;orphan&nbsp;81&nbsp;tw&nbsp;17&nbsp;alloc&nbsp;906&nbsp;mem&nbsp;29726&lt;br&gt;<br>
&gt;&gt;&nbsp;UDP:&nbsp;inuse&nbsp;17&nbsp;mem&nbsp;8&lt;br&gt;<br>
&gt;&gt;&nbsp;UDPLITE:&nbsp;inuse&nbsp;0&lt;br&gt;<br>
&gt;&gt;&nbsp;RAW:&nbsp;inuse&nbsp;1&lt;br&gt;<br>
&gt;&gt;&nbsp;FRAG:&nbsp;inuse&nbsp;0&nbsp;memory&nbsp;0&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;I'm&nbsp;using&nbsp;Squid&nbsp;3.5.16.&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Please&nbsp;upgrade&nbsp;to&nbsp;3.5.19.&nbsp;Some&nbsp;important&nbsp;issues&nbsp;have&nbsp;been<br>
resolved.&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Some&nbsp;of&nbsp;them&nbsp;may&nbsp;be&nbsp;related&nbsp;to&nbsp;your&nbsp;TCP&nbsp;memory&nbsp;problem.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;I&nbsp;have&nbsp;upgraded&nbsp;now&nbsp;and&nbsp;problem&nbsp;still&nbsp;exists.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;When&nbsp;I&nbsp;look&nbsp;with&nbsp;&quot;netstat&quot;&nbsp;and&nbsp;&quot;ss&quot;<br>
I&nbsp;see&nbsp;lots&nbsp;of&nbsp;CLOSE_WAIT&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;connections&nbsp;from&nbsp;squid&nbsp;to&nbsp;ICAP&nbsp;or&nbsp;from&nbsp;squid&nbsp;to&nbsp;upstream<br>
server.&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;Do&nbsp;you&nbsp;have&nbsp;any&nbsp;idea&nbsp;about&nbsp;this&nbsp;problem?&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Memory&nbsp;use&nbsp;by&nbsp;the&nbsp;TCP&nbsp;system&nbsp;of&nbsp;your&nbsp;kernel&nbsp;has&nbsp;very&nbsp;little<br>
to&nbsp;do&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;with&nbsp;Squid.&nbsp;Number&nbsp;of&nbsp;sockets&nbsp;in&nbsp;CLOSE_WAIT&nbsp;does&nbsp;have&nbsp;some<br>
relation&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;to&nbsp;Squid&nbsp;or&nbsp;at&nbsp;least&nbsp;to&nbsp;how&nbsp;the&nbsp;traffic&nbsp;going&nbsp;through&nbsp;it&nbsp;is<br>
handled.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;If&nbsp;you&nbsp;have&nbsp;disabled&nbsp;persistent&nbsp;connections&nbsp;in&nbsp;squid.conf<br>
then&nbsp;lots&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;of&nbsp;closed&nbsp;sockets&nbsp;and&nbsp;FD&nbsp;are&nbsp;to&nbsp;be&nbsp;expected.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;If&nbsp;you&nbsp;have&nbsp;persistent&nbsp;connections&nbsp;enabled,&nbsp;then&nbsp;fewer&nbsp;closures<br>
&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;should&nbsp;happen.&nbsp;But&nbsp;some&nbsp;will&nbsp;so&nbsp;expectations&nbsp;depends&nbsp;on&nbsp;how<br>
high&nbsp;the&nbsp;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;traffic&nbsp;load&nbsp;is.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Persistent&nbsp;connection&nbsp;parameters&nbsp;are&nbsp;enabled&nbsp;in&nbsp;my&nbsp;conf,&nbsp;the&nbsp;problem<br>
&lt;br&gt;<br>
&gt;&gt;&nbsp;occurs&nbsp;especially&nbsp;with&nbsp;connections&nbsp;to&nbsp;c-icap&nbsp;service.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;My&nbsp;netstat&nbsp;output&nbsp;is&nbsp;like&nbsp;this:&lt;br&gt;<br>
&gt;&gt;&nbsp;netstat&nbsp;-tulnap|grep&nbsp;squid|grep&nbsp;CLOSE&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;211742&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;127.0.0.1:55751&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;127.0.0.1:1344&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;17076/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;215700&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;127.0.0.1:55679&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;127.0.0.1:1344&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;17076/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;215704&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;127.0.0.1:55683&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;127.0.0.1:1344&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;17076/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;...(hundreds)&lt;br&gt;<br>
&gt;&gt;&nbsp;Above&nbsp;ones&nbsp;are&nbsp;connections&nbsp;to&nbsp;c-icap&nbsp;service.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;netstat&nbsp;-tulnap|grep&nbsp;squid|grep&nbsp;CLOSE&nbsp;Active&nbsp;Internet&nbsp;connections<br>
&lt;br&gt;<br>
&gt;&gt;&nbsp;(servers&nbsp;and&nbsp;established)&lt;br&gt;<br>
&gt;&gt;&nbsp;Proto&nbsp;Recv-Q&nbsp;Send-Q&nbsp;Local&nbsp;Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Foreign&nbsp;Address&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PID/Program&nbsp;name&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:45182&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.2.177:50020&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.2.172:60028&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:44049&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:55054&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.2.137:52177&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:43542&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.155:39489&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.0.147:38939&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:38754&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.0.164:39602&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.0.147:54114&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.6.180:57857&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;192.168.2.1:8443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.0.156:43482&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE_WAIT&nbsp;&nbsp;15245/(squid-1)&lt;br&gt;<br>
&gt;&gt;&nbsp;...(about&nbsp;50)&lt;br&gt;<br>
&gt;&gt;&nbsp;Above&nbsp;ones&nbsp;are&nbsp;connections&nbsp;from&nbsp;https&nbsp;port&nbsp;to&nbsp;client.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;As&nbsp;you&nbsp;can&nbsp;see&nbsp;recv-q&nbsp;for&nbsp;icap&nbsp;connections&nbsp;allocate&nbsp;more&nbsp;memory<br>
but&nbsp;&lt;br&gt;<br>
&gt;&gt;&nbsp;connections&nbsp;from&nbsp;https_port&nbsp;to&nbsp;upstream&nbsp;server&nbsp;connections&nbsp;allocate<br>
&lt;br&gt;<br>
&gt;&gt;&nbsp;only&nbsp;one&nbsp;byte.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;&nbsp;What&nbsp;can&nbsp;be&nbsp;done&nbsp;to&nbsp;close&nbsp;these&nbsp;unused&nbsp;connections?&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;The&nbsp;problem&nbsp;in&nbsp;this&nbsp;thread&nbsp;seems&nbsp;similar:&lt;br&gt;<br>
&gt;&gt;&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/mail-archive/squid-users/201301/0092.html&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://www.squid-cache.org/mail-archive/squid-users/201301/0092.html&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Amos&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;2&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;14&nbsp;Jun&nbsp;2016&nbsp;11:36:30&nbsp;+0100&lt;br&gt;<br>
From:&nbsp;Nilesh&nbsp;Gavali&nbsp;&lt;nilesh.gavali@tcs.com&gt;&lt;br&gt;<br>
To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Squid&nbsp;not&nbsp;allowing&nbsp;HTTPS&nbsp;access&lt;br&gt;<br>
Message-ID:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;OF83BE7BF7.92EBA289-ON80257FD2.003A3940-80257FD2.003A455E@tcs.com&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
Team;&lt;br&gt;<br>
kindly&nbsp;help&nbsp;on&nbsp;below&nbsp;issue.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;&amp;&nbsp;Regards&lt;br&gt;<br>
Nilesh&nbsp;Suresh&nbsp;Gavali&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
From:&nbsp;&nbsp;&nbsp;Nilesh&nbsp;Gavali/MUM/TCS&lt;br&gt;<br>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
Date:&nbsp;&nbsp;&nbsp;13/06/2016&nbsp;14:00&lt;br&gt;<br>
Subject:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Squid&nbsp;not&nbsp;allowing&nbsp;HTTPS&nbsp;access&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Hello&nbsp;All;&lt;br&gt;<br>
Facing&nbsp;issue&nbsp;while&nbsp;accessing&nbsp;HTTPS&nbsp;via&nbsp;squid,&nbsp;normal&nbsp;http&nbsp;traffic&nbsp;working<br>
&lt;br&gt;<br>
fine.&nbsp;I&nbsp;have&nbsp;squid&nbsp;3.1.10&nbsp;on&nbsp;RHEL.6.0&lt;br&gt;<br>
&lt;br&gt;<br>
attached&nbsp;is&nbsp;my&nbsp;squid&nbsp;.conf&nbsp;for&nbsp;your&nbsp;reference,..help&nbsp;will&nbsp;be&nbsp;much&nbsp;&lt;br&gt;<br>
appreciated.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;&amp;&nbsp;Regards&lt;br&gt;<br>
Nilesh&nbsp;Suresh&nbsp;Gavali&lt;br&gt;<br>
=====-----=====-----=====&lt;br&gt;<br>
Notice:&nbsp;The&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;e-mail&lt;br&gt;<br>
message&nbsp;and/or&nbsp;attachments&nbsp;to&nbsp;it&nbsp;may&nbsp;contain&nbsp;&lt;br&gt;<br>
confidential&nbsp;or&nbsp;privileged&nbsp;information.&nbsp;If&nbsp;you&nbsp;are&nbsp;&lt;br&gt;<br>
not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;any&nbsp;dissemination,&nbsp;use,&nbsp;&lt;br&gt;<br>
review,&nbsp;distribution,&nbsp;printing&nbsp;or&nbsp;copying&nbsp;of&nbsp;the&nbsp;&lt;br&gt;<br>
information&nbsp;contained&nbsp;in&nbsp;this&nbsp;e-mail&nbsp;message&nbsp;&lt;br&gt;<br>
and/or&nbsp;attachments&nbsp;to&nbsp;it&nbsp;are&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;&lt;br&gt;<br>
you&nbsp;have&nbsp;received&nbsp;this&nbsp;communication&nbsp;in&nbsp;error,&nbsp;&lt;br&gt;<br>
please&nbsp;notify&nbsp;us&nbsp;by&nbsp;reply&nbsp;e-mail&nbsp;or&nbsp;telephone&nbsp;and&nbsp;&lt;br&gt;<br>
immediately&nbsp;and&nbsp;permanently&nbsp;delete&nbsp;the&nbsp;message&nbsp;&lt;br&gt;<br>
and&nbsp;any&nbsp;attachments.&nbsp;Thank&nbsp;you&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
URL:&nbsp;&lt;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/attachments/20160614/79185c58/attachment-0001.html&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/pipermail/squid-users/attachments/20160614/79185c58/attachment-0001.html&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&gt;&lt;br&gt;<br>
--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
A&nbsp;non-text&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
Name:&nbsp;squid.conf&lt;br&gt;<br>
Type:&nbsp;application/octet-stream&lt;br&gt;<br>
Size:&nbsp;3149&nbsp;bytes&lt;br&gt;<br>
Desc:&nbsp;not&nbsp;available&lt;br&gt;<br>
URL:&nbsp;&lt;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/attachments/20160614/79185c58/attachment-0001.obj&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/pipermail/squid-users/attachments/20160614/79185c58/attachment-0001.obj&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;3&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;14&nbsp;Jun&nbsp;2016&nbsp;12:40:14&nbsp;+0200&lt;br&gt;<br>
From:&nbsp;Antony&nbsp;Stone&nbsp;&lt;Antony.Stone@squid.open.source.it&gt;&lt;br&gt;<br>
To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Squid&nbsp;not&nbsp;allowing&nbsp;HTTPS&nbsp;access&lt;br&gt;<br>
Message-ID:&nbsp;&lt;201606141240.15034.Antony.Stone@squid.open.source.it&gt;&lt;br&gt;<br>
Content-Type:&nbsp;Text/Plain;&nbsp;&nbsp;charset=&quot;iso-8859-15&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tuesday&nbsp;14&nbsp;June&nbsp;2016&nbsp;at&nbsp;12:36:30,&nbsp;Nilesh&nbsp;Gavali&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Team;&lt;br&gt;<br>
&gt;&nbsp;kindly&nbsp;help&nbsp;on&nbsp;below&nbsp;issue.&lt;br&gt;<br>
&lt;br&gt;<br>
Nilesh:&lt;br&gt;<br>
kindly&nbsp;respond&nbsp;to&nbsp;my&nbsp;reply&nbsp;below.&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Monday&nbsp;13&nbsp;June&nbsp;2016&nbsp;at&nbsp;15:26:22,&nbsp;Antony&nbsp;Stone&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Monday&nbsp;13&nbsp;June&nbsp;2016&nbsp;at&nbsp;15:01:02,&nbsp;Nilesh&nbsp;Gavali&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Facing&nbsp;issue&nbsp;while&nbsp;accessing&nbsp;HTTPS&nbsp;via&nbsp;squid,&nbsp;normal&nbsp;http&nbsp;traffic<br>
working&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;fine.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Please&nbsp;define&nbsp;&quot;issue&quot;,&nbsp;with&nbsp;as&nbsp;much&nbsp;detail&nbsp;as&nbsp;possible:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;-&nbsp;what&nbsp;exactly&nbsp;are&nbsp;you&nbsp;trying&nbsp;to&nbsp;do&nbsp;when&nbsp;a&nbsp;problem&nbsp;occurs?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;-&nbsp;have&nbsp;you&nbsp;previously&nbsp;been&nbsp;able&nbsp;to&nbsp;do&nbsp;this&nbsp;without&nbsp;the&nbsp;problem<br>
occurring?&nbsp;&lt;br&gt;<br>
&gt;&nbsp;If&nbsp;so,&nbsp;what&nbsp;has&nbsp;changed&nbsp;between&nbsp;then&nbsp;and&nbsp;now&nbsp;(different&nbsp;squid&nbsp;config,&lt;br&gt;<br>
&gt;&nbsp;different&nbsp;squid&nbsp;version,&nbsp;different&nbsp;browser...)?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;-&nbsp;what&nbsp;is&nbsp;the&nbsp;actual&nbsp;problem&nbsp;(what&nbsp;error&nbsp;message&nbsp;is&nbsp;displayed,<br>
if&nbsp;there&nbsp;is&lt;br&gt;<br>
&gt;&nbsp;one)?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;-&nbsp;what&nbsp;appears&nbsp;in&nbsp;your&nbsp;access.log&nbsp;when&nbsp;the&nbsp;problem&nbsp;occurs?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&nbsp;-&nbsp;any&nbsp;other&nbsp;information&nbsp;you&nbsp;think&nbsp;might&nbsp;be&nbsp;relevant&nbsp;to&nbsp;us&nbsp;in<br>
working&nbsp;out&lt;br&gt;<br>
&gt;&nbsp;what's&nbsp;happening&nbsp;on&nbsp;your&nbsp;network?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;I&nbsp;have&nbsp;squid&nbsp;3.1.10&nbsp;on&nbsp;RHEL.6.0&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;For&nbsp;HTTPS&nbsp;traffic&nbsp;in&nbsp;particular&nbsp;you&nbsp;are&nbsp;strongly&nbsp;advised&nbsp;to&nbsp;upgrade.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Regards,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Antony.&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
All&nbsp;generalisations&nbsp;are&nbsp;inaccurate.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;reply&nbsp;to&nbsp;the&nbsp;list;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;please&nbsp;*don't*&nbsp;CC&nbsp;me.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Subject:&nbsp;Digest&nbsp;Footer&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
End&nbsp;of&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;22,&nbsp;Issue&nbsp;62&lt;br&gt;<br>
*******************************************&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;
</tt>
