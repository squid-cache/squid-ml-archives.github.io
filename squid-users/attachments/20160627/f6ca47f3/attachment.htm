<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Thank&nbsp;you&nbsp;both&nbsp;for&nbsp;your&nbsp;valuable&nbsp;help.&lt;br&gt;&lt;/div&gt;I&#39;ve&nbsp;configured&nbsp;the&nbsp;tls-dh&nbsp;param&nbsp;with&nbsp;a&nbsp;strong&nbsp;Diffie-Hellman&nbsp;group&nbsp;(2048&nbsp;bits)&nbsp;and&nbsp;configured&nbsp;the&nbsp;cipher&nbsp;as&nbsp;Yuri&nbsp;specified&nbsp;and&nbsp;I&nbsp;was&nbsp;able&nbsp;to&nbsp;get&nbsp;pass&nbsp;the&nbsp;unknown&nbsp;cipher,&nbsp;however&nbsp;now&nbsp;I&nbsp;get&nbsp;a&nbsp;&quot;SSL&nbsp;routines:SSL3_GET_RECORD:wrong&nbsp;version&nbsp;number&quot;.&nbsp;Here&#39;s&nbsp;the&nbsp;configuration&nbsp;I&nbsp;changed:&lt;br&gt; cipher=HIGH:MEDIUM:RC4:3DES:!aNULL:!eNULL:!LOW:!MD5:!EXP:!PSK:!SRP:!DSS&nbsp;dhparams=/etc/dh-parameters.2048&nbsp;options=NO_SSLv2,NO_SSLv3,SINGLE_DH_USE&nbsp;tls-dh=/usr/local/etc/squid/dhparams.pem&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;Renato&nbsp;Jop&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sat,&nbsp;Jun&nbsp;25,&nbsp;2016&nbsp;at&nbsp;11:34&nbsp;AM,&nbsp;Yuri&nbsp;Voinov&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:yvoinov@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;yvoinov@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&lt;br&gt;<br>
Hash:&nbsp;SHA256&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;a&nbsp;href=&quot;tel:25.06.2016&quot;&nbsp;value=&quot;+50225062016&quot;&gt;25.06.2016&lt;/a&gt; 23:09,&nbsp;Amos&nbsp;Jeffries&nbsp;пишет:&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;On&nbsp;26/06/2016&nbsp;4:32&nbsp;a.m.,&nbsp;Yuri&nbsp;Voinov&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Amos,&nbsp;you&nbsp;are&nbsp;a&nbsp;wrong.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;No&nbsp;Squid-4.&nbsp;It&#39;s&nbsp;unstable&nbsp;and&nbsp;not&nbsp;ready&nbsp;for&nbsp;production.&nbsp;Whenever&nbsp;it&#39;s&lt;br&gt;<br>
&gt;&gt;&nbsp;features.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;So&nbsp;some&nbsp;beta&nbsp;software&nbsp;has&nbsp;bugs&nbsp;therefore&nbsp;nobody&nbsp;should&nbsp;ever&nbsp;use&nbsp;it&nbsp;for&lt;br&gt;<br>
&gt;&nbsp;anything.&nbsp;I&nbsp;find&nbsp;that&nbsp;to&nbsp;be&nbsp;a&nbsp;strange&nbsp;and&nbsp;sad&nbsp;view&nbsp;of&nbsp;the&nbsp;world.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Care&nbsp;to&nbsp;guess&nbsp;why&nbsp;I&nbsp;listed&nbsp;it&nbsp;as&nbsp;the&nbsp;last&nbsp;option&nbsp;amongst&nbsp;several?&lt;br&gt;<br>
&gt; &nbsp;Or&nbsp;why&nbsp;4.0.11&nbsp;exists&nbsp;as&nbsp;a&nbsp;beta&nbsp;still?&lt;br&gt;<br>
&gt;&nbsp;It&nbsp;*is*&nbsp;an&nbsp;option&nbsp;for&nbsp;the&nbsp;mentioned&nbsp;problem(s)&nbsp;though&nbsp;whatever&nbsp;its&lt;br&gt;<br>
utility.&lt;br&gt;<br>
&lt;/span&gt;Agreed.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Some&nbsp;time&nbsp;ago&nbsp;I&nbsp;have&nbsp;the&nbsp;same&nbsp;issue&nbsp;and&nbsp;know&nbsp;what&nbsp;happens&nbsp;exactly.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Skype&nbsp;initial&nbsp;connection&nbsp;site&nbsp;uses&nbsp;RC4&nbsp;cipher.&nbsp;Which&nbsp;is&nbsp;disabled&nbsp;in&nbsp;most&lt;br&gt;<br>
&gt;&gt;&nbsp;squid&#39;s&nbsp;configuration.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Your&nbsp;&quot;know&nbsp;what&nbsp;happens&nbsp;exactly&quot;&nbsp;differs&nbsp;from&nbsp;at&nbsp;least&nbsp;two&nbsp;other&nbsp;peoples&lt;br&gt;<br>
&gt;&nbsp;debugging&nbsp;experiences&nbsp;with&nbsp;Skype.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;RC4&nbsp;is&nbsp;on&nbsp;the&nbsp;hitlist&nbsp;for&nbsp;most&nbsp;of&nbsp;the&nbsp;big&nbsp;vendors&nbsp;for&nbsp;the&nbsp;past&nbsp;year&nbsp;or&lt;br&gt;<br>
&gt;&nbsp;so.&nbsp;IIRC&nbsp;there&nbsp;were&nbsp;several&nbsp;Windows&nbsp;Updates&nbsp;to&nbsp;remove&nbsp;it&nbsp;and&nbsp;other&lt;br&gt;<br>
&gt;&nbsp;broken&nbsp;bits&nbsp;from&nbsp;a&nbsp;lot&nbsp;of&nbsp;things&nbsp;over&nbsp;the&nbsp;past&nbsp;year.&lt;br&gt;<br>
&gt;&nbsp;If&nbsp;Skype&nbsp;is&nbsp;still&nbsp;using&nbsp;RC4&nbsp;it&nbsp;might&nbsp;be&nbsp;part&nbsp;of&nbsp;this&nbsp;problem.&lt;br&gt;<br>
&lt;/span&gt;I&#39;m&nbsp;sure&nbsp;this&nbsp;is&nbsp;problem&nbsp;and&nbsp;this&nbsp;problem&nbsp;exists.&nbsp;MS&nbsp;do&nbsp;nothing&nbsp;to&nbsp;make&lt;br&gt;<br>
they&nbsp;sites/services&nbsp;more&nbsp;secure.&nbsp;BTW,&nbsp;MS&nbsp;Updates&nbsp;uses&nbsp;RC4&nbsp;ciphers&nbsp;itself&lt;br&gt;<br>
this&nbsp;time.&nbsp;With&nbsp;strong&nbsp;siphers&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;setup&nbsp;WU&nbsp;via&nbsp;Squid.&lt;br&gt;<br>
I&#39;ve&nbsp;spent&nbsp;much&nbsp;time&nbsp;to&nbsp;identify&nbsp;this&nbsp;problem&nbsp;in&nbsp;my&nbsp;setup&nbsp;and&nbsp;find&lt;br&gt;<br>
working&nbsp;workaround.&lt;br&gt;<br>
&lt;br&gt;<br>
Another&nbsp;part&nbsp;of&nbsp;problem&nbsp;is:&nbsp;MS&nbsp;often&nbsp;uses&nbsp;it&#39;s&nbsp;own&nbsp;self-signed&nbsp;roots,&lt;br&gt;<br>
which&nbsp;is&nbsp;exists&nbsp;in&nbsp;Windows,&nbsp;but&nbsp;nowhere&nbsp;else.&nbsp;And&nbsp;which&nbsp;has&nbsp;not&lt;br&gt;<br>
cross-signed&nbsp;by&nbsp;well-known&nbsp;root&nbsp;CA&#39;s.&nbsp;They&nbsp;think&nbsp;it&nbsp;make&nbsp;MS&nbsp;services&lt;br&gt;<br>
more&nbsp;secure.&nbsp;They&nbsp;wrong.&nbsp;But&nbsp;we&nbsp;can&#39;t&nbsp;do&nbsp;anything&nbsp;with&nbsp;it.&nbsp;So,&nbsp;this&nbsp;is&lt;br&gt;<br>
forced&nbsp;us&nbsp;to&nbsp;add&nbsp;self-signed&nbsp;MS&nbsp;roots&nbsp;to&nbsp;our&nbsp;Squid&#39;s&nbsp;CA&nbsp;bundles&nbsp;to&lt;br&gt;<br>
bump/splice.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;To&nbsp;make&nbsp;it&nbsp;works&nbsp;(as&nbsp;by&nbsp;as&nbsp;most&nbsp;M$&nbsp;update&nbsp;sites)&nbsp;it&#39;s&nbsp;require&nbsp;simple&nbsp;use&lt;br&gt;<br>
&gt;&gt;&nbsp;this&nbsp;cipher&#39;s&nbsp;suite:&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;HIGH:MEDIUM:RC4:3DES:!aNULL:!eNULL:!LOW:!MD5:!EXP:!PSK:!SRP:!DSS&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;That&nbsp;works&nbsp;for&nbsp;me&nbsp;in&nbsp;5&nbsp;SSL&nbsp;bumped&nbsp;setups.&nbsp;There&nbsp;is&nbsp;no&nbsp;matter&nbsp;which&nbsp;squid&lt;br&gt;<br>
&gt;&gt;&nbsp;version&nbsp;installed.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Thank&nbsp;you.&nbsp;Thats&nbsp;another&nbsp;option&nbsp;then.&nbsp;I&#39;d&nbsp;rate&nbsp;that&nbsp;below&nbsp;trying&nbsp;the&nbsp;EC&lt;br&gt;<br>
&gt;&nbsp;ciphers,&nbsp;and&nbsp;above&nbsp;library&nbsp;updates.&lt;br&gt;<br>
&lt;/span&gt;You&nbsp;are&nbsp;welcome.&lt;br&gt;<br>
&lt;br&gt;<br>
Just&nbsp;for&nbsp;information:&nbsp;MS&nbsp;has&nbsp;own&nbsp;IT&nbsp;infrastructure,&nbsp;with&nbsp;some&nbsp;strange&lt;br&gt;<br>
configured&nbsp;and&nbsp;non&nbsp;well-managed&nbsp;elements.&nbsp;I&nbsp;can&#39;t&nbsp;guarantee&nbsp;this&lt;br&gt;<br>
workaround&nbsp;will&nbsp;work&nbsp;everywhere&nbsp;or&nbsp;for&nbsp;every&nbsp;MS&nbsp;service.&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;I&nbsp;made&nbsp;my&nbsp;research,&nbsp;I&#39;ve&nbsp;seen&nbsp;some&nbsp;strange&nbsp;security&nbsp;TLS&lt;br&gt;<br>
combinations&nbsp;on&nbsp;MS&nbsp;sites/services.&nbsp;I.e.,&nbsp;for&nbsp;example,&nbsp;RC4+ECDSA+TLSv1.2.&lt;br&gt;<br>
Or,&nbsp;for&nbsp;example,&nbsp;RC4+MD5+TLSv1.&nbsp;And&nbsp;some&nbsp;similar.&nbsp;Very&nbsp;idiotic&nbsp;and&lt;br&gt;<br>
potentially&nbsp;dangerous&nbsp;combinations.&nbsp;And&nbsp;-&nbsp;they&nbsp;support&nbsp;ignores&nbsp;all&lt;br&gt;<br>
requests.&nbsp;As&nbsp;usual.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;my&nbsp;regret,&nbsp;I&nbsp;can&nbsp;not&nbsp;order&nbsp;all&nbsp;of&nbsp;its&nbsp;users&nbsp;to&nbsp;abandon&nbsp;the&nbsp;use&nbsp;of&lt;br&gt;<br>
Windows.&nbsp;So&nbsp;far,&nbsp;in&nbsp;my&nbsp;infrastructure&nbsp;have&nbsp;machines&nbsp;with&nbsp;Windows&nbsp;XP.&lt;br&gt;<br>
&lt;br&gt;<br>
With&nbsp;this&nbsp;nothing&nbsp;can&nbsp;be&nbsp;done,&nbsp;it&nbsp;is&nbsp;necessary&nbsp;only&nbsp;to&nbsp;weaken&nbsp;the&lt;br&gt;<br>
security&nbsp;-&nbsp;for&nbsp;the&nbsp;sake&nbsp;of&nbsp;compatibility.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Amos&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----&lt;br&gt;<br>
Version:&nbsp;GnuPG&nbsp;v2&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;iQEcBAEBCAAGBQJXbsC5AAoJENNXIZxhPexGiFoH/jrtimBNppF1uHpVTNwOO10z&lt;br&gt;<br>
yF2APMA56S8woNZzhUNjT8+oJFPrthnMoQFrqgicjS77SBAFp9KcOV+SxOKl9+sW&lt;br&gt;<br>
OdAHDPuCD7dGnKzAdFDR1YR7Vp5IpElP1rFO5rqKXeBc3iKjq65BfF+T6atHy6cS&lt;br&gt;<br>
0VAaluvqvHQps2wVKoYxGURDf3Y2K0lJn+qF+s2CaBwEufhzgKSvG0aUIDqTfHfK&lt;br&gt;<br>
3EMQTpPtlTqm+pcexR+oZM1WE1hlES1khOXs51fgo6puPryqWJiHGvO4EBEfWoXF&lt;br&gt;<br>
Skval2COzcdzMvC5jjfGbMEPNGNJrYUeq/KNgppRvE2wQJ+gCLYG317decKHty0=&lt;br&gt;<br>
=8BTp&lt;br&gt;<br>
-----END&nbsp;PGP&nbsp;SIGNATURE-----&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
