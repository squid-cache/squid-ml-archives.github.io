<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNED&nbsp;MESSAGE-----&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hash:&nbsp;SHA256&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;07.07.2016&nbsp;19:59,&nbsp;Marcus&nbsp;Kool&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;On&nbsp;07/07/2016&nbsp;10:49&nbsp;AM,&nbsp;Yuri&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;A&nbsp;similar&nbsp;question&nbsp;can&nbsp;be&nbsp;asked<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;about&nbsp;SNI&nbsp;names&nbsp;containing&nbsp;unusual&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;characters.&nbsp;At&nbsp;some&nbsp;point,&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;would&nbsp;be&nbsp;too&nbsp;dangerous&nbsp;to&nbsp;include&nbsp;SNI&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;information&nbsp;in&nbsp;the&nbsp;fake&nbsp;CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;because&nbsp;it&nbsp;will&nbsp;interfere&nbsp;with&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;HTTP&nbsp;rules,&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;clear<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;that&nbsp;point&nbsp;is&nbsp;exactly.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;To&nbsp;support&nbsp;the&nbsp;weirdest&nbsp;apps&nbsp;Squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;might&nbsp;have&nbsp;to&nbsp;simply&nbsp;copy&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;unusual&nbsp;characters&nbsp;to&nbsp;present&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same&nbsp;parameter&nbsp;values&nbsp;to&nbsp;the&nbsp;server.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;It&nbsp;is&nbsp;being&nbsp;mapped&nbsp;into&nbsp;the&nbsp;HTTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equivalent&nbsp;value.&nbsp;Which&nbsp;are&nbsp;Host:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;header&nbsp;and&nbsp;authority-URI.&nbsp;Only&nbsp;valid&nbsp;FQDN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names&nbsp;can&nbsp;make&nbsp;it&nbsp;through&nbsp;the&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;mapping.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&nbsp;Here&nbsp;things&nbsp;get&nbsp;complicated.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&nbsp;It&nbsp;is&nbsp;correct&nbsp;that&nbsp;Squid&nbsp;enforces&nbsp;apps&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;follow&nbsp;standards&nbsp;or&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&gt;&nbsp;should&nbsp;Squid&nbsp;try&nbsp;to&nbsp;proxy&nbsp;connections&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apps&nbsp;when&nbsp;it&nbsp;can?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&nbsp;Squid&nbsp;isn't&nbsp;enforcing&nbsp;standards&nbsp;here.&nbsp;As&nbsp;Steve<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;original&nbsp;messge&nbsp;says&nbsp;it:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&nbsp;&quot;generates&nbsp;a&nbsp;&quot;CONNECT&nbsp;*.example.com:443&quot;&nbsp;request<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;based&nbsp;on&nbsp;the&nbsp;peeked&nbsp;SNI&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;  &nbsp;-&nbsp;which&nbsp;is&nbsp;arguably&nbsp;invalid&nbsp;HTTP&nbsp;syntax,&nbsp;but&nbsp;oh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;well.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&nbsp;It&nbsp;then&nbsp;is&nbsp;unable&nbsp;to&nbsp;do&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*.example.com&nbsp;to&nbsp;find&nbsp;out&nbsp;what&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&nbsp;its&nbsp;IPs&nbsp;are&nbsp;and&nbsp;does&nbsp;the&nbsp;error&nbsp;handling&nbsp;action<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;a&nbsp;failure&nbsp;to&nbsp;verify&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&gt;&nbsp;on&nbsp;a&nbsp;CONNECT&nbsp;message.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;yes,&nbsp;the&nbsp;fake&nbsp;CONNECT&nbsp;is&nbsp;dealt&nbsp;with&nbsp;like&nbsp;a&nbsp;regular<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNECT&nbsp;including&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;DNS&nbsp;lookup. &nbsp;I&nbsp;fear&nbsp;for&nbsp;other&nbsp;apps&nbsp;(besides&nbsp;the&nbsp;one<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ios&nbsp;app&nbsp;that&nbsp;Steve&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;refers&nbsp;to)&nbsp;to&nbsp;break&nbsp;because&nbsp;Squid&nbsp;may&nbsp;connect&nbsp;to&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;different&nbsp;IP&nbsp;than&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;the&nbsp;client/app&nbsp;is&nbsp;requesting.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;If&nbsp;Squid&nbsp;uses&nbsp;the&nbsp;original&nbsp;IP&nbsp;to&nbsp;connect&nbsp;without<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doing&nbsp;a&nbsp;DNS&nbsp;lookup,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;Steve's&nbsp;app&nbsp;will&nbsp;work&nbsp;and&nbsp;potential&nbsp;issues&nbsp;with&nbsp;other<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apps&nbsp;are&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;&nbsp;prevented.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&nbsp;Interestingly,&nbsp;Marcus.&nbsp;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;the&nbsp;CDN&nbsp;may&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at&nbsp;different&nbsp;points&nbsp;in&nbsp;time&nbsp;different&nbsp;IP&nbsp;connection&nbsp;and&nbsp;it&nbsp;makes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;impossible&nbsp;for&nbsp;client&nbsp;connections&nbsp;through&nbsp;Squid?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;It&nbsp;all&nbsp;depends&nbsp;on&nbsp;the&nbsp;app/client:&nbsp;if&nbsp;it&nbsp;uses&nbsp;a&nbsp;servername/SNI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;resolves&nbsp;to&nbsp;multiple&nbsp;IP&nbsp;addresses&nbsp;but&nbsp;needs&nbsp;to&nbsp;connect&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;that&nbsp;it&nbsp;specifically&nbsp;wants&nbsp;to&nbsp;CONNECT&nbsp;to,&nbsp;the&nbsp;app&nbsp;can&nbsp;fail<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Squid&nbsp;might&nbsp;choose&nbsp;an&nbsp;other&nbsp;IP&nbsp;address&nbsp;to&nbsp;connect&nbsp;to.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Or,&nbsp;apps&nbsp;might&nbsp;become&nbsp;slow&nbsp;since&nbsp;it&nbsp;might&nbsp;be&nbsp;faster&nbsp;when&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reconnects&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;to&nbsp;the&nbsp;same&nbsp;server&nbsp;that&nbsp;it&nbsp;connected&nbsp;to&nbsp;before.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;I&nbsp;think&nbsp;it&nbsp;is&nbsp;best&nbsp;to&nbsp;prevent&nbsp;issues&nbsp;and&nbsp;that&nbsp;Squid&nbsp;should<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;to&nbsp;the&nbsp;IP&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;trying&nbsp;to&nbsp;connect&nbsp;to.&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;suggests,&nbsp;devs&nbsp;will&nbsp;say&nbsp;this&nbsp;is&nbsp;not&nbsp;secure.&nbsp;Client&nbsp;can&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;compromised&nbsp;etc.etc.etc.&nbsp;:)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;Marcus&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;GnuPG&nbsp;v2<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;iQEcBAEBCAAGBQJXfmvzAAoJENNXIZxhPexGQwMIALkYjQH8ke4R44oINkzQfqGR<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;j5VtmMRfSlcYn82Xe7D4UzkjcGytYDiJJg+0VTsVgPxphgAcKXDP/Tx3lxTpP09e<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;8w3pmTU5TmgYUNvuZqheSn+Zhsp4lLUN0rj2VwIZZPueMWA6Ypre7YC7vRscEluj<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;h9p3ZA6LTmj7NpSehWcxPKDxQdJ5HEIMRjzOyXWMJRvjwYU9s55xKYfHy5ZjSGV4<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bF87d8Tg746sh+jcje6BpJBKOVNp8ImyxfjI6eFSVAjBsUpeZPa3yb2uq1LunZi1<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;t50q1C0P93FcqC8SipPcIM/azDEu08VrByG01x12zjgRqMVuIeMkMcvJOT3WVKY=<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;=0ect<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-----END&nbsp;PGP&nbsp;SIGNATURE-----<br>
&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
