<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;have&nbsp;a&nbsp;freshly&nbsp;installed&nbsp;Squid&nbsp;from&nbsp;source&nbsp;on&nbsp;a&nbsp;likewise&nbsp;freshly&nbsp;installed&nbsp;OpenBSD&nbsp;system.&nbsp;Attempting&nbsp;to&nbsp;replace&nbsp;an&nbsp;aging&nbsp;stub&nbsp;Squid&nbsp;on&nbsp;Linux&nbsp;with&nbsp;transparent&nbsp;with&nbsp;SSLBump.&nbsp;I&nbsp;think&nbsp;I&nbsp;have&nbsp;everything&nbsp;set&nbsp;up&nbsp;pretty&nbsp;skookup,&nbsp;the&nbsp;symptom&nbsp;is&nbsp;it&nbsp;just&nbsp;isn&#39;t&nbsp;working.&nbsp;When&nbsp;I&nbsp;browse&nbsp;to&nbsp;an&nbsp;https&nbsp;website&nbsp;I&nbsp;get&nbsp;presented&nbsp;my&nbsp;root&nbsp;cert,&nbsp;but&nbsp;not&nbsp;a&nbsp;dynamically&nbsp;created&nbsp;cert&nbsp;underneath.&nbsp;It&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;they&#39;re&nbsp;being&nbsp;created&nbsp;as&nbsp;the&nbsp;folder&nbsp;hierarchy&nbsp;that&#39;s&nbsp;supposed&nbsp;to&nbsp;contain&nbsp;the&nbsp;dynamic&nbsp;certs&nbsp;remains&nbsp;empty.&nbsp;Note&nbsp;that&nbsp;as&nbsp;of&nbsp;yet&nbsp;this&nbsp;is&nbsp;not&nbsp;in&nbsp;a&nbsp;transparent&nbsp;configuration&nbsp;-&nbsp;choosing&nbsp;to&nbsp;crawl&nbsp;before&nbsp;I&nbsp;walk.&nbsp;Here&nbsp;is&nbsp;some&nbsp;perhaps&nbsp;useful&nbsp;info&nbsp;from&nbsp;the&nbsp;system:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;uname&nbsp;-a &lt;/div&gt;&lt;div&gt;OpenBSD&nbsp;router.example.local&nbsp;5.9&nbsp;GENERIC#1761&nbsp;amd64&lt;/div&gt;&lt;div&gt;#&nbsp;/usr/local/squid/sbin/squid&nbsp;-v&lt;/div&gt;&lt;div&gt;Squid&nbsp;Cache:&nbsp;Version&nbsp;3.5.20&lt;/div&gt;&lt;div&gt;Service&nbsp;Name:&nbsp;squid&lt;/div&gt;&lt;div&gt;configure&nbsp;options:&nbsp; &#39;--enable-icmp&#39;&nbsp;&#39;--enable-delay-pools&#39;&nbsp;&#39;--enable-pf-transparent&#39;&nbsp;&#39;--enable-ssl-crtd&#39;&nbsp;&#39;--enable-auth&#39;&nbsp;&#39;--with-openssl&#39;&nbsp;--enable-ltdl-convenience&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;ps&nbsp;-waux&nbsp;|&nbsp;grep&nbsp;squid&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; &nbsp;2604&nbsp;10.9&nbsp; 1.4&nbsp;17060&nbsp;14840&nbsp;?? &nbsp;R&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:03.11&nbsp;(squid-1)&nbsp;(squid)&lt;/div&gt;&lt;div&gt;root&nbsp; &nbsp; &nbsp;28389&nbsp; 0.0&nbsp; 0.2&nbsp;10608&nbsp; 2548&nbsp;?? &nbsp;Ss&nbsp; &nbsp; &nbsp;5:16PM&nbsp; &nbsp; 0:00.06&nbsp;/usr/local/squid/sbin/squid&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 17905&nbsp; 0.0&nbsp; 0.3&nbsp; &nbsp;688&nbsp; 3496&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.10&nbsp;(ssl_crtd)&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&nbsp;(ssl_crtd)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 21985&nbsp; 0.0&nbsp; 0.3&nbsp; &nbsp;680&nbsp; 3460&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.05&nbsp;(ssl_crtd)&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&nbsp;(ssl_crtd)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 20149&nbsp; 0.1&nbsp; 0.3&nbsp; &nbsp;676&nbsp; 3468&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.04&nbsp;(ssl_crtd)&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&nbsp;(ssl_crtd)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; &nbsp;8313&nbsp; 0.0&nbsp; 0.3&nbsp; &nbsp;688&nbsp; 3488&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.03&nbsp;(ssl_crtd)&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&nbsp;(ssl_crtd)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 11338&nbsp; 0.0&nbsp; 0.3&nbsp; &nbsp;688&nbsp; 3488&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.04&nbsp;(ssl_crtd)&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&nbsp;(ssl_crtd)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 23712&nbsp; 0.0&nbsp; 0.2&nbsp; &nbsp;448&nbsp; 1580&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.06&nbsp;(logfile-daemon)&nbsp;/var/log/squid/access.log&nbsp;(log_file_daemon)&lt;/div&gt;&lt;div&gt;squid&nbsp; &nbsp; 20208&nbsp; 0.0&nbsp; 0.1&nbsp; &nbsp;324&nbsp; 1448&nbsp;?? &nbsp;S&nbsp; &nbsp; &nbsp; 5:16PM&nbsp; &nbsp; 0:00.02&nbsp;(unlinkd)&nbsp;(unlinkd)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;grep&nbsp;-i&nbsp;ssl&nbsp;/var/log/squid/cache.log &lt;br&gt;&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.370&nbsp;kid1|&nbsp;83,7|&nbsp;bio.cc(168)&nbsp;stateChanged:&nbsp;FD&nbsp;12&nbsp;now:&nbsp;0x20&nbsp;SSLOK&nbsp; (SSL&nbsp;negotiation&nbsp;finished&nbsp;successfully)&lt;/div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.370&nbsp;kid1|&nbsp;83,7|&nbsp;bio.cc(168)&nbsp;stateChanged:&nbsp;FD&nbsp;12&nbsp;now:&nbsp;0x2002&nbsp;SSLOK&nbsp; (SSL&nbsp;negotiation&nbsp;finished&nbsp;successfully)&lt;/div&gt;&lt;div&gt;-----BEGIN&nbsp;SSL&nbsp;SESSION&nbsp;PARAMETERS-----&lt;/div&gt;&lt;div&gt;-----END&nbsp;SSL&nbsp;SESSION&nbsp;PARAMETERS-----&lt;/div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.370&nbsp;kid1|&nbsp;83,2|&nbsp;client_side.cc(3809)&nbsp;clientNegotiateSSL:&nbsp;clientNegotiateSSL:&nbsp;New&nbsp;session&nbsp;0x38985389200&nbsp;on&nbsp;FD&nbsp;12&nbsp;(&lt;a&nbsp;href=&quot;http://172.22.19.48:65433&quot;&gt;172.22.19.48:65433&lt;/a&gt;)&lt;/div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.370&nbsp;kid1|&nbsp;83,3|&nbsp;client_side.cc(3813)&nbsp;clientNegotiateSSL:&nbsp;clientNegotiateSSL:&nbsp;FD&nbsp;12&nbsp;negotiated&nbsp;cipher&nbsp;AES128-SHA&lt;/div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.371&nbsp;kid1|&nbsp;83,5|&nbsp;client_side.cc(3829)&nbsp;clientNegotiateSSL:&nbsp;clientNegotiateSSL:&nbsp;FD&nbsp;12&nbsp;has&nbsp;no&nbsp;certificate.&lt;/div&gt;&lt;div&gt;2016/08/01&nbsp;16:54:54.426&nbsp;kid1|&nbsp;85,5|&nbsp;client_side_request.cc(1438)&nbsp;sslBumpAccessCheck:&nbsp;cannot&nbsp;SslBump&nbsp;this&nbsp;request&lt;/div&gt;&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;grep&nbsp;-v&nbsp;^#&nbsp;/usr/local/squid/etc/squid.conf&nbsp;|&nbsp;grep&nbsp;-v&nbsp;^[\s]*$&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp; &nbsp; &nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp; #&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; #&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;/div&gt;&lt;div&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;ftp&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;https&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;gopher&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;wais&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp; #&nbsp;unregistered&nbsp;ports&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;http-mgmt&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;gss-http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;filemaker&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;multiling&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;bump&nbsp;all&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localnet&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/usr/local/squid/etc/ssl/CA.pem&lt;/div&gt;&lt;div&gt;cache_dir&nbsp;ufs&nbsp;/var/cache/squid&nbsp;4000&nbsp;16&nbsp;256&lt;/div&gt;&lt;div&gt;coredump_dir&nbsp;/var/cache/squid&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^ftp:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1440&nbsp; &nbsp; 20%&nbsp; &nbsp; &nbsp;10080&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^gopher:&nbsp; &nbsp; &nbsp; &nbsp; 1440&nbsp; &nbsp; 0%&nbsp; &nbsp; &nbsp; 1440&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp; &nbsp; &nbsp;0%&nbsp; &nbsp; &nbsp; 0&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;20%&nbsp; &nbsp; &nbsp;4320&lt;/div&gt;&lt;div&gt;cache_effective_user&nbsp;squid&lt;/div&gt;&lt;div&gt;cache_effective_group&nbsp;squid&lt;/div&gt;&lt;div&gt;access_log&nbsp;daemon:/var/log/squid/access.log&nbsp;squid&lt;/div&gt;&lt;div&gt;cache_log&nbsp;/var/log/squid/cache.log&lt;/div&gt;&lt;div&gt;sslcrtd_program&nbsp;/usr/local/squid/libexec/ssl_crtd&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;/div&gt;&lt;div&gt;sslcrtd_children&nbsp;10&lt;/div&gt;&lt;div&gt;debug_options&nbsp;ALL,9&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;ls&nbsp;-lR&nbsp;/usr/local/squid/var/lib/&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;&lt;div&gt;total&nbsp;4&lt;/div&gt;&lt;div&gt;drwxr-xr-x&nbsp; 3&nbsp;squid&nbsp; wheel&nbsp; 512&nbsp;Jul&nbsp;23&nbsp;18:38&nbsp;ssl_db&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;/usr/local/squid/var/lib/ssl_db:&lt;/div&gt;&lt;div&gt;total&nbsp;8&lt;/div&gt;&lt;div&gt;drwxr-xr-x&nbsp; 2&nbsp;squid&nbsp; wheel&nbsp; 512&nbsp;Jul&nbsp;23&nbsp;18:38&nbsp;certs&lt;/div&gt;&lt;div&gt;-rw-r--r--&nbsp; 1&nbsp;squid&nbsp; wheel&nbsp; &nbsp; 0&nbsp;Jul&nbsp;23&nbsp;18:38&nbsp;index.txt&lt;/div&gt;&lt;div&gt;-rw-r--r--&nbsp; 1&nbsp;squid&nbsp; wheel&nbsp; &nbsp; 1&nbsp;Jul&nbsp;23&nbsp;18:38&nbsp;size&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;line-height:1.5&quot;&gt;Any&nbsp;advice&nbsp;would&nbsp;be&nbsp;much&nbsp;appreciated.&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
