<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Wed,&nbsp;Aug&nbsp;3,&nbsp;2016&nbsp;at&nbsp;9:14&nbsp;AM&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;08/02/2016&nbsp;09:53&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;To&nbsp;do&nbsp;bumping&nbsp;with&nbsp;server&nbsp;certificate&nbsp;mimic&nbsp;you&nbsp;need&nbsp;the&nbsp;&#39;bump&#39;&nbsp;action&lt;br&gt;<br>
&gt;&nbsp;to&nbsp;occur&nbsp;at&nbsp;#3.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;clarification.&nbsp;I&nbsp;probably&nbsp;read&nbsp;that&nbsp;100&nbsp;times&nbsp;in&nbsp;the&nbsp;documentation&nbsp;but&nbsp;it&nbsp;didn&#39;t&nbsp;really&nbsp;sink&nbsp;in&nbsp;until&nbsp;today&nbsp;how&nbsp;that&nbsp;all&nbsp;works.&nbsp;To&nbsp;be&nbsp;brutally&nbsp;honest&nbsp;the&nbsp;whole&nbsp;concept&nbsp;is&nbsp;still&nbsp;a&nbsp;bit&nbsp;lost&nbsp;on&nbsp;me,&nbsp;but&nbsp;I&nbsp;can&nbsp;make&nbsp;sense&nbsp;that&nbsp;you&nbsp;have&nbsp;to&nbsp;perform&nbsp;the&nbsp;SNI&nbsp;CONNECT&nbsp;bits&nbsp;before&nbsp;you&nbsp;can&nbsp;actually&nbsp;bump.&nbsp;My&nbsp;apologies&nbsp;for&nbsp;the&nbsp;earlier&nbsp;misunderstanding...&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Like:&lt;br&gt;<br>
&gt; &nbsp;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&gt; &nbsp;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;br&gt;<br>
&gt; &nbsp;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;<br>
&gt; &nbsp;ssl_bump&nbsp;stare&nbsp;step2&lt;br&gt;<br>
&gt; &nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;(or&nbsp;maybe&nbsp;stare&nbsp;and&nbsp;both&nbsp;non-3&nbsp;steps.&nbsp;I&#39;m&nbsp;not&nbsp;100%&nbsp;certain&nbsp;there.).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Yes,&nbsp;all&nbsp;of&nbsp;the&nbsp;above&nbsp;can&nbsp;be&nbsp;polished&nbsp;and&nbsp;simplified&nbsp;to&nbsp;become&nbsp;just&nbsp;two&lt;br&gt;<br>
lines:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;ssl_bump&nbsp;stare&nbsp;all&lt;br&gt;<br>
 &nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;still&nbsp;having&nbsp;issues&nbsp;I&#39;m&nbsp;afraid&nbsp;-&nbsp;albeit&nbsp;different&nbsp;issues.&nbsp;My&nbsp;problem&nbsp;now&nbsp;reads&nbsp;a&nbsp;lot&nbsp;like&nbsp;this&nbsp;guys&nbsp;issue:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://www.mail-archive.com/misc@openbsd.org/msg144692.html&quot;&gt;https://www.mail-archive.com/misc@openbsd.org/msg144692.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;did&nbsp;however&nbsp;perform&nbsp;the&nbsp;step&nbsp;he&nbsp;did&nbsp;to&nbsp;rectify&nbsp;his&nbsp;issue&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;having&nbsp;any&nbsp;effect&nbsp;for&nbsp;me&nbsp;I&#39;m&nbsp;afraid.&nbsp;My&nbsp;browser&nbsp;just&nbsp;times&nbsp;out&nbsp;and&nbsp;no&nbsp;auto-generated&nbsp;certificate&nbsp;is&nbsp;ever&nbsp;generated.&nbsp;I&#39;ve&nbsp;combed&nbsp;through&nbsp;a&nbsp;number&nbsp;of&nbsp;configurations&nbsp;on&nbsp;the&nbsp;Internet&nbsp;at&nbsp;this&nbsp;point&nbsp;and&nbsp;I&#39;m&nbsp;not&nbsp;seeing&nbsp;how&nbsp;mine&nbsp;is&nbsp;terribly&nbsp;different&nbsp;from&nbsp;anyone&nbsp;else&#39;s&nbsp;who&nbsp;is&nbsp;having&nbsp;success.&nbsp;For&nbsp;the&nbsp;sake&nbsp;of&nbsp;completeness&nbsp;I&#39;ll&nbsp;post&nbsp;my&nbsp;configuration&nbsp;as&nbsp;it&nbsp;stands&nbsp;today:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; #&nbsp;grep&nbsp;-v&nbsp;^[\s]*$&nbsp;/usr/local/squid/etc/squid.conf&nbsp;|&nbsp;grep&nbsp;-v&nbsp;^#&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp; &nbsp; &nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp; #&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;/div&gt;&lt;div&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; #&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;/div&gt;&lt;div&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;ftp&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;https&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;gopher&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;wais&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp; #&nbsp;unregistered&nbsp;ports&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;http-mgmt&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;gss-http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;filemaker&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;multiling&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localnet&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;stare&nbsp;all&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;bump&nbsp;all&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/usr/local/squid/etc/ssl/gzgtgCA.pem&lt;/div&gt;&lt;div&gt;cache_dir&nbsp;ufs&nbsp;/var/cache/squid&nbsp;4000&nbsp;16&nbsp;256&lt;/div&gt;&lt;div&gt;coredump_dir&nbsp;/var/cache/squid&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^ftp:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1440&nbsp; &nbsp; 20%&nbsp; &nbsp; &nbsp;10080&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^gopher:&nbsp; &nbsp; &nbsp; &nbsp; 1440&nbsp; &nbsp; 0%&nbsp; &nbsp; &nbsp; 1440&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp; &nbsp; &nbsp;0%&nbsp; &nbsp; &nbsp; 0&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;20%&nbsp; &nbsp; &nbsp;4320&lt;/div&gt;&lt;div&gt;sslproxy_cert_error&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&gt;sslproxy_flags&nbsp;DONT_VERIFY_PEER&lt;/div&gt;&lt;div&gt;sslproxy_cert_sign&nbsp;signTrusted&lt;/div&gt;&lt;div&gt;cache_effective_user&nbsp;squid&lt;/div&gt;&lt;div&gt;cache_effective_group&nbsp;squid&lt;/div&gt;&lt;div&gt;access_log&nbsp;daemon:/var/log/squid/access.log&nbsp;squid&lt;/div&gt;&lt;div&gt;cache_log&nbsp;/var/log/squid/cache.log&lt;/div&gt;&lt;div&gt;sslcrtd_program&nbsp;/usr/local/squid/libexec/ssl_crtd&nbsp;-s&nbsp;/usr/local/squid/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;/div&gt;&lt;div&gt;sslcrtd_children&nbsp;10&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;tried&nbsp;various&nbsp;different&nbsp;combinations&nbsp;of&nbsp;ssl_bump&nbsp;directives&nbsp;including&nbsp;adding&nbsp;the&nbsp;step_1&nbsp;and&nbsp;step_2&nbsp;ACLs&nbsp;as&nbsp;suggested&nbsp;by&nbsp;Amos&nbsp;(verbatim),&nbsp;and&nbsp;additionally&nbsp;(again&nbsp;verbatim)&nbsp;the&nbsp;configuration&nbsp;outlined&nbsp;on&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://squid-cache.org&quot;&gt;squid-cache.org&lt;/a&gt;&nbsp;site,&nbsp;but&nbsp;at&nbsp;this&nbsp;point&nbsp;the&nbsp;only&nbsp;behavior&nbsp;I&#39;m&nbsp;getting&nbsp;out&nbsp;of&nbsp;the&nbsp;system&nbsp;is&nbsp;that&nbsp;which&nbsp;I&#39;ve&nbsp;described.&nbsp;I&nbsp;have&nbsp;also&nbsp;tried&nbsp;both&nbsp;peeking&nbsp;and&nbsp;staring,&nbsp;as&nbsp;I&nbsp;understand&nbsp;the&nbsp;use&nbsp;case&nbsp;for&nbsp;my&nbsp;environment&nbsp;stare&nbsp;would&nbsp;be&nbsp;most&nbsp;appropriate,&nbsp;however&nbsp;neither&nbsp;seem&nbsp;to&nbsp;be&nbsp;working&nbsp;for&nbsp;me&nbsp;at&nbsp;this&nbsp;point&nbsp;so&nbsp;it&#39;s&nbsp;moot.&nbsp;I&#39;ve&nbsp;turned&nbsp;off&nbsp;the&nbsp;debugging&nbsp;as&nbsp;I&nbsp;wasn&#39;t&nbsp;getting&nbsp;anything&nbsp;terribly&nbsp;useful&nbsp;out&nbsp;of&nbsp;it.&nbsp;I&nbsp;could&nbsp;see&nbsp;CONNECTs&nbsp;to&nbsp;the&nbsp;https&nbsp;sites,&nbsp;and&nbsp;mentions&nbsp;that&nbsp;they&nbsp;qualified&nbsp;for&nbsp;stare&nbsp;or&nbsp;bump,&nbsp;but&nbsp;never&nbsp;did&nbsp;it&nbsp;seem&nbsp;to&nbsp;actually&nbsp;happen.&nbsp;If&nbsp;anyone&nbsp;has&nbsp;anything&nbsp;that&nbsp;I&nbsp;should&nbsp;grep&nbsp;for&nbsp;in&nbsp;debug&nbsp;logs&nbsp;to&nbsp;maybe&nbsp;help&nbsp;I&#39;d&nbsp;be&nbsp;happy&nbsp;to&nbsp;oblige.&nbsp;Perhaps&nbsp;I&nbsp;should&nbsp;just&nbsp;abandon&nbsp;OpenBSD&nbsp;and&nbsp;move&nbsp;to&nbsp;a&nbsp;more&nbsp;common&nbsp;flavor&nbsp;of&nbsp;*nix&nbsp;-&nbsp;although&nbsp;I&nbsp;will&nbsp;miss&nbsp;PF.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;help.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
