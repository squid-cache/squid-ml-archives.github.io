<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&nbsp;have&nbsp;successfully&nbsp;gotten&nbsp;Squid&nbsp;3.5.20&nbsp;to&nbsp;filter&nbsp;both&nbsp;HTTP&nbsp;and&nbsp;HTTPS&nbsp;in&nbsp;transparent&nbsp;intercept&nbsp;mode.&nbsp;With&nbsp;intercept&nbsp;mode,&nbsp;iptables&nbsp;rules&nbsp;redirect&nbsp;port&nbsp;80&nbsp;to&nbsp;squid&#39;sÂ http_port&nbsp;800&nbsp;and&nbsp;HTTPS&nbsp;port&nbsp;443&nbsp;is&nbsp;redirected&nbsp;to&nbsp;Squid&#39;s&nbsp;https_port&nbsp;801.&nbsp;It&nbsp;all&nbsp;seems&nbsp;to&nbsp;work&nbsp;exactly&nbsp;as&nbsp;it&nbsp;should.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;recently&nbsp;been&nbsp;trying&nbsp;to&nbsp;integrate&nbsp;a&nbsp;urlfilter&nbsp;using&nbsp;url_redirect_program&nbsp;with&nbsp;my&nbsp;Squid&nbsp;implementation,&nbsp;and&nbsp;that&nbsp;works&nbsp;very&nbsp;well,&nbsp;also.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;problem:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;of&nbsp;the&nbsp;useful&nbsp;features&nbsp;of&nbsp;the&nbsp;urlfilter&nbsp;is&nbsp;that&nbsp;it&nbsp;detects&nbsp;proxy&nbsp;tunnels&nbsp;and&nbsp;blocks&nbsp;them.&nbsp;Not&nbsp;being&nbsp;very&nbsp;proficient&nbsp;in&nbsp;the&nbsp;use&nbsp;of&nbsp;proxy&nbsp;tunnels&nbsp;and&nbsp;VPNs&nbsp;I&nbsp;wanted&nbsp;to&nbsp;test&nbsp;it&nbsp;out.&nbsp;I&nbsp;setup&nbsp;a&nbsp;VPN&nbsp;client&nbsp;(CyberGhost&nbsp;VPN)&nbsp;on&nbsp;my&nbsp;Linux&nbsp;client&nbsp;connected&nbsp;to&nbsp;my&nbsp;firewall&nbsp;with&nbsp;the&nbsp;Squid&nbsp;implementation&nbsp;and&nbsp;could&nbsp;successfully&nbsp;establish&nbsp;a&nbsp;VPN&nbsp;connection&nbsp;&lt;strong&gt;&lt;em&gt;via&nbsp;port&nbsp;443&lt;/em&gt;&lt;/strong&gt;&nbsp;when&nbsp;Squid&nbsp;and&nbsp;the&nbsp;URL&nbsp;Filter&nbsp;were&nbsp;disabled.&nbsp;After&nbsp;disconnecting&nbsp;the&nbsp;VPN&nbsp;and&nbsp;enabling&nbsp;Squid&nbsp;and&nbsp;the&nbsp;urlfilter,&nbsp;attempting&nbsp;to&nbsp;connect&nbsp;using&nbsp;the&nbsp;VPN&nbsp;over&nbsp;443&nbsp;failed&nbsp;to&nbsp;connect.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;that&nbsp;actually&nbsp;might&nbsp;be&nbsp;a&nbsp;good&nbsp;thing&nbsp;because&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;block&nbsp;it&nbsp;anyway.&nbsp;But&nbsp;the&nbsp;block&nbsp;is&nbsp;an&nbsp;error&nbsp;and&nbsp;not&nbsp;in&nbsp;the&nbsp;manner&nbsp;that&nbsp;is&nbsp;expected.&nbsp;It&nbsp;is&nbsp;blocked,&nbsp;it&nbsp;seems,&nbsp;because&nbsp;the&nbsp;redirection&nbsp;of&nbsp;port&nbsp;443&nbsp;to&nbsp;Squid&nbsp;causes&nbsp;Squid&nbsp;to&nbsp;barf&nbsp;on&nbsp;the&nbsp;VPN&nbsp;because&nbsp;the&nbsp;VPN,&nbsp;while&nbsp;using&nbsp;port&nbsp;443&nbsp;is&nbsp;not&nbsp;a&nbsp;TLS/SSL&nbsp;encrypted&nbsp;connection&nbsp;and&nbsp;Squid&nbsp;doesn&#39;t&nbsp;seem&nbsp;to&nbsp;know&nbsp;what&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;connection.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;tell&nbsp;Squid&nbsp;that&nbsp;there&nbsp;may&nbsp;be&nbsp;port&nbsp;443&nbsp;connections&nbsp;that&nbsp;don&#39;t&nbsp;use&nbsp;TLS/SSL&nbsp;so&nbsp;that&nbsp;a&nbsp;useful&nbsp;message&nbsp;could&nbsp;be&nbsp;generated&nbsp;other&nbsp;than&nbsp;the&nbsp;&quot;connection&nbsp;failed&quot;&nbsp;message&nbsp;the&nbsp;VPN&nbsp;client&nbsp;gives?&nbsp;There&nbsp;are&nbsp;error&nbsp;messages&nbsp;in&nbsp;the&nbsp;Squid&nbsp;cache.log&nbsp;about&nbsp;connection&nbsp;attempts&nbsp;failed&nbsp;because&nbsp;of&nbsp;problems&nbsp;with&nbsp;TLS/SSL&nbsp;and&nbsp;certs.&lt;/div&gt;&lt;/div&gt;<br>

</tt>
