<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;In&nbsp;my&nbsp;Windows&nbsp;workstations&nbsp;the&nbsp;authentication&nbsp;works&nbsp;correctly,&nbsp;however&nbsp;in&nbsp;Ubuntu&nbsp;14.04&nbsp;the&nbsp;user&nbsp;and&nbsp;password&nbsp;are&nbsp;asked&nbsp;twice.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;using&nbsp;the&nbsp;basic_ncsa_auth&nbsp;with&nbsp;Squid&nbsp;3.4.8&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;any&nbsp;setting&nbsp;that&nbsp;I&nbsp;do&nbsp;in&nbsp;Squid?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Bellow&nbsp;is&nbsp;my&nbsp;squid.conf&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Configuracoes&nbsp;Basicas&lt;/div&gt;&lt;div&gt;http_port&nbsp;3128&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#debug_options&nbsp;ALL,111,2&nbsp;29,9&nbsp;84,6&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;cache_mem&nbsp;512&nbsp;MB&lt;/div&gt;&lt;div&gt;cache_swap_low&nbsp;80&lt;/div&gt;&lt;div&gt;cache_swap_high&nbsp;90&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;maximum_object_size&nbsp;512&nbsp;MB&lt;/div&gt;&lt;div&gt;minimum_object_size&nbsp;0&nbsp;KB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;maximum_object_size_in_memory&nbsp;4096&nbsp;KB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;cache_replacement_policy&nbsp;heap&nbsp;LFUDA&lt;/div&gt;&lt;div&gt;memory_replacement_policy&nbsp;heap&nbsp;LFUDA&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Para&nbsp;não&nbsp;bloquear&nbsp;downloads&lt;/div&gt;&lt;div&gt;quick_abort_min&nbsp;-1&nbsp;KB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Resolve&nbsp;um&nbsp;problema&nbsp;com&nbsp;conexoes&nbsp;persistentes &lt;/div&gt;&lt;div&gt;detect_broken_pconn&nbsp;on&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;fqdncache_size&nbsp;1024&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Parametros&nbsp;de&nbsp;atualizacao&nbsp;da&nbsp;memoria&nbsp;cache&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^ftp:&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;1440&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;20%&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;10080&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^gopher:&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;1440&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;0%&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;1440&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;0%&nbsp;&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;0&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;.&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;0&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;20%&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;4320&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Localizacao&nbsp;dos&nbsp;logs&lt;/div&gt;&lt;div&gt;access_log&nbsp;/var/log/squid3/access.log&lt;/div&gt;&lt;div&gt;cache_log&nbsp;/var/log/squid3/cache.log&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;define&nbsp;a&nbsp;localizacao&nbsp;do&nbsp;cache&nbsp;de&nbsp;disco,&nbsp;tamanho,&nbsp;qtd&nbsp;de&nbsp;diretorios&nbsp;pai&nbsp;e&nbsp;subdiretorios&lt;/div&gt;&lt;div&gt;cache_dir&nbsp;aufs&nbsp;/var/spool/squid3&nbsp;600&nbsp;16&nbsp;256&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid3/basic_ncsa_auth&nbsp;/etc/squid3/passwd&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;children&nbsp;5&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;realm&nbsp;AUTENTICACAO&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours&lt;/div&gt;&lt;div&gt;auth_param&nbsp;basic&nbsp;casesensitive&nbsp;off&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;visible_hostname&nbsp;&lt;a&nbsp;href=&quot;http://proxy.home.com&quot;&gt;proxy.home.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;acls&lt;/div&gt;&lt;div&gt;#acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;/div&gt;&lt;div&gt;acl&nbsp;localhost&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.200.7/32&quot;&gt;192.168.200.7/32&lt;/a&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;to_localhost&nbsp;dst&nbsp;&lt;a&nbsp;href=&quot;http://192.168.200.7/32&quot;&gt;192.168.200.7/32&lt;/a&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;22&nbsp;443&nbsp;563&nbsp;7071&nbsp;10000&nbsp;#&nbsp;ssh,&nbsp;https,&nbsp;snews,&nbsp;zimbra,&nbsp;webmin&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;ftp&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;gopher&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;88&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;kerberos&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;wais&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;http-mgmt&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;389&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;ldap&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;https&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;gss-http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;563&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;snews&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;filemaker&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;multiling&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;3001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;imprenssa&nbsp;nacional&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;8080&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;http&lt;/div&gt;&lt;div&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&lt;span&nbsp;class=&quot;gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;purge&nbsp;method&nbsp;PURGE&lt;/div&gt;&lt;div&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Regras&nbsp;iniciais&nbsp;do&nbsp;Squid&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;purge&nbsp;localhost&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;purge&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Exige&nbsp;autenticacao&lt;/div&gt;&lt;div&gt;acl&nbsp;autenticados&nbsp;proxy_auth&nbsp;REQUIRED&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;autenticados&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Bloqueia&nbsp;extensoes&nbsp;de&nbsp;arquivos&lt;/div&gt;&lt;div&gt;acl&nbsp;extensoes_bloqueadas&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid3/acls/extensoes-proibidas&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Liberar&nbsp;alguns&nbsp;sites&lt;/div&gt;&lt;div&gt;acl&nbsp;sites_liberados&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid3/acls/sites-permitidos&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Bloqueia&nbsp;sites&nbsp;por&nbsp;URL&lt;/div&gt;&lt;div&gt;acl&nbsp;sites_bloqueados&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid3/acls/sites-proibidos&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#bloqueios&nbsp;basicos&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;sites_liberados&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;extensoes_bloqueadas&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;sites_bloqueados &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;LAN&nbsp;#####&lt;/div&gt;&lt;div&gt;acl&nbsp;rede_lan&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.200.0/22&quot;&gt;192.168.200.0/22&lt;/a&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Nega&nbsp;acesso&nbsp;de&nbsp;quem&nbsp;nao&nbsp;esta&nbsp;na&nbsp;rede&nbsp;local&nbsp;do&nbsp;CMB&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;rede_lan &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#negando&nbsp;o&nbsp;acesso&nbsp;para&nbsp;todos&nbsp;que&nbsp;nao&nbsp;estiverem&nbsp;nas&nbsp;regras&nbsp;anteriores&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;###&nbsp;Erros&nbsp;em&nbsp;portugues&lt;/div&gt;&lt;div&gt;error_directory&nbsp;/usr/share/squid3/errors/pt-br&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#cache_effective_user&nbsp;proxy&lt;/div&gt;&lt;div&gt;coredump_dir&nbsp;/var/spool/squid3&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Márcio&lt;/div&gt;&lt;/div&gt;<br>

</tt>
