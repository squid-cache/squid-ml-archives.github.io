<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;So&nbsp;we&nbsp;are&nbsp;moving&nbsp;from&nbsp;an&nbsp;F5&nbsp;LB&nbsp;to&nbsp;an&nbsp;AWS&nbsp;ELB.&nbsp;In&nbsp;the&nbsp;F5&nbsp;we&nbsp;have&nbsp;a&nbsp;irule&nbsp;that&nbsp;inserts&nbsp;a&nbsp;header&nbsp;that&nbsp;our&nbsp;origin&nbsp;servers&nbsp;looks&nbsp;for&nbsp;so&nbsp;they&nbsp;can&nbsp;return&nbsp;https&nbsp;urls.&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;The&nbsp;ELB&nbsp;and&nbsp;Squid&nbsp;combination&nbsp;ends&nbsp;up&nbsp;rewritting&nbsp;the&nbsp;x_forward_proto&nbsp;header&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;fromÂ &lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0)&quot;&gt;HTTP_X_FORWARDED_PROTO:&nbsp;https<br>
&lt;/pre&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0)&quot;&gt;to&lt;/pre&gt;&lt;pre&nbsp;style=&quot;color:rgb(0,0,0)&quot;&gt;&lt;pre&gt;HTTP_X_FORWARDED_PROTO:&nbsp;http&lt;/pre&gt;&lt;pre&gt;&lt;br&gt;&lt;/pre&gt;&lt;pre&gt;So&nbsp;my&nbsp;origin,&nbsp;or&nbsp;back&nbsp;end&nbsp;server&nbsp;does&nbsp;not&nbsp;know&nbsp;that&nbsp;the&nbsp;request&nbsp;came&nbsp;into&nbsp;Squid&nbsp;as&nbsp;https&nbsp;and&nbsp;that&nbsp;breaks&nbsp;the&nbsp;application.&nbsp;&lt;/pre&gt;&lt;pre&gt;I&nbsp;need&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;keep&nbsp;the&nbsp;x_forwarded_proto&nbsp;header&nbsp;in&nbsp;tact,&nbsp;or&nbsp;I&nbsp;need&nbsp;to&nbsp;know&nbsp;how&nbsp;to&nbsp;add&nbsp;a&nbsp;custom&nbsp;header&nbsp;if&nbsp;the&nbsp;original&nbsp;r&lt;/pre&gt;&lt;div&gt;x_forwarded_proto&nbsp;header&nbsp;is&nbsp;https&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;appears&nbsp;to&nbsp;be&nbsp;a&nbsp;&quot;request_header_add&quot;&nbsp;but&nbsp;I&#39;m&nbsp;unclear&nbsp;how&nbsp;to&nbsp;use&nbsp;it.&nbsp;Any&nbsp;assistance&nbsp;would&nbsp;be&nbsp;appreciated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;running&nbsp;3.5.x&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Tory&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
