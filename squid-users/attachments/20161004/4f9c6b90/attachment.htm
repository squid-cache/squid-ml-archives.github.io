<tt>
&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Hi&nbsp;Amos;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Ok,&nbsp;we&nbsp;can&nbsp;discussed&nbsp;the&nbsp;issue&nbsp;in&nbsp;Two<br>
part&nbsp;&nbsp;1.&nbsp;For&nbsp;Windows&nbsp;AD&nbsp;Authentication&nbsp;&amp;&nbsp;SSO&nbsp;and&nbsp;2.&nbsp;Linux&nbsp;server<br>
unable&nbsp;to&nbsp;access&nbsp;via&nbsp;squid&nbsp;proxy.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;For&nbsp;First&nbsp;point-&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Requirement&nbsp;to&nbsp;have&nbsp;SSO&nbsp;for&nbsp;accessing<br>
internet&nbsp;via&nbsp;squid&nbsp;proxy&nbsp;and&nbsp;based&nbsp;on&nbsp;user's&nbsp;AD&nbsp;group&nbsp;membership&nbsp;allow<br>
access&nbsp;to&nbsp;specific&nbsp;sites&nbsp;only.&nbsp;I&nbsp;believe&nbsp;current&nbsp;configuration&nbsp;of&nbsp;squid<br>
is&nbsp;working&nbsp;as&nbsp;expected.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;For&nbsp;Second&nbsp;point&nbsp;-&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Point&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;highlight&nbsp;here<br>
is,&nbsp;the&nbsp;Linux&nbsp;server&nbsp;&lt;/font&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;IWCCP01&lt;/font&gt;&lt;/tt&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;<br>
is&nbsp;not&nbsp;part&nbsp;of&nbsp;domain&nbsp;at&nbsp;all.&nbsp;Hence&nbsp;the&nbsp;below&nbsp;error&nbsp;as&nbsp;squid&nbsp;configured<br>
for&nbsp;AD_auth.&nbsp;So&nbsp;how&nbsp;can&nbsp;we&nbsp;allow&nbsp;Linux&nbsp;server&nbsp;or&nbsp;non&nbsp;domain&nbsp;machine&nbsp;to<br>
access&nbsp;specific&nbsp;sites?&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&gt;&nbsp;Error&nbsp;407&nbsp;is&nbsp;&quot;proxy&nbsp;auth&nbsp;required&quot;,<br>
so&nbsp;the&nbsp;proxy&nbsp;is&nbsp;expecting&nbsp;authentication&nbsp;&lt;br&gt;<br>
&gt;&nbsp;for&nbsp;some&nbsp;reason.&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;====================================&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&nbsp;&lt;/font&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&gt;&nbsp;Can<br>
you&nbsp;confirm&nbsp;that&nbsp;the&nbsp;hostname&nbsp;vseries-test.bottomline.com&nbsp;is&nbsp;contained<br>
in&nbsp;&lt;br&gt;<br>
&gt;&nbsp;your&nbsp;site&nbsp;file&nbsp;/etc/squid/sitelist/dbs_allowed_site&nbsp;?&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
YES,&nbsp;we&nbsp;have&nbsp;entry&nbsp;as&nbsp;.bottomline.com&nbsp;,&nbsp;which&nbsp;work&nbsp;fine&nbsp;when&nbsp;access&nbsp;via<br>
windows&nbsp;machine&nbsp;having&nbsp;proxy&nbsp;enabled&nbsp;for&nbsp;that&nbsp;user.&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;==============================&lt;br&gt;<br>
&gt;&nbsp;Can&nbsp;you&nbsp;temporarily&nbsp;change&nbsp;the&nbsp;line&nbsp;&quot;http_access&nbsp;allow&nbsp;IWCCP01<br>
allowedsite&quot;&nbsp;to&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&quot;http_access&nbsp;allow&nbsp;IWCCP01&quot;&nbsp;and&nbsp;see&nbsp;whether&nbsp;the&nbsp;machine<br>
then&nbsp;gets&nbsp;access?&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&nbsp;I&nbsp;will&nbsp;test&nbsp;this,&nbsp;and&nbsp;update&nbsp;the&nbsp;results.&lt;br&gt;<br>
========================================&lt;br&gt;<br>
If&nbsp;that&nbsp;works,&nbsp;please&nbsp;list&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;command:&lt;br&gt;<br>
&nbsp;&nbsp;grep&nbsp;&quot;bottomline.com&quot;&nbsp;/etc/squid/sitelist/dbs_allowed_site&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;o/p&nbsp;of&nbsp;above&nbsp;command&nbsp;as&nbsp;below&nbsp;-&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;[root@Proxy02&nbsp;~]#&nbsp;grep&nbsp;&quot;bottomline.com&quot;<br>
/etc/squid/sitelist/dbs_allowed_site&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;.bottomline.com&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;[root@Proxy02&nbsp;~]#&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;=======================================&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Thanks&nbsp;&amp;&nbsp;Regards&lt;br&gt;<br>
Nilesh&nbsp;Suresh&nbsp;Gavali&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&nbsp;&nbsp;&lt;br&gt;<br>
Message:&nbsp;2&lt;br&gt;<br>
Date:&nbsp;Wed,&nbsp;5&nbsp;Oct&nbsp;2016&nbsp;00:11:08&nbsp;+1300&lt;br&gt;<br>
From:&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;br&gt;<br>
To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Squid&nbsp;-&nbsp;AD&nbsp;kerberos&nbsp;auth&nbsp;and&nbsp;Linux&nbsp;Server&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
proxy&nbsp;access&nbsp;not&nbsp;working&lt;br&gt;<br>
Message-ID:&nbsp;&lt;d35ad0ca-761d-60e3-c594-04697110afdc@treenet.co.nz&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;4/10/2016&nbsp;11:36&nbsp;p.m.,&nbsp;Antony&nbsp;Stone&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Tuesday&nbsp;04&nbsp;October&nbsp;2016&nbsp;at&nbsp;12:28:44,&nbsp;Nilesh&nbsp;Gavali&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&gt;&nbsp;Hello&nbsp;Antony;&lt;br&gt;<br>
&gt;&gt;&nbsp;I&nbsp;have&nbsp;double&nbsp;checked&nbsp;the&nbsp;current&nbsp;working&nbsp;configuration&nbsp;of&nbsp;my<br>
squid.conf&lt;br&gt;<br>
&gt;&gt;&nbsp;and&nbsp;it&nbsp;has&nbsp;same&nbsp;settings&nbsp;which&nbsp;I&nbsp;posted&nbsp;earlier.&nbsp;somehow&nbsp;it&nbsp;is<br>
working&nbsp;for&lt;br&gt;<br>
&gt;&gt;&nbsp;us.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I'm&nbsp;not&nbsp;saying&nbsp;the&nbsp;whole&nbsp;thing&nbsp;won't&nbsp;work;&nbsp;I'm&nbsp;saying&nbsp;there&nbsp;is&nbsp;no<br>
point&nbsp;in&nbsp;&lt;br&gt;<br>
&gt;&nbsp;having&nbsp;a&nbsp;line&nbsp;&quot;http_access&nbsp;allow&nbsp;ad_auth&quot;&nbsp;following&nbsp;the<br>
line&nbsp;&quot;http_access&nbsp;deny&nbsp;&lt;br&gt;<br>
&gt;&nbsp;all&quot;.&nbsp;&nbsp;The&nbsp;ad_auth&nbsp;line&nbsp;can&nbsp;never&nbsp;be&nbsp;invoked.&lt;br&gt;<br>
&lt;br&gt;<br>
Not&nbsp;knowing&nbsp;why&nbsp;authentication&nbsp;works&nbsp;is&nbsp;dangerous.&nbsp;You&nbsp;might&nbsp;have&nbsp;been&lt;br&gt;<br>
allowing&nbsp;non-authenticated&nbsp;traffic&nbsp;and&nbsp;invalid&nbsp;user&nbsp;accounts&nbsp;through.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;only&nbsp;reason&nbsp;it&nbsp;does&nbsp;&quot;work&quot;&nbsp;is&nbsp;that&nbsp;the&nbsp;ACL&nbsp;called&nbsp;&quot;USERS&quot;<br>
is&nbsp;_not_&lt;br&gt;<br>
actually&nbsp;checking&nbsp;user&nbsp;logins.&nbsp;It&nbsp;is&nbsp;a&nbsp;group&nbsp;checking&nbsp;ACL&nbsp;which&nbsp;requires&lt;br&gt;<br>
authentication&nbsp;to&nbsp;happen&nbsp;before&nbsp;it&nbsp;can&nbsp;be&nbsp;checked.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;this&nbsp;specific&nbsp;case&nbsp;invalid&nbsp;logins&nbsp;cannot&nbsp;be&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;group.&nbsp;So&lt;br&gt;<br>
they&nbsp;will&nbsp;not&nbsp;get&nbsp;through&nbsp;the&nbsp;proxy.&lt;br&gt;<br>
&lt;br&gt;<br>
However,&nbsp;people&nbsp;who&nbsp;accidentally&nbsp;type&nbsp;the&nbsp;user/password&nbsp;wrong,&nbsp;or&nbsp;whose&lt;br&gt;<br>
machines&nbsp;automatically&nbsp;login&nbsp;with&nbsp;an&nbsp;account&nbsp;not&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;group&lt;br&gt;<br>
will&nbsp;not&nbsp;be&nbsp;allowed&nbsp;any&nbsp;way&nbsp;to&nbsp;try&nbsp;again&nbsp;short&nbsp;of&nbsp;shutting&nbsp;down&nbsp;their&lt;br&gt;<br>
browser&nbsp;or&nbsp;maybe&nbsp;even&nbsp;logging&nbsp;out&nbsp;of&nbsp;the&nbsp;machine&nbsp;and&nbsp;trying&nbsp;from&nbsp;another&lt;br&gt;<br>
one.&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;be&nbsp;a&nbsp;problem&nbsp;for&nbsp;you.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&gt;&nbsp;below&nbsp;is&nbsp;the&nbsp;error&nbsp;from&nbsp;access.log&nbsp;file.&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;1475518342.279&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;10.xx.15.103&nbsp;TCP_DENIED/407<br>
3589&nbsp;CONNECT&lt;br&gt;<br>
&gt;&gt;&nbsp;vseries-test.bottomline.com:443&nbsp;-&nbsp;NONE/-&nbsp;text/html&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Error&nbsp;407&nbsp;is&nbsp;&quot;proxy&nbsp;auth&nbsp;required&quot;,&nbsp;so&nbsp;the&nbsp;proxy&nbsp;is&nbsp;expecting<br>
authentication&nbsp;&lt;br&gt;<br>
&gt;&nbsp;for&nbsp;some&nbsp;reason.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Can&nbsp;you&nbsp;confirm&nbsp;that&nbsp;the&nbsp;hostname&nbsp;vseries-test.bottomline.com&nbsp;is&nbsp;contained<br>
in&nbsp;&lt;br&gt;<br>
&gt;&nbsp;your&nbsp;site&nbsp;file&nbsp;/etc/squid/sitelist/dbs_allowed_site&nbsp;?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Can&nbsp;you&nbsp;temporarily&nbsp;change&nbsp;the&nbsp;line&nbsp;&quot;http_access&nbsp;allow&nbsp;IWCCP01<br>
allowedsite&quot;&nbsp;to&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&quot;http_access&nbsp;allow&nbsp;IWCCP01&quot;&nbsp;and&nbsp;see&nbsp;whether&nbsp;the&nbsp;machine<br>
then&nbsp;gets&nbsp;access?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;that&nbsp;works,&nbsp;please&nbsp;list&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;command:&lt;br&gt;<br>
&nbsp;&nbsp;grep&nbsp;&quot;bottomline.com&quot;&nbsp;/etc/squid/sitelist/dbs_allowed_site&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
&lt;br&gt;<br>
*******************************************&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;p&gt;=====-----=====-----=====&lt;br&gt;<br>
Notice:&nbsp;The&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;e-mail&lt;br&gt;<br>
message&nbsp;and/or&nbsp;attachments&nbsp;to&nbsp;it&nbsp;may&nbsp;contain&nbsp;&lt;br&gt;<br>
confidential&nbsp;or&nbsp;privileged&nbsp;information.&nbsp;If&nbsp;you&nbsp;are&nbsp;&lt;br&gt;<br>
not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;any&nbsp;dissemination,&nbsp;use,&nbsp;&lt;br&gt;<br>
review,&nbsp;distribution,&nbsp;printing&nbsp;or&nbsp;copying&nbsp;of&nbsp;the&nbsp;&lt;br&gt;<br>
information&nbsp;contained&nbsp;in&nbsp;this&nbsp;e-mail&nbsp;message&nbsp;&lt;br&gt;<br>
and/or&nbsp;attachments&nbsp;to&nbsp;it&nbsp;are&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;&lt;br&gt;<br>
you&nbsp;have&nbsp;received&nbsp;this&nbsp;communication&nbsp;in&nbsp;error,&nbsp;&lt;br&gt;<br>
please&nbsp;notify&nbsp;us&nbsp;by&nbsp;reply&nbsp;e-mail&nbsp;or&nbsp;telephone&nbsp;and&nbsp;&lt;br&gt;<br>
immediately&nbsp;and&nbsp;permanently&nbsp;delete&nbsp;the&nbsp;message&nbsp;&lt;br&gt;<br>
and&nbsp;any&nbsp;attachments.&nbsp;Thank&nbsp;you&lt;/p&gt;<br>
<br>
&lt;p&gt;&lt;/p&gt;
</tt>
