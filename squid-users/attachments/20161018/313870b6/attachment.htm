<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;In&nbsp;response&nbsp;to&nbsp;it&nbsp;not&nbsp;being&nbsp;a&nbsp;false&nbsp;positive&nbsp;,&nbsp;maybe&nbsp;its&nbsp;not&nbsp;specifically&nbsp;the&nbsp;TTL&nbsp;but&nbsp;in&nbsp;this&nbsp;other&nbsp;article&nbsp;on&nbsp;the&nbsp;mailing&nbsp;lists&nbsp;someone&nbsp;else&nbsp;had&nbsp;the&nbsp;same&nbsp;issue&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;response&nbsp;Amos&nbsp;gave,&nbsp;this&nbsp;is&nbsp;a&nbsp;known&nbsp;issue&nbsp;and&nbsp;apparently&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;&quot;ignore&nbsp;host&nbsp;header&nbsp;forgery&nbsp;issues&quot;&nbsp;or&nbsp;bypass&nbsp;them&nbsp;in&nbsp;the&nbsp;squid&nbsp;config.&lt;/div&gt;&lt;div&gt;My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;,&nbsp;maybe&nbsp;the&nbsp;short&nbsp;TTL&nbsp;is&nbsp;ok,&nbsp;but&nbsp;it&nbsp;is&nbsp;small&nbsp;enough&nbsp;to&nbsp;where&nbsp;when&nbsp;a&nbsp;cloud&nbsp;based&nbsp;client&nbsp;is&nbsp;connecting&nbsp;to&nbsp;server&nbsp;a&nbsp;server&nbsp;b&nbsp;to&nbsp;amazon&nbsp;S3&nbsp;etc&nbsp;it&nbsp;can&nbsp;take&nbsp;a&nbsp;few&nbsp;seconds &lt;/div&gt;&lt;div&gt;Thus&nbsp;that&nbsp;5&nbsp;second&nbsp;TTL&nbsp;(which&nbsp;again&nbsp;is&nbsp;often&nbsp;2-3&nbsp;seconds)&nbsp;is&nbsp;small&nbsp;enough&nbsp;to&nbsp;hurt.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Specifically&nbsp;some&nbsp;of&nbsp;these&nbsp;people&nbsp;(aws&nbsp;,&nbsp;google)&nbsp;in&nbsp;some&nbsp;dns&nbsp;situations&nbsp;they&nbsp;are&nbsp;doing&nbsp;things&nbsp;that&nbsp;squid&nbsp;has&nbsp;been&nbsp;known&nbsp;to&nbsp;identify&nbsp;as&nbsp;host&nbsp;header&nbsp;forgery&nbsp;just&nbsp;becuse&nbsp;it&nbsp;doesnt&nbsp;understand&nbsp;whats&nbsp;happening.&lt;/div&gt;&lt;div&gt;Also&nbsp;if&nbsp;im&nbsp;doing&nbsp;an&nbsp;S3&nbsp;call&nbsp;pulling&nbsp;or&nbsp;pushing&nbsp;a&nbsp;big&nbsp;file&nbsp;which&nbsp;is&nbsp;very&nbsp;common&nbsp;in&nbsp;cloud&nbsp;environments&nbsp;it&nbsp;can&nbsp;take&nbsp;10-20&nbsp;seconds&nbsp;for&nbsp;the&nbsp;request&nbsp;to&nbsp;process&nbsp;,&nbsp;and&nbsp;if&nbsp;TTL&nbsp;expires&nbsp;mid&nbsp;stream&nbsp;,&nbsp;squid&nbsp;is&nbsp;for&nbsp;some&nbsp;reason&nbsp;flagging&nbsp;as&nbsp;forgery&nbsp;and&nbsp;it&nbsp;hangs&nbsp;until&nbsp;it&nbsp;either&nbsp;returns&nbsp;to&nbsp;the&nbsp;same&nbsp;ip&nbsp;in &lt;/div&gt;&lt;div&gt;DNS&nbsp;by&nbsp;chance&nbsp;or&nbsp;until&nbsp;the&nbsp;connection&nbsp;is&nbsp;dropped.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/2016-August/012261.html&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/2016-August/012261.html&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;note&nbsp;from&nbsp;Amos&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;color:rgb(0,0,0)&quot;&gt;&gt;&gt;&lt;i&gt;&nbsp;The&nbsp;cases&nbsp;where&nbsp;Squid&nbsp;still&nbsp;gets&nbsp;it&nbsp;wrong&nbsp;are&nbsp;where&nbsp;the&nbsp;popular&nbsp;CDN<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;service(s)&nbsp;in&nbsp;question&nbsp;are&nbsp;performing&nbsp;DNS&nbsp;actions&nbsp;indistinguishable&nbsp;to<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;those&nbsp;malware&nbsp;attacks.&nbsp;If&nbsp;Squid&nbsp;can&#39;t&nbsp;tell&nbsp;the&nbsp;difference&nbsp;between&nbsp;an<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;attack&nbsp;and&nbsp;normal&nbsp;DNS&nbsp;behaviour&nbsp;the&nbsp;only&nbsp;code&nbsp;change&nbsp;possible&nbsp;is&nbsp;to<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;&nbsp;disable&nbsp;the&nbsp;check&nbsp;(see&nbsp;above&nbsp;about&nbsp;the&nbsp;risk&nbsp;level).<br>
&lt;/i&gt;&gt;&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Oct&nbsp;18,&nbsp;2016&nbsp;at&nbsp;2:01&nbsp;PM,&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:garryd@comnet.uz&quot;&nbsp;target=&quot;_blank&quot;&gt;garryd@comnet.uz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;2016-10-18&nbsp;22:42,&nbsp;John&nbsp;Wright&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&lt;br&gt;<br>
&lt;br&gt;<br>
Replying&nbsp;to&nbsp;the&nbsp;list&lt;br&gt;<br>
&lt;br&gt;<br>
Yes&nbsp;i&nbsp;get&nbsp;that&nbsp;error&nbsp;on&nbsp;many&nbsp;different&nbsp;sites&nbsp;same&nbsp;exact&nbsp;error&nbsp;about&lt;br&gt;<br>
host&nbsp;headers.&lt;br&gt;<br>
Also&nbsp;if&nbsp;you&nbsp;watch&nbsp;the&nbsp;TTL&nbsp;on&nbsp;the&nbsp;amazonaws&nbsp;url&nbsp;i&nbsp;provided&nbsp;it&nbsp;changes&lt;br&gt;<br>
from&nbsp;3&nbsp;to&nbsp;5&nbsp;to&nbsp;10&nbsp;seconds&nbsp;to&nbsp;60&nbsp;to&nbsp;10&nbsp;back&nbsp;and&nbsp;forth.&lt;br&gt;<br>
If&nbsp;you&nbsp;go&nbsp;online&nbsp;to&nbsp;an&nbsp;dns&nbsp;lookup&nbsp;site&nbsp;like&nbsp;kloth&nbsp;i&nbsp;see&nbsp;via&nbsp;kloth&nbsp;5&lt;br&gt;<br>
seconds&nbsp;TTL&lt;br&gt;<br>
&lt;br&gt;<br>
i&nbsp;get&nbsp;a&nbsp;different&nbsp;TTL&nbsp;value&nbsp;at&nbsp;different&nbsp;times,&nbsp;it&nbsp;appears&nbsp;they&nbsp;dont&lt;br&gt;<br>
have&nbsp;a&nbsp;set&nbsp;TTL&nbsp;but&nbsp;they&nbsp;change&nbsp;it&nbsp;often&nbsp;and&nbsp;it&nbsp;varies.&lt;br&gt;<br>
Right&nbsp;now&nbsp;it&nbsp;appears&nbsp;to&nbsp;be&nbsp;a&nbsp;ttl&nbsp;of&nbsp;60&nbsp;seconds&nbsp;as&nbsp;you&nbsp;found&nbsp;but&lt;br&gt;<br>
earlier&nbsp;and&nbsp;over&nbsp;the&nbsp;weekend&nbsp;it&nbsp;has&nbsp;shown&nbsp;5&nbsp;seconds&nbsp;and&nbsp;even&nbsp;AWS&lt;br&gt;<br>
support&nbsp;verified&nbsp;it&nbsp;can&nbsp;vary&nbsp;as&nbsp;low&nbsp;as&nbsp;5&nbsp;seconds.&lt;br&gt;<br>
That&nbsp;being&nbsp;said&nbsp;,&nbsp;when&nbsp;it&nbsp;is&nbsp;changing&nbsp;every&nbsp;3-5&nbsp;seconds&nbsp;which&nbsp;comes&lt;br&gt;<br>
and&nbsp;goes&nbsp;,&nbsp;squid&nbsp;gives&nbsp;the&nbsp;header&nbsp;forgery&nbsp;errors&nbsp;as&nbsp;shown&nbsp;before.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/span&gt;<br>
The&nbsp;time&nbsp;interval&nbsp;between&nbsp;client&#39;s&nbsp;and&nbsp;Squid&#39;s&nbsp;name&nbsp;lookup&nbsp;is&nbsp;measured&nbsp;in&nbsp;milliseconds.&nbsp;So,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;the&nbsp;would&nbsp;not&nbsp;be&nbsp;false&nbsp;positives&nbsp;in&nbsp;environments&nbsp;where&nbsp;same&nbsp;cashing&nbsp;DNS&nbsp;server&nbsp;is&nbsp;used.&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;specific&nbsp;issue&nbsp;you&nbsp;encounter&nbsp;except&nbsp;alert&nbsp;messages&nbsp;and&nbsp;Squid&#39;s&nbsp;inability&nbsp;to&nbsp;cache&nbsp;HTTP&nbsp;responses&nbsp;for&nbsp;&quot;forged&quot;&nbsp;HTTP&nbsp;requests?&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.&lt;wbr&gt;org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/l&lt;wbr&gt;istinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;time,&lt;br&gt;&lt;br&gt;John&nbsp;Wright&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
