<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Hi&nbsp;Eliezer&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;I've&nbsp;never&nbsp;used&nbsp;ICAP,&nbsp;and&nbsp;I&nbsp;think&nbsp;hacking&nbsp;the&nbsp;code&nbsp;is&nbsp;way&nbsp;faster<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;creating/using&nbsp;a&nbsp;separate&nbsp;service&nbsp;for&nbsp;that.&nbsp;And&nbsp;I'm&nbsp;not&nbsp;sure,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;I&nbsp;don't&nbsp;think&nbsp;I&nbsp;can&nbsp;manage&nbsp;to&nbsp;get&nbsp;this&nbsp;done&nbsp;with&nbsp;current<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squid's&nbsp;options.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;color=&quot;#000099&quot;&gt;This&nbsp;patch&nbsp;will&nbsp;make&nbsp;squid&nbsp;NOT&nbsp;ignore&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects&nbsp;with&nbsp;&quot;&lt;b&gt;Vary:&nbsp;*&lt;/b&gt;&quot;&nbsp;replies.&nbsp;It&nbsp;will&nbsp;consider&nbsp;them&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid&nbsp;and&nbsp;cacheable&nbsp;object.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;it&nbsp;will&nbsp;only&nbsp;consider&nbsp;as&nbsp;a&nbsp;valid&nbsp;Vary&nbsp;option&nbsp;those&nbsp;who&nbsp;&lt;b&gt;begins<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/b&gt;with&quot;accept&quot;&nbsp;or&nbsp;the&nbsp;&quot;user-agent&quot;&nbsp;one.&lt;/font&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
Best&nbsp;Regards,<br>
<br>
Heiler&nbsp;Bemerguy<br>
Network&nbsp;Manager&nbsp;-&nbsp;CINBESA<br>
55&nbsp;91&nbsp;98151-4894/3184-1751&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Em&nbsp;21/10/2016&nbsp;16:07,&nbsp;Eliezer&nbsp;Croitoru<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escreveu:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:053a01d22bce$67f6f1a0$37e4d4e0$@ngtech.co.il&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Instead&nbsp;of&nbsp;modifying&nbsp;the&nbsp;code,&nbsp;would&nbsp;you&nbsp;consider&nbsp;to&nbsp;use&nbsp;an&nbsp;ICAP&nbsp;service<br>
that&nbsp;will&nbsp;mangle&nbsp;this?<br>
I&nbsp;am&nbsp;unsure&nbsp;about&nbsp;the&nbsp;risks&nbsp;about&nbsp;doing&nbsp;so&nbsp;but&nbsp;why&nbsp;patch&nbsp;the&nbsp;sources&nbsp;if&nbsp;you<br>
can&nbsp;resolve&nbsp;it&nbsp;with&nbsp;the&nbsp;current&nbsp;mainstream&nbsp;capabilities&nbsp;and&nbsp;API?<br>
<br>
Eliezer<br>
<br>
----<br>
Eliezer&nbsp;Croitoru&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;http://ngtech.co.il/lmgtfy/&quot;&gt;&lt;http://ngtech.co.il/lmgtfy/&gt;&lt;/a&gt;&nbsp;<br>
Linux&nbsp;System&nbsp;Administrator<br>
Mobile:&nbsp;+972-5-28704261<br>
Email:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:eliezer@ngtech.co.il&quot;&gt;eliezer@ngtech.co.il&lt;/a&gt;<br>
&nbsp;<br>
<br>
From:&nbsp;squid-users&nbsp;[&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;mailto:squid-users-bounces@lists.squid-cache.org&quot;&gt;mailto:squid-users-bounces@lists.squid-cache.org&lt;/a&gt;]&nbsp;On<br>
Behalf&nbsp;Of&nbsp;Heiler&nbsp;Bemerguy<br>
Sent:&nbsp;Friday,&nbsp;October&nbsp;21,&nbsp;2016&nbsp;18:21<br>
To:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@squid-cache.org&quot;&gt;squid-users@squid-cache.org&lt;/a&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Caching&nbsp;http&nbsp;google&nbsp;deb&nbsp;files<br>
<br>
<br>
Hello,<br>
I've&nbsp;limited&nbsp;the&nbsp;&quot;vary&quot;&nbsp;usage&nbsp;and&nbsp;gained&nbsp;some&nbsp;hits&nbsp;by&nbsp;making&nbsp;these<br>
modifications&nbsp;(in&nbsp;blue)&nbsp;to&nbsp;the&nbsp;http.cc&nbsp;code:<br>
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(strListGetItem(&amp;vary,&nbsp;',',&nbsp;&amp;item,&nbsp;&amp;ilen,&nbsp;&amp;pos))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBuf&nbsp;name(item,&nbsp;ilen);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(name&nbsp;==&nbsp;asterisk)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;vstr.clear();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;&nbsp;*/&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name.toLower();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(name.cmp(&quot;accept&quot;,&nbsp;6)&nbsp;!=&nbsp;0&nbsp;&amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name.cmp(&quot;user-agent&quot;,&nbsp;10)&nbsp;!=&nbsp;0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!vstr.isEmpty())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vstr.append(&quot;,&nbsp;&quot;,&nbsp;2);<br>
<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
