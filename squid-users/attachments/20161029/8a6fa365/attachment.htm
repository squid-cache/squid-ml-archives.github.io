<tt>
&lt;div&nbsp;style=&quot;FONT-FAMILY:&nbsp;Arial;&nbsp;COLOR:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;FONT-SIZE:&nbsp;12px&quot;&gt;&lt;div&gt;This&nbsp;fixed&nbsp;the&nbsp;WSUS&nbsp;server,&nbsp;it&nbsp;wasn't&nbsp;the&nbsp;cache_peer&nbsp;parameter&nbsp;after&nbsp;all.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;inside&nbsp;dstdomain&nbsp;.mydomain.com&lt;/div&gt;&lt;div&gt;always_direct&nbsp;allow&nbsp;inside&nbsp;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;12.8px;&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&quot;&gt;never_direct&nbsp;allow&nbsp;all&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;The&nbsp;SEPM&nbsp;might&nbsp;have&nbsp;an&nbsp;additional&nbsp;known&nbsp;issue&nbsp;(known&nbsp;by&nbsp;Symantec&nbsp;that&nbsp;is)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;a&nbsp;proxy&nbsp;or&nbsp;a&nbsp;firewall&nbsp;is&nbsp;stripping,&nbsp;compressing,&nbsp;or&nbsp;encrypting&nbsp;content&nbsp;length&nbsp;packet&nbsp;headers,&nbsp;that'll&nbsp;break&nbsp;SEPM&nbsp;too.&nbsp;(SEPM&nbsp;uses&nbsp;port&nbsp;80&nbsp;by&nbsp;default,&nbsp;so&nbsp;theoretically&nbsp;it&nbsp;should&nbsp;have&nbsp;been&nbsp;getting&nbsp;out)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;a&nbsp;parameter&nbsp;in&nbsp;squid&nbsp;that&nbsp;would&nbsp;do&nbsp;that?&nbsp;(so&nbsp;I&nbsp;can&nbsp;see&nbsp;if&nbsp;it&nbsp;is&nbsp;configured&nbsp;or&nbsp;not)&nbsp;The&nbsp;squid.conf&nbsp;is&nbsp;90%&nbsp;of&nbsp;the&nbsp;default&nbsp;file,&nbsp;with&nbsp;just&nbsp;a&nbsp;few&nbsp;tweaks&nbsp;needed&nbsp;for&nbsp;our&nbsp;environment.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&gt;PG&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;border-top:1px&nbsp;solid&nbsp;#bcbcbc;margin:5px&nbsp;0px;&quot;&gt;&lt;/div&gt;&lt;span&nbsp;style=&quot;font-size:12;font-family:arial;color:#000000;&quot;&gt;On&nbsp;10/29/16,&nbsp;&lt;span&gt;Amos&nbsp;Jeffries&lt;squid3@treenet.co.nz&gt;&lt;/span&gt;&nbsp;wrote:&lt;/span&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12;font-family:arial;color:#000000;&quot;&gt;On&nbsp;30/10/2016&nbsp;4:40&nbsp;a.m.,&nbsp;paul.greene.va&nbsp;wrote:&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;Our&nbsp;firewall&nbsp;guy&nbsp;says&nbsp;what&nbsp;he's&nbsp;seeing&nbsp;in&nbsp;his&nbsp;logs&nbsp;is&nbsp;that&nbsp;traffic&nbsp;destined&nbsp;for&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;port&nbsp;443,&nbsp;after&nbsp;it&nbsp;goes&nbsp;through&nbsp;the&nbsp;proxy,&nbsp;is&nbsp;trying&nbsp;to&nbsp;go&nbsp;straight&nbsp;to&nbsp;the&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;vendor&nbsp;over&nbsp;the&nbsp;internet,&nbsp;rather&nbsp;than&nbsp;go&nbsp;through&nbsp;the&nbsp;upstream&nbsp;McAfee&nbsp;gateway&nbsp;as&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;required,&nbsp;and&nbsp;thus,&nbsp;the&nbsp;traffic&nbsp;is&nbsp;getting&nbsp;dropped&nbsp;by&nbsp;the&nbsp;Cisco&nbsp;firewall.&nbsp;I&nbsp;did&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;a&nbsp;packet&nbsp;capture&nbsp;test&nbsp;with&nbsp;the&nbsp;McAfee&nbsp;gateway&nbsp;guy,&nbsp;and&nbsp;he&nbsp;confirmed&nbsp;that&nbsp;no&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;traffic&nbsp;coming&nbsp;from&nbsp;either&nbsp;either&nbsp;the&nbsp;WSUS&nbsp;or&nbsp;the&nbsp;SEPM&nbsp;is&nbsp;reaching&nbsp;his&nbsp;gateway.&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;I&nbsp;thought&nbsp;this&nbsp;line&nbsp;in&nbsp;the&nbsp;squid.conf&nbsp;file&nbsp;should&nbsp;send&nbsp;traffic&nbsp;from&nbsp;our&nbsp;proxy&nbsp;to&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;the&nbsp;upstream&nbsp;McAfee&nbsp;gateway,&nbsp;but&nbsp;maybe&nbsp;I'm&nbsp;misunderstanding&nbsp;the&nbsp;intent&nbsp;of&nbsp;the&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;cache_peer&nbsp;parent&nbsp;parameter.&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;cache_peer&nbsp;&lt;McAfee&nbsp;Gateway&nbsp;IP&nbsp;address&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;&nbsp;&nbsp;&nbsp;8080&nbsp;&nbsp;3130&nbsp;&nbsp;proxy-only&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;no-query&nbsp;no-netdb-exchange&nbsp;default&nbsp;login=username:password&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;cache_peer&nbsp;configures&nbsp;the&nbsp;*how*&nbsp;of&nbsp;traffic&nbsp;sent&nbsp;to&nbsp;that&nbsp;gateway.&nbsp;Which&lt;br&nbsp;/&gt;traffic&nbsp;uses&nbsp;it&nbsp;is&nbsp;configured&nbsp;by&nbsp;other&nbsp;directives&nbsp;(cache_peer_access,&lt;br&nbsp;/&gt;always_direct,&nbsp;never_direct,&nbsp;peer_direct,&nbsp;nonhierarchical_direct)&nbsp;and&lt;br&nbsp;/&gt;depends&nbsp;on&nbsp;the&nbsp;type&nbsp;of&nbsp;traffic.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;NP:&nbsp;the&nbsp;above&nbsp;also&nbsp;indicates&nbsp;the&nbsp;connection(s)&nbsp;are&nbsp;plain-text&nbsp;HTTP.&nbsp;If&lt;br&nbsp;/&gt;you&nbsp;are&nbsp;using&nbsp;interception&nbsp;then&nbsp;HTTPS&nbsp;traffic&nbsp;cannot&nbsp;go&nbsp;through&nbsp;that&lt;br&nbsp;/&gt;link.&nbsp;Since&nbsp;HTTPS&nbsp;requires&nbsp;end-to-end&nbsp;security,&nbsp;the&nbsp;cache_peer&lt;br&nbsp;/&gt;connection&nbsp;needs&nbsp;to&nbsp;use&nbsp;'ssl'&nbsp;options&nbsp;for&nbsp;intercepted&nbsp;port&nbsp;443&nbsp;to&nbsp;use&nbsp;it&lt;br&nbsp;/&gt;safely.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&gt;&nbsp;(if&nbsp;placement&nbsp;of&nbsp;this&nbsp;cache_peer&nbsp;parameter&nbsp;matters,&nbsp;its&nbsp;currently&nbsp;near&nbsp;the&nbsp;end&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;of&nbsp;the&nbsp;squid.conf&nbsp;file)&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;As&nbsp;a&nbsp;test,&nbsp;I&nbsp;configured&nbsp;internet&nbsp;explorer&nbsp;on&nbsp;the&nbsp;WSUS&nbsp;server&nbsp;to&nbsp;use&nbsp;the&nbsp;proxy&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;for&nbsp;internet&nbsp;access,&nbsp;Without&nbsp;configuring&nbsp;for&nbsp;the&nbsp;proxy,&nbsp;IE&nbsp;can't&nbsp;go&nbsp;anywhere&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;except&nbsp;the&nbsp;local&nbsp;network.&nbsp;IE&nbsp;can&nbsp;hit&nbsp;http&nbsp;websites&nbsp;(i.e.&nbsp;&lt;a&nbsp;class=&quot;parsedLink&quot;&nbsp;href=&quot;http://www.cnn.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.cnn.com&lt;/a&gt;)&nbsp;when&nbsp;it's&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;configured&nbsp;to&nbsp;use&nbsp;the&nbsp;proxy,&nbsp;but&nbsp;not&nbsp;https&nbsp;websites.&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;The&nbsp;Safe_ports&nbsp;and&nbsp;SSL_ports&nbsp;list&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;squid.conf&nbsp;defaults.&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;This&nbsp;is&nbsp;squid&nbsp;3.3&nbsp;running&nbsp;on&nbsp;Redhat&nbsp;7.&lt;br&nbsp;/&gt;&gt;&nbsp;&lt;br&nbsp;/&gt;&gt;&nbsp;Any&nbsp;suggestions&nbsp;or&nbsp;pointers?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Assuming&nbsp;you&nbsp;are&nbsp;using&nbsp;explicit/forward&nbsp;proxy,&nbsp;add&nbsp;this&nbsp;to&nbsp;your&nbsp;squid.conf:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&nbsp;never_direct&nbsp;allow&nbsp;all&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;if&nbsp;that&nbsp;dont&nbsp;work&nbsp;by&nbsp;itself&nbsp;you&nbsp;may&nbsp;need&nbsp;these&nbsp;as&nbsp;well:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&nbsp;prefer_direct&nbsp;off&lt;br&nbsp;/&gt;&nbsp;nonhierarchical_direct&nbsp;off&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;You&nbsp;should&nbsp;not&nbsp;have&nbsp;any&nbsp;existing&nbsp;lines&nbsp;with&nbsp;those&nbsp;directives&nbsp;or&nbsp;with&lt;br&nbsp;/&gt;always_direct.&nbsp;If&nbsp;you&nbsp;do&nbsp;the&nbsp;placement&nbsp;might&nbsp;matter.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Amos&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;_______________________________________________&lt;br&nbsp;/&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&nbsp;/&gt;&lt;a&nbsp;class=&quot;parsedEmail&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&nbsp;/&gt;&lt;a&nbsp;class=&quot;parsedLink&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&nbsp;/&gt;&lt;/div&gt;&lt;/div&gt;<br>
<br>

</tt>
