<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;sure&nbsp;about&nbsp;forwarding&nbsp;because&nbsp;I&nbsp;see&nbsp;requests&nbsp;to &lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;http://172.22.15.88:3128/squid&lt;wbr&gt;-internal-periodic/store_diges&lt;wbr&gt;t&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt; in&nbsp;parent&nbsp;logs&nbsp;and&nbsp;my&nbsp;parent&nbsp;returns&nbsp;502&nbsp;because&nbsp;we&nbsp;do&nbsp;not&nbsp;allow&nbsp;requests&nbsp;to&nbsp;internal&nbsp;IPs.&nbsp;Logs&nbsp;from&nbsp;the&nbsp;parent:&lt;/span&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Got&nbsp;request:&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&gt;http://172.22.15.88:3128/squid-internal-periodic/store_digest&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Not&nbsp;allowing&nbsp;blacklisted&nbsp;IP&nbsp;172.22.15.88&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;GET&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&gt;http://172.22.15.88:3128/squid-internal-periodic/store_digest&lt;/a&gt;&nbsp;502&nbsp;0ms&lt;/span&gt;&lt;/div&gt;&lt;/font&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;I&nbsp;do&nbsp;not&nbsp;have&nbsp;&quot;&lt;/span&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;global_internal_static&nbsp;off&quot;&nbsp;in&nbsp;my&nbsp;config&nbsp;and&nbsp;also&nbsp;I&#39;m&nbsp;able&nbsp;to&nbsp;get &lt;/span&gt;&lt;/font&gt;&lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;http://172.22.15.88:3128/squid&lt;wbr&gt;-internal-periodic/store_diges&lt;wbr&gt;t&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt; using&nbsp;curl&nbsp;or&nbsp;telnet&nbsp;(with&nbsp;telnet&nbsp;I&nbsp;do&nbsp;&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;GET&nbsp;/squid-internal-periodic/store&lt;/span&gt;&lt;wbr&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;_digest&quot;&nbsp;–&nbsp;note&nbsp;relative&nbsp;URL&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;).&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;However&nbsp;according&nbsp;to&nbsp;debug&nbsp;logs&nbsp;squid&nbsp;does&nbsp;this&nbsp;request&nbsp;using&nbsp;absolute&nbsp;URL&nbsp;which&nbsp;probably&nbsp;works&nbsp;if&nbsp;target&nbsp;sibling&nbsp;can&nbsp;do&nbsp;direct&nbsp;requests&nbsp;(so&nbsp;it&nbsp;will&nbsp;request&nbsp;itself&nbsp;for&nbsp;digest&nbsp;and&nbsp;return&nbsp;response&nbsp;to&nbsp;original&nbsp;squid).&nbsp;But&nbsp;I&nbsp;do&nbsp;have&nbsp;&quot;&lt;/span&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;never_direct&nbsp;allow&nbsp;all&quot;&nbsp;which&nbsp;probably&nbsp;makes&nbsp;sibling&nbsp;to&nbsp;forward&nbsp;such&nbsp;request&nbsp;to&nbsp;a&nbsp;parent.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;If&nbsp;my&nbsp;theory&nbsp;about&nbsp;absolute&nbsp;vs&nbsp;relative&nbsp;URL&nbsp;is&nbsp;correct&nbsp;then&nbsp;I&nbsp;believe&nbsp;original&nbsp;squid&nbsp;should&nbsp;make &lt;/span&gt;&lt;/font&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;store_digest&nbsp;request&nbsp;using&nbsp;relative&nbsp;URL&nbsp;(like&nbsp;I&nbsp;can&nbsp;do&nbsp;with&nbsp;telnet)&nbsp;so&nbsp;sibling&nbsp;squid&nbsp;will&nbsp;return&nbsp;response&nbsp;right&nbsp;away&nbsp;w/o&nbsp;asking&nbsp;itself&nbsp;for&nbsp;result.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;This&nbsp;is&nbsp;more&nbsp;complete&nbsp;config&nbsp;(only&nbsp;stripped&nbsp;default&nbsp;things&nbsp;like &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;localnet &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;acls&nbsp;/&nbsp;http_access),&nbsp;n&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;ote&nbsp;that&nbsp;I&nbsp;have&nbsp;2&nbsp;parents&nbsp;actually&nbsp;which&nbsp;I&nbsp;select&nbsp;based&nbsp;on&nbsp;header&nbsp;(but&nbsp;all&nbsp;requests&nbsp;w/o&nbsp;header&nbsp;will&nbsp;go&nbsp;to&nbsp;the&nbsp;first&nbsp;parent),&nbsp;and&nbsp;also&nbsp;have:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;via&nbsp;off&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;never_direct&nbsp;allow&nbsp;all&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;forwarded_for&nbsp;off&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;#&nbsp;START&nbsp;CONFIG&nbsp;==========&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;==========&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;Allow&nbsp;HTCP&nbsp;queries&nbsp;from&nbsp;local&nbsp;networks&nbsp;only&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;htcp_access&nbsp;allow&nbsp;localnet&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;htcp_access&nbsp;allow&nbsp;localhost&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;htcp_access&nbsp;deny&nbsp;all&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;Other&nbsp;squids&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;172.22.15.88&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;…&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;siblings&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88/32&quot;&gt;172.22.15.88/32&lt;/a&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;siblings&nbsp;src&nbsp;…/32&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;miss_access&nbsp;deny&nbsp;siblings&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;header_a&nbsp;req_header&nbsp;header_a&nbsp;-i&nbsp;true&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;header_b&nbsp;req_header&nbsp;header_b&nbsp;-i&nbsp;true&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;name1&nbsp;parent&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18070&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name1&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;name1&nbsp;deny&nbsp;header_a&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;name1&nbsp;deny&nbsp;header_b&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;name2&nbsp;parent&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18079&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name2&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;name2&nbsp;allow&nbsp;header_a&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;name2&nbsp;allow&nbsp;header_b&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;name2&nbsp;deny&nbsp;all&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_mem&nbsp;…&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;maximum_object_size_in_memory&nbsp;…&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;memory_replacement_policy&nbsp;…&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_replacement_policy&nbsp;…&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_dir&nbsp;aufs&nbsp;…&nbsp;…&nbsp;16&nbsp;256&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;minimum_object_size&nbsp;…&nbsp;bytes&nbsp;#&nbsp;none-zero&nbsp;so&nbsp;we&nbsp;dont&nbsp;cache&nbsp;mistakes&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;maximum_object_size&nbsp;…&nbsp;KB&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;client_db&nbsp;off&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;refresh_pattern&nbsp;^ftp:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1440&nbsp; &nbsp; 20%&nbsp; &nbsp; &nbsp;10080&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;refresh_pattern&nbsp;^gopher:&nbsp; &nbsp; &nbsp; &nbsp; 1440&nbsp; &nbsp; 0%&nbsp; &nbsp; &nbsp; 1440&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp; &nbsp; &nbsp;0%&nbsp; &nbsp; &nbsp; 0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;refresh_pattern&nbsp;.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;20%&nbsp; &nbsp; &nbsp;4320&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;don&#39;t&nbsp;cache&nbsp;errors&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;negative_ttl&nbsp;0&nbsp;minutes&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;always&nbsp;fetch&nbsp;object&nbsp;from&nbsp;the&nbsp;beginning&nbsp;regardless&nbsp;of&nbsp;Range&nbsp;requests&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;range_offset_limit&nbsp;none&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;via&nbsp;off&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_effective_user&nbsp;squid&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_effective_group&nbsp;squid&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;disable&nbsp;icp&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;icp_port&nbsp;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;never_direct&nbsp;allow&nbsp;all&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;forwarded_for&nbsp;off&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;#&nbsp;END&nbsp;CONFIG&nbsp;==========&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;==========&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Dec&nbsp;28,&nbsp;2016&nbsp;at&nbsp;11:15&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;2016-12-29&nbsp;16:03,&nbsp;Ivan&nbsp;Larionov&nbsp;wrote:&lt;br&gt;<br>
&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;<br>
Hello!&lt;br&gt;<br>
&lt;br&gt;<br>
I&#39;m&nbsp;trying&nbsp;to&nbsp;setup&nbsp;multiple&nbsp;squids&nbsp;as&nbsp;siblings&nbsp;with&nbsp;a&nbsp;parent&nbsp;which&nbsp;is&lt;br&gt;<br>
not&nbsp;even&nbsp;a&nbsp;squid.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;I&#39;m&nbsp;getting&nbsp;following&nbsp;message&nbsp;in&nbsp;logs:&lt;br&gt;<br>
&lt;br&gt;<br>
temporary&nbsp;disabling&nbsp;(Bad&nbsp;Gateway)&nbsp;digest&nbsp;from&nbsp;172.22.15.88&lt;br&gt;<br>
&lt;br&gt;<br>
temporary&nbsp;disabling&nbsp;(Bad&nbsp;Gateway)&nbsp;digest&nbsp;from&nbsp;…&lt;br&gt;<br>
&lt;br&gt;<br>
Squid&nbsp;3.5.23,&nbsp;compiled&nbsp;with&nbsp;&quot;--enable-cache-digests&quot;.&lt;br&gt;<br>
&lt;br&gt;<br>
For&nbsp;parent&nbsp;I&#39;m&nbsp;setting&nbsp;no-digest,&nbsp;but&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;get&nbsp;digests&nbsp;between&lt;br&gt;<br>
siblings.&nbsp;However,&nbsp;it&nbsp;doesn&#39;t&nbsp;work&nbsp;and&nbsp;I&nbsp;probably&nbsp;found&nbsp;a&nbsp;reason&nbsp;after&lt;br&gt;<br>
reading&nbsp;debug&nbsp;logs:&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;how&nbsp;squid&nbsp;does&nbsp;store_digest&nbsp;request&nbsp;from&nbsp;a&nbsp;sibling&nbsp;peer:&lt;br&gt;<br>
&lt;br&gt;&lt;/span&gt;<br>
GET&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://172.22.15.88:3128/squid&lt;wbr&gt;-internal-periodic/store_diges&lt;wbr&gt;t&lt;/a&gt;&nbsp;[1]&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
HTTP/1.1&lt;br&gt;<br>
Accept:&nbsp;application/cache-digest&lt;br&gt;<br>
Accept:&nbsp;text/html&lt;br&gt;<br>
X-Forwarded-For:&nbsp;unknown&lt;br&gt;&lt;/span&gt;<br>
Host:&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.22.15.88:3128&lt;/a&gt;&nbsp;[2]&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
Cache-Control:&nbsp;max-age=259200&lt;br&gt;<br>
Connection:&nbsp;keep-alive&lt;br&gt;<br>
&lt;br&gt;<br>
Response&nbsp;(if&nbsp;I&nbsp;execute&nbsp;this&nbsp;request&nbsp;manually&nbsp;from&nbsp;telnet):&lt;br&gt;<br>
&lt;br&gt;<br>
HTTP/1.1&nbsp;502&nbsp;Bad&nbsp;Gateway&lt;br&gt;<br>
…&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;request&nbsp;has&nbsp;been&nbsp;forwarded&nbsp;to&nbsp;a&nbsp;parent&nbsp;and&nbsp;parent&nbsp;returned&nbsp;502!&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Are&nbsp;you&nbsp;sure&nbsp;about&nbsp;that&nbsp;forwarding?&lt;br&gt;<br>
 Its&nbsp;not&nbsp;being&nbsp;generated&nbsp;by&nbsp;the&nbsp;sibling?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;<br>
Now&nbsp;if&nbsp;I&nbsp;manually&nbsp;do&nbsp;the&nbsp;same&nbsp;request&nbsp;with&nbsp;a&nbsp;relative&nbsp;URL:&lt;br&gt;<br>
&lt;br&gt;<br>
GET&nbsp;/squid-internal-periodic/store&lt;wbr&gt;_digest&nbsp;HTTP/1.1&lt;br&gt;<br>
…&lt;br&gt;<br>
&lt;br&gt;<br>
Response:&lt;br&gt;<br>
&lt;br&gt;<br>
HTTP/1.1&nbsp;200&nbsp;Cache&nbsp;Digest&nbsp;OK&lt;br&gt;<br>
…&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;setup:&lt;br&gt;<br>
&lt;br&gt;<br>
Multiple&nbsp;squids&nbsp;as&nbsp;siblings,&nbsp;one&nbsp;parent&nbsp;(not&nbsp;a&nbsp;squid).&lt;br&gt;<br>
&lt;br&gt;<br>
Peers&nbsp;configuration:&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;Other&nbsp;squids&lt;br&gt;<br>
cache_peer&nbsp;172.22.15.88&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;br&gt;<br>
cache_peer&nbsp;…&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;br&gt;&lt;/span&gt;<br>
acl&nbsp;siblings&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.22.15.88/32&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.22.15.88/32&lt;/a&gt;&nbsp;[3]&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
acl&nbsp;siblings&nbsp;src&nbsp;…/32&lt;br&gt;<br>
miss_access&nbsp;deny&nbsp;siblings&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;Parent&lt;br&gt;<br>
cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18070&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=NAME&lt;br&gt;<br>
cache_peer_access&nbsp;NAME&nbsp;deny&nbsp;some_acl&lt;br&gt;<br>
&lt;br&gt;<br>
Anyone&nbsp;else&nbsp;seen&nbsp;similar&nbsp;issue?&nbsp;Do&nbsp;you&nbsp;have&nbsp;an&nbsp;example&nbsp;of&nbsp;working&lt;br&gt;<br>
configuration&nbsp;with&nbsp;multiple&nbsp;siblings&nbsp;and&nbsp;enabled&nbsp;digests?&lt;br&gt;<br>
&lt;/span&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
The&nbsp;default&nbsp;config&nbsp;usually&nbsp;just&nbsp;works.&lt;br&gt;<br>
&lt;br&gt;<br>
Do&nbsp;you&nbsp;have&nbsp;&quot;global_internal_static&nbsp;off&quot;&nbsp;in&nbsp;your&nbsp;squid.conf?&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.&lt;wbr&gt;org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/l&lt;wbr&gt;istinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;With&nbsp;best&nbsp;regards,&nbsp;Ivan&nbsp;Larionov.&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
