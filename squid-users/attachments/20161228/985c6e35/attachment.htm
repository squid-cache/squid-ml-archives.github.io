<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Hello!&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;setup&nbsp;multiple&nbsp;squids&nbsp;as&nbsp;siblings&nbsp;with&nbsp;a&nbsp;parent&nbsp;which&nbsp;is&nbsp;not&nbsp;even&nbsp;a&nbsp;squid.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;But&nbsp;I&#39;m&nbsp;getting&nbsp;following&nbsp;message&nbsp;in&nbsp;logs:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;temporary&nbsp;disabling&nbsp;(Bad&nbsp;Gateway)&nbsp;digest&nbsp;from&nbsp;172.22.15.88&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;temporary&nbsp;disabling&nbsp;(Bad&nbsp;Gateway)&nbsp;digest&nbsp;from&nbsp;…&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Squid&nbsp;3.5.23,&nbsp;compiled&nbsp;with&nbsp;&quot;--enable-cache-digests&quot;.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;For&nbsp;parent&nbsp;I&#39;m&nbsp;setting&nbsp;no-digest,&nbsp;but&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;get&nbsp;digests&nbsp;between&nbsp;siblings.&nbsp;However,&nbsp;it&nbsp;doesn&#39;t&nbsp;work&nbsp;and&nbsp;I&nbsp;probably&nbsp;found&nbsp;a&nbsp;reason&nbsp;after&nbsp;reading&nbsp;debug&nbsp;logs:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;This&nbsp;is&nbsp;how&nbsp;squid&nbsp;does&nbsp;store_digest&nbsp;request&nbsp;from&nbsp;a&nbsp;sibling&nbsp;peer:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;GET &lt;a&nbsp;href=&quot;http://172.22.15.88:3128/squid-internal-periodic/store_digest&quot;&nbsp;target=&quot;_blank&quot;&gt;http://172.22.15.88:3128/&lt;wbr&gt;squid-internal-periodic/store_&lt;wbr&gt;digest&lt;/a&gt; HTTP/1.1&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Accept:&nbsp;application/cache-digest&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Accept:&nbsp;text/html&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;X-Forwarded-For:&nbsp;unknown&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Host: &lt;a&nbsp;href=&quot;http://172.22.15.88:3128/&quot;&nbsp;target=&quot;_blank&quot;&gt;172.22.15.88:3128&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Cache-Control:&nbsp;max-age=259200&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Connection:&nbsp;keep-alive&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Response&nbsp;(if&nbsp;I&nbsp;execute&nbsp;this&nbsp;request&nbsp;manually&nbsp;from&nbsp;telnet):&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;HTTP/1.1&nbsp;502&nbsp;Bad&nbsp;Gateway&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;…&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;This&nbsp;request&nbsp;has&nbsp;been&nbsp;forwarded&nbsp;to&nbsp;a&nbsp;parent&nbsp;and&nbsp;parent&nbsp;returned&nbsp;502!&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Now&nbsp;if&nbsp;I&nbsp;manually&nbsp;do&nbsp;the&nbsp;same&nbsp;request&nbsp;with&nbsp;a&nbsp;relative&nbsp;URL:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;GET&nbsp;/squid-internal-periodic/&lt;wbr&gt;store_digest&nbsp;HTTP/1.1&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;…&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Response:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;HTTP/1.1&nbsp;200&nbsp;Cache&nbsp;Digest&nbsp;OK&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;…&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;My&nbsp;setup:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Multiple&nbsp;squids&nbsp;as&nbsp;siblings,&nbsp;one&nbsp;parent&nbsp;(not&nbsp;a&nbsp;squid).&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Peers&nbsp;configuration:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;Other&nbsp;squids&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;172.22.15.88&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;…&nbsp;sibling&nbsp;3128&nbsp;4827&nbsp;htcp&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;siblings&nbsp;src &lt;a&nbsp;href=&quot;http://172.22.15.88/32&quot;&nbsp;target=&quot;_blank&quot;&gt;172.22.15.88/32&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;acl&nbsp;siblings&nbsp;src&nbsp;…/32&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;miss_access&nbsp;deny&nbsp;siblings&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;Parent&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18070&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=NAME&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;cache_peer_access&nbsp;NAME&nbsp;deny&nbsp;some_acl&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:12.8px&quot;&gt;Anyone&nbsp;else&nbsp;seen&nbsp;similar&nbsp;issue?&nbsp;Do&nbsp;you&nbsp;have&nbsp;an&nbsp;example&nbsp;of&nbsp;working&nbsp;configuration&nbsp;with&nbsp;multiple&nbsp;siblings&nbsp;and&nbsp;enabled&nbsp;digests?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;With&nbsp;best&nbsp;regards,&nbsp;Ivan&nbsp;Larionov.&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
