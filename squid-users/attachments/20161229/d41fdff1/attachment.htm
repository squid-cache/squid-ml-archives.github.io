<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;see&nbsp;behavior&nbsp;change&nbsp;after&nbsp;update&nbsp;from&nbsp;squid&nbsp;2.7&nbsp;to&nbsp;3.5:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;following&nbsp;ACLs&nbsp;which&nbsp;I&nbsp;later&nbsp;use&nbsp;for cache_peer_access:&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;acl&nbsp;header&nbsp;req_header&nbsp;header_a&nbsp;-i&nbsp;true&lt;/div&gt;&lt;div&gt;acl&nbsp;header req_header&nbsp;header_b&nbsp;-i&nbsp;true&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;name1&nbsp;parent&lt;/div&gt;&lt;div&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18070&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name1&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name1&nbsp;deny&nbsp;header&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;name2&nbsp;parent&lt;/div&gt;&lt;div&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18079&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name2&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name2&nbsp;allow&nbsp;header&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name2&nbsp;deny&nbsp;all&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;With&nbsp;squid&nbsp;2.7&nbsp;it&nbsp;was&nbsp;working&nbsp;as&nbsp;expected&nbsp;(requests&nbsp;with&nbsp;header_a&nbsp;OR&nbsp;header_b&nbsp;were&nbsp;going&nbsp;to&nbsp;the&nbsp;second&nbsp;parent,&nbsp;all&nbsp;other&nbsp;requests&nbsp;to&nbsp;the&nbsp;first&nbsp;one).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However&nbsp;with&nbsp;squid&nbsp;3.5&nbsp;the&nbsp;same&nbsp;config&nbsp;doesn&#39;t&nbsp;work&nbsp;as&nbsp;expected.&nbsp;ONLY&nbsp;requests&nbsp;with&nbsp;header_b&nbsp;are&nbsp;going&nbsp;to&nbsp;the&nbsp;second&nbsp;parent&nbsp;and&nbsp;debug&nbsp;logs&nbsp;show&nbsp;that&nbsp;squid&nbsp;only&nbsp;does&nbsp;verification&nbsp;of&nbsp;header_b.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;current&nbsp;workaround&nbsp;is&nbsp;to&nbsp;use&nbsp;2&nbsp;different&nbsp;ACL&nbsp;names:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;acl&nbsp;header_a&nbsp;req_header&nbsp;header_a&nbsp;-i&nbsp;true&lt;/div&gt;&lt;div&gt;acl&nbsp;header_b&nbsp;req_header&nbsp;header_b&nbsp;-i&nbsp;true&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;name1&nbsp;parent&lt;/div&gt;&lt;div&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18070&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name1&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name1&nbsp;deny&nbsp;header_a&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name1&nbsp;deny&nbsp;header_b&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;name2&nbsp;parent&lt;/div&gt;&lt;div&gt;cache_peer&nbsp;127.0.0.1&nbsp;parent&nbsp;18079&nbsp;0&nbsp;no-query&nbsp;no-digest&nbsp;name=name2&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name2&nbsp;allow&nbsp;header_a&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name2&nbsp;allow&nbsp;header_b&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;name2&nbsp;deny&nbsp;all&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;I&nbsp;think&nbsp;it&nbsp;could&nbsp;be&nbsp;a&nbsp;bug.&nbsp;Multiple&nbsp;ACLs&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;should&nbsp;work&nbsp;as&nbsp;OR,&nbsp;right?&nbsp;Do&nbsp;I&nbsp;understand&nbsp;it&nbsp;correctly?&nbsp;And&nbsp;it&nbsp;was&nbsp;working&nbsp;as&nbsp;expected&nbsp;in&nbsp;2.7.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Has&nbsp;anyone&nbsp;saw&nbsp;similar&nbsp;behavior?&nbsp;Should&nbsp;I&nbsp;report&nbsp;a&nbsp;bug?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&gt;With&nbsp;best&nbsp;regards,&nbsp;Ivan&nbsp;Larionov.&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
