# Hide real hostname
visible_hostname my_proxy

# Only allow cachemgr access from localhost
http_access allow localhost manager
http_access deny manager

# We strongly recommend the following be uncommented to protect innocent
# web applications running on the proxy server who think the only
# one who can access services on "localhost" is a local user
http_access deny to_localhost

http_access allow localhost

# Disable caching to save memory
cache deny all

# Limit memory pools, otherwise squid will consume all memory
memory_pools_limit 256 MB

# http_access directives, based on ACLs
include /etc/squid/acls.conf

# default policy
http_access allow all

mime_table /etc/squid/mime.conf
icon_directory /usr/share/squid/icons
error_directory /usr/share/squid/errors

coredump_dir none

refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320

# HTTP handling
http_port 3127
http_port 3128 tproxy

# HTTPS handling
include /etc/squid/ssl_bump.conf

# FTP handling
ftp_port 2121 tproxy
#ftp_sanitycheck off
#ftp_epsv deny all
always_direct allow all

logfile_daemon /usr/lib64/squid/log_file_daemon

# Like this:
# 26.08.2016 12:55:37 TCP_DENIED/302 GET text/html [1.2.3.4]:55880 -> [2.3.4.5]:80 http://ixbt.com/
logformat squid %{%d.%m.%Y %H:%M:%S}tl %Ss/%03Hs %rm %mt [%>a]:%>p -> [%<a]:%<p %>ru
access_log syslog:LOG_LOCAL3
