<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Greetings&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&#39;re&nbsp;using&nbsp;Squid&nbsp;3.5.19&nbsp;with&nbsp;ssl&nbsp;bump,&lt;br&gt;and&nbsp;we&nbsp;want&nbsp;to&nbsp;tunnel&nbsp;(not&nbsp;bump)&nbsp;applications&nbsp;such&nbsp;as&nbsp;skype,&nbsp;that&nbsp;use&nbsp;pinned&nbsp;ssl,&lt;br&gt;so&nbsp;we&nbsp;defined&nbsp;an&nbsp;acl&nbsp;for&nbsp;splicing&nbsp;skype&#39;s&nbsp;ssl_server_name.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However&nbsp;skype&#39;s&nbsp;client&nbsp;app&nbsp;uses&nbsp;client&nbsp;certificates&nbsp;that&nbsp;don&#39;t&nbsp;have&nbsp;SNI.&lt;br&gt;The&nbsp;only&nbsp;way&nbsp;to&nbsp;identify&nbsp;skype&nbsp;is&nbsp;its&nbsp;Common&nbsp;Name:&nbsp;*.&lt;a&nbsp;href=&quot;http://dc.trouter.io/&quot;&nbsp;target=&quot;_blank&quot;&gt;dc.trouter.io&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;the&nbsp;Common&nbsp;Name&nbsp;is&nbsp;available&nbsp;only&nbsp;in&nbsp;step3&nbsp;of&nbsp;ssl&nbsp;bump,&lt;br&gt;where&nbsp;tunneling&nbsp;the&nbsp;connection&nbsp;is&nbsp;no&nbsp;longer&nbsp;possible&nbsp;(as&nbsp;documented&nbsp;in&nbsp;peek&nbsp;and&nbsp;splice&nbsp;step3&nbsp;docs).&lt;/div&gt;&lt;div&gt;What&nbsp;we&nbsp;get&nbsp;is&nbsp;bumping.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;we&nbsp;can&nbsp;tunnel&nbsp;an&nbsp;acl&nbsp;based&nbsp;on&nbsp;Common&nbsp;Name?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ty&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;http_port&nbsp;3127&lt;br&gt;http_port&nbsp;3128&nbsp;intercept&lt;br&gt;https_port&nbsp;3129&nbsp;ssl-bump&nbsp;intercept&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4M&lt;wbr&gt;B&nbsp;cert=/etc/squid/ssl_cert/myCA.&lt;wbr&gt;pem&lt;br&gt;always_direct&nbsp;allow&nbsp;all&lt;br&gt;acl&nbsp;DiscoverSNIHost&nbsp;at_step&nbsp;SslBump1&lt;br&gt;acl&nbsp;NoSSLIntercept&nbsp;ssl::server_name_regex&nbsp;-i&nbsp;(microsoft|msn|windows|update|&lt;a&nbsp;href=&quot;http://skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;wbr&gt;skype.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://go.trouter.io/&quot;&nbsp;target=&quot;_blank&quot;&gt;go.trouter.io&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://secure.adnxs.compipe.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;secure&lt;wbr&gt;.adnxs.compipe.skype.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://skype-m.hotmail.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;skype&lt;wbr&gt;-m.hotmail.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://mobile.pipe.aria.microsoft.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;mobile.pipe.ari&lt;wbr&gt;a.microsoft.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://edge.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;edge.skype.com&lt;/a&gt;&lt;wbr&gt;|&lt;a&nbsp;href=&quot;http://api.cc.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;api.cc.skype.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://a.config.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;a.config.sky&lt;wbr&gt;pe.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://clientlogin.cdn.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;clientlogin.cdn.skype.c&lt;wbr&gt;om&lt;/a&gt;|.&lt;a&nbsp;href=&quot;http://dc.trouter.io/&quot;&nbsp;target=&quot;_blank&quot;&gt;dc.trouter.io&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://ui.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;ui.skype.com&lt;/a&gt;&lt;wbr&gt;|&lt;a&nbsp;href=&quot;http://apps.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;apps.skype.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://registrar-rr.prod.registrar.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;registrar-rr.&lt;wbr&gt;prod.registrar.skype.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://secure.skypeassets.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;secur&lt;wbr&gt;e.skypeassets.com&lt;/a&gt;|&lt;a&nbsp;href=&quot;http://c1.skype.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;c1.skype.com&lt;/a&gt;&lt;wbr&gt;)&lt;br&gt;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&lt;br&gt;ssl_bump&nbsp;peek&nbsp;DiscoverSNIHost&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sslproxy_cert_error&nbsp;allow&nbsp;all&lt;br&gt;sslproxy_flags&nbsp;DONT_VERIFY_PEER&lt;br&gt;sslcrtd_program&nbsp;/usr/lib/squid/ssl_crtd&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;sslcrtd_children&nbsp;5&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
