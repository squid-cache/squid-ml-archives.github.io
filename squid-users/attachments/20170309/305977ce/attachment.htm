<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:HelveticaNeue,&nbsp;Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;Arial,&nbsp;Lucida&nbsp;Grande,&nbsp;Sans-Serif;font-size:10px&quot;&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7258&quot;&gt;&lt;span&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7331&quot;&gt;&lt;font&nbsp;size=&quot;3&quot;&gt;Here&nbsp;is&nbsp;the&nbsp;conf&nbsp;file.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7258&quot;&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7415&quot;&gt;http_port&nbsp;3128&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7416&quot;&nbsp;dir=&quot;ltr&quot;&gt;cache_peer&nbsp;&lt;corp_proxy_IP&gt;&nbsp;parent&nbsp;&lt;Parent_proxy_port&gt;&nbsp;0&nbsp;no-query&nbsp;default&nbsp;proxy-only&nbsp;login=NEGOTIATE&nbsp;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7417&quot;&gt;&lt;br&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7418&quot;&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7419&quot;&gt;acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7420&quot;&gt;acl&nbsp;localhost&nbsp;src&nbsp;127.0.0.1/255.255.255.255&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7421&quot;&gt;acl&nbsp;all&nbsp;src&nbsp;0.0.0.0/0.0.0.0&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7422&quot;&gt;http_access&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7423&quot;&gt;never_direct&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7424&quot;&gt;icp_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7425&quot;&gt;&lt;br&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7426&quot;&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7427&quot;&gt;cache_effective_user&nbsp;squid&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7428&quot;&gt;#cache_effective_group&nbsp;wheel&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7429&quot;&gt;&lt;br&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7430&quot;&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7258&quot;&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7431&quot;&gt;max_filedescriptors&nbsp;3200&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7259&quot;&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7259&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;3&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7758&quot;&gt;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;what&nbsp;is&nbsp;it&nbsp;that&nbsp;I&nbsp;am&nbsp;missing.&nbsp;I&nbsp;have&nbsp;been&nbsp;wire&nbsp;sharking&nbsp;both&nbsp;the&nbsp;resultant&nbsp;packets&nbsp;when&nbsp;using&nbsp;CNTLM&nbsp;and&nbsp;when&nbsp;using&nbsp;squid,&nbsp;I&nbsp;can&nbsp;see&nbsp;the&nbsp;proxy&nbsp;auth&nbsp;header&nbsp;piece&nbsp;in&nbsp;the&nbsp;Squid&nbsp;packet&nbsp;missing.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7259&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;signature&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7261&quot;&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7260&quot;&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;Cheers&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7262&quot;&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7272&quot;&gt;S.V.Hareesh&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7263&quot;&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7271&quot;&gt;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://svhareesh.blogspot.com/&quot;&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7270&quot;&gt;http://svhareesh.blogspot.com&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7264&quot;&gt;&lt;em&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;helvetica,&nbsp;sans-serif&quot;&nbsp;color=&quot;#ff0000&quot;&gt;&lt;/font&gt;&lt;/em&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;id=&quot;yui_3_16_0_ym19_1_1489080309484_7268&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&nbsp;&lt;div&nbsp;class=&quot;qtdSeparateBR&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;yahoo_quoted&quot;&nbsp;style=&quot;display:&nbsp;block;&quot;&gt;&nbsp;&lt;div&nbsp;style=&quot;font-family:&nbsp;HelveticaNeue,&nbsp;Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;Arial,&nbsp;Lucida&nbsp;Grande,&nbsp;Sans-Serif;&nbsp;font-size:&nbsp;10px;&quot;&gt;&nbsp;&lt;div&nbsp;style=&quot;font-family:&nbsp;HelveticaNeue,&nbsp;Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;Arial,&nbsp;Lucida&nbsp;Grande,&nbsp;Sans-Serif;&nbsp;font-size:&nbsp;16px;&quot;&gt;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;Arial&quot;&gt;&nbsp;On&nbsp;Thursday,&nbsp;9&nbsp;March&nbsp;2017&nbsp;5:20&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&nbsp;wrote:&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&nbsp;&nbsp;&lt;br&gt;&lt;br&gt;&nbsp;&lt;div&nbsp;class=&quot;y_msg_container&quot;&gt;On&nbsp;10/03/2017&nbsp;6:00&nbsp;a.m.,&nbsp;S&nbsp;V&nbsp;Hareesh&nbsp;wrote:&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Ok,&nbsp;I&nbsp;tried&nbsp;that&nbsp;but&nbsp;it&nbsp;didnt&nbsp;work.&nbsp;I&nbsp;can&nbsp;put&nbsp;a&nbsp;conf&nbsp;file&nbsp;here.&nbsp;As&nbsp;a&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;start&nbsp;I&nbsp;am&nbsp;currently&nbsp;in&nbsp;a&nbsp;scenario&nbsp;trying&nbsp;to&nbsp;replace&nbsp;a&nbsp;simple&nbsp;CNTLM&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;HTTP&nbsp;proxy&nbsp;with&nbsp;Squid.&nbsp;I&nbsp;want&nbsp;to&nbsp;configure&nbsp;one&nbsp;account&nbsp;which&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;authenticates&nbsp;with&nbsp;parent&nbsp;proxy&nbsp;send&nbsp;the&nbsp;downstream&nbsp;requests&nbsp;with&nbsp;out&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;taking&nbsp;any&nbsp;creds.&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;If&nbsp;your&nbsp;CNTLM&nbsp;was&nbsp;running&nbsp;on&nbsp;the&nbsp;Squid&nbsp;machine&nbsp;and&nbsp;using&nbsp;the&nbsp;credentials&lt;br&nbsp;clear=&quot;none&quot;&gt;for&nbsp;the&nbsp;service&nbsp;account&nbsp;you&nbsp;have&nbsp;setup&nbsp;Squid&nbsp;to&nbsp;use&nbsp;now&nbsp;-&nbsp;then&nbsp;the&lt;br&nbsp;clear=&quot;none&quot;&gt;cache_peer&nbsp;login=NEGOTIATE&nbsp;should&nbsp;make&nbsp;Squid&nbsp;operate&nbsp;as&nbsp;equivalent&nbsp;to&lt;br&nbsp;clear=&quot;none&quot;&gt;what&nbsp;CNTLM&nbsp;was&nbsp;doing.&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;The&nbsp;config&nbsp;file&nbsp;would&nbsp;be&nbsp;useful&nbsp;for&nbsp;anyone&nbsp;who&nbsp;follows&nbsp;up&nbsp;(not&nbsp;just&nbsp;me,&lt;br&nbsp;clear=&quot;none&quot;&gt;who&nbsp;will&nbsp;be&nbsp;out&nbsp;of&nbsp;time&nbsp;shortly&nbsp;for&nbsp;another&nbsp;few&nbsp;days).&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;Also,&nbsp;if&nbsp;you&nbsp;can&nbsp;track&nbsp;what&nbsp;HTTP&nbsp;messages&nbsp;are&nbsp;happening&nbsp;and&nbsp;whether&nbsp;the&lt;br&nbsp;clear=&quot;none&quot;&gt;Kerberos&nbsp;is&nbsp;working&nbsp;properly&nbsp;for&nbsp;the&nbsp;Squid-&gt;parent&nbsp;messages&nbsp;it&nbsp;would&nbsp;be&lt;br&nbsp;clear=&quot;none&quot;&gt;useful.&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;The&nbsp;current&nbsp;Squid&nbsp;can&nbsp;provide&nbsp;HTTP&nbsp;details&nbsp;in&nbsp;cache.log&nbsp;with&lt;br&nbsp;clear=&quot;none&quot;&gt;&quot;debug_options&nbsp;11,2&quot;.&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;how&nbsp;you&nbsp;would&nbsp;test&nbsp;the&nbsp;Kerberos&nbsp;on&nbsp;a&lt;br&nbsp;clear=&quot;none&quot;&gt;Windows&nbsp;installation,&nbsp;but&nbsp;the&nbsp;Negotiate&nbsp;auth&nbsp;headers&nbsp;in&nbsp;those&nbsp;messages&lt;br&nbsp;clear=&quot;none&quot;&gt;might&nbsp;give&nbsp;a&nbsp;few&nbsp;clues&nbsp;anyway.&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;HTH&lt;br&nbsp;clear=&quot;none&quot;&gt;Amos&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&nbsp;&nbsp;On&nbsp;Thu,&nbsp;Mar&nbsp;9,&nbsp;2017&nbsp;at&nbsp;4:50&nbsp;PM,&nbsp;Amos&nbsp;Jeffrieswrote:&lt;div&nbsp;class=&quot;yqt7428556110&quot;&nbsp;id=&quot;yqtfd47234&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;10/03/2017&nbsp;5:19&nbsp;a.m.,&nbsp;S&nbsp;V&nbsp;Hareesh&nbsp;wrote:&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;On&nbsp;top&nbsp;of&nbsp;the&nbsp;conf&nbsp;file&nbsp;from&nbsp;default&nbsp;setup&nbsp;on&nbsp;Windows,&nbsp;I&nbsp;added&nbsp;the&nbsp;following&nbsp;line&nbsp;in&nbsp;the&nbsp;conf.&nbsp;I&nbsp;added&nbsp;the&nbsp;dns&nbsp;servers&nbsp;and&nbsp;allowed&nbsp;localhost.&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;cache_peer&nbsp;&lt;corporate_proxy&gt;&nbsp;parent&nbsp;80&nbsp;0&nbsp;default&nbsp;connection-auth=on&nbsp;proxy-only&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;never_direct&nbsp;allow&nbsp;all&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;When&nbsp;I&nbsp;point&nbsp;my&nbsp;browser&nbsp;to&nbsp;this&nbsp;proxy,&nbsp;it&nbsp;gives&nbsp;me&nbsp;407,&nbsp;auth&nbsp;required.&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&gt;&nbsp;Also,&nbsp;configured&nbsp;squid&nbsp;service&nbsp;on&nbsp;windows&nbsp;to&nbsp;run&nbsp;with&nbsp;a&nbsp;service&nbsp;account&nbsp;that&nbsp;has&nbsp;access&nbsp;to&nbsp;Internet/corp&nbsp;proxy.&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Squid&nbsp;cannot&nbsp;authenticate&nbsp;to&nbsp;a&nbsp;cache_peer&nbsp;using&nbsp;NTLM.&nbsp;It&nbsp;can&nbsp;only&nbsp;do&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Nagotiate/Kerberos&nbsp;to&nbsp;the&nbsp;parent&nbsp;proxy,&nbsp;and&nbsp;only&nbsp;when&nbsp;&quot;login=NEGOTIATE&quot;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;is&nbsp;added&nbsp;(with&nbsp;or&nbsp;without&nbsp;a&nbsp;named&nbsp;keytab&nbsp;file).&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;NOTE:&nbsp;'connection-auth=on'&nbsp;is&nbsp;about&nbsp;allowing&nbsp;the&nbsp;browser&nbsp;to&nbsp;use&nbsp;NTLM&nbsp;or&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Negotiate/Kerberos&nbsp;through&nbsp;the&nbsp;cache_peer.&nbsp;It&nbsp;needs&nbsp;to&nbsp;also&nbsp;have&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&quot;login=PASSTHRU&quot;&nbsp;if&nbsp;that&nbsp;peer&nbsp;is&nbsp;a&nbsp;proxy&nbsp;(as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;web&nbsp;or&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Exchange&nbsp;server).&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;See&nbsp;the&nbsp;'AUTHENTICATION&nbsp;OPTIONS'&nbsp;section&nbsp;of&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;&lt;a&nbsp;shape=&quot;rect&quot;&nbsp;href=&quot;http://www.squid-cache.org/Doc/config/cache_peer/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.squid-cache.org/Doc/config/cache_peer/&lt;/a&gt;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;Amos&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;_______________________________________________&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;a&nbsp;shape=&quot;rect&quot;&nbsp;ymailto=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;a&nbsp;shape=&quot;rect&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&gt;&nbsp;&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;br&nbsp;clear=&quot;none&quot;&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
