<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thank&nbsp;you,&nbsp;very&nbsp;helpful. &nbsp;Some&nbsp;more&nbsp;clarifying&nbsp;questions&nbsp;for&nbsp;you.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sorry&nbsp;for&nbsp;the&nbsp;imprecise&nbsp;language,&nbsp;I&nbsp;mean&nbsp;not&nbsp;interception&nbsp;but&nbsp;rather&nbsp;accepting&nbsp;connections&nbsp;to&nbsp;that&nbsp;port. &nbsp;Our&nbsp;browsers&nbsp;will&nbsp;be&nbsp;explicitly&nbsp;configured&nbsp;to&nbsp;connect&nbsp;our&nbsp;proxy,&nbsp;so&nbsp;I&nbsp;believe&nbsp;that&nbsp;is&nbsp;not&nbsp;interception?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;we&nbsp;want&nbsp;to&nbsp;only&nbsp;allow&nbsp;encrypted&nbsp;traffic&nbsp;between&nbsp;the&nbsp;browser&nbsp;and&nbsp;proxy,&nbsp;does&nbsp;that&nbsp;mean&nbsp;we&#39;d&nbsp;only&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;following&nbsp;line&nbsp;from&nbsp;your&nbsp;example?&lt;/div&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;#&nbsp;HTTPS&nbsp;proxy;&nbsp;clients&nbsp;establish&nbsp;TLS&nbsp;connections&nbsp;to&nbsp;31443&nbsp;(your&nbsp;item&nbsp;#1)&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;https_port&nbsp;31443&nbsp;ssl-bump&nbsp;...&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Once&nbsp;a&nbsp;handshake&nbsp;is&nbsp;done&nbsp;and&nbsp;tls&nbsp;connection&nbsp;is&nbsp;established&nbsp;here,&nbsp;would&nbsp;it&nbsp;be&nbsp;possible&nbsp;to&nbsp;have&nbsp;all&nbsp;http&nbsp;and&nbsp;https&nbsp;traffic&nbsp;from&nbsp;the&nbsp;browser&nbsp;go&nbsp;through&nbsp;31443? &nbsp;So&nbsp;squid&nbsp;would&nbsp;not&nbsp;need&nbsp;to&nbsp;have&nbsp;ports&nbsp;80&nbsp;and&nbsp;443&nbsp;open?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you,&lt;/div&gt;&lt;div&gt;-Masha&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;May&nbsp;31,&nbsp;2017&nbsp;at&nbsp;5:10&nbsp;PM,&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;05/31/2017&nbsp;02:42&nbsp;PM,&nbsp;Masha&nbsp;Lifshin&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;What&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;achieve&nbsp;is&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;1.&nbsp;an&nbsp;https&nbsp;connection&nbsp;between&nbsp;the&nbsp;client&nbsp;and&nbsp;squid&nbsp;proxy,&nbsp;as&nbsp;well&nbsp;as&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;2.&nbsp;listen&nbsp;on&nbsp;port&nbsp;80&nbsp;for&nbsp;http&nbsp;traffic,&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;3.&nbsp;on&nbsp;port&nbsp;443&nbsp;for&nbsp;ssl&nbsp;traffic,&nbsp;and&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;4.&nbsp;apply&nbsp;ssl-bump&nbsp;to&nbsp;the&nbsp;ssl&nbsp;traffic.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;I&nbsp;parsed&nbsp;your&nbsp;query&nbsp;correctly,&nbsp;and&nbsp;by&nbsp;&quot;listen&quot;&nbsp;you&nbsp;mean&nbsp;&quot;intercept&quot;,&lt;br&gt;<br>
and&nbsp;you&nbsp;want&nbsp;to&nbsp;apply&nbsp;SslBump&nbsp;to&nbsp;proxied&nbsp;SSL&nbsp;traffic&nbsp;on&nbsp;all&nbsp;ports,&nbsp;then&lt;br&gt;<br>
it&nbsp;looks&nbsp;like&nbsp;you&nbsp;will&nbsp;need&nbsp;three&nbsp;ports,&nbsp;each&nbsp;doing&nbsp;ssl-bump.&nbsp;In&nbsp;other&lt;br&gt;<br>
words,&nbsp;instead&nbsp;of&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;http_port&nbsp;80&nbsp;ssl-bump&nbsp;cert=some.cert.pem&nbsp;...&lt;br&gt;<br>
&gt;&nbsp;https_port&nbsp;443&nbsp;cert=other.cert.pem&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;will&nbsp;need&nbsp;something&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;HTTPS&nbsp;proxy;&nbsp;clients&nbsp;establish&nbsp;TLS&nbsp;connections&nbsp;to&nbsp;31443&nbsp;(your&nbsp;item&nbsp;#1)&lt;br&gt;<br>
https_port&nbsp;31443&nbsp;ssl-bump&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;HTTP-intercepting&nbsp;proxy&nbsp;(your&nbsp;item&nbsp;#2)&lt;br&gt;<br>
http_port&nbsp;80&nbsp;intercept&nbsp;ssl-bump&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;SSL-intercepting&nbsp;proxy&nbsp;(your&nbsp;item&nbsp;#3)&lt;br&gt;<br>
https_port&nbsp;443&nbsp;intercept&nbsp;ssl-bump&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;may&nbsp;need&nbsp;&quot;tproxy&quot;&nbsp;instead&nbsp;of&nbsp;&quot;intercept&quot;,&nbsp;depending&nbsp;on&nbsp;how&nbsp;you&nbsp;are&lt;br&gt;<br>
intercepting/forwarding&nbsp;traffic.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;actual&nbsp;port&nbsp;numbers&nbsp;do&nbsp;no&nbsp;matter.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Also&nbsp;wondering&nbsp;what,&nbsp;if&nbsp;any,&nbsp;are&nbsp;the&nbsp;security&nbsp;issues&nbsp;with&nbsp;using&nbsp;port&nbsp;80&lt;br&gt;<br>
&gt;&nbsp;for&nbsp;the&nbsp;http&nbsp;traffic?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Anybody&nbsp;with&nbsp;access&nbsp;to&nbsp;that&nbsp;traffic&nbsp;will&nbsp;be&nbsp;able&nbsp;to&nbsp;easily&nbsp;see&lt;br&gt;<br>
everything&nbsp;and,&nbsp;with&nbsp;a&nbsp;monumental&nbsp;effort,&nbsp;potentially&nbsp;occasionally&lt;br&gt;<br>
modify&nbsp;unencrypted&nbsp;traffic,&nbsp;including&nbsp;plain&nbsp;CONNECT&nbsp;requests&nbsp;that&lt;br&gt;<br>
establish&nbsp;secure&nbsp;channels.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Fri,&nbsp;May&nbsp;26,&nbsp;2017&nbsp;at&nbsp;7:19&nbsp;AM,&nbsp;Alex&nbsp;Rousskov&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; On&nbsp;05/26/2017&nbsp;12:00&nbsp;AM,&nbsp;Masha&nbsp;Lifshin&nbsp;wrote:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;I&nbsp;have&nbsp;added&nbsp;an&nbsp;https_port&nbsp;directive&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;to&nbsp;squid.conf,&nbsp;but&nbsp;it&nbsp;must&nbsp;be&nbsp;misconfigured.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;/span&gt;&gt; &nbsp; &nbsp; &gt;&nbsp;http_port&nbsp;&lt;a&nbsp;href=&quot;http://172.30.0.67:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.30.0.67:443&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://172.30.0.67:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://172.30.0.67:443&lt;/a&gt;&gt;&nbsp;...&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;https_port&nbsp;&lt;a&nbsp;href=&quot;http://172.30.0.67:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.30.0.67:443&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://172.30.0.67:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://172.30.0.67:443&lt;/a&gt;&gt;&nbsp;...&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; You&nbsp;are&nbsp;right&nbsp;--&nbsp;your&nbsp;Squid&nbsp;is&nbsp;misconfigured.&nbsp;You&nbsp;cannot&nbsp;use&nbsp;the&nbsp;same&lt;br&gt;<br>
&gt; &nbsp; &nbsp; address&nbsp;for&nbsp;two&nbsp;ports.&nbsp;Unfortunately,&nbsp;Squid&nbsp;thinks&nbsp;that&nbsp;port&nbsp;binding&lt;br&gt;<br>
&gt; &nbsp; &nbsp; errors&nbsp;are&nbsp;a&nbsp;minor&nbsp;inconvenience&nbsp;and&nbsp;continues&nbsp;running&nbsp;after&nbsp;logging&nbsp;an&lt;br&gt;<br>
&gt; &nbsp; &nbsp; error&nbsp;message&nbsp;(that&nbsp;looks&nbsp;like&nbsp;many&nbsp;other&nbsp;benign&nbsp;error&nbsp;messages).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Changing&nbsp;one&nbsp;of&nbsp;the&nbsp;ports&nbsp;will&nbsp;solve&nbsp;the&nbsp;&quot;same&nbsp;address&quot;&nbsp;problem&lt;br&gt;<br>
&gt; &nbsp; &nbsp; described&nbsp;above.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Do&nbsp;not&nbsp;use&nbsp;port&nbsp;443&nbsp;for&nbsp;http_port.&nbsp;It&nbsp;makes&nbsp;triage&nbsp;extremely&nbsp;confusing&lt;br&gt;<br>
&gt; &nbsp; &nbsp; because&nbsp;port&nbsp;443&nbsp;usually&nbsp;implies&nbsp;SSL.&nbsp;Consider&nbsp;using&nbsp;port&nbsp;3128&nbsp;instead.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; HTH,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Alex.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
