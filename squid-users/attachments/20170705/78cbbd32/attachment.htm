<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Let's&nbsp;open&nbsp;squid's&nbsp;default&nbsp;access.log:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;1499201177.345   &nbsp;155&nbsp;&lt;b&gt;172.16.100.3&lt;/b&gt;&nbsp;TCP_MISS/200&nbsp;633&nbsp;GET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://discovery-v4-4.syncthing.net/v2/?device=DEVICE_ID&quot;&gt;https://discovery-v4-4.syncthing.net/v2/?device=DEVICE_ID&lt;/a&gt;&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORIGINAL_DST/95.85.19.244&nbsp;application/json&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;third&nbsp;(.....|awk&nbsp;{'print&nbsp;$3'})&nbsp;is&nbsp;exactly&nbsp;client&nbsp;IP.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;How&nbsp;to&nbsp;get&nbsp;it&nbsp;in&nbsp;redirector?&nbsp;Read&nbsp;manual&nbsp;of&nbsp;yours&nbsp;redirector,&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;think.&nbsp;Usually&nbsp;this&nbsp;data&nbsp;exactly&nbsp;present&nbsp;in&nbsp;redirector&nbsp;logs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;because&nbsp;of&nbsp;this&nbsp;is&nbsp;_most_&nbsp;interesting&nbsp;data.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;moz-smiley-s3&quot;&gt;&lt;span&gt;;-)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;05.07.2017&nbsp;0:56,&nbsp;Muhammad&nbsp;Usman&nbsp;пишет:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
cite=&quot;mid:CAHfqhMm7m=FrX0pmqtuTQqYNNwnvbo7bWX+PQVyZMgAejVG2oA@mail.gmail.com&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;I&nbsp;have&nbsp;configured&nbsp;Squid&nbsp;and&nbsp;Dansguardian successfully&nbsp;on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ubuntu.&nbsp;I&nbsp;want&nbsp;to&nbsp;inject&nbsp;ads&nbsp;in&nbsp;user&nbsp;browsing&nbsp;(with&nbsp;user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consent). &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;I&nbsp;want&nbsp;to&nbsp;get&nbsp;details&nbsp;about&nbsp;the&nbsp;user&nbsp;like&nbsp;their&nbsp;IP&nbsp;etc&nbsp;but<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;dont&nbsp;know&nbsp;how&nbsp;to&nbsp;get&nbsp;this&nbsp;in&nbsp;Squid&nbsp;and&nbsp;then&nbsp;pass&nbsp;on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to dansguardian.&nbsp;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;appreciated.&nbsp;Thanks&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;_______________________________________________<br>
squid-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
