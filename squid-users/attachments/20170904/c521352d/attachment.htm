<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=utf-8&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;Hi&nbsp;amos&nbsp;,&nbsp;thanks&nbsp;for&nbsp;the&nbsp;kind&nbsp;response&nbsp;.&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;i&nbsp;denied&nbsp;to&nbsp;rebuild&nbsp;squid&nbsp;without&nbsp;IPV6&nbsp;support&nbsp;and&nbsp;seems&nbsp;now&nbsp;no&nbsp;error&nbsp;in&nbsp;helper&nbsp;.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;i&nbsp;just&nbsp;curious&nbsp;to&nbsp;know&nbsp;about&nbsp;the&nbsp;auth&nbsp;directors&nbsp;in&nbsp;squid&nbsp;how&nbsp;should&nbsp;i&nbsp;arrange&nbsp;it&nbsp;:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;all&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/lib/squid/basic_ncsa_auth&nbsp;&nbsp;/etc/squid/squid_user&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;acl&nbsp;ncsa_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;auth_param&nbsp;basic&nbsp;children&nbsp;1000&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;external_acl_type&nbsp;bandwidth_check&nbsp;ttl=0&nbsp;%SRC&nbsp;/usr/local/bin/bandwidth_check&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;acl&nbsp;bandwidth_auth&nbsp;external&nbsp;bandwidth_check&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;http_access&nbsp;allow&nbsp;localnet&nbsp;bandwidth_auth&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;http_access&nbsp;deny&nbsp;&nbsp;localnet&nbsp;!bandwidth_auth&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;###################################################&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;http_access&nbsp;allow&nbsp;ncsa_users&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;is&nbsp;above&nbsp;correct&nbsp;sequence&nbsp;to&nbsp;block&nbsp;any&nbsp;user&nbsp;exceeded&nbsp;quota&nbsp;?&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;also&nbsp;should&nbsp;i&nbsp;use&nbsp;&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;external_acl_type&nbsp;bandwidth_check&nbsp;ttl=0&nbsp;%SRC&nbsp;/usr/local/bin/bandwidth_check&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;or&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;external_acl_type&nbsp;bandwidth_check&nbsp;ttl=0&nbsp;%SRC&nbsp;%LOGIN&nbsp;/usr/local/bin/bandwidth_check&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;or&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;external_acl_type&nbsp;bandwidth_check&nbsp;ttl=0&nbsp;&nbsp;&lt;b&nbsp;class=&quot;&quot;&gt;%EXT_USER&lt;/b&gt;&nbsp;/usr/local/bin/bandwidth_check&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;thanks&nbsp;amos&nbsp;in&nbsp;advance&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Sep&nbsp;4,&nbsp;2017,&nbsp;at&nbsp;8:10&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;class=&quot;&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;04/09/17&nbsp;07:49,&nbsp;--Ahmad--&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;Hello&nbsp;squid&nbsp;folks&nbsp;.&lt;br&nbsp;class=&quot;&quot;&gt;I’m&nbsp;trying&nbsp;to&nbsp;use&nbsp;squid&nbsp;external&nbsp;helper&nbsp;to&nbsp;get&nbsp;quote&nbsp;to&nbsp;ips&nbsp;or&nbsp;users.&lt;br&nbsp;class=&quot;&quot;&gt;I’m&nbsp;following&nbsp;the&nbsp;wiki&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;http://www.mikealeonetti.com/wiki/index.php?title=Squid_Arms_and_Tentacles:_Bandwidth_quotas&quot;&nbsp;class=&quot;&quot;&gt;http://www.mikealeonetti.com/wiki/index.php?title=Squid_Arms_and_Tentacles:_Bandwidth_quotas&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;i&nbsp;have&nbsp;done&nbsp;everything&nbsp;my&nbsp;side&nbsp;on&nbsp;squid&nbsp;.&lt;br&nbsp;class=&quot;&quot;&gt;i&nbsp;have&nbsp;tested&nbsp;the&nbsp;connection&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;root@localhost:~#&nbsp;/usr/local/bin/bandwidth_calculate&nbsp;/etc/squid/bandwidth_rules&lt;br&nbsp;class=&quot;&quot;&gt;root@localhost:~#&lt;br&nbsp;class=&quot;&quot;&gt;no&nbsp;errors&nbsp;above&nbsp;!&lt;br&nbsp;class=&quot;&quot;&gt;#######################################&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;issue&nbsp;I’m&nbsp;not&nbsp;sure&nbsp;if&nbsp;I’m&nbsp;using&nbsp;squid&nbsp;config&nbsp;file&nbsp;integration&nbsp;correctly&nbsp;.&lt;br&nbsp;class=&quot;&quot;&gt;here&nbsp;is&nbsp;my&nbsp;squid.conf&nbsp;file&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;dns_v4_first&nbsp;on&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;all&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;You&nbsp;have&nbsp;defined&nbsp;your&nbsp;LAN&nbsp;to&nbsp;be&nbsp;the&nbsp;entire&nbsp;Internet.&nbsp;Don't&nbsp;do&nbsp;that.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Define&nbsp;localnet&nbsp;to&nbsp;be&nbsp;your&nbsp;actual&nbsp;network&nbsp;ranges.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Use&nbsp;the&nbsp;provided&nbsp;'all'&nbsp;ACL&nbsp;to&nbsp;refer&nbsp;to&nbsp;things&nbsp;that&nbsp;are&nbsp;allowed/denied&nbsp;to&nbsp;everyone&nbsp;online.&nbsp;Most&nbsp;of&nbsp;the&nbsp;time&nbsp;'all'&nbsp;is&nbsp;unnecessary.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;If&nbsp;you&nbsp;expect&nbsp;clients&nbsp;from&nbsp;the&nbsp;general&nbsp;web&nbsp;to&nbsp;access&nbsp;your&nbsp;proxy&nbsp;and&nbsp;some&nbsp;access&nbsp;control&nbsp;to&nbsp;apply&nbsp;to&nbsp;them,&nbsp;then&nbsp;simply&nbsp;do&nbsp;not&nbsp;limit&nbsp;those&nbsp;access&nbsp;controls&nbsp;with&nbsp;the&nbsp;'localnet'&nbsp;ACL.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/lib/squid/basic_ncsa_auth&nbsp;&nbsp;/etc/squid/squid_user&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;ncsa_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&nbsp;class=&quot;&quot;&gt;auth_param&nbsp;basic&nbsp;children&nbsp;1000&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;How&nbsp;many&nbsp;users&nbsp;do&nbsp;expect&nbsp;exactly?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Squid&nbsp;de-duplicated&nbsp;overlapping&nbsp;Basic&nbsp;auth&nbsp;logins&nbsp;so&nbsp;one&nbsp;user&nbsp;can&nbsp;login&nbsp;multiple&nbsp;times&nbsp;at&nbsp;once&nbsp;(ie&nbsp;login&nbsp;bursts&nbsp;when&nbsp;a&nbsp;Browser&nbsp;starts&nbsp;up)&nbsp;with&nbsp;only&nbsp;one&nbsp;query&nbsp;sent&nbsp;to&nbsp;the&nbsp;auth&nbsp;helper.&nbsp;NCSA&nbsp;is&nbsp;also&nbsp;extremely&nbsp;fast&nbsp;lookups.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;If&nbsp;you&nbsp;bumped&nbsp;that&nbsp;up&nbsp;because&nbsp;of&nbsp;the&nbsp;WARNING&nbsp;logged,&nbsp;then&nbsp;please&nbsp;change&nbsp;your&nbsp;practices&nbsp;to&nbsp;fix&nbsp;ERRORs&nbsp;before&nbsp;WARNINGs.&lt;br&nbsp;class=&quot;&quot;&gt;*&nbsp;WARNINGs&nbsp;are&nbsp;logged&nbsp;for&nbsp;things&nbsp;Squid&nbsp;can&nbsp;workaround&nbsp;but&nbsp;needs&nbsp;help&nbsp;to&nbsp;fix&nbsp;properly,&lt;br&nbsp;class=&quot;&quot;&gt;*&nbsp;ERRORs&nbsp;are&nbsp;things&nbsp;Squid&nbsp;cannot&nbsp;do&nbsp;anything&nbsp;about&nbsp;and&nbsp;need&nbsp;your&nbsp;attention,&lt;br&nbsp;class=&quot;&quot;&gt;*&nbsp;FATALs&nbsp;are&nbsp;things&nbsp;that&nbsp;are&nbsp;absolutely&nbsp;critical&nbsp;to&nbsp;fix&nbsp;if&nbsp;you&nbsp;are&nbsp;going&nbsp;to&nbsp;use&nbsp;Squid&nbsp;at&nbsp;all.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;external_acl_type&nbsp;bandwidth_check&nbsp;ttl=60&nbsp;%SRC&nbsp;/usr/local/bin/bandwidth_check&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;The&nbsp;ttl=&nbsp;parameter&nbsp;needs&nbsp;to&nbsp;be&nbsp;0&nbsp;for&nbsp;accurate&nbsp;bandwidth&nbsp;results.&nbsp;With&nbsp;the&nbsp;above&nbsp;the&nbsp;helper&nbsp;is&nbsp;only&nbsp;checked&nbsp;once&nbsp;per&nbsp;minute,&nbsp;not&nbsp;on&nbsp;every&nbsp;request.&lt;br&nbsp;class=&quot;&quot;&gt;Keep&nbsp;in&nbsp;mind&nbsp;that&nbsp;you&nbsp;are&nbsp;only&nbsp;controlling&nbsp;whether&nbsp;new&nbsp;requests&nbsp;can&nbsp;start,&nbsp;and&nbsp;once&nbsp;started&nbsp;they&nbsp;will&nbsp;complete.&nbsp;So&nbsp;regular&nbsp;re-checking&nbsp;is&nbsp;required&nbsp;to&nbsp;minimize&nbsp;overages.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;NP:&nbsp;negative_ttl=&nbsp;control&nbsp;how&nbsp;often&nbsp;Squid&nbsp;re-checks&nbsp;results&nbsp;from&nbsp;the&nbsp;helper&nbsp;once&nbsp;users&nbsp;go&nbsp;over&nbsp;their&nbsp;quota.&nbsp;This&nbsp;is&nbsp;the&nbsp;option&nbsp;that&nbsp;you&nbsp;will&nbsp;want&nbsp;to&nbsp;tune&nbsp;with&nbsp;non-0&nbsp;values&nbsp;to&nbsp;reduce&nbsp;helper&nbsp;load,&nbsp;but&nbsp;also&nbsp;keep&nbsp;it&nbsp;low&nbsp;enough&nbsp;not&nbsp;to&nbsp;block&nbsp;clients&nbsp;for&nbsp;too&nbsp;long&nbsp;after&nbsp;their&nbsp;quota&nbsp;renews.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;acl&nbsp;bandwidth_auth&nbsp;external&nbsp;bandwidth_check&lt;br&nbsp;class=&quot;&quot;&gt;http_access&nbsp;allow&nbsp;localnet&nbsp;bandwidth_auth&lt;br&nbsp;class=&quot;&quot;&gt;http_access&nbsp;deny&nbsp;&nbsp;localnet&nbsp;!bandwidth_auth&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;The&nbsp;wiki&nbsp;is&nbsp;documenting&nbsp;the&nbsp;above&nbsp;two&nbsp;rules&nbsp;as&nbsp;*alternatives*.&nbsp;I&nbsp;suggest&nbsp;you&nbsp;go&nbsp;back&nbsp;and&nbsp;read&nbsp;their&nbsp;descriptions,&nbsp;then&nbsp;pick&nbsp;the&nbsp;one&nbsp;that&nbsp;does&nbsp;what&nbsp;you&nbsp;need.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;###################################################&lt;br&nbsp;class=&quot;&quot;&gt;cache_effective_user&nbsp;squid&lt;br&nbsp;class=&quot;&quot;&gt;cache_effective_group&nbsp;squid&lt;br&nbsp;class=&quot;&quot;&gt;###########################################&lt;br&nbsp;class=&quot;&quot;&gt;http_access&nbsp;allow&nbsp;ncsa_users&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;This&nbsp;will&nbsp;only&nbsp;login&nbsp;users&nbsp;that&nbsp;broadcast&nbsp;their&nbsp;credentials.&nbsp;It&nbsp;will&nbsp;not&nbsp;require&nbsp;credentials&nbsp;from&nbsp;clients,&nbsp;and&nbsp;none&nbsp;of&nbsp;your&nbsp;below&nbsp;rules&nbsp;require&nbsp;login&nbsp;to&nbsp;have&nbsp;happened.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Best&nbsp;practice&nbsp;for&nbsp;authentication&nbsp;is&nbsp;to&nbsp;place&nbsp;the&nbsp;rules&nbsp;applying&nbsp;to&nbsp;non-authenticate&nbsp;clients&nbsp;first,&nbsp;then&nbsp;have:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;!ncsa_users&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;...&nbsp;then&nbsp;to&nbsp;follow&nbsp;that&nbsp;with&nbsp;any&nbsp;rules&nbsp;applying&nbsp;to&nbsp;authenticated&nbsp;clients.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;############################&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;br&nbsp;class=&quot;&quot;&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&nbsp;class=&quot;&quot;&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&nbsp;class=&quot;&quot;&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;These&nbsp;Safe_ports&nbsp;and&nbsp;CONNECT&nbsp;rule&nbsp;need&nbsp;to&nbsp;be&nbsp;*above*&nbsp;all&nbsp;of&nbsp;your&nbsp;custom&nbsp;rules.&nbsp;Otherwise&nbsp;they&nbsp;will&nbsp;have&nbsp;zero&nbsp;ability&nbsp;to&nbsp;protect&nbsp;your&nbsp;proxy&nbsp;against&nbsp;the&nbsp;DoS&nbsp;and&nbsp;hijacking&nbsp;attacks&nbsp;they&nbsp;are&nbsp;supposed&nbsp;to&nbsp;prevent.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;snip&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;here&nbsp;is&nbsp;errors&nbsp;i&nbsp;get&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;2017/09/03&nbsp;19:32:38&nbsp;kid1|&nbsp;WARNING:&nbsp;external&nbsp;ACL&nbsp;'bandwidth_check'&nbsp;queue&nbsp;overload.&nbsp;Request&nbsp;rejected&nbsp;'11.13.209.12'.&lt;br&nbsp;class=&quot;&quot;&gt;2017/09/03&nbsp;19:38:31&nbsp;kid1|&nbsp;WARNING:&nbsp;external&nbsp;ACL&nbsp;'bandwidth_check'&nbsp;queue&nbsp;overload.&nbsp;Request&nbsp;rejected&nbsp;'11.13.209.12'.&lt;br&nbsp;class=&quot;&quot;&gt;2017/09/03&nbsp;19:44:46&nbsp;kid1|&nbsp;WARNING:&nbsp;external&nbsp;ACL&nbsp;'bandwidth_check'&nbsp;queue&nbsp;overload.&nbsp;Request&nbsp;rejected&nbsp;'148.161.111.42'.&lt;br&nbsp;class=&quot;&quot;&gt;2017/09/03&nbsp;19:44:47&nbsp;kid1|&nbsp;WARNING:&nbsp;external&nbsp;ACL&nbsp;'bandwidth_check'&nbsp;queue&nbsp;overload.&nbsp;Request&nbsp;rejected&nbsp;'148.161.111.42’.&lt;br&nbsp;class=&quot;&quot;&gt;but&nbsp;I’m&nbsp;sure&nbsp;100&nbsp;%&nbsp;that&nbsp;the&nbsp;ips&nbsp;above&nbsp;not&nbsp;blacklisted&nbsp;bec&nbsp;i&nbsp;check&nbsp;them&nbsp;over&nbsp;the&nbsp;helper&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Please&nbsp;re-read&nbsp;the&nbsp;WARNING&nbsp;message.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;IPs&nbsp;are&nbsp;*not*&nbsp;being&nbsp;rejected&nbsp;because&nbsp;they&nbsp;are&nbsp;listed.&nbsp;They&nbsp;are&nbsp;being&nbsp;rejected&nbsp;because&nbsp;the&nbsp;helper&nbsp;lookup&nbsp;queue&nbsp;is&nbsp;overloaded&nbsp;and&nbsp;no&nbsp;OK&nbsp;is&nbsp;received.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;here&nbsp;is&nbsp;squid&nbsp;when&nbsp;it&nbsp;run&nbsp;:&lt;br&nbsp;class=&quot;&quot;&gt;root@localhost:~#&nbsp;tailf&nbsp;/var/log/squid/cache.log&lt;br&nbsp;class=&quot;&quot;&gt;2017/09/03&nbsp;19:32:33&nbsp;kid1|&nbsp;ERROR:&nbsp;Failed&nbsp;to&nbsp;create&nbsp;helper&nbsp;child&nbsp;read&nbsp;FD:&nbsp;TCP&nbsp;[::1]&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Fix&nbsp;that&nbsp;ERROR.&nbsp;The&nbsp;WARNING's&nbsp;about&nbsp;the&nbsp;helper&nbsp;and&nbsp;ACL&nbsp;checking&nbsp;are&nbsp;all&nbsp;side&nbsp;effects&nbsp;of&nbsp;there&nbsp;not&nbsp;actually&nbsp;being&nbsp;a&nbsp;helper&nbsp;running.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;There&nbsp;are&nbsp;several&nbsp;ways&nbsp;to&nbsp;do&nbsp;that:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;1)&nbsp;fix&nbsp;the&nbsp;helpers&nbsp;IPv6&nbsp;support.&nbsp;It&nbsp;seems&nbsp;not&nbsp;to&nbsp;have&nbsp;any,&nbsp;or&nbsp;if&nbsp;it&nbsp;does&nbsp;is&nbsp;somehow&nbsp;still&nbsp;only&nbsp;using&nbsp;the&nbsp;IPv4-only&nbsp;address&nbsp;of&nbsp;localhost.&nbsp;Squid&nbsp;is&nbsp;trying&nbsp;to&nbsp;contact&nbsp;it&nbsp;over&nbsp;an&nbsp;IPv6-v4-mapped&nbsp;address&nbsp;for&nbsp;localhost.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;2)&nbsp;add&nbsp;the&nbsp;'ipv4'&nbsp;option&nbsp;to&nbsp;your&nbsp;external_acl_type,&nbsp;to&nbsp;make&nbsp;Squid&nbsp;temporarily&nbsp;be&nbsp;IPv4-only&nbsp;when&nbsp;talking&nbsp;to&nbsp;this&nbsp;helper.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;While&nbsp;(2)&nbsp;is&nbsp;very&nbsp;tempting&nbsp;and&nbsp;easy,&nbsp;you&nbsp;will&nbsp;probably&nbsp;find&nbsp;that&nbsp;an&nbsp;IPv4-only&nbsp;helper&nbsp;like&nbsp;this&nbsp;has&nbsp;errors&nbsp;when&nbsp;it&nbsp;gets&nbsp;told&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;an&nbsp;IPv6&nbsp;client.&nbsp;So&nbsp;(1)&nbsp;is&nbsp;the&nbsp;better&nbsp;option&nbsp;and&nbsp;I&nbsp;see&nbsp;the&nbsp;wiki&nbsp;page&nbsp;author&nbsp;goes&nbsp;on&nbsp;about&nbsp;being&nbsp;happy&nbsp;to&nbsp;fix&nbsp;problem&nbsp;with&nbsp;their&nbsp;helper&nbsp;-&nbsp;just&nbsp;get&nbsp;in&nbsp;touch.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Amos&lt;br&nbsp;class=&quot;&quot;&gt;_______________________________________________&lt;br&nbsp;class=&quot;&quot;&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;class=&quot;&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
