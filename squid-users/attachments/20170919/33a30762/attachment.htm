<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;hi&nbsp;Antony&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;thanks&nbsp;for&nbsp;you&nbsp;reply&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&gt;&nbsp;i&nbsp;setup&nbsp;squid&nbsp;on&nbsp;ubuntu&nbsp;and&nbsp;centos&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;Why&nbsp;both?&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;because&nbsp;of&nbsp;test&nbsp;and&nbsp;because&nbsp;i&nbsp;not&nbsp;get&nbsp;the&nbsp;result&lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;with&nbsp;tproxy&nbsp;and&nbsp;wccp&nbsp;for&nbsp;6&nbsp;gb/s&nbsp;traffic&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;What&nbsp;hardware&nbsp;are&nbsp;you&nbsp;using&nbsp;for&nbsp;that&nbsp;sort&nbsp;of&nbsp;traffic&nbsp;flow?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;i&nbsp;use&nbsp;hp&nbsp;DL360&nbsp;with&nbsp;2&nbsp;6&nbsp;core&nbsp;processor&nbsp;with&nbsp;3&nbsp;GHZ&nbsp;and&nbsp;64&nbsp;GB&nbsp;RAM&nbsp;and&nbsp;1&nbsp;TB&nbsp;HDD&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;but&nbsp;when&nbsp;i&nbsp;try&nbsp;to&nbsp;test&nbsp;squid&nbsp;with&nbsp;40&nbsp;mb/s&nbsp;traffic&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;How&nbsp;are&nbsp;you&nbsp;generating&nbsp;&quot;40&nbsp;mb/s&nbsp;traffic&quot;? &nbsp;I&#39;m&nbsp;assuming&nbsp;that&nbsp;your&nbsp;Internet&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;connection&nbsp;is&nbsp;6Gbps&nbsp;as&nbsp;stated&nbsp;above,&nbsp;so&nbsp;how&nbsp;are&nbsp;you&nbsp;restricting&nbsp;this&nbsp;down&nbsp;to&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;40Mbps&nbsp;for&nbsp;testing?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;i&nbsp;redirect&nbsp;one&nbsp;class&nbsp;of&nbsp;ip&nbsp;address&nbsp;with&nbsp;40&nbsp;mb/s&nbsp;traffic&nbsp;for&nbsp;test&nbsp;of&nbsp;squid&nbsp;and&nbsp;i&nbsp;am&nbsp;going&nbsp;decide&nbsp;to&nbsp;redirect&nbsp;whole&nbsp;of&nbsp;traffic&nbsp;to&nbsp;squid&nbsp;after&nbsp;getting&nbsp;fast&nbsp;browsing&lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&gt;&nbsp;it&nbsp;response&nbsp;very&nbsp;slow&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;Numbers&nbsp;please.&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;websites&nbsp;load&nbsp;at&nbsp;2&nbsp;or&nbsp;1&nbsp;second&nbsp;by&nbsp;direct&nbsp;browsing&nbsp;and&nbsp;load&nbsp;at&nbsp;10&nbsp;second&nbsp;or&nbsp;not&nbsp;load&nbsp;by&nbsp;squid&lt;/font&gt; &lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;while&nbsp;when&nbsp;i&nbsp;use&nbsp;direct&nbsp;browsing&nbsp;i&nbsp;can&nbsp;browse&nbsp;websites&nbsp;very&nbsp;fast&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;Is&nbsp;the&nbsp;direct&nbsp;traffic&nbsp;still&nbsp;being&nbsp;routed&nbsp;through&nbsp;the&nbsp;Squid&nbsp;server&nbsp;(you&nbsp;say&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;you&#39;re&nbsp;using&nbsp;tproxy,&nbsp;so&nbsp;I&nbsp;assume&nbsp;this&nbsp;is&nbsp;an&nbsp;intercept&nbsp;machine&nbsp;with&nbsp;the&nbsp;traffic&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;going&nbsp;through&nbsp;it&nbsp;between&nbsp;client&nbsp;and&nbsp;server)?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;no,&nbsp;HTTP&nbsp;traffic&nbsp;redirect&nbsp;to&nbsp;squid&nbsp;by&nbsp;wccp&nbsp;and&nbsp;access-list&nbsp;config&nbsp;on&nbsp;Cisco&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;ip&nbsp;wccp&nbsp;80&nbsp;redirect-list&nbsp;wccp&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;ip&nbsp;wccp&nbsp;90&nbsp;redirect-list&nbsp;wccp_to_inside&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;ip&nbsp;access-list&nbsp;extended&nbsp;wccp&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt; remark&nbsp;Permit&nbsp;http&nbsp;access&nbsp;from&nbsp;clients&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt; permit&nbsp;tcp&nbsp;x.x.x.x&nbsp;0.0.0.255&nbsp;any&nbsp;eq&nbsp;www&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt; deny&nbsp; &nbsp;ip&nbsp;any&nbsp;any&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;ip&nbsp;access-list&nbsp;extended&nbsp;wccp_to_inside&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt; permit&nbsp;tcp&nbsp;any&nbsp;eq&nbsp;www&nbsp;x.x.x.x&nbsp;0.0.0.255&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt; deny&nbsp; &nbsp;ip&nbsp;any&nbsp;any&lt;/div&gt;&lt;/div&gt;&lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;i&nbsp;used&nbsp;tcpdump&nbsp;for&nbsp;tracing&nbsp;connections&nbsp;arrive&nbsp;time&nbsp;and&nbsp;there&nbsp;was&nbsp;no&nbsp;problem,&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Arrival&nbsp;time&nbsp;where? &nbsp;From&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;Squid? &nbsp;From&nbsp;Squid&nbsp;to&nbsp;the&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;client? &nbsp;What&nbsp;are&nbsp;you&nbsp;actually&nbsp;measuring?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;yes,&nbsp;arriving&nbsp;source&nbsp;packets&nbsp;from&nbsp;clients&nbsp;to&nbsp;squid&nbsp;interface,by&nbsp;time&nbsp;that&nbsp;i&nbsp;push&nbsp;enter&nbsp;on&nbsp;browser&nbsp;address&nbsp;bar&nbsp;and&nbsp;getting&nbsp;packets&nbsp;on&nbsp;tcpdump&nbsp;immediately&lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;i&nbsp;used&nbsp;watch&nbsp;-d&nbsp;for&nbsp;tracing&nbsp;packets&nbsp;match&nbsp;by&nbsp;iptables&nbsp;rules&nbsp;and&nbsp;it&nbsp;was&nbsp;ok,&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;Please&nbsp;be&nbsp;more&nbsp;specific&nbsp;-&nbsp;what&nbsp;did&nbsp;you&nbsp;measure&nbsp;and&nbsp;what&nbsp;does&nbsp;&quot;OK&quot;&nbsp;mean?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;i&nbsp;add&nbsp;rule&nbsp;to&nbsp;iptables&nbsp;for&nbsp;tracing&nbsp;one&nbsp;website&nbsp;packets&nbsp;and&nbsp;i&nbsp;saw&nbsp;them&nbsp;on&nbsp;kern.log&nbsp;that&nbsp;matched&nbsp;with&nbsp;the&nbsp;rule,&nbsp;so&nbsp;if&nbsp;you&nbsp;need&nbsp;please&nbsp;tell&nbsp;me&nbsp;to&nbsp;send&nbsp;commands&nbsp;that&nbsp;i&nbsp;used.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;pre&nbsp;dir=&quot;ltr&quot;&nbsp;id=&quot;gmail-m_-8083075746322363929gmail-CA-424780031ab1596014f0f69ad96adf0be1b4279d&quot;&nbsp;lang=&quot;en&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;ip&nbsp;rule&nbsp;add&nbsp;fwmark&nbsp;1&nbsp;lookup&nbsp;100&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;ip&nbsp;route&nbsp;add&nbsp;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-ResWord&quot;&gt;local&nbsp;&lt;/span&gt;&lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt;&nbsp;dev&nbsp;enp3s0f0&nbsp;table&nbsp;100&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;dir=&quot;ltr&quot;&nbsp;id=&quot;gmail-m_-8083075746322363929gmail-CA-424780031ab1596014f0f69ad96adf0be1b4279d&quot;&nbsp;lang=&quot;en&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-A&nbsp;PREROUTING&nbsp;-d&nbsp;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-ID&quot;&gt;$LOCALIP&lt;/span&gt;&nbsp;-j&nbsp;ACCEPT&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-N&nbsp;DIVERT&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-A&nbsp;DIVERT&nbsp;-j&nbsp;MARK&nbsp;--set-mark&nbsp;1&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-A&nbsp;DIVERT&nbsp;-j&nbsp;ACCEPT&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-A&nbsp;PREROUTING&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;socket&nbsp;-j&nbsp;DIVERT&lt;/span&gt;<br>
&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-line&quot;&gt;iptables&nbsp;-t&nbsp;mangle&nbsp;-A&nbsp;PREROUTING&nbsp;-p&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-j&nbsp;TPROXY&nbsp;--tproxy-mark&nbsp;0x1/0x1&nbsp;--on-port&nbsp;3129&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;watch&nbsp;-d&nbsp;iptables&nbsp;-t&nbsp;mangle&nbsp;-vnL&lt;/font&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Did&nbsp;you&nbsp;compare&nbsp;with&nbsp;and&nbsp;without&nbsp;Squid&nbsp;in&nbsp;place&nbsp;to&nbsp;see&nbsp;what&nbsp;differs?&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;no,&nbsp;as&nbsp;i&nbsp;told&nbsp;when&nbsp;i&nbsp;browsing&nbsp;directly&nbsp;it&nbsp;is&nbsp;well&nbsp;and&nbsp;packets&nbsp;not&nbsp;coming&nbsp;to&nbsp;squid&nbsp;and&nbsp;exit&nbsp;from&nbsp;cisco&nbsp;to&nbsp;internet&nbsp;and&nbsp;arrive&nbsp;to&nbsp;clients&nbsp;from&nbsp;cisco&nbsp;and&nbsp;because&nbsp;of&nbsp;traffic&nbsp;on&nbsp;cisco&nbsp;i&nbsp;can&#39;t&nbsp;enable&nbsp;debugging&nbsp;on&nbsp;it&nbsp;but&nbsp;when&nbsp;i&nbsp;browse&nbsp;from&nbsp;squid&nbsp;i&nbsp;get&nbsp;latency&nbsp;so&nbsp;i&nbsp;suppose&nbsp;the&nbsp;problem&nbsp;is&nbsp;squid&nbsp;or&nbsp;server&nbsp;that&nbsp;squid&nbsp;running&nbsp;on&nbsp;it&lt;/font&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;i&nbsp;also&nbsp;used&nbsp;iptables&nbsp;trace&nbsp;command&nbsp;for&nbsp;tracing&nbsp;matching&nbsp;iptables&nbsp;rules,&lt;br&gt;&gt;&nbsp;there&nbsp;was&nbsp;no&nbsp;problem&nbsp;except&nbsp;i&nbsp;had&nbsp;latency&nbsp;on&nbsp;arriving&nbsp;packets&nbsp;on&nbsp;iptables&lt;br&gt;&gt;&nbsp;rule&nbsp;while&nbsp;tcpdump&nbsp;captured&nbsp;packets&nbsp;fast,&nbsp;it&nbsp;happened&nbsp;when&nbsp;my&nbsp;browsing&nbsp;was&lt;br&gt;&gt;&nbsp;so&nbsp;slow,&nbsp;at&nbsp;some&nbsp;times&nbsp;that&nbsp;my&nbsp;browsing&nbsp;was&nbsp;fast&nbsp;there&nbsp;was&nbsp;no&nbsp;latency&nbsp;on&lt;br&gt;&gt;&nbsp;iptables&nbsp;trace&nbsp;log.&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;That&nbsp;description&nbsp;is&nbsp;too&nbsp;vague&nbsp;to&nbsp;know&nbsp;exactly&nbsp;what&nbsp;you&nbsp;were&nbsp;measuring&nbsp;and&nbsp;what&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;results&nbsp;you&nbsp;got.&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&nbsp;color=&quot;#660000&quot;&gt;iptables&nbsp;-t&nbsp;raw&nbsp;-A&nbsp;PREROUTING&nbsp;-s&nbsp;x.x.x.x&nbsp;-j&nbsp;TRACE&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;iptables&nbsp;-t&nbsp;raw&nbsp;-A&nbsp;OUTPUT&nbsp;-s&nbsp;x.x.x.x&nbsp;-j&nbsp;TRACE&lt;br&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;tailf&nbsp;/var/log/kern.log&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;tcpdump&nbsp;-e&nbsp;-i&nbsp;enp3s0f0&nbsp;-d&nbsp;x.x.x.x&nbsp;dst&nbsp;port&nbsp;80&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;tcpdump&nbsp;-e&nbsp;-i&nbsp;enp3s0f0&nbsp;-s&nbsp;x.x.x.x&nbsp;src&nbsp;port&nbsp;80&lt;/font&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&lt;br&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;i&nbsp;also&nbsp;used&nbsp;tcp&nbsp;and&nbsp;linux&nbsp;enhancement&nbsp;configurations&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Details?&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.wmem_default=524288&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.wmem_max=16777216&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.rmem_default=524288&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.rmem_max=16777216&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_window_scaling&nbsp;=&nbsp;1&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_rmem&nbsp;=&nbsp;66560&nbsp;524288&nbsp;16777216&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_wmem&nbsp;=&nbsp;66560&nbsp;524288&nbsp;16777216&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.somaxconn=4000&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_timestamps=0&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_sack=0&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_fin_timeout=20&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.ip_local_port_range=&lt;wbr&gt;10240&nbsp;65000&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_keepalive_time&nbsp;=&nbsp;900&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_keepalive_intvl&nbsp;=&nbsp;900&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_keepalive_probes&nbsp;=&nbsp;9&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.somaxconn&nbsp;=&nbsp;5000&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.core.netdev_max_backlog&nbsp;=&nbsp;8000&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_max_syn_backlog&nbsp;=&nbsp;8096&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_slow_start_after_&lt;wbr&gt;idle&nbsp;=&nbsp;0&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;net.ipv4.tcp_tw_reuse&nbsp;=&nbsp;1&lt;/font&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;span&nbsp;class=&quot;gmail-m_-8083075746322363929gmail-im&quot;&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&gt;&nbsp;but&nbsp;nothing&nbsp;happened.&lt;br&gt;&gt;&nbsp;wccp&nbsp;send&nbsp;packets&nbsp;very&nbsp;well&nbsp;and&nbsp;tcpdump&nbsp;show&nbsp;capturing&nbsp;packets&nbsp;too&nbsp;but&lt;br&gt;&gt;&nbsp;browsing&nbsp;with&nbsp;squid&nbsp;is&nbsp;very&nbsp;slow.&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Firstly,&nbsp;please&nbsp;define&nbsp;&quot;slow&quot;&nbsp;-&nbsp;do&nbsp;you&nbsp;mean&nbsp;it&nbsp;takes&nbsp;a&nbsp;long&nbsp;time&nbsp;for&nbsp;new&nbsp;web&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;pages&nbsp;/&nbsp;images&nbsp;/&nbsp;etc&nbsp;to&nbsp;appear&nbsp;(but&nbsp;once&nbsp;they&nbsp;start,&nbsp;they&nbsp;arrive&nbsp;quickly)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(102,0,0)&quot;&gt;browse&nbsp;in&nbsp;10&nbsp;second&nbsp;or&nbsp;not&nbsp;browsing,&nbsp;webpages&nbsp;that&nbsp;i&nbsp;browse&nbsp;for&nbsp;first&nbsp;time&nbsp;or&nbsp;i&nbsp;browse&nbsp;for&nbsp;multiple&nbsp;times&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;,&nbsp;or &lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;do&nbsp;you&nbsp;mean&nbsp;that&nbsp;a&nbsp;continuous&nbsp;stream&nbsp;of&nbsp;data&nbsp;(a&nbsp;&quot;download&quot;)&nbsp;arrives&nbsp;more&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;slowly&nbsp;when&nbsp;going&nbsp;through&nbsp;Squid&nbsp;than&nbsp;going&nbsp;direct&nbsp;(and&nbsp;if&nbsp;so,&nbsp;what&nbsp;are&nbsp;the&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;different&nbsp;speeds)?&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;no&nbsp;just&nbsp;browsing, &lt;/font&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;Secondly,&nbsp;what&nbsp;are&nbsp;you&nbsp;trying&nbsp;to&nbsp;achieve&nbsp;with&nbsp;Squid&nbsp;-&nbsp;what&nbsp;is&nbsp;its&nbsp;purpose&nbsp;in&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;your&nbsp;network?&lt;/span&gt;&lt;br&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;caching&nbsp;pages&nbsp;and&nbsp;their&nbsp;objects&nbsp;for&nbsp;better&nbsp;internet&nbsp;browsing&nbsp;by&nbsp;clients&nbsp;and&nbsp;save&nbsp;bandwith.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;squid.conf&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:12.8px&quot;&gt;&lt;font&nbsp;color=&quot;#660000&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;dns_v4_first&nbsp;on&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;fanava_net&nbsp;src &lt;a&nbsp;href=&quot;http://89.221.82.161/32&quot;&nbsp;target=&quot;_blank&quot;&gt;x.x.x.x/32&lt;/a&gt; #&nbsp;Fanava&nbsp;First&nbsp;clients&nbsp;range&nbsp;to&nbsp;cache&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;#&nbsp;http&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;#&nbsp;http-mgmt&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;#&nbsp;gss-http&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;#&nbsp;multiling&nbsp;http&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_access&nbsp;allow&nbsp;fanava_net&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_port &lt;a&nbsp;href=&quot;http://0.0.0.0:3128/&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0:3128&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;http_port &lt;a&nbsp;href=&quot;http://0.0.0.0:3129/&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0:3129&lt;/a&gt; tproxy&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;cache_mem&nbsp;50&nbsp;GB&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;maximum_object_size_in_memory&nbsp;100&nbsp;MB&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;minimum_object_size&nbsp;2&nbsp;KB&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;maximum_object_size&nbsp;6&nbsp;GB&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#cache_dir&nbsp;ufs&nbsp;/var/spool/squid&nbsp;1024000&nbsp;256&nbsp;512&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;cache_swap_low&nbsp;90&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;cache_swap_high&nbsp;92&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;coredump_dir&nbsp;/var/spool/squid&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Image&nbsp;files&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(png|gif|jpg|jpeg|bmp|tif|&lt;wbr&gt;tiff)$&nbsp;10080&nbsp;90%&nbsp;43200&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Compressed&nbsp;files&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(zip|rar|tar|gz|tgz|z|arj|&lt;wbr&gt;lha|lzh|iso|deb|rpm)$&nbsp;10080&nbsp;90%&nbsp;43200&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Binary&nbsp;files&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(exe|msi)$&nbsp;10080&nbsp;90%&nbsp;43200&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Multimedia&nbsp;files&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(mp3|wav|mid|midi|ram|avi|&lt;wbr&gt;wmv|mpg|mpeg|mp4|swf|flv|)$&nbsp;10080&nbsp;90%&nbsp;43200&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Document&nbsp;files&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(pdf|ps|doc|ppt|xls|pps)$&nbsp;10080&nbsp;90%&nbsp;43200&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;HTML&nbsp;patterns&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.index.(html|htm)$&nbsp;0&nbsp;40%&nbsp;10080&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.default.(html|htm)$&nbsp;0&nbsp;40%&nbsp;10080&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;\.(html|htm|css|js)$&nbsp;1440&nbsp;40%&nbsp;40320&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;#&nbsp;Default&nbsp;patterns&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;^ftp:&nbsp;1440&nbsp;20%&nbsp;10080&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;0%&nbsp;1440&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;0%&nbsp;0&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;.&nbsp;0&nbsp;20%&nbsp;4320&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;refresh_pattern&nbsp;(Release|Packages(.gz)*)$&nbsp;0&nbsp;20%&nbsp;2880&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;cache_mgr &lt;a&nbsp;href=&quot;mailto:zeutech@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;zeutech@gmail.com&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_router&nbsp;x.x.x.x&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp_version&nbsp;2&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_rebuild_wait&nbsp;on&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_forwarding_method&nbsp;2&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_return_method&nbsp;2&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_service&nbsp;dynamic&nbsp;80&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_service_info&nbsp;80&nbsp;protocol=tcp&nbsp;flags=src_ip_hash&nbsp;priority=240&nbsp;ports=80&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_service&nbsp;dynamic&nbsp;90&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;wccp2_service_info&nbsp;90&nbsp;protocol=tcp&nbsp;flags=dst_ip_hash,ports_source&nbsp;priority=240&nbsp;ports=80&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,255)&quot;&gt;&lt;span&nbsp;style=&quot;font-family:comic&nbsp;sans&nbsp;ms,sans-serif&quot;&gt;&lt;b&gt;Regards,&lt;br&gt;Iraj&nbsp;Norouzi&lt;/b&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;19,&nbsp;2017&nbsp;at&nbsp;3:04&nbsp;PM,&nbsp;Antony&nbsp;Stone&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:Antony.Stone@squid.open.source.it&quot;&nbsp;target=&quot;_blank&quot;&gt;Antony.Stone@squid.open.source.it&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;Tuesday&nbsp;19&nbsp;September&nbsp;2017&nbsp;at&nbsp;11:18:34,&nbsp;Iraj&nbsp;Norouzi&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;hi&nbsp;everybody&lt;br&gt;<br>
&gt;&nbsp;i&nbsp;setup&nbsp;squid&nbsp;on&nbsp;ubuntu&nbsp;and&nbsp;centos&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Why&nbsp;both?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;with&nbsp;tproxy&nbsp;and&nbsp;wccp&nbsp;for&nbsp;6&nbsp;gb/s&nbsp;traffic&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;What&nbsp;hardware&nbsp;are&nbsp;you&nbsp;using&nbsp;for&nbsp;that&nbsp;sort&nbsp;of&nbsp;traffic&nbsp;flow?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;when&nbsp;i&nbsp;try&nbsp;to&nbsp;test&nbsp;squid&nbsp;with&nbsp;40&nbsp;mb/s&nbsp;traffic&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;How&nbsp;are&nbsp;you&nbsp;generating&nbsp;&quot;40&nbsp;mb/s&nbsp;traffic&quot;? &nbsp;I&#39;m&nbsp;assuming&nbsp;that&nbsp;your&nbsp;Internet&lt;br&gt;<br>
connection&nbsp;is&nbsp;6Gbps&nbsp;as&nbsp;stated&nbsp;above,&nbsp;so&nbsp;how&nbsp;are&nbsp;you&nbsp;restricting&nbsp;this&nbsp;down&nbsp;to&lt;br&gt;<br>
40Mbps&nbsp;for&nbsp;testing?&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;it&nbsp;response&nbsp;very&nbsp;slow&lt;br&gt;<br>
&lt;br&gt;<br>
Numbers&nbsp;please.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;while&nbsp;when&nbsp;i&nbsp;use&nbsp;direct&nbsp;browsing&nbsp;i&nbsp;can&nbsp;browse&nbsp;websites&nbsp;very&nbsp;fast&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Is&nbsp;the&nbsp;direct&nbsp;traffic&nbsp;still&nbsp;being&nbsp;routed&nbsp;through&nbsp;the&nbsp;Squid&nbsp;server&nbsp;(you&nbsp;say&lt;br&gt;<br>
you&#39;re&nbsp;using&nbsp;tproxy,&nbsp;so&nbsp;I&nbsp;assume&nbsp;this&nbsp;is&nbsp;an&nbsp;intercept&nbsp;machine&nbsp;with&nbsp;the&nbsp;traffic&lt;br&gt;<br>
going&nbsp;through&nbsp;it&nbsp;between&nbsp;client&nbsp;and&nbsp;server)?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;i&nbsp;used&nbsp;tcpdump&nbsp;for&nbsp;tracing&nbsp;connections&nbsp;arrive&nbsp;time&nbsp;and&nbsp;there&nbsp;was&nbsp;no&nbsp;problem,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Arrival&nbsp;time&nbsp;where? &nbsp;From&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;Squid? &nbsp;From&nbsp;Squid&nbsp;to&nbsp;the&lt;br&gt;<br>
client? &nbsp;What&nbsp;are&nbsp;you&nbsp;actually&nbsp;measuring?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;i&nbsp;used&nbsp;watch&nbsp;-d&nbsp;for&nbsp;tracing&nbsp;packets&nbsp;match&nbsp;by&nbsp;iptables&nbsp;rules&nbsp;and&nbsp;it&nbsp;was&nbsp;ok,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Please&nbsp;be&nbsp;more&nbsp;specific&nbsp;-&nbsp;what&nbsp;did&nbsp;you&nbsp;measure&nbsp;and&nbsp;what&nbsp;does&nbsp;&quot;OK&quot;&nbsp;mean?&lt;br&gt;<br>
&lt;br&gt;<br>
Did&nbsp;you&nbsp;compare&nbsp;with&nbsp;and&nbsp;without&nbsp;Squid&nbsp;in&nbsp;place&nbsp;to&nbsp;see&nbsp;what&nbsp;differs?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;i&nbsp;also&nbsp;used&nbsp;iptables&nbsp;trace&nbsp;command&nbsp;for&nbsp;tracing&nbsp;matching&nbsp;iptables&nbsp;rules,&lt;br&gt;<br>
&gt;&nbsp;there&nbsp;was&nbsp;no&nbsp;problem&nbsp;except&nbsp;i&nbsp;had&nbsp;latency&nbsp;on&nbsp;arriving&nbsp;packets&nbsp;on&nbsp;iptables&lt;br&gt;<br>
&gt;&nbsp;rule&nbsp;while&nbsp;tcpdump&nbsp;captured&nbsp;packets&nbsp;fast,&nbsp;it&nbsp;happened&nbsp;when&nbsp;my&nbsp;browsing&nbsp;was&lt;br&gt;<br>
&gt;&nbsp;so&nbsp;slow,&nbsp;at&nbsp;some&nbsp;times&nbsp;that&nbsp;my&nbsp;browsing&nbsp;was&nbsp;fast&nbsp;there&nbsp;was&nbsp;no&nbsp;latency&nbsp;on&lt;br&gt;<br>
&gt;&nbsp;iptables&nbsp;trace&nbsp;log.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;That&nbsp;description&nbsp;is&nbsp;too&nbsp;vague&nbsp;to&nbsp;know&nbsp;exactly&nbsp;what&nbsp;you&nbsp;were&nbsp;measuring&nbsp;and&nbsp;what&lt;br&gt;<br>
results&nbsp;you&nbsp;got.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;i&nbsp;also&nbsp;used&nbsp;tcp&nbsp;and&nbsp;linux&nbsp;enhancement&nbsp;configurations&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Details?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;nothing&nbsp;happened.&lt;br&gt;<br>
&gt;&nbsp;wccp&nbsp;send&nbsp;packets&nbsp;very&nbsp;well&nbsp;and&nbsp;tcpdump&nbsp;show&nbsp;capturing&nbsp;packets&nbsp;too&nbsp;but&lt;br&gt;<br>
&gt;&nbsp;browsing&nbsp;with&nbsp;squid&nbsp;is&nbsp;very&nbsp;slow.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;Firstly,&nbsp;please&nbsp;define&nbsp;&quot;slow&quot;&nbsp;-&nbsp;do&nbsp;you&nbsp;mean&nbsp;it&nbsp;takes&nbsp;a&nbsp;long&nbsp;time&nbsp;for&nbsp;new&nbsp;web&lt;br&gt;<br>
pages&nbsp;/&nbsp;images&nbsp;/&nbsp;etc&nbsp;to&nbsp;appear&nbsp;(but&nbsp;once&nbsp;they&nbsp;start,&nbsp;they&nbsp;arrive&nbsp;quickly),&nbsp;or&lt;br&gt;<br>
do&nbsp;you&nbsp;mean&nbsp;that&nbsp;a&nbsp;continuous&nbsp;stream&nbsp;of&nbsp;data&nbsp;(a&nbsp;&quot;download&quot;)&nbsp;arrives&nbsp;more&lt;br&gt;<br>
slowly&nbsp;when&nbsp;going&nbsp;through&nbsp;Squid&nbsp;than&nbsp;going&nbsp;direct&nbsp;(and&nbsp;if&nbsp;so,&nbsp;what&nbsp;are&nbsp;the&lt;br&gt;<br>
different&nbsp;speeds)?&lt;br&gt;<br>
&lt;br&gt;<br>
Secondly,&nbsp;what&nbsp;are&nbsp;you&nbsp;trying&nbsp;to&nbsp;achieve&nbsp;with&nbsp;Squid&nbsp;-&nbsp;what&nbsp;is&nbsp;its&nbsp;purpose&nbsp;in&lt;br&gt;<br>
your&nbsp;network?&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;please&nbsp;help&nbsp;me.&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;help&nbsp;us&nbsp;-&nbsp;give&nbsp;us&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;hardware&nbsp;you&#39;re&nbsp;running&nbsp;this&lt;br&gt;<br>
on,&nbsp;the&nbsp;version&nbsp;of&nbsp;Squid&nbsp;you&#39;re&nbsp;using,&nbsp;what&nbsp;WCCP&nbsp;routing&nbsp;/&nbsp;filtering&nbsp;you&#39;re&lt;br&gt;<br>
doing,&nbsp;the&nbsp;measurements&nbsp;you&#39;ve&nbsp;made&nbsp;and&nbsp;the&nbsp;results&nbsp;you&nbsp;got.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Antony.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
We&nbsp;all&nbsp;get&nbsp;the&nbsp;same&nbsp;amount&nbsp;of&nbsp;time&nbsp;-&nbsp;twenty-four&nbsp;hours&nbsp;per&nbsp;day.&lt;br&gt;<br>
How&nbsp;you&nbsp;use&nbsp;it&nbsp;is&nbsp;up&nbsp;to&nbsp;you.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Please&nbsp;reply&nbsp;to&nbsp;the&nbsp;list;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; please&nbsp;*don&#39;t*&nbsp;CC&nbsp;me.&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.&lt;wbr&gt;org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/&lt;wbr&gt;listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
