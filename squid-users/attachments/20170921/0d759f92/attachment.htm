<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;There&nbsp;is&nbsp;no&nbsp;&gt;60&nbsp;need&nbsp;on&nbsp;the&nbsp;301.&nbsp;Just&nbsp;me&nbsp;suggesting&nbsp;that&nbsp;60sec&nbsp;is&nbsp;too&nbsp;short&nbsp;caching&nbsp;time&nbsp;for&nbsp;a&nbsp;_permanent_&nbsp;thing.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;-&nbsp;may&nbsp;be&nbsp;some&nbsp;misconfiguration&nbsp;in&nbsp;my&nbsp;squid.conf.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;set&nbsp;max-age&nbsp;to&nbsp;values&nbsp;from&nbsp;interval&nbsp;&lt;1;60&gt;&nbsp;only&nbsp;302&nbsp;and&nbsp;307&nbsp;redirects&nbsp;were&nbsp;cached&nbsp;(HIT)&nbsp;and&nbsp;no&nbsp;301.&nbsp;When&nbsp;I&nbsp;increased&nbsp;the&nbsp;max-age&nbsp;value&nbsp;to&nbsp;61&nbsp;then&nbsp;the&nbsp;301&nbsp;redirect&nbsp;was&nbsp;cached&nbsp;too.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;But&nbsp;you&nbsp;are&nbsp;right,&nbsp;that&nbsp;the&nbsp;cause&nbsp;of&nbsp;no-caching&nbsp;the&nbsp;301&nbsp;redirect&nbsp;is&nbsp;the&nbsp;min&nbsp;value&nbsp;of:&lt;br&gt;&lt;pre&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;span&nbsp;style=&quot;font-family:arial,helvetica,sans-serif&quot;&gt;&lt;br&gt;&lt;br&gt;But&nbsp;for&nbsp;redirects&nbsp;302&nbsp;and&nbsp;307&nbsp;the&nbsp;above-mentioned&nbsp;refresh_pattern&nbsp;is&nbsp;ignored.&lt;br&gt;&lt;br&gt;&lt;br&gt;My&nbsp;source&nbsp;server&nbsp;is&nbsp;Apache&nbsp;and&nbsp;the&nbsp;corresponding&nbsp;configuration&nbsp;is:&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:monospace,monospace&quot;&gt;RewriteRule&nbsp;/img301.jpg&nbsp;/img.svg&nbsp;[R=301,L,E=rcache:1]&lt;/span&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:monospace,monospace&quot;&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;span&nbsp;style=&quot;font-family:monospace,monospace&quot;&gt;RewriteRule&nbsp;/img302.jpg&nbsp;/img.svg&nbsp;[R=302,L,E=rcache:1]&lt;br&gt;RewriteRule&nbsp;/img307.jpg&nbsp;/img.svg&nbsp;[R=307,L,E=rcache:1]&lt;br&gt;&lt;br&gt;Header&nbsp;always&nbsp;set&nbsp;Cache-Control&nbsp;&quot;max-age=3&quot;&nbsp;env=rcache&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;zigi&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Sep&nbsp;21,&nbsp;2017&nbsp;at&nbsp;2:24&nbsp;PM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;21/09/17&nbsp;22:16,&nbsp;kAja&nbsp;Ziegler&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;<br>
 &nbsp; &nbsp;Thats&nbsp;what&nbsp;the&nbsp;&quot;must-revalidate&quot;&nbsp;means.&nbsp;It&nbsp;should&nbsp;work&nbsp;better&nbsp;with&lt;br&gt;<br>
 &nbsp; &nbsp;just&nbsp;max-age&nbsp;or&nbsp;Expires&nbsp;header&nbsp;-&nbsp;and&nbsp;with&nbsp;a&nbsp;longer&nbsp;value&nbsp;than&nbsp;60&nbsp;sec&lt;br&gt;<br>
 &nbsp; &nbsp;since&nbsp;this&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be&nbsp;a&nbsp;*permanent*&nbsp;situation.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;I&nbsp;know&nbsp;&quot;must-revalidate&quot;&nbsp;mean&nbsp;&quot;refuse&nbsp;to&nbsp;return&nbsp;stale&nbsp;responses&nbsp;to&nbsp;the&nbsp;user&nbsp;even&nbsp;if&nbsp;they&nbsp;say&nbsp;that&nbsp;stale&nbsp;responses&nbsp;are&nbsp;acceptable&quot;&nbsp;-&nbsp;cached&nbsp;object&nbsp;must&nbsp;be&nbsp;revalidated.&lt;br&gt;<br>
&lt;br&gt;<br>
Max-age=60&nbsp;was&nbsp;only&nbsp;used&nbsp;for&nbsp;testing.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;results&nbsp;of&nbsp;my&nbsp;testing:&lt;br&gt;<br>
&lt;br&gt;<br>
-&nbsp;redirect&nbsp;302&nbsp;or&nbsp;307&nbsp;-&nbsp;to&nbsp;be&nbsp;cached&nbsp;needs&nbsp;Cache-Control&nbsp;max-age&nbsp;&gt;&nbsp;0&nbsp;or&nbsp;Expires&nbsp;&quot;access&nbsp;plus&nbsp;1&nbsp;seconds&quot;&lt;br&gt;<br>
-&nbsp;redirect&nbsp;301&nbsp;-&nbsp;to&nbsp;be&nbsp;cached&nbsp;needs&nbsp;Cache-Control&nbsp;max-age&nbsp;&gt;&nbsp;60&nbsp;or&nbsp;Expires&nbsp;&quot;access&nbsp;plus&nbsp;61&nbsp;seconds&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
There&nbsp;is&nbsp;no&nbsp;&gt;60&nbsp;need&nbsp;on&nbsp;the&nbsp;301.&nbsp;Just&nbsp;me&nbsp;suggesting&nbsp;that&nbsp;60sec&nbsp;is&nbsp;too&nbsp;short&nbsp;caching&nbsp;time&nbsp;for&nbsp;a&nbsp;_permanent_&nbsp;thing.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;<br>
This&nbsp;is&nbsp;strange&nbsp;because&nbsp;I&nbsp;thought&nbsp;that&nbsp;301&nbsp;is&nbsp;always&nbsp;cached&nbsp;without&nbsp;Cache-Control&nbsp;or&nbsp;Expires&nbsp;headers.&nbsp;And&nbsp;I&nbsp;can&#39;t&nbsp;find&nbsp;any&nbsp;information&nbsp;in&nbsp;the&nbsp;documentation&nbsp;which&nbsp;describes&nbsp;such&nbsp;behaviour.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
It&nbsp;should&nbsp;be,&nbsp;so&nbsp;long&nbsp;as&nbsp;it&nbsp;is&nbsp;fresh&nbsp;so&nbsp;that&nbsp;means&nbsp;it&nbsp;does&nbsp;depend&nbsp;on&nbsp;refresh_pattern&nbsp;saying&nbsp;it&nbsp;is&nbsp;fresh&nbsp;when&nbsp;no&nbsp;controls&nbsp;are&nbsp;present.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.&lt;wbr&gt;org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/l&lt;wbr&gt;istinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
