<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Thats&nbsp;what&nbsp;the&nbsp;&quot;must-revalidate&quot;&nbsp;means.&nbsp;It&nbsp;should&nbsp;work&nbsp;better&nbsp;with&nbsp;just&nbsp;<br>
max-age&nbsp;or&nbsp;Expires&nbsp;header&nbsp;-&nbsp;and&nbsp;with&nbsp;a&nbsp;longer&nbsp;value&nbsp;than&nbsp;60&nbsp;sec&nbsp;since&nbsp;<br>
this&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be&nbsp;a&nbsp;*permanent*&nbsp;situation.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;I&nbsp;know&nbsp;&quot;must-revalidate&quot;&nbsp;mean&nbsp;&quot;refuse&nbsp;to&nbsp;return&nbsp;stale&nbsp;responses&nbsp;to&nbsp;the&nbsp;user&nbsp;even&nbsp;if&nbsp;they&nbsp;say&nbsp;<br>
that&nbsp;stale&nbsp;responses&nbsp;are&nbsp;acceptable&quot;&nbsp;-&nbsp;cached&nbsp;object&nbsp;must&nbsp;be&nbsp;revalidated.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Max-age=60&nbsp;was&nbsp;only&nbsp;used&nbsp;for&nbsp;testing.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;T&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;he&nbsp;results&nbsp;of&nbsp;my&nbsp;testing:&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;-&nbsp;redirect&nbsp;302&nbsp;or&nbsp;307&nbsp;-&nbsp;to&nbsp;be&nbsp;cached&nbsp;needs&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;Cache-Control&nbsp;m&lt;/span&gt;&lt;/span&gt;ax-age&nbsp;&gt;&nbsp;0&nbsp;or&nbsp;Expires&nbsp;&quot;access&nbsp;plus&nbsp;1&nbsp;seconds&quot;&lt;br&gt;&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;-&nbsp;redirect&nbsp;301&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;-&nbsp;to&nbsp;be&nbsp;cached&nbsp;needs&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;id=&quot;gmail-result_box&quot;&nbsp;class=&quot;gmail-short_text&quot;&nbsp;lang=&quot;en&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;Cache-Control&nbsp;m&lt;/span&gt;&lt;/span&gt;ax-age&nbsp;&gt;&nbsp;60&nbsp;or&nbsp;Expires&nbsp;&quot;access&nbsp;plus&nbsp;61&nbsp;seconds&quot;&lt;/div&gt;&lt;br&gt;This&nbsp;is&nbsp;strange&nbsp;because&nbsp;I&nbsp;thought&nbsp;that&nbsp;301&nbsp;is&nbsp;always&nbsp;cached&nbsp;without&nbsp;Cache-Control&nbsp;or&nbsp;Expires&nbsp;headers.&nbsp;And&nbsp;I&nbsp;can&#39;t&nbsp;find&nbsp;any&nbsp;information&nbsp;in&nbsp;the&nbsp;documentation&nbsp;which&nbsp;describes&nbsp;such&nbsp;behaviour.&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;zigi&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Sep&nbsp;21,&nbsp;2017&nbsp;at&nbsp;11:11&nbsp;AM,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;21/09/17&nbsp;20:36,&nbsp;kAja&nbsp;Ziegler&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;Amos,&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;302&nbsp;and&nbsp;307&nbsp;are&nbsp;not&nbsp;because&nbsp;as&nbsp;their&nbsp;status&nbsp;description&nbsp;indicates&lt;br&gt;<br>
 &nbsp; &nbsp;they&nbsp;are&nbsp;*temporary*&nbsp;results.&nbsp;They&nbsp;can&nbsp;only&nbsp;be&nbsp;cached&nbsp;if&nbsp;there&nbsp;are&lt;br&gt;<br>
 &nbsp; &nbsp;explicit&nbsp;details&nbsp;from&nbsp;the&nbsp;server&nbsp;indicating&nbsp;for&nbsp;how&nbsp;long.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;were&nbsp;right.&nbsp;After&nbsp;I&nbsp;added&nbsp;header&nbsp;Cache-Control&nbsp;&quot;max-age=60,&nbsp;must-revalidate&quot;&nbsp;to&nbsp;the&nbsp;redirects,&nbsp;then&nbsp;the&nbsp;response&nbsp;was&nbsp;cached.&nbsp;Thank&nbsp;you&nbsp;for&nbsp;clarification.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;301&nbsp;should&nbsp;be&nbsp;cached&nbsp;unless&nbsp;the&nbsp;object&nbsp;would&nbsp;need&nbsp;revalidation&lt;br&gt;<br>
 &nbsp; &nbsp;immediately.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;for&nbsp;301&nbsp;I&nbsp;always&nbsp;get&nbsp;MISS&nbsp;-&nbsp;with&nbsp;and&nbsp;without&nbsp;a&nbsp;cache-control&nbsp;header:&lt;br&gt;<br>
&lt;br&gt;<br>
$&nbsp;curl&nbsp;-v&nbsp;http:/&lt;a&nbsp;href=&quot;http://test.example.com/img301.jpg&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;test.example.com/img301.&lt;wbr&gt;jpg&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://test.example.com/img301.jpg&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://test.example.com/img30&lt;wbr&gt;1.jpg&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
GET&nbsp;/img301.jpg&nbsp;HTTP/1.1&lt;br&gt;<br>
Host:&nbsp;&lt;a&nbsp;href=&quot;http://test.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;test.example.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://test.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://test.example.com&lt;/a&gt;&gt;&lt;br&gt;<br>
User-Agent:&nbsp;curl/7.50.1&lt;br&gt;<br>
Accept:&nbsp;*/*&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;&nbsp;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently&lt;br&gt;<br>
&lt;&nbsp;Date:&nbsp;Thu,&nbsp;21&nbsp;Sep&nbsp;2017&nbsp;06:44:41&nbsp;GMT&lt;br&gt;<br>
&lt;&nbsp;Server:&nbsp;Apache&lt;br&gt;<br>
&lt;&nbsp;Cache-Control:&nbsp;max-age=60,&nbsp;must-revalidate&lt;br&gt;<br>
&lt;&nbsp;Location:&nbsp;&lt;a&nbsp;href=&quot;http://test.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://test.example.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://test.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://test.example.com&lt;/a&gt;&gt;/img.&lt;wbr&gt;svg&lt;br&gt;<br>
&lt;&nbsp;Content-Length:&nbsp;247&lt;br&gt;<br>
&lt;&nbsp;Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1&lt;br&gt;<br>
&lt;&nbsp;X-Cache:&nbsp;MISS&nbsp;from&nbsp;&lt;squid-proxy&gt;&lt;br&gt;<br>
&lt;&nbsp;X-Cache-Lookup:&nbsp;MISS&nbsp;from&nbsp;&lt;squid-proxy&gt;:3128&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;can&#39;t&nbsp;find&nbsp;any&nbsp;information&nbsp;on&nbsp;Squid&nbsp;wiki&nbsp;or&nbsp;via&nbsp;Google&nbsp;if&nbsp;the&nbsp;object&nbsp;need&nbsp;revalidation&nbsp;immediately.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Thats&nbsp;what&nbsp;the&nbsp;&quot;must-revalidate&quot;&nbsp;means.&nbsp;It&nbsp;should&nbsp;work&nbsp;better&nbsp;with&nbsp;just&nbsp;max-age&nbsp;or&nbsp;Expires&nbsp;header&nbsp;-&nbsp;and&nbsp;with&nbsp;a&nbsp;longer&nbsp;value&nbsp;than&nbsp;60&nbsp;sec&nbsp;since&nbsp;this&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be&nbsp;a&nbsp;*permanent*&nbsp;situation.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.&lt;wbr&gt;org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/l&lt;wbr&gt;istinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
