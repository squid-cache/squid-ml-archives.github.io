<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;tahoma,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000&quot;&gt;&lt;div&gt;I&nbsp;was&nbsp;asked&nbsp;to&nbsp;block&nbsp;Facebook&nbsp;access&nbsp;from&nbsp;8:00am&nbsp;to&nbsp;3:00pm&nbsp;for&nbsp;almost&nbsp;all&nbsp;users&nbsp;but&nbsp;them&nbsp;are&nbsp;using&nbsp;**alternative&nbsp;Facebook&nbsp;URLs**&nbsp;to&nbsp;access&nbsp;the&nbsp;social&nbsp;network&nbsp;anyway.&nbsp;This&nbsp;is&nbsp;consuming&nbsp;a&nbsp;lot&nbsp;of&nbsp;our&nbsp;low&nbsp;bandwidth&nbsp;and&nbsp;we&nbsp;can't&nbsp;even&nbsp;work.&nbsp;I&nbsp;decided&nbsp;to&nbsp;design&nbsp;a&nbsp;**regular&nbsp;expression&nbsp;(regex)&nbsp;to&nbsp;parse&nbsp;these&nbsp;URLs&nbsp;and&nbsp;block&nbsp;them**.&nbsp;I&nbsp;don't&nbsp;want&nbsp;to&nbsp;block&nbsp;all&nbsp;facebook&nbsp;URLs&nbsp;but&nbsp;only&nbsp;alternatives.&nbsp;An&nbsp;alternative&nbsp;Facebook&nbsp;URLs&nbsp;mostly&nbsp;contains&nbsp;the&nbsp;words&nbsp;**prod**&nbsp;or&nbsp;**iphone**.&nbsp;The&nbsp;next&nbsp;ones&nbsp;are&nbsp;alternative&nbsp;Facebook&nbsp;URLs&nbsp;registered&nbsp;by&nbsp;our&nbsp;proxy&nbsp;server:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.iphone.touch.prod.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.iphone.haid.prod.facebook.com:443&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.ct.prod.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.vi-vn.prod.facebook.com&lt;br&gt;&lt;br&gt;The&nbsp;designed&nbsp;regex:&nbsp;`/((?=.*\biphone\b)|(?=.*\bprod\b)).*\.facebook\.com(\:|\d|)/`&lt;br&gt;&lt;br&gt;I&nbsp;tested&nbsp;this&nbsp;regex&nbsp;on&nbsp;https://regex101.com/&nbsp;and&nbsp;https://www.regextester.com.&nbsp;The&nbsp;regex&nbsp;is&nbsp;**matching**&nbsp;for:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.iphone.touch.prod.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.iphone.haid.prod.facebook.com:443&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.ct.prod.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.vi-vn.prod.facebook.com&lt;br&gt;&lt;br&gt;And&nbsp;is&nbsp;**not&nbsp;matching**&nbsp;for:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;www.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;m.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;mqtt.facebook.com&nbsp;(for&nbsp;purple-facebook)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;graph.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;connect.facebook.com&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;3-edge-chat.facebook.com&lt;br&gt;&lt;br&gt;So&nbsp;far&nbsp;this&nbsp;is&nbsp;what&nbsp;I&nbsp;wanted,&nbsp;alternative&nbsp;URLs&nbsp;blocked&nbsp;and&nbsp;regular&nbsp;Facebook&nbsp;URLs&nbsp;allowed.&nbsp;**My&nbsp;regex&nbsp;looks&nbsp;good&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;squid**.&lt;br&gt;&lt;br&gt;Next&nbsp;step&nbsp;is&nbsp;to&nbsp;modify&nbsp;the&nbsp;file&nbsp;/etc/squid3/squid.conf&nbsp;by&nbsp;adding&nbsp;a&nbsp;new&nbsp;acl&nbsp;pointing&nbsp;the&nbsp;file&nbsp;that&nbsp;contains&nbsp;the&nbsp;regex:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&lt;strong&gt;&nbsp;acl&nbsp;facebook&nbsp;dstdom_regex&nbsp;&quot;/etc/squid3/acl/facebook&quot;&nbsp;//The&nbsp;file&nbsp;contains&nbsp;the&nbsp;regex&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;pass&nbsp;facebook&lt;/strong&gt;&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;run&nbsp;**squid3&nbsp;-k&nbsp;parse**&nbsp;for&nbsp;check&nbsp;the&nbsp;configuration&nbsp;file&nbsp;I&nbsp;am&nbsp;getting&nbsp;the&nbsp;errors:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;strong&gt;2017/09/22&nbsp;11:12:26|&nbsp;Processing:&nbsp;acl&nbsp;facebook&nbsp;dstdom_regex&nbsp;&quot;/etc/squid3/acl/facebook&quot;&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;&nbsp;&nbsp;&nbsp;&nbsp;2017/09/22&nbsp;11:12:26|&nbsp;squid.conf&nbsp;line&nbsp;78:&nbsp;acl&nbsp;facebook&nbsp;dstdom_regex&nbsp;&quot;/etc/squid3/acl/facebook&quot;&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;&nbsp;&nbsp;&nbsp;&nbsp;2017/09/22&nbsp;11:12:26|&nbsp;aclParseRegexList:&nbsp;Invalid&nbsp;regular&nbsp;expression&nbsp;'((?=.*\biphone\b)|(?=.*\bprod\b)).*\.facebook\.com(\:|\d|)':&nbsp;Invalid&nbsp;preceding&nbsp;regular&nbsp;expression&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;&nbsp;&nbsp;&nbsp;&nbsp;2017/09/22&nbsp;12:39:33|&nbsp;Warning:&nbsp;empty&nbsp;ACL:&nbsp;acl&nbsp;facebook&nbsp;dstdom_regex&nbsp;&quot;/etc/squid3/acl/facebook&quot;&lt;/strong&gt;&lt;br&gt;&lt;br&gt;Obviously,&nbsp;the&nbsp;squid3&nbsp;parser&nbsp;is&nbsp;tagging&nbsp;my&nbsp;acl&nbsp;as&nbsp;**wrong**,&nbsp;but&nbsp;I&nbsp;already&nbsp;tested&nbsp;online&nbsp;and&nbsp;it&nbsp;was&nbsp;good&nbsp;to&nbsp;use.&nbsp;Also&nbsp;it&nbsp;says&nbsp;the&nbsp;acl&nbsp;is&nbsp;empty.&nbsp;What&nbsp;does&nbsp;this&nbsp;mean?&nbsp;The&nbsp;acl&nbsp;was&nbsp;declared&nbsp;with&nbsp;the&nbsp;name&nbsp;**facebook**.&nbsp;I&nbsp;am&nbsp;very&nbsp;confused&nbsp;at&nbsp;this.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;name=&quot;x&quot;&gt;&lt;/span&gt;Ing.&nbsp;Pedro&nbsp;Pablo&nbsp;Delgado&nbsp;Martell&lt;span&nbsp;name=&quot;x&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;<br>
&lt;br&gt;<br>
Participe&nbsp;en&nbsp;el&nbsp;Congreso&nbsp;Internacional&nbsp;de&nbsp;las&nbsp;Ciencias&nbsp;Agropecuarias&nbsp;(AGROCIENCIAS&nbsp;2017)&nbsp;http://www.agrocienciascuba.com/&lt;/br&gt;<br>
<br>
&lt;br&gt;&lt;/html&gt;
</tt>
