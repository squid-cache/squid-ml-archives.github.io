<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;I&nbsp;have&nbsp;an&nbsp;issue:&nbsp;if&nbsp;I&nbsp;restart&nbsp;Squid&nbsp;(with&nbsp;Rock&nbsp;storage),&nbsp;I&nbsp;can&nbsp;no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;longer&nbsp;get&nbsp;TCP_MEM_HIT&nbsp;for&nbsp;any&nbsp;object&nbsp;got&nbsp;cached&nbsp;before&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;restart&nbsp;--&nbsp;I&nbsp;always&nbsp;get&nbsp;TCP_HIT&nbsp;instead.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Steps&nbsp;to&nbsp;reproduce:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;1)&nbsp;Stop&nbsp;squid.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;2)&nbsp;Remove&nbsp;&amp;&nbsp;create&nbsp;a&nbsp;new&nbsp;Rock&nbsp;storage,&nbsp;start&nbsp;Squid.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;3)&nbsp;Get&nbsp;a&nbsp;url&nbsp;via&nbsp;Squid,&nbsp;e.g.:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt; &nbsp;curl&nbsp;-o&nbsp;/dev/null&nbsp;-v&nbsp;-x&nbsp;localhost:3128<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://cdn.bootcss.com/font-linux/0.9/font-linux.woff&quot;&gt;http://cdn.bootcss.com/font-linux/0.9/font-linux.woff&lt;/a&gt;&lt;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href=&quot;http://cdn.bootcss.com/font-linux/0.9/font-linux.woff&quot;&gt;&lt;/a&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt; &nbsp;Suppose&nbsp;Squid&nbsp;is&nbsp;running&nbsp;on&nbsp;localhost:3128.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt; &nbsp;This&nbsp;should&nbsp;get&nbsp;a&nbsp;TCP_MISS.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;4)&nbsp;Repeat&nbsp;step&nbsp;3,&nbsp;and&nbsp;this&nbsp;should&nbsp;get&nbsp;a&nbsp;TCP_MEM_HIT.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;5)&nbsp;Stop&nbsp;&amp;&nbsp;start&nbsp;Squid.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;6)&nbsp;Repeat&nbsp;step&nbsp;3&nbsp;for&nbsp;more&nbsp;than&nbsp;2&nbsp;times,&nbsp;and&nbsp;all&nbsp;the&nbsp;results&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP_HIT,&nbsp;however&nbsp;I&nbsp;expect&nbsp;the&nbsp;2nd&nbsp;and&nbsp;following&nbsp;rounds&nbsp;should&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP_MEM_HIT.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;So&nbsp;it&nbsp;seems&nbsp;an&nbsp;object&nbsp;can&nbsp;never&nbsp;be&nbsp;copied&nbsp;from&nbsp;disk&nbsp;cache&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory&nbsp;cache&nbsp;after&nbsp;a&nbsp;restart.&nbsp;Is&nbsp;this&nbsp;normal?&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;I&nbsp;tested&nbsp;3.5.27&nbsp;and&nbsp;master&nbsp;branch&nbsp;in&nbsp;github,&nbsp;the&nbsp;results&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same.&nbsp;The&nbsp;configuration&nbsp;file&nbsp;is&nbsp;attached.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Thanks.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Duan,&nbsp;Yao&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
