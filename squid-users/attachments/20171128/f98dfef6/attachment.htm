<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;Alex,&nbsp;this&nbsp;is&nbsp;very&nbsp;helpful.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Another&nbsp;interesting&nbsp;fact&nbsp;is&nbsp;that&nbsp;I&nbsp;can&#39;t&nbsp;reproduce&nbsp;this&nbsp;issue&nbsp;if&nbsp;squid&nbsp;has&nbsp;no&nbsp;other&nbsp;traffic&nbsp;except&nbsp;my&nbsp;testing&nbsp;requests.&nbsp;But&nbsp;it&#39;s&nbsp;easy&nbsp;to&nbsp;reproduce&nbsp;when&nbsp;server&nbsp;has&nbsp;other&nbsp;traffic.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;with&nbsp;other&nbsp;traffic&nbsp;I&nbsp;can&#39;t&nbsp;provide&nbsp;the&nbsp;whole&nbsp;log&nbsp;file&nbsp;with&nbsp;debug&nbsp;ALL,7&nbsp;enabled&nbsp;because&nbsp;it&nbsp;has&nbsp;other&nbsp;requests.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;I&nbsp;tried&nbsp;to&nbsp;select&nbsp;only&nbsp;parts&nbsp;related&nbsp;to&nbsp;my&nbsp;test&nbsp;request&nbsp;(this&nbsp;is&nbsp;ALL,7):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://www.dropbox.com/s/udzeipeerf5o38t/squid_retry_logs.tgz?dl=1&quot;&gt;https://www.dropbox.com/s/udzeipeerf5o38t/squid_retry_logs.tgz?dl=1&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Nov&nbsp;28,&nbsp;2017&nbsp;at&nbsp;7:32&nbsp;AM,&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;On&nbsp;11/27/2017&nbsp;05:19&nbsp;PM,&nbsp;Ivan&nbsp;Larionov&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;see&nbsp;retries&nbsp;only&nbsp;when&nbsp;squid&nbsp;config&nbsp;has&nbsp;2&nbsp;parents.&nbsp;If&nbsp;I&nbsp;comment&nbsp;out&lt;br&gt;<br>
&gt;&nbsp;everything&nbsp;related&nbsp;to&nbsp;&quot;newproxy&quot;&nbsp;I&nbsp;can&#39;t&nbsp;reproduce&nbsp;this&nbsp;behavior&nbsp;anymore.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;The&nbsp;posted&nbsp;logs&nbsp;are&nbsp;not&nbsp;detailed&nbsp;enough&nbsp;to&nbsp;confirm&nbsp;or&nbsp;deny&nbsp;that&nbsp;IMO,&nbsp;but&lt;br&gt;<br>
I&nbsp;suspect&nbsp;that&nbsp;you&nbsp;are&nbsp;dealing&nbsp;with&nbsp;at&nbsp;least&nbsp;one&nbsp;bug.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/SquidFaq/InnerWorkings#When_does_Squid_re-forward_a_client_request.3F&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/&lt;wbr&gt;SquidFaq/InnerWorkings#When_&lt;wbr&gt;does_Squid_re-forward_a_&lt;wbr&gt;client_request.3F&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Squid&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;re-forward&nbsp;a&nbsp;request&nbsp;if&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;conditions&nbsp;is&nbsp;true:&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;The&nbsp;number&nbsp;of&nbsp;forwarding&nbsp;attempts&nbsp;exceeded&nbsp;forward_max_tries.&nbsp;For&lt;br&gt;<br>
&gt;&gt;&nbsp;example,&nbsp;if&nbsp;you&nbsp;set&nbsp;forward_max_tries&nbsp;to&nbsp;1&nbsp;(one),&nbsp;then&nbsp;no&nbsp;requests&lt;br&gt;<br>
&gt;&gt;&nbsp;will&nbsp;be&nbsp;re-forwarded.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;AFAICT,&nbsp;there&nbsp;is&nbsp;an&nbsp;off-by-one&nbsp;bug&nbsp;in&nbsp;Squid&nbsp;that&nbsp;violates&nbsp;the&nbsp;above:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt; &nbsp; &nbsp; if&nbsp;(n_tries&nbsp;&gt;&nbsp;Config.forward_max_tries)&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;false;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;n_tries&nbsp;counter&nbsp;is&nbsp;incremented&nbsp;before&nbsp;Squid&nbsp;makes&nbsp;a&nbsp;request&lt;br&gt;<br>
forwarding&nbsp;attempt.&nbsp;With&nbsp;n_tries&nbsp;and&nbsp;Config.forward_max_tries&nbsp;both&nbsp;set&lt;br&gt;<br>
to&nbsp;1,&nbsp;the&nbsp;quoted&nbsp;FwdState::checkRetry()&nbsp;code&nbsp;will&nbsp;not&nbsp;prevent&lt;br&gt;<br>
re-forwarding.&nbsp;There&nbsp;is&nbsp;a&nbsp;similar&nbsp;problem&nbsp;in&nbsp;FwdState::reforward().&nbsp;This&lt;br&gt;<br>
reasoning&nbsp;needs&nbsp;confirmation/testing.&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;note&nbsp;that&nbsp;simply&nbsp;changing&nbsp;the&nbsp;&quot;&gt;&quot;&nbsp;operator&nbsp;to&nbsp;&quot;&gt;=&quot;&nbsp;may&nbsp;break&lt;br&gt;<br>
other&nbsp;things&nbsp;in&nbsp;a&nbsp;difficult-to-detect-by-simple-&lt;wbr&gt;tests&nbsp;ways.&nbsp;The&nbsp;correct&lt;br&gt;<br>
fix&nbsp;may&nbsp;be&nbsp;more&nbsp;complex&nbsp;than&nbsp;it&nbsp;looks&nbsp;and&nbsp;may&nbsp;involve&nbsp;making&nbsp;policy&lt;br&gt;<br>
decisions&nbsp;regarding&nbsp;forward_max_tries&nbsp;meaning.&nbsp;The&nbsp;best&nbsp;fix&nbsp;would&nbsp;remove&lt;br&gt;<br>
checkRetry()&nbsp;and&nbsp;reforward()&nbsp;duplication.&nbsp;This&nbsp;code&nbsp;is&nbsp;difficult&nbsp;to&nbsp;work&lt;br&gt;<br>
with;&nbsp;many&nbsp;related&nbsp;code&nbsp;names&nbsp;are&nbsp;misleading.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&gt;&nbsp;Squid&nbsp;has&nbsp;no&nbsp;alternative&nbsp;destinations&nbsp;to&nbsp;try.&nbsp;Please&nbsp;note&nbsp;that&lt;br&gt;<br>
&gt;&gt;&nbsp;alternative&nbsp;destinations&nbsp;may&nbsp;include&nbsp;multiple&nbsp;next&nbsp;hop&nbsp;IP&nbsp;addresses&lt;br&gt;<br>
&gt;&gt;&nbsp;and&nbsp;multiple&nbsp;peers.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;The&nbsp;fact&nbsp;that&nbsp;Squid&nbsp;sends&nbsp;two&nbsp;requests&nbsp;to&nbsp;the&nbsp;same&nbsp;peer&nbsp;with&nbsp;only&nbsp;one&lt;br&gt;<br>
peer&nbsp;address&nbsp;selected&nbsp;suggests&nbsp;that&nbsp;Squid&nbsp;is&nbsp;retrying&nbsp;a&nbsp;failed&lt;br&gt;<br>
persistent&nbsp;connection&nbsp;rather&nbsp;than&nbsp;re-forwarding&nbsp;after&nbsp;receiving&nbsp;a&nbsp;bad&lt;br&gt;<br>
response.&nbsp;Again,&nbsp;the&nbsp;logs&nbsp;are&nbsp;not&nbsp;detailed&nbsp;enough&nbsp;to&nbsp;distinguish&nbsp;the&nbsp;two&lt;br&gt;<br>
cases.&nbsp;I&nbsp;can&nbsp;only&nbsp;see&nbsp;that&nbsp;a&nbsp;single&nbsp;peer/destination&nbsp;address&nbsp;was&lt;br&gt;<br>
selected&nbsp;(not&nbsp;two),&nbsp;which&nbsp;is&nbsp;correct/expected&nbsp;behavior.&nbsp;I&nbsp;cannot&nbsp;see&lt;br&gt;<br>
what&nbsp;happened&nbsp;next&nbsp;with&nbsp;sufficient&nbsp;detail.&lt;br&gt;<br>
&lt;br&gt;<br>
Going&nbsp;forward,&nbsp;you&nbsp;have&nbsp;several&nbsp;options,&nbsp;including:&lt;br&gt;<br>
&lt;br&gt;<br>
A.&nbsp;Post&nbsp;a&nbsp;link&nbsp;to&nbsp;compressed&nbsp;ALL,7+&nbsp;logs&nbsp;to&nbsp;confirm&nbsp;bug(s).&lt;br&gt;<br>
B.&nbsp;Fix&nbsp;the&nbsp;broken&nbsp;condition(s)&nbsp;in&nbsp;FwdState.&nbsp;See&nbsp;above.&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.542|&nbsp;5,2|&nbsp;TcpAcceptor.cc(220)&nbsp;doAccept:&nbsp;New&nbsp;connection&nbsp;on&nbsp;FD&nbsp;15&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.542|&nbsp;5,2|&nbsp;TcpAcceptor.cc(295)&nbsp;acceptNext:&nbsp;connection&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;on&nbsp;local=&lt;a&nbsp;href=&quot;http://0.0.0.0:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0:3128&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://0.0.0.0:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://0.0.0.0:3128&lt;/a&gt;&gt;&nbsp;remote=[::]&nbsp;FD&nbsp;15&nbsp;flags=9&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;11,2|&nbsp;client_side.cc(2372)&nbsp;parseHttpRequest:&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;HTTP&nbsp;Client&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:3128&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:3128&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:53798&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:53798&lt;/a&gt;&gt;&nbsp;FD&nbsp;45&nbsp;flags=1&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;11,2|&nbsp;client_side.cc(2373)&nbsp;parseHttpRequest:&lt;br&gt;<br>
&gt;&nbsp;HTTP&nbsp;Client&nbsp;REQUEST:&lt;br&gt;<br>
&gt;&nbsp;---------&lt;br&gt;<br>
&gt;&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;HTTP/1.1&lt;br&gt;<br>
&gt;&nbsp;Host:&nbsp;HOST:12345&lt;br&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;curl/7.51.0&lt;br&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;br&gt;<br>
&gt;&nbsp;Proxy-Connection:&nbsp;Keep-Alive&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;85,2|&nbsp;client_side_request.cc(745)&lt;br&gt;<br>
&gt;&nbsp;clientAccessCheckDone:&nbsp;The&nbsp;request&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;is&nbsp;ALLOWED;&lt;br&gt;<br>
&gt;&nbsp;last&nbsp;ACL&nbsp;checked:&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;85,2|&nbsp;client_side_request.cc(721)&lt;br&gt;<br>
&gt;&nbsp;clientAccessCheck2:&nbsp;No&nbsp;adapted_http_access&nbsp;configuration.&nbsp;default:&nbsp;ALLOW&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;85,2|&nbsp;client_side_request.cc(745)&lt;br&gt;<br>
&gt;&nbsp;clientAccessCheckDone:&nbsp;The&nbsp;request&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;is&nbsp;ALLOWED;&lt;br&gt;<br>
&gt;&nbsp;last&nbsp;ACL&nbsp;checked:&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;17,2|&nbsp;FwdState.cc(133)&nbsp;FwdState:&nbsp;Forwarding&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;client&nbsp;request&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:3128&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:3128&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:53798&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:53798&lt;/a&gt;&gt;&nbsp;FD&nbsp;45&nbsp;flags=1,&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;url=&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(258)&nbsp;peerSelectDnsPaths:&lt;br&gt;<br>
&gt;&nbsp;Find&nbsp;IP&nbsp;destination&nbsp;for:&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&#39;&nbsp;via&nbsp;127.0.0.1&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(280)&nbsp;peerSelectDnsPaths:&lt;br&gt;<br>
&gt;&nbsp;Found&nbsp;sources&nbsp;for&nbsp;&#39;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&#39;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(281)&nbsp;peerSelectDnsPaths: &lt;br&gt;<br>
&gt;&nbsp; always_direct&nbsp;=&nbsp;DENIED&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(282)&nbsp;peerSelectDnsPaths: &lt;br&gt;<br>
&gt;&nbsp; &nbsp;never_direct&nbsp;=&nbsp;ALLOWED&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(292)&nbsp;peerSelectDnsPaths: &lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp;cache_peer&nbsp;=&nbsp;local=127.0.0.3&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:18070&lt;/a&gt;&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:18070&lt;/a&gt;&gt;&nbsp;flags=1&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;44,2|&nbsp;peer_select.cc(295)&nbsp;peerSelectDnsPaths: &lt;br&gt;<br>
&gt;&nbsp; &nbsp; &nbsp; &nbsp;timedout&nbsp;=&nbsp;0&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;11,2|&nbsp;http.cc(2229)&nbsp;sendRequest:&nbsp;HTTP&nbsp;Server&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.3:57091&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.3:57091&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.3:57091&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.3:57091&lt;/a&gt;&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:18070&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:18070&lt;/a&gt;&gt;&nbsp;FD&nbsp;40&nbsp;flags=1&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:53:40.543|&nbsp;11,2|&nbsp;http.cc(2230)&nbsp;sendRequest:&nbsp;HTTP&nbsp;Server&lt;br&gt;<br>
&gt;&nbsp;REQUEST:&lt;br&gt;<br>
&gt;&nbsp;---------&lt;br&gt;<br>
&gt;&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;HTTP/1.1&lt;br&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;curl/7.51.0&lt;br&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;br&gt;<br>
&gt;&nbsp;Host:&nbsp;HOST:12345&lt;br&gt;<br>
&gt;&nbsp;Cache-Control:&nbsp;max-age=259200&lt;br&gt;<br>
&gt;&nbsp;Connection:&nbsp;keep-alive&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;[SKIPPED&nbsp;40&nbsp;seconds&nbsp;until&nbsp;parent&nbsp;closes&nbsp;TCP&nbsp;connection&nbsp;with&nbsp;FIN,ACK]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:54:20.627|&nbsp;11,2|&nbsp;http.cc(1299)&nbsp;continueAfterParsingHeader:&lt;br&gt;<br>
&gt;&nbsp;WARNING:&nbsp;HTTP:&nbsp;Invalid&nbsp;Response:&nbsp;No&nbsp;object&nbsp;data&nbsp;received&nbsp;for&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;AKA&nbsp;HOST/&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:54:20.627|&nbsp;17,2|&nbsp;FwdState.cc(655)&lt;br&gt;<br>
&gt;&nbsp;handleUnregisteredServerEnd:&nbsp;self=0x3e31838*2&nbsp;err=0x409b338&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:54:20.627|&nbsp;11,2|&nbsp;http.cc(2229)&nbsp;sendRequest:&nbsp;HTTP&nbsp;Server&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.3:41355&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.3:41355&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.3:41355&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.3:41355&lt;/a&gt;&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:18070&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:18070&lt;/a&gt;&gt;&nbsp;FD&nbsp;40&nbsp;flags=1&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:54:20.627|&nbsp;11,2|&nbsp;http.cc(2230)&nbsp;sendRequest:&nbsp;HTTP&nbsp;Server&lt;br&gt;<br>
&gt;&nbsp;REQUEST:&lt;br&gt;<br>
&gt;&nbsp;---------&lt;br&gt;<br>
&gt;&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;HTTP/1.1&lt;br&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;curl/7.51.0&lt;br&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;br&gt;<br>
&gt;&nbsp;Host:&nbsp;HOST:12345&lt;br&gt;<br>
&gt;&nbsp;Cache-Control:&nbsp;max-age=259200&lt;br&gt;<br>
&gt;&nbsp;Connection:&nbsp;keep-alive&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;[SKIPPED&nbsp;40&nbsp;seconds&nbsp;again&nbsp;until&nbsp;parent&nbsp;closes&nbsp;TCP&nbsp;connection&nbsp;with&nbsp;FIN,ACK]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;ctx:&nbsp;enter&nbsp;level &nbsp;0:&nbsp;&#39;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&#39;&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;11,2|&nbsp;http.cc(719)&nbsp;processReplyHeader:&nbsp;HTTP&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;Server&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.3:41355&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.3:41355&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.3:41355&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.3:41355&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:18070&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:18070&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:18070&lt;/a&gt;&gt;&nbsp;FD&nbsp;40&nbsp;flags=1&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;11,2|&nbsp;http.cc(720)&nbsp;processReplyHeader:&nbsp;HTTP&lt;br&gt;<br>
&gt;&nbsp;Server&nbsp;REPLY:&lt;br&gt;<br>
&gt;&nbsp;---------&lt;br&gt;<br>
&gt;&nbsp;HTTP/1.0&nbsp;502&nbsp;Bad&nbsp;Gateway&lt;br&gt;<br>
&gt;&nbsp;Cache-Control:&nbsp;no-cache&lt;br&gt;<br>
&gt;&nbsp;Connection:&nbsp;close&lt;br&gt;<br>
&gt;&nbsp;Content-Type:&nbsp;text/html&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;html&gt;&lt;body&gt;&lt;h1&gt;502&nbsp;Bad&nbsp;Gateway&lt;/h1&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;server&nbsp;returned&nbsp;an&nbsp;invalid&nbsp;or&nbsp;incomplete&nbsp;response.&lt;br&gt;<br>
&gt;&nbsp;&lt;/body&gt;&lt;/html&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;ctx:&nbsp;exit&nbsp;level &nbsp;0&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;20,2|&nbsp;store.cc(996)&nbsp;checkCachable:&lt;br&gt;<br>
&gt;&nbsp;StoreEntry::checkCachable:&nbsp;NO:&nbsp;not&nbsp;cachable&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;20,2|&nbsp;store.cc(996)&nbsp;checkCachable:&lt;br&gt;<br>
&gt;&nbsp;StoreEntry::checkCachable:&nbsp;NO:&nbsp;not&nbsp;cachable&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;88,2|&nbsp;client_side_reply.cc(2073)&lt;br&gt;<br>
&gt;&nbsp;processReplyAccessResult:&nbsp;The&nbsp;reply&nbsp;for&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://HOST:12345/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://HOST:12345/&lt;/a&gt;&nbsp;is&lt;br&gt;<br>
&gt;&nbsp;ALLOWED,&nbsp;because&nbsp;it&nbsp;matched&nbsp;(access_log&nbsp;stdio:/var/log/squid/access.&lt;wbr&gt;log&lt;br&gt;<br>
&gt;&nbsp;line)&lt;br&gt;<br>
&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;11,2|&nbsp;client_side.cc(1409)&nbsp;sendStartOfMessage:&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;HTTP&nbsp;Client&nbsp;local=&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:3128&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:3128&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;127.0.0.1:53798&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://127.0.0.1:53798&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://127.0.0.1:53798&lt;/a&gt;&gt;&nbsp;FD&nbsp;45&nbsp;flags=1&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&gt;&nbsp;2017/11/27&nbsp;15:55:00.728|&nbsp;11,2|&nbsp;client_side.cc(1410)&nbsp;sendStartOfMessage:&lt;br&gt;<br>
&gt;&nbsp;HTTP&nbsp;Client&nbsp;REPLY:&lt;br&gt;<br>
&gt;&nbsp;---------&lt;br&gt;<br>
&gt;&nbsp;HTTP/1.1&nbsp;502&nbsp;Bad&nbsp;Gateway&lt;br&gt;<br>
&gt;&nbsp;Date:&nbsp;Mon,&nbsp;27&nbsp;Nov&nbsp;2017&nbsp;23:54:20&nbsp;GMT&lt;br&gt;<br>
&gt;&nbsp;Cache-Control:&nbsp;no-cache&lt;br&gt;<br>
&gt;&nbsp;Content-Type:&nbsp;text/html&lt;br&gt;<br>
&gt;&nbsp;X-Cache:&nbsp;MISS&nbsp;from&nbsp;ip-172-23-18-130&lt;br&gt;<br>
&gt;&nbsp;X-Cache-Lookup:&nbsp;MISS&nbsp;from&nbsp;ip-172-23-18-130:3128&lt;br&gt;<br>
&gt;&nbsp;Transfer-Encoding:&nbsp;chunked&lt;br&gt;<br>
&gt;&nbsp;Connection:&nbsp;keep-alive&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;With&nbsp;best&nbsp;regards,&nbsp;Ivan&nbsp;Larionov.&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
