<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;style&gt;body&nbsp;{&nbsp;line-height:&nbsp;1.5;&nbsp;}blockquote&nbsp;{&nbsp;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0.5em;&nbsp;}body&nbsp;{&nbsp;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;????;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;line-height:&nbsp;1.5;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;<br>
&lt;div&gt;&lt;span&gt;&lt;/span&gt;Hi,&nbsp;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;Amos&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Thanks&nbsp;a&nbsp;lot&nbsp;for&nbsp;your&nbsp;reply.&nbsp;&nbsp;In&nbsp;my&nbsp;conf,&nbsp;squid&nbsp;is&nbsp;not&nbsp;only&nbsp;a&nbsp;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;reverse-proxy&nbsp;server,&nbsp;but&nbsp;also&nbsp;a&nbsp;cache&nbsp;server.&nbsp;And&nbsp;that&nbsp;is&nbsp;important&nbsp;to&nbsp;me.&nbsp;&nbsp;In&nbsp;fact&nbsp;,&nbsp;it&nbsp;does't&nbsp;normally&nbsp;for&nbsp;my&nbsp;product&nbsp;environment.&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.112.4.54&nbsp;is&nbsp;the&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;apache&nbsp;server(been&nbsp;agent&nbsp;by&nbsp;squid)&nbsp;,&nbsp;and&nbsp;my&nbsp;request&nbsp;is&nbsp;also&nbsp;sent&nbsp;by&nbsp;it(such&nbsp;as&nbsp;browser&nbsp;reque&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;s&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;window;&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;t&nbsp;and&nbsp;mimetic&nbsp;of&nbsp;httpclient&nbsp;reque&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;s&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;window;&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;t&nbsp;by&nbsp;java).&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.113.10.191&nbsp;is&nbsp;the&nbsp;peer&nbsp;squid&nbsp;server,&nbsp;And&nbsp;is&nbsp;closed&nbsp;now.&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.113.10.190&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;,&nbsp;as&nbsp;you&nbsp;see,&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;window;&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;is&nbsp;the&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;current&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;reverse-proxy&nbsp;server.&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;W&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;hole&nbsp;proceess&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.112.4.54(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;browser&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;)&nbsp;&nbsp;&lt;u&gt;send&nbsp;request&lt;/u&gt;&lt;i&gt;&nbsp;&nbsp;&nbsp;&lt;/i&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.113.10.190&nbsp;&lt;u&gt;if&nbsp;not&nbsp;cached,&nbsp;forward&nbsp;the&nbsp;requset&nbsp;to&nbsp;apache&nbsp;server&lt;/u&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.112.4.54&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;apache&nbsp;server&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&nbsp;&lt;u&gt;return&nbsp;the&nbsp;response&nbsp;page&nbsp;to&nbsp;browser&lt;/u&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.112.4.54&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;browser&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&quot;&gt;&nbsp;&lt;/span&gt;&lt;u&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;if&nbsp;cached,&nbsp;return&nbsp;the&nbsp;page&lt;/u&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;rgba(0,&nbsp;0,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;10.112.4.54&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;browser&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;below&nbsp;is&nbsp;my&nbsp;squid.conf&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;gsrc&nbsp;src&nbsp;10.112.4.54&nbsp;10.113.10.191&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;gdst&nbsp;dst&nbsp;10.112.4.54&nbsp;10.113.10.191&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gsrc&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gdst&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&gt;What&nbsp;is&nbsp;the&nbsp;above&nbsp;supposed&nbsp;to&nbsp;mean?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;10.0.0.0/8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;172.16.0.0/12&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;192.168.0.0/16&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;purge&nbsp;method&nbsp;PURGE&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;clientServers&nbsp;src&nbsp;10.112.4.54&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;purge&nbsp;clientServers&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;purge&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;gat&nbsp;method&nbsp;GET&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;clientS&nbsp;src&nbsp;10.112.4.54&nbsp;10.113.10.190&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gat&nbsp;clientS&lt;/div&gt;&lt;div&gt;&gt;&nbsp;#http_access&nbsp;deny&nbsp;gat&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&gt;The&nbsp;localnet&nbsp;ACL&nbsp;defines&nbsp;10.*/8&nbsp;as&nbsp;allowed&nbsp;and&nbsp;your&nbsp;rules&nbsp;below&nbsp;specify&lt;/div&gt;&lt;div&gt;&gt;&gt;that&nbsp;all&nbsp;localnet&nbsp;traffic&nbsp;is&nbsp;allowed.&lt;/div&gt;&lt;div&gt;&gt;&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&gt;So&nbsp;the&nbsp;above&nbsp;four&nbsp;lines&nbsp;of&nbsp;config&nbsp;seem&nbsp;pointless.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;You&nbsp;have&nbsp;configured&nbsp;the&nbsp;machines&nbsp;10.112.4.54&nbsp;and&nbsp;10.113.10.190&nbsp;as&nbsp;your&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;cache_peer&nbsp;servers.&nbsp;So&nbsp;why&nbsp;are&nbsp;they&nbsp;listed&nbsp;as&nbsp;&quot;src&quot;&nbsp;?&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;In&nbsp;a&nbsp;reverse-proxy&nbsp;&quot;src&quot;&nbsp;is&nbsp;the&nbsp;IP&nbsp;of&nbsp;a&nbsp;client&nbsp;requesting&nbsp;a&nbsp;URL.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;&quot;dst&quot;&nbsp;is&nbsp;the&nbsp;destination&nbsp;server&nbsp;-&nbsp;as&nbsp;determined&nbsp;by&nbsp;DNS&nbsp;records&nbsp;for&nbsp;the&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;URL&nbsp;domain&nbsp;being&nbsp;fetched.&nbsp;In&nbsp;a&nbsp;reverse-proxy&nbsp;those&nbsp;DNS&nbsp;records&nbsp;should&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;hold&nbsp;the&nbsp;proxies&nbsp;own&nbsp;IP&nbsp;address.&nbsp;So&nbsp;dst-IP&nbsp;is&nbsp;rarely&nbsp;ever&nbsp;useful&nbsp;and&nbsp;are&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;&gt;&gt;&lt;/span&gt;downright&nbsp;dangerous&nbsp;to&nbsp;make&nbsp;use&nbsp;of&nbsp;in&nbsp;the&nbsp;reverse-proxy.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;ICP&nbsp;requset&nbsp;cannot&nbsp;sent&nbsp;to&nbsp;peer&nbsp;server&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;at&nbsp;first.&nbsp;So&nbsp;I&nbsp;add&nbsp;it&nbsp;to&nbsp;try&nbsp;to&nbsp;solve&nbsp;it&nbsp;.&nbsp;&lt;/span&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;3130&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;icp&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;3128&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;the&nbsp;default&nbsp;config&nbsp;file&nbsp;says:&lt;/div&gt;&lt;div&gt;&quot;&lt;/div&gt;&lt;div&gt;#&lt;/div&gt;&lt;div&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;/div&gt;&lt;div&gt;#&lt;/div&gt;&lt;div&gt;&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks&nbsp;a&nbsp;lot,&nbsp;I'll&nbsp;delete&nbsp;the&nbsp;needless&nbsp;port&nbsp;info.&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localnet&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_port&nbsp;80&nbsp;accel&nbsp;defaultsite=youlun.lvmama.com&nbsp;no-vhost&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_dir&nbsp;aufs&nbsp;/var/spool/squid&nbsp;8198&nbsp;16&nbsp;256&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_mem&nbsp;5120&nbsp;MB&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_swap_low&nbsp;90&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_swap_high&nbsp;95&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_mgr&nbsp;zhongzhe@lvmama.com&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;visible_hostname&nbsp;cache190&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;the&nbsp;domain&nbsp;name&nbsp;Squid&nbsp;announces&nbsp;to&nbsp;your&nbsp;clients&nbsp;is&nbsp;&quot;cache190&quot;&nbsp;as&nbsp;in&lt;/div&gt;&lt;div&gt;http://cache190/ship_front/youlun/1012487.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;my&nbsp;domain&nbsp;name&nbsp;is&nbsp;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;youlun.lvmama.com.&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;line-height:&nbsp;1.5;&nbsp;background-color:&nbsp;window;&quot;&gt;cache190&nbsp;is&nbsp;just&nbsp;a&nbsp;individual&nbsp;name&nbsp;to&nbsp;distinguish&nbsp;with&nbsp;squid&nbsp;server&nbsp;10.113.10.191.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;coredump_dir&nbsp;&nbsp;/var/spool/squid&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;via&nbsp;off&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;At&nbsp;least&nbsp;while&nbsp;debugging&nbsp;peering&nbsp;issues&nbsp;set&nbsp;&quot;via&nbsp;on&quot;.&nbsp;Only&nbsp;turn&nbsp;it&nbsp;off&lt;/div&gt;&lt;div&gt;if&nbsp;you&nbsp;really&nbsp;have&nbsp;to&nbsp;and&nbsp;*after*&nbsp;you&nbsp;have&nbsp;a&nbsp;fully&nbsp;working&nbsp;proxy&nbsp;hierarchy.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;agree&nbsp;with&nbsp;your.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;maximum_object_size&nbsp;500&nbsp;KB&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;icp_port&nbsp;3130&lt;/div&gt;&lt;div&gt;&gt;&nbsp;icp_access&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&gt;&gt;&nbsp;icp_query_timeout&nbsp;2000&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_peer&nbsp;10.112.4.54&nbsp;parent&nbsp;8090&nbsp;0&nbsp;no-query&nbsp;originserver&nbsp;name=youlun&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;mysites&nbsp;dstdomain&nbsp;youlun.lvmama.com&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;mysites&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_peer_access&nbsp;youlun&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_peer_access&nbsp;youlun&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;The&nbsp;default&nbsp;for&nbsp;cache_peer_access&nbsp;is&nbsp;to&nbsp;allow.&nbsp;No&nbsp;need&nbsp;to&nbsp;specify&nbsp;that&lt;/div&gt;&lt;div&gt;&quot;allow&nbsp;all&quot;.&nbsp;What&nbsp;you&nbsp;need&nbsp;to&nbsp;do&nbsp;to&nbsp;allow&nbsp;everything&nbsp;to&nbsp;reach&nbsp;that&nbsp;peer&lt;/div&gt;&lt;div&gt;server&nbsp;is&nbsp;*not*&nbsp;specify&nbsp;&quot;deny&nbsp;all&quot;.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Though&nbsp;the&nbsp;normal&nbsp;thing&nbsp;is&nbsp;to&nbsp;use&nbsp;an&nbsp;ACL&nbsp;(eg&nbsp;your&nbsp;&quot;mysites&quot;&nbsp;one)&nbsp;to&lt;/div&gt;&lt;div&gt;allow&nbsp;the&nbsp;domains&nbsp;an&nbsp;origin&nbsp;server&nbsp;is&nbsp;known&nbsp;to&nbsp;supply&nbsp;and&nbsp;to&nbsp;deny&nbsp;other&lt;/div&gt;&lt;div&gt;things.&nbsp;Since&nbsp;it&nbsp;is&nbsp;not&nbsp;even&nbsp;worth&nbsp;trying&nbsp;that&nbsp;peer&nbsp;for&nbsp;things&nbsp;it&nbsp;is&nbsp;not&lt;/div&gt;&lt;div&gt;known&nbsp;to&nbsp;be&nbsp;capable&nbsp;of&nbsp;serving.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;So:&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;mysites&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;cache_peer_access&nbsp;youlun&nbsp;allow&nbsp;mysites&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;cache_peer_access&nbsp;youlun&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Also&nbsp;be&nbsp;aware&nbsp;that&nbsp;all&nbsp;of&nbsp;this&nbsp;peer&nbsp;and&nbsp;http_access&nbsp;config&nbsp;needs&nbsp;to&nbsp;be&lt;/div&gt;&lt;div&gt;located&nbsp;up&nbsp;where&nbsp;it&nbsp;says&nbsp;&quot;&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;&quot;&nbsp;etc.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;,&nbsp;I&nbsp;had&nbsp;delete&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;.*/youlun/([0-9]+)&nbsp;1440&nbsp;100%&nbsp;10080&nbsp;ignore-no-store&nbsp;ignore-must-revalidate&nbsp;store-stale&nbsp;ignore-reload&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Why?&nbsp;if&nbsp;your&nbsp;server&nbsp;is&nbsp;not&nbsp;producing&nbsp;correct&nbsp;cacheability&nbsp;headers&nbsp;then&lt;/div&gt;&lt;div&gt;everyone&nbsp;trying&nbsp;to&nbsp;use&nbsp;your&nbsp;site&nbsp;will&nbsp;be&nbsp;having&nbsp;problems.&nbsp;&quot;Fixing&quot;&nbsp;it&lt;/div&gt;&lt;div&gt;for&nbsp;only&nbsp;your&nbsp;proxy&nbsp;by&nbsp;ignoring&nbsp;required&nbsp;things&nbsp;is&nbsp;the&nbsp;worst&nbsp;possible&lt;/div&gt;&lt;div&gt;action&nbsp;to&nbsp;take.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Your&nbsp;proxy&nbsp;is&nbsp;a&nbsp;reverse-proxy&nbsp;(aka&nbsp;CDN),&nbsp;it&nbsp;advertises&nbsp;its&nbsp;Surrogate&lt;/div&gt;&lt;div&gt;abilities&nbsp;to&nbsp;the&nbsp;origin&nbsp;server&nbsp;so&nbsp;your&nbsp;proxy&nbsp;cache&nbsp;can&nbsp;be&nbsp;given&nbsp;custom&lt;/div&gt;&lt;div&gt;values&nbsp;different&nbsp;from&nbsp;the&nbsp;general&nbsp;public.&nbsp;If&nbsp;you&nbsp;need&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;want&nbsp;to&nbsp;squid&nbsp;server&nbsp;response&nbsp;a&nbsp;cache&nbsp;page&nbsp;to&nbsp;the&nbsp;request&nbsp;if&nbsp;it's&nbsp;exit&nbsp;.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;/div&gt;&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;/div&gt;&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;/div&gt;&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_log&nbsp;/var/log/squid/cache.log&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_access_log&nbsp;/var/log/squid/access.log&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;The&nbsp;directive&nbsp;name&nbsp;is&nbsp;&quot;access_log&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Changed.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;cache_store_log&nbsp;/var/log/squid/store.log&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;log_icp_queries&nbsp;off&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;all&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Do&nbsp;not&nbsp;do&nbsp;that&nbsp;&quot;allow&nbsp;all&quot;.&lt;/div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&gt;Been&nbsp;deleted.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;hr&nbsp;style=&quot;WIDTH:&nbsp;210px;&nbsp;HEIGHT:&nbsp;1px&quot;&nbsp;color=&quot;#b5c4df&quot;&nbsp;size=&quot;1&quot;&nbsp;align=&quot;left&quot;&gt;<br>
&lt;div&gt;&lt;span&gt;&lt;div&nbsp;style=&quot;MARGIN:&nbsp;10px;&nbsp;FONT-FAMILY:&nbsp;verdana;&nbsp;FONT-SIZE:&nbsp;10pt&quot;&gt;&lt;div&gt;zhongzhe@lvmama.com&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;blockquote&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0.5em;&quot;&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;border:none;border-top:solid&nbsp;#B5C4DF&nbsp;1.0pt;padding:3.0pt&nbsp;0cm&nbsp;0cm&nbsp;0cm&quot;&gt;&lt;div&nbsp;style=&quot;PADDING-RIGHT:&nbsp;8px;&nbsp;PADDING-LEFT:&nbsp;8px;&nbsp;FONT-SIZE:&nbsp;12px;FONT-FAMILY:tahoma;COLOR:#000000;&nbsp;BACKGROUND:&nbsp;#efefef;&nbsp;PADDING-BOTTOM:&nbsp;8px;&nbsp;PADDING-TOP:&nbsp;8px&quot;&gt;&lt;div&gt;&lt;b&gt;From:&lt;/b&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;Amos&nbsp;Jeffries&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Date:&lt;/b&gt;&nbsp;2017-12-14&nbsp;02:04&lt;/div&gt;&lt;div&gt;&lt;b&gt;To:&lt;/b&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[squid-users]&nbsp;TCP_MISS_ABORTED&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;On&nbsp;13/12/17&nbsp;20:30,&nbsp;zhongzhe@lvmama.com&nbsp;wrote:&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;Hi,&nbsp;All&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;used&nbsp;httpclient&nbsp;to&nbsp;imitate&nbsp;a&nbsp;request&nbsp;to&nbsp;squid&nbsp;,&nbsp;but&nbsp;the&nbsp;response&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;page&nbsp;had&nbsp;not&nbsp;stored&nbsp;by&nbsp;squid&nbsp;although&nbsp;response&nbsp;header&nbsp;is&nbsp;200.&nbsp;I&nbsp;had&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;tried&nbsp;many&nbsp;times&nbsp;with&nbsp;three&nbsp;different&nbsp;pages&nbsp;.&nbsp;only&nbsp;one&nbsp;can&nbsp;be&nbsp;stored&nbsp;by&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;the&nbsp;squid&nbsp;cache.&nbsp;and&nbsp;the&nbsp;others&nbsp;must&nbsp;need&nbsp;to&nbsp;send&nbsp;requset&nbsp;by&nbsp;brower&nbsp;then&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;they&nbsp;were&nbsp;cached.&nbsp;&nbsp;I&nbsp;had&nbsp;checked&nbsp;the&nbsp;access.log&nbsp;,&nbsp;it&nbsp;show&nbsp;me&nbsp;like&nbsp;this.&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;1513148548.653&nbsp;&nbsp;&nbsp;9172&nbsp;10.112.4.54&nbsp;TCP_MISS_ABORTED/200&nbsp;106197&nbsp;GET&nbsp;http://youlun.lvmama.com/ship_front/youlun/1012487&nbsp;-&nbsp;FIRSTUP_PARENT/10.112.4.54&nbsp;text/html&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;do&nbsp;you&nbsp;know&nbsp;what's&nbsp;wrong&nbsp;of&nbsp;my&nbsp;squid.conf&nbsp;?&nbsp;need&nbsp;your&nbsp;help&nbsp;!\&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;There&nbsp;seem&nbsp;to&nbsp;be&nbsp;many&nbsp;things.&nbsp;But&nbsp;none&nbsp;of&nbsp;them&nbsp;have&nbsp;much&nbsp;to&nbsp;do&nbsp;with&nbsp;te&nbsp;&lt;/div&gt;<br>
&lt;div&gt;above.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;What&nbsp;the&nbsp;above&nbsp;says&nbsp;is&nbsp;that&nbsp;a&nbsp;client&nbsp;at&nbsp;10.112.4.54&nbsp;requested&nbsp;&lt;/div&gt;<br>
&lt;div&gt;http://youlun.lvmama.com/ship_front/youlun/1012487&nbsp;and&nbsp;disconnected&nbsp;&lt;/div&gt;<br>
&lt;div&gt;after&nbsp;9&nbsp;seconds.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;fact&nbsp;that&nbsp;~100KB&nbsp;of&nbsp;traffic&nbsp;happened&nbsp;in&nbsp;that&nbsp;transaction&nbsp;implies&nbsp;&lt;/div&gt;<br>
&lt;div&gt;that&nbsp;everything&nbsp;was&nbsp;going&nbsp;okay&nbsp;for&nbsp;a&nbsp;while&nbsp;at&nbsp;least.&nbsp;So&nbsp;there&nbsp;is&nbsp;no&nbsp;&lt;/div&gt;<br>
&lt;div&gt;visible&nbsp;problem&nbsp;with&nbsp;Squid&nbsp;in&nbsp;that&nbsp;log&nbsp;entry.&nbsp;The&nbsp;ABORTED&nbsp;simply&nbsp;means&nbsp;&lt;/div&gt;<br>
&lt;div&gt;one&nbsp;of&nbsp;the&nbsp;endpoints&nbsp;(probably&nbsp;the&nbsp;client)&nbsp;decided&nbsp;to&nbsp;disconnect&nbsp;early.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Back&nbsp;to&nbsp;your&nbsp;squid.conf;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;below&nbsp;is&nbsp;my&nbsp;squid.conf&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;gsrc&nbsp;src&nbsp;10.112.4.54&nbsp;10.113.10.191&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;gdst&nbsp;dst&nbsp;10.112.4.54&nbsp;10.113.10.191&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gsrc&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gdst&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;What&nbsp;is&nbsp;the&nbsp;above&nbsp;supposed&nbsp;to&nbsp;mean?&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;10.0.0.0/8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;172.16.0.0/12&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;192.168.0.0/16&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;purge&nbsp;method&nbsp;PURGE&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;clientServers&nbsp;src&nbsp;10.112.4.54&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;purge&nbsp;clientServers&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;purge&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;gat&nbsp;method&nbsp;GET&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;clientS&nbsp;src&nbsp;10.112.4.54&nbsp;10.113.10.190&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;gat&nbsp;clientS&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;#http_access&nbsp;deny&nbsp;gat&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;localnet&nbsp;ACL&nbsp;defines&nbsp;10.*/8&nbsp;as&nbsp;allowed&nbsp;and&nbsp;your&nbsp;rules&nbsp;below&nbsp;specify&nbsp;&lt;/div&gt;<br>
&lt;div&gt;that&nbsp;all&nbsp;localnet&nbsp;traffic&nbsp;is&nbsp;allowed.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;So&nbsp;the&nbsp;above&nbsp;four&nbsp;lines&nbsp;of&nbsp;config&nbsp;seem&nbsp;pointless.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;You&nbsp;have&nbsp;configured&nbsp;the&nbsp;machines&nbsp;10.112.4.54&nbsp;and&nbsp;10.113.10.190&nbsp;as&nbsp;your&nbsp;&lt;/div&gt;<br>
&lt;div&gt;cache_peer&nbsp;servers.&nbsp;So&nbsp;why&nbsp;are&nbsp;they&nbsp;listed&nbsp;as&nbsp;&quot;src&quot;&nbsp;?&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;In&nbsp;a&nbsp;reverse-proxy&nbsp;&quot;src&quot;&nbsp;is&nbsp;the&nbsp;IP&nbsp;of&nbsp;a&nbsp;client&nbsp;requesting&nbsp;a&nbsp;URL.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&quot;dst&quot;&nbsp;is&nbsp;the&nbsp;destination&nbsp;server&nbsp;-&nbsp;as&nbsp;determined&nbsp;by&nbsp;DNS&nbsp;records&nbsp;for&nbsp;the&nbsp;&lt;/div&gt;<br>
&lt;div&gt;URL&nbsp;domain&nbsp;being&nbsp;fetched.&nbsp;In&nbsp;a&nbsp;reverse-proxy&nbsp;those&nbsp;DNS&nbsp;records&nbsp;should&nbsp;&lt;/div&gt;<br>
&lt;div&gt;hold&nbsp;the&nbsp;proxies&nbsp;own&nbsp;IP&nbsp;address.&nbsp;So&nbsp;dst-IP&nbsp;is&nbsp;rarely&nbsp;ever&nbsp;useful&nbsp;and&nbsp;are&nbsp;&lt;/div&gt;<br>
&lt;div&gt;downright&nbsp;dangerous&nbsp;to&nbsp;make&nbsp;use&nbsp;of&nbsp;in&nbsp;the&nbsp;reverse-proxy.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;3130&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;icp&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;3128&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;As&nbsp;the&nbsp;default&nbsp;config&nbsp;file&nbsp;says:&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&quot;&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localnet&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_port&nbsp;80&nbsp;accel&nbsp;defaultsite=youlun.lvmama.com&nbsp;no-vhost&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_dir&nbsp;aufs&nbsp;/var/spool/squid&nbsp;8198&nbsp;16&nbsp;256&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_mem&nbsp;5120&nbsp;MB&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_swap_low&nbsp;90&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_swap_high&nbsp;95&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_mgr&nbsp;zhongzhe@lvmama.com&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;visible_hostname&nbsp;cache190&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;So&nbsp;the&nbsp;domain&nbsp;name&nbsp;Squid&nbsp;announces&nbsp;to&nbsp;your&nbsp;clients&nbsp;is&nbsp;&quot;cache190&quot;&nbsp;as&nbsp;in&nbsp;&lt;/div&gt;<br>
&lt;div&gt;http://cache190/ship_front/youlun/1012487.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;coredump_dir&nbsp;&nbsp;/var/spool/squid&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;via&nbsp;off&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;At&nbsp;least&nbsp;while&nbsp;debugging&nbsp;peering&nbsp;issues&nbsp;set&nbsp;&quot;via&nbsp;on&quot;.&nbsp;Only&nbsp;turn&nbsp;it&nbsp;off&nbsp;&lt;/div&gt;<br>
&lt;div&gt;if&nbsp;you&nbsp;really&nbsp;have&nbsp;to&nbsp;and&nbsp;*after*&nbsp;you&nbsp;have&nbsp;a&nbsp;fully&nbsp;working&nbsp;proxy&nbsp;hierarchy.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;maximum_object_size&nbsp;500&nbsp;KB&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;icp_port&nbsp;3130&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;icp_access&nbsp;allow&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;icp_query_timeout&nbsp;2000&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_peer&nbsp;10.112.4.54&nbsp;parent&nbsp;8090&nbsp;0&nbsp;no-query&nbsp;originserver&nbsp;name=youlun&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;acl&nbsp;mysites&nbsp;dstdomain&nbsp;youlun.lvmama.com&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;mysites&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_peer_access&nbsp;youlun&nbsp;allow&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_peer_access&nbsp;youlun&nbsp;deny&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;default&nbsp;for&nbsp;cache_peer_access&nbsp;is&nbsp;to&nbsp;allow.&nbsp;No&nbsp;need&nbsp;to&nbsp;specify&nbsp;that&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&quot;allow&nbsp;all&quot;.&nbsp;What&nbsp;you&nbsp;need&nbsp;to&nbsp;do&nbsp;to&nbsp;allow&nbsp;everything&nbsp;to&nbsp;reach&nbsp;that&nbsp;peer&nbsp;&lt;/div&gt;<br>
&lt;div&gt;server&nbsp;is&nbsp;*not*&nbsp;specify&nbsp;&quot;deny&nbsp;all&quot;.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Though&nbsp;the&nbsp;normal&nbsp;thing&nbsp;is&nbsp;to&nbsp;use&nbsp;an&nbsp;ACL&nbsp;(eg&nbsp;your&nbsp;&quot;mysites&quot;&nbsp;one)&nbsp;to&nbsp;&lt;/div&gt;<br>
&lt;div&gt;allow&nbsp;the&nbsp;domains&nbsp;an&nbsp;origin&nbsp;server&nbsp;is&nbsp;known&nbsp;to&nbsp;supply&nbsp;and&nbsp;to&nbsp;deny&nbsp;other&nbsp;&lt;/div&gt;<br>
&lt;div&gt;things.&nbsp;Since&nbsp;it&nbsp;is&nbsp;not&nbsp;even&nbsp;worth&nbsp;trying&nbsp;that&nbsp;peer&nbsp;for&nbsp;things&nbsp;it&nbsp;is&nbsp;not&nbsp;&lt;/div&gt;<br>
&lt;div&gt;known&nbsp;to&nbsp;be&nbsp;capable&nbsp;of&nbsp;serving.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;So:&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;mysites&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;cache_peer_access&nbsp;youlun&nbsp;allow&nbsp;mysites&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;cache_peer_access&nbsp;youlun&nbsp;deny&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Also&nbsp;be&nbsp;aware&nbsp;that&nbsp;all&nbsp;of&nbsp;this&nbsp;peer&nbsp;and&nbsp;http_access&nbsp;config&nbsp;needs&nbsp;to&nbsp;be&nbsp;&lt;/div&gt;<br>
&lt;div&gt;located&nbsp;up&nbsp;where&nbsp;it&nbsp;says&nbsp;&quot;&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;&quot;&nbsp;etc.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;.*/youlun/([0-9]+)&nbsp;1440&nbsp;100%&nbsp;10080&nbsp;ignore-no-store&nbsp;ignore-must-revalidate&nbsp;store-stale&nbsp;ignore-reload&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Why?&nbsp;if&nbsp;your&nbsp;server&nbsp;is&nbsp;not&nbsp;producing&nbsp;correct&nbsp;cacheability&nbsp;headers&nbsp;then&nbsp;&lt;/div&gt;<br>
&lt;div&gt;everyone&nbsp;trying&nbsp;to&nbsp;use&nbsp;your&nbsp;site&nbsp;will&nbsp;be&nbsp;having&nbsp;problems.&nbsp;&quot;Fixing&quot;&nbsp;it&nbsp;&lt;/div&gt;<br>
&lt;div&gt;for&nbsp;only&nbsp;your&nbsp;proxy&nbsp;by&nbsp;ignoring&nbsp;required&nbsp;things&nbsp;is&nbsp;the&nbsp;worst&nbsp;possible&nbsp;&lt;/div&gt;<br>
&lt;div&gt;action&nbsp;to&nbsp;take.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Your&nbsp;proxy&nbsp;is&nbsp;a&nbsp;reverse-proxy&nbsp;(aka&nbsp;CDN),&nbsp;it&nbsp;advertises&nbsp;its&nbsp;Surrogate&nbsp;&lt;/div&gt;<br>
&lt;div&gt;abilities&nbsp;to&nbsp;the&nbsp;origin&nbsp;server&nbsp;so&nbsp;your&nbsp;proxy&nbsp;cache&nbsp;can&nbsp;be&nbsp;given&nbsp;custom&nbsp;&lt;/div&gt;<br>
&lt;div&gt;values&nbsp;different&nbsp;from&nbsp;the&nbsp;general&nbsp;public.&nbsp;If&nbsp;you&nbsp;need&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_log&nbsp;/var/log/squid/cache.log&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_access_log&nbsp;/var/log/squid/access.log&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;directive&nbsp;name&nbsp;is&nbsp;&quot;access_log&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;cache_store_log&nbsp;/var/log/squid/store.log&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;log_icp_queries&nbsp;off&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Do&nbsp;not&nbsp;do&nbsp;that&nbsp;&quot;allow&nbsp;all&quot;.&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;all&lt;/div&gt;<br>
&lt;div&gt;&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Amos&lt;/div&gt;<br>
&lt;div&gt;_______________________________________________&lt;/div&gt;<br>
&lt;div&gt;squid-users&nbsp;mailing&nbsp;list&lt;/div&gt;<br>
&lt;div&gt;squid-users@lists.squid-cache.org&lt;/div&gt;<br>
&lt;div&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/div&gt;<br>
&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;/body&gt;&lt;/html&gt;
</tt>
