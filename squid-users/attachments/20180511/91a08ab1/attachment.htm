<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;10pt;&nbsp;FONT-FAMILY:&nbsp;'Arial';&nbsp;COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&gt;Can&nbsp;you&nbsp;capture&nbsp;the&nbsp;traffic&nbsp;on&nbsp;port&nbsp;88&nbsp;?&nbsp;Heimdal&nbsp;has&nbsp;not&nbsp;helpful&nbsp;messages,&nbsp;<br>
so&nbsp;seeing&nbsp;the&nbsp;real&nbsp;traffic&nbsp;may&nbsp;help&nbsp;identifying&nbsp;the&nbsp;issue.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Kinit&nbsp;should&nbsp;create&nbsp;an&nbsp;AS&nbsp;req/rep&lt;/DIV&gt;<br>
&lt;DIV&gt;the&nbsp;test&nbsp;program&nbsp;creates&nbsp;a&nbsp;TGS&nbsp;req/rep&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Example&nbsp;attached&nbsp;if&nbsp;it&nbsp;gets&nbsp;through.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Markus&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&gt;&quot;Panagiotis&nbsp;Bariamis&quot;&nbsp;&lt;akismpa@gmail.com&gt;&nbsp;wrote&nbsp;in&nbsp;message&nbsp;<br>
news:CAPxN_PVp9RETXBPZG6ZX5rzNK6Hu-HLxdAagSfgXVcg=DcdGsw@mail.gmail.com...&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP-COLOR:&nbsp;#000000;&nbsp;BORDER-BOTTOM-COLOR:&nbsp;#000000;&nbsp;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#000000&nbsp;4px&nbsp;solid;&nbsp;BORDER-RIGHT-COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;Hello&nbsp;my&nbsp;setup&nbsp;is&nbsp;as&nbsp;follows&nbsp;:&lt;BR&gt;&lt;/DIV&gt;Freebsd&nbsp;11&nbsp;Heimdal&nbsp;Kerberos&nbsp;Server&nbsp;<br>
and&nbsp;DNS&nbsp;properly&nbsp;configured&nbsp;(testlab&nbsp;enviroment&nbsp;for&nbsp;&lt;A&nbsp;<br>
href=&quot;http://example.com&quot;&gt;example.com&lt;/A&gt;&nbsp;domain)&nbsp;&lt;BR&gt;&lt;/DIV&gt;Freebsd&nbsp;11&nbsp;squid&nbsp;<br>
proxy&nbsp;server&nbsp;&lt;BR&gt;&lt;/DIV&gt;Windows&nbsp;Client&nbsp;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;I&nbsp;have&nbsp;created&nbsp;a&nbsp;keytab&nbsp;<br>
from&nbsp;the&nbsp;Kerberos&nbsp;Server&nbsp;for&nbsp;http/&lt;A&nbsp;<br>
href=&quot;http://squid.example.com&quot;&gt;squid.example.com&lt;/A&gt;&lt;BR&gt;&lt;/DIV&gt;Proxy&nbsp;server&nbsp;<br>
machine&nbsp;has&nbsp;no&nbsp;problem&nbsp;kinit&nbsp;ing&nbsp;with&nbsp;the&nbsp;keytab&nbsp;file&nbsp;and&nbsp;gets&nbsp;a&nbsp;ticket&nbsp;<br>
&lt;BR&gt;&lt;BR&gt;#&nbsp;klist&lt;BR&gt;Credentials&nbsp;cache:&nbsp;<br>
FILE:/tmp/krb5cc_0&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Principal:&nbsp;<br>
http/&lt;A&gt;squid.example.com@EXAMPLE.COM&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;<br>
Issued&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Expires&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Principal&lt;BR&gt;May&nbsp;&nbsp;9&nbsp;15:38:36&nbsp;2018&nbsp;&nbsp;May&nbsp;10&nbsp;01:38:37&nbsp;2018&nbsp;&nbsp;<br>
krbtgt/&lt;A&gt;EXAMPLE.COM@EXAMPLE.COM&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;My&nbsp;squid.conf&nbsp;is&nbsp;as&nbsp;follows&nbsp;<br>
concerning&nbsp;the&nbsp;authentication&nbsp;:&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;<br>
/usr/local/libexec/squid/negotiate_kerberos_auth&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;<br>
children&nbsp;10&nbsp;startup=1&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;keep_alive&nbsp;on&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;Trying&nbsp;<br>
to&nbsp;use&nbsp;:&lt;BR&gt;#&nbsp;/usr/local/libexec/squid/negotiate_kerberos_auth_test&nbsp;&lt;A&nbsp;<br>
href=&quot;http://squid.example.com&quot;&gt;squid.example.com&lt;/A&gt;&nbsp;&lt;BR&gt;|&nbsp;awk&nbsp;<br>
'{sub(/Token:/,&quot;YR&quot;);&nbsp;print&nbsp;$0}END{print&nbsp;&quot;QQ&quot;}'&nbsp;&lt;BR&gt;|&nbsp;<br>
/usr/local/libexec/squid/negotiate_kerberos_auth&nbsp;-r&nbsp;-s&nbsp;http/&lt;A&nbsp;<br>
href=&quot;http://squid.example.com&quot;&gt;squid.example.com&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;fails&nbsp;with&nbsp;<br>
:&lt;BR&gt;|&nbsp;negotiate_kerberos_auth_test:&nbsp;gss_init_sec_context()&nbsp;failed:&nbsp;&nbsp;An&nbsp;<br>
unsupported&nbsp;mechanism&nbsp;was&nbsp;requested.&nbsp;unknown&nbsp;mech-code&nbsp;0&nbsp;for&nbsp;mech&nbsp;unknown&lt;BR&gt;BH&nbsp;<br>
gss_accept_sec_context()&nbsp;failed:&nbsp;&nbsp;A&nbsp;token&nbsp;was&nbsp;invalid.&nbsp;unknown&nbsp;mech-code&nbsp;0&nbsp;<br>
for&nbsp;mech&nbsp;unknown&lt;BR&gt;BH&nbsp;quit&nbsp;command&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;Any&nbsp;ideas&nbsp;<br>
?&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;Thank&nbsp;you&nbsp;,&nbsp;&lt;BR&gt;&lt;/DIV&gt;Bariamis&nbsp;Panagiotis&nbsp;&lt;BR&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;P&gt;<br>
&lt;HR&gt;<br>
_______________________________________________&lt;BR&gt;squid-users&nbsp;mailing&nbsp;<br>
list&lt;BR&gt;squid-users@lists.squid-cache.org&lt;BR&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
