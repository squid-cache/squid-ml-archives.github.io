<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;Hi&nbsp;Amos, &lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;Here&nbsp;is&nbsp;the&nbsp;topology:&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;client&nbsp;(curl&nbsp;from&nbsp;host&nbsp;running&nbsp;docker)&nbsp;--&gt;&nbsp;squid_child&nbsp;(docker,&nbsp;using&nbsp;ssl-bump&nbsp;with&nbsp;intercept)&nbsp;--&gt;&nbsp;squid_parent&nbsp;(VM&nbsp;with&nbsp;internet&nbsp;connection,&nbsp;https_port&nbsp;without&nbsp;ssl-bump)&nbsp;--&gt;&nbsp;origin&nbsp;server.&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;local&nbsp;- &lt;a&nbsp;href=&quot;http://72.19.0.2:443/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204);font-family:sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;72.19.0.2:443&lt;/a&gt; is&nbsp;the&nbsp;container&nbsp;running&nbsp;squid&nbsp;child&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small&quot;&gt;&lt;font&nbsp;color=&quot;#073763&quot;&gt;remote&nbsp;- &lt;/font&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80);font-family:sans-serif;font-size:13px;background-color:rgb(255,255,255);text-decoration-style:initial;text-decoration-color:initial;float:none;display:inline&quot;&gt;remote=&lt;/span&gt;&lt;a&nbsp;href=&quot;http://172.19.0.1:44522/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204);font-family:sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;172.19.0.1:44522&lt;/a&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif;font-size:13px;background-color:rgb(255,255,255);text-decoration-style:initial;text-decoration-color:initial;float:none;display:inline&quot;&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt; &nbsp;&lt;/font&gt;&lt;font&nbsp;color=&quot;#073763&quot;&gt;is&nbsp;the&nbsp;host&nbsp;machine&nbsp;where&nbsp;containers&nbsp;are&nbsp;running,&nbsp;I&nbsp;am&nbsp;using&nbsp;a&nbsp;curl&nbsp;to&nbsp;do&nbsp;initial&nbsp;tests.&nbsp;Eventually,&nbsp;request&nbsp;would&nbsp;come&nbsp;from&nbsp;other&nbsp;containers&nbsp;or&nbsp;external&nbsp;hosts&nbsp;on&nbsp;the&nbsp;docker&nbsp;daemon&nbsp;host.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;With&nbsp;http&nbsp;traffic&nbsp;this&nbsp;works&nbsp;fine;&nbsp;wherein&nbsp;the&nbsp;request&nbsp;is&nbsp;forwarded&nbsp;to&nbsp;Parent&nbsp;and&nbsp;then&nbsp;to&nbsp;origin&nbsp;server.&nbsp;However,&nbsp;with&nbsp;https&nbsp;header&nbsp;forgery&nbsp;kicks&nbsp;in&nbsp;and&nbsp;tls&nbsp;is&nbsp;terminated.&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:verdana,sans-serif;font-size:small;color:#073763&quot;&gt;-&nbsp;Kedar&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Mon,&nbsp;Jun&nbsp;18,&nbsp;2018&nbsp;at&nbsp;9:44&nbsp;AM&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;18/06/18&nbsp;02:08,&nbsp;Kedar&nbsp;K&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;hitting&nbsp;this&nbsp;issue&nbsp;when&nbsp;running&nbsp;squid&nbsp;in&nbsp;a&nbsp;docker&nbsp;with&nbsp;ssl&nbsp;parent&lt;br&gt;<br>
&gt;&nbsp;cache_peer.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;you&nbsp;describe&nbsp;that&nbsp;a&nbsp;bit&nbsp;clearer&nbsp;please?&nbsp;An&nbsp;end-client,&nbsp;two&nbsp;proxies&lt;br&gt;<br>
and&nbsp;origin&nbsp;server&nbsp;makes&nbsp;four&nbsp;HTTP&nbsp;agents&nbsp;involved&nbsp;with&nbsp;this&nbsp;traffic.&lt;br&gt;<br>
&lt;br&gt;<br>
 Which&nbsp;of&nbsp;those&nbsp;proxies&nbsp;(and/or&nbsp;server)&nbsp;is&nbsp;inside&nbsp;the&nbsp;container?&lt;br&gt;<br>
&lt;br&gt;<br>
 And&nbsp;how&nbsp;are&nbsp;you&nbsp;getting&nbsp;the&nbsp;traffic&nbsp;from&nbsp;the&nbsp;client&nbsp;to&nbsp;the&nbsp;first&nbsp;proxy?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Host&nbsp;header&nbsp;forgery&nbsp;detected&nbsp;on&nbsp;local=11&nbsp;&lt;a&nbsp;href=&quot;http://72.19.0.2:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;72.19.0.2:443&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://172.19.0.1:44522&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;172.19.0.1:44522&lt;/a&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;FD&nbsp;15&nbsp;flags=33&nbsp;(local&nbsp;IP&nbsp;does&nbsp;not&nbsp;match&nbsp;any&nbsp;domain&nbsp;IP)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;​The&nbsp;host&nbsp;ip&nbsp;of&nbsp;the&nbsp;docker&nbsp;would&nbsp;not&nbsp;resolve&nbsp;to&nbsp;a&nbsp;domain.&nbsp;How&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;work-around&nbsp;this&nbsp;problem?​&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;agent&nbsp;being&nbsp;client&nbsp;for&nbsp;the&nbsp;proxy&nbsp;reporting&nbsp;this&nbsp;message&nbsp;apparently&lt;br&gt;<br>
thinks&nbsp;there&nbsp;is&nbsp;a&nbsp;origin&nbsp;server&nbsp;running&nbsp;at&nbsp;&quot;&lt;a&nbsp;href=&quot;http://72.19.0.2:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;72.19.0.2:443&lt;/a&gt;&quot;&nbsp;hosting&nbsp;some&lt;br&gt;<br>
domain&nbsp;name.&nbsp;They&nbsp;are&nbsp;trying&nbsp;to&nbsp;contact&nbsp;that&nbsp;origin&nbsp;server.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&nbsp;color=&quot;#0c343d&quot;&gt;&lt;b&gt;-&nbsp;Kedar&nbsp;Kekan&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
