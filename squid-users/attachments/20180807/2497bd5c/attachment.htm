<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&nbsp;http-equiv=Content-Type&gt;<br>
&lt;META&nbsp;name=GENERATOR&nbsp;content=&quot;MSHTML&nbsp;11.00.10570.1001&quot;&gt;&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;I&nbsp;do&nbsp;know&nbsp;there&nbsp;is/was&nbsp;a&nbsp;bug&nbsp;the&nbsp;systemd&nbsp;isnt&nbsp;picking&nbsp;<br>
up&nbsp;the&nbsp;filedescriptors&nbsp;with&nbsp;systemd,&nbsp;you&nbsp;might&nbsp;have&nbsp;hit&nbsp;it.&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;class=924102108-07082018&gt;Im&nbsp;<br>
suspecting&nbsp;your&nbsp;start&nbsp;script&nbsp;is&nbsp;a&nbsp;sysv&nbsp;script&nbsp;invoked&nbsp;by&nbsp;systemd.&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;Try&nbsp;to&nbsp;set&nbsp;the&nbsp;limits&nbsp;within&nbsp;the&nbsp;start&nbsp;script&nbsp;(sysv)&nbsp;so&nbsp;<br>
the&nbsp;correct&nbsp;users&nbsp;(&nbsp;running&nbsp;squid&nbsp;)&nbsp;gets&nbsp;the&nbsp;<br>
filedescriptors.&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;I&nbsp;run&nbsp;Debian&nbsp;9,&nbsp;with&nbsp;a&nbsp;recompiled&nbsp;squid&nbsp;from&nbsp;debian&nbsp;sid&nbsp;<br>
and&nbsp;that&nbsp;work&nbsp;fine&nbsp;for&nbsp;me&nbsp;atm.&nbsp;&lt;BR&gt;If&nbsp;you&nbsp;use&nbsp;the&nbsp;4.1&nbsp;from&nbsp;sid,&nbsp;add&nbsp;the&nbsp;<br>
following&nbsp;changes&nbsp;also.&nbsp;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;&lt;BR&gt;/etc/logrotate.d/squid&nbsp;<br>
&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
postrotate&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
if&nbsp;[&nbsp;-d&nbsp;/run/systemd/system&nbsp;]&nbsp;&amp;&amp;&nbsp;command&nbsp;systemctl&nbsp;&gt;/dev/null&nbsp;<br>
2&gt;&amp;1&nbsp;&amp;&amp;&nbsp;systemctl&nbsp;is-active&nbsp;--quiet&nbsp;squid.service;&nbsp;<br>
then&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
systemctl&nbsp;restart&nbsp;<br>
squid.service&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
elif&nbsp;[&nbsp;-f&nbsp;/var/run/squid.pid&nbsp;];&nbsp;<br>
then&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
test&nbsp;!&nbsp;-e&nbsp;/var/run/squid.pid&nbsp;||&nbsp;test&nbsp;!&nbsp;-x&nbsp;/usr/sbin/squid&nbsp;||&nbsp;/usr/sbin/squid&nbsp;-k&nbsp;<br>
rotate&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
fi&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endscript&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;BR&gt;Try&nbsp;the&nbsp;following&nbsp;and&nbsp;the&nbsp;below&nbsp;the&nbsp;command&nbsp;created&nbsp;<br>
the&nbsp;file&nbsp;/etc/systemd/system/squid.service.d/override.conf&nbsp;&lt;BR&gt;Add&nbsp;there&nbsp;the&nbsp;<br>
following.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;systemctl&nbsp;edit&nbsp;squid&lt;BR&gt;[Unit]&lt;BR&gt;After=network.target&nbsp;<br>
network-online.target&nbsp;nss-lookup.target&lt;BR&gt;Wants=network-online.target&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;<br>
align=left&gt;[Service]&lt;BR&gt;LimitNOFILE=8192:65535&lt;BR&gt;User=proxy&lt;BR&gt;Group=proxy&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;Greetz,&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;Louis&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=924102108-07082018&gt;&nbsp;&lt;/DIV&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;<br>
style=&quot;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#0000ff&nbsp;2px&nbsp;solid;&nbsp;MARGIN-RIGHT:&nbsp;0px&quot;&nbsp;<br>
dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;lang=nl&nbsp;class=OutlookMessageHeader&nbsp;dir=ltr&nbsp;align=left&gt;<br>
&nbsp;&nbsp;&lt;HR&nbsp;tabIndex=-1&gt;<br>
&nbsp;&nbsp;&lt;FONT&nbsp;size=2&nbsp;face=Tahoma&gt;&lt;B&gt;Van:&lt;/B&gt;&nbsp;squid-users&nbsp;<br>
&nbsp;&nbsp;[mailto:squid-users-bounces@lists.squid-cache.org]&nbsp;&lt;B&gt;Namens&nbsp;&lt;/B&gt;Alex&nbsp;<br>
&nbsp;&nbsp;K&lt;BR&gt;&lt;B&gt;Verzonden:&lt;/B&gt;&nbsp;dinsdag&nbsp;7&nbsp;augustus&nbsp;2018&nbsp;9:46&lt;BR&gt;&lt;B&gt;Aan:&lt;/B&gt;&nbsp;<br>
&nbsp;&nbsp;squid-users@lists.squid-cache.org&lt;BR&gt;&lt;B&gt;Onderwerp:&lt;/B&gt;&nbsp;[squid-users]&nbsp;Squid&nbsp;<br>
&nbsp;&nbsp;File&nbsp;descriptors&nbsp;warning&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Hi&nbsp;all,&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;I&nbsp;observed&nbsp;the&nbsp;following&nbsp;warning&nbsp;at&nbsp;squid&nbsp;cache&nbsp;logs:&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;SPAN&nbsp;style=&quot;FONT-FAMILY:&nbsp;monospace,monospace&quot;&gt;WARNING!&nbsp;Your&nbsp;cache&nbsp;is&nbsp;<br>
&nbsp;&nbsp;running&nbsp;out&nbsp;of&nbsp;filedescriptors&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Googling&nbsp;around&nbsp;I&nbsp;tried&nbsp;to&nbsp;increase&nbsp;the&nbsp;default&nbsp;file&nbsp;descriptors&nbsp;of&nbsp;the&nbsp;<br>
&nbsp;&nbsp;system&nbsp;(I&nbsp;am&nbsp;runnign&nbsp;Debian9&nbsp;x64&nbsp;bit),&nbsp;by&nbsp;setting&nbsp;at&nbsp;/etc/sysctl.conf:&nbsp;<br>
&nbsp;&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;SPAN&nbsp;<br>
&nbsp;&nbsp;style=&quot;FONT-FAMILY:&nbsp;monospace,monospace&quot;&gt;fs.file-max=802762&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Restarted&nbsp;system.&nbsp;Still&nbsp;was&nbsp;receiving&nbsp;the&nbsp;warnings.&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;When&nbsp;checking&nbsp;further&nbsp;I&nbsp;observed&nbsp;that&nbsp;I&nbsp;have&nbsp;the&nbsp;following&nbsp;default&nbsp;<br>
&nbsp;&nbsp;limits:&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;SPAN&nbsp;style=&quot;FONT-FAMILY:&nbsp;monospace,monospace&quot;&gt;ulimit&nbsp;-a&lt;BR&gt;core&nbsp;file&nbsp;<br>
&nbsp;&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(blocks,&nbsp;-c)&nbsp;<br>
&nbsp;&nbsp;0&lt;BR&gt;data&nbsp;seg&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(kbytes,&nbsp;-d)&nbsp;unlimited&lt;BR&gt;scheduling&nbsp;<br>
&nbsp;&nbsp;priority&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-e)&nbsp;0&lt;BR&gt;file&nbsp;<br>
&nbsp;&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(blocks,&nbsp;-f)&nbsp;unlimited&lt;BR&gt;pending&nbsp;<br>
&nbsp;&nbsp;signals&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-i)&nbsp;15338&lt;BR&gt;max&nbsp;locked&nbsp;memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(kbytes,&nbsp;<br>
&nbsp;&nbsp;-l)&nbsp;64&lt;BR&gt;max&nbsp;memory&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(kbytes,&nbsp;-m)&nbsp;unlimited&lt;BR&gt;&lt;B&gt;open&nbsp;<br>
&nbsp;&nbsp;files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-n)&nbsp;1024&lt;/B&gt;&lt;BR&gt;pipe&nbsp;<br>
&nbsp;&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(512&nbsp;<br>
&nbsp;&nbsp;bytes,&nbsp;-p)&nbsp;8&lt;BR&gt;POSIX&nbsp;message&nbsp;queues&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(bytes,&nbsp;-q)&nbsp;<br>
&nbsp;&nbsp;819200&lt;BR&gt;real-time&nbsp;<br>
&nbsp;&nbsp;priority&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-r)&nbsp;0&lt;BR&gt;stack&nbsp;<br>
&nbsp;&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(kbytes,&nbsp;-s)&nbsp;8192&lt;BR&gt;cpu&nbsp;<br>
&nbsp;&nbsp;time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(seconds,&nbsp;-t)&nbsp;unlimited&lt;BR&gt;max&nbsp;user&nbsp;<br>
&nbsp;&nbsp;processes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-u)&nbsp;15338&lt;BR&gt;virtual&nbsp;<br>
&nbsp;&nbsp;memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(kbytes,&nbsp;-v)&nbsp;<br>
&nbsp;&nbsp;unlimited&lt;BR&gt;file&nbsp;<br>
&nbsp;&nbsp;locks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;(-x)&nbsp;unlimited&lt;/SPAN&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Where&nbsp;the&nbsp;&quot;open&nbsp;files&quot;&nbsp;seems&nbsp;to&nbsp;be&nbsp;the&nbsp;related&nbsp;one.&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;I&nbsp;set&nbsp;also&nbsp;the&nbsp;following&nbsp;at&nbsp;squid&nbsp;conf:&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;SPAN&nbsp;style=&quot;FONT-FAMILY:&nbsp;monospace,monospace&quot;&gt;max_filedescriptors&nbsp;<br>
&nbsp;&nbsp;65535&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;I&nbsp;am&nbsp;running&nbsp;a&nbsp;compiled&nbsp;version&nbsp;3.5.23.&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;I&nbsp;have&nbsp;done&nbsp;the&nbsp;correct&nbsp;steps&nbsp;or&nbsp;if&nbsp;I&nbsp;need&nbsp;to&nbsp;tweak&nbsp;the&nbsp;<br>
&nbsp;&nbsp;ulimits&nbsp;also.&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Any&nbsp;experience&nbsp;from&nbsp;your&nbsp;side?&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Thanx,&nbsp;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;alex&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
