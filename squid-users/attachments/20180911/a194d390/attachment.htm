<tt>
i&nbsp;know&nbsp;that.&nbsp;&lt;br&gt;i&nbsp;want&nbsp;to&nbsp;somehow&nbsp;change&nbsp;source&nbsp;code&nbsp;of&nbsp;squid&nbsp;to&nbsp;accept&nbsp;packet&nbsp;from&nbsp;nfqueue,&nbsp;to&nbsp;customize&nbsp;netfilter&nbsp;packet&nbsp;flow&nbsp;for&nbsp;my&nbsp;application(squid).&nbsp;&lt;br&gt;&lt;br&gt;is&nbsp;it&nbsp;possible!?&nbsp;&lt;br&gt;&lt;br&gt;Sent&nbsp;from&nbsp;my&nbsp;Huawei&nbsp;Mobile&lt;div&nbsp;class=&quot;quote&quot;&nbsp;style=&quot;line-height:&nbsp;1.5&quot;&gt;&lt;br&gt;&lt;br&gt;--------&nbsp;Original&nbsp;Message&nbsp;--------&lt;br&gt;Subject:&nbsp;Re:&nbsp;[NOC]&nbsp;Using&nbsp;Nfqueue&nbsp;or&nbsp;DAQ&nbsp;in&nbsp;squid&lt;br&gt;From:&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;br&gt;To:&nbsp;morteza&nbsp;omidian&nbsp;&lt;morteza1131@gmail.com&gt;,Squid&nbsp;noc&nbsp;&lt;noc@lists.squid-cache.org&gt;&lt;br&gt;CC:&nbsp;&lt;br&gt;&lt;br&gt;&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;In&nbsp;future&nbsp;please&nbsp;direct&nbsp;questions&nbsp;about&nbsp;Squid&nbsp;usage&nbsp;to&nbsp;the&nbsp;Vendor&nbsp;that&lt;br&gt;supplied&nbsp;your&nbsp;proxy,&nbsp;or&nbsp;the&nbsp;squid-users&nbsp;mailing&nbsp;list.&nbsp;This&nbsp;noc@&nbsp;list&nbsp;is&lt;br&gt;for&nbsp;the&nbsp;squid-cache.org&nbsp;domain&nbsp;administrators.&lt;br&gt;&lt;br&gt;Replies&nbsp;to&nbsp;this&nbsp;mail&nbsp;have&nbsp;been&nbsp;set&nbsp;to&nbsp;the&nbsp;squid-users&nbsp;mailing&nbsp;list,&nbsp;so&lt;br&gt;if&nbsp;you&nbsp;have&nbsp;any&nbsp;followup&nbsp;please&nbsp;ensure&nbsp;you&nbsp;are&nbsp;subscribed&nbsp;there.&lt;br&gt;&lt;br&gt;&lt;br&gt;On&nbsp;11/09/18&nbsp;2:54&nbsp;AM,&nbsp;morteza&nbsp;omidian&nbsp;wrote:&lt;br&gt;&gt;&nbsp;Hi&lt;br&gt;&gt;&nbsp;i&nbsp;am&nbsp;in&nbsp;a&nbsp;dire&nbsp;need&nbsp;about&nbsp;using&nbsp;squid&nbsp;in&nbsp;my&nbsp;Linux&nbsp;iptables&nbsp;firewall&nbsp;as&nbsp;a&lt;br&gt;&gt;&nbsp;transparent&nbsp;proxy.&nbsp;in&nbsp;my&nbsp;situation,&nbsp;i&nbsp;want&nbsp;squid&nbsp;to&nbsp;place&nbsp;after&nbsp;my&lt;br&gt;&gt;&nbsp;forwards&nbsp;iptables&nbsp;rules,&nbsp;and&nbsp;redirect&nbsp;packets&nbsp;to&nbsp;the&nbsp;input&nbsp;chain&nbsp;does&lt;br&gt;&gt;&nbsp;not&nbsp;work&nbsp;for&nbsp;me.&nbsp;my&nbsp;packet&nbsp;flow&nbsp;is&nbsp;:&nbsp;prerouting &nbsp;&gt; &nbsp;Nat &nbsp;&gt;&nbsp;forward &nbsp;&gt;&lt;br&gt;&gt;&nbsp;squid&nbsp;&gt;&nbsp;post&nbsp;routing&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;the&nbsp;important&nbsp;part&nbsp;is&nbsp;that&nbsp;forward&nbsp;rules&nbsp;must&nbsp;check&nbsp;before&nbsp;packets&lt;br&gt;&gt;&nbsp;forwards&nbsp;to&nbsp;squid.&nbsp;i&nbsp;don't&nbsp;want&nbsp;packets&nbsp;destinate&nbsp;to&nbsp;input&nbsp;chain&nbsp;of&lt;br&gt;&gt;&nbsp;firewall.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;i&nbsp;thought&nbsp;maybe&nbsp;its&nbsp;possible&nbsp;to&nbsp;use&nbsp;DAQ&nbsp;,like&nbsp;the&nbsp;way&nbsp;snort&nbsp;use&nbsp;or&lt;br&gt;&gt;&nbsp;nfqueue&nbsp;in&nbsp;iptables.&nbsp;i&nbsp;need&nbsp;some&nbsp;help&nbsp;about&nbsp;that,&nbsp;please&nbsp;help&nbsp;me&nbsp;if&nbsp;its&lt;br&gt;&gt;&nbsp;possible&nbsp;or&nbsp;*there&nbsp;are&nbsp;any&nbsp;other&nbsp;ways*&nbsp;to&nbsp;solve&nbsp;it&nbsp;.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;thanks&nbsp;a&nbsp;lot.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&lt;br&gt;What&nbsp;you&nbsp;are&nbsp;asking&nbsp;for&nbsp;is&nbsp;not&nbsp;possible.&nbsp;Please&nbsp;see&nbsp;the&nbsp;netfilter&nbsp;packet&lt;br&gt;flow&nbsp;diagram&nbsp;at&lt;br&gt;&lt;https://upload.wikimedia.org/wikipedia/commons/3/37/Netfilter-packet-flow.svg&gt;&lt;br&gt;for&nbsp;reference.&lt;br&gt;&lt;br&gt;In&nbsp;that&nbsp;diagram&nbsp;Squid&nbsp;is&nbsp;the&nbsp;&quot;Application&nbsp;Layer&quot;&nbsp;part&nbsp;of&nbsp;the&nbsp;forward&lt;br&gt;path.&nbsp;Snort,&nbsp;nfqueue&nbsp;etc&nbsp;by&nbsp;comparison&nbsp;are&nbsp;part&nbsp;of&nbsp;the&nbsp;&quot;network&nbsp;layer&quot;&lt;br&gt;or&nbsp;&quot;link&nbsp;layer&quot;.&nbsp;Their&nbsp;actions&nbsp;and&nbsp;involvement&nbsp;in&nbsp;the&nbsp;traffic&nbsp;is&nbsp;quite&lt;br&gt;different&nbsp;from&nbsp;Squid&nbsp;and&nbsp;other&nbsp;application&nbsp;layer&nbsp;software.&lt;br&gt;&lt;br&gt;&lt;br&gt;It&nbsp;sounds&nbsp;to&nbsp;me&nbsp;like&nbsp;you&nbsp;are&nbsp;attempting&nbsp;to&nbsp;intercept&nbsp;traffic&nbsp;in&nbsp;the&lt;br&gt;OUTPUT&nbsp;path.&nbsp;For&nbsp;that&nbsp;situation&nbsp;follow&nbsp;the&nbsp;Localhost&nbsp;interception&lt;br&gt;example&nbsp;at&lt;br&gt;&lt;https://wiki.squid-cache.org/ConfigExamples/Intercept/LinuxLocalhost&gt;&lt;br&gt;&lt;br&gt;If&nbsp;that&nbsp;is&nbsp;not&nbsp;suitable,&nbsp;then&nbsp;please&nbsp;mention&nbsp;(on&nbsp;the&nbsp;squid-users-mailing&lt;br&gt;list)&nbsp;what&nbsp;your&nbsp;problem&nbsp;is,&nbsp;and&nbsp;what&nbsp;you&nbsp;have&nbsp;tried&nbsp;already.&nbsp;Someone&lt;br&gt;could&nbsp;point&nbsp;you&nbsp;at&nbsp;the&nbsp;specific&nbsp;config&nbsp;to&nbsp;use&nbsp;that&nbsp;meets&nbsp;your&nbsp;situation.&lt;br&gt;&lt;br&gt;&lt;br&gt;Amos&nbsp;Jeffries&lt;br&gt;The&nbsp;Squid&nbsp;Software&nbsp;Foundation&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;
</tt>
