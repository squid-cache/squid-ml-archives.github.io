<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Excellent&nbsp;Amos!&nbsp;&lt;br&gt;I&nbsp;have&nbsp;to&nbsp;admit&nbsp;that&nbsp;I&nbsp;was&nbsp;approaching&nbsp;that&nbsp;conclusion.&nbsp;I&nbsp;did&nbsp;exactly&nbsp;as&nbsp;you&nbsp;told&nbsp;me&nbsp;and&nbsp;problem&nbsp;solved.&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;will&nbsp;consider&nbsp;your&nbsp;recommendations&nbsp;when&nbsp;I&nbsp;need&nbsp;to&nbsp;add&nbsp;more&nbsp;rules.&lt;br&gt;Best&nbsp;regards!&lt;br&gt;&lt;br&gt;Gabriel&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;El&nbsp;lun.,&nbsp;1&nbsp;de&nbsp;oct.&nbsp;de&nbsp;2018&nbsp;a&nbsp;la(s)&nbsp;18:04,&nbsp;Amos&nbsp;Jeffries&nbsp;(&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;)&nbsp;escribi√≥:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;2/10/18&nbsp;9:28&nbsp;AM,&nbsp;neok&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;As&nbsp;far&nbsp;as&nbsp;I&nbsp;know,&nbsp;nothing&#39;s&nbsp;changed.&nbsp;The&nbsp;only&nbsp;thing&nbsp;that&nbsp;could&nbsp;have&nbsp;happened&lt;br&gt;<br>
&gt;&nbsp;is&nbsp;that&nbsp;Chrome&nbsp;was&nbsp;updated.&nbsp;I&#39;m&nbsp;reviewing&nbsp;that.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;say&nbsp;Firefox&nbsp;when&nbsp;try&nbsp;acces&nbsp;to&nbsp;denied&nbsp;site:&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;proxy&nbsp;server&nbsp;is&nbsp;refusing&nbsp;connections.&lt;br&gt;<br>
&gt;&nbsp;Firefox&nbsp;is&nbsp;configured&nbsp;to&nbsp;use&nbsp;a&nbsp;proxy&nbsp;server&nbsp;that&nbsp;is&nbsp;refusing&nbsp;connections.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;you&nbsp;an&nbsp;see&nbsp;from&nbsp;the&nbsp;access.log&nbsp;Squid&nbsp;is&nbsp;presenting&nbsp;407&nbsp;auth&lt;br&gt;<br>
challenged&nbsp;in&nbsp;response&nbsp;to&nbsp;these&nbsp;CONNECT&nbsp;requests.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;welcome&nbsp;news&nbsp;to&nbsp;hear&nbsp;Chrome&nbsp;is&nbsp;finally&nbsp;been&nbsp;fixed&nbsp;to&nbsp;actually&lt;br&gt;<br>
perform&nbsp;authentication&nbsp;for&nbsp;CONNECT&nbsp;tunnels.&nbsp;While&nbsp;it&nbsp;may&nbsp;have&nbsp;been&nbsp;okay&lt;br&gt;<br>
with&nbsp;you&nbsp;the&nbsp;previous&nbsp;behaviour&nbsp;is&nbsp;actually&nbsp;a&nbsp;long-standing&nbsp;Browser&nbsp;bug&lt;br&gt;<br>
and&nbsp;violation&nbsp;of&nbsp;HTTP&nbsp;on&nbsp;their&nbsp;part.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;2/10/18&nbsp;8:53&nbsp;AM,&nbsp;neok&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Now&nbsp;Chrome&nbsp;shows&nbsp;me&nbsp;the&nbsp;login&nbsp;window&nbsp;every&nbsp;time&nbsp;I&nbsp;visit&nbsp;a&nbsp;denied&nbsp;site.&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;suspect&nbsp;Chrome&nbsp;has&nbsp;been&nbsp;updated&nbsp;and&nbsp;changed&nbsp;its&nbsp;behavior.&nbsp;I&#39;m&nbsp;currently&lt;br&gt;<br>
&gt;&nbsp;studying&nbsp;that&nbsp;possibility.&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;also&nbsp;rethinking&nbsp;whether&nbsp;the&nbsp;way&nbsp;I&#39;m&nbsp;denying&nbsp;sites&nbsp;is&nbsp;the&nbsp;right&nbsp;one.&lt;br&gt;<br>
&lt;br&gt;<br>
...&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;WEB_ACCESS_YT_ONLY&nbsp;LS_youtube&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;WEB_ACCESS_YT_ONLY&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;&quot;deny&nbsp;WEB_ACCESS_YT_ONLY&quot;&nbsp;line&nbsp;is&nbsp;triggering&nbsp;the&nbsp;re-authentication.&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;the&nbsp;reason&nbsp;for&nbsp;denial&nbsp;is&nbsp;due&nbsp;to&nbsp;credentials&nbsp;(ie&nbsp;%LOGIN&nbsp;for&nbsp;the&lt;br&gt;<br>
external&nbsp;ACL&nbsp;evaluation)&nbsp;a&nbsp;407&nbsp;authentication&nbsp;challenge&nbsp;is&nbsp;produced.&lt;br&gt;<br>
&lt;br&gt;<br>
Notice&nbsp;that&nbsp;in&nbsp;the&nbsp;config&nbsp;I&nbsp;helped&nbsp;you&nbsp;develop&nbsp;a&nbsp;few&nbsp;days&nbsp;ago&nbsp;all&nbsp;the&lt;br&gt;<br>
other&nbsp;uses&nbsp;of&nbsp;these&nbsp;external&nbsp;ACL&nbsp;tests&nbsp;for&nbsp;&quot;deny&quot;&nbsp;action&nbsp;are&nbsp;followed&nbsp;by&lt;br&gt;<br>
another&nbsp;ACL&nbsp;test&nbsp;that&nbsp;is&nbsp;unrelated&nbsp;to&nbsp;the&nbsp;auth&nbsp;process.&nbsp;Usually&nbsp;a&nbsp;regex&lt;br&gt;<br>
or&nbsp;dstdomain&nbsp;check.&nbsp;It&nbsp;is&nbsp;these&nbsp;other&nbsp;ACL&nbsp;checks&nbsp;which&nbsp;prevent&nbsp;any&nbsp;of&lt;br&gt;<br>
those&nbsp;lines&nbsp;triggering&nbsp;similar&nbsp;auth&nbsp;challenges&nbsp;as&nbsp;they&nbsp;deny&nbsp;traffic.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;the&nbsp;next&nbsp;thing&nbsp;your&nbsp;config&nbsp;is&nbsp;doing&nbsp;is&nbsp;a&nbsp;&quot;deny&nbsp;all&quot;&nbsp;you&nbsp;can&nbsp;remove&lt;br&gt;<br>
this&nbsp;&quot;deny&nbsp;WEB_ACCESS_YT_ONLY&quot;&nbsp;line&nbsp;entirely&nbsp;and&nbsp;the&nbsp;popups&nbsp;should&lt;br&gt;<br>
disappear&nbsp;while&nbsp;still&nbsp;having&nbsp;that&nbsp;traffic&nbsp;denied.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;have&nbsp;other&nbsp;config&nbsp;policies&nbsp;to&nbsp;be&nbsp;added&nbsp;later&nbsp;there&nbsp;are&nbsp;some&nbsp;other&lt;br&gt;<br>
things&nbsp;you&nbsp;can&nbsp;do.&nbsp;But&nbsp;those&nbsp;will&nbsp;depend&nbsp;on&nbsp;what&nbsp;the&nbsp;other&nbsp;policies&nbsp;are&lt;br&gt;<br>
going&nbsp;to&nbsp;require,&nbsp;so&nbsp;I&nbsp;wont&nbsp;cover&nbsp;it&nbsp;now.&nbsp;Just&nbsp;be&nbsp;aware&nbsp;you&nbsp;may&nbsp;have&nbsp;to&lt;br&gt;<br>
revisit&nbsp;that&nbsp;YT&nbsp;access&nbsp;rule&nbsp;when&nbsp;adding&nbsp;other&nbsp;policies.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
