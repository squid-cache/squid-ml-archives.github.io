<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Good&nbsp;Day&nbsp;All,&lt;/div&gt;&lt;div&gt;i&#39;m&nbsp;new&nbsp;to&nbsp;squid&nbsp;and&nbsp;i&nbsp;have&nbsp;configured&nbsp;squid&nbsp;as&nbsp;an&nbsp;http&nbsp;transparent&nbsp;proxy&nbsp;with&nbsp;a&nbsp;mikrotik.&lt;/div&gt;&lt;div&gt;the&nbsp;squid&nbsp;server&nbsp;has&nbsp;only&nbsp;a&nbsp;single&nbsp;NIC,&nbsp;so&nbsp;i&nbsp;followed&nbsp;a&nbsp;tutorial&nbsp;and&nbsp;set&nbsp;up&nbsp;a&nbsp;dst-nat&nbsp;to&nbsp;squid&nbsp;proxy&nbsp;for&nbsp;traffic&nbsp;on&nbsp;port&nbsp;80,&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Chain:dstnat.&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Protocol:tcp&lt;/div&gt;&lt;div&gt;Dst-port:80&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Action:dst-nat&lt;/div&gt;&lt;div&gt;To&nbsp;Addresses:192.168.2.2&nbsp;(squid&nbsp;proxy)&lt;/div&gt;&lt;div&gt;To&nbsp;ports:8080&lt;/div&gt;&lt;div&gt;but&nbsp;after&nbsp;setup,&nbsp;only&nbsp;https&nbsp;traffic&nbsp;works&nbsp;correctly,&lt;/div&gt;&lt;div&gt;http&nbsp;traffic&nbsp;client&nbsp;error&nbsp;is&nbsp;&quot;This&nbsp;page&nbsp;isn&#39;t&nbsp;working&nbsp;ERR_EMPTY_RESPONSE&quot;&lt;/div&gt;&lt;div&gt;squid&nbsp;access.log&nbsp;is&nbsp;empty&nbsp;then&nbsp;in&nbsp;squid&nbsp;cache.log&nbsp;these&nbsp;are&nbsp;the&nbsp;errors&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;```&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;2018/10/19&nbsp;17:08:54&nbsp;kid1|&nbsp;ERROR:&nbsp;NF&nbsp;getsockopt(ORIGINAL_DST)&nbsp;failed&nbsp;on&nbsp;local=&lt;a&nbsp;href=&quot;http://192.168.2.2:8080&quot;&gt;192.168.2.2:8080&lt;/a&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://192.168.1.254:41248&quot;&gt;192.168.1.254:41248&lt;/a&gt;&nbsp;FD&nbsp;10&nbsp;flags=33:&nbsp;(92)&nbsp;Protocol&nbsp;not&nbsp;available&lt;br&gt;2018/10/19&nbsp;17:08:54&nbsp;kid1|&nbsp;ERROR:&nbsp;NAT/TPROXY&nbsp;lookup&nbsp;failed&nbsp;to&nbsp;locate&nbsp;original&nbsp;IPs&nbsp;on&nbsp;local=&lt;a&nbsp;href=&quot;http://192.168.2.2:8080&quot;&gt;192.168.2.2:8080&lt;/a&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://192.168.1.254:41248&quot;&gt;192.168.1.254:41248&lt;/a&gt;&nbsp;FD&nbsp;10&nbsp;flags=33&lt;br&gt;&lt;/div&gt;```&lt;/div&gt;&lt;div&gt;please&nbsp;find&nbsp;below&nbsp;my&nbsp;squid.conf&nbsp;contents&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;```&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.0/24&quot;&gt;192.168.1.0/24&lt;/a&gt;   &nbsp;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777   &nbsp;   &nbsp;&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;icap_enable&nbsp;off&lt;br&gt;icap_service&nbsp;service_req&nbsp;reqmod_precache&nbsp;1&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/REQMOD&quot;&gt;127.0.0.1:1344/REQMOD&lt;/a&gt;&lt;br&gt;adaptation_service_set&nbsp;class_req&nbsp;service_req&lt;br&gt;adaptation_access&nbsp;class_req&nbsp;allow&nbsp;all&lt;br&gt;icap_service&nbsp;service_resp&nbsp;respmod_precache&nbsp;0&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/RESPMOD&quot;&gt;127.0.0.1:1344/RESPMOD&lt;/a&gt;&lt;br&gt;adaptation_service_set&nbsp;class_resp&nbsp;service_resp&lt;br&gt;adaptation_access&nbsp;class_resp&nbsp;allow&nbsp;all&lt;br&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;all&lt;br&gt;http_port&nbsp;3128&lt;br&gt;http_port&nbsp;8080&nbsp;transparent&lt;br&gt; access_log&nbsp;daemon:/var/log/squid/access.log&nbsp;squid&lt;br&gt;coredump_dir&nbsp;/var/spool/squid&lt;br&gt;refresh_pattern&nbsp;^ftp:   &nbsp;   &nbsp;1440   &nbsp;20%   &nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:   &nbsp;1440   &nbsp;0%   &nbsp;1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0   &nbsp;0%   &nbsp;0&lt;br&gt;refresh_pattern&nbsp;(Release|Packages(.gz)*)$     &nbsp;0      &nbsp;20%    &nbsp;2880&lt;br&gt;refresh_pattern&nbsp;.   &nbsp;   &nbsp;0   &nbsp;20%   &nbsp;4320&lt;br&gt;&lt;/div&gt;```&lt;/div&gt;&lt;div&gt;please&nbsp;any&nbsp;help&nbsp;or&nbsp;correction&nbsp;would&nbsp;be&nbsp;highly&nbsp;appreciated,&nbsp;i&nbsp;am&nbsp;not&nbsp;even&nbsp;sure&nbsp;if&nbsp;the&nbsp;approach&nbsp;is&nbsp;correct.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Nebedum&nbsp;Uchenna&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
