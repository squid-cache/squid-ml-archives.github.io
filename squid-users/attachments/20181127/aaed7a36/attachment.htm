<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;Thank&nbsp;you&nbsp;both,&nbsp;Matus&nbsp;and&nbsp;Alex!&nbsp;Changing&nbsp;the&nbsp;name&nbsp;got&nbsp;my&nbsp;HTTP&nbsp;access&nbsp;working&nbsp;perfectly.&nbsp;I&nbsp;was&nbsp;stuck&nbsp;on&nbsp;HTTPS&nbsp;soon&nbsp;after,&nbsp;but&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&nbsp;removed&nbsp;&quot;intercept&quot;&nbsp;from&nbsp;the&nbsp;Squid&nbsp;Parent&nbsp;proxy&nbsp;&quot;http_port&quot;&nbsp;line,&nbsp;I&nbsp;got&nbsp;that&nbsp;working.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;guys&nbsp;rock.&nbsp;Thanks&nbsp;again&nbsp;for&nbsp;that&nbsp;little&nbsp;nudge&nbsp;I&nbsp;needed&nbsp;to&nbsp;figure&nbsp;this&nbsp;out.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Phillip&lt;/div&gt;&lt;div&gt; &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;<br>
Message:&nbsp;2&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;27&nbsp;Nov&nbsp;2018&nbsp;17:44:54&nbsp;+0100&lt;br&gt;<br>
From:&nbsp;Matus&nbsp;UHLAR&nbsp;-&nbsp;fantomas&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:uhlar@fantomas.sk&quot;&nbsp;target=&quot;_blank&quot;&gt;uhlar@fantomas.sk&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Parent&nbsp;proxy&nbsp;chaining&lt;br&gt;<br>
Message-ID:&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:20181127164454.GA20312@fantomas.sk&quot;&nbsp;target=&quot;_blank&quot;&gt;20181127164454.GA20312@fantomas.sk&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=us-ascii;&nbsp;format=flowed&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;27.11.18&nbsp;08:33,&nbsp;Phillip&nbsp;McCollum&nbsp;wrote:&lt;br&gt;<br>
&gt;I&nbsp;have&nbsp;a&nbsp;deployment&nbsp;in&nbsp;AWS&nbsp;in&nbsp;where&nbsp;a&nbsp;VPC&nbsp;has&nbsp;a&nbsp;transparent&nbsp;proxy&nbsp;deployed,&lt;br&gt;<br>
&gt;which&nbsp;forwards&nbsp;80/443&nbsp;requests&nbsp;to&nbsp;a&nbsp;parent&nbsp;proxy&nbsp;in&nbsp;another&nbsp;VPC,&nbsp;which&nbsp;I&lt;br&gt;<br>
&gt;then&nbsp;need&nbsp;to&nbsp;forward&nbsp;to&nbsp;another&nbsp;parent&nbsp;proxy&nbsp;(SaaS&nbsp;provider).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Essentially:&lt;br&gt;<br>
&gt;[[Client&nbsp;PC]]&nbsp;--&gt;&nbsp;[[Squid&nbsp;Proxy&nbsp;(10.52.0.20)]]&nbsp;--&gt;&nbsp;[[Parent&nbsp;Squid&nbsp;Proxy&lt;br&gt;<br>
&gt;(10.52.0.168)]]&nbsp;--&gt;&nbsp;[[Parent&nbsp;SaaS&nbsp;Proxy]]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;This&nbsp;is&nbsp;being&nbsp;done&nbsp;to&nbsp;centralize&nbsp;proxy&nbsp;functions&nbsp;and&nbsp;limit&nbsp;the&nbsp;number&nbsp;of&lt;br&gt;<br>
&gt;public&nbsp;IPs&nbsp;that&nbsp;the&nbsp;parent&nbsp;SaaS&nbsp;needs&nbsp;to&nbsp;whitelist.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&#39;m&nbsp;getting&nbsp;&quot;Access&nbsp;Denied&quot;&nbsp;messages&nbsp;and&nbsp;a&nbsp;review&nbsp;of&nbsp;Squid&nbsp;Parent&nbsp;proxy&lt;br&gt;<br>
&gt;access.log&nbsp;shows&nbsp;the&nbsp;following&nbsp;common&nbsp;errors:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;HTTP:&lt;br&gt;<br>
&gt;2018/11/27&nbsp;16:22:54&nbsp;kid1|&nbsp;WARNING:&nbsp;Forwarding&nbsp;loop&nbsp;detected&nbsp;for:&lt;br&gt;<br>
&gt;GET&nbsp;/&nbsp;HTTP/1.1&lt;br&gt;<br>
&gt;Accept:&nbsp;text/html,&nbsp;application/xhtml+xml,&nbsp;image/jxr,&nbsp;*/*&lt;br&gt;<br>
&gt;Accept-Language:&nbsp;en-US&lt;br&gt;<br>
&gt;User-Agent:&nbsp;Mozilla/5.0&nbsp;(Windows&nbsp;NT&nbsp;10.0;&nbsp;WOW64;&nbsp;Trident/7.0;&nbsp;rv:11.0)&nbsp;like&lt;br&gt;<br>
&gt;Gecko&lt;br&gt;<br>
&gt;Accept-Encoding:&nbsp;gzip,&nbsp;deflate&lt;br&gt;<br>
&gt;Cookie:&nbsp;B=8nra62ldvb83a&amp;b=3&amp;s=ik&lt;br&gt;<br>
&gt;Via:&nbsp;1.1&nbsp;squid&nbsp;(squid/3.5.27)&lt;br&gt;<br>
&lt;br&gt;<br>
what&nbsp;are&nbsp;names&nbsp;of&nbsp;your&nbsp;proxies?&lt;br&gt;<br>
you&nbsp;must&nbsp;set&nbsp;different&nbsp;visible_name&nbsp;or&nbsp;at&nbsp;least&nbsp;unique_name&nbsp;so&nbsp;proxy&nbsp;knows&lt;br&gt;<br>
it&#39;s&nbsp;not&nbsp;contacting&nbsp;itself.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;Chain&nbsp;PREROUTING&nbsp;(policy&nbsp;ACCEPT&nbsp;0&nbsp;packets,&nbsp;0&nbsp;bytes)&lt;br&gt;<br>
&gt;&nbsp;pkts&nbsp;bytes&nbsp;target &nbsp; &nbsp; prot&nbsp;opt&nbsp;in &nbsp; &nbsp; out &nbsp; &nbsp; source&lt;br&gt;<br>
&gt;&nbsp;destination&lt;br&gt;<br>
&gt; &nbsp; &nbsp;0 &nbsp; &nbsp; 0&nbsp;REDIRECT &nbsp; tcp &nbsp;-- &nbsp;* &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp;dpt:80&nbsp;redir&nbsp;ports&nbsp;3129&lt;br&gt;<br>
&gt; &nbsp; &nbsp;0 &nbsp; &nbsp; 0&nbsp;REDIRECT &nbsp; tcp &nbsp;-- &nbsp;* &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp;dpt:443&nbsp;redir&nbsp;ports&nbsp;3130&lt;br&gt;<br>
&gt; &nbsp; 35 &nbsp;2100&nbsp;REDIRECT &nbsp; tcp &nbsp;-- &nbsp;* &nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://0.0.0.0/0&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;0.0.0.0/0&lt;/a&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp;dpt:8443&nbsp;redir&nbsp;ports&nbsp;3031&lt;br&gt;<br>
&lt;br&gt;<br>
the&nbsp;intercepting&nbsp;(often&nbsp;called&nbsp;transparent)&nbsp;proxy&nbsp;must&nbsp;have&nbsp;direct&nbsp;access&nbsp;to&lt;br&gt;<br>
world&nbsp;or&nbsp;parent&nbsp;proxy.&nbsp;Redirecting&nbsp;it&nbsp;back&nbsp;will&nbsp;create&nbsp;a&nbsp;loop.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Matus&nbsp;UHLAR&nbsp;-&nbsp;fantomas,&nbsp;&lt;a&nbsp;href=&quot;mailto:uhlar@fantomas.sk&quot;&nbsp;target=&quot;_blank&quot;&gt;uhlar@fantomas.sk&lt;/a&gt;&nbsp;;&nbsp;&lt;a&nbsp;href=&quot;http://www.fantomas.sk/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.fantomas.sk/&lt;/a&gt;&lt;br&gt;<br>
Warning:&nbsp;I&nbsp;wish&nbsp;NOT&nbsp;to&nbsp;receive&nbsp;e-mail&nbsp;advertising&nbsp;to&nbsp;this&nbsp;address.&lt;br&gt;<br>
Varovanie:&nbsp;na&nbsp;tuto&nbsp;adresu&nbsp;chcem&nbsp;NEDOSTAVAT&nbsp;akukolvek&nbsp;reklamnu&nbsp;postu.&lt;br&gt;<br>
BSE&nbsp;=&nbsp;Mad&nbsp;Cow&nbsp;Desease&nbsp;...&nbsp;BSA&nbsp;=&nbsp;Mad&nbsp;Software&nbsp;Producents&nbsp;Desease&lt;br&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
