<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Dear&nbsp;Mike,&nbsp;&lt;br&gt;&lt;br&gt;Please&nbsp;checkout&nbsp;the&nbsp;following&nbsp;and&nbsp;let&nbsp;us&nbsp;know&nbsp;if&nbsp;you&nbsp;need&nbsp;further&nbsp;help.&nbsp;&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/Doc/config/sslproxy_cert_error/&quot;&gt;http://www.squid-cache.org/Doc/config/sslproxy_cert_error/&lt;/a&gt;&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&lt;br&gt;&lt;br&gt;Flashdown&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;Am&nbsp;11.&nbsp;Dezember&nbsp;2018&nbsp;16:41:56&nbsp;MEZ&nbsp;schrieb&nbsp;Mike&nbsp;Quentel&nbsp;&lt;mike.quentel.rbc@gmail.com&gt;:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;pre&nbsp;class=&quot;k9mail&quot;&gt;Hi,&nbsp;I&nbsp;have&nbsp;been&nbsp;unsuccessfully&nbsp;trying&nbsp;to&nbsp;get&nbsp;Squid-4.1-5&nbsp;in&nbsp;AWS&lt;br&gt;(Amazon&nbsp;1&nbsp;Linux)&nbsp;to&nbsp;allow&nbsp;transparent&nbsp;proxy&nbsp;of&nbsp;certain&nbsp;domains,&nbsp;as&lt;br&gt;well&nbsp;as&nbsp;IPs&nbsp;associated&nbsp;with&nbsp;those&nbsp;domains,&nbsp;whilst&nbsp;rejecting&nbsp;everything&lt;br&gt;else.&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;been&nbsp;referencing&nbsp;documentation&nbsp;at&lt;br&gt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/SslPeekAndSplice&quot;&gt;https://wiki.squid-cache.org/Features/SslPeekAndSplice&lt;/a&gt;&lt;br&gt;&lt;br&gt;Version&nbsp;of&nbsp;Squid:&nbsp;4.1-5&nbsp;for&nbsp;Amazon&nbsp;1&nbsp;Linux&nbsp;available&nbsp;at&lt;br&gt;&lt;a&nbsp;href=&quot;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/&quot;&gt;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/&lt;/a&gt;&nbsp;(many&nbsp;thanks&nbsp;to&lt;br&gt;@elico&nbsp;for&nbsp;these&nbsp;packages)&nbsp;specifically,&nbsp;the&nbsp;following:&lt;br&gt;&lt;br&gt;1)&nbsp;&lt;a&nbsp;href=&quot;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/squid-4.1-5.amzn1.x86_64.rpm&quot;&gt;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/squid-4.1-5.amzn1.x86_64.rpm&lt;/a&gt;&lt;br&gt;2)&nbsp;&lt;a&nbsp;href=&quot;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/squid-helpers-4.1-5.amzn1.x86_64.rpm&quot;&gt;http://faster.ngtech.co.il/repo/amzn/1/beta/x86_64/squid-helpers-4.1-5.amzn1.x86_64.rpm&lt;/a&gt;&lt;br&gt;&lt;br&gt;Example&nbsp;of&nbsp;tests&nbsp;that&nbsp;I&nbsp;am&nbsp;running:&lt;br&gt;&lt;br&gt;1)&nbsp;curl&nbsp;-kv&nbsp;&lt;a&nbsp;href=&quot;https://service.us2.sumologic.com&quot;&gt;https://service.us2.sumologic.com&lt;/a&gt;&nbsp;(EXPECTED:&nbsp;successfully&lt;br&gt;accessed;&nbsp;OBSERVED:&nbsp;successfully&nbsp;accessed)&lt;br&gt;2)&nbsp;curl&nbsp;-kv&nbsp;&lt;a&nbsp;href=&quot;https://54.149.155.70&quot;&gt;https://54.149.155.70&lt;/a&gt;&nbsp;(EXPECTED:&nbsp;successfully&nbsp;accessed&lt;br&gt;because&nbsp;it&nbsp;resolves&nbsp;to&nbsp;service.us2.sumologic.com;&nbsp;OBSERVED:&lt;br&gt;&quot;Certificate&nbsp;does&nbsp;not&nbsp;match&nbsp;domainname&quot;&nbsp;&nbsp;[No&nbsp;Error]&nbsp;(TLS&nbsp;code:&lt;br&gt;SQUID_X509_V_ERR_DOMAIN_MISMATCH))&lt;br&gt;3)&nbsp;curl&nbsp;-kv&nbsp;&lt;a&nbsp;href=&quot;https://www.google.com&quot;&gt;https://www.google.com&lt;/a&gt;&nbsp;(EXPECTED:&nbsp;failed&nbsp;to&nbsp;access;&lt;br&gt;OBSERVED:&nbsp;failed&nbsp;to&nbsp;access)&lt;br&gt;4)&nbsp;curl&nbsp;-kv&nbsp;&lt;a&nbsp;href=&quot;https://172.217.13.164&quot;&gt;https://172.217.13.164&lt;/a&gt;&nbsp;(EXPECTED:&nbsp;failed&nbsp;to&nbsp;access;&lt;br&gt;OBSERVED:&nbsp;&quot;Certificate&nbsp;does&nbsp;not&nbsp;match&nbsp;domainname&quot;&nbsp;&nbsp;[No&nbsp;Error]&nbsp;(TLS&lt;br&gt;code:&nbsp;SQUID_X509_V_ERR_DOMAIN_MISMATCH))&lt;br&gt;&lt;br&gt;Below&nbsp;is&nbsp;the&nbsp;latest&nbsp;version&nbsp;of&nbsp;the&nbsp;squid.conf&nbsp;being&nbsp;used.&nbsp;Apologies&lt;br&gt;for&nbsp;any&nbsp;obvious&nbsp;errors--new&nbsp;to&nbsp;Squid&nbsp;here.&nbsp;I&nbsp;have&nbsp;been&nbsp;grappling&nbsp;with&lt;br&gt;this&nbsp;for&nbsp;weeks,&nbsp;with&nbsp;many&nbsp;iterations&nbsp;of&nbsp;squid.conf&nbsp;so&nbsp;any&nbsp;advice&nbsp;is&lt;br&gt;greatly&nbsp;appreciated;&nbsp;many&nbsp;thanks&nbsp;in&nbsp;advance.&lt;hr&gt;visible_hostname&nbsp;squid&lt;br&gt;&lt;br&gt;host_verify_strict&nbsp;off&lt;br&gt;&lt;br&gt;#&nbsp;Handling&nbsp;HTTP&nbsp;requests&lt;br&gt;http_port&nbsp;3128&lt;br&gt;http_port&nbsp;3129&nbsp;intercept&lt;br&gt;&lt;br&gt;sslcrtd_children&nbsp;10&lt;br&gt;&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&nbsp;AWS&nbsp;services&nbsp;domain&lt;br&gt;acl&nbsp;allowed_http_sites&nbsp;dstdomain&nbsp;.amazonaws.com&lt;br&gt;#&nbsp;docker&nbsp;hub&nbsp;registry&lt;br&gt;acl&nbsp;allowed_http_sites&nbsp;dstdomain&nbsp;.docker.io&lt;br&gt;acl&nbsp;allowed_http_sites&nbsp;dstdomain&nbsp;.docker.com&lt;br&gt;acl&nbsp;allowed_http_sites&nbsp;dstdomain&nbsp;www.congiu.net&lt;br&gt;&lt;br&gt;#&nbsp;Handling&nbsp;HTTPS&nbsp;requests&lt;br&gt;#&nbsp;https_port&nbsp;3130&nbsp;intercept&nbsp;ssl-bump&nbsp;generate-host-certificates=on&lt;br&gt;dynamic_cert_mem_cache_size=100MB&nbsp;cert=/etc/squid/squid.pem&lt;br&gt;https_port&nbsp;3130&nbsp;intercept&nbsp;ssl-bump&nbsp;dynamic_cert_mem_cache_size=100MB&lt;br&gt;cert=/etc/squid/squid.pem&lt;br&gt;acl&nbsp;SSL_port&nbsp;port&nbsp;443&lt;br&gt;&lt;br&gt;#&nbsp;AWS&nbsp;services&nbsp;domain&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;.amazonaws.com&lt;br&gt;#&nbsp;docker&nbsp;hub&nbsp;registry&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;.docker.io&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;.docker.com&lt;br&gt;&lt;br&gt;#&nbsp;project&nbsp;specific&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;www.congiu.net&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;mirrors.fedoraproject.org&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;mirror.csclub.uwaterloo.ca&lt;br&gt;&lt;br&gt;#&nbsp;nslookup&nbsp;resolved&nbsp;IPs&nbsp;for&nbsp;collectors.sumologic.com&lt;br&gt;#&nbsp;workaround&nbsp;solution&nbsp;to&nbsp;support&nbsp;sumologic&nbsp;collector&lt;br&gt;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;.sumologic.com&lt;br&gt;#&nbsp;THE&nbsp;FOLLOWING&nbsp;TWO&nbsp;LINES&nbsp;DO&nbsp;NOT&nbsp;SEEM&nbsp;TO&nbsp;WORK&nbsp;AS&nbsp;EXPECTED&lt;br&gt;#&nbsp;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;--server-provided&lt;br&gt;service.sumologic.com&nbsp;sslflags=DONT_VERIFY_PEER&lt;br&gt;#&nbsp;acl&nbsp;allowed_https_sites&nbsp;ssl::server_name&nbsp;--server-provided&lt;br&gt;service.us2.sumologic.com&nbsp;sslflags=DONT_VERIFY_PEER&lt;br&gt;&lt;br&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;acl&nbsp;step2&nbsp;at_step&nbsp;SslBump2&lt;br&gt;acl&nbsp;step3&nbsp;at_step&nbsp;SslBump3&lt;br&gt;&lt;br&gt;ssl_bump&nbsp;peek&nbsp;step1&nbsp;all&lt;br&gt;ssl_bump&nbsp;peek&nbsp;step2&nbsp;allowed_https_sites&lt;br&gt;#&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/2018-September/019150.html&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/2018-September/019150.html&lt;/a&gt;&lt;br&gt;ssl_bump&nbsp;bump&lt;br&gt;ssl_bump&nbsp;splice&nbsp;step3&nbsp;allowed_https_sites&lt;br&gt;ssl_bump&nbsp;bump&lt;br&gt;ssl_bump&nbsp;terminate&nbsp;step2&nbsp;all&lt;br&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&nbsp;http_access&nbsp;allow&nbsp;SSL_port&lt;br&gt;&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!allowed_https_sites&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!allowed_http_sites&lt;br&gt;http_access&nbsp;allow&nbsp;allowed_https_sites&lt;br&gt;http_access&nbsp;allow&nbsp;allowed_http_sites&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;cache&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;debug_options&nbsp;&quot;ALL,9&quot;&lt;hr&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;squid-users@lists.squid-cache.org&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Diese&nbsp;Nachricht&nbsp;wurde&nbsp;von&nbsp;meinem&nbsp;Android-Ger√§t&nbsp;mit&nbsp;K-9&nbsp;Mail&nbsp;gesendet.&lt;/body&gt;&lt;/html&gt;
</tt>
