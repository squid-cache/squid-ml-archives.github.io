<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;switched&nbsp;from&nbsp;Cygwin&nbsp;to&nbsp;building&nbsp;with&nbsp;MinGW,&nbsp;and&nbsp;after&nbsp;8&nbsp;squid&nbsp;code&nbsp;modifications,&nbsp;mostly&nbsp;include&nbsp;and&nbsp;define&nbsp;settings&nbsp;but&nbsp;one&nbsp;flat&nbsp;out&nbsp;access&nbsp;violation&nbsp;crash,&nbsp;I&nbsp;now&nbsp;have&nbsp;Squid&nbsp;proxy&nbsp;running&nbsp;and&nbsp;accessible&nbsp;via&nbsp;browser&nbsp;on&nbsp;Windows&nbsp;:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;now&nbsp;I&nbsp;have&nbsp;built&nbsp;the&nbsp;ecap&nbsp;library,&nbsp;successfully&nbsp;rebuilt&nbsp;squid&nbsp;with&nbsp;--enable-ecap,&nbsp;&nbsp;and&nbsp;built&nbsp;the&nbsp;adapter.&lt;/div&gt;&lt;div&gt;All&nbsp;good!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However&nbsp;I'm&nbsp;at&nbsp;the&nbsp;apparent&nbsp;crux&nbsp;of&nbsp;getting&nbsp;the&nbsp;adapter&nbsp;loaded&nbsp;at&nbsp;squid&nbsp;run&nbsp;time&nbsp;and&nbsp;failing.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;understand&nbsp;that&lt;/div&gt;&lt;div&gt;(1)&nbsp;squid&nbsp;needs&nbsp;to&nbsp;link&nbsp;in&nbsp;the&nbsp;same&nbsp;exact&nbsp;ecap&nbsp;library&nbsp;binary&nbsp;that&nbsp;the&nbsp;adapter&nbsp;does&nbsp;so&nbsp;they&nbsp;can&nbsp;communicate&nbsp;correctly&nbsp;through&nbsp;that&nbsp;ecap,&lt;/div&gt;&lt;div&gt;(2)&nbsp;we&nbsp;don't&nbsp;want&nbsp;to&nbsp;statically&nbsp;link&nbsp;in&nbsp;the&nbsp;adapter&nbsp;to&nbsp;squid.exe,&lt;/div&gt;&lt;div&gt;(3)&nbsp;so&nbsp;that&nbsp;adapter&nbsp;needs&nbsp;to&nbsp;be&nbsp;a&nbsp;shared&nbsp;such&nbsp;library,&nbsp;but&lt;/div&gt;&lt;div&gt;(4)&nbsp;building&nbsp;with&nbsp;MinGW&nbsp;creates&nbsp;a&nbsp;static&nbsp;library.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;I&nbsp;see&nbsp;a&nbsp;comment&nbsp;output&nbsp;during&nbsp;make:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;pre&nbsp;style=&quot;white-space:&nbsp;pre-wrap;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;&gt;&gt;&lt;i&gt;&nbsp;***&nbsp;Warning:&nbsp;This&nbsp;system&nbsp;can&nbsp;not&nbsp;link&nbsp;to&nbsp;static&nbsp;lib&nbsp;archive<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;/usr/local/lib/libecap.la.&nbsp;***&nbsp;I&nbsp;have&nbsp;the&nbsp;capability&nbsp;to&nbsp;make&nbsp;that<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;library&nbsp;automatically&nbsp;link&nbsp;in&nbsp;when&nbsp;***&nbsp;you&nbsp;link&nbsp;to&nbsp;this&nbsp;library.<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;But&nbsp;I&nbsp;can&nbsp;only&nbsp;do&nbsp;this&nbsp;if&nbsp;you&nbsp;have&nbsp;a&nbsp;***&nbsp;shared&nbsp;version&nbsp;of&nbsp;the<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;library,&nbsp;which&nbsp;you&nbsp;do&nbsp;not&nbsp;appear&nbsp;to&nbsp;have.&nbsp;***&nbsp;But&nbsp;as&nbsp;you&nbsp;try&nbsp;to<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;build&nbsp;a&nbsp;module&nbsp;library,&nbsp;libtool&nbsp;will&nbsp;still&nbsp;create&nbsp;***&nbsp;a&nbsp;static<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;module,&nbsp;that&nbsp;should&nbsp;work&nbsp;as&nbsp;long&nbsp;as&nbsp;the&nbsp;dlopening&nbsp;application&nbsp;***<br>
&lt;/i&gt;&gt;&lt;i&gt;&nbsp;is&nbsp;linked&nbsp;with&nbsp;the&nbsp;-dlopen&nbsp;flag&nbsp;to&nbsp;resolve&nbsp;symbols&nbsp;at&nbsp;runtime.&lt;/i&gt;&lt;/pre&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;I&nbsp;did&nbsp;use&nbsp;this&nbsp;./configure&nbsp;for&nbsp;squid,&nbsp;specifying&nbsp;the&nbsp;dlopen:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;div&gt;./configure&nbsp;LDFLAGS=&quot;-dlopen=C:/MinGW/src/ecap_adapter_sample-1.0.0/src/.libs/ecap_adapter_modifying.la&quot;&nbsp;--prefix=c:/squid&nbsp;&nbsp;--enable-ecap&nbsp;--enable-default-hostsfile=none&nbsp;--disable-strict-error-checking&nbsp;&nbsp;--enable-win32-service&nbsp;--disable-optimizations&nbsp;--enable-debug-cbdata&nbsp;--with-pidfile=/var/run/squid.pid&nbsp;--enable-delay-pools&nbsp;--disable-eui&nbsp;--with-filedescriptors=65536&nbsp;--enable-removal-policies=lru,heap&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;my&nbsp;understanding&nbsp;further&nbsp;being&nbsp;that&nbsp;the&nbsp;dlopen&nbsp;will&nbsp;cause&nbsp;squid&nbsp;to&nbsp;not&nbsp;link&nbsp;in&nbsp;the&nbsp;adapter&nbsp;until&nbsp;run&nbsp;time&nbsp;even&nbsp;though&nbsp;that&nbsp;library&nbsp;is&nbsp;static.&nbsp;And&nbsp;since&nbsp;it&nbsp;is&nbsp;not&nbsp;a&nbsp;native&nbsp;Windows&nbsp;format&nbsp;library&nbsp;(not&nbsp;a&nbsp;dll)&nbsp;then&nbsp;squid&nbsp;has&nbsp;to&nbsp;run&nbsp;in&nbsp;a&nbsp;MinGW&nbsp;window.&nbsp;Correct?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yet&nbsp;I&nbsp;still&nbsp;get:&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;div&gt;2018/12/19&nbsp;22:57:32|&nbsp;Loading&nbsp;Squid&nbsp;module&nbsp;from&nbsp;'C:/MinGW/src/ecap_adapter_sample&lt;/div&gt;&lt;div&gt;-1.0.0/src/.libs/ecap_adapter_modifying.la'&lt;/div&gt;&lt;div&gt;2018/12/19&nbsp;22:57:32|&nbsp;FATAL:&nbsp;dying&nbsp;from&nbsp;an&nbsp;unhandled&nbsp;exception:&nbsp;file&nbsp;not&nbsp;found&lt;/div&gt;&lt;div&gt;terminate&nbsp;called&nbsp;after&nbsp;throwing&nbsp;an&nbsp;instance&nbsp;of&nbsp;'TextException'&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;what():&nbsp;&nbsp;file&nbsp;not&nbsp;found&lt;/div&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;change&nbsp;my&nbsp;squid.conf&nbsp;instead&nbsp;to&nbsp;load&nbsp;in&nbsp;.a&nbsp;instead&nbsp;of&nbsp;.la&nbsp;just&nbsp;as&nbsp;a&nbsp;test,&nbsp;I&nbsp;get&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;div&gt;2018/12/20&nbsp;08:39:58|&nbsp;Loading&nbsp;Squid&nbsp;module&nbsp;from&nbsp;'C:/MinGW/src/ecap_adapter_sample&lt;/div&gt;&lt;div&gt;-1.0.0/src/.libs/ecap_adapter_modifying.a'&lt;/div&gt;&lt;div&gt;2018/12/20&nbsp;08:39:58|&nbsp;FATAL:&nbsp;dying&nbsp;from&nbsp;an&nbsp;unhandled&nbsp;exception:&nbsp;%1&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&lt;/div&gt;&lt;div&gt;&nbsp;Win32&nbsp;application.&lt;/div&gt;&lt;div&gt;terminate&nbsp;called&nbsp;after&nbsp;throwing&nbsp;an&nbsp;instance&nbsp;of&nbsp;'TextException'&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;what():&nbsp;&nbsp;%1&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Win32&nbsp;application.&lt;/div&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;I&nbsp;know&nbsp;it's&nbsp;actually&nbsp;accessing&nbsp;that&nbsp;.la,&nbsp;which&nbsp;does&nbsp;exist&nbsp;at&nbsp;that&nbsp;location,&nbsp;yet&nbsp;still&nbsp;complains&nbsp;that&nbsp;&quot;file&nbsp;not&nbsp;found&quot;.&lt;/div&gt;&lt;div&gt;Is&nbsp;it&nbsp;as&nbsp;well&nbsp;trying&nbsp;to&nbsp;link&nbsp;in&nbsp;another&nbsp;library&nbsp;that&nbsp;the&nbsp;adapter&nbsp;needs?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Russel&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;ydp2d2447b1yahoo-style-wrap&quot;&nbsp;style=&quot;font-family:Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;font-size:16px;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
