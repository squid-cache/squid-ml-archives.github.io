<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Amos,&nbsp;thank&nbsp;you&nbsp;for&nbsp;the&nbsp;quick&nbsp;response.&nbsp;My&nbsp;original&nbsp;question&nbsp;could&nbsp;use&nbsp;an&nbsp;example&nbsp;to&nbsp;clarify.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;client&nbsp;------&gt;&nbsp;&lt;a&nbsp;href=&quot;http://example.com&quot;&gt;example.com&lt;/a&gt;&nbsp;(HTTPS&nbsp;squid&nbsp;proxy)&nbsp;------&gt;&nbsp;&lt;a&nbsp;href=&quot;http://instance.example.com&quot;&gt;instance.example.com&lt;/a&gt;&nbsp;(HTTPS&nbsp;server)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;HTTPS&nbsp;squid&nbsp;proxy&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://example.com&quot;&gt;example.com&lt;/a&gt;&nbsp;has&nbsp;a&nbsp;trusted&nbsp;wildcard&nbsp;certificate&nbsp;for&nbsp;*.&lt;a&nbsp;href=&quot;http://example.com&quot;&gt;example.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;HTTPS&nbsp;server&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://instance.example.com&quot;&gt;instance.example.com&lt;/a&gt;&nbsp;has&nbsp;an&nbsp;untrusted&nbsp;certificate&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://instance.example.com&quot;&gt;instance.example.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;without&nbsp;MITM,&nbsp;the&nbsp;client&nbsp;issues&nbsp;a&nbsp;CONNECT&nbsp;to&nbsp;squid&nbsp;running&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://example.com&quot;&gt;example.com&lt;/a&gt;&nbsp;which&nbsp;does&nbsp;its&nbsp;TLS,&nbsp;authenticates,&nbsp;connects&nbsp;to&nbsp;upstream&nbsp;then&nbsp;goes&nbsp;into&nbsp;tunneling&nbsp;mode.&nbsp;The&nbsp;client&nbsp;does&nbsp;the&nbsp;TLS&nbsp;handshake&nbsp;with&nbsp;&lt;a&nbsp;href=&quot;http://instance.example.com&quot;&gt;instance.example.com&lt;/a&gt;,&nbsp;receives&nbsp;its&nbsp;untrusted&nbsp;certificate,&nbsp;and&nbsp;isn&#39;t&nbsp;happy.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;looking&nbsp;for&nbsp;a&nbsp;MITM&nbsp;mode&nbsp;that,&nbsp;instead&nbsp;of&nbsp;requiring&nbsp;a&nbsp;CA&nbsp;that&nbsp;can&nbsp;dynamically&nbsp;create&nbsp;trusted&nbsp;certs&nbsp;on&nbsp;the&nbsp;fly,&nbsp;will&nbsp;return&nbsp;a&nbsp;wildcard&nbsp;certificate&nbsp;for&nbsp;all&nbsp;requests&nbsp;(or&nbsp;even&nbsp;better,&nbsp;for&nbsp;any&nbsp;requests&nbsp;matching&nbsp;hosts&nbsp;in&nbsp;its&nbsp;subdomain).&nbsp;Is&nbsp;that&nbsp;something&nbsp;that&nbsp;exists?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;hacked&nbsp;up&nbsp;my&nbsp;own&nbsp;version&nbsp;of&nbsp;ssl_crtd&nbsp;to&nbsp;serve&nbsp;a&nbsp;static&nbsp;cert&nbsp;and&nbsp;ran&nbsp;into&nbsp;another&nbsp;wrinkle.&nbsp;Is&nbsp;there&nbsp;a&nbsp;version&nbsp;of&nbsp;squid&nbsp;that&nbsp;supports&nbsp;ssl-bump&nbsp;with&nbsp;https_port?&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Fri,&nbsp;Jan&nbsp;25,&nbsp;2019&nbsp;at&nbsp;9:42&nbsp;PM&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;26/01/19&nbsp;5:51&nbsp;am,&nbsp;Bill&nbsp;Bernsen&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;squid&nbsp;running&nbsp;as&nbsp;an&nbsp;explicit&nbsp;forward&nbsp;proxy&nbsp;on&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;host &lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://example.com/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/&lt;/a&gt;&gt; controlling&nbsp;access&nbsp;to&nbsp;all&nbsp;hosts&lt;br&gt;<br>
&gt;&nbsp;in&nbsp;*.&lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://example.com/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/&lt;/a&gt;&gt;.&nbsp;All&nbsp;the&nbsp;hosts&nbsp;in&nbsp;*.&lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://example.com/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/&lt;/a&gt;&gt; have&nbsp;self-signed&nbsp;certificates&nbsp;that&nbsp;I&nbsp;want&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;appear&nbsp;as&nbsp;trusted&nbsp;to&nbsp;user&nbsp;browsers.&nbsp;I&nbsp;don&#39;t&nbsp;have&nbsp;the&nbsp;option&nbsp;of&nbsp;obtaining&lt;br&gt;<br>
&gt;&nbsp;a&nbsp;trusted&nbsp;CA.&nbsp;I&nbsp;do,&nbsp;however,&nbsp;have&nbsp;a&nbsp;trusted&nbsp;wildcard&nbsp;certificate&nbsp;for&lt;br&gt;<br>
&gt;&nbsp;*.&lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://example.com/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/&lt;/a&gt;&gt; available.&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;that&nbsp;I&nbsp;can&lt;br&gt;<br>
&gt;&nbsp;tell&nbsp;squid&nbsp;to&nbsp;present&nbsp;this&nbsp;static&nbsp;wildcard&nbsp;certificate&nbsp;to&nbsp;clients&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;lieu&nbsp;of&nbsp;all&nbsp;upstream&nbsp;server&nbsp;certificates?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;a&nbsp;forward&nbsp;proxy&nbsp;clients&nbsp;are&nbsp;*not*&nbsp;connecting&nbsp;to&nbsp;any&nbsp;of&nbsp;the&lt;br&gt;<br>
*.&lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&nbsp;domains.&nbsp;They&nbsp;are&nbsp;connecting&nbsp;to&nbsp;your&nbsp;proxy&nbsp;hostname&nbsp;-&nbsp;and&lt;br&gt;<br>
telling&nbsp;it&nbsp;to&nbsp;take&nbsp;care&nbsp;of&nbsp;the&nbsp;origin&nbsp;connections.&nbsp;So&nbsp;all&nbsp;clients&nbsp;need&lt;br&gt;<br>
is&nbsp;trust&nbsp;for&nbsp;the&nbsp;CA&nbsp;which&nbsp;signed&nbsp;the&nbsp;proxy&#39;s&nbsp;certificate.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;proxy&nbsp;is&nbsp;the&nbsp;only&nbsp;agent&nbsp;in&nbsp;the&nbsp;path&nbsp;which&nbsp;needs&nbsp;to&nbsp;trust&nbsp;the&lt;br&gt;<br>
wildcard&nbsp;*.&lt;a&nbsp;href=&quot;http://example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;example.com&lt;/a&gt;&nbsp;certificate.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
