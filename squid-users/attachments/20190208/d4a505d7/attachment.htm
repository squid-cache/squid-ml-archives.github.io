<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;15&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#0563C1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#954F72;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
p.MsoListParagraph,&nbsp;li.MsoListParagraph,&nbsp;div.MsoListParagraph<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:34;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-top:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-right:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-left:.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-compose;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
/*&nbsp;List&nbsp;Definitions&nbsp;*/<br>
@list&nbsp;l0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-list-id:2088190775;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-type:hybrid;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-template-ids:-856633050&nbsp;67698705&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715;}<br>
@list&nbsp;l0:level1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-text:&quot;%1\)&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
@list&nbsp;l0:level4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
@list&nbsp;l0:level7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
ol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
ul<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
--&gt;&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;#0563C1&quot;&nbsp;vlink=&quot;#954F72&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;I&nbsp;am&nbsp;using&nbsp;Squid&nbsp;4.5&nbsp;with&nbsp;WCCP.&nbsp;Intercepting&nbsp;SSL&nbsp;by&nbsp;peeking&nbsp;at&nbsp;step1&nbsp;and&nbsp;then&nbsp;deciding&nbsp;to&nbsp;either&nbsp;splice&nbsp;or&nbsp;bump&nbsp;upon&nbsp;the&nbsp;SNI.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;I&nbsp;am&nbsp;noticing&nbsp;a&nbsp;weird&nbsp;behavior&nbsp;for&nbsp;some&nbsp;of&nbsp;my&nbsp;TCP&nbsp;connections.&nbsp;&nbsp;Squid&nbsp;is&nbsp;taking&nbsp;over&nbsp;20s&nbsp;to&nbsp;decide&nbsp;what&nbsp;do&nbsp;with&nbsp;the&nbsp;ClientHello&nbsp;sent&nbsp;by&nbsp;the&nbsp;browser.&nbsp;It&nbsp;is&nbsp;only&nbsp;after&nbsp;20s&nbsp;that&nbsp;it&nbsp;decides&nbsp;to&nbsp;send&nbsp;out&nbsp;a&nbsp;ClientHello&nbsp;to&nbsp;the&nbsp;origin&nbsp;server&nbsp;and<br>
&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;reply&nbsp;to&nbsp;the&nbsp;client&nbsp;with&nbsp;a&nbsp;ServerHello.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;This&nbsp;behavior&nbsp;is&nbsp;hard&nbsp;to&nbsp;reproduce&nbsp;and&nbsp;only&nbsp;some&nbsp;clients&nbsp;are&nbsp;affected.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;I&nbsp;will&nbsp;try&nbsp;to&nbsp;summarize&nbsp;what&nbsp;I&nbsp;see&nbsp;in&nbsp;cache.log&nbsp;with&nbsp;ALL,&nbsp;6&nbsp;debug&nbsp;options.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;1)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Squid's&nbsp;INTERCEPTION&nbsp;thread/program&nbsp;receives&nbsp;a&nbsp;TCP&nbsp;SYN&nbsp;from&nbsp;workstation.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.070&nbsp;kid1|&nbsp;89,5|&nbsp;Intercept.cc(405)&nbsp;Lookup:&nbsp;address&nbsp;BEGIN:&nbsp;me/client=<br>
&lt;b&gt;&lt;SQUID_IP&gt;:&lt;/b&gt;23129,&nbsp;destination/me=&nbsp;&lt;b&gt;&lt;CLIENT/BROWSER_IP&gt;:&lt;/b&gt;58232&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;2)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Squid&nbsp;becomes&nbsp;the&nbsp;origin&nbsp;server&nbsp;and&nbsp;sets&nbsp;up&nbsp;the&nbsp;TCP&nbsp;connection.<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.070&nbsp;kid1|&nbsp;5,5|&nbsp;AsyncCall.cc(93)&nbsp;ScheduleCall:&nbsp;TcpAcceptor.cc(339)&nbsp;will&nbsp;call&nbsp;httpsAccept(local&lt;b&gt;=&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;&lt;/b&gt;:443&nbsp;remote=&lt;b&gt;&lt;CLIENT/BROWSER_IP&gt;:&lt;/b&gt;58232&nbsp;FD&nbsp;40&nbsp;flags=33,<br>
&nbsp;MXID_1101703)&nbsp;[call34733258]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.070&nbsp;kid1|&nbsp;5,5|&nbsp;AsyncCall.cc(38)&nbsp;make:&nbsp;make&nbsp;call&nbsp;httpsAccept&nbsp;[call34733258]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2019/02/06&nbsp;17:23:19.070&nbsp;kid1|&nbsp;33,4|&nbsp;client_side.cc(2776)&nbsp;httpsAccept:&nbsp;local&lt;b&gt;=&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;&lt;/b&gt;:443&nbsp;remote=&lt;b&gt;&lt;CLIENT/BROWSER_IP&gt;&lt;/b&gt;:58232&nbsp;FD&nbsp;40&nbsp;flags=33&nbsp;accepted,&nbsp;starting&nbsp;SSL&nbsp;negotiation.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;3)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Squid&nbsp;checks&nbsp;the&nbsp;SSL&nbsp;ACLs&nbsp;for&nbsp;the&nbsp;destination&nbsp;IP.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;(ssl_bump&nbsp;rules)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,5|&nbsp;Checklist.cc(397)&nbsp;bannedAction:&nbsp;Action&nbsp;'ALLOWED/6'&nbsp;is&nbsp;not&nbsp;banned&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;(ssl_bump&nbsp;rule)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;no_ssl_bump_src_ip&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,3|&nbsp;Ip.cc(538)&nbsp;match:&nbsp;aclIpMatchIp:&nbsp;'&lt;b&gt;&lt;CLIENT/BROWSER_IP&gt;&lt;/b&gt;:58232'&nbsp;NOT&nbsp;found&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,3|&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;no_ssl_bump_src_ip&nbsp;=&nbsp;0&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;4)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Squid&nbsp;decides&nbsp;to&nbsp;allow&nbsp;connections&nbsp;to&nbsp;the&nbsp;remote&nbsp;IP&nbsp;i.e&nbsp;&lt;b&gt;<br>
&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;&lt;/b&gt;&nbsp;and&nbsp;decides&nbsp;to&nbsp;peek&nbsp;at&nbsp;the&nbsp;SNI&nbsp;(will&nbsp;accept&nbsp;ClientHello),&nbsp;hence&nbsp;fakes&nbsp;a&nbsp;CONNECT&nbsp;request&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;28,3|&nbsp;Checklist.cc(163)&nbsp;checkCallback:&nbsp;ACLChecklist::checkCallback:&nbsp;0x1fb19fd8&nbsp;answer=ALLOWED&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;33,2|&nbsp;client_side.cc(2744)&nbsp;httpsSslBumpAccessCheckDone:&nbsp;sslBump&nbsp;action&nbsp;peekneeded&nbsp;for&nbsp;local=&lt;b&gt;&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;remote=&lt;&lt;b&gt;CLIENT/BROWSER_IP&gt;:&lt;/b&gt;58232&nbsp;FD&nbsp;40<br>
&nbsp;flags=33&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.071&nbsp;kid1|&nbsp;33,2|&nbsp;client_side.cc(3395)&nbsp;fakeAConnectRequest:&nbsp;fake&nbsp;a&nbsp;CONNECT&nbsp;request&nbsp;to&nbsp;force&nbsp;connState&nbsp;to&nbsp;tunnel&nbsp;for&nbsp;ssl-bump&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;5)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;The&nbsp;FAKE&nbsp;connect&nbsp;requests&nbsp;again&nbsp;runs&nbsp;through&nbsp;ACLs.&nbsp;&nbsp;20ms&nbsp;are&nbsp;spent&nbsp;for&nbsp;DNS&nbsp;PTR&nbsp;lookup.&nbsp;A&nbsp;total&nbsp;of&nbsp;30ms&nbsp;is&nbsp;spent&nbsp;parsing&nbsp;ACLs.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.103&nbsp;kid1|&nbsp;85,2|&nbsp;client_side_request.cc(758)&nbsp;clientAccessCheckDone:&nbsp;The&nbsp;request&nbsp;CONNECT<br>
&lt;b&gt;&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;&lt;/b&gt;&nbsp;is&nbsp;ALLOWED;&nbsp;last&nbsp;ACL&nbsp;checked:&nbsp;localnet&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.103&nbsp;kid1|&nbsp;93,4|&nbsp;AccessCheck.cc(145)&nbsp;checkCandidates:&nbsp;NO&nbsp;candidates&nbsp;left&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.103&nbsp;kid1|&nbsp;93,3|&nbsp;AccessCheck.cc(196)&nbsp;callBack:&nbsp;NULL&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.103&nbsp;kid1|&nbsp;93,5|&nbsp;AsyncCall.cc(26)&nbsp;AsyncCall:&nbsp;The&nbsp;AsyncCall&nbsp;Adaptation::Initiator::noteAdaptationAclCheckDone&nbsp;constructed,&nbsp;this=0x1552b0b0&nbsp;[call34733267]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;6)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;FAKE&nbsp;connect&nbsp;is&nbsp;processed&nbsp;and&nbsp;Squid&nbsp;reads&nbsp;the&nbsp;TCP&nbsp;connection,&nbsp;gets&nbsp;the&nbsp;ClientHello&nbsp;and&nbsp;reads&nbsp;the&nbsp;SNI.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;33,5|&nbsp;AsyncCall.cc(38)&nbsp;make:&nbsp;make&nbsp;call&nbsp;Server::doClientRead&nbsp;[call34733270]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;33,5|&nbsp;AsyncJob.cc(123)&nbsp;callStart:&nbsp;Http1::Server&nbsp;status&nbsp;in:&nbsp;[&nbsp;job2971436]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;33,5|&nbsp;Server.cc(104)&nbsp;doClientRead:&nbsp;local&lt;b&gt;=&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;remote&lt;b&gt;=&lt;CLIENT/BROWSER_IP&gt;&lt;/b&gt;:58232&nbsp;FD&nbsp;40&nbsp;flags=33&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;5,3|&nbsp;Read.cc(92)&nbsp;ReadNow:&nbsp;local=&lt;&lt;b&gt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;remote=&lt;&lt;b&gt;CLIENT/BROWSER_IP&lt;/b&gt;&gt;:58232&nbsp;FD&nbsp;40&nbsp;flags=33,&nbsp;size&nbsp;4096,&nbsp;retval&nbsp;203,&nbsp;errno&nbsp;0&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;33,5|&nbsp;AsyncCall.cc(26)&nbsp;AsyncCall:&nbsp;The&nbsp;AsyncCall&nbsp;ConnStateData::requestTimeout&nbsp;constructed,&nbsp;this=0x3d42d40&nbsp;[call34733271]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;5,3|&nbsp;comm.cc(559)&nbsp;commSetConnTimeout:&nbsp;local=&lt;b&gt;&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;remote=&lt;b&gt;&lt;CLIENT/BROWSER_IP&gt;:&lt;/b&gt;58232&nbsp;FD&nbsp;40&nbsp;flags=33&nbsp;timeout&nbsp;300&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;83,5|&nbsp;Handshake.cc(404)&nbsp;parseExtensions:&nbsp;first&nbsp;unsupported&nbsp;extension:&nbsp;19018&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.104&nbsp;kid1|&nbsp;83,3|&nbsp;Handshake.cc(497)&nbsp;parseSniExtension:&nbsp;host_name=&lt;b&gt;&lt;ORIGIN_SERVER_SNI&gt;&lt;/b&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;7)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;This&nbsp;is&nbsp;followed&nbsp;by&nbsp;another&nbsp;round&nbsp;of&nbsp;ACL&nbsp;processing&nbsp;now&nbsp;that&nbsp;we&nbsp;have&nbsp;the&nbsp;SNI.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.106&nbsp;kid1|&nbsp;33,3|&nbsp;Pipeline.cc(35)&nbsp;front:&nbsp;Pipeline&nbsp;0xc2d7b60&nbsp;front&nbsp;0x1ae2e730*2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.106&nbsp;kid1|&nbsp;33,3|&nbsp;Pipeline.cc(35)&nbsp;front:&nbsp;Pipeline&nbsp;0xc2d7b60&nbsp;front&nbsp;0x1ae2e730*3&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;83,5|&nbsp;Session.cc(103)&nbsp;NewSessionObject:&nbsp;SSL_new&nbsp;session=0x78136a0&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;83,5|&nbsp;bio.cc(616)&nbsp;squid_bio_ctrl:&nbsp;0xcd0fe80&nbsp;104(6000,&nbsp;0x7ffc32a6e6b4)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;83,5|&nbsp;Session.cc(162)&nbsp;CreateSession:&nbsp;link&nbsp;FD&nbsp;40&nbsp;to&nbsp;TLS&nbsp;session=0x78136a0&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;33,5|&nbsp;client_side.cc(2535)&nbsp;httpsCreate:&nbsp;will&nbsp;negotiate&nbsp;TLS&nbsp;on&nbsp;local=&lt;&lt;b&gt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;remote=&lt;&lt;b&gt;CLIENT/BROWSER_IP&lt;/b&gt;&gt;:58232&nbsp;FD&nbsp;40&nbsp;flags=33&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;5,5|&nbsp;ModEpoll.cc(117)&nbsp;SetSelect:&nbsp;FD&nbsp;40,&nbsp;type=1,&nbsp;handler=0,&nbsp;client_data=0,&nbsp;timeout=0&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;83,5|&nbsp;client_side.cc(3324)&nbsp;startPeekAndSplice:&nbsp;Peek&nbsp;and&nbsp;splice&nbsp;at&nbsp;step2&nbsp;done.&nbsp;Start&nbsp;forwarding&nbsp;the&nbsp;request!!!&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.107&nbsp;kid1|&nbsp;17,3|&nbsp;FwdState.cc(340)&nbsp;Start:&nbsp;'&lt;&lt;b&gt;ORIGIN_SERVER_ON_THE_INTERNET&lt;/b&gt;&gt;:443'&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;8)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;No&nbsp;ServerHello&nbsp;has&nbsp;been&nbsp;sent&nbsp;back&nbsp;to&nbsp;the&nbsp;client&nbsp;yet,&nbsp;Squid&nbsp;starts&nbsp;a&nbsp;TCP&nbsp;connection&nbsp;with&nbsp;the&nbsp;origin&nbsp;server&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.110&nbsp;kid1|&nbsp;5,4|&nbsp;AsyncJob.cc(123)&nbsp;callStart:&nbsp;Comm::ConnOpener&nbsp;status&nbsp;in:&nbsp;[&nbsp;job2971439]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.110&nbsp;kid1|&nbsp;5,5|&nbsp;ConnOpener.cc(350)&nbsp;doConnect:&nbsp;local=0.0.0.0&nbsp;remote&lt;b&gt;=&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;:&lt;/b&gt;443&nbsp;flags=1:&nbsp;Comm::OK&nbsp;-&nbsp;connected&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.110&nbsp;kid1|&nbsp;5,4|&nbsp;ConnOpener.cc(155)&nbsp;cleanFd:&nbsp;local=0.0.0.0&nbsp;remote=&lt;&lt;b&gt;ORIGIN_SERVER_ON_THE_INTERNET&lt;/b&gt;&gt;:443&nbsp;flags=1&nbsp;closing&nbsp;temp&nbsp;FD&nbsp;50&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;9)&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Squid&nbsp;starts&nbsp;a&nbsp;TLS&nbsp;session&nbsp;with&nbsp;the&nbsp;remote/origin&nbsp;server,&nbsp;sends&nbsp;the&nbsp;ClientHello.&nbsp;A&nbsp;total&nbsp;of&nbsp;0.4&nbsp;seconds&nbsp;in&nbsp;Squid&nbsp;sending&nbsp;clienthello&nbsp;to&nbsp;origin&nbsp;server.&nbsp;This&nbsp;is&nbsp;probably&nbsp;when&nbsp;Squid&nbsp;decides&nbsp;to&nbsp;send&nbsp;back&nbsp;the&nbsp;ServerHello&nbsp;to&nbsp;the&nbsp;browser.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.110&nbsp;kid1|&nbsp;83,5|&nbsp;Session.cc(103)&nbsp;NewSessionObject:&nbsp;SSL_new&nbsp;session=0x14899390&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.111&nbsp;kid1|&nbsp;83,5|&nbsp;bio.cc(616)&nbsp;squid_bio_ctrl:&nbsp;0x1492ef80&nbsp;104(6001,&nbsp;0x7ffc32a6e884)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.111&nbsp;kid1|&nbsp;83,5|&nbsp;Session.cc(162)&nbsp;CreateSession:&nbsp;link&nbsp;FD&nbsp;50&nbsp;to&nbsp;TLS&nbsp;session=0x14899390&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;2019/02/06&nbsp;17:23:19.111&nbsp;kid1|&nbsp;83,5|&nbsp;PeerConnector.cc(123)&nbsp;initialize:&nbsp;local=&lt;b&gt;&lt;SQUID_IP&gt;&lt;/b&gt;:44498&nbsp;remote=&lt;b&gt;&lt;ORIGIN_SERVER_ON_THE_INTERNET&gt;&lt;/b&gt;:443&nbsp;FD&nbsp;50&nbsp;flags=1,&nbsp;session=0x14899390&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;So&nbsp;somewhere&nbsp;between&nbsp;Step&nbsp;8&nbsp;and&nbsp;Step&nbsp;9,&nbsp;Squid&nbsp;is&nbsp;taking&nbsp;over&nbsp;20s.<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;What&nbsp;could&nbsp;possibly&nbsp;be&nbsp;keeping&nbsp;it&nbsp;busy&nbsp;?<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;I&nbsp;have&nbsp;external&nbsp;ACL&nbsp;helpers&nbsp;but&nbsp;they&nbsp;work&nbsp;just&nbsp;fine.&nbsp;Average&nbsp;service&nbsp;time&nbsp;is&nbsp;1ms.&nbsp;Squid&nbsp;has&nbsp;not&nbsp;even&nbsp;spawning&nbsp;all&nbsp;helpers&nbsp;that&nbsp;it&nbsp;has&nbsp;been&nbsp;configured&nbsp;to&nbsp;do.&nbsp;(not&nbsp;exhausted&nbsp;the&nbsp;upper&nbsp;limit).<br>
&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;DNS&nbsp;resolution&nbsp;is&nbsp;also&nbsp;good.&nbsp;All&nbsp;CPU/MEM&nbsp;resources&nbsp;look&nbsp;just&nbsp;fine&nbsp;and&nbsp;again&nbsp;this&nbsp;affects&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;the&nbsp;traffic.&nbsp;&nbsp;I&nbsp;don&#8217;t&nbsp;have&nbsp;the&nbsp;failure&nbsp;logs&nbsp;from&nbsp;when&nbsp;this&nbsp;actually&nbsp;happens.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;UPDATE:&nbsp;This&nbsp;problem&nbsp;statement&nbsp;seems&nbsp;local&nbsp;to&nbsp;a&nbsp;few&nbsp;websites.&nbsp;Outside&nbsp;of&nbsp;the&nbsp;proxy,&nbsp;those&nbsp;websites&nbsp;quite&nbsp;quickly&nbsp;as&nbsp;is&nbsp;expected.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;Any&nbsp;thoughts&nbsp;on&nbsp;where&nbsp;to&nbsp;look&nbsp;?&nbsp;&nbsp;other&nbsp;bits&nbsp;and&nbsp;pieces&nbsp;I&nbsp;could&nbsp;check&nbsp;?&nbsp;&nbsp;I&nbsp;have&nbsp;jumbo&nbsp;frames&nbsp;enabled&nbsp;(9000&nbsp;bytes)&nbsp;but&nbsp;am&nbsp;running&nbsp;the&nbsp;proxies&nbsp;at&nbsp;L2&nbsp;1500&nbsp;MTU.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;-Ahmad&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:.25in&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
