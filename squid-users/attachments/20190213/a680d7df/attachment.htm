<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Exchange&nbsp;Server&quot;&gt;<br>
&lt;!--&nbsp;converted&nbsp;from&nbsp;text&nbsp;--&gt;&lt;style&gt;&lt;!--&nbsp;.EmailQuote&nbsp;{&nbsp;margin-left:&nbsp;1pt;&nbsp;padding-left:&nbsp;4pt;&nbsp;border-left:&nbsp;#800000&nbsp;2px&nbsp;solid;&nbsp;}&nbsp;--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;style=&quot;&quot;&gt;<br>
&lt;!--<br>
p<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-top:0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:0}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;id=&quot;x_divtagdefaultwrapper&quot;&nbsp;dir=&quot;ltr&quot;&nbsp;style=&quot;font-size:12pt;&nbsp;color:#000000;&nbsp;font-family:Calibri,Helvetica,sans-serif&quot;&gt;<br>
&lt;p&gt;Many&nbsp;thanks&nbsp;for&nbsp;your&nbsp;help.&nbsp;I&nbsp;could&nbsp;have&nbsp;squid&nbsp;compiled.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;Squid&nbsp;was&nbsp;unable&nbsp;to&nbsp;find&nbsp;the&nbsp;OpenSSL&nbsp;installation&nbsp;because&nbsp;I&nbsp;didn't&nbsp;set&nbsp;the&nbsp;&quot;--prefix&quot;&nbsp;flag&nbsp;when&nbsp;I&nbsp;compiled&nbsp;OpenSSL.&nbsp;Once&nbsp;I&nbsp;set&nbsp;it&nbsp;with&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;&quot;--openssldir&quot;&nbsp;squid&nbsp;compilation&nbsp;worked.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;I'm&nbsp;using&nbsp;CentOS&nbsp;7&nbsp;and&nbsp;OpenSSL&nbsp;1.0.2&nbsp;are&nbsp;installed.&nbsp;It&nbsp;explains&nbsp;why&nbsp;the&nbsp;squid&nbsp;compilation&nbsp;with&nbsp;OpenSSL&nbsp;1.0.2&nbsp;worked&nbsp;by&nbsp;&quot;magic&quot;&nbsp;without&nbsp;&quot;--prefix&quot;.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;Yann&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;hr&nbsp;tabindex=&quot;-1&quot;&nbsp;style=&quot;display:inline-block;&nbsp;width:98%&quot;&gt;<br>
&lt;div&nbsp;id=&quot;x_divRplyFwdMsg&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&nbsp;color=&quot;#000000&quot;&nbsp;style=&quot;font-size:11pt&quot;&gt;&lt;b&gt;De&nbsp;:&lt;/b&gt;&nbsp;squid-users&nbsp;&lt;squid-users-bounces@lists.squid-cache.org&gt;&nbsp;de&nbsp;la&nbsp;part&nbsp;de&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;br&gt;<br>
&lt;b&gt;Envoyé&nbsp;:&lt;/b&gt;&nbsp;mercredi,&nbsp;13&nbsp;février&nbsp;2019&nbsp;12:27:25&lt;br&gt;<br>
&lt;b&gt;À&nbsp;:&lt;/b&gt;&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;b&gt;Objet&nbsp;:&lt;/b&gt;&nbsp;Re:&nbsp;[squid-users]&nbsp;Compiling&nbsp;with&nbsp;OpenSSL&nbsp;1.1&#43;&lt;/font&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10pt;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;PlainText&quot;&gt;On&nbsp;13/02/19&nbsp;10:26&nbsp;pm,&nbsp;Santschi&nbsp;Yann&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello&nbsp;everybody,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;compile&nbsp;Squid&nbsp;4.4&nbsp;with&nbsp;OpenSSL&nbsp;1.1.1a&nbsp;and&nbsp;I'm&nbsp;getting&lt;br&gt;<br>
&gt;&nbsp;compilation&nbsp;errors&nbsp;like&nbsp;this&nbsp;one&nbsp;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;In&nbsp;file&nbsp;included&nbsp;from&nbsp;../../src/security/Context.h:15:0,&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;../../src/security/forward.h:13,&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;../../src/SquidConfig.h:21,&lt;br&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;old_api.cc:24:&lt;br&gt;<br>
&gt;&nbsp;../../compat/openssl.h:121:2:&nbsp;error:&nbsp;#error&nbsp;missing&nbsp;both&nbsp;OpenSSL&nbsp;API&lt;br&gt;<br>
&gt;&nbsp;features&nbsp;EVP_PKEY_up_ref&nbsp;(v1.1)&nbsp;and&nbsp;CRYPTO_LOCK_EVP_PKEY&nbsp;(v1.0)&lt;br&gt;<br>
&gt;&nbsp;&nbsp;#error&nbsp;missing&nbsp;both&nbsp;OpenSSL&nbsp;API&nbsp;features&nbsp;EVP_PKEY_up_ref&nbsp;(v1.1)&nbsp;and&lt;br&gt;<br>
&gt;&nbsp;CRYPTO_LOCK_EVP_PKEY&nbsp;(v1.0)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Squid&nbsp;is&nbsp;not&nbsp;able&nbsp;to&nbsp;find&nbsp;your&nbsp;OpenSSL&nbsp;libcrypto&nbsp;installation.&nbsp;Neither&lt;br&gt;<br>
1.0&nbsp;nor&nbsp;1.1&nbsp;version&nbsp;headers&nbsp;are&nbsp;available&nbsp;to&nbsp;the&nbsp;compiler.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;config.log&nbsp;file&nbsp;generated&nbsp;during&nbsp;the&nbsp;./configure&nbsp;build&nbsp;stage&nbsp;should&lt;br&gt;<br>
contain&nbsp;hints&nbsp;about&nbsp;why&nbsp;that&nbsp;is.&nbsp;It&nbsp;should&nbsp;really&nbsp;have&nbsp;existed&nbsp;with&nbsp;an&lt;br&gt;<br>
error&nbsp;when&nbsp;detecting&nbsp;the&nbsp;library&nbsp;files,&nbsp;but&nbsp;may&nbsp;not&nbsp;have&nbsp;if&nbsp;you&nbsp;have&lt;br&gt;<br>
some&nbsp;other&nbsp;version&nbsp;of&nbsp;libssl&nbsp;or&nbsp;libcrypto&nbsp;or&nbsp;derivatives&nbsp;such&nbsp;as&lt;br&gt;<br>
libressl&nbsp;installed&nbsp;on&nbsp;the&nbsp;build&nbsp;machine&nbsp;in&nbsp;the&nbsp;usual&nbsp;(FHS)&nbsp;location&nbsp;for&lt;br&gt;<br>
such&nbsp;things.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;have&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;--with-openssl=/usr/local/ssl-1.1.1a/&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;please&nbsp;check&nbsp;that&nbsp;the&nbsp;libssl&nbsp;and&nbsp;libcrypto&nbsp;library&nbsp;and&nbsp;header&lt;br&gt;<br>
includes&nbsp;have&nbsp;been&nbsp;successfully&nbsp;*installed*&nbsp;at&nbsp;that&nbsp;location.&nbsp;Simply&lt;br&gt;<br>
expanding&nbsp;the&nbsp;library&nbsp;source&nbsp;code&nbsp;to&nbsp;there&nbsp;is&nbsp;not&nbsp;installation&nbsp;-&nbsp;this&nbsp;is&lt;br&gt;<br>
a&nbsp;common&nbsp;mistake,&nbsp;it&nbsp;has&nbsp;to&nbsp;actually&nbsp;be&nbsp;built&nbsp;and&nbsp;installed&nbsp;at&nbsp;the&nbsp;path&lt;br&gt;<br>
you&nbsp;are&nbsp;telling&nbsp;the&nbsp;Squid&nbsp;compile&nbsp;system&nbsp;to&nbsp;use.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;If&nbsp;I&nbsp;compile&nbsp;with&nbsp;the&nbsp;deprecated&nbsp;OpenSSL&nbsp;1.0.2&nbsp;branch&nbsp;it&nbsp;works&nbsp;but&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;don't&nbsp;want&nbsp;to&nbsp;use&nbsp;this&nbsp;branch.&nbsp;My&nbsp;goal&nbsp;is&nbsp;to&nbsp;offload&nbsp;SSL-Bump&nbsp;with&lt;br&gt;<br>
&gt;&nbsp;hardware&nbsp;that&nbsp;needs&nbsp;OpenSSL&nbsp;1.1.1.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I'm&nbsp;looking&nbsp;for&nbsp;a&nbsp;solution&nbsp;for&nbsp;a&nbsp;couple&nbsp;of&nbsp;days&nbsp;and&nbsp;I&nbsp;found&nbsp;absolutely&lt;br&gt;<br>
&gt;&nbsp;nothing&nbsp;that&nbsp;helps&nbsp;in&nbsp;Squid&nbsp;documentation,&nbsp;source&nbsp;code&nbsp;and&nbsp;Google.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;According&nbsp;to&nbsp;the&nbsp;&quot;CompilingSquid&quot;&nbsp;FAQ&nbsp;it&nbsp;should&nbsp;be&nbsp;feasible&nbsp;with&lt;br&gt;<br>
&gt;&nbsp;Squid-4.&nbsp;Page&nbsp;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/SquidFaq/CompilingSquid&quot;&gt;https://wiki.squid-cache.org/SquidFaq/CompilingSquid&lt;/a&gt;&nbsp;says&lt;br&gt;<br>
&gt;&nbsp;following&nbsp;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;However,&nbsp;please&nbsp;note&nbsp;that&nbsp;Squid-3.5&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Squid-3.5&quot;&gt;https://wiki.squid-cache.org/Squid-3.5&lt;/a&gt;&gt;&nbsp;is&nbsp;not&nbsp;compatible&nbsp;with&nbsp;OpenSSL&lt;br&gt;<br>
&gt;&nbsp;v1.1&#43;.&nbsp;As&nbsp;of&nbsp;Debian&nbsp;Squeeze,&nbsp;or&nbsp;Ubuntu&nbsp;Zesty&nbsp;the&nbsp;*libssl1.0-dev*&nbsp;package&lt;br&gt;<br>
&gt;&nbsp;must&nbsp;be&nbsp;used&nbsp;instead.&nbsp;This&nbsp;is&nbsp;resolved&nbsp;in&nbsp;the&nbsp;Squid-4&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Squid-4&quot;&gt;https://wiki.squid-cache.org/Squid-4&lt;/a&gt;&gt;&nbsp;packages.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;you&nbsp;are&nbsp;quoting&nbsp;the&nbsp;Debian&nbsp;and&nbsp;Ubuntu&nbsp;statements,&nbsp;are&nbsp;we&nbsp;to&nbsp;assume&lt;br&gt;<br>
that&nbsp;you&nbsp;are&nbsp;using&nbsp;one&nbsp;of&nbsp;those&nbsp;OS?&lt;br&gt;<br>
&nbsp;If&nbsp;so,&nbsp;why&nbsp;not&nbsp;use&nbsp;the&nbsp;Debian&nbsp;Buster&nbsp;or&nbsp;Ubuntu&nbsp;Cosmic&nbsp;libssl-dev&lt;br&gt;<br>
package&nbsp;which&nbsp;is&nbsp;currently&nbsp;already&nbsp;at&nbsp;v1.1.1&nbsp;?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;configure&nbsp;script&nbsp;is&nbsp;run&nbsp;with&nbsp;following&nbsp;parameters&nbsp;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;./configure&nbsp;LDFLAGS=-ldl&nbsp;--prefix=/usr&nbsp;--includedir=/usr/include&lt;br&gt;<br>
&gt;&nbsp;--datadir=/usr/share&nbsp;--bindir=/usr/sbin&nbsp;--libexecdir=/usr/lib/squid&lt;br&gt;<br>
&gt;&nbsp;-localstatedir=/var&nbsp;--sysconfdir=/etc/squid&nbsp;--with-default-user=squid&lt;br&gt;<br>
&gt;&nbsp;--with-openssl=/usr/local/ssl-1.1.1a/&nbsp;--enable-ssl&nbsp;--enable-ssl-crtd&lt;br&gt;<br>
&gt;&nbsp;--enable-linux-netfilter&nbsp;--enable-snmp&nbsp;--enable-useragent-log&lt;br&gt;<br>
&gt;&nbsp;--enable-referer-log&nbsp;--enable-cachemgr&nbsp;--enable-truncate&lt;br&gt;<br>
&gt;&nbsp;--enable-underscores&nbsp;--enable-stacktrace&nbsp;--enable-async-io=160&lt;br&gt;<br>
&gt;&nbsp;--enable-poll&nbsp;--enable-icmp&nbsp;--enable-ipfw-transparent&lt;br&gt;<br>
&gt;&nbsp;--enable-forw-via-db&nbsp;--enable-cache-digests&nbsp;--with-included-ltdl&lt;br&gt;<br>
&gt;&nbsp;--enable-ltdl-convenience&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;can&nbsp;spare&nbsp;some&nbsp;time&nbsp;please&nbsp;also&nbsp;run&nbsp;&quot;./configure&nbsp;--help&quot;&nbsp;and&lt;br&gt;<br>
remove&nbsp;the&nbsp;options&nbsp;from&nbsp;the&nbsp;above&nbsp;set&nbsp;which&nbsp;do&nbsp;not&nbsp;exist.&nbsp;At&nbsp;least&nbsp;the&lt;br&gt;<br>
--enable-ssl&nbsp;and&nbsp;log&nbsp;ones&nbsp;are&nbsp;non-existing.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
squid-users@lists.squid-cache.org&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
