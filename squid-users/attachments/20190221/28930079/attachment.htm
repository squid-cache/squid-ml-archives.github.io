<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;been&nbsp;trying&nbsp;to&nbsp;make&nbsp;websockets work&nbsp;over&nbsp;HTTPS&nbsp;but&nbsp;so&nbsp;far&nbsp;I&nbsp;haven&#39;t&nbsp;been&nbsp;able&nbsp;to.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;trying&nbsp;the&nbsp;following&nbsp;websites&nbsp;that&nbsp;use&nbsp;websockets&nbsp;and&nbsp;none&nbsp;of&nbsp;them&nbsp;work:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://speedtest.net&quot;&gt;speedtest.net&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://web.whatsapp.com&quot;&gt;web.whatsapp.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://slack.com/help/test&quot;&gt;https://slack.com/help/test&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;explicitly&nbsp;splice&nbsp;those&nbsp;domain&nbsp;names&nbsp;in&nbsp;squid.conf&nbsp;they&nbsp;work&nbsp;fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;a&nbsp;transparent&nbsp;HTTPS&nbsp;proxy.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Below&nbsp;is&nbsp;my&nbsp;configuration:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=============&lt;/div&gt;&lt;div&gt;&lt;div&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;/div&gt;&lt;div&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/div&gt;&lt;div&gt;log_mime_hdrs&nbsp;on&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;manager&lt;/div&gt;&lt;div&gt;https_port&nbsp;3128&nbsp;intercept&nbsp;ssl-bump&nbsp;cert=/etc/squid/ssl_cert/proxyCA.pem&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=256KB&lt;/div&gt;&lt;div&gt;sslcrtd_program&nbsp;/usr/lib64/squid/security_file_certgen&nbsp;-s&nbsp;/var/spool/squid/ssl_db&nbsp;-M&nbsp;4MB&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;serverIsws&nbsp;ssl::server_name_regex&nbsp;speedtest\.net$&lt;/div&gt;&lt;div&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;splice&nbsp;serverIsws&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;bump&nbsp;!serverIsws&nbsp;all&lt;/div&gt;&lt;div&gt;on_unsupported_protocol&nbsp;tunnel&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;debug_options&nbsp;ALL,1&nbsp;26,1&nbsp;33,9&nbsp;83,9&nbsp;28,9&nbsp;81,9&nbsp;11,2&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localnet&lt;/div&gt;&lt;div&gt;http_access&nbsp;allow&nbsp;localhost&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;http_port&nbsp;3129&nbsp;intercept&lt;/div&gt;&lt;div&gt;http_port&nbsp;3130&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;coredump_dir&nbsp;/var/spool/squid&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^ftp: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1440 &nbsp; &nbsp;20% &nbsp; &nbsp; 10080&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;^gopher: &nbsp; &nbsp; &nbsp; &nbsp;1440 &nbsp; &nbsp;0% &nbsp; &nbsp; &nbsp;1440&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0 &nbsp; &nbsp; 0% &nbsp; &nbsp; &nbsp;0&lt;/div&gt;&lt;div&gt;refresh_pattern&nbsp;. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 20% &nbsp; &nbsp; 4320&lt;/div&gt;&lt;/div&gt;&lt;div&gt;===================&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;logs&nbsp;I&nbsp;see&nbsp;400&nbsp;Bad&nbsp;request&nbsp;:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;==================================================&lt;/div&gt;&lt;div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;11,2|&nbsp;http.cc(723)&nbsp;processReplyHeader:&nbsp;HTTP&nbsp;Server&nbsp;RESPONSE:&lt;/div&gt;&lt;div&gt;---------&lt;/div&gt;&lt;div&gt;HTTP/1.1&nbsp;400&nbsp;Bad&nbsp;Request&lt;/div&gt;&lt;div&gt;Date:&nbsp;Thu,&nbsp;21&nbsp;Feb&nbsp;2019&nbsp;20:46:34&nbsp;GMT&lt;/div&gt;&lt;div&gt;Transfer-Encoding:&nbsp;chunked&lt;/div&gt;&lt;div&gt;Connection:&nbsp;keep-alive&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;----------&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;ctx:&nbsp;exit&nbsp;level &nbsp;0&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;83,3|&nbsp;AccessCheck.cc(42)&nbsp;Start:&nbsp;adaptation&nbsp;off,&nbsp;skipping&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;33,5|&nbsp;store_client.cc(319)&nbsp;doCopy:&nbsp;store_client::doCopy:&nbsp;co:&nbsp;0,&nbsp;hi:&nbsp;117&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;33,3|&nbsp;Pipeline.cc(35)&nbsp;front:&nbsp;Pipeline&nbsp;0x1c47830&nbsp;front&nbsp;0x17948a0*3&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;33,3|&nbsp;Pipeline.cc(35)&nbsp;front:&nbsp;Pipeline&nbsp;0x1c47830&nbsp;front&nbsp;0x17948a0*3&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.004&nbsp;kid1|&nbsp;11,2|&nbsp;Stream.cc(266)&nbsp;sendStartOfMessage:&nbsp;HTTP&nbsp;Client&nbsp;local=&lt;a&nbsp;href=&quot;http://31.13.67.52:443&quot;&gt;31.13.67.52:443&lt;/a&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://192.168.112.143:46408&quot;&gt;192.168.112.143:46408&lt;/a&gt;&nbsp;FD&nbsp;14&nbsp;flags=33&lt;/div&gt;&lt;div&gt;2019/02/21&nbsp;12:52:38.005&nbsp;kid1|&nbsp;11,2|&nbsp;Stream.cc(267)&nbsp;sendStartOfMessage:&nbsp;HTTP&nbsp;Client&nbsp;REPLY:&lt;/div&gt;&lt;div&gt;---------&lt;/div&gt;&lt;div&gt;HTTP/1.1&nbsp;400&nbsp;Bad&nbsp;Request&lt;/div&gt;&lt;div&gt;Date:&nbsp;Thu,&nbsp;21&nbsp;Feb&nbsp;2019&nbsp;20:46:34&nbsp;GMT&lt;/div&gt;&lt;div&gt;X-Cache:&nbsp;MISS&nbsp;from&nbsp;squidserver&lt;/div&gt;&lt;div&gt;X-Cache-Lookup:&nbsp;MISS&nbsp;from&nbsp;squidserver:3130&lt;/div&gt;&lt;div&gt;Transfer-Encoding:&nbsp;chunked&lt;/div&gt;&lt;div&gt;Via:&nbsp;1.1&nbsp;squidserver&nbsp;(squid/4.1)&lt;/div&gt;&lt;div&gt;Connection:&nbsp;keep-alive&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;----------&lt;/div&gt;&lt;/div&gt;&lt;div&gt;============================================&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;not&nbsp;interested&nbsp;in&nbsp;bumping&nbsp;the&nbsp;websockets,&nbsp;I&nbsp;just&nbsp;want&nbsp;HTTPS&nbsp;interception&nbsp;to&nbsp;work&nbsp;as&nbsp;well&nbsp;as&nbsp;websockets.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;help&nbsp;is&nbsp;welcomed.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
