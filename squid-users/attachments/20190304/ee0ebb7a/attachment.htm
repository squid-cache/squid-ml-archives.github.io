<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&gt;&nbsp;On&nbsp;4/03/19&nbsp;5:39&nbsp;pm,&nbsp;George&nbsp;Xie&nbsp;wrote:&lt;br&gt;&gt;&nbsp;&gt;&nbsp;hi&nbsp;all:&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Squid&nbsp;version:&nbsp;3.5.23-5+deb9u1&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Docker&nbsp;version&nbsp;18.09.3,&nbsp;build&nbsp;774a1f4&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Linux&nbsp;instance-4&nbsp;4.9.0-8-amd64&nbsp;#1&nbsp;SMP&nbsp;Debian&nbsp;4.9.130-2&nbsp;(2018-10-27)&lt;br&gt;&gt;&nbsp;&gt;&nbsp;x86_64&nbsp;GNU/Linux&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;have&nbsp;the&nbsp;following&nbsp;squid&nbsp;config:&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;http_port&nbsp;&lt;a&nbsp;href=&quot;http://127.0.0.1:3128&quot;&gt;127.0.0.1:3128&lt;/a&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;cache&nbsp;deny&nbsp;all&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;access_log&nbsp;none&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;What&nbsp;is&nbsp;it&nbsp;exactly&nbsp;that&nbsp;you&nbsp;think&nbsp;this&nbsp;is&nbsp;doing&nbsp;in&nbsp;regards&nbsp;to&nbsp;Squid&lt;br&gt;&gt;&nbsp;memory&nbsp;needs?&lt;br&gt;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sorry,&nbsp;I&nbsp;don&#39;t&nbsp;get&nbsp;your&nbsp;quest.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;runs&nbsp;in&nbsp;a&nbsp;container&nbsp;with&nbsp;following&nbsp;Dockerfile:&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;FROM&nbsp;debian:9&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;RUN&nbsp;apt&nbsp;update&nbsp;&amp;&amp;&nbsp;\&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;apt&nbsp;install&nbsp;--yes&nbsp;squid&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;the&nbsp;total&nbsp;memory&nbsp;of&nbsp;the&nbsp;host&nbsp;server&nbsp;is&nbsp;very&nbsp;low,&nbsp;only&nbsp;592m,&nbsp;about&nbsp;370m&lt;br&gt;&gt;&nbsp;&gt;&nbsp;free&nbsp;memory.&lt;br&gt;&gt;&nbsp;&gt;&nbsp;if&nbsp;I&nbsp;start&nbsp;squid&nbsp;in&nbsp;the&nbsp;container,&nbsp;squid&nbsp;will&nbsp;abort&nbsp;immediately.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;error&nbsp;messages&nbsp;in&nbsp;/var/log/squid/cache.log:&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;FATAL:&nbsp;xcalloc:&nbsp;Unable&nbsp;to&nbsp;allocate&nbsp;1048576&nbsp;blocks&nbsp;of&nbsp;392&nbsp;bytes!&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;Squid&nbsp;Cache&nbsp;(Version&nbsp;3.5.23):&nbsp;Terminated&nbsp;abnormally.&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;CPU&nbsp;Usage:&nbsp;0.012&nbsp;seconds&nbsp;=&nbsp;0.004&nbsp;user&nbsp;+&nbsp;0.008&nbsp;sys&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;Maximum&nbsp;Resident&nbsp;Size:&nbsp;47168&nbsp;KB&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;error&nbsp;message&nbsp;captured&nbsp;with&nbsp;strace&nbsp;-f&nbsp;-e&nbsp;trace=memory:&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;[pid&nbsp; &nbsp;920]&nbsp;mmap(NULL,&nbsp;411176960,&nbsp;PROT_READ|PROT_WRITE,&lt;br&gt;&gt;&nbsp;&gt;&nbsp; &nbsp; &nbsp;MAP_PRIVATE|MAP_ANONYMOUS,&nbsp;-1,&nbsp;0)&nbsp;=&nbsp;-1&nbsp;ENOMEM&nbsp;(Cannot&nbsp;allocate&nbsp;memory)&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;it&nbsp;appears&nbsp;that&nbsp;squid&nbsp;(or&nbsp;glibc)&nbsp;tries&nbsp;to&nbsp;allocate&nbsp;392m&nbsp;memory,&nbsp;which&nbsp;is&lt;br&gt;&gt;&nbsp;&gt;&nbsp;larger&nbsp;than&nbsp;host&nbsp;free&nbsp;memory&nbsp;370m.&lt;br&gt;&gt;&nbsp;&gt;&nbsp;but&nbsp;I&nbsp;guess&nbsp;squid&nbsp;don&#39;t&nbsp;need&nbsp;that&nbsp;much&nbsp;memory,&nbsp;I&nbsp;have&nbsp;another&nbsp;running&lt;br&gt;&gt;&nbsp;&gt;&nbsp;squid&nbsp;instance,&nbsp;which&nbsp;only&nbsp;uses&nbsp;&lt;&nbsp;200m&nbsp;memory.&lt;br&gt;&gt;&nbsp;No&nbsp;doubt&nbsp;it&nbsp;is&nbsp;configured&nbsp;to&nbsp;use&nbsp;less&nbsp;memory.&nbsp;For&nbsp;example&nbsp;by&nbsp;reducing&lt;br&gt;&gt;&nbsp;the&nbsp;default&nbsp;memory&nbsp;cache&nbsp;size.&lt;br&gt;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;that&nbsp;running&nbsp;squid&nbsp;instance&nbsp;has&nbsp;the&nbsp;same&nbsp;config.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&gt;&nbsp;&gt;&nbsp;the&nbsp;oddest&nbsp;thing&nbsp;is&nbsp;if&nbsp;I&nbsp;run&nbsp;squid&nbsp;on&nbsp;the&nbsp;host&nbsp;(also&nbsp;Debian&nbsp;9)&nbsp;directly,&lt;br&gt;&gt;&nbsp;&gt;&nbsp;not&nbsp;in&nbsp;the&nbsp;container,&nbsp;squid&nbsp;could&nbsp;start&nbsp;and&nbsp;run&nbsp;as&nbsp;normal.&lt;br&gt;&gt;&nbsp;&gt;&lt;br&gt;&gt;&nbsp;Linux&nbsp;typically&nbsp;allows&nbsp;RAM&nbsp;over-allocation.&nbsp;Which&nbsp;works&nbsp;okay&nbsp;so&nbsp;long&nbsp;as&lt;br&gt;&gt;&nbsp;there&nbsp;is&nbsp;sufficient&nbsp;swap&nbsp;space&nbsp;and&nbsp;there&nbsp;is&nbsp;time&nbsp;between&nbsp;memory&nbsp;usage&nbsp;to&lt;br&gt;&gt;&nbsp;do&nbsp;the&nbsp;swap&nbsp;in/out&nbsp;process.&lt;br&gt;&gt;&nbsp;Amos&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;swap&nbsp;is&nbsp;disabled&nbsp;in&nbsp;the&nbsp;host&nbsp;server,&nbsp;so&nbsp;do&nbsp;in&nbsp;the&nbsp;container. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;after&nbsp;all,&nbsp;I&nbsp;wonder&nbsp;why&nbsp;squid&nbsp;would&nbsp;try&nbsp;to&nbsp;claim 392m&nbsp;memory&nbsp;if&nbsp;don&#39;t&nbsp;need&nbsp;that&nbsp;much.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;XieShi&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
