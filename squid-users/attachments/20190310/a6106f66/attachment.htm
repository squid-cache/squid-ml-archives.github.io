<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;05.03.19&nbsp;06:13,&nbsp;Amos&nbsp;Jeffries&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:d093dc56-8064-f94e-a867-7ad6626e4570@treenet.co.nz&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;On&nbsp;5/03/19&nbsp;12:10&nbsp;pm,&nbsp;steven&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;Ah&nbsp;thank&nbsp;you&nbsp;for&nbsp;that&nbsp;clarification,&nbsp;the&nbsp;python&nbsp;icap&nbsp;servers&nbsp;i&nbsp;tested&nbsp;so<br>
far&nbsp;are&nbsp;not&nbsp;very&nbsp;promissing&nbsp;but&nbsp;at&nbsp;least&nbsp;theres&nbsp;a&nbsp;connection&nbsp;now.<br>
<br>
sadly&nbsp;squid&nbsp;does&nbsp;not&nbsp;allow&nbsp;http&nbsp;access&nbsp;at&nbsp;all,&nbsp;only&nbsp;https&nbsp;access.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;<br>
Er,&nbsp;that&nbsp;would&nbsp;be&nbsp;because&nbsp;the&nbsp;only&nbsp;http_port&nbsp;you&nbsp;have&nbsp;is&nbsp;configured&nbsp;with<br>
'accl'&nbsp;-&nbsp;making&nbsp;it&nbsp;a&nbsp;reverse-proxy&nbsp;port.&nbsp;But&nbsp;you&nbsp;do&nbsp;not&nbsp;have&nbsp;any<br>
cache_peer&nbsp;configured&nbsp;to&nbsp;handle&nbsp;that&nbsp;type&nbsp;of&nbsp;traffic.<br>
<br>
<br>
So,&nbsp;is&nbsp;there&nbsp;any&nbsp;particular&nbsp;reason&nbsp;you&nbsp;have&nbsp;that&nbsp;port&nbsp;receiving&nbsp;'accel'<br>
/&nbsp;reverse-proxy&nbsp;mode&nbsp;traffic?<br>
&nbsp;If&nbsp;not&nbsp;remove&nbsp;that&nbsp;mode&nbsp;flag&nbsp;and&nbsp;things&nbsp;should&nbsp;all&nbsp;work&nbsp;for&nbsp;HTTP&nbsp;too.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;removed&nbsp;the&nbsp;accel&nbsp;mode&nbsp;but&nbsp;still&nbsp;no&nbsp;luck&nbsp;with&nbsp;http,&nbsp;when&nbsp;opening<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;adress:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://squid-web-proxy-cache.1019090.n4.nabble.com/http-port-with-quot-transparent-quot-or-quot-intercept-quot-td4677133.html&quot;&gt;http://squid-web-proxy-cache.1019090.n4.nabble.com/http-port-with-quot-transparent-quot-or-quot-intercept-quot-td4677133.html&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;The&nbsp;following&nbsp;error&nbsp;was&nbsp;encountered&nbsp;while&nbsp;trying&nbsp;to&nbsp;retrieve&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URL:&nbsp;&lt;a<br>
href=&quot;http://squid-web-proxy-cache.1019090.n4.nabble.com/http-port-with-quot-transparent-quot-or-quot-intercept-quot-td4677133.html&quot;&gt;/http-port-with-quot-transparent-quot-or-quot-intercept-quot-td4677133.html&lt;/a&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;invalid&nbsp;url&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;in&nbsp;this&nbsp;tutorial:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.reddit.com/r/sysadmin/comments/a67hly/squid_proxy_a_short_guide_forward_transparent/&quot;&gt;https://www.reddit.com/r/sysadmin/comments/a67hly/squid_proxy_a_short_guide_forward_transparent/&lt;/a&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;the&nbsp;guy&nbsp;uses&nbsp;two&nbsp;ports&nbsp;for&nbsp;http&nbsp;like&nbsp;this:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;s90z9tc-8&nbsp;hGaZWh&quot;&gt;&lt;code&nbsp;class=&quot;s90z9tc-7&nbsp;cMUrmP&quot;&gt;http_port&nbsp;3128<br>
#&nbsp;Listen&nbsp;on&nbsp;this&nbsp;HTTP&nbsp;port,&nbsp;intercepting&nbsp;requests<br>
http_port&nbsp;3129&nbsp;intercept<br>
<br>
and&nbsp;then&nbsp;with&nbsp;iptables&nbsp;he&nbsp;redirects&nbsp;80&nbsp;to&nbsp;port&nbsp;3129<br>
<br>
which&nbsp;does&nbsp;not&nbsp;work&nbsp;here&nbsp;:(<br>
<br>
<br>
export&nbsp;http_proxy=&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://192.168.10.215:3140&quot;&gt;http://192.168.10.215:3140&lt;/a&gt;&nbsp;&amp;&amp;&nbsp;wget&nbsp;google.de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;im&nbsp;using&nbsp;3140&nbsp;as&nbsp;intercept&nbsp;port.&nbsp;config&nbsp;at&nbsp;the&nbsp;end.<br>
<br>
--2019-03-10&nbsp;20:20:56--&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://google.de/&quot;&gt;http://google.de/&lt;/a&gt;<br>
Connecting&nbsp;to&nbsp;192.168.10.215:3140...&nbsp;connected.<br>
Proxy&nbsp;request&nbsp;sent,&nbsp;awaiting&nbsp;response...&nbsp;403&nbsp;Forbidden<br>
2019-03-10&nbsp;20:20:56&nbsp;ERROR&nbsp;403:&nbsp;Forbidden.<br>
<br>
&lt;/code&gt;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;cache.log&nbsp;entry:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;2019/03/10&nbsp;20:16:20&nbsp;kid1|&nbsp;WARNING:&nbsp;Forwarding&nbsp;loop&nbsp;detected&nbsp;for:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GET&nbsp;/&nbsp;HTTP/1.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User-Agent:&nbsp;Wget/1.19.4&nbsp;(linux-gnu)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accept:&nbsp;*/*&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accept-Encoding:&nbsp;identity&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Via:&nbsp;1.1&nbsp;backup&nbsp;(squid/4.4)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache-Control:&nbsp;max-age=259200&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection:&nbsp;keep-alive&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Host:&nbsp;google.de&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;and&nbsp;with:&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;export&nbsp;http_proxy=&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://192.168.10.215:3129&quot;&gt;http://192.168.10.215:3129&lt;/a&gt;&nbsp;&amp;&amp;&nbsp;wget<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;google.de&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;cache&nbsp;.log&nbsp;entry,&nbsp;wget&nbsp;output:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;--2019-03-10&nbsp;20:22:42-- &nbsp;(try:&nbsp;2) &nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://google.de/&quot;&gt;http://google.de/&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connecting&nbsp;to&nbsp;192.168.10.215:3129...&nbsp;connected.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proxy&nbsp;request&nbsp;sent,&nbsp;awaiting&nbsp;response...&nbsp;No&nbsp;data&nbsp;received.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrying.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;why&nbsp;does&nbsp;my&nbsp;client&nbsp;get&nbsp;a&nbsp;403?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;grep&nbsp;-v&nbsp;'#'&nbsp;squid.conf&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_enable&nbsp;off&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_preview_enable&nbsp;off&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_send_client_ip&nbsp;on&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_send_client_username&nbsp;on&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_service&nbsp;service_req&nbsp;reqmod_precache&nbsp;bypass=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap://127.0.0.1:1344/request&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adaptation_access&nbsp;service_req&nbsp;allow&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap_service&nbsp;service_resp&nbsp;respmod_precache&nbsp;bypass=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icap://127.0.0.1:1344/response&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adaptation_access&nbsp;service_resp&nbsp;allow&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;localnet&nbsp;src&nbsp;192.168.10.0/24&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coredump_dir&nbsp;/var/spool/squid&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_pattern&nbsp;^ftp:       &nbsp;1440   &nbsp;20%   &nbsp;10080&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_pattern&nbsp;^gopher:   &nbsp;1440   &nbsp;0%   &nbsp;1440&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0   &nbsp;0%   &nbsp;0&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_pattern&nbsp;.       &nbsp;0   &nbsp;20%   &nbsp;4320&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_port&nbsp;3128&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_port&nbsp;3140&nbsp;intercept&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https_port&nbsp;3129&nbsp;ssl-bump&nbsp;intercept&nbsp;generate-host-certificates=on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;cert=/etc/squid/myCA.pem&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sslcrtd_program&nbsp;/usr/lib/squid/security_file_certgen&nbsp;-s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
