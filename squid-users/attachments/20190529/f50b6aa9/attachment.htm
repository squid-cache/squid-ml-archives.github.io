<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;Verdana;font-size:&nbsp;12.0px;&quot;&gt;&lt;div&gt;Hi&nbsp;All,&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;have&nbsp;Squid&nbsp;3.5.27&nbsp;running&nbsp;on&nbsp;Ubuntu&nbsp;18.04.2,&nbsp;and&nbsp;have&nbsp;been&nbsp;unsuccesfull&nbsp;in&nbsp;being&nbsp;able&nbsp;to&nbsp;authenticate&nbsp;users&nbsp;via&nbsp;ldap&nbsp;(kerberos&nbsp;is&nbsp;working&nbsp;well)&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Currently&nbsp;it&#39;s&nbsp;iphone&nbsp;and&nbsp;android&nbsp;users&nbsp;that&nbsp;are&nbsp;having&nbsp;the&nbsp;issue&nbsp;-&nbsp;all&nbsp;other&nbsp;users&nbsp;are&nbsp;authenticating&nbsp;via&nbsp;kerberos.&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;In&nbsp;squid.conf,&nbsp;I&nbsp;have:&lt;/div&gt;<br>
<br>
&lt;div&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ldap_auth&nbsp;-d&nbsp;-R&nbsp;-b&nbsp;&quot;OU=users,DC=domain,DC=com&quot;&nbsp;-D&nbsp;squid@domain.com&nbsp;-W&nbsp;/etc/squid/ldappass.txt&nbsp;-f&nbsp;sAMAccountName=%s&nbsp;-h&nbsp;dc.domain.com&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;When&nbsp;a&nbsp;user&nbsp;attempts&nbsp;to&nbsp;browse&nbsp;via&nbsp;the&nbsp;proxy,&nbsp;I&nbsp;see&nbsp;in&nbsp;access.log:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;1559096820.116&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;10.99.88.77&nbsp;TCP_DENIED/407&nbsp;2248&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.google.com&lt;/a&gt;&nbsp;-&nbsp;HIER_NONE/-&nbsp;text/html&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;And&nbsp;the&nbsp;user&nbsp;is&nbsp;prompted&nbsp;for&nbsp;a&nbsp;username&nbsp;and&nbsp;password..&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;then&nbsp;see&nbsp;in&nbsp;cache.log:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;basic_ldap_auth.cc(691):&nbsp;pid=32625&nbsp;:user&nbsp;filter&nbsp;&#39;sAMAccountName=username&#39;,&nbsp;searchbase&nbsp;&#39;OU=users,DC=domain,DC=com&#39;&lt;br/&gt;<br>
basic_ldap_auth.cc(746):&nbsp;pid=32625&nbsp;:attempting&nbsp;to&nbsp;authenticate&nbsp;user&nbsp;&#39;CN=Users&nbsp;Fullname,OU=users,DC=domain,DC=com&#39;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;But&nbsp;the&nbsp;user&nbsp;just&nbsp;keeps&nbsp;getting&nbsp;prompted&nbsp;for&nbsp;username&nbsp;and&nbsp;password&nbsp;over&nbsp;and&nbsp;over,&nbsp;and&nbsp;I&nbsp;continue&nbsp;to&nbsp;see:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;1559096820.116&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;10.99.88.77&nbsp;TCP_DENIED/407&nbsp;2248&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.google.com&lt;/a&gt;&nbsp;-&nbsp;HIER_NONE/-&nbsp;text/html&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;If&nbsp;I&nbsp;run&nbsp;the&nbsp;following&nbsp;on&nbsp;the&nbsp;command&nbsp;line,&nbsp;it&nbsp;appears&nbsp;to&nbsp;authenticate&nbsp;correctly:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;/usr/lib/squid/basic_ldap_auth&nbsp;-d&nbsp;-R&nbsp;-b&nbsp;&quot;OU=users,DC=domain,DC=com&quot;&nbsp;-D&nbsp;squid@domain.com&nbsp;-W&nbsp;/etc/squid/ldappass.txt&nbsp;-f&nbsp;sAMAccountName=%s&nbsp;-h&nbsp;dc.domain.com&lt;/div&gt;<br>
<br>
&lt;div&gt;username&nbsp;password&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;basic_ldap_auth.cc(691):&nbsp;pid=32625&nbsp;:user&nbsp;filter&nbsp;&#39;sAMAccountName=username&#39;,&nbsp;searchbase&nbsp;&#39;OU=users,DC=domain,DC=com&#39;&lt;br/&gt;<br>
basic_ldap_auth.cc(746):&nbsp;pid=32625&nbsp;:attempting&nbsp;to&nbsp;authenticate&nbsp;user&nbsp;&#39;CN=Users&nbsp;Fullname,OU=users,DC=domain,DC=com&#39;&lt;/div&gt;<br>
<br>
&lt;div&gt;OK&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;What&nbsp;else&nbsp;can&nbsp;I&nbsp;do&nbsp;for&nbsp;troubleshooting?&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>
<br>

</tt>
