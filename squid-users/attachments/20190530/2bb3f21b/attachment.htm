<tt>
&lt;html&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;15&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:12.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#0563C1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#954F72;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
p.MsoListParagraph,&nbsp;li.MsoListParagraph,&nbsp;div.MsoListParagraph<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:34;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-top:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-right:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-left:.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:12.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-compose;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,sans-serif;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
/*&nbsp;List&nbsp;Definitions&nbsp;*/<br>
@list&nbsp;l0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-list-id:1665625480;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-type:hybrid;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-template-ids:715555106&nbsp;67698703&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715;}<br>
@list&nbsp;l0:level1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
@list&nbsp;l0:level4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
@list&nbsp;l0:level7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:alpha-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
@list&nbsp;l0:level9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-number-format:roman-lower;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:right;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-9.0pt;}<br>
ol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
ul<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;#0563C1&quot;&nbsp;vlink=&quot;#954F72&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;I&nbsp;have&nbsp;the&nbsp;following&nbsp;for&nbsp;each&nbsp;of&nbsp;my&nbsp;rules&nbsp;(except&nbsp;for&nbsp;my&nbsp;last&nbsp;rule:&nbsp;http_access&nbsp;deny&nbsp;all&nbsp;rule):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;http_access&nbsp;allow&nbsp;AllowedSrc&nbsp;AllowedInternalDst&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;note&nbsp;ruleid&nbsp;ACCESS2INTERNAL&nbsp;&nbsp;AllowedSrc&nbsp;AllowedInternalDst&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;note&nbsp;ruletype&nbsp;ALLOW&nbsp;AllowedSrc&nbsp;AllowedInternalDst&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;I&nbsp;have&nbsp;the&nbsp;following&nbsp;log-format&nbsp;entry&nbsp;used&nbsp;for&nbsp;all&nbsp;logs&nbsp;(note&nbsp;the&nbsp;last&nbsp;two&nbsp;fields&nbsp;now&nbsp;indicate&nbsp;to&nbsp;which&nbsp;rule&nbsp;I&nbsp;matched&nbsp;and&nbsp;the&nbsp;expected&nbsp;behavior):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;logformat&nbsp;MyLogFormat&nbsp;&nbsp;---&gt;&nbsp;local_time=&quot;[%tl]&quot;&nbsp;squid_service=%{service}note&nbsp;squid_status=%Ss&nbsp;squid_hierarchy_status=%Sh&nbsp;**&nbsp;haproxy_id=%{X-Request-Id}&gt;h&nbsp;orig_src_ip=%{X-Forwarded-For}&gt;h&nbsp;haproxy_egress_ip=%&gt;a<br>
&nbsp;haproxy_port=%&gt;p&nbsp;squid_ingress_port=%&gt;lp&nbsp;squid_egress_port=%&lt;lp&nbsp;dst_ip=%&lt;a&nbsp;dst_host=%&lt;A&nbsp;dst_port=%&lt;p&nbsp;ident_username=%[ui&nbsp;username=%[un&nbsp;request_method=%rm&nbsp;request=&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;status_code_from_server=%&gt;Hs&nbsp;status_code_to_client=%&lt;Hs&nbsp;referer=&quot;%{Referer}&gt;h&quot;<br>
&nbsp;user_agent=&quot;%{User-Agent}&gt;h&quot;&nbsp;protocol_version=%rv&nbsp;**&nbsp;dns_response_time=%dt&nbsp;response_time=%tr&nbsp;mime_type=%mt&nbsp;*XFER*&nbsp;&nbsp;total_request_size=%&gt;st&nbsp;total_reply_size=%&lt;st&nbsp;**&nbsp;%{src_zone}note&nbsp;%{dst_zone}note&nbsp;%{method_category}note&nbsp;%{dst_category}note&nbsp;%{file_upload}note<br>
&nbsp;**&nbsp;REQUEST&nbsp;HEADERS&nbsp;%&gt;h&nbsp;***&nbsp;RESPONSE&nbsp;HEADERS&nbsp;%&lt;h&nbsp;***&nbsp;tag_returned=%et&nbsp;tag_string=&quot;%ea&quot;&nbsp;previous_hop_mac=%&gt;eui&nbsp;peer_response_time=%&lt;pt&nbsp;total_response_time=%&lt;tt&nbsp;*SSL*&nbsp;src_ssl_negotiated_version=%ssl::&gt;negotiated_version&nbsp;dst_ssl_negotiated_version=%ssl::&lt;negotiated_version<br>
&nbsp;src_tls_hello_version=%ssl::&gt;received_hello_version&nbsp;&nbsp;dst_tls_hello_version=%ssl::&lt;received_hello_version&nbsp;src_tls_max_version=%ssl::&gt;received_supported_version&nbsp;dst_tls_max_version=%ssl::&lt;received_supported_version&nbsp;src_tls_cipher=%ssl::&gt;negotiated_cipher&nbsp;dst_tls_cipher=%ssl::&lt;negotiated_cipher<br>
&nbsp;ssl_bump=%&lt;bs&nbsp;ssl_bump_mode=%ssl::bump_mode&nbsp;ssl_sni=%ssl::&gt;sni&nbsp;src_cert_subject=&quot;%ssl::&gt;cert_subject&quot;&nbsp;src_cert_issuer=&quot;%ssl::&gt;cert_issuer&quot;&nbsp;dst_cert_subject=&quot;%ssl::&lt;cert_subject&quot;&nbsp;dst_cert_issuer=&quot;%ssl::&lt;cert_issuer&quot;&nbsp;cert_errors=&quot;%ssl::&lt;cert_errors&quot;&nbsp;***&nbsp;error_page_presented=%err_code<br>
&nbsp;err_detail=&quot;%err_detail&quot;&nbsp;&nbsp;rule_id=%{ruleid}note&nbsp;rule_type=%{ruletype}note&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;So&nbsp;when&nbsp;traffic&nbsp;is&nbsp;allowed,&nbsp;everything&nbsp;works&nbsp;as&nbsp;expected&nbsp;(Note&nbsp;the&nbsp;orig_src_ip,&nbsp;rule_id,&nbsp;rule,&nbsp;type&nbsp;are&nbsp;all&nbsp;populated):&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;---&gt;&nbsp;local_time=&quot;[30/May/2019:07:25:12&nbsp;-0400]&quot;&nbsp;squid_service=explicit&nbsp;squid_status=TCP_TUNNEL&nbsp;squid_hierarchy_status=HIER_DIRECT&nbsp;**&nbsp;haproxy_id=5CEFBD98_0AFB14CC_0AFB1621_206C_9E79_461F&nbsp;orig_src_ip=10.10.2.24&nbsp;&lt;TRUNCATED&gt;&nbsp;&nbsp;rule_id=&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;<br>
&nbsp;ACCESS2INTERNAL&nbsp;&nbsp;&lt;/span&gt;rule_type=ALLOW&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;When&nbsp;a&nbsp;client&nbsp;is&nbsp;denied,&nbsp;it&nbsp;creates&nbsp;two&nbsp;log&nbsp;entries,&nbsp;each&nbsp;with&nbsp;portion&nbsp;of&nbsp;the&nbsp;logs&nbsp;filled&nbsp;out&nbsp;(i.e.&nbsp;orig_src_ip&nbsp;in&nbsp;the&nbsp;first&nbsp;log,&nbsp;and&nbsp;the&nbsp;requested&nbsp;url&nbsp;and&nbsp;the&nbsp;&nbsp;rule&nbsp;that&nbsp;I&nbsp;expected&nbsp;to&nbsp;match&nbsp;in&nbsp;second&nbsp;log):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;---&gt;&nbsp;local_time=&quot;[30/May/2019:07:20:32&nbsp;-0400]&quot;&lt;/b&gt;&nbsp;squid_service=explicit&nbsp;squid_status=TCP_DENIED&nbsp;squid_hierarchy_status=HIER_NONE&nbsp;**&nbsp;haproxy_id=5CEFBC7F_0AFB14CC_0AFB1621_206C_9DBE_461F&nbsp;orig_src_ip=10.10.2.24&nbsp;&lt;TRUNCATED&gt;&nbsp;error_page_presented=ERR_ACCESS_DENIED<br>
&nbsp;err_detail=&quot;-&quot;&nbsp;&nbsp;rule_id=-&nbsp;rule_type=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;---&gt;&nbsp;local_time=&quot;[30/May/2019:07:20:32&nbsp;-0400]&quot;&lt;/b&gt;&nbsp;squid_service=explicit&nbsp;squid_status=NONE&nbsp;squid_hierarchy_status=HIER_NONE&nbsp;**&nbsp;haproxy_id=-&nbsp;orig_src_ip=-&nbsp;&lt;TRUNCATED&gt;&nbsp;&nbsp;request_method=GET&nbsp;request=&quot;GET&nbsp;https://example.org/&nbsp;HTTP/1.1&quot;&nbsp;status_code_from_server=403<br>
&nbsp;status_code_to_client=-&nbsp;&lt;TRUNCATED&gt;&nbsp;error_page_presented=ERR_ACCESS_DENIED&nbsp;err_detail=&quot;-&quot;&nbsp;&nbsp;rule_id=&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;&nbsp;ACCESS2INTERNAL&nbsp;<br>
&lt;/span&gt;rule_type=&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;ALLOW&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;So&nbsp;my&nbsp;questions&nbsp;are&nbsp;these:&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;ol&nbsp;style=&quot;margin-top:0in&quot;&nbsp;start=&quot;1&quot;&nbsp;type=&quot;1&quot;&gt;<br>
&lt;li&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;Is&nbsp;there&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;log&nbsp;which&nbsp;rules&nbsp;a&nbsp;connection&nbsp;matches?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;Why&nbsp;does&nbsp;the&nbsp;denied&nbsp;log&nbsp;twice&nbsp;and&nbsp;not&nbsp;as&nbsp;a&nbsp;single&nbsp;log&nbsp;entry?&nbsp;Why&nbsp;isn't&nbsp;the&nbsp;requested&nbsp;URL&nbsp;logged&nbsp;in&nbsp;the&nbsp;first&nbsp;log&nbsp;entry&nbsp;and&nbsp;then&nbsp;done.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;margin-left:0in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt&quot;&gt;Why&nbsp;do&nbsp;I&nbsp;see&nbsp;two&nbsp;squid_status&nbsp;types&nbsp;on&nbsp;the&nbsp;denied&nbsp;(TCP_DENIED&nbsp;and&nbsp;NONE)?&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
