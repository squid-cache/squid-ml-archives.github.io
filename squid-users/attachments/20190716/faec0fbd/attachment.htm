<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;15&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#0563C1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#954F72;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
span.EmailStyle18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-reply;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:#1F497D;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:10.0pt;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
--&gt;&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;#0563C1&quot;&nbsp;vlink=&quot;#954F72&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Hello&nbsp;James,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Here&nbsp;is&nbsp;to&nbsp;confirm&nbsp;that&nbsp;after&nbsp;applying&nbsp;this&nbsp;patch,&nbsp;rebuilding&nbsp;Squid&nbsp;4.6&nbsp;and&nbsp;deploying&nbsp;it&nbsp;into&nbsp;production&nbsp;of&nbsp;about&nbsp;700&nbsp;proxy&nbsp;connected&nbsp;clients&nbsp;using&nbsp;mostly&nbsp;Kerberos&nbsp;authentication&nbsp;followed&nbsp;by&nbsp;NTLM&nbsp;and&nbsp;Basic&nbsp;LDAP<br>
&nbsp;the&nbsp;mentioned&nbsp;issue&nbsp;with&nbsp;negotiate&nbsp;wrapper&nbsp;went&nbsp;away.&nbsp;No&nbsp;more&nbsp;pop&nbsp;us&nbsp;from&nbsp;client&nbsp;browsers.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Best&nbsp;regards,&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Rafael&nbsp;Akchurin&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Diladele&nbsp;B.V.&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;--&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;Need&nbsp;easy&nbsp;to&nbsp;manage&nbsp;DNS&nbsp;filter?&nbsp;See&nbsp;our&nbsp;new&nbsp;project&nbsp;at&nbsp;https://dnssafety.io/&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;border:none;border-top:solid&nbsp;#E1E1E1&nbsp;1.0pt;padding:3.0pt&nbsp;0in&nbsp;0in&nbsp;0in&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;From:&lt;/b&gt;&nbsp;squid-users&nbsp;[mailto:squid-users-bounces@lists.squid-cache.org]<br>
&lt;b&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/b&gt;James&nbsp;Zuelow&lt;br&gt;<br>
&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Monday,&nbsp;July&nbsp;15,&nbsp;2019&nbsp;9:11&nbsp;PM&lt;br&gt;<br>
&lt;b&gt;To:&lt;/b&gt;&nbsp;'squid-users@lists.squid-cache.org'&lt;br&gt;<br>
&lt;b&gt;Subject:&lt;/b&gt;&nbsp;[squid-users]&nbsp;Debian&nbsp;Buster,&nbsp;Squid&nbsp;4.6-1&nbsp;amd64,&nbsp;&quot;Too&nbsp;few&nbsp;negotiateauthenticator&nbsp;processes&nbsp;are&nbsp;running&quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;We&nbsp;have&nbsp;a&nbsp;pair&nbsp;of&nbsp;Squid&nbsp;proxies,&nbsp;running&nbsp;as&nbsp;a&nbsp;failover&nbsp;pair&nbsp;with&nbsp;ucarp.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Both&nbsp;of&nbsp;these&nbsp;proxies&nbsp;are&nbsp;domain&nbsp;joined&nbsp;with&nbsp;Samba,&nbsp;and&nbsp;we&#8217;ve&nbsp;been&nbsp;using&nbsp;Kerberos&nbsp;authentication&nbsp;for&nbsp;several&nbsp;years.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;After&nbsp;Debian&nbsp;Buster&nbsp;was&nbsp;released,&nbsp;we&nbsp;upgraded&nbsp;the&nbsp;failover&nbsp;unit&nbsp;and&nbsp;did&nbsp;some&nbsp;basic&nbsp;testing.&nbsp;&nbsp;Everything&nbsp;seemed&nbsp;to&nbsp;go&nbsp;correctly.&nbsp;&nbsp;Unfortunately&nbsp;when&nbsp;we&nbsp;tested,&nbsp;we&nbsp;didn&#8217;t&nbsp;put&nbsp;the&nbsp;failover&nbsp;under&nbsp;a&nbsp;serious&nbsp;load&nbsp;&#8211;&nbsp;we&nbsp;merely&nbsp;made&nbsp;sure&nbsp;each&nbsp;component<br>
&nbsp;was&nbsp;working&nbsp;the&nbsp;way&nbsp;we&nbsp;expected&nbsp;it&nbsp;to.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;We&nbsp;waited&nbsp;a&nbsp;week,&nbsp;and&nbsp;then&nbsp;updated&nbsp;the&nbsp;primary.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;As&nbsp;soon&nbsp;as&nbsp;the&nbsp;primary&nbsp;was&nbsp;updated&nbsp;and&nbsp;assumed&nbsp;a&nbsp;real&nbsp;load,&nbsp;users&nbsp;started&nbsp;seeing&nbsp;proxy&nbsp;authentication&nbsp;prompts&nbsp;and&nbsp;the&nbsp;proxy&nbsp;started&nbsp;operating&nbsp;very&nbsp;slowly&nbsp;&#8211;&nbsp;to&nbsp;the&nbsp;point&nbsp;where&nbsp;sessions&nbsp;would&nbsp;time&nbsp;out.&nbsp;&nbsp;We&nbsp;quickly&nbsp;rolled&nbsp;to&nbsp;the&nbsp;failover,<br>
&nbsp;but&nbsp;the&nbsp;problem&nbsp;remained.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Since&nbsp;this&nbsp;was&nbsp;a&nbsp;major&nbsp;version&nbsp;upgrade,&nbsp;everything&nbsp;on&nbsp;the&nbsp;server&nbsp;had&nbsp;changed&nbsp;so&nbsp;I&nbsp;had&nbsp;lots&nbsp;of&nbsp;places&nbsp;to&nbsp;look&nbsp;for&nbsp;errors.&nbsp;&nbsp;I&nbsp;did&nbsp;in&nbsp;fact&nbsp;find&nbsp;that&nbsp;my&nbsp;file&nbsp;descriptor&nbsp;settings&nbsp;in&nbsp;limits.conf&nbsp;had&nbsp;reverted&nbsp;back&nbsp;to&nbsp;the&nbsp;default&nbsp;of&nbsp;1024,&nbsp;but&nbsp;even<br>
&nbsp;after&nbsp;fixing&nbsp;this&nbsp;the&nbsp;proxy&nbsp;was&nbsp;slow.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;I&nbsp;see&nbsp;in&nbsp;the&nbsp;logs&nbsp;many&nbsp;occurrences&nbsp;of&nbsp;&#8220;Too&nbsp;few&nbsp;negotiateauthenticator&nbsp;processes&nbsp;are&nbsp;running&#8221;&nbsp;&#8211;&nbsp;the&nbsp;negotiate&nbsp;authenticators&nbsp;look&nbsp;like&nbsp;they&#8217;re&nbsp;crashing&nbsp;every&nbsp;15-45&nbsp;seconds&nbsp;when&nbsp;the&nbsp;proxy&nbsp;is&nbsp;busy&nbsp;(between&nbsp;80-100&nbsp;requests&nbsp;per&nbsp;second&nbsp;at&nbsp;my<br>
&nbsp;site).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Doing&nbsp;a&nbsp;quick&nbsp;Google,&nbsp;I&nbsp;found&nbsp;this:&nbsp;&nbsp;&lt;a&nbsp;href=&quot;https://github.com/diladele/websafety-issues/issues/1141&quot;&gt;<br>
https://github.com/diladele/websafety-issues/issues/1141&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Which&nbsp;refers&nbsp;to&nbsp;this:&nbsp;&nbsp;&lt;a&nbsp;href=&quot;https://bugs.squid-cache.org/show_bug.cgi?id=4936&quot;&gt;<br>
https://bugs.squid-cache.org/show_bug.cgi?id=4936&lt;/a&gt;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;The&nbsp;fix&nbsp;referred&nbsp;to&nbsp;in&nbsp;bug&nbsp;4936&nbsp;appears&nbsp;to&nbsp;be&nbsp;about&nbsp;a&nbsp;month&nbsp;old.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;a&nbsp;href=&quot;https://tracker.debian.org/pkg/squid&quot;&gt;https://tracker.debian.org/pkg/squid&lt;/a&gt;&nbsp;implies&nbsp;that&nbsp;the&nbsp;version&nbsp;of&nbsp;squid&nbsp;in&nbsp;Buster&nbsp;is&nbsp;older&nbsp;than&nbsp;that,&nbsp;last&nbsp;merged&nbsp;into&nbsp;testing&nbsp;(now&nbsp;stable)&nbsp;in&nbsp;February.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Before&nbsp;I&nbsp;file&nbsp;a&nbsp;Debian&nbsp;bug&nbsp;report,&nbsp;how&nbsp;could&nbsp;I&nbsp;go&nbsp;about&nbsp;confirming&nbsp;the&nbsp;presence&nbsp;of&nbsp;bug&nbsp;4936&nbsp;in&nbsp;the&nbsp;current&nbsp;Debian&nbsp;stable&nbsp;version&nbsp;of&nbsp;Squid?&nbsp;&nbsp;Are&nbsp;the&nbsp;dates&nbsp;good&nbsp;enough?&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Thank&nbsp;you!&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;James&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
