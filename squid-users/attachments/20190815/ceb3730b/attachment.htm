<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thank&nbsp;you,&nbsp;Amos.&nbsp;Taking&nbsp;into&nbsp;account&nbsp;your&nbsp;and&nbsp;Rafael&#39;s&nbsp;recommendations,&nbsp;I&nbsp;configured&nbsp;HAProxy&nbsp;and&nbsp;Squid&nbsp;to&nbsp;use&nbsp;the&nbsp;PROXY&nbsp;protocol&nbsp;instead&nbsp;of&nbsp;reformatting&nbsp;the&nbsp;messages.&lt;br&gt;At&nbsp;the&nbsp;moment&nbsp;I&nbsp;disabled&nbsp;authentication,&nbsp;due&nbsp;to&nbsp;internal&nbsp;requirements.&lt;br&gt;I&nbsp;had&nbsp;a&nbsp;hard&nbsp;time&nbsp;dealing&nbsp;with&nbsp;the&nbsp;HAProxy&nbsp;health&nbsp;checks,&nbsp;but&nbsp;I&nbsp;was&nbsp;able&nbsp;to&nbsp;fix&nbsp;it.&lt;br&gt;However,&nbsp;by&nbsp;configuring&nbsp;Squid&nbsp;in&nbsp;this&nbsp;way,&nbsp;I&nbsp;had&nbsp;a&nbsp;last&nbsp;problem&nbsp;that&nbsp;I&nbsp;didn&#39;t&nbsp;expect:&lt;br&gt;Squid&nbsp;reports&nbsp;the&nbsp;client&#39;s&nbsp;IP&nbsp;to&nbsp;my&nbsp;internet&nbsp;gateway&nbsp;instead&nbsp;of&nbsp;their&nbsp;own&nbsp;IP.&lt;br&gt;It&#39;s&nbsp;true,&nbsp;I&nbsp;want&nbsp;to&nbsp;see&nbsp;my&nbsp;clients&#39;&nbsp;IPs&nbsp;in&nbsp;Squid&#39;s&nbsp;log;&nbsp;but&nbsp;I&nbsp;want&nbsp;Squid&#39;s&nbsp;IP&nbsp;to&nbsp;reach&nbsp;my&nbsp;gateway&nbsp;and&nbsp;not&nbsp;my&nbsp;clients&#39;.&nbsp;This&nbsp;way&nbsp;I&nbsp;can&nbsp;make&nbsp;my&nbsp;clients&nbsp;browse&nbsp;internet&nbsp;only&nbsp;through&nbsp;my&nbsp;proxies.&lt;br&gt;&lt;br&gt;I&#39;m&nbsp;really&nbsp;not&nbsp;sure&nbsp;if&nbsp;continuing&nbsp;with&nbsp;this&nbsp;configuration&nbsp;I&#39;m&nbsp;doing&nbsp;will&nbsp;be&nbsp;possible&nbsp;to&nbsp;achieve&nbsp;it.&lt;br&gt;I&nbsp;appreciate&nbsp;in&nbsp;advance&nbsp;any&nbsp;indication&nbsp;you&nbsp;can&nbsp;give&nbsp;me.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;haproxy.cfg&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;div&nbsp;style=&quot;color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas,&quot;Courier&nbsp;New&quot;,monospace;font-weight:normal;font-size:14px;line-height:19px;white-space:pre&quot;&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;global&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    log&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;dev&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;log    local&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    log&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;dev&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;log    local&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;notice&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    chroot&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;var&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;lib&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;haproxy&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    stats&nbsp;socket&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;run&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;haproxy&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;admin&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;sock&nbsp;mode&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;660&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;level&nbsp;admin&nbsp;expose&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;fd&nbsp;listeners&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    stats&nbsp;timeout&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;30&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;s&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    user&nbsp;haproxy&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    group&nbsp;haproxy&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    daemon&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    maxconn&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;4000&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    ca&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;base&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;etc&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ssl&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;certs&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    crt&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;base&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;etc&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ssl&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;private&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    ssl&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;default&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;bind&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ciphers&nbsp;ECDH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AESGCM&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;DH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AESGCM&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ECDH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AES&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;256&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;DH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AES&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;256&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ECDH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AES&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;128&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;DH&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AES&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;RSA&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AESGCM&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;RSA&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;+&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;AES&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:!&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;aNULL&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:!&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;MD&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;5&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:!&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;DSS&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    ssl&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;default&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;bind&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;options&nbsp;no&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;sslv&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;defaults&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    log&nbsp;global&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    mode&nbsp;tcp&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    option&nbsp;tcplog&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    option  dontlognull&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;timeout&nbsp;connect&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;5000&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;timeout&nbsp;client&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;50000&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;timeout&nbsp;server&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;50000&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;frontend&nbsp;squid&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;in&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    bind&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;*:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3128&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    default&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;backend&nbsp;squid&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pool&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;backend&nbsp;squid&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pool&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    balance&nbsp;source&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    mode&nbsp;tcp&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;px1&nbsp;x.x.x.1&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3128&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;check&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;8181&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;send&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;proxy&nbsp;inter&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2000&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;rise&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;fall&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3&lt;/span&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;px2&nbsp;x.x.x.2&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3128&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;check&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;8181&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;send&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;proxy&nbsp;inter&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2000&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;rise&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;fall&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;squid.conf&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;div&nbsp;style=&quot;color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas,&quot;Courier&nbsp;New&quot;,monospace;font-weight:normal;font-size:14px;line-height:19px;white-space:pre&quot;&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;192.168.12.1-192.168.13.254&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;my&nbsp;clients&nbsp;IP&#39;s&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;192.168.11.80&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;haproxy&nbsp;IP&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;SSL&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;443&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;80&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;      &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;http&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;21&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;      &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;ftp&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;443&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;https&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;70&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;      &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;gopher&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;210&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;wais&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535 #&nbsp;unregistered&nbsp;ports&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;280&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;http-mgmt&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;488&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;gss-http&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;591&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;filemaker&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;777&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;     &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;multiling&nbsp;http&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&nbsp;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;8181&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;haproxy&nbsp;health&nbsp;checks&nbsp;port&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;list&nbsp;of&nbsp;allowed&nbsp;domains&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;whitedomains&nbsp;dstdomain&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(206,145,120)&quot;&gt;&quot;/etc/squid/acl/whitedomains.txt&quot;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;list&nbsp;of&nbsp;bloqued&nbsp;domains&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;blackdomains&nbsp;dstdomain&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(206,145,120)&quot;&gt;&quot;/etc/squid/acl/blackdomains.txt&quot;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;malicius&nbsp;dstdomain&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(206,145,120)&quot;&gt;&quot;/etc/squid/acl/malicius.txt&quot;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;acl&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;porn&nbsp;dstdomain&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(206,145,120)&quot;&gt;&quot;/etc/squid/acl/porn.txt&quot;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;!&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;Safe&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;CONNECT&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;!&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;SSL&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ports&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;manager&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;implementation&nbsp;of&nbsp;access&nbsp;list&nbsp;policies&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;blackdomains&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;allow&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;whitedomains&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;malicius&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;LS&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;porn&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;limit&nbsp;downloads&nbsp;to&nbsp;10&nbsp;Mb/s&nbsp;to&nbsp;the&nbsp;localnet&nbsp;network&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;delay&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pools&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;delay&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;class&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;delay&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;parameters&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1310720&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1966080&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;917504&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1310720&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;delay&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;allow&nbsp;localnet&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;implementation&nbsp;of&nbsp;core&nbsp;access&nbsp;policies&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;proxy&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;protocol&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;allow&nbsp;localnet&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;allow&nbsp;localnet&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;allow&nbsp;localhost&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;And&nbsp;finally&nbsp;deny&nbsp;all&nbsp;other&nbsp;access&nbsp;to&nbsp;this&nbsp;proxy&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;access&nbsp;deny&nbsp;all&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Squid&nbsp;normally&nbsp;listens&nbsp;to&nbsp;port&nbsp;3128&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3128&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;require&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;proxy&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;header&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;port&nbsp;used&nbsp;only&nbsp;for&nbsp;haproxy&nbsp;health&nbsp;checks&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;http&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;port&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;8181&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache&nbsp;dir&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;coredump&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;dir&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;var&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;spool&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;squid&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern&nbsp;entries&nbsp;above&nbsp;these.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;refresh&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pattern&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;^&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ftp&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;       &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1440&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;20&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;10080&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;refresh&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pattern&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;^&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;gopher&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;:&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1440&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;    &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;  &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;1440&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;refresh&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pattern&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;i&nbsp;(/cgi-bin/|\?)&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;  &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;refresh&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;pattern&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;       &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;   &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;20&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;4320&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(106,153,85)&quot;&gt;#&nbsp;squid&nbsp;customization&nbsp;settings&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;quick&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;abort&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;min&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;KB&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;quick&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;abort&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;max&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;KB&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;read&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;timeout&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;5&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;minutes&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;timeout&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;3&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;minutes&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;shutdown&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;lifetime&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;seconds&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;ipcache&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;size&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;2048&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;fqdncache&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;size&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(156,220,254)&quot;&gt;4096&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;cache&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;mgr&nbsp;&lt;a&nbsp;href=&quot;mailto:me@tsa.net&quot;&gt;me@tsa.net&lt;/a&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;visible&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;hostname&nbsp;px1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;httpd&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;suppress&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;version&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;string&nbsp;on&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;forwarded&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(86,156,214)&quot;&gt;_&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(212,212,212)&quot;&gt;for&nbsp;off&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best&nbsp;regards&lt;/div&gt;&lt;div&gt;Gabriel&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;El&nbsp;vie.,&nbsp;9&nbsp;de&nbsp;ago.&nbsp;de&nbsp;2019&nbsp;a&nbsp;la(s)&nbsp;03:45,&nbsp;Amos&nbsp;Jeffries&nbsp;(&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;)&nbsp;escribió:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;9/08/19&nbsp;1:44&nbsp;am,&nbsp;neok&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&nbsp;I&nbsp;finally&nbsp;did&nbsp;the&nbsp;configuration&nbsp;differently.&nbsp;It&#39;s&nbsp;working&nbsp;very&nbsp;well&nbsp;for&lt;br&gt;<br>
&gt;&nbsp;me.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;you&nbsp;are&nbsp;doing&nbsp;is&nbsp;polluting&nbsp;every&nbsp;HTTP&nbsp;message&nbsp;with&nbsp;two&nbsp;new&nbsp;headers.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;way&nbsp;Rafael&nbsp;suggested&nbsp;is&nbsp;more&nbsp;efficient&nbsp;since&nbsp;the&nbsp;PROXY&nbsp;protocol&lt;br&gt;<br>
details&nbsp;are&nbsp;only&nbsp;delivered&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;each&nbsp;TCP&nbsp;connection,&nbsp;and&nbsp;HTTP&lt;br&gt;<br>
messages&nbsp;do&nbsp;not&nbsp;need&nbsp;to&nbsp;be&nbsp;reformatted&nbsp;at&nbsp;the&nbsp;LB&nbsp;as&nbsp;they&nbsp;pass.&lt;br&gt;<br>
&lt;br&gt;<br>
Note&nbsp;that&nbsp;Squid&nbsp;will&nbsp;be&nbsp;extending&nbsp;that&nbsp;XFF&nbsp;header&nbsp;itself&nbsp;anyway.&nbsp;But&lt;br&gt;<br>
with&nbsp;your&nbsp;way&nbsp;the&nbsp;LB&nbsp;IP&nbsp;address&nbsp;will&nbsp;be&nbsp;broadcast&nbsp;to&nbsp;the&nbsp;origin(s)&nbsp;in&lt;br&gt;<br>
the&nbsp;XFF&nbsp;header&nbsp;along&nbsp;with&nbsp;the&nbsp;client&nbsp;address.&nbsp;With&nbsp;PROXY&nbsp;protocol&nbsp;Squid&lt;br&gt;<br>
adds&nbsp;only&nbsp;the&nbsp;client&nbsp;address&nbsp;there.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
