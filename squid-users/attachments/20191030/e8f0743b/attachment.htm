<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;style=&quot;display:none;&quot;&gt;&lt;!--&nbsp;P&nbsp;{margin-top:0;margin-bottom:0;}&nbsp;--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;id=&quot;divtagdefaultwrapper&quot;&nbsp;style=&quot;font-size:10pt;color:#000000;font-family:Consolas,Courier,monospace;&quot;&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;p&gt;Hello,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;use&nbsp;squid&nbsp;as&nbsp;a&nbsp;transparent&nbsp;proxy&nbsp;for&nbsp;my&nbsp;users.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;My&nbsp;platform&nbsp;is&nbsp;pretty&nbsp;simple&nbsp;&lt;span&gt;ðŸ˜ƒ&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&quot;Clients&quot;&nbsp;are&nbsp;behind&nbsp;a&nbsp;Debian&nbsp;&quot;Router&quot;&nbsp;which&nbsp;MASQUERADE&nbsp;them&nbsp;(as&nbsp;they&nbsp;use&nbsp;RFC&nbsp;1918&nbsp;ips).&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;I&nbsp;have&nbsp;a&nbsp;Squid&nbsp;4.6&nbsp;from&nbsp;Debian&nbsp;Buster&nbsp;packages&nbsp;installed&nbsp;on&nbsp;a&nbsp;&quot;Proxy&quot;&nbsp;server&nbsp;which&nbsp;is&nbsp;outside&nbsp;my&nbsp;network.&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;I&nbsp;read&nbsp;a&nbsp;lot&nbsp;of&nbsp;tutorials&nbsp;and&nbsp;examples&nbsp;from&nbsp;squid&nbsp;site...&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;I&nbsp;Applied&nbsp;a&nbsp;DNAT&nbsp;to&nbsp;trafic&nbsp;coming&nbsp;from&nbsp;Clients&nbsp;thru&nbsp;Router&nbsp;to&nbsp;Proxy.&lt;/p&gt;<br>
&lt;p&gt;iptables&nbsp;-tnat&nbsp;&lt;span&gt;-A&nbsp;PREROUTING&nbsp;-i&nbsp;LAN_3500&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-j&nbsp;DNAT&nbsp;--to-destination&nbsp;&lt;Proxy&gt;:3129&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&quot;&gt;HTTP&nbsp;is&nbsp;coming&nbsp;to&nbsp;squid&nbsp;successfully&nbsp;but&nbsp;squid&nbsp;logs&nbsp;show&nbsp;a&nbsp;request&nbsp;coming&nbsp;from&nbsp;proxy&nbsp;himself&nbsp;and&nbsp;a&nbsp;request&nbsp;coming&nbsp;from&nbsp;Router&nbsp;(as&nbsp;Clients&nbsp;are&nbsp;NATed&nbsp;by&nbsp;Router)&lt;/span&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;if&nbsp;I&nbsp;allow&nbsp;in&nbsp;squid.conf&nbsp;the&nbsp;Proxy&nbsp;IP,&nbsp;I&nbsp;end&nbsp;up&nbsp;with&nbsp;a&nbsp;Forward&nbsp;loop...&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;I&nbsp;also&nbsp;tried&nbsp;the&nbsp;tproxy&nbsp;scenario&nbsp;with&nbsp;no&nbsp;success.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;I'd&nbsp;really&nbsp;like&nbsp;some&nbsp;help.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;Thanks&nbsp;!&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
