<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;i&nbsp;have&nbsp;done&nbsp;it&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;i&nbsp;can&nbsp;now&nbsp;whitelist&nbsp;urls,&nbsp;block&nbsp;mime&nbsp;types&nbsp;and&nbsp;now&nbsp;i&nbsp;can&nbsp;download/install&nbsp;windows&nbsp;updates&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&lt;br&gt;#&lt;br&gt;#Windows&nbsp;Update&nbsp;Download&lt;br&gt;acl&nbsp;windowsupdate&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&gt;windowsupdate.com&lt;/a&gt;&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;acl&nbsp;wuCONNECT&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&gt;windowsupdate.com&lt;/a&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;CONNECT&nbsp;wuCONNECT&lt;br&gt;http_access&nbsp;allow&nbsp;windowsupdate&lt;br&gt;&lt;br&gt;range_offset_limit&nbsp;200&nbsp;MB&nbsp;windowsupdate&lt;br&gt;maximum_object_size&nbsp;200&nbsp;MB&lt;br&gt;quick_abort_min&nbsp;-1&lt;br&gt;&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&quot;&gt;microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&lt;/a&gt;&nbsp;4320&nbsp;80%&nbsp;43200&nbsp;reload-into-ims&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&quot;&gt;windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&lt;/a&gt;&nbsp;4320&nbsp;80%&nbsp;43200&nbsp;reload-into-ims&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&quot;&gt;windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip)&lt;/a&gt;&nbsp;4320&nbsp;80%&nbsp;43200&nbsp;reload-into-ims&lt;br&gt;&lt;br&gt;acl&nbsp;DiscoverSNIHost&nbsp;at_step&nbsp;SslBump1&lt;br&gt;acl&nbsp;NoSSLIntercept&nbsp;ssl::server_name_regex&nbsp;-i&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&gt;windowsupdate.com&lt;/a&gt;&lt;br&gt;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&lt;br&gt;ssl_bump&nbsp;peek&nbsp;DiscoverSNIHost&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;br&gt;acl&nbsp;BrokenButTrustedServers&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&gt;windowsupdate.com&lt;/a&gt;&lt;br&gt;acl&nbsp;DomainMismatch&nbsp;ssl_error&nbsp;SQUID_X509_V_ERR_DOMAIN_MISMATCH&lt;br&gt;sslproxy_cert_error&nbsp;allow&nbsp;BrokenButTrustedServers&nbsp;DomainMismatch&lt;br&gt;sslproxy_cert_error&nbsp;deny&nbsp;all&lt;br&gt;#&lt;br&gt;#SSL&lt;br&gt;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;\&lt;br&gt;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;\&lt;br&gt;cipher=HIGH:MEDIUM:RC4:3DES:!aNULL:!eNULL:!LOW:!MD5:!EXP:!PSK:!SRP:!DSS&nbsp;\&lt;br&gt;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;br&gt;sslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;configuration:&lt;br&gt;#&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&nbsp;from&nbsp;where&nbsp;browsing&lt;br&gt;#&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;0.0.0.1-0.255.255.255&nbsp;&nbsp;#&nbsp;RFC&nbsp;1122&nbsp;&quot;this&quot;&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://100.64.0.0/10&quot;&gt;100.64.0.0/10&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;6598&nbsp;shared&nbsp;address&nbsp;space&nbsp;(CGN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://169.254.0.0/16&quot;&gt;169.254.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;3927&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;#&lt;br&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;&lt;br&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;&lt;br&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;manager&lt;br&gt;&lt;br&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;#&lt;br&gt;#HTTP_HTTPS&nbsp;whitelist&nbsp;websites&lt;br&gt;acl&nbsp;whitelist&nbsp;ssl::server_name&nbsp;&quot;/usr/local/squid/etc/urlwhite.txt&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;whitelist&lt;br&gt;&lt;br&gt;#URL&nbsp;deny&nbsp;MIME&nbsp;types&lt;br&gt;acl&nbsp;mimetype&nbsp;rep_mime_type&nbsp;&quot;/usr/local/squid/etc/mimedeny.txt&quot;&lt;br&gt;http_reply_access&nbsp;deny&nbsp;mimetype&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;&lt;br&gt;#&nbsp;Uncomment&nbsp;and&nbsp;adjust&nbsp;the&nbsp;following&nbsp;to&nbsp;add&nbsp;a&nbsp;disk&nbsp;cache&nbsp;directory.&lt;br&gt;#cache_dir&nbsp;ufs&nbsp;/usr/local/squid/var/cache/squid&nbsp;100&nbsp;16&nbsp;256&lt;br&gt;&lt;br&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache&nbsp;dir&lt;br&gt;coredump_dir&nbsp;/usr/local/squid/var/cache/squid&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern&nbsp;entries&nbsp;above&nbsp;these.&lt;br&gt;#&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;br&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Amos,&nbsp;do&nbsp;you&nbsp;think&nbsp;i&nbsp;could&nbsp;make&nbsp;the&nbsp;windows&nbsp;update&nbsp;section&nbsp;a&nbsp;bit&nbsp;smaller&nbsp;or&nbsp;do&nbsp;i&nbsp;need&nbsp;all&nbsp;the&nbsp;lines&nbsp;in&nbsp;there?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;many&nbsp;thanks,&lt;/div&gt;&lt;div&gt;rob&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sun,&nbsp;15&nbsp;Dec&nbsp;2019&nbsp;at&nbsp;16:24,&nbsp;robert&nbsp;k&nbsp;Wild&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:robertkwild@gmail.com&quot;&gt;robertkwild@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;hi&nbsp;Amos,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;so&nbsp;this&nbsp;is&nbsp;my&nbsp;new&nbsp;config&nbsp;-&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;configuration:&lt;br&gt;#&lt;br&gt;&lt;br&gt;#SSL&lt;br&gt;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;\&lt;br&gt;cert=/usr/local/squid/ssl_cert/myCA.pem&nbsp;\&lt;br&gt;cipher=HIGH:MEDIUM:RC4:3DES:!aNULL:!eNULL:!LOW:!MD5:!EXP:!PSK:!SRP:!DSS&nbsp;\&lt;br&gt;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;br&gt;sslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&nbsp;from&nbsp;where&nbsp;browsing&lt;br&gt;#&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;0.0.0.1-0.255.255.255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1122&nbsp;&quot;this&quot;&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&nbsp;target=&quot;_blank&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://100.64.0.0/10&quot;&nbsp;target=&quot;_blank&quot;&gt;100.64.0.0/10&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;6598&nbsp;shared&nbsp;address&nbsp;space&nbsp;(CGN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://169.254.0.0/16&quot;&nbsp;target=&quot;_blank&quot;&gt;169.254.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;3927&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&nbsp;target=&quot;_blank&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&nbsp;target=&quot;_blank&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;#&lt;br&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;&lt;br&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;&lt;br&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;manager&lt;br&gt;&lt;br&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;#&lt;br&gt;#Windows&nbsp;Update&lt;br&gt;acl&nbsp;windowsupdate&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&nbsp;target=&quot;_blank&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windowsupdate.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.net&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.net&lt;/a&gt;&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;acl&nbsp;wuCONNECT&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&nbsp;target=&quot;_blank&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windowsupdate.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.net&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.net&lt;/a&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;CONNECT&nbsp;wuCONNECT&lt;br&gt;http_access&nbsp;allow&nbsp;windowsupdate&lt;br&gt;&lt;br&gt;acl&nbsp;DiscoverSNIHost&nbsp;at_step&nbsp;SslBump1&lt;br&gt;acl&nbsp;NoSSLIntercept&nbsp;ssl::server_name_regex&nbsp;-i&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&nbsp;target=&quot;_blank&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windowsupdate.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.net&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.net&lt;/a&gt;&lt;br&gt;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&lt;br&gt;ssl_bump&nbsp;peek&nbsp;DiscoverSNIHost&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;br&gt;acl&nbsp;BrokenButTrustedServers&nbsp;dstdomain&nbsp;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&nbsp;target=&quot;_blank&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&nbsp;target=&quot;_blank&quot;&gt;windowsupdate.com&lt;/a&gt;&nbsp;.&lt;a&nbsp;href=&quot;http://windows.net&quot;&nbsp;target=&quot;_blank&quot;&gt;windows.net&lt;/a&gt;&lt;br&gt;acl&nbsp;DomainMismatch&nbsp;ssl_error&nbsp;SQUID_X509_V_ERR_DOMAIN_MISMATCH&lt;br&gt;sslproxy_cert_error&nbsp;allow&nbsp;BrokenButTrustedServers&nbsp;DomainMismatch&lt;br&gt;sslproxy_cert_error&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;#HTTP_HTTPS&nbsp;whitelist&nbsp;websites&lt;br&gt;acl&nbsp;whitelist&nbsp;ssl::server_name&nbsp;&quot;/usr/local/squid/etc/urlwhite.txt&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;whitelist&lt;br&gt;&lt;br&gt;#URL&nbsp;deny&nbsp;MIME&nbsp;types&lt;br&gt;acl&nbsp;mimetype&nbsp;rep_mime_type&nbsp;&quot;/usr/local/squid/etc/mimedeny.txt&quot;&lt;br&gt;http_reply_access&nbsp;deny&nbsp;mimetype&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;&lt;br&gt;#&nbsp;Uncomment&nbsp;and&nbsp;adjust&nbsp;the&nbsp;following&nbsp;to&nbsp;add&nbsp;a&nbsp;disk&nbsp;cache&nbsp;directory.&lt;br&gt;#cache_dir&nbsp;ufs&nbsp;/usr/local/squid/var/cache/squid&nbsp;100&nbsp;16&nbsp;256&lt;br&gt;&lt;br&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache&nbsp;dir&lt;br&gt;coredump_dir&nbsp;/usr/local/squid/var/cache/squid&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern&nbsp;entries&nbsp;above&nbsp;these.&lt;br&gt;#&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;br&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;but&nbsp;im&nbsp;still&nbsp;getting&nbsp;the&nbsp;exact&nbsp;same&nbsp;logs&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;error&nbsp;503&nbsp;means&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&nbsp;503&nbsp;&lt;/p&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&lt;td&gt;&lt;p&gt;&nbsp;Service&nbsp;Unavailable&nbsp;&lt;/p&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&lt;td&gt;&lt;p&gt;&nbsp;&lt;a&nbsp;href=&quot;http://tools.ietf.org/rfc/rfc1945&quot;&nbsp;title=&quot;RFC&quot;&nbsp;target=&quot;_blank&quot;&gt;1945&lt;/a&gt;,&nbsp;&lt;a&nbsp;href=&quot;http://tools.ietf.org/rfc/rfc2616&quot;&nbsp;title=&quot;RFC&quot;&nbsp;target=&quot;_blank&quot;&gt;2616&lt;/a&gt;&nbsp;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;rob&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sun,&nbsp;15&nbsp;Dec&nbsp;2019&nbsp;at&nbsp;10:40,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;15/12/19&nbsp;1:16&nbsp;pm,&nbsp;robert&nbsp;k&nbsp;Wild&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;hi&nbsp;Amos,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;thank&nbsp;you&nbsp;for&nbsp;getting&nbsp;back&nbsp;to&nbsp;me&nbsp;about&nbsp;this&nbsp;:)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;this&nbsp;is&nbsp;my&nbsp;new&nbsp;config&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#SSL&lt;br&gt;<br>
&gt;&nbsp;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;\&lt;br&gt;<br>
&gt;&nbsp;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;\&lt;br&gt;<br>
&gt;&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;br&gt;<br>
&gt;&nbsp;sslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&lt;br&gt;<br>
&gt;&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#Windows&nbsp;Updates&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;windowsupdate&nbsp;dstdomain&nbsp;&quot;/usr/local/squid/etc/wu.txt&quot;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;wuCONNECT&nbsp;dstdomain&nbsp;&quot;/usr/local/squid/etc/wu.txt&quot;&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;CONNECT&nbsp;wuCONNECT&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;windowsupdate&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
...&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;manager&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;<br>
&gt;&nbsp;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
...&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;reason&nbsp;why&nbsp;i&nbsp;have&nbsp;added&nbsp;the&nbsp;windows&nbsp;update&nbsp;lines&nbsp;at&nbsp;the&nbsp;beginning&nbsp;is&lt;br&gt;<br>
&gt;&nbsp;that&nbsp;the&nbsp;link&nbsp;says&nbsp;so&nbsp;(below)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://linuxnlenux.wordpress.com/2014/10/14/howto-allow-windows-updates-through-squid/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://linuxnlenux.wordpress.com/2014/10/14/howto-allow-windows-updates-through-squid/&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;is&nbsp;a&nbsp;copy-n-paste&nbsp;of&nbsp;an&nbsp;old&nbsp;email&nbsp;without&nbsp;any&nbsp;of&nbsp;the&nbsp;context.&nbsp;See&lt;br&gt;<br>
&lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/SquidFaq/WindowsUpdate&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/SquidFaq/WindowsUpdate&lt;/a&gt;&gt;&nbsp;for&nbsp;the&nbsp;full&lt;br&gt;<br>
context&nbsp;and&nbsp;more&nbsp;up&nbsp;to&nbsp;date&nbsp;info.&lt;br&gt;<br>
&lt;br&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;things&nbsp;that&nbsp;need&nbsp;to&nbsp;be&nbsp;first&nbsp;are&nbsp;very&nbsp;specifically&nbsp;a&lt;br&gt;<br>
sub-set&nbsp;of&nbsp;the&nbsp;MS&nbsp;domains&nbsp;which&nbsp;use&nbsp;a&nbsp;non-443&nbsp;port&nbsp;for&nbsp;call-home&nbsp;traffic&lt;br&gt;<br>
so&nbsp;they&nbsp;would&nbsp;normally&nbsp;get&nbsp;blocked&nbsp;by&nbsp;the&nbsp;SSL_ports&nbsp;protection.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
For&nbsp;a&nbsp;generic&nbsp;whitelist&nbsp;you&nbsp;should&nbsp;still&nbsp;have&nbsp;your&nbsp;list&nbsp;where&nbsp;the&nbsp;config&lt;br&gt;<br>
says&nbsp;&quot;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULES&nbsp;...&quot;&nbsp;.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;when&nbsp;im&nbsp;looking&nbsp;at&nbsp;the&nbsp;logs&nbsp;real&nbsp;time&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;1576368417.620&nbsp; &nbsp; &nbsp;48&nbsp;10.100.1.5&nbsp;NONE/200&nbsp;0&nbsp;CONNECT&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://fe3cr.delivery.mp.microsoft.com:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;fe3cr.delivery.mp.microsoft.com:443&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://fe3cr.delivery.mp.microsoft.com:443&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://fe3cr.delivery.mp.microsoft.com:443&lt;/a&gt;&gt;&nbsp;-&nbsp;HIER_DIRECT/&lt;a&nbsp;href=&quot;http://191.232.139.2&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;191.232.139.2&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://191.232.139.2&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://191.232.139.2&lt;/a&gt;&gt;&nbsp;-&lt;br&gt;<br>
&gt;&nbsp;1576368417.647&nbsp; &nbsp; &nbsp; 0&nbsp;10.100.1.5&nbsp;NONE/503&nbsp;4363&nbsp;POST&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://fe3cr.delivery.mp.microsoft.com/ClientWebService/client.asmx&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://fe3cr.delivery.mp.microsoft.com/ClientWebService/client.asmx&lt;/a&gt;&nbsp;-&lt;br&gt;<br>
&gt;&nbsp;HIER_NONE/-&nbsp;text/html&lt;br&gt;<br>
&gt;&nbsp;1576368419.702&nbsp; &nbsp; &nbsp; 0&nbsp;-&nbsp;TCP_MEM_HIT/200&nbsp;807&nbsp;GET&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.microsoft.com/pkiops/certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crt&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.microsoft.com/pkiops/certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crt&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;-&nbsp;HIER_NONE/-&nbsp;application/octet-st&lt;br&gt;<br>
&gt;&nbsp;ream&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
These&nbsp;show&nbsp;good&nbsp;progress&nbsp;from&nbsp;where&nbsp;you&nbsp;started&nbsp;off.&nbsp;The&nbsp;cert&nbsp;is&nbsp;being&lt;br&gt;<br>
downloaded&nbsp;fine.&nbsp;The&nbsp;tunnel&nbsp;being&nbsp;bumped&nbsp;fine.&nbsp;But&nbsp;the&nbsp;POST&nbsp;request&lt;br&gt;<br>
which&nbsp;was&nbsp;decrypted&nbsp;could&nbsp;not&nbsp;be&nbsp;serviced.&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;you&nbsp;find&nbsp;out&nbsp;what&nbsp;the&nbsp;503&nbsp;message&nbsp;says?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&nbsp;&lt;br&gt;&lt;br&gt;Robert&nbsp;K&nbsp;Wild.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&nbsp;&lt;br&gt;&lt;br&gt;Robert&nbsp;K&nbsp;Wild.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
