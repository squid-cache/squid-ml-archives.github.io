<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;hi&nbsp;Amos,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thank&nbsp;you&nbsp;for&nbsp;getting&nbsp;back&nbsp;to&nbsp;me&nbsp;about&nbsp;this&nbsp;:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;this&nbsp;is&nbsp;my&nbsp;new&nbsp;config&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&lt;br&gt;#SSL&lt;br&gt;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;\&lt;br&gt;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;\&lt;br&gt;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;br&gt;sslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;&lt;br&gt;#Windows&nbsp;Updates&lt;br&gt;acl&nbsp;windowsupdate&nbsp;dstdomain&nbsp;&quot;/usr/local/squid/etc/wu.txt&quot;&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;acl&nbsp;wuCONNECT&nbsp;dstdomain&nbsp;&quot;/usr/local/squid/etc/wu.txt&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;CONNECT&nbsp;wuCONNECT&lt;br&gt;http_access&nbsp;allow&nbsp;windowsupdate&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;configuration:&lt;br&gt;#&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&nbsp;from&nbsp;where&nbsp;browsing&lt;br&gt;#&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;0.0.0.1-0.255.255.255&nbsp;#&nbsp;RFC&nbsp;1122&nbsp;&quot;this&quot;&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.0.0.0/8&quot;&gt;10.0.0.0/8&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://100.64.0.0/10&quot;&gt;100.64.0.0/10&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;6598&nbsp;shared&nbsp;address&nbsp;space&nbsp;(CGN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://169.254.0.0/16&quot;&gt;169.254.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;3927&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;1918&nbsp;local&nbsp;private&nbsp;network&nbsp;(LAN)&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;br&gt;acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;#&lt;br&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;&lt;br&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;&lt;br&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;manager&lt;br&gt;&lt;br&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;#&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;&lt;br&gt;#&nbsp;Uncomment&nbsp;and&nbsp;adjust&nbsp;the&nbsp;following&nbsp;to&nbsp;add&nbsp;a&nbsp;disk&nbsp;cache&nbsp;directory.&lt;br&gt;#cache_dir&nbsp;ufs&nbsp;/usr/local/squid/var/cache/squid&nbsp;100&nbsp;16&nbsp;256&lt;br&gt;&lt;br&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache&nbsp;dir&lt;br&gt;coredump_dir&nbsp;/usr/local/squid/var/cache/squid&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern&nbsp;entries&nbsp;above&nbsp;these.&lt;br&gt;#&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;br&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;the&nbsp;reason&nbsp;why&nbsp;i&nbsp;have&nbsp;added&nbsp;the&nbsp;windows&nbsp;update&nbsp;lines&nbsp;at&nbsp;the&nbsp;beginning&nbsp;is&nbsp;that&nbsp;the&nbsp;link&nbsp;says&nbsp;so&nbsp;(below)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://linuxnlenux.wordpress.com/2014/10/14/howto-allow-windows-updates-through-squid/&quot;&gt;https://linuxnlenux.wordpress.com/2014/10/14/howto-allow-windows-updates-through-squid/&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;this&nbsp;is&nbsp;my&nbsp;domain&nbsp;list&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Microsoft&lt;br&gt;.&lt;a&nbsp;href=&quot;http://bing.com&quot;&gt;bing.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://msn.com&quot;&gt;msn.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://msedge.net&quot;&gt;msedge.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://msftauth.net&quot;&gt;msftauth.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://msauth.net&quot;&gt;msauth.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://msocdn.com&quot;&gt;msocdn.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://outlook.com&quot;&gt;outlook.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://onedrive.com&quot;&gt;onedrive.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://office.net&quot;&gt;office.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://office.com&quot;&gt;office.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://office365.com&quot;&gt;office365.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://microsoftonline.com&quot;&gt;microsoftonline.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://c.s-microsoft.com&quot;&gt;c.s-microsoft.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://live.com&quot;&gt;live.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://live.net&quot;&gt;live.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://akamaized.net&quot;&gt;akamaized.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://akamaihd.net&quot;&gt;akamaihd.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://svc.ms&quot;&gt;svc.ms&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://lync.com&quot;&gt;lync.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://skype.com&quot;&gt;skype.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://gfx.ms&quot;&gt;gfx.ms&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://sharepoint.com&quot;&gt;sharepoint.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://sharepointonline.com&quot;&gt;sharepointonline.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://windowsupdate.com&quot;&gt;windowsupdate.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://windows.net&quot;&gt;windows.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://edgesuite.net&quot;&gt;edgesuite.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://a-msedge.net&quot;&gt;a-msedge.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://akamaiedge.net&quot;&gt;akamaiedge.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://sfx.ms&quot;&gt;sfx.ms&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://azureedge.net&quot;&gt;azureedge.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://trafficmanager.net&quot;&gt;trafficmanager.net&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://azure.com&quot;&gt;azure.com&lt;/a&gt;&lt;br&gt;#Google&lt;br&gt;.&lt;a&nbsp;href=&quot;http://google.com&quot;&gt;google.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://google.co.uk&quot;&gt;google.co.uk&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://googleusercontent.com&quot;&gt;googleusercontent.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://googleapis.com&quot;&gt;googleapis.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://withgoogle.com&quot;&gt;withgoogle.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://gstatic.com&quot;&gt;gstatic.com&lt;/a&gt;&lt;br&gt;#Adobe&lt;br&gt;.&lt;a&nbsp;href=&quot;http://adobedtm.com&quot;&gt;adobedtm.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://adobe.io&quot;&gt;adobe.io&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://adobe.com&quot;&gt;adobe.com&lt;/a&gt;&lt;br&gt;.&lt;a&nbsp;href=&quot;http://adobelogin.com&quot;&gt;adobelogin.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;when&nbsp;im&nbsp;looking&nbsp;at&nbsp;the&nbsp;logs&nbsp;real&nbsp;time&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1576368417.620&nbsp; &nbsp; &nbsp;48&nbsp;10.100.1.5&nbsp;NONE/200&nbsp;0&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://fe3cr.delivery.mp.microsoft.com:443&quot;&gt;fe3cr.delivery.mp.microsoft.com:443&lt;/a&gt;&nbsp;-&nbsp;HIER_DIRECT/&lt;a&nbsp;href=&quot;http://191.232.139.2&quot;&gt;191.232.139.2&lt;/a&gt;&nbsp;-&lt;br&gt;1576368417.647&nbsp; &nbsp; &nbsp; 0&nbsp;10.100.1.5&nbsp;NONE/503&nbsp;4363&nbsp;POST&nbsp;&lt;a&nbsp;href=&quot;https://fe3cr.delivery.mp.microsoft.com/ClientWebService/client.asmx&quot;&gt;https://fe3cr.delivery.mp.microsoft.com/ClientWebService/client.asmx&lt;/a&gt;&nbsp;-&nbsp;HIER_NONE/-&nbsp;text/html&lt;br&gt;1576368419.702&nbsp; &nbsp; &nbsp; 0&nbsp;-&nbsp;TCP_MEM_HIT/200&nbsp;807&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;http://www.microsoft.com/pkiops/certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crt&quot;&gt;http://www.microsoft.com/pkiops/certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crt&lt;/a&gt;&nbsp;-&nbsp;HIER_NONE/-&nbsp;application/octet-st&lt;br&gt;ream&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;squid&nbsp;works&nbsp;fine&nbsp;just&nbsp;as&nbsp;you&nbsp;said&nbsp;on&nbsp;certain&nbsp;apps/programs,&nbsp;so&nbsp;im&nbsp;really&nbsp;struggling&nbsp;on&nbsp;this&nbsp;one&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;rob&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sat,&nbsp;14&nbsp;Dec&nbsp;2019&nbsp;at&nbsp;22:35,&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;15/12/19&nbsp;4:21&nbsp;am,&nbsp;robert&nbsp;k&nbsp;Wild&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;so&nbsp;this&nbsp;is&nbsp;my&nbsp;config&nbsp;file&nbsp;-&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Recommended&nbsp;minimum&nbsp;configuration:&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#SSL&lt;br&gt;<br>
&gt;&nbsp;http_port&nbsp;3128&nbsp;ssl-bump&nbsp;\&lt;br&gt;<br>
&gt;&nbsp;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;\&lt;br&gt;<br>
&gt;&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;sslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&lt;br&gt;<br>
&gt;&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
(elided&nbsp;default&nbsp;localnet&nbsp;and&nbsp;port&nbsp;ACL&nbsp;definitions)&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;deny&nbsp;manager&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;<br>
&gt;&nbsp;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;^^^&nbsp;HINT.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localnet&lt;br&gt;<br>
&gt;&nbsp;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Squid&nbsp;normally&nbsp;listens&nbsp;to&nbsp;port&nbsp;3128&lt;br&gt;<br>
&gt;&nbsp;http_port&nbsp;3128&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;the&nbsp;second&nbsp;port&nbsp;3128&nbsp;config,&nbsp;and&nbsp;it&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;earlier&nbsp;one.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;as&nbsp;you&nbsp;can&nbsp;see&nbsp;i&nbsp;have&nbsp;removed&nbsp;the&nbsp;whitelist/mime&nbsp;config&nbsp;lines&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;when&nbsp;i&nbsp;come&nbsp;into&nbsp;activating&nbsp;office&nbsp;it&nbsp;just&nbsp;cant&nbsp;get&nbsp;online&nbsp;to&nbsp;do&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;via&nbsp;the&nbsp;client&nbsp;app&nbsp;installed&nbsp;on&nbsp;my&nbsp;pc&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;that&nbsp;is&nbsp;still&nbsp;happening&nbsp;with&nbsp;this&nbsp;default&nbsp;config&nbsp;I&nbsp;would&nbsp;be&nbsp;starting&lt;br&gt;<br>
to&nbsp;suspect&nbsp;things&nbsp;outside&nbsp;of&nbsp;Squid.&nbsp;Like&nbsp;firewall&nbsp;or&nbsp;routing&nbsp;rules,&nbsp;the&lt;br&gt;<br>
client&nbsp;app&nbsp;not&nbsp;supporting&nbsp;proxies&nbsp;properly&nbsp;-&nbsp;stuff&nbsp;like&nbsp;that.&lt;br&gt;<br>
&lt;br&gt;<br>
Though&nbsp;403&nbsp;in&nbsp;the&nbsp;proxy&nbsp;log&nbsp;does&nbsp;indicate&nbsp;an&nbsp;explicitly&nbsp;forbidden&lt;br&gt;<br>
action.&nbsp;The&nbsp;way&nbsp;you&nbsp;truncated&nbsp;the&nbsp;log&nbsp;line&nbsp;cut&nbsp;away&nbsp;most&nbsp;of&nbsp;the&nbsp;useful&lt;br&gt;<br>
info&nbsp;that&nbsp;points&nbsp;at&nbsp;where&nbsp;to&nbsp;focus&nbsp;the&nbsp;troubleshooting&nbsp;efforts.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;internet&nbsp;isnt&nbsp;blocked&nbsp;as&nbsp;i&nbsp;can&nbsp;go&nbsp;to&nbsp;any&nbsp;website&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Do&nbsp;you&nbsp;want&nbsp;it&nbsp;to&nbsp;work&nbsp;with&nbsp;the&nbsp;whitelisting&nbsp;ACL&nbsp;you&nbsp;mentioned?&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;yes,&nbsp;then&nbsp;you&nbsp;do&nbsp;need&nbsp;to&nbsp;show&nbsp;at&nbsp;least&nbsp;the&nbsp;http_access&nbsp;directives&lt;br&gt;<br>
using&nbsp;it&nbsp;and&nbsp;the&nbsp;exact&nbsp;entry&nbsp;you&nbsp;added&nbsp;for&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;microsoft.com&lt;/a&gt;&nbsp;domain(s).&lt;br&gt;<br>
&lt;br&gt;<br>
Same&nbsp;for&nbsp;the&nbsp;&quot;mime&quot;&nbsp;config&nbsp;lines&nbsp;you&nbsp;mention,&nbsp;but&nbsp;for&nbsp;those&nbsp;any&nbsp;part&nbsp;of&lt;br&gt;<br>
it&nbsp;could&nbsp;be&nbsp;relevant&nbsp;so&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;see&nbsp;the&nbsp;whole&nbsp;of&nbsp;that&nbsp;stuff.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;have&nbsp;omitted&nbsp;the&nbsp;default&nbsp;&quot;http_access&nbsp;deny&nbsp;all&quot;&nbsp;which&nbsp;should&nbsp;be&nbsp;the&lt;br&gt;<br>
last&nbsp;http_access&nbsp;line&nbsp;in&nbsp;your&nbsp;config.&nbsp;Not&nbsp;a&nbsp;problem&nbsp;in&nbsp;the&nbsp;config&nbsp;as&lt;br&gt;<br>
shown,&nbsp;but&nbsp;if&nbsp;you&nbsp;have&nbsp;other&nbsp;rules&nbsp;they&nbsp;can&nbsp;change&nbsp;the&nbsp;implicit&nbsp;default&lt;br&gt;<br>
into&nbsp;a&nbsp;bad&nbsp;situation&nbsp;very&nbsp;easily.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&nbsp;&lt;br&gt;&lt;br&gt;Robert&nbsp;K&nbsp;Wild.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
