<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Alex,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;for&nbsp;the&nbsp;reply,&nbsp;we&nbsp;update&nbsp;our&nbsp;patch&nbsp;with&nbsp;provided&nbsp;changes.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;more&nbsp;thing,&nbsp;with&nbsp;TLSv1.3.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;site &lt;a&nbsp;href=&quot;https://3frontoffice.tre.se/login&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;https://3frontoffice.&lt;span&nbsp;class=&quot;gmail-il&quot;&gt;tre&lt;/span&gt;.&lt;span&nbsp;class=&quot;gmail-il&quot;&gt;se&lt;/span&gt;/login&lt;/a&gt; with&nbsp;specific&nbsp;behavior&nbsp;in&nbsp;the&nbsp;Chrome&nbsp;browser&nbsp;OS&nbsp;X&nbsp;El&nbsp;Capitan.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(1,91,167);font-family:Arial,sans-serif;font-size:12px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;During establishing&nbsp;TLSv1.3&nbsp;handshake&nbsp;after &lt;/font&gt;&lt;/span&gt;successfully&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,sans-serif&quot;&gt; send&nbsp;our&nbsp;Client&nbsp;Hello,&nbsp;the&nbsp;server&nbsp;answers&nbsp;us&nbsp;with&nbsp;Hello&nbsp;Retry&nbsp;Request.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;In&nbsp;Squid&nbsp;this&nbsp;behavior&nbsp;interprets&nbsp;next&nbsp;Client&nbsp;Hello&nbsp;peek&nbsp;successfully and&nbsp;Hello&nbsp;Retry&nbsp;Request&nbsp;peeks as&nbsp;Server&nbsp;Hello.&lt;br&gt;After&nbsp;that,&nbsp;we&nbsp;splice&nbsp;it&nbsp;and&nbsp;send&nbsp;to&nbsp;OpenSSL&nbsp;and&nbsp;fail&nbsp;handshake&nbsp;establishing.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;Did&nbsp;you&nbsp;already&nbsp;notice&nbsp;such&nbsp;behavior? &lt;br&gt;Did&nbsp;you&nbsp;have&nbsp;some&nbsp;investigation&nbsp;on&nbsp;this&nbsp;issue, &lt;/font&gt;&lt;/span&gt;any&nbsp;advice&nbsp;will&nbsp;be&nbsp;pleasant?&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;Best&nbsp;regards,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;Yaroslav.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Tue,&nbsp;Dec&nbsp;17,&nbsp;2019&nbsp;at&nbsp;4:39&nbsp;PM&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;12/17/19&nbsp;9:00&nbsp;AM,&nbsp;Yaroslav&nbsp;Pushko&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;All&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;We&nbsp;use Squid&nbsp;4.8&nbsp;with&nbsp;OpenSSL&nbsp;1.1.1d&nbsp;in&nbsp;a&nbsp;transparent&nbsp;mode&nbsp;for&nbsp;peek&nbsp;and&lt;br&gt;<br>
&gt;&nbsp;splice&nbsp;interception.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;With&nbsp;this&nbsp;version,&nbsp;we&nbsp;lost&nbsp;the possibility to&nbsp;connect&nbsp;to&nbsp;any&nbsp;HTTPS&nbsp;site.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;There&nbsp;are&nbsp;a&nbsp;few&nbsp;issues: &lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; *&nbsp;support&nbsp;TLSv1.2&nbsp;sites&nbsp;(already&nbsp;discussed&nbsp;in&lt;br&gt;<br>
&gt; &nbsp; &nbsp; thread &lt;a&nbsp;href=&quot;http://squid-web-proxy-cache.1019090.n4.nabble.com/Problem-with-ssl-choose-client-version-inappropriate-fallback-on-some-sites-when-using-TLS1-2-td4688258.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://squid-web-proxy-cache.1019090.n4.nabble.com/Problem-with-ssl-choose-client-version-inappropriate-fallback-on-some-sites-when-using-TLS1-2-td4688258.html&lt;/a&gt; )&lt;br&gt;<br>
&gt; &nbsp; *&nbsp;support&nbsp;TLSv1.3&nbsp;sites.&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;see&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/2019-December/021435.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/2019-December/021435.html&lt;/a&gt;&lt;br&gt;<br>
for&nbsp;several&nbsp;alternative&nbsp;fixes.&nbsp;AFAICT,&nbsp;those&nbsp;fixes&nbsp;are&nbsp;more&nbsp;flexible&lt;br&gt;<br>
and,&nbsp;after&nbsp;polishing,&nbsp;appropriate&nbsp;for&nbsp;the&nbsp;official&nbsp;inclusion&nbsp;because&lt;br&gt;<br>
they&nbsp;make&nbsp;fewer&nbsp;assumptions&nbsp;about&nbsp;the&nbsp;values&nbsp;sent&nbsp;via&nbsp;the&nbsp;supported&lt;br&gt;<br>
versions&nbsp;extension.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;possible&nbsp;that&nbsp;your&nbsp;SSL_MODE_SEND_FALLBACK_SCSV&nbsp;change&nbsp;needs&nbsp;to&nbsp;be&lt;br&gt;<br>
integrated&nbsp;with&nbsp;the&nbsp;other&nbsp;fixes.&nbsp;Thank&nbsp;you&nbsp;for&nbsp;sharing&nbsp;that&nbsp;idea!&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Support&nbsp;TLSv1.2.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; OpenSSL&nbsp;1.1.1d&nbsp;adds&nbsp;support&nbsp;of&nbsp;TLSv1.3.&nbsp;These&nbsp;changes&nbsp;added&nbsp;some&lt;br&gt;<br>
&gt; &nbsp; &nbsp; kind&nbsp;of&nbsp;guard&nbsp;if&nbsp;we&nbsp;perform&nbsp;a&nbsp;handshake&nbsp;with&nbsp;a&nbsp;lower&nbsp;version&nbsp;of&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; TLS&nbsp;protocol&nbsp;than&nbsp;we&nbsp;support.&nbsp;In&nbsp;this&nbsp;scenario,&nbsp;we&nbsp;receive&nbsp;downgrade&lt;br&gt;<br>
&gt; &nbsp; &nbsp; fallback error.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Handshake&nbsp;version&nbsp;TLSv1.2&nbsp;vs.&nbsp;max&nbsp;support&nbsp;TLSv1.3.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; In&nbsp;such&nbsp;case,&nbsp;we&nbsp;have&nbsp;the&nbsp;next&nbsp;error:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; ERROR:&nbsp;negotiating&nbsp;TLS&nbsp;on&nbsp;FD&nbsp;19:&nbsp;error:1425F175:SSL&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; routines:ssl_choose_client_version:inappropriate&nbsp;fallback&nbsp;(1/-1/0)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; OpenSSL&nbsp;already provided a&nbsp;fix&nbsp;for&nbsp;it.&nbsp;You&nbsp;can&nbsp;configure&nbsp;SSL&nbsp;session&lt;br&gt;<br>
&gt; &nbsp; &nbsp; to&nbsp;use&nbsp;option SSL_MODE_SEND_FALLBACK_SCSV&nbsp;and&nbsp;setting&nbsp;SSL&nbsp;max&nbsp;proto&lt;br&gt;<br>
&gt; &nbsp; &nbsp; version&nbsp;for&nbsp;current&nbsp;SSL&nbsp;session,&nbsp;but&nbsp;squid&nbsp;not&nbsp;yet&nbsp;supported&nbsp;these&lt;br&gt;<br>
&gt; &nbsp; &nbsp; features.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; You&nbsp;can&nbsp;find&nbsp;a&nbsp;patch&nbsp;in&nbsp;the&nbsp;attachments,&nbsp;will&nbsp;be&nbsp;grateful&nbsp;for&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; review.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;issue&nbsp;with&nbsp;TLS&nbsp;1.3&nbsp;support,&nbsp;we&nbsp;are&nbsp;still&nbsp;investigating,&nbsp;any&nbsp;advice&lt;br&gt;<br>
&gt;&nbsp;will&nbsp;be&nbsp;pleasant.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Best&nbsp;regards,&lt;br&gt;<br>
&gt;&nbsp;Yaroslav&nbsp;Pushko.&lt;br&gt;<br>
&gt;&nbsp;-- &lt;br&gt;<br>
&gt;&nbsp;Best&nbsp;Regards,&lt;br&gt;<br>
&gt;&nbsp;Yaroslav&nbsp;Pushko&nbsp;|&nbsp;Senior *Software&nbsp;Engineer*&lt;br&gt;<br>
&gt;&nbsp;GlobalLogic&lt;br&gt;<br>
&gt;&nbsp;P&nbsp;+380971842774&nbsp; M&nbsp;+380634232226&nbsp;S dithard&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.globallogic.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.globallogic.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://www.globallogic.com/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.globallogic.com/&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.globallogic.com/email_disclaimer.txt&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.globallogic.com/email_disclaimer.txt&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;Best&nbsp;Regards,&lt;br&gt;&lt;span&nbsp;style=&quot;vertical-align:baseline;font-variant:normal;font-style:normal;font-size:12px;background-color:transparent;text-decoration:none;font-family:Arial;font-weight:bold&quot;&gt;Yaroslav&nbsp;Pushko&nbsp;|&nbsp;Senior &lt;/span&gt;&lt;/font&gt;&lt;b&nbsp;style=&quot;font-family:arial,helvetica,sans-serif;font-size:12.8px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:9.5pt;font-family:Arial,sans-serif;color:rgb(51,51,51)&quot;&gt;Software&nbsp;Engineer&lt;/span&gt;&lt;/b&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;vertical-align:baseline;font-variant:normal;font-style:normal;font-size:12px;background-color:transparent;text-decoration:none;font-family:Arial;font-weight:normal&quot;&gt;GlobalLogic&lt;/span&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;vertical-align:baseline;font-variant:normal;font-style:normal;font-size:12px;background-color:transparent;text-decoration:none;font-family:Arial;font-weight:normal&quot;&gt;P&nbsp;+380971842774&nbsp; M&nbsp;+380634232226&nbsp;S dithard&lt;/span&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.globallogic.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;font-weight:normal;font-style:normal;font-variant:normal;text-decoration:underline;vertical-align:baseline&quot;&gt;www.globallogic.com&lt;/span&gt;&lt;/a&gt;&lt;span&nbsp;style=&quot;vertical-align:baseline;font-variant:normal;font-style:normal;font-size:12px;background-color:transparent;text-decoration:none;font-family:Arial;font-weight:normal&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.globallogic.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&nbsp;style=&quot;font-size:12px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;font-weight:normal;font-style:normal;font-variant:normal;text-decoration:underline;vertical-align:baseline&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.globallogic.com/email_disclaimer.txt&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;font-weight:normal;font-style:normal;font-variant:normal;text-decoration:underline;vertical-align:baseline&quot;&gt;http://www.globallogic.com/email_disclaimer.txt&lt;/span&gt;&lt;/a&gt;&lt;span&nbsp;style=&quot;vertical-align:baseline;font-variant:normal;font-style:normal;font-size:11px;background-color:transparent;text-decoration:none;font-family:Arial;font-weight:normal&quot;&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
