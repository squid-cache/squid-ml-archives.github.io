<tt>
&lt;div&nbsp;dir=&quot;rtl&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;B.H&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&gt;Tunneling&nbsp;it&nbsp;elsewhere,&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Where&nbsp;can&nbsp;I&nbsp;tunnel&nbsp;it?&nbsp;and&nbsp;how&nbsp;can&nbsp;I&nbsp;configure&nbsp;my&nbsp;machine&nbsp;to&nbsp;support&nbsp;it?&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&gt;You&nbsp;cannot&nbsp;have&nbsp;iptables&nbsp;suddenly&nbsp;divert&nbsp;packets&nbsp;to&nbsp;other&nbsp;software&nbsp;mid-stream.&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;want&nbsp;to&nbsp;tunnel&nbsp;it&nbsp;by&nbsp;IP&nbsp;or&nbsp;translate&nbsp;a&nbsp;group&nbsp;of&nbsp;URLs&nbsp;to&nbsp;IPs&nbsp;I&#39;m not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is the&nbsp;case&nbsp;that&nbsp;you&nbsp;mentioned,&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Because&nbsp;I&nbsp;can&nbsp;do&nbsp;it&nbsp;before&nbsp;squid&nbsp;handles&nbsp;TCP&nbsp;session&nbsp;initialization.&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;The&nbsp;issue&nbsp;here&nbsp;is&nbsp;as I&nbsp;said&nbsp;that&nbsp;I&nbsp;want&nbsp;bypass&nbsp;WSS&nbsp;and&nbsp;other&nbsp;stuff&nbsp;that&nbsp;squid&nbsp;can&#39;t&nbsp;technically&nbsp;support&nbsp;for&nbsp;known list&nbsp;of&nbsp;IPs&nbsp;(or&nbsp;URLS).&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Do&nbsp;you&nbsp;have any&nbsp;recommended configuration for&nbsp;this&nbsp;requirement?&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Ben&lt;/div&gt;suddenly&nbsp;divert&nbsp;packets&nbsp;to&nbsp;other&nbsp;software&nbsp;mid-stream.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;rtl&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;‫בתאריך&nbsp;יום&nbsp;ב׳,&nbsp;25&nbsp;במאי&nbsp;2020&nbsp;ב-9:56&nbsp;מאת&nbsp;‪Amos&nbsp;Jeffries‬‏&nbsp;&lt;‪&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;‬‏&gt;:‬&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;21/05/20&nbsp;3:49&nbsp;am,&nbsp;Ben&nbsp;Goz&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;B.H.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;using&nbsp;squid&nbsp;with&nbsp;c-icap&nbsp;module&nbsp;for&nbsp;specific&nbsp;content&nbsp;filtering.&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;configured&nbsp;squid&nbsp;with&nbsp;ssl&nbsp;bump&nbsp;so&nbsp;website&nbsp;with&nbsp;WSS&nbsp;won&#39;t&nbsp;work&nbsp;on&nbsp;it&nbsp;as&lt;br&gt;<br>
&gt;&nbsp;mentioned&nbsp;on&nbsp;squid&nbsp;documentation.&nbsp;So&nbsp;for&nbsp;such&nbsp;URLs&nbsp;(with&nbsp;WSS)&nbsp;I&nbsp;need&lt;br&gt;<br>
&gt;&nbsp;bypassing&nbsp;squid.&nbsp;I&nbsp;read&nbsp;in&nbsp;some&nbsp;posts&nbsp;that&nbsp;squid&nbsp;doesn&#39;t&nbsp;fully&nbsp;supports&lt;br&gt;<br>
&gt;&nbsp;bypassing&nbsp;URLs&nbsp;and&nbsp;best&nbsp;way&nbsp;is&nbsp;to&nbsp;bypasses&nbsp;it&nbsp;via&nbsp;iptables.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Eventually&nbsp;I&nbsp;redirects&nbsp;browser&nbsp;traffic&nbsp;to&nbsp;my&nbsp;proxy&nbsp;machine&nbsp;using&nbsp;local&lt;br&gt;<br>
&gt;&nbsp;machine&nbsp;proxy&nbsp;settings,&nbsp;and&nbsp;Its&nbsp;redirects&nbsp;traffic&nbsp;to&nbsp;my&nbsp;machine&nbsp;with&nbsp;IP&lt;br&gt;<br>
&gt;&nbsp;x.x.x.x&nbsp;port&nbsp;3128.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;If&nbsp;I&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;conservative&nbsp;iptables&nbsp;bypassing&nbsp;how&nbsp;should&nbsp;I&nbsp;config&lt;br&gt;<br>
&gt;&nbsp;my&nbsp;machine?&nbsp;and&nbsp;how&nbsp;iptables&nbsp;rules&nbsp;should&nbsp;looks&nbsp;like?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Since&nbsp;you&nbsp;are&nbsp;redirecting&nbsp;the&nbsp;traffic&nbsp;to&nbsp;Squid&nbsp;in&nbsp;the&nbsp;first&nbsp;place.&nbsp;All&lt;br&gt;<br>
you&nbsp;have&nbsp;to&nbsp;do&nbsp;is&nbsp;*not*&nbsp;redirect&nbsp;the&nbsp;relevant&nbsp;traffic.&nbsp;See&nbsp;your&nbsp;firewall&lt;br&gt;<br>
software&nbsp;documentation&nbsp;on&nbsp;how&nbsp;to&nbsp;configure&nbsp;that.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;hard&nbsp;part&nbsp;is&nbsp;figuring&nbsp;out&nbsp;which&nbsp;traffic&nbsp;you&nbsp;want&nbsp;the&nbsp;proxy&nbsp;to&lt;br&gt;<br>
service,&nbsp;and&nbsp;what&nbsp;to&nbsp;bypass&nbsp;given&nbsp;only&nbsp;a&nbsp;TCP&nbsp;SYN&nbsp;packet.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Be&nbsp;aware&nbsp;that&nbsp;once&nbsp;a&nbsp;TCP&nbsp;SYN+ACK&nbsp;packet&nbsp;is&nbsp;delivered&nbsp;to&nbsp;accept&nbsp;the&lt;br&gt;<br>
connection&nbsp;Squid&nbsp;*has*&nbsp;to&nbsp;service&nbsp;that&nbsp;TCP&nbsp;connection&nbsp;in&nbsp;its&nbsp;entirety.&lt;br&gt;<br>
Such&nbsp;&#39;service&#39;&nbsp;may&nbsp;mean&nbsp;terminating&nbsp;it&nbsp;without&nbsp;any&nbsp;traffic,&nbsp;tunneling&nbsp;it&lt;br&gt;<br>
elsewhere,&nbsp;or&nbsp;full&nbsp;processing&nbsp;of&nbsp;the&nbsp;traffic.&lt;br&gt;<br>
 Either&nbsp;way&nbsp;Squid&nbsp;is&nbsp;the&nbsp;agent&nbsp;servicing&nbsp;it.&nbsp;You&nbsp;cannot&nbsp;have&nbsp;iptables&lt;br&gt;<br>
suddenly&nbsp;divert&nbsp;packets&nbsp;to&nbsp;other&nbsp;software&nbsp;mid-stream.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
