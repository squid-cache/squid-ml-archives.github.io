<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;style=&quot;display:none;&quot;&gt;&nbsp;P&nbsp;{margin-top:0;margin-bottom:0;}&nbsp;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;Arial,&nbsp;Helvetica,&nbsp;sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;&gt;<br>
It's&nbsp;allready&nbsp;the&nbsp;case,&nbsp;the&nbsp;server&nbsp;as&nbsp;a&nbsp;public&nbsp;IP&nbsp;and&nbsp;a&nbsp;valid&nbsp;cert.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;Arial,&nbsp;Helvetica,&nbsp;sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;&gt;<br>
As&nbsp;Amos&nbsp;says,&nbsp;it&nbsp;is&nbsp;related&nbsp;to&nbsp;the&nbsp;gnutls&nbsp;implementation&nbsp;which&nbsp;is&nbsp;experimental.&nbsp;squid&nbsp;has&nbsp;to&nbsp;be&nbsp;built&nbsp;with&nbsp;openssl&nbsp;to&nbsp;support&nbsp;chain&nbsp;certificates.&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;id=&quot;appendonsend&quot;&gt;&lt;/div&gt;<br>
&lt;hr&nbsp;style=&quot;display:inline-block;width:98%&quot;&nbsp;tabindex=&quot;-1&quot;&gt;<br>
&lt;div&nbsp;id=&quot;divRplyFwdMsg&quot;&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&nbsp;style=&quot;font-size:11pt&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;b&gt;De&nbsp;:&lt;/b&gt;&nbsp;Ronan&nbsp;Lucio&nbsp;&lt;ronanlucio@gmail.com&gt;&lt;br&gt;<br>
&lt;b&gt;Envoyé&nbsp;:&lt;/b&gt;&nbsp;mercredi&nbsp;27&nbsp;mai&nbsp;2020&nbsp;02:10&lt;br&gt;<br>
&lt;b&gt;À&nbsp;:&lt;/b&gt;&nbsp;Julien&nbsp;TEHERY&nbsp;&lt;julien.tehery@mediactivegroup.com&gt;&lt;br&gt;<br>
&lt;b&gt;Cc&nbsp;:&lt;/b&gt;&nbsp;squid-users@lists.squid-cache.org&nbsp;&lt;squid-users@lists.squid-cache.org&gt;&lt;br&gt;<br>
&lt;b&gt;Objet&nbsp;:&lt;/b&gt;&nbsp;Re:&nbsp;[squid-users]&nbsp;HTTPS_PORT&nbsp;AND&nbsp;SSL&nbsp;CERT&lt;/font&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;BodyFragment&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;PlainText&quot;&gt;If&nbsp;your&nbsp;server&nbsp;listens&nbsp;on&nbsp;a&nbsp;public&nbsp;IP,&nbsp;you&nbsp;can&nbsp;use&nbsp;a&nbsp;valid&nbsp;certificate.&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tue,&nbsp;May&nbsp;26,&nbsp;2020&nbsp;at&nbsp;7:24&nbsp;PM&nbsp;Julien&nbsp;TEHERY&lt;br&gt;<br>
&lt;julien.tehery@mediactivegroup.com&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;there,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I'm&nbsp;actually&nbsp;facing&nbsp;a&nbsp;problem&nbsp;with&nbsp;Squid&nbsp;4.6-1&nbsp;(Debian&nbsp;10).&lt;br&gt;<br>
&gt;&nbsp;I'm&nbsp;using&nbsp;squid&nbsp;with&nbsp;https_port&nbsp;directive,&nbsp;using&nbsp;an&nbsp;SSL&nbsp;certficate&nbsp;(&nbsp;a&nbsp;true&nbsp;one,&nbsp;not&nbsp;self&nbsp;signed)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Here&nbsp;is&nbsp;the&nbsp;simple&nbsp;setup:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;https_port&nbsp;X.X.X.X:8443&nbsp;tls-cert=/etc/squid/mywildcard.com.pem&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;fact&nbsp;is&nbsp;that&nbsp;setup&nbsp;works&nbsp;for&nbsp;all&nbsp;firefox&nbsp;version&nbsp;using&nbsp;a&nbsp;proxy.pac&nbsp;file&nbsp;for&nbsp;HTTPS&nbsp;connexions&nbsp;to&nbsp;the&nbsp;squid&nbsp;server.&lt;br&gt;<br>
&gt;&nbsp;But&nbsp;for&nbsp;chrome&nbsp;this&nbsp;is&nbsp;quite&nbsp;different.&nbsp;Indeed&nbsp;chrome&nbsp;uses&nbsp;the&nbsp;system's&nbsp;proxy&nbsp;settings&nbsp;and&nbsp;i&nbsp;noticed&nbsp;that&nbsp;sometimes&nbsp;it&nbsp;would&nbsp;work&nbsp;and&nbsp;sometinles&nbsp;it&nbsp;would&nbsp;fail.&lt;br&gt;<br>
&gt;&nbsp;To&nbsp;make&nbsp;it&nbsp;work&nbsp;all&nbsp;the&nbsp;time&nbsp;i&nbsp;had&nbsp;to&nbsp;add&nbsp;my&nbsp;intermediate&nbsp;certificate&nbsp;(thawte)&nbsp;in&nbsp;the&nbsp;local&nbsp;store,&nbsp;so&nbsp;that&nbsp;means&nbsp;intermediate&nbsp;certificate&nbsp;has&nbsp;not&nbsp;been&nbsp;delivered&nbsp;by&nbsp;the&nbsp;squid&nbsp;server&nbsp;as&nbsp;it&nbsp;should.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;pem&nbsp;file&nbsp;in&nbsp;the&nbsp;above&nbsp;setup&nbsp;allreadycontains&nbsp;this&nbsp;(pem&nbsp;file&nbsp;done&nbsp;by&nbsp;concatenating&nbsp;&nbsp;private&nbsp;key,&nbsp;cert,&nbsp;intermediate&nbsp;and&nbsp;root&nbsp;CA.&nbsp;I&nbsp;also&nbsp;tried&nbsp;the&nbsp;following&nbsp;syntax:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;https_port&nbsp;X.X.X.X:8443&nbsp;cert=/etc/squid/mywildcard..com.cer&nbsp;key=/etc/squid/mywildcard.com.key&nbsp;cafile=/etc/squid/mywildcard..com-intermediaire.txt&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;each&nbsp;time&nbsp;i&nbsp;try&nbsp;to&nbsp;see&nbsp;with&nbsp;openssl&nbsp;client&nbsp;if&nbsp;my&nbsp;intermediate&nbsp;is&nbsp;delivered,&nbsp;it's&nbsp;not&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;use&nbsp;&quot;openssl&nbsp;s_client&nbsp;-showcerts&nbsp;-connect&nbsp;myproxy.com:8443&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;If&nbsp;i&nbsp;do&nbsp;the&nbsp;same&nbsp;thing&nbsp;on&nbsp;an&nbsp;apache&nbsp;server&nbsp;with&nbsp;the&nbsp;same&nbsp;certificate&nbsp;files&nbsp;i&nbsp;can&nbsp;see&nbsp;both&nbsp;certificate&nbsp;and&nbsp;intermediate.&nbsp;Why&nbsp;squid&nbsp;isn't&nbsp;able&nbsp;to&nbsp;show&nbsp;it,&nbsp;did&nbsp;i&nbsp;miss&nbsp;something&nbsp;?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Thanks&nbsp;for&nbsp;your&nbsp;help&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
