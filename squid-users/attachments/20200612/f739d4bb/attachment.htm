<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;Alex,&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&#39;s&nbsp;working&nbsp;as&nbsp;expected.&nbsp;I&nbsp;tried&nbsp;to&nbsp;allow&nbsp;only&nbsp;specific&nbsp;domains&nbsp;during&nbsp;the&nbsp;time&nbsp;by&nbsp;adding&nbsp;below&nbsp;acl&nbsp;but&nbsp;I&#39;m&nbsp;getting&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;503&nbsp;in&nbsp;my&nbsp;access.log,&nbsp;below&nbsp;is&nbsp;my&nbsp;configuration.&nbsp;Could&nbsp;you&nbsp;please&nbsp;let&nbsp;me&nbsp;know&nbsp;what&nbsp;I&#39;m&nbsp;missing&nbsp;here.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;usePeerB&nbsp;time&nbsp;00:30-00:59&lt;br&gt;acl&nbsp;usePeerB&nbsp;time&nbsp;02:00-02:29&lt;/div&gt;&lt;div&gt;acl&nbsp;alloweddomains&nbsp;dstdomain&nbsp;&lt;a&nbsp;href=&quot;http://google.com&quot;&gt;google.com&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://facebook.com&quot;&gt;facebook.com&lt;/a&gt;&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;cache_peer_access&nbsp;peerA&nbsp;allow&nbsp;usePeerA&nbsp;allowedomains&lt;br&gt;cache_peer_access&nbsp;peerB&nbsp;allow&nbsp;usePeerB&nbsp;allowedomains&nbsp;&lt;br&gt;cache_peer_access&nbsp;peerC&nbsp;allow&nbsp;!usePeerA&nbsp;!userPeerB&nbsp;alloweddomains&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Thu,&nbsp;Jun&nbsp;11,&nbsp;2020&nbsp;at&nbsp;4:54&nbsp;AM&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;6/10/20&nbsp;12:20&nbsp;PM,&nbsp;Antony&nbsp;Stone&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Wednesday&nbsp;10&nbsp;June&nbsp;2020&nbsp;at&nbsp;18:11:03,&nbsp;Prem&nbsp;Chand&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&gt;&nbsp;Hi&nbsp;Alex,&lt;br&gt;<br>
&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;Thanks&nbsp;for&nbsp;responding&nbsp;to&nbsp;my&nbsp;issue &nbsp;.&nbsp;I&nbsp;didn&#39;t&nbsp;get&nbsp;how&nbsp;the&nbsp;math&nbsp;was&nbsp;done(why&lt;br&gt;<br>
&gt;&gt;&nbsp;it&#39;s&nbsp;multiplied&nbsp;by&nbsp;2)&nbsp;to&nbsp;get&nbsp;16&nbsp;slots&nbsp;if&nbsp;possible&nbsp;could&nbsp;you&nbsp;please&nbsp;elaborate&lt;br&gt;<br>
&gt;&gt;&nbsp;with&nbsp;an&nbsp;example.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;believe&nbsp;what&nbsp;Alex&nbsp;meant&nbsp;was:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;You&nbsp;want&nbsp;30&nbsp;minute&nbsp;timeslots&nbsp;for&nbsp;each&nbsp;of&nbsp;3&nbsp;peers,&nbsp;which&nbsp;is&nbsp;48&nbsp;half-hour&nbsp;&lt;br&gt;<br>
&gt;&nbsp;timeslots&nbsp;throughout&nbsp;the&nbsp;day.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;However,&nbsp;you&nbsp;only&nbsp;need&nbsp;to&nbsp;define&nbsp;48/3&nbsp;of&nbsp;these&nbsp;for&nbsp;peer&nbsp;A,&nbsp;and&nbsp;48/3&nbsp;of&nbsp;them&nbsp;for&nbsp;&lt;br&gt;<br>
&gt;&nbsp;peer&nbsp;B,&nbsp;and&nbsp;then&nbsp;let&nbsp;peer&nbsp;C&nbsp;deal&nbsp;with&nbsp;anything&nbsp;not&nbsp;already&nbsp;handled&nbsp;(so&nbsp;it&nbsp;&lt;br&gt;<br>
&gt;&nbsp;doesn&#39;t&nbsp;need&nbsp;its&nbsp;own&nbsp;definitions).&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;48/3&nbsp;=&nbsp;16,&nbsp;therefore&nbsp;you&nbsp;define&nbsp;16&nbsp;half-hour&nbsp;periods&nbsp;when&nbsp;you&nbsp;want&nbsp;peer&nbsp;A&nbsp;to&nbsp;do&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;work,&nbsp;16&nbsp;half-hour&nbsp;periods&nbsp;for&nbsp;peer&nbsp;B,&nbsp;and&nbsp;then&nbsp;just&nbsp;say&nbsp;&quot;peer&nbsp;C,&nbsp;handle&nbsp;&lt;br&gt;<br>
&gt;&nbsp;anything&nbsp;left&nbsp;over&quot;.&lt;br&gt;<br>
&lt;br&gt;<br>
Thank&nbsp;you,&nbsp;Antony!&nbsp;Here&nbsp;is&nbsp;an&nbsp;untested&nbsp;sketch:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;acl&nbsp;usePeerA&nbsp;time&nbsp;00:00-00:29&lt;br&gt;<br>
 &nbsp;acl&nbsp;usePeerA&nbsp;time&nbsp;01:30-01:59&lt;br&gt;<br>
 &nbsp;...&nbsp;a&nbsp;total&nbsp;of&nbsp;16&nbsp;ORed&nbsp;lines&nbsp;for&nbsp;the&nbsp;first&nbsp;peer&nbsp;...&lt;br&gt;<br>
 &nbsp;...&nbsp;each&nbsp;line&nbsp;matches&nbsp;a&nbsp;unique&nbsp;30&nbsp;minute&nbsp;period&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;acl&nbsp;usePeerB&nbsp;time&nbsp;00:30-00:59&lt;br&gt;<br>
 &nbsp;acl&nbsp;usePeerB&nbsp;time&nbsp;02:00-02:29&lt;br&gt;<br>
 &nbsp;...&nbsp;a&nbsp;total&nbsp;of&nbsp;16&nbsp;ORed&nbsp;lines&nbsp;for&nbsp;the&nbsp;second&nbsp;peer&nbsp;...&lt;br&gt;<br>
 &nbsp;...&nbsp;each&nbsp;line&nbsp;matches&nbsp;a&nbsp;unique&nbsp;30&nbsp;minute&nbsp;period&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;#&nbsp;and&nbsp;now&nbsp;match&nbsp;peer&nbsp;to&nbsp;its&nbsp;time&nbsp;slots&lt;br&gt;<br>
 &nbsp;cache_peer_access&nbsp;peerA&nbsp;allow&nbsp;usePeerA&lt;br&gt;<br>
 &nbsp;cache_peer_access&nbsp;peerB&nbsp;allow&nbsp;usePeerB&lt;br&gt;<br>
 &nbsp;cache_peer_access&nbsp;peerC&nbsp;allow&nbsp;!usePeerA&nbsp;!userPeerB&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;above&nbsp;may&nbsp;need&nbsp;further&nbsp;adjustments&nbsp;and&nbsp;polishing.&nbsp;For&nbsp;example,&nbsp;I&nbsp;am&lt;br&gt;<br>
not&nbsp;sure&nbsp;how&nbsp;Squid&nbsp;will&nbsp;round&nbsp;these&nbsp;time&nbsp;values.&nbsp;The&nbsp;above&nbsp;assumes&nbsp;that&lt;br&gt;<br>
00:29&nbsp;limit&nbsp;includes&nbsp;all&nbsp;60&nbsp;seconds&nbsp;up&nbsp;to&nbsp;(but&nbsp;excluding)&nbsp;00:30:00.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&gt;&nbsp;On&nbsp;Wed,&nbsp;Jun&nbsp;10,&nbsp;2020&nbsp;at&nbsp;7:12&nbsp;PM&nbsp;Alex&nbsp;Rousskov&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;On&nbsp;6/10/20&nbsp;6:09&nbsp;AM,&nbsp;Prem&nbsp;Chand&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;My&nbsp;squid&nbsp;cache&nbsp;peer&nbsp;has&nbsp;3&nbsp;parent&nbsp;IP’s&nbsp;configured.&nbsp;I&nbsp;need&nbsp;to&nbsp;send&nbsp;HTTPS&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;requests&nbsp;to&nbsp;the&nbsp;first&nbsp;parent&nbsp;IP&nbsp;for&nbsp;30&nbsp;minutes&nbsp;and&nbsp;after&nbsp;to&nbsp;the&nbsp;2nd&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;parent&nbsp;IP&nbsp;for&nbsp;30&nbsp;minutes&nbsp;and&nbsp;then&nbsp;to&nbsp;3rd&nbsp;IP&nbsp;for&nbsp;30&nbsp;minutes&nbsp;and&nbsp;this&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;switching&nbsp;needs&nbsp;to&nbsp;happen&nbsp;continuously&nbsp;.Could&nbsp;you&nbsp;please&nbsp;let&nbsp;us&nbsp;know&lt;br&gt;<br>
&gt;&gt;&gt;&gt;&nbsp;how&nbsp;I&nbsp;can&nbsp;achieve&nbsp;this?&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;If&nbsp;you&nbsp;are&nbsp;OK&nbsp;with&nbsp;hard-coded&nbsp;usage&nbsp;time&nbsp;slots&nbsp;for&nbsp;each&nbsp;peer,&nbsp;then&nbsp;I&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;would&nbsp;use&nbsp;two[1]&nbsp;&quot;time&quot;&nbsp;ACLs&nbsp;and&nbsp;cache_peer_access&nbsp;rules.&nbsp;Look&nbsp;for&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;&quot;aclname&nbsp;time&quot;&nbsp;in&nbsp;squid.conf.documented.&nbsp;You&nbsp;will&nbsp;have&nbsp;to&nbsp;generate&nbsp;a&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;list&nbsp;of&nbsp;(24*2/3=16)&nbsp;staggered&nbsp;time&nbsp;slots&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;two&nbsp;ACLs,&nbsp;but&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;it&nbsp;should&nbsp;work.&nbsp;This&nbsp;may&nbsp;be&nbsp;the&nbsp;simplest&nbsp;solution.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;[1]&nbsp;You&nbsp;need&nbsp;two&nbsp;ACLs&nbsp;for&nbsp;three&nbsp;peers&nbsp;because&nbsp;the&nbsp;third&nbsp;peer&nbsp;should&nbsp;get&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;the&nbsp;requests&nbsp;that&nbsp;the&nbsp;first&nbsp;two&nbsp;peers&nbsp;were&nbsp;not&nbsp;allowed&nbsp;to&nbsp;get.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;----&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;With&nbsp;a&nbsp;modern&nbsp;Squid,&nbsp;you&nbsp;could&nbsp;also&nbsp;implement&nbsp;this&nbsp;using&nbsp;a&nbsp;more&nbsp;flexible&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;(and&nbsp;more&nbsp;expensive,&nbsp;on&nbsp;several&nbsp;layers!)&nbsp;architecture&nbsp;with&nbsp;two&nbsp;ACLs:&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;1.&nbsp;An&nbsp;external&nbsp;ACL&nbsp;that&nbsp;returns&nbsp;the&nbsp;right&nbsp;cache&nbsp;peer&nbsp;name&nbsp;to&nbsp;use&nbsp;via&nbsp;a&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;keyword=value&nbsp;annotation&nbsp;API.&nbsp;This&nbsp;always-matching&nbsp;ACL&nbsp;should&nbsp;be&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;attached&nbsp;to&nbsp;http_access&nbsp;or&nbsp;a&nbsp;similar&nbsp;directive&nbsp;that&nbsp;supports&nbsp;slow&nbsp;ACLs.&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Its&nbsp;goal&nbsp;is&nbsp;to&nbsp;annotate&nbsp;the&nbsp;request.&nbsp;You&nbsp;will&nbsp;need&nbsp;to&nbsp;write&nbsp;a&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;script/program&nbsp;that&nbsp;will&nbsp;compute&nbsp;the&nbsp;right&nbsp;annotations&nbsp;based&nbsp;on&nbsp;time&nbsp;or&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;some&nbsp;other&nbsp;factors.&nbsp;This&nbsp;is&nbsp;where&nbsp;the&nbsp;flexibility&nbsp;of&nbsp;this&nbsp;solution&nbsp;is&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;coming&nbsp;from.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;2.&nbsp;A&nbsp;&quot;note&quot;&nbsp;ACL&nbsp;attached&nbsp;to&nbsp;cache_peer_access&nbsp;directives,&nbsp;allowing&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;access&nbsp;to&nbsp;peer&nbsp;X&nbsp;if&nbsp;the&nbsp;external&nbsp;ACL&nbsp;in&nbsp;item&nbsp;1&nbsp;returned&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;use_cache_peer_=X.&nbsp;The&nbsp;&quot;note&quot;&nbsp;ACL&nbsp;is&nbsp;a&nbsp;fast&nbsp;ACL&nbsp;and,&nbsp;hence,&nbsp;can&nbsp;be&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;reliably&nbsp;used&nbsp;with&nbsp;cache_peer_access.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;If&nbsp;you&nbsp;already&nbsp;have&nbsp;another&nbsp;external&nbsp;ACL,&nbsp;you&nbsp;may&nbsp;be&nbsp;able&nbsp;to&nbsp;piggyback&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;annotations&nbsp;in&nbsp;item&nbsp;1&nbsp;to&nbsp;whatever&nbsp;that&nbsp;ACL&nbsp;is&nbsp;already&nbsp;doing.&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;For&nbsp;more&nbsp;information,&nbsp;search&nbsp;for&nbsp;&quot;keyword=value&quot;&nbsp;and&nbsp;&quot;acl&nbsp;aclname&nbsp;note&quot;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;in&nbsp;your&nbsp;squid.conf.documented&nbsp;and&nbsp;see&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/AddonHelpers#Access_Control_.28ACL&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/Features/AddonHelpers#Access_Control_.28ACL&lt;/a&gt;.&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;29&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;HTH,&lt;br&gt;<br>
&gt;&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;Alex.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;prem&lt;/div&gt;<br>

</tt>
