<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&gt;<br>
&lt;div&gt;Hi,&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've&nbsp;noticed&nbsp;one&nbsp;more&nbsp;difference&nbsp;between&nbsp;the&nbsp;CONNECT&nbsp;packets&nbsp;(it&nbsp;appears&nbsp;in&nbsp;the&nbsp;HTTP&nbsp;layer):&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&gt;&nbsp;client's&nbsp;firefox&nbsp;configured&nbsp;with&nbsp;the&nbsp;ip&nbsp;and&nbsp;port&nbsp;of&nbsp;the&nbsp;parent&nbsp;proxy&nbsp;(172.16.103.254:3128),&nbsp;surf&nbsp;on&nbsp;the&nbsp;Net&nbsp;ok:&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Frame&nbsp;58:&nbsp;255&nbsp;bytes&nbsp;on&nbsp;wire&nbsp;(2040&nbsp;bits),&nbsp;255&nbsp;bytes&nbsp;captured&nbsp;(2040&nbsp;bits)&nbsp;on&nbsp;interface&nbsp;eth1,&nbsp;id&nbsp;0&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ethernet&nbsp;II,&nbsp;Src:&nbsp;D-LinkIn_79:24:ed&nbsp;(ac:f1:df:79:24:ed),&nbsp;Dst:&nbsp;VMware_92:8a:f2&nbsp;(00:0c:29:92:8a:f2)&lt;br&gt;&lt;/div&gt;&lt;div&gt;Internet&nbsp;Protocol&nbsp;Version&nbsp;4,&nbsp;Src:&nbsp;172.16.103.101,&nbsp;Dst:&nbsp;172.16.103.254&lt;br&gt;&lt;/div&gt;&lt;div&gt;Transmission&nbsp;Control&nbsp;Protocol,&nbsp;Src&nbsp;Port:&nbsp;35604,&nbsp;Dst&nbsp;Port:&nbsp;3128,&nbsp;Seq:&nbsp;1,&nbsp;Ack:&nbsp;1,&nbsp;Len:&nbsp;201&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hypertext&nbsp;Transfer&nbsp;Protocol&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443&lt;/a&gt;&nbsp;HTTP/1.1\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;Linux&nbsp;x86_64;&nbsp;rv:68.0)&nbsp;Gecko/20100101&nbsp;Firefox/68.0\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Proxy-Connection:&nbsp;keep-alive\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Connection:&nbsp;keep-alive\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Host:&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443\r\n&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443\r\n&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[Full&nbsp;request&nbsp;URI:&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443&lt;/a&gt;]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[HTTP&nbsp;request&nbsp;1/1]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[Response&nbsp;in&nbsp;frame:&nbsp;62]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&gt;&nbsp;client's&nbsp;firefox&nbsp;configured&nbsp;to&nbsp;use&nbsp;system&nbsp;proxy&nbsp;settings&nbsp;(can't&nbsp;surf&nbsp;on&nbsp;the&nbsp;Net):&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Frame&nbsp;620:&nbsp;295&nbsp;bytes&nbsp;on&nbsp;wire&nbsp;(2360&nbsp;bits),&nbsp;295&nbsp;bytes&nbsp;captured&nbsp;(2360&nbsp;bits)&nbsp;on&nbsp;interface&nbsp;eth1,&nbsp;id&nbsp;0&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ethernet&nbsp;II,&nbsp;Src:&nbsp;D-LinkIn_79:24:ed&nbsp;(ac:f1:df:79:24:ed),&nbsp;Dst:&nbsp;VMware_92:8a:f2&nbsp;(00:0c:29:92:8a:f2)&lt;br&gt;&lt;/div&gt;&lt;div&gt;Internet&nbsp;Protocol&nbsp;Version&nbsp;4,&nbsp;Src:&nbsp;172.16.103.101,&nbsp;Dst:&nbsp;172.16.103.254&lt;br&gt;&lt;/div&gt;&lt;div&gt;Transmission&nbsp;Control&nbsp;Protocol,&nbsp;Src&nbsp;Port:&nbsp;35528,&nbsp;Dst&nbsp;Port:&nbsp;3128,&nbsp;Seq:&nbsp;1,&nbsp;Ack:&nbsp;1,&nbsp;Len:&nbsp;241&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hypertext&nbsp;Transfer&nbsp;Protocol&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443&lt;/a&gt;&nbsp;HTTP/1.1\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;Linux&nbsp;x86_64;&nbsp;rv:68.0)&nbsp;Gecko/20100101&nbsp;Firefox/68.0\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Host:&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443\r\n&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443\r\n&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Via:&nbsp;1.1&nbsp;tjener.intern&nbsp;(squid/4.6)\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;X-Forwarded-For:&nbsp;10.0.2.2\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;request&nbsp;field&nbsp;introduit&nbsp;par&nbsp;squid&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;Cache-Control:&nbsp;max-age=259200\r\n&nbsp;&nbsp;-&gt;&nbsp;si&nbsp;on&nbsp;vire&nbsp;le&nbsp;cache&nbsp;dans&nbsp;la&nbsp;config,&nbsp;tjs&nbsp;l√†&nbsp;?&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[Full&nbsp;request&nbsp;URI:&nbsp;&lt;a&nbsp;href=&quot;http://www.google.com:443&quot;&nbsp;rel=&quot;noopener&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.google.com:443&lt;/a&gt;]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[HTTP&nbsp;request&nbsp;1/1]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;[Response&nbsp;in&nbsp;frame:&nbsp;624]&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Remarks:&nbsp;tjener.inter&nbsp;is&nbsp;my&nbsp;server&nbsp;with&nbsp;squid&nbsp;(172.16.103.101)&nbsp;and&nbsp;172.16.103.254:3128&nbsp;is&nbsp;the&nbsp;parent.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.0.2.2&nbsp;is&nbsp;the&nbsp;IP&nbsp;of&nbsp;the&nbsp;client.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;have&nbsp;any&nbsp;idea&nbsp;to&nbsp;help&nbsp;me&nbsp;to&nbsp;fix&nbsp;this&nbsp;....&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;answer.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yannick&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Securely&nbsp;sent&nbsp;with&nbsp;Tutanota.&nbsp;Get&nbsp;your&nbsp;own&nbsp;encrypted,&nbsp;ad-free&nbsp;mailbox:&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;https://tutanota.com&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jun&nbsp;26,&nbsp;2020,&nbsp;07:11&nbsp;by&nbsp;squid3@treenet.co.nz:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;tutanota_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;#93A3B8;&nbsp;padding-left:&nbsp;10px;&nbsp;margin-left:&nbsp;5px;&quot;&gt;&lt;div&gt;On&nbsp;24/06/20&nbsp;7:27&nbsp;am,&nbsp;yannick.rousseau@tutanota.com&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;div&gt;Hi,&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm&nbsp;using&nbsp;squid&nbsp;(4.6)&nbsp;on&nbsp;my&nbsp;server&nbsp;(debianedu&nbsp;buster&nbsp;LTSP),&nbsp;and&nbsp;I'm&lt;br&gt;&lt;/div&gt;&lt;div&gt;trying&nbsp;to&nbsp;configure&nbsp;a&nbsp;parent&nbsp;proxy.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;first,&nbsp;when&nbsp;I&nbsp;configure&nbsp;the&nbsp;client's&nbsp;firefox&nbsp;(manual&nbsp;proxy&lt;br&gt;&lt;/div&gt;&lt;div&gt;configuration)&nbsp;with&nbsp;the&nbsp;ip&nbsp;and&nbsp;port&nbsp;of&nbsp;the&nbsp;parent&nbsp;proxy,&nbsp;it's&nbsp;ok,&nbsp;I&nbsp;can&lt;br&gt;&lt;/div&gt;&lt;div&gt;surf&nbsp;on&nbsp;the&nbsp;internet.&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;configure&nbsp;my&nbsp;server's&nbsp;Squid&nbsp;Proxy&nbsp;to&nbsp;forward&nbsp;to&nbsp;a&lt;br&gt;&lt;/div&gt;&lt;div&gt;parent&nbsp;proxy&nbsp;(172.16.103.254:3128)&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&gt;&nbsp;So&nbsp;I&nbsp;add&nbsp;these&nbsp;two&nbsp;lines&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;squid.conf:&lt;br&gt;&lt;/div&gt;&lt;div&gt;cache_peer&nbsp;172.16.103.254&nbsp;parent&nbsp;3128&nbsp;0&nbsp;no-query&nbsp;no-digest&lt;br&gt;&lt;/div&gt;&lt;div&gt;never_direct&nbsp;allow&nbsp;all&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&gt;&nbsp;And&nbsp;restart&nbsp;squid.&nbsp;It&nbsp;seems&nbsp;to&nbsp;be&nbsp;ok:&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;cat&nbsp;/var/log/squid/cache.log&lt;br&gt;&lt;/div&gt;&lt;div&gt;(.....)&lt;br&gt;&lt;/div&gt;&lt;div&gt;2020/06/23&nbsp;09:51:12&nbsp;kid1|&nbsp;Configuring&nbsp;Parent&nbsp;172.16.103.254/3128/0&lt;br&gt;&lt;/div&gt;&lt;div&gt;(....)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&gt;&nbsp;Then&nbsp;I&nbsp;configure&nbsp;firefox&nbsp;to&nbsp;use&nbsp;system&nbsp;proxy&nbsp;settings,&nbsp;but&nbsp;when&nbsp;I&nbsp;try&lt;br&gt;&lt;/div&gt;&lt;div&gt;to&nbsp;google&nbsp;something&nbsp;or&nbsp;visit&nbsp;debian-fr.org,&nbsp;it&nbsp;doesn't&nbsp;work&nbsp;(no&nbsp;reponse&lt;br&gt;&lt;/div&gt;&lt;div&gt;from&nbsp;the&nbsp;proxy).&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;is&nbsp;odd.&nbsp;The&nbsp;log&nbsp;shows&nbsp;a&nbsp;403&nbsp;response&nbsp;being&nbsp;delivered&nbsp;by&nbsp;the&nbsp;parent&lt;br&gt;&lt;/div&gt;&lt;div&gt;proxy&nbsp;and&nbsp;delivered&nbsp;to&nbsp;Firefox.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Browsers&nbsp;refuse&nbsp;to&nbsp;display&nbsp;proxy&nbsp;responses&nbsp;on&nbsp;CONNECT&nbsp;requests.&nbsp;So&nbsp;the&lt;br&gt;&lt;/div&gt;&lt;div&gt;first&nbsp;is&nbsp;expected.&nbsp;But&nbsp;the&nbsp;second&nbsp;one&nbsp;using&nbsp;http://&nbsp;should&nbsp;be&nbsp;shown.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;div&gt;But&nbsp;my&nbsp;squid's&nbsp;configuration&nbsp;seems&nbsp;to&nbsp;be&nbsp;ok:&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;cat&nbsp;/var/log/squid/access.log&lt;br&gt;&lt;/div&gt;&lt;div&gt;(....)&lt;br&gt;&lt;/div&gt;&lt;div&gt;1592921221.753&nbsp;&nbsp;&nbsp;&nbsp;138&nbsp;10.0.2.2&nbsp;TCP_TUNNEL/403&nbsp;361&lt;br&gt;&lt;/div&gt;&lt;div&gt;CONNECT&nbsp;www.google.com:443&nbsp;&lt;http://www.google.com:443/&gt;&nbsp;-&lt;br&gt;&lt;/div&gt;&lt;div&gt;FIRSTUP_PARENT/172.16.103.254&nbsp;-&lt;br&gt;&lt;/div&gt;&lt;div&gt;1592921275.641&nbsp;&nbsp;&nbsp;&nbsp;521&nbsp;10.0.2.2&nbsp;TCP_MISS/403&nbsp;4289&lt;br&gt;&lt;/div&gt;&lt;div&gt;GET&nbsp;http://www.debian-fr.org/&nbsp;-&nbsp;FIRSTUP_PARENT/172.16.103.254&nbsp;text/html&lt;br&gt;&lt;/div&gt;&lt;div&gt;1592921275.692&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;10.0.2.2&nbsp;TCP_HIT/200&nbsp;13072&nbsp;GET&lt;br&gt;&lt;/div&gt;&lt;div&gt;(...)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;it&nbsp;possible&nbsp;that&nbsp;the&nbsp;squid&nbsp;parent&nbsp;refuse&nbsp;to&nbsp;have&nbsp;&quot;a&nbsp;child&quot;&nbsp;?&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Maybe.&nbsp;You&nbsp;will&nbsp;need&nbsp;to&nbsp;know&nbsp;the&nbsp;parent&nbsp;proxy&nbsp;configuration&nbsp;to&nbsp;tell&lt;br&gt;&lt;/div&gt;&lt;div&gt;that.&nbsp;All&nbsp;that&nbsp;is&nbsp;visible&nbsp;from&nbsp;the&nbsp;detail&nbsp;you&nbsp;have&nbsp;shown&nbsp;is&nbsp;that&nbsp;parent&lt;br&gt;&lt;/div&gt;&lt;div&gt;proxy&nbsp;has&nbsp;forbidden&nbsp;the&nbsp;requests&nbsp;it&nbsp;is&nbsp;receiving.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Amos&lt;br&gt;&lt;/div&gt;&lt;div&gt;_______________________________________________&lt;br&gt;&lt;/div&gt;&lt;div&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;&lt;/div&gt;&lt;div&gt;squid-users@lists.squid-cache.org&lt;br&gt;&lt;/div&gt;&lt;div&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
