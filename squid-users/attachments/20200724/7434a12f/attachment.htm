<tt>
<br>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&nbsp;http-equiv=Content-Type&gt;<br>
&lt;META&nbsp;name=GENERATOR&nbsp;content=&quot;MSHTML&nbsp;11.00.10570.1001&quot;&gt;&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;i&nbsp;would&nbsp;recommend&nbsp;to&nbsp;..&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;1)&nbsp;use&nbsp;debian&nbsp;buster,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;2)&nbsp;use&nbsp;squid&nbsp;4.12&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;3)&nbsp;use&nbsp;samba&nbsp;(winbind).&nbsp;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;needed&nbsp;&nbsp;in&nbsp;smb.conf&nbsp;(&nbsp;only&nbsp;shown&nbsp;whats&nbsp;really&nbsp;needed&nbsp;<br>
),&nbsp;there&nbsp;is&nbsp;more&nbsp;offcourse.&nbsp;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;FONT&nbsp;<br>
color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&nbsp;&nbsp;&nbsp;&nbsp;dedicated&nbsp;keytab&nbsp;file&nbsp;=&nbsp;<br>
/etc/krb5.keytab&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;kerberos&nbsp;method&nbsp;=&nbsp;secrets&nbsp;and&nbsp;<br>
keytab&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
#&nbsp;renew&nbsp;the&nbsp;kerberos&nbsp;ticket&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;winbind&nbsp;refresh&nbsp;tickets&nbsp;=&nbsp;<br>
yes&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
#&nbsp;Added&nbsp;for&nbsp;freeradius&nbsp;support&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;#&lt;/SPAN&gt;ntlm&nbsp;auth&nbsp;=&nbsp;<br>
mschapv2-and-ntlmv2-only&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;SPAN&nbsp;lang=N&gt;<br>
&lt;P&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;apt&nbsp;install&nbsp;winbind&nbsp;<br>
krb5-user&nbsp;&lt;/FONT&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;should&nbsp;be&nbsp;sufficient.&nbsp;&lt;BR&gt;&lt;/FONT&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;BR&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;<br>
size=2&nbsp;face=Arial&gt;samba&nbsp;joins&nbsp;the&nbsp;domain.&nbsp;&lt;BR&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;/etc/krb5.keytab&nbsp;contains&nbsp;the&nbsp;default&nbsp;part&nbsp;and&nbsp;refreshed&nbsp;the&nbsp;server&nbsp;<br>
kerberos&nbsp;passworks/tickes.&nbsp;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;And&nbsp;for&nbsp;squid&nbsp;its&nbsp;keytab.&nbsp;&lt;BR&gt;&lt;BR&gt;kinit&nbsp;Administrator&lt;BR&gt;export&nbsp;<br>
KRB5_KTNAME=FILE:/etc/squid/HTTP-$(hostname&nbsp;-s).keytab&lt;BR&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;net&nbsp;<br>
ads&nbsp;keytab&nbsp;add_update_ads&nbsp;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;HTTP&lt;/SPAN&gt;/$(hostname&nbsp;-f)&nbsp;-U&nbsp;<br>
Administrator&lt;BR&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;BR&gt;#&nbsp;alias&nbsp;name&nbsp;to&nbsp;keytab&lt;BR&gt;net&nbsp;ads&nbsp;<br>
keytab&nbsp;ADD&nbsp;HTTP/CNAME.FQDN&nbsp;&lt;BR&gt;&lt;BR&gt;#&nbsp;check&nbsp;keytab&nbsp;file.&lt;BR&gt;klist&nbsp;-ke&nbsp;<br>
/etc/squid/HTTP-$(hostname&nbsp;-s).keytab&lt;BR&gt;unset&nbsp;KRB5_KTNAME&lt;BR&gt;&lt;BR&gt;#&nbsp;set&nbsp;<br>
rights.&lt;BR&gt;chgrp&nbsp;proxy&nbsp;/etc/squid/HTTP-$(hostname&nbsp;-s).keytab&lt;BR&gt;chmod&nbsp;g+r&nbsp;<br>
/etc/squid/HTTP-$(hostname&nbsp;-s).keytab&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;And&nbsp;i&nbsp;use&nbsp;&nbsp;in&nbsp;squid&nbsp;&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;<br>
/usr/lib/squid/negotiate_wrapper_auth&nbsp;\&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;--kerberos&nbsp;<br>
/usr/lib/squid/negotiate_kerberos_auth&nbsp;-k&nbsp;/etc/squid/HTTP-hostname.keytab&nbsp;<br>
\&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;-s&nbsp;&lt;A&nbsp;<br>
href=&quot;mailto:HTTP/hostname.fqdn@REALM&quot;&gt;HTTP/hostname.fqdn@REALM&lt;/A&gt;&nbsp;-s&nbsp;&lt;A&nbsp;<br>
href=&quot;mailto:HTTP/CNAME.FQDN@REALM&quot;&gt;HTTP/CNAME.FQDN@REALM&lt;/A&gt;&nbsp;<br>
&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;--ntlm&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=gss-spnego&nbsp;<br>
--domain=NTDOM&nbsp;&lt;BR&gt;&lt;BR&gt;Point&nbsp;to&nbsp;think&nbsp;about.&nbsp;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/P&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;SPAN&nbsp;<br>
lang=N&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;FONT&nbsp;<br>
color=#0000ff&gt;&lt;FONT&nbsp;size=2&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;server&nbsp;<br>
&lt;/SPAN&gt;I&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;FONT&nbsp;color=#0000ff&gt;&lt;FONT&nbsp;<br>
size=2&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;P's&nbsp;needs&nbsp;A&nbsp;+&nbsp;<br>
PTR&nbsp;&lt;BR&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&nbsp;use&nbsp;CNAMEs&nbsp;in&nbsp;the&nbsp;DNS.&nbsp;<br>
&lt;BR&gt;and&nbsp;make&nbsp;sure&nbsp;the&nbsp;resolving&nbsp;is&nbsp;setup&nbsp;correctly.&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;FONT&nbsp;color=#0000ff&gt;&lt;FONT&nbsp;size=2&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;Add&nbsp;a&nbsp;caching&nbsp;DNS&nbsp;to&nbsp;the&nbsp;proxy.&nbsp;(&nbsp;and&nbsp;let&nbsp;squid&nbsp;use&nbsp;it&nbsp;<br>
also&nbsp;)&nbsp;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;I&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&nbsp;had&nbsp;this&nbsp;working&nbsp;(without&nbsp;HAproxy)&nbsp;but&nbsp;with&nbsp;<br>
keepalived.&nbsp;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;FONT&nbsp;<br>
color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;A&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;s&nbsp;far&nbsp;i&nbsp;can&nbsp;tel,&nbsp;<br>
your&nbsp;problem&nbsp;is&nbsp;in&nbsp;how&nbsp;the&nbsp;hostnames&nbsp;and&nbsp;ip&nbsp;are&nbsp;<br>
used.&nbsp;&lt;BR&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;<br>
color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;b&lt;SPAN&nbsp;class=171043008-24072020&gt;ut&nbsp;above&nbsp;might&nbsp;<br>
give&nbsp;you&nbsp;ideas.&nbsp;&lt;BR&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;G&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;reetz,&nbsp;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/P&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;SPAN&nbsp;lang=N&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;SPAN&nbsp;<br>
lang=N&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;<br>
&lt;P&gt;&lt;SPAN&nbsp;class=171043008-24072020&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;L&lt;SPAN&nbsp;<br>
class=171043008-24072020&gt;ouis&lt;/SPAN&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/P&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;align=left&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;&nbsp;&lt;/DIV&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;FONT&nbsp;color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&lt;FONT&nbsp;<br>
color=#0000ff&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;<br>
style=&quot;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#0000ff&nbsp;2px&nbsp;solid;&nbsp;MARGIN-RIGHT:&nbsp;0px&quot;&nbsp;<br>
dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;lang=nl&nbsp;class=OutlookMessageHeader&nbsp;dir=ltr&nbsp;align=left&gt;<br>
&nbsp;&nbsp;&lt;HR&nbsp;tabIndex=-1&gt;<br>
&nbsp;&nbsp;&lt;FONT&nbsp;size=2&nbsp;face=Tahoma&gt;&lt;B&gt;Van:&lt;/B&gt;&nbsp;squid-users&nbsp;<br>
&nbsp;&nbsp;[mailto:squid-users-bounces@lists.squid-cache.org]&nbsp;&lt;B&gt;Namens&nbsp;&lt;/B&gt;Service&nbsp;<br>
&nbsp;&nbsp;MV&lt;BR&gt;&lt;B&gt;Verzonden:&lt;/B&gt;&nbsp;donderdag&nbsp;23&nbsp;juli&nbsp;2020&nbsp;17:36&lt;BR&gt;&lt;B&gt;Aan:&lt;/B&gt;&nbsp;<br>
&nbsp;&nbsp;squid-users@lists.squid-cache.org&lt;BR&gt;&lt;B&gt;Onderwerp:&lt;/B&gt;&nbsp;[squid-users]&nbsp;Problem&nbsp;<br>
&nbsp;&nbsp;with&nbsp;HAProxy&nbsp;+&nbsp;Squid&nbsp;4.11&nbsp;+&nbsp;Kerberos&nbsp;authentication&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;Hi,&nbsp;everybody.&lt;BR&gt;I&nbsp;have&nbsp;a&nbsp;SQUID&nbsp;4.11&nbsp;compiled&nbsp;on&nbsp;Debian&nbsp;9.8&nbsp;with&nbsp;<br>
&nbsp;&nbsp;kerberos&nbsp;integration&nbsp;authenticating&nbsp;and&nbsp;browsing&nbsp;without&nbsp;<br>
&nbsp;&nbsp;problems:&lt;BR&gt;cache.log&lt;BR&gt;squid_kerb_auth:&nbsp;User&nbsp;some.user&nbsp;<br>
&nbsp;&nbsp;authenticated&lt;BR&gt;access.log&lt;BR&gt;10.10.10.203&nbsp;TCP_TUNNEL/200&nbsp;5264&nbsp;CONNECT&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;http://update.googleapis.com:443&quot;&gt;update.googleapis.com:443&lt;/A&gt;&nbsp;<br>
&nbsp;&nbsp;some.user&nbsp;HIER_DIRECT/&lt;A&nbsp;href=&quot;http://172.217.162.3&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;<br>
&nbsp;&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;<br>
&nbsp;&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;172.217.162.3&lt;/A&gt;&nbsp;-&lt;BR&gt;&lt;BR&gt;The&nbsp;problem&nbsp;starts&nbsp;when&nbsp;I&nbsp;try&nbsp;<br>
&nbsp;&nbsp;to&nbsp;configure&nbsp;a&nbsp;HAProxy&nbsp;1.8&nbsp;load&nbsp;balancer&nbsp;to&nbsp;which&nbsp;by&nbsp;redundancy&nbsp;I&nbsp;configured&nbsp;a&nbsp;<br>
&nbsp;&nbsp;virtual&nbsp;IP&nbsp;with&nbsp;the&nbsp;keepalived&nbsp;service.&nbsp;When&nbsp;I&nbsp;point&nbsp;my&nbsp;browser&nbsp;to&nbsp;the&nbsp;DNS&nbsp;A&nbsp;<br>
&nbsp;&nbsp;record&nbsp;(balancer.mydomain.local)&nbsp;which&nbsp;in&nbsp;turn&nbsp;points&nbsp;to&nbsp;the&nbsp;keepalived&nbsp;<br>
&nbsp;&nbsp;virtual&nbsp;IP,&nbsp;the&nbsp;authentication&nbsp;stops&nbsp;working:&lt;BR&gt;cache.log<br>
&nbsp;&nbsp;&lt;DIV&gt;no&nbsp;records&lt;BR&gt;access.log&lt;BR&gt;10.10.8.207&nbsp;TCP_DENIED/407&nbsp;4142&nbsp;CONNECT&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;http://update.googleapis.com:443&quot;&gt;update.googleapis.com:443&lt;/A&gt;&nbsp;-&nbsp;<br>
&nbsp;&nbsp;HIER_NONE/-&nbsp;text/&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;In&nbsp;the&nbsp;client&nbsp;browser&nbsp;a&nbsp;prompt&nbsp;appears&nbsp;requesting&nbsp;<br>
&nbsp;&nbsp;authentication.&lt;BR&gt;&lt;BR&gt;I&nbsp;find&nbsp;it&nbsp;strange&nbsp;that&nbsp;the&nbsp;IP&nbsp;registered&nbsp;by&nbsp;SQUID&nbsp;is&nbsp;<br>
&nbsp;&nbsp;10.10.8.207,&nbsp;which&nbsp;is&nbsp;the&nbsp;physical&nbsp;IP&nbsp;of&nbsp;my&nbsp;VM,&nbsp;instead&nbsp;of&nbsp;the&nbsp;virtual&nbsp;IP&nbsp;<br>
&nbsp;&nbsp;configured&nbsp;in&nbsp;HAProxy,&nbsp;which&nbsp;is&nbsp;the&nbsp;IP&nbsp;10.10.8.213.&lt;BR&gt;&lt;BR&gt;I&nbsp;send&nbsp;you&nbsp;all&nbsp;the&nbsp;<br>
&nbsp;&nbsp;configurations&nbsp;that&nbsp;I&nbsp;have&nbsp;made&nbsp;to&nbsp;see&nbsp;if&nbsp;you&nbsp;can&nbsp;help&nbsp;me&nbsp;to&nbsp;find&nbsp;where&nbsp;my&nbsp;<br>
&nbsp;&nbsp;configuration&nbsp;error&nbsp;is.&lt;BR&gt;&lt;BR&gt;keepalived.conf<br>
&nbsp;&nbsp;&lt;DIV&gt;&nbsp;&nbsp;global_defs&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notification_email&nbsp;<br>
&nbsp;&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;some.user@mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;}&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notification_email_from&nbsp;<br>
&nbsp;&nbsp;balancer1@mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smtp_server&nbsp;smtp.&nbsp;<br>
&nbsp;&nbsp;mydomain.local&nbsp;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smtp_connect_timeout&nbsp;60&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;}&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;vrrp_instance&nbsp;VI_1&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&nbsp;<br>
&nbsp;&nbsp;MASTER&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface&nbsp;eth0&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;virtual_router_id&nbsp;101&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priority&nbsp;101&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;advert_int&nbsp;1&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authentication&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auth_type&nbsp;PASS&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;auth_pass&nbsp;somepass123&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;virtual_ipaddress&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;10.10.8.213&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;BR&gt;&nbsp;&nbsp;}&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;haproxy.conf&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;global&lt;BR&gt;log&nbsp;/dev/log&nbsp;local0&lt;BR&gt;log&nbsp;/dev/log&nbsp;local1&nbsp;notice&lt;BR&gt;chroot&nbsp;<br>
&nbsp;&nbsp;/var/lib/haproxy&lt;BR&gt;stats&nbsp;socket&nbsp;/run/haproxy/admin.sock&nbsp;mode&nbsp;660&nbsp;level&nbsp;<br>
&nbsp;&nbsp;admin&lt;BR&gt;stats&nbsp;timeout&nbsp;30s&lt;BR&gt;user&nbsp;haproxy&lt;BR&gt;group&nbsp;<br>
&nbsp;&nbsp;haproxy&lt;BR&gt;daemon&lt;BR&gt;maxconn&nbsp;4000&lt;BR&gt;ca-base&nbsp;/etc/ssl/certs&lt;BR&gt;crt-base&nbsp;<br>
&nbsp;&nbsp;/etc/ssl/private&lt;BR&gt;server=haproxy&lt;BR&gt;ssl-default-bind-ciphers&nbsp;<br>
&nbsp;&nbsp;ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS&lt;BR&gt;ssl-default-bind-options&nbsp;<br>
&nbsp;&nbsp;no-sslv3&lt;BR&gt;&lt;BR&gt;defaults&lt;BR&gt;balance&nbsp;source&lt;BR&gt;log&nbsp;global&lt;BR&gt;mode&nbsp;<br>
&nbsp;&nbsp;http&lt;BR&gt;option&nbsp;httplog&lt;BR&gt;option&nbsp;dontlognull&lt;BR&gt;option&nbsp;<br>
&nbsp;&nbsp;http-server-close&lt;BR&gt;option&nbsp;forwardfor&nbsp;except&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;http://127.0.0.0/8&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;<br>
&nbsp;&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;127.0.0.0/8&lt;/A&gt;&lt;BR&gt;timeout&nbsp;connect&nbsp;<br>
&nbsp;&nbsp;5000&lt;BR&gt;timeout&nbsp;client&nbsp;50000&lt;BR&gt;timeout&nbsp;server&nbsp;50000&lt;BR&gt;&lt;BR&gt;errorfile&nbsp;400&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/400.http&lt;BR&gt;errorfile&nbsp;403&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/403.http&lt;BR&gt;errorfile&nbsp;408&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/408.http&lt;BR&gt;errorfile&nbsp;500&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/500.http&lt;BR&gt;errorfile&nbsp;502&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/502.http&lt;BR&gt;errorfile&nbsp;503&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/503.http&lt;BR&gt;errorfile&nbsp;504&nbsp;<br>
&nbsp;&nbsp;/etc/haproxy/errors/504.http&lt;BR&gt;&lt;BR&gt;###&nbsp;statistics&lt;BR&gt;listen&nbsp;stats&lt;BR&gt;bind&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;http://10.10.8.213:1936&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;warning:&nbsp;<br>
&nbsp;&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;10.10.8.213:1936&lt;/A&gt;&lt;BR&gt;mode&nbsp;<br>
&nbsp;&nbsp;http&lt;BR&gt;stats&nbsp;enable&lt;BR&gt;stats&nbsp;hide-version&lt;BR&gt;stats&nbsp;realm&nbsp;Haproxy\&nbsp;<br>
&nbsp;&nbsp;Statistics&lt;BR&gt;stats&nbsp;uri&nbsp;/haproxy?stats&lt;BR&gt;stats&nbsp;auth&nbsp;<br>
&nbsp;&nbsp;haproxy:somepass123&lt;BR&gt;&lt;BR&gt;###&nbsp;balancer&lt;BR&gt;listen&nbsp;squid&lt;BR&gt;bind&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;http://10.10.8.213:3128&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;warning:&nbsp;<br>
&nbsp;&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;10.10.8.213:3128&lt;/A&gt;&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;mode&nbsp;http&lt;BR&gt;&nbsp;&nbsp;option&nbsp;httplog&lt;BR&gt;&nbsp;&nbsp;balance&nbsp;source&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;hash-type&nbsp;consistent&lt;BR&gt;&nbsp;&nbsp;option&nbsp;httpclose&lt;BR&gt;&nbsp;&nbsp;cookie&nbsp;SERVERID&nbsp;<br>
&nbsp;&nbsp;insert&nbsp;indirect&nbsp;nocache&lt;BR&gt;&nbsp;&nbsp;option&nbsp;forwardfor&nbsp;header&nbsp;X-Client&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;server&nbsp;proxy1&nbsp;&lt;A&nbsp;href=&quot;http://10.10.8.205:3128&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;<br>
&nbsp;&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;10.10.8.205:3128&lt;/A&gt;&nbsp;<br>
&nbsp;&nbsp;check&nbsp;inter&nbsp;2000&nbsp;rise&nbsp;2&nbsp;fall&nbsp;5&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&nbsp;&nbsp;server&nbsp;proxy2&nbsp;&lt;A&nbsp;href=&quot;http://10.10.8.206:3128&quot;&gt;&lt;font&nbsp;color=&quot;red&quot;&gt;&lt;b&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;malicious:&lt;/b&gt;&lt;/font&gt;&nbsp;&lt;FONT&nbsp;<br>
&nbsp;&nbsp;color=red&gt;&lt;B&gt;MailScanner&nbsp;warning:&nbsp;numerical&nbsp;links&nbsp;are&nbsp;often&nbsp;<br>
&nbsp;&nbsp;malicious:&lt;/B&gt;&lt;/FONT&gt;&nbsp;10.10.8.206:3128&lt;/A&gt;&nbsp;check&nbsp;inter&nbsp;2000&nbsp;rise&nbsp;2&nbsp;fall&nbsp;<br>
&nbsp;&nbsp;5&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;squid.conf&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;#&nbsp;minimal&nbsp;configuration&nbsp;for&nbsp;testing&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;visible_hostname&nbsp;proxy1.mydomain.local&lt;BR&gt;http_port&nbsp;3128&lt;BR&gt;debug_options&nbsp;<br>
&nbsp;&nbsp;ALL,&nbsp;1&nbsp;33,&nbsp;2&nbsp;28,&nbsp;9&lt;BR&gt;maximum_object_size&nbsp;8192&nbsp;KB&lt;BR&gt;error_directory&nbsp;<br>
&nbsp;&nbsp;/opt/squid411/share/errors/es-ar&lt;BR&gt;shutdown_lifetime&nbsp;0&nbsp;<br>
&nbsp;&nbsp;seconds&lt;BR&gt;forwarded_for&nbsp;on&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;program&nbsp;<br>
&nbsp;&nbsp;/usr/local/bin/squid_kerb_auth&nbsp;-i&nbsp;-r&nbsp;-s&nbsp;GSS_C_NO_NAME&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;<br>
&nbsp;&nbsp;children&nbsp;300&nbsp;startup=150&nbsp;idle=10&lt;BR&gt;auth_param&nbsp;negotiate&nbsp;keep_alive&nbsp;on&lt;BR&gt;acl&nbsp;<br>
&nbsp;&nbsp;auth&nbsp;proxy_auth&nbsp;REQUIRED&lt;BR&gt;http_access&nbsp;allow&nbsp;auth&lt;BR&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;<br>
&nbsp;&nbsp;443&lt;BR&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&lt;BR&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;BR&gt;http_access&nbsp;<br>
&nbsp;&nbsp;deny&nbsp;!Safe_ports&lt;BR&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;BR&gt;http_access&nbsp;deny&nbsp;<br>
&nbsp;&nbsp;all&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;squid&nbsp;-v&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Squid&nbsp;Cache:&nbsp;Version&nbsp;4.11&lt;BR&gt;Service&nbsp;Name:&nbsp;squid&lt;BR&gt;&lt;BR&gt;This&nbsp;binary&nbsp;uses&nbsp;<br>
&nbsp;&nbsp;OpenSSL&nbsp;1.0.2u&nbsp;&nbsp;20&nbsp;Dec&nbsp;2019.&nbsp;For&nbsp;legal&nbsp;restrictions&nbsp;on&nbsp;distribution&nbsp;see&nbsp;<br>
&nbsp;&nbsp;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;https://www.openssl.org/source/license.html&quot;&gt;https://www.openssl.org/source/license.html&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;configure&nbsp;<br>
&nbsp;&nbsp;options:&nbsp;&nbsp;'--prefix=/opt/squid411'&nbsp;'--includedir=/include'&nbsp;<br>
&nbsp;&nbsp;'--mandir=/share/man'&nbsp;'--infodir=/share/info'&nbsp;<br>
&nbsp;&nbsp;'--localstatedir=/opt/squid411/var'&nbsp;'--disable-maintainer-mode'&nbsp;<br>
&nbsp;&nbsp;'--disable-dependency-tracking'&nbsp;'--disable-silent-rules'&nbsp;'--enable-inline'&nbsp;<br>
&nbsp;&nbsp;'--enable-async-io'&nbsp;'--enable-storeio=ufs,aufs,diskd'&nbsp;<br>
&nbsp;&nbsp;'--enable-removal-policies=lru,heap'&nbsp;'--enable-delay-pools'&nbsp;<br>
&nbsp;&nbsp;'--enable-cache-digests'&nbsp;'--enable-underscores'&nbsp;'--enable-icap-client'&nbsp;<br>
&nbsp;&nbsp;'--enable-follow-x-forwarded-for'&nbsp;'--enable-auth'&nbsp;<br>
&nbsp;&nbsp;'--enable-digest-auth-helpers'&nbsp;'--enable-negotiate-auth-helpers'&nbsp;<br>
&nbsp;&nbsp;'--enable-auth-ntlm'&nbsp;'--enable-arp-acl'&nbsp;'--enable-esi--disable-translation'&nbsp;<br>
&nbsp;&nbsp;'--with-logdir=/var/log/squid411'&nbsp;'--with-pidfile=/var/run/squid411.pid'&nbsp;<br>
&nbsp;&nbsp;'--with-filedescriptors=65536'&nbsp;'--with-large-files'&nbsp;<br>
&nbsp;&nbsp;'--with-default-user=proxy'&nbsp;'--enable-linux-netfilter'&nbsp;<br>
&nbsp;&nbsp;'--enable-ltdl-convenience'&nbsp;'--with-openssl'&nbsp;'--enable-ssl'&nbsp;<br>
&nbsp;&nbsp;'--enable-ssl-crtd'&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;env&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;KRB5_KTNAME=/opt/squid411/etc/PROXY.keytab&lt;BR&gt;KRB5RCACHETYPE=none&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;/etc/krb5.conf&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;[libdefaults]&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;default_realm&nbsp;=&nbsp;MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;dns_lookup_kdc&nbsp;=&nbsp;yes&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;dns_lookup_realm&nbsp;=&nbsp;yes&nbsp;&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ticket_lifetime&nbsp;=&nbsp;24h&lt;BR&gt;&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;default_tgs_enctypes&nbsp;=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;<br>
&nbsp;&nbsp;des-cbc-md5&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_tkt_enctypes&nbsp;=&nbsp;<br>
&nbsp;&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permitted_enctypes&nbsp;=&nbsp;aes256-cts-hmac-sha1-96&nbsp;rc4-hmac&nbsp;<br>
&nbsp;&nbsp;des-cbc-crc&nbsp;des-cbc-md5&lt;BR&gt;&lt;BR&gt;[realms]&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;MYDOMAIN.LOCAL&nbsp;=&nbsp;<br>
&nbsp;&nbsp;{&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kdc&nbsp;=&nbsp;s-dc00.mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kdc&nbsp;=&nbsp;s-dc01.mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kdc&nbsp;=&nbsp;<br>
&nbsp;&nbsp;s-dc02.mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;admin_server&nbsp;=&nbsp;<br>
&nbsp;&nbsp;s-dc00.mydomain.local&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;BR&gt;&lt;BR&gt;[domain_realm]&lt;BR&gt;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;.mydomain.local&nbsp;=&nbsp;MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;mydomain.local&nbsp;=&nbsp;<br>
&nbsp;&nbsp;MYDOMAIN.LOCAL&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;msktutil&nbsp;-c&nbsp;-b&nbsp;&quot;OU=SERVIDORES&quot;&nbsp;-s&nbsp;HTTP/debian-proxy.mydomain.local&nbsp;-k&nbsp;<br>
&nbsp;&nbsp;/opt/squid411/etc/PROXY.keytab&nbsp;--computer-name&nbsp;DEBIAN-PROXY&nbsp;--upn&nbsp;<br>
&nbsp;&nbsp;HTTP/debian-proxy.mydomain.local&nbsp;--server&nbsp;s-dc00.mydomain.local&nbsp;--verbose&nbsp;<br>
&nbsp;&nbsp;--enctypes&nbsp;28&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;#&nbsp;permissions&nbsp;for&nbsp;kaytab&nbsp;file&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;chgrp&nbsp;proxy&nbsp;/opt/squid411/etc/PROXY.keytab&lt;BR&gt;chmod&nbsp;g+r&nbsp;<br>
&nbsp;&nbsp;/opt/squid411/etc/PROXY.keytab&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;klist&lt;BR&gt;Ticket&nbsp;cache:&nbsp;FILE:/tmp/krb5cc_0&lt;BR&gt;Default&nbsp;principal:&nbsp;<br>
&nbsp;&nbsp;some.user@MYDOMAIN.LOCAL&lt;BR&gt;&lt;BR&gt;Valid&nbsp;starting&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expires&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Service&nbsp;<br>
&nbsp;&nbsp;principal&lt;BR&gt;07/23/2020&nbsp;11:59:45&nbsp;&nbsp;07/23/2020&nbsp;21:59:45&nbsp;<br>
&nbsp;&nbsp;&nbsp;krbtgt/MYDOMAIN.LOCAL@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;renew&nbsp;until&nbsp;07/24/2020&nbsp;11:59:40&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;One&nbsp;thing&nbsp;I&nbsp;didn't&nbsp;quite&nbsp;understand&nbsp;is&nbsp;the&nbsp;procedure&nbsp;to&nbsp;authenticate&nbsp;from&nbsp;<br>
&nbsp;&nbsp;HAProxy.&nbsp;According&nbsp;to&nbsp;the&nbsp;documentation&nbsp;I&nbsp;read,&nbsp;I&nbsp;did&nbsp;the&nbsp;following:&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;I&nbsp;created&nbsp;a&nbsp;DNS&nbsp;A&nbsp;record&nbsp;and&nbsp;its&nbsp;PTR&nbsp;in&nbsp;my&nbsp;DNS&nbsp;server&nbsp;pointing&nbsp;to&nbsp;the&nbsp;<br>
&nbsp;&nbsp;virtual&nbsp;IP&nbsp;of&nbsp;the&nbsp;keepalived&nbsp;(10.10.8.213)&nbsp;in&nbsp;the&nbsp;HAProxy.&nbsp;&lt;BR&gt;Then&nbsp;I&nbsp;<br>
&nbsp;&nbsp;created&nbsp;a&nbsp;&quot;HTTP_inet&quot;&nbsp;user&nbsp;account&nbsp;in&nbsp;Active&nbsp;Directory.&lt;BR&gt;Then&nbsp;on&nbsp;my&nbsp;domain&nbsp;<br>
&nbsp;&nbsp;controller,&nbsp;in&nbsp;a&nbsp;CMD&nbsp;with&nbsp;administrator&nbsp;permissions,&nbsp;I&nbsp;ran:&lt;BR&gt;setspn&nbsp;-S&nbsp;<br>
&nbsp;&nbsp;HTTP/inet.mydomain.local&nbsp;HTTP_inet&lt;BR&gt;setspn&nbsp;-S&nbsp;HTTP/inet&nbsp;HTTP_inet&nbsp;&lt;BR&gt;In&nbsp;<br>
&nbsp;&nbsp;both&nbsp;cases&nbsp;the&nbsp;message&nbsp;was:&nbsp;object&nbsp;updated.&lt;BR&gt;Then&nbsp;in&nbsp;my&nbsp;SQUID&nbsp;servers,&nbsp;I&nbsp;<br>
&nbsp;&nbsp;executed:&lt;BR&gt;kinit&nbsp;HTTP_inet@MYDOMAIN.LOCAL&lt;BR&gt;It&nbsp;asks&nbsp;for&nbsp;the&nbsp;user's&nbsp;<br>
&nbsp;&nbsp;password.&lt;BR&gt;Start&nbsp;the&nbsp;ktutil&nbsp;tool&lt;BR&gt;That's&nbsp;where&nbsp;I&nbsp;write:&lt;BR&gt;addent&nbsp;<br>
&nbsp;&nbsp;-password&nbsp;-p&nbsp;HTTP/inet.mydomain.local&nbsp;-k&nbsp;2&nbsp;-e&nbsp;rc4-hmac&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Ask&nbsp;the&nbsp;user&nbsp;password&lt;BR&gt;addent&nbsp;-password&nbsp;-p&nbsp;HTTP/inet&nbsp;-k&nbsp;2&nbsp;-e&nbsp;<br>
&nbsp;&nbsp;rc4-hmac&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Ask&nbsp;the&nbsp;user&nbsp;password&lt;BR&gt;wkt&nbsp;<br>
&nbsp;&nbsp;/opt/squid411/etc/PROXY.keytab&lt;BR&gt;quit&lt;BR&gt;&lt;BR&gt;list&nbsp;the&nbsp;keys&nbsp;in&nbsp;<br>
&nbsp;&nbsp;keytab:&lt;BR&gt;ktutil&lt;BR&gt;read_kt&nbsp;/opt/squid411/etc/PROXY.keytab&lt;BR&gt;&nbsp;&nbsp;&nbsp;1&nbsp;<br>
&nbsp;&nbsp;1&nbsp;DEBIAN-PROXY$@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;2&nbsp;1&nbsp;<br>
&nbsp;&nbsp;DEBIAN-PROXY$@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;3&nbsp;1&nbsp;<br>
&nbsp;&nbsp;DEBIAN-PROXY$@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;4&nbsp;1&nbsp;<br>
&nbsp;&nbsp;HTTP/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;5&nbsp;1&nbsp;<br>
&nbsp;&nbsp;HTTP/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;6&nbsp;1&nbsp;<br>
&nbsp;&nbsp;HTTP/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;7&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/DEBIAN-PROXY@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;8&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/DEBIAN-PROXY@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;&nbsp;9&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/DEBIAN-PROXY@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;10&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;11&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;12&nbsp;1&nbsp;<br>
&nbsp;&nbsp;host/debian-proxy.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;13&nbsp;2&nbsp;<br>
&nbsp;&nbsp;HTTP/inet.mydomain.local@MYDOMAIN.LOCAL&lt;BR&gt;&nbsp;&nbsp;14&nbsp;2&nbsp;<br>
&nbsp;&nbsp;HTTP/inet@MYDOMAIN.LOCAL&lt;BR&gt;&lt;BR&gt;It's&nbsp;this&nbsp;last&nbsp;part&nbsp;I&nbsp;understand&nbsp;the&nbsp;least,&nbsp;<br>
&nbsp;&nbsp;maybe&nbsp;the&nbsp;mistake&nbsp;is&nbsp;there.&nbsp;Or&nbsp;somewhere&nbsp;else.&lt;BR&gt;I&nbsp;appreciate&nbsp;any&nbsp;help&nbsp;you&nbsp;<br>
&nbsp;&nbsp;can&nbsp;offer&nbsp;me.&nbsp;&lt;BR&gt;&lt;BR&gt;Best&nbsp;regards,&lt;BR&gt;&lt;BR&gt;Gabriel&lt;BR&gt;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
