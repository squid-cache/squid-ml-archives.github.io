<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks,&nbsp;Brett,&nbsp;for&nbsp;the&nbsp;answer.&nbsp;I&nbsp;did&nbsp;exactly&nbsp;the&nbsp;same&nbsp;thing&nbsp;and&nbsp;it&#39;s&nbsp;working&nbsp;for&nbsp;me&nbsp;now.&lt;br&gt;I&nbsp;only&nbsp;have&nbsp;to&nbsp;decrypt&nbsp;how&nbsp;to&nbsp;see&nbsp;the&nbsp;client&#39;s&nbsp;IP&nbsp;in&nbsp;SQUID&#39;s&nbsp;logs.&nbsp;I&nbsp;will&nbsp;follow&nbsp;your&nbsp;instructions&nbsp;to&nbsp;try&nbsp;to&nbsp;achieve&nbsp;it.&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&lt;br&gt;&lt;br&gt;Gabriel&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;El&nbsp;jue.,&nbsp;23&nbsp;de&nbsp;jul.&nbsp;de&nbsp;2020&nbsp;a&nbsp;la(s)&nbsp;21:23,&nbsp;Brett&nbsp;Lymn&nbsp;(&lt;a&nbsp;href=&quot;mailto:brett.lymn@baesystems.com&quot;&gt;brett.lymn@baesystems.com&lt;/a&gt;)&nbsp;escribió:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;23,&nbsp;2020&nbsp;at&nbsp;06:07:39PM&nbsp;+0200,&nbsp;Klaus&nbsp;Brandl&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;But&nbsp;if&nbsp;anyone&nbsp;knows&nbsp;a&nbsp;solution,&nbsp;i&nbsp;will&nbsp;spread&nbsp;my&nbsp;ears&nbsp;:)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;we&nbsp;do&nbsp;is:&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;create&nbsp;a&nbsp;user&nbsp;account&nbsp;in&nbsp;AD&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;the&nbsp;HA&nbsp;front&nbsp;end,&lt;br&gt;<br>
set&nbsp;a&nbsp;password&nbsp;and&nbsp;export&nbsp;the&nbsp;keytab&nbsp;for&nbsp;this&nbsp;user&lt;br&gt;<br>
2)&nbsp;Use&nbsp;ktadmin&nbsp;to&nbsp;import&nbsp;the&nbsp;keytab&nbsp;entries&nbsp;for&nbsp;the&nbsp;user&nbsp;created&nbsp;in&nbsp;step&lt;br&gt;<br>
1&nbsp;into&nbsp;the&nbsp;keytab&nbsp;for&nbsp;squid&nbsp;on&nbsp;the&nbsp;squid&nbsp;servers.&lt;br&gt;<br>
3)&nbsp;Set&nbsp;a&nbsp;SPN&nbsp;(setspn)&nbsp;in&nbsp;AD&nbsp;that&nbsp;maps&nbsp;&lt;a&nbsp;href=&quot;HTTP://ha.fqdn.address&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;HTTP://ha.fqdn.address&lt;/a&gt;&nbsp;to&nbsp;the&nbsp;user&lt;br&gt;<br>
created&nbsp;in&nbsp;1&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;SPN&nbsp;(service&nbsp;principal&nbsp;name)&nbsp;tells&nbsp;kerberos&nbsp;to&nbsp;use&nbsp;the&nbsp;user&nbsp;details&lt;br&gt;<br>
set&nbsp;up&nbsp;in&nbsp;step&nbsp;1&nbsp;to&nbsp;authenticate&nbsp;http&nbsp;requests. &nbsp;This&nbsp;works&nbsp;for&nbsp;us,&nbsp;has&lt;br&gt;<br>
been&nbsp;for&nbsp;years.&lt;br&gt;<br>
&lt;br&gt;<br>
One&nbsp;thing,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;know&nbsp;the&nbsp;IP&nbsp;addresses&nbsp;of&nbsp;your&nbsp;clients&nbsp;in&nbsp;the&lt;br&gt;<br>
squid&nbsp;logs&nbsp;you&nbsp;will&nbsp;need&nbsp;to&nbsp;do&nbsp;some&nbsp;extra&nbsp;stuff&nbsp;because&nbsp;all&nbsp;accesses&lt;br&gt;<br>
will&nbsp;appear&nbsp;to&nbsp;come&nbsp;from&nbsp;the&nbsp;HA&nbsp;loadbalancer. &nbsp;We&nbsp;have&nbsp;configured&nbsp;our&lt;br&gt;<br>
load&nbsp;balancers&nbsp;to&nbsp;insert&nbsp;the&nbsp;X-Forwarded-For&nbsp;header&nbsp;into&nbsp;the&nbsp;http&lt;br&gt;<br>
traffic&nbsp;and&nbsp;then&nbsp;modified&nbsp;the&nbsp;logging&nbsp;to&nbsp;log&nbsp;both&nbsp;the&nbsp;loadblancer&nbsp;and&lt;br&gt;<br>
client&nbsp;IP.&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Brett&nbsp;Lymn&lt;br&gt;<br>
This&nbsp;email&nbsp;has&nbsp;been&nbsp;sent&nbsp;on&nbsp;behalf&nbsp;of&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;companies&nbsp;within&nbsp;the&nbsp;BAE&nbsp;Systems&nbsp;Australia&nbsp;group&nbsp;of&nbsp;companies:&lt;br&gt;<br>
&lt;br&gt;<br>
BAE&nbsp;Systems&nbsp;Australia&nbsp;Limited&nbsp;-&nbsp;Australian&nbsp;Company&nbsp;Number&nbsp;008&nbsp;423&nbsp;005&lt;br&gt;<br>
BAE&nbsp;Systems&nbsp;Australia&nbsp;Defence&nbsp;Pty&nbsp;Limited&nbsp;-&nbsp;Australian&nbsp;Company&nbsp;Number&nbsp;006&nbsp;870&nbsp;846&lt;br&gt;<br>
ASC&nbsp;Shipbuilding&nbsp;Pty&nbsp;Limited&nbsp;-&nbsp;Australian&nbsp;Company&nbsp;Number&nbsp;051&nbsp;899&nbsp;864&lt;br&gt;<br>
&lt;br&gt;<br>
BAE&nbsp;Systems&nbsp;Australia&#39;s&nbsp;registered&nbsp;office&nbsp;is&nbsp;Evans&nbsp;Building,&nbsp;Taranaki&nbsp;Road,&nbsp;Edinburgh&nbsp;Parks,&nbsp;Edindurgh,&nbsp;South&nbsp;Australia,&nbsp;5111.&lt;br&gt;<br>
ASC&nbsp;Shipbuilding&#39;s&nbsp;registered&nbsp;office&nbsp;is&nbsp;Level&nbsp;2,&nbsp;80&nbsp;Flinders&nbsp;Street,&nbsp;Adelaide,&nbsp;South&nbsp;Australia,&nbsp;5000.&lt;br&gt;<br>
If&nbsp;the&nbsp;identity&nbsp;of&nbsp;the&nbsp;sending&nbsp;company&nbsp;is&nbsp;not&nbsp;clear&nbsp;from&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;email,&nbsp;please&nbsp;contact&nbsp;the&nbsp;sender.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments&nbsp;may&nbsp;contain&nbsp;confidential&nbsp;and&nbsp;legally&nbsp;privileged&nbsp;information.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;do&nbsp;not&nbsp;copy&nbsp;or&nbsp;disclose&nbsp;its&nbsp;content,&nbsp;but&nbsp;please&nbsp;reply&nbsp;to&nbsp;this&nbsp;email&nbsp;immediately&nbsp;and&nbsp;highlight&nbsp;the&nbsp;error&nbsp;to&nbsp;the&nbsp;sender&nbsp;and&nbsp;then&nbsp;immediately&nbsp;delete&nbsp;the&nbsp;message.&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
