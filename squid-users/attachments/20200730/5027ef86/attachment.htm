<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;I&nbsp;set&nbsp;up&nbsp;Squid&nbsp;4.6&nbsp;on&nbsp;Debian&nbsp;10&nbsp;and&nbsp;I&#39;m&nbsp;having&nbsp;problems&nbsp;with&nbsp;browser&nbsp;authentication&nbsp;on&nbsp;a&nbsp;Windows&nbsp;station.&lt;br&gt;&lt;br&gt;I&nbsp;did&nbsp;the&nbsp;tests&nbsp;on&nbsp;the&nbsp;command&nbsp;line&nbsp;and&nbsp;apparently&nbsp;it&#39;s&nbsp;OK.&lt;br&gt;&lt;br&gt;root@proxy:/etc/squid/acls#&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=squid-2.5-basic&lt;br&gt;Registered&nbsp;MSG_REQ_POOL_USAGE&lt;br&gt;Registered&nbsp;MSG_REQ_DMALLOC_MARK&nbsp;and&nbsp;LOG_CHANGED&lt;br&gt;lp_load_ex:&nbsp;refreshing&nbsp;parameters&lt;br&gt;Initialising&nbsp;global&nbsp;parameters&lt;br&gt;rlimit_max:&nbsp;increasing&nbsp;rlimit_max&nbsp;(1024)&nbsp;to&nbsp;minimum&nbsp;Windows&nbsp;limit&nbsp;(16384)&lt;br&gt;Processing&nbsp;section&nbsp;&quot;[global]&quot;&lt;br&gt;EMPRESA+mane&nbsp;XXXXX&lt;br&gt;NT_STATUS_OK:&nbsp;The&nbsp;operation&nbsp;completed&nbsp;successfully.&nbsp;(0x0)&lt;br&gt;OK&lt;br&gt;&lt;br&gt;Here&nbsp;are&nbsp;my&nbsp;configuration&nbsp;files:&lt;br&gt;&lt;br&gt;#/ETC/SAMBA/SMB.CONF&lt;br&gt;[global]&lt;br&gt; &nbsp; &nbsp;netbios&nbsp;name&nbsp;=&nbsp;PROXY&lt;br&gt; &nbsp; &nbsp;workgroup&nbsp;=&nbsp;EMPRESA&lt;br&gt; &nbsp; &nbsp;security&nbsp;=&nbsp;ADS&lt;br&gt; &nbsp; &nbsp;realm&nbsp;=&nbsp;&lt;a&nbsp;href=&quot;http://EMPRESA.COM.BR&quot;&gt;EMPRESA.COM.BR&lt;/a&gt;&lt;br&gt; &nbsp; &nbsp;encrypt&nbsp;passwords&nbsp;=&nbsp;yes&lt;br&gt; &nbsp; &nbsp;username&nbsp;map&nbsp;=&nbsp;/etc/samba/user.map&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;log&nbsp;file&nbsp;=&nbsp;/var/log/samba/%m.log&lt;br&gt; &nbsp; &nbsp;log&nbsp;level&nbsp;=&nbsp;3&nbsp;passdb:5&nbsp;auth:5&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;*&nbsp;:&nbsp;backend&nbsp;=&nbsp;tdb&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;*&nbsp;:&nbsp;range&nbsp;=&nbsp;3000-7999&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;EMPRESA:backend&nbsp;=&nbsp;ad&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;EMPRESA:schema_mode&nbsp;=&nbsp;rfc2307&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;EMPRESA:range&nbsp;=&nbsp;10000-999999&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;EMPRESA:unix_nss_info&nbsp;=&nbsp;yes&lt;br&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;EMPRESA:unix_primary_group&nbsp;=&nbsp;yes&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;winbind&nbsp;refresh&nbsp;tickets&nbsp;=&nbsp;Yes&lt;br&gt; &nbsp; &nbsp;winbind&nbsp;use&nbsp;default&nbsp;domain&nbsp;=&nbsp;yes&lt;br&gt; &nbsp; &nbsp;winbind&nbsp;separator&nbsp;=&nbsp;+&lt;br&gt; &nbsp; &nbsp;winbind&nbsp;enum&nbsp;users&nbsp;=&nbsp;yes&lt;br&gt; &nbsp; &nbsp;winbind&nbsp;enum&nbsp;groups&nbsp;=&nbsp;yes&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;vfs&nbsp;objects&nbsp;=&nbsp;acl_xattr&lt;br&gt; &nbsp; &nbsp;map&nbsp;acl&nbsp;inherit&nbsp;=&nbsp;yes&lt;br&gt; &nbsp; &nbsp;store&nbsp;dos&nbsp;attributes&nbsp;=&nbsp;yes&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;template&nbsp;shell&nbsp;=&nbsp;/bin/bash&lt;br&gt; &nbsp; &nbsp;template&nbsp;homedir&nbsp;=&nbsp;/home/%U&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;dedicated&nbsp;keytab&nbsp;file&nbsp;=&nbsp;/etc/krb5.keytab&lt;br&gt; &nbsp; &nbsp;kerberos&nbsp;method&nbsp;=&nbsp;secrets&nbsp;and&nbsp;keytab&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;load&nbsp;printers&nbsp;=&nbsp;no&lt;br&gt; &nbsp; &nbsp;printing&nbsp;=&nbsp;bsd&lt;br&gt; &nbsp; &nbsp;printcap&nbsp;name&nbsp;=&nbsp;/dev/null&lt;br&gt; &nbsp; &nbsp;disable&nbsp;spoolss&nbsp;=&nbsp;yes&lt;br&gt;&lt;br&gt;#ETC/NSSWITCH.CONF&lt;br&gt;#&nbsp;/etc/nsswitch.conf&lt;br&gt;#&lt;br&gt;#&nbsp;Example&nbsp;configuration&nbsp;of&nbsp;GNU&nbsp;Name&nbsp;Service&nbsp;Switch&nbsp;functionality.&lt;br&gt;#&nbsp;If&nbsp;you&nbsp;have&nbsp;the&nbsp;`glibc-doc-reference&#39;&nbsp;and&nbsp;`info&#39;&nbsp;packages&nbsp;installed,&nbsp;try:&lt;br&gt;#&nbsp;`info&nbsp;libc&nbsp;&quot;Name&nbsp;Service&nbsp;Switch&quot;&#39;&nbsp;for&nbsp;information&nbsp;about&nbsp;this&nbsp;file.&lt;br&gt;&lt;br&gt;passwd:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;compat&nbsp;winbind&nbsp;&lt;br&gt;group:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; compat&nbsp;winbind&nbsp;&lt;br&gt;shadow:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;compat&lt;br&gt;gshadow:&nbsp; &nbsp; &nbsp; &nbsp; files&lt;br&gt;&lt;br&gt;hosts:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; files&nbsp;dns&lt;br&gt;networks:&nbsp; &nbsp; &nbsp; &nbsp;files&lt;br&gt;&lt;br&gt;protocols:&nbsp; &nbsp; &nbsp; db&nbsp;files&lt;br&gt;services:&nbsp; &nbsp; &nbsp; &nbsp;db&nbsp;files&lt;br&gt;ethers:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp;files&lt;br&gt;rpc:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp;files&lt;br&gt;netgroup:&nbsp; &nbsp; &nbsp; &nbsp;nis&lt;br&gt;&lt;br&gt;#/ETC/KRB5.CONF&lt;br&gt;[libdefaults]&lt;br&gt; &nbsp; &nbsp;dns_lookup_realm&nbsp;=&nbsp;false&lt;br&gt; &nbsp; &nbsp;dns_lookup_kdc&nbsp;=&nbsp;true&lt;br&gt; &nbsp; &nbsp;default_realm&nbsp;=&nbsp;&lt;a&nbsp;href=&quot;http://EMPRESA.COM.BR&quot;&gt;EMPRESA.COM.BR&lt;/a&gt;&lt;br&gt;&lt;br&gt;#/ETC/SQUID/SQUID.CONF&lt;br&gt;&lt;br&gt;http_port&nbsp;3128&lt;br&gt;&lt;br&gt;cache_mem&nbsp;512&nbsp;MB&lt;br&gt;cache_swap_low&nbsp;80&lt;br&gt;cache_swap_high&nbsp;90&lt;br&gt;&lt;br&gt;maximum_object_size&nbsp;512&nbsp;MB&lt;br&gt;minimum_object_size&nbsp;0&nbsp;KB&lt;br&gt;&lt;br&gt;maximum_object_size_in_memory&nbsp;4096&nbsp;KB&lt;br&gt;&lt;br&gt;cache_replacement_policy&nbsp;heap&nbsp;LFUDA&lt;br&gt;memory_replacement_policy&nbsp;heap&nbsp;LFUDA&lt;br&gt;&lt;br&gt;quick_abort_min&nbsp;-1&nbsp;KB&lt;br&gt;&lt;br&gt;detect_broken_pconn&nbsp;on&lt;br&gt;&lt;br&gt;fqdncache_size&nbsp;1024&lt;br&gt;&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;br&gt;refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320&lt;br&gt;&lt;br&gt;access_log&nbsp;/var/log/squid/access.log&lt;br&gt;cache_log&nbsp;/var/log/squid/cache.log&lt;br&gt;&lt;br&gt;cache_dir&nbsp;aufs&nbsp;/var/spool/squid&nbsp;600&nbsp;16&nbsp;256&lt;br&gt;&lt;br&gt;auth_param&nbsp;ntlm&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=squid-2.5-basic&lt;br&gt;auth_param&nbsp;ntlm&nbsp;children&nbsp;20&nbsp;startup=0&nbsp;idle=1&lt;br&gt;auth_param&nbsp;ntlm&nbsp;keep_alive&nbsp;on&lt;br&gt;&lt;br&gt;visible_hostname&nbsp;&quot;Monitoramento&nbsp;de&nbsp;Acesso&nbsp;à&nbsp;Internet&quot;&lt;br&gt;###&nbsp;acls&lt;br&gt;#acl&nbsp;manager&nbsp;proto&nbsp;cache_object&lt;br&gt;acl&nbsp;localhost&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.17/32&quot;&gt;192.168.1.17/32&lt;/a&gt;&lt;br&gt;acl&nbsp;to_localhost&nbsp;dst&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.17/32&quot;&gt;192.168.1.17/32&lt;/a&gt;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;22&nbsp;80&nbsp;3456&nbsp;443&nbsp;563&nbsp;587&nbsp;993&nbsp;2811&nbsp;3001&nbsp;3322&nbsp;7071&nbsp;8443&nbsp;9191&nbsp;10000&nbsp;23000&nbsp;&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;88&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;kerberos&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ntp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;3456&nbsp;&nbsp;&nbsp;#&nbsp;Siafi&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;389&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ldap&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;563&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;snews&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;3001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;imprenssa&nbsp;nacional&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;8080&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;8443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports&lt;br&gt;&lt;br&gt;acl&nbsp;purge&nbsp;method&nbsp;PURGE&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;&lt;br&gt;#&nbsp;----&nbsp;Windows&nbsp;Update&nbsp;----&lt;br&gt;acl&nbsp;microsoft&nbsp;url_regex&nbsp;&quot;/etc/squid/acls/ms-update&quot;&lt;br&gt;acl&nbsp;atualizacoes&nbsp;dstdomain&nbsp;&lt;a&nbsp;href=&quot;http://microsoft.com&quot;&gt;microsoft.com&lt;/a&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;microsoft&lt;br&gt;http_access&nbsp;allow&nbsp;atualizacoes&lt;br&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;purge&nbsp;localhost&lt;br&gt;http_access&nbsp;deny&nbsp;purge&lt;br&gt;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;&lt;br&gt;acl&nbsp;autenticados&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;http_access&nbsp;deny&nbsp;!autenticados&lt;br&gt;&lt;br&gt;acl&nbsp;sites_liberados&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid/acls/sites-permitidos&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;sites_liberados&lt;br&gt;&lt;br&gt;acl&nbsp;extensoes_bloqueadas&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid/acls/extensoes-proibidas&quot;&lt;br&gt;http_access&nbsp;deny&nbsp;extensoes_bloqueadas&lt;br&gt;&lt;br&gt;###&nbsp;Bloqueia&nbsp;sites&nbsp;por&nbsp;URL&lt;br&gt;acl&nbsp;sites_bloqueados&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid/acls/sites-proibidos&quot;&lt;br&gt;http_access&nbsp;deny&nbsp;sites_bloqueados&lt;br&gt;&lt;br&gt;###&nbsp;Rede&nbsp;LAN&nbsp;#####&lt;br&gt;acl&nbsp;rede_usuarios&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/24&quot;&gt;192.168.0.0/24&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;###&nbsp;Nega&nbsp;acesso&nbsp;de&nbsp;quem&nbsp;nao&nbsp;esta&nbsp;na&nbsp;rede&nbsp;local&lt;br&gt;http_access&nbsp;allow&nbsp;rede_usuarios&lt;br&gt;acl&nbsp;extensoes_bloqueadas&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid/acls/extensoes-proibidas&quot;&lt;br&gt;acl&nbsp;sites_liberados&nbsp;url_regex&nbsp;-i&nbsp;&quot;/etc/squid/acls/sites-permitidos&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;sites_liberados&lt;br&gt;http_access&nbsp;deny&nbsp;extensoes_bloqueadas&lt;br&gt;http_access&nbsp;allow&nbsp;autenticados&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;error_directory&nbsp;/usr/share/squid/errors/pt-br&lt;br&gt;&lt;br&gt;coredump_dir&nbsp;/var/spool/squid&lt;br&gt;&lt;br&gt;can&nbsp;anybody&nbsp;help&nbsp;me?&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;&lt;br&gt;Márcio&nbsp;Bacci&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
