<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;run&nbsp;a&nbsp;home&nbsp;server&nbsp;under&nbsp;Centos&nbsp;7&nbsp;and&nbsp;squid&nbsp;3.5.20.&nbsp;The&nbsp;config&nbsp;is&nbsp;still&nbsp;work&nbsp;in&nbsp;progress&nbsp;as&nbsp;I&nbsp;started&nbsp;only&nbsp;today.&nbsp;Any&nbsp;tipps&amp;tricks&nbsp;are&nbsp;welcomed&lt;div&gt;The&nbsp;function&nbsp;is&nbsp;as&nbsp;expected&nbsp;when&nbsp;working&nbsp;from&nbsp;my&nbsp;LAN.&nbsp;But&nbsp;when&nbsp;I&nbsp;tested&nbsp;today&nbsp;from&nbsp;my&nbsp;cell&nbsp;phone&nbsp;from outside&nbsp;I&nbsp;received&nbsp;a&nbsp;few&nbsp;TCP_DENIED&nbsp;for&nbsp;web&nbsp;pages&nbsp;that&nbsp;are&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;blacklists&nbsp;and&nbsp;I&nbsp;can&nbsp;access&nbsp;from&nbsp;my&nbsp;LAN.&lt;/div&gt;&lt;div&gt;I&nbsp;also&nbsp;tried&nbsp;a&nbsp;few&nbsp;apps&nbsp;(e.g.&nbsp;Twitter,&nbsp;Linkedin,&nbsp;etc..)&nbsp;and&nbsp;none&nbsp;worked.&nbsp;Underneath&nbsp;the&nbsp;config&nbsp;as-is.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;idea&nbsp;why&nbsp;I&nbsp;cannot&nbsp;connect?&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;two&nbsp;more&nbsp;question I&nbsp;fiddled&nbsp;with&nbsp;and&nbsp;has&nbsp;no&nbsp;success:&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Is&nbsp;there&nbsp;a&nbsp;possibility&nbsp;to&nbsp;re-direct&nbsp;certain&nbsp;MACs&nbsp;from&nbsp;the&nbsp;LAN&nbsp;through&nbsp;Squid&nbsp;and&nbsp;others&nbsp;can&nbsp;go&nbsp;direct?&lt;/li&gt;&lt;li&gt;Is&nbsp;there&nbsp;a&nbsp;good&nbsp;howto&nbsp;that&nbsp;describes&nbsp;in&nbsp;detail&nbsp;how&nbsp;autdetect proxy&nbsp;works&nbsp;with&nbsp;wpad.dat.&nbsp;I&nbsp;want&nbsp;that&nbsp;when&nbsp;users&nbsp;are&nbsp;on&nbsp;LAN&nbsp;they&nbsp;go&nbsp;through&nbsp;squid,&nbsp;but&nbsp;when&nbsp;they&nbsp;are&nbsp;travelling&nbsp;they&nbsp;can&nbsp;go&nbsp;direct.&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;help,&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Wolfgang&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://172.16.0.0/12&quot;&gt;172.16.0.0/12&lt;/a&gt;&nbsp; #&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&gt;#acl&nbsp;localnet&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://192.168.0.0/16&quot;&gt;192.168.0.0/16&lt;/a&gt;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network&lt;br&gt;#acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range&lt;br&gt;#acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp; &nbsp; &nbsp; #&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines&lt;br&gt;&lt;br&gt;acl&nbsp;SSL_ports&nbsp;port&nbsp;443&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;ftp&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;https&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;gopher&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;wais&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp; #&nbsp;unregistered&nbsp;ports&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;http-mgmt&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;gss-http&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;filemaker&lt;br&gt;acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;multiling&nbsp;http&lt;br&gt;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;#&nbsp;Add&nbsp;wo-lar&nbsp;LAN&nbsp;IP&lt;br&gt;acl&nbsp;lan&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://10.5.2.0/24&quot;&gt;10.5.2.0/24&lt;/a&gt;&lt;br&gt;&lt;br&gt;#&nbsp;Basic&nbsp;user&nbsp;auth&lt;br&gt;#auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib64/squid/basic_ncsa_auth&nbsp;/etc/squid/.htpasswd&lt;br&gt;#auth_param&nbsp;basic&nbsp;children&nbsp;5&lt;br&gt;#auth_param&nbsp;basic&nbsp;realm&nbsp;Squid&nbsp;Basic&nbsp;Authentication&lt;br&gt;#auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;5&nbsp;hours&lt;br&gt;#acl&nbsp;password&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;#http_access&nbsp;allow&nbsp;password&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Recommended&nbsp;minimum&nbsp;Access&nbsp;Permission&nbsp;configuration:&lt;br&gt;#&lt;br&gt;#&nbsp;Deny&nbsp;requests&nbsp;to&nbsp;certain&nbsp;unsafe&nbsp;ports&lt;br&gt;#http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;&lt;br&gt;#&nbsp;Deny&nbsp;CONNECT&nbsp;to&nbsp;other&nbsp;than&nbsp;secure&nbsp;SSL&nbsp;ports&lt;br&gt;#http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;&lt;br&gt;#&nbsp;Only&nbsp;allow&nbsp;cachemgr&nbsp;access&nbsp;from&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&nbsp;manager&lt;br&gt;http_access&nbsp;deny&nbsp;manager&lt;br&gt;&lt;br&gt;#&nbsp;We&nbsp;strongly&nbsp;recommend&nbsp;the&nbsp;following&nbsp;be&nbsp;uncommented&nbsp;to&nbsp;protect&nbsp;innocent&lt;br&gt;#&nbsp;web&nbsp;applications&nbsp;running&nbsp;on&nbsp;the&nbsp;proxy&nbsp;server&nbsp;who&nbsp;think&nbsp;the&nbsp;only&lt;br&gt;#&nbsp;one&nbsp;who&nbsp;can&nbsp;access&nbsp;services&nbsp;on&nbsp;&quot;localhost&quot;&nbsp;is&nbsp;a&nbsp;local&nbsp;user&lt;br&gt;#http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;INSERT&nbsp;YOUR&nbsp;OWN&nbsp;RULE(S)&nbsp;HERE&nbsp;TO&nbsp;ALLOW&nbsp;ACCESS&nbsp;FROM&nbsp;YOUR&nbsp;CLIENTS&lt;br&gt;#&lt;br&gt;acl&nbsp;allowdomains&nbsp;dstdomain&nbsp;&quot;/etc/squid/whitelists/domains&quot;&lt;br&gt;acl&nbsp;porn&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dstdomain&nbsp;&quot;/etc/squid/blacklists/porn/domains&quot;&lt;br&gt;acl&nbsp;drugs&nbsp; &nbsp; &nbsp; &nbsp; dstdomain&nbsp;&quot;/etc/squid/blacklists/drugs/domains&quot;&lt;br&gt;http_access&nbsp;allow&nbsp;allowdomains&lt;br&gt;http_access&nbsp;deny&nbsp;porn&lt;br&gt;http_access&nbsp;deny&nbsp;drugs&lt;br&gt;&lt;br&gt;#&nbsp;Example&nbsp;rule&nbsp;allowing&nbsp;access&nbsp;from&nbsp;your&nbsp;local&nbsp;networks.&lt;br&gt;#&nbsp;Adapt&nbsp;localnet&nbsp;in&nbsp;the&nbsp;ACL&nbsp;section&nbsp;to&nbsp;list&nbsp;your&nbsp;(internal)&nbsp;IP&nbsp;networks&lt;br&gt;#&nbsp;from&nbsp;where&nbsp;browsing&nbsp;should&nbsp;be&nbsp;allowed&lt;br&gt;http_access&nbsp;allow&nbsp;localhost&lt;br&gt;http_access&nbsp;allow&nbsp;lan&lt;br&gt;&lt;br&gt;#&nbsp;And&nbsp;finally&nbsp;deny&nbsp;all&nbsp;other&nbsp;access&nbsp;to&nbsp;this&nbsp;proxy&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;#&nbsp;Squid&nbsp;normally&nbsp;listens&nbsp;to&nbsp;port&nbsp;3128&lt;br&gt;http_port&nbsp;3128&lt;br&gt;&lt;br&gt;#&nbsp;Uncomment&nbsp;and&nbsp;adjust&nbsp;the&nbsp;following&nbsp;to&nbsp;add&nbsp;a&nbsp;disk&nbsp;cache&nbsp;directory.&lt;br&gt;#cache_dir&nbsp;ufs&nbsp;/var/spool/squid&nbsp;100&nbsp;16&nbsp;256&lt;br&gt;&lt;br&gt;#&nbsp;Leave&nbsp;coredumps&nbsp;in&nbsp;the&nbsp;first&nbsp;cache&nbsp;dir&lt;br&gt;coredump_dir&nbsp;/var/spool/squid&lt;br&gt;&lt;br&gt;#&lt;br&gt;#&nbsp;Add&nbsp;any&nbsp;of&nbsp;your&nbsp;own&nbsp;refresh_pattern&nbsp;entries&nbsp;above&nbsp;these.&lt;br&gt;#&lt;br&gt;refresh_pattern&nbsp;^ftp:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1440&nbsp; &nbsp; 20%&nbsp; &nbsp; &nbsp;10080&lt;br&gt;refresh_pattern&nbsp;^gopher:&nbsp; &nbsp; &nbsp; &nbsp; 1440&nbsp; &nbsp; 0%&nbsp; &nbsp; &nbsp; 1440&lt;br&gt;refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp; &nbsp; &nbsp;0%&nbsp; &nbsp; &nbsp; 0&lt;br&gt;refresh_pattern&nbsp;.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;20%&nbsp; &nbsp; &nbsp;4320&lt;br&gt;&lt;br&gt;request_header_access&nbsp;Referer&nbsp;deny&nbsp;all&lt;br&gt;request_header_access&nbsp;X-Forwarded-For&nbsp;deny&nbsp;all&lt;br&gt;request_header_access&nbsp;Via&nbsp;deny&nbsp;all&lt;br&gt;request_header_access&nbsp;Cache-Control&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;#&nbsp;do&nbsp;not&nbsp;display&nbsp;IP&nbsp;address&lt;br&gt;forwarded_for&nbsp;off&lt;br&gt;&lt;br&gt;#&nbsp;Virus&nbsp;check&nbsp;for&nbsp;downloads&lt;br&gt;icap_enable&nbsp;on&lt;br&gt;icap_send_client_ip&nbsp;on&lt;br&gt;icap_send_client_username&nbsp;on&lt;br&gt;icap_client_username_header&nbsp;X-Authenticated-User&lt;br&gt;&lt;/div&gt;&lt;div&gt;icap_service&nbsp;service_req&nbsp;reqmod_precache&nbsp;bypass=1&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/squidclamav&quot;&gt;127.0.0.1:1344/squidclamav&lt;/a&gt;&lt;br&gt;adaptation_access&nbsp;service_req&nbsp;allow&nbsp;all&lt;br&gt;icap_service&nbsp;service_resp&nbsp;respmod_precache&nbsp;bypass=1&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/squidclamav&quot;&gt;127.0.0.1:1344/squidclamav&lt;/a&gt;&lt;br&gt;adaptation_access&nbsp;service_resp&nbsp;allow&nbsp;all&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Wolfgang&nbsp;Rauchholz&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;+34&nbsp;627&nbsp;994&nbsp;977&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;a&nbsp;href=&quot;https://www.linkedin.com/in/wolfgangrauchholz/&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.linkedin.com/in/wolfgangrauchholz/&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
