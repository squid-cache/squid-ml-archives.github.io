<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;create&nbsp;a&nbsp;whitelist&nbsp;that&nbsp;allows&nbsp;cloudfront&nbsp;302&nbsp;redirections,&nbsp;e.g.&nbsp;gitlab&nbsp;is&nbsp;using&nbsp;cloudfront&nbsp;as&nbsp;CDN&nbsp;and&nbsp;when&nbsp;we&nbsp;whitelist&nbsp;&lt;a&nbsp;href=&quot;http://package.gitlab.com&quot;&gt;package.gitlab.com&lt;/a&gt;&nbsp;the&nbsp;URL&nbsp;is&nbsp;redirected&nbsp;(302)&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb?t=1619023239_a63698472b6bebeaee980e7c030632d97a29c15d&quot;&gt;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb?t=1619023239_a63698472b6bebeaee980e7c030632d97a29c15d&lt;/a&gt;.&nbsp;I&nbsp;could&nbsp;whitelist&nbsp;a&nbsp;whole&nbsp;.&lt;a&nbsp;href=&quot;http://cloudfront.net&quot;&gt;cloudfront.net&lt;/a&gt;&nbsp;domain&nbsp;or&nbsp;url_regex,&nbsp;but&nbsp;what&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;achieve,&nbsp;I&nbsp;don&#39;t&nbsp;know&nbsp;if&nbsp;possible,&nbsp;is&nbsp;a&nbsp;chain&nbsp;of&nbsp;events&nbsp;like:&lt;br&gt;If&nbsp;&lt;a&nbsp;href=&quot;http://packages.gitlab.com&quot;&gt;packages.gitlab.com&lt;/a&gt;&nbsp;return&nbsp;302&nbsp;Location&nbsp;.cloudfront,&nbsp;then&nbsp;allow&nbsp;&lt;a&nbsp;href=&quot;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb?t=1619023239_a63698472b6bebeaee980e7c030632d97a29c&quot;&gt;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb?t=1619023239_a63698472b6bebeaee980e7c030632d97a29c&lt;/a&gt;&nbsp;request.&lt;br&gt;I&#39;ve&nbsp;been&nbsp;playing&nbsp;around&nbsp;with&nbsp;http_reply_access&nbsp;and&nbsp;rep_headers,&nbsp;but&nbsp;I&nbsp;can&nbsp;only&nbsp;go&nbsp;as&nbsp;far&nbsp;as&nbsp;allow&nbsp;replay&nbsp;of&nbsp;the&nbsp;first&nbsp;request&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://package.gitlab.com&quot;&gt;package.gitlab.com&lt;/a&gt;,&nbsp;but&nbsp;then&nbsp;a&nbsp;GET&nbsp;to&nbsp;cloudfront&nbsp;is&nbsp;blocked&nbsp;anyway&nbsp;as&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;our&nbsp;whitelist.&lt;br&gt;e.g.&lt;br&gt;1619022938.916&nbsp; &nbsp;423&nbsp;172.16.230.237&nbsp;NONE/200&nbsp;0&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://54.153.54.194:443&quot;&gt;54.153.54.194:443&lt;/a&gt;&nbsp;-&nbsp;ORIGINAL_DST/&lt;a&nbsp;href=&quot;http://54.153.54.194&quot;&gt;54.153.54.194&lt;/a&gt;&nbsp;-&nbsp;&lt;br&gt;1619022939.074&nbsp; &nbsp;153&nbsp;172.16.230.237&nbsp;TCP_MISS/302&nbsp;758&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;https://packages.gitlab.com/gitlab/gitlab-ee/packages/ubuntu/bionic/gitlab-ee_11.0.1-ee.0_amd64.deb/download.deb&quot;&gt;https://packages.gitlab.com/gitlab/gitlab-ee/packages/ubuntu/bionic/gitlab-ee_11.0.1-ee.0_amd64.deb/download.deb&lt;/a&gt;&nbsp;-&nbsp;ORIGINAL_DST/&lt;a&nbsp;href=&quot;http://54.153.54.194&quot;&gt;54.153.54.194&lt;/a&gt;&nbsp;text/html&nbsp;&lt;br&gt;1619022939.108&nbsp; &nbsp; 20&nbsp;172.16.230.237&nbsp;NONE/200&nbsp;0&nbsp;CONNECT&nbsp;&lt;a&nbsp;href=&quot;http://52.84.90.34:443&quot;&gt;52.84.90.34:443&lt;/a&gt;&nbsp;-&nbsp;ORIGINAL_DST/&lt;a&nbsp;href=&quot;http://52.84.90.34&quot;&gt;52.84.90.34&lt;/a&gt;&nbsp;-&nbsp;&lt;br&gt;&lt;div&gt;1619022939.114&nbsp; &nbsp; &nbsp;2&nbsp;172.16.230.237&nbsp;TCP_DENIED/403&nbsp;19053&nbsp;GET&nbsp;&lt;a&nbsp;href=&quot;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb&quot;&gt;https://d20rj4el6vkp4c.cloudfront.net/7/11/ubuntu/package_files/35938.deb&lt;/a&gt;?&nbsp;-&nbsp;HIER_NONE/-&nbsp;text/html&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Mirek&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
