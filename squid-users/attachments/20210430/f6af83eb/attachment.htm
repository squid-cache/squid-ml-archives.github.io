<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hello&nbsp;Alex,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thank&nbsp;you&nbsp;for&nbsp;your&nbsp;answer.&nbsp;I&nbsp;was&nbsp;little&nbsp;bit&nbsp;puzzled&nbsp;since&nbsp;I&nbsp;haven&#39;t&nbsp;got&nbsp;any&nbsp;error&nbsp;when&nbsp;using&nbsp;&quot;clientca&quot;&nbsp;with&nbsp;&quot;http_port&quot;.&nbsp;I&nbsp;thought,&nbsp;maybe&nbsp;it&nbsp;was&nbsp;somehow&nbsp;possible,&nbsp;beyond&nbsp;my&nbsp;understanding.&nbsp;:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;reason&nbsp;why&nbsp;I&nbsp;didn&#39;t&nbsp;respond&nbsp;immediately,&nbsp;because&nbsp;I&nbsp;wanted&nbsp;to&nbsp;test&nbsp;everything&nbsp;with&nbsp;the&nbsp;&quot;https_port&quot;&nbsp;configuration.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;my&nbsp;configuration&nbsp;looks&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;https_port&nbsp;443&nbsp;tls-cert=/etc/squid/certs/new-squid.cert&nbsp;tls-key=/etc/squid/certs/new-squid.key&nbsp;clientca=/etc/squid/certs/autn.pem&nbsp;capath=/etc/squid/certs/CAs&nbsp;sslcontext=id&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;works...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;do&nbsp;is&nbsp;access&nbsp;control&nbsp;with&nbsp;*user_cert*&nbsp;ACL&nbsp;based&nbsp;on&nbsp;CN&nbsp;information.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;ACL&nbsp;configuration&nbsp;is&nbsp;super&nbsp;minimal:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;acl&nbsp;ssl_auth&nbsp;user_cert&nbsp;CN&nbsp;&quot;/etc/squid/&lt;a&nbsp;href=&quot;http://allowed.cn&quot;&gt;allowed.cn&lt;/a&gt;&quot;&lt;br&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;ssl_auth&lt;/div&gt;&lt;div&gt;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
File&nbsp;&quot;/etc/squid/&lt;a&nbsp;href=&quot;http://allowed.cn&quot;&gt;allowed.cn&lt;/a&gt;&quot;&nbsp;contains&nbsp;one&nbsp;row/entry:&nbsp;&quot;Doe&nbsp;John&nbsp;PKI&nbsp;1234567890&quot;&nbsp;(without&nbsp;quotes)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However&nbsp;this&nbsp;doesn&#39;t&nbsp;work.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;From&nbsp;the&nbsp;cache.log,&nbsp;it&nbsp;is&nbsp;visible&nbsp;that&nbsp;client&nbsp;certificate&nbsp;information&nbsp;is&nbsp;fetched:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;clientNegotiateSSL:&nbsp;New&nbsp;session&nbsp;0x11415a0&nbsp;on&nbsp;FD&nbsp;12&nbsp;(10.x.x.x:60308)&lt;br&gt;&gt;&nbsp;retrieveNegotiatedInfo:&nbsp;SSL&nbsp;connection&nbsp;info&nbsp;on&nbsp;FD&nbsp;12&nbsp;SSL&nbsp;version&nbsp;TLS/1.2&nbsp;negotiated&nbsp;cipher&nbsp;AES128-GCM-SHA256&lt;br&gt;&gt;&nbsp;clientNegotiateSSL:&nbsp;FD&nbsp;12&nbsp;client&nbsp;certificate:&nbsp;subject:&nbsp;/DC=tst/CN=Doe&nbsp;John&nbsp;PKI&nbsp;1234567890&lt;br&gt;&gt;&nbsp;clientNegotiateSSL:&nbsp;FD&nbsp;12&nbsp;client&nbsp;certificate:&nbsp;issuer:&nbsp;/DC=com/DC=tst/DC=PKI/CN=CA-AUTH-01&lt;br&gt;&gt;&nbsp;Server.cc(90)&nbsp;readSomeData:&nbsp;conn7&nbsp;local=10.x.x.x:443&nbsp;remote=10.x.x.x:60308&nbsp;FD&nbsp;12&nbsp;flags=1:&nbsp;reading&nbsp;request...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;From&nbsp;the&nbsp;cache.log&nbsp;is&nbsp;as&nbsp;well&nbsp;visible&nbsp;that&nbsp;ssl_auth&nbsp;ACL&nbsp;is&nbsp;checked,&nbsp;but&nbsp;there&nbsp;is&nbsp;NO&nbsp;MATCH:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;http_access&lt;br&gt;&gt;&nbsp;Checklist.cc(398)&nbsp;bannedAction:&nbsp;Action&nbsp;&#39;ALLOWED/0&#39;&nbsp;is&nbsp;not&nbsp;banned&lt;br&gt;&gt;&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;http_access#1&lt;br&gt;&gt;&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;ssl_auth    &nbsp;&lt;&nbsp;---&nbsp;Access&nbsp;list&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;CertificateData.cc(68)&nbsp;match:&nbsp;CN=Doe&nbsp;John&nbsp;PKI&nbsp;1234567890  &nbsp;&lt;&nbsp;---&nbsp;Client&nbsp;certificate&nbsp;CN&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;MemBlob.cc(56)&nbsp;MemBlob:&nbsp;constructed,&nbsp;this=0x14dccc0&nbsp;id=blob1388&nbsp;reserveSize=35&lt;br&gt;&gt;&nbsp;MemBlob.cc(101)&nbsp;memAlloc:&nbsp;blob1388&nbsp;memAlloc:&nbsp;requested=35,&nbsp;received=40&lt;br&gt;&gt;&nbsp;SBuf.cc(866)&nbsp;reAlloc:&nbsp;SBuf5096&nbsp;new&nbsp;store&nbsp;capacity:&nbsp;40&lt;br&gt;&gt;&nbsp;StringData.cc(33)&nbsp;match:&nbsp;aclMatchStringList:&nbsp;checking&nbsp;&#39;Doe&nbsp;John&nbsp;PKI&nbsp;1234567890&#39;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;StringData.cc(36)&nbsp;match:&nbsp;aclMatchStringList:&nbsp;&#39;Doe&nbsp;John&nbsp;PKI&nbsp;1234567890&#39;&nbsp;NOT&nbsp;found  &nbsp;<br>
&lt;&nbsp;---&nbsp;doesn&#39;t&nbsp;match&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;ssl_auth&nbsp;=&nbsp;0&lt;br&gt;&gt;&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;http_access#1&nbsp;=&nbsp;0&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;really&nbsp;not&nbsp;sure&nbsp;what&nbsp;I&nbsp;have&nbsp;missed...&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;to&nbsp;put&nbsp;CN&nbsp;directly&nbsp;in&nbsp;the&nbsp;ACL,&nbsp;so&nbsp;with&nbsp;no&nbsp;reference&nbsp;to&nbsp;thefile.&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;to&nbsp;put&nbsp;single&nbsp;and&nbsp;double&nbsp;quotes&nbsp;around&nbsp;CN&nbsp;in&nbsp;&lt;a&nbsp;href=&quot;http://allowed.cn&quot;&gt;allowed.cn&lt;/a&gt;&nbsp;file,&nbsp;as&nbsp;well.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Could&nbsp;you&nbsp;please&nbsp;help&nbsp;me&nbsp;further?&nbsp;What&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong&nbsp;here?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;and&nbsp;regards,&lt;/div&gt;&lt;div&gt;Neven&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
