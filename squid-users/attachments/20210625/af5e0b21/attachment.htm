<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&nbsp;http-equiv=Content-Type&gt;<br>
&lt;META&nbsp;name=GENERATOR&nbsp;content=&quot;MSHTML&nbsp;11.00.10570.1001&quot;&gt;&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;Hello&nbsp;<br>
all,&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;I'm&nbsp;trying&nbsp;to&nbsp;use&nbsp;<br>
request&nbsp;headers&nbsp;in&nbsp;an&nbsp;external&nbsp;acl,&nbsp;and&nbsp;I'm&nbsp;probably&nbsp;doing&nbsp;it&nbsp;incorrectly,&nbsp;and&nbsp;<br>
it's&nbsp;not&nbsp;working.&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;Here's&nbsp;my&nbsp;acl&nbsp;<br>
definiton:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=&quot;Courier&nbsp;New&quot;&gt;external_acl_type&nbsp;ext_acl_program&nbsp;&nbsp;%SRC&nbsp;<br>
%&gt;{Connection}&nbsp;%&gt;{Accept}&nbsp;%&gt;{Custom_header}&nbsp;%&gt;{Host}&nbsp;<br>
/etc/squid/ext_acl_program.pl&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;The&nbsp;program&nbsp;<br>
ext_acl_program.pl&nbsp;simply&nbsp;prints&nbsp;out&nbsp;the&nbsp;input&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;FONT&nbsp;<br>
face=&quot;Courier&nbsp;New&quot;&gt;&nbsp;&nbsp;&nbsp;chomp&nbsp;($line);&lt;BR&gt;&nbsp;&nbsp;&nbsp;<br>
@fields&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;split('&nbsp;',&nbsp;<br>
$line);&lt;BR&gt;&nbsp;&nbsp;&nbsp;my&nbsp;$ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;=&nbsp;$fields[0];&lt;BR&gt;&nbsp;&nbsp;&nbsp;my&nbsp;$connection&nbsp;&nbsp;&nbsp;=&nbsp;<br>
$fields[1];&lt;BR&gt;&nbsp;&nbsp;&nbsp;my&nbsp;$accept&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<br>
$fields[2];&lt;BR&gt;&nbsp;&nbsp;&nbsp;my&nbsp;$custom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<br>
$fields[3];&lt;BR&gt;&nbsp;&nbsp;&nbsp;my&nbsp;$host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;=&nbsp;$fields[4];&lt;/FONT&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
print&nbsp;LOGFILE&nbsp;&nbsp;&quot;IP:&nbsp;$ip\n&nbsp;Conn:&nbsp;$connection\n&nbsp;Accept:&nbsp;$accept\n&nbsp;Custom:&nbsp;<br>
$custom\n&nbsp;Host:&nbsp;$host&quot;;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=&quot;Courier&nbsp;New&quot;&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=&quot;Courier&nbsp;New&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;T&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;he&nbsp;output&nbsp;looks&nbsp;like&nbsp;this:&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;IP:&nbsp;<br>
10.200.10.2&lt;BR&gt;Conn:&nbsp;keep-alive&lt;BR&gt;Accept:&nbsp;-&lt;BR&gt;Custom:&nbsp;-&lt;BR&gt;Host:&nbsp;&lt;/FONT&gt;&lt;A&nbsp;<br>
href=&quot;http://www.wsws.com:443&quot;&gt;&lt;FONT&nbsp;color=#000000&nbsp;size=2&nbsp;<br>
face=&quot;Courier&nbsp;New&quot;&gt;www.wsws.com:443&lt;/FONT&gt;&lt;/A&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;face=Arial&gt;As&nbsp;you&nbsp;see,&nbsp;<br>
it&nbsp;has&nbsp;values&nbsp;for&nbsp;%SRC,&nbsp;%&gt;{Connection}&nbsp;and&nbsp;%&gt;{Host}.&nbsp;&nbsp;It&nbsp;does&nbsp;not&nbsp;<br>
have&nbsp;values&nbsp;for&nbsp;%&gt;{Accept}&nbsp;and&nbsp;%&gt;{Custom_header}&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;SPAN&nbsp;class=236144918-25062021&gt;&lt;FONT&nbsp;size=2&nbsp;<br>
face=Arial&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;S&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;o&nbsp;the&nbsp;question&nbsp;is,&nbsp;are&nbsp;these&nbsp;%&gt;{}&nbsp;substitutions&nbsp;<br>
coming&nbsp;from&nbsp;request_headers&nbsp;(as&nbsp;I&nbsp;thought)?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;If&nbsp;yes,&nbsp;why&nbsp;does&nbsp;it&nbsp;only&nbsp;have&nbsp;Connection&nbsp;and&nbsp;Host,&nbsp;<br>
and&nbsp;not&nbsp;Accept&nbsp;or&nbsp;my&nbsp;custom&nbsp;header?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;If&nbsp;they&nbsp;are&nbsp;not&nbsp;coming&nbsp;from&nbsp;request&nbsp;headers,&nbsp;where&nbsp;are&nbsp;<br>
they&nbsp;coming&nbsp;from?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;And&nbsp;mostly,&nbsp;how&nbsp;can&nbsp;I&nbsp;pass&nbsp;my&nbsp;custom&nbsp;header&nbsp;into&nbsp;the&nbsp;<br>
program?&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;Thanks&nbsp;so&nbsp;much&nbsp;for&nbsp;your&nbsp;<br>
responses,&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;face=&quot;Courier&nbsp;New&quot;&gt;&lt;FONT&nbsp;size=2&gt;&lt;FONT&nbsp;face=Arial&gt;&lt;SPAN&nbsp;<br>
class=236144918-25062021&gt;Yosi&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/SPAN&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
