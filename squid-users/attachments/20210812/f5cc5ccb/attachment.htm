<tt>
&lt;div&nbsp;dir=&quot;auto&quot;&gt;Thanks&nbsp;Amos&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Thu,&nbsp;12&nbsp;Aug&nbsp;2021,&nbsp;04:05&nbsp;Amos&nbsp;Jeffries,&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;12/08/21&nbsp;4:06&nbsp;am,&nbsp;robert&nbsp;k&nbsp;Wild&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Great&nbsp;thanks&nbsp;Amos&nbsp;as&nbsp;always&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;So&nbsp;shall&nbsp;I&nbsp;leave&nbsp;this&nbsp;ssl&nbsp;bump&nbsp;lines&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&lt;br&gt;<br>
&gt;&gt;&nbsp;ssl_bump&nbsp;peek&nbsp;DiscoverSNIHost&lt;br&gt;<br>
&gt;&gt;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;And&nbsp;delete&nbsp;this&nbsp;one&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&gt;&gt;&nbsp;ssl_bump&nbsp;peek&nbsp;step1&lt;br&gt;<br>
&gt;&gt;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;As&nbsp;your&nbsp;right&nbsp;there&nbsp;both&nbsp;the&nbsp;same,&nbsp;I&nbsp;didn&#39;t&nbsp;spot&nbsp;that&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;My&nbsp;understanding&nbsp;is&nbsp;the&nbsp;&quot;no&nbsp;ssl&nbsp;intercept&quot;,&nbsp;squid&nbsp;doesn&#39;t&nbsp;even&nbsp;bother&nbsp;to&nbsp;&lt;br&gt;<br>
&gt;&nbsp;inspect&nbsp;the&nbsp;packets&nbsp;ie&nbsp;man&nbsp;in&nbsp;the&nbsp;middle&nbsp;and&nbsp;just&nbsp;literally&nbsp;passes&nbsp;it&nbsp;&lt;br&gt;<br>
&gt;&nbsp;straight&nbsp;to&nbsp;the&nbsp;client&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Is&nbsp;that&nbsp;right?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Not&nbsp;quite.&nbsp;Squid&nbsp;still&nbsp;has&nbsp;to&nbsp;receive&nbsp;and&nbsp;look&nbsp;at&nbsp;something&nbsp;to&nbsp;make&nbsp;the&nbsp;&lt;br&gt;<br>
decision&nbsp;to&nbsp;splice.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;&quot;NoSSLIntercept&quot;&nbsp;is&nbsp;just&nbsp;an&nbsp;ACL.&nbsp;Being&nbsp;defined&nbsp;as&nbsp;a&nbsp;ssl:server_name&nbsp;&lt;br&gt;<br>
type&nbsp;it&nbsp;looks&nbsp;at&nbsp;whatever&nbsp;Squid&nbsp;is&nbsp;able&nbsp;to&nbsp;find&nbsp;for&nbsp;a&nbsp;server&nbsp;name&nbsp;&lt;br&gt;<br>
amongst&nbsp;the&nbsp;available&nbsp;data&nbsp;(CONNECT&nbsp;message&nbsp;URI,&nbsp;the&nbsp;client&nbsp;IP&#39;s&nbsp;&lt;br&gt;<br>
reverse-DNS,&nbsp;any&nbsp;TLS&nbsp;details&nbsp;seen&nbsp;so&nbsp;far,&nbsp;etc.&lt;br&gt;<br>
 &nbsp;So&nbsp;it&nbsp;depends&nbsp;on&nbsp;how&nbsp;many&nbsp;of&nbsp;the&nbsp;SSL-Bump&nbsp;steps&nbsp;have&nbsp;taken&nbsp;place&nbsp;so&nbsp;&lt;br&gt;<br>
far&nbsp;as&nbsp;to&nbsp;what&nbsp;it&nbsp;can&nbsp;match&nbsp;against.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;your&nbsp;case&nbsp;it&nbsp;happens&nbsp;at&nbsp;step1&nbsp;and&nbsp;maybe&nbsp;step2&nbsp;(when&nbsp;the&nbsp;peek&nbsp;happened&nbsp;&lt;br&gt;<br>
at&nbsp;step1&nbsp;instead).&nbsp;When&nbsp;means&nbsp;Squid&nbsp;looks&nbsp;at&nbsp;the&nbsp;TCP&nbsp;connections&nbsp;&lt;br&gt;<br>
client-IP,&nbsp;a&nbsp;CONNECT&nbsp;URI&nbsp;(if&nbsp;any)&nbsp;and&nbsp;maybe&nbsp;the&nbsp;TLS&nbsp;client&nbsp;handshake&nbsp;&lt;br&gt;<br>
plain-text&nbsp;details.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp;Note&nbsp;this&nbsp;is&nbsp;specific&nbsp;to&nbsp;your&nbsp;*current*&nbsp;configuration.&nbsp;Small&nbsp;changes&nbsp;&lt;br&gt;<br>
to&nbsp;the&nbsp;order&nbsp;of&nbsp;ssl_bump&nbsp;lines&nbsp;or&nbsp;ACLs&nbsp;used&nbsp;can&nbsp;change&nbsp;this&nbsp;behaviour&nbsp;&lt;br&gt;<br>
dramatically.&lt;br&gt;<br>
&lt;br&gt;<br>
Amos&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&nbsp;rel=&quot;noreferrer&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&nbsp;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
