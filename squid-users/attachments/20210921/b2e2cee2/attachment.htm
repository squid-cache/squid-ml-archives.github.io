<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#464646&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;have&nbsp;setup&nbsp;Kerberos&nbsp;authentication&nbsp;with&nbsp;Windows&nbsp;2019&nbsp;domain&nbsp;using<br>
&nbsp;&nbsp;&nbsp;&nbsp;Squid&nbsp;5.1&nbsp;(&nbsp;The&nbsp;Squid&nbsp;version&nbsp;did&nbsp;not&nbsp;fix&nbsp;the&nbsp;issue&nbsp;-&nbsp;Tested&nbsp;4.x&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;5.x)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;some&nbsp;cases,&nbsp;some&nbsp;computers&nbsp;are&nbsp;not&nbsp;joined&nbsp;to&nbsp;the&nbsp;domain&nbsp;and&nbsp;ween<br>
&nbsp;&nbsp;&nbsp;&nbsp;need&nbsp;to&nbsp;allow&nbsp;authenticate&nbsp;on&nbsp;Squid&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;allow&nbsp;this, &nbsp;Basic&nbsp;Authentication&nbsp;is&nbsp;defined&nbsp;in&nbsp;Squid &nbsp;and&nbsp;we<br>
&nbsp;&nbsp;&nbsp;&nbsp;expect&nbsp;that&nbsp;browsers&nbsp;prompt&nbsp;a&nbsp;login&nbsp;to&nbsp;be&nbsp;authenticated&nbsp;and&nbsp;access<br>
&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;Internet&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;But&nbsp;the&nbsp;behavior&nbsp;is&nbsp;strange.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;a&nbsp;computer&nbsp;outside&nbsp;the&nbsp;windows&nbsp;domain:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Firefox&nbsp;is&nbsp;be&nbsp;able&nbsp;to&nbsp;be&nbsp;successfully&nbsp;authenticated&nbsp;to&nbsp;squid&nbsp;using<br>
&nbsp;&nbsp;&nbsp;&nbsp;basic&nbsp;auth.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Edge,&nbsp;Chrome&nbsp;and&nbsp;IE&nbsp;still&nbsp;try&nbsp;ujsing&nbsp;NTLM&nbsp;method&nbsp;and&nbsp;are&nbsp;allways<br>
&nbsp;&nbsp;&nbsp;&nbsp;rejected&nbsp;with&nbsp;a&nbsp;407&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;When&nbsp;edge,&nbsp;chrome&nbsp;and&nbsp;IE&nbsp;try&nbsp;to&nbsp;establish&nbsp;a&nbsp;session,&nbsp;Squid&nbsp;claim&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2021/09/21&nbsp;01:17:27&nbsp;kid1|&nbsp;ERROR:&nbsp;Negotiate&nbsp;Authentication&nbsp;validating<br>
&nbsp;&nbsp;&nbsp;&nbsp;user.&nbsp;Result:&nbsp;{result=BH,&nbsp;notes={message:&nbsp;received&nbsp;type&nbsp;1&nbsp;NTLM<br>
&nbsp;&nbsp;&nbsp;&nbsp;token;&nbsp;}}&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;let&nbsp;us&nbsp;understanding&nbsp;that&nbsp;these&nbsp;3&nbsp;browsers&nbsp;try&nbsp;NTLM&nbsp;instead&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;Basic&nbsp;Authentication.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;did&nbsp;not&nbsp;know&nbsp;why&nbsp;these&nbsp;browsers&nbsp;using&nbsp;NTLM&nbsp;as&nbsp;they&nbsp;did&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;connected&nbsp;to&nbsp;the&nbsp;Windows&nbsp;domain&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Why&nbsp;squid&nbsp;never&nbsp;get&nbsp;the&nbsp;Basic&nbsp;Authentication&nbsp;credentials.&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Did&nbsp;i&nbsp;miss&nbsp;something&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;it&nbsp;is&nbsp;my&nbsp;configuration.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;negotiate&nbsp;program&nbsp;/lib/squid3/negotiate_kerberos_auth&nbsp;-r<br>
&nbsp;&nbsp;&nbsp;&nbsp;-s&nbsp;GSS_C_NO_NAME&nbsp;-k&nbsp;/etc/squid3/PROXY.keytab&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;negotiate&nbsp;children&nbsp;20&nbsp;startup=5&nbsp;idle=1&nbsp;concurrency=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;queue-size=80&nbsp;on-persistent-overload=ERR&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;negotiate&nbsp;keep_alive&nbsp;on&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;basic&nbsp;program&nbsp;/lib/squid3/basic_ldap_auth&nbsp;-v&nbsp;-R&nbsp;-b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;DC=articatech,DC=int&quot;&nbsp;-D&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:administrator@articatech.int&quot;&gt;&quot;administrator@articatech.int&quot;&lt;/a&gt;&nbsp;-W<br>
&nbsp;&nbsp;&nbsp;&nbsp;/etc/squid3/ldappass.txt&nbsp;-f&nbsp;sAMAccountName=%s&nbsp;-v&nbsp;3&nbsp;-h&nbsp;192.168.90.10&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;basic&nbsp;children&nbsp;3&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;basic&nbsp;realm&nbsp;Active&nbsp;Directory&nbsp;articatech.int&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;7200&nbsp;seconds&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;authenticate_ttl&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;authenticate_ip_ttl&nbsp;1&nbsp;seconds&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;authenticate_cache_garbage_interval&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;AUTHENTICATED&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
