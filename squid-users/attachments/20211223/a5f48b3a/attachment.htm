<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Alex,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;attached&nbsp;a&nbsp;log&nbsp;with&nbsp;about&nbsp;24&nbsp;hours&nbsp;of&nbsp;memory&nbsp;stats&nbsp;from&nbsp;our&nbsp;squid&nbsp;proxy&nbsp;running&nbsp;version&nbsp;5.3.&nbsp;The&nbsp;memory&nbsp;usage&nbsp;increased during&nbsp;the&nbsp;first&nbsp;11-12&nbsp;hours&nbsp;of&nbsp;the&nbsp;log&nbsp;and&nbsp;then&nbsp;flatted&nbsp;out.&nbsp;The&nbsp;same&nbsp;pattern&nbsp;repeats&nbsp;itself&nbsp;each&nbsp;day&nbsp;with about&nbsp;an&nbsp;additional&nbsp;2-3G&nbsp;being&nbsp;used&nbsp;up.&nbsp;Let&nbsp;me&nbsp;know&nbsp;if&nbsp;you&nbsp;need&nbsp;any&nbsp;additional&nbsp;logs.&nbsp;I&nbsp;will&nbsp;take&nbsp;another shot&nbsp;at&nbsp;the&nbsp;test&nbsp;setup&nbsp;with&nbsp;Valgrind&nbsp;later&nbsp;on.&nbsp;Happy&nbsp;holidays!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://bugs.squid-cache.org/show_bug.cgi?id=5132&quot;&gt;https://bugs.squid-cache.org/show_bug.cgi?id=5132&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Praveen&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;23,&nbsp;2021&nbsp;at&nbsp;6:23&nbsp;AM&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;12/23/21&nbsp;1:58&nbsp;AM,&nbsp;Praveen&nbsp;Ponakanti&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Wed,&nbsp;Dec&nbsp;22,&nbsp;2021&nbsp;at&nbsp;6:45&nbsp;AM&nbsp;Alex&nbsp;Rousskov&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; On&nbsp;12/21/21&nbsp;7:48&nbsp;PM,&nbsp;Praveen&nbsp;Ponakanti&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;We&nbsp;are&nbsp;running&nbsp;the&nbsp;squid&nbsp;proxy&nbsp;for&nbsp;servicing&nbsp;outbound&nbsp;HTTP&nbsp;quests&nbsp;from&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;our&nbsp;network&nbsp;and&nbsp;have&nbsp;observed&nbsp;a&nbsp;significant&nbsp;memory&nbsp;leak&nbsp;with&nbsp;5.x&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;versions.&nbsp;While&nbsp;there&nbsp;are&nbsp;several&nbsp;discussions&nbsp;about&nbsp;memory&nbsp;leaks&nbsp;with&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;recent&nbsp;versions,&nbsp;just&nbsp;wanted&nbsp;to&nbsp;list&nbsp;out&nbsp;what&nbsp;we&nbsp;have&nbsp;observed&nbsp;in&nbsp;case&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &gt;&nbsp;this&nbsp;is&nbsp;an&nbsp;unknown&nbsp;leak.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; I&nbsp;recommend&nbsp;sharing&nbsp;a&nbsp;log&nbsp;with&nbsp;48+&nbsp;hourly&nbsp;mgr:mem&nbsp;snapshots.&nbsp;These&lt;br&gt;<br>
&gt; &nbsp; &nbsp; snapshots&nbsp;help&nbsp;compare&nbsp;your&nbsp;leak&nbsp;with&nbsp;others&nbsp;we&nbsp;know&nbsp;about&nbsp;and&nbsp;may&nbsp;help&lt;br&gt;<br>
&gt; &nbsp; &nbsp; isolate&nbsp;some&nbsp;of&nbsp;the&nbsp;memory&nbsp;leaks:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;https://bugs.squid-cache.org/show_bug.cgi?id=5132#c8&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugs.squid-cache.org/show_bug.cgi?id=5132#c8&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;will&nbsp;continue&nbsp;collecting&nbsp;these&nbsp;stats&nbsp;hourly.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;will&nbsp;analyze&nbsp;those&nbsp;logs&nbsp;once&nbsp;you&nbsp;share&nbsp;them.&nbsp;Comparing&nbsp;two&nbsp;snapshots&lt;br&gt;<br>
from&nbsp;different&nbsp;Squid&nbsp;versions/instances&nbsp;may&nbsp;be&nbsp;useful,&nbsp;but&nbsp;it&nbsp;is&nbsp;much&lt;br&gt;<br>
more&nbsp;time&nbsp;consuming,&nbsp;and&nbsp;I&nbsp;cannot&nbsp;offer&nbsp;to&nbsp;do&nbsp;that&nbsp;right&nbsp;now.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;output&nbsp;appears&nbsp;to&nbsp;be&nbsp;quite&nbsp;large&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;...&nbsp;where&nbsp;do&nbsp;I&nbsp;send&nbsp;the&nbsp;files&nbsp;with&nbsp;the&nbsp;memory&nbsp;logs?&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;scripts&nbsp;that&nbsp;track&nbsp;memory&nbsp;usage&nbsp;changes&nbsp;across&nbsp;hourly&nbsp;snapshots&nbsp;do&lt;br&gt;<br>
not&nbsp;care&nbsp;about&nbsp;the&nbsp;log&nbsp;size.&nbsp;However,&nbsp;you&nbsp;may&nbsp;want&nbsp;to&nbsp;share&nbsp;a&nbsp;link&nbsp;to&lt;br&gt;<br>
the&nbsp;(compressed)&nbsp;log&nbsp;rather&nbsp;than&nbsp;sharing&nbsp;the&nbsp;log&nbsp;itself.&nbsp;The&nbsp;best&nbsp;place&lt;br&gt;<br>
to&nbsp;share&nbsp;that&nbsp;info,&nbsp;IMO,&nbsp;is&nbsp;the&nbsp;bug&nbsp;report&nbsp;I&nbsp;referenced&nbsp;above,&nbsp;but&nbsp;you&lt;br&gt;<br>
can&nbsp;post&nbsp;here,&nbsp;of&nbsp;course.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;might&nbsp;have&nbsp;to&nbsp;fix&nbsp;how&nbsp;it&nbsp;is&nbsp;launched&nbsp;from&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;docker&nbsp;entrypoint&nbsp;script&nbsp;in&nbsp;my&nbsp;test&nbsp;env.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
FWIW,&nbsp;here&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;valgrind&nbsp;commands&nbsp;I&nbsp;use&nbsp;(with&nbsp;paths&nbsp;stripped):&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;valgrind&nbsp;-v&nbsp;--trace-children=no&nbsp;--child-silent-after-fork=yes&nbsp;--num-callers=50&nbsp;--log-file=valgrind-%p.log&nbsp;--time-stamp=yes&nbsp;--leak-check=full&nbsp;--leak-resolution=high&nbsp;--show-reachable=no&nbsp;--track-origins=no&nbsp;--gen-suppressions=all&nbsp;--suppressions=valgrind.supp&nbsp;squid&nbsp;-f&nbsp;squid.conf&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
Valgrind&nbsp;reports&nbsp;useful&nbsp;leak&nbsp;info&nbsp;after&nbsp;Squid&nbsp;exits.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;do&nbsp;not&nbsp;have&nbsp;updated/polished&nbsp;Valgrind&nbsp;suppressions,&nbsp;but&nbsp;I&nbsp;can&nbsp;share&lt;br&gt;<br>
what&nbsp;I&nbsp;use:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://gist.github.com/rousskov/a1f503981b4a3832ab44221b0b615b5a&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://gist.github.com/rousskov/a1f503981b4a3832ab44221b0b615b5a&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;do&nbsp;not&nbsp;use&nbsp;gdb/valgrind&nbsp;monitor&nbsp;so&nbsp;I&nbsp;cannot&nbsp;help&nbsp;you&nbsp;there.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
