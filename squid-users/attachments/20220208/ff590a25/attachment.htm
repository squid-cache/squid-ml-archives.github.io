<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;You&nbsp;have&nbsp;at&nbsp;least&nbsp;two&nbsp;basic&nbsp;options:&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;A.&nbsp;Enhance&nbsp;Squid&nbsp;to&nbsp;let&nbsp;SMP&nbsp;workers&nbsp;share&nbsp;helpers.&nbsp;I&nbsp;assume&nbsp;that&nbsp;you&lt;br&gt;have&nbsp;C&nbsp;SMP&nbsp;workers&nbsp;and&nbsp;N&nbsp;helpers&nbsp;per&nbsp;worker,&nbsp;with&nbsp;C&nbsp;and&nbsp;N&nbsp;significantly&lt;br&gt;greater&nbsp;than&nbsp;1.&nbsp;Instead&nbsp;of&nbsp;having&nbsp;N&nbsp;helpers&nbsp;per&nbsp;worker&nbsp;and&nbsp;C*N&nbsp;helpers&lt;br&gt;total,&nbsp;you&nbsp;will&nbsp;have&nbsp;just&nbsp;one&nbsp;concurrent&nbsp;helper&nbsp;per&nbsp;worker&nbsp;and&nbsp;C&nbsp;helpers&lt;br&gt;total.&nbsp;This&nbsp;will&nbsp;be&nbsp;a&nbsp;significant,&nbsp;generally&nbsp;useful&nbsp;improvement&nbsp;that&lt;br&gt;should&nbsp;be&nbsp;officially&nbsp;accepted&nbsp;if&nbsp;implemented&nbsp;well.&nbsp;This&nbsp;enhancement&lt;br&gt;requires&nbsp;serious&nbsp;Squid&nbsp;code&nbsp;modifications&nbsp;in&nbsp;a&nbsp;neglected&nbsp;error-prone&lt;br&gt;area,&nbsp;but&nbsp;it&nbsp;is&nbsp;certainly&nbsp;doable&nbsp;--&nbsp;Squid&nbsp;already&nbsp;shares&nbsp;rock&nbsp;diskers&lt;br&gt;across&nbsp;workers,&nbsp;for&nbsp;example.&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;B.&nbsp;Convert&nbsp;your&nbsp;helper&nbsp;from&nbsp;a&nbsp;database&nbsp;client&nbsp;program&nbsp;to&nbsp;an&nbsp;Aggregator&lt;br&gt;client&nbsp;program&nbsp;(and&nbsp;write&nbsp;the&nbsp;Aggregator).&nbsp;Depending&nbsp;on&nbsp;your&nbsp;needs&nbsp;and&lt;br&gt;skill,&nbsp;you&nbsp;can&nbsp;use&nbsp;TCP&nbsp;or&nbsp;Unix&nbsp;Domain&nbsp;Sockets&nbsp;(UDS)&nbsp;for&lt;br&gt;helper-Aggregator&nbsp;communication.&nbsp;The&nbsp;Aggregator&nbsp;may&nbsp;look&nbsp;very&nbsp;similar&nbsp;to&lt;br&gt;the&nbsp;current&nbsp;helper,&nbsp;except&nbsp;it&nbsp;will&nbsp;not&nbsp;use&nbsp;stdin/stdout&nbsp;for&lt;br&gt;receiving/sending&nbsp;helper&nbsp;queries/responses.&nbsp;This&nbsp;option&nbsp;also&nbsp;requires&lt;br&gt;development,&nbsp;but&nbsp;it&nbsp;is&nbsp;much&nbsp;simpler&nbsp;than&nbsp;option&nbsp;A.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you,&nbsp;Alex,&nbsp;I&nbsp;will&nbsp;keep&nbsp;these&nbsp;in&nbsp;mind.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;thought&nbsp;about&nbsp;the&nbsp;following&nbsp;approach:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;Have&nbsp;only&nbsp;one&nbsp;python&nbsp;helper,&nbsp;this&nbsp;helper&nbsp;fetches&nbsp;the&nbsp;data&nbsp;every&nbsp;minute&nbsp;from&nbsp;the&nbsp;main&nbsp;DB.&lt;/div&gt;&lt;div&gt;2.&nbsp;This&nbsp;helper&nbsp;has&nbsp;concurrency set&nbsp;for&nbsp;it.&lt;/div&gt;&lt;div&gt;3.&nbsp;The&nbsp;helper&nbsp;then&nbsp;spawns&nbsp;child&nbsp;processes using&nbsp;multithreading,&nbsp;each&nbsp;process responds&nbsp;to&nbsp;std/stdout&nbsp;and&nbsp;reads&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;main&nbsp;process&nbsp;which&nbsp;spawned&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;do&nbsp;you&nbsp;think&nbsp;about&nbsp;taking&nbsp;this&nbsp;route?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;will&nbsp;require&nbsp;no&nbsp;extra&nbsp;DBs&nbsp;and&nbsp;no&nbsp;tweaks&nbsp;to&nbsp;Squid,&nbsp;but&nbsp;maybe&nbsp;I&nbsp;am&nbsp;missing&nbsp;something,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best&nbsp;regards,&lt;/div&gt;&lt;div&gt;Roee&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Tue,&nbsp;Feb&nbsp;8,&nbsp;2022&nbsp;at&nbsp;5:12&nbsp;PM&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;2/8/22&nbsp;09:50,&nbsp;roee&nbsp;klinger&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Alex:&nbsp;If&nbsp;there&nbsp;are&nbsp;a&nbsp;lot&nbsp;more&nbsp;requests&nbsp;than&nbsp;your&nbsp;users/TTLs&nbsp;should&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; generate,&nbsp;then&nbsp;you&nbsp;may&nbsp;be&nbsp;able&nbsp;to&nbsp;decrease&nbsp;db&nbsp;load&nbsp;by&nbsp;figuring&nbsp;out&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; where&nbsp;the&nbsp;extra&nbsp;requests&nbsp;are&nbsp;coming&nbsp;from.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;actually,&nbsp;I&nbsp;don&#39;t&nbsp;think&nbsp;it&nbsp;matters&nbsp;much&nbsp;now&nbsp;that&nbsp;I&nbsp;think&nbsp;about&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;again,&nbsp;since&nbsp;as&nbsp;per&nbsp;my&nbsp;requirements,&nbsp;I&nbsp;need&nbsp;to&nbsp;reload&nbsp;the&nbsp;cache&nbsp;every&lt;br&gt;<br>
&gt;&nbsp;60&nbsp;seconds,&nbsp;which&nbsp;means&nbsp;that&nbsp;even&nbsp;if&nbsp;it&nbsp;is&nbsp;perfect,&nbsp;MariaDB&nbsp;will&lt;br&gt;<br>
&gt;&nbsp;still&nbsp;get&nbsp;a&nbsp;high&nbsp;load.&nbsp;I&nbsp;think&nbsp;the&nbsp;second&nbsp;approach&nbsp;will&nbsp;be&nbsp;better&lt;br&gt;<br>
&gt;&nbsp;suited.&lt;br&gt;<br>
&lt;br&gt;<br>
Your&nbsp;call.&nbsp;Wiping&nbsp;out&nbsp;the&nbsp;entire&nbsp;authentication&nbsp;cache&nbsp;every&nbsp;60&nbsp;seconds&nbsp;&lt;br&gt;<br>
feels&nbsp;odd,&nbsp;but&nbsp;I&nbsp;do&nbsp;not&nbsp;know&nbsp;enough&nbsp;about&nbsp;your&nbsp;environment&nbsp;to&nbsp;judge.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Alex:&nbsp;aggregating&nbsp;helper-db&nbsp;connections&nbsp;(helpers&nbsp;can&nbsp;be&nbsp;written&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; talk&nbsp;through&nbsp;a&nbsp;central&nbsp;connection&nbsp;aggregator)&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;That&nbsp;sounds&nbsp;like&nbsp;exactly&nbsp;what&nbsp;I&nbsp;am&nbsp;looking&nbsp;for,&nbsp;how&nbsp;would&nbsp;one&nbsp;go&nbsp;about&nbsp;&lt;br&gt;<br>
&gt;&nbsp;doing&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;have&nbsp;at&nbsp;least&nbsp;two&nbsp;basic&nbsp;options:&lt;br&gt;<br>
&lt;br&gt;<br>
A.&nbsp;Enhance&nbsp;Squid&nbsp;to&nbsp;let&nbsp;SMP&nbsp;workers&nbsp;share&nbsp;helpers.&nbsp;I&nbsp;assume&nbsp;that&nbsp;you&nbsp;&lt;br&gt;<br>
have&nbsp;C&nbsp;SMP&nbsp;workers&nbsp;and&nbsp;N&nbsp;helpers&nbsp;per&nbsp;worker,&nbsp;with&nbsp;C&nbsp;and&nbsp;N&nbsp;significantly&nbsp;&lt;br&gt;<br>
greater&nbsp;than&nbsp;1.&nbsp;Instead&nbsp;of&nbsp;having&nbsp;N&nbsp;helpers&nbsp;per&nbsp;worker&nbsp;and&nbsp;C*N&nbsp;helpers&nbsp;&lt;br&gt;<br>
total,&nbsp;you&nbsp;will&nbsp;have&nbsp;just&nbsp;one&nbsp;concurrent&nbsp;helper&nbsp;per&nbsp;worker&nbsp;and&nbsp;C&nbsp;helpers&nbsp;&lt;br&gt;<br>
total.&nbsp;This&nbsp;will&nbsp;be&nbsp;a&nbsp;significant,&nbsp;generally&nbsp;useful&nbsp;improvement&nbsp;that&nbsp;&lt;br&gt;<br>
should&nbsp;be&nbsp;officially&nbsp;accepted&nbsp;if&nbsp;implemented&nbsp;well.&nbsp;This&nbsp;enhancement&nbsp;&lt;br&gt;<br>
requires&nbsp;serious&nbsp;Squid&nbsp;code&nbsp;modifications&nbsp;in&nbsp;a&nbsp;neglected&nbsp;error-prone&nbsp;&lt;br&gt;<br>
area,&nbsp;but&nbsp;it&nbsp;is&nbsp;certainly&nbsp;doable&nbsp;--&nbsp;Squid&nbsp;already&nbsp;shares&nbsp;rock&nbsp;diskers&nbsp;&lt;br&gt;<br>
across&nbsp;workers,&nbsp;for&nbsp;example.&lt;br&gt;<br>
&lt;br&gt;<br>
B.&nbsp;Convert&nbsp;your&nbsp;helper&nbsp;from&nbsp;a&nbsp;database&nbsp;client&nbsp;program&nbsp;to&nbsp;an&nbsp;Aggregator&nbsp;&lt;br&gt;<br>
client&nbsp;program&nbsp;(and&nbsp;write&nbsp;the&nbsp;Aggregator).&nbsp;Depending&nbsp;on&nbsp;your&nbsp;needs&nbsp;and&nbsp;&lt;br&gt;<br>
skill,&nbsp;you&nbsp;can&nbsp;use&nbsp;TCP&nbsp;or&nbsp;Unix&nbsp;Domain&nbsp;Sockets&nbsp;(UDS)&nbsp;for&nbsp;&lt;br&gt;<br>
helper-Aggregator&nbsp;communication.&nbsp;The&nbsp;Aggregator&nbsp;may&nbsp;look&nbsp;very&nbsp;similar&nbsp;to&nbsp;&lt;br&gt;<br>
the&nbsp;current&nbsp;helper,&nbsp;except&nbsp;it&nbsp;will&nbsp;not&nbsp;use&nbsp;stdin/stdout&nbsp;for&nbsp;&lt;br&gt;<br>
receiving/sending&nbsp;helper&nbsp;queries/responses.&nbsp;This&nbsp;option&nbsp;also&nbsp;requires&nbsp;&lt;br&gt;<br>
development,&nbsp;but&nbsp;it&nbsp;is&nbsp;much&nbsp;simpler&nbsp;than&nbsp;option&nbsp;A.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Tue,&nbsp;Feb&nbsp;8,&nbsp;2022&nbsp;at&nbsp;4:41&nbsp;PM&nbsp;Alex&nbsp;Rousskov&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; On&nbsp;2/8/22&nbsp;09:13,&nbsp;roee&nbsp;klinger&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;I&nbsp;am&nbsp;running&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;Squid&nbsp;in&nbsp;a&nbsp;K8S&nbsp;environment,&nbsp;each&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Squid&nbsp;instance&nbsp;has&nbsp;a&nbsp;helper that&nbsp;authenticates&nbsp;users&nbsp;based&nbsp;on&nbsp;their&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;username&nbsp;and&nbsp;password,&nbsp;the&nbsp;scripts&nbsp;are&nbsp;written&nbsp;in&nbsp;Python.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;I&nbsp;have&nbsp;been&nbsp;facing&nbsp;an&nbsp;issue,&nbsp;that&nbsp;when&nbsp;under&nbsp;load,&nbsp;the&nbsp;helpers&nbsp;(even&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;with&nbsp;3600&nbsp;sec&nbsp;TTL)&nbsp;swamp&nbsp;the&nbsp;MariaDB&nbsp;instance,&nbsp;causing it&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; reach&nbsp;100%&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;CPU,&nbsp;basically I&nbsp;believe&nbsp;because&nbsp;each&nbsp;helper&nbsp;opens&nbsp;up&nbsp;its&nbsp;own&lt;br&gt;<br>
&gt; &nbsp; &nbsp; connection&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;to&nbsp;MariaDB,&nbsp;which&nbsp;ends&nbsp;up&nbsp;as&nbsp;a&nbsp;lot&nbsp;of&nbsp;connections.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;My&nbsp;initial&nbsp;idea&nbsp;was&nbsp;to&nbsp;create&nbsp;a&nbsp;Redis&nbsp;DB&nbsp;next&nbsp;to&nbsp;each&nbsp;Squid&lt;br&gt;<br>
&gt; &nbsp; &nbsp; instance&nbsp;and&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;connect&nbsp;each&nbsp;Squid&nbsp;to&nbsp;its&nbsp;own&nbsp;dedicated&nbsp;Redis.&nbsp;I&nbsp;will&nbsp;sync&nbsp;Redis&lt;br&gt;<br>
&gt; &nbsp; &nbsp; with&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;MariaDB&nbsp;every&nbsp;minute,&nbsp;thus&nbsp;decreasing&nbsp;the&nbsp;connections&nbsp;count&nbsp;from&lt;br&gt;<br>
&gt; &nbsp; &nbsp; a&nbsp;few&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;100s&nbsp;to&nbsp;just&nbsp;1&nbsp;every&nbsp;minute.&nbsp;This&nbsp;will&nbsp;also&nbsp;improve&nbsp;speeds&nbsp;since&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Redis&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;is&nbsp;much&nbsp;faster&nbsp;than&nbsp;MariaDB.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;The&nbsp;problem&nbsp;is,&nbsp;however,&nbsp;that&nbsp;there&nbsp;will&nbsp;still&nbsp;be&nbsp;many&lt;br&gt;<br>
&gt; &nbsp; &nbsp; connections&nbsp;from&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Squid&nbsp;to&nbsp;Redis,&nbsp;and&nbsp;I&nbsp;probably&nbsp;that&nbsp;will&nbsp;consume&nbsp;a&nbsp;lot&nbsp;of&nbsp;DB&lt;br&gt;<br>
&gt; &nbsp; &nbsp; resources&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;as&nbsp;well,&nbsp;which&nbsp;I&nbsp;don&#39;t&nbsp;actually&nbsp;know&nbsp;how&nbsp;to&nbsp;optimize,&nbsp;since&nbsp;it&nbsp;seems&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;that&nbsp;Squid&nbsp;opens&nbsp;many&nbsp;processes,&nbsp;and&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;get&nbsp;them&lt;br&gt;<br>
&gt; &nbsp; &nbsp; to&nbsp;talk&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;to&nbsp;each&nbsp;other&nbsp;(expect&nbsp;TTL&nbsp;values,&nbsp;which&nbsp;seems&nbsp;not&nbsp;to&nbsp;help&nbsp;in&nbsp;my&lt;br&gt;<br>
&gt; &nbsp; &nbsp; case,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;which&nbsp;I&nbsp;also&nbsp;don&#39;t&nbsp;understand&nbsp;why&nbsp;that&nbsp;is).&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;What&nbsp;is&nbsp;the&nbsp;best&nbsp;practice&nbsp;to&nbsp;handle&nbsp;this?&nbsp;considering&nbsp;I&nbsp;have&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;following&nbsp;requirements:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; 1.&nbsp;Fast&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; 2.&nbsp;Refresh&nbsp;data&nbsp;every&nbsp;minute&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; 3.&nbsp;Consume&nbsp;as&nbsp;least&nbsp;amount&nbsp;of&nbsp;DB&nbsp;resources&nbsp;as&nbsp;possible&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; I&nbsp;would&nbsp;start&nbsp;from&nbsp;the&nbsp;beginning:&nbsp;Does&nbsp;the&nbsp;aggregate&nbsp;number&nbsp;of&nbsp;database&lt;br&gt;<br>
&gt; &nbsp; &nbsp; requests&nbsp;match&nbsp;your&nbsp;expectations?&nbsp;In&nbsp;other&nbsp;words,&nbsp;do&nbsp;you&nbsp;see&nbsp;lots&nbsp;of&lt;br&gt;<br>
&gt; &nbsp; &nbsp; database&nbsp;requests&nbsp;that&nbsp;should&nbsp;not&nbsp;be&nbsp;there&nbsp;given&nbsp;your&nbsp;user&nbsp;access&lt;br&gt;<br>
&gt; &nbsp; &nbsp; patterns&nbsp;and&nbsp;authentication&nbsp;TTLs?&nbsp;In&nbsp;yet&nbsp;other&nbsp;words,&nbsp;are&nbsp;there&nbsp;many&lt;br&gt;<br>
&gt; &nbsp; &nbsp; repeated&nbsp;authentication&nbsp;accesses&nbsp;that&nbsp;should&nbsp;have&nbsp;been&nbsp;authentication&lt;br&gt;<br>
&gt; &nbsp; &nbsp; cache&nbsp;hits?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; If&nbsp;there&nbsp;are&nbsp;a&nbsp;lot&nbsp;more&nbsp;requests&nbsp;than&nbsp;your&nbsp;users/TTLs&nbsp;should&nbsp;generate,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; then&nbsp;you&nbsp;may&nbsp;be&nbsp;able&nbsp;to&nbsp;decrease&nbsp;db&nbsp;load&nbsp;by&nbsp;figuring&nbsp;out&nbsp;where&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; extra&lt;br&gt;<br>
&gt; &nbsp; &nbsp; requests&nbsp;are&nbsp;coming&nbsp;from.&nbsp;For&nbsp;example,&nbsp;it&nbsp;is&nbsp;possible&nbsp;that&nbsp;your&lt;br&gt;<br>
&gt; &nbsp; &nbsp; authentication&nbsp;cache&nbsp;key&nbsp;includes&nbsp;some&nbsp;noise&nbsp;that&nbsp;renders&nbsp;caching&lt;br&gt;<br>
&gt; &nbsp; &nbsp; ineffective&nbsp;(e.g.,&nbsp;see&nbsp;comments&nbsp;about&nbsp;key_extras&nbsp;in&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.conf.documented).&nbsp;Or&nbsp;maybe&nbsp;you&nbsp;need&nbsp;a&nbsp;bigger&nbsp;authentication&nbsp;cache.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; If&nbsp;the&nbsp;total&nbsp;stream&nbsp;of&nbsp;authentication&nbsp;requests&nbsp;during&nbsp;peak&nbsp;hours&nbsp;is&lt;br&gt;<br>
&gt; &nbsp; &nbsp; reasonable,&nbsp;with&nbsp;few&nbsp;unwarranted&nbsp;cache&nbsp;misses,&nbsp;then&nbsp;you&nbsp;can&nbsp;start&lt;br&gt;<br>
&gt; &nbsp; &nbsp; working&nbsp;on&nbsp;aggregating&nbsp;helper-db&nbsp;connections&nbsp;(helpers&nbsp;can&nbsp;be&nbsp;written&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; talk&nbsp;through&nbsp;a&nbsp;central&nbsp;connection&nbsp;aggregator)&nbsp;and/or&nbsp;adding&nbsp;database&lt;br&gt;<br>
&gt; &nbsp; &nbsp; power&nbsp;(e.g.,&nbsp;by&nbsp;introducing&nbsp;additional&nbsp;databases&nbsp;running&nbsp;on&nbsp;previously&lt;br&gt;<br>
&gt; &nbsp; &nbsp; unused&nbsp;hardware&nbsp;--&nbsp;just&nbsp;like&nbsp;your&nbsp;MariaDB&nbsp;idea).&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Cheers,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Alex.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
