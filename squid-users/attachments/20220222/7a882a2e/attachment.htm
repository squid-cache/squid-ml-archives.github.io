<tt>
&lt;div&nbsp;dir=&quot;rtl&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;By&nbsp;the&nbsp;help&nbsp;of&nbsp;God.&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;If&nbsp;I&#39;m&nbsp;using&nbsp;the&nbsp;self&nbsp;signed&nbsp;certificate&nbsp;that&nbsp;I&nbsp;created&nbsp;for&nbsp;the&nbsp;ssl&nbsp;bump,&nbsp;then&nbsp;the&nbsp;browser&nbsp;considers&nbsp;it&nbsp;as&nbsp;the&nbsp;same&nbsp;certificate&nbsp;for&nbsp;any&nbsp;domain&nbsp;I&#39;m&nbsp;connecting&nbsp;to?&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;rtl&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;‫בתאריך&nbsp;יום&nbsp;ג׳,&nbsp;22&nbsp;בפבר׳&nbsp;2022&nbsp;ב-7:35&nbsp;מאת&nbsp;‪Eliezer&nbsp;Croitoru‬‏&nbsp;&lt;‪&lt;a&nbsp;href=&quot;mailto:ngtech1ltd@gmail.com&quot;&gt;ngtech1ltd@gmail.com&lt;/a&gt;‬‏&gt;:‬&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Thanks&nbsp;Christos,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;was&nbsp;aware&nbsp;of&nbsp;such&nbsp;things&nbsp;but&nbsp;haven&#39;t&nbsp;seen&nbsp;such&nbsp;a&nbsp;case.&lt;br&gt;<br>
Is&nbsp;there&nbsp;any&nbsp;way&nbsp;to&nbsp;&quot;reproduce&quot;&nbsp;this?&lt;br&gt;<br>
I&nbsp;believe&nbsp;it&nbsp;should&nbsp;be&nbsp;documented&nbsp;in&nbsp;the&nbsp;wiki.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
&lt;br&gt;<br>
----&lt;br&gt;<br>
Eliezer&nbsp;Croitoru&lt;br&gt;<br>
NgTech,&nbsp;Tech&nbsp;Support&lt;br&gt;<br>
Mobile:&nbsp;+972-5-28704261&lt;br&gt;<br>
Email:&nbsp;&lt;a&nbsp;href=&quot;mailto:ngtech1ltd@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ngtech1ltd@gmail.com&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;squid-users&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users-bounces@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-bounces@lists.squid-cache.org&lt;/a&gt;&gt;&nbsp;On&nbsp;Behalf&nbsp;Of&nbsp;Christos&nbsp;Tsantilas&lt;br&gt;<br>
Sent:&nbsp;Monday,&nbsp;February&nbsp;21,&nbsp;2022&nbsp;11:41&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Splice&nbsp;certain&nbsp;SNIs&nbsp;which&nbsp;served&nbsp;by&nbsp;the&nbsp;same&nbsp;IP&lt;br&gt;<br>
&lt;br&gt;<br>
Hi&nbsp;Ben,&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;HTTP/2&nbsp;is&nbsp;used,&nbsp;requests&nbsp;for&nbsp;two&nbsp;different&nbsp;domains&nbsp;may&nbsp;served&nbsp;using&nbsp;&lt;br&gt;<br>
the&nbsp;same&nbsp;TLS&nbsp;connection&nbsp;if&nbsp;both&nbsp;domains&nbsp;are&nbsp;served&nbsp;from&nbsp;the&nbsp;same&nbsp;remote&nbsp;&lt;br&gt;<br>
server&nbsp;and&nbsp;use&nbsp;the&nbsp;same&nbsp;TLS&nbsp;certificate.&lt;br&gt;<br>
There&nbsp;is&nbsp;a&nbsp;description&nbsp;here:&lt;br&gt;<br>
 &nbsp; &nbsp;&lt;a&nbsp;href=&quot;https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing/&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;a&nbsp;similar&nbsp;problem&nbsp;report&nbsp;here:&lt;br&gt;<br>
 &nbsp; &nbsp;&lt;a&nbsp;href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1176673&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugs.chromium.org/p/chromium/issues/detail?id=1176673&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
 &nbsp; &nbsp;Christos&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;14/2/22&nbsp;3:49&nbsp;μ.μ.,&nbsp;Ben&nbsp;Goz&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;By&nbsp;the&nbsp;help&nbsp;of&nbsp;God.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&nbsp;Ny&nbsp;squid&nbsp;version&nbsp;is&nbsp;4.15,&nbsp;using&nbsp;it&nbsp;on&nbsp;tproxy&nbsp;configuration.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;using&nbsp;ssl&nbsp;bump&nbsp;to&nbsp;intercept&nbsp;https&nbsp;connection,&nbsp;but&nbsp;I&nbsp;want&nbsp;to&nbsp;splice&nbsp;&lt;br&gt;<br>
&gt;&nbsp;several&nbsp;domains.&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;problem&nbsp;that&nbsp;when&nbsp;I&#39;m&nbsp;splicing&nbsp;some&nbsp;google&nbsp;domains&nbsp;eg.&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://youtube.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;youtube.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://youtube.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://youtube.com&lt;/a&gt;&gt;&nbsp;then&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;gmail.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://gmail.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://gmail.com&lt;/a&gt;&gt;&nbsp;domain&nbsp;also&nbsp;spliced.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;know&nbsp;that&nbsp;it&nbsp;is&nbsp;very&nbsp;common&nbsp;for&nbsp;google&nbsp;servers&nbsp;to&nbsp;host&nbsp;multiple&nbsp;&lt;br&gt;<br>
&gt;&nbsp;domains&nbsp;on&nbsp;single&nbsp;server.&lt;br&gt;<br>
&gt;&nbsp;And&nbsp;I&nbsp;suspect&nbsp;that&nbsp;when&nbsp;I&#39;m&nbsp;splicing&nbsp;for&nbsp;example&nbsp;&lt;a&nbsp;href=&quot;http://youtube.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;youtube.com&lt;/a&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://youtube.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://youtube.com&lt;/a&gt;&gt;&nbsp;it&#39;ll&nbsp;also&nbsp;splices&nbsp;&lt;a&nbsp;href=&quot;http://google.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;google.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;http://google.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://google.com&lt;/a&gt;&gt;.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; Here&nbsp;are&nbsp;my&nbsp;squid&nbsp;configurations&nbsp;for&nbsp;the&nbsp;ssl&nbsp;bump:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;https_port&nbsp;xxxx&nbsp;ssl-bump&nbsp;tproxy&nbsp;generate-host-certificates=on&nbsp;&lt;br&gt;<br>
&gt;&nbsp;options=ALL&nbsp;dynamic_cert_mem_cache_size=4MB&nbsp;&lt;br&gt;<br>
&gt;&nbsp;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;&lt;br&gt;<br>
&gt;&nbsp;dhparams=/usr/local/squid/etc/dhparam.pem&nbsp;sslflags=NO_DEFAULT_CA&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;DiscoverSNIHost&nbsp;at_step&nbsp;SslBump1&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;NoSSLIntercept&nbsp;ssl::server_name &nbsp;&quot;/usr/local/squid/etc/url-no-bump&quot;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;NoSSLInterceptRegexp&nbsp;ssl::server_name_regex&nbsp;-i&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&quot;/usr/local/squid/etc/url-no-bump-regexp&quot;&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;splice&nbsp;NoSSLInterceptRegexp_always&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;splice&nbsp;NoSSLInterceptRegexp&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;peek&nbsp;DiscoverSNIHost&lt;br&gt;<br>
&gt;&nbsp;ssl_bump&nbsp;bump&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
