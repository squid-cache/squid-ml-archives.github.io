<tt>
&lt;br&gt;&lt;div&gt;Hi&nbsp;all,&lt;/div&gt;&lt;br&gt;&lt;div&gt;I'm&nbsp;trying&nbsp;to&nbsp;use&nbsp;these&nbsp;two&nbsp;features&nbsp;at&nbsp;the&nbsp;same&nbsp;time.&nbsp;&nbsp;The&nbsp;use&nbsp;case&nbsp;is&nbsp;pretty&nbsp;simple.&nbsp;&nbsp;I&nbsp;want&nbsp;to&nbsp;capture&nbsp;all&nbsp;traffic&nbsp;from&nbsp;a&nbsp;single&nbsp;source&nbsp;(a&nbsp;device&nbsp;of&nbsp;mine)&nbsp;to&nbsp;another&nbsp;squid&nbsp;proxy&nbsp;server&nbsp;and&nbsp;decrypt/log&nbsp;it.&nbsp;&nbsp;&nbsp;&nbsp;I'm&nbsp;using&nbsp;the&nbsp;Ubuntu&nbsp;20&nbsp;package&nbsp;of&nbsp;squid-ssl&nbsp;version&nbsp;4.13.&lt;/div&gt;&lt;br&gt;&lt;div&gt;Device&nbsp;-&gt;&nbsp;ssl_bump&nbsp;proxy&nbsp;-&gt;&nbsp;upstream&nbsp;proxy&nbsp;-&gt;&nbsp;website&lt;/div&gt;&lt;br&gt;&lt;div&gt;It&nbsp;was&nbsp;all&nbsp;successfully&nbsp;working&nbsp;without&nbsp;ssl_bump,&nbsp;so&nbsp;the&nbsp;cache_peer&nbsp;configuration&nbsp;works.&nbsp;&nbsp;One&nbsp;side&nbsp;note:&nbsp;the&nbsp;parent&nbsp;proxy&nbsp;is&nbsp;running&nbsp;on&nbsp;443&nbsp;without&nbsp;SSL&nbsp;(I&nbsp;believe&nbsp;-&nbsp;I&nbsp;don't&nbsp;run&nbsp;it&nbsp;but&nbsp;I've&nbsp;asked&nbsp;those&nbsp;that&nbsp;do&nbsp;for&nbsp;confirmation,&nbsp;but&nbsp;I&nbsp;do&nbsp;know&nbsp;it's&nbsp;a&nbsp;pretty&nbsp;standard&nbsp;destination&nbsp;proxy&nbsp;configuration).&nbsp;&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;The&nbsp;website&nbsp;itself&nbsp;is&nbsp;not&nbsp;directly&nbsp;accessible&nbsp;thus&nbsp;the&nbsp;upstream&nbsp;proxy&nbsp;is&nbsp;required.&lt;/div&gt;&lt;br&gt;&lt;div&gt;Adding&nbsp;the&nbsp;ssl_bump&nbsp;configuration&nbsp;caused&nbsp;it&nbsp;to&nbsp;not&nbsp;work,&nbsp;with&nbsp;errors&nbsp;about&nbsp;SSL&nbsp;versions&nbsp;and&nbsp;&quot;Error&nbsp;negotiating&nbsp;SSL&nbsp;connection&nbsp;on&nbsp;FD&nbsp;xx&quot;.&nbsp;&nbsp;My&nbsp;best&nbsp;guess&nbsp;is&nbsp;that&nbsp;it&nbsp;is&nbsp;attempting&nbsp;to&nbsp;establish&nbsp;an&nbsp;SSL&nbsp;connection&nbsp;to&nbsp;the&nbsp;upstream&nbsp;and&nbsp;failing.&nbsp;&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;acl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;/div&gt;&lt;div&gt;ssl_bump&nbsp;bump&nbsp;all&lt;/div&gt;&lt;div&gt;http_&lt;span&nbsp;data-emoji-typing=&quot;true&quot;&gt;port&lt;/span&gt;&nbsp;3128&nbsp;ssl-bump&nbsp;cert=/var/lib/squid/ssl_cert/myCA.pem&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&lt;/div&gt;&lt;div&gt;tls_outgoing_options&nbsp;options=NO_SSLv3&nbsp;flags=DON'T_VERIFY_PEER,DONT_VERIFY_DOMAIN&nbsp;cert=/var/lib/squid/ssl_cert/device.pem&nbsp;key=/var/lib/squid/ssl_cert/client.key&lt;/div&gt;&lt;br&gt;&lt;div&gt;(client.key&nbsp;and&nbsp;client.pem&nbsp;are&nbsp;from&nbsp;the&nbsp;device&nbsp;and&nbsp;are&nbsp;needed&nbsp;due&nbsp;to&nbsp;the&nbsp;authentication&nbsp;of&nbsp;the&nbsp;session&nbsp;at&nbsp;the&nbsp;destination&nbsp;server.&nbsp;&nbsp;Also,&nbsp;I&nbsp;haven't&nbsp;looked&nbsp;at&nbsp;the&nbsp;packet&nbsp;logging&nbsp;yet.&nbsp;I&nbsp;assume&nbsp;that&nbsp;will&nbsp;be&nbsp;an&nbsp;easy&nbsp;addition&nbsp;once&nbsp;the&nbsp;setup&nbsp;works&nbsp;generally.)&lt;/div&gt;&lt;br&gt;&lt;div&gt;However,&nbsp;my&nbsp;understanding&nbsp;is&nbsp;that&nbsp;the&nbsp;cache_peer&nbsp;configuration&nbsp;should&nbsp;NOT&nbsp;do&nbsp;TLS&nbsp;by&nbsp;default&nbsp;unless&nbsp;that&nbsp;was&nbsp;specified&nbsp;in&nbsp;the&nbsp;options,&nbsp;and&nbsp;I&nbsp;see&nbsp;no&nbsp;way&nbsp;to&nbsp;explicitly&nbsp;disable&nbsp;it.&nbsp;&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;So&nbsp;first&nbsp;question:&nbsp;is&nbsp;that&nbsp;assumption&nbsp;accurate?&nbsp;&nbsp;No&nbsp;TLS&nbsp;to&nbsp;the&nbsp;parent&nbsp;unless&nbsp;explicitly&nbsp;configured?&lt;/div&gt;&lt;div&gt;And&nbsp;if&nbsp;the&nbsp;ssl_bump&nbsp;configuration&nbsp;is&nbsp;causing&nbsp;it&nbsp;to&nbsp;attempt&nbsp;an&nbsp;upstream&nbsp;TLS&nbsp;connection,&nbsp;how&nbsp;can&nbsp;I&nbsp;force&nbsp;it&nbsp;off?&lt;/div&gt;&lt;div&gt;Anything&nbsp;here&nbsp;that&nbsp;I'm&nbsp;doing&nbsp;obviously&nbsp;wrong?&lt;/div&gt;&lt;br&gt;&lt;div&gt;I&nbsp;appreciate&nbsp;any&nbsp;and&nbsp;all&nbsp;suggestions.&nbsp;&nbsp;Thanks!&lt;/div&gt;&lt;br&gt;&lt;img&nbsp;class=&quot;mailspring-open&quot;&nbsp;alt=&quot;Sent&nbsp;from&nbsp;Mailspring&quot;&nbsp;width=&quot;0&quot;&nbsp;height=&quot;0&quot;&nbsp;style=&quot;border:0;&nbsp;width:0;&nbsp;height:0;&quot;&nbsp;src=&quot;https://link.getmailspring.com/open/CAE02DFF-21A4-4F38-955D-BAB1642F6301@getmailspring.com?me=3a79f6de&amp;recipient=c3F1aWQtdXNlcnNAbGlzdHMuc3F1aWQtY2FjaGUub3Jn&quot;&gt;
</tt>
