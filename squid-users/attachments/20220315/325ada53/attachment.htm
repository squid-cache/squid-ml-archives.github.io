<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;squid-users,&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;wonder if&nbsp;there&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;workable&nbsp;acls&nbsp;at&nbsp;present that&nbsp;can&nbsp;detect&nbsp;and/or&nbsp;block&nbsp;domain&nbsp;fronting.&nbsp;By&nbsp;way&nbsp;of&nbsp;my&nbsp;understanding,&nbsp;that&nbsp;would&nbsp;be&nbsp;comparing&nbsp;the&nbsp;TLS&nbsp;SNI&nbsp;during&nbsp;a&nbsp;client&nbsp;connecting&nbsp;to&nbsp;squid&nbsp;and&nbsp;issuing&nbsp;a&nbsp;CONNECT&nbsp;method.&nbsp;Squid&nbsp;would&nbsp;bump&nbsp;that&nbsp;TLS&nbsp;request&nbsp;to&nbsp;also&nbsp;examine&nbsp;each&nbsp;and&nbsp;every&nbsp;Host&nbsp;header&nbsp;and&nbsp;compare&nbsp;it&nbsp;to&nbsp;the&nbsp;TLS&nbsp;SNI&nbsp;to&nbsp;see&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;discrepancy.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Looking at&nbsp;the&nbsp;code&nbsp;at&nbsp;the&nbsp;moment&nbsp;I&nbsp;can&nbsp;only&nbsp;see&nbsp;absolute URL&nbsp;vs&nbsp;host&nbsp;header&nbsp;checks,&nbsp;which&nbsp;do&nbsp;not&nbsp;appear&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;CONNECT&nbsp;TLS&nbsp;SNI,&nbsp;which&nbsp;I&nbsp;think&nbsp;to&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;master&nbsp;xaction.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jason.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
