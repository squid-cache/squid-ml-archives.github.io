<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#464646&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Hi&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;We&nbsp;trying&nbsp;to&nbsp;using&nbsp;WCCP&nbsp;with&nbsp;Fortigate&nbsp;without&nbsp;success&nbsp;Squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version &nbsp;5.5&nbsp;always&nbsp;claim&nbsp;&quot;Ignoring&nbsp;WCCPv2&nbsp;message:&nbsp;truncated<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;record&quot;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;What&nbsp;can&nbsp;be&nbsp;the&nbsp;cause&nbsp;?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;We&nbsp;have&nbsp;added&nbsp;a&nbsp;service&nbsp;ID&nbsp;80&nbsp;on&nbsp;fortigate&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;config&nbsp;system&nbsp;wccp&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;edit&nbsp;&quot;80&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;router-id&nbsp;10.10.50.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;group-address&nbsp;0.0.0.0&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;server-list&nbsp;10.10.50.2&nbsp;255.255.255.255&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;server-type&nbsp;forward&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;authentication&nbsp;disable&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;forward-method&nbsp;GRE&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;return-method&nbsp;GRE&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;set&nbsp;assignment-method&nbsp;HASH&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;next&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Squid&nbsp;wccp&nbsp;configuration&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;wccp2_router&nbsp;10.10.50.1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp_version&nbsp;3&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;tested&nbsp;v4&nbsp;do&nbsp;the&nbsp;same&nbsp;behavior&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_rebuild_wait&nbsp;on&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_forwarding_method&nbsp;gre&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_return_method&nbsp;gre&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_assignment_method&nbsp;hash&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_service&nbsp;dynamic&nbsp;80&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_service_info&nbsp;80&nbsp;protocol=tcp&nbsp;protocol=tcp&nbsp;flags=src_ip_hash<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priority=240&nbsp;ports=80,443&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_address&nbsp;0.0.0.0&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2_weight&nbsp;10000&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Squid&nbsp;claim&nbsp;in&nbsp;debug&nbsp;log&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;022/06/21&nbsp;13:15:38.780&nbsp;kid4|&nbsp;80,6|&nbsp;wccp2.cc(1206)&nbsp;wccp2HandleUdp:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wccp2HandleUdp:&nbsp;Called.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2022/06/21&nbsp;13:15:38.781&nbsp;kid4|&nbsp;5,5|&nbsp;ModEpoll.cc(118)&nbsp;SetSelect:&nbsp;FD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38,&nbsp;type=1,&nbsp;handler=1,&nbsp;client_data=0,&nbsp;timeout=0&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2022/06/21&nbsp;13:15:38.781&nbsp;kid4|&nbsp;80,3|&nbsp;wccp2.cc(1230)&nbsp;wccp2HandleUdp:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Incoming&nbsp;WCCPv2&nbsp;I_SEE_YOU&nbsp;length&nbsp;112.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2022/06/21&nbsp;13:15:38.781&nbsp;kid4|&nbsp;ERROR:&nbsp;Ignoring&nbsp;WCCPv2&nbsp;message:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncated&nbsp;record&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;exception&nbsp;location:&nbsp;wccp2.cc(1133)&nbsp;CheckSectionLength&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-signature&quot;&gt;--&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;background-color:&nbsp;#ffffff;border:&nbsp;1px&nbsp;solid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#e7eaec;padding:&nbsp;1px;margin-bottom:&nbsp;20px;box-sizing:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border-box;font-family:&nbsp;'open&nbsp;sans',&nbsp;'Helvetica&nbsp;Neue',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;font-size:&nbsp;13px;color:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#676a6c;width:270px&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;box-sizing:&nbsp;border-box;color:&nbsp;rgb(103,&nbsp;106,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;108);font-size:&nbsp;13px;line-height:&nbsp;18.5667px&quot;&gt; &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
