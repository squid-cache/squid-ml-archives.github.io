<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;ludovit,&lt;br&gt;&lt;br&gt;We&nbsp;experienced&nbsp;the&nbsp;similar&nbsp;problems&nbsp;of&nbsp;crashing&nbsp;squid&nbsp;with&nbsp;&quot;signal&nbsp;6&nbsp;and&nbsp;status&nbsp;0&quot;&nbsp;symptoms&nbsp;in&nbsp;the&nbsp;/var/log/messages.&nbsp;There&nbsp;were&nbsp;hundreds&nbsp;of&nbsp;crashes&nbsp;per&nbsp;hour&nbsp;during&nbsp;the&nbsp;working&nbsp;hours.&nbsp;There&nbsp;were&nbsp;also&nbsp;many&nbsp;crashes&nbsp;during&nbsp;night&nbsp;hours.&nbsp;And&nbsp;I&nbsp;had&nbsp;no&nbsp;idea&nbsp;what&nbsp;the&nbsp;cause&nbsp;of&nbsp;the&nbsp;problem&nbsp;was.&lt;br&gt;But&nbsp;your&nbsp;case&nbsp;shed&nbsp;light&nbsp;on&nbsp;the&nbsp;problem.&lt;br&gt;&lt;br&gt;I&nbsp;captured&nbsp;network&nbsp;traffic&nbsp;and&nbsp;saw&nbsp;in&nbsp;the&nbsp;dump&nbsp;many&nbsp;requests&nbsp;to&nbsp;IPv6&nbsp;addresses&nbsp;like&nbsp;this:&nbsp;POST&nbsp;http://[2001:67c:4e8:f004::a]:80/api&nbsp;HTTP/1.1\r\n&lt;br&gt;I&nbsp;think&nbsp;that&nbsp;the&nbsp;requests&nbsp;were&nbsp;generated&nbsp;by&nbsp;the&nbsp;Telegram&nbsp;application,&nbsp;because&nbsp;neighboring&nbsp;similar&nbsp;requests&nbsp;were&nbsp;addressed&nbsp;to&nbsp;Telegram&nbsp;IPv4&nbsp;pools:&nbsp;POST&nbsp;&lt;a&nbsp;href=&quot;http://91.105.192.100:80/api&quot;&gt;http://91.105.192.100:80/api&lt;/a&gt;&nbsp;HTTP/1.1\r\n&lt;br&gt;&lt;br&gt;To&nbsp;fix&nbsp;the&nbsp;problem&nbsp;somehow,&nbsp;I&nbsp;added&nbsp;the&nbsp;following&nbsp;rules&nbsp;to&nbsp;the&nbsp;very&nbsp;beginning&nbsp;of&nbsp;the&nbsp;SQUID&nbsp;configuration:&lt;br&gt; &nbsp;acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;urldst_ipv6&nbsp;url_regex&nbsp;^http://\[&lt;br&gt; &nbsp;http_access&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;urldst_ipv6&lt;br&gt; &nbsp;&lt;br&gt;Now&nbsp;it&nbsp;seems&nbsp;the&nbsp;problem&nbsp;has&nbsp;been&nbsp;solved.&lt;br&gt;&lt;br&gt;I&nbsp;was&nbsp;wondering&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;SQUID&nbsp;bug.&nbsp;In&nbsp;my&nbsp;opinion,&nbsp;SQUID&nbsp;should&nbsp;not&nbsp;crash&nbsp;on&nbsp;requests&nbsp;to&nbsp;IPv6&nbsp;resources,&nbsp;but&nbsp;should&nbsp;send&nbsp;a&nbsp;response&nbsp;with&nbsp;an&nbsp;error,&nbsp;for&nbsp;example,&nbsp;Bad&nbsp;gateway&nbsp;502,&nbsp;or&nbsp;Not&nbsp;Acceptable&nbsp;406.&lt;br&gt;&lt;br&gt;&lt;br&gt;Kind&nbsp;regards,&lt;br&gt; &nbsp; &nbsp;Ankor.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;ср,&nbsp;12&nbsp;окт.&nbsp;2022&nbsp;г.&nbsp;в&nbsp;15:30,&nbsp;Ludovit&nbsp;Koren&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ludovit.koren@gmail.com&quot;&gt;ludovit.koren@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&nbsp;writes:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;On&nbsp;12/10/22&nbsp;21:12,&nbsp;Ludovit&nbsp;Koren&nbsp;wrote:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;Hi,&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;I&nbsp;am&nbsp;running&nbsp;squid-5.7&nbsp;on&nbsp;FreeBSD&nbsp;12.3-STABLE&nbsp;r371879.&nbsp;Occasionally&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;I&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;get&nbsp;the&nbsp;following&nbsp;error:&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;#3 &nbsp;0x000000080111fcb1&nbsp;in&nbsp;__assert&nbsp;(func=&lt;optimized&nbsp;out&gt;,&nbsp;file=&lt;optimized&nbsp;out&gt;,&nbsp;line=&lt;optimized&nbsp;out&gt;,&nbsp;failedexpr=&lt;optimized&nbsp;out&gt;)&nbsp;at&nbsp;/usr/src/lib/libc/gen/assert.c:51&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;#4 &nbsp;0x0000000000698fcd&nbsp;in&nbsp;Ip::Address::getAddrInfo&nbsp;(this=0x861c04588,&nbsp;dst=&lt;optimized&nbsp;out&gt;,&nbsp;force=0)&nbsp;at&nbsp;Address.cc:663&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;#5 &nbsp;0x000000000068b732&nbsp;in&nbsp;comm_openex&nbsp;(sock_type=sock_type@entry=1,&nbsp;proto=proto@entry=6,&nbsp;addr=...,&nbsp;flags=1,&nbsp;note=0x85ce42dc0&nbsp;&quot;[fe80::21f:29ff:fe28:7017]&quot;)&nbsp;at&nbsp;comm.cc:347&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;The&nbsp;squid&nbsp;is&nbsp;compiled&nbsp;without&nbsp;IPv6&nbsp;option,&nbsp;so&nbsp;I&nbsp;do&nbsp;not&nbsp;understand&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;why&nbsp;it&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;tries&nbsp;to&nbsp;reach&nbsp;IPv6&nbsp;address.&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;A&nbsp;client&nbsp;is&nbsp;requiring&nbsp;connection&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;server.&nbsp;But&nbsp;Squid&nbsp;cannot&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;convert&nbsp;that&nbsp;IPv6&nbsp;address&nbsp;or&nbsp;use&nbsp;on&nbsp;an&nbsp;IPv4-only&nbsp;network.&nbsp;Lack&nbsp;of&nbsp;IPv6&nbsp;&lt;br&gt;<br>
 &nbsp; &nbsp;&gt;&nbsp;support&nbsp;also&nbsp;forbids&nbsp;IPv6&nbsp;failover&nbsp;handling&nbsp;being&nbsp;used.&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;the&nbsp;solution&nbsp;is&nbsp;to&nbsp;reenable&nbsp;IPv6&nbsp;in&nbsp;the&nbsp;squid,&nbsp;as&nbsp;well&nbsp;as&nbsp;in&nbsp;the&nbsp;OS&lt;br&gt;<br>
network&nbsp;stack?&nbsp;Am&nbsp;I&nbsp;right?&lt;br&gt;<br>
&lt;br&gt;<br>
Thank&nbsp;you.&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;br&gt;<br>
lk&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
