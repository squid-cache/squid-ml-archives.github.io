<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;hi&nbsp;all,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;atm&nbsp;i&nbsp;have&nbsp;written&nbsp;a&nbsp;script,&nbsp;once&nbsp;you&nbsp;have&nbsp;built&nbsp;a&nbsp;centos&nbsp;7&nbsp;VM,&nbsp;you&nbsp;just&nbsp;run&nbsp;the&nbsp;script&nbsp;and&nbsp;after&nbsp;the&nbsp;reboot&nbsp;its&nbsp;a&nbsp;complete&nbsp;running&nbsp;squidclamAV&nbsp;server&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;i&#39;m&nbsp;going&nbsp;to&nbsp;be&nbsp;moving&nbsp;the&nbsp;script&nbsp;to&nbsp;a&nbsp;ubuntu&nbsp;server&nbsp;as&nbsp;centos&nbsp;7&nbsp;is&nbsp;dead&nbsp;now&nbsp;(as&nbsp;i&nbsp;run&nbsp;clamAV&nbsp;on&nbsp;it,&nbsp;clamAV&nbsp;will&nbsp;stop&nbsp;getting&nbsp;virus&nbsp;definitions&nbsp;2024&nbsp;as&nbsp;i&nbsp;use&nbsp;this&nbsp;for&nbsp;virus&nbsp;scanning&nbsp;of&nbsp;internet&nbsp;packets)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;just&nbsp;want&nbsp;to&nbsp;know&nbsp;what&nbsp;lines&nbsp;i&nbsp;need&nbsp;to&nbsp;adjust&nbsp;to&nbsp;work&nbsp;with&nbsp;ubuntu&nbsp;instead&nbsp;of&nbsp;centos,&nbsp;obviously&nbsp;i&nbsp;know&nbsp;instead&nbsp;of&nbsp;yum&nbsp;install....&nbsp;its&nbsp;apt&nbsp;install&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;heres&nbsp;my&nbsp;long&nbsp;script&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#!/bin/bash&lt;br&gt;#&lt;br&gt;#this&nbsp;script&nbsp;will&nbsp;download/install&nbsp;and&nbsp;configure&nbsp;the&nbsp;following&nbsp;packages&lt;br&gt;#&lt;br&gt;#squid&nbsp;-&nbsp;proxy&nbsp;server&lt;br&gt;#squid&nbsp;ssl&nbsp;bump&nbsp;-&nbsp;intercept&nbsp;HTTPS&nbsp;traffic&lt;br&gt;#clamAV&nbsp;-&nbsp;antivirus&nbsp;engine&nbsp;inc&nbsp;trojans,viruses,malware&lt;br&gt;#c-icap&nbsp;-&nbsp;icap&nbsp;server&lt;br&gt;#squidclamav&nbsp;-&nbsp;that&nbsp;integrates&nbsp;all&nbsp;the&nbsp;above&nbsp;in&nbsp;squid&lt;br&gt;#whitelist&nbsp;URL&#39;s&lt;br&gt;#deny&nbsp;MIME&nbsp;types&lt;br&gt;#&lt;br&gt;#on&nbsp;the&nbsp;PROD&nbsp;host&nbsp;you&nbsp;only&nbsp;need&nbsp;squid&lt;br&gt;#&lt;br&gt;#first&nbsp;things&nbsp;first&nbsp;lets&nbsp;disable&nbsp;firewalld&nbsp;and&nbsp;SElinux&lt;br&gt;#&lt;br&gt;systemctl&nbsp;stop&nbsp;firewalld&lt;br&gt;systemctl&nbsp;disable&nbsp;firewalld&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s/SELINUX=enforcing/SELINUX=disabled/g&#39;&nbsp;/etc/selinux/config&lt;br&gt;#&lt;br&gt;#squid&nbsp;packages&lt;br&gt;#&lt;br&gt;yum&nbsp;install&nbsp;-y&nbsp;epel-release&nbsp;screen&nbsp;rsync&nbsp;net-tools&nbsp;ethtool&nbsp;swaks&nbsp;sed&nbsp;tar&nbsp;zip&nbsp;unzip&nbsp;curl&nbsp;telnet&nbsp;openssl&nbsp;openssl-devel&nbsp;bzip2-devel&nbsp;libarchive&nbsp;libarchive-devel&nbsp;perl&nbsp;perl-Data-Dumper&nbsp;gcc&nbsp;gcc-c++&nbsp;binutils&nbsp;autoconf&nbsp;automake&nbsp;make&nbsp;sudo&nbsp;wget&nbsp;libxml2-devel&nbsp;libcap-devel&nbsp;libtool-ltdl-devel&lt;br&gt;#&lt;br&gt;#clamAV&nbsp;packages&lt;br&gt;#&lt;br&gt;yum&nbsp;install&nbsp;-y&nbsp;clamav-server&nbsp;clamav-data&nbsp;clamav-update&nbsp;clamav-filesystem&nbsp;clamav&nbsp;clamav-scanner-systemd&nbsp;clamav-devel&nbsp;clamav-lib&nbsp;clamav-server-systemd&lt;br&gt;#&lt;br&gt;#download&nbsp;and&nbsp;compile&nbsp;from&nbsp;source&lt;br&gt;#&lt;br&gt;cd&nbsp;/tmp&lt;br&gt;wget&nbsp;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/Versions/v4/squid-4.17.tar.gz&quot;&gt;http://www.squid-cache.org/Versions/v4/squid-4.17.tar.gz&lt;/a&gt;&lt;br&gt;wget&nbsp;&lt;a&nbsp;href=&quot;http://sourceforge.net/projects/c-icap/files/c-icap/0.5.x/c_icap-0.5.10.tar.gz&quot;&gt;http://sourceforge.net/projects/c-icap/files/c-icap/0.5.x/c_icap-0.5.10.tar.gz&lt;/a&gt;&nbsp;--no-check-certificate&lt;br&gt;wget&nbsp;&lt;a&nbsp;href=&quot;http://sourceforge.net/projects/c-icap/files/c-icap-modules/0.5.x/c_icap_modules-0.5.5.tar.gz&quot;&gt;http://sourceforge.net/projects/c-icap/files/c-icap-modules/0.5.x/c_icap_modules-0.5.5.tar.gz&lt;/a&gt;&nbsp;--no-check-certificate&lt;br&gt;wget&nbsp;&lt;a&nbsp;href=&quot;https://sourceforge.net/projects/squidclamav/files/squidclamav/7.1/squidclamav-7.1.tar.gz&quot;&gt;https://sourceforge.net/projects/squidclamav/files/squidclamav/7.1/squidclamav-7.1.tar.gz&lt;/a&gt;&nbsp;--no-check-certificate&lt;br&gt;#&lt;br&gt;for&nbsp;f&nbsp;in&nbsp;*.tar.gz;&nbsp;do&nbsp;tar&nbsp;xf&nbsp;&quot;$f&quot;;&nbsp;done&lt;br&gt;#&lt;br&gt;cd&nbsp;/tmp/squid-4.17&lt;br&gt;./configure&nbsp;--with-openssl&nbsp;--enable-ssl-crtd&nbsp;--enable-icap-client&nbsp;--enable-http-violations&nbsp;&amp;&amp;&nbsp;make&nbsp;&amp;&amp;&nbsp;make&nbsp;install&lt;br&gt;#&lt;br&gt;cd&nbsp;/tmp/c_icap-0.5.10&lt;br&gt;./configure&nbsp;&#39;CXXFLAGS=-O2&nbsp;-m64&nbsp;-pipe&#39;&nbsp;&#39;CFLAGS=-O2&nbsp;-m64&nbsp;-pipe&#39;&nbsp;--without-bdb&nbsp;--prefix=/usr/local&nbsp;&amp;&amp;&nbsp;make&nbsp;&amp;&amp;&nbsp;make&nbsp;install&lt;br&gt;#&lt;br&gt;cd&nbsp;/tmp/squidclamav-7.1&lt;br&gt;./configure&nbsp;&#39;CXXFLAGS=-O2&nbsp;-m64&nbsp;-pipe&#39;&nbsp;&#39;CFLAGS=-O2&nbsp;-m64&nbsp;-pipe&#39;&nbsp;--with-c-icap=/usr/local&nbsp;--with-libarchive&nbsp;&amp;&amp;&nbsp;make&nbsp;&amp;&amp;&nbsp;make&nbsp;install&lt;br&gt;#&lt;br&gt;cd&nbsp;/tmp/c_icap_modules-0.5.5&lt;br&gt;./configure&nbsp;&#39;CFLAGS=-O3&nbsp;-m64&nbsp;-pipe&#39;&nbsp;&#39;CPPFLAGS=-I/usr/local/clamav/include&#39;&nbsp;&#39;LDFLAGS=-L/usr/local/lib&nbsp;-L/usr/local/clamav/lib/&#39;&nbsp;&amp;&amp;&nbsp;make&nbsp;&amp;&amp;&nbsp;make&nbsp;install&lt;br&gt;#&lt;br&gt;#creating&nbsp;shortcuts&nbsp;and&nbsp;copying&nbsp;files&lt;br&gt;#&lt;br&gt;cp&nbsp;-f&nbsp;/usr/local/squid/etc/squid.conf&nbsp;/usr/local/squid/etc/squid.conf.orig&lt;br&gt;cp&nbsp;-f&nbsp;/usr/local/etc/c-icap.conf&nbsp;/usr/local/etc/c-icap.conf.orig&lt;br&gt;cp&nbsp;-f&nbsp;/usr/local/etc/squidclamav.conf&nbsp;/usr/local/etc/squidclamav.conf.orig&lt;br&gt;cp&nbsp;-f&nbsp;/usr/local/etc/clamav_mod.conf&nbsp;/usr/local/etc/clamav_mod.conf.orig&lt;br&gt;cp&nbsp;-f&nbsp;/usr/local/etc/virus_scan.conf&nbsp;/usr/local/etc/virus_scan.conf.orig&lt;br&gt;#&lt;br&gt;ln&nbsp;-s&nbsp;/usr/local/squid/etc/squid.conf&nbsp;/etc&lt;br&gt;ln&nbsp;-s&nbsp;/usr/local/etc/c-icap.conf&nbsp;/etc&lt;br&gt;ln&nbsp;-s&nbsp;/usr/local/etc/squidclamav.conf&nbsp;/etc&lt;br&gt;ln&nbsp;-s&nbsp;/usr/local/etc/clamav_mod.conf&nbsp;/etc&lt;br&gt;ln&nbsp;-s&nbsp;/usr/local/etc/virus_scan.conf&nbsp;/etc&lt;br&gt;#&lt;br&gt;mkdir&nbsp;-p&nbsp;/usr/local/clamav/share/clamav&lt;br&gt;ln&nbsp;-s&nbsp;/var/lib/clamav&nbsp;/usr/local/clamav/share/clamav&lt;br&gt;#&lt;br&gt;#tmpfiles&nbsp;for&nbsp;run&nbsp;files&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;d&nbsp;/var/run/c-icap&nbsp;0755&nbsp;root&nbsp;root&nbsp;-&quot;&nbsp;&gt;&gt;&nbsp;/etc/tmpfiles.d/c-icap.conf&lt;br&gt;echo&nbsp;&quot;d&nbsp;/var/run/clamav&nbsp;0755&nbsp;root&nbsp;root&nbsp;-&quot;&nbsp;&gt;&gt;&nbsp;/etc/tmpfiles.d/clamav.conf&lt;br&gt;#&lt;br&gt;#original&nbsp;squid&nbsp;config&lt;br&gt;#&lt;br&gt;sed&nbsp;-i&nbsp;&#39;/http_port&nbsp;3128/d&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%http_access&nbsp;deny&nbsp;!Safe_ports%#http_access&nbsp;deny&nbsp;!Safe_ports%g&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports%#http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports%g&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;#&lt;br&gt;#create&nbsp;URL,&nbsp;MIME&nbsp;and&nbsp;public&nbsp;key&nbsp;list&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;#eicar&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/urlwhite.txt&lt;br&gt;echo&nbsp;&quot;.&lt;a&nbsp;href=&quot;http://eicar.org&quot;&gt;eicar.org&lt;/a&gt;&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/urlwhite.txt&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;&lt;a&nbsp;href=&quot;http://updater.maxon.net/server_test&quot;&gt;http://updater.maxon.net/server_test&lt;/a&gt;&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/urlspecial.txt&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;application/octet-stream&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/x-msi&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/zip&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/x-7z-compressed&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/vnd.ms-cab-compressed&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/x-msdownload&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;echo&nbsp;&quot;application/x-iso9660-image&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/mimedeny.txt&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;.&lt;a&nbsp;href=&quot;http://activation.paceap.com&quot;&gt;activation.paceap.com&lt;/a&gt;&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/pubkey.txt&lt;br&gt;#&lt;br&gt;#ICAP&nbsp;in&nbsp;squid&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;#ICAP&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_enable&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;adaptation_uses_indirect_client&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_send_client_ip&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_send_client_username&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_client_username_header&nbsp;X-Authenticated-User&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_service&nbsp;service_req&nbsp;reqmod_precache&nbsp;bypass=0&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/squidclamav&quot;&gt;127.0.0.1:1344/squidclamav&lt;/a&gt;&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;adaptation_access&nbsp;service_req&nbsp;allow&nbsp;all&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;icap_service&nbsp;service_resp&nbsp;respmod_precache&nbsp;bypass=0&nbsp;icap://&lt;a&nbsp;href=&quot;http://127.0.0.1:1344/squidclamav&quot;&gt;127.0.0.1:1344/squidclamav&lt;/a&gt;&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;echo&nbsp;&quot;adaptation_access&nbsp;service_resp&nbsp;allow&nbsp;all&quot;&nbsp;&gt;&gt;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;#&lt;br&gt;#creating&nbsp;SSL&lt;br&gt;#&lt;br&gt;mkdir&nbsp;-p&nbsp;/usr/local/squid/etc/ssl_cert&lt;br&gt;cd&nbsp;/usr/local/squid/etc/ssl_cert&lt;br&gt;adduser&nbsp;squid&lt;br&gt;chown&nbsp;squid:squid&nbsp;/usr/local/squid/etc/ssl_cert&lt;br&gt;chmod&nbsp;700&nbsp;/usr/local/squid/etc/ssl_cert&lt;br&gt;openssl&nbsp;req&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-sha256&nbsp;-days&nbsp;365&nbsp;-nodes&nbsp;-x509&nbsp;-extensions&nbsp;v3_ca&nbsp;-keyout&nbsp;myCA.pem&nbsp; -out&nbsp;myCA.pem&nbsp;-batch&lt;br&gt;#must&nbsp;import&nbsp;the&nbsp;below&nbsp;cert&nbsp;on&nbsp;hosts&nbsp;in&nbsp;trusted&nbsp;root&nbsp;cert&nbsp;ie&nbsp;the&nbsp;.der&nbsp;file&lt;br&gt;openssl&nbsp;x509&nbsp;-in&nbsp;myCA.pem&nbsp;-outform&nbsp;DER&nbsp;-out&nbsp;myCA.der&lt;br&gt;/usr/local/squid/libexec/security_file_certgen&nbsp;-c&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&lt;br&gt;chown&nbsp;squid:squid&nbsp;-R&nbsp;/var/lib/ssl_db&lt;br&gt;chmod&nbsp;-R&nbsp;777&nbsp;/usr/local/squid/var/logs&lt;br&gt;#&lt;br&gt;#squid&nbsp;config&lt;br&gt;#&lt;br&gt;sed&nbsp;-i&nbsp;&#39;51i#SSL&nbsp;NO&nbsp;Interception&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;52iacl&nbsp;DiscoverSNIHost&nbsp;at_step&nbsp;SslBump1&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;53iacl&nbsp;NoSSLIntercept&nbsp;ssl::server_name&nbsp;&quot;/usr/local/squid/etc/pubkey.txt&quot;&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;54issl_bump&nbsp;splice&nbsp;NoSSLIntercept&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;55issl_bump&nbsp;peek&nbsp;DiscoverSNIHost&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;56issl_bump&nbsp;bump&nbsp;all&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;57i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;58i#SSL&nbsp;Bump&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;59ihttp_port&nbsp;3128&nbsp;ssl-bump&nbsp;cert=/usr/local/squid/etc/ssl_cert/myCA.pem&nbsp;generate-host-certificates=on&nbsp;dynamic_cert_mem_cache_size=4MB&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;60isslcrtd_program&nbsp;/usr/local/squid/libexec/security_file_certgen&nbsp;-s&nbsp;/var/lib/ssl_db&nbsp;-M&nbsp;4MB&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;61iacl&nbsp;step1&nbsp;at_step&nbsp;SslBump1&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;62issl_bump&nbsp;peek&nbsp;step1&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;63issl_bump&nbsp;bump&nbsp;all&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;64i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;65iacl&nbsp;activation&nbsp;port&nbsp;80&nbsp;443&nbsp;8090&nbsp;9251&nbsp;#&nbsp;office&nbsp;adobe&nbsp;web&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;66i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;67i#allow&nbsp;special&nbsp;URL&nbsp;paths&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;68iacl&nbsp;special_url&nbsp;url_regex&nbsp;&quot;/usr/local/squid/etc/urlspecial.txt&quot;&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;69i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;70i#deny&nbsp;MIME&nbsp;types&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;71iacl&nbsp;mimetype&nbsp;rep_mime_type&nbsp;&quot;/usr/local/squid/etc/mimedeny.txt&quot;&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;72i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;73ihttp_reply_access&nbsp;allow&nbsp;special_url&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;74ihttp_reply_access&nbsp;deny&nbsp;mimetype&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;75i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;76i#HTTP_HTTPS&nbsp;whitelist&nbsp;websites&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;77iacl&nbsp;whitelist&nbsp;ssl::server_name&nbsp;&quot;/usr/local/squid/etc/urlwhite.txt&quot;&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;78i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;79i#HTTP_HTTPS&nbsp;whitelist&nbsp;websites&nbsp;regex&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;80iacl&nbsp;whitelistreg&nbsp;ssl::server_name_regex&nbsp;&quot;/usr/local/squid/etc/urlregwhite.txt&quot;&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;81i#&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;82ihttp_access&nbsp;allow&nbsp;activation&nbsp;whitelist&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;83ihttp_access&nbsp;allow&nbsp;activation&nbsp;whitelistreg&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;84ihttp_access&nbsp;deny&nbsp;all&#39;&nbsp;/usr/local/squid/etc/squid.conf&lt;br&gt;#&lt;br&gt;#squidclamav&nbsp;conf&lt;br&gt;#&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%redirect&nbsp;&lt;a&nbsp;href=&quot;http://proxy.domain.dom/cgi-bin/clwarn.cgi%#redirect&quot;&gt;http://proxy.domain.dom/cgi-bin/clwarn.cgi%#redirect&lt;/a&gt;&nbsp;&lt;a&nbsp;href=&quot;http://proxy.domain.dom/cgi-bin/clwarn.cgi%g&quot;&gt;http://proxy.domain.dom/cgi-bin/clwarn.cgi%g&lt;/a&gt;&#39;&nbsp;/etc/squidclamav.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%enable_libarchive&nbsp;0%enable_libarchive&nbsp;1%g&#39;&nbsp;/etc/squidclamav.conf&lt;br&gt;#&lt;br&gt;#clamav&nbsp;conf&lt;br&gt;#&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%#LocalSocket&nbsp;/run/clamd.scan/clamd.sock%LocalSocket&nbsp;/var/run/clamav/clamd.ctl%g&#39;&nbsp;/etc/clamd.d/scan.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%Example%#Example%g&#39;&nbsp;/etc/clamd.d/scan.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%User&nbsp;clamscan%User&nbsp;root%g&#39;&nbsp;/etc/clamd.d/scan.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%#StreamMaxLength&nbsp;10M%StreamMaxLength&nbsp;5M%g&#39;&nbsp;/etc/clamd.d/scan.conf&lt;br&gt;freshclam&lt;br&gt;systemctl&nbsp;enable&nbsp;clamd@scan&lt;br&gt;#&lt;br&gt;#crontab&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;00&nbsp;01,13&nbsp;*&nbsp;*&nbsp;*&nbsp; /usr/bin/freshclam&nbsp;--quiet&quot;&nbsp;&gt;&gt;&nbsp;/var/spool/cron/root&lt;br&gt;echo&nbsp;&quot;@reboot&nbsp;/usr/local/squid/sbin/squid&quot;&nbsp;&gt;&gt;&nbsp;/var/spool/cron/root&lt;br&gt;echo&nbsp;&quot;*/15&nbsp;*&nbsp;*&nbsp;*&nbsp;*&nbsp;/usr/local/squid/sbin/squid&nbsp;-k&nbsp;reconfigure&quot;&nbsp;&gt;&gt;&nbsp;/var/spool/cron/root&lt;br&gt;echo&nbsp;&quot;0&nbsp;21&nbsp;*&nbsp;*&nbsp;0&nbsp;/usr/local/squid/sbin/squid&nbsp;-k&nbsp;rotate&quot;&nbsp;&gt;&gt;&nbsp;/var/spool/cron/root&lt;br&gt;#&lt;br&gt;#c-icap&nbsp;and&nbsp;c-icap&nbsp;modules&lt;br&gt;#&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%#.*User&nbsp;wwwrun%User&nbsp;root%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%#.*Group&nbsp;nogroup%Group&nbsp;root%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%#.*Service&nbsp;echo_service&nbsp;srv_echo.so%Service&nbsp;squidclamav&nbsp;squidclamav.so%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%DebugLevel&nbsp;1%DebugLevel&nbsp;0%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%StartServers&nbsp;3%StartServers&nbsp;1%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%MaxServers&nbsp;10%MaxServers&nbsp;20%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;-e&nbsp;&#39;s%MaxRequestsPerChild&nbsp; 0%MaxRequestsPerChild&nbsp; 100%g&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;520iacl&nbsp;localhost&nbsp;src&nbsp;&lt;a&nbsp;href=&quot;http://127.0.0.1/255.255.255.255&quot;&gt;127.0.0.1/255.255.255.255&lt;/a&gt;&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;521iacl&nbsp;PERMIT_REQUESTS&nbsp;type&nbsp;REQMOD&nbsp;RESPMOD&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;522iicap_access&nbsp;allow&nbsp;localhost&nbsp;PERMIT_REQUESTS&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;sed&nbsp;-i&nbsp;&#39;523iicap_access&nbsp;deny&nbsp;all&#39;&nbsp;/etc/c-icap.conf&lt;br&gt;echo&nbsp;&quot;clamav_mod.TmpDir&nbsp;/var/tmp&quot;&nbsp;&gt;&gt;&nbsp;/etc/clamav_mod.conf&lt;br&gt;echo&nbsp;&quot;clamav_mod.MaxFilesInArchive&nbsp;1000&quot;&nbsp;&gt;&gt;&nbsp;/etc/clamav_mod.conf&lt;br&gt;echo&nbsp;&quot;clamav_mod.MaxScanSize&nbsp;5M&quot;&nbsp;&gt;&gt;&nbsp;/etc/clamav_mod.conf&lt;br&gt;echo&nbsp;&quot;clamav_mod.HeuristicScanPrecedence&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/etc/clamav_mod.conf&lt;br&gt;echo&nbsp;&quot;clamav_mod.OLE2BlockMacros&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/etc/clamav_mod.conf&lt;br&gt;echo&nbsp;&quot;virus_scan.ScanFileTypes&nbsp;TEXT&nbsp;DATA&nbsp;EXECUTABLE&nbsp;ARCHIVE&nbsp;DOCUMENT&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;virus_scan.SendPercentData&nbsp;5&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;virus_scan.PassOnError&nbsp;on&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;virus_scan.MaxObjectSize&nbsp; 5M&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;virus_scan.DefaultEngine&nbsp;clamav&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;Include&nbsp;clamav_mod.conf&quot;&nbsp;&gt;&gt;&nbsp;/etc/virus_scan.conf&lt;br&gt;echo&nbsp;&quot;Include&nbsp;virus_scan.conf&quot;&nbsp;&gt;&gt;&nbsp;/etc/c-icap.conf&lt;br&gt;#&lt;br&gt;#make&nbsp;c-icap&nbsp;service&lt;br&gt;#&lt;br&gt;echo&nbsp;&quot;[Unit]&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;Description=c-icap&nbsp;service&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;After=network.target&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;[Service]&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;Type=forking&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;PIDFile=/var/run/c-icap/c-icap.pid&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;ExecStart=/usr/local/bin/c-icap&nbsp;-f&nbsp;/etc/c-icap.conf&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;KillMode=process&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;[Install]&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;echo&nbsp;&quot;WantedBy=multi-user.target&quot;&nbsp;&gt;&gt;&nbsp;/usr/lib/systemd/system/c-icap.service&lt;br&gt;systemctl&nbsp;enable&nbsp;c-icap&lt;br&gt;reboot&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks,&lt;/div&gt;&lt;div&gt;rob&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&nbsp;&lt;br&gt;&lt;br&gt;Robert&nbsp;K&nbsp;Wild.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
