<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;use &lt;span&nbsp;style=&quot;color:rgb(30,30,30);font-family:courier;font-size:12px&quot;&gt;tcp_outgoing_address &lt;/span&gt;to&nbsp;forward&nbsp;traffic&nbsp;from&nbsp;specific&nbsp;users&nbsp;to&nbsp;a&nbsp;specific&nbsp;interface.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;running&nbsp;squid&nbsp;5.7&nbsp;(on&nbsp;openwrt).&lt;/div&gt;&lt;div&gt;have&nbsp;a&nbsp;few&nbsp;interfaces&nbsp;on&nbsp;my&nbsp;machine,&nbsp;two&nbsp;of&nbsp;which&nbsp;are&nbsp;VPN&nbsp;interfaces&nbsp;with&nbsp;IPs&nbsp;(internal) &lt;span&nbsp;style=&quot;font-variant-ligatures:no-common-ligatures;color:rgb(0,0,0);font-family:Menlo;font-size:14px&quot;&gt;10.200.0.70 &lt;/span&gt; and&lt;span&nbsp;style=&quot;font-variant-ligatures:no-common-ligatures;color:rgb(0,0,0);font-family:Menlo;font-size:14px&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;font-variant-ligatures:no-common-ligatures;color:rgb(0,0,0);font-family:Menlo;font-size:14px&quot;&gt;10.102.237.50&lt;/span&gt;.&lt;/div&gt;&lt;div&gt;trying&nbsp;to&nbsp;forward&nbsp;user&nbsp;&quot;uk&quot;&nbsp;to&nbsp;the&nbsp;interface&nbsp;with&nbsp;IP&nbsp;10.200.0.70&nbsp;is&nbsp;&quot;ignored&quot;&nbsp;-&nbsp;I&nbsp;can&nbsp;see&nbsp;that&nbsp;the&nbsp;default&nbsp;WAN&nbsp;interface&nbsp;is&nbsp;used.&nbsp;I&nbsp;see&nbsp;it&nbsp;by&nbsp;using&nbsp;a&nbsp;simple&nbsp;&quot;what&nbsp;is&nbsp;my&nbsp;ip&quot;&nbsp;test&nbsp;when&nbsp;using&nbsp;the&nbsp;proxy,&nbsp;and&nbsp;checking&nbsp;the&nbsp;traffic&nbsp;of&nbsp;the&nbsp;interfaces&nbsp;when&nbsp;sending&nbsp;requests.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;the&nbsp;relevant&nbsp;excerpt&nbsp;from&nbsp;the&nbsp;squid&nbsp;conf:&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;acl&nbsp;wg_uk&nbsp;proxy_auth&nbsp;uk&lt;br&gt;tcp_outgoing_address&nbsp;10.200.0.70&nbsp;wg_uk&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;can&nbsp;see&nbsp;that&nbsp;the&nbsp;IP&nbsp;and&nbsp;config&nbsp;are&nbsp;not&nbsp;wrong&nbsp;because&nbsp;the&nbsp;requests&nbsp;don&#39;t&nbsp;get &lt;span&nbsp;style=&quot;background-color:transparent;font-style:inherit;font-variant-ligatures:inherit;font-variant-caps:inherit;font-weight:inherit;white-space:inherit&quot;&gt;503&nbsp;errors&nbsp;(if&nbsp;I&nbsp;change&nbsp;the&nbsp;IP&nbsp;to&nbsp;a&nbsp;non&nbsp;existing&nbsp;one,&nbsp;e.g.&nbsp;10.200.0.71&nbsp;I&nbsp;do&nbsp;get&nbsp;503&nbsp;errors).&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:transparent;font-style:inherit;font-variant-ligatures:inherit;font-variant-caps:inherit;font-weight:inherit;white-space:inherit&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:transparent;font-style:inherit;font-variant-ligatures:inherit;font-variant-caps:inherit;font-weight:inherit;white-space:inherit&quot;&gt;small&nbsp;excerpt&nbsp;from&nbsp;the&nbsp;squid_cache.log&nbsp;(proxy&nbsp;server&nbsp;is &lt;/span&gt;192.168.1.1,&nbsp;proxy&nbsp;client&nbsp;is 192.168.1.149)&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;2022/11/26&nbsp;11:28:48.286|&nbsp;17,3|&nbsp;FwdState.cc(394)&nbsp;Start:&nbsp;&#39;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&#39;&lt;br&gt;2022/11/26&nbsp;11:28:48.286|&nbsp;17,2|&nbsp;FwdState.cc(157)&nbsp;FwdState:&nbsp;Forwarding&nbsp;client&nbsp;request&nbsp;conn157&nbsp;local=&lt;a&nbsp;href=&quot;http://192.168.1.1:3128&quot;&gt;192.168.1.1:3128&lt;/a&gt;&nbsp;remote=&lt;a&nbsp;href=&quot;http://192.168.1.149:64723&quot;&gt;192.168.1.149:64723&lt;/a&gt;&nbsp;FD&nbsp;13&nbsp;flags=1,&nbsp;url=&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&lt;span&nbsp;style=&quot;background-color:transparent;font-style:inherit;font-variant-ligatures:inherit;font-variant-caps:inherit;font-weight:inherit;white-space:inherit&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;44,2|&nbsp;peer_select.cc(460)&nbsp;resolveSelected:&nbsp;Find&nbsp;IP&nbsp;destination&nbsp;for:&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&#39;&nbsp;via&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com&quot;&gt;detectportal.firefox.com&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;14,4|&nbsp;ipcache.cc(607)&nbsp;nbgethostbyname:&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com&quot;&gt;detectportal.firefox.com&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;14,3|&nbsp;Address.cc(389)&nbsp;lookupHostIP:&nbsp;Given&nbsp;Non-IP&nbsp;&#39;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com&quot;&gt;detectportal.firefox.com&lt;/a&gt;&#39;:&nbsp;Name&nbsp;does&nbsp;not&nbsp;resolve&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;14,4|&nbsp;ipcache.cc(647)&nbsp;ipcache_nbgethostbyname_:&nbsp;ipcache_nbgethostbyname:&nbsp;HIT&nbsp;for&nbsp;&#39;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com&quot;&gt;detectportal.firefox.com&lt;/a&gt;&#39;&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;14,7|&nbsp;ipcache.cc(250)&nbsp;forwardIp:&nbsp;34.107.221.82&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,3|&nbsp;Checklist.cc(70)&nbsp;preCheck:&nbsp;0x7ffd71e3d440&nbsp;checking&nbsp;fast&nbsp;ACLs&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;tcp_outgoing_address&nbsp;10.200.0.70&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;(tcp_outgoing_address&nbsp;10.200.0.70&nbsp;line)&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,5|&nbsp;Acl.cc(124)&nbsp;matches:&nbsp;checking&nbsp;wg_uk&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;29,5|&nbsp;UserRequest.cc(75)&nbsp;valid:&nbsp;Validated.&nbsp;Auth::UserRequest&nbsp;&#39;0x1bad2e0&#39;.&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,4|&nbsp;Acl.cc(346)&nbsp;cacheMatchAcl:&nbsp;ACL::cacheMatchAcl:&nbsp;cache&nbsp;hit&nbsp;on&nbsp;acl&nbsp;&#39;wg_uk&#39;&nbsp;(0x1551ca0)&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,3|&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;wg_uk&nbsp;=&nbsp;1&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,3|&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;(tcp_outgoing_address&nbsp;10.200.0.70&nbsp;line)&nbsp;=&nbsp;1&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,3|&nbsp;Acl.cc(151)&nbsp;matches:&nbsp;checked:&nbsp;tcp_outgoing_address&nbsp;10.200.0.70&nbsp;=&nbsp;1&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,3|&nbsp;Checklist.cc(63)&nbsp;markFinished:&nbsp;0x7ffd71e3d440&nbsp;answer&nbsp;ALLOWED&nbsp;for&nbsp;match&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,4|&nbsp;FilledChecklist.cc(67)&nbsp;~ACLFilledChecklist:&nbsp;ACLFilledChecklist&nbsp;destroyed&nbsp;0x7ffd71e3d440&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;28,4|&nbsp;Checklist.cc(197)&nbsp;~ACLChecklist:&nbsp;ACLChecklist::~ACLChecklist:&nbsp;destroyed&nbsp;0x7ffd71e3d440&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;24,7|&nbsp;SBuf.cc(209)&nbsp;append:&nbsp;from&nbsp;c-string&nbsp;to&nbsp;id&nbsp;SBuf10501&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;24,7|&nbsp;SBuf.cc(160)&nbsp;rawSpace:&nbsp;reserving&nbsp;46&nbsp;for&nbsp;SBuf10501&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;24,7|&nbsp;SBuf.cc(866)&nbsp;reAlloc:&nbsp;SBuf10501&nbsp;new&nbsp;store&nbsp;capacity:&nbsp;128&lt;br&gt;2022/11/26&nbsp;11:28:48.287|&nbsp;44,2|&nbsp;peer_select.cc(1171)&nbsp;handlePath:&nbsp;PeerSelector27&nbsp;found&nbsp;conn167&nbsp;local=10.200.0.70&nbsp;remote=&lt;a&nbsp;href=&quot;http://34.107.221.82:80&quot;&gt;34.107.221.82:80&lt;/a&gt;&nbsp;HIER_DIRECT&nbsp;flags=1,&nbsp;destination&nbsp;#1&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1177)&nbsp;handlePath:&nbsp; &nbsp;always_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1178)&nbsp;handlePath:&nbsp; &nbsp; never_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1179)&nbsp;handlePath:&nbsp; &nbsp; &nbsp; &nbsp; timedout&nbsp;=&nbsp;0&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,7|&nbsp;peer_select.cc(1149)&nbsp;interestedInitiator:&nbsp;PeerSelector27&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;17,3|&nbsp;FwdState.cc(631)&nbsp;noteDestination:&nbsp;conn167&nbsp;local=10.200.0.70&nbsp;remote=&lt;a&nbsp;href=&quot;http://34.107.221.82:80&quot;&gt;34.107.221.82:80&lt;/a&gt;&nbsp;HIER_DIRECT&nbsp;flags=1&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;17,3|&nbsp;FwdState.cc(1135)&nbsp;connectStart:&nbsp;1+&nbsp;paths&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;11,7|&nbsp;HttpRequest.cc(468)&nbsp;clearError:&nbsp;old:&nbsp;ERR_NONE&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;17,5|&nbsp;AsyncCall.cc(30)&nbsp;AsyncCall:&nbsp;The&nbsp;AsyncCall&nbsp;FwdState::noteConnection&nbsp;constructed,&nbsp;this=0x1b97100&nbsp;[call1887]&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;93,5|&nbsp;AsyncJob.cc(34)&nbsp;AsyncJob:&nbsp;AsyncJob&nbsp;constructed,&nbsp;this=0x1b86e18&nbsp;type=HappyConnOpener&nbsp;[job99]&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;93,5|&nbsp;AsyncCall.cc(30)&nbsp;AsyncCall:&nbsp;The&nbsp;AsyncCall&nbsp;AsyncJob::start&nbsp;constructed,&nbsp;this=0x1b09300&nbsp;[call1888]&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;93,5|&nbsp;AsyncCall.cc(97)&nbsp;ScheduleCall:&nbsp;AsyncJob.cc(26)&nbsp;will&nbsp;call&nbsp;AsyncJob::start()&nbsp;[call1888]&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;14,7|&nbsp;ipcache.cc(250)&nbsp;forwardIp:&nbsp;[2600:1901:0:38d7::]&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,7|&nbsp;peer_select.cc(1149)&nbsp;interestedInitiator:&nbsp;PeerSelector27&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,6|&nbsp;SBuf.cc(99)&nbsp;assign:&nbsp;SBuf10502&nbsp;from&nbsp;c-string,&nbsp;n=4294967295)&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;28,4|&nbsp;FilledChecklist.cc(67)&nbsp;~ACLFilledChecklist:&nbsp;ACLFilledChecklist&nbsp;destroyed&nbsp;0x7ffd71e3d440&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;28,4|&nbsp;Checklist.cc(197)&nbsp;~ACLChecklist:&nbsp;ACLChecklist::~ACLChecklist:&nbsp;destroyed&nbsp;0x7ffd71e3d440&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(209)&nbsp;append:&nbsp;from&nbsp;c-string&nbsp;to&nbsp;id&nbsp;SBuf10503&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(160)&nbsp;rawSpace:&nbsp;reserving&nbsp;46&nbsp;for&nbsp;SBuf10503&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(866)&nbsp;reAlloc:&nbsp;SBuf10503&nbsp;new&nbsp;store&nbsp;capacity:&nbsp;128&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1171)&nbsp;handlePath:&nbsp;PeerSelector27&nbsp;found&nbsp;conn168&nbsp;local=[::]&nbsp;remote=[2600:1901:0:38d7::]:80&nbsp;HIER_DIRECT&nbsp;flags=1,&nbsp;destination&nbsp;#2&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1177)&nbsp;handlePath:&nbsp; &nbsp;always_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1178)&nbsp;handlePath:&nbsp; &nbsp; never_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(1179)&nbsp;handlePath:&nbsp; &nbsp; &nbsp; &nbsp; timedout&nbsp;=&nbsp;0&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,7|&nbsp;peer_select.cc(1149)&nbsp;interestedInitiator:&nbsp;PeerSelector27&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;17,3|&nbsp;FwdState.cc(631)&nbsp;noteDestination:&nbsp;conn168&nbsp;local=[::]&nbsp;remote=[2600:1901:0:38d7::]:80&nbsp;HIER_DIRECT&nbsp;flags=1&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;17,7|&nbsp;FwdState.cc(690)&nbsp;notifyConnOpener:&nbsp;reusing&nbsp;pending&nbsp;notification&nbsp;about&nbsp;2+&nbsp;paths&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;14,7|&nbsp;ipcache.cc(231)&nbsp;finalCallback:&nbsp;0x1af12b8&nbsp;&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,7|&nbsp;peer_select.cc(1149)&nbsp;interestedInitiator:&nbsp;PeerSelector27&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,7|&nbsp;peer_select.cc(1149)&nbsp;interestedInitiator:&nbsp;PeerSelector27&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(209)&nbsp;append:&nbsp;from&nbsp;c-string&nbsp;to&nbsp;id&nbsp;SBuf10504&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(160)&nbsp;rawSpace:&nbsp;reserving&nbsp;46&nbsp;for&nbsp;SBuf10504&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;24,7|&nbsp;SBuf.cc(866)&nbsp;reAlloc:&nbsp;SBuf10504&nbsp;new&nbsp;store&nbsp;capacity:&nbsp;128&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(479)&nbsp;resolveSelected:&nbsp;PeerSelector27&nbsp;found&nbsp;all&nbsp;2&nbsp;destinations&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://detectportal.firefox.com/canonical.html&quot;&gt;http://detectportal.firefox.com/canonical.html&lt;/a&gt;&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(480)&nbsp;resolveSelected:&nbsp; &nbsp;always_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(481)&nbsp;resolveSelected:&nbsp; &nbsp; never_direct&nbsp;=&nbsp;DENIED&lt;br&gt;2022/11/26&nbsp;11:28:48.288|&nbsp;44,2|&nbsp;peer_select.cc(482)&nbsp;resolveSelected:&nbsp; &nbsp; &nbsp; &nbsp; timedout&nbsp;=&nbsp;0&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;can&nbsp;anyone&nbsp;help&nbsp;me&nbsp;understand&nbsp;what&nbsp;I&#39;m&nbsp;missing?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;thanks!&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;<br>

</tt>
