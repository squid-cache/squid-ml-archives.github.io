<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&nbsp;got&nbsp;the&nbsp;external&nbsp;acl&nbsp;setup&nbsp;to&nbsp;work,&nbsp;it&nbsp;had&nbsp;some&nbsp;bugs&nbsp;but&nbsp;I&nbsp;notice&nbsp;something&nbsp;that&nbsp;maybe&nbsp;through&nbsp;configuration&nbsp;I&nbsp;can&nbsp;fix.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&#39;s&nbsp;a&nbsp;configuration&lt;br&gt;&lt;/div&gt;&lt;div&gt;external_acl_type&nbsp;CHECKOVERCUOTE&nbsp;concurrency=100&nbsp;ttl=3&nbsp;negative_ttl=10&nbsp;children-max=50&nbsp;children-startup=10&nbsp;children-idle=5&nbsp; %LOGIN&nbsp;/usr/lib/squid/ext_sql_session_acl&nbsp;--dsn&nbsp;&quot;DBI:mysql:database=squidmgr&quot;&nbsp;--user&nbsp;squidmgr&nbsp;--password&nbsp;squ1dmgr&nbsp;--table&nbsp;&quot;proxy_usuario&quot;&nbsp;--uidcol&nbsp;&quot;identificador&quot;&nbsp;--usercol&nbsp;&quot;identificador&quot;&nbsp;--cond&nbsp;&quot;overcuote&nbsp;=&nbsp;1&quot;&nbsp;--debug&lt;br&gt;acl&nbsp;OVERCUOTE&nbsp;external&nbsp;CHECKOVERCUOTE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;generate:&nbsp;SELECT&nbsp;identificador&nbsp;AS&nbsp;&#39;user&#39;,&nbsp;&#39;&#39;&nbsp;AS&nbsp;&#39;tag&#39;&nbsp;FROM&nbsp;proxy_usuario&nbsp;WHERE&nbsp;(identificador&nbsp;=&nbsp;?)&nbsp;AND&nbsp;overcuote&nbsp;=1&lt;/div&gt;&lt;div&gt;UID&nbsp;queried:&nbsp;&#39;frizquierdo&nbsp;-&nbsp;&#39;&nbsp;#&nbsp;when&nbsp;user&nbsp;identifier&nbsp;authenticated&nbsp;on&nbsp;squid&nbsp;is&nbsp;&#39;frizquierdo&#39;&lt;br&gt;&lt;/div&gt;&lt;br&gt;The&nbsp;user&nbsp;identifier&nbsp;generated&nbsp;by&nbsp;the&nbsp;ext_sql_session_acl&nbsp;query&nbsp;is&nbsp;made&nbsp;up&nbsp;of&nbsp;the&nbsp;user&nbsp;identifier&nbsp;+space+&nbsp;hyphen&nbsp;+space,&nbsp;for&nbsp;example&nbsp;(for&nbsp;&#39;frizquierdo&#39;&nbsp;identifier,&nbsp;&#39;frizquierdo&nbsp;-&nbsp;&#39;&nbsp;is&nbsp;generated),&nbsp;so&nbsp;in&nbsp;the&nbsp;database&nbsp;it&nbsp;would&nbsp;have&nbsp;to&nbsp;be&nbsp;the&nbsp;user&nbsp;identifier&nbsp;stored&nbsp;in&nbsp;that&nbsp;format.&lt;br&gt;Is&nbsp;there&nbsp;a&nbsp;directive&nbsp;that&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;parameter&nbsp;is&nbsp;not&nbsp;created&nbsp;that&nbsp;way?&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;El&nbsp;mié,&nbsp;29&nbsp;mar&nbsp;2023&nbsp;a&nbsp;las&nbsp;8:00,&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&gt;&nbsp;escribió:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Send&nbsp;squid-users&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;&#39;help&#39;&nbsp;to&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users-owner@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-owner@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;squid-users&nbsp;digest...&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Today&#39;s&nbsp;Topics:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; 1.&nbsp;Re:&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;22&nbsp;(Francisco)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
----------------------------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;1&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;28&nbsp;Mar&nbsp;2023&nbsp;11:46:29&nbsp;-0400&lt;br&gt;<br>
From:&nbsp;Francisco&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:frizquierdo87@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;frizquierdo87@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;22&lt;br&gt;<br>
Message-ID:&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:CAJXDOba8SokfbZWeG-GidyLb6-r-hJYG__qJCCF6iQ2zQJUE0g@mail.gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;CAJXDOba8SokfbZWeG-GidyLb6-r-hJYG__qJCCF6iQ2zQJUE0g@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;my&nbsp;previous&nbsp;email&nbsp;I&nbsp;was&nbsp;missing&nbsp;part&nbsp;of&nbsp;the&nbsp;text&nbsp;when&nbsp;I&nbsp;sent&nbsp;it,&nbsp;I&lt;br&gt;<br>
deleted&nbsp;it&nbsp;by&nbsp;mistake.&lt;br&gt;<br>
This&nbsp;is&nbsp;what&nbsp;I&nbsp;have&nbsp;so&nbsp;far:&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;try&nbsp;to&nbsp;make&nbsp;the&nbsp;following&nbsp;config:&lt;br&gt;<br>
external_acl_type&nbsp;CHECKOVERCUOTE&nbsp;ttl=5&nbsp;negative_ttl=5&nbsp;children-max=10&lt;br&gt;<br>
children-startup=5&nbsp;%ACL&nbsp;/usr/lib/squid/ext_sql_session_acl&nbsp;--dsn&lt;br&gt;<br>
&quot;DBI:mysql:database=squidmgr&quot;&nbsp;--user&nbsp;squidmgr&nbsp;--password&nbsp;squidmgr&nbsp;--table&lt;br&gt;<br>
&quot;proxy_usuario&quot;&nbsp;uidcol&nbsp;&quot;id&quot;&nbsp;--usercol&nbsp;&quot;identificador&quot;&nbsp;--cond&nbsp;&quot;overcuote=1&quot;&lt;br&gt;<br>
--persist&lt;br&gt;<br>
acl&nbsp;OVERCUOTE&nbsp;external&nbsp;CHECKOVERCUOTE&lt;br&gt;<br>
&lt;br&gt;<br>
http_access&nbsp;allow&nbsp;CONNECT&nbsp;SSL_ports&nbsp;!dominio_cuba&nbsp;usuarios_internet&lt;br&gt;<br>
macs_red_local&nbsp;red_local&nbsp;!OVERCUOTE&lt;br&gt;<br>
&lt;br&gt;<br>
--cond&nbsp;&quot;overcuote=1&quot;&nbsp;is&nbsp;the&nbsp;field&nbsp;in&nbsp;database&nbsp;that&nbsp;it&#39;s&nbsp;set&nbsp;to&nbsp;1&nbsp;when&nbsp;user&lt;br&gt;<br>
calc&nbsp;overcuote.&lt;br&gt;<br>
&lt;br&gt;<br>
if&nbsp;i&nbsp;try&nbsp;ext_sql_session_acl&nbsp;from&nbsp;terminal,&nbsp;i&nbsp;see:&lt;br&gt;<br>
ERR&nbsp;message=&quot;unknow&nbsp;UID&nbsp;&#39;&nbsp;&#39;&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
El&nbsp;mar,&nbsp;28&nbsp;mar&nbsp;2023&nbsp;a&nbsp;las&nbsp;8:00,&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
escribi?:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Send&nbsp;squid-users&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;&#39;help&#39;&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users-owner@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-owner@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
&gt;&nbsp;than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;squid-users&nbsp;digest...&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Today&#39;s&nbsp;Topics:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp;1.&nbsp;Re:&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;21&nbsp;(Francisco)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;----------------------------------------------------------------------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Message:&nbsp;1&lt;br&gt;<br>
&gt;&nbsp;Date:&nbsp;Mon,&nbsp;27&nbsp;Mar&nbsp;2023&nbsp;18:09:10&nbsp;-0400&lt;br&gt;<br>
&gt;&nbsp;From:&nbsp;Francisco&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:frizquierdo87@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;frizquierdo87@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;21&lt;br&gt;<br>
&gt;&nbsp;Message-ID:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CAJXDObaQz4X2g=&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Y5Uh3U6NPmoafA-RygPWMvfED6bEYNszf_uA@mail.gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Y5Uh3U6NPmoafA-RygPWMvfED6bEYNszf_uA@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Sorry,&nbsp;I&nbsp;don&#39;t&nbsp;understand&nbsp;how&nbsp;to&nbsp;combine&nbsp;*ext_sql_session_acl*&nbsp;with&lt;br&gt;<br>
&gt;&nbsp;anothers&nbsp;acl&nbsp;of&nbsp;type&nbsp;dstdomain&nbsp;for&nbsp;example,&nbsp;becasue&nbsp;I&nbsp;need&nbsp;calc&nbsp;user&#39;s&lt;br&gt;<br>
&gt;&nbsp;cuote&nbsp;only&nbsp;for&nbsp;an&nbsp;certains&nbsp;sites&nbsp;(domains,&nbsp;and&nbsp;sites).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;El&nbsp;lun,&nbsp;27&nbsp;mar&nbsp;2023&nbsp;a&nbsp;las&nbsp;8:00,&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;escribi?:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Send&nbsp;squid-users&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;&#39;help&#39;&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users-request@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-request@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users-owner@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users-owner@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;squid-users&nbsp;digest...&quot;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Today&#39;s&nbsp;Topics:&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp;1.&nbsp;Re:&nbsp;squid&nbsp;5.7&nbsp;Bad&nbsp;request&nbsp;from&nbsp;parent&nbsp;cache&nbsp;after&nbsp;squid&nbsp;-k&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; reconfigure&nbsp;(Amos&nbsp;Jeffries)&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;----------------------------------------------------------------------&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Message:&nbsp;1&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Date:&nbsp;Mon,&nbsp;27&nbsp;Mar&nbsp;2023&nbsp;05:05:02&nbsp;+1300&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;From:&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;squid&nbsp;5.7&nbsp;Bad&nbsp;request&nbsp;from&nbsp;parent&nbsp;cache&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp; &nbsp; &nbsp; &nbsp; after&nbsp;squid&nbsp;-k&nbsp;reconfigure&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Message-ID:&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:bfd2a571-02d1-2cff-690c-59caf55a0338@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;bfd2a571-02d1-2cff-690c-59caf55a0338@treenet.co.nz&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Content-Type:&nbsp;text/plain;&nbsp;charset=UTF-8;&nbsp;format=flowed&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;On&nbsp;24/03/2023&nbsp;2:34&nbsp;pm,&nbsp;Francisco&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;Hi,&nbsp;(first&nbsp;Iapologize&nbsp;for&nbsp;my&nbsp;English)&nbsp;I&nbsp;have&nbsp;a&nbsp;local&nbsp;squid&nbsp;proxy&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;forward&nbsp;mode,&nbsp;with&nbsp;parent&nbsp;cache.&nbsp;I&#39;m&nbsp;trying&nbsp;calc&nbsp;and&nbsp;restrict&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;authenticated&nbsp;users&nbsp;that&nbsp;reach&nbsp;the&nbsp;assigned&nbsp;cuote&nbsp;on&nbsp;certains&nbsp;domains&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;and&nbsp;sites,&nbsp;and&nbsp;for&nbsp;that&nbsp;I&nbsp;store&nbsp;the&nbsp;access&nbsp;log&nbsp;into&nbsp;database&nbsp;that&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;match&nbsp;determinates&nbsp;ACL.&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;Every&nbsp;one&nbsp;minute&nbsp;run&nbsp;an&nbsp;script&nbsp;that&nbsp;calc&nbsp;http_size&nbsp;for&nbsp;every&nbsp;user&nbsp;from&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;database&nbsp;(leaving&nbsp;out&nbsp;logs&nbsp;records&nbsp;derived&nbsp;from&nbsp;TCP_HIT_,&nbsp;zero&nbsp;size,&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;NONE,&nbsp;etc,&nbsp;etc),&nbsp;and&nbsp;those&nbsp;users&nbsp;that&nbsp;get&nbsp;her&nbsp;assigned&nbsp;limit,&nbsp;I&nbsp;put&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;them&nbsp;into&nbsp;a&nbsp;file&nbsp;(that&nbsp;point&nbsp;to&nbsp;an&nbsp;access&nbsp;deny_rule),&nbsp;and&nbsp;make&nbsp;squid&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;-k&nbsp;reconfigure.&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Constantly&nbsp;reconfiguring&nbsp;Squid&nbsp;has&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;side&nbsp;effects&nbsp;such&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;as&nbsp;the&nbsp;one&nbsp;you&nbsp;noticed.&nbsp;Avoiding&nbsp;that&nbsp;is&nbsp;a&nbsp;good&nbsp;idea.&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;I&nbsp;recommend&nbsp;having&nbsp;a&nbsp;table&nbsp;in&nbsp;the&nbsp;database&nbsp;with&nbsp;the&nbsp;details&nbsp;about&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;whether&nbsp;a&nbsp;user&nbsp;is&nbsp;allowed&nbsp;(or&nbsp;not).&nbsp;The&nbsp;ext_sql_session_acl&nbsp;helper&nbsp;can&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;check&nbsp;that&nbsp;table&nbsp;to&nbsp;allow/deny&nbsp;users.&lt;br&gt;<br>
&gt;&nbsp;&gt; &nbsp;?&lt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/Versions/v4/manuals/ext_sql_session_acl.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.squid-cache.org/Versions/v4/manuals/ext_sql_session_acl.html&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;HTH&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Amos&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;------------------------------&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Subject:&nbsp;Digest&nbsp;Footer&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;------------------------------&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;End&nbsp;of&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;21&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;********************************************&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
&gt;&nbsp;An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
&gt;&nbsp;URL:&nbsp;&lt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/attachments/20230327/48f4c47d/attachment-0001.htm&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/attachments/20230327/48f4c47d/attachment-0001.htm&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;------------------------------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Subject:&nbsp;Digest&nbsp;Footer&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;------------------------------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;End&nbsp;of&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;22&lt;br&gt;<br>
&gt;&nbsp;********************************************&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
URL:&nbsp;&lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/attachments/20230328/fd60a036/attachment-0001.htm&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/attachments/20230328/fd60a036/attachment-0001.htm&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Subject:&nbsp;Digest&nbsp;Footer&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
End&nbsp;of&nbsp;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;103,&nbsp;Issue&nbsp;23&lt;br&gt;<br>
********************************************&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
