<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Previously,&nbsp;caching&nbsp;was&nbsp;disabled&nbsp;on&nbsp;our&nbsp;proxy&nbsp;servers.&nbsp;Now&nbsp;we&nbsp;need&nbsp;to&nbsp;cache&nbsp;some&nbsp;content&nbsp;(files&nbsp;about&nbsp;10&nbsp;MB&nbsp;in&nbsp;size).&lt;/div&gt;&lt;div&gt;So&nbsp;we&nbsp;changed&nbsp;the&nbsp;squid.conf:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;#Disable&nbsp;caching&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;#cache&nbsp;deny&nbsp;all&lt;br&gt;#no_cache&nbsp;deny&nbsp;all &lt;br&gt;#cache_mem&nbsp;0&lt;br&gt;&lt;br&gt;cache_dir&nbsp;ufs&nbsp;/data/squid/cache&nbsp;32000&nbsp;16&nbsp;256&nbsp;max-size=12000000&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;have&nbsp;24&nbsp;workers&nbsp;on&nbsp;each&nbsp;proxy.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;saw&nbsp;that&nbsp;some&nbsp;requests&nbsp;were&nbsp;taken&nbsp;from&nbsp;the&nbsp;cache,&nbsp;and&nbsp;some&nbsp;were&nbsp;not.&lt;/div&gt;&lt;div&gt;The&nbsp;documentation says: &lt;br&gt;&lt;/div&gt;&lt;div&gt;&quot;&lt;span&nbsp;style=&quot;color:rgb(30,30,30);font-family:courier;font-size:12px&quot;&gt;In&nbsp;SMP&nbsp;configurations,&nbsp;cache_dir&nbsp;must&nbsp;not&nbsp;precede&nbsp;the&nbsp;workers&nbsp;option &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(30,30,30);font-family:courier;font-size:12px&quot;&gt;and&nbsp;should&nbsp;use&nbsp;configuration&nbsp;macros&nbsp;or&nbsp;conditionals&nbsp;to&nbsp;give&nbsp;each &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(30,30,30);font-family:courier;font-size:12px&quot;&gt;worker&nbsp;interested&nbsp;in&nbsp;disk&nbsp;caching&nbsp;a&nbsp;dedicated&nbsp;cache&nbsp;directory.&lt;/span&gt;&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;found&nbsp;Amos&#39;&nbsp;comment&nbsp;that&nbsp;&quot;rock &lt;span&nbsp;style=&quot;color:rgb(0,0,0);white-space:pre-wrap&quot;&gt;cache&nbsp;type&nbsp;*is*&nbsp;SMP-aware&quot;&nbsp;(&lt;/span&gt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/pipermail/squid-users/2018-October/019410.html&quot;&gt;http://lists.squid-cache.org/pipermail/squid-users/2018-October/019410.html&lt;/a&gt;)&lt;/div&gt;&lt;div&gt;So&nbsp;we&nbsp;switched&nbsp;to&nbsp;a&nbsp;rock&nbsp;cache_dir:&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;cache_dir&nbsp;rock&nbsp;/data/squid/cache&nbsp;32000&nbsp;max-size=12000000&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;everything&nbsp;seems&nbsp;to&nbsp;be&nbsp;working&nbsp;fine&nbsp;in&nbsp;the&nbsp;test&nbsp;environment,&nbsp;but&nbsp;I&nbsp;found&nbsp;limitations&nbsp;on&nbsp;the&nbsp;RockStore&nbsp;(&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/RockStore&quot;&gt;https://wiki.squid-cache.org/Features/RockStore&lt;/a&gt;):&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:rgb(242,242,242);color:rgb(55,55,55);font-family:&quot;Myriad&nbsp;Pro&quot;,Calibri,Helvetica,Arial,sans-serif;font-size:16px&quot;&gt;&quot;Objects&nbsp;larger&nbsp;than&nbsp;32,000&nbsp;bytes&nbsp;cannot&nbsp;be&nbsp;cached&nbsp;when&nbsp;cache_dirs&nbsp;are&nbsp;shared&nbsp;among&nbsp;workers.&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does&nbsp;this&nbsp;mean&nbsp;that RockStore is&nbsp;not&nbsp;suitable&nbsp;for&nbsp;caching&nbsp;large&nbsp;files?&lt;br&gt;&lt;/div&gt;&lt;div&gt;Should&nbsp;I&nbsp;switch&nbsp;back to&nbsp;the&nbsp;UFS&nbsp;and&nbsp;configure&nbsp;24&nbsp;cache_dirs&nbsp;(this&nbsp;will&nbsp;lead&nbsp;to&nbsp;a&nbsp;significant&nbsp;consumption&nbsp;of&nbsp;disk&nbsp;space)?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kind&nbsp;regards,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;Ankor&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
