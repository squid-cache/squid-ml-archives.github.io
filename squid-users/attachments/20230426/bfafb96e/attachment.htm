<tt>
&lt;div&nbsp;dir=&quot;auto&quot;&gt;Thank&nbsp;you&nbsp;very much&nbsp;for&nbsp;you&nbsp;answer&nbsp;and&nbsp;explanation &lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;Yep,&nbsp;I&nbsp;don’t&nbsp;use&nbsp;name&nbsp;“proxy”&nbsp;for&nbsp;annotations,&nbsp;it&nbsp;was&nbsp;just&nbsp;for&nbsp;example&nbsp;only&nbsp;. &lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;Bets&nbsp;regards!&lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;Alexg&lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;auto&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Wed,&nbsp;26&nbsp;Apr&nbsp;2023&nbsp;at&nbsp;18:34,&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-style:solid;padding-left:1ex;border-left-color:rgb(204,204,204)&quot;&gt;On&nbsp;4/26/23&nbsp;08:08,&nbsp;Alexeyяр&nbsp;Gruzdov&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Oh...&nbsp;Looks&nbsp;like&nbsp;I&nbsp;just&nbsp;need&nbsp;to&nbsp;send&nbsp;as&nbsp;answer&nbsp;the&nbsp;list&nbsp;of&nbsp;my&nbsp;policy&nbsp;&lt;br&gt;<br>
&gt;&nbsp;acl,&nbsp;for&nbsp;example&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;user1&nbsp;wanted&nbsp;to&nbsp;go&nbsp;over&nbsp;peer1&nbsp;and&nbsp;peer3&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;answer&nbsp;from&nbsp;external&nbsp;script&nbsp;must&nbsp;be&nbsp;like &nbsp;&quot;OK&nbsp;proxy=peer1&nbsp;&lt;br&gt;<br>
&gt;&nbsp;proxy=peer3&quot; &nbsp;and&nbsp;looks&nbsp;like&nbsp;it&nbsp;works&nbsp;well&nbsp;like&nbsp;I&nbsp;need.&nbsp;User&nbsp;will&nbsp;go&nbsp;&lt;br&gt;<br>
&gt;&nbsp;over&nbsp;peer1&nbsp;and&nbsp;peer3&nbsp;only&nbsp;by&nbsp;round-robin.&lt;br&gt;<br>
&lt;br&gt;<br>
Instead&nbsp;of&nbsp;sending&nbsp;N&nbsp;same-name&nbsp;annotations&nbsp;to&nbsp;Squid,&nbsp;please&nbsp;try&nbsp;sending&nbsp;&lt;br&gt;<br>
one&nbsp;annotation&nbsp;with&nbsp;a&nbsp;coma-separated&nbsp;list&nbsp;of&nbsp;N&nbsp;values:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; proxy=peer1,peer3,peer4&lt;br&gt;<br>
&lt;br&gt;<br>
Rationale:&nbsp;Even&nbsp;if&nbsp;your&nbsp;current&nbsp;N-annotation&nbsp;setup&nbsp;&quot;works&quot;,&nbsp;it&nbsp;is&nbsp;&lt;br&gt;<br>
essentially&nbsp;relying&nbsp;on&nbsp;undefined&nbsp;and/or&nbsp;questionable&nbsp;behavior&nbsp;that&nbsp;may&nbsp;&lt;br&gt;<br>
change.&nbsp;Using&nbsp;N-value&nbsp;annotations,&nbsp;you&nbsp;are&nbsp;avoiding&nbsp;that&nbsp;problem.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;&quot;note&quot;&nbsp;ACL&nbsp;has&nbsp;-m&nbsp;option&nbsp;that&nbsp;tells&nbsp;Squid&nbsp;to&nbsp;interpret&nbsp;the&nbsp;&lt;br&gt;<br>
annotation&nbsp;value&nbsp;as&nbsp;a&nbsp;list:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; acl&nbsp;cleared_for_peer1&nbsp;note&nbsp;-m&nbsp;proxy&nbsp;peer1&lt;br&gt;<br>
 &nbsp; &nbsp; acl&nbsp;cleared_for_peer2&nbsp;note&nbsp;-m&nbsp;proxy&nbsp;peer2&lt;br&gt;<br>
 &nbsp; &nbsp; ...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
And,&nbsp;again,&nbsp;avoid&nbsp;using&nbsp;&quot;proxy&quot;&nbsp;as&nbsp;the&nbsp;annotation&nbsp;name:&nbsp;That&nbsp;name&nbsp;is&nbsp;&lt;br&gt;<br>
currently&nbsp;reserved&nbsp;for&nbsp;Squid&nbsp;own&nbsp;use.&nbsp;Use&nbsp;&quot;proxy_&quot;&nbsp;or&nbsp;any&nbsp;other&nbsp;name&nbsp;&lt;br&gt;<br>
ending&nbsp;with&nbsp;an&nbsp;underscore&nbsp;character.&nbsp;IMO,&nbsp;we&nbsp;should&nbsp;change&nbsp;the&nbsp;&lt;br&gt;<br>
policy/code&nbsp;to&nbsp;be&nbsp;more&nbsp;admin-friendly,&nbsp;but&nbsp;that&nbsp;change&nbsp;may&nbsp;not&nbsp;happen&nbsp;&lt;br&gt;<br>
for&nbsp;a&nbsp;long&nbsp;time,&nbsp;and&nbsp;modern&nbsp;Squids&nbsp;will&nbsp;warn&nbsp;you&nbsp;about&nbsp;reserved&nbsp;names&nbsp;&lt;br&gt;<br>
like&nbsp;&quot;proxy&quot;:&nbsp;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://github.com/squid-cache/squid/commit/27c36771bf145c2f8ca1efab6743b9e087867ab5&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/squid-cache/squid/commit/27c36771bf145c2f8ca1efab6743b9e087867ab5&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;ср,&nbsp;26&nbsp;апр.&nbsp;2023 г.&nbsp;в&nbsp;15:40,&nbsp;Alexeyяр&nbsp;Gruzdov:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Hello!&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Yes!&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Thank&nbsp;you!&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; One&nbsp;more&nbsp;question&nbsp;pls:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; For&nbsp;example&nbsp;I&nbsp;have&nbsp;five&nbsp;of&nbsp;cache_peers&nbsp;and&nbsp;ACL&nbsp;associated &nbsp;with&nbsp;some&lt;br&gt;<br>
&gt; &nbsp; &nbsp; cache&nbsp;peer.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; As&nbsp;you&nbsp;know&nbsp;-&nbsp;I&nbsp;used&nbsp;the&nbsp;my&nbsp;external&nbsp;ACL&nbsp;script&nbsp;and&nbsp;now&nbsp;I&nbsp;can&nbsp;put&lt;br&gt;<br>
&gt; &nbsp; &nbsp; the&nbsp;policy&nbsp;to&nbsp;answer&nbsp;fo&nbsp;my&nbsp;script&nbsp;and&nbsp;squid&nbsp;will&nbsp;get&nbsp;an&nbsp;answer&nbsp;and&lt;br&gt;<br>
&gt; &nbsp; &nbsp; used&nbsp;the&nbsp;correct&nbsp;ACL&nbsp;for&nbsp;username.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; For&nbsp;example&nbsp;answer&nbsp;is &nbsp;&quot;OK &nbsp;proxy=peer1&quot; &nbsp;and&nbsp;user&nbsp;will&nbsp;be&nbsp;used&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; cache_peer1,&nbsp;or&nbsp;if&nbsp;&quot;OK&nbsp;proxy=all&quot;&nbsp;and&nbsp;user&nbsp;will&nbsp;go&nbsp;over&nbsp;all&nbsp;of&lt;br&gt;<br>
&gt; &nbsp; &nbsp; cache_peers&nbsp;by&nbsp;round-robin.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; All&nbsp;works&nbsp;well.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; But&nbsp;how&nbsp;I&nbsp;can&nbsp;put&nbsp;something like&nbsp;a&nbsp;list&nbsp;of&nbsp;ACL&nbsp;for&nbsp;user&nbsp;? &nbsp;for&lt;br&gt;<br>
&gt; &nbsp; &nbsp; example &nbsp;I&nbsp;want&nbsp;that&nbsp;some one&nbsp;user&nbsp;can go&nbsp;over&nbsp;peer1&nbsp;and&nbsp;peer3&nbsp;only,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; by&nbsp;round&nbsp;robin,&nbsp;but&nbsp;will&nbsp;be&nbsp;denied over&nbsp;peer2.&nbsp;peer4,&nbsp;peer5.&nbsp;Of&lt;br&gt;<br>
&gt; &nbsp; &nbsp; course&nbsp;better using&nbsp;external&nbsp;ACL&nbsp;(as&nbsp;DB&nbsp;).&nbsp;What do&nbsp;you&nbsp;think?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; пн,&nbsp;24&nbsp;апр.&nbsp;2023 г.&nbsp;в&nbsp;18:07,&nbsp;Alex&nbsp;Rousskov&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&gt;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; On&nbsp;4/23/23&nbsp;14:28,&nbsp;Alexeyяр&nbsp;Gruzdov&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;One&nbsp;more&nbsp;may&nbsp;be&nbsp;last&nbsp;thing: &nbsp;-&nbsp;I&nbsp;found&nbsp;the&nbsp;strange&nbsp;behavior&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; -&nbsp;if&nbsp;I&nbsp;make&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;changes&nbsp;at&nbsp;my&nbsp;ext&nbsp;ACL&nbsp;script&nbsp;(its&nbsp;python&nbsp;)&nbsp;and&nbsp;then&nbsp;&quot;squid&nbsp;-k&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;reconfigure&quot; &nbsp;then&nbsp;I&nbsp;can&nbsp;see&nbsp;that&nbsp;my&nbsp;script&nbsp;appears in&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &quot;TOP&quot;&nbsp;of&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;process&nbsp;and&nbsp;loads&nbsp;CPU&nbsp;to&nbsp;100%&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Check&nbsp;how&nbsp;your&nbsp;ACL&nbsp;script&nbsp;reacts&nbsp;to&nbsp;stdin&nbsp;closure/EOF.&nbsp;The&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; script&nbsp;should&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; quit&nbsp;but&nbsp;probably&nbsp;does&nbsp;not.&nbsp;Same&nbsp;for&nbsp;any&nbsp;stdin&nbsp;reading&nbsp;errors.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; On&nbsp;EOF,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; the&nbsp;script&nbsp;should&nbsp;use&nbsp;exit&nbsp;code&nbsp;zero.&nbsp;All&nbsp;these&nbsp;things&nbsp;are&nbsp;easy&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; to&nbsp;test&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; on&nbsp;the&nbsp;command&nbsp;line&nbsp;(without&nbsp;Squid).&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Alex.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;вс,&nbsp;23&nbsp;апр.&nbsp;2023 г.&nbsp;в&nbsp;16:36,&nbsp;Amos&nbsp;Jeffries&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid3@treenet.co.nz&quot;&nbsp;target=&quot;_blank&quot;&gt;squid3@treenet.co.nz&lt;/a&gt;&gt;&gt;&gt;:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; On&nbsp;23/04/2023&nbsp;5:27&nbsp;pm,&nbsp;Alexeyяр&nbsp;Gruzdov&nbsp;wrote:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Hello&nbsp;Guys!&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Thank&nbsp;you&nbsp;very&nbsp;much!&nbsp;For&nbsp;now&nbsp;all&nbsp;works&nbsp;like&nbsp;I&nbsp;needed!&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;But&nbsp;I&nbsp;have&nbsp;an&nbsp;one&nbsp;more&nbsp; questions&nbsp;about&nbsp;how&nbsp;I&nbsp;could&nbsp;to&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; use&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; kv-pair:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; ...&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;and&nbsp;then&nbsp;ACL&nbsp;with&nbsp;“note&nbsp;proxy&nbsp;all&nbsp;“&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;But&nbsp;how&nbsp;the&nbsp;kv-pair&nbsp;must&nbsp;to&nbsp;be&nbsp;looked&nbsp;for&nbsp;this&nbsp;my&nbsp;tag&nbsp;?&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;I&nbsp;have&nbsp;tried&nbsp;to&nbsp;get&nbsp;answer&nbsp;from&nbsp;my&nbsp;ext&nbsp;script&nbsp;like&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;“OK”&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;“proxy=all”&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;But&nbsp;looks&nbsp;like&nbsp;it’s&nbsp;not&nbsp;correct&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; This&nbsp;part&nbsp;of&nbsp;the&nbsp;instructions&nbsp;were&nbsp;missed:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/Features/AddonHelpers#helper-protocols&lt;/a&gt;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &quot;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; For&nbsp;every&nbsp;line&nbsp;sent&nbsp;by&nbsp;Squid&nbsp;exactly&nbsp;one&nbsp;line&nbsp;is&nbsp;expected&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; back.&nbsp;Some&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; script&nbsp;language&nbsp;such&nbsp;as&nbsp;perl&nbsp;and&nbsp;python&nbsp;need&nbsp;to&nbsp;be&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; careful&nbsp;about&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; number&nbsp;of&nbsp;newlines&nbsp;in&nbsp;their&nbsp;output.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &quot;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; If&nbsp;your&nbsp;helper&nbsp;received&nbsp;something&nbsp;like&nbsp;this&nbsp;(with&nbsp;concurrency&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; channel-id&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &quot;1&quot;):&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;  &quot;1&nbsp;bob&nbsp;192.0.2.1&quot;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; It&nbsp;should&nbsp;produce&nbsp;a&nbsp;line&nbsp;like:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;  &nbsp;&quot;1&nbsp;OK&nbsp;proxy=all&quot;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; If&nbsp;no&nbsp;concurrency&nbsp;channel-id&nbsp;is&nbsp;received,&nbsp;then&nbsp;output&nbsp;is&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; the&nbsp;same&nbsp;but&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; without&nbsp;sending&nbsp;channel-id&nbsp;back&nbsp;and&nbsp;MUST&nbsp;be&nbsp;sent&nbsp;in&nbsp;same&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; order&nbsp;as&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; received.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; I&nbsp;do&nbsp;recommend&nbsp;using&nbsp;concurrency.&nbsp;It&nbsp;can&nbsp;help&nbsp;further&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; debug&nbsp;issues&nbsp;with&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; helpers&nbsp;responding&nbsp;incorrectly.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; HTH&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; Amos&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; _______________________________________________&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; _______________________________________________&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
