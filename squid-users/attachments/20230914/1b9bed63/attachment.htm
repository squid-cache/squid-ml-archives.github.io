<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-2&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7654.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[squid-users]&nbsp;Squid&nbsp;BUG:&nbsp;assurance&nbsp;failed:&nbsp;tok.skip(WellKnownUrlPathPrefix())&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Wow&nbsp;-&nbsp;Alex&nbsp;now&nbsp;even&nbsp;the&nbsp;old&nbsp;cachemgr.cgi&nbsp;works&nbsp;:-]&nbsp;client&nbsp;v4.6&nbsp;also&nbsp;works&lt;BR&gt;<br>
&lt;BR&gt;<br>
But&nbsp;-&nbsp;could&nbsp;someone&nbsp;(or&nbsp;you)&nbsp;clarify&nbsp;the&nbsp;next&nbsp;one&nbsp;for&nbsp;me?&nbsp;I've&nbsp;read&nbsp;some&nbsp;questions&nbsp;about&nbsp;the&nbsp;&quot;new&quot;&nbsp;cachemgr.cgi&nbsp;and&nbsp;the&nbsp;MGR_INDEX&nbsp;template.&nbsp;Without&nbsp;this&nbsp;file&nbsp;the&nbsp;only&nbsp;output&nbsp;which&nbsp;the&nbsp;cmgr.cgi&nbsp;produces&nbsp;is&nbsp;&quot;Internal&nbsp;Error:&nbsp;Missing&nbsp;Template&nbsp;MGR_INDEX&quot;.&nbsp;But&nbsp;if&nbsp;I&nbsp;put&nbsp;content&nbsp;from&nbsp;MGR_INDEX&nbsp;from&nbsp;&lt;A&nbsp;HREF=&quot;https://github.com/yadij/cachemgr.js/&quot;&gt;https://github.com/yadij/cachemgr.js/&lt;/A&gt;&nbsp;it&nbsp;gives&nbsp;me&nbsp;(Apache/2.4.38&nbsp;Debian)&lt;BR&gt;<br>
&lt;BR&gt;<br>
[Wed&nbsp;Sep&nbsp;13&nbsp;05:57:57.902368&nbsp;2023]&nbsp;[cgid:error]&nbsp;[pid&nbsp;22501:tid&nbsp;140478824113920]&nbsp;[client&nbsp;192.168.xx.xx:24201]&nbsp;End&nbsp;of&nbsp;script&nbsp;output&nbsp;before&nbsp;headers:&nbsp;cachemgr.cgi,&nbsp;referer:&nbsp;&lt;A&nbsp;HREF=&quot;http://squid_IP/cgi-bin/cachemgr.cgi&quot;&gt;http://squid_IP/cgi-bin/cachemgr.cgi&lt;/A&gt;&lt;BR&gt;<br>
assertion&nbsp;failed:&nbsp;MemBuf.cc:211:&nbsp;&quot;sz&nbsp;&gt;=&nbsp;0&quot;&lt;BR&gt;<br>
&lt;BR&gt;<br>
(line&nbsp;211&nbsp;is&nbsp;in&nbsp;the&nbsp;function&nbsp;MemBuf::Append)&lt;BR&gt;<br>
&lt;BR&gt;<br>
But&nbsp;if&nbsp;I&nbsp;put&nbsp;only&nbsp;some&nbsp;text&nbsp;in&nbsp;the&nbsp;MGR_INDEX&nbsp;file&nbsp;(something&nbsp;like&nbsp;&lt;p&gt;Test&nbsp;bla&nbsp;bla&lt;/p&gt;)&nbsp;it&nbsp;renders&lt;BR&gt;<br>
&lt;BR&gt;<br>
Cache&nbsp;Manager&nbsp;menu&nbsp;for&nbsp;localhost:&lt;BR&gt;<br>
Test&nbsp;bla&nbsp;bla&lt;BR&gt;<br>
&lt;BR&gt;<br>
Generated&nbsp;Thu,&nbsp;14&nbsp;Sep&nbsp;2023&nbsp;10:16:11&nbsp;GMT,&nbsp;by&nbsp;cachemgr.cgi/6.3-20230903-ra9c06aa6a@proxy&lt;BR&gt;<br>
&lt;BR&gt;<br>
Have&nbsp;not&nbsp;found&nbsp;any&nbsp;info&nbsp;about&nbsp;substitutions&nbsp;(eq.&nbsp;like&nbsp;in&nbsp;the&nbsp;ERR&nbsp;files)&nbsp;or&nbsp;something.&nbsp;I&nbsp;thought&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;MGR_INDEX&nbsp;file&nbsp;cachemgr.cgi&nbsp;should&nbsp;work&nbsp;as&nbsp;the&nbsp;old&nbsp;one&nbsp;-&nbsp;and&nbsp;MGR_INDEX&nbsp;is&nbsp;only&nbsp;used&nbsp;while&nbsp;I&nbsp;need&nbsp;some&nbsp;customization&nbsp;or&nbsp;my&nbsp;own&nbsp;design/functions.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
Besides&nbsp;that&nbsp;I&nbsp;have&nbsp;found&nbsp;out&nbsp;that&nbsp;every&nbsp;time&nbsp;I&nbsp;shutdown&nbsp;squid&nbsp;with&nbsp;start-stop-daemon&nbsp;it&nbsp;coredumps.&nbsp;Frankly&nbsp;-&nbsp;I&nbsp;do&nbsp;not&nbsp;have&nbsp;capacity&nbsp;to&nbsp;go&nbsp;through&nbsp;these.&lt;BR&gt;<br>
&lt;BR&gt;<br>
ep&nbsp;14&nbsp;11:55:13&nbsp;proxy&nbsp;squid[23984]:&nbsp;Squid&nbsp;Parent:&nbsp;squid-4&nbsp;process&nbsp;23990&nbsp;exited&nbsp;due&nbsp;to&nbsp;signal&nbsp;6&nbsp;with&nbsp;status&nbsp;0&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:55:15&nbsp;proxy&nbsp;squid[23984]:&nbsp;Squid&nbsp;Parent:&nbsp;squid-1&nbsp;process&nbsp;23993&nbsp;exited&nbsp;due&nbsp;to&nbsp;signal&nbsp;6&nbsp;with&nbsp;status&nbsp;0&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:55:47&nbsp;proxy&nbsp;squid[23984]:&nbsp;Squid&nbsp;Parent:&nbsp;squid-3&nbsp;process&nbsp;23991&nbsp;exited&nbsp;due&nbsp;to&nbsp;signal&nbsp;6&nbsp;with&nbsp;status&nbsp;0&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:55:48&nbsp;proxy&nbsp;squid[23984]:&nbsp;Squid&nbsp;Parent:&nbsp;squid-2&nbsp;process&nbsp;23992&nbsp;exited&nbsp;due&nbsp;to&nbsp;signal&nbsp;6&nbsp;with&nbsp;status&nbsp;0&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:18&nbsp;proxy&nbsp;systemd-coredump[3679]:&nbsp;Process&nbsp;23990&nbsp;(squid)&nbsp;of&nbsp;user&nbsp;13&nbsp;dumped&nbsp;core.#012#012Stack&nbsp;trace&nbsp;of&nbsp;thread&nbsp;23990:&lt;BR&gt;<br>
#012#0&nbsp;&nbsp;0x00007f35c21ab8eb&nbsp;__GI_raise&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#1&nbsp;&nbsp;0x00007f35c2196535&nbsp;__GI_abort&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#2&nbsp;&nbsp;0x000055c7eca80694&nbsp;xassert&nbsp;(squid)&lt;BR&gt;<br>
#012#3&nbsp;&nbsp;0x000055c7ecb23c7c&nbsp;_ZN5Store4RootEv&nbsp;(squid)&lt;BR&gt;<br>
#012#4&nbsp;&nbsp;0x000055c7ec8805af&nbsp;_ZN10StoreEntry16destroyMemObjectEv&nbsp;(squid)&lt;BR&gt;<br>
#012#5&nbsp;&nbsp;0x000055c7ec8811f6&nbsp;_Z17destroyStoreEntryPv&nbsp;(squid)&lt;BR&gt;<br>
#012#6&nbsp;&nbsp;0x000055c7ecb2d3eb&nbsp;hashFreeItems&nbsp;(squid)&lt;BR&gt;<br>
#012#7&nbsp;&nbsp;0x000055c7ecb1fe4a&nbsp;_ZN5Store10ControllerD1Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#8&nbsp;&nbsp;0x000055c7ecb1fec9&nbsp;_ZN5Store10ControllerD0Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#9&nbsp;&nbsp;0x00007f35c21adebc&nbsp;__run_exit_handlers&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#10&nbsp;0x00007f35c21adfea&nbsp;__GI_exit&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#11&nbsp;0x000055c7ec847ce3&nbsp;SquidShutdown&nbsp;(squid)&lt;BR&gt;<br>
#012#12&nbsp;0x000055c7ec6f0cf1&nbsp;SquidMainSafe&nbsp;(squid)&lt;BR&gt;<br>
#012#13&nbsp;0x00007f35c219809b&nbsp;__libc_start_main&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#14&nbsp;0x000055c7ec6fa71a&nbsp;_start&nbsp;(squid)&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:18&nbsp;proxy&nbsp;systemd-coredump[3681]:&nbsp;Process&nbsp;23993&nbsp;(squid)&nbsp;of&nbsp;user&nbsp;13&nbsp;dumped&nbsp;core.&lt;BR&gt;<br>
#012#012Stack&nbsp;trace&nbsp;of&nbsp;thread&nbsp;23993:&lt;BR&gt;<br>
#012#0&nbsp;&nbsp;0x00007f169c64c8eb&nbsp;__GI_raise&nbsp;(libc.so.6)#012#1&nbsp;&nbsp;0x00007f169c637535&nbsp;__GI_abort&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#2&nbsp;&nbsp;0x0000557ee57ab694&nbsp;xassert&nbsp;(squid)&lt;BR&gt;<br>
#012#3&nbsp;&nbsp;0x0000557ee584ec7c&nbsp;_ZN5Store4RootEv&nbsp;(squid)&lt;BR&gt;<br>
#012#4&nbsp;&nbsp;0x0000557ee55ab5af&nbsp;_ZN10StoreEntry16destroyMemObjectEv&nbsp;(squid)&lt;BR&gt;<br>
#012#5&nbsp;&nbsp;0x0000557ee55ac1f6&nbsp;_Z17destroyStoreEntryPv&nbsp;(squid)&lt;BR&gt;<br>
#012#6&nbsp;&nbsp;0x0000557ee58583eb&nbsp;hashFreeItems&nbsp;(squid)&lt;BR&gt;<br>
#012#7&nbsp;&nbsp;0x0000557ee584ae4a&nbsp;_ZN5Store10ControllerD1Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#8&nbsp;&nbsp;0x0000557ee584aec9&nbsp;_ZN5Store10ControllerD0Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#9&nbsp;&nbsp;0x00007f169c64eebc&nbsp;__run_exit_handlers&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#10&nbsp;0x00007f169c64efea&nbsp;__GI_exit&nbsp;(libc.so.6)#012#11&nbsp;0x0000557ee5572ce3&nbsp;SquidShutdown&nbsp;(squid)&lt;BR&gt;<br>
#012#12&nbsp;0x0000557ee541bcf1&nbsp;SquidMainSafe&nbsp;(squid)&lt;BR&gt;<br>
#012#13&nbsp;0x00007f169c63909b&nbsp;__libc_start_main&nbsp;(libc.so.6)#012#14&nbsp;0x0000557ee542571a&nbsp;_start&nbsp;(squid)&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:18&nbsp;proxy&nbsp;systemd[1]:&nbsp;systemd-coredump@60-3678-0.service:&nbsp;Succeeded.&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:18&nbsp;proxy&nbsp;systemd[1]:&nbsp;systemd-coredump@61-3680-0.service:&nbsp;Succeeded.&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:42&nbsp;proxy&nbsp;systemd-coredump[3688]:&nbsp;Process&nbsp;23992&nbsp;(squid)&nbsp;of&nbsp;user&nbsp;13&nbsp;dumped&nbsp;core.&lt;BR&gt;<br>
#012#012Stack&nbsp;trace&nbsp;of&nbsp;thread&nbsp;23992:#012&lt;BR&gt;<br>
#0&nbsp;&nbsp;0x00007fa6a64568eb&nbsp;__GI_raise&nbsp;(libc.so.6&lt;BR&gt;<br>
#012#1&nbsp;&nbsp;0x00007fa6a6441535&nbsp;__GI_abort&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#2&nbsp;&nbsp;0x000055bde67df694&nbsp;xassert&nbsp;(squid)&lt;BR&gt;<br>
#012#3&nbsp;&nbsp;0x000055bde6882c7c&nbsp;_ZN5Store4RootEv&nbsp;(squid)&lt;BR&gt;<br>
#012#4&nbsp;&nbsp;0x000055bde65df5af&nbsp;_ZN10StoreEntry16destroyMemObjectEv&nbsp;(squid)&lt;BR&gt;<br>
#012#5&nbsp;&nbsp;0x000055bde65e01f6&nbsp;_Z17destroyStoreEntryPv&nbsp;(squid)&lt;BR&gt;<br>
#012#6&nbsp;&nbsp;0x000055bde688c3eb&nbsp;hashFreeItems&nbsp;(squid)&lt;BR&gt;<br>
#012#7&nbsp;&nbsp;0x000055bde687ee4a&nbsp;_ZN5Store10ControllerD1Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#8&nbsp;&nbsp;0x000055bde687eec9&nbsp;_ZN5Store10ControllerD0Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#9&nbsp;&nbsp;0x00007fa6a6458ebc&nbsp;__run_exit_handlers&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#10&nbsp;0x00007fa6a6458fea&nbsp;__GI_exit&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#11&nbsp;0x000055bde65a6ce3&nbsp;SquidShutdown&nbsp;(squid)&lt;BR&gt;<br>
#012#12&nbsp;0x000055bde644fcf1&nbsp;SquidMainSafe&nbsp;(squid)&lt;BR&gt;<br>
#012#13&nbsp;0x00007fa6a644309b&nbsp;__libc_start_main&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#14&nbsp;0x000055bde645971a&nbsp;_start&nbsp;(squid)&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:43&nbsp;proxy&nbsp;systemd[1]:&nbsp;systemd-coredump@62-3685-0.service:&nbsp;Succeeded.&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:56&nbsp;proxy&nbsp;systemd-coredump[3677]:&nbsp;Process&nbsp;23991&nbsp;(squid)&nbsp;of&nbsp;user&nbsp;13&nbsp;dumped&nbsp;core.&lt;BR&gt;<br>
#012#012Stack&nbsp;trace&nbsp;of&nbsp;thread&nbsp;23991:&lt;BR&gt;<br>
#012#0&nbsp;&nbsp;0x00007fbe358dd8eb&nbsp;__GI_raise&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#1&nbsp;&nbsp;0x00007fbe358c8535&nbsp;__GI_abort&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#2&nbsp;&nbsp;0x00005642b5ae8694&nbsp;xassert&nbsp;(squid)&lt;BR&gt;<br>
#012#3&nbsp;&nbsp;0x00005642b5b8bc7c&nbsp;_ZN5Store4RootEv&nbsp;(squid)&lt;BR&gt;<br>
#012#4&nbsp;&nbsp;0x00005642b58e85af&nbsp;_ZN10StoreEntry16destroyMemObjectEv&nbsp;(squid)&lt;BR&gt;<br>
#012#5&nbsp;&nbsp;0x00005642b58e91f6&nbsp;_Z17destroyStoreEntryPv&nbsp;(squid)&lt;BR&gt;<br>
#012#6&nbsp;&nbsp;0x00005642b5b953eb&nbsp;hashFreeItems&nbsp;(squid)&lt;BR&gt;<br>
#012#7&nbsp;&nbsp;0x00005642b5b87e4a&nbsp;_ZN5Store10ControllerD1Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#8&nbsp;&nbsp;0x00005642b5b87ec9&nbsp;_ZN5Store10ControllerD0Ev&nbsp;(squid)&lt;BR&gt;<br>
#012#9&nbsp;&nbsp;0x00007fbe358dfebc&nbsp;__run_exit_handlers&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#10&nbsp;0x00007fbe358dffea&nbsp;__GI_exit&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#11&nbsp;0x00005642b58afce3&nbsp;SquidShutdown&nbsp;(squid)&lt;BR&gt;<br>
#012#12&nbsp;0x00005642b5758cf1&nbsp;SquidMainSafe&nbsp;(squid)&lt;BR&gt;<br>
#012#13&nbsp;0x00007fbe358ca09b&nbsp;__libc_start_main&nbsp;(libc.so.6)&lt;BR&gt;<br>
#012#14&nbsp;0x00005642b576271a&nbsp;_start&nbsp;(squid)&lt;BR&gt;<br>
Sep&nbsp;14&nbsp;11:56:57&nbsp;proxy&nbsp;systemd[1]:&nbsp;systemd-coredump@59-3676-0.service:&nbsp;Succeeded.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
Maybe&nbsp;something&nbsp;with&nbsp;my&nbsp;(rock)&nbsp;storage&nbsp;closing?&lt;BR&gt;<br>
THX&lt;BR&gt;<br>
LL&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
-----Pùvodní&nbsp;zpráva-----&lt;BR&gt;<br>
Od:&nbsp;squid-users&nbsp;za&nbsp;u¾ivatele&nbsp;Alex&nbsp;Rousskov&lt;BR&gt;<br>
Odesláno:&nbsp;st&nbsp;13.9.2023&nbsp;20:53&lt;BR&gt;<br>
Komu:&nbsp;squid-users@lists.squid-cache.org&lt;BR&gt;<br>
Pøedmìt:&nbsp;Re:&nbsp;[squid-users]&nbsp;Squid&nbsp;BUG:&nbsp;assurance&nbsp;failed:&nbsp;tok.skip(WellKnownUrlPathPrefix())&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;2023-09-12&nbsp;15:50,&nbsp;Louèanský&nbsp;Luká¹&nbsp;wrote:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;&nbsp;2023/09/12&nbsp;19:12:03&nbsp;kid4|&nbsp;ERROR:&nbsp;Squid&nbsp;BUG:&nbsp;assurance&nbsp;failed:&lt;BR&gt;<br>
&gt;&nbsp;tok.skip(WellKnownUrlPathPrefix())&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;&nbsp;Request:&lt;BR&gt;<br>
&gt;&nbsp;GET&nbsp;cache_object://squid_ip/info&nbsp;HTTP/1.0&lt;BR&gt;<br>
&gt;&nbsp;Host:&nbsp;squid_ip&lt;BR&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;squidclient/4.6&lt;BR&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;BR&gt;<br>
&gt;&nbsp;Connection:&nbsp;close&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thank&nbsp;you&nbsp;for&nbsp;sharing&nbsp;this&nbsp;detail.&nbsp;I&nbsp;can&nbsp;now&nbsp;reproduce&nbsp;this&nbsp;problem.&lt;BR&gt;<br>
&lt;BR&gt;<br>
You&nbsp;are&nbsp;suffering&nbsp;from&nbsp;a&nbsp;bug&nbsp;in&nbsp;Squid&nbsp;v6.3&nbsp;commit&nbsp;6695897&nbsp;(which&nbsp;was&lt;BR&gt;<br>
incorrectly&nbsp;attributed&nbsp;to&nbsp;me).&nbsp;Until&nbsp;that&nbsp;bug&nbsp;is&nbsp;addressed,&nbsp;cache&lt;BR&gt;<br>
manager&nbsp;requests&nbsp;using&nbsp;the&nbsp;deprecated&nbsp;cache_object&nbsp;scheme&nbsp;(e.g.,&nbsp;those&lt;BR&gt;<br>
emitted&nbsp;by&nbsp;older&nbsp;squidclients)&nbsp;will&nbsp;trigger&nbsp;the&nbsp;above&lt;BR&gt;<br>
WellKnownUrlPathPrefix&nbsp;assertion&nbsp;in&nbsp;Squid&nbsp;v6.3.&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;have&nbsp;attached&nbsp;a&nbsp;patch&nbsp;that&nbsp;fixes&nbsp;this&nbsp;v6.3&nbsp;bug&nbsp;in&nbsp;my&nbsp;tests.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;&nbsp;Sending&nbsp;HTTP&nbsp;request&nbsp;...&lt;BR&gt;<br>
&gt;&nbsp;done.&lt;BR&gt;<br>
&gt;&nbsp;HTTP/1.1&nbsp;404&nbsp;Not&nbsp;Found&lt;BR&gt;<br>
&gt;&nbsp;Server:&nbsp;squid&lt;BR&gt;<br>
&gt;&nbsp;Mime-Version:&nbsp;1.0&lt;BR&gt;<br>
&gt;&nbsp;Date:&nbsp;Tue,&nbsp;12&nbsp;Sep&nbsp;2023&nbsp;19:09:41&nbsp;GMT&lt;BR&gt;<br>
&gt;&nbsp;Content-Type:&nbsp;text/html;charset=utf-8&lt;BR&gt;<br>
&gt;&nbsp;Content-Length:&nbsp;13057&lt;BR&gt;<br>
&gt;&nbsp;X-Squid-Error:&nbsp;ERR_INVALID_URL&nbsp;0&lt;BR&gt;<br>
&gt;&nbsp;Cache-Status:&nbsp;proxy;detail=no-cache&lt;BR&gt;<br>
&gt;&nbsp;Via:&nbsp;1.1&nbsp;proxy&nbsp;(squid)&lt;BR&gt;<br>
&gt;&nbsp;Connection:&nbsp;close&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;This&nbsp;is&nbsp;obviously&nbsp;calling&nbsp;for&nbsp;url&nbsp;cache_object://squid_ip/info&nbsp;which&nbsp;I&lt;BR&gt;<br>
&gt;&nbsp;think&nbsp;is&nbsp;obsolete.&nbsp;Now&nbsp;I&nbsp;went&nbsp;with&nbsp;the&nbsp;new&nbsp;squidclient:&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;./squidclient&nbsp;-h&nbsp;squid_ip&nbsp;-p&nbsp;squid_port&nbsp;-vv&nbsp;mgr:info&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;Request:&lt;BR&gt;<br>
&gt;&nbsp;GET&nbsp;&lt;A&nbsp;HREF=&quot;http://squid_ip:squid_port/squid-internal-mgr/info&quot;&gt;http://squid_ip:squid_port/squid-internal-mgr/info&lt;/A&gt;&nbsp;HTTP/1.0&lt;BR&gt;<br>
&gt;&nbsp;Host:&nbsp;10.50.1.5:3127&lt;BR&gt;<br>
&gt;&nbsp;User-Agent:&nbsp;squidclient/6.3&lt;BR&gt;<br>
&gt;&nbsp;Accept:&nbsp;*/*&lt;BR&gt;<br>
&gt;&nbsp;Connection:&nbsp;close&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;&nbsp;But&nbsp;it&nbsp;seems&nbsp;squid&nbsp;is&nbsp;then&nbsp;trying&nbsp;to&nbsp;open&nbsp;it's&lt;BR&gt;<br>
&gt;&nbsp;visible_hostname:squid_port/squid-internal-mgr/&nbsp;and&nbsp;due&nbsp;my&nbsp;DNS&nbsp;setting&lt;BR&gt;<br>
&gt;&nbsp;it&nbsp;is&nbsp;its&nbsp;WAN&nbsp;IP&nbsp;-&nbsp;so&nbsp;it's&nbsp;connecting&nbsp;to&nbsp;its&nbsp;outside&nbsp;IP&nbsp;with&nbsp;its&nbsp;outside&lt;BR&gt;<br>
&gt;&nbsp;IP&nbsp;which&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;http_access&nbsp;manager&nbsp;allow&nbsp;list&nbsp;(now&nbsp;it&nbsp;is&nbsp;and&nbsp;the&lt;BR&gt;<br>
&gt;&nbsp;newer&nbsp;squidclient&nbsp;works).&lt;BR&gt;<br>
&lt;BR&gt;<br>
You&nbsp;are&nbsp;in&nbsp;Squid&nbsp;Bug&nbsp;5283&nbsp;territory&nbsp;here:&lt;BR&gt;<br>
&lt;A&nbsp;HREF=&quot;https://bugs.squid-cache.org/show_bug.cgi?id=5283&quot;&gt;https://bugs.squid-cache.org/show_bug.cgi?id=5283&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
In&nbsp;a&nbsp;Linux&nbsp;test&nbsp;environment,&nbsp;I&nbsp;can&nbsp;work&nbsp;around&nbsp;those&nbsp;&quot;outside&nbsp;IP&quot;&lt;BR&gt;<br>
problems&nbsp;by&nbsp;adding&nbsp;&quot;-l&nbsp;127.0.0.1&quot;&nbsp;option&nbsp;to&nbsp;squidclient,&nbsp;forcing&lt;BR&gt;<br>
squidclient&nbsp;to&nbsp;connect&nbsp;to&nbsp;Squid&nbsp;from&nbsp;the&nbsp;loopback&nbsp;address.&nbsp;IIRC,&nbsp;that&lt;BR&gt;<br>
&quot;-l&quot;&nbsp;trick&nbsp;does&nbsp;not&nbsp;work&nbsp;in&nbsp;environments&nbsp;that&nbsp;do&nbsp;not&nbsp;support&lt;BR&gt;<br>
from-localhost&nbsp;connections&nbsp;to&nbsp;&quot;outside&nbsp;IPs&quot;&nbsp;on&nbsp;the&nbsp;same&nbsp;box&nbsp;(e.g.,&nbsp;Windows).&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
HTH,&lt;BR&gt;<br>
&lt;BR&gt;<br>
Alex.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&gt;&nbsp;-----Pùvodní&nbsp;zpráva-----&lt;BR&gt;<br>
&gt;&nbsp;Od:&nbsp;squid-users&nbsp;za&nbsp;u¾ivatele&nbsp;Alex&nbsp;Rousskov&lt;BR&gt;<br>
&gt;&nbsp;Odesláno:&nbsp;út&nbsp;12.9.2023&nbsp;19:28&lt;BR&gt;<br>
&gt;&nbsp;Komu:&nbsp;squid-users@lists.squid-cache.org&lt;BR&gt;<br>
&gt;&nbsp;Pøedmìt:&nbsp;Re:&nbsp;[squid-users]&nbsp;Squid&nbsp;BUG:&nbsp;assurance&nbsp;failed:&lt;BR&gt;<br>
&gt;&nbsp;tok.skip(WellKnownUrlPathPrefix())&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;On&nbsp;2023-09-12&nbsp;13:06,&nbsp;Louèanský&nbsp;Luká¹&nbsp;wrote:&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;Is&nbsp;this&nbsp;anyhow&nbsp;interesting?&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;Not&nbsp;really,&nbsp;IMO&nbsp;--&nbsp;the&nbsp;problem&nbsp;happens&nbsp;earlier.&nbsp;I&nbsp;can&nbsp;confirm&nbsp;that&nbsp;you&lt;BR&gt;<br>
&gt;&nbsp;are&nbsp;running&nbsp;v6.3-based&nbsp;code.&nbsp;Let's&nbsp;call&nbsp;that&nbsp;progress&nbsp;:-).&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;Can&nbsp;you&nbsp;share&nbsp;the&nbsp;a&nbsp;_pointer_&nbsp;to&nbsp;a&nbsp;compressed&nbsp;ALL,9&nbsp;cache.log&nbsp;file&nbsp;while&lt;BR&gt;<br>
&gt;&nbsp;reproducing&nbsp;the&nbsp;problem&nbsp;using&nbsp;a&nbsp;single&nbsp;transaction?&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;&lt;A&nbsp;HREF=&quot;https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction&quot;&gt;https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction&lt;/A&gt;&nbsp;&lt;&lt;A&nbsp;HREF=&quot;https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction&quot;&gt;https://wiki.squid-cache.org/SquidFaq/BugReporting#debugging-a-single-transaction&lt;/A&gt;&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;Alex.&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(30)&nbsp;SBuf:&nbsp;SBuf15514952&lt;BR&gt;<br>
&gt;&nbsp;created&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(30)&nbsp;SBuf:&nbsp;SBuf15514953&lt;BR&gt;<br>
&gt;&nbsp;created&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(30)&nbsp;SBuf:&nbsp;SBuf15514954&lt;BR&gt;<br>
&gt;&nbsp;created&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,7|&nbsp;SBuf.cc(85)&nbsp;assign:&nbsp;assigning&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;SBuf15514952&nbsp;from&nbsp;SBuf15514912&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(38)&nbsp;SBuf:&nbsp;SBuf15514955&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;created&nbsp;from&nbsp;id&nbsp;SBuf15514915&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(445)&nbsp;startsWith:&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;SBuf15514955&nbsp;startsWith&nbsp;SBuf125812,&nbsp;caseSensitive:&nbsp;0&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(447)&nbsp;startsWith:&nbsp;no,&nbsp;too&lt;BR&gt;<br>
&gt;&nbsp;short&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.267&nbsp;kid4|&nbsp;24,8|&nbsp;Tokenizer.cc(185)&nbsp;skip:&nbsp;no&nbsp;match,&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;not&nbsp;skipping&nbsp;'/squid-internal-mgr/'&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04&nbsp;kid4|&nbsp;ERROR:&nbsp;Squid&nbsp;BUG:&nbsp;assurance&nbsp;failed:&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;tok.skip(WellKnownUrlPathPrefix())&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;2023/09/12&nbsp;18:47:04.268&nbsp;kid4|&nbsp;24,8|&nbsp;SBuf.cc(70)&nbsp;~SBuf:&nbsp;SBuf15514955&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;destructed&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;BTW&nbsp;debug&nbsp;24,9&nbsp;makes&nbsp;pretty&nbsp;big&nbsp;log&nbsp;files...&nbsp;:-)&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&nbsp;L&lt;BR&gt;<br>
&gt;&nbsp;&nbsp;&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&lt;BR&gt;<br>
&gt;&nbsp;_______________________________________________&lt;BR&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
&gt;&nbsp;squid-users@lists.squid-cache.org&lt;BR&gt;<br>
&gt;&nbsp;&lt;A&nbsp;HREF=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
