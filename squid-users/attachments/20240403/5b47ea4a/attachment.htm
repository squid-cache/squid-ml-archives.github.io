<tt>
&lt;!DOCTYPE&nbsp;html&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Hello,&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;this&nbsp;has&nbsp;recently&nbsp;started&nbsp;me&nbsp;up&nbsp;more&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;it&nbsp;go.&nbsp;For&nbsp;a&nbsp;while&nbsp;chrome&nbsp;is&nbsp;upgrading&nbsp;in-page&nbsp;links&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https.&nbsp;It&nbsp;is&nbsp;supposed&nbsp;to&nbsp;work&nbsp;something&nbsp;like<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.bleepingcomputer.com/news/google/google-chrome-now-auto-upgrades-to-secure-connections-for-all-users/&quot;&gt;https://www.bleepingcomputer.com/news/google/google-chrome-now-auto-upgrades-to-secure-connections-for-all-users/&lt;/a&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;But&nbsp;there&nbsp;is&nbsp;a&nbsp;catch&nbsp;for&nbsp;me&nbsp;-&nbsp;my&nbsp;squid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;something&nbsp;like:&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;(104)&nbsp;Connection&nbsp;reset&nbsp;by&nbsp;peer&nbsp;(TLS&nbsp;code:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Failed&nbsp;to&nbsp;establish&nbsp;a&nbsp;secure&nbsp;connection:&nbsp;[No&nbsp;Error]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;or&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;[No&nbsp;Error]&nbsp;(TLS&nbsp;code:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_LIB_ERR=1408F10B+TLS_IO_ERR=1)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Failed&nbsp;to&nbsp;establish&nbsp;a&nbsp;secure&nbsp;connection:&nbsp;error:1408F10B:SSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routines:ssl3_get_record:wrong&nbsp;version&nbsp;number&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;to&nbsp;the&nbsp;user&nbsp;-&nbsp;via&nbsp;error&nbsp;page&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Log&nbsp;file:&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;1712122364.809  &nbsp;1172&nbsp;10.0.0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NONE_NONE_ABORTED/000&nbsp;0&nbsp;CONNECT&nbsp;46.255.231.158:443&nbsp;-&nbsp;HIER_NONE/-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;SNI&nbsp;redir.netcentrum.cz&nbsp;BumpMode&nbsp;peek&nbsp;-&nbsp;-&nbsp;-&nbsp;ServerNegoTLS&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerRecTLS&nbsp;-&nbsp;ServerRecVer&nbsp;-&nbsp;ServerNegCiph&nbsp;-&nbsp;Error:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1712122366.296    &nbsp;23&nbsp;10.0.0.1&nbsp;NONE_NONE_ABORTED/000&nbsp;0&nbsp;CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46.255.231.158:443&nbsp;-&nbsp;HIER_NONE/-&nbsp;-&nbsp;SNI&nbsp;redir.netcentrum.cz<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BumpMode&nbsp;peek&nbsp;-&nbsp;-&nbsp;-&nbsp;ServerNegoTLS&nbsp;-&nbsp;ServerRecTLS&nbsp;-&nbsp;ServerRecVer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;ServerNegCiph&nbsp;-&nbsp;Error:&nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1712122366.293    &nbsp;21&nbsp;10.0.0.1&nbsp;NONE_NONE_ABORTED/000&nbsp;0&nbsp;CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46.255.231.158:443&nbsp;-&nbsp;HIER_NONE/-&nbsp;-&nbsp;SNI&nbsp;redir.netcentrum.cz<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BumpMode&nbsp;peek&nbsp;-&nbsp;-&nbsp;-&nbsp;ServerNegoTLS&nbsp;-&nbsp;ServerRecTLS&nbsp;-&nbsp;ServerRecVer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;ServerNegCiph&nbsp;-&nbsp;Error:&nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1712122367.111    &nbsp;20&nbsp;10.0.0.1&nbsp;NONE_NONE_ABORTED/000&nbsp;0&nbsp;CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46.255.231.158:443&nbsp;-&nbsp;HIER_NONE/-&nbsp;-&nbsp;SNI&nbsp;redir.netcentrum.cz<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BumpMode&nbsp;peek&nbsp;-&nbsp;-&nbsp;-&nbsp;ServerNegoTLS&nbsp;-&nbsp;ServerRecTLS&nbsp;-&nbsp;ServerRecVer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;ServerNegCiph&nbsp;-&nbsp;Error:&nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1712122367.114    &nbsp;21&nbsp;10.0.0.1&nbsp;NONE_NONE_ABORTED/000&nbsp;0&nbsp;CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46.255.231.158:443&nbsp;-&nbsp;HIER_NONE/-&nbsp;-&nbsp;SNI&nbsp;redir.netcentrum.cz<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BumpMode&nbsp;peek&nbsp;-&nbsp;-&nbsp;-&nbsp;ServerNegoTLS&nbsp;-&nbsp;ServerRecTLS&nbsp;-&nbsp;ServerRecVer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;ServerNegCiph&nbsp;-&nbsp;Error:&nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;In&nbsp;fact&nbsp;-&nbsp;this&nbsp;seems&nbsp;to&nbsp;be&nbsp;http&nbsp;only&nbsp;sites<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;like&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.ssllabs.com/ssltest/analyze.html?d=www.jarovnet.org&quot;&gt;https://www.ssllabs.com/ssltest/analyze.html?d=www.jarovnet.org&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.ssllabs.com/ssltest/analyze.html?d=redir.netcentrum.cz&amp;s=46.255.231.158&amp;latest&quot;&gt;https://www.ssllabs.com/ssltest/analyze.html?d=redir.netcentrum.cz&amp;s=46.255.231.158&amp;latest&lt;/a&gt;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;this&nbsp;snapshot&nbsp;from&nbsp;centrum&nbsp;web&nbsp;mail&nbsp;page&nbsp;source&nbsp;code&nbsp;&quot;Více<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;informací&nbsp;o&nbsp;tomto&nbsp;zapezpečení&nbsp;naleznete&nbsp;v&nbsp;&lt;a<br>
href=&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;http://napoveda.centrum.cz/index.php?/Knowledgebase/Article/View/18/1/&quot;&gt;&quot;http://napoveda.centrum.cz/index.php?/Knowledgebase/Article/View/18/1/&quot;&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;So&nbsp;-&nbsp;what&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be&nbsp;happening&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chrome&nbsp;should&nbsp;fallback&nbsp;to&nbsp;http&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;problem&nbsp;with&nbsp;https<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;i&nbsp;think&nbsp;the&nbsp;most&nbsp;obvious&nbsp;reason&nbsp;to&nbsp;fall&nbsp;back&nbsp;would&nbsp;be&nbsp;no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;at&nbsp;all.&nbsp;So&nbsp;I&nbsp;think&nbsp;my&nbsp;effort&nbsp;should&nbsp;target&nbsp;the&nbsp;situation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;squid&nbsp;says &nbsp;ERR_SECURE_CONNECT_FAIL&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQUID_TLS_ERR_CONNECT+TLS_IO_ERR=5+errno=104&nbsp;and&nbsp;to&nbsp;remain<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;silent&nbsp;to&nbsp;the&nbsp;client.&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;do&nbsp;it&nbsp;-&nbsp;ie.&nbsp;do&nbsp;not&nbsp;show<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;page&nbsp;for&nbsp;not&nbsp;able&nbsp;to&nbsp;connect&nbsp;to&nbsp;server&nbsp;at&nbsp;all?&nbsp;I'd&nbsp;like<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;every&nbsp;other&nbsp;problems&nbsp;(ie.&nbsp;bad/selfsigned/not&nbsp;matched&nbsp;certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc.)&nbsp;pushed&nbsp;to&nbsp;the&nbsp;client's&nbsp;eyes.&nbsp;I&nbsp;have&nbsp;implemented<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.squid-cache.org/Doc/config/on_unsupported_protocol/&quot;&gt;https://www.squid-cache.org/Doc/config/on_unsupported_protocol/&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;like&nbsp;in&nbsp;the&nbsp;example&nbsp;-&nbsp;but&nbsp;it&nbsp;is&nbsp;for&nbsp;an&nbsp;accepted&nbsp;TCP&nbsp;connections.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I'd&nbsp;like&nbsp;to&nbsp;handle&nbsp;SSL&nbsp;errors&nbsp;-&nbsp;such&nbsp;as&nbsp;not&nbsp;being&nbsp;able&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect&nbsp;at&nbsp;all.&nbsp;-&nbsp;could&nbsp;it&nbsp;be&nbsp;done&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.squid-cache.org/Doc/config/sslproxy_cert_error/&quot;&gt;https://www.squid-cache.org/Doc/config/sslproxy_cert_error/&lt;/a&gt;?&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;LL&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
