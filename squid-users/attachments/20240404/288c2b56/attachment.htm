<tt>
&lt;!DOCTYPE&nbsp;html&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;white-space:&nbsp;pre-wrap&quot;&gt;<br>
&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
cite=&quot;mid:mailman.984.1712206107.1200.squid-users@lists.squid-cache.org&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;Date:&nbsp;Wed,&nbsp;3&nbsp;Apr&nbsp;2024&nbsp;11:05:02&nbsp;-0400<br>
From:&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&gt;&lt;rousskov@measurement-factory.com&gt;&lt;/a&gt;<br>
To:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;<br>
Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;Chrome&nbsp;auto-HTTPS-upgrade&nbsp;-&nbsp;not&nbsp;falling&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http<br>
Message-ID:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:e8845677-fe34-439a-9bfe-4a0b2aa3461a@measurement-factory.com&quot;&gt;&lt;e8845677-fe34-439a-9bfe-4a0b2aa3461a@measurement-factory.com&gt;&lt;/a&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=UTF-8;&nbsp;format=flowed<br>
<br>
On&nbsp;2024-04-03&nbsp;02:14,&nbsp;Lou?ansk?&nbsp;Luk??&nbsp;wrote:<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;this&nbsp;has&nbsp;recently&nbsp;started&nbsp;me&nbsp;up&nbsp;more&nbsp;then&nbsp;let&nbsp;it&nbsp;go.&nbsp;For&nbsp;a&nbsp;while<br>
chrome&nbsp;is&nbsp;upgrading&nbsp;in-page&nbsp;links&nbsp;to&nbsp;https.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;Just&nbsp;to&nbsp;add&nbsp;two&nbsp;more&nbsp;pieces&nbsp;of&nbsp;related&nbsp;information&nbsp;to&nbsp;this&nbsp;thread:<br>
<br>
Some&nbsp;Squid&nbsp;admins&nbsp;report&nbsp;that&nbsp;their&nbsp;v6-based&nbsp;code&nbsp;does&nbsp;not&nbsp;suffer&nbsp;from&nbsp;<br>
this&nbsp;issue&nbsp;while&nbsp;their&nbsp;v5-based&nbsp;code&nbsp;does.&nbsp;I&nbsp;have&nbsp;not&nbsp;verified&nbsp;those&nbsp;<br>
reports,&nbsp;but&nbsp;there&nbsp;may&nbsp;be&nbsp;more&nbsp;to&nbsp;the&nbsp;story&nbsp;here.&nbsp;What&nbsp;Squid&nbsp;version&nbsp;are&nbsp;<br>
_you_&nbsp;using?<br>
<br>
One&nbsp;way&nbsp;to&nbsp;track&nbsp;progress&nbsp;with&nbsp;this&nbsp;annoying&nbsp;and&nbsp;complex&nbsp;issue&nbsp;is&nbsp;to&nbsp;<br>
follow&nbsp;the&nbsp;following&nbsp;pull&nbsp;request.&nbsp;The&nbsp;current&nbsp;code&nbsp;cannot&nbsp;be&nbsp;officially&nbsp;<br>
merged&nbsp;as&nbsp;is,&nbsp;and&nbsp;I&nbsp;would&nbsp;not&nbsp;recommend&nbsp;using&nbsp;it&nbsp;in&nbsp;production&nbsp;(because&nbsp;<br>
of&nbsp;low-level&nbsp;bugs&nbsp;that&nbsp;will&nbsp;probably&nbsp;crash&nbsp;Squid&nbsp;in&nbsp;some&nbsp;cases),&nbsp;but&nbsp;<br>
testing&nbsp;it&nbsp;in&nbsp;the&nbsp;lab&nbsp;and&nbsp;providing&nbsp;feedback&nbsp;to&nbsp;authors&nbsp;may&nbsp;be&nbsp;useful:<br>
<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://github.com/squid-cache/squid/pull/1668&quot;&gt;https://github.com/squid-cache/squid/pull/1668&lt;/a&gt;<br>
<br>
HTH,<br>
<br>
Alex.<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Hello,&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;fortunately,&nbsp;I&nbsp;do&nbsp;not&nbsp;observe&nbsp;this&nbsp;problem&nbsp;accessing&nbsp;sites<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;running&nbsp;only&nbsp;on&nbsp;port&nbsp;80&nbsp;(no&nbsp;443&nbsp;at&nbsp;all),&nbsp;but&nbsp;my&nbsp;configuration&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simple:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;squid&nbsp;6.6&nbsp;as&nbsp;FreeBSD&nbsp;binary&nbsp;package&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;much&nbsp;about&nbsp;ssl&nbsp;in&nbsp;the&nbsp;config&nbsp;file&nbsp;though,&nbsp;just&nbsp;passing&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;through,&nbsp;no&nbsp;ssl&nbsp;juggling&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;acl&nbsp;SSL_ports&nbsp;port&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;80&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;Safe_ports&nbsp;port&nbsp;443&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;!Safe_ports&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;to_localhost&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;....&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;....&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;....&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;....&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;allow&nbsp;....&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_access&nbsp;deny&nbsp;all&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;I&nbsp;don't&nbsp;think&nbsp;it&nbsp;was&nbsp;different&nbsp;with&nbsp;squid&nbsp;5.9,&nbsp;which&nbsp;I&nbsp;used&nbsp;till<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;November&nbsp;2023.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Occasionally,&nbsp;I&nbsp;see&nbsp;another&nbsp;problem,&nbsp;which&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;related&nbsp;to&nbsp;squid&nbsp;ssl&nbsp;handling&nbsp;configuration:&nbsp;PR_END_OF_FILE_ERROR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Firefox)&nbsp;/&nbsp;ERR_CONNECTION_CLOSED&nbsp;(Chrome),&nbsp;typically&nbsp;accessing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samba.org.&nbsp;But&nbsp;they&nbsp;use&nbsp;permanent&nbsp;redirect&nbsp;from&nbsp;http&nbsp;to&nbsp;https,&nbsp;so<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;another&nbsp;situation&nbsp;than&nbsp;http-only&nbsp;site.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;David&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
