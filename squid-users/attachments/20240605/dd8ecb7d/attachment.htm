<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000&quot;&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I&nbsp;appreciate&nbsp;very&nbsp;much&nbsp;your&nbsp;looking&nbsp;at&nbsp;my&nbsp;question.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;Date:&nbsp;Thu,&nbsp;30&nbsp;May&nbsp;2024&nbsp;22:15:27&nbsp;+1200&lt;br&gt;&gt;From:&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;br&gt;&gt;To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;&gt;Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;can't&nbsp;explain&nbsp;403&nbsp;denied&nbsp;for&nbsp;authenticated&lt;br&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user&lt;br&gt;&gt;Message-ID:&nbsp;&lt;96746157-da51-47db-8d52-d65239f2717e@treenet.co.nz&gt;&lt;br&gt;&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=UTF-8;&nbsp;format=flowed&lt;br&gt;&gt;&lt;br&gt;&gt;On&nbsp;25/05/24&nbsp;07:28,&nbsp;Kevin&nbsp;wrote:&lt;br&gt;&gt;&gt;&nbsp;Hi,&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;We&nbsp;have&nbsp;2&nbsp;external&nbsp;ACLs&nbsp;that&nbsp;take&nbsp;a&nbsp;request's&nbsp;data&nbsp;(IP,&nbsp;authenticated&lt;br&gt;&gt;&gt;&nbsp;username,&nbsp;URL,&nbsp;user-agent,&nbsp;etc)&nbsp;and&nbsp;uses&nbsp;that&nbsp;information&nbsp;to&nbsp;determine&lt;br&gt;&gt;&gt;&nbsp;whether&nbsp;a&nbsp;user&nbsp;or&nbsp;host&nbsp;should&nbsp;be&nbsp;permitted&nbsp;to&nbsp;access&nbsp;that&nbsp;URL.??&nbsp;It&lt;br&gt;&gt;&gt;&nbsp;almost&nbsp;always&nbsp;works&nbsp;well,&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;recurring&nbsp;occasional&nbsp;issue&nbsp;that&lt;br&gt;&gt;&gt;&nbsp;I&nbsp;can't&nbsp;figure&nbsp;out.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;When&nbsp;it&nbsp;occurs,&nbsp;it's&nbsp;always&nbsp;around&nbsp;4AM.??&nbsp;This&nbsp;particular&nbsp;request&nbsp;occurs&lt;br&gt;&gt;&gt;&nbsp;often&nbsp;-&nbsp;averages&nbsp;about&nbsp;once&nbsp;a&nbsp;second&nbsp;throughout&nbsp;the&nbsp;day.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;What&nbsp;we&nbsp;see&nbsp;is&nbsp;a&nbsp;&quot;403&nbsp;forbidden&quot;&nbsp;for&nbsp;a&nbsp;(should&nbsp;be)&nbsp;permitted&nbsp;site&nbsp;from&lt;br&gt;&gt;&gt;&nbsp;an&nbsp;authenticated&nbsp;user&nbsp;from&nbsp;the&nbsp;same&nbsp;IP/user&nbsp;and&nbsp;to&nbsp;the&nbsp;same&nbsp;site&nbsp;that&lt;br&gt;&gt;&gt;&nbsp;gets&nbsp;a&nbsp;&quot;202&nbsp;connection&nbsp;established&quot;&nbsp;every&nbsp;other&nbsp;time.&lt;br&gt;&gt;&lt;br&gt;&gt;Is&nbsp;maybe&nbsp;4am&nbsp;the&nbsp;time&nbsp;when&nbsp;your&nbsp;auth&nbsp;system&nbsp;refreshes&nbsp;all&nbsp;nonce?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;thus&nbsp;making&nbsp;any&nbsp;currently&nbsp;in-use&nbsp;by&nbsp;the&nbsp;clients&nbsp;invalid&nbsp;until&nbsp;they&lt;br&gt;&gt;re-auth.&nbsp;You&nbsp;might&nbsp;see&nbsp;a&nbsp;mix&nbsp;of&nbsp;403/401/407&nbsp;in&nbsp;a&nbsp;bunch&nbsp;at&nbsp;such&nbsp;times.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;My&nbsp;auth&nbsp;system&nbsp;is&nbsp;just&nbsp;squid&nbsp;with&nbsp;one&nbsp;flat&nbsp;file&nbsp;each&nbsp;for&nbsp;basic&nbsp;and&nbsp;digest&nbsp;authentication&nbsp;(we&nbsp;allow&nbsp;basic&nbsp;only&nbsp;if&nbsp;an&nbsp;application&nbsp;doesn't&nbsp;support&nbsp;digest).&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;in&nbsp;a&nbsp;similar&nbsp;style&nbsp;one/some&nbsp;of&nbsp;the&nbsp;clients&nbsp;is&nbsp;broken&nbsp;and&nbsp;fails&lt;br&gt;&gt;to&nbsp;update&nbsp;its&nbsp;nonce&nbsp;before&nbsp;it&nbsp;expires&nbsp;at&nbsp;4am?&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;The&nbsp;client&nbsp;is&nbsp;a&nbsp;Java-based&nbsp;application.&nbsp;&nbsp;I&nbsp;can&nbsp;find&nbsp;out&nbsp;more&nbsp;from&nbsp;the&nbsp;team&nbsp;that&nbsp;wrote&nbsp;it.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&nbsp;&nbsp;-&nbsp;looking&nbsp;at&nbsp;which&nbsp;client&nbsp;agent&nbsp;and&nbsp;IP&nbsp;were&nbsp;getting&nbsp;the&nbsp;403&nbsp;and/or&nbsp;the&lt;br&gt;&gt;nonce&nbsp;which&nbsp;received&nbsp;403&nbsp;will&nbsp;give&nbsp;you&nbsp;hints&nbsp;about&nbsp;this&nbsp;possibility.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;Oh:&nbsp;it's&nbsp;only&nbsp;this&nbsp;one&nbsp;application&nbsp;from&nbsp;this&nbsp;one&nbsp;particular&nbsp;host.&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Or&nbsp;your&nbsp;network&nbsp;router(s)&nbsp;do&nbsp;garbage&nbsp;collection&nbsp;and&nbsp;terminate&lt;br&gt;&gt;long-running&nbsp;connections&nbsp;to&nbsp;free&nbsp;up&nbsp;TCP&nbsp;resources?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;thus&nbsp;forcing&nbsp;a&nbsp;lot&nbsp;of&nbsp;client&nbsp;re-connects&nbsp;at&nbsp;4am,&nbsp;which&nbsp;may:&lt;br&gt;&gt;&nbsp;&nbsp;a)&nbsp;overload&nbsp;the&nbsp;auth&nbsp;system/helper,&nbsp;or&lt;br&gt;&gt;&nbsp;&nbsp;b)&nbsp;break&nbsp;a&nbsp;transaction&nbsp;that&nbsp;included&nbsp;nonce&nbsp;update&nbsp;for&nbsp;clients&nbsp;-&lt;br&gt;&gt;resulting&nbsp;in&nbsp;their&nbsp;next&nbsp;request&nbsp;being&nbsp;invalid&nbsp;nonce.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I'm&nbsp;not&nbsp;aware&nbsp;of&nbsp;a&nbsp;4AM&nbsp;connection-terminating&nbsp;task&nbsp;but&nbsp;will&nbsp;confirm.&nbsp;&nbsp;&nbsp;As&nbsp;mentioned&nbsp;(in&nbsp;answer&nbsp;to&nbsp;a),&nbsp;the&nbsp;auth&nbsp;system&nbsp;is&nbsp;just&nbsp;squid.&nbsp;&nbsp;&nbsp;Re:&nbsp;b&nbsp;-&nbsp;I&nbsp;hadn't&nbsp;thought&nbsp;of&nbsp;that.&nbsp;&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;you&nbsp;have&nbsp;log&nbsp;processing&nbsp;software&nbsp;that&nbsp;does&nbsp;&quot;squid&nbsp;-k&nbsp;restart&quot;&lt;br&gt;&gt;instead&nbsp;of&nbsp;the&nbsp;proper&nbsp;&quot;squid&nbsp;-k&nbsp;rotate&quot;&nbsp;to&nbsp;get&nbsp;access&nbsp;to&nbsp;the&nbsp;log&nbsp;files?&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I&nbsp;hadn't&nbsp;checked&nbsp;that!&nbsp;&nbsp;But&nbsp;logrotate&nbsp;runs&nbsp;at&nbsp;00:00&nbsp;and&nbsp;the&nbsp;rotate&nbsp;script&nbsp;does&nbsp;use&nbsp;&quot;squid&nbsp;-k&nbsp;rotate&quot;.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;your&nbsp;auth&nbsp;system&nbsp;has&nbsp;a&nbsp;limit&nbsp;on&nbsp;how&nbsp;large&nbsp;nonce-count&nbsp;can&nbsp;become?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;I&nbsp;notice&nbsp;that&nbsp;the&nbsp;working&nbsp;request&nbsp;has&nbsp;0x2F&nbsp;uses&nbsp;and&nbsp;the&nbsp;forbidden&lt;br&gt;&gt;has&nbsp;0x35&nbsp;(suspiciously&nbsp;close&nbsp;to&nbsp;50&nbsp;in&nbsp;decimal)&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don't&nbsp;know&nbsp;what&nbsp;that&nbsp;is.&nbsp;&nbsp;I&nbsp;didn't&nbsp;find&nbsp;a&nbsp;lot&nbsp;of&nbsp;helpful&nbsp;detail&nbsp;on&nbsp;squid's&nbsp;digest&nbsp;auth&nbsp;implementation.&nbsp;&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;The&nbsp;difference&nbsp;I&nbsp;see&nbsp;in&nbsp;the&nbsp;logs:?&nbsp;though&nbsp;all&nbsp;the&nbsp;digest&nbsp;auth&nbsp;info&nbsp;looks&lt;br&gt;&gt;&gt;&nbsp;okay,&nbsp;the&nbsp;%un&nbsp;field&nbsp;in&nbsp;the&nbsp;log&nbsp;for&nbsp;the&nbsp;usual&nbsp;(successful)&nbsp;request&nbsp;is&nbsp;the&lt;br&gt;&gt;&gt;&nbsp;authenticated&nbsp;username,&nbsp;while&nbsp;in&nbsp;the&nbsp;failed&nbsp;request,&nbsp;it's&nbsp;&quot;-&quot;.??&nbsp;So&lt;br&gt;&gt;&gt;&nbsp;though&nbsp;there&nbsp;hasn't&nbsp;been&nbsp;an&nbsp;authentication&nbsp;error&nbsp;or&nbsp;&quot;authentication&lt;br&gt;&gt;&gt;&nbsp;required&quot;&nbsp;in&nbsp;the&nbsp;log&nbsp;-&nbsp;and&nbsp;the&nbsp;username&nbsp;is&nbsp;in&nbsp;the&nbsp;authentication&nbsp;details&lt;br&gt;&gt;&gt;&nbsp;in&nbsp;the&nbsp;log&nbsp;entry&nbsp;-?&nbsp;it&nbsp;seems&nbsp;like&nbsp;squid&nbsp;isn't&nbsp;recognizing&nbsp;that&nbsp;username&lt;br&gt;&gt;&gt;&nbsp;as&nbsp;%un.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Be&nbsp;aware&nbsp;that&nbsp;a&nbsp;properly&nbsp;behaving&nbsp;client&nbsp;will&nbsp;*not*&nbsp;send&nbsp;credentials&lt;br&gt;&gt;until&nbsp;they&nbsp;are&nbsp;requested,&nbsp;after&nbsp;which&nbsp;it&nbsp;should&nbsp;*always*&nbsp;send&lt;br&gt;&gt;credentials&nbsp;on&nbsp;that&nbsp;same&nbsp;connection&nbsp;(even&nbsp;if&nbsp;they&nbsp;are&nbsp;not&nbsp;requested&lt;br&gt;&gt;explicitly).&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;That&nbsp;means&nbsp;some&nbsp;requests&nbsp;on&nbsp;a&nbsp;multiplex/pipeline/keep-alive&nbsp;connection&lt;br&gt;&gt;MAY&nbsp;arrive&nbsp;with&nbsp;credentials&nbsp;and&nbsp;be&nbsp;accepted(2xx)/denied(403)&nbsp;without&lt;br&gt;&gt;authentication&nbsp;having&nbsp;occured.&nbsp;Entirely&nbsp;due&nbsp;to&nbsp;your&nbsp;*_access&nbsp;directives&lt;br&gt;&gt;sequence.&nbsp;In&nbsp;these&nbsp;cases&nbsp;the&nbsp;log&nbsp;will&nbsp;show&nbsp;auth&nbsp;headers&nbsp;but&nbsp;no&nbsp;value&nbsp;for&lt;br&gt;&gt;%un&nbsp;and/or&nbsp;%ul.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;My&nbsp;squid.conf&nbsp;first&nbsp;tests&nbsp;a&nbsp;request&nbsp;to&nbsp;see&nbsp;if&nbsp;an&nbsp;unauthenticated&nbsp;request&lt;br&gt;&gt;&gt;&nbsp;from&nbsp;a&nbsp;particular&nbsp;host&nbsp;is&nbsp;permitted.?&nbsp;That&nbsp;external&nbsp;ACL&nbsp;doesn't&nbsp;take&nbsp;a&lt;br&gt;&gt;&gt;&nbsp;username&nbsp;as&nbsp;an&nbsp;argument.??&nbsp;If&nbsp;that&nbsp;external&nbsp;ACL&nbsp;passes,&nbsp;the&nbsp;request&nbsp;is&lt;br&gt;&gt;&gt;&nbsp;allowed.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Please&nbsp;*show*&nbsp;the&nbsp;config&nbsp;lines&nbsp;rather&nbsp;than&nbsp;describing&nbsp;what&nbsp;you&nbsp;*think*&lt;br&gt;&gt;they&nbsp;do.&nbsp;Their&nbsp;exact&nbsp;ordering&nbsp;matters&nbsp;*a&nbsp;lot*.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&nbsp;Obfuscation&nbsp;of&nbsp;sensitive&nbsp;details&nbsp;is&nbsp;okay/expected&nbsp;so&nbsp;long&nbsp;as&nbsp;you&nbsp;makes&lt;br&gt;&gt;it&nbsp;easy&nbsp;for&nbsp;us&nbsp;to&nbsp;tell&nbsp;that&nbsp;value&nbsp;A&nbsp;and&nbsp;value&nbsp;B&nbsp;are&nbsp;different.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;FWIW;&nbsp;if&nbsp;your&nbsp;config&nbsp;file&nbsp;is&nbsp;*actually*&nbsp;containing&nbsp;only&nbsp;what&nbsp;you&lt;br&gt;&gt;described&nbsp;it&nbsp;is&nbsp;missing&nbsp;a&nbsp;number&nbsp;of&nbsp;things&nbsp;necessary&nbsp;to&nbsp;have&nbsp;a&nbsp;safe&nbsp;and&lt;br&gt;&gt;secure&nbsp;proxy.&nbsp;A&nbsp;look&nbsp;at&nbsp;your&nbsp;full&nbsp;config&nbsp;(without&nbsp;comments&nbsp;or&nbsp;empty&lt;br&gt;&gt;lines)&nbsp;will&nbsp;help&nbsp;us&nbsp;point&nbsp;out&nbsp;any&nbsp;unnoticed&nbsp;issues&nbsp;for&nbsp;you&nbsp;to&nbsp;consider&lt;br&gt;&gt;fixing.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;Understood.&nbsp;&nbsp;&nbsp;Here&nbsp;it&nbsp;is:&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&nbsp;&lt;!--StartFragment--&gt;&lt;pre&gt;acl&nbsp;localnet&nbsp;src&nbsp;10.0.0.0/8&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;172.16.0.0/12&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;192.168.0.0/16&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range<br>
acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines<br>
acl&nbsp;windows_net&nbsp;src&nbsp;172.18.114.0/24<br>
acl&nbsp;sample_host&nbsp;src&nbsp;172.18.115.1/32<br>
acl&nbsp;rsync&nbsp;port&nbsp;873<br>
acl&nbsp;SSL_ports&nbsp;port&nbsp;443<br>
acl&nbsp;SSL_ports&nbsp;port&nbsp;873&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#873&nbsp;is&nbsp;rsync<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;873<br>
acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT<br>
acl&nbsp;PURGE&nbsp;method&nbsp;PURGE<br>
acl&nbsp;localhost&nbsp;src&nbsp;127.0.0.1<br>
http_access&nbsp;allow&nbsp;PURGE&nbsp;localhost<br>
http_access&nbsp;deny&nbsp;PURGE<br>
acl&nbsp;URN&nbsp;proto&nbsp;URN<br>
http_access&nbsp;deny&nbsp;URN<br>
http_access&nbsp;deny&nbsp;manager<br>
acl&nbsp;API_FIREFOX&nbsp;dstdomain&nbsp;api.profiler.firefox.com<br>
http_access&nbsp;deny&nbsp;API_FIREFOX<br>
acl&nbsp;ff_browser&nbsp;browser&nbsp;^Mozilla/5\.0<br>
acl&nbsp;rma_ua&nbsp;browser&nbsp;^RMA/1\.0.*compatible;.RealMedia<br>
uri_whitespace&nbsp;encode<br>
acl&nbsp;trellix_phone_cloud&nbsp;dstdomain&nbsp;amcore-ens.rest.gti.trellix.com<br>
http_access&nbsp;deny&nbsp;trellix_phone_cloud<br>
external_acl_type&nbsp;host_based_filter&nbsp;children-max=15&nbsp;ttl=0&nbsp;%ACL&nbsp;%DATA&nbsp;%SRC&nbsp;%&gt;rd&nbsp;%&gt;rP&nbsp;&nbsp;/PATH/TO/FILTER/SCRIPT.py<br>
acl&nbsp;HostBasedRules&nbsp;external&nbsp;host_based_filter<br>
http_access&nbsp;allow&nbsp;HostBasedRules<br>
auth_param&nbsp;digest&nbsp;program&nbsp;/usr/lib/squid/digest_file_auth&nbsp;-c&nbsp;/etc/squid/passwd<br>
auth_param&nbsp;digest&nbsp;realm&nbsp;squid<br>
auth_param&nbsp;digest&nbsp;children&nbsp;2<br>
auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ncsa_auth&nbsp;/etc/squid/basic_passwd<br>
auth_param&nbsp;basic&nbsp;children&nbsp;2<br>
auth_param&nbsp;basic&nbsp;realm&nbsp;squidb<br>
auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours<br>
acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED<br>
external_acl_type&nbsp;custom_acl_db&nbsp;children-max=15&nbsp;ttl=0&nbsp;%ACL&nbsp;%DATA&nbsp;%ul&nbsp;%SRC&nbsp;%&gt;rd&nbsp;%&gt;rP&nbsp;%credentials&nbsp;/PATH/TO/FILTER/SCRIPT.py<br>
acl&nbsp;CustomAclDB&nbsp;external&nbsp;custom_acl_db<br>
http_access&nbsp;allow&nbsp;CustomAclDB<br>
acl&nbsp;CRLs&nbsp;url_regex&nbsp;&quot;/etc/squid/conf.d/CRL_urls.txt&quot;<br>
http_access&nbsp;allow&nbsp;CRLs<br>
deny_info&nbsp;303:https://abc.def.com/<br>
http_access&nbsp;deny&nbsp;all<br>
acl&nbsp;apache&nbsp;rep_header&nbsp;Server&nbsp;^Apache<br>
icp_access&nbsp;allow&nbsp;localnet<br>
icp_access&nbsp;deny&nbsp;all<br>
http_access&nbsp;deny&nbsp;!Safe_ports<br>
http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports<br>
http_access&nbsp;allow&nbsp;localhost&nbsp;manager<br>
http_access&nbsp;deny&nbsp;manager<br>
http_access&nbsp;allow&nbsp;localhost<br>
http_port&nbsp;3128<br>
coredump_dir&nbsp;/var/cache/squid<br>
refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080<br>
refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440<br>
refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320<br>
logformat&nbsp;squid&nbsp;%ts.%03tu&nbsp;%6tr&nbsp;%&gt;a&nbsp;%Ss/%&gt;Hs&nbsp;%&lt;st&nbsp;%rm&nbsp;%ru&nbsp;%un&nbsp;%Sh/%&lt;A&nbsp;%mt<br>
logformat&nbsp;squidmime&nbsp;%ul&nbsp;%ts.%03tu&nbsp;%6tr&nbsp;%&gt;a&nbsp;%Ss/%&gt;Hs&nbsp;%&lt;st&nbsp;%rm&nbsp;%ru&nbsp;%un&nbsp;%Sh/%&lt;A&nbsp;%mt&nbsp;[%&gt;h]&nbsp;[%&lt;h]<br>
logformat&nbsp;common&nbsp;%&gt;a&nbsp;%ui&nbsp;%un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;%Ss:%Sh<br>
logformat&nbsp;combined&nbsp;%&gt;a&nbsp;%ui&nbsp;%un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;&quot;%{Referer}&gt;h&quot;&nbsp;&quot;%{User-Agent}&gt;h&quot;&nbsp;%Ss:%Sh<br>
logformat&nbsp;ip_port&nbsp;%ts&nbsp;%tu&nbsp;%&gt;a&nbsp;%&gt;p&nbsp;%&lt;lp&nbsp;%&lt;a&nbsp;%&lt;p&nbsp;%dt&nbsp;%tr&nbsp;%un&nbsp;%&gt;ru&nbsp;%Ss<br>
access_log&nbsp;daemon:/var/log/squid/access.log&nbsp;combined<br>
access_log&nbsp;daemon:/var/log/squid/network.log&nbsp;ip_port<br>
cache_log&nbsp;/var/log/squid/cache.log<br>
cache_store_log&nbsp;/var/log/squid/store.log<br>
access_log&nbsp;daemon:/var/log/squid/useragent.log&nbsp;useragent<br>
visible_hostname&nbsp;proxy.abc.com<br>
cache&nbsp;deny&nbsp;all&lt;/pre&gt;&lt;!--EndFragment--&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;The&nbsp;next&nbsp;line&nbsp;in&nbsp;squid.conf&nbsp;is&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;FYI&nbsp;the&nbsp;above&nbsp;just&nbsp;means&nbsp;that&nbsp;Squid&nbsp;is&nbsp;using&nbsp;authentication.&nbsp;It&nbsp;says&lt;br&gt;&gt;nothing&nbsp;about&nbsp;when&nbsp;the&nbsp;authentication&nbsp;will&nbsp;be&nbsp;(or&nbsp;not&nbsp;be)&nbsp;performed.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;...&nbsp;and&nbsp;after&nbsp;that,&nbsp;the&nbsp;external&nbsp;ACL&nbsp;that&nbsp;takes&nbsp;the&nbsp;username&nbsp;as&nbsp;well&nbsp;as&lt;br&gt;&gt;&gt;&nbsp;the&nbsp;other&nbsp;info.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;HTH&lt;br&gt;&gt;Amos&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;hr&nbsp;id=&quot;zwchr&quot;&nbsp;data-marker=&quot;__DIVIDER__&quot;&gt;&lt;div&nbsp;data-marker=&quot;__HEADERS__&quot;&gt;&lt;b&gt;From:&nbsp;&lt;/b&gt;squid-users-request@lists.squid-cache.org&lt;br&gt;&lt;b&gt;To:&nbsp;&lt;/b&gt;&quot;squid-users&quot;&nbsp;&lt;squid-users@lists.squid-cache.org&gt;&lt;br&gt;&lt;b&gt;Sent:&nbsp;&lt;/b&gt;Thursday,&nbsp;May&nbsp;30,&nbsp;2024&nbsp;8:00:01&nbsp;AM&lt;br&gt;&lt;b&gt;Subject:&nbsp;&lt;/b&gt;squid-users&nbsp;Digest,&nbsp;Vol&nbsp;117,&nbsp;Issue&nbsp;31&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I&nbsp;appreciate&nbsp;very&nbsp;much&nbsp;your&nbsp;looking&nbsp;at&nbsp;my&nbsp;question.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;Date:&nbsp;Thu,&nbsp;30&nbsp;May&nbsp;2024&nbsp;22:15:27&nbsp;+1200&lt;br&gt;&gt;From:&nbsp;Amos&nbsp;Jeffries&nbsp;&lt;squid3@treenet.co.nz&gt;&lt;br&gt;&gt;To:&nbsp;squid-users@lists.squid-cache.org&lt;br&gt;&gt;Subject:&nbsp;Re:&nbsp;[squid-users]&nbsp;can't&nbsp;explain&nbsp;403&nbsp;denied&nbsp;for&nbsp;authenticated&lt;br&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user&lt;br&gt;&gt;Message-ID:&nbsp;&lt;96746157-da51-47db-8d52-d65239f2717e@treenet.co.nz&gt;&lt;br&gt;&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=UTF-8;&nbsp;format=flowed&lt;br&gt;&gt;&lt;br&gt;&gt;On&nbsp;25/05/24&nbsp;07:28,&nbsp;Kevin&nbsp;wrote:&lt;br&gt;&gt;&gt;&nbsp;Hi,&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;We&nbsp;have&nbsp;2&nbsp;external&nbsp;ACLs&nbsp;that&nbsp;take&nbsp;a&nbsp;request's&nbsp;data&nbsp;(IP,&nbsp;authenticated&lt;br&gt;&gt;&gt;&nbsp;username,&nbsp;URL,&nbsp;user-agent,&nbsp;etc)&nbsp;and&nbsp;uses&nbsp;that&nbsp;information&nbsp;to&nbsp;determine&lt;br&gt;&gt;&gt;&nbsp;whether&nbsp;a&nbsp;user&nbsp;or&nbsp;host&nbsp;should&nbsp;be&nbsp;permitted&nbsp;to&nbsp;access&nbsp;that&nbsp;URL.??&nbsp;It&lt;br&gt;&gt;&gt;&nbsp;almost&nbsp;always&nbsp;works&nbsp;well,&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;recurring&nbsp;occasional&nbsp;issue&nbsp;that&lt;br&gt;&gt;&gt;&nbsp;I&nbsp;can't&nbsp;figure&nbsp;out.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;When&nbsp;it&nbsp;occurs,&nbsp;it's&nbsp;always&nbsp;around&nbsp;4AM.??&nbsp;This&nbsp;particular&nbsp;request&nbsp;occurs&lt;br&gt;&gt;&gt;&nbsp;often&nbsp;-&nbsp;averages&nbsp;about&nbsp;once&nbsp;a&nbsp;second&nbsp;throughout&nbsp;the&nbsp;day.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;What&nbsp;we&nbsp;see&nbsp;is&nbsp;a&nbsp;&quot;403&nbsp;forbidden&quot;&nbsp;for&nbsp;a&nbsp;(should&nbsp;be)&nbsp;permitted&nbsp;site&nbsp;from&lt;br&gt;&gt;&gt;&nbsp;an&nbsp;authenticated&nbsp;user&nbsp;from&nbsp;the&nbsp;same&nbsp;IP/user&nbsp;and&nbsp;to&nbsp;the&nbsp;same&nbsp;site&nbsp;that&lt;br&gt;&gt;&gt;&nbsp;gets&nbsp;a&nbsp;&quot;202&nbsp;connection&nbsp;established&quot;&nbsp;every&nbsp;other&nbsp;time.&lt;br&gt;&gt;&lt;br&gt;&gt;Is&nbsp;maybe&nbsp;4am&nbsp;the&nbsp;time&nbsp;when&nbsp;your&nbsp;auth&nbsp;system&nbsp;refreshes&nbsp;all&nbsp;nonce?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;thus&nbsp;making&nbsp;any&nbsp;currently&nbsp;in-use&nbsp;by&nbsp;the&nbsp;clients&nbsp;invalid&nbsp;until&nbsp;they&lt;br&gt;&gt;re-auth.&nbsp;You&nbsp;might&nbsp;see&nbsp;a&nbsp;mix&nbsp;of&nbsp;403/401/407&nbsp;in&nbsp;a&nbsp;bunch&nbsp;at&nbsp;such&nbsp;times.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;My&nbsp;auth&nbsp;system&nbsp;is&nbsp;just&nbsp;squid&nbsp;with&nbsp;one&nbsp;flat&nbsp;file&nbsp;each&nbsp;for&nbsp;basic&nbsp;and&nbsp;digest&nbsp;authentication&nbsp;(we&nbsp;allow&nbsp;basic&nbsp;only&nbsp;if&nbsp;an&nbsp;application&nbsp;doesn't&nbsp;support&nbsp;digest).&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;in&nbsp;a&nbsp;similar&nbsp;style&nbsp;one/some&nbsp;of&nbsp;the&nbsp;clients&nbsp;is&nbsp;broken&nbsp;and&nbsp;fails&lt;br&gt;&gt;to&nbsp;update&nbsp;its&nbsp;nonce&nbsp;before&nbsp;it&nbsp;expires&nbsp;at&nbsp;4am?&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;The&nbsp;client&nbsp;is&nbsp;a&nbsp;Java-based&nbsp;application.&nbsp;&nbsp;I&nbsp;can&nbsp;find&nbsp;out&nbsp;more&nbsp;from&nbsp;the&nbsp;team&nbsp;that&nbsp;wrote&nbsp;it.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&nbsp;&nbsp;-&nbsp;looking&nbsp;at&nbsp;which&nbsp;client&nbsp;agent&nbsp;and&nbsp;IP&nbsp;were&nbsp;getting&nbsp;the&nbsp;403&nbsp;and/or&nbsp;the&lt;br&gt;&gt;nonce&nbsp;which&nbsp;received&nbsp;403&nbsp;will&nbsp;give&nbsp;you&nbsp;hints&nbsp;about&nbsp;this&nbsp;possibility.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;Oh:&nbsp;it's&nbsp;only&nbsp;this&nbsp;one&nbsp;application&nbsp;from&nbsp;this&nbsp;one&nbsp;particular&nbsp;host.&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Or&nbsp;your&nbsp;network&nbsp;router(s)&nbsp;do&nbsp;garbage&nbsp;collection&nbsp;and&nbsp;terminate&lt;br&gt;&gt;long-running&nbsp;connections&nbsp;to&nbsp;free&nbsp;up&nbsp;TCP&nbsp;resources?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;thus&nbsp;forcing&nbsp;a&nbsp;lot&nbsp;of&nbsp;client&nbsp;re-connects&nbsp;at&nbsp;4am,&nbsp;which&nbsp;may:&lt;br&gt;&gt;&nbsp;&nbsp;a)&nbsp;overload&nbsp;the&nbsp;auth&nbsp;system/helper,&nbsp;or&lt;br&gt;&gt;&nbsp;&nbsp;b)&nbsp;break&nbsp;a&nbsp;transaction&nbsp;that&nbsp;included&nbsp;nonce&nbsp;update&nbsp;for&nbsp;clients&nbsp;-&lt;br&gt;&gt;resulting&nbsp;in&nbsp;their&nbsp;next&nbsp;request&nbsp;being&nbsp;invalid&nbsp;nonce.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I'm&nbsp;not&nbsp;aware&nbsp;of&nbsp;a&nbsp;4AM&nbsp;connection-terminating&nbsp;task&nbsp;but&nbsp;will&nbsp;confirm.&nbsp;&nbsp;&nbsp;As&nbsp;mentioned&nbsp;(in&nbsp;answer&nbsp;to&nbsp;a),&nbsp;the&nbsp;auth&nbsp;system&nbsp;is&nbsp;just&nbsp;squid.&nbsp;&nbsp;&nbsp;Re:&nbsp;b&nbsp;-&nbsp;I&nbsp;hadn't&nbsp;thought&nbsp;of&nbsp;that.&nbsp;&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;you&nbsp;have&nbsp;log&nbsp;processing&nbsp;software&nbsp;that&nbsp;does&nbsp;&quot;squid&nbsp;-k&nbsp;restart&quot;&lt;br&gt;&gt;instead&nbsp;of&nbsp;the&nbsp;proper&nbsp;&quot;squid&nbsp;-k&nbsp;rotate&quot;&nbsp;to&nbsp;get&nbsp;access&nbsp;to&nbsp;the&nbsp;log&nbsp;files?&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;I&nbsp;hadn't&nbsp;checked&nbsp;that!&nbsp;&nbsp;But&nbsp;logrotate&nbsp;runs&nbsp;at&nbsp;00:00&nbsp;and&nbsp;the&nbsp;rotate&nbsp;script&nbsp;does&nbsp;use&nbsp;&quot;squid&nbsp;-k&nbsp;rotate&quot;.&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;Or&nbsp;maybe&nbsp;your&nbsp;auth&nbsp;system&nbsp;has&nbsp;a&nbsp;limit&nbsp;on&nbsp;how&nbsp;large&nbsp;nonce-count&nbsp;can&nbsp;become?&lt;br&gt;&gt;&nbsp;&nbsp;-&nbsp;I&nbsp;notice&nbsp;that&nbsp;the&nbsp;working&nbsp;request&nbsp;has&nbsp;0x2F&nbsp;uses&nbsp;and&nbsp;the&nbsp;forbidden&lt;br&gt;&gt;has&nbsp;0x35&nbsp;(suspiciously&nbsp;close&nbsp;to&nbsp;50&nbsp;in&nbsp;decimal)&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don't&nbsp;know&nbsp;what&nbsp;that&nbsp;is.&nbsp;&nbsp;I&nbsp;didn't&nbsp;find&nbsp;a&nbsp;lot&nbsp;of&nbsp;helpful&nbsp;detail&nbsp;on&nbsp;squid's&nbsp;digest&nbsp;auth&nbsp;implementation.&nbsp;&nbsp;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;The&nbsp;difference&nbsp;I&nbsp;see&nbsp;in&nbsp;the&nbsp;logs:?&nbsp;though&nbsp;all&nbsp;the&nbsp;digest&nbsp;auth&nbsp;info&nbsp;looks&lt;br&gt;&gt;&gt;&nbsp;okay,&nbsp;the&nbsp;%un&nbsp;field&nbsp;in&nbsp;the&nbsp;log&nbsp;for&nbsp;the&nbsp;usual&nbsp;(successful)&nbsp;request&nbsp;is&nbsp;the&lt;br&gt;&gt;&gt;&nbsp;authenticated&nbsp;username,&nbsp;while&nbsp;in&nbsp;the&nbsp;failed&nbsp;request,&nbsp;it's&nbsp;&quot;-&quot;.??&nbsp;So&lt;br&gt;&gt;&gt;&nbsp;though&nbsp;there&nbsp;hasn't&nbsp;been&nbsp;an&nbsp;authentication&nbsp;error&nbsp;or&nbsp;&quot;authentication&lt;br&gt;&gt;&gt;&nbsp;required&quot;&nbsp;in&nbsp;the&nbsp;log&nbsp;-&nbsp;and&nbsp;the&nbsp;username&nbsp;is&nbsp;in&nbsp;the&nbsp;authentication&nbsp;details&lt;br&gt;&gt;&gt;&nbsp;in&nbsp;the&nbsp;log&nbsp;entry&nbsp;-?&nbsp;it&nbsp;seems&nbsp;like&nbsp;squid&nbsp;isn't&nbsp;recognizing&nbsp;that&nbsp;username&lt;br&gt;&gt;&gt;&nbsp;as&nbsp;%un.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Be&nbsp;aware&nbsp;that&nbsp;a&nbsp;properly&nbsp;behaving&nbsp;client&nbsp;will&nbsp;*not*&nbsp;send&nbsp;credentials&lt;br&gt;&gt;until&nbsp;they&nbsp;are&nbsp;requested,&nbsp;after&nbsp;which&nbsp;it&nbsp;should&nbsp;*always*&nbsp;send&lt;br&gt;&gt;credentials&nbsp;on&nbsp;that&nbsp;same&nbsp;connection&nbsp;(even&nbsp;if&nbsp;they&nbsp;are&nbsp;not&nbsp;requested&lt;br&gt;&gt;explicitly).&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;That&nbsp;means&nbsp;some&nbsp;requests&nbsp;on&nbsp;a&nbsp;multiplex/pipeline/keep-alive&nbsp;connection&lt;br&gt;&gt;MAY&nbsp;arrive&nbsp;with&nbsp;credentials&nbsp;and&nbsp;be&nbsp;accepted(2xx)/denied(403)&nbsp;without&lt;br&gt;&gt;authentication&nbsp;having&nbsp;occured.&nbsp;Entirely&nbsp;due&nbsp;to&nbsp;your&nbsp;*_access&nbsp;directives&lt;br&gt;&gt;sequence.&nbsp;In&nbsp;these&nbsp;cases&nbsp;the&nbsp;log&nbsp;will&nbsp;show&nbsp;auth&nbsp;headers&nbsp;but&nbsp;no&nbsp;value&nbsp;for&lt;br&gt;&gt;%un&nbsp;and/or&nbsp;%ul.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;My&nbsp;squid.conf&nbsp;first&nbsp;tests&nbsp;a&nbsp;request&nbsp;to&nbsp;see&nbsp;if&nbsp;an&nbsp;unauthenticated&nbsp;request&lt;br&gt;&gt;&gt;&nbsp;from&nbsp;a&nbsp;particular&nbsp;host&nbsp;is&nbsp;permitted.?&nbsp;That&nbsp;external&nbsp;ACL&nbsp;doesn't&nbsp;take&nbsp;a&lt;br&gt;&gt;&gt;&nbsp;username&nbsp;as&nbsp;an&nbsp;argument.??&nbsp;If&nbsp;that&nbsp;external&nbsp;ACL&nbsp;passes,&nbsp;the&nbsp;request&nbsp;is&lt;br&gt;&gt;&gt;&nbsp;allowed.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Please&nbsp;*show*&nbsp;the&nbsp;config&nbsp;lines&nbsp;rather&nbsp;than&nbsp;describing&nbsp;what&nbsp;you&nbsp;*think*&lt;br&gt;&gt;they&nbsp;do.&nbsp;Their&nbsp;exact&nbsp;ordering&nbsp;matters&nbsp;*a&nbsp;lot*.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&nbsp;Obfuscation&nbsp;of&nbsp;sensitive&nbsp;details&nbsp;is&nbsp;okay/expected&nbsp;so&nbsp;long&nbsp;as&nbsp;you&nbsp;makes&lt;br&gt;&gt;it&nbsp;easy&nbsp;for&nbsp;us&nbsp;to&nbsp;tell&nbsp;that&nbsp;value&nbsp;A&nbsp;and&nbsp;value&nbsp;B&nbsp;are&nbsp;different.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&gt;&lt;br&gt;&gt;FWIW;&nbsp;if&nbsp;your&nbsp;config&nbsp;file&nbsp;is&nbsp;*actually*&nbsp;containing&nbsp;only&nbsp;what&nbsp;you&lt;br&gt;&gt;described&nbsp;it&nbsp;is&nbsp;missing&nbsp;a&nbsp;number&nbsp;of&nbsp;things&nbsp;necessary&nbsp;to&nbsp;have&nbsp;a&nbsp;safe&nbsp;and&lt;br&gt;&gt;secure&nbsp;proxy.&nbsp;A&nbsp;look&nbsp;at&nbsp;your&nbsp;full&nbsp;config&nbsp;(without&nbsp;comments&nbsp;or&nbsp;empty&lt;br&gt;&gt;lines)&nbsp;will&nbsp;help&nbsp;us&nbsp;point&nbsp;out&nbsp;any&nbsp;unnoticed&nbsp;issues&nbsp;for&nbsp;you&nbsp;to&nbsp;consider&lt;br&gt;&gt;fixing.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;Understood.&nbsp;&nbsp;&nbsp;Here&nbsp;it&nbsp;is:&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&nbsp;&lt;!--StartFragment--&gt;&lt;pre&gt;acl&nbsp;localnet&nbsp;src&nbsp;10.0.0.0/8&nbsp;&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;172.16.0.0/12&nbsp;&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;192.168.0.0/16&nbsp;#&nbsp;RFC1918&nbsp;possible&nbsp;internal&nbsp;network<br>
acl&nbsp;localnet&nbsp;src&nbsp;fc00::/7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4193&nbsp;local&nbsp;private&nbsp;network&nbsp;range<br>
acl&nbsp;localnet&nbsp;src&nbsp;fe80::/10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;RFC&nbsp;4291&nbsp;link-local&nbsp;(directly&nbsp;plugged)&nbsp;machines<br>
acl&nbsp;windows_net&nbsp;src&nbsp;172.18.114.0/24<br>
acl&nbsp;sample_host&nbsp;src&nbsp;172.18.115.1/32<br>
acl&nbsp;rsync&nbsp;port&nbsp;873<br>
acl&nbsp;SSL_ports&nbsp;port&nbsp;443<br>
acl&nbsp;SSL_ports&nbsp;port&nbsp;873&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#873&nbsp;is&nbsp;rsync<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ftp<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;443&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;https<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gopher<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wais<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;1025-65535&nbsp;&nbsp;#&nbsp;unregistered&nbsp;ports<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;http-mgmt<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;488&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gss-http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;filemaker<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;777&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiling&nbsp;http<br>
acl&nbsp;Safe_ports&nbsp;port&nbsp;873<br>
acl&nbsp;CONNECT&nbsp;method&nbsp;CONNECT<br>
acl&nbsp;PURGE&nbsp;method&nbsp;PURGE<br>
acl&nbsp;localhost&nbsp;src&nbsp;127.0.0.1<br>
http_access&nbsp;allow&nbsp;PURGE&nbsp;localhost<br>
http_access&nbsp;deny&nbsp;PURGE<br>
acl&nbsp;URN&nbsp;proto&nbsp;URN<br>
http_access&nbsp;deny&nbsp;URN<br>
http_access&nbsp;deny&nbsp;manager<br>
acl&nbsp;API_FIREFOX&nbsp;dstdomain&nbsp;api.profiler.firefox.com<br>
http_access&nbsp;deny&nbsp;API_FIREFOX<br>
acl&nbsp;ff_browser&nbsp;browser&nbsp;^Mozilla/5\.0<br>
acl&nbsp;rma_ua&nbsp;browser&nbsp;^RMA/1\.0.*compatible;.RealMedia<br>
uri_whitespace&nbsp;encode<br>
acl&nbsp;trellix_phone_cloud&nbsp;dstdomain&nbsp;amcore-ens.rest.gti.trellix.com<br>
http_access&nbsp;deny&nbsp;trellix_phone_cloud<br>
external_acl_type&nbsp;host_based_filter&nbsp;children-max=15&nbsp;ttl=0&nbsp;%ACL&nbsp;%DATA&nbsp;%SRC&nbsp;%&gt;rd&nbsp;%&gt;rP&nbsp;&nbsp;/PATH/TO/FILTER/SCRIPT.py<br>
acl&nbsp;HostBasedRules&nbsp;external&nbsp;host_based_filter<br>
http_access&nbsp;allow&nbsp;HostBasedRules<br>
auth_param&nbsp;digest&nbsp;program&nbsp;/usr/lib/squid/digest_file_auth&nbsp;-c&nbsp;/etc/squid/passwd<br>
auth_param&nbsp;digest&nbsp;realm&nbsp;squid<br>
auth_param&nbsp;digest&nbsp;children&nbsp;2<br>
auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ncsa_auth&nbsp;/etc/squid/basic_passwd<br>
auth_param&nbsp;basic&nbsp;children&nbsp;2<br>
auth_param&nbsp;basic&nbsp;realm&nbsp;squidb<br>
auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours<br>
acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED<br>
external_acl_type&nbsp;custom_acl_db&nbsp;children-max=15&nbsp;ttl=0&nbsp;%ACL&nbsp;%DATA&nbsp;%ul&nbsp;%SRC&nbsp;%&gt;rd&nbsp;%&gt;rP&nbsp;%credentials&nbsp;/PATH/TO/FILTER/SCRIPT.py<br>
acl&nbsp;CustomAclDB&nbsp;external&nbsp;custom_acl_db<br>
http_access&nbsp;allow&nbsp;CustomAclDB<br>
acl&nbsp;CRLs&nbsp;url_regex&nbsp;&quot;/etc/squid/conf.d/CRL_urls.txt&quot;<br>
http_access&nbsp;allow&nbsp;CRLs<br>
deny_info&nbsp;303:https://abc.def.com/<br>
http_access&nbsp;deny&nbsp;all<br>
acl&nbsp;apache&nbsp;rep_header&nbsp;Server&nbsp;^Apache<br>
icp_access&nbsp;allow&nbsp;localnet<br>
icp_access&nbsp;deny&nbsp;all<br>
http_access&nbsp;deny&nbsp;!Safe_ports<br>
http_access&nbsp;deny&nbsp;CONNECT&nbsp;!SSL_ports<br>
http_access&nbsp;allow&nbsp;localhost&nbsp;manager<br>
http_access&nbsp;deny&nbsp;manager<br>
http_access&nbsp;allow&nbsp;localhost<br>
http_port&nbsp;3128<br>
coredump_dir&nbsp;/var/cache/squid<br>
refresh_pattern&nbsp;^ftp:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10080<br>
refresh_pattern&nbsp;^gopher:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1440<br>
refresh_pattern&nbsp;-i&nbsp;(/cgi-bin/|\?)&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
refresh_pattern&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4320<br>
logformat&nbsp;squid&nbsp;%ts.%03tu&nbsp;%6tr&nbsp;%&gt;a&nbsp;%Ss/%&gt;Hs&nbsp;%&lt;st&nbsp;%rm&nbsp;%ru&nbsp;%un&nbsp;%Sh/%&lt;A&nbsp;%mt<br>
logformat&nbsp;squidmime&nbsp;%ul&nbsp;%ts.%03tu&nbsp;%6tr&nbsp;%&gt;a&nbsp;%Ss/%&gt;Hs&nbsp;%&lt;st&nbsp;%rm&nbsp;%ru&nbsp;%un&nbsp;%Sh/%&lt;A&nbsp;%mt&nbsp;[%&gt;h]&nbsp;[%&lt;h]<br>
logformat&nbsp;common&nbsp;%&gt;a&nbsp;%ui&nbsp;%un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;%Ss:%Sh<br>
logformat&nbsp;combined&nbsp;%&gt;a&nbsp;%ui&nbsp;%un&nbsp;[%tl]&nbsp;&quot;%rm&nbsp;%ru&nbsp;HTTP/%rv&quot;&nbsp;%&gt;Hs&nbsp;%&lt;st&nbsp;&quot;%{Referer}&gt;h&quot;&nbsp;&quot;%{User-Agent}&gt;h&quot;&nbsp;%Ss:%Sh<br>
logformat&nbsp;ip_port&nbsp;%ts&nbsp;%tu&nbsp;%&gt;a&nbsp;%&gt;p&nbsp;%&lt;lp&nbsp;%&lt;a&nbsp;%&lt;p&nbsp;%dt&nbsp;%tr&nbsp;%un&nbsp;%&gt;ru&nbsp;%Ss<br>
access_log&nbsp;daemon:/var/log/squid/access.log&nbsp;combined<br>
access_log&nbsp;daemon:/var/log/squid/network.log&nbsp;ip_port<br>
cache_log&nbsp;/var/log/squid/cache.log<br>
cache_store_log&nbsp;/var/log/squid/store.log<br>
access_log&nbsp;daemon:/var/log/squid/useragent.log&nbsp;useragent<br>
visible_hostname&nbsp;proxy.abc.com<br>
cache&nbsp;deny&nbsp;all&lt;/pre&gt;&lt;!--EndFragment--&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&nbsp;data-mce-bogus=&quot;1&quot;&gt;&lt;/div&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;The&nbsp;next&nbsp;line&nbsp;in&nbsp;squid.conf&nbsp;is&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;FYI&nbsp;the&nbsp;above&nbsp;just&nbsp;means&nbsp;that&nbsp;Squid&nbsp;is&nbsp;using&nbsp;authentication.&nbsp;It&nbsp;says&lt;br&gt;&gt;nothing&nbsp;about&nbsp;when&nbsp;the&nbsp;authentication&nbsp;will&nbsp;be&nbsp;(or&nbsp;not&nbsp;be)&nbsp;performed.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;...&nbsp;and&nbsp;after&nbsp;that,&nbsp;the&nbsp;external&nbsp;ACL&nbsp;that&nbsp;takes&nbsp;the&nbsp;username&nbsp;as&nbsp;well&nbsp;as&lt;br&gt;&gt;&gt;&nbsp;the&nbsp;other&nbsp;info.&lt;br&gt;&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;HTH&lt;br&gt;&gt;Amos&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
