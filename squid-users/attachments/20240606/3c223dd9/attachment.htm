<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000&quot;&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;div&nbsp;style=&quot;font-family:'arial'&nbsp;,&nbsp;'helvetica'&nbsp;,&nbsp;sans-serif;font-size:12pt;color:#000000&quot;&gt;&lt;div&gt;&gt;&gt;&nbsp;uri_whitespace&nbsp;encode&lt;br&gt;&gt;&lt;br&gt;&gt;Hmm.&nbsp;Accepting&nbsp;whitespace&nbsp;in&nbsp;URLs&nbsp;is&nbsp;a&nbsp;risky&nbsp;choice.&nbsp;One&nbsp;can&nbsp;never&nbsp;be&lt;br&gt;&gt;completely&nbsp;sure&nbsp;how&nbsp;third-party&nbsp;agents&nbsp;in&nbsp;the&nbsp;network&nbsp;are&nbsp;handling&nbsp;it&lt;br&gt;&gt;before&nbsp;the&nbsp;request&nbsp;arrived.&lt;br&gt;&gt;&lt;br&gt;&gt;If&nbsp;(big&nbsp;IF)&nbsp;you&nbsp;are&nbsp;able&nbsp;to&nbsp;use&nbsp;&quot;uri_whitespace&nbsp;deny&quot;&nbsp;this&nbsp;proxy&nbsp;would&lt;br&gt;&gt;be&nbsp;a&nbsp;bit&nbsp;more&nbsp;secure.&nbsp;This&nbsp;is&nbsp;just&nbsp;a&nbsp;suggestion,&nbsp;you&nbsp;know&nbsp;best&nbsp;here.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;I&nbsp;think&nbsp;that&nbsp;was&nbsp;a&nbsp;workaround&nbsp;for&nbsp;a&nbsp;vulnerability.&nbsp;&nbsp;If&nbsp;it&nbsp;was,&nbsp;it&nbsp;may&nbsp;no&nbsp;longer&nbsp;be&nbsp;needed.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;trellix_phone_cloud&nbsp;dstdomain&nbsp;amcore-ens.rest.gti.trellix.com&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;trellix_phone_cloud&lt;br&gt;&gt;&gt;&nbsp;external_acl_type&nbsp;host_based_filter&nbsp;children-max=15&nbsp;ttl=0&nbsp;0X0P+0CL&nbsp;&gt;&gt;&nbsp;acl&nbsp;HostBasedRules&nbsp;external&nbsp;host_based_filter&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;HostBasedRules&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;program&nbsp;/usr/lib/squid/digest_file_auth&nbsp;-c&nbsp;/etc/squid/passwd&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;realm&nbsp;squid&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;children&nbsp;2&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ncsa_auth&nbsp;/etc/squid/basic_passwd&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;children&nbsp;2&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;realm&nbsp;squidb&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;&gt;&gt;&nbsp;external_acl_type&nbsp;custom_acl_db&nbsp;children-max=15&nbsp;ttl=0&nbsp;0X0P+0CL&nbsp;&gt;&gt;&nbsp;acl&nbsp;CustomAclDB&nbsp;external&nbsp;custom_acl_db&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;CustomAclDB&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Hmm,&nbsp;this&nbsp;use&nbsp;of&nbsp;combined&nbsp;authentication+authorization&nbsp;is&nbsp;a&nbsp;bit&nbsp;tricky&lt;br&gt;&gt;with&nbsp;two&nbsp;layers&nbsp;of&nbsp;asynchronous&nbsp;helper&nbsp;lookups&nbsp;going&nbsp;on.&nbsp;That&nbsp;alone&lt;br&gt;&gt;might&nbsp;be&nbsp;what&nbsp;is&nbsp;going&nbsp;on&nbsp;with&nbsp;the&nbsp;weird&nbsp;403's.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;A&nbsp;better&nbsp;sequence&nbsp;would&nbsp;be:&lt;br&gt;&gt;&lt;br&gt;&gt;#&nbsp;ensure&nbsp;login&nbsp;is&nbsp;performed&lt;br&gt;&gt;http_access&nbsp;deny&nbsp;!auth_users&lt;br&gt;&gt;&lt;br&gt;&gt;#&nbsp;check&nbsp;the&nbsp;access&nbsp;permissions&nbsp;for&nbsp;whichever&nbsp;user&nbsp;logged&nbsp;in&lt;br&gt;&gt;http_access&nbsp;allow&nbsp;CustomAclDB&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;The&nbsp;first&nbsp;call&nbsp;the&nbsp;the&nbsp;external_acl&nbsp;is&nbsp;to&nbsp;process&nbsp;unauthenticated&nbsp;requests.&nbsp;&nbsp;&nbsp;Is&nbsp;the&nbsp;suggestion&nbsp;to&nbsp;replace&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;with&nbsp;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&nbsp;http_access&nbsp;deny&nbsp;!auth_users&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;before&nbsp;the&nbsp;second&nbsp;external_acl&nbsp;(for&nbsp;authenticated&nbsp;requests)?&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;Thanks&nbsp;again,&nbsp;very&nbsp;much&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;Kevin&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
