<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;overflow-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;line-break:&nbsp;after-white-space;&quot;&gt;You&nbsp;can&nbsp;also&nbsp;add&nbsp;this&nbsp;to&nbsp;lock&nbsp;down&nbsp;the&nbsp;proxy&nbsp;after&nbsp;hours&nbsp;so&nbsp;nothing&nbsp;is&nbsp;used&nbsp;much&nbsp;like&nbsp;locking&nbsp;a&nbsp;door,&nbsp;whatever&nbsp;is&nbsp;inside&nbsp;is&nbsp;going&nbsp;to&nbsp;keep&nbsp;working&nbsp;ie&nbsp;connections&nbsp;already&nbsp;established&nbsp;however&nbsp;all&nbsp;new&nbsp;connections&nbsp;will&nbsp;be&nbsp;blocked.&nbsp;I&nbsp;love&nbsp;this&nbsp;one&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;block_hours&nbsp;time&nbsp;00:30-05:00&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;terminate&nbsp;all&nbsp;block_hours&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;http_access&nbsp;deny&nbsp;all&nbsp;block_hours&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;however&nbsp;this&nbsp;is&nbsp;for&nbsp;use&nbsp;with&nbsp;ssl&nbsp;intercept&nbsp;and&nbsp;root&nbsp;certificates&nbsp;installed&nbsp;however&nbsp;it&nbsp;also&nbsp;works&nbsp;for&nbsp;spliced&nbsp;connections&nbsp;as&nbsp;it&nbsp;comes&nbsp;before&nbsp;everything&nbsp;else&nbsp;the&nbsp;terminate&nbsp;everything&nbsp;line&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;you&nbsp;can&nbsp;also&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;lock&nbsp;down&nbsp;to&nbsp;specific&nbsp;mac&nbsp;addresses&nbsp;ie&nbsp;small&nbsp;office&nbsp;home&nbsp;network&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;use&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;eui_lookup&nbsp;on&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Example&nbsp;of&nbsp;use&nbsp;with&nbsp;mac&nbsp;addresses&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only&nbsp;src&nbsp;192.168.1.8&nbsp;#Tasha&nbsp;iPhone&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only&nbsp;src&nbsp;192.168.1.10&nbsp;#Jon&nbsp;iPhone&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only&nbsp;src&nbsp;192.168.1.11&nbsp;#Amazon&nbsp;Fire&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only&nbsp;src&nbsp;192.168.1.15&nbsp;#Tasha&nbsp;HP&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only&nbsp;src&nbsp;192.168.1.16&nbsp;#iPad&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only_mac&nbsp;arp&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only_mac&nbsp;arp&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;splice_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;NoSSLIntercept&nbsp;ssl::server_name_regex&nbsp;-i&nbsp;&quot;/usr/local/pkg/reg.url.nobump&quot;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;NoBumpDNS&nbsp;dstdomain&nbsp;&quot;/usr/local/pkg/dns.nobump&quot;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;markBumped&nbsp;annotate_client&nbsp;bumped=true&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;active_use&nbsp;annotate_client&nbsp;active=true&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only&nbsp;src&nbsp;192.168.1.3&nbsp;#webtv&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only&nbsp;src&nbsp;192.168.1.4&nbsp;#toshiba&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only&nbsp;src&nbsp;192.168.1.5&nbsp;#imac&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only&nbsp;src&nbsp;192.168.1.9&nbsp;#macbook&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only&nbsp;src&nbsp;192.168.1.13&nbsp;#dell&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only_mac&nbsp;arp&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;bump_only_mac&nbsp;arp&nbsp;&nbsp;(unique&nbsp;48bit&nbsp;hardware&nbsp;address&nbsp;here)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;peek&nbsp;step1&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;miss_access&nbsp;deny&nbsp;no_miss&nbsp;active_use&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;splice&nbsp;https_login&nbsp;active_use&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;splice&nbsp;splice_only_mac&nbsp;splice_only&nbsp;active_use&nbsp;(this&nbsp;works&nbsp;as&nbsp;“and&nbsp;logic”&nbsp;except&nbsp;my&nbsp;annotate&nbsp;active&nbsp;use)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;splice&nbsp;NoBumpDNS&nbsp;active_use&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;splice&nbsp;NoSSLIntercept&nbsp;active_use&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;bump&nbsp;bump_only_mac&nbsp;bump_only&nbsp;active_use&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;activated&nbsp;note&nbsp;active_use&nbsp;true&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;ssl_bump&nbsp;terminate&nbsp;!activated&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;acl&nbsp;markedBumped&nbsp;note&nbsp;bumped&nbsp;true&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;url_rewrite_access&nbsp;deny&nbsp;markedBumped&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;On&nbsp;Jun&nbsp;6,&nbsp;2024,&nbsp;at&nbsp;12:08,&nbsp;Kevin&nbsp;&lt;squid@kretz.net&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;div&nbsp;data-marker=&quot;__QUOTED_TEXT__&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;helvetica,&nbsp;sans-serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;div&gt;&gt;&gt;&nbsp;uri_whitespace&nbsp;encode&lt;br&gt;&gt;&lt;br&gt;&gt;Hmm.&nbsp;Accepting&nbsp;whitespace&nbsp;in&nbsp;URLs&nbsp;is&nbsp;a&nbsp;risky&nbsp;choice.&nbsp;One&nbsp;can&nbsp;never&nbsp;be&lt;br&gt;&gt;completely&nbsp;sure&nbsp;how&nbsp;third-party&nbsp;agents&nbsp;in&nbsp;the&nbsp;network&nbsp;are&nbsp;handling&nbsp;it&lt;br&gt;&gt;before&nbsp;the&nbsp;request&nbsp;arrived.&lt;br&gt;&gt;&lt;br&gt;&gt;If&nbsp;(big&nbsp;IF)&nbsp;you&nbsp;are&nbsp;able&nbsp;to&nbsp;use&nbsp;&quot;uri_whitespace&nbsp;deny&quot;&nbsp;this&nbsp;proxy&nbsp;would&lt;br&gt;&gt;be&nbsp;a&nbsp;bit&nbsp;more&nbsp;secure.&nbsp;This&nbsp;is&nbsp;just&nbsp;a&nbsp;suggestion,&nbsp;you&nbsp;know&nbsp;best&nbsp;here.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;I&nbsp;think&nbsp;that&nbsp;was&nbsp;a&nbsp;workaround&nbsp;for&nbsp;a&nbsp;vulnerability.&nbsp;&nbsp;If&nbsp;it&nbsp;was,&nbsp;it&nbsp;may&nbsp;no&nbsp;longer&nbsp;be&nbsp;needed.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;trellix_phone_cloud&nbsp;dstdomain&nbsp;amcore-ens.rest.gti.trellix.com&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;deny&nbsp;trellix_phone_cloud&lt;br&gt;&gt;&gt;&nbsp;external_acl_type&nbsp;host_based_filter&nbsp;children-max=15&nbsp;ttl=0&nbsp;0X0P+0CL&nbsp;&gt;&gt;&nbsp;acl&nbsp;HostBasedRules&nbsp;external&nbsp;host_based_filter&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;HostBasedRules&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;program&nbsp;/usr/lib/squid/digest_file_auth&nbsp;-c&nbsp;/etc/squid/passwd&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;realm&nbsp;squid&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;digest&nbsp;children&nbsp;2&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ncsa_auth&nbsp;/etc/squid/basic_passwd&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;children&nbsp;2&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;realm&nbsp;squidb&lt;br&gt;&gt;&gt;&nbsp;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;2&nbsp;hours&lt;br&gt;&gt;&lt;br&gt;&gt;&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;&gt;&gt;&nbsp;external_acl_type&nbsp;custom_acl_db&nbsp;children-max=15&nbsp;ttl=0&nbsp;0X0P+0CL&nbsp;&gt;&gt;&nbsp;acl&nbsp;CustomAclDB&nbsp;external&nbsp;custom_acl_db&lt;br&gt;&gt;&gt;&nbsp;http_access&nbsp;allow&nbsp;CustomAclDB&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;Hmm,&nbsp;this&nbsp;use&nbsp;of&nbsp;combined&nbsp;authentication+authorization&nbsp;is&nbsp;a&nbsp;bit&nbsp;tricky&lt;br&gt;&gt;with&nbsp;two&nbsp;layers&nbsp;of&nbsp;asynchronous&nbsp;helper&nbsp;lookups&nbsp;going&nbsp;on.&nbsp;That&nbsp;alone&lt;br&gt;&gt;might&nbsp;be&nbsp;what&nbsp;is&nbsp;going&nbsp;on&nbsp;with&nbsp;the&nbsp;weird&nbsp;403's.&lt;br&gt;&gt;&lt;br&gt;&gt;&lt;br&gt;&gt;A&nbsp;better&nbsp;sequence&nbsp;would&nbsp;be:&lt;br&gt;&gt;&lt;br&gt;&gt;#&nbsp;ensure&nbsp;login&nbsp;is&nbsp;performed&lt;br&gt;&gt;http_access&nbsp;deny&nbsp;!auth_users&lt;br&gt;&gt;&lt;br&gt;&gt;#&nbsp;check&nbsp;the&nbsp;access&nbsp;permissions&nbsp;for&nbsp;whichever&nbsp;user&nbsp;logged&nbsp;in&lt;br&gt;&gt;http_access&nbsp;allow&nbsp;CustomAclDB&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;The&nbsp;first&nbsp;call&nbsp;the&nbsp;the&nbsp;external_acl&nbsp;is&nbsp;to&nbsp;process&nbsp;unauthenticated&nbsp;requests.&nbsp;&nbsp;&nbsp;Is&nbsp;the&nbsp;suggestion&nbsp;to&nbsp;replace&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&nbsp;acl&nbsp;auth_users&nbsp;proxy_auth&nbsp;REQUIRED&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;with&nbsp;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&nbsp;http_access&nbsp;deny&nbsp;!auth_users&nbsp;&lt;/div&gt;&lt;br&gt;&lt;div&gt;before&nbsp;the&nbsp;second&nbsp;external_acl&nbsp;(for&nbsp;authenticated&nbsp;requests)?&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;Thanks&nbsp;again,&nbsp;very&nbsp;much&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;Kevin&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;squid-users@lists.squid-cache.org&lt;br&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
