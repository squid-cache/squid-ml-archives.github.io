<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&nbsp;Andre,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Your&nbsp;logs&nbsp;say: &lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;&gt;&nbsp;winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So &lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;In&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;addition&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;to&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;Francesco&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&#39;s&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;suggestion,&nbsp;&lt;/span&gt;you&nbsp;can&nbsp;try&nbsp;to&nbsp;increase the&nbsp;&quot;winbind&nbsp;max&nbsp;clients&quot;&nbsp;parameter&nbsp;in&nbsp;your&nbsp;smb.conf&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Your&nbsp;squid.conf&nbsp;record:&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace&quot;&gt;auth_param&nbsp;ntlm&nbsp;children&nbsp;500&nbsp;startup=5&nbsp;idle=1&lt;/font&gt; &lt;br&gt;&lt;/div&gt;&lt;div&gt;limits&nbsp;the&nbsp;number&nbsp;of&nbsp;ntlm-helpers,&nbsp;but&nbsp;in&nbsp;the&nbsp;SMP&nbsp;squid&nbsp;configuration&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;this&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;value&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;is&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;multiplied&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;by&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;the&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;number&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;of&nbsp;workers&nbsp;(&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;although&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;I&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;did&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;not&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;notice&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;the&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;activation&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;of&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;multiprocessing&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;support&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;in&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;your&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;squid&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;configuration&lt;/span&gt;).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kind&nbsp;regards,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; Andrey&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;ср,&nbsp;24&nbsp;июл.&nbsp;2024 г.&nbsp;в&nbsp;21:57,&nbsp;Francesco&nbsp;Chemolli&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gkinkie@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gkinkie@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Hi&nbsp;Andre,&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;chain&nbsp;of&nbsp;services&nbsp;here&nbsp;is:&lt;br&gt;<br>
&lt;br&gt;<br>
browser&nbsp;&lt;-&gt;&nbsp;squid&nbsp;&lt;-&gt;&nbsp;ntlm_auth&nbsp;&lt;-&gt;&nbsp;winbindd&nbsp;&lt;-&gt;&nbsp;active&nbsp;directory&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;order&nbsp;to&nbsp;bisect&nbsp;the&nbsp;problem,&nbsp;could&nbsp;you&nbsp;try&nbsp;using&nbsp;`wbinfo&nbsp;-a`&nbsp;on&nbsp;one&lt;br&gt;<br>
of&nbsp;the&nbsp;affected&nbsp;machiens&nbsp;to&nbsp;authenticate&nbsp;against&nbsp;Active&nbsp;Directory&nbsp;and&lt;br&gt;<br>
see&nbsp;if&nbsp;the&nbsp;performance&nbsp;is&nbsp;on&nbsp;the&nbsp;winbindd&nbsp;&lt;-&gt;&nbsp;AD&nbsp;side&nbsp;of&nbsp;the&nbsp;equation&lt;br&gt;<br>
on&nbsp;on&nbsp;the&nbsp;squid&nbsp;&lt;-&gt;&nbsp;ntlm_auth&nbsp;side?&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Wed,&nbsp;Jul&nbsp;24,&nbsp;2024&nbsp;at&nbsp;7:27 PM&nbsp;Andre&nbsp;Bolinhas&lt;br&gt;<br>
&lt;&lt;a&nbsp;href=&quot;mailto:andre.bolinhas@articatech.com&quot;&nbsp;target=&quot;_blank&quot;&gt;andre.bolinhas@articatech.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;Team.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;using&nbsp;SQUID&nbsp;5.9&nbsp;+&nbsp;windbindd&nbsp;4.9.5,&nbsp;the&nbsp;authentication&nbsp;method&nbsp;is&nbsp;NTLM.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Every&nbsp;day,&nbsp;around&nbsp;5pm,&nbsp;the&nbsp;internet&nbsp;speed&nbsp;becomes&nbsp;very&nbsp;slow,&nbsp;with&nbsp;users&nbsp;reporting&nbsp;that&nbsp;websites&nbsp;takes&nbsp;too&nbsp;long&nbsp;to&nbsp;open.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Also,&nbsp;the&nbsp;time&nbsp;that&nbsp;the&nbsp;issue&nbsp;occur&nbsp;is&nbsp;very&nbsp;strange,&nbsp;since&nbsp;is&nbsp;when&nbsp;most&nbsp;of&nbsp;the&nbsp;users&nbsp;are&nbsp;not&nbsp;in&nbsp;the&nbsp;office&nbsp;anymore&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;By&nbsp;doing&nbsp;a&nbsp;deep&nbsp;analyze&nbsp;on&nbsp;Proxy&nbsp;server,&nbsp;I&nbsp;manage&nbsp;to&nbsp;find&nbsp;this&nbsp;error&nbsp;that&nbsp;could&nbsp;be&nbsp;related&nbsp;with&nbsp;this&nbsp;issue.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Cache.log&lt;br&gt;<br>
&gt;&nbsp;GENSEC&nbsp;login&nbsp;failed:&nbsp;NT_STATUS_LOGON_FAILURE&lt;br&gt;<br>
&gt;&nbsp;GENSEC&nbsp;login&nbsp;failed:&nbsp;NT_STATUS_LOGON_FAILURE&lt;br&gt;<br>
&gt;&nbsp;GENSEC&nbsp;login&nbsp;failed:&nbsp;NT_STATUS_LOGON_FAILURE&lt;br&gt;<br>
&gt;&nbsp;GENSEC&nbsp;login&nbsp;failed:&nbsp;NT_STATUS_LOGON_FAILURE&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Windbindd.log&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.220216, &nbsp;2]&nbsp;../source3/winbindd/winbindd.c:1121(remove_client)&lt;br&gt;<br>
&gt; &nbsp; final&nbsp;write&nbsp;to&nbsp;client&nbsp;failed:&nbsp;Broken&nbsp;pipe&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.220319, &nbsp;0]&nbsp;../source3/winbindd/winbindd.c:1246(winbindd_listen_fde_handler)&lt;br&gt;<br>
&gt; &nbsp; winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.261482, &nbsp;0]&nbsp;../source3/winbindd/winbindd.c:1246(winbindd_listen_fde_handler)&lt;br&gt;<br>
&gt; &nbsp; winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.261857, &nbsp;2]&nbsp;../source3/winbindd/winbindd.c:1121(remove_client)&lt;br&gt;<br>
&gt; &nbsp; final&nbsp;write&nbsp;to&nbsp;client&nbsp;failed:&nbsp;Broken&nbsp;pipe&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.261926, &nbsp;0]&nbsp;../source3/winbindd/winbindd.c:1246(winbindd_listen_fde_handler)&lt;br&gt;<br>
&gt; &nbsp; winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.276216, &nbsp;0]&nbsp;../source3/winbindd/winbindd.c:1246(winbindd_listen_fde_handler)&lt;br&gt;<br>
&gt; &nbsp; winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.276507, &nbsp;2]&nbsp;../source3/winbindd/winbindd.c:1121(remove_client)&lt;br&gt;<br>
&gt; &nbsp; final&nbsp;write&nbsp;to&nbsp;client&nbsp;failed:&nbsp;Broken&nbsp;pipe&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:06:48.276568, &nbsp;0]&nbsp;../source3/winbindd/winbindd.c:1246(winbindd_listen_fde_handler)&lt;br&gt;<br>
&gt; &nbsp; winbindd:&nbsp;Exceeding&nbsp;500&nbsp;client&nbsp;connections,&nbsp;no&nbsp;idle&nbsp;connection&nbsp;found&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:09:02.512093, &nbsp;1]&nbsp;../source4/lib/messaging/messaging.c:83(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;server&nbsp;10301&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:09:02.512159, &nbsp;1]&nbsp;../source3/lib/messages.c:131(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;PID&nbsp;10301&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:11:27.979681, &nbsp;1]&nbsp;../source3/winbindd/winbindd_util.c:440(trustdom_list_done)&lt;br&gt;<br>
&gt; &nbsp; trustdom_list_done:&nbsp;Could&nbsp;not&nbsp;receive&nbsp;trusts&nbsp;for&nbsp;domain&nbsp;BANK&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:11:27.979756, &nbsp;1]&nbsp;../source3/winbindd/winbindd_util.c:440(trustdom_list_done)&lt;br&gt;<br>
&gt; &nbsp; trustdom_list_done:&nbsp;Could&nbsp;not&nbsp;receive&nbsp;trusts&nbsp;for&nbsp;domain&nbsp;HLGROUP&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:12:02.612725, &nbsp;1]&nbsp;../source4/lib/messaging/messaging.c:83(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;server&nbsp;4706&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:12:02.612794, &nbsp;1]&nbsp;../source3/lib/messages.c:131(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;PID&nbsp;4706&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:15:03.307322, &nbsp;1]&nbsp;../source4/lib/messaging/messaging.c:83(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;server&nbsp;13541&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:15:03.307477, &nbsp;1]&nbsp;../source3/lib/messages.c:131(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;PID&nbsp;13541&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:18:02.603927, &nbsp;1]&nbsp;../source4/lib/messaging/messaging.c:83(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;server&nbsp;27640&nbsp;[]&lt;br&gt;<br>
&gt;&nbsp;[2024/07/22&nbsp;17:18:02.603983, &nbsp;1]&nbsp;../source3/lib/messages.c:131(ping_message)&lt;br&gt;<br>
&gt; &nbsp; INFO:&nbsp;Received&nbsp;PING&nbsp;message&nbsp;from&nbsp;PID&nbsp;27640&nbsp;[]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;smb.conf&lt;br&gt;<br>
&gt;&nbsp;[global]&lt;br&gt;<br>
&gt; &nbsp; &nbsp;netbios&nbsp;name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;ASP02&lt;br&gt;<br>
&gt; &nbsp; &nbsp;log&nbsp;level &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;2&lt;br&gt;<br>
&gt; &nbsp; &nbsp;workgroup &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;mydom&lt;br&gt;<br>
&gt; &nbsp; &nbsp;kerberos&nbsp;method &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;dedicated&nbsp;keytab&lt;br&gt;<br>
&gt; &nbsp; &nbsp;dedicated&nbsp;keytab&nbsp;file &nbsp; &nbsp; &nbsp;=&nbsp;/etc/krb5.keytab&lt;br&gt;<br>
&gt; &nbsp; &nbsp;realm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;mydom.MY&lt;br&gt;<br>
&gt; &nbsp; &nbsp;password&nbsp;server &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;10.150.1.62&lt;br&gt;<br>
&gt; &nbsp; &nbsp;security &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;ads&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;enum&nbsp;groups &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;enum&nbsp;users &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;*&nbsp;:&nbsp;backend &nbsp; =&nbsp;tdb&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;*&nbsp;:&nbsp;range &nbsp; &nbsp; =&nbsp;3000-7999&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;mydom:backend&nbsp;=&nbsp;ad&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;mydom:schema_mode&nbsp;=&nbsp;rfc2307&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;mydom:range&nbsp;=&nbsp;10000-999999&lt;br&gt;<br>
&gt; &nbsp; &nbsp;idmap&nbsp;config&nbsp;mydom:unix_nss_info&nbsp;=&nbsp;yes&lt;br&gt;<br>
&gt;&nbsp;tls&nbsp;enabled&nbsp;=&nbsp;yes&lt;br&gt;<br>
&gt;&nbsp;ldap&nbsp;ssl&nbsp;=&nbsp;start&nbsp;tls&lt;br&gt;<br>
&gt;&nbsp;tls&nbsp;keyfile &nbsp;=&nbsp;tls/key.pem&lt;br&gt;<br>
&gt;&nbsp;tls&nbsp;certfile&nbsp;=&nbsp;tls/cert.pem&lt;br&gt;<br>
&gt;&nbsp;tls&nbsp;cafile &nbsp; =&nbsp;tls/ca.pem&lt;br&gt;<br>
&gt;&nbsp;client&nbsp;ldap&nbsp;sasl&nbsp;wrapping&nbsp;=&nbsp;plain&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;ntlmv2&nbsp;auth &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;Yes&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;lanman&nbsp;auth &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;ldap&nbsp;sasl&nbsp;wrapping &nbsp;=&nbsp;sign&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;normalize&nbsp;names &nbsp; &nbsp;=&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;separator &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;/&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;use&nbsp;default&nbsp;domain&nbsp;=&nbsp;yes&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;nested&nbsp;groups &nbsp; &nbsp; &nbsp;=&nbsp;Yes&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;reconnect&nbsp;delay &nbsp; &nbsp;=&nbsp;30&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;offline&nbsp;logon &nbsp; &nbsp; &nbsp;=&nbsp;true&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;cache&nbsp;time &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;1800&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;refresh&nbsp;tickets &nbsp; &nbsp;=&nbsp;true&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;refresh&nbsp;tickets &nbsp; &nbsp;=&nbsp;true&lt;br&gt;<br>
&gt; &nbsp; &nbsp;winbind&nbsp;max&nbsp;clients &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;500&lt;br&gt;<br>
&gt; &nbsp; &nbsp;allow&nbsp;trusted&nbsp;domains &nbsp; &nbsp; &nbsp;=&nbsp;Yes&lt;br&gt;<br>
&gt; &nbsp; &nbsp;server&nbsp;signing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;auto&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;signing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;auto&lt;br&gt;<br>
&gt; &nbsp; &nbsp;lm&nbsp;announce &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;ntlm&nbsp;auth &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;lanman&nbsp;auth &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;preferred&nbsp;master &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;local&nbsp;master &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;wins&nbsp;support &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;No&lt;br&gt;<br>
&gt; &nbsp; &nbsp;encrypt&nbsp;passwords &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;yes&lt;br&gt;<br>
&gt; &nbsp; &nbsp;printing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;bsd&lt;br&gt;<br>
&gt; &nbsp; &nbsp;load&nbsp;printers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;no&lt;br&gt;<br>
&gt; &nbsp; &nbsp;socket&nbsp;options &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;TCP_NODELAY&nbsp;SO_RCVBUF=8192&nbsp;SO_SNDBUF=8192&lt;br&gt;<br>
&gt; &nbsp; &nbsp;min&nbsp;protocol &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;SMB2&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;min&nbsp;protocol &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;SMB2&lt;br&gt;<br>
&gt; &nbsp; &nbsp;client&nbsp;max&nbsp;protocol &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;SMB3&lt;br&gt;<br>
&gt; &nbsp; &nbsp;load&nbsp;printers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;no&lt;br&gt;<br>
&gt; &nbsp; &nbsp;printing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;bsd&lt;br&gt;<br>
&gt; &nbsp; &nbsp;printcap&nbsp;name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;/dev/null&lt;br&gt;<br>
&gt; &nbsp; &nbsp;disable&nbsp;spoolss &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;yes&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Squid.conf&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;kerberos_conf()&nbsp;LockActiveDirectoryToKerberos&nbsp;=&nbsp;0&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#KerbAuthMethod&nbsp;=&nbsp;0/1&nbsp;and&nbsp;NOT_NTLM&nbsp;=&nbsp;False&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;ntlm&nbsp;program&nbsp;/usr/bin/ntlm_auth &nbsp;--domain=mydom.MY&nbsp;--helper-protocol=squid-2.5-ntlmssp&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;ntlm&nbsp;children&nbsp;500&nbsp;startup=5&nbsp;idle=1&nbsp;concurrency=0&nbsp;queue-size=2000&nbsp;on-persistent-overload=ERR&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;ntlm&nbsp;keep_alive&nbsp;off&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;ads&nbsp;groups&nbsp;OK&lt;br&gt;<br>
&gt;&nbsp;#Other&nbsp;settings&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;7200&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_ttl&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_ip_ttl&nbsp;1&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_cache_garbage_interval&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;authFailed&nbsp;src&nbsp;all&lt;br&gt;<br>
&gt;&nbsp;acl&nbsp;AUTHENTICATED&nbsp;proxy_auth&nbsp;REQUIRED&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;END&nbsp;NTLM&nbsp;Parameters&nbsp;--------------------------------&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;Basic&nbsp;authentication&nbsp;for&nbsp;other&nbsp;browser&nbsp;that&nbsp;did&nbsp;not&nbsp;supports&nbsp;NTLM&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/bin/ntlm_auth&nbsp;--helper-protocol=squid-2.5-basic&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;basic&nbsp;children&nbsp;60&nbsp;startup=2&nbsp;idle=1&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;basic&nbsp;realm&nbsp;Active&nbsp;Directory&nbsp;Basic&nbsp;Identification&lt;br&gt;<br>
&gt;&nbsp;auth_param&nbsp;basic&nbsp;credentialsttl&nbsp;7200&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_ttl&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_ip_ttl&nbsp;1&nbsp;seconds&lt;br&gt;<br>
&gt;&nbsp;authenticate_cache_garbage_interval&nbsp;3600&nbsp;seconds&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;ldap_auth_ad()&nbsp;EnableAdLDAPAuth&nbsp;=&nbsp;0&nbsp;-&nbsp;SKIP&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;ads&nbsp;groups&nbsp;OK&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#&nbsp;--------------------------------------------------&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
 &nbsp; &nbsp;Francesco&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
