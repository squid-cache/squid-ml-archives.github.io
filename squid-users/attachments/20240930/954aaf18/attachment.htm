<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;br&gt;&lt;br&gt;I&nbsp;need&nbsp;Squid&nbsp;to&nbsp;handle&nbsp;multiple&nbsp;IP&nbsp;addresses&nbsp;(more&nbsp;than&nbsp;128),&nbsp;each&nbsp;bound&nbsp;to&nbsp;port&nbsp;3128,&nbsp;with&nbsp;different&nbsp;users&nbsp;authenticated&nbsp;and&nbsp;assigned&nbsp;to&nbsp;specific&nbsp;IP&nbsp;addresses&nbsp;for&nbsp;outgoing&nbsp;traffic.&nbsp;However,&nbsp;I’ve&nbsp;encountered&nbsp;a&nbsp;limitation&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;IP&nbsp;addresses/ports&nbsp;that&nbsp;Squid&nbsp;can&nbsp;listen&nbsp;on.&lt;br&gt;&lt;br&gt;&lt;br&gt;Example&nbsp;configuration:&lt;br&gt;&lt;br&gt;http_port&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.1:3128&quot;&gt;192.168.1.1:3128&lt;/a&gt;&lt;br&gt;http_port&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.2:3128&quot;&gt;192.168.1.2:3128&lt;/a&gt;&lt;br&gt;[...]&lt;br&gt;http_port&nbsp;&lt;a&nbsp;href=&quot;http://192.168.1.254:3128&quot;&gt;192.168.1.254:3128&lt;/a&gt;&lt;br&gt;&lt;br&gt;auth_param&nbsp;basic&nbsp;program&nbsp;/usr/lib/squid/basic_ncsa_auth&nbsp;/etc/squid/squid_passwd&lt;br&gt;auth_param&nbsp;basic&nbsp;children&nbsp;5&lt;br&gt;auth_param&nbsp;basic&nbsp;realm&nbsp;Squid_Proxy&lt;br&gt;auth_param&nbsp;basic&nbsp;casesensitive&nbsp;off&lt;br&gt;shutdown_lifetime&nbsp;1&nbsp;seconds&lt;br&gt;&lt;br&gt;acl&nbsp;user1&nbsp;proxy_auth&nbsp;user1&lt;br&gt;acl&nbsp;user2&nbsp;proxy_auth&nbsp;user2&lt;br&gt;[...]&lt;br&gt;acl&nbsp;user254&nbsp;proxy_auth&nbsp;user254&lt;br&gt;&lt;br&gt;acl&nbsp;ip_192_168_1_1&nbsp;localip&nbsp;192.168.1.1&lt;br&gt;acl&nbsp;ip_192_168_1_2&nbsp;localip&nbsp;192.168.1.2&lt;br&gt;[...]&lt;br&gt;acl&nbsp;ip_192_168_1_254&nbsp;localip&nbsp;192.168.1.254&lt;br&gt;&lt;br&gt;tcp_outgoing_address&nbsp;192.168.1.1&nbsp;user1&lt;br&gt;tcp_outgoing_address&nbsp;192.168.1.2&nbsp;user2&lt;br&gt;[...]&lt;br&gt;tcp_outgoing_address&nbsp;192.168.1.254&nbsp;user254&lt;br&gt;&lt;br&gt;http_access&nbsp;allow&nbsp;user1&nbsp;ip_192_168_1_1&lt;br&gt;http_access&nbsp;allow&nbsp;user2&nbsp;ip_192_168_1_2&lt;br&gt;[...]&lt;br&gt;http_access&nbsp;allow&nbsp;user254&nbsp;ip_192_168_1_254&lt;br&gt;&lt;br&gt;http_access&nbsp;deny&nbsp;all&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Compilation&nbsp;Attempts:&lt;br&gt;Recompiling&nbsp;using&nbsp;dpkg-buildpackage&nbsp;with&nbsp;the&nbsp;CXXFLAGS:&lt;br&gt;&lt;br&gt;sudo&nbsp;apt-get&nbsp;build-dep&nbsp;squid&lt;br&gt;apt-get&nbsp;source&nbsp;squid&lt;br&gt;cd&nbsp;squid-*&lt;br&gt;export&nbsp;CXXFLAGS=&quot;-DMAXTCPLISTENPORTS=254&quot;&lt;br&gt;dpkg-buildpackage&nbsp;-us&nbsp;-uc&lt;br&gt;sudo&nbsp;dpkg&nbsp;-i&nbsp;../squid_5.2-1ubuntu4_amd64.deb&nbsp;../squid-common_5.2-1ubuntu4_all.deb&lt;br&gt;&lt;br&gt;However,&nbsp;when&nbsp;I&nbsp;run&nbsp;squid&nbsp;-v,&nbsp;the&nbsp;CXXFLAGS=&quot;-DMAXTCPLISTENPORTS=254&quot;&nbsp;flag&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;compiled&nbsp;version.&nbsp;This&nbsp;makes&nbsp;me&nbsp;question&nbsp;if&nbsp;the&nbsp;custom&nbsp;flag&nbsp;is&nbsp;even&nbsp;applied.&lt;br&gt;&lt;br&gt;Compiling&nbsp;manually&nbsp;with&nbsp;make:&lt;br&gt;&lt;br&gt;wget&nbsp;&lt;a&nbsp;href=&quot;http://www.squid-cache.org/Versions/v5/squid-5.2.tar.gz&quot;&gt;http://www.squid-cache.org/Versions/v5/squid-5.2.tar.gz&lt;/a&gt;&lt;br&gt;tar&nbsp;-xzf&nbsp;squid-5.2.tar.gz&lt;br&gt;cd&nbsp;squid-5.2&lt;br&gt;export&nbsp;CXXFLAGS=&quot;-DMAXTCPLISTENPORTS=254&quot;&lt;br&gt;./configure&nbsp;--prefix=/usr&nbsp;--localstatedir=/var&nbsp;--libexecdir=/usr/lib/squid&nbsp;--datadir=/usr/share/squid&nbsp;\&lt;br&gt;--sysconfdir=/etc/squid&nbsp;--with-logdir=/var/log/squid&nbsp;--with-pidfile=/var/run/squid.pid&nbsp;\&lt;br&gt;--enable-ssl&nbsp;--enable-ssl-crtd&nbsp;--enable-auth&nbsp;--enable-cache-digests&nbsp;\&lt;br&gt;--enable-removal-policies=&quot;lru,heap&quot;&nbsp;--enable-follow-x-forwarded-for&lt;br&gt;make&lt;br&gt;sudo&nbsp;make&nbsp;install&lt;br&gt;But&nbsp;again,&nbsp;after&nbsp;running&nbsp;squid&nbsp;-v,&nbsp;the&nbsp;custom&nbsp;flag&nbsp;doesn&#39;t&nbsp;appear,&nbsp;and&nbsp;the&nbsp;limit&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;listening&nbsp;IP&nbsp;addresses&nbsp;is&nbsp;still&nbsp;in&nbsp;place.&lt;br&gt;&lt;br&gt;I’ve&nbsp;tested&nbsp;with&nbsp;various&nbsp;versions&nbsp;of&nbsp;Squid,&nbsp;ranging&nbsp;from&nbsp;4.8&nbsp;to&nbsp;5.9,&nbsp;but&nbsp;none&nbsp;of&nbsp;them&nbsp;seem&nbsp;to&nbsp;apply&nbsp;the&nbsp;custom&nbsp;flag&nbsp;for&nbsp;increasing&nbsp;the&nbsp;number&nbsp;of&nbsp;listening&nbsp;addresses/ports.&lt;br&gt;&lt;br&gt;Questions:&lt;br&gt;How&nbsp;can&nbsp;I&nbsp;confirm&nbsp;that&nbsp;Squid&nbsp;is&nbsp;applying&nbsp;the&nbsp;MAXTCPLISTENPORTS&nbsp;value?&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;force&nbsp;Squid&nbsp;to&nbsp;recognize&nbsp;this&nbsp;parameter?&lt;br&gt;Is&nbsp;there&nbsp;an&nbsp;alternative&nbsp;method&nbsp;to&nbsp;configure&nbsp;Squid&nbsp;to&nbsp;handle&nbsp;254&nbsp;IP&nbsp;addresses&nbsp;without&nbsp;recompiling?&nbsp;Am&nbsp;I&nbsp;missing&nbsp;a&nbsp;critical&nbsp;step&nbsp;in&nbsp;the&nbsp;build&nbsp;process?&lt;br&gt;Do&nbsp;you&nbsp;have&nbsp;any&nbsp;recommendations&nbsp;to&nbsp;optimize&nbsp;the&nbsp;configuration&nbsp;for&nbsp;managing&nbsp;an&nbsp;entire&nbsp;/24&nbsp;prefix&nbsp;with&nbsp;254&nbsp;addresses?&lt;br&gt;Any&nbsp;advice&nbsp;or&nbsp;suggestions&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated!&nbsp;I’ve&nbsp;done&nbsp;extensive&nbsp;research&nbsp;on&nbsp;the&nbsp;issue,&nbsp;but&nbsp;I&nbsp;haven’t&nbsp;found&nbsp;a&nbsp;solution&nbsp;yet.&lt;br&gt;&lt;br&gt;Thanks&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;help!&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&lt;br&gt;Alexis&lt;/div&gt;&lt;/div&gt;<br>

</tt>
