<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Jonathan,&lt;div&gt; &nbsp;the&nbsp;problem&nbsp;is:&nbsp;can&nbsp;you&nbsp;even&nbsp;see&nbsp;the&nbsp;HTTP&nbsp;being&nbsp;exchanged?&lt;/div&gt;&lt;div&gt;This&nbsp;requires&nbsp;TLS&nbsp;interception.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;can,&nbsp;then&nbsp;it&#39;s&nbsp;relatively&nbsp;easy:&nbsp;you&nbsp;can&nbsp;to&nbsp;filter&nbsp;on&nbsp;(untested)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;acl&nbsp;doh_post_ct&nbsp;Content-Type&nbsp;-i application/dns-message&lt;/div&gt;&lt;div&gt;acl&nbsp;doh_path_rfc8484&nbsp;urlpath_regex&nbsp;^/dns-query&lt;/div&gt;&lt;div&gt;acl&nbsp;doh_query_rfc8484&nbsp;urlpath_regex&nbsp;dns=&lt;/div&gt;&lt;div&gt;acl&nbsp;doh_path_json&nbsp;urlpath_regex&nbsp;^/resolve&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;doh_post_ct&nbsp;doh_path_json&lt;/div&gt;&lt;div&gt;http_access&nbsp;deny&nbsp;doh_path_rfc8484&nbsp;doh_query_rfc8484&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If,&nbsp;however,&nbsp;you&nbsp;cannot&nbsp;inspect&nbsp;the&nbsp;HTTP&nbsp;payload&nbsp;in&nbsp;TLS,&nbsp;your&nbsp;only&nbsp;option&nbsp;is&nbsp;to&nbsp;blacklist&nbsp;all&nbsp;DOH&nbsp;providers&nbsp;by&nbsp;DNS&nbsp;name&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&nbsp;gmail_quote_container&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sat,&nbsp;Jan&nbsp;11,&nbsp;2025&nbsp;at&nbsp;1:32 AM&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jonathanlee571@gmail.com&quot;&gt;jonathanlee571@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;acl&nbsp;deny_rep_mime_doh&nbsp;rep_mime_type&nbsp;application/dns-message&lt;br&gt;<br>
&lt;br&gt;<br>
for&nbsp;example&nbsp;would&nbsp;this&nbsp;work?&nbsp;I&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;a&nbsp;huge&nbsp;list&nbsp;and&nbsp;save&nbsp;memory&nbsp;if&nbsp;this&nbsp;solves&nbsp;my&nbsp;wackamole&nbsp;problem.&nbsp;I&nbsp;do&nbsp;not&nbsp;see&nbsp;anything&nbsp;on&nbsp;the&nbsp;Squid&nbsp;website&nbsp;but&nbsp;in&nbsp;theory&nbsp;that&nbsp;could&nbsp;resolve&nbsp;it&nbsp;right?&lt;br&gt;<br>
&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;&lt;a&nbsp;href=&quot;mailto:jonathanlee571@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jonathanlee571@gmail.com&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jonathanlee571@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jonathanlee571@gmail.com&lt;/a&gt;&gt;&nbsp;&lt;br&gt;<br>
Sent:&nbsp;Friday,&nbsp;January&nbsp;10,&nbsp;2025&nbsp;2:54&nbsp;PM&lt;br&gt;<br>
To:&nbsp;&#39;squid-users&#39;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
Subject:&nbsp;RE:&nbsp;Squid&nbsp;url&nbsp;redirector&nbsp;and&nbsp;DoH&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;this&nbsp;hair&nbsp;brained&nbsp;idea&nbsp;to&nbsp;use&nbsp;the&nbsp;media&nbsp;type&nbsp;and&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;endless&nbsp;list.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Could&nbsp;this&nbsp;work?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://www.iana.org/assignments/media-types/media-types.xhtml&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.iana.org/assignments/media-types/media-types.xhtml&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;lists&nbsp;mime&nbsp;types&nbsp;for&nbsp;doh&nbsp;with&nbsp;rfc&nbsp;8484&nbsp;and&nbsp;8427&nbsp;so&nbsp;technically&nbsp;could&nbsp;I&nbsp;just&nbsp;create&nbsp;a&nbsp;mime&nbsp;block&nbsp;for&nbsp;DoH&nbsp;and&nbsp;stop&nbsp;creating&nbsp;endless&nbsp;lists?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://www.iana.org/assignments/media-types/application/dns-message&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.iana.org/assignments/media-types/application/dns-message&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://www.iana.org/assignments/media-types/application/dns+json&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.iana.org/assignments/media-types/application/dns+json&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://wiki.squid-cache.org/ConfigExamples/BlockingMimeTypes&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://wiki.squid-cache.org/ConfigExamples/BlockingMimeTypes&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;Jonathan&nbsp;Lee&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jonathanlee571@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jonathanlee571@gmail.com&lt;/a&gt;&gt;&nbsp;&lt;br&gt;<br>
Sent:&nbsp;Friday,&nbsp;January&nbsp;10,&nbsp;2025&nbsp;2:38&nbsp;PM&lt;br&gt;<br>
To:&nbsp;squid-users&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
Subject:&nbsp;Squid&nbsp;url&nbsp;redirector&nbsp;and&nbsp;DoH&lt;br&gt;<br>
&lt;br&gt;<br>
Hello&nbsp;fellow&nbsp;Squid&nbsp;users,&nbsp;can&nbsp;you&nbsp;please&nbsp;help?&nbsp;I&nbsp;was&nbsp;wondering&nbsp;about&nbsp;this&nbsp;for&nbsp;years,&nbsp;I&nbsp;have&nbsp;a&nbsp;massive&nbsp;block&nbsp;list&nbsp;with&nbsp;DoH&nbsp;servers.&nbsp;Do&nbsp;you&nbsp;really&nbsp;need&nbsp;to&nbsp;block&nbsp;DoH&nbsp;if&nbsp;you&nbsp;want&nbsp;Squid&nbsp;to&nbsp;use&nbsp;a&nbsp;specific&nbsp;dns?&nbsp;Let’s&nbsp;say&nbsp;you&nbsp;are&nbsp;using&nbsp;a&nbsp;dns&nbsp;over&nbsp;tls,&nbsp;to&nbsp;Google&nbsp;or&nbsp;cloudflare&nbsp;and&nbsp;your&nbsp;system&nbsp;sometimes&nbsp;wants&nbsp;the&nbsp;DoH&nbsp;one.one.one.one&nbsp;is&nbsp;blocking&nbsp;that&nbsp;url&nbsp;really&nbsp;needed?&nbsp;My&nbsp;list&nbsp;is&nbsp;so&nbsp;big&nbsp;it&nbsp;is&nbsp;like&nbsp;playing&nbsp;wackamole&nbsp;with&nbsp;DoH.&nbsp;If&nbsp;I&nbsp;block&nbsp;it&nbsp;I&nbsp;see&nbsp;all&nbsp;the&nbsp;url&nbsp;requests&nbsp;if&nbsp;not&nbsp;I&nbsp;see&nbsp;IP&nbsp;addresses&nbsp;sometimes&nbsp;in&nbsp;the&nbsp;get&nbsp;requests.&nbsp;I&nbsp;must&nbsp;have&nbsp;a&nbsp;ACL&nbsp;with&nbsp;thousands&nbsp;and&nbsp;thousands&nbsp;of&nbsp;DoH&nbsp;servers&nbsp;in&nbsp;it.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;is&nbsp;recommended&nbsp;with&nbsp;sites&nbsp;that&nbsp;want&nbsp;DoH&nbsp;however&nbsp;clients&nbsp;must&nbsp;use&nbsp;Squid&nbsp;per&nbsp;firewall&nbsp;ACLs?&nbsp;&lt;br&gt;<br>
Sent&nbsp;from&nbsp;my&nbsp;iPhone&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail_signature_prefix&quot;&gt;--&nbsp;&lt;/span&gt;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt; &nbsp; &nbsp;Francesco&lt;/div&gt;<br>

</tt>
