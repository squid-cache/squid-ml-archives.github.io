<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&gt;&nbsp;Quality&nbsp;pull&nbsp;requests&nbsp;welcome.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;implemented the&nbsp;A-example&nbsp;functionality&nbsp;and&nbsp;made&nbsp;PR:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://github.com/squid-cache/squid/pull/2023&quot;&gt;https://github.com/squid-cache/squid/pull/2023&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;But&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;the&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;modified&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;Squid&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;project&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;is&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;not&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;being&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;built&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;on&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;github&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;although&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;there&nbsp;are&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;no&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;problems&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;during&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;the&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;local&lt;/span&gt;&lt;span&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;builds&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;Alex&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;,&lt;/span&gt;&nbsp;Amos&nbsp;and&nbsp;Francesco,&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;could&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;you&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;see&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;what&lt;/span&gt;&nbsp;the&nbsp;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&gt;problem&lt;/span&gt;&nbsp;is?<br>
<br>
&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;Kind&nbsp;regards,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-EzKURWReUAB5oZgtQNkl&quot;&nbsp;style=&quot;white-space-collapse:&nbsp;preserve;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ankor.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&nbsp;gmail_quote_container&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;вт,&nbsp;11&nbsp;мар.&nbsp;2025 г.&nbsp;в&nbsp;17:40,&nbsp;Andrey&nbsp;K&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ankor2023@gmail.com&quot;&gt;ankor2023@gmail.com&lt;/a&gt;&gt;:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;Alex,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;for&nbsp;sharing&nbsp;your&nbsp;thoughts.&lt;/div&gt;&lt;div&gt;The&nbsp;A-example&nbsp;looks&nbsp;easier&nbsp;to&nbsp;implement&nbsp;and&nbsp;more&nbsp;reliable.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kind regards,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;Ankor.&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;вт,&nbsp;11&nbsp;мар.&nbsp;2025 г.&nbsp;в&nbsp;17:12,&nbsp;Alex&nbsp;Rousskov&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;2025-03-10&nbsp;23:56,&nbsp;Andrey&nbsp;K&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt; &nbsp;&gt; Alex:&nbsp;FWIW,&nbsp;related&nbsp;future&nbsp;Squid&nbsp;improvements&nbsp;may&nbsp;include:&lt;br&gt;<br>
&gt; &nbsp;&gt; &nbsp;*&nbsp;Detecting&nbsp;such&nbsp;shared&nbsp;memory&nbsp;segments&nbsp;clashes;&nbsp;refusing&nbsp;to&nbsp;start.&lt;br&gt;<br>
&gt; &nbsp;&gt; &nbsp;*&nbsp;Disabling&nbsp;shared&nbsp;memory&nbsp;use&nbsp;when&nbsp;caching&nbsp;is&nbsp;completely&nbsp;disabled.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;But&nbsp;...&nbsp;segments&nbsp;may&nbsp;remain&nbsp;from&nbsp;the&nbsp;previous&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Squid&nbsp;crash.&nbsp;Thus,&nbsp;in&nbsp;my&nbsp;opinion,&nbsp;it&nbsp;is&nbsp;impractical&nbsp;to&nbsp;refuse&nbsp;to&nbsp;launch&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;program.&lt;br&gt;<br>
&lt;br&gt;<br>
&quot;Squid&nbsp;should&nbsp;overwrite&nbsp;segments&nbsp;left&nbsp;by&nbsp;a&nbsp;crashed&nbsp;Squid&quot;&nbsp;does&nbsp;not&nbsp;imply&nbsp;&lt;br&gt;<br>
that&nbsp;&quot;detecting&nbsp;segment&nbsp;clashes&nbsp;among&nbsp;independent&nbsp;Squid&nbsp;instances&nbsp;is&nbsp;&lt;br&gt;<br>
impractical&quot;.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;following&nbsp;rough&nbsp;examples&nbsp;are&nbsp;_not_&nbsp;implementation&nbsp;blueprints,&nbsp;but&nbsp;&lt;br&gt;<br>
they&nbsp;illustrate&nbsp;the&nbsp;lack&nbsp;of&nbsp;the&nbsp;above&nbsp;implication:&lt;br&gt;<br>
&lt;br&gt;<br>
A.&nbsp;If&nbsp;Squid&nbsp;were&nbsp;to&nbsp;incorporate&nbsp;PID&nbsp;filename[^1]&nbsp;into&nbsp;segment&nbsp;names,&nbsp;&lt;br&gt;<br>
then&nbsp;segments&nbsp;from&nbsp;different&nbsp;Squid&nbsp;instances&nbsp;will&nbsp;not&nbsp;clash.&lt;br&gt;<br>
&lt;br&gt;<br>
B.&nbsp;If&nbsp;Squid&nbsp;were&nbsp;to&nbsp;write&nbsp;its&nbsp;PID&nbsp;filename[^1]&nbsp;into&nbsp;a&nbsp;shared&nbsp;memory&nbsp;&lt;br&gt;<br>
segment,&nbsp;then&nbsp;Squid&nbsp;would&nbsp;be&nbsp;able&nbsp;to&nbsp;detect&nbsp;that&nbsp;another&nbsp;running&nbsp;&lt;br&gt;<br>
instance&nbsp;is&nbsp;using&nbsp;the&nbsp;same&nbsp;shared&nbsp;memory&nbsp;segment&nbsp;(while&nbsp;still&nbsp;&lt;br&gt;<br>
overwriting&nbsp;segments&nbsp;left&nbsp;by&nbsp;an&nbsp;earlier&nbsp;crash).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
[^1]:&nbsp;Full&nbsp;Squid&nbsp;PID&nbsp;filename&nbsp;are&nbsp;already&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;across&nbsp;&lt;br&gt;<br>
Squid&nbsp;instances&nbsp;that&nbsp;may&nbsp;overwrite&nbsp;each&nbsp;other&nbsp;segments&nbsp;because&nbsp;Squid&nbsp;&lt;br&gt;<br>
refuses&nbsp;to&nbsp;start&nbsp;if&nbsp;another&nbsp;Squid&nbsp;instance&nbsp;is&nbsp;using&nbsp;its&nbsp;PID&nbsp;file.&nbsp;The&nbsp;&lt;br&gt;<br>
only&nbsp;red&nbsp;flag&nbsp;I&nbsp;can&nbsp;think&nbsp;of&nbsp;here&nbsp;is&nbsp;esoteric&nbsp;chrooted&nbsp;instances,&nbsp;but&nbsp;I&nbsp;&lt;br&gt;<br>
would&nbsp;not&nbsp;be&nbsp;surprised&nbsp;if&nbsp;those&nbsp;instances&nbsp;cannot&nbsp;share&nbsp;segments.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;think&nbsp;it&#39;s&nbsp;enough&nbsp;to&nbsp;put&nbsp;a&nbsp;warning&nbsp;in&nbsp;the&nbsp;code&nbsp;when&nbsp;detecting&nbsp;old&lt;br&gt;<br>
&gt;&nbsp;segments.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;disagree&nbsp;that&nbsp;a&nbsp;level-0&nbsp;warning&nbsp;during&nbsp;regular/uneventful&nbsp;startups&nbsp;is&nbsp;&lt;br&gt;<br>
a&nbsp;good&nbsp;idea,&nbsp;especially&nbsp;if&nbsp;there&nbsp;will&nbsp;be&nbsp;one&nbsp;warning&nbsp;for&nbsp;every&nbsp;segment.&nbsp;&lt;br&gt;<br>
We&nbsp;should&nbsp;try&nbsp;to&nbsp;address&nbsp;the&nbsp;actual&nbsp;problem&nbsp;(i.e.&nbsp;refuse&nbsp;to&nbsp;start&nbsp;a&nbsp;&lt;br&gt;<br>
segment-clashing&nbsp;concurrent&nbsp;instance)&nbsp;rather&nbsp;than&nbsp;allowing&nbsp;clashes&nbsp;but&nbsp;&lt;br&gt;<br>
adding&nbsp;a&nbsp;yet&nbsp;another&nbsp;warning&nbsp;about&nbsp;a&nbsp;usually&nbsp;benign&nbsp;event.&lt;br&gt;<br>
&lt;br&gt;<br>
Alex.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;Something&nbsp;like&nbsp;that:&lt;br&gt;<br>
&gt;&nbsp;void&lt;br&gt;<br>
&gt;&nbsp;Ipc::Mem::Segment::create(const&nbsp;off_t&nbsp;aSize)&lt;br&gt;<br>
&gt;&nbsp;{&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;assert(aSize&nbsp;&gt;&nbsp;0);&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;assert(theFD&nbsp;&lt;&nbsp;0);&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;int&nbsp;xerrno&nbsp;=&nbsp;0;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;//&nbsp;Why&nbsp;a&nbsp;brand&nbsp;new&nbsp;segment?&nbsp;A&nbsp;Squid&nbsp;crash&nbsp;may&nbsp;leave&nbsp;a&nbsp;reusable&nbsp;&lt;br&gt;<br>
&gt;&nbsp;segment,&nbsp;but&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;//&nbsp;our&nbsp;placement-new&nbsp;code&nbsp;requires&nbsp;an&nbsp;all-0s&nbsp;segment.&nbsp;We&nbsp;could&nbsp;&lt;br&gt;<br>
&gt;&nbsp;truncate&nbsp;and&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;//&nbsp;resize&nbsp;the&nbsp;old&nbsp;segment,&nbsp;but&nbsp;OS&nbsp;X&nbsp;does&nbsp;not&nbsp;allow&nbsp;using&nbsp;O_TRUNC&nbsp;with&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;//&nbsp;shm_open()&nbsp;and&nbsp;does&nbsp;not&nbsp;support&nbsp;ftruncate()&nbsp;for&nbsp;old&nbsp;segments.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;if&nbsp;(!createFresh(xerrno)&nbsp;&amp;&amp;&nbsp;xerrno&nbsp;==&nbsp;EEXIST)&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;*debugs(54,&nbsp;DBG_CRITICAL,&nbsp;&quot;WARNING:&nbsp;there&nbsp;is&nbsp;an&nbsp;old&nbsp;shared&nbsp;memory&nbsp;&lt;br&gt;<br>
&gt;&nbsp;segment:&nbsp;&#39;&quot;&nbsp;&lt;&lt;&nbsp;theName&nbsp;&lt;&lt;&nbsp;&quot;&#39;.&nbsp;Perhaps&nbsp;it&nbsp;was&nbsp;left&nbsp;after&nbsp;the&nbsp;previous&nbsp;&lt;br&gt;<br>
&gt;&nbsp;crash&nbsp;of&nbsp;the&nbsp;Squid.&nbsp;We&nbsp;will&nbsp;remove&nbsp;it.&nbsp;Or&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;sign&nbsp;that&nbsp;another&nbsp;&lt;br&gt;<br>
&gt;&nbsp;instance&nbsp;of&nbsp;the&nbsp;Squid&nbsp;is&nbsp;running. &nbsp;In&nbsp;this&nbsp;case,&nbsp;you&nbsp;must&nbsp;launch&nbsp;the&nbsp;&lt;br&gt;<br>
&gt;&nbsp;program&nbsp;with&nbsp;the&nbsp;-n&nbsp;option&nbsp;and&nbsp;specify&nbsp;the&nbsp;unique&nbsp;name&nbsp;of&nbsp;the&nbsp;service.&quot;);*&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unlink();&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createFresh(xerrno);&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp;}&lt;br&gt;<br>
&gt;&nbsp;Kind&nbsp;regards,&lt;br&gt;<br>
&gt;&nbsp;Ankor.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;сб,&nbsp;8&nbsp;мар.&nbsp;2025 г.&nbsp;в&nbsp;08:14,&nbsp;Andrey&nbsp;K&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ankor2023@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ankor2023@gmail.com&lt;/a&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:ankor2023@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ankor2023@gmail.com&lt;/a&gt;&gt;&gt;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Hello&nbsp;Alex,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Thanks&nbsp;for&nbsp;the&nbsp;analysis.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Squidonlyallowsalphanumericcharactersinthe&nbsp;servicename,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; soitrefusesto&nbsp;usethe&nbsp;originalservice&nbsp;namein&nbsp;the&nbsp;-n&nbsp;option&nbsp;(-n&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.user.service).&lt;br&gt;<br>
&gt; &nbsp; &nbsp; I&nbsp;added-n&nbsp;squiduser option&nbsp;to&nbsp;the&nbsp;ExecStart&nbsp;string&nbsp;of&nbsp;the&nbsp;second&lt;br&gt;<br>
&gt; &nbsp; &nbsp; instance.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Now&nbsp;it&nbsp;looks&nbsp;good:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; #&nbsp;the&nbsp;first&nbsp;instance&lt;br&gt;<br>
&gt; &nbsp; &nbsp; lsof&nbsp;-p&nbsp;3746105&nbsp;|&nbsp;grep&nbsp;shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp;525572&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614834&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; 136&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614835&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp; 8&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614833&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; &nbsp; 7u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp; 8&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614833&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; &nbsp; 8u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp;525572&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614834&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid&nbsp; &nbsp;3746105&nbsp;root&nbsp; &nbsp; 9u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; 136&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1213614835&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; #&nbsp;the&nbsp;second&nbsp;instance&lt;br&gt;<br>
&gt; &nbsp; &nbsp; lsof&nbsp;-p&nbsp;3685356&nbsp;|&nbsp;grep&nbsp;shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp;2093368&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704041&nbsp;/dev/shm/squiduser-tls_session_cache.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; 525572&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704039&nbsp;/dev/shm/squiduser-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp;136&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704040&nbsp;/dev/shm/squiduser-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; mem&nbsp; &nbsp; REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704038&nbsp;/dev/shm/squiduser-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; &nbsp; 6u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704038&nbsp;/dev/shm/squiduser-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; &nbsp; 7u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; 525572&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704039&nbsp;/dev/shm/squiduser-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; &nbsp; 8u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp; &nbsp; &nbsp;136&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704040&nbsp;/dev/shm/squiduser-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; squid.use&nbsp;3685356&nbsp;root&nbsp; &nbsp; 9u&nbsp; &nbsp;REG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,23&nbsp; &nbsp;2093368&lt;br&gt;<br>
&gt; &nbsp; &nbsp; 1212704041&nbsp;/dev/shm/squiduser-tls_session_cache.shm&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; Kind&nbsp;regards,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ankor.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; пт,&nbsp;7&nbsp;мар.&nbsp;2025 г.&nbsp;в&nbsp;17:48,&nbsp;Alex&nbsp;Rousskov&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:rousskov@measurement-factory.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rousskov@measurement-factory.com&lt;/a&gt;&gt;&gt;:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; On&nbsp;2025-03-07&nbsp;06:50,&nbsp;Andrey&nbsp;K&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Squid&nbsp;Cache:&nbsp;Version&nbsp;6.13&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Service&nbsp;Name:&nbsp;squid&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Squid&nbsp;Cache:&nbsp;Version&nbsp;6.10&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Service&nbsp;Name:&nbsp;squid&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;#&nbsp;the&nbsp;first&nbsp;instance&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318&nbsp;DEL &nbsp;... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30205&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318&nbsp;DEL &nbsp;... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30206&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318&nbsp;DEL &nbsp;... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30204&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318 &nbsp; 8u&nbsp;... &nbsp; &nbsp; &nbsp;8 &nbsp; 30204&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; (deleted)&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318 &nbsp; 9u&nbsp;...&nbsp;525572 &nbsp; 30205&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; (deleted)&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1318 &nbsp;10u&nbsp;... &nbsp; &nbsp;136 &nbsp; 30206&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; (deleted)&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;#&nbsp;the&nbsp;second&nbsp;instance&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514&nbsp;mem &nbsp;...&nbsp;2093368 &nbsp; 31497&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; /dev/shm/squid-tls_session_cache.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514&nbsp;mem &nbsp;... &nbsp;525572 &nbsp; 31495&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514&nbsp;mem &nbsp;... &nbsp; &nbsp; 136 &nbsp; 31496&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514&nbsp;mem &nbsp;... &nbsp; &nbsp; &nbsp; 8 &nbsp; 31494&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514 &nbsp; 6u&nbsp;... &nbsp; &nbsp; &nbsp; 8 &nbsp; 31494&nbsp;/dev/shm/squid-cf__metadata.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514 &nbsp; 7u&nbsp;... &nbsp;525572 &nbsp; 31495&nbsp;/dev/shm/squid-cf__queues.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514 &nbsp; 8u&nbsp;... &nbsp; &nbsp; 136 &nbsp; 31496&nbsp;/dev/shm/squid-cf__readers.shm&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;1514 &nbsp; 9u&nbsp;...&nbsp;2093368 &nbsp; 31497&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; /dev/shm/squid-tls_session_cache.shm&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; As&nbsp;suspected,&nbsp;these&nbsp;two&nbsp;Squid&nbsp;instances&nbsp;use&nbsp;the&nbsp;same&nbsp;shared&nbsp;memory&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; segments&nbsp;(e.g.,&nbsp;/dev/shm/squid-cf*).&nbsp;Such&nbsp;shared&nbsp;use&nbsp;violates&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; critical&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; code&nbsp;assumptions&nbsp;and&nbsp;results&nbsp;in&nbsp;undefined&nbsp;behavior.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Maybe&nbsp;I&#39;m&nbsp;not&nbsp;experiencing&nbsp;any&nbsp;difficulties&nbsp;because&nbsp;I&nbsp;have&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; caching&nbsp;turned&nbsp;off&nbsp;on&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;both&nbsp;instances?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Well,&nbsp;you&nbsp;_are_&nbsp;experiencing&nbsp;at&nbsp;least&nbsp;one&nbsp;difficulty&nbsp;--&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; assertion&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; that&nbsp;started&nbsp;this&nbsp;email&nbsp;thread.&nbsp;If&nbsp;you&nbsp;have&nbsp;fully&nbsp;disabled&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; caching,&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; difficulties&nbsp;you&nbsp;experience&nbsp;should&nbsp;not&nbsp;include&nbsp;cache&nbsp;corruption.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; However,&nbsp;it&nbsp;looks&nbsp;like&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;instances&nbsp;does&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; cache&nbsp;TLS&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; sessions&nbsp;(in&nbsp;/dev/shm/squid-tls_session_cache.shm).&nbsp;If&nbsp;both&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; instances&nbsp;do&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; that,&nbsp;then&nbsp;all&nbsp;bets&nbsp;are&nbsp;off!&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; FWIW,&nbsp;related&nbsp;future&nbsp;Squid&nbsp;improvements&nbsp;may&nbsp;include:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp;Detecting&nbsp;such&nbsp;shared&nbsp;memory&nbsp;segments&nbsp;clashes;&nbsp;refusing&nbsp;to&nbsp;start.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp;Disabling&nbsp;shared&nbsp;memory&nbsp;use&nbsp;when&nbsp;caching&nbsp;is&nbsp;completely&nbsp;disabled.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Quality&nbsp;pull&nbsp;requests&nbsp;welcome.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Cheers,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Alex.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;чт,&nbsp;6&nbsp;мар.&nbsp;2025 г.&nbsp;в&nbsp;17:11,&nbsp;Alex&nbsp;Rousskov:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; On&nbsp;2025-03-06&nbsp;08:59,&nbsp;Amos&nbsp;Jeffries&nbsp;wrote:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;On&nbsp;6/03/25&nbsp;19:17,&nbsp;Andrey&nbsp;K&nbsp;wrote:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;Hello,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;similar configuration:&nbsp;two&nbsp;SMP&nbsp;squids&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; running&nbsp;on&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; same&nbsp;OEL&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;host.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;They&nbsp;were&nbsp;built&nbsp;with&nbsp;different&nbsp;configurations:&nbsp;with&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; different&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;installation&nbsp;path&nbsp;prefixes&nbsp;and&nbsp;different names&nbsp;of&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; binary&nbsp;files:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; squid&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;and&nbsp;squid.user&nbsp;and&nbsp;they&nbsp;listen&nbsp;to&nbsp;different&nbsp;ports.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;They&nbsp;are&nbsp;launched from&nbsp;two&nbsp;different&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; services:squid.service&nbsp;and&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;squid.user.service&nbsp;with&nbsp;the&nbsp;service&nbsp;Type=forking:&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;   &nbsp;ExecStart=/usr/sbin/squid&nbsp;-sYC&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;   &nbsp;ExecStart=/sbin/squid.user&nbsp;-f&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; /etc/squid.user/squid.conf&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;I&nbsp;have&nbsp;not&nbsp;experienced&nbsp;any&nbsp;troubles&nbsp;with&nbsp;this&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; configuration&nbsp;yet.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;/&gt;&nbsp;Please&nbsp;be&nbsp;aware&nbsp;that&nbsp;&quot;squid&nbsp;-n&nbsp;...&quot;&nbsp;is&nbsp;a&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; REQUIREMENT&nbsp;for&nbsp;running/&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;/multiple&nbsp;Squid&nbsp;instances&nbsp;on&nbsp;the&nbsp;same&nbsp;machine&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; regardless&nbsp;of&nbsp;what&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; features&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;are&nbsp;used./&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;Could&nbsp;you&nbsp;please tell&nbsp;me&nbsp;if&nbsp;I&nbsp;should&nbsp;use&nbsp;the&nbsp;-n&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; option&nbsp;in&nbsp;the&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;ExecStart&nbsp;strings?&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;The&nbsp;arguments&nbsp;of&nbsp;the&nbsp;options&nbsp;should&nbsp;be&nbsp;the&nbsp;service&nbsp;names?&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;   &nbsp;ExecStart=/usr/sbin/squid&nbsp;-sYC&nbsp;-n&nbsp;squid.service&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;   &nbsp;ExecStart=/sbin/squid.user&nbsp;-f&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; /etc/squid.user/squid.conf&nbsp;-n&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp;   &nbsp;squid.user.service&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;Yes&nbsp;you&nbsp;should.&nbsp;The&nbsp;different&nbsp;./configure&nbsp;options&nbsp;has&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; helped&nbsp;you&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; avoid&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &nbsp;&gt;&nbsp;major&nbsp;issues,&nbsp;but&nbsp;some&nbsp;may&nbsp;still&nbsp;appear.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; I&nbsp;agree.&nbsp;Moreover,&nbsp;I&nbsp;do&nbsp;not&nbsp;understand&nbsp;how&nbsp;your&nbsp;two&nbsp;SMP&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; Squids&nbsp;could&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; work&nbsp;correctly&nbsp;without&nbsp;distinct&nbsp;service&nbsp;names&nbsp;because&nbsp;(on&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; OEL)&nbsp;I&nbsp;would&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; expect&nbsp;them&nbsp;to&nbsp;share&nbsp;the&nbsp;same&nbsp;shared&nbsp;memory&nbsp;segments&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; (which&nbsp;they&nbsp;must&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; not&nbsp;do&nbsp;to&nbsp;remain&nbsp;distinct&nbsp;instances).&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; What&nbsp;is&nbsp;your&nbsp;Squid&nbsp;version?&nbsp;Can&nbsp;you&nbsp;tell&nbsp;how&nbsp;your&nbsp;Squids&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; name&nbsp;their&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; shared&nbsp;memory&nbsp;segment&nbsp;&quot;files&quot;?&nbsp;For&nbsp;example,&nbsp;on&nbsp;some&nbsp;Linux&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; OSes,&nbsp;those&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; segments&nbsp;could&nbsp;be&nbsp;in&nbsp;/var/run/shm/&nbsp;with&nbsp;names&nbsp;like&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; squid-tr_map_anchors.shm &nbsp;and&nbsp;squid-tr_spaces.shm.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; Thank&nbsp;you,&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; Alex.&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; _______________________________________________&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;mailto:&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &lt;&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&gt;&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
squid-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:squid-users@lists.squid-cache.org&quot;&nbsp;target=&quot;_blank&quot;&gt;squid-users@lists.squid-cache.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.squid-cache.org/listinfo/squid-users&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.squid-cache.org/listinfo/squid-users&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
