<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Dear&nbsp;Squid&nbsp;team,&lt;br&gt;&lt;br&gt;I’m&nbsp;currently&nbsp;working&nbsp;on&nbsp;deploying&nbsp;Squid&nbsp;as&nbsp;a&nbsp;transparent&nbsp;proxy&nbsp;using&nbsp;WCCPv2&nbsp;with&nbsp;a&nbsp;Cisco&nbsp;ASA&nbsp;firewall.&lt;br&gt;&lt;br&gt;The&nbsp;ASA&nbsp;selects&nbsp;a&nbsp;router&nbsp;ID&nbsp;x.x.x.x&nbsp;automatically&nbsp;and&nbsp;uses&nbsp;GRE&nbsp;encapsulation.&nbsp;However,&nbsp;in&nbsp;my&nbsp;Squid&nbsp;configuration,&nbsp;I’m&nbsp;using&nbsp;wccp2_forwarding_method&nbsp;gre.&lt;br&gt;&lt;br&gt;I’ve&nbsp;confirmed&nbsp;that:&lt;br&gt;-&nbsp;UDP&nbsp;traffic&nbsp;on&nbsp;port&nbsp;2048&nbsp;between&nbsp;Squid&nbsp;and&nbsp;the&nbsp;ASA&nbsp;is&nbsp;working&nbsp;correctly.&lt;br&gt;-&nbsp;Squid&nbsp;receives&nbsp;WCCP&nbsp;messages&nbsp;(`HERE_I_AM`,&nbsp;`I_SEE_YOU`)&nbsp;but&nbsp;logs&nbsp;errors&nbsp;like:&lt;br&gt; &nbsp;`ERROR:&nbsp;Ignoring&nbsp;WCCPv2&nbsp;message:&nbsp;check&nbsp;failed:&nbsp;duplicate&nbsp;security&nbsp;definition`&lt;br&gt;-&nbsp;ASA&nbsp;logs&nbsp;show&nbsp;that&nbsp;Squid&nbsp;is&nbsp;visible&nbsp;but&nbsp;marked&nbsp;as&nbsp;“NOT&nbsp;Usable”&nbsp;and&nbsp;gets&nbsp;0%&nbsp;hash&nbsp;allocation.&lt;br&gt;-&nbsp;I’m&nbsp;running&nbsp;Squid&nbsp;version&nbsp;5.9&nbsp;on&nbsp;Linux&nbsp;Ubuntu.&lt;br&gt;&lt;br&gt;Questions:&lt;br&gt;1.&nbsp;Is&nbsp;there&nbsp;a&nbsp;known&nbsp;issue&nbsp;when&nbsp;using&nbsp;`wccp2_forwarding_method&nbsp;gre`&nbsp;with&nbsp;devices&nbsp;that&nbsp;support&nbsp;GRE?&lt;br&gt;2.&nbsp;Could&nbsp;Squid&nbsp;gracefully&nbsp;fallback&nbsp;or&nbsp;detect&nbsp;ASA’s&nbsp;redirect&nbsp;mode&nbsp;automatically?&lt;br&gt;3.&nbsp;Is&nbsp;there&nbsp;a&nbsp;specific&nbsp;Squid&nbsp;version&nbsp;better&nbsp;suited&nbsp;for&nbsp;WCCPv2&nbsp;with&nbsp;GRE&nbsp;only?&lt;br&gt;&lt;br&gt;Any&nbsp;insights,&nbsp;suggestions,&nbsp;or&nbsp;recommended&nbsp;configuration&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated.&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;support&nbsp;and&nbsp;great&nbsp;work&nbsp;on&nbsp;Squid.&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&nbsp; &lt;br&gt;Assoham&nbsp;AWOUTOU  &lt;br&gt;MACHAERO  &lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:10pt;font-family:Arial&quot;&gt;******************************&lt;wbr&gt;******************************&lt;wbr&gt;******************&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:8pt;font-family:Arial&quot;&gt;The&nbsp;information&nbsp;contained&nbsp;herein&nbsp;may&nbsp;be&nbsp;company&nbsp;confidential&nbsp;and&nbsp;proprietary.&nbsp;The&nbsp;information&nbsp;is&nbsp;intended&nbsp;only&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;named&nbsp;individual&nbsp;or&nbsp;entity.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;the&nbsp;employee&nbsp;or&nbsp;agent&nbsp;responsible&nbsp;for&nbsp;delivering&nbsp;it&nbsp;to&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;use,&nbsp;dissemination,&nbsp;distribution&nbsp;or&nbsp;copying&nbsp;of&nbsp;this&nbsp;communication&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;communication&nbsp;in&nbsp;error,&nbsp;please&nbsp;notify&nbsp;the&nbsp;sender&nbsp;(and&nbsp;delete&nbsp;it&nbsp;from&nbsp;your&nbsp;systems)&nbsp;immediately.&nbsp;The&nbsp;information&nbsp;herein&nbsp;is&nbsp;not&nbsp;warranted&nbsp;to&nbsp;be&nbsp;free&nbsp;of&nbsp;virus&nbsp;or&nbsp;any&nbsp;other&nbsp;defect&nbsp;that&nbsp;may&nbsp;affect&nbsp;the&nbsp;recipient&#39;s&nbsp;computer&nbsp;system&nbsp;and&nbsp;it&nbsp;is&nbsp;your&nbsp;responsibility&nbsp;to&nbsp;carry&nbsp;out&nbsp;appropriate&nbsp;virus&nbsp;checks&nbsp;of&nbsp;this&nbsp;email&nbsp;and&nbsp;attachments&nbsp;(if&nbsp;any).&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:10pt;font-family:Arial&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-family:Arial,Helvetica,sans-serif;font-size:small&quot;&gt;&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(34,34,34);font-family:Arial,Helvetica,sans-serif;font-size:small&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:10pt;font-family:Arial&quot;&gt;******************************&lt;wbr&gt;******************************&lt;wbr&gt;******************&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-family:Arial,Helvetica,sans-serif;font-size:small&quot;&gt;&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(34,34,34);font-family:Arial,Helvetica,sans-serif;font-size:small&quot;&gt;
</tt>
